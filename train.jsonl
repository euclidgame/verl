{"id": "usamo-2012-q1", "question": "Find all integers $n \\ge 3$ such that\namong any $n$ positive real numbers\n$a_1$, $a_2$, \\dots, $a_n$ with\n\\[ \\max(a_1,a_2,\\dots,a_n)\n  \\le n \\cdot \\min(a_1,a_2,\\dots,a_n), \\]\nthere exist three that are the side lengths\nof an acute triangle.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2669112}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all integers $n \\ge 3$ such that\namong any $n$ positive real numbers\n$a_1$, $a_2$, \\dots, $a_n$ with\n\\[ \\max(a_1,a_2,\\dots,a_n)\n  \\le n \\cdot \\min(a_1,a_2,\\dots,a_n), \\]\nthere exist three that are the side lengths\nof an acute triangle.\n\\end{mdframed}\nThe answer is all $n \\ge 13$.\n\nDefine $(F_n)$ as the sequence of Fibonacci numbers,\nby $F_1 = F_2 = 1$ and $F_{n+1} = F_n + F_{n-1}$.\nWe will find that Fibonacci numbers show up naturally\nwhen we work through the main proof,\nso we will isolate the following calculation now\nto make the subsequent solution easier to read.\n\\begin{claim*}\n  For positive integers $m$, we have $F_m \\le m^2$ if and only if $m \\le 12$.\n\\end{claim*}\n\\begin{proof}\n  A table of the first $14$ Fibonacci numbers is given below.\n  \\[\n    \\begin{array}{rrrrr rrrrr rrrr}\n      F_1 & F_2 & F_3 & F_4 & F_5 & F_6 & F_7 & F_8 & F_9\n        & F_{10} & F_{11} & F_{12} & F_{13} & F_{14} \\\\ \\hline\n      1 & 1 & 2 & 3 & 5 & 8 & 13 & 21 & 34 & 55 & 89 & 144 & 233 & 377\n    \\end{array}\n  \\]\n  By examining the table, we see that $F_m \\le m^2$ is true for $m = 1, 2, \\dots 12$,\n  and in fact $F_{12} = 12^2 = 144$.\n  However, $F_m > m^2$ for $m = 13$ and $m = 14$.\n\n  Now it remains to prove that $F_m > m^2$ for $m \\ge 15$.\n  The proof is by induction with base cases\n  $m = 13$ and $m = 14$ being checked already.\n  For the inductive step, if $m \\ge 15$ then we have\n  \\begin{align*}\n    F_m &= F_{m-1} + F_{m-2} > (m-1)^2 + (m-2)^2 \\\\\n    &= 2m^2 - 6m + 5 = m^2 + (m-1)(m-5) > m^2\n  \\end{align*}\n  as desired.\n\\end{proof}\n\nWe now proceed to the main problem.\nThe hypothesis $\\max(a_1,a_2,\\dots,a_n)\n\\le n \\cdot \\min(a_1,a_2,\\dots,a_n)$\nwill be denoted by $(\\dagger)$.\n\n\\medskip\n\n\\textbf{Proof that all $n \\ge 13$ have the property.}\nWe first show now that every $n \\ge 13$ has the desired property.\nSuppose for contradiction that no three numbers are the sides of an acute triangle.\nAssume without loss of generality (by sorting the numbers)\nthat $a_1 \\le a_2 \\le \\dots \\le a_n$.\nThen since $a_{i-1}$, $a_i$, $a_{i+1}$ are not the sides of an acute triangle\nfor each $i \\ge 2$, we have that $a_{i+1}^2 \\ge a_i^2 + a_{i-1}^2$;\nwriting this out gives\n\\begin{align*}\n  a_3^2 &\\ge a_2^2 + a_1^2 \\ge 2a_1^2 \\\\\n  a_4^2 &\\ge a_3^2 + a_2^2 \\ge 2a_1^2 + a_1^2 = 3a_1^2 \\\\\n  a_5^2 &\\ge a_4^2 + a_3^2 \\ge 3a_1^2 + 2a_1^2 = 5a_1^2 \\\\\n  a_6^2 &\\ge a_5^2 + a_4^2 \\ge 5a_1^2 + 3a_1^2 = 8a_1^2\n\\end{align*}\nand so on.\nThe Fibonacci numbers appear naturally and by induction,\nwe conclude that $a_i^2 \\ge F_i a_1^2$.\nIn particular, $a_n^2 \\ge F_n a_1^2$.\n\nHowever, we know $\\max(a_1, \\dots, a_n) = a_n$\nand $\\min(a_1, \\dots, a_n) = a_1$,\nso $(\\dagger)$ reads $a_n \\le n \\cdot a_1$.\nTherefore we have $F_n \\le n^2$, and so $n \\le 12$, contradiction!\n\n\\medskip\n\n\\textbf{Proof that no $n \\le 12$ have the property.}\nAssume that $n \\le 12$.\nThe above calculation also suggests a way to pick the counterexample:\nwe choose $a_i = \\sqrt{F_i}$ for every $i$.\nThen $\\min(a_1, \\dots, a_n) = a_1 = 1$\nand $\\max(a_1, \\dots, a_n) = \\sqrt{F_n}$,\nso $(\\dagger)$ is true as long as $n \\le 12$.\nAnd indeed no three numbers form the sides of an acute triangle:\nif $i < j < k$,\nthen $a_k^2 = F_k = F_{k-1} + F_{k-2} \\ge F_j + F_i = a_j^2 + a_i^2$.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2012}
{"id": "usamo-2012-q2", "question": "A circle is divided into congruent arcs by $432$ points.\nThe points are colored in four colors such that\nsome $108$ points are colored red,\nsome $108$ points are colored green,\nsome $108$ points are colored blue,\nand the remaining $108$ points are colored yellow.\nProve that one can choose three points of each color in such a way\nthat the four triangles formed by the chosen points\nof the same color are congruent.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2669115}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA circle is divided into congruent arcs by $432$ points.\nThe points are colored in four colors such that\nsome $108$ points are colored red,\nsome $108$ points are colored green,\nsome $108$ points are colored blue,\nand the remaining $108$ points are colored yellow.\nProve that one can choose three points of each color in such a way\nthat the four triangles formed by the chosen points\nof the same color are congruent.\n\\end{mdframed}\nFirst, consider the $431$ possible non-identity rotations\nof the red points, and count overlaps with green points.\nIf we select a rotation randomly,\nthen each red point lies over a green point\nwith probability $\\frac{108}{431}$;\nhence the expected number of red-green incidences is\n\\[ \\frac{108}{431} \\cdot 108 > 27 \\]\nand so by pigeonhole, we can find a red $28$-gon\nand a green $28$-gon which are rotations of each other.\n\nNow, look at the $430$ rotations of this $28$-gon\n(that do not give the all-red or all-green configuration)\nand compare it with the blue points.\nThe same approach gives\n\\[ \\frac{108}{430} \\cdot 28 > 7 \\]\nincidences, so we can find red, green, blue $8$-gons\nwhich are similar under rotation.\n\nFinally, the $429$ nontrivial rotations of this $8$-gon expect\n\\[ \\frac{108}{429} \\cdot 8 > 2 \\]\nincidences with yellow.\nSo finally we have four monochromatic $3$-gons,\none of each color, which are rotations of each other.\n\\pagebreak", "category": "Combinatorics", "source": "USAMO", "year": 2012}
{"id": "usamo-2012-q3", "question": "Determine which integers $n > 1$ have the property\nthat there exists an infinite sequence $a_1$, $a_2$, $a_3$, \\dots\nof nonzero integers such that the equality\n\\[ a_k + 2a_{2k} + \\dots + na_{nk} = 0 \\]\nholds for every positive integer $k$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2669119}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nDetermine which integers $n > 1$ have the property\nthat there exists an infinite sequence $a_1$, $a_2$, $a_3$, \\dots\nof nonzero integers such that the equality\n\\[ a_k + 2a_{2k} + \\dots + na_{nk} = 0 \\]\nholds for every positive integer $k$.\n\\end{mdframed}\nAnswer: all $n > 2$.\n\nFor $n = 2$, we have $a_k + 2a_{2k} = 0$,\nwhich is clearly not possible,\nsince it implies $a_{2^k} = \\frac{a_1}{2^{k-1}}$\nfor all $k \\ge 1$.\n\nFor $n \\ge 3$ we will construct a \\emph{completely multiplicative} sequence\n(meaning $a_{ij} = a_i a_j$ for all $i$ and $j$).\nThus $(a_i)$ is determined by its value on primes,\nand satisfies the condition as long as\n$a_1 + 2a_2 + \\dots + na_n = 0$.\nThe idea is to take two large primes and use Bezout's theorem,\nbut the details require significant care.\n\nWe start by solving the case where $n \\ge 9$.\nIn that case, by Bertrand postulate there exists primes $p$ and $q$ such that\n\\[\n  \\left\\lceil n/2 \\right\\rceil < q < 2\\left\\lceil n/2 \\right\\rceil\n  \\quad\\text{and}\\quad\n  \\half(q-1) < p < q-1.\n\\]\nClearly $p \\neq q$, and $q \\ge 7$, so $p > 3$.\nAlso, $p < q < n$ but $2q > n$, and $4p \\ge 4\\left( \\half(q+1) \\right) > n$.\nWe now stipulate that $a_r = 1$ for any prime $r \\neq p,q$\n(in particular including $r=2$ and $r=3$).\nThere are now three cases, identical in substance.\n\\begin{itemize}\n  \\ii If $p, 2p, 3p \\in [1,n]$ then we would like to\n  choose nonzero $a_p$ and $a_q$ such that\n  \\[ 6p \\cdot a_p + q \\cdot a_q = 6p + q - \\half n (n+1) \\]\n  which is possible by B\\'{e}zout lemma, since $\\gcd(6p,q) = 1$.\n\n  \\ii Else if $p, 2p \\in [1,n]$ then we would like to\n  choose nonzero $a_p$ and $a_q$ such that\n  \\[ 3p \\cdot a_p + q \\cdot a_q = 3p + q - \\half n (n+1) \\]\n  which is possible by B\\'{e}zout lemma, since $\\gcd(3p, q) = 1$.\n\n  \\ii Else if $p \\in [1,n]$ then we would like to\n  choose nonzero $a_p$ and $a_q$ such that\n  \\[ p \\cdot a_p + q \\cdot a_q = p + q - \\half n (n+1) \\]\n  which is possible by B\\'{e}zout lemma, since $\\gcd(p, q) = 1$.\n  (This case is actually possible in a few edge cases,\n  for example when $n=9$, $q=7$, $p=5$.)\n\\end{itemize}\n\nIt remains to resolve the cases where $3 \\le n \\le 8$.\nWe enumerate these cases manually:\n\\begin{itemize}\n  \\ii For $n = 3$, let $a_n = (-1)^{\\nu_3(n)}$.\n  \\ii For $n = 4$, let $a_n = (-1)^{\\nu_2(n) + \\nu_3(n)}$.\n  \\ii For $n = 5$, let $a_n = (-2)^{\\nu_5(n)}$.\n  \\ii For $n = 6$, let $a_n =  5^{\\nu_2(n)} \\cdot 3^{\\nu_3(n)} \\cdot (-42)^{\\nu_5(n)}$.\n  \\ii For $n = 7$, let $a_n = (-3)^{\\nu_7(n)}$.\n  \\ii For $n = 8$, we can choose $(p,q) = (5,7)$ in the prior construction.\n\\end{itemize}\n\nThis completes the constructions for all $n > 2$.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Number Theory", "source": "USAMO", "year": 2012}
{"id": "usamo-2012-q4", "question": "Find all functions $f \\colon \\NN \\to \\NN$ such that\n$f(n!) = f(n)!$ for all positive integers $n$ and such that\n$m-n$ divides $f(m) - f(n)$ for all distinct positive integers $m$, $n$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2669997}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all functions $f \\colon \\NN \\to \\NN$ such that\n$f(n!) = f(n)!$ for all positive integers $n$ and such that\n$m-n$ divides $f(m) - f(n)$ for all distinct positive integers $m$, $n$.\n\\end{mdframed}\nAnswer: $f \\equiv 1$, $f \\equiv 2$, and $f$ the identity.\nAs these obviously work, we prove these are the only ones.\n\nBy putting $n=1$ and $n=2$ we give $f(1), f(2) \\in \\{1,2\\}$.\nAlso, we will use the condition\n\\[ m!-n! \\text{ divides } f(m)! - f(n)!. \\]\nWe consider four cases on $f(1)$ and $f(2)$,\nand dispense with three of them.\n\\begin{itemize}\n  \\ii If $f(2) = 1$ then for all $m \\ge 3$ we have\n  $m!-2$ divides $f(m)! - 1$, so $f(m) = 1$\n  for modulo $2$ reasons.\n  Then clearly $f(1) = 1$.\n  \\ii If $f(1) = f(2) = 2$ we first obtain\n  $3!-1 \\mid f(3)!-2$, which implies $f(3) = 2$.\n  Then $m! - 3 \\mid f(m)! - 2$ for $m \\ge 4$\n  implies $f(m)=2$ for modulo $3$ reasons.\n\\end{itemize}\nHence we are left with the case where $f(1) = 1$ and $f(2) = 2$.\nContinuing, we have\n\\[ 3!-1 \\mid f(3)! - 1 \\quad\\text{and}\\quad\n  3!-2 \\mid f(3)!-2 \\implies f(3) = 3. \\]\n\nContinuing by induction, suppose $f(1) = 1$, \\dots, $f(k) = k$.\n\\[ k! \\cdot k = (k+1)! - k! \\mid f(k+1)! - k! \\]\nand thus we deduce that $f(k+1) \\ge k$, and hence\n\\[ k \\mid \\frac{f(k+1)!}{k!} - 1. \\]\nThen plainly $f(k+1) \\le 2k$ for mod $k$ reasons,\nbut also $f(k+1) \\equiv 1 \\pmod k$ so we conclude $f(k+1) = k+1$.\n\n\\begin{remark*}\n  Shankar Padmanabhan gives the following way\n  to finish after verifying that $f(3) = 3$.\n  Note that if\n  \\[ M = ( ( ( (3!)! )! )! \\dots )! \\]\n  for any number of iterated factorials\n  then $f(M) = M$.\n  Thus for any $n$, we have\n  \\[ M-n \\mid f(M) - f(n) = M - f(n) \\implies M - n \\mid n - f(n) \\]\n  and so taking $M$ large enough implies $f(n) = n$.\n\\end{remark*}\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 2012}
{"id": "usamo-2012-q5", "question": "Let $P$ be a point in the plane of $\\triangle ABC$,\nand $\\gamma$ a line through $P$.\nLet $A'$, $B'$, $C'$ be the points where the\nreflections of lines $PA$, $PB$, $PC$ with respect to $\\gamma$\nintersect lines $BC$, $CA$, $AB$ respectively.\nProve that $A'$, $B'$, $C'$ are collinear.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2669960}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $P$ be a point in the plane of $\\triangle ABC$,\nand $\\gamma$ a line through $P$.\nLet $A'$, $B'$, $C'$ be the points where the\nreflections of lines $PA$, $PB$, $PC$ with respect to $\\gamma$\nintersect lines $BC$, $CA$, $AB$ respectively.\nProve that $A'$, $B'$, $C'$ are collinear.\n\\end{mdframed}\nWe present three solutions.\n\n\\paragraph{First solution (complex numbers).}\nLet $p=0$ and set $\\gamma$ as the real line.\nThen $A'$ is the intersection of $bc$ and $p\\ol a$.\nSo, we get\n\\[ a' = \\frac{\\ol a(\\ol b c - b \\ol c)}{(\\ol b - \\ol c)\\ol a-(b-c) a}. \\]\n\n\\begin{center}\n  \\begin{asy}\n    size(4cm);\n    pair A = dir(110), B = dir(210), C = dir(330);\n    Drawing(\"A\", A, A);\n    Drawing(\"B\", B, dir(-90));\n    Drawing(\"C\", C, dir(-90));\n    draw(A--B--C--cycle);\n    pair P = Drawing(\"P\", 0.1*dir(40), dir(-35));\n    pair X1 = P + .5 * dir(10);\n    pair X2 = P - .5 * dir(10);\n    Drawing(Line(X1,X2), dashed, Arrows);\n    pair T = 2*foot(A,X1,X2)-A;\n    pair A1 = Drawing(\"A'\", extension(P,T,B,C), dir(-40));\n    draw(A--P--A1);\n  \\end{asy}\n\\end{center}\n\nNote that\n\\[ \\ol a' = \\frac{a (b \\ol c - \\ol b c)}{(b-c) a - (\\ol b - \\ol c)\\ol a}. \\]\nThus it suffices to prove\n\\[ 0 = \\det\n\\begin{bmatrix}\n  \\frac{\\ol a(\\ol b c-b \\ol c)}{(\\ol b - \\ol c)\\ol a - (b-c) a} & \\frac{a (b \\ol c - \\ol b c)}{(b-c) a - (\\ol b - \\ol c) \\ol a} & 1 \\\\\n  \\frac{\\ol b(\\ol c a-c \\ol a)}{(\\ol c - \\ol a)\\ol b - (c-a) b} & \\frac{b (c \\ol a - \\ol c a)}{(c-a) b - (\\ol c - \\ol a) \\ol b} & 1 \\\\\n  \\frac{\\ol c(\\ol a b-a \\ol b)}{(\\ol a - \\ol b)\\ol c - (a-b) c} & \\frac{c (a \\ol b - \\ol a b)}{(a-b) c - (\\ol a - \\ol b)\\ol c} & 1\n\\end{bmatrix}.\n\\]\nThis is equivalent to\n\\[ 0 = \\det\n\\begin{bmatrix}\n  \\ol a(\\ol b c -b \\ol c) & a (\\ol b c - b \\ol c) & (\\ol b - \\ol c) \\ol a - (b-c) a \\\\\n  \\ol b(\\ol c a -c \\ol a) & b (\\ol c a - c \\ol a) & (\\ol c - \\ol a) \\ol b - (c-a) b \\\\\n  \\ol c(\\ol a b -a \\ol b) & c (\\ol a b - a \\ol b) & (\\ol a - \\ol b) \\ol c - (a-b) c \\\\\n\\end{bmatrix}. \\]\nThis determinant has the property that the rows sum to zero, and we're done.\n\\begin{remark*}\n  Alternatively, if you don't notice that you could just blindly expand:\n  \\begin{align*}\n    &\\phantom{=} \\sum_{\\text{cyc}} ((\\ol b - \\ol c) \\ol a - (b-c) a) \\cdot\n    - \\det\n    \\begin{bmatrix}\n      b & \\ol b \\\\\n      c & \\ol c\n    \\end{bmatrix}\n    \\left( \\ol c a - c \\ol a \\right)\\left( \\ol a b - a \\ol b \\right) \\\\\n    &= (\\ol b c - c \\ol b)(\\ol c a - c \\ol a)(\\ol a b - a \\ol b)\n    \\sum_{\\text{cyc}} \\left( ab - ac + \\ol c \\ol a - \\ol b \\ol a \\right) = 0.\n  \\end{align*}\n\\end{remark*}\n\n\\paragraph{Second solution (Desargues involution).}\nWe let $C'' = \\ol{A'B'} \\cap \\ol{AB}$.\nConsider complete quadrilateral $ABCA'B'C''C$.\nWe see that there is an involutive pairing $\\tau$ at $P$\nswapping $(PA,PA')$, $(PB,PB')$, $(PC,PC'')$.\nFrom the first two, we see $\\tau$ coincides with reflection\nabout $\\ell$, hence conclude $C'' = C$.\n\n\\paragraph{Third solution (barycentric), by Catherine Xu.}\nWe will perform barycentric coordinates on the triangle $PCC'$,\nwith $P=(1,0,0)$, $C'=(0,1,0)$, and $C=(0,0,1)$.\nSet $a = CC'$, $b = CP$, $c = C'P$ as usual.\nSince $A$, $B$, $C'$ are collinear,\nwe will define $A = (p : k : q)$ and $B = (p : \\ell : q)$.\n\n\\begin{claim*}\n  Line $\\gamma$ is the angle bisector of\n  $\\angle APA' $, $\\angle BPB'$, and $\\angle CPC'$.\n\\end{claim*}\n\\begin{proof}\n  Since $A'P$ is the reflection of $AP$ across $\\gamma$, etc.\n\\end{proof}\n\nThus $B'$ is the intersection of the isogonal of $B$ with respect to $\\angle P$\nwith the line $CA$; that is,\n\\[ B' = \\left( \\frac pk \\frac{b^2}{\\ell}\n  : \\frac{b^2}{\\ell} : \\frac{c^2}{q} \\right). \\]\nAnalogously, $A'$ is the intersection of the isogonal of $A$ with respect to $\\angle P$\nwith the line $CB$; that is,\n\\[ A' = \\left( \\frac{p}{\\ell} \\frac{b^2}{k}\n    : \\frac{b^2}{k} : \\frac{c^2}{q} \\right). \\]\nThe ratio of the first to third coordinate in these two points\nis both $b^2pq : c^2k\\ell$, so it follows $A'$, $B'$, and $C'$ are collinear.\n\n\\begin{remark*}\n  [Problem reference]\n  The converse of this problem appears as problem 1052\n  attributed S.\\ V.\\ Markelov in the book\n  \\emph{Geometriya: 9--11 Klassy: Ot Uchebnoy Zadachi k Tvorcheskoy, 1996},\n  by I.\\ F.\\ Sharygin.\n\\end{remark*}\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2012}
{"id": "usamo-2012-q6", "question": "For integer $n \\ge 2$,\nlet $x_1$, $x_2$, \\dots, $x_n$ be real numbers satisfying\n\\[ x_1 + x_2 +  \\dots + x_n = 0\n  \\quad\\text{and}\\quad x_1^2 + x_2^2 + \\dots + x_n^2 = 1. \\]\nFor each subset $A\\subseteq\\{1, 2, \\dots, n\\}$, define $S_A=\\sum_{i\\in A} x_i$.\n(If $A$ is the empty set, then $S_A=0$.)\nProve that for any positive number $\\lambda$,\nthe number of sets $A$ satisfying $S_A\\geq\\lambda$ is at most $2^{n-3}/\\lambda^2$.\nFor which choices of $x_1$, $x_2$, \\dots, $x_n$, $\\lambda$ does equality hold?", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2670037}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFor integer $n \\ge 2$,\nlet $x_1$, $x_2$, \\dots, $x_n$ be real numbers satisfying\n\\[ x_1 + x_2 +  \\dots + x_n = 0\n  \\quad\\text{and}\\quad x_1^2 + x_2^2 + \\dots + x_n^2 = 1. \\]\nFor each subset $A\\subseteq\\{1, 2, \\dots, n\\}$, define $S_A=\\sum_{i\\in A} x_i$.\n(If $A$ is the empty set, then $S_A=0$.)\nProve that for any positive number $\\lambda$,\nthe number of sets $A$ satisfying $S_A\\geq\\lambda$ is at most $2^{n-3}/\\lambda^2$.\nFor which choices of $x_1$, $x_2$, \\dots, $x_n$, $\\lambda$ does equality hold?\n\\end{mdframed}\nLet $\\eps_i$ be a coin flip of $0$ or $1$.\nThen we have\n\\begin{align*} \\mathbb E[S_A^2]\n  &= \\mathbb E\\left[ \\left( \\sum \\eps_i x_i \\right)^2 \\right]\n  = \\sum_i \\mathbb E[\\eps_i^2] x_i^2\n  + \\sum_{i < j} \\mathbb E[\\eps_i\\eps_j] 2x_i x_j \\\\\n  &= \\half \\sum x_i^2 + \\half \\sum x_i x_j\n  = \\half + \\half \\sum_{i<j} x_i x_j\n  = \\half + \\half \\left( -\\half \\right) = \\frac 14.\n\\end{align*}\nIn other words, $\\sum_A S_A^2 = 2^{n-2}$.\nSince can always pair $A$ with its complement, we conclude\n\\[ \\sum_{S_A > 0} S_A^2 = 2^{n-3}. \\]\n\nEquality holds iff $S_A \\in \\{\\pm \\lambda, 0\\}$ for every $A$.\nThis occurs when $x_1 = 1/\\sqrt2$, $x_2 = -1/\\sqrt2$,\n$x_3 = \\dots = 0$ (or permutations), and $\\lambda = 1/\\sqrt2$.\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "USAMO", "year": 2012}
{"id": "putnam-2012-a1", "question": "Let $d_1, d_2, \\dots, d_{12}$ be real numbers in the open\ninterval $(1, 12)$. Show that there exist distinct indices $i, j, k$\nsuch that $d_i, d_j, d_k$ are the side lengths of an acute triangle.", "solution": "Without loss of generality, assume $d_1\\leq d_2\\leq \\cdots \\leq d_{12}$.\nIf $d_{i+2}^2 < d_i^2+d_{i+1}^2$ for some $i\\leq 10$, then\n$d_i,d_{i+1},d_{i+2}$ are the side lengths of an acute triangle, since\nin this case $d_i^2 < d_{i+1}^2+d_{i+2}^2$ and $d_{i+1}^2 <\nd_i^2+d_{i+2}^2$ as well. Thus we may assume $d_{i+2}^2 \\geq d_i^2 +\nd_{i+1}^2$ for all $i$. But then by induction, $d_i^2 \\geq F_i d_1^2$\nfor all $i$, where $F_i$ is the $i$-th Fibonacci number (with\n$F_1=F_2=1$): $i=1$ is clear, $i=2$ follows from $d_2\\geq d_1$, and the\ninduction step follows from the assumed inequality. Setting $i=12$ now\ngives $d_{12}^2 \\geq 144 d_1^2$, contradicting $d_1>1$ and $d_{12}<12$.\n\n\\noindent\n\\textbf{Remark.} A materially equivalent problem appeared on the 2012\nUSA Mathematical Olympiad and USA Junior Mathematical Olympiad.", "category": "Geometry", "source": "PUTNAM", "year": 2012}
{"id": "putnam-2012-a2", "question": "Let $*$ be a commutative and associative binary operation on a set $S$. Assume that for every $x$\nand $y$ in $S$, there exists $z$ in $S$ such that $x * z = y$. (This $z$ may depend on $x$ and $y$.)\nShow that if $a,b,c$ are in $S$ and $a*c = b*c$, then $a=b$.", "solution": "Write $d$ for $a * c = b * c \\in S$. For some $e\\in S$, $d * e = a$, and\nthus for $f = c * e$, $a * f = a * c * e = d * e = a$ and $b * f = b * c\n* e = d * e = a$. Let $g \\in S$ satisfy $g * a = b$; then $b = g * a = g\n* (a * f) = (g * a) * f = b * f = a$, as desired.\n\n\\noindent\n\\textbf{Remark.} With slightly more work, one can show that $S$ forms an abelian group\nwith the operation $*$.", "category": "Algebra", "source": "PUTNAM", "year": 2012}
{"id": "putnam-2012-a3", "question": "Let $f: [-1, 1] \\to \\RR$ be a continuous function such that\n\\begin{itemize}", "solution": "We will prove that $f(x) = \\sqrt{1-x^2}$ for all $x \\in [-1,1]$. Define\n$g :\\thinspace (-1,1) \\to \\mathbb{R}$ by\n$g(x) = f(x)/\\sqrt{1-x^2}$. Plugging $f(x) = g(x)\\sqrt{1-x^2}$ into\nequation (i) and simplifying yields\n\\begin{equation} \\label{eq:g}\ng(x) = g\\left(\\frac{x^2}{2-x^2}\\right)\n\\end{equation}\n  for all $x \\in (-1,1)$. Now fix $x \\in (-1,1)$ and define a sequence\n$\\{a_n\\}_{n=1}^\\infty$ by $a_1=x$ and $a_{n+1} = \\frac{a_n^2}{2-a_n^2}$.\nThen\n  $a_n \\in (-1,1)$ and thus $|a_{n+1}| \\leq |a_n|^2$ for all $n$. It\nfollows that $\\{|a_n|\\}$ is a decreasing sequence with $|a_n| \\leq\n|x|^n$ for all $n$, and so $\\lim_{n\\to\\infty} a_n = 0$. Since $g(a_n) =\ng(x)$ for all $n$ by \\eqref{eq:g} and $g$ is continuous at $0$, we\nconclude that $g(x) = g(0) = f(0) = 1$. This holds for all $x \\in\n(-1,1)$ and thus for $x=\\pm 1$ as well by continuity. The result follows.\n\n\\noindent\n\\textbf{Remark.} As pointed out by Noam Elkies, condition (iii) is unnecessary.\nHowever, one can use it to derive a slightly different solution by running the recursion\nin the opposite direction.", "category": "Geometry", "source": "PUTNAM", "year": 2012}
{"id": "putnam-2012-a4", "question": "Let $q$ and $r$ be integers with $q > 0$, and let $A$ and $B$ be intervals on the real line.\nLet $T$ be the set of all $b+mq$ where $b$ and $m$ are integers with $b$ in $B$,\nand let $S$ be the set of all integers $a$ in $A$ such that $ra$ is in $T$. Show that if the\nproduct of the lengths of $A$ and $B$ is less than $q$, then $S$ is the intersection of $A$\nwith some arithmetic progression.", "solution": "We begin with an easy lemma.\n\\setcounter{lemma}{0}\n\\begin{lemma*}\nLet $S$ be a finite set of integers with the following property: for all $a,b,c \\in S$ with\n$a \\leq b \\leq c$, we also have $a+c-b \\in S$. Then $S$ is an arithmetic progression.\n\\end{lemma*}\n\\begin{proof}\nWe may assume $\\# S \\geq 3$, as otherwise $S$ is trivially an arithmetic progression.\nLet $a_1, a_2$ be the smallest and second-smallest elements of $S$, respectively, and put\n$d = a_2 - a_1$. Let $m$ be the smallest positive integer such that $a_1 + md \\notin S$.\nSuppose that there exists an integer $n$ contained in $S$ but not in\n$\\{a_1, a_1 + d, \\dots, a_1 + (m-1)d\\}$, and choose the least such $n$.\nBy the hypothesis applied with $(a,b,c) = (a_1, a_2, n)$, we see that $n-d$ also has the property,\na contradiction.\n\\end{proof}\n\nWe now return to the original problem.\nBy dividing $B, q, r$ by $\\gcd(q,r)$ if necessary, we may reduce to the case where $\\gcd(q,r) = 1$.\nWe may assume $\\#S \\geq 3$, as otherwise $S$ is trivially an arithmetic progression.\nLet $a_1, a_2, a_3$ be any three distinct elements of $S$, labeled so that $a_1 < a_2 < a_3$,\nand write $ra_i = b_i + m_i q$ with $b_i, m_i \\in \\ZZ$ and $b_i \\in B$. Note that $b_1, b_2, b_3$ must also be distinct, so the differences $b_2 - b_1, b_3 - b_1, b_3 - b_2$ are all nonzero; consequently, two of them have the same sign. If $b_i - b_j$ and $b_k - b_l$ have the same sign, then\nwe must have\n\\[\n(a_i - a_j)(b_k - b_l) =  (b_i - b_j)(a_k - a_l)\n\\]\nbecause both sides are of the same sign, of absolute value less than $q$,\nand congruent to each other modulo $q$. In other words, the points $(a_1, b_1), (a_2, b_2), (a_3, b_3)$\nin $\\RR^2$ are collinear.\nIt follows that $a_4 = a_1 + a_3 - a_2$ also belongs to $S$ (by taking $b_4 = b_1 + b_3 - b_2$),\nso $S$ satisfies the conditions of the lemma. It is therefore an\narithmetic progression.\n\n\\noindent\n\\textbf{Reinterpretations.}\nOne can also interpret this argument geometrically using cross products (suggested by Noam Elkies),\nor directly in terms of congruences (suggested by Karl Mahlburg).\n\n\\noindent\n\\textbf{Remark.} The problem phrasing is somewhat confusing: to say that ``$S$ is the intersection of\n[the interval] $A$ with an arithmetic progression'' is the same thing as saying that ``$S$ is the empty set or an arithmetic progression'' unless it is implied that arithmetic progressions are necessarily infinite.\nUnder that interpretation, however, the problem becomes false; for instance, for\n\\[\nq=5, r=1, A = [1,3], B = [0,2],\n\\]\nwe have\n\\[\nT = \\{\\cdots, 0,1,2,5,6,7,\\dots\\}, S = \\{1,2\\}.\n\\]", "category": "Number Theory", "source": "PUTNAM", "year": 2012}
{"id": "putnam-2012-a5", "question": "Let $\\FF_p$ denote the field of integers modulo a prime $p$, and let $n$ be a positive integer.\nLet $v$ be a fixed vector in $\\FF_p^n$, let $M$ be an $n \\times n$ matrix with entries of $\\FF_p$,\nand define $G: \\FF_p^n \\to \\FF_p^n$ by $G(x) = v + Mx$. Let $G^{(k)}$ denote the $k$-fold\ncomposition of $G$ with itself, that is, $G^{(1)}(x) = G(x)$ and $G^{(k+1)}(x) = G(G^{(k)}(x))$.\nDetermine all pairs $p, n$ for which there exist $v$ and $M$ such that the $p^n$ vectors\n$G^{(k)}(0)$, $k=1,2,\\dots,p^n$ are distinct.", "solution": "The pairs $(p,n)$ with the specified property are those pairs with $n=1$, together with the single pair\n$(2,2)$. We first check that these do work. For $n=1$, it is clear that taking $v = (1)$ and $M = (0)$\nhas the desired effect. For $(p,n) = (2,2)$, we take $v = \\begin{pmatrix} 0 & 1 \\end{pmatrix}$\nand $M = \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix}$ and then observe that\n\\[\nG^{(k)}(0) = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix},\n\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix},\n\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix},\n\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\,\nk=0,1,2,3.\n\\]\nWe next check that no other pairs work, keeping in mind that the desired condition means that\n$G$ acts on $\\FF_p^n$ as a cyclic permutation. Assume by way of contradiction that $(p,n)$ has the desired\nproperty but does not appear in our list. In particular, we have $n \\geq 2$.\n\nLet $I$ be the $n \\times n$ identity matrix over $\\FF_p$.\nDecompose $\\FF_p^n$ as a direct sum of two subspaces $V,W$ such that\n$M-I$ is nilpotent on $V$ and invertible on $W$. Suppose that $W \\neq 0$.\nSplit $v$ as $v_1 + v_2$ with $v_1 \\in V$, $v_2 \\in W$. Since $M-I$ is invertible on $W$, there exists a\nunique $w \\in W$ such that $(M-I)w = -v_2$. Then $G^{(k)}(w) - w \\in V$ for all nonnegative integers $k$.\nLet $k$ be the least positive integer such that $G^{(k)}(w) = w$; then $k$ is at most the cardinality of $V$,\nwhich is strictly less than $p^n$ because $W \\neq 0$. This gives a contradiction and thus forces $W = 0$.\n\nIn other words, the matrix $N = M-I$ is nilpotent; consequently, $N^n = 0$.\nFor any positive integer $k$, we have\n\\begin{align*}\nG^{(k)}(0) &= v + Mv + \\cdots + M^{k-1}v \\\\\n&=  \\sum_{j=0}^{k-1}  \\sum_{i=0}^{n-1} \\binom{j}{i} N^i v \\\\\n&= \\sum_{i=0}^{n-1} \\binom{k}{i+1} N^i v.\n\\end{align*}\nIf $n \\geq 2$ and $(p,n) \\neq (2,2)$, then $p^{n-1} > n$ and so $G^{k}(0) = 0$ for $k = p^{n-1}$ (because all\nof the binomial coefficients are divisible by $p$). This contradiction\ncompletes the proof.", "category": "Algebra", "source": "PUTNAM", "year": 2012}
{"id": "putnam-2012-a6", "question": "Let $f(x,y)$ be a continuous, real-valued function on $\\RR^2$. Suppose that, for every\nrectangular region $R$ of area $1$, the double integral of $f(x,y)$ over $R$ equals $0$.\nMust $f(x,y)$ be identically 0?", "solution": "\\textbf{First solution.}\nYes, $f(x,y)$ must be identically 0. We proceed using a series of lemmas.\n\n\\setcounter{lemma}{0}\n\\begin{lemma}\nLet $R$ be a rectangular region of area $1$ with corners $A,B,C,D$ labeled in counterclockwise order. Then\n$f(A) + f(C) = f(B) + f(D)$.\n\\end{lemma}\n\\begin{proof}\nWe may choose coordinates so that for some $c>0$,\n\\[\nA = (0,0), B = (c,0), C = (c,1/c), D = (0, 1/c).\n\\]\nDefine the functions\n\\begin{align*}\ng(x,y) &= \\int_x^{x+c} f(t,y)\\,dt \\\\\nh(x,y) &= \\int_0^y g(x,u)\\,du.\n\\end{align*}\nFor any $x,y \\in \\RR$,\n\\[\nh(x,y+1/c) - h(x,y) = \\int_x^{x+c} \\int_y^{y+1/c} f(t,u)\\,dt\\,du = 0\n\\]\nby hypothesis, so $h(x,y+1/c) = h(x,y)$. By the fundamental theorem of calculus,\nwe may differentiate both sides of this identity with respect to $y$ to deduce that\n$g(x,y+1/c) = g(x,y)$. Differentiating this new identity with respect to $x$ yields the desired equality.\n\\end{proof}\n\n\\begin{lemma}\nLet $C$ be a circle whose diameter $d$ is at least $\\sqrt{2}$, and let $AB$ and $A'B'$ be two diameters of $C$. Then\n$f(A) + f(B) = f(A') + f(B')$.\n\\end{lemma}\n\\begin{proof}\nBy continuity, it suffices to check the case where $\\alpha = \\arcsin \\frac{2}{d^2}$\nis an irrational multiple of $2\\pi$.\nLet $\\beta$ be the radian measure of the counterclockwise arc from $A$ to $A'$.\nBy Lemma~1, the claim holds when $\\beta = \\alpha$. By induction, the claim also holds when $\\beta \\equiv n\\alpha\n\\pmod{2\\pi}$ for any positive integer $n$. Since $\\alpha$ is an irrational multiple of $2\\pi$, the positive multiples of $\\alpha$ fill out a dense subset of the real numbers modulo $2\\pi$,\nso by continuity the claim holds for all $\\beta$.\n\\end{proof}\n\n\\begin{lemma}\nLet $R$ be a rectangular region of arbitrary (positive) area with corners $A,B,C,D$ labeled in counterclockwise order. Then\n$f(A) + f(C) = f(B) + f(D)$.\n\\end{lemma}\n\\begin{proof}\nLet $EF$ be a segment such that $AEFD$ and $BEFC$ are rectangles whose diagonals have length at least $\\sqrt{2}$. By Lemma~2,\n\\begin{align*}\nf(A) + f(F) &= f(D) + f(E) \\\\\nf(C) + f(E) &= f(B) + f(F),\n\\end{align*}\nyielding the claim.\n\\end{proof}\n\n\\begin{lemma}\nThe restriction of $f$ to any straight line is constant.\n\\end{lemma}\n\\begin{proof}\nWe may choose coordinates so that the line in question is the $x$-axis.\nDefine the function $g(y)$ by\n\\[\ng(y) = f(0,y) - f(0,0).\n\\]\nBy Lemma~3, for all $x \\in \\RR$,\n\\[\nf(x,y) = f(x,0) + g(y).\n\\]\nFor any $c>0$, by the original hypothesis we have\n\\begin{align*}\n0 &= \\int_x^{x+c} \\int_y^{y+1/c} f(u,v)\\,du\\,dv \\\\\n&= \\int_x^{x+c} \\int_y^{y+1/c} (f(u,0) + g(v))\\,du\\,dv \\\\\n&= \\frac{1}{c} \\int_x^{x+c} f(u,0)\\,du + c \\int_y^{y+1/c} g(v)\\,dv.\n\\end{align*}\nIn particular, the function $F(x) = \\int_x^{x+c} f(u,0)\\,du$ is constant.\nBy the fundamental theorem of calculus, we may differentiate to conclude that\n$f(x+c,0) = f(x,0)$ for all $x \\in \\RR$. Since $c$ was also arbitrary, we deduce the claim.\n\\end{proof}\n\nTo complete the proof, note that\nsince any two points in $\\RR^2$ are joined by a straight line, Lemma~4 implies that $f$ is constant.\nThis constant equals the integral of $f$ over any rectangular region of area 1, and hence must be 0\nas desired.\n\n\\noindent\n\\textbf{Second solution} (by Eric Larson, communicated by Noam Elkies).\nIn this solution, we fix coordinates and\nassume only that the double integral vanishes on each rectangular region of area 1\nwith sides parallel to the coordinate axes, and still conclude that $f$ must be identically 0.\n\n\\setcounter{lemma}{0}\n\\begin{lemma*}\nLet $R$ be a rectangular region of area $1$ with sides parallel to the coordinate axes.\nThen the averages of $f$ over any two adjacent sides of $R$ are equal.\n\\end{lemma*}\n\\begin{proof}\nWithout loss of generality, we may take $R$ to have corners $(0, 0), (c,0), (c,1/c), (0,1/c)$ and consider\nthe two sides adjacent to $(c,1/c)$. Differentiate the equality\n\\[\n0 = \\int_x^{x+c} \\int_y^{y+1/c} f(u,v)\\,du\\,dv\n\\]\nwith respect to $c$ to obtain\n\\[\n0 = \\int_y^{y+1/c} f(x+c,v)\\,dv - \\frac{1}{c^2} \\int_x^{x+c} f(u,y+1/c)\\,du.\n\\]\nRearranging yields\n\\[\nc \\int_y^{y+1/c} f(x+c,v)\\,dv = \\frac{1}{c} \\int_x^{x+c} f(u,y+1/c)\\,du,\n\\]\nwhich asserts the desired result.\n\\end{proof}\n\nReturning to the original problem, given any $c>0$, we can tile the plane with rectangles of area 1 whose\nvertices lie in the lattice $\\{(mc, n/c): m,n \\in \\ZZ\\}$. By repeated application of the lemma,\nwe deduce that for any positive integer $n$,\n\\[\n\\int_0^c f(u,0)\\,du = \\int_{nc}^{(n+1)c} f(u,0)\\,du.\n\\]\nReplacing $c$ with $c/n$, we obtain\n\\[\n\\int_0^{c/n} f(u,0)\\,du = \\int_{c}^{c+1/n} f(u,0)\\,du.\n\\]\nFixing $c$ and taking the limit as $n \\to \\infty$ yields $f(0,0) = f(c,0)$. By similar reasoning,\n$f$ is constant on any horizontal line and on any vertical line, and as in the first solution the constant\nvalue is forced to equal 0.\n\n\\noindent\n\\textbf{Third solution.} (by Sergei Artamoshin) We retain the weaker hypothesis of the second solution. Assume by way of contradiction that $f$ is not identically zero.\n\nWe first exhibit a vertical segment $PQ$ with $f(P) > 0$ and $f(Q) < 0$.\nIt cannot be the case that $f(P) \\leq 0$ for all $P$, as otherwise the vanishing of the zero over any rectangle would force $f$ to vanish identically. By continuity, there must exist an open disc $U$ such that $f(P) > 0$ for all $P \\in U$. Choose a rectangle $R$ of area $1$ with sides parallel to the coordinate axes with one horizontal edge contained in $U$. Since the integral of $f$ over $R$ is zero, there must exist a point $Q \\in R$ such that $f(Q) < 0$. Take $P$ to be the vertical projection of $Q$ onto the edge of $R$ contained in $U$.\n\nBy translating coordinates, we may assume that $P = (0,0)$ and\n$Q = (0,a)$ for some $a>0$.\nFor $s$ sufficiently small, $f$ is positive on the square of side length $2s$ centered at $P$, which we call $S$, and negative on the square of side length $2s$ centered at $Q$, which we call $S'$. Since the ratio $2s/(1-4s^2)$ tends to 0 as $s$ does, we can choose $s$ so that\n$2s/(1-4s^2) = a/n$ for some positive integer $n$.\n\nFor $i \\in \\ZZ$, let $A_i$ be the rectangle\n\\begin{multline*}\n\\left\\{(x,y): s \\leq x \\leq s + \\frac{1-4s^2}{2s},\\right. \\\\\n\\qquad \\left. -s+i \\frac{2s}{1-4s^2} \\leq y \\leq s + i \\frac{2s}{1-4s^2} \\right\\}\n\\end{multline*}\nand let $B_i$ be the rectangle\n\\begin{multline*}\n\\left\\{(x,y): s \\leq x \\leq s + \\frac{1-4s^2}{2s}, \\right.  \\\\\n\\qquad \\left. s+i \\frac{2s}{1-4s^2} \\leq y \\leq -s + (i+1) \\frac{2s}{1-4s^2} \\right\\}.\n\\end{multline*}\nThen for all $i \\in \\ZZ$,\n\\[\nS \\cup A_0, A_n \\cup S', A_i \\cup B_i, B_i \\cup A_{i+1}\n\\]\nare all rectangles of area 1 with sides parallel to the coordinate axes,\nso the integral over $f$ over each of these rectangles is zero.\nSince the integral over $S$ is positive, the integral over $A_0$ must be negative; by induction, for all $i \\in \\ZZ$ the integral over $A_i$ is negative and the integral over $B_i$ is positive. But this forces the integral over $S'$ to be positive whereas $f$ is negative everywhere on $S'$, a contradiction.", "category": "Geometry", "source": "PUTNAM", "year": 2012}
{"id": "putnam-2012-b1", "question": "Let $S$ be a class of functions from $[0, \\infty)$ to $[0, \\infty)$ that satisfies:\n\\begin{itemize}", "solution": "Each of the following functions belongs to $S$ for the reasons indicated.\n\\begin{center}\n\\begin{tabular}{ll}\n$f(x), g(x)$ & given \\\\\n$\\ln(x+1)$ & (i) \\\\\n$\\ln(f(x)+1), \\ln(g(x)+1)$ & (ii) plus two previous lines\\\\\n$\\ln(f(x)+1) + \\ln(g(x)+1)$ & (ii) \\\\\n$e^x - 1$ & (i) \\\\\n$(f(x)+1)(g(x)+1) - 1$ & (ii) plus two previous lines \\\\\n$f(x)g(x) + f(x) + g(x)$ & previous line \\\\\n$f(x) + g(x)$ & (ii) plus first line \\\\\n$f(x) g(x)$ & (iii) plus two previous lines\n\\end{tabular}\n\\end{center}", "category": "Combinatorics", "source": "PUTNAM", "year": 2012}
{"id": "putnam-2012-b2", "question": "Let $P$ be a given (non-degenerate) polyhedron. Prove that there is a constant $c(P) > 0$\nwith the following property: If a collection of $n$ balls whose volumes sum to $V$ contains\nthe entire surface of $P$, then $n > c(P) / V^2$.", "solution": "Fix a face $F$ of the polyhedron with area $A$. Suppose $F$ is completely covered by balls of radii\n$r_1, \\dots, r_n$ whose volumes sum to $V$. Then on one hand,\n\\[\n\\sum_{i=1}^n \\frac{4}{3} \\pi r_i^3 = V.\n\\]\nOn the other hand, the intersection of a ball of radius $r$ with the plane containing $F$ is a\ndisc of radius at most $r$, which covers a piece of $F$ of area at most $\\pi r^2$; therefore\n\\[\n\\sum_{i=1}^n \\pi r_i^2 \\geq A.\n\\]\nBy writing $n$ as $\\sum_{i=1}^n 1$ and applying H\\\"older's inequality,\nwe obtain\n\\[\nn V^2 \\geq \\left( \\sum_{i=1}^n \\left( \\frac{4}{3} \\pi r_i^3 \\right)^{2/3} \\right)^3\n\\geq \\frac{16}{9\\pi} A^3.\n\\]\nConsequently, any value of $c(P)$ less than $\\frac{16}{9\\pi} A^3$ works.", "category": "Geometry", "source": "PUTNAM", "year": 2012}
{"id": "putnam-2012-b3", "question": "A round-robin tournament of $2n$ teams lasted for $2n-1$ days, as follows.\nOn each day, every team played one game against another team, with one team winning\nand one team losing in each of the $n$ games. Over the course of the tournament,\neach team played every other team exactly once. Can one necessarily choose\none winning team from each day without choosing any team more than once?", "solution": "The answer is yes. We first note that for any collection of $m$\ndays with $1\\leq m\\leq 2n-1$, there are at least $m$ distinct teams that\nwon a game on at least one of those days. If not, then any of the teams\nthat lost games on all of those days must in particular have lost to $m$\nother teams, a contradiction.\n\nIf we now construct a bipartite graph whose vertices are the $2n$ teams\nand the $2n-1$ days, with an edge linking a day to a team if that team\nwon their game on that day, then any collection of $m$ days is connected\nto a total of at least $m$ teams. It follows from Hall's Marriage Theorem\nthat one can match the $2n-1$ days with $2n-1$ distinct teams that won on\ntheir respective days, as desired.", "category": "Combinatorics", "source": "PUTNAM", "year": 2012}
{"id": "putnam-2012-b4", "question": "Suppose that $a_0 = 1$ and that $a_{n+1} = a_n + e^{-a_n}$ for $n=0,1,2,\\dots$. Does $a_n - \\log n$\nhave a finite limit as $n \\to \\infty$? (Here $\\log n = \\log_e n = \\ln n$.)", "solution": "\\textbf{First solution.}\nWe will show that the answer is yes. First note that for all $x>-1$,\n$e^x \\geq 1+x$ and thus\n\\begin{equation} \\label{eq:log}\nx \\geq \\log(1+x).\n\\end{equation}\nWe next claim that $a_n > \\log(n+1)$ (and in particular that $a_n-\\log\nn > 0$) for all $n$, by induction on $n$. For $n=0$ this follows\nfrom $a_0=1$. Now suppose that $a_n > \\log(n+1)$, and define $f(x)\n= x+e^{-x}$, which is an increasing function in $x>0$; then\n\\begin{align*}\na_{n+1} &= f(a_n) > f(\\log(n+1)) \\\\\n&= \\log(n+1) + 1/(n+1) \\geq \\log(n+2),\n\\end{align*}\nwhere the last inequality is \\eqref{eq:log} with $x=1/(n+1)$. This completes\nthe induction step.\n\nIt follows that $a_n-\\log n$ is a decreasing function in $n$: we have\n\\begin{align*}\n&(a_{n+1} - \\log(n+1)) - (a_n - \\log n) \\\\\n&\\,= e^{-a_n} + \\log(n/(n+1)) \\\\\n&\\,< 1/(n+1) + \\log(n/(n+1)) \\leq 0,\n\\end{align*}\nwhere the final inequality is \\eqref{eq:log} with $x = -1/(n+1)$. Thus\n$\\{a_n-\\log n\\}_{n=0}^\\infty$ is a decreasing sequence of positive numbers,\nand so it has a limit as $n\\to\\infty$.\n\n\\noindent\n\\textbf{Second solution.}\nPut $b_n = e^{a_n}$, so that $b_{n+1} = b_n e^{1/b_n}$.  In terms of the\n$b_n$, the problem is to prove that $b_n/n$ has a limit as $n \\to \\infty$;\nwe will show that the limit is in fact equal to 1.\n\nExpanding $e^{1/b_n}$ as a Taylor series in $1/b_n$, we have\n\\[\nb_{n+1} = b_n + 1 + R_n\n\\]\nwhere $0 \\leq R_n \\leq c/b_n$ for some absolute constant $c>0$.\nBy writing\n\\[\nb_n = n+e + \\sum_{i=0}^{n-1} R_i,\n\\]\nwe see first that $b_n \\geq n+e$. We then see that\n\\begin{align*}\n0 &\\leq \\frac{b_n}{n} - 1 \\\\\n&\\leq \\frac{e}{n} + \\sum_{i=0}^{n-1} \\frac{R_i}{n}  \\\\\n&\\leq \\frac{e}{n} + \\sum_{i=0}^{n-1} \\frac{c}{n b_i}  \\\\\n&\\leq \\frac{e}{n} + \\sum_{i=0}^{n-1} \\frac{c}{n (i+e)}  \\\\\n&\\leq \\frac{e}{n} + \\frac{c \\log n}{n}.\n\\end{align*}\nIt follows that $b_n/n \\to 1$ as $n \\to \\infty$.\n\n\\noindent\n\\textbf{Remark.}\nThis problem is an example of the general principle that one can often predict the asymptotic behavior of a recursive\nsequence by studying solutions of a sufficiently similar-looking differential equation. In this case, we\nstart with the equation $a_{n+1} - a_n = e^{-a_n}$, then replace $a_n$ with a function $y(x)$\nand replace the difference $a_{n+1} - a_n$ with the derivative $y'(x)$ to obtain the differential equation\n$y' = e^{-y}$, which indeed has the solution $y = \\log x$.", "category": "Number Theory", "source": "PUTNAM", "year": 2012}
{"id": "putnam-2012-b5", "question": "Prove that, for any two bounded functions $g_1, g_2: \\RR \\to [1, \\infty)$,\nthere exist functions $h_1, h_2: \\RR \\to \\RR$ such that, for every $x \\in \\RR$,\n\\[\n\\sup_{s \\in \\RR} (g_1(s)^x g_2(s))  = \\max_{t \\in \\RR} (x h_1(t) + h_2(t)).\n\\]", "solution": "Define the function\n\\[\nf(x) = \\sup_{s \\in \\RR} \\{x \\log g_1(s) + \\log g_2(s)\\}.\n\\]\nAs a function of $x$, $f$ is the supremum of a collection of affine functions, so it is convex.\nThe function $e^{f(x)}$ is then also convex, as may be checked directly from the definition:\nfor $x_1, x_2 \\in \\RR$ and $t \\in [0,1]$, by the weighted AM-GM inequality\n\\begin{align*}\nt e^{f(x_1)} + (1-t) e^{f(x_2)}&\\geq e^{t f(x_1) + (1-t)f(x_2)} \\\\\n&\\geq e^{f(t x_1 + (1-t)x_2)}.\n\\end{align*}\nFor each $t \\in \\RR$, draw a supporting line to the graph of $e^{f(x)}$ at $x=t$;\nit has the form $y = x h_1(t) + h_2(t)$ for some $h_1(t), h_2(t) \\in \\RR$. For all $x$, we then have\n\\[\n\\sup_{s \\in \\RR} \\{g_1(s)^x g_2(s) \\} \\geq x h_1(t) + h_2(t)\n\\]\nwith equality for $x = t$. This proves the desired equality (including the fact that the maximum on the right side is achieved).\n\n\\noindent\n\\textbf{Remark.}\nThis problem demonstrates an example of \\emph{duality} for convex functions.", "category": "Algebra", "source": "PUTNAM", "year": 2012}
{"id": "putnam-2012-b6", "question": "Let $p$ be an odd prime number such that $p \\equiv 2 \\pmod{3}$. Define a permutation $\\pi$ of the\nresidue classes modulo $p$ by $\\pi(x) \\equiv x^3 \\pmod{p}$. Show that $\\pi$ is an even permutation\nif and only if $p \\equiv 3 \\pmod{4}$.\n\n\\end{itemize}\n\n\\end{document}", "solution": "\\textbf{First solution.}\nSince fixed points do not affect the signature of a permutation, we may\nignore the residue class of $0$ and consider $\\pi$ as a permutation on the\nnonzero residue classes modulo $p$. These form a cyclic group of order $p-1$,\nso the signature of $\\pi$ is also the signature of multiplication by 3 as\na permutation $\\sigma$ of the residue classes modulo $p-1$. If we identify\nthese classes with the integers $0,\\dots,p-2$, then the signature equals\nthe parity of the number of \\emph{inversions}: these are the pairs $(i,j)$\nwith $0 \\leq i < j \\leq p-2$ for which $\\sigma(i) > \\sigma(j)$. We may write\n\\[\n\\sigma(i) = 3i - (p-1) \\left\\lfloor \\frac{3i}{p-1} \\right\\rfloor\n\\]\nfrom which we see that $(i,j)$ cannot be an inversion unless $\\lfloor \\frac{3j}{p-1} \\rfloor > \\lfloor \\frac{3i}{p-1} \\rfloor$. In particular, we only obtain inversions when $i < 2(p-1)/3$.\n\nIf $i < (p-1)/3$, the elements $j$ of $\\{0,\\dots,p-2\\}$ for which $(i,j)$ is an inversion correspond to the elements of $\\{0,\\dots,3i\\}$ which are not multiples of $3$, which are $2i$ in number.\nThis contributes a total of $0 + 2 + \\cdots + 2(p-2)/3 = (p-2)(p+1)/9$ inversions.\n\nIf $(p-1)/3 < i < 2(p-1)/3$, the elements $j$ of $\\{0,\\dots,p-2\\}$ for which $(i,j)$ is an inversion correspond\nto the elements of $\\{0, \\dots, 3i-p+1\\}$ congruent to 1 modulo 3, which are\n$(3i-p+2)/3 = i - (p-2)/3$ in number. This contributes a total of\n$1 + \\cdots + (p-2)/3 = (p-2)(p+1)/18$ inversions.\n\nSumming up, the total number of inversions is $(p-2)(p+1)/6$, which is even if and only if\n$p \\equiv 3 \\pmod{4}$. This proves the claim.\n\n\\noindent\n\\textbf{Second solution} (by Noam Elkies).\nRecall that the sign of $\\pi$ (which is $+1$ if $\\pi$ is even and $-1$ if $\\pi$ is odd)\ncan be computed as\n\\[\n\\prod_{0 \\leq x < y < p} \\frac{\\pi(x) - \\pi(y)}{x - y}\n\\]\n(because composing $\\pi$ with a transposition changes the sign of the product).\nReducing modulo $p$, we get a congruence with\n\\[\n\\prod_{0 \\leq x < y < p} \\frac{x^3-y^3}{x-y} = \\prod_{0 \\leq x < y < p} (x^2 + xy + y^2).\n\\]\nIt thus suffices to count the number of times each possible value of $x^2+xy+y^2$ occurs.\nEach nonzero value $c$ modulo $p$ occurs $p+1$ times as $x^2+xy+y^2$ with $0 \\leq x, y < p$\nand hence $(p + \\chi(c/3))/2$ times with $0 \\leq x < y < p$, where $\\chi$ denotes the quadratic character\nmodulo $p$. Since $p \\equiv 2 \\pmod{3}$, by the law of quadratic reciprocity we have\n$\\chi(-3) = +1$, so $\\chi(c/3) = \\chi(-c)$.\nIt thus remains to evaluate the product $\\prod_{c=1}^{p-1} c^{(p+\\chi(-c))/2}$ modulo $p$.\n\nIf $p \\equiv 3 \\pmod{4}$, this is easy: each factor is a quadratic residue (this is clear if $c$ is a residue,\nand otherwise $\\chi(-c) = +1$ so $p+\\chi(-c)$ is divisible by $4$) and $-1$ is not, so we must get $+1$\nmodulo $p$.\n\nIf $p \\equiv 1 \\pmod{4}$, we must do more work: we\nchoose a primitive root $g$ modulo $p$ and rewrite the product as\n\\[\n\\prod_{i=0}^{p-2} g^{i(p+(-1)^i)/2}.\n\\]\nThe sum of the exponents, split into sums over $i$ odd and $i$ even, gives\n\\[\n\\sum_{j=0}^{(p-3)/2} \\left( j(p+1) + \\frac{(2j+1)(p-1)}{2}\\right)\n\\]\nwhich simplifies to\n\\[\n\\frac{(p-3)(p-1)(p+1)}{8} + \\frac{(p-1)^3}{8} = \\frac{p-1}{2} \\left( \\frac{p^2 - 1}{2} - p \\right).\n\\]\nHence the product we are trying to evaluate is congruent to $g^{(p-1)/2} \\equiv -1$ modulo $p$.\n\n\\noindent\n\\textbf{Third solution} (by Mark van Hoeij).\nWe compute the parity of $\\pi$ as the parity of the number of cycles of even length\nin the cycle decomposition of $\\pi$.\nFor $x$ a nonzero residue class modulo $p$ of multiplicative order $d$, the elements of the orbit of $x$\nunder $\\pi$ also have order $d$ (because $d$ divides $p-1$ and hence is coprime to $3$). Since the group\nof nonzero residue classes modulo $p$ is cyclic of order $p-1$, the elements of order $d$ fall into\n$\\varphi(d)/f(d)$ orbits under $\\pi$, where $\\varphi$ is the Euler phi function and $f(d)$ is the\nmultiplicative order of 3 modulo $d$. The parity of $\\pi$ is then the parity of the sum of $\\varphi(d)/f(d)$\nover all divisors $d$ of $p-1$ for which $f(d)$ is even.\n\nIf $d$ is odd, then $\\varphi(d)/f(d) = \\varphi(2d)/f(2d)$, so the summands corresponding to $d$ and $2d$\ncoincide. It thus suffices to consider those $d$ divisible by $4$. If $p \\equiv 3 \\pmod{4}$, then there are no\nsuch summands, so the sum is trivially even.\n\nIf $p \\equiv 1 \\pmod{4}$, then $d=4$ contributes a summand of $\\varphi(4)/f(4) = 2/2 = 1$.\nFor each $d$ which is a larger multiple of 4, the group $(\\ZZ/d\\ZZ)^*$ is isomorphic to the product of\n$\\ZZ/2\\ZZ$ with another group of even order, so the maximal power of 2 dividing $f(d)$ is strictly smaller\nthan the maximal power of 2 dividing $d$. Hence $\\varphi(d)/f(d)$ is even, and so the overall sum is odd.\n\n\\noindent\n\\textbf{Remark.}\nNote that the second proof uses quadratic reciprocity, whereas the first and third proofs are similar to several classical\nproofs of quadratic reciprocity. Abhinav Kumar notes that the problem itself is a special case\nof the Duke-Hopkins quadratic reciprocity law for abelian groups (Quadratic reciprocity in a finite group,\n\\textit{Amer. Math. Monthly} \\textbf{112} (2005), 251--256; see also\n\\url{http://math.uga.edu/~pete/morequadrec.pdf}).\n\n\n\\end{itemize}\n\\end{document}", "category": "Number Theory", "source": "PUTNAM", "year": 2012}
{"id": "usamo-2003-q1", "question": "Prove that for every positive integer $n$\nthere exists an $n$-digit number divisible by $5^n$\nall of whose digits are odd.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p336189}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nProve that for every positive integer $n$\nthere exists an $n$-digit number divisible by $5^n$\nall of whose digits are odd.\n\\end{mdframed}\nThis is immediate by induction on $n$.\nFor $n = 1$ we take $5$;\nmoving forward if $M$ is a working $n$-digit number then exactly one of\n\\begin{align*}\n  N_1 &= 10^n + M \\\\\n  N_3 &= 3 \\cdot 10^n + M \\\\\n  N_5 &= 5 \\cdot 10^n + M \\\\\n  N_7 &= 7 \\cdot 10^n + M \\\\\n  N_9 &= 9 \\cdot 10^n + M\n\\end{align*}\nis divisible by $5^{n+1}$;\nas they are all divisible by $5^n$\nand $N_k/5^n$ are all distinct.\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 2003}
{"id": "usamo-2003-q2", "question": "A convex polygon $\\mathcal{P}$ in the plane\nis dissected into smaller convex polygons by\ndrawing all of its diagonals.\nThe lengths of all sides and all diagonals of the\npolygon $\\mathcal{P}$ are rational numbers.\nProve that the lengths of all sides of all polygons\nin the dissection are also rational numbers.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p336193}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA convex polygon $\\mathcal{P}$ in the plane\nis dissected into smaller convex polygons by\ndrawing all of its diagonals.\nThe lengths of all sides and all diagonals of the\npolygon $\\mathcal{P}$ are rational numbers.\nProve that the lengths of all sides of all polygons\nin the dissection are also rational numbers.\n\\end{mdframed}\nSuppose $AB$ is a side of a polygon in the dissection,\nlying on diagonal $XY$, with $X$, $A$, $B$, $Y$ in that order.\nThen \\[ AB = XY - XA - YB. \\]\nIn this way, we see that it actually just suffices to\nprove the result for a quadrilateral.\n\nWe present two approaches to this end.\n\n\\paragraph{First approach (trig).}\nConsider quadrilateral $ABCD$.\nThere are twelve angles one can obtain using three of its four vertices,\nthree at each vertex; denote this set of $12$ angles by $S$\nNote that:\n\\begin{itemize}\n  \\ii The law of cosines implies $\\cos \\theta \\in \\QQ$ for each $\\theta \\in S$.\n  \\ii Hence, $(\\sin \\theta)^2 \\in \\QQ$ for $\\theta \\in S$.\n  (This is because $\\sin\\theta^2+\\cos^2\\theta$.)\n\\end{itemize}\nWe say two angles $\\theta_1$ and $\\theta_2$ are\n\\emph{equivalent} if $\\frac{\\sin \\theta_1}{\\sin \\theta_2}$\nThis is the same as saying,\nwhen $\\sin\\theta_1$ and $\\sin\\theta_2$ are written in simplest radical form,\nthe part under the square root is the same.\n\nNow we contend:\n\\begin{claim*}\n  The angles $\\angle BAC$, $\\angle CAD$, $\\angle BAD$ are equivalent.\n\\end{claim*}\n\\begin{proof}\n  Note that\n  \\[ \\QQ \\ni \\cos(\\angle BAD) = \\cos \\angle BAC \\cos \\angle CAD - \\sin \\angle BAC \\sin \\angle CAD \\]\n  so $\\angle BAC$ and $\\angle CAD$ are equivalent.\n  Then\n  \\[ \\sin (\\angle BAD) = \\sin \\angle BAC \\cos \\angle CAD + \\cos \\angle BAC \\sin \\angle CAD \\]\n  implies $\\angle BAD$ is equivalent to those two.\n\\end{proof}\n\n\\begin{claim*}\n  The angles $\\angle BAD$, $\\angle DBA$, $\\angle ADB$ are equivalent.\n\\end{claim*}\n\\begin{proof}\n  Law of sines on $\\triangle BAD$.\n\\end{proof}\n\nIterating the argument implies that all angles are equivalent.\n\nNow, if $AB$ and $CD$ meet at $E$,\nthe law of sines on $\\triangle AEB$, etc.\\ implies the result.\n\n\\paragraph{Second approach (barycentric coordinates).}\nTo do this, we apply barycentric coordinates.\nConsider quadrilateral $ABDC$\n(note the changed order of vertices),\nwith $A=(1,0,0)$, $B=(0,1,0)$, $C=(0,0,1)$.\nLet $D = (x,y,z)$, with $x+y+z=1$.\nBy hypothesis, each of the numbers\n\\begin{align*}\n  -a^2yz + b^2(1-x)z + c^2(1-x)y &= AD^2 \\\\\n  a^2(1-y)z + b^2zx + c^2(1-y)x &= BD^2 \\\\\n  -a^2(1-z)y - b^2(1-z)x + c^2xy &= CD^2\n\\end{align*}\nis rational. Let $W = a^2yz + b^2zx + c^2xy$. Then,\n\\begin{align*}\n  b^2z + c^2y &=  AD^2 + W \\\\\n  a^2z + c^2x &= BD^2 + W \\\\\n  a^2y + b^2x &= CD^2 + W.\n\\end{align*}\nThis implies that $AD^2 + BD^2 + 2W - c^2 = 2S_C z$ and cyclically\n(as usual $2S_C = a^2+b^2-c^2$).\nIf any of $S_A$, $S_B$, $S_C$ are zero, then we deduce $W$ is rational.\nOtherwise, we have that\n\\[ 1 = x+y+z = \\sum_{\\text{cyc}} \\frac{AD^2 + BD^2 + 2W - c^2}{2S_C} \\]\nwhich implies that $W$ is rational,\nbecause it appears with coefficient\n$\\frac{1}{S_A} + \\frac{1}{S_B} + \\frac{1}{S_C} \\neq 0$\n(since $S_{BC} + S_{CA} + S_{AB}$ is actually the area of $ABC$).\n\nHence from the rationality of $W$,\nwe deduce that $x$ is rational as long as $S_A \\neq 0$,\nand similarly for the others.\nSo at most one of $x$, $y$, $z$ is irrational,\nbut since $x+y+z=1$ this implies they are all rational.\n\nFinally, if $P = \\ol{AD} \\cap \\ol{BC}$\nthen $AP = \\frac{1}{y+z} AD$, so $AP$ is rational too,\ncompleting the proof.\n\n\\begin{remark*}\n  After the reduction to quadrilateral,\n  a third alternate approach goes by quoting Putnam 2018 A6,\n  reproduced below:\n  \\begin{quote}\n  Four points are given in the plane, with no three collinear,\n  such that the squares of the $\\binom42=6$ pairwise distances are all rational.\n  Show that the ratio of the areas between any two of the\n  $\\binom43=4$ triangles determined by these points is also rational.\n  \\end{quote}\n  If $ABCD$ is the quadrilateral,\n  the heights from $C$ and $D$ to $AB$ have rational ratio.\n  Letting $P = AC \\cap BD$,\n  we see $AP/AB$ can be shown as rational via coordinates, as needed.\n\\end{remark*}\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2003}
{"id": "usamo-2003-q3", "question": "Let $n$ be a positive integer.\nFor every sequence of integers\n\\[ A = (a_0, \\; a_1, \\; a_2, \\; \\dots, a_n) \\]\nsatisfying $0 \\le a_i \\le i$, for $i=0,\\dots,n$,\nwe define another sequence\n\\[ t(A)= (t(a_0), \\; t(a_1), \\; t(a_2), \\; \\dots, \\; t(a_n)) \\]\nby setting $t(a_i)$ to be the number of terms in the\nsequence $A$ that precede the term $a_i$ and are different from $a_i$.\nShow that, starting from any sequence $A$ as above,\nfewer than $n$ applications of the  transformation $t$\nlead to a sequence $B$ such that $t(B) = B$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p336202}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n$ be a positive integer.\nFor every sequence of integers\n\\[ A = (a_0, \\; a_1, \\; a_2, \\; \\dots, a_n) \\]\nsatisfying $0 \\le a_i \\le i$, for $i=0,\\dots,n$,\nwe define another sequence\n\\[ t(A)= (t(a_0), \\; t(a_1), \\; t(a_2), \\; \\dots, \\; t(a_n)) \\]\nby setting $t(a_i)$ to be the number of terms in the\nsequence $A$ that precede the term $a_i$ and are different from $a_i$.\nShow that, starting from any sequence $A$ as above,\nfewer than $n$ applications of the  transformation $t$\nlead to a sequence $B$ such that $t(B) = B$.\n\\end{mdframed}\nWe go by strong induction on $n$ with the base cases $n=1$ and $n=2$ done by hand.\nConsider two cases:\n\\begin{itemize}\n\\ii If $a_0 = 0$ and $a_1 = 1$, then $1 \\le t(a_i) \\le i$ for $i \\ge 1$;\nnow apply induction to\n\\[ \\left(t(a_1)-1, \\; t(a_2)-1, \\; \\dots, \\; t(a_n)-1\\right). \\]\n\n\\ii Otherwise, assume that $a_0 = a_1 = \\dots = a_{k-1} = 0$\nbut $a_k \\neq 0$, where $k \\ge 2$.\nAssume $k < n$ or it's obvious.\nThen $t(a_i) \\neq 0$ for $i \\ge k$, thus $t(t(a_i)) \\ge k$ for $i \\ge k$,\nand we can apply induction hypothesis to\n\\[ \\left( t(t(a_k))-k, \\; \\dots, \\; t(t(a_n))-k \\right). \\]\n\\end{itemize}\n\n\\begin{remark*}\n  I think the set of sequences with $t(B) = B$, i.e.\\ the possible fixed points,\n  can be described as blocks of equal numbers such as\n  \\[ B = (0,0,0,0,0,5,5,7,7,7,7,7,7,7,7,7,7,7,18,18) \\]\n  where the number in each block is the index of the first term in it.\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Combinatorics", "source": "USAMO", "year": 2003}
{"id": "usamo-2003-q4", "question": "Let $ABC$ be a triangle.\nA circle passing through $A$ and $B$\nintersects segments $AC$ and $BC$ at $D$ and $E$, respectively.\nLines $AB$ and $DE$ intersect at $F$,\nwhile lines $BD$ and $CF$ intersect at $M$.\nProve that $MF = MC$ if and only if $MB \\cdot MD = MC^2$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p336205}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle.\nA circle passing through $A$ and $B$\nintersects segments $AC$ and $BC$ at $D$ and $E$, respectively.\nLines $AB$ and $DE$ intersect at $F$,\nwhile lines $BD$ and $CF$ intersect at $M$.\nProve that $MF = MC$ if and only if $MB \\cdot MD = MC^2$.\n\\end{mdframed}\nCeva theorem plus the similar triangles.\n\n\\begin{center}\n\\begin{asy}\n  size(7.5cm);\n  pair C = Drawing(\"C\", (3,0), dir(-45));\n  pair D = Drawing(\"D\", (0,0));\n  pair M = Drawing(\"M\", (1,-0.7));\n  pair F = Drawing(\"F\", 2*M-C);\n  pair B = Drawing(\"B\", conj(C/M) * (M-C)+C, dir(130));\n  pair E = Drawing(\"E\", extension(D,F,B,C), dir(40));\n  pair A = Drawing(\"A\", extension(D,C,B,F), dir(225));\n  draw(A--B--C--cycle);\n  draw(circumcircle(B,D,E), dashed);\n  draw(A--F, dotted);\n  draw(E--F--C, dotted);\n  draw(B--M, dotted);\n\\end{asy}\n\\end{center}\n\nWe know unconditionally that\n\\[ \\dang CBD = \\dang EBD = \\dang EAD = \\dang EAC. \\]\nMoreover, by Ceva's theorem on $\\triangle BCF$,\nwe have $MF = MC \\iff \\ol{FC} \\parallel \\ol{AE}$.\nSo we have the equivalences\n\\begin{align*}\n  MF = MC &\\iff \\ol{FC} \\parallel \\ol{AE} \\\\\n  &\\iff \\dang FCA = \\dang EAC \\\\\n  &\\iff \\dang MCD = \\dang CBD \\\\\n  &\\iff MC^2 = MB \\cdot MD.\n\\end{align*}\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2003}
{"id": "usamo-2003-q5", "question": "Let $a$, $b$, $c$ be positive real numbers.\nProve that\n\\[ \\frac{(2a+b+c)^2}{2a^2+(b+c)^2}\n+ \\frac{(2b+c+a)^2}{2b^2+(c+a)^2}\n+ \\frac{(2c+a+b)^2}{2c^2+(a+b)^2} \\le 8.  \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p336208}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a$, $b$, $c$ be positive real numbers.\nProve that\n\\[ \\frac{(2a+b+c)^2}{2a^2+(b+c)^2}\n+ \\frac{(2b+c+a)^2}{2b^2+(c+a)^2}\n+ \\frac{(2c+a+b)^2}{2c^2+(a+b)^2} \\le 8.  \\]\n\\end{mdframed}\nThis is a canonical example of tangent line trick.\nHomogenize so that $a + b + c = 3$.\nThe desired inequality reads\n\\[ \\sum_{\\text{cyc}} \\frac{(a+3)^2}{2a^2+(3-a)^2} \\le 8. \\]\nThis follows from\n\\[ f(x) = \\frac{(x+3)^2}{2x^2+(3-x)^2}\n  \\le \\frac{1}{3} (4x + 4) \\]\nwhich can be checked as\n$\\frac 13 (4x+4)(2x^2+(3-x)^2) - (x+3)^2\n= (x-1)^2 (4x+3) \\ge 0$.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2003}
{"id": "usamo-2003-q6", "question": "At the vertices of a regular hexagon are written six nonnegative integers\nwhose sum is $2003^{2003}$.\nBert is allowed to make moves of the following form:\nhe may pick a vertex and replace the number written\nthere by the absolute value of the difference between the numbers\nwritten at the two neighboring vertices.\nProve that Bert can make a sequence of moves,\nafter which the number $0$ appears at all six vertices.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p336210}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nAt the vertices of a regular hexagon are written six nonnegative integers\nwhose sum is $2003^{2003}$.\nBert is allowed to make moves of the following form:\nhe may pick a vertex and replace the number written\nthere by the absolute value of the difference between the numbers\nwritten at the two neighboring vertices.\nProve that Bert can make a sequence of moves,\nafter which the number $0$ appears at all six vertices.\n\\end{mdframed}\nIf $a \\le b \\le c$ are \\emph{odd} integers,\nthe configuration which has $(a,b-a,b,c-b,c,c-a)$ around the hexagon\nin some order (up to cyclic permutation and reflection)\nis said to be \\emph{great} (picture below).\n\n\\begin{claim*}\n  We can reach a great configuration\n  from any configuration with odd sum.\n\\end{claim*}\n\\begin{proof}\n  We should be able to find an equilateral triangle\n  whose vertices have odd sum.\n  If all three vertices are odd, then we are already done.\n  Otherwise, operate as in the following picture (modulo $2$).\n  \\begin{center}\n  \\begin{asy}\n  size(10cm);\n  picture[] h = new picture[4];\n  h[0] = new picture;\n  h[1] = new picture;\n  h[2] = new picture;\n  h[3] = new picture;\n\n  pen cu = blue + fontsize(9pt);\n  pen cd = deepgreen + fontsize(7pt);\n  pen mu = lightred + fontsize(9pt);\n  pen md = orange + fontsize(7pt);\n\n  for (int i=0; i<=3; ++i) {\n  draw(h[i], dir(30)--dir(150)--dir(270)--cycle, cd);\n  draw(h[i], dir(90)--dir(210)--dir(330)--cycle, cu);\n  draw(h[i], dir(30)--dir(90)--dir(150)--dir(210)--dir(270)--dir(330)--cycle, lightgray);\n  }\n\n  label(h[0], \"$1$\", dir(90), dir(90), cu);\n  label(h[0], \"$\\ast$\", dir(150), dir(150), cd);\n  label(h[0], \"$0$\", dir(210), dir(210), cu);\n  label(h[0], \"$\\ast$\", dir(270), dir(270), cd);\n  label(h[0], \"$0$\", dir(330), dir(330), cu);\n  label(h[0], \"$\\ast$\", dir(30), dir(30), cd);\n\n  label(h[1], \"$1$\", dir(90), dir(90), cu);\n  label(h[1], \"$1$\", dir(150), dir(150), md);\n  label(h[1], \"$0$\", dir(210), dir(210), cu);\n  label(h[1], \"$0$\", dir(270), dir(270), md);\n  label(h[1], \"$0$\", dir(330), dir(330), cu);\n  label(h[1], \"$1$\", dir(30), dir(30), md);\n\n  label(h[2], \"$1$\", dir(90), dir(90), cu);\n  label(h[2], \"$1$\", dir(150), dir(150), cd);\n  label(h[2], \"$1$\", dir(210), dir(210), mu);\n  label(h[2], \"$0$\", dir(270), dir(270), cd);\n  label(h[2], \"$1$\", dir(330), dir(330), mu);\n  label(h[2], \"$1$\", dir(30), dir(30), cd);\n\n  label(h[3], \"$1$\", dir(90), dir(90), cu);\n  label(h[3], \"$0$\", dir(150), dir(150), md);\n  label(h[3], \"$1$\", dir(210), dir(210), cu);\n  label(h[3], \"$0$\", dir(270), dir(270), md);\n  label(h[3], \"$1$\", dir(330), dir(330), cu);\n  label(h[3], \"$0$\", dir(30), dir(30), md);\n\n  add(shift(0,0)*h[0]);\n  add(shift(3,0)*h[1]);\n  add(shift(6,0)*h[2]);\n  add(shift(9,0)*h[3]);\n  \\end{asy}\n  \\end{center}\n  Thus we arrived at a great configuration.\n\\end{proof}\n\n\\begin{claim*}\n  Bert's goal is possible for all great configurations.\n\\end{claim*}\n\\begin{proof}\n  [Proof, suggested by Haoran Chen]\n  If $a=b=c$ then we have $(t,0,t,0,t,0)$ which is obviously winnable.\n\n  Otherwise, we can perform the following three operations\n  shown in the figure below,\n  which yield a great configuration whose odd entries\n  are $a$, $b$, $|c-2a|$.\n\n  \\begin{center}\n  \\begin{asy}\n  size(12.5cm);\n  picture[] h = new picture[5];\n  h[0] = new picture;\n  h[1] = new picture;\n  h[2] = new picture;\n  h[3] = new picture;\n  h[4] = new picture;\n\n  pen cu = blue + fontsize(9pt);\n  pen cd = deepgreen + fontsize(7pt);\n  pen mu = red + fontsize(9pt);\n  pen md = red + fontsize(9pt);\n\n  for (int i=0; i<=4; ++i) {\n  draw(h[i], dir(30)--dir(150)--dir(270)--cycle, cd);\n  draw(h[i], dir(90)--dir(210)--dir(330)--cycle, cu);\n  draw(h[i], dir(30)--dir(90)--dir(150)--dir(210)--dir(270)--dir(330)--cycle, lightgray);\n  }\n\n  label(h[0], \"$a$\", dir(90), dir(90), cu);\n  label(h[0], \"$b-a$\", dir(150), dir(150), cd);\n  label(h[0], \"$b$\", dir(210), dir(210), cu);\n  label(h[0], \"$c-b$\", dir(270), dir(270), cd);\n  label(h[0], \"$c$\", dir(330), dir(330), cu);\n  label(h[0], \"$c-a$\", dir(30), dir(30), cd);\n\n  label(h[1], \"$a$\", dir(90), dir(90), cu);\n  label(h[1], \"$b-a$\", dir(150), dir(150), cd);\n  label(h[1], \"$b$\", dir(210), dir(210), cu);\n  label(h[1], \"$c-b$\", dir(270), dir(270), cd);\n  label(h[1], \"$b-a$\", dir(330), dir(330), mu);\n  label(h[1], \"$c-a$\", dir(30), dir(30), cd);\n\n  label(h[2], \"$a$\", dir(90), dir(90), cu);\n  label(h[2], \"$b-a$\", dir(150), dir(150), cd);\n  label(h[2], \"$b$\", dir(210), dir(210), cu);\n  label(h[2], \"$a$\", dir(270), dir(270), md);\n  label(h[2], \"$b-a$\", dir(330), dir(330), cu);\n  label(h[2], \"$c-a$\", dir(30), dir(30), cd);\n\n  label(h[3], \"$a$\", dir(90), dir(90), cu);\n  label(h[3], \"$b-a$\", dir(150), dir(150), cd);\n  label(h[3], \"$b$\", dir(210), dir(210), cu);\n  label(h[3], \"$a$\", dir(270), dir(270), cd);\n  label(h[3], \"$|c-2a|$\", dir(330), dir(330), mu);\n  label(h[3], \"$c-a$\", dir(30), dir(30), cd);\n\n  label(h[4], \"$a$\", dir(90), dir(90), cu);\n  label(h[4], \"$b$\", dir(210), dir(210), cu);\n  label(h[4], \"$|c-2a|$\", dir(330), dir(330), cu);\n\n  add(shift(0,3)*h[0]);\n  add(shift(4,3)*h[1]);\n  add(shift(8,3)*h[2]);\n  add(shift(2,0)*h[3]);\n  add(shift(6,0)*h[4]);\n  \\end{asy}\n  \\end{center}\n\n  Since $|c-2a| < c$ unless $a=b=c$,\n  this decreases the sum.\n  So an induction now completes the problem.\n%  This is annoying, but straightforward.\n%  Our standing assumption is $a \\neq c$ (but possibly $b=c$).\n%  It's already obvious that $|c-2a| < c$,\n%  so focus on the last term.\n%  If $c > 2b$, then $\\left\\lvert (c-2b)-(c-a) \\right\\rvert =\n%  \\left\\lvert 2b-a \\right\\rvert < c$ as well for $a \\neq c$.\n%  When $c \\le 2b$ we instead have\n%  $\\left\\lvert (2b-c)-(c-a) \\right\\rvert\n%  \\le \\max \\left( 2b-c, c-a \\right)$\n%  with equality if and only if $c-a = 0$; but $2b-c \\le c$ as needed.\n%  Thus, in all situations we have\n%  \\[ c \\neq a \\implies\n%    \\max\\left( \\left\\lvert \\left\\lvert c-2b \\right\\rvert - (c-a)\n%    \\right\\rvert, \\left\\lvert c-2a \\right\\rvert \\right) < c. \\]\n%  Now denote the new odd entries by $a' \\le b' \\le c'$ (in some order).\n%  If $b < c$ then $c' < c$,\n%  while if $b = c$ then $c' = b$ but $b' < c = b$.\n%  Thus $(c', b', a')$ precedes $(c, b, a)$ lexicographically, and we\n%  can induct down.\n\\end{proof}\n\n\\begin{remark*}\n  One simple idea might be to try to overwrite\n  the maximum number at each point, decreasing the sum.\n  However, this fails on the arrangement $(t,t,0,t,t,0)$.\n\n  Unfortunately, this issue is actually fatal,\n  as the problem has a hidden parity obstruction.\n  The configuration $(1,1,0,1,1,0) \\bmod 2$ is invariant modulo $2$,\n  and so Bert can walk into a ``fatal death-trap'' of this shape\n  long before the numbers start becoming equal/zero/etc.\n  In other words, you can mess up on the first move!\n  This is why the initial sum is given to be odd;\n  however, it's not possible for Bert to win\n  so one essentially has to ``tip-toe'' around the $110110$ trap\n  any time one leaves the space of odd sum.\n  That's why the great configurations defined above serve as an anchor,\n  making sure we never veer too far from the\n  safe $101010$ configuration.\n\\end{remark*}\n\n\\begin{remark*}\n  On the other hand, many other approaches are possible\n  which anchor around a different parity configuration,\n  like $100000$ for example.\n  The choice of $101010$ by me is due to symmetry --- ostensibly,\n  if it worked, there should be fewer cases.\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "USAMO", "year": 2003}
{"id": "imo-2000-q1", "question": "Two circles $G_1$ and $G_2$ intersect at two points $M$ and $N$.\nLet $AB$ be the line tangent to these circles at $A$ and $B$,\nrespectively, so that $M$ lies closer to $AB$ than $N$.\nLet $CD$ be the line parallel to $AB$\nand passing through the point $M$,\nwith $C$ on $G_1$ and $D$ on $G_2$.\nLines $AC$ and $BD$ meet at $E$; lines $AN$ and $CD$ meet at $P$;\nlines $BN$ and $CD$ meet at $Q$.\nShow that $EP = EQ$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p354110}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nTwo circles $G_1$ and $G_2$ intersect at two points $M$ and $N$.\nLet $AB$ be the line tangent to these circles at $A$ and $B$,\nrespectively, so that $M$ lies closer to $AB$ than $N$.\nLet $CD$ be the line parallel to $AB$\nand passing through the point $M$,\nwith $C$ on $G_1$ and $D$ on $G_2$.\nLines $AC$ and $BD$ meet at $E$; lines $AN$ and $CD$ meet at $P$;\nlines $BN$ and $CD$ meet at $Q$.\nShow that $EP = EQ$.\n\\end{mdframed}\nFirst, we have $\\dang EAB = \\dang ACM = \\dang BAM$\nand similarly $\\dang EBA = \\dang BDM = \\dang ABM$.\nConsequently, $\\ol{AB}$ bisects $\\angle EAM$ and $\\angle EBM$,\nand hence $\\triangle EAB \\cong \\triangle MAB$.\n\n\\begin{center}\n\\begin{asy}\npair M = dir(120);\npair U = dir(170);\npair V = dir(10);\npair N = 0.3*V+0.7*U;\n\npair O_1 = circumcenter(M, U, N);\npair O_2 = circumcenter(M, V, N);\n\nreal r1 = abs(U-O_1);\nreal r2 = abs(V-O_2);\npair Se = (r1*O_2-r2*O_1)/(r1-r2);\npath w1 = CP(O_1,N);\npath w2 = CP(O_2,N);\nfilldraw(w1, opacity(0.1)+lightcyan, blue);\nfilldraw(w2, opacity(0.1)+lightcyan, blue);\npair A = IP(w1, CP(midpoint(Se--O_1), Se));\npair B = IP(w2, CP(midpoint(Se--O_2), Se));\n\ndraw(A--B, red);\npair C = -M+2*foot(O_1, M, M+B-A);\npair D = -M+2*foot(O_2, M, M+B-A);\ndraw(C--D, red);\n\npair E = extension(A, C, B, D);\npair P = extension(A, N, C, D);\npair Q = extension(B, N, C, D);\ndraw(C--E--D, blue);\ndraw(A--N--B, blue);\ndraw(P--E--Q, heavygreen);\n\npair T = extension(M, N, A, B);\ndraw(T--N, heavycyan);\ndraw(A--M--B, purple);\ndraw(E--M, red);\n\ndot(\"$M$\", M, dir(350));\ndot(\"$N$\", N, dir(260));\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$D$\", D, dir(D));\ndot(\"$E$\", E, dir(E));\ndot(\"$P$\", P, dir(260));\ndot(\"$Q$\", Q, dir(330));\ndot(\"$T$\", T, dir(160));\n\n/* TSQ Source:\n\nM = dir 120 R350\nU := dir 170\nV := dir 10\nN = 0.3*V+0.7*U R260\n\nO_1 := circumcenter M U N R-90\nO_2 := circumcenter M V N R-90\n\n!real r1 = abs(U-O_1);\n!real r2 = abs(V-O_2);\nSe := (r1*O_2-r2*O_1)/(r1-r2)\n!path w1 = CP(O_1,N);\n!path w2 = CP(O_2,N);\nw1 0.1 lightcyan / blue\nw2 0.1 lightcyan / blue\nA = IP w1 CP midpoint Se--O_1 Se\nB = IP w2 CP midpoint Se--O_2 Se\n\nA--B red\nC = -M+2*foot O_1 M M+B-A\nD = -M+2*foot O_2 M M+B-A\nC--D red\n\nE = extension A C B D\nP = extension A N C D R260\nQ = extension B N C D R330\nC--E--D blue\nA--N--B blue\nP--E--Q heavygreen\n\nT = extension M N A B R160\nT--N heavycyan\nA--M--B purple\nE--M red\n\n*/\n\\end{asy}\n\\end{center}\n\nNow it is well-known that $\\ol{MN}$ bisects $\\ol{AB}$\nand since $\\ol{AB} \\parallel \\ol{PQ}$\nwe deduce that $M$ is the midpoint of $\\ol{PQ}$.\nAs $\\ol{AB}$ is the perpendicular bisector of $\\ol{EM}$,\nit follows that $EP = EQ$ as well.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2000}
{"id": "imo-2000-q2", "question": "Let $a$, $b$, $c$ be positive real numbers with $abc = 1$.\nShow that\n\\[\n  \\left( a - 1 + \\frac 1b \\right)\n  \\left( b - 1 + \\frac 1c \\right)\n  \\left( c - 1 + \\frac 1a \\right)\n  \\le 1.\n\\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p354109}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a$, $b$, $c$ be positive real numbers with $abc = 1$.\nShow that\n\\[\n  \\left( a - 1 + \\frac 1b \\right)\n  \\left( b - 1 + \\frac 1c \\right)\n  \\left( c - 1 + \\frac 1a \\right)\n  \\le 1.\n\\]\n\\end{mdframed}\nLet $a = x/y$, $b = y/z$, $c = z/x$ for $x,y,z > 0$.\nThen the inequality rewrites as\n\\[ (-x+y+z)(x-y+z)(x+y-z) \\le xyz \\]\nwhich when expanded is equivalent to Schur's inequality.\nAlternatively, if one wants to avoid appealing to Schur,\nthen the following argument works:\n\\begin{itemize}\n  \\ii At most one term on the left-hand side is negative;\n  if that occurs we are done from $xyz > 0 > (-x+y+z)(x-y+z)(x+y-z)$.\n  \\ii If all terms in the left-hand side are nonnegative,\n  let us denote $m = -x+y+z \\ge 0$, $n = x-y+z \\ge 0$, $p = x+y-z \\ge 0$.\n  Then it becomes\n  \\[ mnp \\le \\frac{(m+n)(n+p)(p+m)}{8} \\]\n  which follows by AM-GM.\n\\end{itemize}\n\\pagebreak", "category": "Algebra", "source": "IMO", "year": 2000}
{"id": "imo-2000-q3", "question": "Let $n \\ge 2$ be a positive integer\nand $\\lambda$ a positive real number.\nInitially there are $n$ fleas on a horizontal line,\nnot all at the same point.\nWe define a move as choosing two fleas at some points $A$ and $B$,\nwith $A$ to the left of $B$,\nand letting the flea from $A$ jump over the flea from $B$ to the point $C$\nso that $\\frac{BC}{AB} = \\lambda$.\n\nDetermine all values of $ \\lambda$ such that,\nfor any point $M$ on the line\nand for any initial position of the $n$ fleas,\nthere exists a sequence of moves that will take\nthem all to the position right of $M$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p354112}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n \\ge 2$ be a positive integer\nand $\\lambda$ a positive real number.\nInitially there are $n$ fleas on a horizontal line,\nnot all at the same point.\nWe define a move as choosing two fleas at some points $A$ and $B$,\nwith $A$ to the left of $B$,\nand letting the flea from $A$ jump over the flea from $B$ to the point $C$\nso that $\\frac{BC}{AB} = \\lambda$.\n\nDetermine all values of $ \\lambda$ such that,\nfor any point $M$ on the line\nand for any initial position of the $n$ fleas,\nthere exists a sequence of moves that will take\nthem all to the position right of $M$.\n\\end{mdframed}\nThe answer is $\\lambda \\ge \\frac{1}{n-1}$.\n\nWe change the problem by replacing the fleas\nwith \\textbf{bowling balls} $B_1$, $B_2$, \\dots, $B_n$ in that order.\nBowling balls aren't exactly great at jumping,\nso each move can now be described as follows:\n\\begin{itemize}\n\\ii Select two indices $i < j$.\nThen ball $B_i$ moves to $B_{i+1}$'s location,\n$B_{i+1}$ moves to $B_{i+2}$'s location, and so on;\nuntil $B_{j-1}$ moves to $B_j$'s location,\n\\ii Finally, $B_j$ moves some distance forward;\nthe distance is at most $\\lambda \\cdot |B_j B_i|$\nand $B_j$ may not pass $B_{j+1}$.\n\\end{itemize}\n\n\\begin{claim*}\n  If $\\lambda < \\frac{1}{n-1}$\n  the bowling balls have bounded movement.\n\\end{claim*}\n\\begin{proof}\n  Let $a_i \\ge 0$ denote the initial distance\n  between $B_i$ and $B_{i+1}$,\n  and let $\\Delta_i$ denote the distance travelled by ball $i$.\n  Of course we have\n  $\\Delta_1 \\le a_1 + \\Delta_2$,\n  $\\Delta_2 \\le a_2 + \\Delta_3$,\n  \\dots,\n  $\\Delta_{n-1} \\le a_{n-1} + \\Delta_n$\n  by the relative ordering of the bowling balls.\n  Finally, distance covered by $B_n$ is always\n  $\\lambda$ times distance travelled by other bowling balls, so\n  \\begin{align*}\n    \\Delta_n &\\le \\lambda \\sum_{i=1}^{n-1} \\Delta_i\n    \\le \\lambda \\sum_{i=1}^{n-1}\n    \\left( \\left( a_i + a_{i+1} + \\dots + a_{n-1} \\right)\n      + \\Delta_n \\right) \\\\\n    &= (n-1)\\lambda \\cdot \\Delta_n + \\sum_{i=1}^{n-1} i a_i\n  \\end{align*}\n  and since $(n-1)\\lambda > 1$, this gives an upper bound.\n\\end{proof}\n\n\\begin{remark*}\n  Equivalently, you can phrase the proof without\n  bowling balls as follows:\n  if $x_1 < \\dots < x_n$ are the positions of the fleas,\n  the quantity\n  \\[ L = x_n - \\lambda(x_1 + \\dots + x_{n-1}) \\]\n  is a monovariant which never increases;\n  i.e.\\ $L$ is bounded above.\n  Since $L > (1-(n-1)\\lambda) x_n$, it follows\n  $\\lambda < \\frac{1}{n-1}$ is enough to stop the fleas.\n\\end{remark*}\n\n\\begin{claim*}\nWhen $\\lambda \\ge \\frac{1}{n-1}$,\nit suffices to always jump the leftmost flea\nover the rightmost flea.\n\\end{claim*}\n\\begin{proof}\nIf we let $x_i$ denote the distance travelled by $B_1$\nin the $i$th step,\nthen $x_i = a_i$ for $1 \\le i \\le n-1$\nand $x_i = \\lambda(x_{i-1} + x_{i-2} + \\dots + x_{i-(n-1)})$.\n\nIn particular, if $\\lambda \\ge \\frac{1}{n-1}$\nthen each $x_i$ is at least the average of the previous $n-1$ terms.\nSo if the $a_i$ are not all zero,\nthen $\\{x_{n}, \\dots, x_{2n-2}\\}$ are all positive\nand thereafter $x_i \\ge \\min \\left\\{ x_n, \\dots, x_{2n-2} \\right\\} > 0$\nfor every $i \\ge 2n-1$.\nSo the partial sums of $x_i$ are unbounded, as desired.\n\\end{proof}\n\n\\begin{remark*}\n  Other inductive constructions are possible.\n  Here is the idea of one of them,\n  although the details are more complicated.\n\n  We claim in general that given $n-1$ fleas at $0$\n  and one flea at $1$,\n  we can get all the fleas arbitrarily close to\n  $\\frac{1}{1-(n-1)\\lambda}$\n  (or as far as we want if $\\lambda > \\frac{1}{n-1}$.).\n  The proof is induction by $n \\ge 2$;\n  for $n=2$ we get a geometric series.\n  For $n \\ge 3$, we leave one flea at zero\n  and move the remainder close to $\\frac{1}{1-(n-2)\\lambda}$,\n  then jump the last flea to\n  $\\frac{1+\\lambda}{1-(n-2)\\lambda}$.\n\n  Now we're in the same situation,\n  except we shifted $\\frac{1}{1-(n-2)\\lambda}$ right\n  and have then scaled everything by\n  $r = \\frac{\\lambda}{1-(n-2)\\lambda}$.\n  If we repeat this process again and check the geometric series,\n  we see the fleas converge to\n  \\[ \\frac{1}{1-(n-2)\\lambda}\n    \\left( 1 + r + r^2 + r^3 + \\dots \\right)\n    = \\frac{1}{1-(n-2)\\lambda} \\cdot \\frac{1}{1-r}\n    = \\frac{1}{1-(n-1)\\lambda}. \\]\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Geometry", "source": "IMO", "year": 2000}
{"id": "imo-2000-q4", "question": "A magician has one hundred cards numbered $1$ to $100$.\nHe puts them into three boxes, a red one, a white one and a blue one,\nso that each box contains at least one card.\nA member of the audience draws two cards from two different boxes\nand announces the sum of numbers on those cards.\nGiven this information,\nthe magician locates the box from which no card has been drawn.\n\nHow many ways are there to put the cards\nin the three boxes so that the trick works?", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p354114}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA magician has one hundred cards numbered $1$ to $100$.\nHe puts them into three boxes, a red one, a white one and a blue one,\nso that each box contains at least one card.\nA member of the audience draws two cards from two different boxes\nand announces the sum of numbers on those cards.\nGiven this information,\nthe magician locates the box from which no card has been drawn.\n\nHow many ways are there to put the cards\nin the three boxes so that the trick works?\n\\end{mdframed}\nThere are $2 \\cdot 3! = 12$ ways, which amount to:\n\\begin{itemize}\n  \\ii Partitioning the cards modulo $3$, or\n  \\ii Placing $1$ alone in a box,\n  $100$ alone in a second box,\n  and all remaining cards in the third box.\n\\end{itemize}\nThese are easily checked to work so we prove they are the only ones.\n\n\\paragraph{First solution.}\nWe proceed by induction on $n \\ge 3$ with the base case being immediate.\n\nFor the inductive step,\nconsider a working partition of $\\{1, 2, \\dots, n\\}$.\nThen either $n$ is in its own box; or\ndeleting $n$ gives a working partition of $\\{1, 2, \\dots, n-1\\}$.\nSimilarly, either $1$ is in its own box; or\ndeleting $1$ gives a working partition of $\\{2, 3, \\dots, n\\}$,\nand we can reduce all numbers by $1$ to get\na working partition of $\\{1, 2, \\dots, n-1\\}$.\n\nTherefore, we only need to consider there cases.\n\\begin{itemize}\n  \\ii If $1$ and $n$ are both in their own box,\n  this yields one type of solution we already found.\n\n  \\ii If $n$ is not in a box by itself,\n  then by induction hypothesis the cards $1$ through $n-1$\n  are either arranged mod $3$,\n  or as $\\{1\\} \\cup \\{2,3,\\dots,n-2\\} \\cup \\{n-1\\}$.\n  \\begin{itemize}\n    \\ii In the former mod $3$ situation,\n    since $n + (n-3) = (n-1) + (n-2)$,\n    so $n$ must be in the same box as $n-3$.\n    \\ii In the latter case and for $n > 4$,\n    since $n + 1 = 2 + (n-1)$,\n    $n$ must be in the same box as $1$.\n    But now $n + 2 = (n-1) + 3$ for $n > 4$, contradiction.\n  \\end{itemize}\n\n  \\ii The case where $1$ is in a box by itself is analogous.\n\\end{itemize}\nThis exhausts all cases, completing the proof.\n\n\\paragraph{Second solution.}\nLet $A$, $B$, $C$ be the sets of cards in the three boxes.\nThen $A+B$, $B+C$, $C+A$ should be disjoint,\nand contained in $\\{3, 4, \\dots, 199\\}$.\nOn the other hand, we have the following famous fact.\n\\begin{lemma*}\n  Let $X$ and $Y$ be finite nonempty sets of real numbers.\n  We have $|X+Y| \\ge |X|+|Y|-1$,\n  with equality if and only if $X$ and $Y$ are arithmetic\n  progressions with the same common difference,\n  or one of $X$ and $Y$ is a singleton set.\n\\end{lemma*}\nPutting these two together gives the estimates\n\\[ 197 \\ge |A+B| + |B+C| + |C+A|\n  \\ge 2\\left( |A|+|B|+|C| \\right)-3 = 197. \\]\nSo all the inequalities must be sharp.\nConsequently we conclude that:\n\\begin{claim*}\n  Either the sets $A$, $B$, $C$ are disjoint arithmetic progressions\n  with the same common difference\n  $d = \\min_{x \\neq y \\text{ in same set}} |x-y|$,\n  or two of the sets are two singleton.\n  Moreover, $\\{3, 4, \\dots, 199\\}\n    = (A+B) \\sqcup (B+C) \\sqcup (C+A)$.\n\\end{claim*}\nFrom here it is not hard to deduce the layouts above are the only ones,\nbut there are some details.\nFirst, we make the preliminary observation that\n$3=1+2$, $4=1+3$, $198=98+100$, $199=99+100$\nand these numbers can't be decomposed in other ways;\nthus from the remark about the disjoint union:\n\\begin{claim*}\n  [Convenient corollary]\n  The pairs $(1,2)$, $(1,3)$, $(98,100)$, $(99,100)$\n  are all in different sets.\n\\end{claim*}\nWe now consider the four cases.\n\\begin{itemize}\n  \\ii If two of the boxes are singletons,\n  it follows from the corollary that we should have $A = \\{1\\}$,\n  $B = \\{100\\}$ and $C = \\{2, \\dots, 99\\}$, up to permutation.\n  \\ii Otherwise $A$, $B$, $C$ are disjoint arithmetic\n  progressions with the same common difference $d$.\n  As two of $\\{1,2,3,4\\}$ are in the same box\n  (by pigeonhole), we must have $d \\le 3$.\n  \\begin{itemize}\n    \\ii If $d=3$, then no two elements of different residues\n    modulo $3$ can be in the same box,\n    so we must be in the first construction claimed earlier.\n\n    \\ii If $d=2$, then the convenient corollary\n    tells us we may assume WLOG that $1 \\in A$ and $2 \\in B$,\n    hence $3 \\in C$\n    (since $3 \\notin A$ by convenient corollary,\n    and $3 \\notin B$ because common difference $2$).\n    Thus we must have $A = \\{1\\}$, $B = \\{2, 4, \\dots, 100\\}$\n    and $C = \\{3, 5, \\dots 99\\}$\n    which does not work since $1+4 = 2+3$.\n    Therefore there are no solutions in this case.\n\n    \\ii If $d=1$, then by convenient corollary\n    the numbers $1$ and $2$ are in different sets,\n    as are $99$ and $100$.\n    So we must have $A = \\{1\\}$, $B = \\{2, \\dots, 99\\}$, $C = \\{100\\}$\n    which we have already seen is valid.\n  \\end{itemize}\n\\end{itemize}\n\\pagebreak", "category": "Combinatorics", "source": "IMO", "year": 2000}
{"id": "imo-2000-q5", "question": "Does there exist a positive integer $n$\nsuch that $n$ has exactly 2000 distinct prime divisors\nand $n$ divides $2^n + 1$?", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p354115}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nDoes there exist a positive integer $n$\nsuch that $n$ has exactly 2000 distinct prime divisors\nand $n$ divides $2^n + 1$?\n\\end{mdframed}\nAnswer: Yes.\n\nWe say that $n$ is \\emph{Korean} if $n \\mid 2^n+1$.\nFirst, observe that $n=9$ is Korean.\nNow, the problem is solved upon the following claim:\n\\begin{claim*}\n  If $n > 3$ is Korean,\n  there exists a prime $p$ not dividing $n$\n  such that $np$ is Korean too.\n\\end{claim*}\n\\begin{proof}\n  I claim that one can take any primitive prime divisor $p$ of $2^{2n}-1$,\n  which exists by Zsigmondy theorem.\n  Obviously $p \\neq 2$.\n  Then:\n  \\begin{itemize}\n    \\ii Since $p \\nmid 2^{\\varphi(n)}-1$ it follows then that $p \\nmid n$.\n    \\ii Moreover, $p \\mid 2^n+1$ since $p \\nmid 2^n-1$.\n  \\end{itemize}\n  Hence $np \\mid 2^n+1 \\mid 2^{np} + 1$ by Chinese Theorem,\n  since $\\gcd(n,p) = 1$.\n  % Thanks Wanlin for catching this\n\\end{proof}\n\\pagebreak", "category": "Number Theory", "source": "IMO", "year": 2000}
{"id": "imo-2000-q6", "question": "Let $\\ol{AH_1}$, $\\ol{BH_2}$, and $\\ol{CH_3}$ be the\naltitudes of an acute triangle $ABC$.\nThe incircle $\\omega$ of triangle $ABC$ touches the sides\n$BC$, $CA$ and $AB$ at $T_1$, $T_2$ and $T_3$, respectively.\nConsider the reflections of the lines $H_1H_2$, $H_2H_3$, and\n$H_3H_1$ with respect to the lines $T_1T_2$, $T_2T_3$, and $T_3T_1$.\nProve that these images form a triangle whose vertices lie on $\\omega$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p351094}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $\\ol{AH_1}$, $\\ol{BH_2}$, and $\\ol{CH_3}$ be the\naltitudes of an acute triangle $ABC$.\nThe incircle $\\omega$ of triangle $ABC$ touches the sides\n$BC$, $CA$ and $AB$ at $T_1$, $T_2$ and $T_3$, respectively.\nConsider the reflections of the lines $H_1H_2$, $H_2H_3$, and\n$H_3H_1$ with respect to the lines $T_1T_2$, $T_2T_3$, and $T_3T_1$.\nProve that these images form a triangle whose vertices lie on $\\omega$.\n\\end{mdframed}\nWe use complex numbers with $\\omega$ the unit circle.\nLet $T_1 = a$, $T_2 = b$, $T_3 = c$.\nThe main content of the problem is to show that\nthe triangle in question has vertices\n$ab/c$, $bc/a$, $ca/b$\n(which is evident from a good diagram).\n\nSince $A = \\frac{2bc}{b+c}$, we have\n\\[ H_1 = \\half \\left( \\frac{2bc}{b+c} + a + a - a^2 \\cdot\n  \\frac{2}{b+c} \\right)\n  = \\frac{ab+bc+ca-a^2}{b+c}. \\]\nThe reflection of $H_1$ over $\\ol{T_1 T_2}$ is\n\\begin{align*}\n  H_1^C &= a + b - ab \\ol{H_1}\n    = a + b - b \\cdot \\frac{ac+ab+a^2-bc}{a(b+c)} \\\\\n  &= \\frac{a(a+b)(b+c) - b(a^2+ab+ac-bc)}{a(b+c)}\n    = \\frac{c(a^2+b^2)}{a(b+c)}.\n\\end{align*}\nNow, we claim that $H_1^C$ lies on the chord joining\n$\\frac{ca}{b}$ and $\\frac{cb}{a}$;\nby symmetry so will $H_2^C$\nand this will imply the problem\n(it means that the desired triangle has vertices\n$ab/c$, $bc/a$, $ca/b$).\nA cartoon of this is shown below.\n\\begin{center}\n\\begin{asy}\n  pair A = dir(110);\n  pair B = dir(210);\n  pair C = dir(330);\n  dot(\"$\\frac{bc}{a}$\", A, dir(10), blue);\n  dot(\"$\\frac{ca}{b}$\", B, dir(140), blue);\n  dot(\"$\\frac{ab}{c}$\", C, dir(50), blue);\n  dot(\"$H_1^C$\", 2*A-B, dir(A-B));\n  dot(\"$H_2^C$\", 2*B-A, dir(B-A));\n  dot(\"$H_2^A$\", 2*B-C, dir(B-C));\n  dot(\"$H_3^A$\", 2*C-B, dir(C-B));\n  dot(\"$H_3^B$\", 2*C-A, dir(C-A));\n  dot(\"$H_1^B$\", 2*A-C, dir(A-C));\n  draw( (2*A-B)--(2*B-A) );\n  draw( (2*B-C)--(2*C-B) );\n  draw( (2*C-A)--(2*A-C) );\n\\end{asy}\n\\end{center}\nTo see this, it suffices to compute\n\\begin{align*}\n  H_1^C + \\left( \\frac{ca}{b} \\right)\\left( \\frac{cb}{a} \\right) \\ol{H_1^C}\n  &= \\frac{c(a^2+b^2)}{a(b+c)}\n    + c^2 \\frac{\\frac 1c \\cdot \\frac{a^2+b^2}{a^2b^2}}%\n    {\\frac1a\\left( \\frac{b+c}{bc} \\right)} \\\\\n  &= \\frac{c(a^2+b^2)}{a(b+c)}\n    + \\frac{c(a^2+b^2)}{abc\\inv(b+c)} \\\\\n  &= \\frac{c(a^2+b^2)}{a(b+c)} \\left( \\frac{b+c}{b} \\right) \\\\\n  &= \\frac{c(a^2+b^2)}{ab}= \\frac{ca}{b} + \\frac{cb}{a}\n\\end{align*}\nas desired.\n\\pagebreak\n\n\n\\end{document}", "category": "Geometry", "source": "IMO", "year": 2000}
{"id": "putnam-2005-a1", "question": "Show that every positive integer is a sum of one or more numbers of the\nform $2^r 3^s$, where $r$ and $s$ are nonnegative integers and no\nsummand divides another.\n(For example, 23 = 9 + 8 + 6.)", "solution": "We proceed by induction, with base case $1 = 2^0 3^0$. Suppose all\nintegers less than $n-1$ can be represented. If $n$ is even, then\nwe can take a representation of $n/2$ and multiply each term by 2 to\nobtain a representation of $n$. If $n$ is odd,\nput $m = \\lfloor \\log_3 n\n\\rfloor$, so that $3^m \\leq n < 3^{m+1}$. If $3^m = n$, we are done.\nOtherwise, choose a representation $(n-3^m)/2 = s_1 + \\cdots + s_k$\nin the desired form. Then\n\\[\nn = 3^m + 2s_1 + \\cdots + 2s_k,\n\\]\nand clearly none of the $2s_i$ divide each other or $3^m$. Moreover,\nsince $2s_i \\leq n-3^m < 3^{m+1} - 3^m$, we have $s_i < 3^m$,\nso $3^m$ cannot divide $2s_i$ either. Thus $n$ has a representation\nof the desired form in all cases, completing the induction.\n\n\\textbf{Remarks:}\nThis problem is originally due to Paul Erd\\H{o}s.\nNote that the representations need not be unique: for instance,\n\\[\n11 = 2+9 = 3+8.\n\\]", "category": "Number Theory", "source": "PUTNAM", "year": 2005}
{"id": "putnam-2005-a2", "question": "Let $\\mathbf{S} = \\{(a,b) | a = 1, 2, \\dots,n, b = 1,2,3\\}$.\nA \\emph{rook tour} of $\\mathbf{S}$ is a polygonal path made up of line\nsegments connecting points $p_1, p_2, \\dots, p_{3n}$ in sequence such that\n\\begin{enumerate}", "solution": "We will assume $n \\geq 2$ hereafter, since the answer is 0 for $n=1$.\n\n\\textbf{First solution:}\nWe show that the set of rook tours from $(1,1)$ to $(n,1)$ is in bijection with\nthe set of subsets of $\\{1,2,...,n\\}$ that include $n$ and contain an even number\nof elements in total.  Since the latter set evidently contains $2^{n-2}$ elements,\nso does the former.\n\nWe now construct the bijection.  Given a rook tour $P$ from $(1,1)$ to $(n,1)$,\nlet $S=S(P)$ denote the set of all $i \\in \\{1,2,\\ldots,n\\}$ for which there is\neither a directed edge from $(i,1)$ to $(i,2)$ or from $(i,3)$ to $(i,2)$.  It\nis clear that this set $S$ includes $n$ and must contain an even number of\nelements.  Conversely, given a subset $S=\\{a_1,a_2,\\ldots,a_{2r}=n\\}\n\\subset \\{1,2,\\ldots,n\\}$ of this type with $a_1<a_2<\\cdots<a_{2r}$,\nwe notice that there is a unique path $P$ containing\n$(a_i,2+(-1)^i),(a_1,2)$\nfor $i=1,2,\\ldots,2r$.  This establishes the desired bijection.\n\n\n\\textbf{Second solution:}\nLet $A_n$ denote the set of rook tours beginning at $(1,1)$ and\nending at $(n,1)$, and let $B_n$ denote the set of rook tours\nbeginning at $(1,1)$ and ending at $(n,3)$.\n\nFor $n \\geq 2$, we construct a bijection between $A_n$ and $A_{n-1}\n\\cup B_{n-1}$. Any path $P$ in $A_n$ contains either the line segment\n$P_1$ between $(n-1,1)$ and $(n,1)$, or the line segment $P_2$ between\n$(n,2)$ and $(n,1)$. In the former case, $P$ must also contain the\nsubpath $P_1'$ which joins $(n-1,3)$, $(n,3)$, $(n,2)$, and $(n-1,2)$\nconsecutively; then deleting $P_1$ and $P_1'$ from $P$ and adding the\nline segment joining $(n-1,3)$ to $(n-1,2)$ results in a path in\n$A_{n-1}$. (This construction is reversible, lengthening any path in\n$A_{n-1}$ to a path in $A_n$.) In the latter case, $P$ contains the\nsubpath $P_2'$ which joins $(n-1,3)$, $(n,3)$, $(n,2)$, $(n,1)$\nconsecutively; deleting $P_2'$ results in a path in $B_{n-1}$, and\nthis construction is also reversible. The desired bijection follows.\n\nSimilarly, there is a bijection between $B_n$ and $A_{n-1} \\cup\nB_{n-1}$ for $n \\geq 2$. It follows by induction that for $n \\geq 2$,\n$|A_n| = |B_n| = 2^{n-2} (|A_1| + |B_1|)$. But $|A_1| = 0$ and $|B_1|\n= 1$, and hence the desired answer is $|A_n| = 2^{n-2}$.\n\n\\textbf{Remarks:}\nOther bijective arguments are possible: for instance, Noam Elkies\npoints out that each element of $A_n \\cup B_n$\ncontains a different one of the possible sets of\nsegments of the form $(i,2),(i+1,2)$ for $i=1,\\dots,n-1$.\nRichard Stanley provides the reference: K.L. Collins and L.B. Krompart,\nThe number of Hamiltonian paths in a rectangular grid,\n\\textit{Discrete Math.}  \\textbf{169} (1997), 29--38. This problem\nis Theorem~1 of that paper; the cases of $4 \\times n$ and $5 \\times n$\ngrids\nare also treated. The paper can also be found online at the URL\n\\texttt{kcollins.web.wesleyan.edu/vita.htm}.", "category": "Combinatorics", "source": "PUTNAM", "year": 2005}
{"id": "putnam-2005-a3", "question": "Let $p(z)$ be a polynomial of degree $n$ all of whose zeros have absolute\nvalue 1 in the complex  plane. Put $g(z) = p(z)/z^{n/2}$. Show that all zeros\nof $g'(z) = 0$ have absolute value 1.", "solution": "Note that it is implicit in the problem that $p$ is nonconstant,\none may take any branch of the square root, and that $z=0$ should be\nignored.\n\n\\textbf{First solution:}\nWrite $p(z) = c \\prod_{j=1}^n (z-r_j)$, so that\n\\[\n\\frac{g'(z)}{g(z)} = \\frac{1}{2z} \\sum_{j=1}^n \\frac{z+r_j}{z-r_j}.\n\\]\nNow if $z\\neq r_j$ for all $j$,then\n\\[\n\\frac{z+r_j}{z-r_j}\n= \\frac{(z+r_j)(\\overline{z}-\\overline{r_j})}{|z-r_j|^2}\n= \\frac{|z|^2-1+2 \\mathrm{Im}(\\overline{z} r_j)}{|z-r_j|^2},\n\\]\nand so\n\\[\n\\mathrm{Re}\\, \\frac{z g'(z)}{g(z)} = \\frac{|z|^2-1}{2} \\left(\n\\sum_j \\frac{1}{|z-r_j|^2} \\right).\n\\]\nSince the quantity in parentheses\nis positive, $g'(z)/g(z)$ can be $0$ only if $|z|=1$. If on the other\nhand $z = r_j$ for some $j$, then $|z|=1$ anyway.\n\n\\textbf{Second solution:}\nWrite $p(z) = c\\prod_{j=1}^n (z-r_j)$, so that\n\\[\n\\frac{g'(z)}{g(z)}\n= \\sum_{j=1}^n \\left( \\frac{1}{z-r_j} - \\frac{1}{2z} \\right).\n\\]\nWe first check that $g'(z) \\neq 0$ whenever $z$ is real and $z>1$.\nIn this case, for $r_j = e^{i \\theta_j}$, we have $z - r_j =\n(z - \\cos (\\theta_j)) + \\sin(\\theta_j) i$, so the real part of\n$\\frac{1}{z-r_j} - \\frac{1}{2z}$ is\n\\[\n\\frac{z - \\cos(\\theta_j)}{z^2 - 2z \\cos(\\theta_j) + 1} - \\frac{1}{2z}\n= \\frac{z^2-1}{2z(z^2 - 2z \\cos(\\theta_j) + 1)} > 0.\n\\]\nHence $g'(z)/g(z)$ has positive real part, so $g'(z)/g(z)$ and hence\n$g(z)$ are nonzero.\n\nApplying the same argument after replacing $p(z)$ by $p(e^{i \\theta} z)$,\nwe deduce that $g'$ cannot have any roots outside the unit circle.\nApplying the same argument after replacing $p(z)$ by $z^n p(1/z)$, we\nalso deduce that $g'$ cannot have any roots inside the unit circle.\nHence all roots of $g'$ have absolute value 1, as desired.\n\n\\textbf{Third solution:}\nWrite $p(z) = c \\prod_{j=1}^n (z - r_j)$ and\nput $r_j = e^{2 i \\theta_j}$. Note that $g(e^{2 i \\theta})$\nis equal to a nonzero constant times\n\\begin{align*}\nh(\\theta) &= \\prod_{j=1}^n \\frac{e^{i (\\theta + \\theta_j)}\n- e^{-i(\\theta + \\theta_j)}}{2i} = \\prod_{j=1}^n \\sin(\\theta +\\theta_j).\n\\end{align*}\nSince $h$ has at least $2n$ roots (counting multiplicity)\nin the interval $[0, 2\\pi)$, $h'$ does also by repeated application of\nRolle's theorem. Since $g'(e^{2 i \\theta}) = 2i e^{2i \\theta} h'(\\theta)$,\n$g'(z^2)$ has at least $2n$ roots on the unit circle. Since $g'(z^2)$ is equal to\n$z^{-n-1}$ times a polynomial of degree $2n$, $g'(z^2)$ has all roots on the\nunit circle, as then does $g'(z)$.\n\n\\textbf{Remarks:}\nThe second solution imitates the proof of the Gauss-Lucas theorem:\nthe roots of the derivative of a complex polynomial lie in the convex hull of\nthe roots of the original polynomial.\nThe second solution is close to problem B3 from the 2000 Putnam.\nA hybrid between the first and third solutions is to check that\non the unit circle, $\\mathrm{Re}(zg'(z)/g(z)) = 0$ while between any\ntwo roots of $p$, $\\mathrm{Im}(zg'(z)/g(z))$ runs from $+\\infty$ to $-\\infty$\nand so must have a zero crossing. (This only works when $p$ has distinct roots,\nbut the general case follows by the continuity of the roots of a polynomial\nas functions of the coefficients.)\nOne can also construct a  solution using Rouch\\'e's theorem.", "category": "Algebra", "source": "PUTNAM", "year": 2005}
{"id": "putnam-2005-a4", "question": "Let $H$ be an $n \\times n$ matrix all of whose entries are $\\pm 1$ and\nwhose rows are mutually orthogonal. Suppose $H$ has an $a \\times b$ submatrix\nwhose entries are all $1$. Show that $ab \\leq n$.", "solution": "\\textbf{First solution:}\nChoose a set of $a$ rows $r_1, \\dots, r_a$\ncontaining an $a \\times b$ submatrix whose\nentries are all 1. Then for $i,j \\in\\{1, \\dots, a\\}$, we have\n$r_i \\cdot r_j = n$ if $i=j$ and 0 otherwise. Hence\n\\[\n\\sum_{i,j=1}^a r_i \\cdot r_j = an.\n\\]\nOn the other hand, the term on the left is the dot product of\n$r_1 + \\cdots + r_a$ with itself, i.e., its squared length. Since\nthis vector has $a$ in each of its first $b$ coordinates, the dot product\nis at least $a^2 b$. Hence $an \\geq a^2 b$,\nwhence $n \\geq ab$ as desired.\n\n\\textbf{Second solution:}\n(by Richard Stanley)\nSuppose without loss of generality that the $a \\times b$ submatrix\noccupies the first $a$ rows and the first $b$ columns.\nLet $M$ be the submatrix occupying the first $a$ rows and the last\n$n-b$ columns. Then the hypothesis implies that the matrix\n$MM^T$ has $n-b$'s on the main diagonal and $-b$'s elsewhere.\nHence the column vector $v$ of length $a$ consisting of all 1's\nsatisfies $MM^T v = (n-ab)v$, so $n-ab$ is an eigenvalue of $MM^T$.\nBut $MM^T$ is semidefinite, so its eigenvalues are all nonnegative\nreal numbers. Hence $n-ab \\geq 0$.\n\n\\textbf{Remarks:}\nA matrix as in the problem is called a \\emph{Hadamard matrix}, because\nit meets the equality condition of Hadamard's inequality:\nany $n \\times n$ matrix with $\\pm 1$ entries has absolute determinant\nat most $n^{n/2}$, with equality if and only if the rows are mutually\northogonal\n(from the interpretation of the determinant as the volume of a paralellepiped\nwhose edges are parallel to the row vectors).\nNote that this implies  that the columns are also mutually orthogonal.\nA generalization of this problem, with a similar proof, is known\nas \\emph{Lindsey's lemma}: the sum of the entries in any\n$a \\times b$ submatrix of a Hadamard matrix is at most $\\sqrt{abn}$.\nStanley notes that Ryser (1981) asked for the smallest size of a Hadamard\nmatrix containing an $r \\times s$ submatrix of all 1's, and refers to\nthe URL \\texttt{www3.interscience.wiley.com/cgi-bin/ abstract/110550861/ABSTRACT} for more information.", "category": "Combinatorics", "source": "PUTNAM", "year": 2005}
{"id": "putnam-2005-a5", "question": "Evaluate $\\int_0^1 \\frac{\\ln(x+1)}{x^2+1}\\,dx$.", "solution": "\\textbf{First solution:}\nWe make the substitution $x = \\tan \\theta$, rewriting the desired integral as\n\\[\n\\int_0^{\\pi/4} \\log(\\tan(\\theta) + 1)\\,d\\theta.\n\\]\nWrite\n\\[\n\\log(\\tan(\\theta)+ 1) = \\log(\\sin(\\theta) + \\cos(\\theta))-\\log(\\cos(\\theta))\n\\]\nand then note that $\\sin(\\theta) + \\cos(\\theta) = \\sqrt{2} \\cos\n(\\pi/4 - \\theta)$. We may thus rewrite the integrand as\n\\[\n\\frac12 \\log(2) + \\log(\\cos(\\pi/4 - \\theta)) - \\log(\\cos(\\theta)).\n\\]\nBut over the interval $[0, \\pi/4]$, the integrals of\n$\\log(\\cos(\\theta))$ and $\\log(\\cos(\\pi/4 - \\theta))$ are equal, so their\ncontributions cancel out. The desired integral is then just the integral\nof $\\frac{1}{2} \\log(2)$ over the interval $[0,\\pi/4]$, which is\n$\\pi \\log(2)/8$.\n\n\\textbf{Second solution:}\n(by Roger Nelsen)\nLet $I$ denote the desired integral. We make the substitution\n$x = (1-u)/(1+u)$ to obtain\n\\begin{align*}\nI &= \\int_0^1 \\frac{(1+u)^2\\log(2/(1+u))}{2(1+u^2)} \\frac{2\\,du}{(1+u)^2} \\\\\n&= \\int_0^1 \\frac{\\log(2) - \\log(1+u)}{1+u^2}\\,du \\\\\n&= \\log(2) \\int_0^1 \\frac{du}{1+u^2} - I,\n\\end{align*}\nyielding\n\\[\nI = \\frac{1}{2} \\log(2) \\int_0^1 \\frac{du}{1+u^2} = \\frac{\\pi \\log(2)}{8}.\n\\]\n\n\\textbf{Third solution:}\n(attributed to Steven Sivek)\nDefine the function\n\\[\nf(t) = \\int_0^1 \\frac{\\log(xt+1)}{x^2+1}\\,dx\n\\]\nso that $f(0) = 0$ and\nthe desired integral is $f(1)$. Then by differentiation under\nthe integral,\n\\[\nf'(t) = \\int_0^1 \\frac{x}{(xt+1)(x^2+1)}\\,dx.\n\\]\nBy partial fractions, we obtain\n\\begin{align*}\nf'(t) &= \\left. \\frac{2 t \\arctan(x) - 2 \\log(tx+1) + \\log(x^2+1)}{2(t^2+1)}\n\\right|_{x=0}^{x=1}\n\\\\ &= \\frac{\\pi t + 2 \\log(2) - 4 \\log(t+1)}{4(t^2+1)},\n\\end{align*}\nwhence\n\\[\nf(t) = \\frac{\\log(2) \\arctan(t)}{2} + \\frac{\\pi \\log(t^2+1)}{8}\n- \\int_0^t \\frac{\\log(t+1)}{t^2+1}\\,dt\n\\]\nand hence\n\\[\nf(1) = \\frac{\\pi \\log(2)}{4} - \\int_0^1 \\frac{\\log(t+1)}{t^2+1}\\,dt.\n\\]\nBut the integral on the right is again the desired integral $f(1)$, so\nwe may move it to the left to obtain\n\\[\n2f(1) = \\frac{\\pi \\log(2)}{4}\n\\]\nand hence $f(1) = \\pi \\log(2)/8$ as desired.\n\n\\textbf{Fourth solution:} (by David Rusin)\nWe have\n\\[\n\\int_0^1 \\frac{\\log(x+1)}{x^2+1}\\,dx =\n\\int_0^1 \\left( \\sum_{n=1}^\\infty \\frac{(-1)^{n-1} x^n}{n(x^2+1)} \\right)\\,dx.\n\\]\nWe next justify moving the sum  through the integral sign.\nNote that\n\\[\n\\sum_{n=1}^\\infty \\int_0^1 \\frac{(-1)^{n-1} x^n\\,dx}{n(x^2+1)}\n\\]\nis an alternating series whose terms strictly decrease to zero, so it\nconverges. Moreover, its partial sums alternately bound the previous\nintegral above and below, so the sum of the series coincides with the integral.\n\nPut\n\\[\nJ_n = \\int_0^1 \\frac{x^n\\,dx}{x^2+1};\n\\]\nthen $J_0 = \\arctan(1) = \\frac{\\pi}{4}$\nand $J_1 = \\frac{1}{2} \\log(2)$. Moreover,\n\\[\nJ_{n} + J_{n+2} = \\int_0^1 x^n\\,dx = \\frac{1}{n+1}.\n\\]\nWrite\n\\begin{align*}\nA_m &= \\sum_{i=1}^m \\frac{(-1)^{i-1}}{2i-1} \\\\\nB_m &= \\sum_{i=1}^m \\frac{(-1)^{i-1}}{2i};\n\\end{align*}\nthen\n\\begin{align*}\nJ_{2n} &= (-1)^n (J_0 - A_n) \\\\\nJ_{2n+1} &= (-1)^n (J_1 - B_{n}).\n\\end{align*}\nNow the $2N$-th partial sum of our series equals\n\\begin{multline*}\n\\sum_{n=1}^{N} \\left[\\frac{J_{2n-1}}{2n-1} -  \\frac{J_{2n}}{2n}\\right] \\\\\n\\begin{aligned}\n&= \\sum_{n=1}^{N} \\frac{(-1)^{n-1}}{2n-1} \\left[(J_1 - B_{n-1})\n- \\frac{(-1)^n}{2n}(J_0 - A_n)\\right] \\\\\n&= A_{N}(J_1 - B_{N-1}) + B_N(J_0 - A_N) + A_N B_N.\n\\end{aligned}\n\\end{multline*}\nAs $N \\to \\infty$, $A_N \\to J_0$ and $B_N \\to J_1$,\nso the sum tends to $J_0 J_1 = \\pi \\log(2)/8$.\n\n\\textbf{Fifth solution:}\n(suggested by Alin Bostan)\nNote that\n\\[\n\\log(1+x) = \\int_0^1 \\frac{x\\,dy}{1 + xy},\n\\]\nso the desired integral $I$ may be written as\n\\[\nI = \\int_0^1 \\int_0^1 \\frac{x\\,dy\\,dx}{(1 + xy)(1+x^2)}.\n\\]\nWe may interchange $x$ and $y$ in this expression, then use Fubini's theorem to interchange\nthe order of summation, to obtain\n\\[\nI = \\int_0^1 \\int_0^1 \\frac{y\\,dy\\,dx}{(1 + xy)(1+y^2)}.\n\\]\nWe then add these expressions to obtain\n\\begin{align*}\n2I &= \\int_0^1 \\int_0^1 \\left( \\frac{x}{1+x^2} + \\frac{y}{1+y^2}\n\\right) \\frac{dy\\,dx}{1+xy} \\\\\n&= \\int_0^1 \\int_0^1  \\frac{x+y+xy^2+x^2y}{(1+x^2)(1+y^2)} \\frac{dy\\,dx}{1+xy}  \\\\\n&= \\int_0^1 \\int_0^1  \\frac{(x+y)\\,dy\\,dx}{(1+x^2)(1+y^2)}.\n\\end{align*}\nBy another symmetry argument, we have\n\\[\n2I = 2 \\int_0^1 \\int_0^1 \\frac{x\\,dy\\,dx}{(1+x^2)(1+y^2)},\n\\]\nso\n\\[\nI = \\left(\\int_0^1 \\frac{x\\,dx}{1+x^2} \\right) \\left( \\int_0^1 \\frac{1}{1+y^2} \\right)\n= \\log(2) \\cdot \\frac{\\pi}{8}.\n\\]\n\n\\textbf{Remarks:}\nThe first two solutions are related by the fact that if $x = \\tan(\\theta)$,\nthen $1-x/(1+x) = \\tan(\\pi/4 - \\theta)$.\nThe strategy of the third solution (introducing a parameter then\ndifferentiating it) was a favorite of physics Nobelist (and Putnam Fellow)\nRichard Feynman.\nThe fifth solution resembles Gauss's evaluation of $\\int_{-\\infty}^\\infty \\exp(-x^2)\\,dx$.\nNoam Elkies notes that this integral is number 2.491\\#8 in\nGradshteyn and Ryzhik,\n\\textit{Table of integrals, series, and products}.\nThe \\emph{Mathematica} computer algebra system (version 5.2)\nsuccessfully computes\nthis integral, but we do not know how.", "category": "Algebra", "source": "PUTNAM", "year": 2005}
{"id": "putnam-2005-a6", "question": "Let $n$ be given, $n \\geq 4$, and suppose that $P_1, P_2, \\dots, P_n$\nare $n$ randomly, independently and uniformly, chosen points on a circle.\nConsider the convex $n$-gon whose vertices are the $P_i$. What is the\nprobability that at least one of the vertex angles of this polygon is\nacute?", "solution": "\\textbf{First solution:}\nThe angle at a vertex $P$ is acute if and only if all of the other points\nlie on an open semicircle. We first deduce from this that if there are any\ntwo acute angles at all, they must occur consecutively. Suppose the contrary;\nlabel the vertices $Q_1, \\dots, Q_n$ in counterclockwise order (starting anywhere),\nand suppose that the angles at $Q_1$ and $Q_i$ are acute for some $i$\nwith $3 \\leq i \\leq n-1$.\nThen the open semicircle starting at $Q_2$ and proceeding counterclockwise\nmust contain all of $Q_3, \\dots, Q_n$, while the open semicircle starting at\n$Q_i$ and proceeding counterclockwise must contain $Q_{i+1}, \\dots,\nQ_n, Q_1, \\dots, Q_{i-1}$. Thus two open semicircles cover the entire circle,\ncontradiction.\n\nIt follows that if the polygon has at least one acute angle, then\nit has either one acute angle or two acute angles\noccurring consecutively. In particular, there\nis a unique pair of consecutive vertices $Q_1, Q_2$ in counterclockwise order\nfor which $\\angle Q_2$ is acute and $\\angle Q_1$ is not acute.\nThen the remaining points all lie in the arc from the antipode of $Q_1$\nto $Q_1$, but $Q_2$ cannot lie in the arc, and the remaining points\ncannot all lie in the arc from the antipode of $Q_1$ to the antipode\nof $Q_2$. Given the choice of $Q_1, Q_2$, let $x$ be the measure of\nthe counterclockwise arc from $Q_1$ to $Q_2$; then the probability that\nthe other points fall into position is\n$2^{-n+2} - x^{n-2}$ if $x \\leq 1/2$ and 0 otherwise.\n\nHence the probability that the polygon has at least one acute angle with\na \\emph{given} choice of which two points will act as $Q_1$ and $Q_2$ is\n\\[\n\\int_0^{1/2} (2^{-n+2} - x^{n-2})\\,dx\n= \\frac{n-2}{n-1} 2^{-n+1}.\n\\]\nSince there are $n(n-1)$ choices for which two points act as $Q_1$ and $Q_2$,\nthe probability of at least one acute angle is $n(n-2) 2^{-n+1}$.\n\n\\textbf{Second solution:}\n(by Calvin Lin)\nAs in the first solution, we may compute the probability that for a\nparticular one of the points $Q_1$, the angle at $Q_1$ is not acute but\nthe following angle is, and then multiply by $n$.\nImagine picking the points by first choosing $Q_1$, then\npicking $n-1$ \\emph{pairs}\nof antipodal points and then picking one\nmember of each pair. Let $R_2, \\dots, R_n$ be the points of the pairs\nwhich lie in the semicircle, taken in order away from $Q_1$,\nand let $S_2, \\dots, S_n$ be the antipodes of these. Then to\nget the desired situation,\nwe must choose from the pairs to end up with all but one of the\n$S_i$, and we cannot take $R_n$ and the other $S_i$ or else $\\angle Q_1$ will be\nacute. That gives us $(n-2)$ good choices out of $2^{n-1}$; since we could\nhave chosen $Q_1$ to be any of the $n$ points, the probability is again\n$n(n-2) 2^{-n+1}$.", "category": "Geometry", "source": "PUTNAM", "year": 2005}
{"id": "putnam-2005-b1", "question": "Find a nonzero polynomial $P(x,y)$ such that $P(\\lfloor a \\rfloor,\n\\lfloor 2a \\rfloor) = 0$ for all real numbers $a$.\n(Note: $\\lfloor \\nu \\rfloor$ is the greatest integer less than\nor equal to $\\nu$.)", "solution": "Take $P(x,y) = (y-2x)(y-2x-1)$.\nTo see that this works, first note that if $m = \\lfloor a \\rfloor$,\nthen $2m$ is an integer less than or equal to $2a$, so\n$2m \\leq \\lfloor 2a \\rfloor$. On the other hand, $m+1$\nis an integer strictly greater than $a$, so $2m+2$ is an integer\nstrictly greater than $2a$, so $\\lfloor 2a \\rfloor \\leq 2m+1$.", "category": "Algebra", "source": "PUTNAM", "year": 2005}
{"id": "putnam-2005-b2", "question": "Find all positive integers $n, k_1, \\dots, k_n$ such that\n$k_1 + \\cdots + k_n = 5n-4$ and\n\\[\n\\frac{1}{k_1} + \\cdots + \\frac{1}{k_n} = 1.\n\\]", "solution": "By the arithmetic-harmonic mean inequality or the Cauchy-Schwarz inequality,\n\\[\n(k_1 + \\cdots + k_n)\\left(\\frac{1}{k_1} + \\cdots + \\frac{1}{k_n} \\right)\n\\geq n^2.\n\\]\nWe must thus have $5n-4 \\geq n^2$, so $n \\leq 4$. Without loss of generality,\nwe may suppose that $k_1 \\leq \\cdots \\leq k_n$.\n\nIf $n=1$, we must have $k_1 = 1$, which works. Note that hereafter we cannot\nhave $k_1 =1$.\n\nIf $n = 2$, we have $(k_1,k_2) \\in \\{(2,4), (3,3)\\}$, neither of which work.\n\nIf $n=3$, we have $k_1 +k_2 +k_3 =11$, so $2 \\leq k_1 \\leq 3$.\nHence\n\\[\n(k_1,k_2,k_3) \\in \\{(2,2,7),(2,3,6),(2,4,5),(3,3,5),(3,4,4)\\},\n\\]\nand only $(2,3,6)$ works.\n\nIf $n = 4$, we must have equality in the AM-HM inequality, which only\nhappens when $k_1 = k_2 = k_3 = k_4 = 4$.\n\nHence the solutions are $n = 1$ and $k_1 = 1$,\n$n=3$ and $(k_1,k_2,k_3)$ is a permutation of $(2,3,6)$,\nand $n=4$ and $(k_1,k_2,k_3,k_4) = (4,4,4,4)$.\n\n\\textbf{Remark:}\nIn the cases $n=2,3$, Greg Kuperberg suggests the alternate\napproach of\nenumerating the\nsolutions of $1/k_1 + \\cdots + 1/k_n = 1$ with $k_1 \\leq \\cdots \\leq k_n$.\nThis is easily done by\nproceeding in lexicographic order: one obtains $(2,2)$ for $n=2$, and\n$(2,3,6), (2,4,4), (3,3,3)$ for $n=3$, and only $(2,3,6)$ contributes\nto the final answer.", "category": "Combinatorics", "source": "PUTNAM", "year": 2005}
{"id": "putnam-2005-b3", "question": "Find all differentiable functions $f: (0, \\infty) \\to (0, \\infty)$ for which\nthere is a positive real number $a$ such that\n\\[\nf' \\left( \\frac{a}{x} \\right) = \\frac{x}{f(x)}\n\\]\nfor all $x > 0$.", "solution": "\\textbf{First solution:}\nThe functions are precisely $f(x) = cx^d$ for $c,d > 0$ arbitrary\nexcept that we must take $c=1$ in case $d=1$. To see that these work,\nnote that $f'(a/x) = d c (a/x)^{d-1}$ and $x/f(x) = 1/(c x^{d-1})$,\nso the given equation holds if and only if $d c^2 a^{d-1} = 1$. If\n$d \\neq 1$, we may solve for $a$ no matter what $c$ is; if\n$d=1$, we must have $c=1$. (Thanks to Brad Rodgers for pointing out\nthe $d=1$ restriction.)\n\nTo check that these are all solutions,\nput $b = \\log(a)$ and $y = \\log(a/x)$; rewrite the given equation as\n\\[\nf(e^{b-y}) f'(e^y) = e^{b-y}.\n\\]\nPut\n\\[\ng(y) = \\log f(e^y);\n\\]\nthen the given equation rewrites as\n\\[\ng(b-y) + \\log g'(y) + g(y) - y = b-y,\n\\]\nor\n\\[\n\\log g'(y) = b -g(y) - g(b-y).\n\\]\nBy the symmetry of the right side,\nwe have $g'(b-y) = g'(y)$. Hence the function\n$g(y) + g(b-y)$ has zero derivative and so is constant,\nas then is $g'(y)$.\nFrom this we deduce that $f(x) = cx^d$ for some $c,d$, both\nnecessarily positive since $f'(x) > 0$ for all $x$.\n\n\\textbf{Second solution:}\n(suggested by several people)\nSubstitute $a/x$ for $x$ in the given equation:\n\\[\nf'(x) = \\frac{a}{xf(a/x)}.\n\\]\nDifferentiate:\n\\[\nf''(x) = - \\frac{a}{x^2 f(a/x)}\n+ \\frac{a^2 f'(a/x)}{x^3 f(a/x)^2}.\n\\]\nNow substitute to eliminate evaluations at $a/x$:\n\\[\nf''(x) = - \\frac{f'(x)}{x}\n+ \\frac{f'(x)^2}{f(x)}.\n\\]\nClear denominators:\n\\[\nx f(x) f''(x) + f(x) f'(x) = x f'(x)^2.\n\\]\nDivide through by $f(x)^2$ and rearrange:\n\\[\n0 = \\frac{f'(x)}{f(x)} + \\frac{x f''(x)}{f(x)} - \\frac{x f'(x)^2}{f(x)^2}.\n\\]\nThe right side is the derivative of $x f'(x)/f(x)$, so that quantity\nis constant. That is, for some $d$,\n\\[\n\\frac{f'(x)}{f(x)} = \\frac{d}{x}.\n\\]\nIntegrating yields $f(x) = cx^d$, as desired.", "category": "Algebra", "source": "PUTNAM", "year": 2005}
{"id": "putnam-2005-b4", "question": "For positive integers $m$ and $n$, let $f(m,n)$ denote the number of\n$n$-tuples $(x_1,x_2,\\dots,x_n)$ of integers such that\n$|x_1| + |x_2| + \\cdots + |x_n| \\leq m$.\nShow that $f(m,n) = f(n,m)$.", "solution": "\\textbf{First solution:}\nDefine $f(m,n,k)$ as the number of $n$-tuples $(x_1, x_2,\\dots,x_n)$\nof integers such that $|x_1| + \\cdots + |x_n| \\leq m$ and exactly\n$k$ of $x_1, \\dots, x_n$ are nonzero. To choose such a tuple, we may choose\nthe $k$ nonzero positions, the signs of those $k$ numbers, and\nthen an ordered $k$-tuple of positive integers with sum $\\leq m$.\nThere are $\\binom{n}{k}$ options for the first choice, and $2^k$ for the\nsecond. As for the third, we have\n$\\binom{m}{k}$ options by a ``stars and bars'' argument: depict the\n$k$-tuple by drawing a number of stars for each term, separated by bars,\nand adding stars at the end to get a total of $m$ stars. Then each tuple\ncorresponds to placing $k$ bars, each in a different position behind one\nof the $m$ fixed stars.\n\nWe conclude that\n\\[\nf(m,n,k) = 2^k\\binom{m}{k} \\binom{n}{k} = f(n,m,k);\n\\]\nsumming over $k$ gives $f(m,n) = f(n,m)$. (One may also extract easily a\nbijective interpretation of the equality.)\n\n\\textbf{Second solution:}\n(by Greg Kuperberg)\nIt will be convenient to extend the definition of $f(m,n)$ to $m,n \\geq 0$,\nin which case we have $f(0,m) = f(n,0) = 1$.\n\nLet $S_{m,n}$ be the set of $n$-tuples $(x_1, \\dots, x_n)$ of integers\nsuch that $|x_1| + \\cdots + |x_n| \\leq m$. Then elements of $S_{m,n}$\ncan be classified into three types. Tuples with $|x_1| + \\cdots + |x_n| < m$\nalso belong to $S_{m-1,n}$. Tuples with $|x_1| + \\cdots + |x_n| = m$\nand $x_n \\geq 0$ correspond to elements of $S_{m,n-1}$ by dropping $x_n$.\nTuples with $|x_1| + \\cdots + |x_n| = m$ and $x_n < 0$ correspond to\nelements of $S_{m-1,n-1}$ by dropping $x_n$. It follows that\n\\[\nf(m,n) = f(m-1,n) + f(m,n-1) + f(m-1,n-1),\n\\]\nso $f$ satisfies a symmetric recurrence with symmetric boundary conditions\n$f(0,m) = f(n,0) = 1$. Hence $f$ is symmetric.\n\n\\def\\ZZ{\\mathbb{Z}}\n\\textbf{Third solution:}\n(by Greg Martin)\nAs in the second solution,\nit is convenient to allow $f(m,0)=f(0,n)=1$. Define the generating function\n\\[\nG(x,y) = \\sum_{m=0}^\\infty \\sum_{n=0}^\\infty f(m,n) x^m y^n.\n\\]\nAs equalities of formal power series (or convergent series on,\nsay, the region $|x|,|y|<\\frac13$), we have\n\\begin{align*}\nG(x,y) &= \\sum_{m\\ge0} \\sum_{n\\ge0} x^m y^n \\sum_{\\substack{k_1,\\,\\dots,\\,k_n \\in \\ZZ \\\\ |k_1| + \\cdots + |k_n| \\le m}} 1 \\\\\n&= \\sum_{n\\ge0} y^n \\sum_{k_1,\\,\\dots,\\,k_n \\in \\ZZ} \\sum_{m\\ge|k_1| + \\cdots + |k_n|} x^m \\\\\n&= \\sum_{n\\ge0} y^n \\sum_{k_1,\\,\\dots,\\,k_n \\in \\ZZ} \\frac{x^{|k_1| + \\cdots + |k_n|}}{1-x} \\\\\n&= \\frac1{1-x} \\sum_{n\\ge0} y^n \\bigg( \\sum_{k\\in\\ZZ} x^{|k|} \\bigg)^n \\\\\n&= \\frac1{1-x} \\sum_{n\\ge0} y^n \\bigg( \\frac{1+x}{1-x} \\bigg)^n \\\\\n&= \\frac1{1-x} \\cdot \\frac1{1-y(1+x)/(1-x)} \\\\\n&= \\frac1{1-x-y-xy}.\n\\end{align*}\nSince $G(x,y) = G(y,x)$, it follows that $f(m,n) = f(n,m)$ for all $m,n\\ge0$.", "category": "Combinatorics", "source": "PUTNAM", "year": 2005}
{"id": "putnam-2005-b5", "question": "Let $P(x_1,\\dots,x_n)$ denote a polynomial with real coefficients in the\nvariables $x_1, \\dots, x_n$, and suppose that\n\\[\n\\left( \\frac{\\partial^2}{\\partial x_1^2} + \\cdots + \\frac{\\partial^2}{\\partial\nx_n^2}\\right) P(x_1, \\dots,x_n) = 0 \\quad \\mbox{(identically)}\n\\] % Equation labelled (a) (label to the left of the equation) in AMM version.\nand that\n\\[\nx_1^2 + \\cdots + x_n^2 \\mbox{ divides } P(x_1, \\dots, x_n).\n\\] % Equation labelled (b) (label to the left of the equation) in AMM version.\nShow that $P=0$ identically.", "solution": "\\textbf{First solution:}\nPut $Q = x_1^2 + \\cdots + x_n^2$. Since $Q$ is homogeneous, $P$ is divisible\nby $Q$ if and only if each of the homogeneous components of $P$ is divisible\nby $Q$. It is thus sufficient to solve the problem in case $P$ itself is\nhomogeneous, say of degree $d$.\n\nSuppose that we have a factorization $P = Q^m R$ for some $m>0$, where\n$R$ is homogeneous\nof degree $d$ and not divisible by $Q$;\nnote that the homogeneity implies that\n\\[\n\\sum_{i=1}^n x_i \\frac{\\partial R}{\\partial x_i} = dR.\n\\]\nWrite $\\nabla^2$ as shorthand for $\\frac{\\partial^2}{\\partial\nx_1^2} + \\cdots + \\frac{\\partial^2}{\\partial x_n^2}$; then\n\\begin{align*}\n0 &= \\nabla^2 P \\\\\n&= 2mn Q^{m-1}R + Q^m \\nabla^2 R + 2 \\sum_{i=1}^n 2mx_i Q^{m-1}\n\\frac{\\partial R}{\\partial\nx_i} \\\\\n&= Q^m \\nabla^2 R + (2mn + 4md) Q^{m-1} R.\n\\end{align*}\nSince $m>0$, this forces $R$ to be divisible by $Q$, contradiction.\n\n\\textbf{Second solution:}\n(by Noam Elkies)\nRetain notation as in the first solution.\nLet $P_d$ be the set of homogeneous\npolynomials of degree $d$, and let $H_d$ be the subset of $P_d$\nof polynomials killed by $\\nabla^2$, which has dimension\n$\\geq \\dim(P_d) - \\dim(P_{d-2})$; the given problem amounts to showing\nthat this inequality is actually an equality.\n\nConsider the operator $Q \\nabla^2$ (i.e., apply $\\nabla^2$ then multiply\nby $Q$) on $P_d$; its zero eigenspace is precisely $H_d$.\nBy the calculation from the first solution, if $R \\in P_d$, then\n\\[\n\\nabla^2 (QR) - Q \\nabla^2 R = (2n+4d)R.\n\\]\nConsequently, $Q^j H_{d-2j}$ is contained in the eigenspace of $Q \\nabla^2$\non $P_d$ of eigenvalue\n\\[\n(2n+4(d-2j)) + \\cdots + (2n+4(d-2)).\n\\]\nIn particular, the $Q^j H^{d-2j}$ lie in distinct eigenspaces, so are\nlinearly independent within $P_d$. But by dimension counting,\ntheir total dimension is at least that of $P_d$.\nHence they exhaust $P_d$, and the zero eigenspace cannot have dimension\ngreater than $\\dim(P_d) - \\dim(P_{d-2})$, as desired.\n\n\\textbf{Third solution:}\n(by Richard Stanley)\nWrite $x = (x_1, \\dots, x_n)$ and $\\nabla = (\\frac{\\partial}{\\partial x_1},\n\\dots, \\frac{\\partial}{\\partial x_n})$.\nSuppose that $P(x) = Q(x)(x_1^2 + \\cdots + x_n^2)$. Then\n\\[\nP(\\nabla)P(x) = Q(\\nabla)(\\nabla^2)P(x) =0.\n\\]\nOn the other hand,\nif $P(x) = \\sum_\\alpha c_\\alpha x^\\alpha$ (where $\\alpha = (\\alpha_1,\n\\dots, \\alpha_n)$ and $x^\\alpha = x_1^{\\alpha_1} \\cdots\nx_n^{\\alpha_n}$), then the constant term of $P(\\nabla)P(x)$\nis seen to be $\\sum_\\alpha c_\\alpha^2$. Hence $c_\\alpha = 0$ for all\n$\\alpha$.\n\n\\textbf{Remarks:}\nThe first two solutions apply directly over any field of characteristic zero.\n(The result fails in characteristic $p>0$ because we may take\n$P = (x_1^2 + \\cdots + x_n^2)^p = x_1^{2p} + \\cdots + x_n^{2p}$.)\nThe third solution can be extended to complex coefficients\nby replacing $P(\\nabla)$ by its complex conjugate, and again the result\nmay be deduced for any field of characteristic zero.\nStanley also suggests\nSection 5 of the arXiv e-print \\texttt{math.CO/0502363} for\nsome  algebraic background for this problem.", "category": "Algebra", "source": "PUTNAM", "year": 2005}
{"id": "putnam-2005-b6", "question": "Let $S_n$ denote the set of all permutations of the numbers $1,2,\\dots,n$.\nFor $\\pi \\in S_n$, let $\\sigma(\\pi) = 1$ if $\\pi$ is an even permutation\nand $\\sigma(\\pi) = -1$ if $\\pi$ is an odd permutation.\nAlso, let $\\nu(\\pi)$ denote the number of fixed points of $\\pi$.\nShow that\n\\[\n\\sum_{\\pi \\in S_n} \\frac{\\sigma(\\pi)}{\\nu(\\pi) + 1} = (-1)^{n+1}\n\\frac{n}{n+1}.\n\\]\n\\end{itemize}\n\\end{document}", "solution": "\\textbf{First solution:}\nLet $I$ be the identity matrix, and let\n$J_x$ be the matrix with $x$'s on the diagonal and 1's elsewhere.\nNote that $J_x - (x-1)I$, being the all 1's matrix, has rank 1 and trace $n$,\nso has $n-1$ eigenvalues equal to 0 and one equal to $n$.\nHence $J_x$ has $n-1$ eigenvalues equal to $x-1$ and one equal to $x+n-1$,\nimplying\n\\[\n\\det J_x = (x+n-1)(x-1)^{n-1}.\n\\]\nOn the other hand, we may expand the determinant as a sum indexed by\npermutations, in which case we get\n\\[\n\\det J_x = \\sum_{\\pi \\in S_n} \\sgn(\\pi) x^{\\nu(\\pi)}.\n\\]\nIntegrating both sides from 0 to 1 (and substituting $y=1-x$) yields\n\\begin{align*}\n\\sum_{\\pi \\in S_n} \\frac{\\sgn(\\pi)}{\\nu(\\pi) + 1}\n&= \\int_0^1 (x+n-1)(x-1)^{n-1}\\,dx \\\\\n&= \\int_0^1 (-1)^{n+1} (n-y)y^{n-1}\\,dy \\\\\n&= (-1)^{n+1} \\frac{n}{n+1},\n\\end{align*}\nas desired.\n\n\\textbf{Second solution:}\nWe start by recalling a form of the principle of inclusion-exclusion:\nif $f$ is a function on the power set of $\\{1, \\dots, n\\}$, then\n\\[\nf(S) = \\sum_{T \\supseteq S} (-1)^{|T|-|S|} \\sum_{U \\supseteq T} f(U).\n\\]\nIn this case we take $f(S)$ to be the sum of $\\sigma(\\pi)$\nover all permutations $\\pi$ whose fixed points are exactly $S$.\nThen $\\sum_{U \\supseteq T} f(U) = 1$ if $|T| \\geq n-1$\nand 0 otherwise (since a permutation group on 2 or more symbols has as many even and odd permutations), so\n\\[\nf(S) = (-1)^{n-|S|}(1 - n + |S|).\n\\]\nThe desired sum can thus be written, by grouping over fixed point sets, as\n\\begin{multline*}\n\\sum_{i=0}^n \\binom{n}{i} (-1)^{n-i} \\frac{1-n+i}{i+1} \\\\\n\\begin{aligned}\n&= \\sum_{i=0}^n (-1)^{n-i} \\binom{n}{i} - \\sum_{i=0}^n (-1)^{n-i} \\frac{n}{i+1}\n\\binom{n}{i} \\\\\n&= 0 - \\sum_{i=0}^n (-1)^{n-i} \\frac{n}{n+1} \\binom{n+1}{i+1} \\\\\n&= (-1)^{n+1} \\frac{n}{n+1}.\n\\end{aligned}\n\\end{multline*}\n\n\\textbf{Third solution:}\n(by Richard Stanley)\nThe \\emph{cycle indicator} of the symmetric group $S_n$ is defined by\n\\[\nZ_n(x_1, \\dots, x_n) = \\sum_{\\pi \\in S_n} x_1^{c_1(\\pi)} \\cdots x_n^{c_n(\\pi)},\n\\]\nwhere $c_i(\\pi)$ is the number of cycles of $\\pi$ of length $i$.\nPut\n\\[\nF_n = \\sum_{\\pi \\in S_n} \\sigma(\\pi) x^{\\nu(\\pi)} =\nZ_n(x,-1,1,-1,1,\\dots)\n\\]\nand\n\\[\nf(n) =  \\sum_{\\pi \\in S_n} \\frac{\\sigma(\\pi)}{\\nu(\\pi) + 1}\n= \\int_0^1 F_n(x)\\,dx.\n\\]\nA standard argument in enumerative combinatorics (the\nExponential Formula) gives\n\\[\n\\sum_{n=0}^\\infty Z_n(x_1,\\dots,x_n) \\frac{t^n}{n!}\n= \\exp \\sum_{k=1}^{\\infty} x_k \\frac{t^k}{k},\n\\]\nyielding\n\\begin{align*}\n\\sum_{n=0}^\\infty\nf(n) \\frac{t^n}{n!} &= \\int_0^1 \\exp \\left( xt - \\frac{t^2}{2}\n+ \\frac{t^3}{3} - \\cdots \\right)\\,dx \\\\\n&= \\int_0^1 e^{(x-1)t + \\log(1+t)}\\,dx \\\\\n&= \\int_0^1 (1+t) e^{(x-1)t}\\,dx \\\\\n&= \\frac{1}{t} (1-e^{-t}) (1+t).\n\\end{align*}\nExpanding the right side as a Taylor series and comparing coefficients\nyields the desired result.\n\n\\textbf{Fourth solution (sketch):}\n(by David Savitt)\nWe prove the identity of rational functions\n\\[\n\\sum_{\\pi \\in S_n} \\frac{\\sigma(\\pi)}{\\nu(\\pi) + x}\n= \\frac{(-1)^{n+1} n! (x+n-1)}{x(x+1)\\cdots(x+n)}\n\\]\nby induction on $n$, which for $x=1$ implies the desired result.\n(This can also be deduced as in the other solutions, but in this argument\nit is necessary to formulate the strong induction hypothesis.)\n\nLet $R(n,x)$ be the right hand side of the above equation. It is\neasy to verify that\n\\begin{align*}\nR(x,n) &= R(x+1,n-1) + (n-1)! \\frac{(-1)^{n+1}}{x} \\\\\n&\\qquad + \\sum_{l=2}^{n-1} (-1)^{l-1}  \\frac{(n-1)!}{(n-l)!} R(x,n-l),\n\\end{align*}\nsince the sum telescopes. To prove the desired equality,\nit suffices to show that the left hand side satisfies the same\nrecurrence. This follows because we can classify each $\\pi \\in S_n$\nas either fixing $n$, being an $n$-cycle, or having $n$ in an\n$l$-cycle for one of $l=2,\\dots,n-1$; writing the sum\nover these classes gives the desired recurrence.\n\n\\end{itemize}\n\n\n\\end{document}", "category": "Combinatorics", "source": "PUTNAM", "year": 2005}
{"id": "imo-1999-q1", "question": "A set $S$ of points from the space will be called\ncompletely symmetric if it has at least three elements\nand fulfills the condition that for every two distinct points $A$ and $B$ from $S$,\nthe perpendicular bisector plane of the segment $AB$ is a plane of symmetry for $S$.\nProve that if a completely symmetric set is finite,\nthen it consists of the vertices of either a regular polygon,\nor a regular tetrahedron or a regular octahedron.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p131833}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA set $S$ of points from the space will be called\ncompletely symmetric if it has at least three elements\nand fulfills the condition that for every two distinct points $A$ and $B$ from $S$,\nthe perpendicular bisector plane of the segment $AB$ is a plane of symmetry for $S$.\nProve that if a completely symmetric set is finite,\nthen it consists of the vertices of either a regular polygon,\nor a regular tetrahedron or a regular octahedron.\n\\end{mdframed}\nLet $G$ be the centroid of $S$.\n\n\\begin{claim*}\n  All points of $S$ lie on a sphere $\\Gamma$ centered at $G$.\n\\end{claim*}\n\\begin{proof}\n  Each perpendicular bisector plane passes through $G$.\n  So if $A,B \\in S$ it follows $GA = GB$.\n\\end{proof}\n\n\\begin{claim*}\n  Consider any plane passing through three or more points of $S$.\n  The points of $S$ in the plane form a regular polygon.\n\\end{claim*}\n\\begin{proof}\n  The cross section is a circle because we are intersecting a plane with sphere $\\Gamma$.\n  Now if $A$, $B$, $C$ are three adjacent points on this circle,\n  by taking the perpendicular bisector we have $AB=BC$.\n\\end{proof}\n\nIf the points of $S$ all lie in a plane, we are done.\nOtherwise, the points of $S$ determine a polyhedron $\\Pi$ inscribed in $\\Gamma$.\nAll of the faces of $\\Pi$ are evidently regular polygons,\nof the same side length $s$.\n\n\\begin{claim*}\n  Every face of $\\Pi$ is an equilateral triangle.\n\\end{claim*}\n\\begin{proof}\n  Suppose on the contrary some face $A_1 A_2 \\dots A_n$ has $n > 3$.\n  Let $B$ be any vertex adjacent to $A_1$ in $\\Pi$ other than $A_2$ or $A_n$.\n  Consider the plane determined by $\\triangle A_1 A_3 B$.\n  This is supposed to be a regular polygon, but arc $A_1 A_3$ is longer than arc $A_1 B$,\n  and by construction there are no points inside these arcs.\n  This is a contradiction.\n\\end{proof}\n\nHence, $\\Pi$ has faces all congruent equilateral triangles.\nThis implies it is a regular polyhedron --- either\na regular tetrahedron, regular octahedron, or regular icosahedron.\nWe can check the regular icosahedron fails by\ntaking two antipodal points as our counterexample.\nThis finishes the problem.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 1999}
{"id": "imo-1999-q2", "question": "Find the least constant $C$ such that for any integer $n > 1$ the inequality\n\\[\\sum_{1 \\le i < j \\le n} x_i x_j (x_i^2 + x_j^2)\n  \\le C \\left( \\sum_{1 \\le i \\le n} x_i \\right)^4\\]\nholds for all real numbers $x_1, \\dots, x_n \\ge 0$.\nDetermine the cases of equality.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p131846}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind the least constant $C$ such that for any integer $n > 1$ the inequality\n\\[\\sum_{1 \\le i < j \\le n} x_i x_j (x_i^2 + x_j^2)\n  \\le C \\left( \\sum_{1 \\le i \\le n} x_i \\right)^4\\]\nholds for all real numbers $x_1, \\dots, x_n \\ge 0$.\nDetermine the cases of equality.\n\\end{mdframed}\nAnswer: $C = \\frac 18$, with equality when two $x_i$ are equal\nand the remaining $x_i$ are equal to zero.\n\nWe present two proofs of the bound.\n\n\\paragraph{First solution by smoothing.}\nFix $\\sum x_i = 1$.\nThe sum on the left-hand side can be interpreted as\n$\\sum_{i=1}^n x_i^3 \\sum_{j \\neq i} x_j = \\sum_{i=1}^n x_i^3(1-x_i)$,\nso we may rewrite the inequality as:\nThen it becomes \\[ \\sum_i (x_i^3 - x_i^4) \\le C. \\]\n\n\\begin{claim*}\n  [Smoothing]\n  Let $f(x) = x^3 - x^4$.\n  If $u + v \\le \\frac 34$, then $f(u) + f(v) \\le f(0) + f(u+v)$.\n\\end{claim*}\n\\begin{proof}\n  Note that\n  \\begin{align*}\n    (u^3-u^4)+(v^3-v^4) &\\le (u+v)^3-(u+v)^4 \\\\\n    \\iff uv(4u^2+4v^2+6uv) &\\le 3uv(u+v)\n  \\end{align*}\n  If $u+v\\le \\frac 34$ this is obvious as $4u^2+4v^2+6uv \\le 4(u+v)^2$.\n\\end{proof}\n\nObserve that if three nonnegative reals have pairwise sums\nexceeding $\\frac34$ then they have sum at least $\\frac 98$.\nHence we can smooth until $n-2$ of the terms are zero.\nHence it follows\n\\[ C = \\max_{a+b=1} (a^3+b^3-a^4-b^4) \\]\nwhich is routine computation giving $C = \\frac18$.\n\n\\paragraph{Second solution by AM-GM (Nairit Sarkar).}\nWrite\n\\begin{align*}\n  \\text{LHS}\n  &\\le \\left( \\sum_{1 \\le k \\le n} x_k^2 \\right)\n  \\left( \\sum_{1 \\le i < j \\le n} x_i x_j \\right)\n  = \\half \\left( \\sum_{1 \\le k \\le n} x_k^2 \\right)\n  \\left( \\sum_{1 \\le i < j \\le n} 2 x_i x_j \\right) \\\\\n  &\\le \\half \\left( \\frac{\\sum_k x_k^2 + 2 \\sum_{i<j} x_i x_j}{2}  \\right)^2\n  = \\frac 18 \\left( \\sum_{1 \\le i < n} x_i \\right)^4\n\\end{align*}\nas desired.\n\\pagebreak", "category": "Algebra", "source": "IMO", "year": 1999}
{"id": "imo-1999-q3", "question": "Let $n$ be an even positive integer.\nFind the minimal number of cells on the $n \\times n$ board\nthat must be marked so that any cell\n(marked or not marked) has a marked neighboring cell.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p131873}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n$ be an even positive integer.\nFind the minimal number of cells on the $n \\times n$ board\nthat must be marked so that any cell\n(marked or not marked) has a marked neighboring cell.\n\\end{mdframed}\nFor every marked cell, consider the marked cell adjacent\nto it; in this way we have a \\emph{domino} of two cells.\nFor each domino, its \\emph{aura} consists of all the cells\nwhich are adjacent to a cell of the domino.\nThere are up to eight squares in each aura,\nbut some auras could be cut off by the boundary of the board,\nwhich means that there could be as few as five squares.\n\nWe will prove that $\\half n (n+2)$\nis the minimum number of auras\nneeded to cover the board\n(the auras need not be disjoint).\n\\begin{itemize}\n  \\ii A construction is shown on the left below,\n  showing that $\\half n (n+2)$.\n  \\ii Color the board as shown to the right into ``rings''.\n  Every aura takes covers exactly (!) four blue cells.\n  Since there are $2n(n+2)$ blue cells, this implies the lower bound.\n\\end{itemize}\n\n\\begin{center}\n\\begin{asy}\nsize(11cm);\n\npath aura = (1,0)--(2,0)--(2,1)--(3,1)--(3,3)--(2,3)--(2,4)--(1,4)--(1,3)--(0,3)--(0,1)--(1,1)--cycle;\npicture aura_up(pen fill) {\n  picture pic = new picture;\n  fill(pic, aura, fill);\n  draw(pic, (1,1)--(2,1), lightgray );\n  draw(pic, (1,3)--(2,3), lightgray );\n  draw(pic, (0,2)--(3,2), lightgray );\n  draw(pic, (1,1)--(1,3), lightgray );\n  draw(pic, (2,1)--(2,3), lightgray );\n  draw(pic, aura, blue+1.25);\n  return pic;\n}\n\npicture aura_right(pen fill) {\n  return shift(0,3) * rotate(-90) * aura_up(fill);\n}\n\nadd(shift(-1,-1)*aura_up(palegreen));\nadd(shift(-1,3)*aura_up(palegreen));\nadd(shift(-1,7)*aura_up(palegreen));\nadd(shift(1,1)*aura_up(palegreen));\nadd(shift(1,5)*aura_up(palegreen));\nadd(shift(3,3)*aura_up(palegreen));\nadd(shift(6,3)*aura_up(palegreen));\nadd(shift(8,1)*aura_up(palegreen));\nadd(shift(8,5)*aura_up(palegreen));\nadd(shift(10,-1)*aura_up(palegreen));\nadd(shift(10,3)*aura_up(palegreen));\nadd(shift(10,7)*aura_up(palegreen));\n\nadd(shift(4,6)*aura_right(palered));\nadd(shift(2,8)*aura_right(palered));\nadd(shift(6,8)*aura_right(palered));\n/*\nadd(shift(0,10)*aura_right(palered));\nadd(shift(4,10)*aura_right(palered));\nadd(shift(8,10)*aura_right(palered));\n*/\nadd(shift(4,1)*aura_right(palered));\nadd(shift(2,-1)*aura_right(palered));\nadd(shift(6,-1)*aura_right(palered));\nadd(shift(0,-3)*aura_right(palered));\nadd(shift(4,-3)*aura_right(palered));\nadd(shift(8,-3)*aura_right(palered));\n\ndraw(shift(0,-2)*scale(12)*unitsquare, black+2);\n\npath cell = shift(16,-2)*unitsquare;\nfor (int i = 0; i <= 11; ++i) {\nfor (int j = 0; j <= 11; ++j) {\n  if (max(abs(i-5.5), abs(j-5.5)) == 5.5)\n    filldraw(shift(i,j)*cell, paleblue, gray);\n  else if (max(abs(i-5.5), abs(j-5.5)) == 3.5)\n    filldraw(shift(i,j)*cell, paleblue, gray);\n  else if (max(abs(i-5.5), abs(j-5.5)) == 1.5)\n    filldraw(shift(i,j)*cell, paleblue, gray);\n  else draw(shift(i,j)*cell, gray);\n}\n}\n\\end{asy}\n\\end{center}\n\nNote that this proves that a partition into disjoint auras\nactually always has exactly $\\half n (n+2)$ auras,\nthus also implying EGMO 2019/2.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Combinatorics", "source": "IMO", "year": 1999}
{"id": "imo-1999-q4", "question": "Find all pairs of positive integers $(x,p)$\nsuch that $p$ is a prime and $x^{p-1}$ is a divisor of $(p-1)^{x}+1$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p131811}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all pairs of positive integers $(x,p)$\nsuch that $p$ is a prime and $x^{p-1}$ is a divisor of $(p-1)^{x}+1$.\n\\end{mdframed}\nIf $p = 2$ then $x \\in \\{1,2\\}$,\nand if $p = 3$ then $x \\in \\{1,3\\}$, since this is IMO 1990/3.\nAlso, $x = 1$ gives a solution for any prime $p$.\nWe show that there are no other solutions.\n\nAssume $x > 1$ and let $q$ be smallest prime divisor of $x$.\nWe have $q > 2$ since $(p-1)^x+1$ is odd.\nThen\n\\[ (p-1)^x \\equiv -1 \\pmod q \\implies (p-1)^{2x} \\equiv 1 \\pmod q \\]\nso the order of $p-1 \\bmod q$ is even and divides $\\gcd(q-1,2x) \\le 2$.\nThis means that\n\\[ p-1 \\equiv -1 \\pmod q \\implies p = q. \\]\n\nIn other words $p \\mid x$ and we get $x^{p-1} \\mid (p-1)^{x}+1$.\nBy exponent lifting lemma, we now have\n\\[ 0 < (p-1) \\nu_{p}(x) \\le 1 + \\nu_p(x). \\]\nThis forces $p=3$,\nwhich we already addressed.\n\\pagebreak", "category": "Number Theory", "source": "IMO", "year": 1999}
{"id": "imo-1999-q5", "question": "Two circles $\\Omega_{1}$ and $\\Omega_{2}$ touch internally the circle\n$\\Omega$ in $M$ and $N$ and the center of $\\Omega_{2}$ is on $\\Omega_{1}$.\nThe common chord of the circles $\\Omega_{1}$ and $\\Omega_{2}$\nintersects $\\Omega$ in $A$ and $B$\nLines $MA$ and $MB$ intersects $\\Omega_{1}$ in $C$ and $D$.\nProve that $\\Omega_{2}$ is tangent to $CD$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p131838}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nTwo circles $\\Omega_{1}$ and $\\Omega_{2}$ touch internally the circle\n$\\Omega$ in $M$ and $N$ and the center of $\\Omega_{2}$ is on $\\Omega_{1}$.\nThe common chord of the circles $\\Omega_{1}$ and $\\Omega_{2}$\nintersects $\\Omega$ in $A$ and $B$\nLines $MA$ and $MB$ intersects $\\Omega_{1}$ in $C$ and $D$.\nProve that $\\Omega_{2}$ is tangent to $CD$.\n\\end{mdframed}\nLet $P$ and $Q$ be the centers of $\\Omega_1$ and $\\Omega_2$.\n\nLet line $MQ$ meet $\\Omega_1$ again at $W$,\nthe homothetic image of $Q$ under $\\Omega_1 \\to \\Omega$.\n\nMeanwhile, let $T$ be the intersection of segment $PQ$\nwith $\\Omega_2$, and let $L$ be its homothetic image on $\\Omega$.\nSince $\\ol{PTQ} \\perp \\ol{AB}$, it follows $\\ol{LW}$ is a diameter of $\\Omega$.\nLet $O$ be its center.\n\n\\begin{center}\n\\begin{asy}\nsize(10cm);\npen xfqqff = rgb(0.49803,0.,1.); pen qqffff = rgb(0.,1.,1.); pen cqcqcq = rgb(0.75294,0.75294,0.75294);\npair O = (0.,0.), M = (-0.54799,0.83648), P = (-0.16957,0.25884), Q = (-0.16861,-0.43170), A = (-0.97449,-0.22439), B = (0.97512,-0.22166), C = (-0.84251,0.10388), D = (0.50379,0.10577), T = (-0.16936,0.10483), L = (-0.00139,0.99999);\ndraw(circle(O, 1.), linewidth(0.6));\ndraw(circle(P, 0.69055), linewidth(0.6) + xfqqff);\ndraw(circle(Q, 0.53653), linewidth(0.6) + xfqqff);\ndraw(O--M, linewidth(0.6) + red);\ndraw(M--A, linewidth(0.6) + qqffff);\ndraw(M--B, linewidth(0.6) + qqffff);\ndraw(O--(-0.36380,-0.93147), linewidth(0.6) + red);\ndraw(P--Q, linewidth(0.6));\ndraw(M--(0.00139,-0.99999), linewidth(0.6) + green);\ndraw((0.00139,-0.99999)--L, linewidth(0.6));\ndraw(L--(-0.36380,-0.93147), linewidth(0.6) + green);\ndraw(M--(-0.36380,-0.93147), linewidth(0.6));\ndraw(A--B, linewidth(0.6));\ndot(\"$O$\", O, dir((1.868, -2.897)));\ndot(\"$N$\", (-0.36380,-0.93147), dir((-5.700, -12.058)));\ndot(\"$M$\", M, dir((-8.656, 10.478)));\ndot(\"$P$\", P, dir((-2.789, 6.521)));\ndot(\"$Q$\", Q, dir((3.600, -6.558)));\ndot(\"$A$\", A, dir((-15.478, -5.915)));\ndot(\"$B$\", B, dir((4.982, -4.507)));\ndot(\"$C$\", C, dir((-8.023, -3.199)));\ndot(\"$D$\", D, dir((1.442, 0.454)));\ndot(\"$T$\", T, dir((-7.133, 1.989)));\ndot(\"$W$\", (0.00139,-0.99999), dir((-2.113, -15.052)));\ndot(\"$L$\", L, dir((1.046, 1.812)));\ndot(\"$E$\", midpoint(A--B), dir(-45));\n\\end{asy}\n\\end{center}\n\n\\begin{claim*}\n  $MNTQ$ is cyclic.\n\\end{claim*}\n\\begin{proof}\n  By Reim: $\\dang TQM = \\dang LWM = \\dang LNM = \\dang TNM$.\n\\end{proof}\n\nLet $E$ be the midpoint of $\\ol{AB}$.\n\\begin{claim*}\n  $OEMN$ is cyclic.\n\\end{claim*}\n\\begin{proof}\n  By radical axis, the lines $MM$, $NN$, $AEB$ meet at a point $R$.\n  Then $OEMN$ is on the circle with diameter $\\ol{OR}$.\n\\end{proof}\n\n\\begin{claim*}\n  $MTE$ are collinear.\n\\end{claim*}\n\\begin{proof}\n  $\\dang NMT = \\dang TQN = \\dang LON = \\dang NOE = \\dang NME$.\n\\end{proof}\n\nNow consider the homothety mapping $\\triangle WAB$ to $\\triangle QCD$.\nIt should map $E$ to a point on line $ME$\nwhich is also on the line through $Q$ perpendicular to $\\ol{AB}$; that is, to point $T$.\nHence $TCD$ are collinear, and it's immediate that $T$ is the desired tangency point.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 1999}
{"id": "imo-1999-q6", "question": "Find all the functions $f \\colon \\RR \\to \\RR$ such that\n\\[f(x-f(y))=f(f(y))+xf(y)+f(x)-1\\]\nfor all $x,y \\in \\RR$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p131856}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all the functions $f \\colon \\RR \\to \\RR$ such that\n\\[f(x-f(y))=f(f(y))+xf(y)+f(x)-1\\]\nfor all $x,y \\in \\RR$.\n\\end{mdframed}\nThe answer is $f(x) = -\\half x^2+1$\nwhich obviously works.\n\nFor the other direction, first note that\n\\[ P(f(y),y) \\implies 2f(f(y)) + f(y)^2 - 1 = f(0). \\]\nWe introduce the notation $c = \\frac{f(0)-1}{2}$,\nand $S = \\opname{img} f$.\nThen the above assertion says\n\\[ f(s) = -\\half s^2 + (c + 1). \\]\nThus, the given functional equation can be rewritten as\n\\[ Q(x,s) : f(x-s)=-\\half s^2 + sx + f(x) - c. \\]\n\n\\begin{claim*}\n  [Main claim]\n  We can find a function $g \\colon \\RR \\to \\RR$ such that\n  \\[ f(x-z) = zx + f(x) + g(z). \\qquad (\\spadesuit). \\]\n\\end{claim*}\n\\begin{proof}\n  If $z \\neq 0$,\n  the idea is to fix a nonzero value $s_0 \\in S$ (it exists)\n  and then choose $x_0$ such that $- \\half s_0^2 + s_0 x_0 - c = z$.\n  Then, $Q(x_0, s)$ gives an pair $(u,v)$ with $u-v = z$.\n\n  But now for any $x$, using $Q(x+v,u)$ and $Q(x,-v)$ gives\n  \\begin{align*}\n    f(x-z)-f(x) &= f(x-u+v)-f(x)\n    = f(x+v)-f(x) + u(x+v) - \\half u^2 + c \\\\\n    &= -vx-\\half s^2-c + u(x+v) - \\half u^2 + c \\\\\n    &= -vx-\\half v^2 + u(x+v) - \\half u^2 = zx + g(z)\n  \\end{align*}\n  where $g(z) = -\\half(u^2+v^2)$ depends only on $z$.\n\\end{proof}\n\nNow, let\n\\[ h(x) \\coloneq \\half x^2 + f(x) - (2c+1), \\]\nso $h(0) = 0$.\n\\begin{claim*}\n  The function $h$ is additive.\n\\end{claim*}\n\\begin{proof}\n  We just need to rewrite $(\\spadesuit)$.\n  Letting $x=z$ in $(\\spadesuit)$,\n  we find that actually $g(x)=f(0)-x^2-f(x)$.\n  Using the definition of $h$ now gives\n  \\[ h(x-z) = h(x) + h(z). \\qedhere \\]\n\\end{proof}\n\nTo finish, we need to remember that $f$, hence $h$, is known\non the image\n\\[ S =  \\left\\{ f(x) \\mid x \\in \\RR \\right\\}\n  = \\left\\{ h(x) - \\half x^2 + (2c+1) \\mid x \\in \\RR \\right\\}. \\]\nThus, we derive\n\\[ h\\left( h(x)-\\half x^2+(2c+1) \\right) = -c\n  \\qquad \\forall x \\in \\RR. \\qquad(\\heartsuit)  \\]\nWe can take the following two instances of $\\heartsuit$:\n\\begin{align*}\n  h\\left( h(2x)-2x^2+(2c+1) \\right) &= -c \\\\\n  h\\left( 2h(x)-x^2+2(2c+1) \\right) &= -2c.\n\\end{align*}\nNow subtracting these and using $2h(x)=h(2x)$ gives\n\\[ c = h\\left( -x^2 - (2c+1) \\right). \\]\nTogether with $h$ additive, this implies readily $h$ is constant.\nThat means $c=0$ and the problem is solved.\n\\pagebreak\n\n\n\\end{document}", "category": "Algebra", "source": "IMO", "year": 1999}
{"id": "imo-2003-q1", "question": "Let $A$ be a $101$-element subset of $S=\\{1,2,\\dots,10^6\\}$.\nProve that there exist numbers $t_1$, $t_2, \\dots, t_{100}$ in $S$ such that the sets\n\\[ A_j=\\{x+t_j\\mid x\\in A\\},\\qquad j=1,2,\\dots,100  \\]\nare pairwise disjoint.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p261}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $A$ be a $101$-element subset of $S=\\{1,2,\\dots,10^6\\}$.\nProve that there exist numbers $t_1$, $t_2, \\dots, t_{100}$ in $S$ such that the sets\n\\[ A_j=\\{x+t_j\\mid x\\in A\\},\\qquad j=1,2,\\dots,100  \\]\nare pairwise disjoint.\n\\end{mdframed}\nA greedy algorithm works: suppose we have picked\n\\[ T = \\left\\{ t_1, \\dots, t_n \\right\\} \\]\nas large as possible, meaning it's impossible to add any more elements to $T$.\nThat means, for each $t \\in \\left\\{ 1, \\dots, 10^6 \\right\\}$ either $t \\in T$ already\nor there exists two distinct elements $a, b \\in A$ and $t_i \\in T$ such that\n\\[ t = t_i + b - a \\qquad (\\star).  \\]\n\nThere are at most\n$|T| \\cdot |A| \\cdot \\left( |A|-1 \\right) = n \\cdot 101 \\cdot 100$\npossible values for the right-hand side of $(\\star)$.\nSo we therefore must have\n\\[ 101 \\cdot 100 \\cdot n + n \\ge 10^6 \\]\nwhich implies $n > 99$, as desired.\n\n\\begin{remark*}\n  It is possible to improve the bound significantly with a small optimization;\n  rather than adding any $t$, we require that $t_1 < \\dots < t_n$\n  and that at each step we add the \\emph{least} $t \\in S$ which is permitted.\n  In that case, one finds we only need to consider $b > a$ in $(\\star)$,\n  and so this will save us a factor of $2+o(1)$\n  as the main term $101 \\cdot 100$ becomes $\\binom{101}{2}$ instead.\n  This proves it's possible to choose $198$ elements.\n\n  See, e.g., \\url{https://aops.com/community/p22959828} for such a write-up.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "IMO", "year": 2003}
{"id": "imo-2003-q2", "question": "Determine all pairs of positive integers $(a,b)$ such that\n\\[ \\frac{a^2}{2ab^2-b^3+1} \\]\nis a positive integer.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p262}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nDetermine all pairs of positive integers $(a,b)$ such that\n\\[ \\frac{a^2}{2ab^2-b^3+1} \\]\nis a positive integer.\n\\end{mdframed}\nThe answer is $(a,b) = (2\\ell, 1)$, $(a,b) = (\\ell, 2\\ell)$\nand $(a,b) = (8\\ell^4-\\ell, 2\\ell)$, for any $\\ell$.\nCheck these work.\n\nIn the sequel, assume $b > 1$,\nand integers $a$, $b$, $k$ obey $k = \\frac{a^2}{2ab^2-b^3+1}$.\nExpanding, we have the polynomial\n\\[ X^2 - 2kb^2 \\cdot X + k(b^3-1) = 0 \\]\nhas two integer roots, one of which is $X = a$.\nThis means solutions to the original problem come in pairs\n(even with $k$ fixed):\n\\[ (a,b) \\longleftrightarrow\n  \\left( 2kb^2 - a, b\\right)\n  = \\left( \\frac{k(b^3-1)}{a}, b\\right). \\]\n(Here, the first representation ensures\n$2kb^2-a \\in \\ZZ$,\nwhile the latter representation and the hypothesis $b > 1$ ensures\nthat $\\frac{k(b^3-1)}{a} > 0$.)\n\nOn the other hand, we claim that:\n\\begin{claim*}\nFor any solution $(a,b)$,\neither $2a = b$ or $a > b$.\n\\end{claim*}\n\\begin{proof}\n  Since the denominator is positive, $a \\ge b/2$.\n  Now,\n  \\[ a^2 \\ge 2ab^2 - b^3 + 1 \\iff a^2 \\ge b^2(2a-b) + 1 \\]\n  and so if $2a - b > 0$ then $a^2 > b^2 \\implies a > b$.\n\\end{proof}\n\nNow assume we have pair $(a_1, b)$ and $(a_2, b)$\nof solutions with $b \\neq 2a_1, 2a_2$.\nThen assume $a_1 > a_2 > b$ and\n\\begin{align*}\n  a_1 + a_2 &= 2k \\cdot b^2 \\\\\n  a_1a_2 &= k(b^3-1)\n\\end{align*}\nThat's impossible, since then $a_1 > \\frac{a_1+a_2}{2} = k b^2$\nand hence $a_1a_2 > kb^2 \\cdot b = kb^3$.\nThus the only solutions are the ones we claimed at the beginning.\n\n\\begin{remark*}\n  Important to notice that the problem is \\emph{positive divides},\n  not just divides.\n  There is an implicit inequality built in to the problem\n  statement and it is essentially impossible to solve without.\n  I would be interested in a pair $(a,b)$\n  for which $k < 0$, $k \\in \\ZZ$ yet $a, b > 0$.\n\\end{remark*}\n\\pagebreak", "category": "Number Theory", "source": "IMO", "year": 2003}
{"id": "imo-2003-q3", "question": "Each pair of opposite sides of convex hexagon has the property that\nthe distance between their midpoints is $\\frac{\\sqrt3}{2}$\ntimes the sum of their lengths.\nProve that the hexagon is equiangular.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p263}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nEach pair of opposite sides of convex hexagon has the property that\nthe distance between their midpoints is $\\frac{\\sqrt3}{2}$\ntimes the sum of their lengths.\nProve that the hexagon is equiangular.\n\\end{mdframed}\nUnsurprisingly, this is a geometric inequality.\nDenote the hexagon by $ABCDEF$.\nThen we have that\n\\[\n  \\left\\lvert\n  \\frac{\\vec D + \\vec E}{2} - \\frac{\\vec A + \\vec B}{2}\n  \\right\\rvert\n  = \\sqrt3 \\cdot \\frac{\\left\\lvert \\vec B - \\vec A \\right\\rvert\n    + \\left\\lvert \\vec E - \\vec D \\right\\rvert}{2}\n  \\ge \\sqrt 3 \\cdot\n  \\left\\lvert \\frac{(\\vec B - \\vec A) - (\\vec E - \\vec D)}{2}  \\right\\rvert\n\\]\nand cyclic variations.\nSuppose we define the right-hand sides as variables\n\\begin{align*}\n  \\vec x = (\\vec B - \\vec A) - (\\vec E - \\vec D) \\\\\n  \\vec y = (\\vec D - \\vec C) - (\\vec A - \\vec F) \\\\\n  \\vec z = (\\vec F - \\vec E) - (\\vec C - \\vec B).\n\\end{align*}\nThen we now have\n\\begin{align*}\n  \\left\\lvert \\vec y - \\vec z \\right\\rvert\n  &\\ge \\sqrt 3 \\left\\lvert \\vec x  \\right\\rvert \\\\\n  \\left\\lvert \\vec z - \\vec x \\right\\rvert\n  &\\ge \\sqrt 3 \\left\\lvert \\vec y  \\right\\rvert \\\\\n  \\left\\lvert \\vec x - \\vec y \\right\\rvert\n  &\\ge \\sqrt 3 \\left\\lvert \\vec z  \\right\\rvert.\n\\end{align*}\nWe square all sides (using\n$\\left\\lvert \\vec v \\right\\rvert^2 = \\vec v \\cdot \\vec v$)\nand then sum to get\n\\[ \\sum_{\\text{cyc}} (\\vec y - \\vec z) \\cdot (\\vec y - \\vec z)\n  \\ge 3 \\sum_{\\text{cyc}} \\vec x \\cdot \\vec x \\]\nwhich rearranges to\n\\[- \\left\\lvert \\vec x + \\vec y + \\vec z \\right\\rvert^2 \\ge 0. \\]\nThis can only happen if $\\vec x + \\vec y + \\vec z =0$,\nand moreover all the inequalities above were actually equalities.\nThat means that our triangle inequalities above were actually sharp\n(and already we have $\\ol{AB} \\parallel \\ol{DE}$ and so on).\n\nWorking with just $x$ and $y$ now we have\n\\begin{align*}\n  3 (\\vec x \\cdot \\vec x) &= (2 \\vec y - \\vec x) \\cdot (2 \\vec y - \\vec x) \\\\\n  &= \\vec x \\cdot \\vec x - 4 \\vec y \\cdot \\vec x + 4 \\vec y \\cdot \\vec y \\\\\n  \\implies\n  -\\vec x \\cdot \\vec x + 2 (\\vec y \\cdot \\vec y) &= 2 \\vec x \\cdot \\vec y \\\\\n  2 (\\vec x \\cdot \\vec x) - \\vec y \\cdot \\vec y &= 2 \\vec x \\cdot \\vec y.\n\\end{align*}\nwhich implies $\\vec x \\cdot \\vec x = \\vec y \\cdot \\vec y$,\nthat is, $\\vec x$ and $\\vec y$ have the same magnitude.\nIn this way we find $\\vec x$, $\\vec y$, $\\vec z$ all\nhave the same magnitude,\nand since $\\vec x + \\vec y + \\vec z = 0$\nthey are related by $120\\dg$ rotations, as desired.\n\n\\begin{remark*}\n  In fact one can show further that the equiangular hexagons\n  which work are exactly those formed by taking an equilateral triangle\n  and cutting off equally sized corners.\n  This equality case helps motivate the solution.\n\\end{remark*}\n\\begin{remark*}\n  One can note this ``must'' be an inequality\n  because the space of such hexagons is $2$-dimensional,\n  even though \\emph{a priori} the space of hexagons satisfying\n  three given conditions should have dimension $9-3=6$.\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Geometry", "source": "IMO", "year": 2003}
{"id": "imo-2003-q4", "question": "Let $ABCD$ be a cyclic quadrilateral.\nLet $P, Q$ and $R$ be the feet of perpendiculars\nfrom $D$ to lines $\\ol{BC}$, $\\ol{CA}$ and $\\ol{AB}$, respectively.\nShow that $PQ = QR$ if and only if the\nbisectors of angles $ABC$ and $ADC$ meet on segment $\\ol{AC}$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p264}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABCD$ be a cyclic quadrilateral.\nLet $P, Q$ and $R$ be the feet of perpendiculars\nfrom $D$ to lines $\\ol{BC}$, $\\ol{CA}$ and $\\ol{AB}$, respectively.\nShow that $PQ = QR$ if and only if the\nbisectors of angles $ABC$ and $ADC$ meet on segment $\\ol{AC}$.\n\\end{mdframed}\nLet $\\gamma$ denote the circumcircle of $ABCD$.\nThe condition on bisectors is equivalent to $(AC;BD)_\\gamma = -1$.\nMeanwhile if $\\infty$ denotes the point at infinity along Simson line $\\ol{PQR}$\nthen $PQ = QR$ if and only if $(PR;Q\\infty) = -1$.\n\nLet rays $BQ$ and $DQ$ meet the circumcircle again at $F$ and $E$.\n\n\\begin{center}\n\\begin{asy}\npair B = dir(150);\npair A = dir(200);\npair C = dir(340);\npair D = IP(2*A*C/(A+C)--B, unitcircle);\n\ndraw(A--D--C--B--A--C, lightblue);\nfilldraw(unitcircle, opacity(0.1)+lightcyan, blue);\npair P = foot(D, B, C);\npair Q = foot(D, A, C);\npair R = foot(D, A, B);\ndraw(P--D--R, blue);\ndraw(R--A, lightblue);\n\ndraw(P--R, red);\npair O = origin;\npair E = -D+2*foot(O, D, Q);\npair F = -B+2*foot(O, B, Q);\n\ndraw(B--E, red);\ndraw(B--F, lightblue);\ndraw(D--E, lightblue);\n\ndot(\"$B$\", B, dir(B));\ndot(\"$A$\", A, dir(A));\ndot(\"$C$\", C, dir(C));\ndot(\"$D$\", D, dir(D));\ndot(\"$P$\", P, dir(60));\ndot(\"$Q$\", Q, dir(315));\ndot(\"$R$\", R, dir(R));\ndot(\"$E$\", E, dir(E));\ndot(\"$F$\", F, dir(F));\n\n/* TSQ Source:\n\nB = dir 150\nA = dir 200\nC = dir 340\nD = IP 2*A*C/(A+C)--B unitcircle\n\nA--D--C--B--A--C lightblue\nunitcircle 0.1 lightcyan / blue\nP = foot D B C R60\nQ = foot D A C R315\nR = foot D A B\nP--D--R blue\nR--A lightblue\n\nP--R red\nO := origin\nE = -D+2*foot O D Q\nF = -B+2*foot O B Q\n\nB--E red\nB--F lightblue\nD--E lightblue\n\n*/\n\\end{asy}\n\\end{center}\n\n\\begin{lemma*}\n  [EGMO Proposition 4.1]\n  Then $\\ol{BE} \\parallel \\ol{PQR}$.\n\\end{lemma*}\n\\begin{proof}\n  Since $\\dang DPR = \\dang DAR = \\dang DAB = \\dang DEB$.\n\\end{proof}\n\nNow we have\n\\[ (PR;Q\\infty) \\overset{B}{=} (CA;FE)_\\gamma\n  \\overset{Q}{=} (AC;BD)_\\gamma \\]\nas desired.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2003}
{"id": "imo-2003-q5", "question": "Let $n$ be a positive integer and\nlet $x_1 \\le x_2 \\le \\dots \\le x_n$ be real numbers.\nProve that\n\\[ \\left(\\sum_{i=1}^{n}\\sum_{j=1}^{n} |x_i - x_j|\\right)^2\n  \\le \\frac{2(n^2-1)}{3}\\sum_{i=1}^{n}\\sum_{j=1}^{n} (x_i - x_j)^2 \\]\nwith equality if and only if $x_1$, $x_2$, \\dots, $x_n$\nform an arithmetic sequence.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p265}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n$ be a positive integer and\nlet $x_1 \\le x_2 \\le \\dots \\le x_n$ be real numbers.\nProve that\n\\[ \\left(\\sum_{i=1}^{n}\\sum_{j=1}^{n} |x_i - x_j|\\right)^2\n  \\le \\frac{2(n^2-1)}{3}\\sum_{i=1}^{n}\\sum_{j=1}^{n} (x_i - x_j)^2 \\]\nwith equality if and only if $x_1$, $x_2$, \\dots, $x_n$\nform an arithmetic sequence.\n\\end{mdframed}\nLet $d_1 = x_2 - x_1$, \\dots, $d_{n-1} = x_n - x_{n-1}$.\nThe inequality in question becomes:\n\\[\n  \\left( \\sum_i i(n-i) d_i \\right)^2\n  \\le\n  \\frac{n^2-1}{3} \\cdot\n  \\left( \\sum_i i(n-i) d_i^2 + 2\\sum_{i<j} i(n-j) d_i d_j  \\right).\n\\]\nClearing the square on the right-hand side we want to show\n\\[\n  \\sum_{i<j} \\left( 3ij(n-i)(n-j) - (n^2-1)i(n-j) \\right) \\cdot 2d_i d_j\n  \\le \\sum_i (n^2-1-3i(n-i)) \\cdot i(n-i) d_i^2.\n\\]\nWe use AM-GM directly on $2d_i d_j \\le d_i^2 + d_j^2$:\nthis actually solves the problem.\nThe annoying part is to check that the coefficients actually match:\n\\begin{claim*}\n  [Big bash]\n  For an index $1 \\le k \\le n-1$, we have\n  \\begin{align*}\n    &\\sum_{i<k} \\left( 3ik(n-i)(n-k) - (n^2-1)i(n-k) \\right) \\\\\n    +& \\sum_{j>k} \\left( 3kj(n-k)(n-j) - (n^2-1)k(n-j) \\right) \\\\\n    = & (n^2-1-3k(n-k)) \\cdot k(n-k).\n  \\end{align*}\n\\end{claim*}\n\\begin{proof}\n  Rewrite as:\n  \\begin{align*}\n    3k(n-k) \\left( -k(n-k) + \\sum_i i(n-i) \\right)\n      &= (n^2-1)\\left( (n-k)\\sum_{i<k} i + k\\sum_{j>k} (n-j) \\right) \\\\\n      &+ (n^2-1-3k(n-k)) \\cdot k(n-k) \\\\\n    \\iff 3k(n-k) \\sum_i i(n-i)\n      &= (n^2-1) \\left( (n-k)\\sum_{i<k} i + k\\sum_{j>k}(n-j) \\right) \\\\\n      &+ (n^2-1)k(n-k) - 3k^2(n-k)^2 \\\\\n    \\iff 3k(n-k) \\left( \\sum_{i} i(n-i) \\right)\n      &= (n^2-1) \\left( (n-k)\\sum_{i \\le k} i + k \\sum_{i < n-k} i \\right) \\\\\n    \\iff 3k(n-k) \\frac{(n-1)n(n+1)}{6}\n      &= (n^2-1) \\left( (n-k)\\frac{k(k+1)}{2} \\right) \\\\\n      & + (n^2-1) \\left( k \\frac{(n-k)(n-k-1)}{2} \\right) \\\\\n    \\iff 3k(n-k) \\frac{(n-1)n(n+1)}{6}\n      &= (n^2-1)k(n-k) \\cdot \\frac n2\n  \\end{align*}\n  which is visibly true.\n\\end{proof}\nEquality occurs only if all $d_i$ are equal\nbecause the coefficient of $d_i d_j$ is nonzero\nfor any $i \\le n/2$ and $j \\ge n/2$.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2003}
{"id": "imo-2003-q6", "question": "Let $p$ be a prime number.\nProve that there exists a prime number $q$ such that for every integer $n$,\nthe number $n^p-p$ is not divisible by $q$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p266}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $p$ be a prime number.\nProve that there exists a prime number $q$ such that for every integer $n$,\nthe number $n^p-p$ is not divisible by $q$.\n\\end{mdframed}\nBy orders, we must have $q=pk+1$ for this to be possible\n(since if $q \\not \\equiv 1 \\pmod p$, then $n^p$ can be any residue modulo $q$).\nSince $p \\equiv n^p \\pmod q \\implies p^k \\equiv 1 \\pmod q$,\nit suffices to prevent the latter situation from happening.\n\nSo we need a prime $q \\equiv 1 \\pmod p$ such that $p^k \\not\\equiv 1 \\pmod q$.\nTo do this, we first recall the following lemma.\n\\begin{lemma*}\n  Let $\\Phi_p(X) = 1 + X + X^2 + \\dots + X^{p-1}$.\n  For any integer $a$, if $q$ is a prime divisor of $\\Phi_p(a)$ other than $p$,\n  then $a \\pmod q$ has order $p$. (In particular, $q \\equiv 1 \\pmod p$.)\n\\end{lemma*}\n\\begin{proof}\n  We have $a^p-1 \\equiv 0 \\pmod q$, so either the order is $1$ or $p$.\n  If it is $1$, then $a \\equiv 1 \\pmod q$, so $q \\mid \\Phi_p(1) = p$, hence $q = p$.\n\\end{proof}\n\n% Wishfully we hope the order of $p$ is $p$ and $k \\nmid p$.\nNow the idea is to extract a prime factor $q$\nfrom the cyclotomic polynomial\n\\[ \\Phi_p(p) = \\frac{p^p-1}{p-1} \\equiv 1+p \\pmod{p^2} \\]\nsuch that $q \\not\\equiv 1 \\pmod{p^2}$;\nhence $k \\not\\equiv 0 \\pmod p$,\nand as $p \\pmod q$ has order $p$ we have $p^k \\not\\equiv 1 \\pmod q$.\n\\pagebreak\n\n\n\\end{document}", "category": "Number Theory", "source": "IMO", "year": 2003}
{"id": "tstst-2016-q1", "question": "Let $A = A(x,y)$ and $B = B(x,y)$ be\ntwo-variable polynomials with real coefficients.\nSuppose that $A(x,y)/B(x,y)$ is a polynomial in $x$\nfor infinitely many values of $y$,\nand a polynomial in $y$ for infinitely many values of $x$.\nProve that $B$ divides $A$, meaning there exists a third polynomial $C$\nwith real coefficients such that $A = B \\cdot C$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6575197}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $A = A(x,y)$ and $B = B(x,y)$ be\ntwo-variable polynomials with real coefficients.\nSuppose that $A(x,y)/B(x,y)$ is a polynomial in $x$\nfor infinitely many values of $y$,\nand a polynomial in $y$ for infinitely many values of $x$.\nProve that $B$ divides $A$, meaning there exists a third polynomial $C$\nwith real coefficients such that $A = B \\cdot C$.\n\\end{mdframed}\nThis is essentially an application of the division algorithm,\nbut the details require significant care.\n\nFirst, we claim that $A/B$ can be written as a polynomial in $x$\nwhose coefficients are rational functions in $y$.\nTo see this, use the division algorithm to get\n\\[ A = Q \\cdot B + R \\qquad Q,R \\in (\\RR(y))[x] \\]\nwhere $Q$ and $R$ are polynomials in $x$\nwhose coefficients are rational functions in $y$,\nand moreover $\\deg_x B > \\deg_x R$.\n\nNow, we claim that $R \\equiv 0$.\nIndeed, we have by hypothesis that for infinitely many values of $y_0$\nthat $B(x,y_0)$ divides $A(x, y_0)$,\nwhich means $B(x,y_0) \\mid R(x,y_0)$ as polynomials in $\\RR[x]$.\nNow, we have $\\deg_x B(x,y_0) > \\deg_x R(x,y_0)$\noutside of finitely many values of $y_0$ (but not all of them!);\nthis means for infinitely many $y_0$ we have $R(x,y_0) \\equiv 0$.\nSo each coefficient of $x^i$ (in $\\RR(y)$)\nhas infinitely many roots, hence is a zero polynomial.\n\nConsequently, we are able to write $A / B = F(x,y) / M(y)$\nwhere $F \\in \\RR[x,y]$ and $M \\in \\RR[y]$ are each polynomials.\nRepeating the same argument now gives\n\\[ \\frac AB = \\frac{F(x,y)}{M(y)} = \\frac{G(x,y)}{N(x)}. \\]\nNow, by unique factorization of polynomials in $\\RR[x,y]$,\nwe can discuss GCD's.\nSo, we tacitly assume $\\gcd(F,M) = \\gcd(G,N) = (1)$.\nAlso, we obviously have $\\gcd(M,N) = (1)$.\nBut $F \\cdot N = G \\cdot M$, so $M \\mid F \\cdot N$,\nthus we conclude $M$ is the constant polynomial.\nThis implies the result.\n\n\\begin{remark*} This fact does not generalize to arbitrary functions that are separately polynomial:\nsee e.g. \\url{http://aops.com/community/c6h523650p2978180}. \\end{remark*}\n\\pagebreak", "category": "Algebra", "source": "TSTST", "year": 2016}
{"id": "tstst-2016-q2", "question": "Let $ABC$ be a scalene triangle with orthocenter $H$ and circumcenter $O$\nand denote by $M$, $N$ the midpoints of $\\ol{AH}$, $\\ol{BC}$.\nSuppose the circle $\\gamma$ with diameter $\\ol{AH}$ meets\nthe circumcircle of $ABC$ at $G \\neq A$,\nand meets line $\\ol{AN}$ at $Q \\neq A$.\nThe tangent to $\\gamma$ at $G$ meets line $OM$ at $P$.\nShow that the circumcircles of $\\triangle GNQ$\nand $\\triangle MBC$ intersect on $\\ol{PN}$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6575204}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a scalene triangle with orthocenter $H$ and circumcenter $O$\nand denote by $M$, $N$ the midpoints of $\\ol{AH}$, $\\ol{BC}$.\nSuppose the circle $\\gamma$ with diameter $\\ol{AH}$ meets\nthe circumcircle of $ABC$ at $G \\neq A$,\nand meets line $\\ol{AN}$ at $Q \\neq A$.\nThe tangent to $\\gamma$ at $G$ meets line $OM$ at $P$.\nShow that the circumcircles of $\\triangle GNQ$\nand $\\triangle MBC$ intersect on $\\ol{PN}$.\n\\end{mdframed}\nWe present two solutions,\none using essentially only power of a point,\nand the other more involved.\n\n\\paragraph{First solution (found by contestants).}\nDenote by $\\triangle DEF$ the orthic triangle.\nObserve $\\ol{PA}$ and $\\ol{PG}$ are tangents to $\\gamma$,\nsince $\\ol{OM}$ is the perpendicular bisector of $\\ol{AG}$.\nAlso note that $\\ol{AG}$, $\\ol{EF}$, $\\ol{BC}$ are concurrent at some point $R$\nby radical axis on $(ABC)$, $\\gamma$, $(BFEC)$.\n\nNow, consider circles $(PAGM)$, $(MFDNE)$, and $(MBC)$.\nWe already saw the point $R$ satisfies\n\\[ RA \\cdot RG = RE \\cdot RF = RB \\cdot RC \\]\nand hence has equal powers to all three circles;\nbut since the circles at $M$ already, they must actually be coaxial.\nAssume they meet again at $T \\in \\ol{RM}$, say.\nThen $\\angle PTM$ and $\\angle MTN$ are both right angles, hence $T$ lies on $\\ol{PN}$.\n\nFinally $H$ is the orthocenter of $\\triangle ARN$,\nand thus the circle with diameter $\\ol{RN}$ passes through $G$, $Q$, $N$.\n\n\\begin{center}\n\\begin{asy}\nsize(11cm);\npair A = dir(120);\npair B = dir(210);\npair C = dir(330);\npair N = midpoint(B--C);\npair H = orthocenter(A, B, C);\npair M = midpoint(A--H);\npair O = circumcenter(A, B, C);\npair P = extension(O, M, A, B-C+A);\npair T = foot(M, P, N);\npair D = foot(A, B, C);\npair E = foot(B, C, A);\npair F = foot(C, A, B);\n\nfilldraw(A--B--C--cycle, opacity(0.1)+lightblue, blue);\ndraw(unitcircle, blue);\n\ndraw(A--D, heavygreen);\ndraw(B--E, heavygreen);\ndraw(C--F, heavygreen);\ndraw(E--F, heavygreen);\ndraw(B--M--C, lightred);\n// filldraw(circumcircle(M, B, C), opacity(0.05)+lightred, red);\n\nfilldraw(circumcircle(D, E, F), opacity(0.05)+lightred, red);\ndraw(O--P--N, heavycyan);\ndraw(A--P, heavycyan);\n\nfilldraw(circumcircle(A, E, F), opacity(0.1)+lightgreen, heavygreen);\npair Q = foot(H, A, N);\npair G = -A+2*foot(A, M, P);\n\npair R = extension(E, F, B, C);\ndraw(R--F, heavygreen);\ndraw(R--B, blue);\ndraw(R--Q, heavygreen);\ndraw(A--R, heavygreen);\ndraw(A--N, blue);\ndraw(P--G, heavycyan);\ndraw(G--N, blue);\ndraw(M--R, heavygreen);\nfilldraw(circumcircle(R, G, T), opacity(0.05)+lightred, red);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$N$\", N, dir(N));\ndot(\"$H$\", H, dir(H));\ndot(\"$M$\", M, dir(M));\ndot(\"$O$\", O, dir(225));\ndot(\"$P$\", P, dir(P));\ndot(\"$T$\", T, dir(T));\ndot(\"$D$\", D, dir(D));\ndot(\"$E$\", E, dir(E));\ndot(\"$F$\", F, dir(F));\ndot(\"$Q$\", Q, dir(Q));\ndot(\"$G$\", G, dir(G));\ndot(\"$R$\", R, dir(R));\n\n/* TSQ Source:\n\n!size(11cm);\nA = dir 120\nB = dir 210\nC = dir 330\nN = midpoint B--C\nH = orthocenter A B C\nM = midpoint A--H\nO = circumcenter A B C R225\nP = extension O M A B-C+A\nT = foot M P N\nD = foot A B C\nE = foot B C A\nF = foot C A B\n\nA--B--C--cycle 0.1 lightblue / blue\nunitcircle blue\n\nA--D heavygreen\nB--E heavygreen\nC--F heavygreen\nE--F heavygreen\nB--M--C lightred\n// circumcircle M B C 0.05 lightred / red\n\ncircumcircle D E F 0.1 lightred / red\nO--P--N heavycyan\nA--P heavycyan\n\ncircumcircle A E F 0.1 lightgreen / heavygreen\nQ = foot H A N\nG = -A+2*foot A M P\n\nR = extension E F B C\nR--F heavygreen\nR--B blue\nR--Q heavygreen\nA--R heavygreen\nA--N blue\nP--G heavycyan\nG--N blue\nM--R heavygreen\ncircumcircle R G T 0.1 lightred / red\n\n*/\n\\end{asy}\n\\end{center}\n\n\\paragraph{Alternate solution (by proposer).}\nLet $L$ be diametrically opposite $A$ on the circumcircle.\nDenote by $\\triangle DEF$ the orthic triangle.\nLet $X = \\ol{AH} \\cap \\ol{EF}$.\nFinally, let $T$ be the second intersection of $(MFDNE)$ and $(MBC)$.\n\n\\begin{center}\n\\begin{asy}\nsize(11cm);\npair A = dir(120);\npair B = dir(210);\npair C = dir(330);\npair N = midpoint(B--C);\npair H = orthocenter(A, B, C);\npair M = midpoint(A--H);\npair O = circumcenter(A, B, C);\npair P = extension(O, M, A, B-C+A);\npair X = extension(P, N, A, H);\npair T = foot(M, P, N);\npair D = foot(A, B, C);\npair E = foot(B, C, A);\npair F = foot(C, A, B);\npair L = -A;\npair K = extension(H, N, A, P);\n\nfilldraw(A--B--C--cycle, opacity(0.1)+lightblue, blue);\nfilldraw(B--L--C--cycle, opacity(0.1)+lightblue, blue);\ndraw(unitcircle, blue);\ndraw(A--L, blue);\n\ndraw(A--D, heavygreen);\ndraw(B--E, heavygreen);\ndraw(C--F, heavygreen);\ndraw(E--F, heavygreen);\ndraw(B--M--C, lightred);\nfilldraw(circumcircle(M, B, C), opacity(0.05)+lightred, red);\n\nfilldraw(circumcircle(D, E, F), opacity(0.05)+lightred, red);\ndraw(A--K--L, heavycyan);\ndraw(O--P--N, heavycyan);\n\nfilldraw(circumcircle(A, E, F), opacity(0.1)+lightgreen, heavygreen);\npair Q = foot(H, A, N);\npair G = -A+2*foot(A, M, P);\n\npair R = extension(E, F, B, C);\ndraw(R--F, heavygreen);\ndraw(R--B, blue);\ndraw(R--Q, heavygreen);\ndraw(A--R, heavygreen);\ndraw(A--N, blue);\ndraw(P--G, heavycyan);\ndraw(M--R, heavygreen);\nfilldraw(circumcircle(R, G, T), opacity(0.05)+lightred, red);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$N$\", N, dir(N));\ndot(\"$H$\", H, dir(H));\ndot(\"$M$\", M, dir(M));\ndot(\"$O$\", O, dir(225));\ndot(\"$P$\", P, dir(P));\ndot(\"$X$\", X, dir(X));\ndot(\"$T$\", T, dir(T));\ndot(\"$D$\", D, dir(D));\ndot(\"$E$\", E, dir(E));\ndot(\"$F$\", F, dir(F));\ndot(\"$L$\", L, dir(L));\ndot(\"$K$\", K, dir(K));\ndot(\"$Q$\", Q, dir(Q));\ndot(\"$G$\", G, dir(G));\ndot(\"$R$\", R, dir(R));\n\n/* TSQ Source:\n\n!size(11cm);\nA = dir 120\nB = dir 210\nC = dir 330\nN = midpoint B--C\nH = orthocenter A B C\nM = midpoint A--H\nO = circumcenter A B C R225\nP = extension O M A B-C+A\nX = extension P N A H\nT = foot M P N\nD = foot A B C\nE = foot B C A\nF = foot C A B\nL = -A\nK = extension H N A P\n\nA--B--C--cycle 0.1 lightblue / blue\nB--L--C--cycle 0.1 lightblue / blue\nunitcircle blue\nA--L blue\n\nA--D heavygreen\nB--E heavygreen\nC--F heavygreen\nE--F heavygreen\nB--M--C lightred\ncircumcircle M B C 0.05 lightred / red\n\ncircumcircle D E F 0.05 lightred / red\nA--K--L heavycyan\nO--P--N heavycyan\n\ncircumcircle A E F 0.1 lightgreen / heavygreen\nQ = foot H A N\nG = -A+2*foot A M P\n\nR = extension E F B C\nR--F heavygreen\nR--B blue\nR--Q heavygreen\nA--R heavygreen\nA--N blue\nP--G heavycyan\nM--R heavygreen\ncircumcircle R G T 0.05 lightred / red\n\n*/\n\\end{asy}\n\\end{center}\n\nWe begin with a few easy observations.\nFirst, points $H$, $G$, $N$, $L$ are collinear and $\\angle AGL = 90\\dg$.\nAlso, $Q$ is the foot from $H$ to $\\ol{AN}$.\nConsequently, lines $AG$, $EF$, $HQ$, $BC$, $TM$\nconcur at a point $R$ (radical axis).\nMoreover, we already know $\\angle MTN = 90\\dg$.\nThis implies $T$ lies on the circle with diameter $\\ol{RN}$,\nwhich is exactly the circumcircle of $\\triangle GQN$.\n\nNote by Brocard's Theorem on $AFHE$, the point $X$ is the orthocenter of $\\triangle MBC$.\nBut $\\angle MTN = 90\\dg$ already, and $N$ is the midpoint of $\\ol{BC}$.\nConsequently, points $T$, $X$, $N$ are collinear.\n\nFinally, we claim $P$, $X$, $N$ are collinear, which solves the problem.\nNote $P = \\ol{GG} \\cap \\ol{AA}$.\nSet $K = \\ol{HNL} \\cap \\ol{AP}$.\nThen by noting \\[ -1 = (D,X;A,H) \\overset{N}{=} (\\infty, \\ol{NX} \\cap \\ol{AK}; A, K) \\]\nwe see that $\\ol{NX}$ bisects segment $\\ol{AK}$, as desired.\n(A more projective finish is to show that $\\ol{PXN}$ is the polar of $R$ to $\\gamma$).\n\n\\begin{remark*}\nThe original problem proposal reads as follows:\n\\begin{quote}\nLet $ABC$ be a triangle with orthocenter $H$ and circumcenter $O$\nand denote by $M$, $N$ the midpoints of $\\ol{AH}$, $\\ol{BC}$.\nSuppose ray $OM$ meets the line parallel to $\\ol{BC}$ through $A$ at $P$.\nProve that the line through the circumcenter of $\\triangle MBC$\nand the midpoint of $\\ol{OH}$ is parallel to $\\ol{NP}$.\n\\end{quote}\nThe points $G$ and $Q$ were added to the picture later\nto prevent the problem from being immediate by coordinates.\n\\end{remark*}\n\\pagebreak", "category": "Geometry", "source": "TSTST", "year": 2016}
{"id": "tstst-2016-q3", "question": "Decide whether or not there exists a nonconstant polynomial $Q(x)$\nwith integer coefficients with the following property:\nfor every positive integer $n > 2$, the numbers\n\\[ Q(0), \\; Q(1), Q(2),  \\; \\dots, \\; Q(n-1) \\]\nproduce at most $0.499n$ distinct residues when taken modulo $n$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6575217}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nDecide whether or not there exists a nonconstant polynomial $Q(x)$\nwith integer coefficients with the following property:\nfor every positive integer $n > 2$, the numbers\n\\[ Q(0), \\; Q(1), Q(2),  \\; \\dots, \\; Q(n-1) \\]\nproduce at most $0.499n$ distinct residues when taken modulo $n$.\n\\end{mdframed}\nWe claim that\n\\[ Q(x) = 420(x^2-1)^2 \\]\nworks.\nClearly, it suffices to prove the result when $n=4$ and when $n$ is an odd prime $p$.\nThe case $n=4$ is trivial, so assume now $n=p$ is an odd prime.\n\nFirst, we prove the following easy claim.\n\\begin{claim*}\n  For any odd prime $p$, there are at least $\\frac12(p-3)$\n  values of $a$ for which $\\left( \\frac{1-a^2}{p} \\right) = +1$.\n\\end{claim*}\n\\begin{proof}\n  Note that if $k \\neq 0$ and $k^2 \\neq -1$, then $a = \\frac{1-k^2}{k^2+1}$ works.\n\\end{proof}\n\\begin{remark*}\n  The above identity comes from starting with the equation $1-a^2=b^2$,\n  and writing it as $\\left( \\frac 1b \\right)^2 - \\left( \\frac ab \\right)^2 = 1$.\n  Then solve $\\frac 1b - \\frac ab = k$ and $\\frac 1b + \\frac ab = 1/k$ for $a$.\n\\end{remark*}\n\nLet $F(x) = (x^2-1)^2$.\nThe range of $F$ modulo $p$ is contained within the $\\half(p+1)$ quadratic residues modulo $p$.\nOn the other hand, if for some $t$ neither of $1 \\pm t$ is a quadratic residue,\nthen $t^2$ is omitted from the range of $F$ as well.\nCall such a value of $t$ \\emph{useful}, and let $N$ be the number of useful residues.\nWe aim to show $N \\ge \\frac14 p - 2$.\n\nWe compute a lower bound on the number $N$ of useful $t$ by writing\n\\begin{align*}\n  N &= \\frac{1}{4} \\left( \\sum_t \\left[ \\left(1 - \\left(\\frac{1-t}{p} \\right) \\right)\n    \\left(1 - \\left(\\frac{1+t}{p} \\right) \\right) \\right]\n    - \\left( 1- \\left( \\frac2p \\right) \\right)\n    - \\left( 1- \\left( \\frac{-2}p \\right) \\right)\n  \\right) \\\\\n  &\\ge \\frac{1}{4} \\sum_t \\left[ \\left(1 - \\left(\\frac{1-t}{p} \\right) \\right)\n    \\left(1 - \\left(\\frac{1+t}{p} \\right) \\right) \\right] -1 \\\\\n  &= \\frac{1}{4} \\left(p + \\sum_t \\left(\\frac{1-t^2}{p} \\right) \\right) -1 \\\\\n  &\\ge \\frac14 \\left( p + (+1) \\cdot \\tfrac12(p-3) + 0 \\cdot 2\n    + (-1) \\cdot ( (p-2) - \\tfrac12(p-3)) \\right) - 1 \\\\\n  &\\ge \\frac14 \\left( p - 5 \\right).\n\\end{align*}\n\nThus, the range of $F$ has size at most\n\\[ \\half(p+1) - \\half N \\le \\frac38(p+3). \\]\nThis is less than $0.499p$ for any $p \\ge 11$.\n\n\\begin{remark*}\n  In fact, the computation above is essentially an equality.\n  There are only two points where terms are dropped:\n  one, when $p \\equiv 3 \\pmod 4$ there are no $k^2 = -1$ in the lemma,\n  and secondly, the terms $1-\\left( 2/p \\right)$ and $1-\\left( -2/p \\right)$\n  are dropped in the initial estimate for $N$.\n  With suitable modifications, one can show that in fact,\n  the range of $F$ is exactly equal to\n  \\[\n    \\half(p+1) - \\half N =\n    \\begin{cases}\n      \\frac18(3p+5) & p \\equiv 1 \\pmod 8 \\\\\n      \\frac18(3p+7) & p \\equiv 3 \\pmod 8 \\\\\n      \\frac18(3p+9) & p \\equiv 5 \\pmod 8 \\\\\n      \\frac18(3p+3) & p \\equiv 7 \\pmod 8.\n    \\end{cases}\n  \\]\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Number Theory", "source": "TSTST", "year": 2016}
{"id": "tstst-2016-q4", "question": "Prove that if $n$ and $k$ are positive integers\nsatisfying $\\varphi^k(n) = 1$, then $n \\le 3^k$.\n(Here $\\varphi^k$ denotes $k$ applications of the Euler phi function.)", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6580534}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nProve that if $n$ and $k$ are positive integers\nsatisfying $\\varphi^k(n) = 1$, then $n \\le 3^k$.\n(Here $\\varphi^k$ denotes $k$ applications of the Euler phi function.)\n\\end{mdframed}\nThe main observation is that the exponent of $2$ decreases\nby at most $1$ with each application of $\\varphi$.\nThis will give us the desired estimate.\n\nDefine the \\emph{weight} function $w$ on positive integers as follows: it satisfies\n\\begin{align*}\n  w(ab) &= w(a)+w(b); \\\\\n  w(2) &= 1; \\quad\\text{and} \\\\\n  w(p) &= w(p-1) \\quad \\text{for any prime $p > 2$}.\n\\end{align*}\nBy induction, we see that $w(n)$ counts the powers of $2$\nthat are produced as $\\varphi$ is repeatedly applied to $n$.\nIn particular, $k \\ge w(n)$.\n\nFrom $w(2) = 1$, it suffices to prove that $w(p) \\ge \\log_3 p$ for every $p > 2$.\nWe use strong induction and note that\n\\[\n w(p) = w(2) + w\\left( \\frac{p-1}{2} \\right)\n \\ge 1 + \\log_3(p-1) - \\log_3 2 \\ge \\log_3 p\n\\]\nfor any $p > 2$. This solves the problem.\n\n\\begin{remark*}\nOne can motivate this solution through small cases $2^x 3^y$\nlike $2^x 17^w$, $2^x 3^y 7^z$, $2^x 11^t$.\n\nMoreover, the stronger bound \\[ n \\le 2 \\cdot 3^{k-1} \\] is true and best possible.\n\\end{remark*}\n\\pagebreak", "category": "Number Theory", "source": "TSTST", "year": 2016}
{"id": "tstst-2016-q5", "question": "In the coordinate plane are finitely many \\emph{walls},\nwhich are disjoint line segments, none of which are parallel to either axis.\nA bulldozer starts at an arbitrary point and moves in the $+x$ direction.\nEvery time it hits a wall, it turns at a right angle to its path,\naway from the wall, and continues moving.\n(Thus the bulldozer always moves parallel to the axes.)\n\nProve that it is impossible for the bulldozer\nto hit both sides of every wall.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6580545}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nIn the coordinate plane are finitely many \\emph{walls},\nwhich are disjoint line segments, none of which are parallel to either axis.\nA bulldozer starts at an arbitrary point and moves in the $+x$ direction.\nEvery time it hits a wall, it turns at a right angle to its path,\naway from the wall, and continues moving.\n(Thus the bulldozer always moves parallel to the axes.)\n\nProve that it is impossible for the bulldozer\nto hit both sides of every wall.\n\\end{mdframed}\nWe say a wall $v$ is \\emph{above} another wall $w$ if some point on\n$v$ is directly above a point on $w$.\n(This relation is anti-symmetric, as walls do not intersect).\n\nThe critical claim is as follows:\n\\begin{claim*}\n  There exists a lowest wall,\n  i.e.\\ a wall not above any other walls.\n\\end{claim*}\n\\begin{proof}\n  Assume not.\n  Then we get a directed cycle of some length $n \\ge 3$:\n  it's possible to construct a series of points $P_i$, $Q_i$,\n  for $i = 1, \\dots, n$ (indices modulo $n$), such that\n  the point $Q_i$ is directly above $P_{i+1}$ for each $i$,\n  the segment $\\ol{Q_i P_{i+1}}$ does not intersect any wall in its interior,\n  and finally each segment $\\ol{P_i Q_i}$ is contained inside a wall.\n  This gives us a broken line on $2n$ vertices which is not self-intersecting.\n\n  Now consider the leftmost vertical segment $\\ol{Q_i P_{i+1}}$\n  and the rightmost vertical segment $\\ol{Q_j P_{j+1}}$.\n  The broken line gives a path from $P_{i+1}$ to $Q_j$,\n  as well as a path from $P_{j+1}$ to $Q_i$.\n  These clearly must intersect, contradiction.\n\\end{proof}\n\\begin{remark*}\n  This claim is Iran TST 2010.\n\\end{remark*}\n\nThus if the bulldozer eventually moves upwards indefinitely,\nit may never hit the bottom side of the lowest wall.\nSimilarly, if the bulldozer eventually moves downwards indefinitely,\nit may never hit the upper side of the highest wall.\n\\pagebreak", "category": "Geometry", "source": "TSTST", "year": 2016}
{"id": "tstst-2016-q6", "question": "Let $ABC$ be a triangle with incenter $I$, and whose incircle is tangent\nto $\\ol{BC}$, $\\ol{CA}$, $\\ol{AB}$ at $D$, $E$, $F$, respectively.\nLet $K$ be the foot of the altitude from $D$ to $\\ol{EF}$.\nSuppose that the circumcircle of $\\triangle AIB$\nmeets the incircle at two distinct points $C_1$ and $C_2$,\nwhile the circumcircle of $\\triangle AIC$ meets the incircle\nat two distinct points $B_1$ and $B_2$.\nProve that the radical axis of the circumcircles of\n$\\triangle BB_1B_2$ and $\\triangle CC_1C_2$ passes through the midpoint $M$ of $\\ol{DK}$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6580553}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle with incenter $I$, and whose incircle is tangent\nto $\\ol{BC}$, $\\ol{CA}$, $\\ol{AB}$ at $D$, $E$, $F$, respectively.\nLet $K$ be the foot of the altitude from $D$ to $\\ol{EF}$.\nSuppose that the circumcircle of $\\triangle AIB$\nmeets the incircle at two distinct points $C_1$ and $C_2$,\nwhile the circumcircle of $\\triangle AIC$ meets the incircle\nat two distinct points $B_1$ and $B_2$.\nProve that the radical axis of the circumcircles of\n$\\triangle BB_1B_2$ and $\\triangle CC_1C_2$ passes through the midpoint $M$ of $\\ol{DK}$.\n\\end{mdframed}\n\\paragraph{First solution (Allen Liu).}\nLet $X$, $Y$, $Z$ be midpoints of $EF$, $FD$, $DE$, and let $G$ be the Gergonne point.\nBy radical axis on $(AEIF)$, $(DEF)$, $(AIC)$ we see that $B_1$, $X$, $B_2$ are collinear.\nLikewise, $B_1$, $Z$, $B_2$ are collinear, so lines $B_1B_2$ and $XZ$ coincide.\nSimilarly, lines $C_1C_2$ and $XY$ coincide.\nIn particular lines $B_1B_2$ and $C_1C_2$ meet at $X$.\n\n\\begin{center}\n\\begin{asy}\nsize(12cm);\n\npair A = dir(70);\npair B = dir(240);\npair C = dir(300);\npair I = incenter(A, B, C);\npair D = foot(I, B, C);\npair E = foot(I, C, A);\npair F = foot(I, A, B);\npair G = extension(A, D, B, E);\nfilldraw(A--B--C--cycle, opacity(0.1)+lightcyan, blue);\ndraw(D--E--F--cycle, blue);\ndraw(incircle(A, B, C), blue);\ndraw(A--D, blue);\ndraw(B--E, blue);\ndraw(C--F, blue);\n\npair Q = extension(G, G+F-D, E, F);\npair S = extension(G, G+F-D, E, D);\npair R = extension(G, G+D-E, F, D);\npair U = extension(G, G+D-E, F, E);\n\npair X = midpoint(E--F);\npair Y = midpoint(F--D);\npair Z = midpoint(D--E);\n\npair Qp = 2*Q-G;\npair Rp = 2*R-G;\npair Sp = 2*S-G;\npair Up = 2*U-G;\n\npair B_1 = OP(circumcircle(B, Qp, Sp), incircle(A, B, C));\npair B_2 = IP(circumcircle(B, Qp, Sp), incircle(A, B, C));\npair C_1 = OP(circumcircle(C, Rp, Up), incircle(A, B, C));\npair C_2 = IP(circumcircle(C, Rp, Up), incircle(A, B, C));\n\ndraw(circumcircle(B, B_1, B_2), red);\ndraw(circumcircle(C, C_1, C_2), red);\n\npair V = extension(X, Y, A, B);\npair W = extension(X, Z, A, C);\n\npair T = extension(B, W, C, V);\ndraw(X--T, yellow);\ndraw(unitcircle, blue);\ndraw(B--W, heavygreen);\ndraw(C--V, heavygreen);\ndraw(B--V, blue);\ndraw(C--W, blue);\n\ndraw(C_2--V, heavygreen);\ndraw(B_2--W, heavygreen);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$D$\", D, dir(D));\ndot(\"$E$\", E, dir(E));\ndot(\"$F$\", F, dir(170));\ndot(\"$G$\", G, dir(G));\ndot(\"$X$\", X, dir(110));\ndot(\"$Y$\", Y, dir(350));\ndot(\"$Z$\", Z, dir(Z));\ndot(\"$B_1$\", B_1, dir(B_1));\ndot(\"$B_2$\", B_2, dir(100));\ndot(\"$C_1$\", C_1, dir(C_1));\ndot(\"$C_2$\", C_2, dir(40));\ndot(\"$V$\", V, dir(V));\ndot(\"$W$\", W, dir(W));\ndot(\"$T$\", T, dir(T));\n\n/* Source generated by TSQ */\n\\end{asy}\n\\end{center}\n\nNote $G$ is the symmedian point of $DEF$, so\nit is well-known that $XG$ passes through the midpoint of $DK$.\nSo we just have to prove $G$ lies on the radical axis.\n\nFirst, note that $\\triangle DEF$ is the cevian triangle of the Gergonne point $G$.\nSet $V = \\ol{XY} \\cap \\ol{AB}$, $W = \\ol{XZ} \\cap \\ol{AC}$, and $T = \\ol{BW} \\cap \\ol{CV}$.\n\nWe begin with the following completely projective claim.\n\\begin{claim*}\n  The points $X$, $G$, $T$ are collinear.\n\\end{claim*}\n\\begin{proof}\n  It suffices to view $\\triangle XYZ$ as any cevian triangle of $\\triangle DEF$\n  (which is likewise any cevian triangle of $\\triangle ABC$).\n  Then\n  \\begin{itemize}\n    \\ii By Cevian Nest on $\\triangle ABC$,\n    it follows that $\\ol{AX}$, $\\ol{BY}$, $\\ol{CZ}$ are concurrent.\n    \\ii Hence $\\triangle BYV$ and $\\triangle CZW$ are perspective.\n    \\ii Hence $\\triangle BZW$ and $\\triangle CYV$ are perspective too.\n    \\ii Hence we deduce by Desargues theorem that $T$, $X$,\n    and $\\ol{BZ} \\cap \\ol{CY}$ are collinear.\n    \\ii Finally, the Cevian Nest theorem applied on $\\triangle GBC$\n    (which has cevian triangles $\\triangle DFE$, $\\triangle XZY$)\n    we deduce $G$, $X$, and $\\ol{BZ} \\cap \\ol{CY}$, proving the claim.\n  \\end{itemize}\n  One could also proceed by using barycentric coordinates on $\\triangle DEF$.\n\\end{proof}\n\\begin{remark*}\n  [Eric Shen]\n  The first four bullets can be replaced by non-projective means:\n  one can check that $\\ol{BZ} \\cap \\ol{CY}$ is the radical center\n  of $(BIC)$, $(BB_1B_2)$, $(CC_1C_2)$ and therefore it lies on line $\\ol{XT}$.\n\\end{remark*}\n\nNow, we contend point $V$ is the radical center $(CC_1C_2)$, $(ABC)$ and $(DEF)$.\nTo see this, let $V' = \\ol{ED} \\cap \\ol{AB}$;\nthen $(FV';AB)$ is harmonic, and $V$ is the midpoint of $\\ol{FV'}$,\nand thus $VA \\cdot VB = VF^2 = VC_1 \\cdot VC_2$.\n\nSo in fact $\\ol{CV}$ is the radical axis of $(ABC)$ and $(CC_1C_2)$.\n\nSimilarly, $\\ol{BW}$ is the radical axis of $(ABC)$ and $(BB_1B_2)$.\nThus $T$ is the radical center of $(ABC)$, $(BB_1B_2)$, $(CC_1C_2)$.\n\nThis completes the proof, as now $\\ol{XT}$ is the desired radical axis.\n\n\\paragraph{Second solution (Evan Chen).}\nAs before, we just have to prove $G$ lies on the radical axis.\n\n\\begin{center}\n \\begin{asy}\n  size(14cm);\n\n  pair A = dir(50);\n  pair B = dir(220);\n  pair C = dir(320);\n  pair I = incenter(A, B, C);\n  pair D = foot(I, B, C);\n  pair E = foot(I, C, A);\n  pair F = foot(I, A, B);\n  pair G = extension(A, D, B, E);\n  filldraw(A--B--C--cycle, opacity(0.1)+lightcyan, blue);\n  draw(D--E--F--cycle, blue);\n  draw(incircle(A, B, C), blue);\n  draw(A--D, blue);\n  draw(B--E, blue);\n  draw(C--F, blue);\n\n  pair P = extension(G, G+E-F, D, F);\n  pair T = extension(G, G+E-F, D, E);\n  pair Q = extension(G, G+F-D, E, F);\n  pair S = extension(G, G+F-D, E, D);\n  pair R = extension(G, G+D-E, F, D);\n  pair U = extension(G, G+D-E, F, E);\n\n  pair X = midpoint(E--F);\n  pair Y = midpoint(F--D);\n  pair Z = midpoint(D--E);\n\n  pair Pp = 2*P-G;\n  pair Qp = 2*Q-G;\n  pair Rp = 2*R-G;\n  pair Sp = 2*S-G;\n  pair Tp = 2*T-G;\n  pair Up = 2*U-G;\n\n  draw(Pp--Tp, heavygreen);\n  draw(Rp--Up, heavygreen);\n  draw(Qp--Sp, heavygreen);\n\n  pair V = extension(B, X, Sp, Z);\n  pair W = extension(B, R, Qp, X);\n\n  pair B_1 = OP(circumcircle(B, Qp, Sp), incircle(A, B, C));\n  pair B_2 = IP(circumcircle(B, Qp, Sp), incircle(A, B, C));\n  pair C_1 = OP(circumcircle(C, Rp, Up), incircle(A, B, C));\n  pair C_2 = IP(circumcircle(C, Rp, Up), incircle(A, B, C));\n\n  pair K = foot(D, E, F);\n  pair M = midpoint(D--K);\n  draw(D--K, blue);\n\n  draw(C_1--C_2, red);\n  draw(B_1--B_2, red);\n  filldraw(circumcircle(P, Q, R), opacity(0.1)+lightgreen, green+1.4);\n  filldraw(circumcircle(Pp, Qp, Rp), opacity(0.1)+lightgreen, green);\n  draw(circumcircle(Sp, Q, P), orange);\n  draw(circumcircle(B, B_1, B_2), red);\n  draw(circumcircle(C, C_1, C_2), red);\n\n  draw(X--M, yellow);\n  draw(B--V, orange);\n  draw(B--W, orange);\n\n  dot(\"$A$\", A, dir(A));\n  dot(\"$B$\", B, dir(B));\n  dot(\"$C$\", C, dir(C));\n  dot(\"$I$\", I, dir(I));\n  dot(\"$D$\", D, dir(D));\n  dot(\"$E$\", E, dir(E));\n  dot(\"$F$\", F, dir(F));\n  dot(\"$G$\", G, dir(G));\n  dot(\"$P$\", P, dir(200));\n  dot(\"$T$\", T, dir(100));\n  dot(\"$Q$\", Q, dir(70));\n  dot(\"$S$\", S, dir(260));\n  dot(\"$R$\", R, dir(250));\n  dot(\"$U$\", U, dir(U));\n  dot(\"$X$\", X, dir(X));\n  dot(\"$Y$\", Y, dir(350));\n  dot(\"$Z$\", Z, dir(Z));\n  dot(\"$P'$\", Pp, dir(Pp));\n  dot(\"$Q'$\", Qp, dir(Qp));\n  dot(\"$R'$\", Rp, dir(240));\n  dot(\"$S'$\", Sp, dir(Sp));\n  dot(\"$T'$\", Tp, dir(Tp));\n  dot(\"$U'$\", Up, dir(60));\n  dot(\"$V$\", V, dir(V));\n  dot(\"$W$\", W, dir(W));\n  dot(\"$B_1$\", B_1, dir(B_1));\n  dot(\"$B_2$\", B_2, dir(B_2));\n  dot(\"$C_1$\", C_1, dir(C_1));\n  dot(\"$C_2$\", C_2, dir(C_2));\n  dot(\"$K$\", K, dir(200));\n  dot(\"$M$\", M, dir(M));\n \\end{asy}\n\\end{center}\n\nConstruct parallelograms $GPFQ$, $GRDS$, $GTUE$\nsuch that $P,R \\in DF$, $S,T \\in DE$, $Q,U \\in EF$.\nAs $FG$ bisects $PQ$ and is isogonal to $FZ$,\nwe find $PQED$, hence $PQRU$, is cyclic.\nRepeating the same logic and noticing $PR$, $ST$, $QU$ not concurrent,\nall six points $PQRSTU$ are cyclic.\nMoreover, since $PQ$ bisects $GF$, we see that\na dilation with factor $2$ at $G$ sends $PQ$ to $P', Q' \\in AB$, say,\nwith $F$ the midpoint of $P'Q'$.\nDefine $R', S' \\in BC$ similarly now and $T', U' \\in CA$.\n\nNote that $EQPDS'$ is in cyclic too,\nas $\\dang DS'Q = \\dang DRS = \\dang DEF$.\nBy homothety through $B$, points $B$, $P$, $X$ are collinear;\nassume they meet $(EQPDS')$ again at $V$.\nThus $EVQPDS'$ is cyclic, and now\n\\[ \\dang BVS' = \\dang PVS' = \\dang PQS = \\dang PTS = \\dang FED = \\dang XEZ = \\dang XVZ \\]\nhence $V$ lies on $(BQ'S')$.\n\nSince $FB \\parallel QP$, we get $EVFB$ is cyclic too,\nso $XV \\cdot XB = XE \\cdot XF$ now;\nthus $X$ lies on the radical axis of $(BS'Q')$ and $(DEF)$.\nBy the same argument with $W \\in BZ$, we get $Z$ lies on the radical axis too.\nThus the radical axis of $(BS'Q')$ and $(DEF)$ must be line $XZ$,\nwhich coincides with $B_1B_2$; so $(BB_1B_2) = (BS'Q')$.\n\nAnalogously, $(CC_1C_2) = (CR'U')$.\nSince $G = Q'S' \\cap R'U'$, we need only prove that $Q'R'S'U'$ is cyclic.\nBut $QRSU$ is cyclic, so we are done.\n\nThe circle $(PQRSTU)$ is called the \\emph{Lemoine circle} of $ABC$.\n\\pagebreak\n\n\n\\end{document}", "category": "Geometry", "source": "TSTST", "year": 2016}
{"id": "tst-2016-q1", "question": "Let $S = \\{1, \\dots, n\\}$.\nGiven a bijection $f \\colon S \\to S$ an \\emph{orbit} of $f$ is a\nset of the form $\\{x, f(x), f(f(x)), \\dots \\}$ for some $x \\in S$.\nWe denote by $c(f)$ the number of distinct orbits of $f$.\nFor example, if $n=3$ and $f(1)=2$, $f(2)=1$, $f(3)=3$,\nthe two orbits are $\\{1,2\\}$ and $\\{3\\}$, hence $c(f)=2$.\n\nGiven $k$ bijections $f_1$, \\dots, $f_k$ from $S$ to itself, prove that\n\\[ c(f_1) + \\dots + c(f_k) \\le n(k-1) + c(f) \\]\nwhere $f \\colon S \\to S$ is the composed function $f_1 \\circ \\dots \\circ f_k$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p5679356}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $S = \\{1, \\dots, n\\}$.\nGiven a bijection $f \\colon S \\to S$ an \\emph{orbit} of $f$ is a\nset of the form $\\{x, f(x), f(f(x)), \\dots \\}$ for some $x \\in S$.\nWe denote by $c(f)$ the number of distinct orbits of $f$.\nFor example, if $n=3$ and $f(1)=2$, $f(2)=1$, $f(3)=3$,\nthe two orbits are $\\{1,2\\}$ and $\\{3\\}$, hence $c(f)=2$.\n\nGiven $k$ bijections $f_1$, \\dots, $f_k$ from $S$ to itself, prove that\n\\[ c(f_1) + \\dots + c(f_k) \\le n(k-1) + c(f) \\]\nwhere $f \\colon S \\to S$ is the composed function $f_1 \\circ \\dots \\circ f_k$.\n\\end{mdframed}\nMost motivated solution is to consider $n - c(f)$ and show this is the transposition distance.\nDumb graph theory works as well.\n\\pagebreak", "category": "Combinatorics", "source": "TST", "year": 2016}
{"id": "tst-2016-q2", "question": "Let $ABC$ be a scalene triangle with circumcircle $\\Omega$,\nand suppose the incircle of $ABC$ touches $BC$ at $D$.\nThe angle bisector of $\\angle A$ meets $BC$ and $\\Omega$ at $K$ and $M$.\nThe circumcircle of $\\triangle DKM$ intersects the $A$-excircle\nat $S_1$, $S_2$, and $\\Omega$ at $T \\neq M$.\nProve that line $AT$ passes through either $S_1$ or $S_2$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p5679361}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a scalene triangle with circumcircle $\\Omega$,\nand suppose the incircle of $ABC$ touches $BC$ at $D$.\nThe angle bisector of $\\angle A$ meets $BC$ and $\\Omega$ at $K$ and $M$.\nThe circumcircle of $\\triangle DKM$ intersects the $A$-excircle\nat $S_1$, $S_2$, and $\\Omega$ at $T \\neq M$.\nProve that line $AT$ passes through either $S_1$ or $S_2$.\n\\end{mdframed}\nWe present an angle-chasing solution,\nand then a more advanced alternative finish.\n\n\\paragraph{First solution (angle chasing).}\nAssume for simplicity $AB < AC$.\nLet $E$ be the contact point of the $A$-excircle on $BC$;\nalso let ray $TD$ meet $\\Omega$ again at $L$.\nFrom the fact that $\\angle MTL = \\angle MTD = 180^{\\circ} - \\angle MKD$,\nwe can deduce that $\\angle MTL = \\angle ACM$,\nmeaning that $L$ is the reflection of $A$ across the\nperpendicular bisector $\\ell$ of $BC$.\nIf we reflect $T$, $D$, $L$ over $\\ell$, we deduce $A$, $E$ and the reflection of $T$ across\n$\\ell$ are collinear, which implies that $\\angle BAT = \\angle CAE$.\n\nNow, consider the reflection point $E$ across line $AI$, say $S$.\nSince ray $AI$ passes through the $A$-excenter, $S$ lies on the $A$-excircle.\nSince $\\angle BAT = \\angle CAE$, $S$ also lies on ray $AT$.\nBut the circumcircles of triangles $DKM$ and $KME$ are congruent (from $DM = EM$),\nso $S$ lies on the circumcircle of $\\triangle DKM$ too.\nHence $S$ is the desired intersection point.\n\n\\begin{center}\n\\begin{asy}\nsize(12cm);\npair A = dir(40);\npair B = dir(210);\npair C = dir(330);\npair I = incenter(A, B, C);\npair D = foot(I, B, C);\npair K = extension(A, I, B, C);\npair M = dir(-90);\npair E = B+C-D;\npair I_A = 2*M-I;\n\npair S = -E+2*foot(E, K, M);\n\npair L = dir(90);\n\nfilldraw(A--B--C--cycle, opacity(0.2)+lightblue, blue);\nfilldraw(unitcircle, opacity(0.1)+lightblue, blue);\n\nfilldraw(circumcircle(D, K, M), opacity(0.2)+lightgreen, green);\nfilldraw(circumcircle(E, K, M), opacity(0.2)+lightred, red);\n\ndraw(A--I_A, blue);\n\ndraw(arc(I_A, abs(E-I_A), -20, 120), heavycyan);\ndraw(E--S, orange);\n\npair T = extension(I, L, A, S);\ndraw(E--A--S, orange+dashed);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$D$\", D, dir(90));\ndot(\"$K$\", K, dir(100));\ndot(\"$M$\", M, dir(M));\ndot(\"$E$\", E, dir(E));\ndot(\"$I_A$\", I_A, dir(I_A));\ndot(\"$S$\", S, dir(10));\ndot(\"$T$\", T, dir(T));\n\n/* Source generated by TSQ\n\n!size(12cm);\nA = dir 40\nB = dir 210\nC = dir 330\nI := incenter A B C\nD = foot I B C R90\nK = extension A I B C R100\nM = dir -90\nE = B+C-D\nI_A = 2*M-I\n\nS = -E+2*foot E K M R10\nL := dir 90\n\nA--B--C--cycle 0.2 lightblue / blue\nunitcircle 0.1 lightblue / blue\n\ncircumcircle D K M 0.2 lightgreen / green\ncircumcircle E K M 0.2 lightred / red\n\nA--I_A blue\n\n!draw(arc(I_A, abs(E-I_A), -20, 120), heavycyan);\nE--S orange\n\nT = extension I L A S\nE--A--S orange dashed\n*/\n\\end{asy}\n\\end{center}\n\n\\paragraph{Second solution (advanced).}\nIt's known that $T$ is the touch-point of the $A$-mixtilinear incircle.\nLet $E$ be contact point of $A$-excircle on $BC$.\nNow the circumcircles of $\\triangle DKM$ and $\\triangle KME$ are congruent,\nsince $DM = ME$ and the angles at $K$ are supplementary.\nLet $S$ be the reflection of $E$ across line $KM$, which by\nthe above the above comment lies on the circumcircle of $\\triangle DKM$.\nSince $KM$ passes through the $A$-excenter, $S$ also lies on the $A$-excircle.\nBut $S$ also lies on line $AT$, since lines $AT$ and $AE$ are isogonal\n(the mixtilinear cevian is isogonal to the Nagel line).\nThus $S$ is the desired intersection point.\n\n\\paragraph{Authorship comments.}\nThis problem comes from an observation of mine:\nlet $ABC$ be a triangle,\nlet the $\\angle A$ bisector meet $\\ol{BC}$ and $(ABC)$ at $E$ and $M$.\nLet $W$ be the tangency point of the $A$-mixtilinear excircle\nwith the circumcircle of $ABC$.\nThen $A$-Nagel line passed through a common intersection\nof the circumcircle of $\\triangle MEW$\nand the $A$-mixtilinear incircle.\n\nThis problem is the inverted version of this observation.\n\\pagebreak", "category": "Geometry", "source": "TST", "year": 2016}
{"id": "tst-2016-q3", "question": "Let $p$ be a prime number. Let $\\FF_p$ denote the integers modulo $p$,\nand let $\\FF_p[x]$ be the set of polynomials with coefficients in $\\FF_p$.\nDefine $\\Psi \\colon \\FF_p[x] \\to \\FF_p[x]$ by\n\\[ \\Psi\\left( \\sum_{i=0}^n a_i x^i \\right) = \\sum_{i=0}^n a_i x^{p^i}. \\]\nProve that for nonzero polynomials $F,G \\in \\FF_p[x]$,\n\\[ \\Psi(\\gcd(F,G)) = \\gcd(\\Psi(F), \\Psi(G)). \\]\n%Here, a polynomial $Q$ divides $P$ if there exists $R \\in \\FF_p[x]$\n%such that $P(x) - Q(x) R(x)$ is the polynomial with all coefficients $0$\n%(with all addition and multiplication in the coefficients taken modulo $p$),\n%and the gcd of two polynomials is the highest degree polynomial\n%with leading coefficient $1$ which divides both of them.\n%A non-zero polynomial is a polynomial with not all coefficients $0$.\n%As an example of multiplication, $(x+1)(x+2)(x+3) = x^3+x^2+x+1$\n%in $\\FF_5[x]$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p5679392}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $p$ be a prime number. Let $\\FF_p$ denote the integers modulo $p$,\nand let $\\FF_p[x]$ be the set of polynomials with coefficients in $\\FF_p$.\nDefine $\\Psi \\colon \\FF_p[x] \\to \\FF_p[x]$ by\n\\[ \\Psi\\left( \\sum_{i=0}^n a_i x^i \\right) = \\sum_{i=0}^n a_i x^{p^i}. \\]\nProve that for nonzero polynomials $F,G \\in \\FF_p[x]$,\n\\[ \\Psi(\\gcd(F,G)) = \\gcd(\\Psi(F), \\Psi(G)). \\]\n%Here, a polynomial $Q$ divides $P$ if there exists $R \\in \\FF_p[x]$\n%such that $P(x) - Q(x) R(x)$ is the polynomial with all coefficients $0$\n%(with all addition and multiplication in the coefficients taken modulo $p$),\n%and the gcd of two polynomials is the highest degree polynomial\n%with leading coefficient $1$ which divides both of them.\n%A non-zero polynomial is a polynomial with not all coefficients $0$.\n%As an example of multiplication, $(x+1)(x+2)(x+3) = x^3+x^2+x+1$\n%in $\\FF_5[x]$.\n\\end{mdframed}\nObserve that $\\Psi$ is also a linear map of $\\FF_p$ vector spaces,\nand that $\\Psi(xP) = \\Psi(P)^p$ for any $P \\in \\FF_p[x]$.\n(In particular, $\\Psi(1) = x$, not $1$, take caution!)\n\n\\paragraph{First solution (Ankan Bhattacharya).}\nWe start with:\n\\begin{claim*}\n  If $P \\mid Q$ then $\\Psi(P) \\mid \\Psi(Q)$.\n\\end{claim*}\n\\begin{proof}\n  Set $Q = PR$, where $R = \\sum_{i=0}^k r_i x^i$.\n  Then\n  \\[ \\Psi(Q) = \\Psi\\left( P\\sum_{i=0}^k r_i x^i \\right)\n    = \\sum_{i=0}^k \\Psi\\left( P \\cdot r_i x^i  \\right)\n    = \\sum_{i=0}^k r_i \\Psi(P)^{p^i} \\]\n  which is divisible by $\\Psi(P)$.\n\\end{proof}\n\nThis already implies\n\\[ \\Psi(\\gcd(F,G)) \\mid \\gcd(\\Psi(F), \\Psi(G)). \\]\nFor the converse, by Bezout there exists $A,B \\in \\FF_p[x]$\nsuch that $AF + BG = \\gcd(F,G)$, so taking $\\Psi$ of both sides gives\n\\[ \\Psi(AF) + \\Psi(BG) = \\Psi\\left( \\gcd(F,G) \\right). \\]\nThe left-hand side is divisible by $\\gcd(\\Psi(F), \\Psi(G))$\nsince the first term is divisible by $\\Psi(F)$\nand the second term is divisible by $\\Psi(G)$.\nSo $\\gcd(\\Psi(F), \\Psi(G)) \\mid \\Psi(\\gcd(F,G))$\nand noting both sides are monic we are done.\n\n\\paragraph{Second solution.}\nHere is an alternative (longer but more conceptual) way to finish without Bezout lemma.\nLet $\\beth \\subseteq \\FF_p[x]$ denote the set of polynomials in the image of $\\Psi$,\nthus $\\Psi \\colon \\FF_p[x] \\to \\beth$ is a bijection on the level of sets.\n\n\\begin{claim*}\n  If $A,B \\in \\beth$ then $\\gcd(A,B) \\in \\beth$.\n\\end{claim*}\n\\begin{proof}\n  It suffices to show that if $A$ and $B$ are monic,\n  and $\\deg A > \\deg B$,\n  then the remainder when $A$ is divided by $B$ is in $\\beth$.\n  Suppose $\\deg A = p^k$ and $B = x^{p^{k-1}} - c_2x^{p^{k-2}} - \\dots - c_k$.\n  Then\n  \\begin{align*}\n    x^{p^k} &\\equiv \\left( c_2x^{p^{k-2}} + c_3x^{p^{k-3}}\n    + \\dots + c_k  \\right)^p \\pmod B  \\\\\n    &\\equiv c_2x^{p^{k-1}} + c_3x^{p^{k-2}} \\dots + c_k \\pmod B\n  \\end{align*}\n  since exponentiation by $p$ commutes with addition in $\\FF_p$.\n  This is enough to imply the conclusion.\n  The proof if $\\deg B$ is smaller less than $p^{k-1}$ is similar.\n\\end{proof}\n\nThus, if we view $\\FF_p[x]$ and $\\beth$ as partially ordered sets\nunder polynomial division, then $\\gcd$ is the\n``greatest lower bound'' or ``meet'' in both partially ordered sets.\nWe will now prove that $\\Psi$ is an \\emph{isomorphism} of the posets.\nWe have already seen that $P \\mid Q \\implies \\Psi(P) \\mid \\Psi(Q)$\nfrom the first solution. For the converse:\n\n\\begin{claim*}\n  If $\\Psi(P) \\mid \\Psi(Q)$ then $P \\mid Q$.\n\\end{claim*}\n\\begin{proof}\n  Suppose $\\Psi(P) \\mid \\Psi(Q)$, but $Q=PA+B$ where $\\deg B < \\deg P$.\n  Thus $\\Psi(P) \\mid \\Psi(PA) + \\Psi(B)$, hence $\\Psi(P) \\mid \\Psi(B)$,\n  but $\\deg \\Psi(P) > \\deg \\Psi(B)$ hence $\\Psi(B) = 0 \\implies B = 0$.\n\\end{proof}\n\nThis completes the proof.\n\n\\begin{remark*}\n   In fact $\\Psi \\colon \\FF_p[x] \\to \\beth$ is a ring isomorphism\n   if we equip $\\beth$ with function composition as the ring multiplication.\n   Indeed in the proof of the first claim\n   (that $P \\mid Q \\implies \\Psi(P) \\mid \\Psi(Q)$) we saw that\n   \\[ \\Psi(RP) = \\sum_{i=0}^k r_i \\Psi(P)^{p^i} = \\Psi(R) \\circ \\Psi(P). \\]\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Algebra", "source": "TST", "year": 2016}
{"id": "tst-2016-q4", "question": "Let $\\sqrt{3}=1.b_1b_2b_3\\dots_{(2)}$ be the binary representation\nof $\\sqrt 3$. Prove that for any positive integer $n$, at least one of\nthe digits $b_n, b_{n+1}, \\dots, b_{2n}$ equals 1.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6368201}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $\\sqrt{3}=1.b_1b_2b_3\\dots_{(2)}$ be the binary representation\nof $\\sqrt 3$. Prove that for any positive integer $n$, at least one of\nthe digits $b_n, b_{n+1}, \\dots, b_{2n}$ equals 1.\n\\end{mdframed}\nAssume the contrary, so that for some integer $k$ we have\n\\[k < 2^{n-1} \\sqrt 3 < k + \\frac{1}{2^{n+1}}. \\]\nSquaring gives\n\\begin{align*}\nk^2 < 3 \\cdot 2^{2n-2} &< k^2 + \\frac{k}{2^n} + \\frac{1}{2^{2n+2}} \\\\\n&\\le k^2 + \\frac{2^{n-1} \\sqrt 3}{2^n} + \\frac{1}{2^{2n+2}} \\\\\n&= k^2 + \\frac{\\sqrt3}{2} + \\frac{1}{2^{2n+2}} \\\\\n&\\le k^2 + \\frac{\\sqrt3}{2} + \\frac{1}{16} \\\\\n&< k^2+1\n\\end{align*}\nand this is a contradiction.\n\\pagebreak", "category": "Number Theory", "source": "TST", "year": 2016}
{"id": "tst-2016-q5", "question": "Let $n \\ge 4$ be an integer.\nFind all functions $W \\colon \\{1, \\dots, n\\}^2 \\to \\RR$ such that\nfor every partition $[n] = A \\cup B \\cup C$ into disjoint sets,\n\\[ \\sum_{a \\in A} \\sum_{b \\in B} \\sum_{c \\in C} W(a,b) W(b,c)\n= |A| |B| |C|. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6368185}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n \\ge 4$ be an integer.\nFind all functions $W \\colon \\{1, \\dots, n\\}^2 \\to \\RR$ such that\nfor every partition $[n] = A \\cup B \\cup C$ into disjoint sets,\n\\[ \\sum_{a \\in A} \\sum_{b \\in B} \\sum_{c \\in C} W(a,b) W(b,c)\n= |A| |B| |C|. \\]\n\\end{mdframed}\nOf course, $W(k,k)$ is arbitrary for $k \\in [n]$.\nWe claim that $W(a,b) = \\pm 1$ for any $a \\neq b$, with the sign fixed.\n(These evidently work.)\n\nFirst, let $X_{abc} = W(a,b)W(b,c)$ for all distinct $a$, $b$, $c$,\nso the given condition is\n\\[ \\sum_{a,b,c \\in A \\times B \\times C} X_{abc} = |A| |B| |C|. \\]\nConsider the given equation with the particular choices\n\\begin{itemize}\n  \\ii $A = \\{1\\}$, $B = \\{2\\}$, $C = \\{3,4,\\dots,n\\}$.\n  \\ii $A = \\{1\\}$, $B = \\{3\\}$, $C = \\{2,4,\\dots,n\\}$.\n  \\ii $A = \\{1\\}$, $B = \\{2,3\\}$, $C = \\{4,\\dots,n\\}$.\n\\end{itemize}\nThis gives\n\\begin{align*}\n  X_{123} + X_{124} + \\dots + X_{12n} &= n-2 \\\\\n  X_{132} + X_{134} + \\dots + X_{13n} &= n-2 \\\\\n  (X_{124} + \\dots + X_{12n})\n  + (X_{134} + \\dots + X_{13n}) &= 2(n-3).\n\\end{align*}\nAdding the first two and\nsubtracting the last one gives $X_{123} + X_{132} = 2$.\nSimilarly, $X_{123} + X_{321} = 2$,\nand in this way we have $X_{321} = X_{132}$.\nThus $W(3,2)W(2,1) = W(1,3)W(3,2)$,\nand since $W(3,2) \\neq 0$ (clearly) we get $W(2,1) = W(3,2)$.\n\nAnalogously, for any distinct $a$, $b$, $c$ we have $W(a,b) = W(b,c)$.\nFor $n \\ge 4$ this is enough to imply $W(a,b) = \\pm 1$ for $a \\neq b$\nwhere the choice of sign is the same for all $a$ and $b$.\n\n\\begin{remark*}\nSurprisingly, the $n = 3$ case has ``extra'' solutions for\n$W(1,2) = W(2,3) = W(3,1) = \\pm1$,\n$W(2,1) = W(3,2) = W(1,3) = \\mp1$.\n\\end{remark*}\n\\begin{remark*}\n[Intuition]\nIt should still be possible to solve the problem\nwith $X_{abc}$ in place of $W(a,b) W(b,c)$,\nbecause we have about far more equations than variables $X_{a,b,c}$\nso linear algebra assures us we almost certainly have a unique solution.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "TST", "year": 2016}
{"id": "tst-2016-q6", "question": "Let $ABC$ be an acute scalene triangle\nand let $P$ be a point in its interior.\nLet $A_1$, $B_1$, $C_1$ be projections of $P$ onto\ntriangle sides $BC$, $CA$, $AB$, respectively.\nFind the locus of points $P$ such that\n$AA_1$, $BB_1$, $CC_1$ are concurrent\nand $\\angle PAB + \\angle PBC + \\angle PCA = 90\\dg$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6368189}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be an acute scalene triangle\nand let $P$ be a point in its interior.\nLet $A_1$, $B_1$, $C_1$ be projections of $P$ onto\ntriangle sides $BC$, $CA$, $AB$, respectively.\nFind the locus of points $P$ such that\n$AA_1$, $BB_1$, $CC_1$ are concurrent\nand $\\angle PAB + \\angle PBC + \\angle PCA = 90\\dg$.\n\\end{mdframed}\nIn complex numbers with $ABC$ the unit circle,\nit is equivalent to solving the following two cubic equations\nin $p$ and $q = \\ol p$:\n\\begin{align*}\n (p-a)(p-b)(p-c) &= (abc)^2 (q -1/a)(q - 1/b)(q - 1/c) \\\\\n 0 &= \\prod_{\\text{cyc}} (p+c-b-bcq) + \\prod_{\\text{cyc}} (p+b-c-bcq).\n\\end{align*}\nViewing this as two cubic curves in $(p,q) \\in \\CC^2$,\nby \\emph{B\\'ezout's Theorem} it follows there are at most nine solutions\n(unless both curves are not irreducible,\nbut it's easy to check the first one cannot be factored).\nMoreover it is easy to name nine solutions (for $ABC$ scalene):\nthe three vertices, the three excenters, and $I$, $O$, $H$.\nHence the answer is just those three triangle centers $I$, $O$ and $H$.\n\n\\begin{remark*}\n  On the other hand it is not easy to solve the cubics by hand;\n  I tried for an hour without success.\n  So I think this solution is only feasible\n  with knowledge of algebraic geometry.\n\\end{remark*}\n\\begin{remark*}\n  These two cubics have names:\n  \\begin{itemize}\n    \\ii The locus of $\\angle PAB + \\angle PBC + \\angle PCA = 90\\dg$\n    is the \\textbf{McCay cubic},\n    which is the locus of points $P$\n    for which $P$, $P^\\ast$, $O$ are collinear.\n    \\ii The locus of the pedal condition\n    is the \\textbf{Darboux cubic},\n    which is the locus of points $P$\n    for which $P$, $P^\\ast$, $L$ are collinear,\n    $L$ denoting the de Longchamps point.\n  \\end{itemize}\n  Assuming $P \\neq P^\\ast$,\n  this implies $P$ and $P^\\ast$\n  both lie on the Euler line of $\\triangle ABC$,\n  which is possible only if $P=O$ or $P=H$.\n\n  Some other synthetic solutions are posted at\n  \\url{https://aops.com/community/c6h1243902p6368189}.\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Geometry", "source": "TST", "year": 2016}
{"id": "imo-2004-q1", "question": "Let $ABC$ be an acute-angled triangle with $AB\\neq AC$.\nThe circle with diameter $BC$ intersects the sides $AB$ and $AC$\nat $M$ and $N$ respectively.\nDenote by $O$ the midpoint of the side $BC$.\nThe bisectors of the angles $\\angle BAC$ and $\\angle MON$ intersect at $R$.\nProve that the circumcircles of the triangles $BMR$ and $CNR$\nhave a common point lying on the side $BC$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p99445}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be an acute-angled triangle with $AB\\neq AC$.\nThe circle with diameter $BC$ intersects the sides $AB$ and $AC$\nat $M$ and $N$ respectively.\nDenote by $O$ the midpoint of the side $BC$.\nThe bisectors of the angles $\\angle BAC$ and $\\angle MON$ intersect at $R$.\nProve that the circumcircles of the triangles $BMR$ and $CNR$\nhave a common point lying on the side $BC$.\n\\end{mdframed}\nBy Miquel's theorem it's enough to show $AMRN$ is cyclic.\n\\begin{center}\n\\begin{asy}\npair A = dir(130);\npair B = dir(210);\npair C = dir(330);\npair H = A+B+C;\npair M = foot(C, A, B);\npair N = foot(B, A, C);\npair O = midpoint(B--C);\npair R = extension(A, incenter(A, B, C), O, midpoint(M--N));\npair T = extension(H, R, B, C);\nfilldraw(A--B--C--cycle, opacity(0.1)+lightblue, blue);\ndraw(B--N, blue);\ndraw(C--M, blue);\nfilldraw(circumcircle(A, M, N), opacity(0.1)+lightgreen, heavygreen);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$H$\", H, dir(H));\ndot(\"$M$\", M, dir(M));\ndot(\"$N$\", N, dir(N));\ndot(\"$O$\", O, dir(O));\ndot(\"$R$\", R, dir(R));\n// dot(\"$T$\", T, dir(T));\n\n/* TSQ Source:\n\nA = dir 130\nB = dir 210\nC = dir 330\nH = A+B+C\nM = foot C A B\nN = foot B A C\nO = midpoint B--C\nR = extension A incenter A B C O midpoint M--N\nT = extension H R B C\nA--B--C--cycle 0.1 lightblue / blue\nB--N blue\nC--M blue\ncircumcircle A M N 0.1 lightgreen / heavygreen\nR--T--B blue\n\n*/\n\\end{asy}\n\\end{center}\nIn fact, since the bisector of $\\angle MON$\nis just the perpendicular bisector of $\\ol{MN}$,\nthe point $R$ is actually just the arc midpoint\nof $\\widehat{MN}$ of $(AMN)$ as desired.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2004}
{"id": "imo-2004-q2", "question": "Find all polynomials $P$ with real coefficients such that\nfor all reals $a$, $b$, $c$ such that $ab+bc+ca = 0$, we have\n\\[ P(a-b) + P(b-c) + P(c-a) = 2P(a+b+c). \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p99448}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all polynomials $P$ with real coefficients such that\nfor all reals $a$, $b$, $c$ such that $ab+bc+ca = 0$, we have\n\\[ P(a-b) + P(b-c) + P(c-a) = 2P(a+b+c). \\]\n\\end{mdframed}\nThe answer is \\[ P(x) = \\alpha x^4 + \\beta x^2 \\]\nwhich can be checked to work, for any real numbers $\\alpha$ and $\\beta$.\n\nIt is easy to obtain that $P$ is even and $P(0) = 0$.\nThe trick is now to choose $(a,b,c) = (6x,3x,-2x)$\nand then compare the leading coefficients to get\n\\[ 3^n + 5^n + 8^n = 2 \\cdot 7^n \\]\nfor $n = \\deg f$ (which is even).\nAs $n \\ge 7 \\implies (8/7)^n > 2$, this means that we must have $n \\le 6$.\nMoreover, taking modulo $7$ we have $3^n + 5^n \\equiv 6 \\pmod 7$\nwhich gives $n \\equiv 2, 4 \\pmod 6$.\n\nThus $\\deg P \\le 4$, which (combined with $P$ even) resolves the problem.\n\\pagebreak", "category": "Algebra", "source": "IMO", "year": 2004}
{"id": "imo-2004-q3", "question": "Define a ``hook'' to be a figure made up of six unit squares\nas shown below in the picture,\nor any of the figures obtained by applying rotations\nand reflections to this figure.\n\\begin{center}\n\\begin{asy}\nunitsize(0.5 cm);\ndraw(unitsquare);\ndraw(shift(0,1)*unitsquare);\ndraw(shift(0,2)*unitsquare);\ndraw(shift(1,2)*unitsquare);\ndraw(shift(2,1)*unitsquare);\ndraw(shift(2,2)*unitsquare);\n\\end{asy}\n\\end{center}\nWhich $m \\times n$ rectangles can be tiled by hooks?", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p99450}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nDefine a ``hook'' to be a figure made up of six unit squares\nas shown below in the picture,\nor any of the figures obtained by applying rotations\nand reflections to this figure.\n\\begin{center}\n\\begin{asy}\nunitsize(0.5 cm);\ndraw(unitsquare);\ndraw(shift(0,1)*unitsquare);\ndraw(shift(0,2)*unitsquare);\ndraw(shift(1,2)*unitsquare);\ndraw(shift(2,1)*unitsquare);\ndraw(shift(2,2)*unitsquare);\n\\end{asy}\n\\end{center}\nWhich $m \\times n$ rectangles can be tiled by hooks?\n\\end{mdframed}\nThe answer is that one requires:\n\\begin{itemize}\n  \\ii $\\{1,2,5\\} \\notin \\{m,n\\}$,\n  \\ii $3 \\mid m$ or $3 \\mid n$,\n  \\ii $4 \\mid m$ or $4 \\mid n$.\n\\end{itemize}\n\nFirst, we check all of these work, in fact we claim:\n\\begin{claim*}\n  Any rectangle satisfying these conditions\n  can be tiled by $3 \\times 4$ rectangles (and hence by hooks).\n\\end{claim*}\n\\begin{proof}\n  If $3 \\mid m$ and $4 \\mid n$, this is clear.\n  Else suppose $12 \\mid m$ but $3 \\nmid n$, $4 \\nmid n$.\n  Then $n \\ge 7$, so it can be written in the form\n  $3a+4b$ for nonnegative integers $a$ and $b$, which permits a tiling.\n\\end{proof}\n\nWe now prove these conditions are necessary.\nIt is not hard to see that $m,n \\notin \\{1,2,5\\}$ is necessary.\n\nWe thus turn our attention to divisibility conditions.\nEach hook has a \\emph{hole}, and if we associate each hook with\nthe one that fills its hole, we get a bijective pairing of hooks.\nThus the number of cells is divisible by $12$,\nand the cells come grouped into two possible shapes,\nwhich we will call \\textbf{tiles} shown below,\n(rotations and reflections permitted).\n\\begin{center}\n\\begin{asy}\nunitsize(0.5 cm);\nfilldraw(unitsquare, white, black);\nfilldraw(shift(0,1)*unitsquare, white, black);\nfilldraw(shift(0,2)*unitsquare, white, black);\nfilldraw(shift(1,2)*unitsquare, white, black);\nfilldraw(shift(2,1)*unitsquare, white, black);\nfilldraw(shift(2,2)*unitsquare, white, black);\n\nfilldraw(shift(1,0)*unitsquare, gray, black);\nfilldraw(shift(1,1)*unitsquare, gray, black);\nfilldraw(shift(2,0)*unitsquare, gray, black);\nfilldraw(shift(3,0)*unitsquare, gray, black);\nfilldraw(shift(3,1)*unitsquare, gray, black);\nfilldraw(shift(3,2)*unitsquare, gray, black);\n\\end{asy}\n\\qquad\n\\begin{asy}\nunitsize(0.5 cm);\nfilldraw(unitsquare, white, black);\nfilldraw(shift(0,1)*unitsquare, white, black);\nfilldraw(shift(0,2)*unitsquare, white, black);\nfilldraw(shift(1,2)*unitsquare, white, black);\nfilldraw(shift(2,1)*unitsquare, white, black);\nfilldraw(shift(2,2)*unitsquare, white, black);\n\nfilldraw(shift(1,0)*unitsquare, gray, black);\nfilldraw(shift(1,1)*unitsquare, gray, black);\nfilldraw(shift(1,-1)*unitsquare, gray, black);\nfilldraw(shift(0,-1)*unitsquare, gray, black);\nfilldraw(shift(-1,-1)*unitsquare, gray, black);\nfilldraw(shift(-1,0)*unitsquare, gray, black);\n\\end{asy}\n\\end{center}\n\nIn particular, the total number of cells is divisible by $12$.\nThus the problem is reduced to proving that:\n\\begin{claim*}\n  if a $6a \\times 2b$ rectangle is tiled by tiles,\n  then at least one of $a$ and $b$ is even.\n\\end{claim*}\n\\begin{proof}\n  Note that the tiles can be further classified into two types:\n  \\begin{itemize}\n    \\ii \\textbf{First type}: These tiles have exactly four columns,\n    each with exactly three cells (an odd number).\n    Moreover, all rows have an even number of cells (either $2$ or $4$).\n    \\ii \\textbf{Second type}: vice-versa.\n    These tiles have exactly four rows,\n    each with exactly three cells (an odd number).\n    Moreover, all rows have an odd number of cells.\n  \\end{itemize}\n  We claim that any tiling uses an even number of each type, which is enough.\n\n  By symmetry we prove an even number of first-type tiles.\n  Color red every fourth column of the rectangle.\n  The number of cells colored red is even.\n  The tiles of the second type cover an even number of red cells,\n  and the tiles of the first type cover an odd number of red cells.\n  Hence the number of tiles of the first type must be even.\n\\end{proof}\n\n\\begin{remark*}\n  This shows that a rectangle can be tiled by hooks\n  if and only if it can be tiled by $3 \\times 4$ rectangles.\n  But there exist tilings which do not decompose into $3 \\times 4$;\n  see e.g.\\ \\url{https://aops.com/community/c6h14023p99881}.\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Geometry", "source": "IMO", "year": 2004}
{"id": "imo-2004-q4", "question": "Let $n \\ge 3$ be an integer\nand $t_1$, $t_2$, \\dots, $t_n$ positive real numbers such that\n\\[ n^2+1 > \\left(t_1 + t_2 + \\dots + t_n\\right)\n  \\left( \\frac{1}{t_1} + \\frac{1}{t_2} + \\dots + \\frac{1}{t_n} \\right). \\]\nShow that $t_i$, $t_j$, $t_k$ are the sides of a triangle\nfor all $i$, $j$, $k$ with $1 \\le i < j < k \\le n$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p99756}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n \\ge 3$ be an integer\nand $t_1$, $t_2$, \\dots, $t_n$ positive real numbers such that\n\\[ n^2+1 > \\left(t_1 + t_2 + \\dots + t_n\\right)\n  \\left( \\frac{1}{t_1} + \\frac{1}{t_2} + \\dots + \\frac{1}{t_n} \\right). \\]\nShow that $t_i$, $t_j$, $t_k$ are the sides of a triangle\nfor all $i$, $j$, $k$ with $1 \\le i < j < k \\le n$.\n\\end{mdframed}\nLet $a = t_1$, $b = t_2$, $c = t_3$.\nExpand:\n\\begin{align*}\n  n^2+1 &> \\left(t_1 + t_2 + \\dots + t_n\\right)\n    \\left( \\frac{1}{t_1} + \\dots + \\frac{1}{t_n} \\right) \\\\\n  &= n + \\sum_{1 \\le i < j \\le n}\n    \\left( \\frac{t_i}{t_j} + \\frac{t_j}{t_i} \\right) \\\\\n  &= n + \\sum_{1 \\le i < j \\le n}\n    \\left( \\frac{t_i}{t_j} + \\frac{t_j}{t_i} \\right) \\\\\n  &\\ge n + \\sum_{1 \\le i < j \\le 3}\n    \\left( \\frac{t_i}{t_j} + \\frac{t_j}{t_i} \\right)\n    + \\sum_{\\substack{1 \\le i < j \\le n \\\\ j > 3 }} 2 \\\\\n  &= n + 2\\left( \\binom n2-3 \\right)\n    + \\left( \\frac ab + \\frac ba \\right)\n    + \\frac{a+b}{c} + \\frac{c}{b} + \\frac{c}{a} \\\\\n  &\\ge n + 2\\left( \\binom n2-3 \\right) + 2\n    + \\frac{a+b}{c} + c \\cdot \\frac{4}{a+b}\n\\end{align*}\nSo, we conclude that\n\\[ \\frac{a+b}{c} + \\frac{4c}{a+b} < 5 \\]\nwhich rearranges to\n\\[ \\left( 4c-(a+b) \\right)\\left( c-(a+b) \\right) < 0. \\]\nThis is enough to imply $c \\le a+b$.\n\n\\begin{remark*}\n  A variant of the same argument allows one to improve\n  the left-hand side to $(n+\\sqrt{10}-3)^2$.\n  One does so by writing\n  \\[ \\text{RHS} \\ge \\left( \\sqrt{\\left( a+b+c \\right)\n    \\left( \\frac1a+\\frac1b+\\frac1c \\right)} + (n-3) \\right)^2 \\]\n  and estimating the square root as in the previous approach.\n\n  In addition, $(n+\\sqrt{10}-3)^2$ is best possible,\n  as seen by taking $(a,b,c) = (2,1,1)$ and $t_4 = t_5 = \\dots = \\frac25 \\sqrt{10}$.\n\\end{remark*}\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2004}
{"id": "imo-2004-q5", "question": "In a convex quadrilateral $ABCD$,\nthe diagonal $BD$ bisects neither the angle $ABC$ nor the angle $CDA$.\nThe point $P$ lies inside $ABCD$ and satisfies\n\\[\\angle PBC=\\angle DBA \\quad\\text{and}\\quad \\angle PDC=\\angle BDA. \\]\nProve that $ABCD$ is a cyclic quadrilateral if and only if $AP=CP$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p99759}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nIn a convex quadrilateral $ABCD$,\nthe diagonal $BD$ bisects neither the angle $ABC$ nor the angle $CDA$.\nThe point $P$ lies inside $ABCD$ and satisfies\n\\[\\angle PBC=\\angle DBA \\quad\\text{and}\\quad \\angle PDC=\\angle BDA. \\]\nProve that $ABCD$ is a cyclic quadrilateral if and only if $AP=CP$.\n\\end{mdframed}\nWe show two solutions.\nWe note that the first hypothesis cannot be dropped, because $ABCD$ being a kite\nwith $BA=BC$ and $DA=DC$ with center $P$ is a counterexample\n(where $AP=CP$ but $ABCD$ is not cyclic).\nHowever, the condition that $BD$ bisects neither angle $\\angle B$ nor $\\angle D$\nis equivalent to requiring that the point $P$ does not lie on line $BD$\nand we assume this henceforth.\n\n\\paragraph{Barycentric solution (from teenager Evan).}\nApply barycentric coordinates to $\\triangle PBD$\n(nondegenerate by the non-bisect condition)\nwith $P = (1,0,0)$, $B = (0,1,0)$ and $D = (0,0,1)$.\nDefine $a = BD$, $b = DP$ and $c = PB$.\n\nSince $A$ and $C$ are isogonal conjugates with respect to $\\triangle PBD$,\nwe set \\[ A = (au : bv : cw) \\qquad\\text{and}\\qquad\n  C = \\left( \\frac au : \\frac bv : \\frac cw \\right). \\]\nFor brevity define $M = au + bv + cw$ and $N = avw + bwu + cuv$.\n\nWe now compute each condition.\n\\begin{claim*}\n  Quadrilateral $ABCD$ is cyclic if and only if $N^2 = u^2 M^2$.\n\\end{claim*}\n\\begin{proof}\n  W know a circle through $B$ and $D$\n  is a locus of points\n  with \\[ \\frac{a^2yz+b^2zx+c^2xy}{x(x+y+z)} \\]\n  is equal to some constant.\n  Therefore quadrilateral $ABCD$ is cyclic if and only if\n  $\\frac{abc \\cdot N}{au \\cdot M}$\n  is equal to $\\frac{abc \\cdot uvw \\cdot M}{avw \\cdot N}$\n  which rearranges to $N^2 = u^2M^2$.\n\\end{proof}\n\\begin{claim*}\n  We have $PA = PC$ if and only if $N^2 = u^2 M^2$.\n\\end{claim*}\n\\begin{proof}\n  We have the displacement vector\n  $\\overrightarrow{PA}\n  = \\tfrac{1}{M} \\left( bv+cw , -bv ,-cw \\right)$.\n  Therefore,\n  \\begin{align*}\n    M^2 \\cdot \\left\\lvert PA \\right\\rvert^2\n    &= -a^2(bv)(cw) + b^2(cw)(bv+cw) + c^2(bv)(bv+cw) \\\\\n    &= bc(-a^2vw + (bw+cv)(bv+cw)).\n  \\end{align*}\n  In a similar way\n  (by replacing $u$, $v$, $w$ with their inverses)\n  we have\n  \\begin{align*}\n    \\left( \\frac{N}{uvw} \\right)^2 \\cdot \\left\\lvert PC \\right\\rvert^2\n    &= (vw)^{-2} \\cdot bc(-a^2vw + (bv+cw)(bw+cv)) \\\\\n    \\iff N^2 \\cdot \\left\\lvert PC \\right\\rvert^2\n    & = u^2 bc(-a^2vw + (bw+cv)(bv+cw))\n  \\end{align*}\n  These are equal if and only if $N^2 = u^2M^2$, as desired.\n\\end{proof}\n\n\\paragraph{Angle chasing solution (Evan Chen and Petko Lazarov).}\nThe solution consists of two parts.\nThe first part is that by angle chasing, we will prove that\n\\[ \\dang PAC = \\dang ACP \\iff \\dang BAC + \\dang CBD + \\dang DCA + \\dang ADB = 0.\n  \\qquad (\\spadesuit). \\]\nA careless reader would be forgiven for thinking that $(\\spadesuit)$\nimplies the problem or at least one direction,\nbut it turns out the situation is more subtle.\nThe second part analyzes the angle conditions more carefully\nand provides a complete proof.\n\n\\subparagraph{Proof of the equivalence $(\\spadesuit)$ by angle chasing.}\nWe start with the following unconditional claim, valid for any quadrilateral.\n\\begin{claim*}\n  [Isogonal conjugation]\n  Let $ABCD$ and $P$ be as in the problem statement.\n  Then $\\dang APB + \\dang CPD = 180\\dg$.\n\\end{claim*}\n\\begin{proof}\n  The angles in the statement imply that $A$ and $C$\n  are isogonal conjugates with respect to $\\triangle PBC$.\n  Thus, lines $PA$ and $PC$ are isogonal with respect to $\\angle BPC$, as needed.\n\\end{proof}\n\n\\begin{center}\n\\begin{asy}\nimport geometry;\n\nsize(9cm);\npair A = (-0.50099,1.69422);\npair B = (-1.8,-0.6);\npair C = (0.09182,-1.79600);\npair D = (1.55802,-0.60384);\npair P = (-1.04359,-0.19363);\n\ndraw(circumcircle(A,B,C), gray+dashed);\nfilldraw(A--B--C--D--cycle, opacity(0.2)+yellow, black);\ndraw(B--D);\ndraw(A--C);\n\ndraw(C--P--A, brown);\ndraw(B--P--D, gray);\n\nmarkangle(radius=15, n=2, P, A, C, red, StickIntervalMarker(1,1, red));\nmarkangle(radius=15, n=2, A, C, P, red, StickIntervalMarker(1,1, red));\nmarkangle(radius=10, n=3, A, P, B, deepgreen, StickIntervalMarker(1,2, deepgreen));\nmarkangle(radius=10, n=3, C, P, D, deepgreen, StickIntervalMarker(1,1, deepgreen));\nmarkangle(radius=12, n=1, B, A, C, blue);\nmarkangle(radius=12, n=1, C, B, D, blue);\nmarkangle(radius=12, n=1, D, C, A, blue);\nmarkangle(radius=12, n=1, A, D, B, blue);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$D$\", D, dir(D));\ndot(\"$P$\", P, dir(45));\n\\end{asy}\n\\end{center}\n\nNext we rewrite the two angles $\\dang APB$ and $\\dang CPD$ in the claim\n(colored green with three rings)\nso that their only dependence on $P$\nis through the angles $\\dang PAC$ and $\\dang CAP$ (colored red with two rings),\nas follows:\n\\begin{align*}\n  -\\dang APB &= \\dang PBA + \\dang BAP = \\dang PBA + (\\dang BAC - \\dang PAC) \\\\\n    &= \\dang CBD + \\dang BAC - \\dang PAC \\\\\n  -\\dang CPD &= \\dang PDC + \\dang DCP = \\dang PDC + (\\dang DCA + \\dang ACP) \\\\\n    &= \\dang ADB + \\dang DCA + \\dang ACP.\n\\end{align*}\nSince the claim says $\\dang APB + \\dang CPD = 0$, summing\nlets us finally rewrite $\\dang PAC - \\dang APC$ in terms of only $A$, $B$, $C$, $D$:\n\\begin{align*}\n  0 &= (\\dang ACP - \\dang PAC) + \\dang ADB + \\dang DCA + \\dang CBD + \\dang BAC \\\\\n  \\implies \\dang PAC - \\dang ACP &= \\dang ADB + \\dang DCA + \\dang CBD + \\dang BAC.\n\\end{align*}\nThese four latter angles are colored blue with one ring in the figure.\nThis proves $(\\spadesuit)$.\n\n\\subparagraph{Quasi-harmonic quadrilaterals.}\nTo interpret the condition $(\\spadesuit)$, we define a new term:\na quadrilateral $ABCD$ is \\emph{quasi-harmonic} if $AB \\cdot CD = BC \\cdot DA$.\n(See IMO 2018/6 for another problem involving quasi-harmonic quadrilaterals.)\nThe following two lemmas show why this condition is relevant:\n\\begin{lemma*}\n  The condition\n  \\[ \\dang BAC + \\dang CBD + \\dang DCA + \\dang ADB = 0 \\]\n  is equivalent to $ABCD$ being \\emph{either} cyclic or quasi-harmonic or both.\n\\end{lemma*}\n\\begin{proof}\n  A clean approach with complex numbers\n  (posted at \\url{https://aops.com/community/p15327734}) goes as follows:\n  define complex numbers $\\mu = (a-b)(c-d) \\neq 0$ and $\\nu = (b-c)(d-a) \\neq 0$.\n  Then \\[ \\mu-\\nu = (a-c)(b-d) \\neq 0. \\]\n\n  Now the angle condition is equivalent to\n  \\begin{align*}\n    \\RR &\\ni \\frac{a-b}{d-b} \\cdot \\frac{b-c}{a-c} \\cdot \\frac{c-d}{b-d} \\cdot \\frac{d-a}{c-a} \\\\\n    &= \\frac{\\mu \\nu}{(\\mu - \\nu)^2} \\\\\n    &= \\frac{1}{\\frac{\\mu}{\\nu} + \\frac{\\nu}{\\mu} - 2} \\\\\n    \\iff \\RR &\\ni \\frac{\\mu}{\\nu} + \\frac{\\nu}{\\mu}.\n  \\end{align*}\n  In general, though $z+1/z$ is real exactly when either $|z|=1$ or $z \\in \\RR$.\n  Note $\\mu/\\nu \\in \\RR$ is equivalent to $ABCD$ cyclic\n  and $|\\mu| = |\\nu|$ is equivalent to $ABCD$ being quasiharmonic; the proof follows.\n\n  This can be also proved by inversion at $A$, though we don't write the details here.\n  (See also \\url{https://problems.ru/view_problem_details_new.php?id=116602}).\n\\end{proof}\n\n\\begin{lemma*}\n  Quadrilateral $ABCD$ is quasi-harmonic if and only if $P$ lies on line $AC$.\n\\end{lemma*}\n\\begin{proof}\n  Let $X = \\ol{BD} \\cap \\ol{AC}$.\n  If the isogonal of line $BD$ with respect to $\\angle B$ meets line $AC$ at $Y$, then\n  $\\frac{AX}{CX} \\frac{AY}{CY} = \\left( \\frac{BA}{BC} \\right)^2$.\n  Similarly if the isogonal to $\\angle D$ meets line $AC$ at $Y'$, then\n  $\\frac{AX}{CX} \\frac{AY'}{CY'} = \\left( \\frac{DA}{DC} \\right)^2$.\n  Hence $ABCD$ is quasi-harmonic if and only if $Y = Y'$ (that is, $Y=Y'=P$).\n\\end{proof}\n\n\\subparagraph{Wrap-up.}\nWe now show that $PA = PC$ if and only if $ABCD$ is cyclic\nby cases on whether $P$ lies on $\\ol{AC}$.\n\\begin{itemize}\n  \\ii If $ABCD$ is \\emph{not} quasi-harmonic,\n  then $(\\spadesuit)$ implies the problem statement immediately.\n  Indeed, $\\dang PAC = \\dang ACP$ if and only if $PA = PC$\n  (as $\\triangle PAC$ is not degenerate)\n  and the second lemma turns our angle condition into $ABCD$ cyclic.\n\n  \\ii Now assume $ABCD$ is quasi-harmonic and $P$ lies on line $AC$.\n  We ignore $(\\spadesuit)$.\n  Instead, note that if $ABCD$ is also cyclic then\n  $\\ol{BD}$ is a symmedian of $\\triangle ABC$ and hence $P$ is the midpoint.\n  Conversely, suppose we know $\\ol{BD}$ is a symmedian of $\\triangle ABC$.\n  Let $D' \\neq B$ be the point for which $ABCD'$ is cyclic and harmonic;\n  then $B$, $D$, $D'$ are collinear and $\\frac{BD}{CD} = \\frac{BD'}{CD'} = \\frac{BA}{CA}$.\n  So $D' = D$ (the corresponding Apollonian circle only meets line $BD$ twice), as needed.\n\\end{itemize}\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2004}
{"id": "imo-2004-q6", "question": "We call a positive integer \\emph{alternating} if every two consecutive digits\nin its decimal representation are of different parity.\nFind all positive integers $n$ which have an alternating multiple.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p99760}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nWe call a positive integer \\emph{alternating} if every two consecutive digits\nin its decimal representation are of different parity.\nFind all positive integers $n$ which have an alternating multiple.\n\\end{mdframed}\nIf $20 \\mid n$, then clearly $n$ has no alternating\nmultiple since the last two digits are both even.\nWe will show the other values of $n$ all work.\n\nThe construction is just rush-down do-it.\nThe meat of the solution is the two following steps.\n\\begin{claim*}\n  [Tail construction]\n  For every even integer $w \\ge 2$,\n  \\begin{itemize}\n    \\ii there exists an even alternating multiple $g(w)$ of $2^{w+1}$\n    with exactly $w$ digits, and\n    \\ii there exists an even alternating multiple $h(w)$ of $5^{w}$\n    with exactly $w$ digits.\n  \\end{itemize}\n\\end{claim*}\n(One might note this claim is implied by the problem, too.)\n\\begin{proof}\n  We prove the first point by induction on $w$.\n  If $w = 2$, take $g(2) = 32$.\n  In general, we can construct $g(w+2)$ from $g(w)$\n  by adding some element in\n  \\[ 10^w \\cdot \\{10, 12, 14, 16, 18, 30, \\dots, 98\\} \\]\n  to $g(w)$, corresponding to the digits\n  we want to append to the start.\n  This multiple is automatically divisible by $2^{w+1}$,\n  and also can take any of the four possible values modulo $2^{w+3}$.\n\n  The second point is a similar induction,\n  with base case $h(2) = 50$.\n  The same set above consists of numbers divisible by $5^w$,\n  and covers all residues modulo $5^{w+2}$.\n  Careful readers might recognize the second part\n  as essentially USAMO 2003/1.\n\\end{proof}\n\n\\begin{claim*}\n  [Head construction]\n  If $\\gcd(n,10) = 1$, then for any $b$,\n  there exists an even alternating number $f(b \\bmod n)$ which is\n  $b \\pmod n$.\n\\end{claim*}\n\\begin{proof}\n  A standard argument shows that\n  \\[ 10 \\cdot \\frac{100^m-1}{99}\n    = \\underbrace{1010\\dots10}_{m\\ 10\\text{'s}}\n    \\equiv 0 \\pmod n \\]\n  for any $m$ divisible by $\\varphi(99n)$.\n  Take a very large such $m$,\n  and then add on $b$ distinct numbers of the form $10^{\\varphi(n)r}$\n  for various even values of $r$; these all are $1 \\pmod n$\n  and change some of the $1$'s to $3$'s.\n\\end{proof}\n\n\nNow, we can solve the problem.\nConsider three cases:\n\\begin{itemize}\n  \\ii If $n = 2^k m$ where $\\gcd(m,10) = 1$ and $k \\ge 2$ is even,\n  then the concatenated number\n  \\[ 10^k f\\left( -\\frac{g(k)}{10^k} \\bmod m \\right) + g(k) \\]\n  works fine.\n\n  \\ii If $n = 5^k m$ where $\\gcd(m,10) = 1$ and $k \\ge 2$ is even,\n  then the concatenated number\n  \\[ 10^k f\\left( -\\frac{h(k)}{10^k} \\bmod m \\right) + h(k) \\]\n  works fine.\n\n  \\ii If $n = 50m$ where $\\gcd(m,10) = 1$,\n  then the concatenated number\n  \\[ 100 f\\left( -\\frac{1}{2} \\bmod m \\right) + 50 \\]\n  works fine.\n\\end{itemize}\nSince every non-multiple of $20$ divides such a number, we are done.\n\\pagebreak\n\n\n\\end{document}", "category": "Number Theory", "source": "IMO", "year": 2004}
{"id": "imo-1998-q1", "question": "A convex quadrilateral $ABCD$ has perpendicular diagonals.\nThe perpendicular bisectors of the sides $AB$ and $CD$ meet\nat a unique point $P$ inside $ABCD$.\nProve that the quadrilateral $ABCD$ is cyclic\nif and only if triangles $ABP$ and $CDP$ have equal areas.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p124387}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA convex quadrilateral $ABCD$ has perpendicular diagonals.\nThe perpendicular bisectors of the sides $AB$ and $CD$ meet\nat a unique point $P$ inside $ABCD$.\nProve that the quadrilateral $ABCD$ is cyclic\nif and only if triangles $ABP$ and $CDP$ have equal areas.\n\\end{mdframed}\nIf $ABCD$ is cyclic, then $P$ is the circumcenter,\nand $\\angle APB + \\angle PCD = 180\\dg$.\nThe hard part is the converse.\n\n\\begin{center}\n\\begin{asy}\nimport graph; size(10cm);\npen zzttqq = rgb(0.6,0.2,0.); pen aqaqaq = rgb(0.62745,0.62745,0.62745); pen cqcqcq = rgb(0.75294,0.75294,0.75294);\ndraw((2.28154,-9.32038)--(8.62921,-11.79133)--(2.93422,-2.54008)--cycle, linewidth(0.6) + zzttqq);\ndraw((2.28154,-9.32038)--(-2.,-4.)--(-4.,-12.)--cycle, linewidth(0.6) + zzttqq);\n\ndraw((8.62921,-11.79133)--(-2.,-4.), linewidth(0.6));\ndraw((2.93422,-2.54008)--(-4.,-12.), linewidth(0.6));\ndraw((8.62921,-11.79133)--(2.93422,-2.54008), linewidth(0.6));\ndraw((-2.,-4.)--(-4.,-12.), linewidth(0.6));\ndraw((2.28154,-9.32038)--(5.78172,-7.16571), linewidth(0.6) + blue);\ndraw((2.28154,-9.32038)--(-3.,-8.), linewidth(0.6) + blue);\ndraw((2.28154,-9.32038)--(8.62921,-11.79133), linewidth(0.6) + zzttqq);\ndraw((8.62921,-11.79133)--(2.93422,-2.54008), linewidth(0.6) + zzttqq);\ndraw((2.93422,-2.54008)--(2.28154,-9.32038), linewidth(0.6) + zzttqq);\ndraw((2.28154,-9.32038)--(-2.,-4.), linewidth(0.6) + zzttqq);\ndraw((-2.,-4.)--(-4.,-12.), linewidth(0.6) + zzttqq);\ndraw((-4.,-12.)--(2.28154,-9.32038), linewidth(0.6) + zzttqq);\ndraw((2.93422,-2.54008)--(-0.31533,2.73866), linewidth(0.6));\ndraw((-2.,-4.)--(-0.31533,2.73866), linewidth(0.6));\ndraw(circle((2.25532,-9.31383), 6.80768), linewidth(0.6) + aqaqaq);\ndraw((0.51354,-5.84245)--(-3.,-8.), linewidth(0.6) + blue);\ndraw((0.51354,-5.84245)--(5.78172,-7.16571), linewidth(0.6) + blue);\ndot(\"$D$\", (-4.,-12.), dir((-76.113, -27.810)));\ndot(\"$C$\", (-2.,-4.), dir((-75.616, 41.734)));\ndot(\"$B$\", (2.93422,-2.54008), dir((1.940, 37.397)));\ndot(\"$A$\", (8.62921,-11.79133), dir((31.751, -33.422)));\ndot(\"$P$\", (2.28154,-9.32038), dir((-11.247, -66.945)));\ndot(\"$M$\", (5.78172,-7.16571), dir((39.728, 27.050)));\ndot(\"$N$\", (-3.,-8.), dir((-82.402, 23.307)));\ndot(\"$E$\", (0.51354,-5.84245), dir((-30.585, 62.531)));\ndot(\"$X$\", (-0.31533,2.73866), dir((-23.973, 36.915)));\n\\end{asy}\n\\end{center}\n\nLet $M$ and $N$ be the midpoints of $\\ol{AB}$ and $\\ol{CD}$.\n\\begin{claim*}\n  Unconditionally, we have $\\dang NEM = \\dang MPN$.\n\\end{claim*}\n\\begin{proof}\n  Note that $\\ol{EN}$ is the median of right triangle $\\triangle ECD$, and similarly for $\\ol{EM}$.\n  Hence $\\dang NED = \\dang EDN = \\dang BDC$, while $\\dang AEM = \\dang ACB$.\n  Since $\\dang DEA = 90\\dg$, by looking at quadrilateral $XDEA$ where $X = \\ol{CD} \\cap \\ol{AB}$,\n  we derive that $\\dang NED + \\dang AEM + \\dang DXA = 90\\dg$, so\n  \\[ \\dang NEM = \\dang NED + \\dang AEM + 90\\dg = -\\dang DXA = -\\dang NXM = -\\dang NPM \\]\n  as needed.\n\\end{proof}\n\nHowever, the area condition in the problem tells us\n\\[ \\frac{EN}{EM} = \\frac{CN}{CM} = \\frac{PM}{PN}. \\]\nFinally, we have $\\angle MEN > 90\\dg$ from the configuration.\nThese properties uniquely determine the point $E$:\nit is the reflection of $P$ across the midpoint of $MN$.\n\nSo $EMPN$ is a parallelogram, and thus $\\ol{ME} \\perp \\ol{CD}$.\nThis implies $\\dang BAE = \\dang CEM = \\dang EDC$ giving $ABCD$ cyclic.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 1998}
{"id": "imo-1998-q2", "question": "In a competition, there are $a$ contestants\nand $b$ judges, where $b \\ge 3$ is an odd integer.\nEach judge rates each contestant as either ``pass'' or ``fail''.\nSuppose $k$ is a number such that for any two judges,\ntheir ratings coincide for at most $k$ contestants.\nProve that\n\\[ \\frac ka \\ge \\frac{b-1}{2b}. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p124458}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nIn a competition, there are $a$ contestants\nand $b$ judges, where $b \\ge 3$ is an odd integer.\nEach judge rates each contestant as either ``pass'' or ``fail''.\nSuppose $k$ is a number such that for any two judges,\ntheir ratings coincide for at most $k$ contestants.\nProve that\n\\[ \\frac ka \\ge \\frac{b-1}{2b}. \\]\n\\end{mdframed}\nThis is a ``routine'' problem with global ideas.\nWe count pairs of coinciding ratings,\ni.e.\\ the number $N$ of tuples\n\\[(\\{J_1, J_2\\}, C) \\]\nof two distinct judges and a contestant\nfor which the judges gave the same rating.\n\nOn the one hand, if we count by the judges,\nwe have \\[ N \\le \\binom b2 k \\]\nby he problem condition.\n\nHowever, if we write $b=2m+1$ (so $m \\coloneq \\frac{b-1}{2}$), then each contestant $C$\ncontributes at least $\\binom{m}{2} + \\binom{m+1}{2} = m^2$ to $N$, and so\n\\[ N \\ge a \\cdot \\left( \\frac{b-1}{2} \\right)^2 \\]\nPutting together the two estimates for $N$ yields the conclusion.\n\\pagebreak", "category": "Combinatorics", "source": "IMO", "year": 1998}
{"id": "imo-1998-q3", "question": "For any positive integer $n$,\nlet $\\tau(n)$ denote the number of its positive divisors (including $1$ and itself).\nDetermine all positive integers $m$ for which\nthere exists a positive integer $n$ such that\n\\[ \\frac{\\tau(n^{2})}{\\tau(n)}=m. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p124439}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFor any positive integer $n$,\nlet $\\tau(n)$ denote the number of its positive divisors (including $1$ and itself).\nDetermine all positive integers $m$ for which\nthere exists a positive integer $n$ such that\n\\[ \\frac{\\tau(n^{2})}{\\tau(n)}=m. \\]\n\\end{mdframed}\nThe answer is odd integers $m$ only.\nIf we write $n = p_1^{e_1} \\dots p_k^{e_k}$ we get\n\\[ \\prod \\frac{2e_i+1}{e_i+1} = m. \\]\nIt's clear now that $m$ must be odd,\nsince every fraction has odd numerator.\n\nWe now endeavor to construct odd numbers.\nThe proof is by induction, in which we are curating sets of\nfractions of the form $\\frac{2e+1}{e+1}$ that multiply\nto a given target.\n\nThe base cases are easy to verify by hand.\nGenerally, assume $p = 2^t k - 1$ is odd, where $k$ is odd.\nThen we can write\n\\[\n  \\frac{2^{2t}k-2^t(k+1)+1}{2^{2t-1}k-2^{t-1}(k+1)+1}\n  \\cdot\n  \\frac{2^{2t-1}k-2^{t-1}(k+1)+1}{2^{2t-2}k-2^{t-2}(k+1)+1}\n  \\cdot \\dots \\cdot\n  \\frac{2^{t+1}k-2(k+1)+1}{2^tk-2^0(k+1)+1}.\n\\]\nNote that $2^{2t}k-2^t(k+1)+1 = (2^t k - 1)(2^t - 1)$,\nand $2^t k - k = k(2^t-1)$, so the above fraction simplifies to\n\\[ \\frac{2^t k - 1}{k} \\]\nmeaning we just need to multiply by $k$,\nwhich we can do using induction hypothesis.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Number Theory", "source": "IMO", "year": 1998}
{"id": "imo-1998-q4", "question": "Determine all pairs $(x,y)$ of positive integers\nsuch that $x^{2}y+x+y$ is divisible by $xy^{2}+y+7$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p124428}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nDetermine all pairs $(x,y)$ of positive integers\nsuch that $x^{2}y+x+y$ is divisible by $xy^{2}+y+7$.\n\\end{mdframed}\nThe answer is $(7k^2,7k)$ for all $k \\ge 1$,\nas well as $(11,1)$ and $(49,1)$.\n\nWe are given $xy^2+y+7 \\mid x^2y+x+y$.\nMultiplying the right-hand side by $y$ gives\n\\[ xy^2+y+7 \\mid x^2y^2+xy+y^2 \\]\nThen subtracting $x$ times the left-hand side gives\n\\[ xy^2+y+7 \\mid y^2-7x. \\]\nWe consider cases based on the sign of $y^2=7x$.\n\\begin{itemize}\n  \\ii If $y^2 > 7x$, then $0 < y^2-7x < xy^2+y+7$,\n  contradiction.\n  \\ii If $y^2=7x$, let $y = 7k$, so $x = 7k^2$.\n  Plugging this back in to the original equation reads\n  \\[ 343k^4 + 7k + 7 \\mid 343k^5 + 7k^2 + 7k \\]\n  which is always valid, hence these are all solutions.\n  \\ii  If $y^2 < 7x$, then $|y^2-7x| \\le 7x$,\n  so $y \\in \\{1,2\\}$.\n\n  When $y=1$ we get\n  \\[ x+8 \\mid x^2+x+1 \\iff x+8 \\mid 64-8+1=57.\\]\n  This has solutions $x=11$ and $x=49$.\n\n  When $y=2$\n  \\begin{align*}\n    4x+9 \\mid 2x^2+x+2 \\\\\n    \\implies 4x+9 &\\mid 16x^2+8x+16 \\\\\n    \\implies 4x+9 &\\mid 81-18+16 = 79\n  \\end{align*}\n  which never occurs.\n\\end{itemize}\n\\pagebreak", "category": "Number Theory", "source": "IMO", "year": 1998}
{"id": "imo-1998-q5", "question": "Let $I$ be the incenter of triangle $ABC$.\nLet the incircle of $ABC$ touch\nthe sides $BC$, $CA$, and $AB$ at $K$, $L$, and $M$, respectively.\nThe line through $B$ parallel to $MK$ meets the lines\n$LM$ and $LK$ at $R$ and $S$, respectively.\nProve that angle $RIS$ is acute.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p121417}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $I$ be the incenter of triangle $ABC$.\nLet the incircle of $ABC$ touch\nthe sides $BC$, $CA$, and $AB$ at $K$, $L$, and $M$, respectively.\nThe line through $B$ parallel to $MK$ meets the lines\n$LM$ and $LK$ at $R$ and $S$, respectively.\nProve that angle $RIS$ is acute.\n\\end{mdframed}\nObserve that $\\triangle MKL$ is acute with circumcenter $I$.\nWe now present two proofs.\n\n\\paragraph{First simple proof (grobber).}\nThe problem is equivalent to showing $BI^2 > BR \\cdot BS$.\nBut from\n\\[ \\triangle BRK \\sim \\triangle MKL \\sim \\triangle BLS \\]\nwe conclude\n\\[ BR = t \\cdot \\frac{MK}{ML},\n  \\qquad BS = t \\cdot \\frac{ML}{MK} \\]\nwhere $t = BK  = BL$ is the length\nof the tangent from $B$.\nHence $BR \\cdot BS = t^2$.\nSince $BI > t$ is clear, we are done.\n\n\\paragraph{Second projective proof.}\nLet $N$ be the midpoint of $\\ol{KL}$,\nand let ray $MN$ meet the incircle again at $P$.\n\nNote that line $\\ol{RBS}$ is the polar of $N$.\nBy Brocard's theorem, lines $MK$ and $PL$ should thus\nmeet the polar of $N$, so we conclude $R = \\ol{MK} \\cap \\ol{PL}$.\nAnalogously, $S = \\ol{ML} \\cap \\ol{PK}$.\n\nAgain by Brocard's theorem, $\\triangle NRS$ is self-polar,\nso $N$ is the orthocenter of $\\triangle RIS$.\nSince $N$ lies between $I$ and $B$ we are done.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 1998}
{"id": "imo-1998-q6", "question": "Classify all functions $f \\colon \\NN \\to \\NN$\nsatisfying the identity\n\\[ f(n^2 f(m)) = m f(n)^2. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p124426}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nClassify all functions $f \\colon \\NN \\to \\NN$\nsatisfying the identity\n\\[ f(n^2 f(m)) = m f(n)^2. \\]\n\\end{mdframed}\nLet $\\mathcal P$ be the set of primes,\nand let $g \\colon \\mathcal P \\to \\mathcal P$ be any involution on them.\nExtend $g$ to a completely multiplicative function on $\\NN$.\nThen $f(n) = d g(n)$ is a solution for any $d \\in \\NN$\nwhich is fixed by $g$.\n\nIt's straightforward to check these all work,\nsince $g \\colon \\NN \\to \\NN$ is an involution on them.\nSo we prove these are the only functions.\n\nLet $d = f(1)$.\n\\begin{claim*}\n  We have $df(n) = f(dn)$ and $d \\cdot f(ab) = f(a) f(b)$.\n\\end{claim*}\n\\begin{proof}\n  Let $P(m,n)$ denote the assertion in the problem statement.\n  Off the bat,\n  \\begin{itemize}\n    \\ii $P(1,1)$ implies $f(d) = d^2$.\n    \\ii $P(n,1)$ implies $f(f(n)) = d^2n$.\n    In particular, $f$ is injective.\n    \\ii $P(1,n)$ implies $f(dn^2) = f(n)^2$.\n  \\end{itemize}\n  Then\n  \\begin{align*}\n    f(a)^2 f(b)^2 &= f(da^2) f(b)^2 & \\text{by third bullet}\\\\\n    &= f(b^2 f(f(da^2))) & \\text{by problem statement} \\\\\n    &= f(b^2 \\cdot d^2 \\cdot da^2) & \\text{by second bullet} \\\\\n    &= f(dab)^2 & \\text{by third bullet} \\\\\n    \\implies f(a) f(b) &= f(dab).\n  \\end{align*}\n  This implies the first claim by taking $(a,b) = (1,n)$.\n  Then $df(a) = f(da)$, and so we actually have\n  $f(a) f(b) = d f(ab)$.\n\\end{proof}\n\\begin{claim*}\n  All values of $f$ are divisible by $d$.\n\\end{claim*}\n\\begin{proof}\n  We have\n  \\begin{align*}\n    f(n^2) &= \\frac 1d f(n)^2 \\\\\n    f(n^3) &= \\frac{f(n^2) f(n)}{d} = \\frac{f(n)^3}{d^2} \\\\\n    f(n^4) &= \\frac{f(n^3) f(n)}{d} = \\frac{f(n)^4}{d^3}\n  \\end{align*}\n  and so on,\n  which implies the result.\n\\end{proof}\nThen, define $g(n) = f(n) / d$.\nWe conclude that $g$ is completely multiplicative, with $g(1) = 1$.\nHowever, $f(f(n)) = d^2n$ also implies $g(g(n)) = n$,\ni.e.\\ $g$ is an involution.\nMoreover, since $f(d) = d^2$, $g(d) = d$.\n\nAll that remains is to check that $g$ must map primes to primes\nto finish the description in the problem.\nThis is immediate; since $g$ is multiplicative and $g(1) = 1$,\nif $g(g(p)) = p$ then $g(p)$ can have at most one prime factor,\nhence $g(p)$ is itself prime.\n\n\\begin{remark*}\n  The IMO problem actually asked for the least value of $f(1998)$.\n  But for instruction purposes,\n  it is probably better to just find all $f$.\n  Since $1998 = 2 \\cdot 3^3 \\cdot 37$,\n  this answer is $2^3 \\cdot 3 \\cdot 5 = 120$, anyways.\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Algebra", "source": "IMO", "year": 1998}
{"id": "egmo-2012-q1", "question": "Let $ABC$ be a triangle with circumcenter $O$.\nThe points $D$, $E$, $F$ lie in the interiors\nof the sides $BC$, $CA$, $AB$ respectively,\nsuch that $\\ol{DE} \\perp \\ol{CO}$ and $\\ol{DF} \\perp \\ol{BO}$.\nLet $K$ be the circumcenter of triangle $AFE$.\nProve that the lines $\\ol{DK}$ and $\\ol{BC}$ are perpendicular.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2658992}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle with circumcenter $O$.\nThe points $D$, $E$, $F$ lie in the interiors\nof the sides $BC$, $CA$, $AB$ respectively,\nsuch that $\\ol{DE} \\perp \\ol{CO}$ and $\\ol{DF} \\perp \\ol{BO}$.\nLet $K$ be the circumcenter of triangle $AFE$.\nProve that the lines $\\ol{DK}$ and $\\ol{BC}$ are perpendicular.\n\\end{mdframed}\nFirst, note\n$\\dang EDF = 180\\dg - \\dang BOC = 180\\dg - 2A$,\nso $\\dang FDE = 2A$.\n\\begin{center}\n  \\begin{asy}\n    pair A = Drawing(\"A\", dir(110), dir(110));\n    pair B = Drawing(\"B\", dir(210), dir(210));\n    pair C = Drawing(\"C\", dir(330), dir(330));\n    draw(A--B--C--cycle);\n    pair O = Drawing(\"O\", origin, dir(45));\n    pair D = Drawing(\"D\", 0.4*B+0.6*C, dir(-90));\n    pair F = Drawing(\"F\", extension(A,B,D,foot(D,O,B)), dir(-C));\n    pair E = Drawing(\"E\", extension(A,C,D,foot(D,O,C)), dir(-B));\n    pair K = Drawing(\"K\", circumcenter(A,E,F), dir(90));\n    draw(E--D--F--cycle);\n    draw(E--K--F, dashed);\n    draw(B--O--C);\n    draw(D--K);\n    draw(circumcircle(D,E,F), dotted);\n  \\end{asy}\n\\end{center}\nObserve that $\\dang FKE = 2A$ as well; hence $KFDE$ is cyclic.\nHence\n\\begin{align*}\n  \\dang KDB &= \\dang KDF + \\dang FDB \\\\\n  &= \\dang KEF + \\left( 90\\dg - \\dang DBO \\right) \\\\\n  &= (90\\dg-A) + (90\\dg-(90\\dg-A)) \\\\\n  &= 90\\dg.\n\\end{align*}\nand the proof ends here.\n\\pagebreak", "category": "Geometry", "source": "EGMO", "year": 2012}
{"id": "egmo-2012-q2", "question": "Let $n$ be a positive integer.\nFind the greatest possible integer $m$, in terms of $n$,\nwith the following property: a table with $m$ rows and $n$ columns can be\nfilled with real numbers in such a manner that for any\ntwo different rows $\\left[ a_1, a_2, \\dots, a_n \\right]$\nand $\\left[ b_1, b_2, \\dots, b_n \\right]$ the following holds:\n\\[\\max\\left( {\\left| {{a_1} - {b_1}} \\right|,\\left| {{a_2} - {b_2}} \\right|,\n  \\dots,\\left| {{a_n} - {b_n}} \\right|} \\right) = 1. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2658981}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n$ be a positive integer.\nFind the greatest possible integer $m$, in terms of $n$,\nwith the following property: a table with $m$ rows and $n$ columns can be\nfilled with real numbers in such a manner that for any\ntwo different rows $\\left[ a_1, a_2, \\dots, a_n \\right]$\nand $\\left[ b_1, b_2, \\dots, b_n \\right]$ the following holds:\n\\[\\max\\left( {\\left| {{a_1} - {b_1}} \\right|,\\left| {{a_2} - {b_2}} \\right|,\n  \\dots,\\left| {{a_n} - {b_n}} \\right|} \\right) = 1. \\]\n\\end{mdframed}\n\\paragraph{Answer.} The largest $m$ is $m(n) = 2^n$.\n\n\\paragraph{Construction.} Choose the table with all $2^n$ binary vectors.\n\n\\paragraph{Bound.}\nWe will proceed by induction on $n$, with the base case $n=1$ being immediate.\nTake the first column, and assume the entries lie in some interval $I = [r, r+1]$.\nThen the rows with first entry equal to $r$\nform an $(n-1)$-table, hence at most $m(n-1)$ of them.\nThe rows with first entry not equal to $r$\nalso form an $(n-1)$-table, hence at most $m(n-1)$ of them.\nSo\n\\[ m(n) \\le \\underbrace{m(n-1)}_{\\text{first entry $r$}}\n  + \\underbrace{m(n-1)}_{\\text{first entry not $r$}} = 2m(n-1) \\]\nand we're done by induction.\n\\pagebreak", "category": "Combinatorics", "source": "EGMO", "year": 2012}
{"id": "egmo-2012-q3", "question": "Solve over $\\RR$ the functional equation\n\\[ f\\left( yf(x + y) + f(x) \\right) = 4x + 2yf(x + y). \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2658967}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nSolve over $\\RR$ the functional equation\n\\[ f\\left( yf(x + y) + f(x) \\right) = 4x + 2yf(x + y). \\]\n\\end{mdframed}\nThe only solution is $f(x) \\equiv 2x$ which obviously works.\n\nLet $P(x,y)$ be the given condition. Then:\n\\begin{itemize}\n  \\ii Note $P(x,0) \\implies f(f(x)) = 4x$; in particular $f$ is bijective.\n  \\begin{itemize}\n    \\ii \\dots This also implies $f(4x) = f(f(f(x))) = 4f(x)$.\n    \\ii Taking $x=0$ gives $f(0) = 4f(0) \\implies f(0) = 0$.\n  \\end{itemize}\n  \\ii Now $P(0,2) \\implies f(2f(2)) = 4f(2) = f(8) \\implies f(2) = 4$.\n  \\ii Then $P(0,1) \\implies f(f(1)) = 2f(1) \\implies 4 = 2f(1) \\implies f(1)=2$.\n  \\ii Finally, $P(x,1-x)$ gives\n  \\[ f\\left( 2(1-x) + f(x) \\right) = 4x + 4(1-x) = 4. \\]\n  Since $f$ is a bijection and $f(2) = 4$, this means $2(1-x)+f(x) = 2$,\n  so $f(x) = 2x$ as desired.\n\\end{itemize}\n\\pagebreak", "category": "Algebra", "source": "EGMO", "year": 2012}
{"id": "egmo-2012-q4", "question": "A set $A$ of integers is called \\emph{sum-full} if $A \\subseteq A + A$.\nA set $A$ of integers is said to be \\emph{zero-sum-free} if $0$\nis the only integer that cannot be expressed as the\nsum of the elements of a finite nonempty subset of $A$.\nDoes there exist a sum-full zero-sum-free set of integers?", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2658986}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA set $A$ of integers is called \\emph{sum-full} if $A \\subseteq A + A$.\nA set $A$ of integers is said to be \\emph{zero-sum-free} if $0$\nis the only integer that cannot be expressed as the\nsum of the elements of a finite nonempty subset of $A$.\nDoes there exist a sum-full zero-sum-free set of integers?\n\\end{mdframed}\nThe answer is YES, such a set exists, and is given by\n\\[ A = \\left\\{ 1, -2, 3, -5, 8, -13, 21, -34, 55, \\dots \\right\\}. \\]\n\nTo prove every number can be expressed as a\n(possibly empty) subset of $A$, we have the following stronger claim.\n\\begin{claim*}\n  Let $N$ be an integer (possibly zero or negative).\n  Let $F$ denote the smallest Fibonacci number\n  which is strictly greater than $|N|$.\n  Then there exists a representation of $N$ as the sum of\n  a (possibly empty) subset of $A$,\n  where no element used has absolute value greater than $N$.\n\\end{claim*}\n\\begin{proof}\n  By induction on $|N|$.\n  Omitted.\n\\end{proof}\n\nOn the other hand, the \\emph{Zeckendorf representation theorem}\nimplies that it's not possible to express $0$\nas a nonempty subset;\nsuch a representation would amount to an identity of the form\n\\[ F_{i_1} + F_{i_2} + \\dots = F_{j_1} + F_{j_2} + \\dots \\]\nwhere no terms on either side are consecutive,\nand both sides have no common terms; and this is impossible.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Number Theory", "source": "EGMO", "year": 2012}
{"id": "egmo-2012-q5", "question": "The numbers $p$ and $q$ are prime and satisfy\n\\[ \\frac{p}{p+1} + \\frac{q+1}{q} = \\frac{2n}{n+2} \\]\nfor some positive integer $n$.\nFind all possible values of $q-p$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2659385}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nThe numbers $p$ and $q$ are prime and satisfy\n\\[ \\frac{p}{p+1} + \\frac{q+1}{q} = \\frac{2n}{n+2} \\]\nfor some positive integer $n$.\nFind all possible values of $q-p$.\n\\end{mdframed}\nWe clean up the numerators as\n\\[ \\left( 1-\\frac{1}{p+1} \\right) + \\left( 1 + \\frac{1}{q} \\right) = 2 - \\frac{4}{n+2} \\]\nwhich simplifies as\n\\[ \\frac{4}{n+2} = \\frac{1}{p+1} - \\frac{1}{q} \\]\nwhich reduces as\n\\[ \\frac{4}{n+2} = \\frac{q-p-1}{q(p+1)} \\]\nAt this point $n$ is a free parameter.\nSo, this motivates us to rewrite the equation as\n\\[ n+2 = \\frac{4q(p+1)}{(q-p)-1}. \\]\nThis implies that $q-p-1 \\mid 4q(p+1)$.\nSince $n$ is positive, we have $0 < q-p-1 < q$.\nBecause $q$ is prime, this implies $q-p-1 \\mid 4(p+1)$.\nBut now $q-p-1 \\mid 4(p+1) + 4(q-p-1) = 4q$.\nAgain, $q$ is prime, so $q-p-1 \\mid 4$.\nThis implies $q-p \\in \\left\\{ 2,3,5 \\right\\}$.\n\nIt is easy to construct working examples: say $(p,q)$ is $(3,5)$, $(2,5)$ and $(2,7)$.\n\\pagebreak", "category": "Number Theory", "source": "EGMO", "year": 2012}
{"id": "egmo-2012-q6", "question": "There are infinitely many people registered on the social network Mugbook.\nSome pairs of (different) users are registered as friends, but each person has only finitely many friends.\nEvery user has at least one friend.\n(Friendship is symmetric; that is, if $A$ is a friend of $B$, then $B$ is a friend of $A$.)\nEach person is required to designate one of their friends as their best friend.\nIf $A$ designates $B$ as her best friend, then (unfortunately)\nit does not follow that $B$ necessarily designates $A$ as her best friend.\nSomeone designated as a best friend is called a $1$-best friend.\nMore generally, if $n> 1$ is a positive integer,\nthen a user is an $n$-best friend provided that they have been designated\nthe best friend of someone who is an $(n-1)$-best friend.\nSomeone who is a $k$-best friend for every positive integer $k$ is called popular.\n\\begin{enumerate}\n  \\ii[(a)] Prove that every popular person is the best friend of a popular person.\n  \\ii[(b)] Show that if people can have infinitely many friends,\n  then it is possible that a popular person is not the best friend of a popular person.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2659392}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nThere are infinitely many people registered on the social network Mugbook.\nSome pairs of (different) users are registered as friends, but each person has only finitely many friends.\nEvery user has at least one friend.\n(Friendship is symmetric; that is, if $A$ is a friend of $B$, then $B$ is a friend of $A$.)\nEach person is required to designate one of their friends as their best friend.\nIf $A$ designates $B$ as her best friend, then (unfortunately)\nit does not follow that $B$ necessarily designates $A$ as her best friend.\nSomeone designated as a best friend is called a $1$-best friend.\nMore generally, if $n> 1$ is a positive integer,\nthen a user is an $n$-best friend provided that they have been designated\nthe best friend of someone who is an $(n-1)$-best friend.\nSomeone who is a $k$-best friend for every positive integer $k$ is called popular.\n\\begin{enumerate}\n  \\ii[(a)] Prove that every popular person is the best friend of a popular person.\n  \\ii[(b)] Show that if people can have infinitely many friends,\n  then it is possible that a popular person is not the best friend of a popular person.\n\\end{enumerate}\n\\end{mdframed}\nFirst note the following statement is true by induction:\n\\begin{claim*}\n  Someone who is an $n$-best friend is also a $k$-best friend for all $1 \\le k < n$.\n\\end{claim*}\n\\begin{proof}\n  Induction on $(k,n)$.\n\\end{proof}\n\nFor part (a), suppose Dan is a popular person.\nLet the friends of Dan be $P_1$, $P_2$, \\dots, $P_m$.\nFor each $n$, one of the $P_i$'s must be an $n$-best friend.\nBy pigeonhole, one of the $P_i$'s is an $n$-best friend for infinitely many $n \\ge 1$.\nHence be the claim above they are popular too.\n\nFor part (b), consider a social graph defined by having Dan ($D$)\nand the following chains of best friends:\n\\begin{align*}\n  D &\\longleftarrow P_{11} \\\\\n  D &\\longleftarrow P_{21} \\longleftarrow P_{22} \\\\\n  D &\\longleftarrow P_{31} \\longleftarrow P_{32} \\longleftarrow P_{33} \\\\\n  D &\\longleftarrow P_{41} \\longleftarrow P_{42} \\longleftarrow P_{43} \\longleftarrow P_{44} \\\\\n  &\\vdotswithin{\\longleftarrow}\n\\end{align*}\nThen Dan is the only popular person in the entire network.\nThis gives the construction promised.\n\\pagebreak", "category": "Combinatorics", "source": "EGMO", "year": 2012}
{"id": "egmo-2012-q7", "question": "Let $ABC$ be an acute-angled triangle with circumcircle $\\Gamma$ and orthocenter $H$. Let $K$ be a point of $\\Gamma$ on the other side of $\\ol{BC}$ from $A$. Let $L$ be the reflection of $K$ across $\\ol{AB}$, and let $M$ be the reflection of $K$ across $\\ol{BC}$. Let $E$ be the second point of intersection of $\\Gamma$ with the circumcircle of triangle $BLM$.  Show that the lines $KH$, $EM$ and $BC$ are concurrent.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2659395}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be an acute-angled triangle with circumcircle $\\Gamma$ and orthocenter $H$. Let $K$ be a point of $\\Gamma$ on the other side of $\\ol{BC}$ from $A$. Let $L$ be the reflection of $K$ across $\\ol{AB}$, and let $M$ be the reflection of $K$ across $\\ol{BC}$. Let $E$ be the second point of intersection of $\\Gamma$ with the circumcircle of triangle $BLM$.  Show that the lines $KH$, $EM$ and $BC$ are concurrent.\n\\end{mdframed}\n\\begin{center}\n  \\begin{asy}\n    size(9cm);\n    pair A = dir(110);\n    pair B = dir(210);\n    pair C = dir(330);\n    draw(A--B--C--cycle);\n\n    pair Ap = -B*C/A;\n    pair Cp = -A*B/C;\n    draw(A--Ap);\n    draw(C--Cp);\n    draw(unitcircle);\n\n    pair K = dir(230);\n    pair M = reflect(B,C)*K;\n    pair blah = reflect(A,B)*K;\n    pair L = blah;\n    draw(M--K--L, dotted);\n\n    pair E = IP(unitcircle, circumcircle(B, L, M));\n    draw(circumcircle(B, L, M));\n\n    pair H = A+B+C;\n    draw(H--K, red);\n    draw(E--Ap, red);\n    draw(E--L, dotted);\n\n    dot(\"$A$\", A, dir(A));\n    dot(\"$B$\", B, dir(B));\n    dot(\"$C$\", C, dir(C));\n    dot(\"$A'$\", Ap, dir(Ap));\n    dot(\"$C'$\", Cp, dir(Cp));\n    dot(\"$K$\", K, dir(K));\n    dot(\"$M$\", M, dir(M));\n    dot(\"$L$\", L, dir(270));\n    dot(\"$E$\", E, dir(100));\n    dot(\"$H$\", H, dir(45));\n\n    /* Source generated by TSQ */\n  \\end{asy}\n\\end{center}\n\nThe main idea is a ``floating orthocenter'' amidst a large number of reflections.\nThis motivates us to reflect $H$ over $\\ol{BC}$ to $A'$\nand $H$ over $\\ol{AB}$ to $C'$.\nThen the problem is equivalent to trying to prove that\nthe points $E$, $M$, $A'$ are collinear.\n\nLet $E'$ be the second intersection of line $A'M$ with $\\Gamma$.\nFirst, we claim that $E'$, $C'$, $L$ are collinear.\nNote that and \\[ \\angle LC'B = \\angle KHB = \\angle MA'B = \\angle E'A'B \\] (using the reflections).\nFrom here we get $\\angle LC'B + \\angle BC'E' = 180^{\\circ}$, and\nhence the collinearity is proved.\nOn the other hand,\n\\[ \\angle LBM =\n  2\\left( \\angle KBA - KBC \\right)\n  = 2 \\angle B \\]\nand\n\\[ \\angle C'E'A' = 180 -2 \\angle B. \\]\nSo $L$, $B$, $M$, $E'$ are cyclic as desired.\n\\pagebreak", "category": "Geometry", "source": "EGMO", "year": 2012}
{"id": "egmo-2012-q8", "question": "A word is a finite sequence of letters from some alphabet.\nA word is \\emph{repetitive} if it is a concatenation of at least two identical subwords\n(for example, $ababab$ and $abcabc$ are repetitive, but $ababa$ and $aabb$ are not).\nProve that if a word has the property that swapping any two adjacent letters\nmakes the word repetitive, then all its letters are identical.\n(Note that one may swap two adjacent identical letters, leaving a word unchanged.)", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2659401}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA word is a finite sequence of letters from some alphabet.\nA word is \\emph{repetitive} if it is a concatenation of at least two identical subwords\n(for example, $ababab$ and $abcabc$ are repetitive, but $ababa$ and $aabb$ are not).\nProve that if a word has the property that swapping any two adjacent letters\nmakes the word repetitive, then all its letters are identical.\n(Note that one may swap two adjacent identical letters, leaving a word unchanged.)\n\\end{mdframed}\nA word with the property that swapping any two adjacent letters\nmakes the word repetitive, but for which all letters the same,\nwill called a \\emph{unicorn}.\nThe problem asks to show there are no unicorns.\n\nSo assume for contradiction there exists a unicorn.\nWe proceed in three steps.\n\n\\paragraph{Step 1. Reduction to binary alphabet.}\nIn the alphabet, choose one letter (that appears in the unicorn) to be $0$\nand replace all the letters with $1$.\nThe resulting word is still a unicorn on the two symbols $\\{0,1\\}$.\nIn this way we only need to consider the problem for the alphabet $\\Sigma = \\{0,1\\}$.\n\n\\paragraph{Step 2. Unicorns are repetitive themselves.}\nSo let $w \\in \\Sigma^n$ be a unicorn.\nIt's easy to see that $w = 010101\\dotsm$ is not a unicorn;\nif we swap the first two fits, the resulting word\n$100101\\dotsm$ has a doubled $00$ that appears only once, so it is not a unicorn.\nSimilarly, $w = 101010\\dotsm$ is not a unicorn.\nHence, we may assume our unicorn $w$ has at least two adjacent bits equal.\nThis means that $w$ is itself repetitive.\n\n\\paragraph{Step 3. Main argument.}\nFrom now on let $w[i]$ denote the $i$\\ts{th} letter of $w$.\nFix an index $1 \\le k < n/2$ for which $w[k] \\neq w[k+1]$.\nLet $w'$ be the word that results from swapping the unequal bits,\nso $w'[k] = w[k+1]$ and $w'[k+1] = w[k]$.\nNow $w$ is repetitive, and so is $w'$;\nso there should exist integers $p \\le n/2$ and $q \\le n/2$ dividing $n$ (the \\emph{periods})\nsuch that the identities\n\\[\n  w[i] = w[i+p] \\quad \\forall 1 \\le i \\le n-p; \\qquad\n  w'[i] = w'[i+q] \\quad \\forall 1 \\le i \\le n-q.\n\\]\nWe may assume $p$ and $q$ are different and don't divide each other.\nWe will now produce a contradiction in two cases.\n\\begin{itemize}\n  \\ii Consider the case $\\gcd(p,q) = 1$.\n  Then, the number of $1$'s in $w$ ought to be a multiple of $n/p$,\n  because $w$ consists of $n/p$ repetitions of some word.\n  Similarly, the number of $1$'s in $w'$ ought to be a multiple of $n/q$.\n  But these numbers are equal.\n  So the number of $1$'s is a multiple of both $n/p$ and $n/q$.\n  When $\\gcd(p,q) = 1$, this can only occur if the numbers $1$'s is divisible by $n$,\n  i.e.\\ $w = 0 \\dots 0$ or $w = 1 \\dots 1$.\n  Then $w$ is not in fact a unicorn.\n\n  \\ii Otherwise, let $d = \\gcd(p,q) > 1$.\n  Choose the index $i = k$ to start.\n  In a \\emph{move} we update the index as follows:\n  \\begin{itemize}\n    \\ii If $i + p < n$, replace $i$ with $i + p$.\n    \\ii Otherwise, replace $i$ with $i - q$.\n    \\ii Repeat this until $i \\equiv k \\pmod q$ again for the first time.\n  \\end{itemize}\n  This process is well defined since $p$ and $q$ are different and less than $n/2$.\n  This creates a sequence\n  \\[ k = i_0, i_1, i_2, \\dots, i_m \\]\n  with the property that the values of $w$ and $w'$ at all indices\n  except the ends are equal.\n  (The assumption $d > 1$ means that all $i_\\bullet$ are $k \\pmod d$,\n  so this sequence never contains $k+1$.)\n  Following the chain then creates a contradiction,\n  because we started at $w[k]$ and ended at $w'[i_m] = w'[k] \\neq w[k]$ following only equalities.\n\\end{itemize}\nA cartoon is shown below for $p = 9$, $q = 6$, $n = 18$, $k = 2$.\n\\begin{center}\n\\begin{asy}\n  size(12cm);\n  for (int i=1; i<=18; ++i) {\n    dot(\"$\" + ((string)(i)) + \"$\", (i,0), dir(-90));\n  }\n  void draw_arr(int x, int y, pen p) {\n    draw((x,0)..((x+y)/2, (y-x)/5)..(y,0), p, EndArrow(TeXHead), Margins);\n  }\n  draw_arr(2,11, deepgreen);\n  draw_arr(11,5, red);\n  draw_arr(5,14, deepgreen);\n  draw_arr(14,8, red);\n  draw_arr(8,2, red);\n\n  label(\"$w$\", (0,-2), blue);\n  label(\"$w'$\", (0,-3), blue);\n  draw(box((0.6,-1.6), (9.4,-2.4)), deepgreen);\n  draw(box((9.6,-1.6), (18.4,-2.4)), deepgreen);\n  draw(box((0.6,-2.6), (6.4,-3.4)), red);\n  draw(box((6.6,-2.6), (12.4,-3.4)), red);\n  draw(box((12.6,-2.6), (18.4,-3.4)), red);\n  label(\"$\\mathbf{0}$\", (2,-2), blue);\n  label(\"$\\mathbf{1}$\", (3,-2), blue);\n  label(\"$\\mathbf{1}$\", (2,-3), blue);\n  label(\"$\\mathbf{0}$\", (3,-3), blue);\n\n  label(\"$0$\", (11,-2), blue);\n  label(\"$0$\", (11,-3), blue);\n  label(\"$0$\", (5,-2), blue);\n  label(\"$0$\", (5,-3), blue);\n  label(\"$0$\", (14,-2), blue);\n  label(\"$0$\", (14,-3), blue);\n  label(\"$0$\", (8,-2), blue);\n  label(\"$0$\", (8,-3), blue);\n\\end{asy}\n\\end{center}\n\n\\begin{remark*}\n  [The smart solution]\n  An alternative clever way to do this last part is using roots of unity.\n  The idea is to show that in our binary language,\n  if $S$ is the subset of indices with $1$'s among $\\{1, \\dots, n\\}$,\n  then every repetitive word satisfies\n  \\[ \\sum_{s \\in S} \\exp\\left( \\frac{2\\pi n}{s} \\right) = 0. \\]\n  (The converse is not true.)\n  Hence a repetitive unicorn cannot exist;\n  swapping \\emph{any} two adjacent indices with unequal bits makes the sum change.\n  (The proof earlier shows this too, since we only used one value of $k$.)\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "EGMO", "year": 2012}
{"id": "putnam-2000-a1", "question": "Let $A$ be a positive real number.  What are the possible values of\n$\\sum_{j=0}^\\infty x_j^2$, given that $x_0,x_1,\\ldots$ are positive\nnumbers\nfor which $\\sum_{j=0}^\\infty x_j=A$?", "solution": "The possible values comprise the interval $(0, A^2)$.\n\nTo see that the values must lie in this interval, note that\n\\[\n\\left(\\sum_{j=0}^m x_j\\right)^2\n= \\sum_{j=0}^m x_j^2 + \\sum_{0\\leq j<k\\leq m} 2x_jx_k,\n\\]\nso $\\sum_{j=0}^m x_j^2 \\leq A^2 - 2x_0x_1$. Letting $m \\to \\infty$,\nwe have $\\sum_{j=0}^\\infty x_j^2 \\leq A^2-2x_0x_1 < A^2$.\n\nTo show that all values in $(0, A^2)$ can be obtained, we\nuse geometric progressions with $x_1/x_0 = x_2/x_1 = \\cdots = d$\nfor variable $d$.\nThen $\\sum_{j=0}^\\infty x_j = x_0/(1-d)$ and\n\\[\n\\sum_{j=0}^\\infty x_j^2 = \\frac{x_0^2}{1-d^2} = \\frac{1-d}{1+d} \\left(\n\\sum_{j=0}^\\infty x_j \\right)^2.\n\\]\nAs $d$ increases from 0 to 1, $(1-d)/(1+d)$ decreases from 1 to 0.\nThus if we take geometric progressions with $\\sum_{j=0}^\\infty\nx_j = A$, $\\sum_{j=0}^\\infty x_j^2$ ranges from 0 to $A^2$.\nThus the possible values are indeed those in the interval $(0, A^2)$,\nas claimed.", "category": "Algebra", "source": "PUTNAM", "year": 2000}
{"id": "putnam-2000-a2", "question": "Prove that there exist infinitely many integers $n$ such that\n$n,n+1,n+2$ are each the sum of the squares of two integers.\n[Example: $0=0^2+0^2$, $1=0^2+1^2$, $2=1^2+1^2$.]", "solution": "First solution:\nLet $a$ be an even integer such that $a^2+1$ is not prime. (For example,\nchoose $a \\equiv 2 \\pmod{5}$, so that $a^2+1$ is divisible by 5.)\nThen we can write $a^2+1$ as a difference of squares $x^2-b^2$,\nby factoring $a^2+1$ as $rs$ with $r \\geq s > 1$, and setting $x\n= (r+s)/2$, $b = (r-s)/2$.\nFinally, put $n=x^2-1$, so that $n=a^2+b^2$, $n+1 = x^2$, $n+2 = x^2+1$.\n\nSecond solution:\nIt is well-known that the equation $x^2-2y^2=1$ has infinitely\nmany solutions (the so-called ``Pell'' equation).  Thus setting\n$n=2y^2$ (so that $n=y^2+y^2$, $n+1=x^2+0^2$, $n+2=x^2+1^2$)\nyields infinitely many $n$ with the desired property.\n\nThird solution:\nAs in the first solution, it suffices to exhibit $x$ such that $x^2-1$\nis the sum of two squares. We will take $x=3^{2^n}$, and show that $x^2-1$\nis the sum of two squares by induction on $n$: if $3^{2^n}-1 = a^2+b^2$,\nthen\n\\begin{align*}\n(3^{2^{n+1}}-1) &= (3^{2^n} - 1)(3^{2^n}+1) \\\\\n&= (3^{2^{n-1}}a+b)^2 + (a-3^{2^{n-1}}b)^2.\n\\end{align*}\n\nFourth solution (by Jonathan Weinstein):\nLet $n=4k^4+4k^2=(2k^2)^2+(2k)^2$ for any integer $k$. Then $n+1=(2k^2+1)^2+0^2$ and $n+2=(2k^2+1)^2+1^2$.", "category": "Number Theory", "source": "PUTNAM", "year": 2000}
{"id": "putnam-2000-a3", "question": "The octagon $P_1P_2P_3P_4P_5P_6P_7P_8$ is inscribed in a circle, with\nthe\nvertices around the circumference in the given order.  Given that the\npolygon\n$P_1P_3P_5P_7$ is a square of area 5, and the polygon $P_2P_4P_6P_8$ is a\nrectangle of area 4, find the maximum possible area of the octagon.", "solution": "The maximum area is $3 \\sqrt{5}$.\n\nWe deduce from the area of $P_1P_3P_5P_7$ that the radius of the circle\nis $\\sqrt{5/2}$.  An easy calculation using the Pythagorean Theorem then\nshows that the rectangle $P_2P_4P_6P_8$ has sides $\\sqrt{2}$ and\n$2\\sqrt{2}$.\nFor notational ease, denote the area of a polygon by putting brackets\naround the name of the polygon.\n\nBy symmetry, the area of the octagon can be expressed as\n\\[\n[P_2P_4P_6P_8] + 2[P_2P_3P_4] + 2[P_4P_5P_6].\n\\]\nNote that $[P_2P_3P_4]$ is $\\sqrt{2}$ times\nthe distance from $P_3$ to $P_2P_4$, which is maximized when $P_3$\nlies on the midpoint of arc $P_2P_4$; similarly, $[P_4P_5P_6]$ is\n$\\sqrt{2}/2$ times the distance from $P_5$ to $P_4P_6$, which is\nmaximized when $P_5$ lies on the midpoint of arc $P_4P_6$. Thus the\narea of the octagon is maximized when $P_3$ is the\nmidpoint of arc $P_2P_4$ and $P_5$ is the midpoint of arc $P_4P_6$.\nIn this case, it is easy to calculate that $[P_2P_3P_4] = \\sqrt{5}-1$\nand $[P_4P_5P_6] = \\sqrt{5}/2-1$, and so the area of the octagon is\n$3\\sqrt{5}$.", "category": "Geometry", "source": "PUTNAM", "year": 2000}
{"id": "putnam-2000-a4", "question": "Show that the improper integral\n\\[ \\lim_{B\\to\\infty}\\int_{0}^B \\sin(x) \\sin(x^2)\\,dx\\]\nconverges.", "solution": "To avoid some improper integrals at 0, we may as well replace the left endpoint of integration by some $\\epsilon > 0$. We now use integration by parts:\n\\begin{align*}\n\\int_\\epsilon^B \\sin x \\sin x^2\\,dx\n&= \\int_\\epsilon^B \\frac{\\sin x}{2x} \\sin x^2 (2x\\,dx) \\\\\n&= \\left. -\\frac{\\sin x}{2x} \\cos x^2 \\right|_\\epsilon^B \\\\\n&\\mbox{} + \\int_\\epsilon^B \\left( \\frac{\\cos x}{2x} - \\frac{\\sin x}{2x^2} \\right) \\cos x^2\\,dx.\n\\end{align*}\nNow $\\frac{\\sin x}{2x} \\cos x^2$ tends to 0 as $B \\to \\infty$,\nand the integral of $\\frac{\\sin x}{2x^2} \\cos x^2$ converges absolutely\nby comparison with $1/x^2$. Thus it suffices to note that\n\\begin{align*}\n\\int_\\epsilon^B \\frac{\\cos x}{2x} \\cos x^2\\,dx &=\n\\int_\\epsilon^B \\frac{\\cos x}{4x^2} \\cos x^2(2x\\,dx) \\\\\n&= \\left. \\frac{\\cos x}{4x^2} \\sin x^2 \\right|_\\epsilon^B \\\\\n&\\mbox{} - \\int_\\epsilon^B \\frac{2x\\cos x - \\sin x}{4x^3} \\sin x^2\\,dx,\n\\end{align*}\nand that the final integral converges absolutely by comparison to\n$1/x^3$.\n\nAn alternate approach is to first rewrite $\\sin x \\sin x^2$ as\n$\\frac{1}{2}(\\cos (x^2-x) - \\cos (x^2+x))$. Then\n\\begin{align*}\n\\int_\\epsilon^B \\cos(x^2+x)\\,dx &=\n- \\left. \\frac{\\sin (x^2+x)}{2x+1} \\right|_\\epsilon^B \\\\\n&\\mbox{} - \\int_\\epsilon^B \\frac{2\\sin(x^2+x)}{(2x+1)^2}\\,dx\n\\end{align*}\nconverges absolutely, and $\\int_0^B \\cos (x^2-x)$ can be\ntreated similarly.", "category": "Geometry", "source": "PUTNAM", "year": 2000}
{"id": "putnam-2000-a5", "question": "Three distinct points with integer coordinates lie in the plane on a\ncircle of radius $r>0$.  Show that two of these points are separated by a\ndistance of at least $r^{1/3}$.", "solution": "Let $a,b,c$ be the distances between the points. Then the area of the triangle\nwith the three points as vertices\nis $abc/4r$. On the other hand, the area of a triangle whose vertices\nhave integer coordinates is at least 1/2 (for example,\nby Pick's Theorem). Thus $abc/4r \\geq 1/2$,\nand so\n\\[\n\\max\\{a,b,c\\} \\geq (abc)^{1/3} \\geq (2r)^{1/3} > r^{1/3}.\n\\]", "category": "Geometry", "source": "PUTNAM", "year": 2000}
{"id": "putnam-2000-a6", "question": "Let $f(x)$ be a polynomial with integer coefficients.  Define a\nsequence $a_0,a_1,\\ldots$ of integers such that $a_0=0$ and\n$a_{n+1}=f(a_n)$\nfor all $n\\geq 0$.  Prove that if there exists a positive integer $m$ for\nwhich $a_m=0$ then either $a_1=0$ or $a_2=0$.", "solution": "Recall that if $f(x)$ is a polynomial with integer coefficients,\nthen $m-n$ divides $f(m)-f(n)$ for any integers $m$ and $n$. In particular,\nif we put $b_n = a_{n+1} - a_n$, then $b_n$ divides $b_{n+1}$ for all $n$.\nOn the other hand, we are given that $a_0=a_m=0$, which implies that\n$a_1=a_{m+1}$ and so $b_0=b_m$. If $b_0=0$, then $a_0=a_1=\\cdots=a_m$\nand we are done. Otherwise, $|b_0| = |b_1| = |b_2| = \\cdots$, so\n$b_n = \\pm b_0$ for all $n$.\n\nNow $b_0 + \\cdots + b_{m-1} = a_m - a_0 = 0$, so half of the integers $b_0,\n\\dots, b_{m-1}$ are positive and half are negative. In particular, there\nexists an integer $0<k<m$ such that $b_{k-1} = -b_k$, which is to say,\n$a_{k-1} = a_{k+1}$. From this it follows that $a_n = a_{n+2}$ for all\n$n \\geq k-1$; in particular, for $m=n$, we have\n\\[\na_0 = a_m = a_{m+2} = f(f(a_0))\n= a_2.\n\\]", "category": "Algebra", "source": "PUTNAM", "year": 2000}
{"id": "putnam-2000-b1", "question": "Let $a_j,b_j,c_j$ be integers for $1\\leq j\\leq N$.  Assume for each\n$j$, at least one of $a_j,b_j,c_j$ is odd.  Show that there exist integers\n$r$, $s$, $t$ such that $ra_j+sb_j+tc_j$ is odd for at least $4N/7$ values\nof $j$, $1\\leq j\\leq N$.", "solution": "Consider the seven triples $(a,b,c)$ with $a,b,c \\in \\{0,1\\}$ not\nall zero. Notice that if $r_j, s_j, t_j$ are not all even, then four\nof the sums $ar_j + bs_j + ct_j$ with $a,b,c \\in \\{0,1\\}$ are even\nand four are odd. Of course the sum with $a=b=c=0$ is even, so at\nleast four of the seven triples with $a,b,c$ not all zero yield an odd\nsum. In other words, at least $4N$ of the tuples $(a,b,c,j)$ yield\nodd sums. By the pigeonhole principle, there is a triple $(a,b,c)$\nfor which at least $4N/7$ of the sums are odd.", "category": "Combinatorics", "source": "PUTNAM", "year": 2000}
{"id": "putnam-2000-b2", "question": "Prove that the expression\n\\[ \\frac{gcd(m,n)}{n}\\binom{n}{m} \\]\nis an integer for all pairs of integers $n\\geq m\\geq 1$.", "solution": "Since $\\gcd(m,n)$ is an integer linear combination of $m$ and $n$,\nit follows that\n\\[\\frac{gcd(m,n)}{n}\\binom{n}{m}\\]\nis an integer linear combination of the integers\n\\[\\frac{m}{n}\\binom{n}{m}=\\binom{n-1}{m-1} \\mbox{ and }\n\\frac{n}{n}\\binom{n}{m}=\\binom{n}{m} \\]\nand hence is itself an integer.", "category": "Number Theory", "source": "PUTNAM", "year": 2000}
{"id": "putnam-2000-b3", "question": "Let $f(t)=\\sum_{j=1}^N a_j \\sin(2\\pi jt)$, where each $a_j$ is real\nand\n$a_N$ is not equal to 0.  Let $N_k$ denote the number of zeroes (including\nmultiplicities) of $\\frac{d^k f}{dt^k}$.\nProve that\n\\[N_0\\leq N_1\\leq N_2\\leq \\cdots \\mbox{ and } \\lim_{k\\to\\infty} N_k =\n2N.\\]\n[Editorial clarification: only zeroes in $[0, 1)$ should be counted.]", "solution": "Put $f_k(t) = \\frac{df^k}{dt^k}$.\nRecall Rolle's theorem: if $f(t)$ is differentiable, then between any\ntwo zeroes of $f(t)$ there exists a zero of $f'(t)$. This also applies\nwhen the zeroes are not all distinct: if $f$ has a zero of multiplicity\n$m$ at $t=x$, then $f'$ has a zero of multiplicity at least $m-1$ there.\n\nTherefore, if $0 \\leq a_0 \\leq a_1 \\leq \\cdots \\leq a_r < 1$ are the roots\nof $f_k$ in $[0,1)$, then $f_{k+1}$ has a root\nin each of the intervals $(a_0, a_1), (a_1, a_2), \\dots, (a_{r-1}, a_r)$,\nso long as we\nadopt the convention that the empty interval $(t,t)$ actually contains\nthe point $t$ itself. There is also a root in the ``wraparound'' interval\n$(a_r, a_0)$. Thus $N_{k+1} \\geq N_k$.\n\nNext, note that if we set $z = e^{2\\pi i t}$; then\n\\[\nf_{4k}(t) = \\frac{1}{2i} \\sum_{j=1}^N j^{4k} a_j (z^j - z^{-j})\n\\]\nis equal to $z^{-N}$ times a polynomial of degree $2N$. Hence as a\nfunction of $z$, it has at most $2N$ roots; therefore $f_k(t)$ has\nat most $2N$ roots in $[0,1]$. That is, $N_k \\leq 2N$ for all $N$.\n\nTo establish that $N_k \\to 2N$, we make precise the observation that\n\\[\nf_k(t) = \\sum_{j=1}^N j^{4k} a_j \\sin(2\\pi j t)\n\\]\nis dominated by the term with $j=N$. At the points\n$t = (2i+1)/(2N)$ for $i=0,1, \\dots, N-1$, we have\n$N^{4k} a_N \\sin (2\\pi N t) = \\pm N^{4k} a_N$. If $k$ is chosen large enough\nso that\n\\[\n|a_N| N^{4k} > |a_1| 1^{4k} + \\cdots + |a_{N-1}| (N-1)^{4k},\n\\]\nthen $f_k((2i+1)/2N)$ has the same sign as $a_N \\sin (2\\pi N at)$,\nwhich is to say, the sequence $f_k(1/2N), f_k(3/2N), \\dots$ alternates\nin sign. Thus\nbetween these points (again including the ``wraparound'' interval) we find\n$2N$ sign changes of $f_k$. Therefore $\\lim_{k \\to \\infty} N_k = 2N$.", "category": "Algebra", "source": "PUTNAM", "year": 2000}
{"id": "putnam-2000-b4", "question": "Let $f(x)$ be a continuous function such that $f(2x^2-1)=2xf(x)$ for\nall $x$.  Show that $f(x)=0$ for $-1\\leq x\\leq 1$.", "solution": "For $t$ real and not a multiple of $\\pi$, write $g(t) =\n\\frac{f(\\cos t)}{\\sin t}$.\nThen $g(t+\\pi) = g(t)$; furthermore, the given equation implies that\n\\[\ng(2t) = \\frac{f(2\\cos^2 t - 1)}{\\sin (2t)} =\n\\frac{2(\\cos t) f(\\cos t)}{\\sin(2t)} = g(t).\n\\]\nIn particular, for any integer $n$ and $k$, we have\n\\[\ng(1+n\\pi/2^k) = g(2^k + n\\pi) = g(2^k) = g(1).\n\\]\nSince $f$ is continuous, $g$ is continuous where it is defined;\nbut the set $\\{1+n\\pi/2^k | n,k\\in{\\mathbb{Z}}\\}$ is dense\nin the reals, and so $g$ must be constant on its domain.\nSince $g(-t) = -g(t)$ for all $t$, we must have $g(t) = 0$\nwhen $t$ is not a multiple of $\\pi$.\nHence $f(x) = 0$ for $x \\in (-1,1)$.  Finally,\nsetting $x=0$ and $x=1$ in the given equation yields\n$f(-1) = f(1) = 0$.", "category": "Algebra", "source": "PUTNAM", "year": 2000}
{"id": "putnam-2000-b5", "question": "Let $S_0$ be a finite set of positive integers.  We define finite\nsets\n$S_1,S_2,\\ldots$ of positive integers as follows:\nthe integer $a$ is in $S_{n+1}$ if and only if exactly one of $a-1$ or $a$ is\nin\n$S_n$.\nShow that there exist infinitely many integers $N$ for which\n$S_N=S_0\\cup\\{N+a: a\\in S_0\\}$.", "solution": "We claim that all integers $N$ of the form $2^k$, with $k$ a positive\ninteger and $N>\\max\\{S_0\\}$, satisfy the desired conditions.\n\nIt follows from the definition of $S_n$, and induction on $n$, that\n\\begin{align*}\n\\sum_{j \\in S_n} x^j &\\equiv (1+x) \\sum_{j \\in S_{n-1}} x^j \\\\\n&\\equiv (1+x)^n \\sum_{j \\in S_0} x^j \\pmod{2}.\n\\end{align*}\nFrom the identity $(x+y)^2 \\equiv x^2+y^2 \\pmod{2}$ and induction\non $n$, we have $(x+y)^{2^n} \\equiv x^{2^n} + y^{2^n} \\pmod{2}$.\nHence if we choose $N$ to be a power of 2 greater than $\\max\\{S_0\\}$, then\n\\[\n\\sum_{j \\in S_n} \\equiv (1+x^N) \\sum_{j \\in S_0} x^j\n\\]\nand $S_N=S_0\\cup\\{N+a: a\\in S_0\\}$, as desired.", "category": "Combinatorics", "source": "PUTNAM", "year": 2000}
{"id": "putnam-2000-b6", "question": "Let $B$ be a set of more than $2^{n+1}/n$ distinct points with\ncoordinates\nof the form $(\\pm 1,\\pm 1,\\ldots,\\pm 1)$ in $n$-dimensional space with\n$n\\geq 3$.\nShow that there are three distinct points in $B$ which are the vertices of\nan\nequilateral triangle.\n\n\\end{itemize}\n\\end{document}", "solution": "For each point $P$ in $B$, let $S_P$ be the set of points with\nall coordinates equal to $\\pm 1$ which\ndiffer from $P$ in exactly one coordinate. Since there are more than\n$2^{n+1}/n$ points in $B$, and each $S_P$ has $n$ elements, the\ncardinalities of the sets $S_P$ add up to more than $2^{n+1}$, which\nis to say, more than twice the total number of points. By the\npigeonhole principle, there must be a point in three of the\nsets, say $S_P, S_Q, S_R$. But then any two of $P, Q, R$ differ in\nexactly two coordinates, so $PQR$ is an equilateral triangle, as\ndesired.\n\n\n\\end{itemize}\n\n\\end{document}", "category": "Geometry", "source": "PUTNAM", "year": 2000}
{"id": "usamo-2013-q1", "question": "In triangle $ABC$,\npoints $P$, $Q$, $R$ lie on sides $BC$, $CA$, $AB$, respectively.\nLet $\\omega_A$, $\\omega_B$, $\\omega_C$ denote the\ncircumcircles of triangles $AQR$, $BRP$, $CPQ$, respectively.\nGiven the fact that segment $AP$ intersects\n$\\omega_A$, $\\omega_B$, $\\omega_C$ again at $X$, $Y$, $Z$ respectively,\nprove that $YX/XZ=BP/PC$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3041822}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nIn triangle $ABC$,\npoints $P$, $Q$, $R$ lie on sides $BC$, $CA$, $AB$, respectively.\nLet $\\omega_A$, $\\omega_B$, $\\omega_C$ denote the\ncircumcircles of triangles $AQR$, $BRP$, $CPQ$, respectively.\nGiven the fact that segment $AP$ intersects\n$\\omega_A$, $\\omega_B$, $\\omega_C$ again at $X$, $Y$, $Z$ respectively,\nprove that $YX/XZ=BP/PC$.\n\\end{mdframed}\nLet $M$ be the concurrence point of $\\omega_A$, $\\omega_B$, $\\omega_C$ (by Miquel's theorem).\n\n\\begin{center}\n  \\begin{asy}\n    size(8cm);\n    defaultpen(fontsize(9pt));\n    pair A = dir(110);\n    pair B = dir(210);\n    pair C = dir(330);\n    pair P = 0.4*B+0.6*C;\n    pair Q = 0.4*C+0.6*A;\n    pair R = 0.7*A+0.3*B;\n    draw(B--A--C);\n\n    draw(circumcircle(A, Q, R), blue);\n    draw(circumcircle(B, R, P), blue);\n    draw(circumcircle(C, P, Q), blue);\n\n    pair O_A = circumcenter(A, Q, R);\n    pair O_B = circumcenter(B, R, P);\n    pair O_C = circumcenter(C, P, Q);\n\n    pair M = -P+2*foot(P, O_B, O_C);\n    pair X = -A+2*foot(O_A, A, P);\n    pair Y = -P+2*foot(O_B, A, P);\n    pair Z = -P+2*foot(O_C, A, P);\n\n    draw(X--M--P, dotted);\n    draw(R--Q);\n    draw(A--Y);\n    draw(Z--P);\n\n    draw(B--C, red);\n    draw(Y--Z, red);\n\n    dot(\"$A$\", A, dir(A));\n    dot(\"$B$\", B, dir(B));\n    dot(\"$C$\", C, dir(C));\n    dot(\"$P$\", P, dir(P));\n    dot(\"$Q$\", Q, dir(Q));\n    dot(\"$R$\", R, dir(R));\n    dot(\"$M$\", M, dir(-90));\n    dot(\"$X$\", X, dir(225));\n    dot(\"$Y$\", Y, dir(45));\n    dot(\"$Z$\", Z, dir(180));\n\n    /* Source generated by TSQ\n    A = dir 110\n    B = dir 210\n    C = dir 330\n    P = 0.4*B+0.6*C\n    Q = 0.4*C+0.6*A\n    R = 0.7*A+0.3*B\n    B--A--C\n\n    circumcircle A Q R blue\n    circumcircle B R P blue\n    circumcircle C P Q blue\n\n    O_A := circumcenter A Q R\n    O_B := circumcenter B R P\n    O_C := circumcenter C P Q\n\n    M = -P+2*foot P O_B O_C R-90\n    X = -A+2*foot O_A A P R225\n    Y = -P+2*foot O_B A P R45\n    Z = -P+2*foot O_C A P R180\n\n    X--M--P dotted\n    R--Q\n    A--Y\n    Z--P\n\n    B--C red\n    Y--Z red\n    */\n  \\end{asy}\n\\end{center}\n\n\nThen $M$ is the center of a spiral similarity sending\n$\\ol{YZ}$ to $\\ol{BC}$.\nSo it suffices to show that this spiral similarity\nalso sends $X$ to $P$, but\n\\[ \\dang MXY = \\dang MXA = \\dang MRA = \\dang MRB = \\dang MPB \\]\nso this follows.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2013}
{"id": "usamo-2013-q2", "question": "For a positive integer $n\\geq 3$ plot $n$\nequally spaced points around a circle.\nLabel one of them $A$, and place a marker at $A$.\nOne may move the marker forward in a clockwise direction\nto either the next point or the point after that.\nHence there are a total of $2n$ distinct moves available;\ntwo from each point.\nLet $a_n$ count the number of ways to advance\naround the circle exactly twice,\nbeginning and ending at $A$, without repeating a move.\nProve that $a_{n-1}+a_n=2^n$ for all $n\\geq 4$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3041823}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFor a positive integer $n\\geq 3$ plot $n$\nequally spaced points around a circle.\nLabel one of them $A$, and place a marker at $A$.\nOne may move the marker forward in a clockwise direction\nto either the next point or the point after that.\nHence there are a total of $2n$ distinct moves available;\ntwo from each point.\nLet $a_n$ count the number of ways to advance\naround the circle exactly twice,\nbeginning and ending at $A$, without repeating a move.\nProve that $a_{n-1}+a_n=2^n$ for all $n\\geq 4$.\n\\end{mdframed}\nWe present two similar approaches.\n\n\\paragraph{First solution.}\nImagine the counter is moving along\nthe set $S = \\{0, 1, \\dots, 2n\\}$ instead,\nstarting at $0$ and ending at $2n$, in jumps of length $1$ and $2$.\nWe can then record the sequence of moves as a matrix of the form\n\\[\n  \\begin{bmatrix}\n    p_0 & p_1 & p_2 & \\dots & p_{n-1} & p_n \\\\\n    p_n & p_{n+1} & p_{n+2} & \\dots & p_{2n-1} & p_{2n}\n  \\end{bmatrix}\n\\]\nwhere $p_i = 1$ if the point $i$ was visited by the counter,\nand $p_i = 0$ if the point was not visited by the counter.\nNote that $p_0 = p_{2n} = 1$ and the upper-right and lower-left entries are equal.\nThen, the problem amounts to finding the number of such matrices\nwhich avoid the contiguous submatrices\n\\[\n  \\begin{bmatrix} 0 & 0 \\end{bmatrix}\n  \\qquad\n  \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}\n  \\qquad\n  \\begin{bmatrix} 1 & 1 \\\\ 1 & 1 \\end{bmatrix}\n\\]\nwhich correspond to forbidding jumps of length greater than $2$,\nrepeating a length $2$ jump and repeating a length $1$ jump.\n\nWe give a nice symmetric phrasing suggested by \\texttt{fclvbfm934} at\n\\url{https://aops.com/community/p27834267}.\nIf we focus on just the three possible column vectors that appear, say\n\\[\n  \\mathbf u \\coloneq \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}, \\qquad\n  \\mathbf v \\coloneq \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}, \\qquad\n  \\mathbf w \\coloneq \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n\\]\nthen we can instead describe valid matrices\nas sequences of $n+1$ such column vectors,\nwhere no two column vectors are adjacent,\nand where the boundary condition is that\n\\begin{itemize}\n  \\ii either we start with $\\mathbf u$ and end with $\\mathbf v$, or\n  \\ii either we start with $\\mathbf w$ and end with $\\mathbf w$.\n\\end{itemize}\nLet $x_n$ and $y_n$ denote the number of such $2 \\times (n+1)$ matrices.\n(Hence $a_n = x_n + y_n$.)\nBut owing to the symmetry of the setup with $\\mathbf u$, $\\mathbf v$, $\\mathbf w$,\nwe could instead view $x_n$ and $y_n$ as the number of $2 \\times (n+1)$ matrices\nfor a fixed starting first column whose final column is the same/different.\nSo we have the recursions\n\\begin{align*}\n  x_{n+1} &= x_n + y_n \\\\\n  y_{n+1} &= 2x_n.\n\\end{align*}\nWe also have that\n\\[ 2x_n + y_n = 2^n \\]\nwhich may either be proved directly from the recursions (using $x_1 = 1$ and $y_1 = 0$),\nor by noting the left-hand side counts the total number of sequences\nof $n+1$ column vectors with no restrictions on the final column at all\n(in which case there are simply $2$ choices for each of the $n$ columns\nafter the first one).\nThus,\n\\begin{align*}\n  a_{n+1} + a_n &= (x_{n+1} + y_{n+1}) + (x_n + y_n) \\\\\n  &= \\left( (x_n + y_n) + 2x_n \\right) + (x_n + y_n) \\\\\n  &= 2(2x_n + y_n) = 2^{n+1}\n\\end{align*}\nas needed.\n\n\\paragraph{Second (longer) solution.}\nIf one does not notice the nice rephrasing with $\\mathbf u$, $\\mathbf v$,\n$\\mathbf w$ above, one may still proceed with the following direct calculation.\nRetain the notation of\n\\[\n  \\begin{bmatrix}\n    p_0 & p_1 & p_2 & \\dots & p_{n-1} & p_n \\\\\n    p_n & p_{n+1} & p_{n+2} & \\dots & p_{2n-1} & p_{2n}\n  \\end{bmatrix}\n\\]\ndescribed earlier.\nWe will for now ignore the boundary conditions.\nInstead we say a $2 \\times m$ matrix is \\emph{silver} ($m \\ge 2$)\nif it avoids the three shapes above.\nWe consider three types of silver matrices\n(essentially doing casework on the last column):\n\\begin{itemize}\n\\ii \\emph{type B matrices}, of the shape\n  $\\begin{bmatrix}\n    1 & \\dotsb & 1 \\\\\n    0 & \\dotsb & 0\n  \\end{bmatrix}$\n\\ii \\emph{type C matrices}, of the shape\n  $\\begin{bmatrix}\n    1 & \\dotsb & 0 \\\\\n    0 & \\dotsb & 1\n  \\end{bmatrix}$.\n\\ii \\emph{type D matrices}, of the shape\n  $\\begin{bmatrix}\n    1 & \\dotsb & 1 \\\\\n    0 & \\dotsb & 1\n  \\end{bmatrix}$.\n\\end{itemize}\nWe let $b_m$, $c_m$, $d_m$\ndenote matrices of each type, of size $2 \\times m$,\nand claim the following two recursions for $m \\ge 4$:\n\\begin{align*}\n  b_m &= c_{m-1} + d_{m-1} \\\\\n  c_m &= b_{m-1} + d_{m-1} \\\\\n  d_m &= b_{m-1} + c_{m-1}.\n\\end{align*}\nIndeed, if we delete the last column of a type B matrix\nand consider what used to be the second-to-last column,\nwe find that it is either type C or type D.\nThis establishes the first recursion and the others are analogous.\n\nNote that $b_2 = 0$ and $c_2 = d_2 = 1$.\nSo using this recursion, the first few values are\n\\[\n  \\begin{array}{rrrrrrrr}\n    m  & 2 & 3 & 4 & 5 &  6 &  7 &  8 \\\\ \\hline\n    b_m & 0 & 2 & 2 & 6 & 10 & 22 & 42 \\\\\n    c_m & 1 & 1 & 3 & 5 & 11 & 21 & 43 \\\\\n    d_m & 1 & 1 & 3 & 5 & 11 & 21 & 43 \\\\\n  \\end{array}\n\\]\nand a calculation gives $b_m = \\frac{2^{m-1} + 2(-1)^{m-1}}{3}$,\n$c_m = d_m = \\frac{2^{m-1} - (-1)^{m-1}}{3}$.\n\nWe now relate $a_n$ to $b_m$, $c_m$, $d_m$.\nObserve that a matrix as described in the problem is a silver\nmatrix of one of two forms:\n\\[\n  \\begin{bmatrix}\n    1 & p_1 & p_2 & \\dots & p_{n-1} & 0 \\\\\n    0 & p_{n+1} & p_{n+2} & \\dots & p_{2n-1} & 1\n  \\end{bmatrix}\n  \\qquad\n  \\text{or}\\qquad\n  \\begin{bmatrix}\n    1 & p_1 & p_2 & \\dots & p_{n-1} & 1 \\\\\n    1 & p_{n+1} & p_{n+2} & \\dots & p_{2n-1} & 1\n  \\end{bmatrix}.\n\\]\nThere are $c_{n+1}$ matrices of the first form.\nMoreover, there are $2d_n$ matrices of the second form\n(to see this, delete the first column;\nwe either get a type-D matrix\nor an upside-down type-D matrix).\nThus we get\n\\[ a_n = c_{n+1} + 2d_n\n  = \\frac{2^{n+1} + (-1)^{n+1}}{3}. \\]\nThis implies the result.\n\n\\begin{remark*}\n  The two solutions are closely related.\n  In fact, $c_n = x_{n-1}$ and $b_n = y_{n-1}$.\n  So the second solution is really the same as the first solution,\n  except the symmetry of $\\mathbf u$, $\\mathbf v$, $\\mathbf w$ was not noticed,\n  thus requiring a third recursion to handle all the cases manually.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "USAMO", "year": 2013}
{"id": "usamo-2013-q3", "question": "Let $n$ be a positive integer.\nThere are $\\tfrac{n(n+1)}{2}$ tokens,\neach with a black side and a white side,\narranged into an equilateral triangle,\nwith the biggest row containing $n$ tokens.\nInitially, each token has the white side up.\nAn operation is to choose a line parallel to the sides of the triangle,\nand flip all the token on that line.\nA configuration is called admissible if it can be obtained from the\ninitial configuration by performing a finite number of operations.\nFor each admissible configuration $C$,\nlet $f(C)$ denote the smallest number of operations required to\nobtain $C$ from the initial configuration.\nFind the maximum value of $f(C)$,\nwhere $C$ varies over all admissible configurations.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3041827}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n$ be a positive integer.\nThere are $\\tfrac{n(n+1)}{2}$ tokens,\neach with a black side and a white side,\narranged into an equilateral triangle,\nwith the biggest row containing $n$ tokens.\nInitially, each token has the white side up.\nAn operation is to choose a line parallel to the sides of the triangle,\nand flip all the token on that line.\nA configuration is called admissible if it can be obtained from the\ninitial configuration by performing a finite number of operations.\nFor each admissible configuration $C$,\nlet $f(C)$ denote the smallest number of operations required to\nobtain $C$ from the initial configuration.\nFind the maximum value of $f(C)$,\nwhere $C$ varies over all admissible configurations.\n\\end{mdframed}\nThe answer is\n\\[\n  \\max_C f(C) =\n  \\begin{cases}\n    6k & n = 4k \\\\\n    6k+1 & n = 4k+1 \\\\\n    6k+2 & n = 4k+2 \\\\\n    6k+3 & n = 4k+3.\n  \\end{cases}\n\\]\nThe main point of the problem is actually to determine\nall linear dependencies among the $3n$ possible moves\n(since the moves commute and applying a move twice\nis the same as doing nothing).\nIn what follows, assume $n > 1$ for convenience.\n\nTo this end, we consider sequences of operations as\nadditive vectors in $v \\in \\FF_2^{3n}$, with the\nlinear map $T \\colon \\FF_2^{3n} \\to \\FF_2^{\\half n(n+1)}$\ndenoting the result of applying a vector $v$.\nWe in particular focus on the following four vectors.\n\\begin{itemize}\n  \\ii Three vectors $x$, $y$, $z$ are defined by\n  choosing all $n$ lines parallel to one axis.\n  Note $T(x) = T(y) = T(z) = \\mathbf 1$\n  (i.e.\\ these vectors flip all tokens).\n  \\ii The vector $\\theta$ which toggles\n  all lines with an even number of tokens.\n  One can check that $T(\\theta) = \\mathbf 0$.\n  (Easiest to guess from $n=2$ and $n=3$ case.)\n  One amusing proof that this works is to use Vivani's theorem:\n  in an equilateral triangle $ABC$,\n  the sum of distances from an interior point $P$\n  to the three sides is equal.\n\\end{itemize}\nThe main claim is:\n\\begin{claim*}\n  For $n \\ge 2$,\n  the kernel of $T$ has exactly eight elements,\n  namely $\\{\\mathbf 0, x+y, y+z, z+x,\n  \\theta, \\theta+x+y, \\theta+y+z, \\theta+z+x \\}$.\n\\end{claim*}\n% (This is motivated by the validity of the claim\n% when $n = 2$ and $n = 3$.)\n\\begin{proof}\n  Suppose $T(v) = 0$.\n  \\begin{itemize}\n    \\ii If $v$ uses the $y$-move of length $n$,\n    then we replace $v$ with $v+(x+y)$\n    to obtain a vector in the kernel not using the $y$-move of length $n$.\n    \\ii If $v$ uses the $z$-move of length $n$,\n    then we replace $v$ with $v+(x+z)$\n    to obtain a vector in the kernel not using the $z$-move of length $n$.\n    \\ii If $v$ uses the $x$-move of length $2$, then\n    \\begin{itemize}\n      \\ii if $n$ is odd, replace $v$ with $v+\\theta$;\n      \\ii if $n$ is even, replace $v$ with $v+(\\theta+y+z)$\n    \\end{itemize}\n    to obtain a vector in the kernel not using the $x$-move of length $2$.\n  \\end{itemize}\n  A picture is shown below,\n  with the unused rows being dotted.\n  \\begin{center}\n  \\begin{asy}\n    pair A = dir(60);\n    pair B = dir(0);\n    real r = 0.3;\n    draw( (-A)--(7*A), dashed );\n    draw( (7*B-A)--(7*A-B), dashed );\n    draw( (5*A-B)--(5*A+2*B), dashed );\n    for (int i=0; i<=6; ++i) {\n      for (int j=0; i+j<=6; ++j) {\n        filldraw(CR(i*A+j*B, r), opacity(0.2)+lightcyan, black);\n      }\n    }\n  \\end{asy}\n  \\end{center}\n\n  Then, it is easy to check inductively that $v$ must now be the\n  zero vector, after the replacements.\n  The idea is that for each token $t$,\n  if two of the moves involving $t$ are unused, so is the third,\n  and in this way we can show all rows are unused.\n  Thus the original $v$ was in the kernel we described.\n\n  (An alternative proof by induction is feasible too;\n  as a sequence of movings which does not affect the top $n$ rows\n  also does not affect the to $n-1$ rows.)\n\\end{proof}\nThen problem is a coordinate bash,\nsince given any $v$ we now know exactly which vectors $w$\nhave $T(v) = T(w)$, so given any admissible configuration $C$\none can exactly compute $f(C)$ as the minimum of eight values.\n\nTo be explicit, we could represent a vector $v$ as\n\\[ v \\longleftrightarrow (a_1, a_2, b_1, b_2, c_1, c_2) \\]\nwhere $a_1$ is the number of $1$'s in odd $x$-indices,\n$a_2$ number of $1$'s in even $x$-indices.\nThen for example\n\\begin{align*}\n  v &\\longleftrightarrow (a_1, a_2, b_1, b_2, c_1, c_2) \\\\\n  v+x+y &\\longleftrightarrow \\left( \\left\\lceil \\frac n2 \\right\\rceil - a_1,\n    \\left\\lfloor \\frac n2 \\right\\rfloor - a_2,\n    \\left\\lceil \\frac n2  \\right\\rceil - b_1,\n    \\left\\lfloor \\frac n2 \\right\\rfloor - b_2, c_1, c_2 \\right) \\\\\n  v+\\theta &\\longleftrightarrow \\left(a_1, \\left\\lfloor \\frac n2  \\right\\rfloor - a_2, b_1,\n    \\left\\lfloor \\frac n2 \\right\\rfloor -\n    b_2, c_1, \\left\\lfloor \\frac n2 \\right\\rfloor - c_2\\right)\n  &\\vdotswithin{=}\n\\end{align*}\nand $f(T(v))$ is the smallest sum of the six numbers across all eight $6$-tuples.\nSo you expect to answer about $\\frac32 n$\nif all things are about $n/4$.\nThe details are too annoying to reproduce here, so they are omitted.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Combinatorics", "source": "USAMO", "year": 2013}
{"id": "usamo-2013-q4", "question": "Find all real numbers $x,y,z \\ge 1$ satisfying\n\\[ \\min \\left( \\sqrt{x+xyz}, \\sqrt{y+xyz}, \\sqrt{z+xyz} \\right)\n  = \\sqrt{x-1} + \\sqrt{y-1} + \\sqrt{z-1}. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3043752}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all real numbers $x,y,z \\ge 1$ satisfying\n\\[ \\min \\left( \\sqrt{x+xyz}, \\sqrt{y+xyz}, \\sqrt{z+xyz} \\right)\n  = \\sqrt{x-1} + \\sqrt{y-1} + \\sqrt{z-1}. \\]\n\\end{mdframed}\nSet $x = 1+a$, $y = 1+b$, $z = 1+c$\nwhich eliminates the $x,y,z \\ge 1$ condition.\nAssume without loss of generality that $a \\leq b \\leq c$.\nThen the given equation rewrites as\n\\[ \\sqrt{(1+a)\\left( 1+(1+b)(1+c) \\right)} = \\sqrt a + \\sqrt b + \\sqrt c. \\]\n\nIn fact, we are going to prove the left-hand side always exceeds the\nright-hand side, and then determine the equality cases.\nWe have:\n\\begin{align*}\n  (1+a)\\left( 1 + (1+b)(1+c) \\right)\n  &= (a+1)\\left( 1 + (b+1)(1+c) \\right) \\\\\n  &\\le (a+1) \\left( 1 + \\left( \\sqrt b + \\sqrt c \\right)^2 \\right) \\\\\n  &\\le \\left( \\sqrt a + \\left( \\sqrt b + \\sqrt c \\right) \\right)^2\n\\end{align*}\nby two applications of Cauchy-Schwarz.\n\nEquality holds if $bc = 1$ and $1/a = \\sqrt b + \\sqrt c$.\nLetting $c = t^2$ for $t \\ge 1$,\nwe recover $b = t^{-2} \\le t^2$ and $a = \\frac{1}{t+1/t} \\le t^2$.\n\nHence the solution set is\n\\[ (x,y,z) = \\left( 1 + \\left( \\frac{t}{t^2+1} \\right)^2,\n  1 + \\frac{1}{t^2}, 1 + t^2 \\right) \\]\nand permutations, for any $t > 0$.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2013}
{"id": "usamo-2013-q5", "question": "Let $m$ and $n$ be positive integers.\nProve that there exists a positive integer $c$\nsuch that $cm$ and $cn$ have the same nonzero decimal digits.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3043754}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $m$ and $n$ be positive integers.\nProve that there exists a positive integer $c$\nsuch that $cm$ and $cn$ have the same nonzero decimal digits.\n\\end{mdframed}\nOne-line spoiler: $142857$.\n\nMore verbosely,\nthe idea is to look at the decimal representation of $1/D$, $m/D$, $n/D$\nfor a suitable denominator $D$, which have a ``cyclic shift'' property\nin which the digits of $n/D$ are the digits of $m/D$ shifted by $3$.\n\n\\begin{remark*}\n  [An example to follow along]\n  Here is an example to follow along in the subsequent proof\n  If $m = 4$ and $n = 23$ then the magic numbers $e = 3$ and $D = 41$ obey\n  \\[ 10^3 \\cdot \\frac{4}{41} = 97 + \\frac{23}{41}. \\]\n  The idea is that\n  \\begin{align*}\n    \\frac{1}{41} &= 0.\\ol{02439} \\\\\n    \\frac{4}{41} &= 0.\\ol{09756} \\\\\n    \\frac{23}{41} &= 0.\\ol{56097}\n  \\end{align*}\n  and so $c = 2349$ works;\n  we get $4c = 9756$ and $23c = 56097$\n  which are cyclic shifts of each other by $3$ places\n  (with some leading zeros appended).\n\\end{remark*}\n\nHere is the one to use:\n\\begin{claim*}\n  There exists positive integers $D$ and $e$\n  such that $\\gcd(D,10)=1$, $D > \\max(m,n)$,\n  and moreover \\[ \\frac{ 10^e m - n }{ D } \\in \\ZZ. \\]\n\\end{claim*}\n\\begin{proof}\n  Suppose we pick some exponent $e$ and define the number\n  \\[ A = 10^e n - m. \\]\n  Let $r = \\nu_2(m)$ and $s = \\nu_5(m)$.\n  As long as $e > \\max(r,s)$ we have $\\nu_2(A) = r$ and $\\nu_5(A) = s$, too.\n  Now choose any $e > \\max(r,s)$ big enough that $A > 2^r 5^s \\max(m,n)$ also holds.\n  Then the number $D = \\frac{A}{2^r 5^s}$ works;\n  the first two properties hold by construction and\n  \\[ 10^e \\cdot \\frac nD - \\frac mD\n    = \\frac{A}{D} = 2^r 5^s \\]\n  is an integer.\n\\end{proof}\n\\begin{remark*}\n  [For people who like obscure theorems]\n  Kobayashi's theorem implies we can actually pick $D$ to be prime.\n\\end{remark*}\nNow we take $c$ to be the\nnumber under the bar of $1/D$ (leading zeros removed).\nThen the decimal representation of $\\frac mD$\nis the decimal representation of $cm$ repeated\n(possibly including leading zeros).\nSimilarly, $\\frac nD$ has the decimal representation of $cm$ repeated (possibly including leading zeros).\nFinally, since\n\\[ 10^e \\cdot \\frac mD - \\frac nD \\text{ is an integer} \\]\nit follows that these repeating decimal representations are rotations of each other by $e$ places,\nso in particular they have the same number of nonzero digits.\n\n\n\\begin{remark*}\n  Many students tried to find a $D$ satisfying the stronger hypothesis\n  that $1/D$, $2/D$, \\dots, $(D-1)/D$\n  are cyclic shifts of each other.\n  For example, this holds in the famous $D = 7$ case.\n\n  The official USAMO 2013 solutions try to do this by proving\n  that $10$ is a primitive root modulo $7^e$\n  for each $e \\ge 1$, by Hensel lifting lemma.\n  I think this argument is actually \\emph{incorrect},\n  because it breaks if either $m$ or $n$ are divisible by $7$.\n  Put bluntly, $\\frac{7}{49}$ and $\\frac{8}{49}$\n  are not shifts of each other.\n\n  One may be tempted to resort to using large primes $D$\n  rather than powers of $7$ to deal with this issue.\n  However it is an open conjecture\n  (a special case of Artin's primitive root conjecture)\n  whether or not $10 \\pmod p$ is primitive infinitely often,\n  which is the necessary conjecture\n  so this is harder than it seems.\n\\end{remark*}\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 2013}
{"id": "usamo-2013-q6", "question": "Let $ABC$ be a triangle.\nFind all points $P$ on segment $BC$ satisfying the following property:\nIf $X$ and $Y$ are the intersections of line $PA$ with the common external\ntangent lines of the circumcircles of triangles $PAB$ and $PAC$, then\n\\[ \\left( \\frac{PA}{XY} \\right)^2 + \\frac{PB\\cdot PC}{AB\\cdot AC} = 1.\\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3043749}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle.\nFind all points $P$ on segment $BC$ satisfying the following property:\nIf $X$ and $Y$ are the intersections of line $PA$ with the common external\ntangent lines of the circumcircles of triangles $PAB$ and $PAC$, then\n\\[ \\left( \\frac{PA}{XY} \\right)^2 + \\frac{PB\\cdot PC}{AB\\cdot AC} = 1.\\]\n\\end{mdframed}\nLet $O_1$ and $O_2$ denote the circumcenters of $PAB$ and $PAC$.\nThe main idea is to notice that $\\triangle ABC$ and $\\triangle AO_1O_2$\nare spirally similar.\n\n\\begin{center}\n\\begin{asy}\npair A = dir(140);\npair B = dir(210);\npair C = dir(330);\npair P = 0.3*C+0.7*B;\nfilldraw(A--B--C--cycle, opacity(0.1)+lightcyan, blue);\n\npair O_1 = circumcenter(A, B, P);\npair O_2 = circumcenter(A, C, P);\n\nreal r1 = abs(P-O_1);\nreal r2 = abs(P-O_2);\npair Se = (r1*O_2-r2*O_1)/(r1-r2);\npath w1 = CP(O_1,P);\npath w2 = CP(O_2,P);\nfilldraw(w1, opacity(0.1)+yellow, deepgreen);\nfilldraw(w2, opacity(0.1)+yellow, deepgreen);\n\npair X_1 = IP(w1, CP(midpoint(Se--O_1), Se));\npair Y_1 = OP(w1, CP(midpoint(Se--O_1), Se));\npair X_2 = IP(w2, CP(midpoint(Se--O_2), Se));\npair Y_2 = OP(w2, CP(midpoint(Se--O_2), Se));\n\ndraw(X_1--X_2, deepgreen);\ndraw(Y_1--Y_2, deepgreen);\npair X = extension(A, P, X_1, X_2);\npair Y = extension(A, P, Y_1, Y_2);\ndraw(X--Y, dotted);\n\nfilldraw(A--O_1--O_2--cycle, opacity(0.1)+lightred, red);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$P$\", P, dir(70));\ndot(\"$O_1$\", O_1, dir(-90));\ndot(\"$O_2$\", O_2, dir(-90));\ndot(\"$X_1$\", X_1, dir(X_1));\ndot(\"$Y_1$\", Y_1, dir(Y_1));\ndot(\"$X_2$\", X_2, dir(X_2));\ndot(\"$Y_2$\", Y_2, dir(Y_2));\ndot(\"$X$\", X, dir(X));\ndot(\"$Y$\", Y, dir(Y));\n\n/* TSQ Source:\n\nA = dir 140\nB = dir 210\nC = dir 330\nP = 0.3*C+0.7*B R70\nA--B--C--cycle 0.1 lightcyan / blue\n\nO_1 = circumcenter A B P R-90\nO_2 = circumcenter A C P R-90\n\n!real r1 = abs(P-O_1);\n!real r2 = abs(P-O_2);\nSe := (r1*O_2-r2*O_1)/(r1-r2)\n!path w1 = CP(O_1,P);\n!path w2 = CP(O_2,P);\nw1 0.1 yellow / deepgreen\nw2 0.1 yellow / deepgreen\n\nX_1 = IP w1 CP midpoint Se--O_1 Se\nY_1 = OP w1 CP midpoint Se--O_1 Se\nX_2 = IP w2 CP midpoint Se--O_2 Se\nY_2 = OP w2 CP midpoint Se--O_2 Se\n\nX_1--X_2 deepgreen\nY_1--Y_2 deepgreen\nX = extension A P X_1 X_2\nY = extension A P Y_1 Y_2\nX--Y dotted\n\nA--O_1--O_2--cycle 0.1 lightred / red\n\n*/\n\\end{asy}\n\\end{center}\n\n\\begin{claim*}\n  [Salmon theorem]\n  We have $\\triangle ABC \\overset{+}{\\sim} \\triangle AO_1O_2$.\n\\end{claim*}\n\\begin{proof}\n  We first claim $\\triangle AO_1B \\overset{+}{\\sim} \\triangle AO_2C$.\n  Assume without loss of generality that $\\angle APB \\le 90\\dg$.\n  Then \\[ \\angle AO_1B = 2 \\angle APB \\]\n  but \\[ \\angle AO_2C = 2 \\left( 180 - \\angle APC \\right) = 2 \\angle ABP. \\]\n  Hence $\\angle AO_1B = \\angle AO_2C$.\n  Moreover, both triangles are isosceles,\n  establishing the first similarity.\n  The second part follows from spiral similarities coming in pairs.\n\\end{proof}\n\n\\begin{claim*}\n  We always have\n  \\[ \\left( \\frac{PA}{XY} \\right)^2 = 1 - \\left( \\frac{a}{b+c} \\right)^2. \\]\n  (In particular, this does not depend on $P$.)\n\\end{claim*}\n\\begin{proof}\nWe now delete the points $B$ and $C$\nand remember only the fact that $\\triangle AO_1O_2$\nhas angles $A$, $B$, $C$.\nThe rest is a computation and several approaches are possible.\n\nWithout loss of generality $A$ is closer to $X$ than $Y$,\nand let the common tangents be $\\ol{X_1X_2}$ and $\\ol{Y_1Y_2}$.\nWe'll perform the main calculation\nwith the convenient scaling $O_B O_C = a$, $AO_C = b$, and $AO_B = c$.\nLet $B_1$ and $C_1$ be the tangency points of $X$,\nand let $h = AM$ be the height of $\\triangle A O_B O_C$.\n\n\\begin{center}\n\\begin{asy}\npair O_1 = dir(180);\npair O_2 = dir(0);\npair A = dir(130);\npair P = conj(A);\npair M = midpoint(A--P);\n\nreal r1 = abs(P-O_1);\nreal r2 = abs(P-O_2);\npair Se = (r1*O_2-r2*O_1)/(r1-r2);\npath w1 = CP(O_1,P);\npath w2 = CP(O_2,P);\nfilldraw(w1, opacity(0.1)+yellow, deepgreen);\nfilldraw(w2, opacity(0.1)+yellow, deepgreen);\n\npair X_1 = IP(w1, CP(midpoint(Se--O_1), Se));\npair X_2 = IP(w2, CP(midpoint(Se--O_2), Se));\n\nfilldraw(A--O_1--O_2--cycle, opacity(0.1)+lightred, red);\ndraw(O_1--X_1--X_2--O_2, deepgreen);\npair X = extension(A, P, X_1, X_2);\ndraw(P--X, deepgreen);\n\ndot(\"$O_1$\", O_1, dir(O_1));\ndot(\"$O_2$\", O_2, dir(O_2));\ndot(\"$A$\", A, dir(30));\ndot(\"$P$\", P, dir(330));\ndot(\"$M$\", M, dir(315));\ndot(\"$X_1$\", X_1, dir(X_1));\ndot(\"$X_2$\", X_2, dir(105));\ndot(\"$X$\", X, dir(X));\n\n/* TSQ Source:\n\nO_1 = dir 180\nO_2 = dir 0\nA = dir 130 R30\nP = conj A R330\nM = midpoint A--P R315\n\n!real r1 = abs(P-O_1);\n!real r2 = abs(P-O_2);\nSe := (r1*O_2-r2*O_1)/(r1-r2)\n!path w1 = CP(O_1,P);\n!path w2 = CP(O_2,P);\nw1 0.1 yellow / deepgreen\nw2 0.1 yellow / deepgreen\n\nX_1 = IP w1 CP midpoint Se--O_1 Se\nX_2 = IP w2 CP midpoint Se--O_2 Se R105\n\nA--O_1--O_2--cycle 0.1 lightred / red\nO_1--X_1--X_2--O_2 deepgreen\nX = extension A P X_1 X_2\nP--X deepgreen\n\n*/\n\\end{asy}\n\\end{center}\n\nNote that by Power of a Point, we have $XX_1^2 = XX_2^2 = XM^2 - h^2$.\nAlso, by Pythagorean theorem we easily obtain $X_1X_2 = a^2 - (b-c)^2$.\nSo putting these together gives\n\\[ XM^2 - h^2 = \\frac{a^2 - (b-c)^2}{4}\n  = \\frac{(a+b-c)(a-b+c)}{4} = (s-b)(s-c). \\]\nTherefore, we have\n\nThen\n\\begin{align*}\n  \\frac{XM^2}{h^2}\n  &= 1 + \\frac{(s-b)(s-c)}{h^2}\n    = 1 + \\frac{a^2(s-b)(s-c)}{a^2h^2} \\\\\n  &= 1 + \\frac{a^2(s-b)(s-c)}{4s(s-a)(s-b)(s-c)}\n    = 1 + \\frac{a^2}{4s(s-a)} \\\\\n  &= 1 + \\frac{a^2}{(b+c)^2-a^2}\n  = \\frac{(b+c)^2}{(b+c)^2-a^2}.\n\\end{align*}\nThus \\[ \\left( \\frac{PA}{XY} \\right)^2 = \\left(\\frac{h}{XM}\\right)^2\n  = 1 - \\left( \\frac{a}{b+c} \\right)^2. \\qedhere \\]\n\\end{proof}\n\nTo finish, note that when $P$ is the foot of the $\\angle A$-bisector,\nwe necessarily have\n\\[\n  \\frac{PB \\cdot PC}{AB \\cdot AC}\n  = \\frac{\\left( \\frac{b}{b+c} a \\right)\\left( \\frac{c}{b+c} a \\right)}{bc}\n  = \\left( \\frac{a}{b+c} \\right)^2.  \\]\nSince there are clearly at most two solutions as $\\tfrac{PA}{XY}$ is fixed,\nthese are the only two solutions.\n\\pagebreak\n\n\n\\end{document}", "category": "Geometry", "source": "USAMO", "year": 2013}
{"id": "imo-2015-q1", "question": "We say that a finite set $\\mathcal{S}$ of points in the plane\nis \\emph{balanced} if,\nfor any two different points $A$ and $B$ in $\\mathcal{S}$,\nthere is a point $C$ in $\\mathcal{S}$ such that $AC=BC$.\nWe say that $\\mathcal{S}$ is \\emph{center-free} if for\nany three different points $A$, $B$ and $C$ in $\\mathcal{S}$,\nthere are no points $P$ in $\\mathcal{S}$ such that $PA=PB=PC$.\n\n\\begin{enumerate}\n\\item[(a)] Show that for all integers $n\\ge 3$,\n  there exists a balanced set consisting of $n$ points.\n\\item[(b)] Determine all integers $n\\ge 3$ for which\n  there exists a balanced center-free set consisting of $n$ points.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p5079689}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nWe say that a finite set $\\mathcal{S}$ of points in the plane\nis \\emph{balanced} if,\nfor any two different points $A$ and $B$ in $\\mathcal{S}$,\nthere is a point $C$ in $\\mathcal{S}$ such that $AC=BC$.\nWe say that $\\mathcal{S}$ is \\emph{center-free} if for\nany three different points $A$, $B$ and $C$ in $\\mathcal{S}$,\nthere are no points $P$ in $\\mathcal{S}$ such that $PA=PB=PC$.\n\n\\begin{enumerate}\n\\item[(a)] Show that for all integers $n\\ge 3$,\n  there exists a balanced set consisting of $n$ points.\n\\item[(b)] Determine all integers $n\\ge 3$ for which\n  there exists a balanced center-free set consisting of $n$ points.\n\\end{enumerate}\n\\end{mdframed}\nFor part (a), take a circle centered at a point $O$,\nand add $n-1$ additional points by adding pairs of points\nseparated by an arc of $60^{\\circ}$ or similar triples.\nAn example for $n = 6$ is shown below.\n\\begin{center}\n\\begin{asy}\n  size(4cm);\n  draw(unitcircle);\n  dotfactor *= 1.5;\n  pair O = (0,0);\n  dot(\"$O$\", O, dir(-90), blue);\n  pair A = dir(37);\n  pair B = A*dir(-60);\n  pair C = B*dir(-60);\n  pair X = dir(117);\n  pair Y = X*dir(60);\n  draw(O--X--Y--cycle, deepgreen+dashed);\n  dot(X, deepgreen);\n  dot(Y, deepgreen);\n  draw(B--O--A--B--C--O, red+dashed);\n  dot(A, red);\n  dot(B, red);\n  dot(C, red);\n\\end{asy}\n\\end{center}\n\nFor part (b), the answer is odd $n$, achieved by taking a regular $n$-gon.\nTo show even $n$ fail, note that some point is on the perpendicular bisector of\n\\[ \\left\\lceil \\frac 1n \\binom n2 \\right\\rceil = \\frac{n}{2} \\]\npairs of points, which is enough.\n(This is a standard double-counting argument.)\n\n\\begin{remark*}\n  As an aside, there is a funny joke about this problem.\n  There are two types of people in the world:\n  \\begin{itemize}\n    \\ii Those who solve (b) quickly and then take forever to solve (a),\n    \\ii those who solve (a) quickly and then can't solve (b) at all.\n  \\end{itemize}\n  (Empirically true when the Taiwan IMO 2014 team was working on it.)\n\\end{remark*}\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2015}
{"id": "imo-2015-q2", "question": "Find all positive integers $a$, $b$, $c$ such that\neach of $ab-c$, $bc-a$, $ca-b$ is a power of $2$\n(possibly including $2^0=1$).", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p5079630}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all positive integers $a$, $b$, $c$ such that\neach of $ab-c$, $bc-a$, $ca-b$ is a power of $2$\n(possibly including $2^0=1$).\n\\end{mdframed}\nHere is the solution of \\textbf{Telv Cohl},\nwhich is the shortest solution I am aware of.\nWe will prove the only solutions are $(2,2,2)$, $(2,2,3)$,\n$(2,6,11)$ and $(3,5,7)$ and permutations.\n\nWLOG assume $a \\ge b \\ge c > 1$, so $ab-c \\ge ca-b \\ge bc-a$.\nWe consider the following cases:\n\\begin{itemize}\n  \\ii If $a$ is even, then\n  \\begin{align*}\n    ca-b &= \\gcd (ab-c, ca-b) \\le \\gcd (ab-c, a(ca-b)+ab-c) \\\\\n    &= \\gcd\\left( ab-c, c(a^2-1) \\right).\n  \\end{align*}\n  As $a^2-1$ is odd, we conclude $ca-b \\le c$.\n  This implies $a=b=c=2$.\n\n  \\ii If $a$, $b$, $c$ are all odd, then $a > b > c > 1$ follows.\n  Then as before\n  \\[  ca-b \\le \\gcd (ab-c, c(a^2-1))\n    \\le 2^{\\nu_2(a^2-1)} \\le 2a+2 \\le 3a-b \\]\n  so $c = 3$ and $a = b+2$.\n  As $3a-b = ca-b \\ge 2(bc-a) = 6b-2a$ we then conclude $a=7$ and $b=5$.\n\n  \\ii If $a$ is odd and $b$, $c$ are even, then $bc-a=1$\n  and hence $bc^2 - b - c = ca - b$.\n  Then from the miraculous identity\n  \\[ c^3-b-c = (1-c^2)(ab-c) + a(\\underbrace{bc^2-b-c}_{=ca-b}) + (ca-b) \\]\n  so we conclude $\\gcd(ab-c, ca-b) = \\gcd(ab-c, c^3-b-c)$, in other words\n  \\[ bc^2-b-c = ca-b = \\gcd(ab-c, ca-b) = \\gcd(ab-c, c^3-b-c). \\]\n  We thus consider two more cases:\n  \\begin{itemize}\n    \\ii If $c^3-b-c \\neq 0$ then\n    the above implies $|c^3-b-c| \\ge bc^2-b-c$.\n    As $b \\ge c > 1$, we must actually have $b = c$,\n    thus $a = c^2-1$.\n    Finally $ab-c = c(c^2-2)$ is a power of $2$, hence $b=c=2$, so $a=3$.\n\n    \\ii In the second case, assume $c^3-b-c = 0$, hence $c^3-c$.\n    From $bc-a=1$ we obtain $a=c^4-c^2-1$,\n    hence\n    \\[ ca-b = c^5-2c^3 = c^3(c^2-2) \\]\n    is a power of $2$, hence again $c = 2$.\n    Thus $a=11$ and $b=6$.\n  \\end{itemize}\n\\end{itemize}\nThis finishes all cases, so the proof is done.\n\\pagebreak", "category": "Number Theory", "source": "IMO", "year": 2015}
{"id": "imo-2015-q3", "question": "Let $ABC$ be an acute triangle with $AB > AC$.\nLet $\\Gamma$ be its circumcircle, $H$ its orthocenter, and $F$ the foot of the altitude from $A$.\nLet $M$ be the midpoint of $\\ol{BC}$.\nLet $Q$ be the point on $\\Gamma$ such that $\\angle HQA = 90\\dg$\nand let $K$ be the point on $\\Gamma$ such that $\\angle HKQ = 90\\dg$.\nAssume that the points $A$, $B$, $C$, $K$ and $Q$ are all different and lie on $\\Gamma$ in this order.\nProve that the circumcircles of triangles $KQH$ and $FKM$ are tangent to each other.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p5079655}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be an acute triangle with $AB > AC$.\nLet $\\Gamma$ be its circumcircle, $H$ its orthocenter, and $F$ the foot of the altitude from $A$.\nLet $M$ be the midpoint of $\\ol{BC}$.\nLet $Q$ be the point on $\\Gamma$ such that $\\angle HQA = 90\\dg$\nand let $K$ be the point on $\\Gamma$ such that $\\angle HKQ = 90\\dg$.\nAssume that the points $A$, $B$, $C$, $K$ and $Q$ are all different and lie on $\\Gamma$ in this order.\nProve that the circumcircles of triangles $KQH$ and $FKM$ are tangent to each other.\n\\end{mdframed}\nLet $L$ be on the nine-point circle with $\\angle HML = 90^{\\circ}$.\nThe negative inversion at $H$ swapping $\\Gamma$ and nine-point circle maps\n\\[ A \\longleftrightarrow F, \\quad\n  Q \\longleftrightarrow M, \\quad\n  K \\longleftrightarrow L. \\]\nIn the inverted statement, we want line $ML$ to be tangent to $(AQL)$.\n\n\\begin{center}\n\\begin{asy}\nsize(10cm);\npair A = dir(80);\npair B = dir(220);\npair C = dir(-40);\n\nfilldraw(unitcircle, opacity(0.1)+yellow, orange);\npair O = circumcenter(A, B, C);\npair H = orthocenter(A, B, C);\npair Q = IP(CP(midpoint(A--H), H), unitcircle);\npair N = midpoint(H--Q);\npair T = midpoint(A--H);\npair N_9 = midpoint(O--H);\npair M = midpoint(B--C);\npair F = foot(A, B, C);\n\nfilldraw(circumcircle(M, F, N), opacity(0.1)+yellow, heavyred);\n\npair L = M+T-N;\npair K = foot(Q, L, H);\n\ndraw(A--B--C--cycle, red+1);\ndraw(A--F, red+1);\ndraw(T--M--L--N, red);\ndraw(M--Q--A, brown);\ndraw(Q--K--L, brown);\n\nfilldraw(A--Q--L--cycle, opacity(0.1)+cyan, cyan);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$O$\", O, dir(O));\ndot(\"$H$\", H, dir(H));\ndot(\"$Q$\", Q, dir(Q));\ndot(\"$N$\", N, dir(N));\ndot(\"$T$\", T, dir(T));\ndot(\"$N_9$\", N_9, dir(N_9));\ndot(\"$M$\", M, dir(M));\ndot(\"$F$\", F, dir(F));\ndot(\"$L$\", L, dir(L));\ndot(\"$K$\", K, dir(K));\n\n/* TSQ Source:\n\n!size(10cm);\nA = dir 80\nB = dir 220\nC = dir -40\n\nunitcircle 0.1 yellow / orange\nO = circumcenter A B C\nH = orthocenter A B C\nQ = IP CP midpoint A--H H unitcircle\nN = midpoint H--Q\nT = midpoint A--H\nN_9 = midpoint O--H\nM = midpoint B--C\nF = foot A B C\n\ncircle M F N 0.1 yellow / heavyred\n\nL = M+T-N\nK = foot Q L H\n\nA--B--C--cycle red+1\nA--F red+1\nT--M--L--N red\nM--Q--A brown\nQ--K--L brown\n\nA--Q--L--cycle 0.1 cyan / cyan\n\n*/\n\\end{asy}\n\\end{center}\n\n\\begin{claim*}\n  $\\ol{LM} \\parallel \\ol{AQ}$.\n\\end{claim*}\n\\begin{proof}\n  Both are perpendicular to $\\ol{MHQ}$.\n\\end{proof}\n\\begin{claim*}\n  $LA = LQ$.\n\\end{claim*}\n\\begin{proof}\n  Let $N$ and $T$ be the midpoints of $\\ol{HQ}$ and $\\ol{AH}$,\n  and $O$ the circumcenter.\n  As $\\ol{MT}$ is a diameter, we know $LTNM$ is a rectangle,\n  so $\\ol{LT}$ passes through $O$.\n  Since $\\ol{LOT} \\perp \\ol{AQ}$ and $OA=OQ$, the proof is complete.\n\\end{proof}\nTogether these two claims solve the problem.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Geometry", "source": "IMO", "year": 2015}
{"id": "imo-2015-q4", "question": "Triangle $ABC$ has circumcircle $\\Omega$ and circumcenter $O$.\nA circle $\\Gamma$ with center $A$\nintersects the segment $BC$ at points $D$ and $E$,\nsuch that $B$, $D$, $E$, and $C$ are all different\nand lie on line $BC$ in this order.\nLet $F$ and $G$ be the points of intersection of $\\Gamma$ and $\\Omega$,\nsuch that $A$, $F$, $B$, $C$, and $G$ lie on $\\Omega$ in this order.\nLet $K = (BDF) \\cap \\ol{AB} \\neq B$\nand $L = (CGE) \\cap \\ol{AC} \\neq C$\nand assume these points do not lie on line $FG$.\nDefine $X = \\ol{FK} \\cap \\ol{GL}$.\nProve that $X$ lies on the line $AO$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p5083464}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nTriangle $ABC$ has circumcircle $\\Omega$ and circumcenter $O$.\nA circle $\\Gamma$ with center $A$\nintersects the segment $BC$ at points $D$ and $E$,\nsuch that $B$, $D$, $E$, and $C$ are all different\nand lie on line $BC$ in this order.\nLet $F$ and $G$ be the points of intersection of $\\Gamma$ and $\\Omega$,\nsuch that $A$, $F$, $B$, $C$, and $G$ lie on $\\Omega$ in this order.\nLet $K = (BDF) \\cap \\ol{AB} \\neq B$\nand $L = (CGE) \\cap \\ol{AC} \\neq C$\nand assume these points do not lie on line $FG$.\nDefine $X = \\ol{FK} \\cap \\ol{GL}$.\nProve that $X$ lies on the line $AO$.\n\\end{mdframed}\nSince $\\ol{AO} \\perp \\ol{FG}$ for obvious reasons,\nwe will only need to show that $XF = XG$,\nor that $\\dang KFG = \\dang LGF$.\n\nLet line $FG$ meet $(BDF)$ and $(CGE)$\nagain at $F_2$ and $G_2$.\n\\begin{center}\n\\begin{asy}\nsize(10cm);\npair A = dir(105);\npair B = dir(200);\npair C = dir(340);\nreal r = 1.337;\n\npair F = IP(CR(A, r), unitcircle);\npair G = OP(CR(A, r), unitcircle);\npair D = IP(CR(A, r), B--C);\npair E = OP(CR(A, r), B--C);\n\npair K = IP(circumcircle(B, D, F), A--B);\npair L = IP(circumcircle(C, E, G), A--C);\ndraw(unitcircle, orange);\ndraw(arc(A,r,160,380), orange);\nfilldraw(A--B--C--cycle, opacity(0.1)+lightred, red);\npair X = extension(F, K, G, L);\ndraw(F--G, red);\ndraw(F--X--G, lightblue);\n\npair F_2 = IP(circumcircle(B, F, D), F--G);\npair G_2 = IP(F--G, circumcircle(C, E, G));\nfilldraw(circumcircle(B, F, D), opacity(0.1)+yellow, lightblue);\nfilldraw(circumcircle(C, E, G), opacity(0.1)+yellow, lightblue);\n\ndraw(B--F_2--D--F--cycle, lightcyan);\ndraw(C--G_2--E--G--cycle, lightcyan);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$F$\", F, dir(F));\ndot(\"$G$\", G, dir(G));\ndot(\"$D$\", D, dir(D));\ndot(\"$E$\", E, dir(E));\ndot(\"$K$\", K, dir(100));\ndot(\"$L$\", L, dir(L));\ndot(\"$X$\", X, dir(X));\ndot(\"$F_2$\", F_2, dir(70));\ndot(\"$G_2$\", G_2, dir(G_2));\n\n/* TSQ Source:\n\nA = dir 105\nB = dir 200\nC = dir 340\n! real r = 1.337;\n\nF = IP CR A r unitcircle\nG = OP CR A r unitcircle\nD = IP CR A r B--C\nE = OP CR A r B--C\n\nK = IP circumcircle B D F A--B R100\nL = IP circumcircle C E G A--C\nunitcircle orange\n!draw(arc(A,r,160,380), orange);\nA--B--C--cycle 0.1 lightred / red\nX = extension F K G L\nF--G red\nF--X--G lightblue\n\nF_2 = IP circumcircle B F D F--G R70\nG_2 = IP F--G circumcircle C E G\ncircumcircle B F D 0.1 yellow / lightblue\ncircumcircle C E G 0.1 yellow / lightblue\n\nB--F_2--D--F--cycle lightcyan\nC--G_2--E--G--cycle lightcyan\n\n*/\n\\end{asy}\n\\end{center}\n\n\\begin{claim*}\n  Quadrilaterals $FBDF_2$ and $G_2ECG$ are similar,\n  actually homothetic through $\\ol{FG} \\cap \\ol{BC}$.\n\\end{claim*}\n\\begin{proof}\n  This is essentially a repeated application\n  of being ``anti-parallel'' through $\\angle(FG, BC)$.\n  Note the four angle relations\n  \\begin{align*}\n    \\dang(FD, FG) = \\dang(BC,GE) = \\dang(G_2C,FG)\n      &\\implies \\ol{FD} \\parallel \\ol{G_2C} \\\\\n    \\dang(F_2B, FG) = \\dang(BC,FD) = \\dang(GE,FG)\n      &\\implies \\ol{F_2B} \\parallel \\ol{GE} \\\\\n    \\dang(FB, FG)  = \\dang(BC,GC) = \\dang(G_2E,FG)\n      &\\implies \\ol{FB} \\parallel \\ol{G_2E} \\\\\n    \\dang(F_2D, FG)  = \\dang(BC,FB) = \\dang(GC,FG)\n      &\\implies \\ol{F_2D} \\parallel \\ol{GC}.\n  \\end{align*}\n  This gives the desired homotheties.\n\\end{proof}\nTo finish the angle chase,\n\\begin{align*}\n  \\dang GFK = \\dang F_2BK &= \\dang F_2BF - \\dang ABF\n  = \\dang F_2DF - \\dang ABF \\\\\n  &= \\dang F_2DF - \\dang GCA\n  = \\dang GCG_2 - \\dang GCA \\\\\n  &=  \\dang LCG_2 = \\dang LGF\n\\end{align*}\nas needed.\n(Here $\\dang ABF = \\dang GCA$ since $AF = AG$.)\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2015}
{"id": "imo-2015-q5", "question": "Solve the functional equation\n\\[ f(x+f(x+y)) + f(xy) = x + f(x+y) + yf(x) \\]\nfor $f \\colon \\RR \\to \\RR$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p5083463}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nSolve the functional equation\n\\[ f(x+f(x+y)) + f(xy) = x + f(x+y) + yf(x) \\]\nfor $f \\colon \\RR \\to \\RR$.\n\\end{mdframed}\nThe answers are $f(x) \\equiv x$ and $f(x) \\equiv 2-x$.\nObviously, both of them work.\n\nLet $P(x,y)$ be the given assertion.\nWe also will let $S = \\{t \\mid f(t) = t\\}$\nbe the set of fixed points of $f$.\n\\begin{itemize}\n  \\ii From $P(0,0)$ we get $f(f(0)) = 0$.\n  \\ii From $P(0,f(0))$ we get $2f(0) = f(0)^2$\n  and hence $f(0) \\in \\{0,2\\}$.\n  \\ii From $P(x,1)$\n  we find that $x+f(x+1) \\in S$ for all $x$.\n\\end{itemize}\n\nWe now solve the case $f(0) = 2$.\n\\begin{claim*}\n  If $f(0) = 2$ then $f(x) \\equiv 2-x$.\n\\end{claim*}\n\\begin{proof}\n  Let $t \\in S$ be any fixed point.\n  Then $P(0,t)$ gives $2 = 2t$ or $t = 1$;\n  so $S = \\{1\\}$.\n  But we also saw $x+f(x+1) \\in S$,\n  which implies $f(x) \\equiv 2-x$.\n\\end{proof}\n\nHenceforth, assume $f(0) = 0$.\n\\begin{claim*}\n  If $f(0) = 0$ then $f$ is odd.\n\\end{claim*}\n\\begin{proof}\n  Note that $P(1,-1) \\implies f(1) + f(-1) = 1 - f(1)$\n  and $P(-1,1) \\implies f(-1) + f(-1) = -1 + f(1)$,\n  together giving $f(1) = 1$ and $f(-1) = -1$.\n  To prove $f$ odd we now obtain more fixed points:\n  \\begin{itemize}\n    \\ii From $P(x,0)$ we find that $x+f(x) \\in S$ for all $x \\in \\RR$.\n    \\ii From $P(x-1,1)$ we find that $x-1+f(x) \\in S$ for all $x \\in \\RR$.\n    \\ii From $P(1, f(x)+x-1)$ we find $x+1+f(x) \\in S$ for all $x \\in \\RR$.\n  \\end{itemize}\n  Finally $P(x, -1)$ gives $f$ odd.\n\\end{proof}\nTo finish from $f$ odd, notice that\n\\begin{align*}\n  P(x,-x) &\\implies f(x) + f(-x^2) = x - xf(x) \\\\\n  P(-x,x) &\\implies f(-x) + f(-x^2) = -x + xf(-x)\n\\end{align*}\nwhich upon subtracting gives $f(x) \\equiv x$.\n\\pagebreak", "category": "Algebra", "source": "IMO", "year": 2015}
{"id": "imo-2015-q6", "question": "The sequence $a_1,a_2,\\dots$ of integers satisfies the conditions:\n\\begin{enumerate}[(i)]\n  \\ii $1\\le a_j\\le2015$ for all $j\\ge1$,\n  \\ii $k+a_k\\neq \\ell+a_\\ell$ for all $1\\le k<\\ell$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p5083494}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nThe sequence $a_1,a_2,\\dots$ of integers satisfies the conditions:\n\\begin{enumerate}[(i)]\n  \\ii $1\\le a_j\\le2015$ for all $j\\ge1$,\n  \\ii $k+a_k\\neq \\ell+a_\\ell$ for all $1\\le k<\\ell$.\n\\end{enumerate}\nProve that there exist two positive integers $b$ and $N$ for which\n\\[ \\left\\lvert\\sum_{j=m+1}^n (a_j-b) \\right\\rvert \\le 1007^2 \\]\nfor all integers $m$ and $n$ such that $n > m\\ge N$.\n\\end{mdframed}\nWe give two equivalent solutions with different presentations,\none with ``arrows'' and the other by ``juggling''.\n\n\\paragraph{First solution (arrows).}\nConsider the map\n\\[ f \\colon k \\mapsto k + a_k. \\]\nThis map is injective, so if we draw all arrows of the form $k \\mapsto f(k)$\nwe get a partition of $\\NN$ into one or more ascending chains\n(which skip by at most $2015$).\n\nThere are at most $2015$ such chains,\nsince among any $2015$ consecutive points in $\\NN$\nevery chain must have an element.\n\nWe claim we may take $b$ to be the number of such chains,\nand $N$ to be the largest of the start-points of all the chains.\n\n% TODO picture here would be nice\nConsider an interval $I = [m+1, n]$.\nWe have that\n\\[ \\sum_{m<j\\le n} a_j = \\sum_{\\text{chain } c} \\left[ \\min \\left\\{ x > n, x \\in c \\right\\}\n  - \\min \\left\\{ x > m, x \\in c \\right\\} \\right]. \\]\nThus the upper bound is proved by the calculation\n\\begin{align*}\n  \\sum_{m<j\\le n} (a_j-b)\n  &= \\sum_{\\text{chain } c} \\left[ (\\min \\left\\{ x > n, x \\in c \\right\\} - n)\n    - (\\min \\left\\{ x > m, x \\in c \\right\\} - m) \\right] \\\\\n  &= \\sum_{\\text{chain } c} \\left[ (\\min \\left\\{ x > n, x \\in c \\right\\} - n) \\right]\n    - \\sum_{\\text{chain } c} \\left[\n    \\min \\left\\{ x > m, x \\in c \\right\\} - m \\right] \\\\\n  &\\le (1+2015+2014+\\dots+(2015-(b-2)))-(1+2+\\dots+b) \\\\\n  &= (b-1)(2015-b)\n\\end{align*}\nfrom above (noting that $n+1$ has to belong to some chain).\nThe lower bound is similar.\n\n\\paragraph{Second solution (juggling).}\nThis solution is essentially the same, but phrased as a juggling problem.\nHere is a solution in this interpretation:\nwe will consider several balls thrown in the air,\nwhich may be at heights $0$, $1$, $2$, \\dots, $2014$.\nThe process is as follows:\n\\begin{itemize}\n\\ii Initially, at time $t = 0$, there are no balls in the air.\n\\ii Then at each integer time $t$ thereafter,\nif there is a ball at height $0$, it is caught;\notherwise a ball is added to the juggler's hand.\nThis ball (either caught or added) is then thrown to a height of $a_t$.\n\\ii Immediately afterwards, all balls have their height decreased by one.\n\\end{itemize}\nThe condition $a_k + k \\neq \\ell + a_\\ell$ thus ensures that\nno two balls are ever at the same height.\nIn particular, there will never be more than $2016$ balls,\nsince there are only $2015$ possible heights.\n\nWe claim we may set.\n\\begin{align*}\n  b &= \\text{number of balls in entire process} \\\\\n  N &= \\text{last moment in time at which a ball is added}.\n\\end{align*}\nIndeed, the key fact is that if we let $S_t$ denote\nthe sum of the height of all the balls just after time $t+\\half$, then\n\\[ S_{t+1} - S_t = a_{t+1} - b \\]\nAfter all, at each time step $t$, the caught ball is thrown to height $a_t$,\nand then all balls have their height decreased by $1$,\nfrom which the conclusion follows.\nHence the quantity in the problem is exactly equal to\n\\[ \\left\\lvert\\sum_{j=m+1}^n (a_j-b) \\right\\rvert\n  = \\left\\lvert S_m - S_n \\right\\rvert. \\]\nFor a fixed $b$, we easily have the inequalities\n$0 + 1 + \\dots + (b-1) \\le S_t \\le 2014 + 2013 + \\dots + (2015-b)$.\nHence $|S_m - S_n| \\le (b-1)(2015-b) \\le 1007^2$ as desired.\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "IMO", "year": 2015}
{"id": "imo-2008-q1", "question": "Let $H$ be the orthocenter of an acute-angled triangle $ABC$.\nThe circle $\\Gamma_{A}$ centered at the midpoint of $\\ol{BC}$ and passing\nthrough $H$ intersects the sideline $BC$ at points  $A_1$ and $A_2$.\nSimilarly, define the points $B_1$, $B_2$, $C_1$, and $C_2$.\nProve that six points $A_1$, $A_2$, $B_1$, $B_2$, $C_1$, $C_2$ are concyclic.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1190553}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $H$ be the orthocenter of an acute-angled triangle $ABC$.\nThe circle $\\Gamma_{A}$ centered at the midpoint of $\\ol{BC}$ and passing\nthrough $H$ intersects the sideline $BC$ at points  $A_1$ and $A_2$.\nSimilarly, define the points $B_1$, $B_2$, $C_1$, and $C_2$.\nProve that six points $A_1$, $A_2$, $B_1$, $B_2$, $C_1$, $C_2$ are concyclic.\n\\end{mdframed}\nWe show two solutions.\n\n\\paragraph{First solution using power of a point.}\nLet $D$, $E$, $F$ be the centers of $\\Gamma_A$, $\\Gamma_B$, $\\Gamma_C$\n(in other words, the midpoints of the sides).\n\nWe first show that $B_1$, $B_2$, $C_1$, $C_2$ are concyclic.\nIt suffices to prove that $A$\nlies on the radical axis of the circles $\\Gamma_B$ and $\\Gamma_C$.\n\n\\begin{center}\n\\begin{asy}\npair A = dir(110);\npair B = dir(210);\npair C = dir(330);\ndraw(A--B--C--cycle);\n\npair D = midpoint(B--C);\npair E = midpoint(C--A);\npair F = midpoint(A--B);\npair H = orthocenter(A, B, C);\ndraw(E--F);\n\npair X = -H+2*foot(H, E, F);\npath w1 = Drawing(CP(E,H));\npath w2 = Drawing(CP(F,H));\npair B_1 = IP(w1, A--C);\npair B_2 = OP(w1, A--C);\npair C_1 = IP(w2, A--B);\npair C_2 = OP(w2, A--B);\n\npair T = foot(A, B, C);\ndraw(A--T, dotted);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$D$\", D, dir(D));\ndot(\"$E$\", E, dir(E));\ndot(\"$F$\", F, dir(F));\ndot(\"$H$\", H, 1.4*dir(-10));\ndot(\"$X$\", X, 1.4*dir(10));\ndot(\"$B_1$\", B_1, 1.5*dir(90));\ndot(\"$B_2$\", B_2, 1.2*dir(-10));\ndot(\"$C_1$\", C_1, 1.2*dir(120));\ndot(\"$C_2$\", C_2, dir(C_2));\n\n/* TSQ Source:\n\nA = dir 110\nB = dir 210\nC = dir 330\nA--B--C--cycle\n\nD = midpoint B--C\nE = midpoint C--A\nF = midpoint A--B\nH = orthocenter A B C 1.4R-10\nE--F\n\nX = -H+2*foot H E F 1.4R10\n! path w1 = Drawing(CP(E,H));\n! path w2 = Drawing(CP(F,H));\nB_1 = IP w1 A--C 1.5R90\nB_2 = OP w1 A--C 1.2R-10\nC_1 = IP w2 A--B 1.2R120\nC_2 = OP w2 A--B\n\nT := foot A B C\nA--T dotted\n\n*/\n\\end{asy}\n\\end{center}\n\nLet $X$ be the second intersection of $\\Gamma_B$ and $\\Gamma_C$.\nClearly $\\ol{XH}$ is perpendicular to the line\njoining the centers of the circles, namely $\\ol{EF}$.\nBut $\\ol{EF} \\parallel \\ol{BC}$, so $\\ol{XH} \\perp \\ol{BC}$.\nSince $\\ol{AH} \\perp \\ol{BC}$ as well,\nwe find that $A$, $X$, $H$ are collinear, as needed.\n\nThus, $B_1$, $B_2$, $C_1$, $C_2$ are concyclic.\nSimilarly, $C_1$, $C_2$, $A_1$, $A_2$ are concyclic,\nas are $A_1$, $A_2$, $B_1$, $B_2$.\nNow if any two of these three circles coincide, we are done;\nelse the pairwise radical axii are not concurrent, contradiction.\n(Alternatively, one can argue directly that $O$ is the center of all\nthree circles, by taking the perpendicular bisectors.)\n\n\\paragraph{Second solution using length chase (Ritwin Narra).}\nWe claim the circumcenter $O$ of $\\triangle ABC$\nis in fact the center of $(A_1A_2B_1B_2C_1C_2)$.\n\nDefine $D$, $E$, $F$ as before.\nThen since $\\ol{OD} \\perp \\ol{A_1A_2}$ and $DA_1 = DA_2$,\nwhich means $OA_1 = OA_2$. Similarly, we have $OB_1 = OB_2$ and $OC_1 = OC_2$.\n\nNow since $DA_1 = DA_2 = DH$, we have $OA_1^2 = OD^2 + HD^2$.\nWe seek to show\n\\[ OD^2 + HD^2 = OE^2 + HE^2 = OF^2 + HF^2. \\]\nThis is clear by Appollonius's Theorem\nsince $D$, $E$, and $F$ lie on the nine-point circle,\nwhich is centered at the midpoint of $\\ol{OH}$.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2008}
{"id": "imo-2008-q2", "question": "Let $x$, $y$, $z$ be real numbers with $xyz = 1$, all different from $1$.\nProve that\n\\[ \\frac{x^2}{(x-1)^2} + \\frac{y^2}{(y-1)^2} + \\frac{z^2}{(z-1)^2} \\ge 1 \\]\nand show that equality holds for infinitely many choices\nof rational numbers $x$, $y$, $z$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1190551}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $x$, $y$, $z$ be real numbers with $xyz = 1$, all different from $1$.\nProve that\n\\[ \\frac{x^2}{(x-1)^2} + \\frac{y^2}{(y-1)^2} + \\frac{z^2}{(z-1)^2} \\ge 1 \\]\nand show that equality holds for infinitely many choices\nof rational numbers $x$, $y$, $z$.\n\\end{mdframed}\nLet $x=a/b$, $y=b/c$, $z=c/a$, so we want to show\n\\[ \\left(\\frac{a}{a-b}\\right)^2+\\left(\\frac{b}{b-c}\\right)^2\n  +\\left(\\frac{c}{c-a}\\right)^2\\ge 1.\\]\nA boring computation shows this is equivalent to\n\\[ \\frac{(a^2b+b^2c+c^2a-3abc)^2}{(a-b)^2(b-c)^2(c-a)^2} \\ge 0 \\]\nwhich proves the inequality\n(and it is unsurprising we are in such a situation,\ngiven that there is an infinite curve of rationals).\n\nFor equality, it suffices to show there are infinitely many integer solutions to\n\\[ a^2b+b^2c+c^2a=3abc \\iff \\frac ac + \\frac ba + \\frac ca = 3 \\]\nor equivalently that there are infinitely many rational solutions to\n\\[ u + v + \\frac{1}{uv} = 3. \\]\nFor any $0 \\neq u \\in \\QQ$ the real solution for $u$ is\n\\[ v = \\frac{-u + (u-1)\\sqrt{1-4/u} + 3}{2} \\]\nand there are certainly infinitely many rational numbers $u$\nfor which $1-4/u$ is a rational square\n(say, $u = \\frac{-4}{q^2-1}$ for $q \\neq \\pm 1$ a rational number).\n\\pagebreak", "category": "Algebra", "source": "IMO", "year": 2008}
{"id": "imo-2008-q3", "question": "Prove that there are infinitely many positive integers $n$\nsuch that $n^2+1$ has a prime factor greater than $2n + \\sqrt{2n}$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1190546}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nProve that there are infinitely many positive integers $n$\nsuch that $n^2+1$ has a prime factor greater than $2n + \\sqrt{2n}$.\n\\end{mdframed}\nThe idea is to pick the prime $p$ first!\n\nSelect any large prime $p \\ge 2013$,\nand let $h = \\left\\lceil \\sqrt p \\right\\rceil$.\nWe will try to find an $n$ such that\n\\[ n \\le \\frac 12 (p-h) \\quad \\text{and} \\quad p \\mid n^2+1. \\]\nThis implies $p \\ge 2n+\\sqrt{p}$\nwhich is enough to ensure $p \\ge 2n + \\sqrt{2n}$.\n\nAssume $p \\equiv 1 \\pmod 8$ henceforth.\nThen there exists some $\\frac 12 p < x < p$\nsuch that $x^2 \\equiv -1 \\pmod p$,\nand we set \\[ x = \\frac{p+1}{2} + t. \\]\n\\begin{claim*}\n  We have $t \\ge \\frac{h-1}{2}$ and hence may take $n = p-x$.\n\\end{claim*}\n\\begin{proof}\nAssume for contradiction this is false; then\n\\begin{align*}\n  0 &\\equiv  4(x^2+1) \\pmod{p} \\\\\n  &= \\left( p+1+2t \\right)^2 + 4 \\\\\n  &\\equiv (2t+1)^2 + 4 \\pmod{p} \\\\\n  &< h^2+4\n\\end{align*}\nSo we have that $(2t+1)^2+4$ is positive and divisible by $p$,\nyet at most $\\left\\lceil \\sqrt{p} \\right\\rceil^2 + 4 < 2p$.\nSo it must be the case that $(2t+1)^2+4 = p$,\nbut this has no solutions modulo $8$.\n\\end{proof}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Number Theory", "source": "IMO", "year": 2008}
{"id": "imo-2008-q4", "question": "Find all functions $f$ from the positive reals to the positive reals such that\n\\[ \\frac{f(w)^2 + f(x)^2}{f(y^2)+f(z^2)} = \\frac{w^2+x^2}{y^2+z^2} \\]\nfor all positive real numbers $w$, $x$, $y$, $z$ satisfying $wx=yz$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1191683}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all functions $f$ from the positive reals to the positive reals such that\n\\[ \\frac{f(w)^2 + f(x)^2}{f(y^2)+f(z^2)} = \\frac{w^2+x^2}{y^2+z^2} \\]\nfor all positive real numbers $w$, $x$, $y$, $z$ satisfying $wx=yz$.\n\\end{mdframed}\nThe answers are $f(x) \\equiv x$ and $f(x) \\equiv 1/x$.\nThese work, so we show they are the only ones.\n\nFirst, setting $(t,t,t,t)$ gives $f(t^2) = f(t)^2$.\nIn particular, $f(1) = 1$.\nNext, setting $(t, 1, \\sqrt t, \\sqrt t)$ gives\n\\[ \\frac{f(t)^2 + 1}{2f(t)} = \\frac{t^2 + 1}{2t} \\]\nwhich as a quadratic implies $f(t) \\in \\{t, 1/t\\}$.\n\nNow assume $f(a) = a$ and $f(b) = 1/b$.\nSetting $(\\sqrt a, \\sqrt b, 1, \\sqrt{ab})$ gives\n\\[ \\frac{a + 1/b}{f(ab) + 1} = \\frac{a+b}{ab+1}. \\]\nOne can check the two cases on $f(ab)$ each imply\n$a=1$ and $b=1$ respectively.\nHence the only answers are those claimed.\n\\pagebreak", "category": "Algebra", "source": "IMO", "year": 2008}
{"id": "imo-2008-q5", "question": "Let $n$ and $k$ be positive integers with $k \\geq n$ and $k - n$ an even number.\nThere are $2n$ lamps labelled $1$, $2$, \\dots, $2n$ each of which can be either on or off.\nInitially all the lamps are off.\nWe consider sequences of steps: at each step one of the lamps is switched\n(from on to off or from off to on).\nLet $N$ be the number of such sequences consisting of $k$ steps\nand resulting in the state where lamps $1$ through $n$ are all on,\nand lamps $n + 1$ through $2n$ are all off.\nLet $M$ be number of such sequences consisting of $k$ steps,\nresulting in the state where lamps $1$ through $n$ are all on,\nand lamps $n + 1$ through $2n$ are all off,\nbut where none of the lamps $n + 1$ through $2n$ is ever switched on.\nDetermine $\\frac{N}{M}$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1191679}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n$ and $k$ be positive integers with $k \\geq n$ and $k - n$ an even number.\nThere are $2n$ lamps labelled $1$, $2$, \\dots, $2n$ each of which can be either on or off.\nInitially all the lamps are off.\nWe consider sequences of steps: at each step one of the lamps is switched\n(from on to off or from off to on).\nLet $N$ be the number of such sequences consisting of $k$ steps\nand resulting in the state where lamps $1$ through $n$ are all on,\nand lamps $n + 1$ through $2n$ are all off.\nLet $M$ be number of such sequences consisting of $k$ steps,\nresulting in the state where lamps $1$ through $n$ are all on,\nand lamps $n + 1$ through $2n$ are all off,\nbut where none of the lamps $n + 1$ through $2n$ is ever switched on.\nDetermine $\\frac{N}{M}$.\n\\end{mdframed}\nThe answer is $2^{k-n}$.\n\nConsider the following map $\\Psi$ from $N$-sequences to $M$-sequences:\n\\begin{itemize}\n  \\ii change every instance of $n+1$ to $1$;\n  \\ii change every instance of $n+2$ to $2$;\n  \\ii[$\\vdots$]\n  \\ii change every instance of $2n$ to $n$.\n\\end{itemize}\n(For example, suppose $k=9$, $n=3$;\nthen $144225253 \\mapsto 111222223$.)\n\nClearly this is map is well-defined and surjective.\nSo all that remains is:\n\\begin{claim*}\n  Every $M$-sequence has exactly $2^{k-n}$ pre-images under $\\Psi$.\n\\end{claim*}\n\\begin{proof}\n  Indeed, suppose that there are $c_1$ instances of lamp $1$.\n  Then we want to pick an odd subset of the $1$'s to change to $n+1$'s,\n  so $2^{c_1 - 1}$ ways to do this.\n  And so on.\n  Hence the number of pre-images is\n  \\[ \\prod_i 2^{c_i - 1} = 2^{k-n}. \\qedhere \\]\n\\end{proof}\n\\pagebreak", "category": "Combinatorics", "source": "IMO", "year": 2008}
{"id": "imo-2008-q6", "question": "Let $ABCD$ be a convex quadrilateral with $BA \\neq BC$.\nDenote the incircles of triangles $ABC$ and $ADC$\nby $\\omega_1$ and $\\omega_2$ respectively.\nSuppose that there exists a circle $\\omega$ tangent\nto ray $BA$ beyond $A$ and to the ray $BC$ beyond $C$,\nwhich is also tangent to the lines $AD$ and $CD$.\nProve that the common external tangents to\n$\\omega_1$ and $\\omega_2$ intersect on $\\omega$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1191671}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABCD$ be a convex quadrilateral with $BA \\neq BC$.\nDenote the incircles of triangles $ABC$ and $ADC$\nby $\\omega_1$ and $\\omega_2$ respectively.\nSuppose that there exists a circle $\\omega$ tangent\nto ray $BA$ beyond $A$ and to the ray $BC$ beyond $C$,\nwhich is also tangent to the lines $AD$ and $CD$.\nProve that the common external tangents to\n$\\omega_1$ and $\\omega_2$ intersect on $\\omega$.\n\\end{mdframed}\nBy the external version of Pitot theorem, the existence\nof $\\omega$ implies that\n\\[ BA + AD = CB + CD. \\]\nLet $\\ol{PQ}$ and $\\ol{ST}$ be diameters of $\\omega_1$ and $\\omega_2$\nwith $P, T \\in \\ol{AC}$.\nThen the length relation on $ABCD$ implies that $P$ and $T$\nare reflections about the midpoint of $\\ol{AC}$.\n\nNow orient $AC$ horizontally and let $K$ be the ``uppermost'' point of $\\omega$, as shown.\n\n\\begin{center}\n\\begin{asy}\nsize(12cm);\npair W = dir(48.4);\npair X = dir(68.4);\npair Y = dir(138.4);\npair Z = dir(173.4);\n\npair A = 2*X*Z/(X+Z);\npair B = 2*W*Z/(W+Z);\npair C = 2*W*Y/(W+Y);\npair D = 2*X*Y/(X+Y);\n\ndraw(arc(origin, 1, 40, 180), dashed+orange);\n\nfilldraw(incircle(A, B, C), opacity(0.1)+lightred, red);\nfilldraw(incircle(A, D, C), opacity(0.1)+lightred, red);\nfilldraw(A--B--C--D--cycle, opacity(0.1)+yellow, orange);\ndraw(A--C, red);\n\npair I_B = incenter(A, B, C);\npair I_D = incenter(A, D, C);\npair P = foot(I_B, A, C);\npair Q = 2*I_B-P;\npair T = foot(I_D, A, C);\npair S = 2*I_D-T;\n\ndraw(A--Z, orange);\ndraw(C--W, orange);\npair E = 2*Y*Z/(Y+Z);\npair F = 2*X*W/(X+W);\ndraw(E--D--F, orange);\n\npair K = extension(B, Q, D, P);\ndraw(B--K--P, dashed+red);\ndraw(P--Q, red);\ndraw(S--T, red);\n\ndot(\"$W$\", W, dir(W));\ndot(\"$X$\", X, dir(95));\ndot(\"$Y$\", Y, dir(Y));\ndot(\"$Z$\", Z, dir(Z));\ndot(\"$A$\", A, dir(135));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(45));\ndot(\"$D$\", D, dir(-D));\ndot(\"$P$\", P, dir(270));\ndot(\"$Q$\", Q, 0.8*dir(95));\ndot(\"$T$\", T, dir(45));\ndot(\"$S$\", S, dir(225));\ndot(\"$K$\", K, dir(315));\n\n/* TSQ Source:\n\n!size(12cm);\nW = dir 48.4\nX = dir 68.4 R95\nY = dir 138.4\nZ = dir 173.4\n\nA = 2*X*Z/(X+Z) R135\nB = 2*W*Z/(W+Z)\nC = 2*W*Y/(W+Y) R45\nD = 2*X*Y/(X+Y) R-D\n\n!draw(arc(origin, 1, 40, 180), dashed+orange);\n\nincircle A B C 0.1 lightred / red\nincircle A D C 0.1 lightred / red\nA--B--C--D--cycle 0.1 yellow / orange\nA--C red\n\nI_B := incenter A B C\nI_D := incenter A D C\nP = foot I_B A C R270\nQ = 2*I_B-P 0.8R95\nT = foot I_D A C R45\nS = 2*I_D-T R225\n\nA--Z orange\nC--W orange\nE := 2*Y*Z/(Y+Z)\nF := 2*X*W/(X+W)\nE--D--F orange\n\nK = extension B Q D P R315\nB--K--P dashed red\nP--Q red\nS--T red\n\n*/\n\\end{asy}\n\\end{center}\n\nConsequently, a homothety at $B$ maps $Q$, $T$, $K$ to each other\n(since $T$ is the uppermost of the excircle, $Q$ of the incircle).\nSimilarly, a homothety at $D$ maps $P$, $S$, $K$ to each other.\nAs $\\ol{PQ}$ and $\\ol{ST}$ are parallel diameters\nit then follows $K$ is the exsimilicenter of $\\omega_1$ and $\\omega_2$.\n\\pagebreak\n\n\n\\end{document}", "category": "Geometry", "source": "IMO", "year": 2008}
{"id": "usamo-2004-q1", "question": "Let $ABCD$ be a quadrilateral circumscribed about a circle,\nwhose interior and exterior angles are at least $60$ degrees.\nProve that\n\\[ \\frac{1}{3}|AB^3 - AD^3|\n  \\le |BC^3 - CD^3| \\le 3|AB^3 - AD^3|.  \\]\nWhen does equality hold?", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p17439}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABCD$ be a quadrilateral circumscribed about a circle,\nwhose interior and exterior angles are at least $60$ degrees.\nProve that\n\\[ \\frac{1}{3}|AB^3 - AD^3|\n  \\le |BC^3 - CD^3| \\le 3|AB^3 - AD^3|.  \\]\nWhen does equality hold?\n\\end{mdframed}\nClearly it suffices to show the left inequality.\nSince $AB+CD = BC+AD \\implies |AB-AD| = |BC-CD|$, it suffices to prove\n\\[ \\frac13(AB^2 + AB \\cdot AD + AD^2)\n\\le BC^2 + BC \\cdot CD + CD^2. \\]\nThis follows by noting that\n\\begin{align*}\n  BC^2 + BC \\cdot CD + CD^2\n  &\\ge BC^2 + CD^2 - 2(BC)(CD)\\cos(\\angle BCD) \\\\\n  &= BD^2 \\\\\n  &= AB^2 + AD^2 - 2(AB)(AD)\\cos(\\angle BAD) \\\\\n  &\\ge AB^2 + AD^2 - AB \\cdot AD \\\\\n  &\\ge \\tfrac13(AB^2 + AD^2 + AB \\cdot AD)\n\\end{align*}\nthe last line following by AM-GM.\n\nThe equality holds iff $ABCD$ is a kite with $AB=AD$, $CB=CD$.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2004}
{"id": "usamo-2004-q2", "question": "Let $a_1$, $a_2$, \\dots, $a_n$ be integers whose greatest common\ndivisor is $1$.\nLet $S$ be a set of integers with the following properties:\n\\begin{enumerate}\n  \\ii[(a)] $a_i \\in S$ for $i = 1, \\dots, n$.\n  \\ii[(b)] $a_i - a_j \\in S$ for $i, j = 1, \\dots, n$,\n  not necessarily distinct.\n  \\ii[(c)] If $x, y \\in S$ and $x+y \\in S$,\n  then $x-y \\in S$ too.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p17440}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a_1$, $a_2$, \\dots, $a_n$ be integers whose greatest common\ndivisor is $1$.\nLet $S$ be a set of integers with the following properties:\n\\begin{enumerate}\n  \\ii[(a)] $a_i \\in S$ for $i = 1, \\dots, n$.\n  \\ii[(b)] $a_i - a_j \\in S$ for $i, j = 1, \\dots, n$,\n  not necessarily distinct.\n  \\ii[(c)] If $x, y \\in S$ and $x+y \\in S$,\n  then $x-y \\in S$ too.\n\\end{enumerate}\nProve that $S = \\ZZ$.\n\\end{mdframed}\nThe idea is to show any linear combination of the $a_i$ are in $S$,\nwhich implies (by Bezout) that $S = \\ZZ$.\nThis is pretty intuitive, but the details require some care\n(in particular there is a parity obstruction at the second lemma).\n\nFirst, we make the following simple observations:\n\\begin{itemize}\n  \\ii $0 \\in S$, by putting $i=j=1$ in (b).\n  \\ii $s \\in S \\iff -s \\in S$, by putting $x=0$ in (c).\n\\end{itemize}\n\nNow, we prove that:\n\\begin{lemma*}\n  For any integers $c$, $d$, and indices $i$, $j$,\n  we have $ca_i + da_j \\in S$.\n\\end{lemma*}\n\\begin{proof}\n  We will assume $c,d > 0$ since the other cases are analogous.\n  In that case it follows by induction on $c+d$;\n  for example $ca_i + (d-1)a_j$, $a_j$, $ca_i + da_j$ in $S$\n  implies $ca_i + (d+1)a_j \\in S$.\n\\end{proof}\n\n\\begin{lemma*}\n  For any nonzero integers $c_1$, $c_2$, \\dots, $c_m$,\n  and any distinct indices $\\{i_1 , i_2 , \\dots , i_m\\}$, we have\n  \\[ \\sum_k c_k a_{i_k} \\in S. \\]\n\\end{lemma*}\n\\begin{proof}\n  By induction on $m$, with base case $m \\le 2$ already done.\n\n  For the inductive step,\n  we will assume that $i_1 = 1$, $i_2 = 2$, et cetera,\n  for notational convenience.\n  The proof is then split into two cases.\n\n\n  \\emph{First Case}: some $c_i$ is even.\n  WLOG $c_1 \\neq 0$ is even and note that\n  \\begin{align*}\n    x &\\coloneq \\half c_1 a_1 + \\sum_{k \\ge 3} c_k a_k \\in S \\\\\n    y &\\coloneq -\\half c_1 a_1 - c_2 a_2 \\in S \\\\\n    x+y &= -c_2 a_2 + \\sum_{k \\ge 3} c_k a_k \\in S \\\\\n    \\implies x-y &= \\sum_{k \\ge 1} c_k a_k \\in S.\n  \\end{align*}\n\n\n  \\emph{Second Case}: all $c_i$ are odd.\n  We reduce this to the first case as follows.\n  Let $u = \\frac{a_1}{\\gcd(a_1, a_2)}$ and $v = \\frac{a_2}{\\gcd(a_1, a_2)}$.\n  Then $\\gcd(u,v) = 1$ and so WLOG $u$ is odd.\n  Then\n  \\[\n    c_1 a_1 + c_2 a_2\n    = (c_1 + v)a_1 + (c_2 - u) a_2\n  \\]\n  and so we can replace our given combination\n  by $(c_1+v)a_1 + (c_2-u)a_2 + c_3a_3 + \\dots$\n  which now has an even coefficient for $a_2$.\n\\end{proof}\n\nWe then apply the lemma at $m = n$;\nthis implies the result since Bezout's lemma\nimplies that $\\sum c_i a_i = 1$ for some choice of $c_i \\in \\ZZ$.\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 2004}
{"id": "usamo-2004-q3", "question": "For what real values of $k > 0$ is it possible to\ndissect a $1 \\times k$ rectangle into two similar but noncongruent polygons?", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p17441}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFor what real values of $k > 0$ is it possible to\ndissect a $1 \\times k$ rectangle into two similar but noncongruent polygons?\n\\end{mdframed}\nAnswer: the dissection is possible for every $k > 0$ except for $k = 1$.\n\n\\paragraph{Construction.}\nBy symmetry it suffices to give a construction for $k > 1$\n(since otherwise we replace $k$ by $k\\inv$).\nFor every integer $n \\ge 2$ and real number $r > 1$,\nwe define a shape $\\mathcal R(n,r)$ as follows.\n\\begin{itemize}\n  \\ii We start with a rectangle of width $1$ and height $r$.\n  To its left, we glue a rectangle of height $r$ and width $r^2$ to its left.\n  \\ii Then, we glue a rectangle of width $1+r^2$ and height $r^3$ below our figure,\n  followed by a rectangle of height $r+r^3$ and width $r^4$ to the left of our figure.\n  \\ii Next, we glue a rectangle of width $1+r^2+r^4$ and height $r^5$ below our figure,\n  followed by a rectangle of height $r+r^3+r^5$ and width $r^6$ to the left of our figure.\n\\end{itemize}\n\\dots and so on, up until we have put $2n$ rectangles together.\nThe picture $\\mathcal R(3,r)$ is shown below as an example.\n\\begin{center}\n\\begin{asy}\nsize(8cm);\ndefaultpen(fontsize(10pt));\n\nreal r = 1.6;\n\npair A = (0,r^3+r);\npair B = (r^4,r^3+r);\npair C = (r^4+r^2,r^3+r);\npair D = (r^4+r^2+1,r^3+r);\npair E = (r^4,r^3);\npair F = (r^4+r^2, r^3);\npair G = (r^4+r^2+1, r^3);\npair O = (0,0);\npair H = (r^4,0);\npair I = (r^4+r^2+1,0);\npair W = (-r^6, A.y);\npair X = (W.x,-r^5);\npair Y = (0,-r^5);\npair Z = (I.x,-r^5);\n\npen p = black+1.3;\npen q = red;\nfill(O--A--B--H--cycle, palecyan);\nfill(B--C--F--E--cycle, palecyan);\nfill(W--A--Y--X--cycle, palecyan);\nfill(C--D--G--F--cycle, palegreen);\nfill(E--G--I--H--cycle, palegreen);\nfill(O--Y--Z--I--cycle, palegreen);\n\ndraw(O--A, q);\ndraw(B--E, q);\ndraw(F--G, q);\ndraw(H--I, q);\ndraw(W--D--Z--X--cycle, p);\ndraw(C--F--E--H--O--Y, p);\n\nlabel(\"$1$\", (C+D)/2, dir(90));\nlabel(\"$r^2$\", (B+C)/2, dir(90));\nlabel(\"$r^4$\", (A+B)/2, dir(90));\nlabel(\"$r^6$\", (W+A)/2, dir(90));\n\nlabel(\"$r^1$\", (D+G)/2, dir(0));\nlabel(\"$r^3$\", (G+I)/2, dir(0));\nlabel(\"$r^5$\", (I+Z)/2, dir(0));\n\\end{asy}\n\\end{center}\nObserve that by construction,\nthe entire shape $\\mathcal R(n,r)$ is a rectangle\nwhich consists of two similar ``staircase'' polygons\n(which are not congruent, since $r>1$).\nNote that $\\mathcal R(n,r)$ is similar to a $1 \\times f_n(r)$ rectangle\nwhere $f_n(r)$ is the aspect ratio of $\\mathcal R(n,r)$, defined by\n\\[ f_n(r) = \\frac{1+r^2+\\dots+r^{2n}}{r+r^3+\\dots+r^{2n-1}}\n  = r + \\frac{1}{r+r^3+\\dots+r^{2n-1}}.  \\]\n\nWe claim that this is enough.\nIndeed for each fixed $n$, note that\n\\[ \\lim_{r \\to 1^+} f_n(r) = 1 + \\frac1n\n  \\; \\text{ and } \\;\n  \\lim_{r \\to \\infty} f_n(r) = \\infty. \\]\nSince $f_n$ is continuous, it achieves all values greater than $1+\\frac1n$.\nThus by taking sufficiently large $n$ (such that $k > 1+\\frac1n$),\nwe obtain a valid construction for any $k > 1$.\n\n\\paragraph{Proof of impossibility for a square.}\nNow we show that $k = 1$ is impossible (the tricky part!).\nSuppose we have a squared dissected into\ntwo similar polygons $\\mathcal P \\sim \\mathcal Q$.\nLet $\\Gamma$ be their common boundary.\nBy counting the number of sides of $\\mathcal P$ and $\\mathcal Q$\nwe see $\\Gamma$ must run from one side of the square to an opposite side\n(possibly ending at a corner of the square).\nWe orient the figure so $\\Gamma$ runs from north to south,\nwith $\\mathcal P$ to the west and $\\mathcal Q$ to the east.\n\\begin{center}\n\\begin{asy}\nsize(4cm);\npair A = (0,0);\npair B = (1,0);\npair C = (1,1);\npair D = (0,1);\npair W = (0.4,0);\npair X = (0.3,0.7);\npair Y = (0.7,0.3);\npair Z = (0.6,1);\nfilldraw(A--W--X--Y--Z--D--cycle, palecyan, black);\nfilldraw(B--W--X--Y--Z--C--cycle, palegreen, black);\ndraw( W--X--Y--Z, black+1 );\nlabel(\"$\\Gamma$\", Y, dir(15));\nlabel(\"$\\mathcal P$\", (0.1,0.5), blue);\nlabel(\"$\\mathcal Q$\", (0.9,0.5), deepgreen);\n\\end{asy}\n\\end{center}\n\nLet $s$ be the longest length of a segment in $\\Gamma$.\n\\begin{claim*}\n  The longest side length of $\\mathcal P$ is $\\max(s,1)$.\n  Similarly, the longest side length of $\\mathcal Q$ is $\\max(s,1)$ as well.\n\\end{claim*}\n\\begin{proof}\n  The only edges of $\\mathcal P$ not in $\\Gamma$\n  are the west edge of our original square, which has length $1$,\n  and the north/south edges of $\\mathcal P$ (if any),\n  which have length at most $1$.\n  An identical argument works for $\\mathcal Q$.\n\\end{proof}\nIt follows the longest sides of $\\mathcal P$ and $\\mathcal Q$ have the same length!\nHence the two polygons are in fact congruent, ending the proof.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Geometry", "source": "USAMO", "year": 2004}
{"id": "usamo-2004-q4", "question": "Alice and Bob play a game on a $6$ by $6$ grid.\nOn his turn, a player chooses a rational number not yet appearing in the grid\nand writes it in an empty square of the grid.\nAlice goes first and then the players alternate.\nWhen all squares have numbers written in them, in each row,\nthe square with the greatest number in that row is colored black.\nAlice wins if he can then draw a line from the top of the grid to the bottom of the grid\nthat stays in black squares, and Bob wins if he can't.\n(If two squares share a vertex,\nAlice can draw a line from one to the other that stays in those two squares.)\nFind, with proof, a winning strategy for one of the players.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p17438}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nAlice and Bob play a game on a $6$ by $6$ grid.\nOn his turn, a player chooses a rational number not yet appearing in the grid\nand writes it in an empty square of the grid.\nAlice goes first and then the players alternate.\nWhen all squares have numbers written in them, in each row,\nthe square with the greatest number in that row is colored black.\nAlice wins if he can then draw a line from the top of the grid to the bottom of the grid\nthat stays in black squares, and Bob wins if he can't.\n(If two squares share a vertex,\nAlice can draw a line from one to the other that stays in those two squares.)\nFind, with proof, a winning strategy for one of the players.\n\\end{mdframed}\nBob can win.\nLabel the first two rows as follows:\n\\[\n  \\begin{bmatrix}\n    a & b & c & d & e & f \\\\\n    d' & e' & f' & a' & b' & c'\n  \\end{bmatrix}\n\\]\nThese twelve boxes thus come in six \\emph{pairs}, $(a, a')$, $(b, b')$ and so on.\n\n\\begin{claim*}\n  Bob can ensure that the order relation\n  of the labels is the same between the two rows,\n  meaning that $a < b$ if and only if $a' < b'$, and so on.\n\\end{claim*}\n\\begin{proof}\n  If Alice plays $q$ in some box in the first two rows, then Bob can plays $q + \\eps$\n  in the corresponding box in the same pair, for some sufficiently small $\\eps$\n  (in terms of the existing numbers).\n\n  When Alice writes a number in any other row, Bob writes anywhere in rows $3$ to $6$.\n\\end{proof}\n\nUnder this strategy the black squares in the first two rows will be a pair\nand therefore will not touch, so Bob wins.\n\\pagebreak", "category": "Combinatorics", "source": "USAMO", "year": 2004}
{"id": "usamo-2004-q5", "question": "Let $a$, $b$, $c$ be positive reals.\nProve that\n\\[ ( a^5-a^2+3 )( b^5-b^2+3 )( c^5-c^2+3 )\n  \\ge \\left( a+b+c \\right)^3. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p17397}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a$, $b$, $c$ be positive reals.\nProve that\n\\[ ( a^5-a^2+3 )( b^5-b^2+3 )( c^5-c^2+3 )\n  \\ge \\left( a+b+c \\right)^3. \\]\n\\end{mdframed}\nObserve that for all real numbers $a$, the inequality\n\\[ a^5-a^2+3 \\ge a^3+2 \\]\nholds.\nThen the problem follows by H\\\"{o}lder in the form\n\\[ (a^3+1+1)(1+b^3+1)(1+1+c^3) \\ge (a+b+c)^3. \\]\n\\pagebreak", "category": "Algebra", "source": "USAMO", "year": 2004}
{"id": "usamo-2004-q6", "question": "A circle $\\omega$ is inscribed in a quadrilateral $ABCD$.\nLet $I$ be the center of $\\omega$.\nSuppose that \\[ (AI + DI)^2 + (BI + CI)^2 = (AB + CD)^2.  \\]\nProve that $ABCD$ is an isosceles trapezoid.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p17437}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA circle $\\omega$ is inscribed in a quadrilateral $ABCD$.\nLet $I$ be the center of $\\omega$.\nSuppose that \\[ (AI + DI)^2 + (BI + CI)^2 = (AB + CD)^2.  \\]\nProve that $ABCD$ is an isosceles trapezoid.\n\\end{mdframed}\nHere's a completely algebraic solution.\nWLOG $\\omega$ has radius $1$, and let $a$, $b$, $c$, $d$ be the\nlengths of the tangents from $A$, $B$, $C$, $D$ to $\\omega$.\nIt is known that\n\\[ a+b+c+d = abc+bcd+cda+dab \\qquad (\\star) \\]\nwhich can be proved by, say $\\tan$-addition formula.\nThen, the content of the problem is to show that\n\\[\n  (\\sqrt{a^2+1}+\\sqrt{d^2+1})^2\n  + (\\sqrt{b^2+1}+\\sqrt{c^2+1})^2\n  \\le (a+b+c+d)^2\n\\]\nsubject to $(\\star)$,\nwith equality only when $a=d=\\tfrac1b=\\tfrac1c$.\n\nLet $S = ab+bc+cd+da+ac+bd$. Then the inequality is\n\\[ \\sqrt{(a^2+1)(d^2+1)} + \\sqrt{(b^2+1)(c^2+1)} \\le S - 2. \\]\nNow, by \\textbf{USAMO 2014 Problem 1} and the condition $(\\star)$,\nwe have that $(a^2+1)(b^2+1)(c^2+1)(d^2+1) = (S - abcd - 1)^2$.\nSo squaring both sides, the inequality becomes\n\\[ (ad)^2+(bc)^2 + a^2+b^2+c^2+d^2 \\le S^2 - 6S + 2abcd + 4. \\]\nTo simplify this, we use the identities\n\\begin{align*}\n  S^2 &= 6abcd + \\sum_{\\text{sym}} a^2bc\n    + \\frac14\\sum_{\\text{sym}} a^2b^2 \\\\\n  (a+b+c+d)^2 &= (abc+bcd+cda+dab)(a+b+c+d) \\\\\n  &= 4abcd + \\frac12\\sum_{\\text{sym}} a^2bc\n\\end{align*}\nSo $S^2+2abcd = \\frac14\\textstyle\\sum_{\\text{sym}}\n  a^2b^2 + 2(a^2+b^2+c^2+d^2) + 4S$\nand the inequality we want to prove reduces to\n\\[ 2S \\le (ab)^2+(ac)^2+(bd)^2+(cd)^2 + 4 + a^2 + b^2 + c^2 + d^2. \\]\nThis follows by AM-GM since\n\\begin{align*}\n  (ab)^2 + 1 &\\ge 2ab \\\\\n  (ac)^2 + 1 &\\ge 2ac \\\\\n  (bd)^2 + 1 &\\ge 2bd \\\\\n  (cd)^2 + 1 &\\ge 2cd \\\\\n  a^2 + d^2 &\\ge 2ad \\\\\n  b^2 + c^2 &\\ge 2bc.\n\\end{align*}\nThe equality case is when $ab=ac=bd=cd=1$, $a=d$, $b=c$,\nas needed to imply an isosceles trapezoid.\n\n\\begin{remark*}\nNote that a priori one expects an inequality.\nIndeed,\n\\begin{itemize}\n  \\ii Quadrilaterals with incircles have four degrees of freedom.\n  \\ii There is one condition imposed.\n  \\ii Isosceles trapezoid with incircles have two degrees of freedom.\n\\end{itemize}\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Geometry", "source": "USAMO", "year": 2004}
{"id": "egmo-2017-q1", "question": "Let $ABCD$ be a convex quadrilateral\nwith $\\angle DAB = \\angle BCD = 90\\dg$ and $\\angle ABC > \\angle CDA$.\nLet $Q$ and $R$ be points on segments $BC$ and $CD$,\nrespectively, such that line $QR$ intersects lines $AB$ and $AD$\nat points $P$ and $S$, respectively.\nIt is given that $PQ=RS$.\nLet the midpoint of $BD$ be $M$ and the midpoint of $QR$ be $N$.\nProve that the points $M$, $N$, $A$ and $C$ lie on a circle.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p8024554}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABCD$ be a convex quadrilateral\nwith $\\angle DAB = \\angle BCD = 90\\dg$ and $\\angle ABC > \\angle CDA$.\nLet $Q$ and $R$ be points on segments $BC$ and $CD$,\nrespectively, such that line $QR$ intersects lines $AB$ and $AD$\nat points $P$ and $S$, respectively.\nIt is given that $PQ=RS$.\nLet the midpoint of $BD$ be $M$ and the midpoint of $QR$ be $N$.\nProve that the points $M$, $N$, $A$ and $C$ lie on a circle.\n\\end{mdframed}\nThe condition is equivalent to $N$ being the midpoint\nof both $\\ol{PS}$ and $\\ol{QR}$ simultaneously.\n(Thus triangles $BAD$ and $BCD$ play morally dual roles.)\n\n\\begin{center}\n\\begin{asy}\nimport graph; size(12cm);\npen zzttqq = rgb(0.6,0.2,0.); pen cqcqcq = rgb(0.75294,0.75294,0.75294);\ndraw((-1.83576,5.20298)--(-4.,1.5)--(-0.44779,-2.69232)--(4.5,1.5)--cycle, linewidth(0.6) + zzttqq);\n\ndraw(circle((0.25,1.5), 4.25), linewidth(0.6));\ndraw((-5.40339,-0.90118)--(6.45435,0.35776), linewidth(0.6));\ndraw((-1.83576,5.20298)--(-4.,1.5), linewidth(0.6) + zzttqq);\ndraw((-4.,1.5)--(-0.44779,-2.69232), linewidth(0.6) + zzttqq);\ndraw((-0.44779,-2.69232)--(4.5,1.5), linewidth(0.6) + zzttqq);\ndraw((4.5,1.5)--(-1.83576,5.20298), linewidth(0.6) + zzttqq);\ndraw((-4.,1.5)--(-5.40339,-0.90118), linewidth(0.6));\ndraw((4.5,1.5)--(6.45435,0.35776), linewidth(0.6));\ndot(\"$D$\", (4.5,1.5), dir(40));\ndot(\"$B$\", (-4.,1.5), dir(180));\ndot(\"$M$\", (0.25,1.5), dir(90));\ndot(\"$A$\", (-1.83576,5.20298), dir(130));\ndot(\"$C$\", (-0.44779,-2.69232), dir(270));\ndot(\"$Q$\", (-2.24919,-0.56630), dir(80));\ndot(\"$R$\", (2.67884,-0.04308), dir(135));\ndot(\"$P$\", (-5.40339,-0.90118), dir(270));\ndot(\"$S$\", (6.45435,0.35776), dir(270));\ndot(\"$N$\", (0.21482,-0.30469), dir(80));\n\\end{asy}\n\\end{center}\n\nThe rest is angle chasing.\nWe have\n\\begin{align*}\n  \\dang ANC &= \\dang ANP + \\dang QNC \\\\\n  &= 2\\dang ASP + 2\\dang QRC \\\\\n  &= 2 \\dang DSR + 2 \\dang DRS = 2 \\dang RDS \\\\\n  &= 2 \\dang ADC = \\dang AMC.\n\\end{align*}\n\\pagebreak", "category": "Geometry", "source": "EGMO", "year": 2017}
{"id": "egmo-2017-q2", "question": "Find the smallest positive integer $k$ for which\nthere exists a coloring of the positive integers\n$\\ZZ_{>0}$ with $k$ colors and a function $f \\colon \\ZZ_{>0} \\to \\ZZ_{>0}$\nwith the following two properties:\n\\begin{enumerate}[(i)]\n  \\ii For all positive integers $m$, $n$ of the same color,\n  $f(m+n)=f(m)+f(n)$.\n  \\ii There are positive integers $m$, $n$\n  such that $f(m+n) \\neq f(m)+f(n)$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p8024575}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind the smallest positive integer $k$ for which\nthere exists a coloring of the positive integers\n$\\ZZ_{>0}$ with $k$ colors and a function $f \\colon \\ZZ_{>0} \\to \\ZZ_{>0}$\nwith the following two properties:\n\\begin{enumerate}[(i)]\n  \\ii For all positive integers $m$, $n$ of the same color,\n  $f(m+n)=f(m)+f(n)$.\n  \\ii There are positive integers $m$, $n$\n  such that $f(m+n) \\neq f(m)+f(n)$.\n\\end{enumerate}\n\\end{mdframed}\nAnswer: $k=3$.\n\nConstruction for $k=3$:\nlet\n\\[ f(n) =\n  \\begin{cases} n/3 & n\\equiv 0 \\pmod 3 \\\\\n  n & \\text{else} \\end{cases} \\]\nand color the integers modulo $3$.\n\nNow we prove that for $k=2$ a function $f$ obeying (i) must be linear,\neven if $f \\colon \\ZZ_{>0} \\to \\RR_{>0}$.\nCall the colors blue/red and WLOG $f(1) = 1$.\n\nFirst, we obviously have:\n\\begin{claim*}\n  $f(2n) = 2f(n)$ for every $n$.\n\\end{claim*}\n\nNow we proceed by induction in the following way.\nAssume that $f(1) = 1$, $f(2) = 2$, \\dots, $f(2n) = 2n$.\nFor brevity let $m = 2n+1$ be red\nand assume for contradiction that $f(m) \\neq m$.\n\nThe proof now proceeds in four steps.\nFirst:\n\\begin{itemize}\n  \\ii The number $m-2$ must be blue.\n  Indeed if $m-2$ was red we would have $f(2m-2) = f(m) + f(m-2)$\n  which is a contradiction as $f(2m-2) = 2f(m-1) = 2m-2$ and $f(m-2)=m-2$.\n\n  \\ii The number $2$ must be red.\n  Indeed if it was blue then $f(m) = f(2) + f(m-2) = m$ contradiction.\n\\end{itemize}\nObserve then that $f(m+2) = f(m)+2$ since $m$ and $2$ are both red.\nNow we consider two cases:\n\\begin{itemize}\n  \\ii If $m+2$ is red, then\n  $f(2m+2) = f(m+2) + f(m) = (f(m) + 2) + f(m)$.\n  But $f(2m+2) = f(4n+4) = 4f(n+1) = 2m+2$, contradiction.\n\n  \\ii If $m+2$ is blue,\n  then $2f(m) = f(2m) = f(m+2) + f(m-2) = f(m) + 2 + (m-2)$.\n  So then $f(m) = m$ again a contradiction.\n\\end{itemize}\n\nSo $f(m) = m$, which completes the induction.\n\\pagebreak", "category": "Combinatorics", "source": "EGMO", "year": 2017}
{"id": "egmo-2017-q3", "question": "There are $2017$ lines in the plane such that\nno three of them go through the same point.\nTurbo the snail sits on a point on exactly one of the lines\nand starts sliding along the lines in the following fashion:\nshe moves on a given line until she reaches an intersection of two lines.\nAt the intersection, she follows her journey\non the other line turning left or right,\nalternating her choice at each intersection point she reaches.\nShe can only change direction at an intersection point.\nCan there exist a line segment through which she passes\nin both directions during her journey?", "solution": "", "category": "Geometry", "source": "EGMO", "year": 2017}
{"id": "egmo-2017-q4", "question": "Let $n\\geq1$ be an integer and let $t_1<t_2<\\dots<t_n$ be positive integers.\nIn a group of $t_n+1$ people, some games of chess are played.\nTwo people can play each other at most once.\nProve that it is possible for the following two conditions to hold at the same time:\n\\begin{enumerate}[(i)]\n  \\ii The number of games played by each person is one of $t_1,t_2,\\dots,t_n$.\n  \\ii For every $i$ with $1\\leq i\\leq n$,\n  there is someone who has played exactly $t_i$ games of chess.", "solution": "", "category": "Combinatorics", "source": "EGMO", "year": 2017}
{"id": "egmo-2017-q5", "question": "An $n$-tuple $(a_1,a_2,\\dots,a_n)$ of positive integers is \\emph{expensive} if\n\\[ (a_1+a_2)(a_2+a_3)\\dots(a_{n-1}+a_n)(a_n+a_1) = 2^{2k-1} \\]\nfor some positive integer $k$.\n\\begin{enumerate}\n  \\ii[(a)] Find all integers $n \\ge 2$ for which there exists an expensive $n$-tuple.\n  \\ii[(b)] Prove that each odd integer $m \\ge 1$\n  appears in an expensive $n$-tuple for some $n \\ge 2$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p8029376}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nAn $n$-tuple $(a_1,a_2,\\dots,a_n)$ of positive integers is \\emph{expensive} if\n\\[ (a_1+a_2)(a_2+a_3)\\dots(a_{n-1}+a_n)(a_n+a_1) = 2^{2k-1} \\]\nfor some positive integer $k$.\n\\begin{enumerate}\n  \\ii[(a)] Find all integers $n \\ge 2$ for which there exists an expensive $n$-tuple.\n  \\ii[(b)] Prove that each odd integer $m \\ge 1$\n  appears in an expensive $n$-tuple for some $n \\ge 2$.\n\\end{enumerate}\n\\end{mdframed}\nFor part (a), the answer is odd $n$,\nwith construction given by setting $a_1 = \\dots = a_n = 1$.\nWe show by induction that even $n$ all fail,\nwith $n=2$ being plain.\n\nConstruct a regular $n$-gon whose vertices are labeled $a_i$\nand edges are labeled with $a_i + a_j$.\n\\begin{center}\n\\begin{asy}\n  size(5cm);\n  int[] x = {1,3,13,3,1,7,9,7,1,1}; // repeat last guy\n  for (int i=0; i<9; ++i) {\n    dot( (string) x[i], dir(40*i), dir(40*i), darkcyan);\n    draw(dir(40*i)--dir(40*i+40), darkcyan);\n    label( (string) (x[i] + x[i+1]),\n    midpoint(dir(40*i)--dir(40*i+40)), dir(40*i+20), red);\n  }\n\\end{asy}\n\\end{center}\nThen we observe that it's impossible for an edge to exceed\nboth of its neighbors,\nsince if $a+b = 2^e$ then $\\min(a+1, b+1) > 2^{e-1}$.\nConsequently we can take two adjacent edges $a+b = b+c$\nwith the same label; hence $a = c$.\nThen delete $b$, $c$ and induct down.\n\nFor part (b), for odd integers $m$, let $f(m)$ denote $2^k - m$\nwhere $2^k$ is the smallest power of two exceeding $m$.\nNote $f(m) \\le m$ with equality if and only if $m = 1$.\nSo repeatedly apply $f$ until we wrap around;\nthis gives twice a square of a power of two.\nExample when $m = 13$:\n\\begin{center}\n\\begin{asy}\n  size(4cm);\n  int[] x = {13,3,1,1,3,13}; // repeat last guy\n  for (int i=0; i<5; ++i) {\n    dot( (string) x[i], dir(72*i), dir(72*i), darkcyan);\n    draw(dir(72*i)--dir(72*i+72), darkcyan);\n    label( (string) (x[i] + x[i+1]),\n    midpoint(dir(72*i)--dir(72*i+72)), dir(72*i+36), red);\n  }\n\\end{asy}\n\\end{center}\n\n\\begin{remark*}\n  By applying the process of (a) in reverse,\n  one essentially finds an inductive characterization\n  of all expensive $n$-tuples.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "EGMO", "year": 2017}
{"id": "egmo-2017-q6", "question": "Let $ABC$ be an acute scalene triangle.\nThe reflections of the centroid $G$ and the circumcenter $O$ of $ABC$ in its sides $BC$, $CA$, $AB$\nare denoted by $G_1$, $G_2$, $G_3$ and $O_1$, $O_2$, $O_3$, respectively.\nShow that the circumcircles of triangles $G_1G_2C$, $G_1G_3B$, $G_2G_3A$,\n$O_1O_2C$, $O_1O_3B$, $O_2O_3A$ and $ABC$ have a common point.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p8029388}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be an acute scalene triangle.\nThe reflections of the centroid $G$ and the circumcenter $O$ of $ABC$ in its sides $BC$, $CA$, $AB$\nare denoted by $G_1$, $G_2$, $G_3$ and $O_1$, $O_2$, $O_3$, respectively.\nShow that the circumcircles of triangles $G_1G_2C$, $G_1G_3B$, $G_2G_3A$,\n$O_1O_2C$, $O_1O_3B$, $O_2O_3A$ and $ABC$ have a common point.\n\\end{mdframed}\nHere is an approach with complex numbers.\nLet $P$ be an arbitrary point.\nLet $P_B$ and $P_C$ be the reflections of $P$ across $AB$ and $AC$\nand let $Q_B$ and $Q_C$ be the second intersections of\nlines $AP_B$ and $AP_C$ with the circumcircle.\nThen we will compute the intersection of\n$(A P_B P_C)$ and $(A Q_B Q_C) \\equiv (ABC)$.\n\nWe have $p_B = a+c-ac\\ol p$, $p_C = a+b-ab\\ol p$.\nTo compute $q_B$ note that\n\\begin{align*}\n  a+q_B &= p_B + a q_B \\ol{p_B} \\\\\n  &= a+c-ac\\ol p + aq_B \\left( 1/a + 1/c - p/ac \\right) \\\\\n  \\implies ac\\ol p - c &= (a/c-p/c) q_B \\\\\n  \\implies q_B &= c^2 \\frac{a\\ol p -1}{a-p}.\n\\end{align*}\nSimilarly $q_C = b^2 \\frac{a \\ol p - 1}{a-p}$.\nThen, the desired intersection is\n\\begin{align*}\n  \\frac{p_B q_C - p_C q_B}{p_B - p_C + q_C - q_B}\n  &= \\frac{ \\left( \\frac{a \\ol p -1}{a-p} \\right)\n  \\left( b^2(a+c-ac \\ol p) - c^2 (a+b-ab\\ol p) \\right)}%\n  {(b-c)(a \\ol p-1) + (b^2-c^2) \\cdot \\frac{a \\ol p - 1}{a-p}} \\\\\n  &= \\frac{b^2(a+c-ac \\ol p) - c^2(a+b-ab\\ol p)}%\n  {(b-c)(a-p) + (b^2-c^2)} \\\\\n  &= \\frac{(b-c)(a(b+c)+bc) - (b-c) abc \\ol p}{(a-p)+(b+c)} \\\\\n  &= \\frac{ab+bc+ca - abc \\ol p}{a+b+c-p}\n\\end{align*}\nwhich is in any case symmetric in $a$, $b$, $c$.\nMoreover taking $p = \\frac13(a+b+c)$ and $p=0$\ngive the same numbers (and indeed any $p$ on the Euler line).\n\\pagebreak\n\n\n\\end{document}", "category": "Geometry", "source": "EGMO", "year": 2017}
{"id": "usamo-2000-q1", "question": "Call a real-valued function $f$ \\emph{very convex} if\n\\[ \\frac{f(x)+f(y)}{2}\n  \\ge f\\left( \\frac{x+y}{2} \\right) + \\left\\lvert x-y \\right\\rvert  \\]\nholds for all real numbers $x$ and $y$.\nProve that no very convex function exists.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p299244}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nCall a real-valued function $f$ \\emph{very convex} if\n\\[ \\frac{f(x)+f(y)}{2}\n  \\ge f\\left( \\frac{x+y}{2} \\right) + \\left\\lvert x-y \\right\\rvert  \\]\nholds for all real numbers $x$ and $y$.\nProve that no very convex function exists.\n\\end{mdframed}\nFor $C \\ge 0$, we say a function $f$ is \\emph{$C$-convex}\n\\[ \\frac{f(x)+f(y)}{2}\n  \\ge f\\left( \\frac{x+y}{2} \\right) + C\\left\\lvert x-y \\right\\rvert. \\]\n\nSuppose $f$ is $C$-convex.\nLet $a < b < c < d < e$ be any arithmetic progression,\nsuch that $t = |e-a|$.\nObserve that\n\\begin{align*}\n  f(a) + f(c) &\\ge 2f(b) + C \\cdot \\half t \\\\\n  f(c) + f(e) &\\ge 2f(d) + C \\cdot \\half t \\\\\n  f(b) + f(d) &\\ge 2f(c) + C \\cdot \\half t\n\\end{align*}\nAdding the first two to twice the third gives\n\\[ f(a) + f(e) \\ge 2f(c) + 2C \\cdot t. \\]\nSo we conclude $C$-convex function is also $2C$-convex.\nThis is clearly not okay for $C > 0$.\n\\pagebreak", "category": "Algebra", "source": "USAMO", "year": 2000}
{"id": "usamo-2000-q2", "question": "Let $S$ be the set of all triangles $ABC$ for which\n\\[ 5 \\left( \\frac{1}{AP} + \\frac{1}{BQ} + \\frac{1}{CR} \\right)\n  - \\frac{3}{\\min\\{ AP, BQ, CR \\}} = \\frac{6}{r}, \\]\nwhere $r$ is the inradius and $P$, $Q$, $R$ are the points of tangency\nof the incircle with sides $AB$, $BC$, $CA$ respectively.\nProve that all triangles in $S$ are isosceles and similar to one another.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p338078}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $S$ be the set of all triangles $ABC$ for which\n\\[ 5 \\left( \\frac{1}{AP} + \\frac{1}{BQ} + \\frac{1}{CR} \\right)\n  - \\frac{3}{\\min\\{ AP, BQ, CR \\}} = \\frac{6}{r}, \\]\nwhere $r$ is the inradius and $P$, $Q$, $R$ are the points of tangency\nof the incircle with sides $AB$, $BC$, $CA$ respectively.\nProve that all triangles in $S$ are isosceles and similar to one another.\n\\end{mdframed}\nWe will prove the inequality\n\\[ \\frac{2}{AP} + \\frac{5}{BQ} + \\frac{5}{CR} \\ge \\frac 6r \\]\nwith equality when $AP : BQ : CR = 1 : 4 : 4$.\nThis implies the problem statement.\n\nLetting $x= AP$, $y = BQ$, $z = CR$, the inequality becomes\n\\[ \\frac2x + \\frac5y + \\frac5z \\ge 6\\sqrt{\\frac{x+y+z}{xyz}}. \\]\nSquaring both sides and collecting terms gives\n\\[\n  \\frac{4}{x^2} + \\frac{25}{y^2} + \\frac{25}{z^2} + \\frac{14}{yz}\n  \\ge \\frac{16}{xy} + \\frac{16}{xz}.\n\\]\nIf we replace $x=1/a$, $y=4/b$, $z=4/c$,\nthen it remains to prove the inequality\n\\[ 64a^2 + 25(b+c)^2 \\ge 64a(b+c) + 36bc \\]\nwhere equality holds when $a=b=c$.\nThis follows by two applications of AM-GM:\n\\begin{align*}\n  16 \\left( 4a^2 + (b+c)^2 \\right) &\\ge 64a(b+c) \\\\\n  9(b+c)^2 &\\ge 36bc.\n\\end{align*}\n\nAgain one can tell this is an inequality by counting\ndegrees of freedom.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2000}
{"id": "usamo-2000-q3", "question": "A game of solitaire is played with $R$ red cards,\n$W$ white cards, and $B$ blue cards.\nA player plays all the cards one at a time.\nWith each play he accumulates a penalty.\nIf he plays a blue card, then he is charged a penalty\nwhich is the number of white cards still in his hand.\nIf he plays a white card, then he is charged a penalty\nwhich is twice the number of red cards still in his hand.\nIf he plays a red card, then he is charged a penalty\nwhich is three times the number of blue cards still in his hand.\n\nFind, as a function of $R$, $W$, and $B$, the minimal total penalty\na player can amass and the number of ways in which this minimum can be achieved.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p338081}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA game of solitaire is played with $R$ red cards,\n$W$ white cards, and $B$ blue cards.\nA player plays all the cards one at a time.\nWith each play he accumulates a penalty.\nIf he plays a blue card, then he is charged a penalty\nwhich is the number of white cards still in his hand.\nIf he plays a white card, then he is charged a penalty\nwhich is twice the number of red cards still in his hand.\nIf he plays a red card, then he is charged a penalty\nwhich is three times the number of blue cards still in his hand.\n\nFind, as a function of $R$, $W$, and $B$, the minimal total penalty\na player can amass and the number of ways in which this minimum can be achieved.\n\\end{mdframed}\nThe minimum penalty is\n\\[ f(B,W,R) = \\min (BW, 2WR, 3RB) \\]\nor equivalently, the natural guess of\n``discard all cards of one color first''\nis actually optimal (though not necessarily unique).\n\nThis can be proven directly by induction.\nIndeed the base case $BWR = 0$\n(in which case zero penalty is clearly achievable).\nThe inductive step follows from\n\\[ f(B,W,R) = \\min\n  \\begin{cases}\n    f(B-1,W,R) + W \\\\\n    f(B,W-1,R) + 2R \\\\\n    f(B,W,R-1) + 3B.\n  \\end{cases}\n\\]\n\nIt remains to characterize the strategies.\nThis is an annoying calculation, so we just state the result.\n\\begin{itemize}\n  \\ii If any of the three quantities $BW$, $2WR$, $3RB$\n  is strictly smaller than the other three,\n  there is one optimal strategy.\n  \\ii If $BW = 2WR < 3RB$,\n  there are $W+1$ optimal strategies,\n  namely discarding from $0$ to $W$ white cards,\n  then discarding all blue cads.\n  (Each white card discarded still preserves $BW = 2WR$.)\n  \\ii If $2WR = 3RB < BW$,\n  there are $R+1$ optimal strategies,\n  namely discarding from $0$ to $R$ red cards,\n  and then discarding all white cards.\n  \\ii If $3RB = RB < 2WR$,\n  there are $B+1$ optimal strategies,\n  namely discarding from $0$ to $B$ blue cards,\n  and then discarding all red cards.\n  \\ii Now suppose $BW = 2WR = 3RB$.\n  Discarding a card of one color\n  ends up in exactly one of the previous three cases.\n  This gives an answer of $R+W+B$ strategies.\n\\end{itemize}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Combinatorics", "source": "USAMO", "year": 2000}
{"id": "usamo-2000-q4", "question": "Find the smallest positive integer $n$ such\nthat if $n$ squares of a $1000 \\times 1000$ chessboard are colored,\nthen there will exist three colored squares\nwhose centers form a right triangle with sides\nparallel to the edges of the board.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p338084}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind the smallest positive integer $n$ such\nthat if $n$ squares of a $1000 \\times 1000$ chessboard are colored,\nthen there will exist three colored squares\nwhose centers form a right triangle with sides\nparallel to the edges of the board.\n\\end{mdframed}\nThe answer is $n = 1999$.\n\nFor a construction with $n = 1998$,\ntake a punctured L as illustrated below (with $1000$ replaced by $4$):\n\\[ \\begin{bmatrix} 1 \\\\ 1 \\\\ 1 \\\\ & 1 & 1 & 1 \\end{bmatrix}. \\]\n\nWe now show that if there is no right triangle,\nthere are at most $1998$ tokens (colored squares).\nIn every column with more than two tokens,\nwe have token emit a bidirectional horizontal\ndeath ray (laser) covering its entire row:\nthe hypothesis is that the death ray won't hit any other tokens.\n\\begin{center}\n\\begin{asy}\nsize(6cm);\nfor (int i=1; i<=8; ++i) {\n  if ((i-1)*(i-3)*(i-5) != 0) draw( (0.5,i)--(8.5,i), red+1, Arrows(TeXHead) );\n  for (int j=1; j<=8; ++j) {\n    if ( (i-j)/2 == (i-j)#2 )\n      filldraw(shift(i-0.5,j-0.5)*unitsquare, opacity(0.2)+gray, gray);\n    else\n      draw(shift(i-0.5,j-0.5)*unitsquare, gray);\n  }\n}\n\ndraw( (3,2)--(3,7), blue);\ndraw( (5,4)--(5,8), blue);\nvoid token(pair P) { fill(circle(P, 0.2), black); }\ntoken( (1,1) );\ntoken( (2,1) );\ntoken( (3,2) );\ntoken( (3,6) );\ntoken( (3,7) );\ntoken( (4,1) );\ntoken( (5,4) );\ntoken( (5,8) );\ntoken( (6,5) );\ntoken( (7,3) );\ntoken( (8,1) );\n\\end{asy}\n\\end{center}\n\nAssume there are $n$ tokens and that $n > 1000$.\nThen obviously some column has more than two tokens,\nso at most $999$ tokens don't emit a death ray\n(namely, any token in its own column).\nThus there are at least $n-999$ death rays.\nOn the other hand, we can have at most $999$ death rays total\n(since it would not be okay for the whole board to have death rays,\nas some row should have more than two tokens).\nTherefore, $n \\le 999 + 999 = 1998$ as desired.\n\\pagebreak", "category": "Combinatorics", "source": "USAMO", "year": 2000}
{"id": "usamo-2000-q5", "question": "Let $A_1 A_2 A_3$ be a triangle,\nand let $\\omega_1$ be a circle in its plane\npassing through $A_1$ and $A_2$.\nSuppose there exists circles $\\omega_2$, $\\omega_3$, \\dots, $\\omega_7$\nsuch that for $k = 2, 3, \\dots, 7,$\ncircle $\\omega_k$ is externally tangent to $\\omega_{k-1}$ and passes\nthrough $A_k$ and $A_{k+1}$ (indices mod $3$).\nProve that $\\omega_7 = \\omega_1$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p338089}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $A_1 A_2 A_3$ be a triangle,\nand let $\\omega_1$ be a circle in its plane\npassing through $A_1$ and $A_2$.\nSuppose there exists circles $\\omega_2$, $\\omega_3$, \\dots, $\\omega_7$\nsuch that for $k = 2, 3, \\dots, 7,$\ncircle $\\omega_k$ is externally tangent to $\\omega_{k-1}$ and passes\nthrough $A_k$ and $A_{k+1}$ (indices mod $3$).\nProve that $\\omega_7 = \\omega_1$.\n\\end{mdframed}\nThe idea is to keep track of the subtended arc\n$\\widehat{A_i A_{i+1}}$ of $\\omega_i$ for each $i$.\nTo this end, let $\\beta = \\dang A_1 A_2 A_3$,\n$\\gamma = \\dang A_2 A_3 A_1$\nand $\\alpha = \\dang A_1 A_2 A_3$.\n\n\\begin{center}\n\\begin{asy}\nsize(8cm);\ndefaultpen(fontsize(9pt));\npair A2 = (0,0);\npair O1 = (-8,0);\npair O2 = (5,0);\npair A1 = abs(A2-O1)*dir(285)+O1;\npair A3 = abs(A2-O2)*dir(245)+O2;\npair O3 = extension(O2, A3, midpoint(A1--A3), midpoint(A1--A3)+dir(A1-A3)*dir(90));\n\nfilldraw(circle(O1,abs(A1-O1)), opacity(0.1)+lightgreen, deepgreen);\nfilldraw(circle(O2,abs(A2-O2)), opacity(0.1)+lightgreen, deepgreen);\nfilldraw(circle(O3,abs(A3-O3)), opacity(0.1)+lightgreen, deepgreen);\nfilldraw(A1--A2--A3--cycle, opacity(0.1)+orange, red);\n\npair J = (0,-3.2);\ndraw(O1--O2--O3, deepcyan+dotted);\n\ndot(\"$O_1$\", O1, dir(90), deepcyan);\ndot(\"$O_2$\", O2, dir(90), deepcyan);\ndot(\"$O_3$\", O3, dir(-90), deepcyan);\ndot(\"$A_1$\", A1, dir(A1-J), red);\ndot(\"$A_2$\", A2, dir(A2-J), red);\ndot(\"$A_3$\", A3, dir(A3-J), red);\n\nlabel(\"$\\alpha$\", A1, 2.4*dir(J-A1), red);\nlabel(\"$\\beta$\",  A2, 2*dir(J-A2), red);\nlabel(\"$\\gamma$\", A3, 2*dir(J-A3), red);\n\\end{asy}\n\\end{center}\n\nInitially, we set $\\theta = \\dang O_1 A_2 A_1$.\nThen we compute\n\\begin{align*}\n  \\dang O_1 A_2 A_1 &= \\theta \\\\\n  \\dang O_2 A_3 A_2 &= -\\beta-\\theta \\\\\n  \\dang O_3 A_1 A_3 &= \\beta-\\gamma+\\theta \\\\\n  \\dang O_4 A_2 A_1 &= (\\gamma-\\beta-\\alpha)-\\theta \\\\\n\\end{align*}\nand repeating the same calculation another round gives\n\\[ \\dang O_7 A_2 A_1 = k-(k-\\theta) = \\theta \\]\nwith $k = \\gamma-\\beta-\\alpha$.\nThis implies $O_7 = O_1$, so $\\omega_7 = \\omega_1$.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2000}
{"id": "usamo-2000-q6", "question": "Let $a_1, b_1, a_2, b_2, \\dots , a_n, b_n$ be nonnegative real numbers.\nProve that\n\\[ \\sum_{i, j = 1}^{n} \\min\\{a_i a_j, b_i b_j\\}\n  \\le \\sum_{i, j = 1}^{n} \\min\\{a_i b_j, a_j b_i\\}.  \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p108437}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a_1, b_1, a_2, b_2, \\dots , a_n, b_n$ be nonnegative real numbers.\nProve that\n\\[ \\sum_{i, j = 1}^{n} \\min\\{a_i a_j, b_i b_j\\}\n  \\le \\sum_{i, j = 1}^{n} \\min\\{a_i b_j, a_j b_i\\}.  \\]\n\\end{mdframed}\nWe present two solutions.\n\n\\paragraph{First solution by creating a single min (Vincent Huang and Ravi Boppana).}\nLet $b_i = r_i a_i$ for each $i$,\nand rewrite the inequality as\n\\[ \\sum_{i,j} a_i a_j \\left[\n  \\min (r_i, r_j) - \\min(1, r_i r_j) \\right] \\ge 0. \\]\nWe now do the key manipulation to convert the double min\ninto a separate single min.\nLet $\\eps_i = +1$ if $r_i \\ge 1$, and $\\eps_i = -1$ otherwise,\nand let $s_i = |r_i-1|$.\nThen we pass to absolute values:\n\\begin{align*}\n  2\\min(r_i,r_j) - 2\\min(1,r_i r_j)\n  &= |r_i r_j-1| - |r_i-r_j|  - (r_i-1)(r_j-1) \\\\\n  &= |r_i r_j-1| - |r_i-r_j| - \\eps_i \\eps_j s_i s_j \\\\\n  &= \\eps_i \\eps_j \\min \\left( |1-r_i r_j \\pm (r_i-r_j)| \\right)\n  - \\eps_i \\eps_j s_i s_j \\\\\n  &= \\eps_i \\eps_j \\min \\left( s_i(r_j+1), s_j(r_i+1) \\right)\n  - \\eps_i \\eps_j s_i s_j \\\\\n  &= (\\eps_i s_i)(\\eps_j s_j)\n  \\min \\left( \\frac{r_j+1}{s_j}-1, \\frac{r_i+1}{s_i}-1  \\right).\n\\end{align*}\nSo let us denote $x_i = a_i \\eps_i s_i \\in \\RR$,\nand $t_i = \\frac{r_i+1}{s_i}-1 \\in \\RR_{\\ge 0}$.\nThus it suffices to prove that:\n\\begin{claim*}\n  We have\n  \\[ \\sum_{i,j} x_i x_j \\min(t_i, t_j) \\ge 0 \\]\n  for arbitrary $x_i \\in \\RR$, $t_i \\in \\RR_{\\ge 0}$.\n\\end{claim*}\n\\begin{proof}\n  One can just check this ``by hand''\n  by assuming $t_1 \\le t_2 \\le \\dots \\le t_n$;\n  then the left-hand side becomes\n  \\[ \\sum_i t_i x_i^2 + 2 \\sum_{i < j} 2 t_i x_i x_j\n    = \\sum_i (t_i - t_{i-1}) (x_i + x_{i+1} + \\dots + x_n)^2 \\ge 0.  \\]\n  There is also a nice proof using the integral identity\n  \\[ \\min(t_i, t_j) = \\int_0^\\infty \\mathbf1(u \\le t_i) \\mathbf1(u \\le t_j) \\; du \\]\n  where the $\\mathbf1$ are indicator functions.\n  Indeed,\n  \\begin{align*}\n    \\sum_{i,j} x_i x_j \\min(t_i, t_j)\n    &= \\sum_{i,j} x_i x_j \\int_0^\\infty \\mathbf1(u \\le t_i) \\mathbf1(u \\le t_j) \\; du \\\\\n    &= \\int_0^\\infty \\sum_i x_i \\mathbf1(u \\le t_i)\n    \\sum_j x_j \\mathbf1(u \\le t_j) \\; du \\\\\n    &= \\int_0^\\infty \\left( \\sum_i x_i \\mathbf1(u \\le t_i) \\right)^2 \\; du \\\\\n    &\\ge 0. \\qedhere\n  \\end{align*}\n\\end{proof}\n\n\n\\paragraph{Second solution by smoothing (Alex Zhai).}\nThe case $n=1$ is immediate, so we'll proceed by induction on $n \\ge 2$.\n\nAgain, let $b_i = r_i a_i$ for each $i$, and\nwrite the inequality as\n\\[ L_n(a_1, \\dots, a_n, r_1, \\dots, r_n)\n  \\coloneq \\sum_{i,j} a_i a_j \\left[\n  \\min (r_i, r_j) - \\min(1, r_i r_j) \\right] \\ge 0. \\]\nFirst note that if $r_1 = r_2$ then\n\\[ L_n(a_1, a_2, a_3, \\dots, r_1, r_1, r_3 \\dots)\n  = L_{n-1}(a_1+a_2, a_3, \\dots, r_1, r_3, \\dots) \\]\nand so our goal is to smooth to a situation\nwhere two of the $r_i$'s are equal,\nso that we may apply induction.\n\nOn the other hand, $L_n$ is a \\emph{piecewise linear} function in $r_1 \\ge 0$.\nLet us smooth $r_1$ then.\nNote that if the minimum is attained at $r_1 = 0$,\nwe can ignore $a_1$ and reduce to the $(n-1)$-variable case.\nOn the other hand, the minimum must be achieved at a cusp\nwhich opens upward, which can only happen if $r_i r_j = 1$ for some $j$.\n(The $r_i = r_j$ cusps open downward, sadly.)\n\nIn this way, whenever some $r_i$ is not equal to the reciprocal\nof any other $r_\\bullet$, we can smooth it.\nThis terminates; so we may smooth until we reach a situation for which\n\\[ \\{ r_1, \\dots, r_n \\} = \\{ 1/r_1, \\dots, 1/r_n \\}. \\]\nNow, assume WLOG that $r_1 = \\max_i r_i$ and $r_2 = \\min_i r_i$,\nhence $r_1 r_2 = 1$ and $r_1 \\ge 1 \\ge r_2$.\nWe isolate the contributions from $a_1$, $a_2$, $r_1$ and $r_2$.\n\\begin{align*}\n  L_n(\\dots) &= a_1^2 \\left[ r_1 - 1  \\right] + a_2^2 \\left[ r_2 - r_2^2 \\right]\n    + 2a_1a_2 \\left[ r_2 - 1 \\right] \\\\\n  &+ 2a_1 \\left[ (a_3r_3+\\dots+a_n r_n) - (a_3+\\dots+a_n) \\right] \\\\\n  &+ 2a_2r_2 \\left[ (a_3+\\dots+a_n) - (a_3r_3+\\dots+a_n r_n) \\right] \\\\\n  &+ \\sum_{i=3}^n \\sum_{j=3}^n a_i a_j \\left[\n    \\min (r_i, r_j) - \\min(1, r_i r_j) \\right].\n\\end{align*}\nThe idea now is to smooth via\n\\[ (a_1, a_2, r_1, r_2)\n  \\longrightarrow\n  \\left( a_1, \\frac 1t a_2, \\frac 1t r_1, tr_2 \\right) \\]\nwhere $t \\ge 1$ is such that\n$\\frac 1t r_1 \\ge \\max(1, r_3, \\dots, r_n)$ holds.\n(This choice is such that $a_1$ and $a_2 r_2$ are unchanged,\nbecause we don't know the sign of $\\sum_{i \\ge 3} (1-r_i) a_i$\nand so the post-smoothing value is still at least the max.)\nThen,\n\\begin{align*}\n  &\\phantom{ {} = {} } L_n(a_1, a_2, \\dots, r_1, r_2, \\dots)\n  - L_n\\left(a_1, \\frac 1t a_2, \\dots, \\frac1t r_1, tr_2\\right) \\\\\n  &= a_1^2 \\left( r_1 - \\frac 1t r_1 \\right)\n  + a_2^2 \\left( r_2 - \\frac 1t r_2 \\right)\n  + 2a_1a_2 \\left( \\frac 1t - 1 \\right) \\\\\n  &= \\left( 1 - \\frac 1t \\right) \\left( r_1 a_1^2 + r_2 a_2^2 - 2a_1a_2 \\right)\n  \\ge 0\n\\end{align*}\nthe last line by AM-GM.\nNow pick $t = \\frac{r_1}{\\max(1, r_3, \\dots, r_n)}$,\nand at last we can induct down.\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "USAMO", "year": 2000}
{"id": "putnam-2006-a1", "question": "Find the volume of the region of points $(x,y,z)$ such that\n\\[\n(x^2 + y^2 + z^2 + 8)^2 \\leq 36(x^2 + y^2).\n\\]", "solution": "We change to cylindrical coordinates, i.e., we put $r = \\sqrt{x^2 + y^2}$.\nThen the given inequality is equivalent to\n\\[\nr^2 + z^2 + 8 \\leq 6r,\n\\]\nor\n\\[\n(r-3)^2 + z^2 \\leq 1.\n\\]\nThis defines a solid of revolution (a solid torus); the area being rotated\nis the disc $(x-3)^2 + z^2 \\leq 1$ in the $xz$-plane. By Pappus's theorem,\nthe volume of this equals the area of this disc, which is $\\pi$, times the\ndistance through which the center of mass is being rotated, which is $(2\\pi)3$.\nThat is, the total volume is $6 \\pi^2$.", "category": "Geometry", "source": "PUTNAM", "year": 2006}
{"id": "putnam-2006-a2", "question": "Alice and Bob play a game in which they take turns removing stones from\na heap that initially has $n$ stones. The number of stones removed at\neach turn must be one less than a prime number. The winner is the player\nwho takes the last stone. Alice plays first. Prove that there are\ninfinitely many $n$ such that Bob has a winning strategy.\n(For example, if $n=17$, then Alice might take 6 leaving 11; then\nBob might take 1 leaving 10; then Alice can take the remaining stones\nto win.)", "solution": "Suppose on the contrary that the set $B$ of values of $n$ for which Bob\nhas a winning strategy is finite; for convenience, we include $n=0$ in $B$,\nand write $B = \\{b_1, \\dots, b_m\\}$.\nThen for every nonnegative integer $n$ not\nin $B$, Alice must have some move on a heap of $n$ stones leading to a\nposition in which the second player wins. That is, every nonnegative integer\nnot in $B$ can be written as $b + p - 1$ for some $b \\in B$ and some prime\n$p$. However, there are numerous ways to show that this cannot happen.\n\n\\textbf{First solution:}\nLet $t$ be any integer bigger than all of the $b \\in B$. Then it is easy to\nwrite down $t$ consecutive composite integers, e.g., $(t+1)! + 2, \\dots,\n(t+1)! + t+1$. Take $n = (t+1)! + t$; then for each $b \\in B$,\n$n - b + 1$ is one of the composite integers we just wrote down.\n\n\\textbf{Second solution:}\nLet $p_1, \\dots, p_{2m}$ be\nany prime numbers; then by the Chinese remainder theorem, there exists a\npositive integer $x$ such that\n\\begin{align*}\nx - b_1 &\\equiv -1 \\pmod{p_1 p_{m+1}} \\\\\n\\dots \\\\\nx - b_n &\\equiv -1 \\pmod{p_m p_{2m}}.\n\\end{align*}\nFor each $b \\in B$,\nthe unique integer $p$ such that $x=b+p-1$ is divisible\nby at least two primes, and so cannot itself be prime.\n\n\\textbf{Third solution:} (by Catalin Zara)\nPut $b_1 = 0$, and take $n = (b_2 - 1)\\cdots(b_m - 1)$; then $n$ is\ncomposite because $3, 8 \\in B$, and for any nonzero $b \\in B$,\n$n - b_i + 1$ is divisible by but not equal to $b_i - 1$.\n(One could also take $n = b_2 \\cdots b_m - 1$, so that\n$n-b_i+1$ is divisible by $b_i$.)", "category": "Number Theory", "source": "PUTNAM", "year": 2006}
{"id": "putnam-2006-a3", "question": "Let $1, 2, 3, \\dots, 2005, 2006, 2007, 2009, 2012, 2016, \\dots$\nbe a sequence defined by $x_k = k$ for $k=1, 2, \\dots, 2006$ and\n$x_{k+1} = x_k + x_{k-2005}$ for $k \\geq 2006$. Show that the sequence has\n2005 consecutive terms each divisible by 2006.", "solution": "We first observe that given any sequence of integers\n$x_1, x_2, \\dots$ satisfying a recursion\n\\[\nx_k = f(x_{k-1}, \\dots, x_{k-n}) \\qquad (k > n),\n\\]\nwhere $n$ is fixed and $f$ is a fixed polynomial of $n$ variables with\ninteger coefficients, for any positive integer $N$, the sequence modulo $N$\nis eventually periodic. This is simply because there are only finitely many\npossible sequences of $n$ consecutive values modulo $N$, and once such\na sequence is repeated, every subsequent value is repeated as well.\n\nWe next observe that if one can rewrite the same recursion as\n\\[\nx_{k-n} = g(x_{k-n+1}, \\dots, x_k) \\qquad (k > n),\n\\]\nwhere $g$ is also a polynomial with integer coefficients, then\nthe sequence extends uniquely to a doubly infinite sequence $\\dots,\nx_{-1}, x_0, x_1, \\dots$ which is fully periodic modulo any $N$.\nThat is the case in the\nsituation at hand, because we can rewrite the given recursion as\n\\[\nx_{k-2005} = x_{k+1} - x_k.\n\\]\nIt thus suffices to find 2005 consecutive terms divisible by $N$ in the\ndoubly infinite sequence, for any fixed $N$ (so in particular for\n$N = 2006$).\nRunning the recursion backwards, we easily find\n\\begin{gather*}\nx_1 = x_0 = \\cdots = x_{-2004} = 1 \\\\\nx_{-2005} = \\cdots = x_{-4009} = 0,\n\\end{gather*}\nyielding the desired result.", "category": "Number Theory", "source": "PUTNAM", "year": 2006}
{"id": "putnam-2006-a4", "question": "Let $S = \\{1, 2, \\dots, n\\}$ for some integer $n > 1$. Say a permutation\n$\\pi$ of $S$ has a \\emph{local maximum} at $k \\in S$ if\n\\begin{enumerate} % The for parts are aligned in the AMM version", "solution": "\\textbf{First solution:}\nBy the linearity of expectation, the average number of local maxima is equal\nto the sum of the probability of having a local maximum at $k$ over\n$k=1,\\dots, n$.\nFor $k=1$, this probability is 1/2: given the pair\n$\\{\\pi(1), \\pi(2)\\}$, it is equally likely that $\\pi(1)$ or $\\pi(2)$ is\nbigger. Similarly, for $k=n$, the probability is 1/2. For $1 < k < n$,\nthe probability is 1/3: given the pair $\\{\\pi(k-1), \\pi(k), \\pi(k+1)\\}$,\nit is equally likely that any of the three is the largest.\nThus the average number of local maxima is\n\\[\n2 \\cdot \\frac{1}{2} + (n-2) \\cdot \\frac{1}{3} =\n\\frac{n+1}{3}.\n\\]\n\n\\textbf{Second solution:}\nAnother way to apply the linearity of expectation is to compute the\nprobability that $i \\in \\{1, \\dots, n\\}$ occurs as a local maximum.\nThe most efficient way to do this is to imagine the permutation\nas consisting of the symbols $1, \\dots, n, *$ written in a circle in\nsome order. The number $i$ occurs as a local maximum if the two symbols\nit is adjacent to both belong to the set $\\{*, 1, \\dots, i-1\\}$. There are\n$i(i-1)$ pairs of such symbols and $n(n-1)$ pairs in total, so the\nprobability of $i$ occurring as a local maximum is $i(i-1)/(n(n-1))$, and\nthe average number of local maxima is\n\\begin{align*}\n\\sum_{i=1}^n \\frac{i(i-1)}{n(n-1)} &=\n\\frac{2}{n(n-1)} \\sum_{i=1}^n \\binom{i}{2} \\\\\n&= \\frac{2}{n(n-1)} \\binom{n+1}{3} \\\\\n&= \\frac{n+1}{3}.\n\\end{align*}\nOne can obtain a similar (if slightly more intricate)\nsolution inductively, by removing the known\nlocal maximum $n$ and splitting into two shorter sequences.\n\n\\textbf{Remark:}\nThe usual term for a local maximum in this sense is a \\emph{peak}.\nThe complete distribution for the number of peaks is known;\nRichard Stanley suggests the reference:\nF. N. David and D. E. Barton, \\textit{Combinatorial Chance}, Hafner, New York,\n1962, p.\\ 162 and subsequent.", "category": "Combinatorics", "source": "PUTNAM", "year": 2006}
{"id": "putnam-2006-a5", "question": "Let $n$ be a positive odd integer and let $\\theta$ be a real number such\nthat $\\theta/\\pi$ is irrational. Set $a_k = \\tan (\\theta + k \\pi/n)$,\n$k=1,2,\\dots,n$. Prove that\n\\[\n\\frac{a_1 + a_2 + \\cdots + a_n}{a_1 a_2 \\cdots a_n}\n\\]\nis an integer, and determine its value.", "solution": "Since the desired expression involves symmetric functions of $a_1,\n\\dots, a_n$, we start by finding a polynomial with $a_1, \\dots, a_n$\nas roots. Note that\n\\[\n1 \\pm i \\tan \\theta = e^{\\pm i \\theta} \\sec \\theta\n\\]\nso that\n\\[\n1 + i \\tan \\theta = e^{2 i \\theta} (1 - i \\tan \\theta).\n\\]\nConsequently, if we put $\\omega = e^{2 i n \\theta}$, then the polynomial\n\\[\nQ_n(x) = (1 + ix)^n - \\omega (1-ix)^n\n\\]\nhas among its roots $a_1, \\dots, a_n$. Since these are distinct and\n$Q_n$ has degree $n$, these must be exactly the roots.\n\nIf we write\n\\[\nQ_n(x) = c_n x^n + \\cdots + c_1 x + c_0,\n\\]\nthen $a_1 + \\cdots + a_n = -c_{n-1}/c_n$ and $a_1\\cdots a_n = -c_0/c_n$,\nso the ratio we are seeking is $c_{n-1}/c_0$.\nBy inspection,\n\\begin{align*}\nc_{n-1} &= n i^{n-1} - \\omega n (-i)^{n-1} = n i^{n-1} (1-\\omega)\\\\\nc_0 &= 1 - \\omega\n\\end{align*}\nso\n\\[\n\\frac{a_1+ \\cdots + a_n}{a_1 \\cdots a_n}\n= \\begin{cases} n & n \\equiv 1 \\pmod{4} \\\\ -n & n \\equiv 3 \\pmod{4}.\n\\end{cases}\n\\]\n\n\\textbf{Remark:} The same argument shows that the ratio between\nany two \\emph{odd} elementary\nsymmetric functions of $a_1, \\dots, a_n$ is independent\nof $\\theta$.", "category": "Algebra", "source": "PUTNAM", "year": 2006}
{"id": "putnam-2006-a6", "question": "Four points are chosen uniformly and independently at random in the interior\nof a given circle. Find the probability that they are the vertices\nof a convex quadrilateral.", "solution": "\\textbf{First solution:}\n(by Daniel Kane)\nThe probability is $1 - \\frac{35}{12\\pi^2}$.\nWe start with some notation and simplifications.\nFor simplicity, we\nassume without loss of generality that the circle has radius 1.\nLet $E$ denote the expected value of a random variable over all\nchoices of $P,Q,R$.\nWrite $[XYZ]$ for the area of triangle $XYZ$.\n\nIf $P,Q,R,S$ are the four points, we may ignore the case where three\nof them are collinear, as this occurs with probability zero. Then the only\nway they can fail to form the vertices of a convex quadrilateral is if one\nof them lies inside the triangle formed by the other three. There are four\nsuch configurations, depending on which point lies inside the triangle, and\nthey are mutually exclusive. Hence the desired probability is 1 minus\nfour times the probability that $S$ lies inside triangle $PQR$. That latter\nprobability is simply $E([PQR])$ divided by the area of\nthe disc.\n\nLet $O$ denote the center of the circle,\nand let $P',Q',R'$ be the projections of $P,Q,R$ onto the circle from $O$.\nWe can write\n\\[\n[PQR] = \\pm [OPQ] \\pm [OQR] \\pm [ORP]\n\\]\nfor a suitable choice of signs, determined as follows. If the points\n$P',Q',R'$ lie on no semicircle, then all of the signs are positive.\nIf $P',Q',R'$ lie on a semicircle in that order and\n$Q$ lies inside the triangle $OPR$, then the sign on $[OPR]$ is\npositive and the others are negative.\nIf $P',Q',R'$ lie on a semicircle in that order and\n$Q$ lies outside the triangle $OPR$, then the sign on $[OPR]$ is\nnegative and the others are positive.\n\nWe first calculate\n\\[\nE([OPQ] + [OQR] + [ORP]) = 3 E([OPQ]).\n\\]\nWrite $r_1 = OP, r_2 = OQ, \\theta = \\angle POQ$, so that\n\\[\n[OPQ] = \\frac{1}{2} r_1 r_2 (\\sin \\theta).\n\\]\nThe distribution of $r_1$ is given by $2r_1$ on $[0,1]$\n(e.g., by the change of variable formula to polar coordinates),\nand similarly for $r_2$.\nThe distribution of $\\theta$ is uniform on $[0,\\pi]$.\nThese three distributions are independent; hence\n\\begin{align*}\n& E([OPQ]) \\\\\n&= \\frac{1}{2} \\left( \\int_0^{1} 2r^2\\,dr \\right)^2\n\\left( \\frac{1}{\\pi} \\int_0^\\pi \\sin (\\theta)\\,d\\theta \\right) \\\\\n&= \\frac{4}{9 \\pi},\n\\end{align*}\nand\n\\[\nE([OPQ] + [OQR] + [ORP]) = \\frac{4}{3 \\pi}.\n\\]\n\nWe now treat the case where $P',Q',R'$ lie on a semicircle in\nthat order.\nPut $\\theta_1 = \\angle POQ$ and $\\theta_2 = \\angle QOR$; then\nthe distribution of $\\theta_1, \\theta_2$ is uniform on the region\n\\[\n0 \\leq \\theta_1, \\quad 0 \\leq \\theta_2, \\quad \\theta_1 + \\theta_2 \\leq \\pi.\n\\]\nIn particular, the distribution on $\\theta = \\theta_1 + \\theta_2$\nis $\\frac{2\\theta}{\\pi^2}$ on $[0, \\pi]$.\nPut $r_P = OP, r_Q = OQ, r_R = OR$. Again, the distribution on $r_P$\nis given by $2 r_P$ on $[0,1]$, and similarly for $r_Q, r_R$; these\nare independent from each other and from the joint distribution\nof $\\theta_1,\\theta_2$.\nWrite $E'(X)$ for the expectation of a random variable $X$\nrestricted to this part of the domain.\n\nLet $\\chi$ be the random variable with value 1 if $Q$ is inside\ntriangle $OPR$ and 0 otherwise.\nWe now compute\n\\begin{align*}\n&E'([OPR]) \\\\\n&=\n\\frac{1}{2} \\left( \\int_0^1 2r^2\\,dr \\right)^2\n\\left( \\int_0^\\pi \\frac{2\\theta}{\\pi^2} \\sin(\\theta) \\,d\\theta \\right)\\\\\n&= \\frac{4}{9 \\pi} \\\\\n& E'(\\chi [OPR]) \\\\\n&= E'(2 [OPR]^2 / \\theta) \\\\\n&=\n\\frac{1}{2} \\left( \\int_0^1 2r^3\\,dr \\right)^2\n\\left( \\int_0^\\pi \\frac{2\\theta}{\\pi^2} \\theta^{-1} \\sin^2(\\theta) \\,d\\theta \\right)\\\\\n&= \\frac{1}{8\\pi}.\n\\end{align*}\nAlso recall that given any triangle $XYZ$, if $T$ is chosen uniformly\nat random inside $XYZ$, the expectation of $[TXY]$ is the area of\ntriangle bounded by $XY$ and the centroid of $XYZ$, namely\n$\\frac{1}{3} [XYZ]$.\n\nLet $\\chi$ be the random variable with value 1 if $Q$ is inside\ntriangle $OPR$ and 0 otherwise. Then\n\\begin{align*}\n&E'([OPQ] + [OQR] + [ORP] - [PQR]) \\\\\n&= 2 E'(\\chi ([OPQ] + [OQR]) + 2 E'((1-\\chi)[OPR]) \\\\\n&= 2 E'(\\frac{2}{3} \\chi [OPR]) + 2 E'([OPR]) - 2 E'(\\chi [OPR]) \\\\\n&= 2E'([OPR]) - \\frac{2}{3} E'(\\chi [OPR]) = \\frac{29}{36 \\pi}.\n\\end{align*}\nFinally, note that the case when $P',Q',R'$\nlie on a semicircle in some order occurs with probability $3/4$.\n(The case where they lie on a semicircle proceeding clockwise from $P'$\nto its antipode has probability 1/4; this case and its two analogues are\nexclusive and exhaustive.) Hence\n\\begin{align*}\n&E([PQR]) \\\\\n&= E([OPQ]+[OQR]+[ORP]) \\\\\n&\\quad - \\frac{3}{4} E'([OPQ] + [OQR] + [ORP] - [PQR]) \\\\\n&= \\frac{4}{3 \\pi} - \\frac{29}{48 \\pi} = \\frac{35}{48 \\pi},\n\\end{align*}\nso the original probability is\n\\[\n1 - \\frac{4 E([PQR])}{\\pi} = 1 - \\frac{35}{12 \\pi^2}.\n\\]\n\n\\textbf{Second solution:}\n(by David Savitt)\nAs in the first solution, it suffices to check that for\n$P,Q,R$ chosen uniformly at random in the disc, $E([PQR]) = \\frac{35}{48 \\pi}$.\nDraw the lines $PQ, QR, RP$, which with probability 1 divide the interior\nof the circle into seven regions. Put $a = [PQR]$, let $b_1,b_2,b_3$\ndenote the areas of the\nthree other regions sharing a side with the triangle, and let\n$c_1,c_2,c_3$ denote the areas of the other three regions.\nPut $A = E(a)$, $B = E(b_1)$, $C = E(c_1)$, so that\n$A + 3B + 3C = \\pi$.\n\nNote that $c_1 + c_2 + c_3 + a$ is the area of the region in which we can\nchoose a fourth point $S$ so that the quadrilateral $PQRS$ fails to be\nconvex. By comparing expectations, we have $3C + A = 4A$,\nso $A = C$ and $4A + 3B = \\pi$.\n\nWe will compute $B + 2A = B + 2C$, which is the expected area of the part\nof the circle cut off by a chord through two random points $D,E$, on the\nside of the chord not containing a third random point $F$.\nLet $h$ be the distance from the center $O$ of the circle to the line $DE$.\nWe now determine the distribution of $h$.\n\nPut $r = OD$; the distribution of $r$ is $2r$ on $[0,1]$.\nWithout loss of generality, suppose $O$ is the origin and\n$D$ lies on the positive $x$-axis.\nFor fixed $r$, the distribution of $h$ runs over $[0,r]$,\nand can be computed as the area of the infinitesimal region in which\n$E$ can be chosen so the chord through $DE$ has distance to $O$\nbetween $h$ and $h+dh$, divided by $\\pi$.\nThis region splits into two symmetric pieces, one of which lies\nbetween chords making angles of $\\arcsin(h/r)$ and\n$\\arcsin((h + dh)/r)$ with the $x$-axis.\nThe angle between these is $d\\theta = dh/(r^2 - h^2)$.\nDraw the chord through $D$ at distance $h$ to $O$, and let $L_1,L_2$ be the\nlengths of the parts on opposite sides of $D$; then\nthe area we are looking for is $\\frac{1}{2}(L_1^2 + L_2^2) d\\theta$.\nSince\n\\[\n\\{L_1, L_2 \\} = \\sqrt{1-h^2} \\pm \\sqrt{r^2 - h^2},\n\\]\nthe area we are seeking (after doubling) is\n\\[\n2\\frac{1 + r^2 - 2h^2}{\\sqrt{r^2 - h^2}}.\n\\]\nDividing by $\\pi$, then integrating over $r$, we compute the distribution\nof $h$ to be\n\\begin{align*}\n&\\frac{1}{\\pi} \\int_h^1 2 \\frac{1 + r^2 - 2h^2}{\\sqrt{r^2 - h^2}} 2r\\,dr \\\\\n&= \\frac{16}{3\\pi} (1-h^2)^{3/2}.\n\\end{align*}\n\nWe now return to computing $B +2A$.\nLet $A(h)$ denote the smaller of the two areas of the disc cut off\nby a chord at distance $h$.\nThe chance that the third point is in the smaller (resp.\\\nlarger) portion is $A(h)/\\pi$ (resp.\\ $1 - A(h)/\\pi$),\nand then the area we are trying to compute is $\\pi - A(h)$\n(resp.\\ $A(h)$).\nUsing the distribution on $h$,\nand the fact that\n\\begin{align*}\nA(h) &= 2 \\int_h^1 \\sqrt{1-h^2}\\,dh \\\\\n&= \\frac{\\pi}{2}  - \\arcsin(h) - h \\sqrt{1-h^2},\n\\end{align*}\nwe find\n\\begin{align*}\n&B+2A \\\\\n&= \\frac{2}{\\pi} \\int_0^1 A(h) (\\pi - A(h))\\, \\frac{16}{3\\pi} (1-h^2)^{3/2}\n\\,dh \\\\\n&= \\frac{35 + 24 \\pi^2}{72 \\pi}.\n\\end{align*}\nSince $4A + 3B = \\pi$, we solve to obtain\n$A = \\frac{35}{48 \\pi}$ as in the first solution.\n\n\\textbf{Third solution:} (by Noam Elkies)\nAgain, we reduce to computing the average area of a triangle formed by\nthree random points $A,B,C$ inside a unit circle.\nLet $O$ be the center of the circle, and put $c = \\max\\{OA,OB,OC\\}$;\nthen the probability that $c \\leq r$ is $(r^2)^3$, so the distribution\nof $c$ is $6c^5\\,dc$ on $[0,1]$.\n\nGiven $c$, the expectation of $[ABC]$ is equal to $c^2$ times $X$, the expected\narea of a triangle formed by two random points $P,Q$ in a circle and\na fixed point $R$ on the boundary. We introduce polar coordinates centered\nat $R$, in which the circle is given by $r = 2 \\sin \\theta$ for\n$\\theta \\in [0, \\pi]$. The distribution of a random point in that circle is\n$\\frac{1}{\\pi} r\\,dr\\,d\\theta$ over $\\theta \\in [0,\\pi]$ and\n$r \\in [0, 2 \\sin \\theta]$. If $(r,\\theta)$ and $(r',\\theta')$ are the\ntwo random points, then the area is $\\frac{1}{2} rr' \\sin |\\theta - \\theta'|$.\n\nPerforming the integrals over $r$ and $r'$ first, we find\n\\begin{align*}\nX &= \\frac{32}{9 \\pi^2} \\int_0^\\pi \\int_0^\\pi \\sin^3 \\theta \\sin^3 \\theta'\n\\sin |\\theta-\\theta'|\\,d\\theta'\\,d\\theta \\\\\n&= \\frac{64}{9 \\pi^2} \\int_0^\\pi \\int_0^\\theta \\sin^3 \\theta \\sin^3 \\theta'\n\\sin (\\theta-\\theta') \\,d\\theta'\\,d\\theta.\n\\end{align*}\nThis integral is unpleasant but straightforward; it yields\n$X = 35/(36 \\pi)$, and\n$E([PQR]) = \\int_0^1 6c^7 X\\,dc = 35/(48 \\pi)$, giving the desired\nresult.\n\n\\textbf{Remark:}\nThis is one of the oldest problems in geometric probability; it is an instance\nof Sylvester's four-point problem, which nowadays is usually solved using\na device known as Crofton's formula.\nWe defer to \\texttt{http://mathworld.wolfram.com/} for\nfurther discussion.", "category": "Combinatorics", "source": "PUTNAM", "year": 2006}
{"id": "putnam-2006-b1", "question": "Show that the curve $x^3 + 3xy + y^3 = 1$ contains only one set of three\ndistinct points, $A$, $B$, and $C$, which are vertices of an equilateral\ntriangle, and find its area.", "solution": "The ``curve'' $x^3 + 3xy + y^3 - 1 = 0$ is actually reducible, because the\nleft side factors as\n\\[\n(x+y-1)(x^2 -xy + y^2 + x + y + 1).\n\\]\nMoreover, the second factor is\n\\[\n\\frac{1}{2} ((x+1)^2 + (y+1)^2 + (x-y)^2),\n\\]\nso it only vanishes at $(-1,-1)$. Thus the curve in question consists of the\nsingle point $(-1,-1)$ together with the line $x+y=1$. To form a triangle\nwith three points on this curve, one of its vertices must be $(-1,-1)$.\nThe other two vertices lie on the line $x+y=1$, so the length of the altitude\nfrom $(-1,-1)$ is the distance from $(-1,-1)$ to $(1/2,1/2)$, or\n$3 \\sqrt{2}/2$. The area of an equilateral triangle of height $h$ is\n$h^2 \\sqrt{3}/3$, so the desired area is\n$3 \\sqrt{3}/2$.\n\n\\textbf{Remark:} The factorization used above is a special case of the fact\nthat\n\\begin{align*}\n&x^3 + y^3 + z^3 - 3xyz \\\\\n&= (x+y+z)(x+\\omega y + \\omega^2 z)(x + \\omega^2 y\n+ \\omega z),\n\\end{align*}\nwhere $\\omega$ denotes a primitive cube root of unity. That fact in turn follows\nfrom the evaluation of the determinant of the \\emph{circulant matrix}\n\\[\n\\begin{pmatrix} x & y & z \\\\ z & x & y \\\\ y & z & x\n\\end{pmatrix}\n\\]\nby reading off the eigenvalues of the eigenvectors\n$(1, \\omega^i, \\omega^{2i})$ for $i=0,1,2$.", "category": "Geometry", "source": "PUTNAM", "year": 2006}
{"id": "putnam-2006-b2", "question": "Prove that, for every set $X = \\{x_1, x_2, \\dots, x_n\\}$ of $n$\nreal numbers, there exists a non-empty subset $S$ of $X$ and an integer $m$\nsuch that\n\\[\n\\left| m + \\sum_{s \\in S} s \\right| \\leq \\frac{1}{n+1}.\n\\]", "solution": "Let $\\{x\\} = x - \\lfloor x \\rfloor$ denote the fractional part of $x$.\nFor $i=0,\\dots, n$, put $s_i = x_1 + \\cdots + x_i$ (so that $s_0 = 0$).\nSort the numbers $\\{s_0\\}, \\dots, \\{s_n\\}$ into ascending order,\nand call the result $t_0, \\dots, t_n$. Since $0 = t_0 \\leq \\cdots \\leq\nt_n < 1$, the differences\n\\[\nt_1 - t_0, \\dots, t_n - t_{n-1}, 1 - t_n\n\\]\nare nonnegative and add up to 1. Hence (as in  the pigeonhole principle) one\nof these differences\nis no more than $1/(n+1)$; if it is anything other than $1 - t_n$,\nit equals $\\pm (\\{s_i\\} - \\{s_j\\})$ for some\n$0 \\leq i < j \\leq n$. Put $S = \\{x_{i+1}, \\dots, x_j\\}$ and\n$m = \\lfloor s_i \\rfloor - \\lfloor s_j \\rfloor$; then\n\\begin{align*}\n\\left| m + \\sum_{s \\in S} s \\right|\n&= |m + s_j - s_i| \\\\\n&= |\\{s_j\\} - \\{s_i\\}| \\\\\n&\\leq \\frac{1}{n+1},\n\\end{align*}\nas desired. In case $1 - t_n \\leq 1 / (n+1)$, we take\n$S = \\{x_1, \\dots, x_n\\}$ and $m = -\\lceil s_n \\rceil$, and again obtain\nthe desired conclusion.", "category": "Combinatorics", "source": "PUTNAM", "year": 2006}
{"id": "putnam-2006-b3", "question": "Let $S$ be a finite set of points in the plane. A linear partition of $S$\nis an unordered pair $\\{A,B\\}$ of subsets of $S$ such that $A \\cup B = S$,\n$A \\cap B = \\emptyset$, and $A$ and $B$ lie on opposite sides of some\nstraight line disjoint from $S$ ($A$ or $B$ may be empty). Let $L_S$ be the\nnumber of linear partitions of $S$. For each positive integer $n$, find the\nmaximum of $L_S$ over all sets $S$ of $n$ points.", "solution": "The maximum is $\\binom{n}{2} + 1$, achieved for instance by a\nconvex $n$-gon: besides the trivial partition (in which all of the points\nare in one part), each linear\npartition occurs by drawing a line crossing a unique pair\nof edges.\n\n\\textbf{First solution:}\nWe will prove that $L_S = \\binom{n}{2} + 1$ in any configuration in which\nno two of the lines joining points of $S$ are parallel. This suffices\nto imply the maximum in all configurations: given a maximal configuration,\nwe may vary the points slightly to get another maximal configuration in which\nour hypothesis is satisfied.\nFor convenience, we assume $n \\geq 3$, as the cases $n=1,2$ are easy.\n\nLet $P$ be the line at infinity in the real projective plane; i.e., $P$\nis the set of possible directions of lines in the plane, viewed as a circle.\nRemove the directions corresponding to lines through two points of $S$;\nthis leaves behind $\\binom{n}{2}$ intervals.\n\nGiven a direction in one of the intervals, consider the set of linear\npartitions achieved by lines parallel to that direction. Note that the\nresulting collection of partitions depends only on the interval. Then\nnote that the collections associated to adjacent intervals differ in only\none element.\n\nThe trivial partition that puts all of $S$ on one side is in every such\ncollection. We now observe that for any other linear partition\n$\\{A,B\\}$, the set of intervals to which $\\{A,B\\}$ is:\n\\begin{enumerate}", "category": "Combinatorics", "source": "PUTNAM", "year": 2006}
{"id": "putnam-2006-b4", "question": "Let $Z$ denote the set of points in $\\mathbb{R}^n$ whose coordinates are 0\nor 1. (Thus $Z$ has $2^n$ elements, which are the vertices of a unit\nhypercube in $\\mathbb{R}^n$.) Given a vector subspace $V$\nof $\\mathbb{R}^n$, let $Z(V)$\ndenote the number of members of $Z$ that lie in $V$. Let $k$ be given,\n$0 \\leq k \\leq n$. Find the maximum, over all vector subspaces $V\n\\subseteq \\mathbb{R}^n$ of dimension $k$, of the number of points in\n$V \\cap Z$. [Editorial note: the proposers probably intended to write\n$Z(V)$ instead of\n``the number of points in $V \\cap Z$'', but this changes nothing.]", "solution": "The maximum is $2^k$, achieved for instance by the subspace\n\\[\n\\{(x_1, \\dots, x_n) \\in \\mathbb{R}^n: x_1 = \\cdots = x_{n-k} = 0\\}.\n\\]\n\n\\textbf{First solution:}\nMore generally, we show that any affine $k$-dimensional plane in\n$\\mathbb{R}^n$ can contain at most $2^k$ points in $Z$. The proof is by\ninduction on $k+n$; the case $k=n=0$ is clearly true.\n\nSuppose that $V$ is a $k$-plane in $\\mathbb{R}^n$. Denote the\nhyperplanes $\\{x_n = 0\\}$ and $\\{x_n = 1\\}$ by $V_0$ and $V_1$,\nrespectively. If $V\\cap V_0$ and $V\\cap V_1$ are each at most\n$(k-1)$-dimensional, then $V\\cap V_0\\cap Z$ and $V\\cap V_1 \\cap Z$ each\nhave cardinality at most $2^{k-1}$ by the induction assumption, and\nhence $V\\cap Z$ has at most $2^k$ elements. Otherwise, if $V\\cap V_0$ or\n$V\\cap V_1$ is $k$-dimensional, then $V \\subset V_0$ or $V\\subset V_1$;\nnow apply the induction hypothesis on $V$, viewed as a subset of\n$\\mathbb{R}^{n-1}$ by dropping the last coordinate.\n\n\\textbf{Second solution:}\nLet $S$ be a subset of $Z$ contained in a $k$-dimensional subspace of $V$.\nThis is equivalent to asking that any $t_1, \\dots, t_{k+1} \\in S$\nsatisfy a nontrivial linear dependence $c_1 t_1 + \\cdots + c_{k+1} t_{k+1} = 0$\nwith $c_1, \\dots, c_{k+1} \\in \\mathbb{R}$. Since $t_1, \\dots, t_{k+1} \\in\n\\mathbb{Q}^n$, given such a dependence we can always find another one with\n$c_1, \\dots, c_{k+1} \\in \\mathbb{Q}$; then by clearing denominators, we\ncan find one with $c_1, \\dots, c_{k+1} \\in \\mathbb{Z}$ and not all having a\ncommon factor.\n\nLet $\\mathbb{F}_2$ denote the field of two elements, and let\n$\\overline{S} \\subseteq \\mathbb{F}_2^n$ be the reductions modulo 2 of the points of\n$S$. Then any $t_1, \\dots, t_{k+1} \\in \\overline{S}$ satisfy a nontrivial\nlinear dependence, because we can take the dependence from the end of\nthe previous paragraph and reduce modulo 2. Hence $\\overline{S}$ is contained\nin a $k$-dimensional subspace of $\\mathbb{F}_{2^n}$, and the latter has cardinality\nexactly $2^k$. Thus $\\overline{S}$ has at most $2^k$ elements, as does\n$S$.\n\nVariant (suggested by David Savitt): if $\\overline{S}$ contained $k+1$\nlinearly independent elements, the $(k+1) \\times n$ matrix formed by these\nwould have a nonvanishing maximal minor. The lift of that minor back to $\\RR$\nwould also not vanish, so $S$ would contain $k+1$ linearly independent\nelements.\n\n\\textbf{Third solution:} (by Catalin Zara)\nLet $V$ be a $k$-dimensional subspace. Form the matrix whose rows are the elements\nof $V \\cap Z$; by construction, it has row rank at most $k$. It thus also has\ncolumn rank at most $k$; in particular, we can choose $k$ coordinates such that\neach point of $V \\cap Z$ is determined by those $k$ of its coordinates. Since\neach coordinate of a point in $Z$ can only take two values, $V \\cap Z$ can have\nat most $2^k$ elements.\n\n\\textbf{Remark:} The proposers probably did not realize that this problem appeared\nonline about three months before the exam, at\n\\texttt{http://www.artofproblemsolving.com/ Forum/viewtopic.php?t=105991}. (It\nmay very well have also appeared even earlier.)", "category": "Combinatorics", "source": "PUTNAM", "year": 2006}
{"id": "putnam-2006-b5", "question": "For each continuous function $f: [0,1] \\to \\mathbb{R}$, let $I(f) =\n\\int_0^1 x^2 f(x)\\,dx$ and $J(x) = \\int_0^1 x \\left(f(x)\\right)^2\\,dx$.\nFind the maximum value of $I(f) - J(f)$ over all such functions $f$.", "solution": "The answer is $1/16$. We have\n\\begin{align*}\n&\\int_0^1 x^2 f (x)\\,dx - \\int_0^1 x f(x)^2\\,dx \\\\\n&= \\int_0^1 (x^3/4 - x\n( f(x)-x/2)^2)\\,dx \\\\\n&\\leq \\int_0^1 x^3/4\\,dx = 1/16,\n\\end{align*}\nwith equality when $f(x) = x/2$.", "category": "Algebra", "source": "PUTNAM", "year": 2006}
{"id": "putnam-2006-b6", "question": "Let $k$ be an integer greater than 1. Suppose $a_0 > 0$, and define\n\\[\na_{n+1} = a_n + \\frac{1}{\\sqrt[k]{a_n}}\n\\]\nfor $n > 0$. Evaluate\n\\[\n\\lim_{n \\to \\infty} \\frac{a_n^{k+1}}{n^k}.\n\\]\n\\end{itemize}\n\n\\end{document}", "solution": "\\textbf{First solution:}\nWe start with some easy\nupper and lower bounds on $a_n$.\nWe write $O(f(n))$ and $\\Omega(f(n))$ for functions $g(n)$ such that\n$f(n)/g(n)$ and $g(n)/f(n)$, respectively, are bounded above.\nSince $a_n$ is a nondecreasing sequence, $a_{n+1}-a_n$ is bounded above,\nso $a_n = O(n)$. That means $a_n^{-1/k} = \\Omega(n^{-1/k})$, so\n\\[\na_n = \\Omega \\left( \\sum_{i=1}^n i^{-1/k} \\right)\n= \\Omega(n^{(k-1)/k}).\n\\]\nIn fact, all we will need is that $a_n \\to \\infty$ as $n \\to \\infty$.\n\nBy Taylor's theorem with remainder, for $1 < m < 2$ and $x>0$,\n\\[\n|(1+x)^m - 1 - mx| \\leq \\frac{m(m-1)}{2}x^2.\n\\]\nTaking $m = (k+1)/k$ and $x = a_{n+1}/a_n = 1 + a_n^{-(k+1)/k}$, we obtain\n\\[\n\\left| a_{n+1}^{(k+1)/k} - a_n^{(k+1)/k} - \\frac{k+1}{k} \\right|\n\\leq \\frac{k+1}{2k^2} a_n^{-(k+1)/k}.\n\\]\nIn particular,\n\\[\n\\lim_{n \\to \\infty} a_{n+1}^{(k+1)/k} - a_n^{(k+1)/k} = \\frac{k+1}{k}.\n\\]\n\nIn general, if $x_n$ is a sequence with $\\lim_{n \\to \\infty} x_n = c$, then\nalso\n\\[\n\\lim_{n \\to \\infty} \\frac{1}{n} \\sum_{i=1}^n x_i = c\n\\]\nby Cesaro's lemma. Explicitly, for any $\\epsilon > 0$, we can find $N$ such that\n$|x_n - c| \\leq \\epsilon/2$ for $n \\geq N$, and then\n\\[\n\\left| c - \\frac{1}{n} \\sum_{i=1}^n x_i \\right|\n\\leq \\frac{n-N}{n} \\frac{\\epsilon}{2} + \\frac{N}{n} \\left| \\sum_{i=1}^N (c-x_i) \\right|;\n\\]\nfor $n$ large, the right side is smaller than $\\epsilon$.\n\nIn our case, we deduce that\n\\[\n\\lim_{n \\to \\infty} \\frac{a_n^{(k+1)/k}}{n} = \\frac{k+1}{k}\n\\]\nand so\n\\[\n\\lim_{n \\to \\infty} \\frac{a_n^{k+1}}{n^k} = \\left(\\frac{k+1}{k} \\right)^k,\n\\]\nas desired.\n\n\\textbf{Remark:}\nThe use of Cesaro's lemma above is the special case $b_n = n$\nof the \\emph{Cesaro-Stolz\ntheorem}: if $a_n,b_n$ are sequences such that $b_n$ is positive,\nstrictly increasing, and unbounded, and\n\\[\n\\lim_{n \\to \\infty} \\frac{a_{n+1} - a_n}{b_{n+1} - b_n} = L,\n\\]\nthen\n\\[\n\\lim_{n \\to \\infty} \\frac{a_n}{b_n} = L.\n\\]\n\n\\textbf{Second solution:}\nIn this solution, rather than applying Taylor's theorem with remainder\nto $(1+x)^m$ for $1 < m < 2$ and $x > 0$, we only apply convexity to deduce\nthat $(1+x)^m \\geq 1 + mx$. This gives\n\\[\na_{n+1}^{(k+1)/k} - a_n^{(k+1)/k} \\geq \\frac{k+1}{k},\n\\]\nand so\n\\[\na_n^{(k+1)/k} \\geq \\frac{k+1}{k} n + c\n\\]\nfor some $c \\in \\RR$. In particular,\n\\[\n\\liminf_{n \\to \\infty} \\frac{a_n^{(k+1)/k}}{n} \\geq \\frac{k+1}{k}\n\\]\nand so\n\\[\n\\liminf_{n \\to \\infty} \\frac{a_n}{n^{k/(k+1)}} \\geq \\left(\\frac{k+1}{k} \\right)^{k/(k+1)}.\n\\]\nBut turning this around, the fact that\n\\begin{align*}\n&a_{n+1} - a_n \\\\\n&= a_n^{-1/k} \\\\\n&\\leq \\left(\\frac{k+1}{k} \\right)^{-1/(k+1)} n^{-1/(k+1)}\n(1 + o(1)),\n\\end{align*}\nwhere $o(1)$ denotes a function tending to 0 as $n \\to \\infty$,\nyields\n\\begin{align*}\n&a_n \\\\\n&\\leq\n\\left(\\frac{k+1}{k} \\right)^{-1/(k+1)} \\sum_{i=1}^n i^{-1/(k+1)} (1 + o(1)) \\\\\n&= \\frac{k+1}{k} \\left(\\frac{k+1}{k} \\right)^{-1/(k+1)} n^{k/(k+1)}(1 + o(1)) \\\\\n&= \\left( \\frac{k+1}{k} \\right)^{k/(k+1)} n^{k/(k+1)}(1 + o(1)),\n\\end{align*}\nso\n\\[\n\\limsup_{n \\to \\infty} \\frac{a_n}{n^{k/(k+1)}} \\leq \\left( \\frac{k+1}{k}\n\\right)^{k/(k+1)}\n\\]\nand this completes the proof.\n\n\\textbf{Third solution:}\nWe argue that $a_n \\to \\infty$ as in the first solution.\nWrite $b_n = a_n - L n^{k/(k+1)}$, for a value of $L$ to be determined\nlater.\nWe have\n\\begin{align*}\n&b_{n+1} \\\\\n &= b_n + a_n^{-1/k} - L ((n+1)^{k/(k+1)} - n^{k/(k+1)}) \\\\\n&= e_1 + e_2,\n\\end{align*}\nwhere\n\\begin{align*}\ne_1 &= b_n + a_n^{-1/k} - L^{-1/k} n^{-1/(k+1)} \\\\\ne_2 &= L ((n+1)^{k/(k+1)} - n^{k/(k+1)}) \\\\\n&\\quad - L^{-1/k} n^{-1/(k+1)}.\n\\end{align*}\nWe first estimate $e_1$.\nFor $-1 < m < 0$, by the convexity of $(1+x)^m$\nand $(1+x)^{1-m}$, we have\n\\begin{align*}\n1 + mx &\\leq (1+x)^m \\\\\n&\\leq 1 + mx (1+x)^{m-1}.\n\\end{align*}\nHence\n\\begin{align*}\n-\\frac{1}{k} L^{-(k+1)/k} n^{-1} b_n &\\leq e_1 - b_n \\\\\n&\\leq\n-\\frac{1}{k} b_n a_n^{-(k+1)/k}.\n\\end{align*}\nNote that both bounds have sign opposite to $b_n$; moreover,\nby the bound $a_n = \\Omega(n^{(k-1)/k})$, both bounds have absolutely\nvalue strictly less than that of $b_n$ for $n$ sufficiently large. Consequently,\nfor $n$ large,\n\\[\n|e_1| \\leq |b_n|.\n\\]\nWe now work on $e_2$.\nBy Taylor's theorem\nwith remainder applied to $(1+x)^m$ for $x > 0$ and $0 < m < 1$,\n\\begin{align*}\n1+mx &\\geq (1+x)^m \\\\\n&\\geq 1 + mx + \\frac{m(m-1)}{2} x^2.\n\\end{align*}\nThe ``main term'' of $L ((n+1)^{k/(k+1)} - n^{k/(k+1)})$\nis $L \\frac{k}{k+1} n^{-1/(k+1)}$. To make this coincide with\n$L^{-1/k} n^{-1/(k+1)}$, we take\n\\[\nL = \\left( \\frac{k+1}{k} \\right)^{k/(k+1)}.\n\\]\nWe then find that\n\\[\n|e_2| = O(n^{-2}),\n\\]\nand because $b_{n+1} = e_1 + e_2$, we have\n$|b_{n+1}| \\leq |b_n| + |e_2|$. Hence\n\\[\n|b_n| = O\\left (\\sum_{i=1}^n i^{-2} \\right) = O(1),\n\\]\nand so\n\\[\n\\lim_{n \\to \\infty} \\frac{a_n^{k+1}}{n^k} = L^{k+1} = \\left( \\frac{k+1}{k} \\right)^k.\n\\]\n\n\\textbf{Remark:}\nThe case $k=2$ appeared on the 2004 Romanian Olympiad (district level).\n\n\\textbf{Remark:}\nOne can make a similar argument for any sequence given by\n$a_{n+1} = a_n + f(a_n)$, when $f$ is a \\emph{decreasing} function.\n\n\\textbf{Remark:}\nRichard Stanley suggests a heuristic for determining the asymptotic\nbehavior of sequences of this type: replace the given recursion\n\\[\na_{n+1} - a_n = a_n^{-1/k}\n\\]\nby the differential equation\n\\[\ny' = y^{-1/k}\n\\]\nand determine the asymptotics of the latter.\n\\end{itemize}\n\n\n\\end{document}", "category": "Number Theory", "source": "PUTNAM", "year": 2006}
{"id": "usamo-2002-q1", "question": "Let $S$ be a set with $2002$ elements, and let $N$ be an integer with $0 \\leq N \\leq 2^{2002}$.\nProve that it is possible to color every subset of $S$\neither black or white so that the following conditions hold:\n\\begin{enumerate}\n  \\ii[(a)] the union of any two white subsets is white;\n  \\ii[(b)] the union of any two black subsets is black;\n  \\ii[(c)] there are exactly $N$ white subsets.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p337845}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $S$ be a set with $2002$ elements, and let $N$ be an integer with $0 \\leq N \\leq 2^{2002}$.\nProve that it is possible to color every subset of $S$\neither black or white so that the following conditions hold:\n\\begin{enumerate}\n  \\ii[(a)] the union of any two white subsets is white;\n  \\ii[(b)] the union of any two black subsets is black;\n  \\ii[(c)] there are exactly $N$ white subsets.\n\\end{enumerate}\n\\end{mdframed}\nWe will solve the problem with $2002$\nreplaced by an arbitrary integer $n \\ge 0$.\nIn other words, we prove:\n\\begin{claim*}\n  For any nonnegative integers $n$ and $N$ with $0 \\le N \\le 2^n$,\n  it is possible to color the $2^n$ subsets\n  of $\\{1, \\dots, n\\}$ black and white\n  satisfying the conditions of the problem.\n\\end{claim*}\nThe proof is by induction on $n$.\nWhen $n = 1$ the problem is easy to do by hand,\nso this gives us a base case.\n\nFor the inductive step, we divide into two cases:\n\\begin{itemize}\n  \\ii If $N \\le 2^{n-1}$,\n  then we take a coloring of subsets of $\\{1, \\dots, n-1\\}$\n  with $N$ white sets;\n  then we color the remaining $2^{n-1}$ sets\n  (which contain $n$) black.\n\n  \\ii If $N > 2^{n-1}$,\n  then we take a coloring of subsets of $\\{1, \\dots, n-1\\}$\n  with $N - 2^{n-1}$ white sets;\n  then we color the remaining $2^{n-1}$ sets\n  (which contain $n$) white.\n\\end{itemize}\n\\pagebreak", "category": "Combinatorics", "source": "USAMO", "year": 2002}
{"id": "usamo-2002-q2", "question": "Let $ABC$ be a triangle such that\n\\[\n  \\left( \\cot \\frac{A}{2} \\right)^2\n  + \\left( 2\\cot \\frac{B}{2} \\right)^2\n  + \\left( 3\\cot \\frac{C}{2} \\right)^2\n  = \\left( \\frac{6s}{7r} \\right)^2,\n\\]\nwhere $s$ and $r$ denote its semiperimeter and its inradius, respectively.\nProve that triangle $ABC$ is similar to a triangle $T$ whose side lengths are all positive integers\nwith no common divisors and determine these integers.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p337847}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle such that\n\\[\n  \\left( \\cot \\frac{A}{2} \\right)^2\n  + \\left( 2\\cot \\frac{B}{2} \\right)^2\n  + \\left( 3\\cot \\frac{C}{2} \\right)^2\n  = \\left( \\frac{6s}{7r} \\right)^2,\n\\]\nwhere $s$ and $r$ denote its semiperimeter and its inradius, respectively.\nProve that triangle $ABC$ is similar to a triangle $T$ whose side lengths are all positive integers\nwith no common divisors and determine these integers.\n\\end{mdframed}\nLet $x = s-a$, $y = s-b$, $z = s-c$ in the usual fashion, then the equation reads\n\\[ x^2 + 4y^2 + 9z^2 = \\left( \\frac67(x+y+z) \\right)^2. \\]\nHowever, by Cauchy-Schwarz, we have\n\\[ \\left( 1 + \\tfrac14 + \\tfrac19 \\right)\\left( x^2 + 4y^2 + 9z^2 \\right) \\ge \\left( x+y+z \\right)^2  \\]\nwith equality if and only if $1 : \\tfrac12 : \\tfrac13 = x : 2y : 3z$,\nid est $x : y : z = 1 : \\tfrac14 : \\tfrac19 = 36 : 9 : 4$.\nThis is equivalent to $y+z : z+x : x+y = 13 : 40 : 45$.\n\n%Wow.\n%I was laughing at how un-geometric this problem looked,\n%as it was the only geometry problem on the USAMO 2002.\n%Then I actually tried it and realized it was not geometry.\n\n\\begin{remark*}\nYou can tell this is not a geometry problem\nbecause you eliminate the cotangents right away to get an algebra problem\\dots\nand then you realize the problem claims that one equation\ncan determine three variables up to scaling,\nat which point you realize it has to be an inequality\n(otherwise degrees of freedom don't work).\nSo of course, Cauchy-Schwarz\\dots\n\\end{remark*}\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2002}
{"id": "usamo-2002-q3", "question": "Prove that any monic polynomial (a polynomial with leading coefficient $1$)\nof degree $n$ with real coefficients is the average\nof two monic polynomials of degree $n$ with $n$ real roots.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p337849}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nProve that any monic polynomial (a polynomial with leading coefficient $1$)\nof degree $n$ with real coefficients is the average\nof two monic polynomials of degree $n$ with $n$ real roots.\n\\end{mdframed}\nFirst,\n\\begin{lemma*}\n  If $p$ is a monic polynomial of degree $n$,\n  and $p(1)p(2) < 0$, $p(2)p(3) < 0$, \\dots, $p(n-1)p(n) < 0$\n  then $p$ has $n$ real roots.\n\\end{lemma*}\n\\begin{proof}\n  The intermediate value theorem already guarantees\n  the existence of $n-1$ real roots.\n\n  The last root is obtained by considering cases on $n \\pmod 2$.\n  \\begin{itemize}\n  \\ii If $n$ is even, then $p(1)$ and $p(n)$ have opposite sign,\n  while we must have either\n  \\[ \\lim_{x \\to -\\infty} p(x) = \\lim_{x \\to \\infty} p(x) = \\pm \\infty \\]\n  so we get one more root.\n  \\ii The $n$ odd case is similar,\n  with $p(1)$ and $p(n)$ now having the same sign,\n  but $\\lim_{x \\to -\\infty} p(x) = -\\lim_{x \\to \\infty} p(x)$ instead. \\qedhere\n \\end{itemize}\n\\end{proof}\n\nLet $f(n)$ be the monic polynomial and let\n$M > 1000\\max_{t=1, \\dots, n} |f(t)|+1000$.\nThen we may select reals $a_1, \\dots, a_n$ and $b_1, \\dots, b_n$\nsuch that for each $k = 1, \\dots, n$, we have\n\\begin{align*}\n  a_k + b_k &= 2f(k) \\\\\n  (-1)^k a_k & > M \\\\\n  (-1)^{k+1} b_k & > M.\n\\end{align*}\nWe may interpolate monic polynomials $g$ and $h$ through the $a_k$ and $b_k$\n(if the $a_k$, $b_k$ are selected ``generically'' from each other).\nThen one can easily check $f = \\tfrac12(g+h)$ works.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Algebra", "source": "USAMO", "year": 2002}
{"id": "usamo-2002-q4", "question": "Determine all functions $f \\colon \\RR \\to \\RR$ such that\n\\[ f(x^2 - y^2) = x f(x) - y f(y) \\]\nfor all pairs of real numbers $x$ and $y$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p337857}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nDetermine all functions $f \\colon \\RR \\to \\RR$ such that\n\\[ f(x^2 - y^2) = x f(x) - y f(y) \\]\nfor all pairs of real numbers $x$ and $y$.\n\\end{mdframed}\nThe answer is $f(x) = cx$, $c \\in \\RR$ (these obviously work).\n\nFirst, by putting $x=0$ and $y=0$ respectively\nwe have \\[ f(x^2) = xf(x) \\quad\\text{and}\\quad f(-y^2) = -yf(y). \\]\nFrom this we deduce that $f$ is odd, in particular $f(0) = 0$.\nThen, we can rewrite the given as $f(x^2-y^2) + f(y^2) = f(x^2)$.\nCombined with the fact that $f$ is odd, we deduce that $f$ is additive\n(i.e. $f(a+b)=f(a)+f(b)$).\n\n\\begin{remark*}\n  [Philosophy]\n  At this point we have $f(x^2) \\equiv xf(x)$ and $f$ additive,\n  and everything we have including the given equation is a direct corollary of these two.\n  So it makes sense to only focus on these two conditions.\n\\end{remark*}\n\nThen\n\\begin{align*}\n  f( (x+1)^2 ) &= (x+1)f(x+1) \\\\\n  \\implies f(x^2) + 2f(x) + f(1)\n  &= (x+1)f(x) + (x+1)f(1)\n\\end{align*}\nwhich readily gives $f(x) = f(1)x$.\n\\pagebreak", "category": "Algebra", "source": "USAMO", "year": 2002}
{"id": "usamo-2002-q5", "question": "Let $a$, $b$ be integers greater than $2$.\nProve that there exists a positive integer $k$\nand a finite sequence $n_1, n_2, \\dots, n_k$ of\npositive integers such that $n_1 = a$, $n_k = b$,\nand $n_i n_{i+1}$ is divisible by $n_i + n_{i+1}$\nfor each $i$ ($1 \\leq i < k$).", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p337862}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a$, $b$ be integers greater than $2$.\nProve that there exists a positive integer $k$\nand a finite sequence $n_1, n_2, \\dots, n_k$ of\npositive integers such that $n_1 = a$, $n_k = b$,\nand $n_i n_{i+1}$ is divisible by $n_i + n_{i+1}$\nfor each $i$ ($1 \\leq i < k$).\n\\end{mdframed}\nConsider a graph $G$ on the vertex set $\\{3, 4, \\dots\\}$\nand with edges between $v$, $w$ if $v + w \\mid vw$;\nthe problem is equivalent to showing that $G$ is connected.\n\nFirst, note that $n$ is connected to $n(n-1)$, $n(n-1)(n-2)$, etc.\\\nup to $n!$.\nBut for $n > 2$, $n!$ is connected to $(n+1)!$ too:\n\\begin{itemize}\n  \\ii $n! \\to (n+1)!$ if $n$ is even\n  \\ii $n! \\to 2n! \\to (n+1)!$ if $n$ is odd.\n\\end{itemize}\nThis concludes the problem.\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 2002}
{"id": "usamo-2002-q6", "question": "I have an $n \\times n$ sheet of stamps, from which I've been asked\nto tear out blocks of three adjacent stamps in a single row or column.\n(I can only tear along the perforations separating adjacent stamps,\nand each block must come out of the sheet in one piece.)\nLet $b(n)$ be the smallest number of blocks I can tear out\nand make it impossible to tear out any more blocks.\nProve that there are real constants $c$ and $d$ such that\n\\[ \\frac{1}{7} n^2 - cn \\leq b(n) \\leq \\frac{1}{5} n^2 + dn  \\]\nfor all $n > 0$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p337852}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nI have an $n \\times n$ sheet of stamps, from which I've been asked\nto tear out blocks of three adjacent stamps in a single row or column.\n(I can only tear along the perforations separating adjacent stamps,\nand each block must come out of the sheet in one piece.)\nLet $b(n)$ be the smallest number of blocks I can tear out\nand make it impossible to tear out any more blocks.\nProve that there are real constants $c$ and $d$ such that\n\\[ \\frac{1}{7} n^2 - cn \\leq b(n) \\leq \\frac{1}{5} n^2 + dn  \\]\nfor all $n > 0$.\n\\end{mdframed}\nFor the lower bound: there are $2n(n-2)$ places one could put a block.\nNote that each block eliminates at most $14$ such places.\n\nFor the upper bound, the construction of $\\frac15$ is easy to build.\nHere is an illustration of one possible construction\nfor $n=9$ which generalizes readily,\nusing only vertical blocks.\n\\[\n\\begin{bmatrix}\n  A &   & E &   & I & L &   & P &   \\\\\n  A &   & E & G &   & L &   & P & R \\\\\n  A & C &   & G &   & L & N &   & R \\\\\n    & C &   & G & J &   & N &   & R \\\\\n    & C & F &   & J &   & N & Q &   \\\\\n  B &   & F &   & J & M &   & Q &   \\\\\n  B &   & F & H &   & M &   & Q & S \\\\\n  B & D &   & H &   & M & O &   & S \\\\\n    & D &   & H & K &   & O &   & S \\\\\n\\end{bmatrix}\n\\]\n\nActually, for the lower bound,\none may improve $1/7$ to $1/6$.\nCount the number $A$ of pairs of adjacent squares\none of which is torn out and the other which is not:\n\\begin{itemize}\n  \\ii For every deleted block, there are eight neighboring squares,\n  at least two on each long edge which have been deleted too.\n  Hence $N \\le 6b(n)$.\n  \\ii For every block still alive and not on the border, there are\n  four neighboring squares, and clearly at least two are deleted.\n  Hence $N \\ge 2\\left( (n-2)^2 - 3b(n) \\right)$.\n\\end{itemize}\nCollating these solves the problem.\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "USAMO", "year": 2002}
{"id": "imo-2018-q1", "question": "Let $\\Gamma$ be the circumcircle of acute triangle $ABC$.\nPoints $D$ and $E$ lie on segments $AB$ and $AC$,\nrespectively, such that $AD = AE$.\nThe perpendicular bisectors of $\\ol{BD}$ and $\\ol{CE}$\nintersect the minor arcs $AB$ and $AC$ of $\\Gamma$\nat points $F$ and $G$, respectively.\nProve that the lines $DE$ and $FG$ are parallel.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10626500}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $\\Gamma$ be the circumcircle of acute triangle $ABC$.\nPoints $D$ and $E$ lie on segments $AB$ and $AC$,\nrespectively, such that $AD = AE$.\nThe perpendicular bisectors of $\\ol{BD}$ and $\\ol{CE}$\nintersect the minor arcs $AB$ and $AC$ of $\\Gamma$\nat points $F$ and $G$, respectively.\nProve that the lines $DE$ and $FG$ are parallel.\n\\end{mdframed}\nWe present a synthetic solution from the IMO shortlist\nas well as a complex numbers approach.\nWe also outline a trig solution (the one I found at IMO),\nand a fourth solution from Derek Liu.\n\n\n\\paragraph{Synthetic solution (from Shortlist).}\nConstruct parallelograms $AXFD$ and $AEGY$,\nnoting that $X$ and $Y$ lie on $\\Gamma$.\nAs $\\ol{XF} \\parallel \\ol{AB}$ we can let $M$\ndenote the midpoint of minor arcs $\\widehat{XF}$ and $\\widehat{AB}$\n(which coincide). Define $N$ similarly.\n\n\\begin{center}\n\\begin{asy}\npair A = dir(110);\npair B = dir(210);\npair C = dir(330);\npair F = dir(190);\npair M = dir(160);\npair N = dir(40);\npair G = M*N/F;\npair K = foot(F, A, B);\npair L = foot(G, A, C);\npair D = -B+2*K;\npair E = -C+2*L;\npair X = M*M/F;\npair Y = N*N/G;\nfilldraw(unitcircle, opacity(0.1)+lightcyan, lightblue);\ndraw(D--B--C--E--cycle, lightblue);\n\ndraw(X--A, red);\ndraw(A--Y, pink);\ndraw(F--X, heavygreen);\ndraw(Y--G, heavygreen);\ndraw(F--G, dotted+blue);\ndraw(M--N, dotted+blue);\nfilldraw(A--X--F--D--cycle, opacity(0.1)+lightgreen, heavygreen);\nfilldraw(A--E--G--Y--cycle, opacity(0.1)+lightgreen, heavygreen);\ndraw(B--F, heavygreen);\ndraw(C--G, heavygreen);\n\ndraw(X--F, heavycyan+1);\ndraw(D--A--E, heavycyan+1);\ndraw(Y--G, heavycyan+1);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$F$\", F, dir(F));\ndot(\"$M$\", M, dir(M));\ndot(\"$N$\", N, dir(N));\ndot(\"$G$\", G, dir(G));\ndot(\"$D$\", D, dir(160));\ndot(\"$E$\", E, dir(80));\ndot(\"$X$\", X, dir(X));\ndot(\"$Y$\", Y, dir(Y));\n\n/* TSQ Source:\n\nA = dir 110\nB = dir 210\nC = dir 330\nF = dir 190\nM = dir 160\nN = dir 40\nG = M*N/F\nK := foot F A B\nL := foot G A C\nD = -B+2*K R160\nE = -C+2*L R80\nX = M*M/F\nY = N*N/G\nunitcircle 0.1 lightcyan / lightblue\nD--B--C--E--cycle lightblue\n\nX--A red\nA--Y pink\nF--X heavygreen\nY--G heavygreen\nF--G dotted blue\nM--N dotted blue\nA--X--F--D--cycle 0.1 lightgreen / heavygreen\nA--E--G--Y--cycle 0.1 lightgreen / heavygreen\nB--F heavygreen\nC--G heavygreen\n\nX--F heavycyan+1\nD--A--E heavycyan+1\nY--G heavycyan+1\n\n*/\n\\end{asy}\n\\end{center}\n\nObserve that $XF = AD = AE = YG$,\nso arcs $\\widehat{XF}$ and $\\widehat{YG}$ have equal measure;\nhence arcs $\\widehat{MF}$ and $\\widehat{NG}$ have equal measure;\ntherefore $\\ol{MN} \\parallel \\ol{FG}$.\n\nSince $\\ol{MN}$ and $\\ol{DE}$ are both perpendicular\nto the $\\angle A$ bisector, we're done.\n\n\\paragraph{Complex numbers solution.}\nLet $b$, $c$, $f$, $g$, $a$ be as usual.\nNote that\n\\begin{align*}\n  d-a &= \\left( 2 \\cdot \\frac{f+a+b-ab\\ol f}{2} -b \\right)-a\n    = f - \\frac{ab}{f} \\\\\n  e-a &= g - \\frac{ac}{g}\n\\end{align*}\nWe are given $AD = AE$ from which one deduces\n\\begin{align*}\n  \\left( \\frac{e-a}{d-a} \\right)^2 &= \\frac cb\n  \\implies \\frac{(g^2-ac)^2}{(f^2-ab)^2} = \\frac{g^2 c}{f^2 b} \\\\\n  \\implies bc(bg^2-cf^2)a^2 &= g^2f^4c - f^2g^4b = f^2g^2(f^2c-g^2b) \\\\\n  \\implies bc \\cdot a^2 &= (fg)^2 \\implies \\left( -\\frac{fg}{a} \\right)^2 = bc.\n\\end{align*}\nSince $\\frac{-fg}{a}$ is the point $X$ on the circle\nwith $\\ol{AX} \\perp \\ol{FG}$,\nwe conclude $\\ol{FG}$ is either parallel or perpendicular\nto the $\\angle A$-bisector; it must the latter\nsince the $\\angle A$-bisector separates the two minor arcs.\n\n\\paragraph{Trig solution (outline).}\nLet $\\ell$ denote the $\\angle A$ bisector.\nFix $D$ and $F$.\nWe define the phantom point $G'$ such that $\\ol{FG'} \\perp \\ell$\nand $E'$ on side $\\ol{AC}$ such that $GE'=GC$.\n\\begin{claim*}\n  [Converse of the IMO problem]\n  We have $AD = AE'$, so that $E = E'$.\n\\end{claim*}\n\\begin{proof}\n  Since $\\ol{FG'} \\perp \\ell$,\n  one can deduce $\\angle FBD = \\half C + x$\n  and $\\angle GCA = \\half B + x$ for some $x$.\n  (One fast way to see this is to note that $\\ol{FG} \\parallel \\ol{MN}$\n  where $M$ and $N$ are in the first solution.)\n  Then $\\angle FAB = \\half C -x$ and $\\angle GAC = \\half B - x$.\n\n  Let $R$ be the circumradius.\n  Now, by the law of sines,\n  \\[ BF = 2R \\sin\\left( \\half C - x \\right). \\]\n  From there we get\n  \\begin{align*}\n  BD &= 2 \\cdot BF \\cos\\left(\\half C + x\\right)\n    = 4R \\cos\\left(\\half C+x\\right) \\sin \\left(\\half C-x\\right) \\\\\n  DA &= AB - BD = 2R\\sin C\n    - 4R\\cos\\left(\\half C+x\\right) \\sin\\left(\\half C -x\\right) \\\\\n  &= 2R\\left[ \\sin C - 2\\cos\\left( \\half C + x \\right) \\sin \\left( \\half C -x \\right) \\right] \\\\\n  &= 2R\\left[ \\sin C - \\left( \\sin C - \\sin 2x  \\right) \\right]\n  = 2R \\sin 2x.\n  \\end{align*}\n  A similar calculation gives $AE' = 2R \\sin 2x$ as needed.\n\\end{proof}\nThus, $\\ol{FG'} \\parallel \\ol{DE}$, so $G = G'$ as well.\nThis concludes the proof.\n\n\\paragraph{Synthetic solution from Derek Liu.}\nLet lines $FD$ and $GE$ intersect $\\Gamma$ again at $J$ and $K$, respectively.\n\\begin{center}\n\\begin{asy}\nunitsize(0.5cm);\nimport graph;\npair A=(-2.5,6), B=(-5.2,-3.9), C=(5.2,-3.9), D=(-4,0.5), E=(1,1.5), F=(-6.39,-1.21), G=(6.36,1.33), J=(3.19,5.66), K=(-6.27,1.72);\ndraw(Circle((0,0),6.5)); draw(A--B--C--A); draw(B--F--J--A--K--G--C); draw(Circle(A,5.7),dashed);\ndot(A); dot(B); dot(C); dot(D); dot(E); dot(F); dot(G); dot(J); dot(K);\nlabel(\"$A$\",A,N);\nlabel(\"$B$\",B,SW);\nlabel(\"$C$\",C,SE);\nlabel(\"$D$\",D,SSE);\nlabel(\"$E$\",E,S);\nlabel(\"$F$\",F,W);\nlabel(\"$G$\",G,E);\nlabel(\"$J$\",J,ENE);\nlabel(\"$K$\",K,WSW);\n\\end{asy}\n\\end{center}\nNotice that $\\triangle BFD\\sim\\triangle JAD$; as $FB=FD$, it follows that $AJ=AD$.\nLikewise, $\\triangle CGE\\sim\\triangle KAE$ and $GC=GE$, so $AK=AE$.\nHence,\n\\[ AK=AE=AD=AJ, \\]\nso $DEJK$ is cyclic with center $A$.\n\nIt follows that\n\\[ \\dang KED=\\dang KJD=\\dang KJF=\\dang KGF, \\]\nso we're done.\n\\begin{remark*}\nNote that $K$ and $J$ must be distinct for this solution to work.\nSince $G$ and $K$ lie on opposite sides of $AC$, $K$ is on major arc $ABC$.\nAs $AK=AD=AE\\le \\min(AB,AC)$, $K$ lies on minor arc $AB$.\nSimilarly, $J$ lies on minor arc $AC$, so $K\\neq J.$\n\\end{remark*}\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2018}
{"id": "imo-2018-q2", "question": "Find all integers $n \\geq 3$ for which\nthere exist real numbers $a_1, a_2, \\dots, a_n$ satisfying\n\\[ a_i a_{i+1} +1 = a_{i+2} \\]\nfor $i=1,2, \\dots, n$, where indices are taken modulo $n$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10626524}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all integers $n \\geq 3$ for which\nthere exist real numbers $a_1, a_2, \\dots, a_n$ satisfying\n\\[ a_i a_{i+1} +1 = a_{i+2} \\]\nfor $i=1,2, \\dots, n$, where indices are taken modulo $n$.\n\\end{mdframed}\nThe answer is $3 \\mid n$,\nachieved by $(-1,-1,2,-1,-1,2,\\dots)$.\nWe present two solutions.\n\n\\paragraph{First solution by inequalities.}\nWe compute $a_i a_{i+1} a_{i+2}$ in two ways:\n\\begin{align*}\n  a_i a_{i+1} a_{i+2} &= [a_{i+2}-1]a_{i+2} = a_{i+2}^2 - a_{i+2} \\\\\n  &= a_i [a_{i+3}-1] = a_i a_{i+3} - a_i.\n\\end{align*}\nCyclically summing $a_{i+2}^2 - a_{i+2} = a_i a_{i+3} - a_i$ then gives\n\\[ \\sum_i a_{i+2}^2 = \\sum_i a_i a_{i+3}\n  \\iff \\sum_{\\text{cyc}} \\left( a_i - a_{i+3} \\right)^2 = 0.  \\]\nThis means for inequality reasons the sequence is $3$-periodic.\nSince the sequence is clearly not $1$-periodic,\nas $x^2 + 1 = x$ has no real solutions.\nThus $3 \\mid n$.\n\n\\paragraph{Second solution by sign counting.}\nExtend $a_n$ to be a periodic sequence.\nThe idea is to look at the signs, and show the sequence\nof the signs must be $--+$ repeated.\nThis takes several steps:\n\\begin{itemize}\n  \\ii The pattern $---$ is impossible. Obvious, since the third term should be $ > 1$.\n  \\ii The pattern $++$ is impossible. Then the sequence becomes strictly increasing,\n  hence may not be periodic.\n  \\ii Zeros are impossible. If $a_1 = 0$, then $a_2 = 0$, $a_3 > 0$, $a_4 > 0$,\n  which gives the impossible $++$.\n  \\ii The pattern $--+-+$ is impossible.\n  Compute the terms:\n  \\begin{align*}\n    a_1 &= -x < 0 \\\\\n    a_2 &= -y < 0 \\\\\n    a_3 &= 1 + xy > 1 \\\\\n    a_4 &= 1 - y(1+xy) < 0 \\\\\n    a_5 &= 1 + (1+xy)(1-y(1+xy)) < 1.\n  \\end{align*}\n  But now\n  \\[ a_6 - a_5 = (1 + a_5 a_4) - (1 + a_3 a_4)\n    = a_4 (a_5 - a_3) > 0 \\]\n  since $a_5 > 1 > a_3$.\n  This means we have the impossible $++$ pattern.\n  \\ii The infinite alternating pattern $-+-+-+-+\\dots$ is impossible.\n  Note that\n  \\[ a_1 a_2 + 1 = a_3 < 0 < a_4 = 1 + a_2 a_3 \\implies a_1 < a_3 \\]\n  since $a_2 > 0$;\n  extending this we get $a_1 < a_3 < a_5 < \\dots$\n  which contradicts the periodicity.\n\\end{itemize}\nWe finally collate the logic of sign patterns.\nSince the pattern is not alternating, there must be $--$ somewhere.\nAfterwards must be $+$, and then after that must be two minus signs\n(since one minus sign is impossible by impossibility of $--+-+$\nand $---$ is also forbidden);\nthus we get the periodic $--+$ as desired.\n\\pagebreak", "category": "Algebra", "source": "IMO", "year": 2018}
{"id": "imo-2018-q3", "question": "An \\emph{anti-Pascal triangle} is an equilateral triangular array\nof numbers such that, except for the numbers in the bottom row,\neach number is the absolute value of the difference\nof the two numbers immediately below it.\nFor example, the following array is an anti-Pascal triangle\nwith four rows which contains every integer from $1$ to $10$.\n\\begin{center}\n\\begin{tikzpicture}[scale = 0.8]\n\\node at (1.5,2.58) {$4$};\n\\node at (1,1.72) {$2$};\n\\node at (2,1.72) {$6$};\n\\node at (0.5,0.86) {$5$};\n\\node at (1.5,0.86) {$7$};\n\\node at (2.5,0.86) {$1$};\n\\node at (0,0) {$8$};\n\\node at (1,0) {$3$};\n\\node at (2,0) {$10$};\n\\node at (3,0) {$9$};\n\\end{tikzpicture}\n\\end{center}\nDoes there exist an anti-Pascal triangle with $2018$ rows\nwhich contains every integer from $1$ to $1+2+\\dots +2018$?", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10626557}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nAn \\emph{anti-Pascal triangle} is an equilateral triangular array\nof numbers such that, except for the numbers in the bottom row,\neach number is the absolute value of the difference\nof the two numbers immediately below it.\nFor example, the following array is an anti-Pascal triangle\nwith four rows which contains every integer from $1$ to $10$.\n\\begin{center}\n\\begin{tikzpicture}[scale = 0.8]\n\\node at (1.5,2.58) {$4$};\n\\node at (1,1.72) {$2$};\n\\node at (2,1.72) {$6$};\n\\node at (0.5,0.86) {$5$};\n\\node at (1.5,0.86) {$7$};\n\\node at (2.5,0.86) {$1$};\n\\node at (0,0) {$8$};\n\\node at (1,0) {$3$};\n\\node at (2,0) {$10$};\n\\node at (3,0) {$9$};\n\\end{tikzpicture}\n\\end{center}\nDoes there exist an anti-Pascal triangle with $2018$ rows\nwhich contains every integer from $1$ to $1+2+\\dots +2018$?\n\\end{mdframed}\nThe answer is no, there is no anti-Pascal triangle\nwith the required properties.\n\nLet $n = 2018$ and $N = 1+2+\\dots+n$.\nFor every number $d$ not in the bottom row,\ndraw an arrow from $d$ to the larger of the two numbers below it\n(i.e.\\ if $d=a-b$, draw $d \\to a$).\nThis creates an \\emph{oriented forest} (which looks like lightning strikes).\n\nConsider the directed path starting from the top vertex $A$.\nStarting from the first number, it increments by at least $1+2+\\dots+n$,\nsince the increments at each step in the path are distinct;\ntherefore equality must hold\nand thus the path from the top ends at $N = 1+2+\\dots+n$\nwith all the numbers $\\{1,2,\\dots,n\\}$ being close by.\nLet $B$ be that position.\n\n\\begin{center}\n\\begin{asy}\n  size(8cm);\n  pair P(int x, int y) {\n    return x*dir(60)+y*dir(0);\n  }\n  pair A = P(12,0);\n  draw(A--P(0,0)--P(0,12)--cycle, gray+0.4);\n  draw(A--P(11,1)--P(9,1)--P(8,2)--P(5,5)--P(3,7)--P(1,7)--P(0,8),\n    orange+1.1, EndArrow(TeXHead));\n  draw(P(0,7)--P(7,0), blue);\n  draw(P(0,9)--P(3,9), blue);\n  draw(P(7,0)--P(6,0)--P(5,1)--P(3,1)--P(2,2)--P(0,2),\n    orange+1.1, EndArrow(TeXHead));\n\n  dot(\"$A$\", A, dir(90));\n  dot(\"$B$\", P(0,8), dir(-90));\n  dot(\"$C$\", P(7,0), dir(150));\n  dot(\"$D$\", P(0,2), dir(-90));\n  dot(\"$X$\", P(0,7), dir(-90));\n  dot(\"$Y$\", P(0,9), dir(-90));\n  dot(P(3,9));\n\\end{asy}\n\\end{center}\nConsider the two left/right neighbors $X$ and $Y$ of the endpoint $B$.\nAssume that $B$ is to the right of the midpoint of the bottom side,\nand complete the equilateral triangle as shown to an apex $C$.\nConsider the lightning strike from $C$ hitting the bottom at $D$.\nIt travels at least $\\left\\lfloor n/2-1 \\right\\rfloor$ steps, by construction.\nBut the increases must be at least $n+1$, $n+2$, \\dots since $1,2,\\dots,n$\nare close to the $A \\to B$ lightning path.\nThen the number at $D$ is at least\n\\[ (n+1) + (n+2) + \\dots +\n  \\left( n+\\left( \\left\\lfloor n/2-1 \\right\\rfloor \\right) \\right)\n  > 1 + 2 + \\dots + n \\]\nfor $n \\ge 2018$, contradiction.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Combinatorics", "source": "IMO", "year": 2018}
{"id": "imo-2018-q4", "question": "A \\emph{site} is any point $(x,y)$ in the plane\nfor which $x,y \\in \\{1, \\dots, 20\\}$.\nInitially, each of the $400$ sites is unoccupied.\nAmy and Ben take turns placing stones on unoccupied sites,\nwith Amy going first;\nAmy has the additional restriction that no two of her stones\nmay be at a distance equal to $\\sqrt5$.\nThey stop once either player cannot move.\nFind the greatest $K$ such that Amy can ensure that\nshe places at least $K$ stones.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10632348}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA \\emph{site} is any point $(x,y)$ in the plane\nfor which $x,y \\in \\{1, \\dots, 20\\}$.\nInitially, each of the $400$ sites is unoccupied.\nAmy and Ben take turns placing stones on unoccupied sites,\nwith Amy going first;\nAmy has the additional restriction that no two of her stones\nmay be at a distance equal to $\\sqrt5$.\nThey stop once either player cannot move.\nFind the greatest $K$ such that Amy can ensure that\nshe places at least $K$ stones.\n\\end{mdframed}\nThe answer is $K = 100$.\n\nFirst, we show Amy can always place at least $100$ stones.\nIndeed, treat the problem as a grid with checkerboard coloring.\nThen Amy can choose to always play on one of the $200$ black squares.\nIn this way, she can guarantee half the black squares,\ni.e.\\ she can get $\\half \\cdot 200 = 100$ stones.\n\nSecond, we show Ben can prevent Amy from placing more than $100$ stones.\nDivide into several $4 \\times 4$ squares and then further partition\neach $4 \\times 4$ squares as shown in the grid below.\n\\[\n  \\left[\n  \\begin{array}{cccc}\n    1 & 2 & 3 & 4 \\\\\n    3 & 4 & 1 & 2 \\\\\n    2 & 1 & 4 & 3 \\\\\n    4 & 3 & 2 & 1\n  \\end{array}\n  \\right]\n\\]\nThe squares with each label form $4$-cycles by knight jumps.\nFor each such cycle, whenever Amy plays in the cycle,\nBen plays in the opposite point of the cycle,\npreventing Amy from playing any more stones in that original cycle.\nHence Amy can play at most in $1/4$ of the stones, as desired.\n\\pagebreak", "category": "Combinatorics", "source": "IMO", "year": 2018}
{"id": "imo-2018-q5", "question": "Let $a_1$, $a_2$, \\dots\\ be an infinite sequence of positive integers,\nand $N$ a positive integer.\nSuppose that for all integers $n \\ge N$, the expression\n\\[ \\frac{a_1}{a_2} + \\frac{a_2}{a_3} + \\dots\n  + \\frac{a_{n-1}}{a_n} + \\frac{a_n}{a_1} \\]\nis an integer.\nProve that $(a_n)$ is eventually constant.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10632353}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a_1$, $a_2$, \\dots\\ be an infinite sequence of positive integers,\nand $N$ a positive integer.\nSuppose that for all integers $n \\ge N$, the expression\n\\[ \\frac{a_1}{a_2} + \\frac{a_2}{a_3} + \\dots\n  + \\frac{a_{n-1}}{a_n} + \\frac{a_n}{a_1} \\]\nis an integer.\nProve that $(a_n)$ is eventually constant.\n\\end{mdframed}\nThe condition implies that the difference\n\\[ S(n) = \\frac{a_{n+1} - a_n}{a_1} + \\frac{a_n}{a_{n+1}} \\]\nis an integer for all $n > N$.\nWe proceed by $p$-adic valuation only henceforth;\nfix a prime $p$.\nThen analyzing the $\\nu_p$, we immediately get that for $n > N$:\n\\begin{itemize}\n\\ii If $\\nu_p(a_n) < \\nu_p(a_{n+1})$, then $\\nu_p(a_{n+1}) = \\nu_p(a_1)$.\n\\ii If $\\nu_p(a_n) = \\nu_p(a_{n+1})$, no conclusion.\n\\ii If $\\nu_p(a_n) > \\nu_p(a_{n+1})$,\nthen $\\nu_p(a_{n+1}) \\ge \\nu_p(a_1)$.\n\\end{itemize}\nIn other words:\n\\begin{claim*}\nLet $p$ be a prime.  Consider the sequence\n$\\nu_p(a_{N+1})$, $\\nu_p(a_{N+2})$, \\dots.\nThen either:\n\\begin{itemize}\n  \\ii We have $\\nu_p(a_{N+1}) \\ge \\nu_p(a_{N+2}) \\ge \\dots$\n  and so on, i.e.\\ the sequence is weakly decreasing immediately; or\n  \\ii For some index $K > N$ we have\n  $\\nu_p(a_K) < \\nu_p(a_{K+1}) = \\nu_p(a_{K+2}) = \\dots = \\nu_p(a_1)$,\n  i.e.\\ the sequence ``jumps'' to $\\nu_p(a_1)$\n  at some point and then stays there forever after.\n  Note this requires $\\nu_p(a_1) > 0$.\n\\end{itemize}\n\\end{claim*}\n\nA cartoon of the situation is drawn below.\n\\begin{center}\n  \\begin{asy}\n    label(\"$\\nu_p(a_1)$\", (0,3), dir(180), deepcyan);\n    draw( (0,3)--(11,3), blue+dotted );\n    draw( (0,9)--(0,-1)--(12,-1), black, Arrows );\n    dot( (1,6), red );\n    dot( (2,5), red );\n    dot( (3,5), red );\n    dot( (4,5), red );\n    dot( (5,4), red );\n    dot( (6,4), red );\n    dot( (7,4), red );\n    dot( (8,3), red );\n    dot( (1,9), darkred );\n    dot( (2,7), darkred );\n    dot( (3,6), darkred );\n    dot( (4,6), darkred );\n    dot( (5,6), darkred );\n    dot( (6,6), darkred );\n    dot( (7,6), darkred );\n    dot( (8,6), darkred );\n    dot( (9,6), darkred );\n    draw( (1,6)--(2,5)--(4,5)--(5,4)--(7,4)--(8,3), red );\n    draw( (1,9)--(2,7)--(3,6)--(4,6)--(9,6), darkred );\n    dot( (1,1), brown );\n    dot( (2,1), brown );\n    dot( (3,1), brown );\n    dot( (4,1), brown );\n    dot( (5,1), brown );\n    dot( (6,3), brown );\n    dot( (6,3), brown );\n    draw( (1,1)--(5,1)--(6,3), brown );\n    dot( (1,0), orange );\n    dot( (2,0), orange );\n    dot( (3,0), orange );\n    dot( (4,0), orange );\n    dot( (5,0), orange );\n    dot( (6,0), orange );\n    dot( (7,0), orange );\n    dot( (8,0), orange );\n    dot( (9,0), orange );\n    draw( (1,0)--(9,0), orange );\n    draw( (1,-0.8)--(1,-1.2) );\n    draw(\"$n > N$\", (1,-1.2), dir(-90) );\n  \\end{asy}\n\\end{center}\n\nAs only finitely many primes $p$ divide $a_1$,\nafter some time $\\nu_p(a_n)$ is fixed for all such $p \\mid a_1$.\nAfterwards, the sequence satisfies $a_{n+1} \\mid a_n$ for each $n$,\nand thus must be eventually constant.\n\n\\begin{remark*}\n  This solution is almost completely $p$-adic,\n  in the sense that I think a similar result\n  holds if one replaces $a_n \\in \\ZZ$\n  by $a_n \\in \\ZZ_p$ for any particular prime $p$.\n  In other words, the primes almost do not talk to each other.\n\n  There is one caveat: if $x_n$ is an integer sequence\n  such that $\\nu_p(x_n)$ is eventually constant for each prime\n  then $x_n$ may not be constant.\n  For example, take $x_n$ to be the $n$th prime!\n  That's why in the first claim (applied to co-finitely many of the primes),\n  we need the stronger non-decreasing condition,\n  rather than just eventually constant.\n\\end{remark*}\n\n\\begin{remark*}\n  An alternative approach is to show that, when the fractions $a_n / a_1$\n  is written in simplest form for $n = N+1, N+2, \\dots$,\n  the numerator and denominator are both weakly decreasing.\n  Hence it must eventually be constant; in which case it equals $\\frac11$.\n\\end{remark*}\n\\pagebreak", "category": "Number Theory", "source": "IMO", "year": 2018}
{"id": "imo-2018-q6", "question": "A convex quadrilateral $ABCD$ satisfies $AB \\cdot CD = BC \\cdot DA$.\nPoint $X$ lies inside $ABCD$ so that\n\\[ \\angle XAB=\\angle XCD \\quad \\text{ and } \\quad \\angle XBC=\\angle XDA. \\]\nProve that $\\angle BXA + \\angle DXC=180\\dg$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10632360}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA convex quadrilateral $ABCD$ satisfies $AB \\cdot CD = BC \\cdot DA$.\nPoint $X$ lies inside $ABCD$ so that\n\\[ \\angle XAB=\\angle XCD \\quad \\text{ and } \\quad \\angle XBC=\\angle XDA. \\]\nProve that $\\angle BXA + \\angle DXC=180\\dg$.\n\\end{mdframed}\nWe present two solutions by inversion.\nThe first is the official one.\nThe second is a solution via inversion, completed by USA5 Michael Ren.\n\n\\paragraph{Official solution by inversion.}\nIn what follows a convex quadrilateral is called\n\\emph{quasi-harmonic} if $AB \\cdot CD = BC \\cdot DA$.\n\n\\begin{claim*}\n  A quasi-harmonic quadrilateral is determined\n  up to similarity by its angles.\n\\end{claim*}\n\\begin{proof}\n  Do some inequalities.\n\\end{proof}\n\\begin{remark*}\n  This could be expected by degrees of freedom;\n  a quadrilateral has four degrees of freedom up to similarity;\n  the pseudo-harmonic condition is one\n  while the measures of angles $\\angle A$, $\\angle B$, $\\angle C$, $\\angle D$\n  (summing to $360\\dg$) provide three degrees of freedom.\n  (Note that the point $X$ plays no role in this comment.)\n\\end{remark*}\n\nPerforming an inversion at $X$, one obtains a\nsecond quasi-harmonic quadrilateral\n$A^\\ast B^\\ast C^\\ast D^\\ast$ which has the same angles\nas the original one, $\\angle D^\\ast = \\angle A$,\n$\\angle A^\\ast = \\angle B$, and so on.\nThus by the claim we obtain similarity\n\\[ D^\\ast A^\\ast B^\\ast C^\\ast \\sim ABCD. \\]\nIf one then maps $D^\\ast A^\\ast B^\\ast C^\\ast$,\nonto $ABCD$, the image of $X^\\ast$\nbecomes a point isogonally conjugate to $X$.\nIn other words, $X$ has an isogonal conjugate in $ABCD$.\n\nIt is well-known that this is equivalent to\n$\\angle BXA + \\angle DXC = 180\\dg$,\nfor example by inscribing an ellipse with foci $X$ and $X^\\ast$.\n\n\\paragraph{Second solution: ``rhombus inversion'', by Michael Ren.}\nSince\n\\[ \\frac{AB}{AD} = \\frac{CB}{CD} \\]\nand\n\\[ \\frac{BA}{BC} = \\frac{DA}{DC} \\]\nit follows that $B$ and $D$ lie on an Apollonian circle $\\omega_{AC}$\nthrough $A$ and $C$,\nwhile $A$ and $C$ lie on an Apollonian circle $\\omega_{BD}$\nthrough $B$ and $D$.\nWe let these two circles intersect at a point $P$ inside $ABCD$.\n\nThe main idea is then to\nperform an inversion about $P$ with radius $1$.\nWe obtain:\n%\\paragraph{Rhombus construction.}\n\\begin{lemma*}\n  The image of $ABCD$ is a rhombus.\n\\end{lemma*}\n\\begin{proof}\n  By the inversion distance formula, we have\n  \\[ \\frac{1}{A'B'} = \\frac{PA}{AB} \\cdot PB = \\frac{PC}{BC} \\cdot PB = \\frac{1}{B'C'} \\]\n  and so $A'B' = B'C'$.\n  In a similar way, we derive $B'C' = C'D' = D'A'$,\n  so the image is a rhombus as claimed.\n\\end{proof}\n\nLet us now translate the angle conditions.\nWe were given that $\\dang XAB = \\dang XCD$, but\n\\begin{align*}\n  \\dang XAB &= \\dang XAP + \\dang PAB = \\dang PX'A' + \\dang A'B'P \\\\\n  \\dang XCD &= \\dang XCP + \\dang PCD = \\dang PX'C' + \\dang C'D'P\n  \\intertext{so subtracting these gives}\n  \\dang A'X'C' &= \\dang A'B'P + \\dang PD'C' = \\dang (A'B', B'P) + \\dang (PD', C'D') \\\\\n  &= \\dang (A'B', B'P) + \\dang (PD', A'B') = \\dang D' P B'. \\tag{1}\n\\end{align*}\nsince $\\ol{A'B'} \\parallel \\ol{C'D'}$.\nSimilarly, we obtain\n\\[ \\dang B'X'D' = \\dang A'PC' \\tag{2}. \\]\nWe now translate the desired condition.\nSince\n\\begin{align*}\n  \\dang AXB &= \\dang AXP + \\dang PXB = \\dang PA'X' + \\dang X'B'P \\\\\n  \\dang CXD &= \\dang CXP + \\dang PXD = \\dang PC'X' + \\dang X'DP'\n\\end{align*}\nwe compute\n\\begin{align*}\n  \\dang AXB + \\dang CXD &= (\\dang PA'X' + \\dang X'B'P) + (\\dang PC'X' + \\dang X'D'P) \\\\\n  &= -\\left[ \\left( \\dang A'X'P + \\dang X'PA' \\right)\n    + \\left( \\dang PX'B' + \\dang B'PX' \\right) \\right] \\\\\n  &\\quad- \\left[ \\left( \\dang C'X'P + \\dang X'PC' \\right)\n    + \\left( \\dang PX'D' + \\dang D'PX'  \\right) \\right] \\\\\n  &= \\left[ \\dang PX'A' + \\dang BX'P + \\dang PX'C' + \\dang D'X'P  \\right] \\\\\n  &\\quad+ \\left[ \\dang A'PX' + \\dang X'PB' + \\dang C'PX' + \\dang X'PD' \\right] \\\\\n  &= \\dang A'PB' + \\dang C'PD' + \\dang B'X'C + \\dang D'X'A\n\\end{align*}\nand we wish to show this is equal to zero, i.e.\\\nthe desired becomes\n\\[ \\dang A'PB' + \\dang C'PD' + \\dang B'X'C + \\dang D'X'A = 0. \\tag{3} \\]\nIn other words, the problem is to show (1) and (2) implies (3).\n\nHenceforth drop apostrophes.\nHere is the inverted diagram (with apostrophes dropped).\n\\begin{center}\n\\begin{asy}\nsize(12cm);\npair A = (0,3);\npair B = (-8,0);\npair C = (0,-3);\npair D = (8,0);\n\npair X = (-5.6,7.8);\npair Y = reflect(circumcenter(A,C,X), circumcenter(D,B,X))*X;\npair Q = IP(circumcircle(A, Y, D), circumcircle(B, Y, C));\npair P = conj(Q);\n\nfilldraw(A--B--C--D--cycle, opacity(0.1)+lightred, red);\ndraw(A--C, red);\ndraw(B--D, red);\n\ndraw(B--X--D, lightgreen);\ndraw(A--P--C, lightgreen);\ndraw(C--X--A, lightblue);\ndraw(B--P--D, lightblue);\n\ndraw(circumcircle(A, X, C), heavycyan);\ndraw(circumcircle(B, X, D), heavycyan);\ndraw(circumcircle(B, Q, C), lightcyan);\ndraw(circumcircle(A, Q, D), lightcyan);\ndraw(Q--P, red);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$D$\", D, dir(D));\ndot(\"$X$\", X, dir(X));\ndot(\"$Y$\", Y, dir(Y));\ndot(\"$Q$\", Q, dir(Q));\ndot(\"$P$\", P, dir(P));\n\n/* TSQ Source:\n\nA = (0,3)\nB = (-8,0)\nC = (0,-3)\nD = (8,0)\n\nX = (-5.6,7.8)\nY = OP circumcircle A X C circumcircle B X D\nQ = IP circumcircle A Y D circumcircle B Y C\nP = conj(Q)\n\nA--B--C--D--cycle 0.1 lightred / red\nA--C red\nB--D red\n\nB--X--D lightgreen\nA--P--C lightgreen\nC--X--A lightblue\nB--P--D lightblue\n\ncircumcircle A X C heavycyan\ncircumcircle B X D heavycyan\ncircumcircle B Q C lightcyan\ncircumcircle A Q D lightcyan\nQ--P red\n\n*/\n\\end{asy}\n\\end{center}\n\nLet $Q$ denote the reflection of $P$\nand let $Y$ denote the second intersection of $(BQC)$ and $(AQD)$.\nThen\n\\begin{align*}\n  -\\dang AXC &= -\\dang DPB = \\dang BQD = \\dang BQY + \\dang YQD = \\dang BCY + \\dang YAD \\\\\n  &= \\dang(BC,CY) + \\dang(YA,AD) = \\dang YCA = -\\dang AYC.\n\\end{align*}\n% again using $\\ol{AB} \\parallel \\ol{CD}$.\nHence $XACY$ is concyclic; similarly $XBDY$ is concyclic.\n\n\\begin{claim*}\n  $X \\neq Y$.\n\\end{claim*}\n\\begin{proof}\n  To see this: Work pre-inversion assuming $AB < AC$.\n  Then $Q$ was the center of $\\omega_{BD}$.\n  If $T$ was the second intersection of $BA$ with $(QBC)$,\n  then $QB = QD = QT = \\sqrt{QA \\cdot QC}$, by shooting lemma.\n  Since $\\angle BAD < 180\\dg$,\n  it follows $(QBCY)$ encloses $ABCD$ (pre-inversion).\n  (This part is where the hypothesis that\n  $ABCD$ is convex with $X$ inside is used.)\n\\end{proof}\n\nFinally, we do an angle chase to finish:\n\\begin{align*}\n  \\dang DXA &= \\dang DXY + \\dang YXA = \\dang DBY + \\dang YCA \\\\\n  &= \\dang (DB, YB) + \\dang (CY, CA) = \\dang CYB + 90\\dg \\\\\n  &= \\dang CQB + 90\\dg = -\\dang APB + 90\\dg \\tag{4}.\n\\end{align*}\nSimilarly,\n\\[ \\dang BXC = \\dang DPC + 90\\dg. \\tag{5} \\]\n%% \\dang AXB = \\dang DYC + 90\\dg, \\quad\n%% \\dang CXD = \\dang BYC + 90\\dg.\nSumming (4) and (5) gives (3).\n% $\\dang BXC + \\dang DXA = (\\dang BPA + 90\\dg) + (\\dang DPC + 90\\dg) = -(\\dang APB + \\dang CPD)$.\n\n\n\\begin{remark*}\n  A difficult part of the problem in many solutions\n  is that the conclusion is false in the directed sense,\n  if the point $X$ is allowed to lie outside the quadrilateral.\n  We are saved in the first solution because the equivalence\n  of the isogonal conjugation requires $X$ inside the quadrilateral.\n  On the other hand, in the second solution,\n  the issue appears in the presence of the second point $Y$.\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Geometry", "source": "IMO", "year": 2018}
{"id": "imo-2011-q1", "question": "Given any set $A = \\{a_1, a_2, a_3, a_4\\}$ of four distinct\npositive integers, we denote the sum $a_1+a_2+a_3+a_4$ by $s_A$.\nLet $n_A$ denote the number of pairs $(i,j)$ with $1 \\le i < j \\le 4$\nfor which $a_i + a_j$ divides $s_A$.\nFind all sets $A$ of four distinct positive integers which achieve\nthe largest possible value of $n_A$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2363530}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nGiven any set $A = \\{a_1, a_2, a_3, a_4\\}$ of four distinct\npositive integers, we denote the sum $a_1+a_2+a_3+a_4$ by $s_A$.\nLet $n_A$ denote the number of pairs $(i,j)$ with $1 \\le i < j \\le 4$\nfor which $a_i + a_j$ divides $s_A$.\nFind all sets $A$ of four distinct positive integers which achieve\nthe largest possible value of $n_A$.\n\\end{mdframed}\nThere are two curves of solutions,\nnamely $\\{x,5x,7x,11x\\}$ and $\\{x,11x,19x,29x\\}$, for any positive integer $x$,\nachieving $n_A = 4$ (easy to check).\nWe'll show that $n_A \\le 4$ and equality holds only in one of the curves.\n\nLet $A = \\{a < b < c < d\\}$.\n\\begin{claim*}\n  We have $n_A \\le 4$ with equality iff\n  \\[ a+b \\mid c+d, \\quad a+c \\mid b+d, \\quad a+d = b+c. \\]\n\\end{claim*}\n\\begin{proof}\n  Note $a+b \\mid s_A \\iff a+b \\mid c+d$ etc.\n  Now $c+d \\nmid a+b$ and $b+d \\nmid a+c$ for size reasons, so we already have $n_A \\le 4$;\n  moreover $a+d \\mid b+c$ and $b+c \\mid a+d$ if and only if $a+d = b+c$.\n\\end{proof}\n\nWe now show the equality curve is the one above.\n\\[ a+c  \\mid b+d \\iff a+c \\mid -a+2b+c \\iff a+c \\mid 2(b-a). \\]\nSince $a+c > |b-a|$, so we must have $a+c=2(b-a)$.\nSo we now have\n\\begin{align*}\n  c &= 2b-3a \\\\\n  d &= b+c-a = 3b+c-4a.\n\\end{align*}\nThe last condition is\n\\[ a+b \\mid c+d = 5b-7a \\iff a+b \\mid 12a. \\]\nNow, let $x = \\gcd(a,b)$.\nThe expressions for $c$ and $d$ above imply that\n$x \\mid c,d$ so we may scale down so that $x = 1$.\nThen $\\gcd(a+b,a) = \\gcd(a,b) = 1$ and so $a+b \\mid 12$.\n\nWe have $c > b$, so $3a < b$.\nThe only pairs $(a,b)$ with $3a < 2b$, $\\gcd(a,b) = 1$ and $a+b \\mid 12$\nare $(a,b) \\in \\left\\{ (1,5), (1,11) \\right\\}$ which give the solutions earlier.\n\\pagebreak", "category": "Combinatorics", "source": "IMO", "year": 2011}
{"id": "imo-2011-q2", "question": "Let $\\mathcal{S}$ be a finite set of at least two points in the plane.\nAssume that no three points of $\\mathcal S$ are collinear.\nA \\emph{windmill} is a process that starts with a\nline $\\ell$ going through a single point $P \\in \\mathcal S$.\nThe line rotates clockwise about the \\emph{pivot} $P$ until the first time\nthat the line meets some other point belonging to $\\mathcal S$.\nThis point, $Q$, takes over as the new pivot,\nand the line now rotates clockwise about $Q$,\nuntil it next meets a point of $\\mathcal S$.\nThis process continues indefinitely.\n\nShow that we can choose a point $P$ in $\\mathcal S$ and\na line $\\ell$ going through $P$ such that the resulting windmill\nuses each point of $\\mathcal S$ as a pivot infinitely many times.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2363537}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $\\mathcal{S}$ be a finite set of at least two points in the plane.\nAssume that no three points of $\\mathcal S$ are collinear.\nA \\emph{windmill} is a process that starts with a\nline $\\ell$ going through a single point $P \\in \\mathcal S$.\nThe line rotates clockwise about the \\emph{pivot} $P$ until the first time\nthat the line meets some other point belonging to $\\mathcal S$.\nThis point, $Q$, takes over as the new pivot,\nand the line now rotates clockwise about $Q$,\nuntil it next meets a point of $\\mathcal S$.\nThis process continues indefinitely.\n\nShow that we can choose a point $P$ in $\\mathcal S$ and\na line $\\ell$ going through $P$ such that the resulting windmill\nuses each point of $\\mathcal S$ as a pivot infinitely many times.\n\\end{mdframed}\nOrient $\\ell$ in some direction,\nand color the plane such that its left half is red\nand right half is blue.\nThe critical observation is that:\n\\begin{claim*}\n  The number of points on the red side of $\\ell$ does not change,\n  nor does the number of points on the blue side\n  (except at a moment when $\\ell$ contains two points).\n\\end{claim*}\n\nThus, if $|\\mathcal S| = n+1$,\nit suffices to pick the initial configuration\nso that there are $\\left\\lfloor n/2 \\right\\rfloor$\nred and $\\left\\lceil n/2 \\right\\rceil$ blue points.\nThen when the line $\\ell$ does a full $180\\dg$ rotation,\nthe red and blue sides ``switch'',\nso the windmill has passed through every point.\n\n(See official shortlist for verbose write-up;\nthis is deliberately short to make a point.)\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2011}
{"id": "imo-2011-q3", "question": "Let $f \\colon \\RR \\to \\RR$ be a real-valued function\ndefined on the set of real numbers that satisfies\n\\[ f(x+y) \\leq yf(x) + f(f(x))\\]\nfor all real numbers $x$ and $y$.\nProve that $f(x) = 0$ for all $x \\leq 0$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2363539}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $f \\colon \\RR \\to \\RR$ be a real-valued function\ndefined on the set of real numbers that satisfies\n\\[ f(x+y) \\leq yf(x) + f(f(x))\\]\nfor all real numbers $x$ and $y$.\nProve that $f(x) = 0$ for all $x \\leq 0$.\n\\end{mdframed}\nWe begin by rewriting the given as\n\\[ f(z) \\le (z-x)f(x) + f(f(x)) \\quad\n  \\forall x,z \\in \\RR \\qquad (\\heartsuit) \\]\n(which is better anyways since control over inputs to $f$\nis more valuable).\nWe start by eliminating the double $f$:\nlet $z = f(w)$ to get\n\\[ f(f(w)) \\le (f(w)-x)f(x) + f(f(x)) \\]\nand then use the \\emph{symmetry trick} to write\n\\[ f(f(x)) \\le (f(x)-w)f(w) + f(f(w)) \\]\nso that when we sum we get\n\\[ wf(w) + xf(x) \\le 2f(x)f(w). \\]\n\n%(We remark now that if we set $w = 0$,\n%we find that $xf(x) \\le 2f(x)f(0)$ for all $x$;\n%since we know $f(0)$ should be zero, this is pretty good.)\n\nNext we use \\emph{cancellation trick}:\nset $w = 2f(x)$ in the above to get\n\\[ xf(x) \\le 0 \\quad \\forall x \\in \\RR. \\qquad (\\spadesuit) \\]\n\n\\begin{claim*}\n  For every $p \\in \\RR$, we have $f(p) \\le 0$.\n\\end{claim*}\n\\begin{proof}\n  Assume $f(p) > 0$ for some $p \\in \\RR$.\n  Then for any negative number $z$,\n  \\[ 0 \\overset{(\\spadesuit)}{\\le} f(z)\n    \\overset{(\\heartsuit)}{\\le} (z-p)f(p) + f(f(p)). \\]\n  which is false if we let $z \\to -\\infty$.\n\\end{proof}\n\nTogether with $(\\spadesuit)$ we derive $f(x) = 0$ for $x < 0$.\nFinally, letting $x$ and $z$ be any negative numbers\nin $(\\heartsuit)$, we get $f(0) \\ge 0$, so $f(0) = 0$ too.\n\\begin{remark*}\n  As another corollary of the claim, $f(f(x)) = 0$ for all $x$.\n\\end{remark*}\n\\begin{remark*}\n  A nontrivial example of a working $f$\n  is to take\n  \\[ f(x) = \\begin{cases}\n      -\\exp(\\exp(\\exp(x))) & x > 0 \\\\\n      0 & x \\le 0.\n    \\end{cases} \\]\n  or some other negative function growing rapidly in absolute value\n  for $x > 0$.\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Algebra", "source": "IMO", "year": 2011}
{"id": "imo-2011-q4", "question": "Let $n > 0$ be an integer.\nWe are given a balance and $n$ weights of weight $2^0$, $2^1$, \\dots, $2^{n-1}$.\nWe are to place each of the $n$ weights on the balance, one after another,\nin such a way that the right pan is never heavier than the left pan.\nAt each step we choose one of the weights\nthat has not yet been placed on the balance,\nand place it on either the left pan or the right pan,\nuntil all of the weights have been placed.\nDetermine the number of ways in which this can be done.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2365036}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n > 0$ be an integer.\nWe are given a balance and $n$ weights of weight $2^0$, $2^1$, \\dots, $2^{n-1}$.\nWe are to place each of the $n$ weights on the balance, one after another,\nin such a way that the right pan is never heavier than the left pan.\nAt each step we choose one of the weights\nthat has not yet been placed on the balance,\nand place it on either the left pan or the right pan,\nuntil all of the weights have been placed.\nDetermine the number of ways in which this can be done.\n\\end{mdframed}\nThe answer is $a_n = (2n-1)!!$.\n\nWe refer to what we're counting as a \\emph{valid $n$-sequence}:\nan order of which weights to place,\nand whether to place them on the left or right pan.\n\nWe use induction, with $n=1$ being obvious.\nNow consider the weight $2^0 = 1$.\n\\begin{itemize}\n  \\ii If we delete it from any valid $n$-sequence,\n  we get a valid $(n-1)$-sequence with all weights doubled.\n  \\ii Given a valid $(n-1)$-sequence with all weights doubled,\n  we may insert $2^0 = 1$ it into $2n-1$ ways.\n  Indeed, we may insert it anywhere, and designate it either left or right,\n  except we may not designate right if we choose to insert\n  $2^0 = 1$ at the very beginning.\n\\end{itemize}\nConsequently, we have that\n\\[ a_n = (2n-1) \\cdot a_{n-1}. \\]\nSince $a_1 = 1$, the conclusion follows.\n\n\\begin{remark*}\n  [Gabriel Levin]\n  An alternate approach can be done by considering the heaviest weight $2^{n-1}$\n  instead of the lightest weight $2^0=1$.\n  This gives a more complicated recursion:\n  \\[ a_n = \\sum_{k=0}^{n-1} \\binom{n-1}{k} 2^{n-k-1} (n-k-1)! a_k \\]\n  by summing over the index $k$ corresponding to the number of weights\n  placed before the heaviest weight $2^{n-1}$ is placed.\n\n  This recursion can then be rewritten as\n  \\begin{align*}\n    a_n &= \\sum_{k=0}^{n-1} \\binom{n-1}{k} 2^{n-k-1} (n-k-1)! a_k \\\\\n    &= (n-1)! \\sum_{k=0}^{n-1} \\frac{2^{n-k-1}a_k}{k!} \\\\\n    &= 2(n-1)! \\sum_{k=0}^{n-1} \\frac{2^{(n-1)-k-1}a_k}{k!} \\\\\n    &= 2(n-1)(n-2)! (\\sum_{k=0}^{(n-1)-1} \\frac{2^{(n-1)-k-1}a_k}{k!}) + 2(n-1)!\n  \\frac{\\frac12 a_{n-1}}{(n-1)!}\n    &= 2(n-1) a_{n-1} + a_{n-1}\n    &= (2n-1)a_{n-1}\n  \\end{align*}\n  and since $a_1 = 1$, we have $a_n = (2n-1)!!$ by induction on $n$.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "IMO", "year": 2011}
{"id": "imo-2011-q5", "question": "Let $f \\colon \\ZZ \\to \\ZZ_{>0}$ be a function such that\n$f(m-n) \\mid f(m) - f(n)$ for $m,n \\in \\ZZ$.\nProve that if $m,n \\in \\ZZ$ satisfy $f(m) \\le f(n)$\nthen $f(m) \\mid f(n)$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2365041}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $f \\colon \\ZZ \\to \\ZZ_{>0}$ be a function such that\n$f(m-n) \\mid f(m) - f(n)$ for $m,n \\in \\ZZ$.\nProve that if $m,n \\in \\ZZ$ satisfy $f(m) \\le f(n)$\nthen $f(m) \\mid f(n)$.\n\\end{mdframed}\nLet $P(m,n)$ denote the given assertion.\nFirst, we claim $f$ is even.\nThis is straight calculation:\n\\begin{itemize}\n  \\ii $P(x,0) \\implies f(x) \\mid f(x)-f(0)\n  \\implies f(x) \\mid M \\coloneq f(0)$.\n  \\ii $P(0,x) \\implies f(-x) \\mid M-f(x) \\implies\n  f(-x) \\mid f(x)$.\n  Analogously, $f(x) \\mid f(-x)$.\n  So $f(x) = f(-x)$ and $f$ is even.\n\\end{itemize}\n\n\\begin{claim*}\n  Let $x$, $y$, $z$ be integers with $x+y+z=0$.\n  Then among $f(x)$, $f(y)$, $f(z)$,\n  two of them are equal and divide the third.\n\\end{claim*}\n\\begin{proof}\n  Let $a = f(\\pm x)$, $b = f(\\pm y)$, $c = f(\\pm z)$\n  be positive integers.\n  Note that\n  \\begin{align*}\n    a &\\mid b-c \\\\\n    b &\\mid c-a \\\\\n    c &\\mid a-b\n  \\end{align*}\n  from $P(y,-z)$ and similarly.\n  WLOG $c = \\max(a,b,c)$; then $c > |a-b|$\n  so $a=b$.  Thus $a=b \\mid c$ from the first two.\n\\end{proof}\nThis implies the problem,\nby taking $x$ and $y$ in the previous claim\nto be the integers $m$ and $n$.\n\n\\begin{remark*}\n  At \\url{https://aops.com/community/c6h418981p2381909},\n  Davi Medeiros gives the following characterization\n  of functions $f$ satisfying the hypothesis.\n\n  Pick $f(0)$, $k$ positive integers,\n  a chain $d_1 \\mid d_2 \\mid \\dots \\mid d_k$ of divisors of $f(0)$,\n  and positive integers $a_1,a_2,\\dots,a_{k-1}$,\n  greater than $1$ (if $k=1$, $a_i$ doesn't exist, for every $i$).\n  We'll define $f$ as follows:\n  \\begin{itemize}\n    \\ii $f(n)=d_1$, for every integer $n$ that is not divisible by $a_1$;\n    \\ii $f(a_1n)=d_2$, for every integer $n$ that is not divisible by $a_2$;\n    \\ii $f(a_1a_2n)=d_3$, for every integer $n$ that is not divisible by $a_3$;\n    \\ii $f(a_1a_2a_3n)=d_4$, for every integer $n$ that is not divisible by $a_4$;\n    \\ii \\dots\n    \\ii $f(a_1a_2 \\dots a_{k-1}n)=d_k$, for every integer $n$;\n  \\end{itemize}\n\\end{remark*}\n\\pagebreak", "category": "Number Theory", "source": "IMO", "year": 2011}
{"id": "imo-2011-q6", "question": "Let $ABC$ be an acute triangle with circumcircle $\\Gamma$.\nLet $\\ell$ be a tangent line to $\\Gamma$, and let $\\ell_a$, $\\ell_b$, $\\ell_c$ be the lines obtained\nby reflecting $\\ell$ in the lines $BC$, $CA$, and $AB$, respectively.\nShow that the circumcircle of the triangle determined by the lines $\\ell_a$, $\\ell_b$, and $\\ell_c$\nis tangent to the circle $\\Gamma$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2365045}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be an acute triangle with circumcircle $\\Gamma$.\nLet $\\ell$ be a tangent line to $\\Gamma$, and let $\\ell_a$, $\\ell_b$, $\\ell_c$ be the lines obtained\nby reflecting $\\ell$ in the lines $BC$, $CA$, and $AB$, respectively.\nShow that the circumcircle of the triangle determined by the lines $\\ell_a$, $\\ell_b$, and $\\ell_c$\nis tangent to the circle $\\Gamma$.\n\\end{mdframed}\nThis is a hard problem with many beautiful solutions.\nThe following solution is not very beautiful but not too hard to find during an olympiad,\nas the only major insight it requires is the construction of $A_2$, $B_2$, and $C_2$.\n\n\\begin{center}\n  \\begin{asy}\n    size(11cm);\n    pair A = dir(110);\n    dot(\"$A$\", A, dir(A));\n    pair B = dir(195);\n    dot(\"$B$\", B, dir(160));\n    pair C = dir(325);\n    dot(\"$C$\", C, 1.4*dir(30));\n    pair P = dir(270);\n    dot(\"$P$\", P, dir(P));\n    draw(unitcircle);\n    draw(A--B--C--cycle);\n\n    pair U = P+(2,0);\n    pair V = 2*P-U;\n\n    pair X_1 = reflect(B,C)*P;\n    pair Y_1 = reflect(C,A)*P;\n    pair Z_1 = reflect(A,B)*P;\n    pair X_2 = extension(B, C, U, V);\n    dot(X_2);\n    pair Y_2 = extension(C, A, U, V);\n    dot(Y_2);\n    pair Z_2 = extension(A, B, U, V);\n    dot(Z_2);\n    draw(B--Z_2, dotted);\n    draw(C--Y_2, dotted);\n    draw(C--X_2, dotted);\n    draw(X_2--Z_2);\n\n    pair A_1 = extension(Y_1, Y_2, Z_1, Z_2);\n    dot(\"$A_1$\", A_1, dir(A_1));\n    pair B_1 = extension(Z_1, Z_2, X_1, X_2);\n    dot(\"$B_1$\", B_1, dir(B_1));\n    pair C_1 = extension(X_1, X_2, Y_1, Y_2);\n    dot(\"$C_1$\", C_1, dir(50));\n\n    draw(A_1--B_1--C_1--cycle, black+1);\n    draw(C_1--X_2, dotted);\n    pair O_1 = circumcenter(A_1, B_1, C_1);\n    draw(arc(O_1, abs(O_1-A_1), -80, 140));\n\n    pair A_2 = A*A/P;\n    dot(\"$A_2$\", A_2, dir(-20));\n    pair B_2 = B*B/P;\n    dot(\"$B_2$\", B_2, dir(130));\n    pair C_2 = C*C/P;\n    dot(\"$C_2$\", C_2, dir(C_2));\n    draw(A_2--B_2--C_2--cycle, black+1);\n\n    pair T = extension(A_1, A_2, B_1, B_2);\n    dot(\"$T$\", T, dir(T));\n    draw(T--A_1, dashed);\n    draw(T--B_1, dashed);\n    draw(T--C_1, dashed);\n\n    /*\n    A = dir 110\n    B = dir 195\n    C = dir 325\n    P = dir 270\n\n    unitcircle\n    A--B--C--cycle blue\n    U := P+(2,0)\n    V := 2*P-U\n    X = reflect(B,C)*P\n    Y = reflect(C,A)*P\n    Z = reflect(A,B)*P\n    Y--Z heavygreen\n\n    X1 := extension B C U V\n    Y1 := extension C A U V\n    Z1 := extension A B U V\n    Line Y1 Z1\n\n    A_1 = extension Y Y1 Z Z1\n    B_1 = extension Z Z1 X X1\n    C_1 = extension X X1 Y Y1\n    A_1--B_1--C_1--cycle red\n    circumcircle A_1 B_1 C_1\n\n    circumcircle B Z X dotted\n    circumcircle C X Y dotted\n    circumcircle A Y Z dotted\n\n    M = extension A_1 A*A/P B_1 B*B/P\n    */\n  \\end{asy}\n\\end{center}\n\nWe apply complex numbers with $\\omega$ the unit circle and $p=1$.  Let $A_1 = \\ell_B \\cap \\ell_C$, and let $a_2 = a^2$ (in other words, $A_2$ is the reflection of $P$ across the diameter of $\\omega$ through $A$).  Define the points $B_1$, $C_1$, $B_2$, $C_2$ similarly.\n\nWe claim that $\\ol{A_1A_2}$, $\\ol{B_1B_2}$, $\\ol{C_1C_2}$ concur at a point on $\\Gamma$.\n\nWe begin by finding $A_1$. If we reflect the points $1+i$ and $1-i$ over $\\ol{AB}$, then we get two points $Z_1$, $Z_2$ with\n\\begin{align*}\n  z_1 &= a+b-ab(1-i) = a+b-ab+abi \\\\\n  z_2 &= a+b-ab(1+i) = a+b-ab-abi. \\\\\n  \\intertext{Therefore,}\n  z_1 - z_2 &= 2abi  \\\\\n  \\ol{z_1}z_2 - \\ol{z_2}{z_1}\n    &= -2i \\left( a+b+\\frac1a+\\frac1b-2 \\right).\n\\end{align*}\n\nNow $\\ell_C$ is the line $\\ol{Z_1Z_2}$,\nso with the analogous equation $\\ell_B$ we obtain:\n\\begin{align*}\n  a_1 &= \\frac{ -2i\\left( a+b+\\frac1a+\\frac1b-2 \\right)\\left( 2ac i \\right) +\n    2i\\left( a+c+\\frac1a+\\frac1c-2 \\right)(2abi) }\n    { \\left( -\\frac{2}{ab}i \\right)\n    \\left( 2ac i \\right) - \\left( -\\frac{2}{ac}i \\right) \\left( 2abi \\right)} \\\\\n  &= \\frac{\\left[ c-b \\right]a^2 + \\left[ \\frac cb - \\frac bc - 2c + 2b \\right]a + (c-b)  }{\\frac cb - \\frac bc} \\\\\n  &= a + \\frac{(c-b)\\left[ a^2-2a+1 \\right]}{(c-b)(c+b)/bc} \\\\\n  &= a + \\frac{bc}{b+c} (a-1)^2.\n\\end{align*}\nThen the second intersection of $\\ol{A_1A_2}$ with $\\omega$ is given by\n\\begin{align*}\n  \\frac{a_1-a_2}{1-a_2\\ol{a_1}}\n  &= \\frac{a+\\frac{bc}{b+c}(a-1)^2-a^2}{1-a-a^2 \\cdot \\frac{(1-1/a)^2}{b+c}} \\\\\n  &= \\frac{a + \\frac{bc}{b+c}(1-a)}{1 - \\frac{1}{b+c}(1-a)} \\\\\n  &= \\frac{ab+bc+ca - abc}{a+b+c-1}.\n\\end{align*}\nThus, the claim is proved.\n\nFinally, it suffices to show $\\ol{A_1B_1} \\parallel \\ol{A_2B_2}$.\nOne can also do this with complex numbers;\nit amounts to showing $a^2-b^2$, $a-b$, $i$\n(corresponding to $\\ol{A_2 B_2}$, $\\ol{A_1 B_1}$, $\\ol{PP}$)\nhave their arguments an arithmetic progression, equivalently\n\\[ \\frac{(a-b)^2}{i(a^2-b^2)} \\in \\RR\n  \\iff\n  \\frac{(a-b)^2}{i(a^2-b^2)}\n  = \\frac{\\left( \\frac 1a-\\frac1b \\right)^2}\n  {\\frac1i\\left(\\frac{1}{a^2}-\\frac{1}{b^2}\\right)}\n\\]\nwhich is obvious.\n\\begin{remark*}\nOne can use directed angle chasing for this last part too.\nLet $\\ol{BC}$ meet $\\ell$ at $K$ and $\\ol{B_2C_2}$ meet $\\ell$ at $L$.\nEvidently\n\\begin{align*}\n  -\\dang B_2LP &= \\dang LPB_2 + \\dang PB_2L \\\\\n  &= 2 \\dang KPB + \\dang PB_2C_2 \\\\\n  &= 2 \\dang KPB + 2\\dang PBC \\\\\n  &= -2\\dang PKB \\\\\n  &= \\dang PKB_1 \\\\\n\\end{align*}\nas required.\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Geometry", "source": "IMO", "year": 2011}
{"id": "tstst-2013-q1", "question": "Let $ABC$ be a triangle and $D$, $E$, $F$ be the midpoints of arcs $BC$, $CA$, $AB$ on the circumcircle.\nLine $\\ell_a$ passes through the feet of the perpendiculars\nfrom $A$ to $\\ol{DB}$ and $\\ol{DC}$.\nLine $m_a$ passes through the feet of the perpendiculars from $D$ to $\\ol{AB}$ and $\\ol{AC}$.\nLet $A_1$ denote the intersection of lines $\\ell_a$ and $m_a$.\nDefine points $B_1$ and $C_1$ similarly.\nProve that triangles $DEF$ and $A_1B_1C_1$ are similar to each other.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3181479}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle and $D$, $E$, $F$ be the midpoints of arcs $BC$, $CA$, $AB$ on the circumcircle.\nLine $\\ell_a$ passes through the feet of the perpendiculars\nfrom $A$ to $\\ol{DB}$ and $\\ol{DC}$.\nLine $m_a$ passes through the feet of the perpendiculars from $D$ to $\\ol{AB}$ and $\\ol{AC}$.\nLet $A_1$ denote the intersection of lines $\\ell_a$ and $m_a$.\nDefine points $B_1$ and $C_1$ similarly.\nProve that triangles $DEF$ and $A_1B_1C_1$ are similar to each other.\n\\end{mdframed}\nIn fact, it is true for any points $D$, $E$, $F$ on the circumcircle.\nMore strongly we contend:\n\\begin{claim*}\n  Point $A_1$ is the midpoint of $\\ol{HD}$.\n\\end{claim*}\n\\begin{proof}\n  Lines $m_a$ and $\\ell_a$ are Simson lines,\n  so they both pass through the point $(a+b+c+d)/2$\n  in complex coordinates.\n\\end{proof}\n\n\\begin{center}\n  \\begin{asy}\n    pair A = dir(130);\n    pair B = dir(200);\n    pair C = dir(-20);\n    pair D = dir(-90);\n    pair P1 = foot(A,B,D);\n    pair P2 = foot(A,C,D);\n    pair Q1 = foot(D,A,B);\n    pair Q2 = foot(D,A,C);\n    pair H = A+B+C;\n    draw(H--D, deepgreen);\n    draw(unitcircle);\n    filldraw(A--B--C--cycle, lightcyan + opacity(0.1), blue);\n    draw(B--D--C, blue);\n    draw(P1--A--P2, dashed+red);\n    draw(Q1--D--Q2, dashed+orange);\n    draw(P1--P2, red);\n    draw(Q1--Q2, orange);\n    draw(P1--B, blue);\n    draw(Q1--B, blue);\n    dot(Q1, orange);\n    dot(Q2, orange);\n    dot(P1, red);\n    dot(P2, red);\n    dot(\"$A_1$\", (A+B+C+D)/2, dir(-90));\n    dot(\"$A$\", A, A);\n    dot(\"$B$\", B, B);\n    dot(\"$C$\", C, C);\n    dot(\"$D$\", D, D);\n    dot(\"$H$\", H, dir(90));\n  \\end{asy}\n\\end{center}\n\nHence $A_1 B_1 C_1$ is similar to $DEF$ through a homothety at $H$ with\nratio $\\half$.\n\\pagebreak", "category": "Geometry", "source": "TSTST", "year": 2013}
{"id": "tstst-2013-q2", "question": "A finite sequence of integers $a_1, a_2, \\dots, a_n$ is called\n\\emph{regular} if there exists a real number $x$ satisfying\n\\[ \\left\\lfloor kx \\right\\rfloor = a_k \\quad \\text{for } 1 \\le k \\le n. \\]\nGiven a regular sequence $a_1, a_2, \\dots, a_n$, for $1 \\le k \\le n$ we say that\nthe term $a_k$ is \\emph{forced} if the following condition is satisfied:\nthe sequence \\[ a_1, \\; a_2, \\; \\dots, \\; a_{k-1}, \\; b \\]\nis regular if and only if $b = a_k$.\n\nFind the maximum possible number of forced terms\nin a regular sequence with $1000$ terms.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3181480}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA finite sequence of integers $a_1, a_2, \\dots, a_n$ is called\n\\emph{regular} if there exists a real number $x$ satisfying\n\\[ \\left\\lfloor kx \\right\\rfloor = a_k \\quad \\text{for } 1 \\le k \\le n. \\]\nGiven a regular sequence $a_1, a_2, \\dots, a_n$, for $1 \\le k \\le n$ we say that\nthe term $a_k$ is \\emph{forced} if the following condition is satisfied:\nthe sequence \\[ a_1, \\; a_2, \\; \\dots, \\; a_{k-1}, \\; b \\]\nis regular if and only if $b = a_k$.\n\nFind the maximum possible number of forced terms\nin a regular sequence with $1000$ terms.\n\\end{mdframed}\nThe answer is $985$. WLOG, by shifting $a_1 = 0$ (clearly $a_1$ isn't forced).\nNow, we construct regular sequences inductively using the following procedure.\nStart with the inequality \\[ \\tfrac01 \\le x < \\tfrac11. \\]\nThen for each $k = 2, 3, \\dots, 1000$ we perform the following procedure.\nIf there is no fraction of the form $F = \\frac mk$ in the interval $A \\le x < B$,\nthen $a_k$ is forced,\nand the interval of possible $x$ values does not change.\nOtherwise, $a_k$ is not forced,\nand we pick a value of $a_k$ and update the interval accordingly.\n\nThe theory of \\href{https://en.wikipedia.org/wiki/Farey_sequence}{Farey sequences}\ntells us that when we have a stage $\\tfrac ab \\le x < \\tfrac cd$\nthen the next time we will find a fraction\nin that interval is exactly $\\tfrac{a+c}{b+d}$ (at time $k=b+d$),\nand it will be the only such fraction.\n\nSo essentially, starting with $\\tfrac 01 \\le x < \\tfrac 11$\nwe repeatedly replace one of the endpoints of the intervals with the mediant,\nuntil one of the denominators exceeds $1000$;\nwe are trying to minimize the number of non-forced terms,\nwhich is the number of denominators that appear in this process.\nIt is not hard to see that this optimum occurs by always replacing the smaller of the denominators,\nso that the sequence is\n\\begin{align*}\n \\tfrac{0}{1} &\\le x < \\tfrac{1}{1} \\\\\n \\tfrac{0}{1} &\\le x < \\tfrac{1}{2} \\\\\n \\tfrac{1}{3} &\\le x < \\tfrac{1}{2} \\\\\n \\tfrac{1}{3} &\\le x < \\tfrac{2}{5} \\\\\n \\tfrac{3}{8} &\\le x < \\tfrac{2}{5} \\\\\n \\tfrac{3}{8} &\\le x < \\tfrac{5}{13}\n\\end{align*}\nand so on; we see that the non-forced terms in this optimal configuration\nare exactly the Fibonacci numbers.\nThere are $15$ Fibonacci numbers less than $1000$,\nhence the answer $1000 - 15 = 985$.\n\\pagebreak", "category": "Number Theory", "source": "TSTST", "year": 2013}
{"id": "tstst-2013-q3", "question": "Divide the plane into an infinite square grid by drawing\nall the lines $x=m$ and $y=n$ for $m,n \\in \\ZZ$.\nNext, if a square's upper-right corner has both coordinates even, color it black;\notherwise, color it white (in this way, exactly $1/4$ of the squares are black\nand no two black squares are adjacent).\nLet $r$ and $s$ be odd integers,\nand let $(x,y)$ be a point in the interior of any white square such that $rx-sy$ is irrational.\nShoot a laser out of this point with slope $r/s$;\nlasers pass through white squares and reflect off black squares.\nProve that the path of this laser will from a closed loop.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3181481}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nDivide the plane into an infinite square grid by drawing\nall the lines $x=m$ and $y=n$ for $m,n \\in \\ZZ$.\nNext, if a square's upper-right corner has both coordinates even, color it black;\notherwise, color it white (in this way, exactly $1/4$ of the squares are black\nand no two black squares are adjacent).\nLet $r$ and $s$ be odd integers,\nand let $(x,y)$ be a point in the interior of any white square such that $rx-sy$ is irrational.\nShoot a laser out of this point with slope $r/s$;\nlasers pass through white squares and reflect off black squares.\nProve that the path of this laser will from a closed loop.\n\\end{mdframed}\nHere is Sammy Luo's solution.\nFix the speed of light at $\\sqrt{r^2+s^2}$ units per second.\nWe prove periodicity every six seconds.\n\nWe re-color the white squares as red, blue, or green\naccording as to whether they have a black square directly\nto the left/right, above/below, or neither, as shown below.\nFinally, we fix time zero to be a moment just before the laser passes\na horizontal (WLOG) lattice line (not necessarily a wall).\nShown below is an example for $(r,s) = (3,5)$.\n\n\\begin{center}\n\\begin{asy}\nsize(11cm);\nint Mx = 3;\nint My = 6;\nfor (int i=0; i<=Mx; ++i) {\nfor (int j=0; j<=My; ++j) {\nfill(shift(2*i, 2*j) * unitsquare, opacity(0.1)+lightgreen);\nif (i != Mx) { fill(shift(2*i+1, 2*j) * unitsquare, opacity(0.1)+lightred); }\nif (j != My) { fill(shift(2*i, 2*j+1) * unitsquare, opacity(0.1)+lightblue); }\nif ((i != Mx) && (j != My)) { fill(shift(2*i+1, 2*j+1) * unitsquare, black); }\n}\n}\n\n\npair ne_until_y(pair O, real y) {\n  return extension(O, O+(3,5), (0,y), (1,y) );\n}\npair ne_until_x(pair O, real x) {\n  return extension(O, O+(3,5), (x,0), (x,1) );\n}\npair se_until_y(pair O, real y) {\n  return extension(O, O+(-3,5), (0,y), (1,y) );\n}\npair se_until_x(pair O, real x) {\n  return extension(O, O+(-3,5), (x,0), (x,1) );\n}\n\n\npair[] P = new pair[10];\nP[0] = (2.0, 0.84);\nP[1] = ne_until_y(P[0], 3);\nP[2] = se_until_y(P[1], 2);\nP[3] = ne_until_x(P[2], 5);\nP[4] = se_until_x(P[3], 4);\nP[5] = ne_until_x(P[4], 5);\nP[6] = se_until_y(P[5], 9);\nP[7] = ne_until_y(P[6], 8);\nP[8] = se_until_y(P[7], 11);\nP[9] = ne_until_x(P[8], 1);\n\nfor (int i=0; i<=8; ++i) { draw(P[i]--P[i+1], orange); }\n\ntransform t = yscale(-1)*rotate(-90);\npair[] Q = new pair[8];\nQ[0] = t*P[0];\nQ[1] = t*ne_until_y(P[0], 1);\nQ[2] = t*ne_until_y(P[0], 2);\nQ[3] = t*ne_until_x(P[0], 3);\nQ[4] = t*ne_until_y(P[0], 3); // = P[1]\nQ[5] = t*se_until_y(P[1], 2);\nQ[6] = t*ne_until_x(P[2], 4);\nQ[7] = t*ne_until_y(P[2], 3);\n\n// for (int i=0; i<=7; ++i) { dot(Q[i], lightblue); }\n\npicture rotated = t*currentpicture;\ncurrentpicture.erase();\nadd(rotated);\n\ndotfactor *= 0.5;\ndefaultpen(fontsize(6pt));\ndot(\"$h$\", Q[0], dir(-90), red);\ndot(\"$v$\", Q[1], dir(90), orange);\ndot(\"$v$\", Q[2], dir(-45), orange);\ndot(\"$h$\", Q[3], dir(-45), orange);\ndot(\"$v$\", Q[4], dir(180)*2, orange);\ndot(\"$v$\", Q[5], dir(105)*2, orange);\ndot(\"$h$\", Q[6], dir(90), orange);\ndot(\"$v$\", Q[7], dir(90), orange);\n\ndot(t*P[3], red);\ndot(t*se_until_x(P[5], 4), red);\ndot(t*P[9], red);\n\\end{asy}\n\\end{center}\n\nThe main idea is to keep track of every time the laser passes\na lattice line (again, not necessarily a wall).\nThere are four possible types of events:\n\\begin{itemize}\n  \\ii A horizontal $h$ event where the laser switches from red to green (or vice-versa);\n  \\ii A horizontal $h$ event where the laser rebounds off a wall,\n  remaining in a blue square, but flips the $x$-component of its velocity;\n  \\ii A vertical $v$ event where the laser switches from blue to green (or vice-versa)\n  \\ii A vertical $v$ event where the laser rebounds off a wall,\n  remaining in a red square, but flips the $y$-component of its velocity.\n\\end{itemize}\n\nThe first key observation is that:\n\\begin{claim*}\n  In the first second, the laser will encounter exactly\n  $r$ horizontal events and $s$ vertical events.\n  In every second after that, the same sequence of $r+s$ events occurs.\n\\end{claim*}\n\\begin{proof}\n  Bouncing off a wall doesn't change this\n  as opposed to if the laser had passed through the wall.\n\\end{proof}\nWe let the \\emph{key-word} be the sequence $w$ of $r+s$ letters corresponding to the sequence.\nFor example, the picture above denotes an example with keyword $w = hvvhvvhv$;\nso no matter what, every second, the laser will encounter eight lattice lines,\nwhich are horizontal and vertical in that order.\n\n\\begin{claim*}\n  Color is periodic every $3$ seconds.\n\\end{claim*}\n\\begin{proof}\n  The free group generated by $h$ and $v$\n  acts on the set $\\{R,G,B\\}$ of colors in an obvious way; consider this right action.\n  First we consider the color of the square after each second.\n  Note that with respect to color, each letter is an involution;\n  so as far as color changes are concerned,\n  it's enough to work with the reduced word $w'$ obtained by modding out by $h^2 = 1$ and $v^2 = 1$.\n  (For example, $w' = hv$ in our example.)\n  In general, $w' = (hv)^k$ or $w' = (vh)^k$,\n  for some odd integer $k$ (since $k \\equiv r \\equiv s \\equiv 1 \\pmod 2$).\n  Now we see that the action of $hv$\n  on the set of colors is\n  $\\text{red} \\mapsto \\text{blue} \\mapsto \\text{green} \\mapsto \\text{red}$,\n  and similarly for $vh$ (being the inverse).\n  This implies that the color is periodic every three seconds.\n\\end{proof}\n\nNow in a 3-second period,\nconsider the $3r$ horizontal events and $3s$ vertical events (both are odd).\nIn order for the color to remain the same\n(as the only color changes are $R \\leftrightarrow G$ for $h$ and $B \\leftrightarrow G$ for $v$)\nthere must have been an even number of color swaps for each orientation.\nTherefore there was an odd number of wall collisions of each orientation.\nSo, the laser is pointing in the opposite direction at the end of 3 seconds.\n\nFinally, let $x_t$ be the fractional part of the $x$\ncoordinate after $t$ seconds\n(the $y$-coordinate is always zero by our setup at these moments).\nNote that\n\\[ x_{t+1} =\n  \\begin{cases}\n    x_t & \\text{even number of vertical wall collisions} \\\\\n    1 - x_t & \\text{odd numbers of vertical wall collisions}\n  \\end{cases}\n\\]\nSince over the three seconds there were an odd number of vertical collisions;\nit follows $x_3 = 1 - x_0$.\nThus at the end of three seconds, the laser is in a symmetric position from the start;\nand in $6$ seconds it will form a closed loop.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Geometry", "source": "TSTST", "year": 2013}
{"id": "tstst-2013-q4", "question": "Circle $\\omega$, centered at $X$, is internally tangent to circle $\\Omega$,\ncentered at $Y$, at $T$.\nLet $P$ and $S$ be variable points on $\\Omega$ and $\\omega$,\nrespectively, such that line $PS$ is tangent to $\\omega$ (at $S$).\nDetermine the locus of $O$ --- the circumcenter of triangle $PST$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3181482}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nCircle $\\omega$, centered at $X$, is internally tangent to circle $\\Omega$,\ncentered at $Y$, at $T$.\nLet $P$ and $S$ be variable points on $\\Omega$ and $\\omega$,\nrespectively, such that line $PS$ is tangent to $\\omega$ (at $S$).\nDetermine the locus of $O$ --- the circumcenter of triangle $PST$.\n\\end{mdframed}\nThe answer is a circle centered at $Y$\nwith radius $\\sqrt{YX \\cdot YT}$,\nminus the two points on line $XY$ itself.\n\nWe let $PS$ meet $\\Omega$ again at $P'$,\nand let $O'$ be the circumcenter of $\\triangle TPS'$.\nNote that $O'$, $X$, $O$ are collinear on the perpendicular\nbisector of line $\\ol{TS}$\nFinally, we let $M$ denote the arc midpoint of $PP'$\nwhich lies on line $TS$ (by homothety).\n\n\\begin{center}\n\\begin{asy}\nimport graph; size(9cm);\npen qqffff = rgb(0.,1.,1.); pen qqwuqq = rgb(0.,0.39215,0.); pen ffdxqq = rgb(1.,0.84313,0.); pen yqqqqq = rgb(0.50196,0.,0.);\npair X = (-2.,0.), Y = (2.,0.), T = (-9.50185,0.), P = (7.49229,10.10580), O = (5.46686,-5.82994), M = (-0.78960,11.15843);\npair S = (-3.81946,7.27786);\npair Pp = (-7.60181,6.33228);\npair Op = (-4.49671,1.94937);\nfill(T--S--P--cycle, palegreen);\nfill(T--Op--Y--cycle, palegreen);\nfill(T--S--Pp--cycle, palecyan);\nfill(T--O--Y--cycle, palecyan);\ndraw(circle(X, 7.50185), linewidth(0.6) + red);\ndraw(circle(Y, 11.50185), linewidth(0.6) + red);\ndraw(circle(Y, 6.78287), linewidth(0.6) + qqwuqq);\ndraw(T--Op--Y--O--T--Y, gray);\ndraw(T--Pp--M--P--T--M, black);\ndraw(Pp--P, black);\ndraw(Op--O, gray);\ndot(\"$X$\", X, dir((8.005, 21.422)));\ndot(\"$Y$\", Y, dir((8.687, 21.422)));\ndot(\"$T$\", T, dir(T-Y));\ndot(\"$S$\", S, dir(135));\ndot(\"$P$\", P, dir(P-Y));\ndot(\"$O$\", O, dir(-45));\ndot(\"$P'$\", Pp, dir(Pp-Y));\ndot(\"$O'$\", Op, dir(40));\ndot(\"$M$\", M, dir((8.912, 22.013)));\n\\end{asy}\n\\end{center}\nBy three applications of Salmon theorem, we have the following spiral\nsimilarities all centered at $T$:\n\\begin{align*}\n  \\triangle TSP &\\overset{+}{\\sim} \\triangle TO'Y \\\\\n  \\triangle TP'S &\\overset{+}{\\sim} \\triangle TYO \\\\\n  \\triangle TP'P &\\overset{+}{\\sim} \\triangle TO'O.\n\\end{align*}\nHowever, the shooting lemma also gives us two similarities:\n\\begin{align*}\n  \\triangle TP'M &\\overset{+}{\\sim} \\triangle TSP \\\\\n  \\triangle TMP &\\overset{+}{\\sim} \\triangle TP'S.\n\\end{align*}\nPutting everything together, we find that\n\\[ TP'MP \\overset{+}{\\sim} TO'YO. \\]\nThen by shooting lemma, $YO'^2 = YX \\cdot YT$, so $O$\nindeed lies on the claimed circle.\n\nAs the line $\\ol{O'O}$ may be any line through $X$ other than line $XY$\n(one takes $S$ to be the reflection of $T$ across this line)\none concludes the only two non-achievable points are\nthe diametrically opposite ones on line $XY$ of this circle\n(because this leads to the only degenerate situation where $S=T$).\n\\pagebreak", "category": "Geometry", "source": "TSTST", "year": 2013}
{"id": "tstst-2013-q5", "question": "Let $p$ be a prime.\nProve that in a complete graph with $1000p$ vertices\nwhose edges are labelled with integers,\none can find a cycle whose sum of labels is divisible by $p$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3181483}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $p$ be a prime.\nProve that in a complete graph with $1000p$ vertices\nwhose edges are labelled with integers,\none can find a cycle whose sum of labels is divisible by $p$.\n\\end{mdframed}\nSelect $p-1$ disjoint triangles arbitrarily.  If any of these triangles have $0$ sum modulo $p$ we are done.  Otherwise, we may label the vertices $u_i$, $x_i$, and $v_i$ (where $1 \\le i \\le p-1$) in such a way that $u_ix_i + x_iv_i \\neq u_iv_i$.\n\nLet $A_i = \\left\\{ u_ix_i+x_iv_i, u_iv_i \\right\\}$.  We can show that $\\left\\lvert A_1 + A_2 + \\dots + A_t \\right\\rvert \\ge \\min \\left\\{ p,t+1 \\right\\}$ for each $1 \\le t \\le p-1$, by using induction on $t$ alongside Cauchy-Davenport.  So, $A_1 + A_2 + \\dots + A_{p-1}$ spans all of $\\ZZ_p$.  All that's left to do is join the triangles together to form a cycle, and then delete either $u_ix_i,x_iv_i$ or $u_iv_i$ from each triangle in such a way that the final sum is $0$ mod $p$.\n\\pagebreak", "category": "Combinatorics", "source": "TSTST", "year": 2013}
{"id": "tstst-2013-q6", "question": "Let $\\NN$ be the set of positive integers.\nFind all functions $f \\colon \\NN \\to \\NN$ that satisfy the equation\n\\[ f^{abc-a}(abc) + f^{abc-b}(abc) + f^{abc-c}(abc) = a + b + c \\]\nfor all $a,b,c \\ge 2$. (Here $f^k$ means $f$ applied $k$ times.)", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3181484}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $\\NN$ be the set of positive integers.\nFind all functions $f \\colon \\NN \\to \\NN$ that satisfy the equation\n\\[ f^{abc-a}(abc) + f^{abc-b}(abc) + f^{abc-c}(abc) = a + b + c \\]\nfor all $a,b,c \\ge 2$. (Here $f^k$ means $f$ applied $k$ times.)\n\\end{mdframed}\nThe answer is $f(n) = n-1$ for $n \\ge 3$ with $f(1)$ and $f(2)$ arbitrary;\ncheck these work.\n\n\\begin{lemma*}\n We have $f^{t^2-t}(t^2) = t$ for all $t$.\n\\end{lemma*}\n\\begin{proof}\n We say $1 \\le k \\le 8$ is good if $f^{t^9-t^k}(t^9) = t^k$ for all $t$.\n First, we observe that\n \\[ f^{t^9-t^3}(t^9) = t^3 \\quad\\text{and}\\quad f^{t^3-t}(t^3) = t\n   \\implies f^{t^9-t}(t^9) = t.  \\]\n so $k=1$ and $k=3$ are good.\n Then taking $(a,b,c) = (t,t^4,t^4)$,\n $(a,b,c) = (t^2, t^3, t^4)$\n gives that $k = 4$ and $k = 2$ are good, respectively.\n % $(a,b,c) = (t,t^3,t^5)$,  gives $5$ good\n% Similarly, $(a,b,c) = (t,t^2,t^6)$ and $(a,b,c) = (t,t,t^7)$\n% gives $6$ and $7$ are good.\n The lemma follows from this $k=1$ and $k=2$ being good.\n\\end{proof}\n\nNow, letting $t = abc$ we combine\n\\begin{align*}\n f^{t-a}(a) + f^{t-b}(b) + f^{t-c}(c) &= a+b+c \\\\\n f^{t^2-ab} (t^2) + f^{t^2-t} (t^2) + f^{t^2-c} (t^2) &= ab + t + c \\\\\n \\implies \\left[ f^{t-a}(t) - a \\right]\n + \\left[ f^{t-b}(t) - b \\right]\n &=\n \\left[ f^{t-ab}(t) - ab \\right]\n\\end{align*}\nby subtracting and applying the lemma repeatedly.\nIn other words, we have proven the second lemma:\n\\begin{lemma*}\n  Let $t$ be fixed, and define $g_t(n) = f^{t-n}(t) - n$ for $n < t$.\n  If $a,b \\ge 2$ and $ab \\mid t$, $ab < t$,  then $g_t(a) + g_t(b) = g_t(ab)$.\n\\end{lemma*}\n\nNow let $a,b \\ge 2$ be arbitrary, and let $p > q > \\max\\{a,b\\}$ be primes.\nSuppose $s = a^p b^q$ and $t = s^2$; then\n\\[ p g_t(a) + q g_t(b)\n  = g_t\\left( a^p b^q \\right) = g_t(s)\n  = f^{s^2-s}(s) - s = 0.  \\]\nNow \\[ q \\mid g_t(a) > -a\n  \\quad\\text{and}\\quad p \\mid g_t(b) > -b\n  \\implies g_t(a) = g_t(b) = 0.  \\]\nand so we conclude $f^{t-a}(t) = a$\nand $f^{t-b}(t) = b$ for $a,b \\ge 2$.\n\nIn particular, if $a = n$ and $b = n+1$\nthen we deduce $f(n+1) = n$ for all $n \\ge 2$, as desired.\n\n\\begin{remark*}\n  If you let $c = (ab)^2$ after the first lemma,\n  you recover the $2$-variable version!\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 3}", "category": "Number Theory", "source": "TSTST", "year": 2013}
{"id": "tstst-2013-q7", "question": "A country has $n$ cities, labelled $1,2,3,\\dots,n$.\nIt wants to build exactly $n-1$ roads between certain pairs of cities\nso that every city is reachable from every other city via some sequence of roads.\nHowever, it is not permitted to put roads between pairs of cities\nthat have labels differing by exactly $1$,\nand it is also not permitted to put a road between cities $1$ and $n$.\nLet $T_n$ be the total number of possible ways to build these roads.\n\\begin{enumerate}[(a)]\n  \\ii For all odd $n$, prove that $T_n$ is divisible by $n$.\n  \\ii For all even $n$, prove that $T_n$ is divisible by $n/2$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3181485}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA country has $n$ cities, labelled $1,2,3,\\dots,n$.\nIt wants to build exactly $n-1$ roads between certain pairs of cities\nso that every city is reachable from every other city via some sequence of roads.\nHowever, it is not permitted to put roads between pairs of cities\nthat have labels differing by exactly $1$,\nand it is also not permitted to put a road between cities $1$ and $n$.\nLet $T_n$ be the total number of possible ways to build these roads.\n\\begin{enumerate}[(a)]\n  \\ii For all odd $n$, prove that $T_n$ is divisible by $n$.\n  \\ii For all even $n$, prove that $T_n$ is divisible by $n/2$.\n\\end{enumerate}\n\\end{mdframed}\nYou can just spin the tree!\n\nFixing $n$, the group $G = \\ZZ/n\\ZZ$ acts on the set of trees\nby rotation (where we imagine placing $1,2,\\dots,n$ along a circle).\n\n\\begin{claim*}\n  For odd $n$, all trees have trivial stabilizer.\n\\end{claim*}\n\\begin{proof}\n  One way to see this is to look at the degree sequence.\n  Suppose $g^e$ fixes a tree $T$.\n  Then so does $g^k$, for $k = \\gcd(e,n)$.\n  Then it follows that $n/k$ divides $\\sum_v \\deg v = 2n-2$.\n  Since $\\gcd(2n-2, n) = 1$ we must then have $k = n$.\n\\end{proof}\n\nThe proof for even $n$ is identical except that $\\gcd(2n-2, n) = 2$\nand hence each tree either has stabilizer with size $\\le 2$.\n\nThere is also a proof using linear algebra,\nusing Kirchoff's tree formula.  (Overkill.)\n\\pagebreak", "category": "Combinatorics", "source": "TSTST", "year": 2013}
{"id": "tstst-2013-q8", "question": "Define a function $f \\colon \\NN \\to \\NN$ by $f(1) = 1$,\n$f(n+1) = f(n) + 2^{f(n)}$ for every positive integer $n$.\nProve that $f(1)$, $f(2)$, \\dots, $f(3^{2013})$\nleave distinct remainders when divided by $3^{2013}$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3181486}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nDefine a function $f \\colon \\NN \\to \\NN$ by $f(1) = 1$,\n$f(n+1) = f(n) + 2^{f(n)}$ for every positive integer $n$.\nProve that $f(1)$, $f(2)$, \\dots, $f(3^{2013})$\nleave distinct remainders when divided by $3^{2013}$.\n\\end{mdframed}\nI'll prove by induction on $k \\ge 1$ that any $3^k$\nconsecutive values of $f$ produce distinct residues modulo $3^k$.\nThe base case $k=1$ is easily checked\n($f$ is always odd, hence $f$ cycles $1$, $0$, $2$ mod $3$).\n\nFor the inductive step, assume it's true for $k$.\nNote that $2^\\bullet \\pmod{3^{k+1}}$ cycles every $2 \\cdot 3^k$\nso we look at the outputs of $f$ modulo $2 \\cdot 3^k$.\n\\begin{claim*}\n  We have\n  \\[ \\{ f(n), f(n+1), \\dots, f(n+3^k-1) \\} \\pmod{2 \\cdot 3^k} \\]\n  is a permutation\n  \\[ \\{ 1, 3, \\dots, 2 \\cdot 3^k-1 \\} \\pmod{2 \\cdot 3^k}. \\]\n\\end{claim*}\n\\begin{proof}\n  The $f$-values were given to be distinct modulo $3^k$, and $f$ is always odd.\n\\end{proof}\nThus, we conclude that\n\\[ \\{ 2^{f(n)}, 2^{f(n+1)}, \\dots, 2^{f(n+3^k-1)}\\} \\pmod{3^{k+1}} \\]\nis a permutation of\n\\[ \\{ 2^{1}, 2^{3}, \\dots, 2^{2 \\cdot 3^k - 1}\\} \\pmod{3^{k+1}} \\]\nand so\n\\begin{align*}\n  f(n+3^k) - f(n)\n  &= 2^{f(n)} + 2^{f(n+1)} + \\dots + 2^{f(n+3^k-1)} \\pmod{3^{k+1}} \\\\\n  &\\equiv 2^1 + 2^3 + \\dots + 2^{2 \\cdot 3^k-1} \\pmod{3^{k+1}} \\\\\n  &= 2 \\cdot \\frac{4^{3^k}-1}{4-1}.\n\\end{align*}\nHence\n\\[\n  f(n+3^k)-f(n) \\equiv C \\pmod{3^{k+1}}\n  \\qquad\\text{where} \\qquad C = 2 \\cdot \\frac{4^{3^k}-1}{4-1}\n\\]\nnoting that $C$ does not depend on $n$. Exponent lifting gives $\\nu_3(C) = k$\nhence $f(n)$, $f(n+3^k)$, $f(n+2\\cdot3^k)$ differ mod $3^{k+1}$ for all $n$,\nand the inductive hypothesis now solves the problem.\n\\pagebreak", "category": "Number Theory", "source": "TSTST", "year": 2013}
{"id": "tstst-2013-q9", "question": "Let $r$ be a rational number in the interval $[-1,1]$\nand let $\\theta = \\cos^{-1} r$.\nCall a subset $S$ of the plane good if $S$ is unchanged\nupon rotation by $\\theta$ around any point of $S$\n(in both clockwise and counterclockwise directions).\nDetermine all values of $r$ satisfying the following property:\nThe midpoint of any two points in a good set also lies in the set.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3181487}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $r$ be a rational number in the interval $[-1,1]$\nand let $\\theta = \\cos^{-1} r$.\nCall a subset $S$ of the plane good if $S$ is unchanged\nupon rotation by $\\theta$ around any point of $S$\n(in both clockwise and counterclockwise directions).\nDetermine all values of $r$ satisfying the following property:\nThe midpoint of any two points in a good set also lies in the set.\n\\end{mdframed}\nThe answer is that $r$ has this property\nif and only if $r = \\frac{4n-1}{4n}$ for some integer $n$.\n\nThroughout the solution, we will let $r = \\frac ab$ with $b > 0$ and\n$\\gcd(a,b) = 1$. We also let\n\\[ \\omega = e^{i\\theta} = \\frac ab \\pm \\frac{\\sqrt{b^2-a^2}}{b} i. \\]\nThis means we may work with complex multiplication in the usual way;\nthe rotation of $z$ through center $c$ is given by $z \\mapsto \\omega(z-c)+c$.\n\nFor most of our proof, we start by constructing a good set as follows.\n\\begin{itemize}\n  \\ii Start by letting $S_0 = \\{0, 1\\}$.\n  \\ii Let $S_i$ consist of $S_{i-1}$ plus\n  all points that can be obtained by rotating a point of $S_{i-1}$\n  through a different point of $S_{i-1}$ (with scale factor $\\omega$).\n  \\ii Let $S_\\infty = \\bigcup_{i \\ge 0} S_i$.\n\\end{itemize}\nThe set $S_\\infty$ is the (minimal, by inclusion) good set containing\n$0$ and $1$.\nWe are going to show that for most values of $r$,\nwe have $\\half \\notin S_\\infty$.\n\n\\begin{claim*}\n  If $b$ is odd, then $\\half \\notin S_\\infty$.\n\\end{claim*}\n\\begin{proof}\n  Idea: denominators that appear are always odd.\n\n  Consider the ring\n  \\[ A = \\ZZ_{\\{b\\}} = \\left\\{ \\frac{s}{t} \\mid s,t \\in \\ZZ, t \\mid b^\\infty \\right\\} \\]\n  which consists of all rational numbers\n  whose denominators divide $b^\\infty$.\n  Then, $0, 1, \\omega \\in A[\\sqrt{b^2-a^2}]$\n  and hence $S_\\infty \\subseteq A[\\sqrt{b^2-a^2}]$ too.\n  (This works even if $\\sqrt{b^2-a^2} \\in \\ZZ$,\n  in which case $S_\\infty \\subseteq A = A[\\sqrt{b^2-a^2}]$.)\n\n  But $\\half \\notin A[\\sqrt{b^2-a^2}]$.\n\\end{proof}\n\n\\begin{claim*}\n  If $b$ is even and $|b-a| \\neq 1$, then $\\half \\notin S_\\infty$.\n\\end{claim*}\n\\begin{proof}\n  Idea: take modulo a prime dividing $b-a$.\n\n  Let $D = b^2-a^2 \\equiv 3 \\pmod 4$.\n  Let $p$ be a prime divisor of $b-a$.\n  Because $\\gcd(a,b) = 1$, we have $p \\neq 2$ and $p \\nmid b$.\n\n  Consider the ring\n  \\[ A = \\ZZ_{(p)} = \\left\\{ \\frac{s}{t} \\mid s,t \\in \\ZZ, p \\perp t \\right\\} \\]\n  which consists of all rational numbers whose denominators are coprime to $p$.\n  Then, $0, 1, \\omega \\in A[\\sqrt{-D}]$ and hence $S_\\infty \\subseteq A[\\sqrt{-D}]$ too.\n\n  Now, there is a well-defined ``mod-$p$'' ring homomorphism\n  \\[ \\Psi \\colon A[\\sqrt{-D}] \\to \\FF_p \\quad\\text{by}\\quad\n    x+y\\sqrt{-D} \\mapsto x \\bmod p \\]\n  which commutes with addition and multiplication (as $p \\mid D$).\n  Under this map,\n  \\[ \\omega \\mapsto \\frac ab \\bmod p = 1. \\]\n  Consequently, the rotation $z \\mapsto \\omega(z-c)+c$\n  is just the identity map modulo $p$.\n  In other words, the pre-image of any point in $S_\\infty$\n  under $\\Psi$ must be either $\\Psi(0) = 0$ or $\\Psi(1) = 1$.\n\n  However, $\\Psi(1/2) = 1/2$ is neither of these. So this point cannot be achieved.\n\\end{proof}\n\n\\begin{claim*}\n  Suppose $a = 2n-1$ and $b=2n$ for $n$ an odd integer.\n  Then $\\half \\notin S_\\infty$\n\\end{claim*}\n\\begin{proof}\n  Idea: $\\omega$ is ``algebraic integer'' sans odd denominators.\n\n  This time, we define the ring\n  \\[ B = \\ZZ_{(2)} = \\left\\{ \\frac{s}{t} \\mid s,t \\in \\ZZ, t \\text{ odd} \\right\\} \\]\n  of rational numbers with odd denominator.\n  We carefully consider the ring $B[\\omega]$ where\n  \\[ \\omega = \\frac{2n-1 \\pm \\sqrt{1-4n}}{2n}. \\]\n  So $S_\\infty \\subseteq B[\\omega]$ as $0, 1, \\omega \\in B[\\omega]$.\n\n  I claim that $B[\\omega]$ is an integral extension of $B$;\n  equivalently that $\\omega$ is integral over $B$.\n  Indeed, $\\omega$ is the root of the monic polynomial\n  \\[  (T-1)^2 + \\frac1n (T-1) - \\frac 1n = 0 \\]\n  where $\\frac1n \\in B$ makes sense as $n$ is odd.\n\n  On the other hand, $\\half$ is not integral over $B$\n  so it is not an element of $B[\\omega]$.\n\\end{proof}\n\nIt remains to show that if $r = \\frac{4n-1}{4n}$, then goods sets\nsatisfy the midpoint property.\nAgain starting from the points $z_0 = 0$, $z_1 = 1$ construct the sequence\n\\begin{align*}\n  z_2 &= \\omega(z_1-z_0) + z_0 \\\\\n  z_3 &= \\omega\\inv(z_0-z_2) + z_2 \\\\\n  z_4 &= \\omega\\inv(z_2-z_3) + z_3 \\\\\n  z_5 &= \\omega(z_3-z_4) + z_4\n\\end{align*}\nas shown in the diagram below.\n\\begin{center}\n\\begin{asy}\n  size(8cm);\n  pair z0 = (0,0);\n  pair z1 = (1,0);\n  real theta = 28.96;\n  pair z2 = rotate(theta, z0) * z1;\n  pair z3 = rotate(-theta, z2) * z0;\n  pair z4 = rotate(-theta, z3) * z2;\n  pair z5 = rotate(theta, z4) * z3;\n  draw(arc(z0, z1, z2), lightgreen);\n  draw(arc(z3, z4, z2), lightgreen);\n  draw(arc(z2, z3, z0), lightgreen);\n  draw(arc(z4, z3, z5), lightgreen);\n  draw(z1--z0--z2--z3--z4--z5, deepcyan);\n  dot(\"$z_0=0$\", z0, dir(-45), red);\n  dot(\"$z_1=1$\", z1, dir(-45), red);\n  dot(\"$z_2$\", z2, dir(90));\n  dot(\"$z_3$\", z3, dir(90));\n  dot(\"$z_4=2r-1$\", z4, dir(-90));\n  dot(\"$z_5=2r-2$\", z5, dir(-90));\n\\end{asy}\n\\end{center}\nThis construction shows that if we have the length-one segment\n$\\{0,1\\}$ then we can construct the length-one segment $\\{2r-2, 2r-1\\}$.\nIn other words, we can shift the segment to the left by\n\\[ 1-(2r-1) = 2(1-r) = \\frac{1}{2n}. \\]\nRepeating this construction $n$ times gives the desired midpoint $\\half$.\n\\pagebreak\n\n\n\\end{document}", "category": "Geometry", "source": "TSTST", "year": 2013}
{"id": "imo-2007-q1", "question": "Real numbers $a_1$, $a_2$, \\dots, $a_n$ are fixed.\nFor each $1 \\le i \\le n$ we let\n$d_i = \\max\\{a_j : 1 \\le j \\le i\\} - \\min\\{a_j : i \\le j \\le n\\}$\nand let $d = \\max \\{d_i : 1 \\le i \\le n\\}$.\n\n\\begin{enumerate}[(a)]\n  \\ii Prove that for any real numbers $x_1 \\le \\dots \\le x_n$ we have\n  \\[\n    \\max \\left\\{ \\left\\lvert x_i - a_i \\right\\rvert :\n      1 \\le i \\le n \\right\\}\n      \\ge \\half d.\n  \\]\n  \\ii Moreover, show that there exists some\n  choice of $x_1 \\le \\dots \\le x_n$ which achieves equality.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p893741}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nReal numbers $a_1$, $a_2$, \\dots, $a_n$ are fixed.\nFor each $1 \\le i \\le n$ we let\n$d_i = \\max\\{a_j : 1 \\le j \\le i\\} - \\min\\{a_j : i \\le j \\le n\\}$\nand let $d = \\max \\{d_i : 1 \\le i \\le n\\}$.\n\n\\begin{enumerate}[(a)]\n  \\ii Prove that for any real numbers $x_1 \\le \\dots \\le x_n$ we have\n  \\[\n    \\max \\left\\{ \\left\\lvert x_i - a_i \\right\\rvert :\n      1 \\le i \\le n \\right\\}\n      \\ge \\half d.\n  \\]\n  \\ii Moreover, show that there exists some\n  choice of $x_1 \\le \\dots \\le x_n$ which achieves equality.\n\\end{enumerate}\n\\end{mdframed}\nNote that we can dispense of $d_i$ immediately\nby realizing that the definition of $d$ just says\n\\[ d = \\max_{1 \\le i \\le j \\le n} \\left( a_i - a_j \\right). \\]\n\nIf $a_1 \\le \\dots \\le a_n$ are already nondecreasing\nthen $d = 0$ and there is nothing to prove\n(for the equality case, just let $x_i = a_i$),\nso we will no longer consider this case.\n\nOtherwise, consider any indices $i < j$ with $a_i > a_j$.\nWe first prove (a) by applying the following claim\nwith $p = a_i$ and $q = a_j$:\n\\begin{claim*}\n  For any $p \\le q$, we have\n  either $|p - a_i| \\ge \\half(a_i-a_j)$\n  or $|q - a_j| \\ge \\half(a_i-a_j)$.\n\\end{claim*}\n\\begin{proof}\n  Assume for contradiction both are false.\n  Then $p > a_i - \\half(a_i-a_j)\n  = a_j + \\half(a_i-a_j) > q$, contradiction.\n\\end{proof}\n\nAs for (b), we let $i < j$ be any indices for which\n$a_i - a_j = d > 0$ achieves the maximal difference.\nWe then define $x_\\bullet$ in three steps:\n\\begin{itemize}\n  \\ii We set $x_k = \\frac{a_i + a_j}{2}$ for $k = i, \\dots, j$.\n  \\ii We recursively set $x_{k} = \\max(x_{k-1}, a_k)$\n  for $k = j+1, j+2, \\dots$.\n  \\ii We recursively set $x_{k} = \\min(x_{k+1}, a_k)$\n  for $k = i-1, i-2, \\dots$.\n\\end{itemize}\nBy definition, these $x_\\bullet$ are weakly increasing.\nTo prove this satisfies (b) we only need to check that\n\\[ \\left\\lvert x_k - a_k \\right\\rvert \\le \\frac{a_i-a_j}{2} \\qquad\n  (\\star) \\]\nfor any index $k$ (as equality holds for $k = i$ or $k = j$).\n\nWe note $(\\star)$ holds for $i < k < j$ by construction.\nFor $k > j$, note that $x_k \\in \\{a_j, a_{j+1}, \\dots, a_k\\}$\nby construction, so $(\\star)$ follows from our choice of $i$ and $j$\ngiving the largest possible difference; the case $k < i$ is similar.\n\\pagebreak", "category": "Algebra", "source": "IMO", "year": 2007}
{"id": "imo-2007-q2", "question": "Consider five points $A$, $B$, $C$, $D$ and $E$\nsuch that $ABCD$ is a parallelogram and $BCED$ is a cyclic quadrilateral.\nLet $\\ell$ be a line passing through $A$.\nSuppose that $\\ell$ intersects the interior of the segment $DC$ at $F$\nand intersects line $BC$ at $G$.\nSuppose also that $EF = EG = EC$.\nProve that $\\ell$ is the bisector of angle $ DAB$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p893744}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nConsider five points $A$, $B$, $C$, $D$ and $E$\nsuch that $ABCD$ is a parallelogram and $BCED$ is a cyclic quadrilateral.\nLet $\\ell$ be a line passing through $A$.\nSuppose that $\\ell$ intersects the interior of the segment $DC$ at $F$\nand intersects line $BC$ at $G$.\nSuppose also that $EF = EG = EC$.\nProve that $\\ell$ is the bisector of angle $ DAB$.\n\\end{mdframed}\nLet $M$, $N$, $P$ denote the midpoints of $\\ol{CF}$, $\\ol{CG}$, $\\ol{AC}$\n(noting $P$ is also the midpoint of $\\ol{BD}$).\n\nBy a homothety at $C$ with ratio $\\half$,\nwe find $\\ol{MNP}$ is the image of line $\\ell \\equiv \\ol{AGF}$.\n\n\\begin{center}\n\\begin{asy}\npair C = dir(200);\npair D = dir(340);\npair E = dir(240);\npair K = E*E/C;\npair B = C*K/D;\npair A = B+D-C;\npair M = foot(E, C, D);\npair N = foot(E, C, B);\npair P = foot(E, B, D);\nfilldraw(unitcircle, opacity(0.1)+lightcyan, blue);\ndraw(B--C--D--cycle, blue);\nfilldraw(CP(E, C), opacity(0.1)+lightred, red+dotted);\npair F = 2*M-C;\npair G = 2*N-C;\ndraw(E--P, orange);\ndraw(E--M, orange);\ndraw(E--N, orange);\ndraw(C--G, blue);\n\ndraw(N--P, deepgreen);\ndraw(A--G, deepgreen);\ndraw(B--A--D, lightblue+dashed);\ndraw(A--C, lightblue+dashed);\n\ndot(\"$C$\", C, dir(180));\ndot(\"$D$\", D, dir(D));\ndot(\"$E$\", E, dir(E));\ndot(\"$B$\", B, dir(B));\ndot(\"$A$\", A, dir(A));\ndot(\"$M$\", M, dir(135));\ndot(\"$N$\", N, dir(N));\ndot(\"$P$\", P, dir(P));\ndot(\"$F$\", F, dir(F));\ndot(\"$G$\", G, dir(G));\n\n/* TSQ Source:\n\nC = dir 200 R180\nD = dir 340\nE = dir 240\nK := E*E/C\nB = C*K/D\nA = B+D-C\nM = foot E C D R135\nN = foot E C B\nP = foot E B D\nunitcircle 0.1 lightcyan / blue\nB--C--D--cycle blue\nCP E C 0.1 lightred / red dotted\nF = 2*M-C\nG = 2*N-C\nE--P orange\nE--M orange\nE--N orange\nC--G blue\n\nN--P deepgreen\nA--G deepgreen\nB--A--D lightblue dashed\nA--C lightblue dashed\n\n*/\n\\end{asy}\n\\end{center}\n\nHowever, since we also have $\\ol{EM} \\perp \\ol{CF}$\nand $\\ol{EN} \\perp \\ol{CG}$ (from $EF=EG=EC$)\nwe conclude $\\ol{PMN}$ is the Simson line of $E$ with respect to $\\triangle BCD$,\nwhich implies $\\ol{EP} \\perp \\ol{BD}$.\nIn other words, $\\ol{EP}$ is the perpendicular bisector of $\\ol{BD}$,\nso $E$ is the midpoint of arc $\\widehat{BCD}$.\n\nFinally,\n\\begin{align*}\n  \\dang(\\ol{AB}, \\ell) &= \\dang(\\ol{CD}, \\ol{MNP}) = \\dang CMN = \\dang CEN \\\\\n  &= 90\\dg - \\dang NCE = 90\\dg + \\dang ECB\n\\end{align*}\nwhich means that $\\ell$ is parallel to a bisector of $\\angle BCD$,\nand hence to one of $\\angle BAD$.\n(Moreover since $F$ lies on the interior of $\\ol{CD}$,\nit is actually the internal bisector.)\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2007}
{"id": "imo-2007-q3", "question": "In a mathematical competition some competitors are (mutual) friends.\nCall a group of competitors a \\emph{clique} if each two of them are friends.\nGiven that the largest size of a clique is even,\nprove that the competitors can be arranged into two rooms\nsuch that the largest size of a clique contained in one room\nis the same as the largest size of a clique contained in the other room.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p893746}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nIn a mathematical competition some competitors are (mutual) friends.\nCall a group of competitors a \\emph{clique} if each two of them are friends.\nGiven that the largest size of a clique is even,\nprove that the competitors can be arranged into two rooms\nsuch that the largest size of a clique contained in one room\nis the same as the largest size of a clique contained in the other room.\n\\end{mdframed}\nTake the obvious graph interpretation $G$.\nWe paint red any vertices in one of the maximal cliques $K$,\nwhich we assume has $2r$ vertices,\nand paint the remaining vertices green.\nWe let $\\alpha(\\bullet)$ denote the clique number.\n\nInitially, let the two rooms $A = K$, $B = G-K$.\n\\begin{claim*}\n  We can move at most $r$ vertices of $A$ into $B$\n  to arrive at $\\alpha(A) \\le \\alpha(B) \\le \\alpha(A)+1$.\n\\end{claim*}\n\\begin{proof}\n  This is actually obvious by discrete continuity.\n  We move one vertex at a time,\n  noting $\\alpha(A)$ decreases by one at each step,\n  while $\\alpha(B)$ increases by either zero or one at each step.\n\n  We stop once $\\alpha(B) \\ge \\alpha(A)$,\n  which happens before we have moved $r$ vertices\n  (since then we have $\\alpha(B) \\ge r = \\alpha(A)$).\n  The conclusion follows.\n\\end{proof}\n\nSo let's consider the situation\n\\[ \\alpha(A) = k \\ge r \\qquad\\text{and}\\qquad \\alpha(B) = k+1. \\]\n\nAt this point $A$ is a set of $k$ red vertices,\nwhile $B$ has the remaining $2r-k$ red vertices\n(and all the green ones).\nAn example is shown below with $k=4$ and $2r = 6$.\n\n\\begin{center}\n\\begin{asy}\nsize(10cm);\npair K1 = 2*dir(45);\npair K2 = 2*dir(135);\npair K3 = 2*dir(225);\npair K4 = 2*dir(315);\n\nlabel(\"$A$\", (0,2), dir(90), red);\nlabel(\"$\\alpha(A) = k$\", (0,-2.5), dir(90), red);\nlabel(\"$k$ red vertices\", (0,-2.5), dir(-90), red);\n\npair K5 = (6,1);\npair K6 = (6,-1);\n\ndraw(K1--K5, palered);\ndraw(K2--K5, palered);\ndraw(K3--K5, palered);\ndraw(K4--K5, palered);\n\ndraw(K1--K6, palered);\ndraw(K2--K6, palered);\ndraw(K3--K6, palered);\ndraw(K4--K6, palered);\n\npair B1 = (4.8,1.3);\npair B2 = (3.7,0);\npair B3 = (4.8,-1.3);\n\npair C1 = (7.2,1.3);\npair C2 = (8.3,0);\npair C3 = (7.2,-1.3);\n\ndraw(K5--B1--K6, paleblue);\ndraw(K5--B2--K6, paleblue);\ndraw(K5--B3--K6, paleblue);\ndraw(B1--B2--B3--cycle, paleblue);\ndraw(K5--C1--K6, paleblue);\ndraw(K5--C2--K6, paleblue);\ndraw(K5--C3--K6, paleblue);\ndraw(C1--C2--C3--cycle, paleblue);\n\ndraw(K1--K2--K3--K4--cycle, red+1);\ndraw(K1--K3, red+1);\ndraw(K2--K4, red+1);\ndraw(K5--K6, red+1);\n\ndot(K1, red);\ndot(K2, red);\ndot(K3, red);\ndot(K4, red);\ndot(K5, red);\ndot(K6, red);\ndot(B1, deepgreen);\ndot(B2, deepgreen);\ndot(B3, blue);\ndot(C1, deepgreen);\ndot(C2, deepgreen);\ndot(C3, blue);\ndraw(circle(B3, 0.15), blue);\ndraw(circle(C3, 0.15), blue);\n\nlabel(\"$B$\", (6,2), dir(90), deepgreen);\nlabel(\"$\\alpha(B) = k+1$\", (6,-2.5), dir(90), deepgreen);\nlabel(\"$2r-k$ red vertices\", (6,-2.5), dir(-90), deepgreen);\n\ndraw((3,2.8)--(3,-2.8), black+1.5);\n\\end{asy}\n\\end{center}\n\nNow, if we can move any red vertex from $B$ back to $A$\nwithout changing the clique number of $B$, we do so, and win.\n\nOtherwise, it must be the case that \\emph{every}\n$(k+1)$-clique in $B$ uses \\emph{every} red vertex in $B$.\nFor each $(k+1)$-clique in $B$ (in arbitrary order), we do the following procedure.\n\\begin{itemize}\n  \\ii If all $k+1$ vertices are still green, pick one and re-color it blue.\n  This is possible since $k+1 > 2r-k$.\n  \\ii Otherwise, do nothing.\n\\end{itemize}\nThen we move all the blue vertices from $B$ to $A$,\none at a time, in the same order we re-colored them.\nThis forcibly decreases the clique number of $B$ to $k$,\nsince the clique number is $k+1$ just before the last blue vertex is moved,\nand strictly less than $k+1$ (hence equal to $k$) immediately after that.\n\n\\begin{claim*}\n  After this, $\\alpha(A) = k$ still holds.\n\\end{claim*}\n\\begin{proof}\n  Assume not, and we have a $(k+1)$-clique\n  which uses $b$ blue vertices and $(k+1)-b$ red vertices in $A$.\n  Together with the $2r-k$ red vertices already in $B$\n  we then get a clique of size\n  \\[ b + \\left( (k+1-b) \\right)\n  + \\left( 2r-k \\right) = 2r + 1 \\]\n  which is a contradiction.\n\\end{proof}\n\n\\begin{remark*}\n  Dragomir Grozev posted the\n  following motivation on\n  \\href{https://dgrozev.wordpress.com/2019/12/05/splitting-the-cliques-of-a-graph-imo-2007-p3/}{his blog}:\n  \\begin{quote}\n  I think, it's a natural idea to place all students in one room and begin\n  moving them one by one into the other one.\n  Then the max size of the cliques in the first and second room\n  increase (resp.\\ decrease) at most with one.\n  So, there would be a moment both sizes are almost the same.\n  At that moment we may adjust something.\n\n  Trying the idea, I had some difficulties\n  keeping track of the maximal cliques in the both rooms.\n  It seemed easier all the students in one of the rooms to comprise a clique.\n  It could be achieved by moving only the members of the maximal clique.\n  Following this path the remaining obstacles can be overcome naturally.\n  \\end{quote}\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Combinatorics", "source": "IMO", "year": 2007}
{"id": "imo-2007-q4", "question": "In triangle $ABC$ the bisector of $\\angle BCA$\nmeets the circumcircle again at $R$,\nthe perpendicular bisector of $\\ol{BC}$ at $P$,\nand the perpendicular bisector of $\\ol{AC}$ at $Q$.\nThe midpoint of $\\ol{BC}$ is $K$ and the midpoint of $\\ol{AC}$ is $L$.\nProve that the triangles $RPK$ and $RQL$ have the same area.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p894655}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nIn triangle $ABC$ the bisector of $\\angle BCA$\nmeets the circumcircle again at $R$,\nthe perpendicular bisector of $\\ol{BC}$ at $P$,\nand the perpendicular bisector of $\\ol{AC}$ at $Q$.\nThe midpoint of $\\ol{BC}$ is $K$ and the midpoint of $\\ol{AC}$ is $L$.\nProve that the triangles $RPK$ and $RQL$ have the same area.\n\\end{mdframed}\nWe first begin by proving the following claim.\n\\begin{claim*}\n  We have $CQ = PR$ (equivalently, $CP = QR$).\n\\end{claim*}\n\\begin{proof}\n  Let $O = \\ol{LQ} \\cap \\ol{KP}$ be the circumcenter.\n  Then\n  \\[ \\dang OPQ = \\dang KPC = 90\\dg - \\dang PCK\n  = 90\\dg - \\dang LCQ = \\dang \\dang CQL = \\dang PQO. \\]\n  Thus $OP = OQ$.\n  Since $OC = OR$ as well, we get the conclusion.\n\\end{proof}\n\nDenote by $X$ and $Y$ the feet from $R$ to $\\ol{CA}$\nand $\\ol{CB}$, so $\\triangle CXR \\cong \\triangle CYR$.\nThen, let $t = \\frac{CQ}{CR} = 1 - \\frac{CP}{CR}$.\n\n\\begin{center}\n\\begin{asy}\npair C = dir(90);\npair R = -C;\npair X = dir(205);\npair Y = -conj(X);\npair Q = 0.41*R+0.59*C;\npair P = R+C-Q;\npair L = foot(Q, C, X);\npair K = foot(P, C, Y);\npair A = 2*L-C;\npair B = 2*K-C;\npair O = extension(L, Q, P, K);\n\nfilldraw(L--Q--X--cycle, opacity(0.1)+orange, dotted+orange);\nfilldraw(P--K--Y--cycle, opacity(0.1)+orange, dotted+orange);\ndraw(C--A--B--cycle, lightblue);\ndraw(A--X, lightblue);\ndraw(circumcircle(C, A, B), lightblue+dashed);\ndraw(C--R, deepgreen);\ndraw(X--R--Y, deepgreen);\ndraw(L--O, blue);\ndraw(P--K, blue);\n\ndot(\"$C$\", C, dir(C));\ndot(\"$R$\", R, dir(R));\ndot(\"$X$\", X, dir(180));\ndot(\"$Y$\", Y, dir(0));\ndot(\"$Q$\", Q, dir(45));\ndot(\"$P$\", P, dir(215));\ndot(\"$L$\", L, dir(L));\ndot(\"$K$\", K, dir(K));\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$O$\", O, dir(315));\n\n/* TSQ Source:\n\nC = dir 90\nR = -C\nX = dir 205 R180\nY = -conj(X) R0\nQ = 0.41*R+0.59*C R45\nP = R+C-Q R215\nL = foot Q C X\nK = foot P C Y\nA = 2*L-C\nB = 2*K-C\nO = extension L Q P K R315\n\nL--Q--X--cycle 0.1 orange / dotted orange\nP--K--Y--cycle 0.1 orange / dotted orange\nC--A--B--cycle lightblue\nA--X lightblue\ncircumcircle C A B lightblue dashed\nC--R deepgreen\nX--R--Y deepgreen\nL--O blue\nP--K blue\n\n*/\n\\end{asy}\n\\end{center}\n\nThen it follows that\n\\[ [RQL] = [XQL] = t(1-t) \\cdot [XRC]\n= t(1-t) \\cdot [YCR] = [YKP] = [RKP] \\]\nas needed.\n\n\\begin{remark*}\n  Trigonometric approaches are very possible\n  (and easier to find) as well:\n  both areas work out to be $\\frac 18 ab \\tan \\half C$.\n\\end{remark*}\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2007}
{"id": "imo-2007-q5", "question": "Let $a$ and $b$ be positive integers.\nShow that if $4ab - 1$ divides $(4a^{2} - 1)^{2}$, then $a = b$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p894656}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a$ and $b$ be positive integers.\nShow that if $4ab - 1$ divides $(4a^{2} - 1)^{2}$, then $a = b$.\n\\end{mdframed}\nAs usual,\n\\[ 4ab-1 \\mid (4a^2-1)^2 \\iff 4ab-1 \\mid (4ab \\cdot a-b)^2\n  \\iff 4ab-1 \\mid (a-b)^2. \\]\nThen we use a typical Vieta jumping argument.\nDefine \\[ k = \\frac{(a-b)^2}{4ab-1}. \\]\nNote that $k = 0 \\iff a = b$.\nSo we will prove that $k > 0$ leads to a contradiction.\n\nIndeed, suppose $(a, b)$ is a minimal solution with $a > b$\n(we have $a \\neq b$ since $k \\neq 0$).\nBy Vieta jumping, $(b, \\frac{b^2+k}{a})$ is also such a solution.\nBut now\n\\begin{align*}\n  \\frac{b^2+k}{a} \\ge a &\\implies k \\ge a^2 - b^2 \\\\\n  &\\implies \\frac{(a-b)^2}{4ab-1} \\ge a^2-b^2 \\\\\n  &\\implies a-b \\ge (4ab-1)(a+b)\n\\end{align*}\nwhich is absurd for $a,b \\in \\ZZ_{>0}$.\n(In the last step we divided by $a-b > 0$.)\n\\pagebreak", "category": "Number Theory", "source": "IMO", "year": 2007}
{"id": "imo-2007-q6", "question": "Let $n$ be a positive integer.\nConsider\n\\[ S = \\left\\{ (x,y,z) \\mid\n  x,y,z \\in \\{ 0, 1, \\dots, n\\}, \\;\n  x+y+z > 0 \\right\\} \\]\nas a set of $(n+1)^3-1$ points in the three-dimensional space.\nDetermine the smallest possible number of planes,\nthe union of which contains $S$ but does not include $(0,0,0)$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p894658}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n$ be a positive integer.\nConsider\n\\[ S = \\left\\{ (x,y,z) \\mid\n  x,y,z \\in \\{ 0, 1, \\dots, n\\}, \\;\n  x+y+z > 0 \\right\\} \\]\nas a set of $(n+1)^3-1$ points in the three-dimensional space.\nDetermine the smallest possible number of planes,\nthe union of which contains $S$ but does not include $(0,0,0)$.\n\\end{mdframed}\nThe answer is $3n$.\nHere are two examples of constructions with $3n$ planes:\n\\begin{itemize}\n  \\ii $x+y+z=i$ for $i=1,\\dots,3n$.\n  \\ii $x=i$, $y=i$, $z=i$ for $i=1,\\dots,n$.\n\\end{itemize}\nSuppose for contradiction we have $N < 3n$ planes.\nLet them be $a_i x + b_i y + c_i z + 1 = 0$, for $i = 1, \\dots, N$.\nDefine the polynomials\n\\begin{align*}\n  A(x,y,z) &= \\prod_{i=1}^n (x-i) \\prod_{i=1}^n (y-i) \\prod_{i=1}^n (z-i) \\\\\n  B(x,y,z) &= \\prod_{i=1}^N \\left( a_i x + b_i y + c_i z + 1 \\right).\n\\end{align*}\nNote that $A(0,0,0) = (-1)^n  (n!)^3 \\neq 0$\nand $B(0,0,0) =  1 \\neq 0$,\nbut $A(x,y,z) = B(x,y,z) = 0$ for any $(x,y,z) \\in S$.\nAlso, the coefficient of $x^n y^n z^n$ in $A$ is $1$,\nwhile the coefficient of $x^n y^n z^n$ in $B$ is $0$.\n\nNow, define\n\\[ P(x,y,z) \\coloneq A(x,y,z) - \\lambda  B(x,y,z). \\]\nwhere $\\lambda = \\frac{A(0,0,0)}{B(0,0,0)} = (-1)^{n} (n!)^3$.\nWe now have that\n\\begin{itemize}\n  \\ii $P(x,y,z) = 0$ for any $x,y,z \\in \\left\\{ 0,1,\\dots,n \\right\\}^3$.\n  \\ii But the coefficient of $x^n y^n z^n$ is $1$.\n\\end{itemize}\nThis is a contradiction to Alon's combinatorial nullstellensatz.\n\\pagebreak\n\n\n\\end{document}", "category": "Geometry", "source": "IMO", "year": 2007}
{"id": "usamo-2016-q1", "question": "Let $X_1$, $X_2$, \\dots, $X_{100}$ be a sequence of\nmutually distinct nonempty subsets of a set $S$.\nAny two sets $X_i$ and $X_{i+1}$ are disjoint and their union is not the whole set $S$,\nthat is, $X_i \\cap X_{i+1} = \\emptyset$ and $X_i \\cup X_{i+1} \\neq S$,\nfor all $i \\in \\{1, \\dots, 99\\}$.\nFind the smallest possible number of elements in $S$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6213589}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $X_1$, $X_2$, \\dots, $X_{100}$ be a sequence of\nmutually distinct nonempty subsets of a set $S$.\nAny two sets $X_i$ and $X_{i+1}$ are disjoint and their union is not the whole set $S$,\nthat is, $X_i \\cap X_{i+1} = \\emptyset$ and $X_i \\cup X_{i+1} \\neq S$,\nfor all $i \\in \\{1, \\dots, 99\\}$.\nFind the smallest possible number of elements in $S$.\n\\end{mdframed}\nSolution with Danielle Wang: the answer is that $|S| \\ge 8$.\n\n\\paragraph{Proof that $|S| \\ge 8$ is necessary.}\nSince we must have $2^{|S|} \\geq 100$, we must have $|S| \\geq 7$.\n\nTo see that $|S| = 8$ is the minimum possible size,\nconsider a chain on the set $S = \\{1, 2, \\dots, 7\\}$\nsatisfying $X_i \\cap X_{i+1} = \\emptyset$ and $X_i \\cup X_{i+1} \\neq S$.\nBecause of these requirements any subset of size $4$ or more\ncan only be neighbored by sets of size $2$ or less,\nof which there are $\\binom 71 + \\binom 72 = 28$ available.\nThus, the chain can contain no more than $29$ sets of size $4$ or more\nand no more than $28$ sets of size $2$ or less.\nFinally, since there are only $\\binom 73 = 35$ sets of size $3$ available,\nthe total number of sets in such a chain\ncan be at most $29 + 28 + 35 = 92 < 100$, contradiction.\n\n\\paragraph{Construction.}\nWe will provide an inductive construction for a chain of subsets\n$X_1, X_2, \\dots, X_{2^{n-1} + 1}$ of $S = \\left\\{ 1, \\dots, n \\right\\}$\nsatisfying $X_i \\cap X_{i+1} = \\varnothing$\nand $X_i \\cup X_{i+1} \\neq S$ for each $n \\geq 4$.\n\nFor $S = \\{1, 2, 3, 4\\}$,\nthe following chain of length $2^3 + 1 = 9$ will work:\n\\[\n\\begin{array}{ccccccccc}\n  34 & 1 & 23 & 4 & 12 & 3 & 14 & 2 & 13\n\\end{array}.\n\\]\nNow, given a chain of subsets of $\\{1, 2, \\dots, n\\}$\nthe following procedure produces a\nchain of subsets of $\\{1, 2, \\dots, n+1\\}$:\n\\begin{enumerate}\n\\item take the original chain, delete any element,\n  and make two copies of this chain, which now has even length;\n\\item glue the two copies together,\n  joined by $\\varnothing$ in between; and then\n\\item insert the element $n+1$ into the sets in alternating positions\n  of the chain starting with the first.\n\\end{enumerate}\nFor example, the first iteration of this construction gives:\n\\[\n \\begin{array}{ccccccccc}\n 345 & 1 & 235 & 4 & 125 & 3 & 145 & 2 & 5 \\\\\n 34 & 15 & 23 & 45 & 12 & 35 & 14 & 25 &\n \\end{array}\n\\]\nIt can be easily checked that if the original chain satisfies the requirements,\nthen so does the new chain, and if the original chain has length $2^{n-1}+1$,\nthen the new chain has length $2^{n}+1$, as desired.\nThis construction yields a chain of length $129$\nwhen $S = \\{1, 2, \\dots, 8\\}$.\n\n\\begin{remark*}\n  Here is the construction for $n=8$ in its full glory.\n \\[\n  \\begin{array}{ccccccccc}\n  345678 & 1 & 235678 & 4 & 125678 & 3 & 145678 & 2 & 5678 \\\\\n  34 & 15678 & 23 & 45678 & 12 & 35678 & 14 & 678 & \\\\\n  345 & 1678 & 235 & 4678 & 125 & 3678 & 145 & 2678 & 5 \\\\\n  34678 & 15 & 23678 & 45 & 12678 & 35 & 78 & & \\\\\\hline\n  3456 & 178 & 2356 & 478 & 1256 & 378 & 1456 & 278 & 56 \\\\\n  3478 & 156 & 2378 & 456 & 1278 & 356 & 1478 & 6 & \\\\\n  34578 & 16 & 23578 & 46 & 12578 & 36 & 14578 & 26 & 578 \\\\\n  346 & 1578 & 236 & 4578 & 126 & 8 & & & \\\\ \\hline\\hline\n  34567 & 18 & 23567 & 48 & 12567 & 38 & 14567 & 28 & 567 \\\\\n  348 & 1567 & 238 & 4567 & 128 & 3567 & 148 & 67 & \\\\\n  3458 & 167 & 2358 & 467 & 1258 & 367 & 1458 & 267 & 58 \\\\\n  3467 & 158 & 2367 & 458 & 1267 & 358 & 7 & & \\\\\\hline\n  34568 & 17 & 23568 & 47 & 12568 & 37 & 14568 & 27 & 568 \\\\\n  347 & 1568 & 237 & 4568 & 127 & 3568 & 147 & 68 & \\\\\n  3457 & 168 & 2357 & 468 & 1257 & 368 & 1457 & 268 & 57 \\\\\n  3468 & 157 & 2368 & 457 & 1268 & & & & \\\\\n  \\end{array}\n \\]\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "USAMO", "year": 2016}
{"id": "usamo-2016-q2", "question": "Prove that for any positive integer $k$,\n\\[ (k^2)!\\cdot\\displaystyle\\prod_{j=0}^{k-1}\\frac{j!}{(j+k)!} \\]\nis an integer.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6213627}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nProve that for any positive integer $k$,\n\\[ (k^2)!\\cdot\\displaystyle\\prod_{j=0}^{k-1}\\frac{j!}{(j+k)!} \\]\nis an integer.\n\\end{mdframed}\nWe show the exponent of any given prime $p$ is nonnegative in the expression.\nRecall that the exponent of $p$ in $n!$ is equal to\n$\\sum_{i \\ge 1} \\left\\lfloor n/p^i \\right\\rfloor$.\nIn light of this, it suffices to show\nthat for any prime power $q$, we have\n\\[\n\\left\\lfloor \\frac{k^2}{q} \\right\\rfloor\n+ \\sum_{j=0}^{k-1} \\left\\lfloor \\frac{j}{q} \\right\\rfloor\n\\ge \\sum_{j=0}^{k-1} \\left\\lfloor \\frac{j+k}{q} \\right\\rfloor\n\\]\nSince both sides are integers, we show\n\\[\n\\left\\lfloor \\frac{k^2}{q} \\right\\rfloor\n+ \\sum_{j=0}^{k-1} \\left\\lfloor \\frac{j}{q} \\right\\rfloor\n> -1 + \\sum_{j=0}^{k-1} \\left\\lfloor \\frac{j+k}{q} \\right\\rfloor.\n\\]\nIf we denote by $\\left\\{ x \\right\\}$ the fractional part of $x$,\nthen $\\left\\lfloor x \\right\\rfloor = x - \\left\\{ x \\right\\}$\nso it's equivalent to\n\\[\n\\left\\{ \\frac{k^2}{q} \\right\\}\n+ \\sum_{j=0}^{k-1} \\left\\{ \\frac{j}{q} \\right\\}\n< 1 + \\sum_{j=0}^{k-1} \\left\\{ \\frac{j+k}{q} \\right\\}.\n\\]\nHowever, the sum of remainders when $0, 1, \\dots, k-1$ are taken modulo $q$\nis easily seen to be less than the sum of remainders\nwhen $k, k+1, \\dots, 2k-1$ are taken modulo $q$.\nSo \\[ \\sum_{j=0}^{k-1} \\left\\{ \\frac{j}{q} \\right\\}\n\\le \\sum_{j=0}^{k-1} \\left\\{ \\frac{j+k}{q} \\right\\} \\] follows,\nand we are done upon noting $\\left\\{ k^2/q \\right\\} < 1$.\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 2016}
{"id": "usamo-2016-q3", "question": "Let $ABC$ be an acute triangle\nand let $I_B$, $I_C$, and $O$ denote its\n$B$-excenter, $C$-excenter, and circumcenter, respectively.\nPoints $E$ and $Y$ are selected on $\\ol{AC}$ such that\n$\\angle ABY = \\angle CBY$ and $\\ol{BE} \\perp \\ol{AC}$.\nSimilarly, points $F$ and $Z$ are selected on $\\ol{AB}$ such that\n$\\angle ACZ = \\angle BCZ$ and $\\ol{CF} \\perp \\ol{AB}$.\n\nLines $I_B F$ and $I_C E$ meet at $P$.\nProve that $\\ol{PO}$ and $\\ol{YZ}$ are perpendicular.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6213572}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be an acute triangle\nand let $I_B$, $I_C$, and $O$ denote its\n$B$-excenter, $C$-excenter, and circumcenter, respectively.\nPoints $E$ and $Y$ are selected on $\\ol{AC}$ such that\n$\\angle ABY = \\angle CBY$ and $\\ol{BE} \\perp \\ol{AC}$.\nSimilarly, points $F$ and $Z$ are selected on $\\ol{AB}$ such that\n$\\angle ACZ = \\angle BCZ$ and $\\ol{CF} \\perp \\ol{AB}$.\n\nLines $I_B F$ and $I_C E$ meet at $P$.\nProve that $\\ol{PO}$ and $\\ol{YZ}$ are perpendicular.\n\\end{mdframed}\nWe present two solutions.\n\n\\paragraph{First solution.}\nLet $I_A$ denote the $A$-excenter and $I$ the incenter.\nThen let $D$ denote the foot of the altitude from $A$.\nSuppose the $A$-excircle is tangent to $\\ol{BC}$, $\\ol{AB}$, $\\ol{AC}$\nat $A_1$, $B_1$, $C_1$ and let\n$A_2$, $B_2$, $C_2$ denote the reflections of $I_A$ across these points.\nLet $S$ denote the circumcenter of $\\triangle I I_B I_C$.\n\n\\begin{center}\n\\begin{asy}\nsize(14cm);\n\npair A = dir(110);\npair B = dir(208);\npair C = dir(332);\ndraw(A--B--C--cycle, blue+1);\npair I = incenter(A, B, C);\npair O = circumcenter(A, B, C);\npair E = foot(B, C, A);\npair F = foot(C, A, B);\npair M_A = extension(A, I, O, B+C);\npair I_A = 2*M_A-I;\npair M_B = extension(B, I, O, C+A);\npair I_B = 2*M_B-I;\npair M_C = extension(C, I, O, A+B);\npair I_C = 2*M_C-I;\n\npair P = extension(E, I_C, F, I_B);\ndraw(A--I_A, blue+dashed);\n\npair D = foot(A, B, C);\nfilldraw(I--I_B--I_C--cycle, opacity(0.2)+lightred, red);\nfilldraw(unitcircle, opacity(0.1)+lightblue, blue);\n\npair A_1 = foot(I_A, B, C);\npair B_1 = foot(I_A, A, B);\npair C_1 = foot(I_A, C, A);\ndraw(arc(I_A, abs(I_A-A_1), 15, 165), blue+dotted);\ndraw(C--C_1, blue+dashed);\ndraw(B--B_1, blue+dashed);\npair A_2 = 2*A_1-I_A;\npair B_2 = 2*B_1-I_A;\npair C_2 = 2*C_1-I_A;\ndraw(D--A_2, heavygreen);\ndraw(I_B--B_2, heavygreen);\ndraw(I_C--C_2, heavygreen);\ndraw(I_A--A_2, heavygreen+dashed);\ndraw(I_A--B_2, heavygreen+dashed);\ndraw(I_A--C_2, heavygreen+dashed);\n\ndraw(I_B--I_A--I_C, red+dashed);\ndraw(B--I--C, red+dashed);\nfilldraw(A_2--B_2--C_2--cycle, opacity(0.2)+lightgreen, deepgreen+1);\npair S = circumcenter(I, I_B, I_C);\ndraw(S--I_A, orange);\ndraw(arc(S, abs(S-I), 185, 355), red+dotted);\n\npair Y = extension(B, I, A, C);\npair Z = extension(C, I, A, B);\ndraw(Y--Z, red);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(180));\ndot(\"$C$\", C, dir(0));\ndot(\"$I$\", I, dir(270));\ndot(\"$O$\", O, dir(-45));\ndot(\"$E$\", E, dir(30));\ndot(\"$F$\", F, dir(F));\ndot(\"$I_A$\", I_A, dir(I_A));\ndot(\"$I_B$\", I_B, dir(I_B));\ndot(\"$I_C$\", I_C, dir(I_C));\ndot(\"$P$\", P, dir(135));\ndot(\"$D$\", D, dir(-90));\ndot(\"$A_1$\", A_1, dir(A_1));\ndot(\"$B_1$\", B_1, dir(200));\ndot(\"$C_1$\", C_1, dir(20));\ndot(\"$A_2$\", A_2, dir(A_2));\ndot(\"$B_2$\", B_2, dir(B_2));\ndot(\"$C_2$\", C_2, dir(C_2));\ndot(\"$S$\", S, dir(S));\ndot(\"$Y$\", Y, dir(350));\ndot(\"$Z$\", Z, dir(110));\n\n/* Source generated by TSQ\n\n!size(14cm);\n\nA = dir 110\nB = dir 208 R180\nC = dir 332 R0\nA--B--C--cycle blue+1\nI = incenter A B C R270\nO = circumcenter A B C R-45\nE = foot B C A R30\nF = foot C A B\nM_A := extension A I O B+C\nI_A = 2*M_A-I\nM_B := extension B I O C+A\nI_B = 2*M_B-I\nM_C := extension C I O A+B\nI_C = 2*M_C-I\n\nP = extension E I_C F I_B R140\nA--I_A blue dashed\n\nD = foot A B C R-90\nI--I_B--I_C--cycle 0.2 lightred / red\nunitcircle 0.1 lightblue / blue\n\nA_1 = foot I_A B C\nB_1 = foot I_A A B R200\nC_1 = foot I_A C A R20\n!draw(arc(I_A, abs(I_A-A_1), 15, 165), blue+dotted);\nC--C_1 blue dashed\nB--B_1 blue dashed\nA_2 = 2*A_1-I_A\nB_2 = 2*B_1-I_A\nC_2 = 2*C_1-I_A\nD--A_2 heavygreen\nI_B--B_2 heavygreen\nI_C--C_2 heavygreen\nI_A--A_2 heavygreen dashed\nI_A--B_2 heavygreen dashed\nI_A--C_2 heavygreen dashed\n\nI_B--I_A--I_C red dashed\nB--I--C red dashed\nA_2--B_2--C_2--cycle 0.2 lightgreen / deepgreen+1\nS = circumcenter I I_B I_C\nS--I_A orange\n!draw(arc(S, abs(S-I), 185, 355), red+dotted);\n\nY = extension B I A C R350\nZ = extension C I A B R110\nY--Z red\n\n\n\n*/\n\\end{asy}\n\\end{center}\n\nWe begin with the following observation:\n\\begin{claim*}\n  Points $D$, $I$, $A_2$ are collinear.\n  Similarly, points $E$, $I_C$, $C_2$ are collinear\n  and points $F$, $I_B$, $B_2$ are collinear.\n\\end{claim*}\n\n\\begin{proof}\n  This basically follows from the ``midpoints of altitudes'' lemma.\n  To see $D$, $I$, $A_2$ are collinear,\n  recall first that $\\ol{IA_1}$ passes\n  through the midpoint $M$ of $\\ol{AD}$.\n  \\begin{center}\n  \\begin{asy}\n    pair A = dir(125);\n    pair B = dir(220);\n    pair C = dir(320);\n    draw(A--B--C--cycle, blue);\n    pair I = incenter(A, B, C);\n    pair O = circumcenter(A, B, C);\n    pair M_A = extension(A, I, O, B+C);\n    pair I_A = 2*M_A-I;\n    filldraw(incircle(A, B, C), opacity(0.2)+lightblue, blue);\n\n    pair D = foot(A, B, C);\n    filldraw(unitcircle, opacity(0.1)+palecyan, blue);\n    draw(A--D, heavygreen);\n\n    pair A_1 = foot(I_A, B, C);\n    draw(arc(I_A, abs(I_A-A_1), 0, 180), blue+dashed);\n    pair B_1 = foot(I_A, A, B);\n    pair C_1 = foot(I_A, C, A);\n    draw(C--C_1, blue+dotted);\n    draw(B--B_1, blue+dotted);\n\n    pair A_2 = 2*A_1-I_A;\n    draw(A--I_A, blue);\n    draw(D--A_2, red);\n    draw(I_A--A_2, blue+dotted);\n\n    pair P = foot(I, B, C);\n    pair Q = 2*I-P;\n    draw(A--A_1, heavygreen);\n    draw(P--Q, heavygreen);\n\n    pair U = extension(Q, Q+B-C, A, B);\n    pair V = extension(Q, Q+C-B, A, C);\n    draw(U--V, heavygreen);\n\n    pair M = midpoint(A--D);\n    draw(M--A_1, dotted);\n\n    dot(P); dot(Q);\n\n\n    dot(\"$A$\", A, dir(A));\n    dot(\"$B$\", B, dir(180));\n    dot(\"$C$\", C, dir(0));\n    dot(\"$I$\", I, dir(10));\n    dot(\"$I_A$\", I_A, dir(I_A));\n    dot(\"$D$\", D, dir(-90));\n    dot(\"$A_1$\", A_1, dir(-45));\n    dot(\"$B_1$\", B_1, dir(200));\n    dot(\"$C_1$\", C_1, dir(20));\n    dot(\"$A_2$\", A_2, dir(A_2));\n    dot(\"$M$\", M, dir(0));\n\n    /* TSQ Source:\n\n    A = dir 125\n    B = dir 220 R180\n    C = dir 320 R0\n    A--B--C--cycle blue\n    I = incenter A B C R10\n    O := circumcenter A B C R45\n    M_A := extension A I O B+C\n    I_A = 2*M_A-I\n    incircle A B C 0.2 lightblue / blue\n\n    D = foot A B C R-90\n    unitcircle 0.1 palecyan / blue\n    A--D heavygreen\n\n    A_1 = foot I_A B C R-45\n    !draw(arc(I_A, abs(I_A-A_1), 0, 180), blue+dashed);\n    B_1 = foot I_A A B R200\n    C_1 = foot I_A C A R20\n    C--C_1 blue dotted\n    B--B_1 blue dotted\n\n    A_2 = 2*A_1-I_A\n    A--I_A blue\n    D--A_2 red\n    I_A--A_2 blue dotted\n\n    P := foot I B C\n    Q := 2*I-P\n    A--A_1 heavygreen\n    P--Q heavygreen\n\n    U := extension Q Q+B-C A B\n    V := extension Q Q+C-B A C\n    U--V heavygreen\n\n    M = midpoint A--D R0\n    M--A_1 dotted\n\n    !dot(P); dot(Q);\n\n    */\n\n  \\end{asy}\n  \\end{center}\n  Now since $\\ol{AD} \\parallel \\ol{I_A A_2}$,\n  and $M$ and $A_1$ are the midpoints of $\\ol{AD}$ and $\\ol{I_A A_2}$,\n  it follows from the collinearity of $A$, $I$, $I_A$\n  that $D$, $I$, $A_2$ are collinear as well.\n\n  The other two claims follow in a dual fashion.\n  For example, using the homothety taking the $A$ to $C$-excircle,\n  we find that $\\ol{C_1I_C}$ bisects the altitude $\\ol{BE}$.\n  (The homothety at $B$ will send $C_1$ to the point on the $C$-excircle which is\n  diametrically opposite the foot from $I_C$ to $AC$. This diameter of the\n  $C$-excircle is then mapped through homothety through $C_1$ onto the $B$-altitude.)\n  Then since $I_C$, $B$, $I_A$ are collinear the same argument\n  now gives $I_C$, $E$, $C_2$ are collinear.\n  The fact that $I_B$, $F$, $B_2$ are collinear is symmetric.\n\\end{proof}\n\nObserve that $\\ol{B_2C_2} \\parallel \\ol{B_1C_1} \\parallel \\ol{I_B I_C}$.\nProceeding similarly on the other sides,\nwe discover $\\triangle I I_B I_C$ and $\\triangle A_2 B_2 C_2$ are homothetic.\nHence $P$ is the center of this homothety (in particular, $D$, $I$, $P$, $A_2$ are collinear).\nMoreover, $P$ lies on the line joining $I_A$ to $S$,\nwhich is the Euler line of $\\triangle I I_B I_C$,\nso it passes through the nine-point center of $\\triangle I I_B I_C$,\nwhich is $O$. Consequently, $P$, $O$, $I_A$ are collinear as well.\n\nTo finish, we need only prove that $\\ol{OS} \\perp \\ol{YZ}$.\nIn fact, we claim that $\\ol{YZ}$ is the radical axis\nof the circumcircles of $\\triangle ABC$ and $\\triangle I I_B I_C$.\nActually, $Y$ is the radical center of these two circumcircles\nand the circle with diameter $\\ol{II_B}$\n(which passes through $A$ and $C$).\nAnalogously $Z$ is the radical center of the circumcircles\nand the circle with diameter $\\ol{II_C}$, and the proof is complete.\n\n\\paragraph{Second solution (barycentric, outline, Colin Tang).}\nwe are going to use barycentric coordinates\nto show that the line through $O$ perpendicular to $\\ol{YZ}$\nis concurrent with $\\ol{I_B F}$ and $\\ol{I_C E}$.\n\nThe displacement vector $\\overrightarrow{YZ}$\nis proportional to $(a(b-c):-b(a+c):c(a+b))$,\nand so by strong perpendicularity criterion\nand doing a calculation gives the line\n\\[ x(b-c)bc(a+b+c) + y(a+c)ac(a+b-c) + z(a+b)ab(-a+b-c) = 0. \\]\nOn the other hand, line $I_C E$ has equation\n\\[\n  0 =\n  \\det \\begin{bmatrix}\n    a &  b & -c \\\\\n    S_C & 0 & S_A \\\\\n    x & y & z\n  \\end{bmatrix}\n  = bS_a \\cdot x + (-cS_C-aS_A) \\cdot y + (-bS_C) \\cdot z\n\\]\nand similarly for $I_B F$.\nConsequently, concurrence of these lines is equivalent to\n\\[\n  \\det \\begin{bmatrix}\n    bS_A & -cS_C - aS_A & -bS_C \\\\\n    cS_A & -cS_B & -aS_A - bS_B \\\\\n    (b-c)bc(a+b+c) & (a+c)ac(a+b-c) & (a+b)ab(-a+b-c)\n  \\end{bmatrix}\n  = 0\n\\]\nwhich is a computation.\n\n\\paragraph{Authorship comments.}\nI was intrigued by a Taiwan TST problem which implied that,\nin the configuration above, $\\angle I_B D I_C$ was bisected by $\\ol{DA}$.\nThis motivated me to draw all three properties above where $I_A$ and $P$\nwere isogonal conjugates with respect to $DEF$.\nAfter playing around with this picture for a long time,\nI finally noticed that $O$ was on line $PI_A$.\n(So the original was to show that $I_B F$, $I_C E$, $DA_2$ concurrent).\nEventually I finally noticed in the picture that $PI_A$\nactually passed through the circumcenter of $ABC$ as well.\nThis took me many hours to prove.\n\nThe final restatement (which follows quickly from $P$, $O$, $I_A$ collinear)\nwas discovered by Telv Cohl when I showed him the problem.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Geometry", "source": "USAMO", "year": 2016}
{"id": "usamo-2016-q4", "question": "Find all functions $f \\colon \\RR \\to \\RR$ such that\nfor all real numbers $x$ and $y$,\n\\[ (f(x)+xy) \\cdot f(x-3y) + (f(y)+xy) \\cdot f(3x-y) = (f(x+y))^2. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6220308}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all functions $f \\colon \\RR \\to \\RR$ such that\nfor all real numbers $x$ and $y$,\n\\[ (f(x)+xy) \\cdot f(x-3y) + (f(y)+xy) \\cdot f(3x-y) = (f(x+y))^2. \\]\n\\end{mdframed}\nWe claim that the only two functions satisfying\nthe requirements are $f(x) \\equiv 0$ and $f(x) \\equiv x^2$.\nThese work.\n\nFirst, taking $x=y=0$ in the given yields $f(0) = 0$,\nand then taking $x=0$ gives $f(y)f(-y) = f(y)^2$.\nSo also $f(-y)^2 = f(y)f(-y)$, from which we conclude $f$ is even.\nThen taking $x = -y$ gives\n\\[ \\forall x \\in \\RR : \\qquad\nf(x) = x^2 \\qquad\\text{or}\\qquad f(4x) = 0 \\qquad(\\bigstar) \\]\nfor all $x$.\n\n\\begin{remark*}\n  Note that an example of a function satisfying $(\\bigstar)$ is\n  \\[\n    f(x)\n    =\n    \\begin{cases}\n      x^2 & \\text{if } |x| < 1 \\\\\n      1 - \\cos \\left( \\frac{\\pi}{2} \\cdot x^{1337} \\right)  & \\text{if } 1 \\le |x| < 4 \\\\\n      0 & \\text{if } |x| \\ge 4.\n    \\end{cases}\n  \\]\n  So, yes, we are currently in a world of trouble, still.\n  (This function is even continuous; I bring this up to emphasize that\n  ``continuity'' is completely unrelated to the issue at hand.)\n\\end{remark*}\n\nNow we claim\n\\begin{claim*}\n  $f(z) = 0 \\iff f(2z) = 0 \\qquad (\\spadesuit)$.\n\\end{claim*}\n\\begin{proof}\n  Let $(x,y)=(3t,t)$ in the given to get\n  \\[ \\left( f(t)+3t^2 \\right)f(8t) = f(4t)^2. \\]\n  Now if $f(4t) \\neq 0$ (in particular, $t \\neq 0$),\n  then $f(8t) \\neq 0$.\n  Thus we have $(\\spadesuit)$ in the reverse direction.\n\n  Then $f(4t) \\neq 0 \\overset{(\\bigstar)}{\\implies} f(t) = t^2 \\neq 0\n  \\overset{(\\spadesuit)}{\\implies} f(2t) \\neq 0$\n  implies the forwards direction,\n  the last step being the reverse direction $(\\spadesuit)$.\n\\end{proof}\n%so by $(\\bigstar)$ we have $f(t) = t^2$, and moreover $f(8t) \\neq 0$.\n%But we also have\n%\\[ \\left( f(t/4)+\\frac{3}{16}t^2 \\right)f(2t) = f(t)^2 = t^4 \\neq 0 \\]\n%and hence $f(2t) \\neq 0$ as well.\n%Thus we have seen that $f(4t) \\neq 0 \\implies f(8t), f(2t) \\neq 0$\n%which is logically equivalent to $(\\spadesuit)$.\n\nBy putting together $(\\bigstar)$ and $(\\spadesuit)$ we finally get\n\\[ \\forall x \\in \\RR : \\qquad\nf(x) = x^2 \\qquad\\text{or}\\qquad f(x) = 0 \\qquad(\\heartsuit) \\]\n\nWe are now ready to approach the main problem.\nAssume there's an $a \\neq 0$ for which $f(a) = 0$;\nwe show that $f \\equiv 0$.\n\nLet $b \\in \\RR$ be given.\nSince $f$ is even, we can assume without loss of generality that $a, b > 0$.\nAlso, note that $f(x) \\ge 0$ for all $x$ by $(\\heartsuit)$.\nBy using $(\\spadesuit)$ we can generate $c > b$\nsuch that $f(c) = 0$ by taking $c = 2^n a$ for a large enough integer $n$.\nNow, select $x, y > 0$ such that\n$x-3y=b$ and $x+y=c$. That is,\n\\[\n  (x,y) = \\left( \\frac{3c+b}{4}, \\frac{c-b}{4} \\right).\n\\]\nSubstitution into the original equation gives\n\\[\n  0 = \\left( f(x) + xy \\right) f(b)\n  + \\left( f(y) + xy \\right) f(3x-y)\n  \\ge \\left( f(x) + xy \\right) f(b).\n\\]\nBut since $f(b) \\ge 0$, it follows $f(b) = 0$, as desired.\n\\pagebreak", "category": "Algebra", "source": "USAMO", "year": 2016}
{"id": "usamo-2016-q5", "question": "An equilateral pentagon $AMNPQ$ is inscribed in triangle $ABC$\nsuch that $M \\in \\ol{AB}$, $Q \\in \\ol {AC}$, and $N,P \\in \\ol{BC}$.\nLet $S$ be the intersection of $\\ol{MN}$ and $\\ol{PQ}$.\nDenote by $\\ell$ the angle bisector of $\\angle MSQ$.\n\nProve that $\\ol{OI}$ is parallel to $\\ell$,\nwhere $O$ is the circumcenter of triangle $ABC$,\nand $I$ is the incenter of triangle $ABC$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6220306}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nAn equilateral pentagon $AMNPQ$ is inscribed in triangle $ABC$\nsuch that $M \\in \\ol{AB}$, $Q \\in \\ol {AC}$, and $N,P \\in \\ol{BC}$.\nLet $S$ be the intersection of $\\ol{MN}$ and $\\ol{PQ}$.\nDenote by $\\ell$ the angle bisector of $\\angle MSQ$.\n\nProve that $\\ol{OI}$ is parallel to $\\ell$,\nwhere $O$ is the circumcenter of triangle $ABC$,\nand $I$ is the incenter of triangle $ABC$.\n\\end{mdframed}\n\\paragraph{First solution (complex).}\nIn fact, we only need $AM = AQ = NP$ and $MN = QP$.\n\nWe use complex numbers with $ABC$ the unit circle,\nassuming WLOG that $A$, $B$, $C$ are labeled counterclockwise.\nLet $x$, $y$, $z$ be the complex numbers corresponding to the arc midpoints\nof $BC$, $CA$, $AB$, respectively; thus $x+y+z$ is the incenter of $\\triangle ABC$.\nFinally, let $s > 0$ be the side length of $AM = AQ = NP$.\n\nThen, since $MA = s$ and $MA \\perp OZ$, it follows that\n\\[ m - a = i \\cdot sz. \\]\nSimilarly, $p-n = i \\cdot sy$ and $a-q = i \\cdot sx$, so summing these up gives\n\\[ i \\cdot s(x+y+z) = (p-q) + (m-n) = (m-n) - (q-p). \\]\nSince $MN = PQ$, the argument of $(m-n) - (q-p)$ is along\nthe external angle bisector of the angle formed, which is perpendicular to $\\ell$.\nOn the other hand, $x+y+z$ is oriented in the same direction as $OI$, as desired.\n\n\\paragraph{Second solution (trig, Danielle Wang).}\nLet $\\delta$ and $\\epsilon$ denote $\\angle MNB$ and $\\angle CPQ$.\nAlso, assume $AMNPQ$ has side length $1$.\n\nIn what follows, assume $AB < AC$.\nFirst, we note that\n\\begin{align*}\nBN   &=   (c-1) \\cos B + \\cos \\delta \\textrm{,}    \\\\\nCP   &=   (b-1) \\cos C + \\cos \\epsilon \\textrm{, and}   \\\\\na   &=   1 + BN + CP\n\\end{align*}\nfrom which it follows that\n\\[\n\\cos \\delta + \\cos \\epsilon = \\cos B + \\cos C - 1\n\\]\nAlso, by the Law of Sines, we have $\\frac{c-1}{\\sin\\delta} = \\frac{1}{\\sin B}$\nand similarly on triangle $CPQ$, and from this we deduce\n\\[ \\sin \\epsilon - \\sin \\delta = \\sin B - \\sin C. \\]\nThe sum-to-product formulas\n\\begin{align*}\n\\sin{\\epsilon} - \\sin{\\delta} &= 2 \\cos\\left( \\frac{\\epsilon + \\delta}{2} \\right) \\sin\\left( \\frac{\\epsilon - \\delta}{2} \\right) \\\\\n\\cos{\\epsilon} - \\cos{\\delta} &= 2 \\cos\\left( \\frac{\\epsilon + \\delta}{2} \\right) \\cos\\left( \\frac{\\epsilon - \\delta}{2} \\right)\n\\end{align*}\ngive us\n\\[\n\\tan \\left( \\frac{\\epsilon-\\delta}{2} \\right) = \\frac{\\sin{\\epsilon} - \\sin{\\delta}}{\\cos{\\epsilon} - \\cos{\\delta}}\n= \\frac{\\sin B - \\sin C}{\\cos B + \\cos C - 1}. \\]\nNow note that $\\ell$ makes an angle of\n$\\frac{1}{2}(\\pi+\\epsilon-\\delta)$ with line $BC$.\nMoreover, if line $OI$ intersects line $BC$ with angle $\\varphi$ then\n\\[ \\tan\\varphi = \\frac{r - R \\cos A}{\\frac{1}{2}(b-c)}. \\]\nSo in order to prove the result, we only need to check that\n\\[ \\frac{r - R \\cos A}{\\frac{1}{2}(b-c)}\n  = \\frac{\\cos B + \\cos C + 1}{\\sin B - \\sin C}. \\]\nUsing the fact that $b = 2R\\sin B$, $c = 2R\\sin C$, this  reduces to the fact that\n$r/R + 1 = \\cos A + \\cos B + \\cos C$, which is the so-called Carnot theorem.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2016}
{"id": "usamo-2016-q6", "question": "Integers $n$ and $k$ are given, with $n \\ge k \\ge 2$.\nYou play the following game against an evil wizard.\nThe wizard has $2n$ cards; for each $i=1,\\dots,n$, there are two cards labeled $i$.\nInitially, the wizard places all cards face down in a row, in unknown order.\nYou may repeatedly make moves of the following form: you point to any $k$ of the cards.\nThe wizard then turns those cards face up.\nIf any two of the cards match, the game is over and you win.\nOtherwise, you must look away, while the wizard arbitrarily permutes\nthe $k$ chosen cards and then turns them back face-down. Then, it is your turn again.\n\nWe say this game is \\emph{winnable} if there exist some positive integer $m$ and\nsome strategy that is guaranteed to win in at most $m$ moves,\nno matter how the wizard responds.\nFor which values of $n$ and $k$ is the game winnable?", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6220302}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nIntegers $n$ and $k$ are given, with $n \\ge k \\ge 2$.\nYou play the following game against an evil wizard.\nThe wizard has $2n$ cards; for each $i=1,\\dots,n$, there are two cards labeled $i$.\nInitially, the wizard places all cards face down in a row, in unknown order.\nYou may repeatedly make moves of the following form: you point to any $k$ of the cards.\nThe wizard then turns those cards face up.\nIf any two of the cards match, the game is over and you win.\nOtherwise, you must look away, while the wizard arbitrarily permutes\nthe $k$ chosen cards and then turns them back face-down. Then, it is your turn again.\n\nWe say this game is \\emph{winnable} if there exist some positive integer $m$ and\nsome strategy that is guaranteed to win in at most $m$ moves,\nno matter how the wizard responds.\nFor which values of $n$ and $k$ is the game winnable?\n\\end{mdframed}\nThe game is winnable if and only if $k < n$.\n\nFirst, suppose $2 \\le k < n$. Query the cards in positions $\\left\\{ 1, \\dots, k \\right\\}$,\nthen $\\left\\{ 2, \\dots, k+1 \\right\\}$, and so on, up to $\\left\\{ 2n-k+1, 2n \\right\\}$.\nIndeed, by taking the difference of the $i$th and $(i+1)$st query,\nwe can deduce the value of the $i$th card, for $1 \\le i \\le 2n-k$.\n(This is possible because the cards are flipped face up before they are re-shuffled,\nso even if two adjacent queries return the same set,\none can still determine the $i$th card.\nIt is possible to solve the problem even without the flipped information, though.)\nIf $k \\le n$, this is more than $n$ cards, so we can find a matching pair.\n\nFor $k = n$ we remark the following:\nat each turn after the first, assuming one has not won,\nthere are $n$ cards representing each of the $n$ values exactly once,\nsuch that the player has no information about the order of those $n$ cards.\nWe claim that consequently the player cannot guarantee victory.\nIndeed, let $S$ denote this set of $n$ cards, and $\\ol{S}$ the other $n$ cards.\nThe player will never win by picking only cards in $S$ or $\\ol{S}$.\nAlso, if the player selects some cards in $S$ and some cards in $\\ol{S}$,\nthen it is possible that the choice of cards in $S$ is exactly the complement\nof those selected from $\\ol{S}$; the strategy cannot prevent this since\nthe player has no information on $S$. This implies the result.\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "USAMO", "year": 2016}
{"id": "imo-2013-q1", "question": "Let  $k$ and $n$ be positive integers.\nProve that there exist positive integers $m_1$, \\dots, $m_k$\nsuch that\n\\[ 1 + \\frac{2^k-1}{n} = \\left( 1 + \\frac{1}{m_1} \\right) \\left( 1 + \\frac{1}{m_2} \\right)\n  \\dots \\left( 1 + \\frac{1}{m_k} \\right). \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p5720240}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet  $k$ and $n$ be positive integers.\nProve that there exist positive integers $m_1$, \\dots, $m_k$\nsuch that\n\\[ 1 + \\frac{2^k-1}{n} = \\left( 1 + \\frac{1}{m_1} \\right) \\left( 1 + \\frac{1}{m_2} \\right)\n  \\dots \\left( 1 + \\frac{1}{m_k} \\right). \\]\n\\end{mdframed}\nBy induction on $k \\ge 1$.\nWhen $k = 1$ there is nothing to prove.\n\nFor the inductive step, if $n$ is even, write\n\\[\n  \\frac{n + (2^k-1)}{n}\n  = \\left( 1 + \\frac{1}{n + (2^k-2)} \\right) \\cdot \\frac{\\frac n2 + (2^{k-1}-1)}{\\frac n2}\n\\]\nand use inductive hypothesis on the second term.\nOn the other hand if $n$ is odd then write\n\\[\n  \\frac{n + (2^k-1)}{n}\n  = \\left( 1 + \\frac{1}{n} \\right) \\cdot \\frac{\\frac{n+1}{2} + (2^{k-1}-1)}{\\frac{n+1}2}\n\\]\nand use inductive hypothesis on the second term.\n\\pagebreak", "category": "Number Theory", "source": "IMO", "year": 2013}
{"id": "imo-2013-q2", "question": "A configuration of $4027$ points in the plane is called\n\\emph{Colombian} if it consists of $2013$ red points and $2014$ blue points,\nand no three of the points of the configuration are collinear.\nBy drawing some lines, the plane is divided into several regions.\nAn arrangement of lines is \\emph{good} for a Colombian configuration\nif the following two conditions are satisfied:\n\\begin{enumerate}\n  \\ii[(i)] No line passes through any point of the configuration.\n  \\ii[(ii)] No region contains points of both colors.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p5720110}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA configuration of $4027$ points in the plane is called\n\\emph{Colombian} if it consists of $2013$ red points and $2014$ blue points,\nand no three of the points of the configuration are collinear.\nBy drawing some lines, the plane is divided into several regions.\nAn arrangement of lines is \\emph{good} for a Colombian configuration\nif the following two conditions are satisfied:\n\\begin{enumerate}\n  \\ii[(i)] No line passes through any point of the configuration.\n  \\ii[(ii)] No region contains points of both colors.\n\\end{enumerate}\nFind the least value of $k$ such that for any Colombian configuration\nof $4027$ points, there is a good arrangement of $k$ lines.\n\\end{mdframed}\nThe answer is $k \\ge 2013$.\n\nTo see that $k = 2013$ is necessary,\nconsider a regular $4026$-gon and alternatively color the\npoints red and blue,\nthen place the last blue point anywhere\nin general position (it doesn't matter).\nEach side of the $4026$ is a red-blue line segment\nwhich needs to be cut by one of the $k$ lines,\nand each line can cut at most two of the segments.\n\nNow, we prove that $k = 2013$ lines is sufficient.\nConsider the convex hull of all the points.\n\\begin{itemize}\n  \\ii If the convex hull has any red points,\n  cut that red point off from everyone else by a single line.\n  Then, for each of the remaining $2012$ red points,\n  break them into $1006$ pairs arbitrarily,\n  and for each pair $\\{A, B\\}$ draw two lines\n  parallel to $AB$ and close to them.\n\n  \\ii If the convex hull has two consecutive blue points,\n  cut those two blue points off from everyone else by a single line.\n  Then repeat the above construction\n  for the remaining $2012$ blue points.\n\\end{itemize}\nThe end.\n\\pagebreak", "category": "Combinatorics", "source": "IMO", "year": 2013}
{"id": "imo-2013-q3", "question": "Let the excircle of triangle $ABC$ opposite\nthe vertex $A$ be tangent to the side $BC$ at the point $A_1$.\nDefine the points $B_1$ on $CA$ and $C_1$ on $AB$ analogously,\nusing the excircles opposite $B$ and $C$, respectively.\nSuppose that the circumcenter of triangle $A_1B_1C_1$ lies\non the circumcircle of triangle $ABC$.\nProve that triangle $ABC$ is right-angled.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p5720184}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet the excircle of triangle $ABC$ opposite\nthe vertex $A$ be tangent to the side $BC$ at the point $A_1$.\nDefine the points $B_1$ on $CA$ and $C_1$ on $AB$ analogously,\nusing the excircles opposite $B$ and $C$, respectively.\nSuppose that the circumcenter of triangle $A_1B_1C_1$ lies\non the circumcircle of triangle $ABC$.\nProve that triangle $ABC$ is right-angled.\n\\end{mdframed}\nWe ignore for now the given condition\nand prove the following important lemma.\n\n\\begin{lemma*}\n  Let $(AB_1C_1)$ meet $(ABC)$ again at $X$.\n  From $BC_1 = B_1C$ follows $XC_1 = XB_1$,\n  and $X$ is the midpoint of major arc $\\widehat{BC}$.\n\\end{lemma*}\n\\begin{proof}\n  This follows from the fact that we have\n  a spiral similarity $\\triangle XBC_1 \\sim \\triangle XCB_1$\n  which must actually be a spiral congruence\n  since $BC_1 = B_1C$.\n\\end{proof}\n\nWe define the arc midpoints $Y$ and $Z$ similarly,\nwhich lie on the perpendicular bisectors of\n$\\ol{A_1 C_1}$, $\\ol{A_1 B_1}$.\n\n\\begin{center}\n\\begin{asy}\npair A = dir(110);\npair B = dir(180);\npair C = dir(0);\npair X = dir(90);\npair Y = dir(235);\npair Z = dir(325);\n\npair A_1 = foot(Y+Z-X, B, C);\npair B_1 = foot(Z+X-Y, C, A);\npair C_1 = foot(X+Y-Z, A, B);\n\nfilldraw(unitcircle, opacity(0.1)+gray, gray);\ndraw(C_1--X--B_1, red);\ndraw(A--B--C--cycle, gray);\nfilldraw(A_1--B_1--C_1--cycle, opacity(0.1)+cyan, heavycyan);\ndraw(Y--X--Z, orange);\ndraw(circumcircle(X, B_1, C_1), dashed+gray);\ndraw(X--A_1, red+dashed);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$X$\", X, dir(X));\ndot(\"$Y$\", Y, dir(Y));\ndot(\"$Z$\", Z, dir(Z));\ndot(\"$A_1$\", A_1, dir(270));\ndot(\"$B_1$\", B_1, dir(B_1));\ndot(\"$C_1$\", C_1, dir(C_1));\n\n/* TSQ Source:\n\nA = dir 110\nB = dir 180\nC = dir 0\nX = dir 90\nY = dir 235\nZ = dir 325\n\nA_1 = foot Y+Z-X B C R270\nB_1 = foot Z+X-Y C A\nC_1 = foot X+Y-Z A B\n\nunitcircle 0.1 gray / gray\nC_1--X--B_1 red\nA--B--C--cycle gray\nA_1--B_1--C_1--cycle 0.1 cyan / heavycyan\nY--X--Z orange\ncircumcircle X B_1 C_1 dashed gray\nX--A_1 red dashed\n\n*/\n\\end{asy}\n\\end{center}\n\nWe now turn to the problem condition\nwhich asserts the circumcenter $W$ of $\\triangle A_1B_1C_1$\nlies on $(ABC)$.\n\\begin{claim*}\n  We may assume WLOG that $W = X$.\n\\end{claim*}\n\\begin{proof}\n  This is just configuration analysis,\n  since we already knew that the arc midpoints\n  both lie on $(ABC)$ and the relevant perpendicular bisectors.\n\n  Point $W$ lies on $(ABC)$ and hence outside $\\triangle ABC$,\n  hence outside $\\triangle A_1 B_1 C_1$.\n  Thus we may assume WLOG that $\\angle B_1 A_1 C_1 > 90\\dg$.\n  Then $A$ and $X$ lie on the same side of line $\\ol{B_1 C_1}$,\n  and since $W$ is supposed to lie both on $(ABC)$\n  and the perpendicular bisector of $\\ol{B_1C_1}$ it follows $W = X$.\n\\end{proof}\n\nConsequently, $\\ol{XY}$ and $\\ol{XZ}$\nare exactly the perpendicular bisectors\nof $\\ol{A_1 C_1}$, $\\ol{A_1 B_1}$.\nThe rest is angle chase, the fastest one is\n\\begin{align*}\n  \\angle A &= \\angle C_1 X B_1\n  = \\angle C_1 X A_1 + \\angle A_1 X B_1\n  = 2 \\angle YXA_1 + 2 \\angle A_1 X Z \\\\\n  &= 2 \\angle YXZ =  180\\dg - \\angle A\n\\end{align*}\nwhich solves the problem.\n\n\\begin{remark*}\n  Angle chasing is also possible even without\n  the points $Y$ and $Z$, though it takes much longer.\n  Introduce the Bevan point $V$ and use the fact\n  that $VA_1B_1C$ is cyclic (with diameter $\\ol{VC}$)\n  and similarly $VA_1C_1B$ is cyclic;\n  a calculation then gives $\\angle CVB = 180\\dg - \\half \\angle A$.\n  Thus $V$ lies on the circle with diameter $\\ol{I_b I_c}$.\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Geometry", "source": "IMO", "year": 2013}
{"id": "imo-2013-q4", "question": "Let $ABC$ be an acute triangle with orthocenter $H$,\nand let $W$ be a point on the side $\\ol{BC}$, between $B$ and $C$.\nThe points $M$ and $N$ are the feet of the altitudes\ndrawn from $B$ and $C$, respectively.\nSuppose $\\omega_1$ is the circumcircle of triangle $BWN$\nand $X$ is a point such that $\\ol{WX}$ is a diameter of $\\omega_1$.\nSimilarly, $\\omega_2$ is the circumcircle of triangle $CWM$\nand $Y$ is a point such that $\\ol{WY}$ is a diameter of $\\omega_2$.\nShow that the points $X$, $Y$, and $H$ are collinear.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p5720174}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be an acute triangle with orthocenter $H$,\nand let $W$ be a point on the side $\\ol{BC}$, between $B$ and $C$.\nThe points $M$ and $N$ are the feet of the altitudes\ndrawn from $B$ and $C$, respectively.\nSuppose $\\omega_1$ is the circumcircle of triangle $BWN$\nand $X$ is a point such that $\\ol{WX}$ is a diameter of $\\omega_1$.\nSimilarly, $\\omega_2$ is the circumcircle of triangle $CWM$\nand $Y$ is a point such that $\\ol{WY}$ is a diameter of $\\omega_2$.\nShow that the points $X$, $Y$, and $H$ are collinear.\n\\end{mdframed}\nWe present two solutions, an elementary one\nand then an advanced one by moving points.\n\n\\paragraph{First solution, classical.}\nLet $P$ be the second intersection of $\\omega_1$ and $\\omega_2$;\nthis is the Miquel point, so $P$ also lies on the circumcircle of $AMN$,\nwhich is the circle with diameter $\\ol{AH}$.\n\n\\begin{center}\n\\begin{asy}\npair A = dir(110);\npair B = dir(210);\npair C = dir(330);\npair M = foot(B, A, C);\npair N = foot(C, A, B);\ndraw(B--M);\ndraw(C--N);\nfilldraw(A--B--C--cycle, opacity(0.1)+lightcyan, lightblue);\ndraw(B--M, lightblue);\ndraw(C--N, lightblue);\npair W = 0.55*C+0.45*B;\npair H = A+B+C;\npair P = foot(H, A, W);\npair X = extension(P, H, B, B+A-H);\npair Y = extension(P, H, C, C+A-H);\nfilldraw(circumcircle(B, N, W), opacity(0.1)+lightgreen, heavygreen);\nfilldraw(circumcircle(C, M, W), opacity(0.1)+lightgreen, heavygreen);\ndraw(X--W--Y, heavygreen);\ndraw(B--X, lightblue);\ndraw(C--Y, lightblue);\n\ndraw(X--Y, red+dotted);\ndraw(A--W, red+dotted);\ndraw(circumcircle(A, M, N), red+dashed);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$M$\", M, dir(M));\ndot(\"$N$\", N, dir(N));\ndot(\"$W$\", W, dir(W));\ndot(\"$H$\", H, dir(H));\ndot(\"$P$\", P, dir(P));\ndot(\"$X$\", X, dir(X));\ndot(\"$Y$\", Y, dir(Y));\n\n/* TSQ Source:\n\nA = dir 110\nB = dir 210\nC = dir 330\nM = foot B A C\nN = foot C A B\nB--M\nC--N\nA--B--C--cycle 0.1 lightcyan / lightblue\nB--M lightblue\nC--N lightblue\nW = 0.55*C+0.45*B\nH = A+B+C\nP = foot H A W\nX = extension P H B B+A-H\nY = extension P H C C+A-H\ncircumcircle B N W 0.1 lightgreen / heavygreen\ncircumcircle C M W 0.1 lightgreen / heavygreen\nX--W--Y heavygreen\nB--X lightblue\nC--Y lightblue\n\nX--Y red dotted\nA--W red dotted\ncircumcircle A M N red dashed\n\n*/\n\\end{asy}\n\\end{center}\n\nWe now contend:\n\\begin{claim*}\n  Points $P$, $H$, $X$ collinear.\n  (Similarly, points $P$, $H$, $Y$ are collinear.)\n\\end{claim*}\n\\begin{proof}\n  [Proof using power of a point]\n  By radical axis on $BNMC$, $\\omega_1$, $\\omega_2$,\n  it follows that $A$, $P$, $W$ are collinear.\n  We know that $\\angle APH = 90\\dg$, and also\n  $\\angle XPW = 90\\dg$ by construction.\n  Thus $P$, $H$, $X$ are collinear.\n\\end{proof}\n\\begin{proof}\n  [Proof using angle chasing]\n  This is essentially Reim's theorem:\n  \\[ \\dang NPH = \\dang NAH = \\dang BAH = \\dang ABX = \\dang NBX = \\dang NPX \\]\n  as desired.\n  Alternatively, one may prove $A$, $P$, $W$ are collinear by\n  $\\dang NPA = \\dang NMA = \\dang NMC = \\dang NBC = \\dang NBW = \\dang NPW$.\n\\end{proof}\n\n\\paragraph{Second solution, by moving points.}\nFix $\\triangle ABC$ and vary $W$.\nLet $\\infty$ be the point at infinity perpendicular to $\\ol{BC}$\nfor brevity.\n\nBy spiral similarity, the point $X$ moves linearly on $\\ol{B\\infty}$\nas $W$ varies linearly on $\\ol{BC}$.\nSimilarly, so does $Y$.\nSo in other words, the map \\[ X \\mapsto W \\mapsto Y \\]\nis linear.\nHowever, the map \\[ X \\mapsto Y' \\coloneq \\ol{XH} \\cap \\ol{C\\infty} \\]\nis linear too.\n\nTo show that these maps are the same,\nit suffices to check it thus at two points.\n\\begin{itemize}\n  \\ii When $W = B$, the circle $(BNW)$\n  degenerates to the circle through $B$ tangent to $\\ol{BC}$,\n  and $X = \\ol{CN} \\cap \\ol{B\\infty}$.\n  We have $Y = Y' = C$.\n  \\ii When $W = C$, the result is analogous.\n  \\ii Although we don't need to do so,\n  it's also easy to check the result if $W$\n  is the foot from $A$\n  since then $XHWB$ and $YHWC$ are rectangles.\n\\end{itemize}\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2013}
{"id": "imo-2013-q5", "question": "Suppose a function $f \\colon \\QQ_{>0} \\to \\RR$ satisfies:\n\\begin{enumerate}\n  \\ii [(i)] If $x,y \\in \\QQ_{>0}$, then $f(x)f(y) \\ge f(xy)$.\n  \\ii [(ii)] If $x,y \\in \\QQ_{>0}$, then $f(x+y) \\ge f(x) + f(y)$.\n  \\ii [(iii)] There exists a rational number $a > 1$ with $f(a) = a$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p5720286}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nSuppose a function $f \\colon \\QQ_{>0} \\to \\RR$ satisfies:\n\\begin{enumerate}\n  \\ii [(i)] If $x,y \\in \\QQ_{>0}$, then $f(x)f(y) \\ge f(xy)$.\n  \\ii [(ii)] If $x,y \\in \\QQ_{>0}$, then $f(x+y) \\ge f(x) + f(y)$.\n  \\ii [(iii)] There exists a rational number $a > 1$ with $f(a) = a$.\n\\end{enumerate}\nProve that $f(x) = x$ for all positive rational numbers $x$.\n\\end{mdframed}\nFirst, we dispense of negative situations by proving:\n\\begin{claim*}\n  For any integer $n > 0$, we have $f(n) \\ge n$.\n\\end{claim*}\n\\begin{proof}\n  Note by induction on (ii) we have $f(nx) \\ge n f(x)$.\n  Taking $(x,y) = (a,1)$ in (i) gives $f(1) \\ge 1$,\n  and hence $f(n) \\ge n$.\n\\end{proof}\n\n\\begin{claim*}\n  The $f$ takes only positive values,\n  and hence by (ii) is strictly increasing.\n\\end{claim*}\n\\begin{proof}[Proof, suggested by Gopal Goel]\n  Let $p,q > 0$ be integers.\n  Then $f(q) f(p/q) \\ge f(p)$, and since both $\\min(f(p), f(q)) > 0$\n  it follows $f(p/q) > 0$.\n\\end{proof}\n\n\\begin{claim*}\n  For any $x > 1$ we have $f(x) \\ge x$.\n\\end{claim*}\n\\begin{proof}\n  Note that\n  \\[ f(x)^N \\ge f(x^N) \\ge f\\left( \\left\\lfloor x^N \\right\\rfloor \\right)\n    \\ge \\left\\lfloor x^N \\right\\rfloor > x^N-1 \\]\n  for any integer $N$.\n  Since $N$ can be arbitrarily large, we conclude $f(x) \\ge x$ for $x > 1$.\n\\end{proof}\n\nOn the other hand, $f$ has arbitrarily large fixed points\n(namely powers of $a$) so from (ii) we're essentially done.\nFirst, for $x > 1$ pick a large $m$ and note\n\\[ a^m = f(a^m) \\ge f(a^m-x) + f(x) \\ge (a^m-x)+x = a^m. \\]\nFinally, for $x \\le 1$ use\n\\[ nf(x) = f(n)f(x) \\ge f(nx) \\ge nf(x) \\]\nfor large $n$.\n\n\\begin{remark*}\nNote that $a > 1$ is essential;\nif $b \\ge 1$ then $f(x) = bx^2$ works with unique fixed point $1/b \\le 1$.\n\\end{remark*}\n\\pagebreak", "category": "Algebra", "source": "IMO", "year": 2013}
{"id": "imo-2013-q6", "question": "Let $n \\ge 3$ be an integer, and consider a circle with $n + 1$ equally spaced points marked on it.\nConsider all labellings of these points with the numbers\n$0, 1, \\dots , n$ such that each label is used exactly once;\ntwo such labellings are considered to be the same if\none can be obtained from the other by a rotation of the circle.\nA labelling is called \\emph{beautiful} if, for any four labels $a < b < c < d$ with $a + d = b + c$,\nthe chord joining the points labelled $a$ and $d$\ndoes not intersect the chord joining the points labelled $b$ and $c$.\nLet $M$ be the number of beautiful labellings,\nand let $N$ be the number of ordered pairs $(x, y)$ of positive integers\nsuch that $x + y \\le n$ and $\\gcd(x, y) = 1$.\nProve that $M = N + 1$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p5720264}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n \\ge 3$ be an integer, and consider a circle with $n + 1$ equally spaced points marked on it.\nConsider all labellings of these points with the numbers\n$0, 1, \\dots , n$ such that each label is used exactly once;\ntwo such labellings are considered to be the same if\none can be obtained from the other by a rotation of the circle.\nA labelling is called \\emph{beautiful} if, for any four labels $a < b < c < d$ with $a + d = b + c$,\nthe chord joining the points labelled $a$ and $d$\ndoes not intersect the chord joining the points labelled $b$ and $c$.\nLet $M$ be the number of beautiful labellings,\nand let $N$ be the number of ordered pairs $(x, y)$ of positive integers\nsuch that $x + y \\le n$ and $\\gcd(x, y) = 1$.\nProve that $M = N + 1$.\n\\end{mdframed}\nFirst, here are half of the beautiful labellings up to reflection for $n = 6$,\njust for concreteness.\n\n\\begin{center}\n\\begin{asy}\nsize(9cm);\n\npair g(int n) { return dir(90 + 60*n); }\n\npicture ring(int a, int b, int c, int d, int e, real r) {\n  picture pic = new picture;\n  draw(pic, unitcircle);\n  draw(pic, dir(90)--dir(r), dotted+blue);\n  draw(pic, g(a)--g(e), dotted+blue);\n  draw(pic, g(b)--g(d), dotted+blue);\n  dot(pic, \"$0$\", dir(90), dir(90));\n  dot(pic, \"$1$\", g(a), g(a));\n  dot(pic, \"$2$\", g(b), g(b));\n  dot(pic, \"$3$\", g(c), g(c));\n  dot(pic, \"$4$\", g(d), g(d));\n  dot(pic, \"$5$\", g(e), g(e));\n  dot(pic, \"$6$\", dir(r), dir(r), red);\n  return pic;\n}\n\nadd(shift(3,6)*ring(2,4,5,1,3,0));\nadd(shift(0,6)*ring(3,1,4,2,5,240));\nadd(shift(3,3)*ring(4,2,5,3,1,0));\nadd(shift(0,3)*ring(2,3,4,5,1,240));\nadd(shift(3,0)*ring(1,2,3,4,5,50));\nadd(shift(0,0)*ring(1,2,3,4,5,130));\n\\end{asy}\n\\end{center}\n\nAbbreviate ``beautiful labelling of points around a circle'' to ring.\nMoreover, throughout the solution we will allow degenerate\nchords that join a point to itself;\nthis has no effect on the problem statement.\n\nThe idea is to proceed by induction in the following way.\nA ring of $[0,n]$ is called \\emph{linear}\nif it is an arithmetic progression modulo $n+1$.\nFor example, the first two rings in the diagram\nand the last one are linear for $n = 6$,\nwhile the other three are not.\n\nOf course we can move from any ring on $[0,n]$\nto a ring on $[0,n-1]$ by deleting $n$.\nWe are going to prove that:\n\\begin{itemize}\n  \\ii Each linear ring on $[0,n-1]$ yields exactly two\n  rings of $[0,n]$, and\n  \\ii Each nonlinear ring on $[0,n-1]$ yields exactly one\n  rings of $[0,n]$.\n\\end{itemize}\nIn light of the fact there are obviously $\\varphi(n)$ linear rings on $[0,n]$,\nthe conclusion will follow by induction.\n\nWe say a set of chords (possibly degenerate) is \\emph{pseudo-parallel}\nif for any three of them, one of them separates the two.\n(Pictorially, one can perturb the endpoints along the circle\nin order to make them parallel in Euclidean sense.)\nThe main structure lemma is going to be:\n\\begin{lemma*}\n  In any ring, the chords of sum $k$\n  (even including degenerate ones) are pseudo-parallel.\n\\end{lemma*}\n\\begin{proof}\n  By induction on $n$.\n  By shifting, we may assume that one of the chords is $\\{0,k\\}$\n  and discard all numbers exceeding $k$; that is, assume $n = k$.\n  Suppose the other two chords are $\\{a, n-a\\}$ and $\\{b, n-b\\}$.\n  \\begin{center}\n  \\begin{asy}\n    size(5cm);\n    draw(unitcircle);\n    pair O = dir(210);\n    pair N = dir(330);\n    draw(O--N);\n    pair A1 = dir(100);\n    pair A2 = dir(140);\n    pair B1 = dir( 80);\n    pair B2 = dir( 40);\n    draw(A1--A2);\n    draw(B1--B2);\n    pair U = dir(200);\n    pair V = dir(340);\n    draw(U--V, blue);\n    pair X = dir(250);\n    pair Y = dir(310);\n    draw(X--Y, red);\n    draw(O--X, blue+dashed);\n    dot(\"$a$\", A1, A1);\n    dot(\"$b$\", B1, B1);\n    dot(\"$n-a$\", A2, A2);\n    dot(\"$n-b$\", B2, B2);\n    dot(\"$u$\", U, U, blue);\n    dot(\"$v$\", V, V, blue);\n    dot(\"$u+v$\", X, X, red);\n    dot(\"$n-(u+v)$\", Y, Y, red);\n    dot(\"$0$\", O, O);\n    dot(\"$n$\", N, N);\n  \\end{asy}\n  \\end{center}\n  We consider the chord $\\{u,v\\}$ directly above $\\{0,n\\}$, drawn in blue.\n  There are now three cases.\n  \\begin{itemize}\n      \\ii If $u+v = n$, then delete $0$ and $n$\n      and decrease everything by $1$.\n      Then the chords $\\{a-1, n-a-1\\}$, $\\{b-1, n-b-1\\}$, $\\{u-1, v-1\\}$\n      contradict the induction hypothesis.\n\n      \\ii If $u+v < n$, then search for the chord\n      $\\{u+v, n-(u+v)\\}$.\n      It lies on the other side of $\\{0, n\\}$\n      in light of chord $\\{0,u+v\\}$.\n      Now again delete $0$ and $n$ and decrease everything by $1$.\n      Then the chords $\\{a-1, n-a-1\\}$, $\\{b-1, n-b-1\\}$, $\\{u+v-1, n-(u+v)-1\\}$\n      contradict the induction hypothesis.\n      %% MAX LU: this case can't occur at all;\n      %% nowhere to put $n-u$ without $0+n = u+(n-u)\n      %% and $v + (n-(u+v))$.\n\n      \\ii If $u+v > n$, apply the map $t \\mapsto n-t$ to the entire ring.\n      This gives the previous case as now $(n-u)+(n-v) < n$.\n      \\qedhere\n  \\end{itemize}\n\\end{proof}\n\nNext, we give another characterization of linear rings.\n\\begin{lemma*}\n  A ring on $[0,n-1]$ is linear if and only if the point $0$\n  does not lie between two chords of sum $n$.\n\\end{lemma*}\n\\begin{proof}\n  It's obviously true for linear rings.\n  Conversely, assume the property holds for some ring.\n  Note that the chords with sum $n-1$ are pseudo-parallel and encompass every point,\n  so they are \\emph{actually} parallel.\n  Similarly, the chords of sum $n$ are \\emph{actually} parallel\n  and encompass every point other than $0$.\n  So the map\n  \\[ t \\mapsto n-t \\mapsto (n-1)-(n-t) = t-1 \\pmod n \\]\n  is rotation as desired.\n\\end{proof}\n\n\\begin{lemma*}\n  Every nonlinear ring on $[0,n-1]$ induces exactly one ring on $[0,n]$.\n\\end{lemma*}\n\\begin{proof}\n  Because the chords of sum $n$ are pseudo-parallel,\n  there is at most one possibility for the location $n$.\n\n  Conversely, we claim that this works.\n  The chords of sum $n$ (and less than $n$) are OK by construction, so\n  assume for contradiction that there exists $a,b,c \\in \\{1,\\dots,n-1\\}$\n  such that $a + b = n + c$.\n  Then, we can ``reflect'' them using the (pseudo-parallel)\n  chords of length $n$ to find that $(n-a) + (n-b) = 0 + (n-c)$,\n  and the chords joining $0$ to $n-c$ and $n-a$ to $n-b$ intersect,\n  by definition.\n  \\begin{center}\n  \\begin{asy}\n    size(5cm);\n    draw(unitcircle);\n    draw(dir(140)--dir(220), blue+dotted);\n    draw(dir(250)--dir(110), blue+dotted);\n    draw(dir(340)--dir(20), blue+dotted);\n    draw(dir(60)--dir(300), blue+dotted);\n    draw(dir(220)--dir(60), lightred);\n    draw(dir(340)--dir(110), lightred);\n    draw(dir(140)--dir(300), orange+dashed);\n    draw(dir(250)--dir(20), orange+dashed);\n    dot(\"$0$\", dir(140), dir(140));\n    dot(\"$n$\", dir(220), dir(220), red);\n    dot(\"$n-a$\", dir(250), dir(250));\n    dot(\"$n-c$\", dir(300), dir(300));\n    dot(\"$b$\", dir(340), dir(340));\n    dot(\"$n-b$\", dir(20), dir(20));\n    dot(\"$c$\", dir(60), dir(60));\n    dot(\"$a$\", dir(110), dir(110));\n  \\end{asy}\n  \\end{center}\n  This is a contradiction that the original numbers on $[0,n-1]$ form a ring.\n\\end{proof}\n\n\\begin{lemma*}\n  Every linear ring on $[0,n-1]$ induces\n  exactly two rings on $[0,n]$.\n\\end{lemma*}\n\\begin{proof}\n  Because the chords of sum $n$ are pseudo-parallel,\n  the point $n$ must lie either directly to the left or right of $0$.\n  For the same reason as in the previous proof, both of them work.\n\\end{proof}\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "IMO", "year": 2013}
{"id": "tstst-2015-q1", "question": "Let $a_1$, $a_2$, \\dots, $a_n$ be a sequence of real numbers,\nand let $m$ be a fixed positive integer less than $n$.\nWe say an index $k$ with $1 \\le k \\le n$ is \\textit{good} if there exists\nsome $\\ell$ with $1 \\le \\ell \\le m$ such that\n\\[ a_k + a_{k + 1} + \\dotsb + a_{k + \\ell - 1} \\ge 0, \\]\nwhere the indices are taken modulo $n$.\nLet $T$ be the set of all good indices. Prove that\n\\[ \\sum_{k \\in T} a_k \\ge 0. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p5017901}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a_1$, $a_2$, \\dots, $a_n$ be a sequence of real numbers,\nand let $m$ be a fixed positive integer less than $n$.\nWe say an index $k$ with $1 \\le k \\le n$ is \\textit{good} if there exists\nsome $\\ell$ with $1 \\le \\ell \\le m$ such that\n\\[ a_k + a_{k + 1} + \\dotsb + a_{k + \\ell - 1} \\ge 0, \\]\nwhere the indices are taken modulo $n$.\nLet $T$ be the set of all good indices. Prove that\n\\[ \\sum_{k \\in T} a_k \\ge 0. \\]\n\\end{mdframed}\nFirst we prove the result if the indices are not taken modulo $n$.\nCall a number $\\ell$-good if $\\ell$ is the \\emph{smallest} number\nsuch that $a_k + a_{k+1} + \\dots + a_{k+\\ell-1} \\ge 0$, and $\\ell \\le m$.\nThen if $a_k$ is $\\ell$-good,\nthe numbers $a_{k+1}, \\dots, a_{k+\\ell-1}$ are good as well.\n\nThen by greedy from left to right,\nwe can group all the good numbers into blocks with nonnegative sums.\nRepeatedly take the first good number,\nif $\\ell$-good, group it with the next $\\ell$ numbers.\nAn example for $m = 3$:\n\\[ \\langle 4 \\rangle\n  \\quad \\langle -1 \\quad -2 \\quad 6 \\rangle\n  \\quad -9\n  \\quad -7\n  \\quad \\langle 3 \\rangle\n  \\quad \\langle -2 \\quad 4 \\rangle\n  \\quad \\langle -1. \\]\n\nWe can now return to the original problem.\nLet $N$ be a large integer; applying the algorithm to\n$N$ copies of the sequence, we deduce that\n\\[ N \\sum_{k \\in T} a_k + c_N \\ge 0 \\]\nwhere $c_N$ represents some ``error'' from left-over terms.\nAs $|c_N| \\le \\sum |a_i|$, by taking $N$ large enough we deduce the problem.\n\n\\begin{remark*}\n  This solution was motivated by looking at the case $m = 1$,\n  realizing how dumb it was, then looking at $m = 2$,\n  and realizing it was equally dumb.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "TSTST", "year": 2015}
{"id": "tstst-2015-q2", "question": "Let $ABC$ be a scalene triangle. Let $K_a$, $L_a$, and\n$M_a$ be the respective intersections with $BC$ of the internal\nangle bisector, external angle bisector, and the median from\n$A$. The circumcircle of $AK_aL_a$ intersects $AM_a$ a second time\nat a point $X_a$ different from $A$. Define $X_b$ and $X_c$\nanalogously. Prove that the circumcenter of $X_aX_bX_c$ lies on\nthe Euler line of $ABC$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p5017915}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a scalene triangle. Let $K_a$, $L_a$, and\n$M_a$ be the respective intersections with $BC$ of the internal\nangle bisector, external angle bisector, and the median from\n$A$. The circumcircle of $AK_aL_a$ intersects $AM_a$ a second time\nat a point $X_a$ different from $A$. Define $X_b$ and $X_c$\nanalogously. Prove that the circumcenter of $X_aX_bX_c$ lies on\nthe Euler line of $ABC$.\n\\end{mdframed}\nThe main content of the problem:\n\\begin{claim*}\n  $\\angle H X_a G = 90\\dg$.\n\\end{claim*}\nThis implies the result,\nsince then the desired circumcenter is the midpoint of $\\ol{GH}$.\n(This is the main difficulty; the Euler line is a red herring.)\n\nIn what follows, we abbreviate $K_a$ $L_a$, $M_a$, $X_a$\nto $K$, $L$, $M$, $X$.\n\n\\begin{proof}\n  [First proof by Brocard]\n  To do this, it suffices to show that $M$ has the\n  same power with respect to the circle\n  with diameter $\\ol{AH}$ and the circle with diameter $\\ol{K L}$.\n  In fact I claim both circles are orthogonal\n  to the circle with diameter $\\ol{BC}$!\n  The former follows from Brocard's theorem, noting that $A$\n  is on the polar of $H$,\n  and the latter follows from the harmonic bundle.\n\n  \\begin{center}\n  \\begin{asy}\n  size(11cm);\n  pair A = dir(150);\n  pair B = dir(200);\n  pair C = dir(340);\n  filldraw(A--B--C--cycle, opacity(0.1)+lightred, red);\n\n  pair M = midpoint(B--C);\n\n  pair H = orthocenter(A, B, C);\n  pair G = centroid(A, B, C);\n  pair X = foot(H, M, A);\n\n  pair K = extension(A, incenter(A, B, C), B, C);\n  pair L = extension(A, A+dir(90)*(K-A), B, C);\n\n  draw(K--A--L--B, red);\n  draw(circumcircle(A, K, L), orange+dashed);\n  draw(A--M, red);\n  draw(X--H, orange);\n\n  dot(\"$A$\", A, dir(A));\n  dot(\"$B$\", B, dir(270));\n  dot(\"$C$\", C, dir(270));\n  dot(\"$M$\", M, dir(M));\n  dot(\"$H$\", H, dir(270));\n  dot(\"$G$\", G, dir(10));\n  dot(\"$X$\", X, dir(10));\n  dot(\"$K$\", K, dir(K));\n  dot(\"$L$\", L, dir(L));\n\n  /* TSQ Source:\n\n  !size(11cm);\n  A = dir 150\n  B = dir 200 R270\n  C = dir 340 R270\n  A--B--C--cycle 0.1 lightred / red\n\n  M = midpoint B--C\n\n  H = orthocenter A B C R270\n  G = centroid A B C R10\n  X = foot H M A R10\n\n  K = extension A incenter A B C B C\n  L = extension A A+dir(90)*(K-A) B C\n\n  K--A--L--B red\n  circumcircle A K L orange dashed\n  A--M red\n  X--H orange\n\n  */\n  \\end{asy}\n  \\end{center}\n  Then $\\ol{AM}$ is the radical axis, so $X$ lies on both circles.\n\\end{proof}\n\n\\begin{proof}\n  [Second proof by orthocenter reflection, Bendit Chan]\n  As before, we know $MX \\cdot MA = MK \\cdot ML = MB \\cdot MC$,\n  but $X$ lies inside segment $AM$.\n  Construct parallelogram $ABA'C$.\n  Then $MX \\cdot MA' = MB \\cdot MC$,\n  so $XBA'C$ is concyclic.\n\n  However, it is well-known the circumcircle of $\\triangle BA'C$\n  (which is the reflection of $(ABC)$ across $\\ol{BC}$)\n  passes through $H$ and in fact has diameter $\\ol{A'H}$.\n  So this gives $\\angle HXA' = 90\\dg$ as needed.\n\\end{proof}\n\n\\begin{proof}\n  [Third proof by barycentric coordinates]\n  Alternatively we may just compute $X = (a^2:2S_A:2S_A)$.\n  Let $F = (0 : S_C : S_B)$ be the foot from $H$.\n  Then we check that $X H F M$ is cyclic,\n  which is power of a point from $A$.\n\\end{proof}\n\\pagebreak", "category": "Geometry", "source": "TSTST", "year": 2015}
{"id": "tstst-2015-q3", "question": "Let $P$ be the set of all primes, and let $M$ be a\nnon-empty subset of $P$. Suppose that for any non-empty subset\n$\\{p_1, p_2, \\dots, p_k\\}$ of $M$, all prime factors of\n$p_1 p_2 \\dots p_k + 1$ are also in $M$. Prove that $M = P$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p5017928}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $P$ be the set of all primes, and let $M$ be a\nnon-empty subset of $P$. Suppose that for any non-empty subset\n$\\{p_1, p_2, \\dots, p_k\\}$ of $M$, all prime factors of\n$p_1 p_2 \\dots p_k + 1$ are also in $M$. Prove that $M = P$.\n\\end{mdframed}\nThe following solution was found by user \\texttt{Aiscrim} on AOPS.\n\nObviously $|M| = \\infty$.\nAssume for contradiction $p \\notin M$.\nWe say a prime $q \\in M$ is \\emph{sparse}\nif there are only finitely many elements of $M$\nwhich are $q \\pmod p$\n(in particular there are finitely many sparse primes).\n\nNow let $C$ be the product of all sparse primes (note $p \\nmid C$).\nFirst, set $a_0 = 1$.\nFor $k \\ge 0$, consider then the prime factorization of the number\n\\[ Ca_k + 1. \\]\nNo prime in its factorization is sparse,\nso consider the number $a_{k+1}$ obtained by\n\\textbf{replacing each prime in its factorization\nwith some arbitrary representative of that prime's residue class}.\nIn this way we select a number $a_{k+1}$ such that\n\\begin{itemize}\n  \\ii $a_{k+1} \\equiv Ca_k + 1 \\pmod p$, and\n  \\ii $a_{k+1}$ is a product of distinct primes in $M$.\n\\end{itemize}\nIn particular, $a_k \\equiv C^k + C^{k-1} + \\dots + 1 \\pmod p$\n\nBut since $C \\not\\equiv 0 \\pmod p$,\nwe can find a $k$ such that $a_k \\equiv 0 \\pmod p$\n(namely, $k=p-1$ if $C \\equiv 1$ and $k=p-2$ else)\nwhich is clearly impossible since $a_k$ is a product of primes in $M$!\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Number Theory", "source": "TSTST", "year": 2015}
{"id": "tstst-2015-q4", "question": "Let $x,y,z$ be real numbers (not necessarily positive)\nsuch that $x^4 + y^4 + z^4 + xyz = 4$.\nProve that $x \\le 2$ and \\[ \\sqrt{2-x} \\ge \\frac{y+z}{2}. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p5017801}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $x,y,z$ be real numbers (not necessarily positive)\nsuch that $x^4 + y^4 + z^4 + xyz = 4$.\nProve that $x \\le 2$ and \\[ \\sqrt{2-x} \\ge \\frac{y+z}{2}. \\]\n\\end{mdframed}\nWe prove that the condition $x^4+y^4+z^4+xyz = 4$ implies\n\\[ \\sqrt{2-x} \\geq \\frac{y+z}{2}. \\]\n\nWe first prove the  easy part.\n\\begin{claim*}\n  We have $x \\le 2$.\n\\end{claim*}\n\\begin{proof}\n  Indeed, AM-GM gives that\n  \\begin{align*}\n    5 =x^4+y^4+(z^4+1)+xyz\n      &= \\frac{3x^4}{4}+\\left(\\frac{x^4}{4}+y^4\\right)+(z^4+1)+xyz \\\\\n      &\\geq \\frac{3x^4}{4}+x^2y^2+2z^2+xyz.\n  \\end{align*}\n  We evidently have that $x^2y^2+2z^2+xyz \\geq 0$ because the\n  quadratic form $a^2+ab+2b^2$ is positive definite, so $x^4 \\leq\n  \\frac{20}{3} \\implies x \\leq 2$.\n\\end{proof}\nNow, the desired statement is\nimplied by its square, so it suffices to show that\n\\[ 2-x \\geq \\left(\\frac{y+z}{2}\\right)^2 \\]\n\nWe are going to proceed by contradiction\n(it seems that many solutions do this)\nand assume that\n\\[ 2-x < \\left( \\frac{y+z}{2} \\right)^2\n  \\iff 4x + y^2 + 2yz + z^2 > 8. \\]\nBy AM-GM,\n\\begin{align*}\n  x^4 + 3 & \\ge 4x \\\\\n  \\tfrac{y^4+1}{2} &\\ge y^2 \\\\\n  \\tfrac{z^4+1}{2} &\\ge z^2\n\\end{align*}\nwhich yields that\n\\[ x^4+\\frac{y^4+z^4}{2}+2yz+4 > 8. \\]\nIf we replace $x^4 = 4 - (y^4+z^4+xyz)$ now,\nthis gives\n\\[ -\\frac{y^4+z^4}{2}+(2-x)yz > 0 \\implies (2-x)yz > \\frac{y^4+z^4}{2}. \\]\nSince $2-x$ and the right-hand side are positive,\nwe have $yz \\geq 0$.\nNow\n\\[ \\frac{y^4+z^4}{2yz} < 2-x < \\left(\\frac{y+z}{2}\\right)^2\n  \\implies 2y^4+2z^4 < yz(y+z)^2 = y^3z+2y^2z^2+yz^3. \\]\nThis is clearly false by AM-GM, so we have a contradiction.\n\\pagebreak", "category": "Algebra", "source": "TSTST", "year": 2015}
{"id": "tstst-2015-q5", "question": "Let $\\varphi(n)$ denote the number of positive integers\nless than $n$ that are relatively prime to $n$.\nProve that there exists a positive integer $m$ for which the equation\n$\\varphi(n) = m$ has at least $2015$ solutions in $n$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p5017821}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $\\varphi(n)$ denote the number of positive integers\nless than $n$ that are relatively prime to $n$.\nProve that there exists a positive integer $m$ for which the equation\n$\\varphi(n) = m$ has at least $2015$ solutions in $n$.\n\\end{mdframed}\nHere are two explicit solutions.\n\n\\paragraph{First solution with ad-hoc subsets, by Evan Chen.}\nI consider the following eleven prime numbers:\n\\[ S = \\left\\{ 11, 13, 17, 19, 29, 31, 37, 41, 43, 61, 71 \\right\\}. \\]\nThis has the property that for any $p \\in S$,\nall prime factors of $p-1$ are one digit.\n\nLet $N = (210)^{\\text{billion}}$,\nand consider $M = \\varphi\\left( N \\right)$.\nFor any subset $T \\subset S$, we have\n\\[ M = \\varphi\\left(\n  \\frac{N}{\\prod_{p\\in T} (p-1)} \\prod_{p \\in T} p \\right). \\]\nSince $2^{\\left\\lvert S \\right\\rvert} > 2015$ we're done.\n\\begin{remark*}\nThis solution is motivated by the deep fact that\n$\\varphi(11 \\cdot 1000) = \\varphi(10 \\cdot 1000)$,\nfor example.\n\\end{remark*}\n\n\\paragraph{Second solution with smallest primes, by Yang Liu.}\nLet $2 = p_1 < p_2 < \\dots < p_{2015}$\nbe the \\emph{smallest} $2015$ primes.\nThen the $2015$ numbers\n\\begin{align*}\n  n_1 &= (p_1-1) p_2 \\dots p_{2015} \\\\\n  n_2 &= p_1 (p_2-1) \\dots p_{2015} \\\\\n  &\\vdotswithin= \\\\\n  n_{2015} &= p_1 p_2 \\dots \\left( p_{2015}-1 \\right)\n\\end{align*}\nall have the same phi value, namely\n\\[ \\varphi(p_1 p_2 \\dots p_{2015}) = \\prod_{i=1}^{2015} (p_i-1). \\]\n\\pagebreak", "category": "Number Theory", "source": "TSTST", "year": 2015}
{"id": "tstst-2015-q6", "question": "A \\emph{Nim-style game} is defined as follows. Two\npositive integers $k$ and $n$ are specified, along with a finite\nset $S$ of $k$-tuples of integers (not necessarily positive). At\nthe start of the game, the $k$-tuple $(n,0,0,\\dots,0)$ is written\non the blackboard.\n\nA legal move consists of erasing the tuple $(a_1,a_2,\\dots,a_k)$\nwhich is written on the blackboard and replacing it with\n$(a_1+b_1,a_2+b_2,\\dots,a_k+b_k)$, where $(b_1,b_2,\\dots,b_k)$\nis an element of the set $S$. Two players take turns making legal\nmoves, and the first to write a negative integer loses. In the\nevent that neither player is ever forced to write a negative\ninteger, the game is a draw.\n\nProve that there is a choice of $k$ and $S$ with the following\nproperty: the first player has a winning strategy if $n$ is a\npower of $2$, and otherwise the second player has a winning\nstrategy.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p5017871}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA \\emph{Nim-style game} is defined as follows. Two\npositive integers $k$ and $n$ are specified, along with a finite\nset $S$ of $k$-tuples of integers (not necessarily positive). At\nthe start of the game, the $k$-tuple $(n,0,0,\\dots,0)$ is written\non the blackboard.\n\nA legal move consists of erasing the tuple $(a_1,a_2,\\dots,a_k)$\nwhich is written on the blackboard and replacing it with\n$(a_1+b_1,a_2+b_2,\\dots,a_k+b_k)$, where $(b_1,b_2,\\dots,b_k)$\nis an element of the set $S$. Two players take turns making legal\nmoves, and the first to write a negative integer loses. In the\nevent that neither player is ever forced to write a negative\ninteger, the game is a draw.\n\nProve that there is a choice of $k$ and $S$ with the following\nproperty: the first player has a winning strategy if $n$ is a\npower of $2$, and otherwise the second player has a winning\nstrategy.\n\\end{mdframed}\nHere we present a solution with $14$ registers and $22$ moves.\nInitially $X=n$ and all other variables are zero.\n\n\\begin{center}\n\\scriptsize\n\\setlength{\\tabcolsep}{3pt}\n\\begin{tabular}{l|rr|r|rrr|rrr|r|rr|rr}\n&$X$&$Y$&Go&$S_X^0$&$S_X$&$S_X'$&$S_Y^0$&$S_Y$&$S_Y'$&Cl&$A$&$B$&Die&Die'\\\\\\hline\nInit&-1&&1&&&&&&&&&1&1&1\\\\\nBegin&1&&-1&1&&&&&&&-1&1&&\\\\\\hline\nSleep&&&&&&&&&&&1&-1&&\\\\\\hline\nStartX&&&&-1&1&&&&&&-1&1&&\\\\\nWorkX&-1&&&&-1&1&&&&&-1&1&&\\\\\nWorkX'&-1&1&&&1&-1&&&&&-1&1&&\\\\\nDoneX&&&&&-1&&1&&&&-1&1&&\\\\\nWrongX&-1&&&&&&-1&&&&&-1&&\\\\\\hline\nStartY&&&&&&&-1&1&&&-1&1&&\\\\\nWorkY&&-1&&&&&&-1&1&&-1&1&&\\\\\nWorkY'&1&-1&&&&&&1&-1&&-1&1&&\\\\\nDoneY&&&&1&&&&-1&&&-1&1&&\\\\\nWrongY&&-1&&-1&&&&&&&&-1&&\\\\\\hline\nClaimX&-1&&&-1&&&&&&1&-1&1&&\\\\\nClaimY&&-1&&&&&-1&&&1&-1&1&&\\\\\nFakeX&-1&&&&&&&&&-1&&-1&&\\\\\nFakeY&&-1&&&&&&&&-1&&-1&&\\\\\nWin&&&&&&&&&&-1&-1&&&\\\\\\hline\nPunA&&&&&&&&&&&&-2&&\\\\\nPunB&&&&&&&&&&&-1&-1&&\\\\\nKill&&&&&&&&&&&&-1&-2&1\\\\\nKill'&&&&&&&&&&&&-1&1&-2\n\\end{tabular}\n\\end{center}\n\nNow, the ``game'' is played as follows.\nThe mechanics are controlled by the \\emph{turn counters} $A$ and $B$.\n\nObserve the game starts with Alice playing Init.\nThereafter, we say that the game is\n\\begin{itemize}\n  \\ii In the \\emph{main part} if $A+B = 1$,\n  and no one has played Init a second time.\n  \\ii In the \\emph{death part} otherwise.\n\\end{itemize}\nObserve that in the main state,\non Alice's turn we always have $(A,B) = (1,0)$\nand on Bob's turn we always have $(A,B) = (0,1)$.\n\n\\begin{claim*}\n  A player who plays Init a second time must lose.\n  In particular, a player who makes a move when $A=B=0$ must lose.\n\\end{claim*}\n\\begin{proof}\n  Situations with $A+B \\ge 2$ cannot occur during main part,\n  so there are only a few possibilities.\n  \\begin{itemize}\n  \\ii Suppose the offending player is in a situation where $A=B=0$.\n  Then he/she must play Init.\n  At this point, the opposing player can respond by playing Kill.\n  Then the offending player must play Init again.\n  The opposing player now responds with Kill'.\n  This iteration continues until $X$ reaches a negative number\n  and the offending player loses.\n  \\ii Suppose Alice has $(A,B) = (1,0)$ but plays Init again anyways.\n  Then Bob responds with PunB to punish her; he then wins as in the first case.\n  \\ii Suppose Bob has $(A,B) = (0,1)$ but plays Init again anyways.\n  Alice responds with PunA in the same way. \\qedhere\n  \\end{itemize}\n\\end{proof}\n\nThus we may assume that players avoid the death part at all costs.\nHence the second moves consist of Bob playing Sleep,\nand then Alice playing Begin\n(thus restoring the value of $n$ in $X$), then Bob playing Sleep.\n\nNow we return to analysis of the main part.\nWe say the game is in \\emph{state} $S$ for\n$S \\in \\{S_X^0, S_X, S_X', S_Y^0, S_Y, S_Y', \\text{Cl} \\}$\nif $S = 1$ and all other variables are zero.\nBy construction, this is always the case.\nFrom then on the main part is divided into several phases:\n\\begin{itemize}\n  \\ii An \\emph{$X$-phase}: this begins with Alice at $S_X^0$, and\n  ends when the game is in a state other than $S_X$ and $S_X'$.\n  (She can never return to $S_X^0$ during an $X$-phase.)\n  \\ii A \\emph{$Y$-phase}: this begins with Alice at $S_Y^0$, and\n  ends when the game is in a state other than $S_Y$ and $S_Y'$.\n  (She can never return to $S_Y^0$ during a $Y$-phase.)\n\\end{itemize}\n\n\\begin{claim*}\nConsider an $X$-phase in which $(X,Y) = (x,0)$, $x > 1$.\nThen Alice can complete the phase without losing if and only if $x$ is even;\nif so she begins a $Y$-phase with $(X,Y) = (0,x/2)$.\n\\end{claim*}\n\\begin{proof}\nAs $x >1$, Alice cannot play ClaimX since Bob will respond with FakeX and win.\nNow by alternating between WorkX and WorkX',\nAlice can repeatedly deduct $2$ from $X$ and add $1$ to $Y$,\nleading to $(x-2,y+1)$, $(x-4,y+2)$, and so on.\n(During this time, Bob can only play Sleep.)\nEventually, she must stop this process by playing DoneX, which begins a $Y$-phase.\n\nNow note that unless $X=0$, Bob now has a winning move WrongX.\nConversely he may only play Sleep if $X=0$.\n\\end{proof}\n\nWe have an analogous claim for $Y$-phases.\nThus if $n$ is not a power of $2$, we see that Alice eventually loses.\n\nNow suppose $n = 2^k$;\nthen Alice reaches $(X,Y) = (0,2^{k-1}), \\; (2^{k-2}, 0), \\; \\dots$\nuntil either reaching $(1,0)$ or $(0,1)$.\nAt this point she can play ClaimX or ClaimY, respectively;\nthe game is now in state Cl.\nBob cannot play either FakeX or FakeY, so he must play Sleep,\nand then Alice wins by playing Win.\nThus Alice has a winning strategy when $n = 2^k$.\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "TSTST", "year": 2015}
{"id": "usamo-1998-q1", "question": "Suppose that the set $\\{1,2,\\dots, 1998\\}$\nhas been partitioned into disjoint pairs $\\{a_i,b_i\\}$ ($1\\leq i\\leq 999$)\nso that for all $i$, $|a_i-b_i|$ equals $1$ or $6$.\nProve that the sum\n\\[ |a_1-b_1|+|a_2-b_2|+\\dotsb +|a_{999}-b_{999}|  \\]\nends in the digit $9$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p343865}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nSuppose that the set $\\{1,2,\\dots, 1998\\}$\nhas been partitioned into disjoint pairs $\\{a_i,b_i\\}$ ($1\\leq i\\leq 999$)\nso that for all $i$, $|a_i-b_i|$ equals $1$ or $6$.\nProve that the sum\n\\[ |a_1-b_1|+|a_2-b_2|+\\dotsb +|a_{999}-b_{999}|  \\]\nends in the digit $9$.\n\\end{mdframed}\nLet $S$ be the sum.\nModulo $2$,\n\\[ S = \\sum |a_i-b_i| \\equiv \\sum (a_i+b_i)\n  = 1 + 2 + \\dots + 1998 \\equiv 1 \\pmod 2. \\]\nModulo $5$,\n\\[ S = \\sum |a_i-b_i| = 1 \\cdot 999 \\equiv 4 \\pmod 5. \\]\nSo $S \\equiv 9 \\pmod{10}$.\n\\pagebreak", "category": "Combinatorics", "source": "USAMO", "year": 1998}
{"id": "usamo-1998-q2", "question": "Let $\\mathcal C_1$ and $\\mathcal C_2$ be concentric circles, with\n$\\mathcal C_2$ in the interior of $\\mathcal C_1$.\nFrom a point $A$ on $\\mathcal C_1$ one draws the tangent $AB$\nto $\\mathcal C_2$ ($B\\in \\mathcal C_2$).\nLet $C$ be the second point of intersection of ray $AB$ and\n$\\mathcal C_1$, and let $D$ be the midpoint of $\\ol{AB}$.\nA line passing through $A$ intersects $\\mathcal C_2$ at $E$ and $F$\nin such a way that the perpendicular bisectors of $\\ol{DE}$ and $\\ol{CF}$\nintersect at a point $M$ on line $AB$.\nFind, with proof, the ratio $AM/MC$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p343866}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $\\mathcal C_1$ and $\\mathcal C_2$ be concentric circles, with\n$\\mathcal C_2$ in the interior of $\\mathcal C_1$.\nFrom a point $A$ on $\\mathcal C_1$ one draws the tangent $AB$\nto $\\mathcal C_2$ ($B\\in \\mathcal C_2$).\nLet $C$ be the second point of intersection of ray $AB$ and\n$\\mathcal C_1$, and let $D$ be the midpoint of $\\ol{AB}$.\nA line passing through $A$ intersects $\\mathcal C_2$ at $E$ and $F$\nin such a way that the perpendicular bisectors of $\\ol{DE}$ and $\\ol{CF}$\nintersect at a point $M$ on line $AB$.\nFind, with proof, the ratio $AM/MC$.\n\\end{mdframed}\nBy power of a point we have\n\\[ AE \\cdot AF = AB^2\n  = \\left( \\half AB \\right) \\cdot \\left( 2AB \\right)\n  = AD \\cdot AC \\]\nand hence $CDEF$ is cyclic.\nThen $M$ is the circumcenter of quadrilateral $CDEF$.\n\n\\begin{center}\n\\begin{asy}\npair A = dir(170);\npair C = dir(40);\npair B = midpoint(A--C);\npair D = midpoint(A--B);\npair M = midpoint(C--D);\npair O = origin;\n\nfilldraw(unitcircle, opacity(0.1)+lightcyan, heavycyan);\ndraw(CP(O, B), heavycyan);\npair E = IP(CP(M, D), CP(O, B));\npair F = OP(CP(M, D), CP(O, B));\nfilldraw(CP(M, D), opacity(0.1)+lightred, red);\ndraw(A--C, heavygreen);\ndraw(A--F, heavygreen);\ndraw(D--E, red);\ndraw(C--F, red);\npair U = midpoint(D--E);\npair V = midpoint(C--F);\ndraw(U--M--V, red+dotted);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$C$\", C, dir(C));\ndot(\"$B$\", B, dir(B));\ndot(\"$D$\", D, dir(D));\ndot(\"$M$\", M, dir(M));\ndot(\"$O$\", O, dir(45));\ndot(\"$E$\", E, dir(220));\ndot(\"$F$\", F, dir(F));\n\n/* TSQ Source:\n\nA = dir 170\nC = dir 40\nB = midpoint A--C\nD = midpoint A--B\nM = midpoint C--D\nO = origin R45\n\nunitcircle 0.1 lightcyan / heavycyan\nCP O B heavycyan\nE = IP CP M D CP O B R220\nF = OP CP M D CP O B\nCP M D 0.1 lightred / red\nA--C heavygreen\nA--F heavygreen\nD--E red\nC--F red\nU := midpoint D--E\nV := midpoint C--F\nU--M--V red dotted\n\n*/\n\\end{asy}\n\\end{center}\n\nThus $M$ is the midpoint of $\\ol{CD}$\n(and we are given already that $B$ is the midpoint of $\\ol{AC}$,\n$D$ is the midpoint of $\\ol{AB}$).\nThus a quick computation along $\\ol{AC}$ gives $AM/MC = 5/3$.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 1998}
{"id": "usamo-1998-q3", "question": "Let $a_0,a_1,\\dots ,a_n$ be numbers from the interval $(0,\\pi/2)$\nsuch that $\\tan (a_0-\\frac{\\pi}{4})+ \\tan (a_1-\\frac{\\pi}{4})\n + \\dotsb +\\tan (a_n-\\frac{\\pi}{4}) \\ge  n-1$.\nProve that\n\\[ \\tan a_0\\tan a_1 \\dotsm \\tan a_n \\ge n^{n+1}. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p343867}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a_0,a_1,\\dots ,a_n$ be numbers from the interval $(0,\\pi/2)$\nsuch that $\\tan (a_0-\\frac{\\pi}{4})+ \\tan (a_1-\\frac{\\pi}{4})\n + \\dotsb +\\tan (a_n-\\frac{\\pi}{4}) \\ge  n-1$.\nProve that\n\\[ \\tan a_0\\tan a_1 \\dotsm \\tan a_n \\ge n^{n+1}. \\]\n\\end{mdframed}\nLet $x_i = \\tan(a_i - \\frac{\\pi}{4})$.\nThen we have that\n\\[ \\tan a_i = \\tan(a_i - 45\\dg + 45\\dg) = \\frac{x_i + 1}{1 - x_i}. \\]\nIf we further substitute $y_i = \\frac{1 - x_i}{2} \\in (0,1)$,\nthen we have to prove that the following statement:\n\\begin{claim*}\n  If $\\sum_0^n y_i \\le 1$ and $y_i \\ge 0$, we have\n  \\[ \\prod_{i=1}^n \\left( \\frac{1}{y_i}-1 \\right) \\ge n^{n+1}. \\]\n\\end{claim*}\n\\begin{proof}\n  Homogenizing, we have to prove that\n  \\[ \\prod_{i=1}^n \\left( \\frac{y_0+y_1+y_2+\\dots+y_n}{y_i}-1 \\right) \\ge n^{n+1}. \\]\n  By AM-GM, we have\n  \\[ \\frac{y_1+y_2+y_3+\\dots+y_n}{y_0}\n    \\ge n \\sqrt[n]{\\frac{y_1y_2y_3\\dots y_n}{y_1}}. \\]\n    Cyclic product works.\n\\end{proof}\n\\begin{remark*}\n  Alternatively, the function $x \\mapsto \\log(1/x-1)$\n  is a convex function on $(0,1)$ so Jensen inequality should also work.\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Geometry", "source": "USAMO", "year": 1998}
{"id": "usamo-1998-q4", "question": "A computer screen shows a $98 \\times 98$ chessboard, colored in the usual way.\nOne can select with a mouse any rectangle with sides on the lines\nof the chessboard and click the mouse button:\nas a result, the colors in the selected rectangle switch\n(black becomes white, white becomes black).\nFind, with proof, the minimum number of mouse clicks\nneeded to make the chessboard all one color.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p343869}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA computer screen shows a $98 \\times 98$ chessboard, colored in the usual way.\nOne can select with a mouse any rectangle with sides on the lines\nof the chessboard and click the mouse button:\nas a result, the colors in the selected rectangle switch\n(black becomes white, white becomes black).\nFind, with proof, the minimum number of mouse clicks\nneeded to make the chessboard all one color.\n\\end{mdframed}\nThe answer is $98$.\nOne of several possible constructions is to toggle\nall columns and rows with even indices.\n\nIn the other direction, let $n = 98$ and\nsuppose that $k$ rectangles are used,\nnone of which are $n \\times n$ (else we may delete it).\nThen, for any two orthogonally adjacent cells,\nthe edge between them must be contained in the edge of\none of the $k$ rectangles.\n\nWe define a \\emph{gridline} to be a line segment\nthat runs in the interior of the board from\none side of the board to the other.\nHence there are $2n-2$ gridlines exactly.\nMoreover, we can classify these rectangles into two types:\n\\begin{itemize}\n  \\ii \\emph{Full length rectangles}:\n  these span from one edge of the board to the other.\n  The two long sides completely cover two gridlines,\n  but the other two sides of the rectangle do not.\n  \\ii \\emph{Partial length rectangles}:\n  each of four sides can partially cover ``half a'' gridline.\n\\end{itemize}\nSee illustration below for $n = 6$.\n\\begin{center}\n\\begin{asy}\n  unitsize(0.5cm);\n  picture base;\n  for (int i=1; i<=5; ++i) {\n    draw(base, (0,i)--(6,i), black );\n    draw(base, (i,0)--(i,6), black );\n  }\n\n  picture full;\n  picture partial;\n\n  add(full, base);\n  add(partial, base);\n  label(full, \"Full length\", (3,0), dir(-90), red);\n  label(partial, \"Partial length\", (3,0), dir(-90), blue);\n\n  filldraw(full, box( (0,3), (6,1) ), lightred+opacity(0.3), red+1.4 );\n  filldraw(partial, box( (2,2), (4,5) ), lightcyan+opacity(0.3), blue+1.4 );\n  add(shift(0,0)*base);\n  add(shift(7,0)*full);\n  add(shift(14,0)*partial);\n\\end{asy}\n\\end{center}\nSince there are $2n-2$ gridlines;\nand each rectangle can cover at most two gridlines in total\n(where partial-length rectangles are ``worth $\\half$''\non each of the four sides),\nwe immediately get the bound $2k \\ge 2n-2$, or $k \\ge n-1$.\n\nTo finish, we prove that:\n\\begin{claim*}\n  If equality holds and $k = n-1$, then $n$ is odd.\n\\end{claim*}\n\\begin{proof}\n  If equality holds, then look at the horizontal gridlines\n  and say two gridlines are \\emph{related} if some rectangle\n  has horizontal edges along both gridlines.\n  (Hence, the graph has degree either $1$ or $2$ at each vertex,\n  for equality to hold.)\n  The reader may verify the resulting graph consists only of\n  even length cycles and single edges,\n  which would mean $n-1$ is even.\n\\end{proof}\nHence for $n = 98$ the answer is indeed $98$ as claimed.\n\\pagebreak", "category": "Combinatorics", "source": "USAMO", "year": 1998}
{"id": "usamo-1998-q5", "question": "Prove that for each $n\\geq 2$,\nthere is a set $S$ of $n$ integers\nsuch that $(a-b)^2$ divides $ab$ for every distinct $a,b\\in S$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p343870}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nProve that for each $n\\geq 2$,\nthere is a set $S$ of $n$ integers\nsuch that $(a-b)^2$ divides $ab$ for every distinct $a,b\\in S$.\n\\end{mdframed}\nThis is a direct corollary of the more difficult\nUSA TST 2015/2, reproduced below.\n\\begin{quote}\n  Prove that for every positive integer $n$,\n  there exists a set $S$ of $n$ positive integers\n  such that for any two distinct $a,b \\in S$,\n  $a-b$ divides $a$ and $b$\n  but none of the other elements of $S$.\n\\end{quote}\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 1998}
{"id": "usamo-1998-q6", "question": "Let $n \\geq 5$ be an integer.\nFind the largest integer $k$ (as a function of $n$)\nsuch that there exists a convex $n$-gon $A_{1}A_{2}\\dots A_{n}$\nfor which exactly $k$ of the quadrilaterals\n$A_{i}A_{i+1}A_{i+2}A_{i+3}$ have an inscribed circle,\nwhere indices are taken modulo $n$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p150148}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n \\geq 5$ be an integer.\nFind the largest integer $k$ (as a function of $n$)\nsuch that there exists a convex $n$-gon $A_{1}A_{2}\\dots A_{n}$\nfor which exactly $k$ of the quadrilaterals\n$A_{i}A_{i+1}A_{i+2}A_{i+3}$ have an inscribed circle,\nwhere indices are taken modulo $n$.\n\\end{mdframed}\nThe main claim is the following:\n\\begin{claim*}\n  We can't have both $A_1 A_2 A_3 A_4$\n  and $A_2 A_3 A_4 A_5$ be circumscribed.\n\\end{claim*}\n\\begin{proof}\n  If not, then we have the following diagram,\n  where $a = A_1A_2$, $b = A-2 A_3$, $c = A_3 A_4$, $d = A_4 A_5$.\n  \\begin{center}\n  \\begin{asy}\n    size(9cm);\n    pair A1 = dir(10);\n    pair A2 = dir(40);\n    pair A3 = dir(90);\n    pair A4 = dir(130);\n    pair A5 = dir(200);\n    draw(A1--A2--A3--A4--A5, blue);\n    label(\"$a$\", midpoint(A1--A2), dir(A1+A2), blue);\n    label(\"$b$\", midpoint(A2--A3), dir(A2+A3), blue);\n    label(\"$c$\", midpoint(A3--A4), dir(A3+A4), blue);\n    label(\"$d$\", midpoint(A4--A5), dir(A4+A5), blue);\n    draw(A1--A4, red);\n    label(rotate(-20)*\"$c+a-b$\", 0.6*A4+0.4*A1, dir(A1+A4), red);\n    draw(A2--A5, orange);\n    label(rotate(30)*\"$b+d-c$\", 0.5*A5+0.5*A2, dir(A2+A5), orange);\n    dot(\"$A_1$\", A1, dir(A1), blue);\n    dot(\"$A_2$\", A2, dir(A2), blue);\n    dot(\"$A_3$\", A3, dir(A3), blue);\n    dot(\"$A_4$\", A4, dir(A4), blue);\n    dot(\"$A_5$\", A5, dir(A5), blue);\n  \\end{asy}\n  \\end{center}\n  Then $A_1 A_4 = c+a-b$ and $A_5A_2 = b+d-c$.\n  But now\n  \\[ A_1 A_4 + A_2 A_5 = (c+a-b) + (b+d-c) = a+d = A_1 A_2 + A_4 A_5 \\]\n  but in the picture we have an obvious violation\n  of the triangle inequality.\n\\end{proof}\n\nThis immediately gives an upper bound of\n$\\left\\lfloor n/2 \\right\\rfloor$.\n\nFor the construction, one can construct a suitable cyclic $n$-gon by\nusing a continuity argument (details to be added).\n\\pagebreak\n\n\n\\end{document}", "category": "Geometry", "source": "USAMO", "year": 1998}
{"id": "usamo-2018-q1", "question": "Let $a$, $b$, $c$ be positive real numbers such that $a+b+c = 4\\sqrt[3]{abc}$.\nProve that\n\\[ 2(ab+bc+ca) + 4 \\min (a^2, b^2, c^2) \\ge a^2 + b^2 + c^2. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10226140}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a$, $b$, $c$ be positive real numbers such that $a+b+c = 4\\sqrt[3]{abc}$.\nProve that\n\\[ 2(ab+bc+ca) + 4 \\min (a^2, b^2, c^2) \\ge a^2 + b^2 + c^2. \\]\n\\end{mdframed}\nWLOG let $c = \\min(a,b,c) = 1$ by scaling.\nThe given inequality becomes equivalent to\n\\[ 4ab + 2a + 2b + 3 \\ge (a+b)^2 \\qquad \\forall a+b = 4(ab)^{1/3}-1. \\]\nNow, let $t = (ab)^{1/3}$ and eliminate $a+b$ using the condition, to get\n\\[ 4t^3 + 2(4t-1) + 3 \\ge (4t-1)^2\n  \\iff 0 \\le 4t^3 - 16t^2 + 16t = 4t(t-2)^2 \\]\nwhich solves the problem.\n\nEquality occurs only if $t=2$,\nmeaning $ab = 8$ and $a+b=7$, which gives\n\\[ \\{a,b\\} = \\left\\{ \\frac{7 \\pm \\sqrt{17}}{2} \\right\\} \\]\nwith the assumption $c = 1$.\nScaling gives the curve of equality cases.\n\\pagebreak", "category": "Algebra", "source": "USAMO", "year": 2018}
{"id": "usamo-2018-q2", "question": "Find all functions $f \\colon (0,\\infty) \\to (0,\\infty)$ such that\n\\[\n  f\\left( x+\\frac 1y \\right)\n  + f\\left( y+\\frac 1z \\right)\n  + f\\left( z+\\frac 1x \\right)\n  = 1\n\\]\nfor all $x,y,z > 0$ with $xyz = 1$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10226145}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all functions $f \\colon (0,\\infty) \\to (0,\\infty)$ such that\n\\[\n  f\\left( x+\\frac 1y \\right)\n  + f\\left( y+\\frac 1z \\right)\n  + f\\left( z+\\frac 1x \\right)\n  = 1\n\\]\nfor all $x,y,z > 0$ with $xyz = 1$.\n\\end{mdframed}\nThe main part of the problem is to show all solutions are linear.\nAs always, let $x=b/c$, $y=c/a$, $z=a/b$\n(classical inequality trick).\nThen the problem becomes\n\\[ \\sum_{\\text{cyc}} f\\left( \\frac{b+c}{a} \\right) = 1. \\]\nLet $f(t) = g(\\frac{1}{t+1})$,\nequivalently $g(s) = f(1/s-1)$.\nThus $g \\colon (0,1) \\to (0,1)$\nwhich satisfies $\\sum_{\\text{cyc}} g\\left( \\frac{a}{a+b+c} \\right) = 1$,\nor equivalently\n\\[ \\boxed{g(a) + g(b) + g(c) = 1} \\qquad \\forall a+b+c=1. \\]\n\nThe rest of the solution is dedicated to solving this\nequivalent functional equation in $g$.\nIt is a lot of technical details and I will only outline them\n(with apologies to the contestants who didn't have that luxury).\n\n\\begin{claim*}\n  The function $g$ is linear.\n\\end{claim*}\n\\begin{proof}\n  This takes several steps, all of which are technical.\n  We begin by proving $g$ is linear over $[1/8, 3/8]$.\n  \\begin{itemize}\n    \\ii First, whenever $a+b \\le 1$ we have\n    \\[ 1 - g(1-(a+b)) = g(a) + g(b) = 2 g\\left( \\frac{a+b}{2} \\right). \\]\n    Hence $g$ obeys Jensen's functional equation over $(0,1/2)$.\n    \\ii Define $h \\colon [0,1] \\to \\RR$\n    by $h(t) = g(\\frac{2t+1}{8}) - (1-t) \\cdot g(1/8) - t \\cdot g(3/8)$,\n    then $h$ satisfies Jensen's functional equation too over $[0,1]$.\n    We have also arranged that $h(0) = h(1) = 0$, hence $h(1/2) = 0$ as well.\n    \\ii Since\n    \\[ h(t) = h(t) + h(1/2) = 2h(t/2+1/4)\n      = h(t+1/2) + h(0) = h(t+1/2) \\]\n    for any $t < 1/2$, we find $h$ is periodic modulo $1/2$.\n    It follows one can extend $\\wt h$ by\n    \\[ \\wt h \\colon \\RR \\to \\RR \\qquad\\text{by}\\qquad\n      \\wt h(t) = h(t - \\left\\lfloor t \\right\\rfloor) \\]\n    and still satisfy Jensen's functional equation.\n    Because $\\wt h(0) = 0$, it's well-known this implies $\\wt h$ is additive\n    (because $\\wt h(x+y) = 2\\wt h\\left( (x+y)/2 \\right) = \\wt h(x) + \\wt h(y)$\n    for any real numbers $x$ to $y$).\n  \\end{itemize}\n  But $\\wt h$ is bounded below on $[0,1]$ since $g \\ge 0$,\n  and since $\\wt h$ is also additive,\n  it follows (well-known) that $\\wt h$ is linear.\n  Thus $h$ is the zero function.\n  So, the function $g$ is linear over $[1/8,3/8]$;\n  thus we may write $g(x) = kx + \\ell$, valid for $1/8 \\le x \\le 3/8$.\n\n  Since $3g(1/3) = 1$, it follows $k + 3\\ell = 1$.\n\n  For $0 < x < 1/8$ we have\n  $g(x) = 2g(0.15) - g(0.3-x) = 2(0.15k+\\ell) - (k(0.3-x)+\\ell) = kx+\\ell$,\n  so $g$ is linear over $(0,3/8)$ as well.\n  Finally, for $3/8 < x < 1$, we use the given equation\n  \\[\n    1 = g\\left( \\frac{1-x}{2} \\right)\n    + g\\left( \\frac{1-x}{2} \\right)\n    + g(x)\n    \\implies g(x) = 1 - 2\\left( k \\cdot \\frac{1-x}{2} + \\ell \\right)\n    = kx+\\ell\n  \\]\n  since $\\frac{1-x}{2} < \\frac{5}{16} < \\frac{3}{8}$.\n  Thus $g$ is linear over all.\n\\end{proof}\n\nPutting this back in,\nwe deduce that $g(x) = kx + \\frac{1-k}{3}$ for some $k \\in [-1/2,1]$,\nand so \\[ f(x) = \\frac{k}{x+1} + \\frac{1-k}{3} \\]\nfor some $k \\in [-1/2,1]$.\nAll such functions work.\n\\pagebreak", "category": "Algebra", "source": "USAMO", "year": 2018}
{"id": "usamo-2018-q3", "question": "Let $n \\ge 2$ be an integer, and let $\\{a_1, \\dots, a_m\\}$ denote\nthe $m = \\varphi(n)$ integers less than $n$ and relatively prime to $n$.\nAssume that every prime divisor of $m$ also divides $n$.\nProve that $m$ divides $a_1^k + \\dots + a_m^k$ for every positive\ninteger $k$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10226222}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n \\ge 2$ be an integer, and let $\\{a_1, \\dots, a_m\\}$ denote\nthe $m = \\varphi(n)$ integers less than $n$ and relatively prime to $n$.\nAssume that every prime divisor of $m$ also divides $n$.\nProve that $m$ divides $a_1^k + \\dots + a_m^k$ for every positive\ninteger $k$.\n\\end{mdframed}\nFor brevity, given any $n$, we let $A(n) = \\left\\{ 1 \\le x \\le n, \\gcd(x,n) = 1 \\right\\}$\n(thus $|A(n)| = \\varphi(n)$).\nAlso, let $S(n,k) = \\sum_{a \\in A(n)} a^k$.\n\nWe will prove the stronger statement (which eliminates the hypothesis on $n$).\n\\begin{claim*}\n  Let $n \\ge 2$ be arbitrary (and $k \\ge 0$).\n  If $p \\mid n$, then \\[ \\nu_p (\\varphi(n)) \\le \\nu_p(S(n,k)). \\]\n\\end{claim*}\n\nWe start with the special case where $n$ is a prime power.\n\\begin{lemma*}\n  Let $p$ be prime, $e \\ge 1$, $k \\ge 0$.\n  We always have\n  \\[ S(p^e, k) = \\sum_{x \\in A(p^e)} x^k \\equiv 0 \\pmod{p^{e-1}}.  \\]\n\\end{lemma*}\n\\begin{proof}\n  For $p$ odd, this follows by taking a primitive root $g$ modulo $p^{e}$.\n  We will have\n  \\[ S(p^e, k) \\equiv 1 + g^k + g^{2k} + \\dots + g^{(\\varphi(p^e)-1)k}\n    \\equiv \\frac{g^{\\varphi(p^e) k} - 1}{g^k - 1}. \\]\n  If $p-1 \\nmid k$, then the denominator is not divisible by $p$\n  and hence the entire expression is $0 \\pmod{p^e}$.\n  In the other case where $p-1 \\mid k$, since $\\nu_p(\\varphi(p^e)) = e-1$,\n  the exponent lifting lemma implies\n  \\[ \\nu_p\\left( (g^k)^{\\varphi(p^e)} - 1 \\right) = \\nu_p(g^k-1) + (e-1) \\]\n  and so the conclusion is true here too.\n\n  In the annoying case $p = 2$, the proof is broken into two cases:\n  for $k$ odd it follows by pairing $x$ with $2^e-x$\n  and when $k$ is even one can take $5$ as a generator\n  of all the quadratic residues as in the $p > 2$ case.\n\\end{proof}\n\\begin{corollary*}\n  We have $\\nu_p(1^k + \\dots + t^k) \\ge \\nu_p(t) - 1$ for any $k$, $t$, $p$.\n\\end{corollary*}\n\\begin{proof}\n  Assume $p \\mid t$.\n  Handle the terms in that sum divisible by $p$ (by induction)\n  and apply the lemma a bunch of times.\n\\end{proof}\n\nNow the idea is to add primes $q$ one at a time to $n$, starting from the base case $n = p^e$.\nSo, formally we proceed by induction on the number of prime divisors of $n$.\nWe'll also assume $k \\ge 1$ in what follows since the base case $k=0$ is easy.\n\n\\begin{itemize}\n\\ii First, suppose we want to go from $n$ to $nq$ where $q \\nmid n$.\nIn that case $\\varphi(nq)$ gained $\\nu_p(q-1)$ factors of $p$\nand then we need to show $\\nu_p(S(nq,k)) \\ge \\nu_p(\\varphi(n)) + \\nu_p(q-1)$.\nThe trick is to write\n\\[ A(nq) = \\left\\{ a + nh \\mid a \\in A(n)\n    \\text{ and } h = 0,\\dots,q-1 \\right\\}\n    \\setminus qA(n)  \\]\nand then expand using binomial theorem:\n\\begin{align*}\n  S(nq, k) &= \\sum_{a \\in A(n)} \\sum_{h=0}^{q-1} (a+nh)^k - \\sum_{a \\in A(n)} (qa)^k \\\\\n  &= -q^k S(n,k) + \\sum_{a \\in A(n)} \\sum_{h=0}^{q-1} \\sum_{j=0}^k\n    \\left[ \\binom kj a^{k-j} n^j h^j \\right] \\\\\n  &= -q^k S(n,k) +\n    \\sum_{j=0}^k \\left[ \\binom kj n^j \\left( \\sum_{a \\in A(n)} a^{k-j} \\right)\n    \\left( \\sum_{h=0}^{q-1} h^j \\right) \\right] \\\\\n  &= -q^k S(n,k) + \\sum_{j=0}^k \\left[ \\binom kj n^j S(n,k-j)\n    \\left( \\sum_{h=1}^{q-1} h^j \\right) \\right] \\\\\n  &= (q-q^k) S(n,k)\n    + \\sum_{j=1}^k \\left[ \\binom kj n^j S(n,k-j)\n    \\left( \\sum_{h=1}^{q-1} h^j \\right) \\right].\n\\end{align*}\nWe claim every term here has enough powers of $p$.\nFor the first term, $S(n,k)$ has at least $\\nu_p(\\varphi(n))$ factors of $p$;\nand we have the $q-q^k$ multiplier out there.\nFor the other terms, we apply induction to $S(n,k-j)$;\nmoreover $\\sum_{h=1}^{q-1} h^j$ has at least $\\nu_p(q-1)-1$ factors of $p$ by corollary,\nand we get one more factor of $p$ (at least) from $n^j$.\n\n\\ii On the other hand, if $q$ already divides $n$, then this time\n\\[ A(nq) = \\left\\{ a + nh \\mid a \\in A(n)\n    \\text{ and } h = 0,\\dots,q-1 \\right\\}.  \\]\nand we have no additional burden of $p$ to deal with; the same calculation gives\n\\[ S(nq,k) = qS(n,k)\n  + \\sum_{j=1}^k \\left[ \\binom kj n^j S(n,k-j)\n  \\left( \\sum_{h=1}^{q-1} h^j \\right) \\right] \\]\nwhich certainly has enough factors of $p$ already.\n\\end{itemize}\n\n\\begin{remark*}\n  A curious bit about the problem is that $\\nu_p(\\varphi(n))$ can exceed $\\nu_p(n)$,\n  and so it is not true that the residues of $A(n)$ are well-behaved modulo $\\varphi(n)$.\n\n  As an example, let $n = 2 \\cdot 3 \\cdot 7 \\cdot 13 = 546$,\n  so $m = \\varphi(n) = 1 \\cdot 2 \\cdot 6 \\cdot 12 = 144$.\n  Then $A(n)$ contains $26$ elements which are $1 \\bmod 9$\n  and $23$ elements which are $4 \\bmod 9$.\n\\end{remark*}\n\n\\begin{remark*}\n  The converse of the problem is true too\n  (but asking both parts would make this too long for exam).\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Number Theory", "source": "USAMO", "year": 2018}
{"id": "usamo-2018-q4", "question": "Let $p$ be a prime, and let $a_1$, \\dots, $a_p$ be integers.\nShow that there exists an integer $k$ such that the numbers\n\\[ a_1 + k, \\; a_2 + 2k, \\; \\dots, \\; a_p + pk \\]\nproduce at least $\\half p$ distinct remainders upon division by $p$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10232389}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $p$ be a prime, and let $a_1$, \\dots, $a_p$ be integers.\nShow that there exists an integer $k$ such that the numbers\n\\[ a_1 + k, \\; a_2 + 2k, \\; \\dots, \\; a_p + pk \\]\nproduce at least $\\half p$ distinct remainders upon division by $p$.\n\\end{mdframed}\nFor each $k = 0, \\dots, p-1$ let $G_k$ be the graph\non $\\{1, \\dots, p\\}$ where we join $\\{i,j\\}$ if and only if\n\\[ a_i + ik \\equiv a_j + jk \\pmod p\n  \\iff k \\equiv - \\frac{a_i - a_j}{i-j} \\pmod p. \\]\nSo we want a graph $G_k$ with at least $\\half p$ connected components.\n\nHowever, each $\\{i,j\\}$ appears in exactly one graph $G_k$,\nso some graph has at most $\\frac 1p \\binom p2 = \\half(p-1)$ edges\n(by ``pigeonhole'').\nThis graph has at least $\\half(p+1)$ connected components, as desired.\n\n\\begin{remark*}\n  Here is an example for $p=5$ showing equality can occur:\n  \\[\n    \\begin{bmatrix}\n      0 & 0 & 3 & 4 & 3 \\\\\n      0 & 1 & 0 & 2 & 2 \\\\\n      0 & 2 & 2 & 0 & 1 \\\\\n      0 & 3 & 4 & 3 & 0 \\\\\n      0 & 4 & 1 & 1 & 4\n    \\end{bmatrix}.\n  \\]\n  Ankan Bhattacharya points out more generally\n  that $a_i = i^2$ is sharp in general.\n\\end{remark*}\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 2018}
{"id": "usamo-2018-q5", "question": "Let $ABCD$ be a convex cyclic quadrilateral with\n$E = \\ol{AC} \\cap \\ol{BD}$, $F = \\ol{AB} \\cap \\ol{CD}$,\n$G = \\ol{DA} \\cap \\ol{BC}$.\nThe circumcircle of $\\triangle ABE$\nintersects line $CB$ at $B$ and $P$,\nand the circumcircle of $\\triangle ADE$\nintersects line $CD$ at $D$ and $Q$.\nAssume $C$, $B$, $P$, $G$\nand $C$, $Q$, $D$, $F$ are collinear in that order.\nLet $M = \\ol{FP} \\cap \\ol{GQ}$.\nProve that $\\angle MAC = 90\\dg$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10232392}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABCD$ be a convex cyclic quadrilateral with\n$E = \\ol{AC} \\cap \\ol{BD}$, $F = \\ol{AB} \\cap \\ol{CD}$,\n$G = \\ol{DA} \\cap \\ol{BC}$.\nThe circumcircle of $\\triangle ABE$\nintersects line $CB$ at $B$ and $P$,\nand the circumcircle of $\\triangle ADE$\nintersects line $CD$ at $D$ and $Q$.\nAssume $C$, $B$, $P$, $G$\nand $C$, $Q$, $D$, $F$ are collinear in that order.\nLet $M = \\ol{FP} \\cap \\ol{GQ}$.\nProve that $\\angle MAC = 90\\dg$.\n\\end{mdframed}\nWe present three general routes.\n(The second route, using the fact that $\\ol{AC}$\nis an angle bisector, has many possible variations.)\n\n\\paragraph{First solution (Miquel points).}\nThis is indeed a Miquel point problem,\nbut the main idea is to focus on the self-intersecting\ncyclic quadrilateral $PBQD$ as the key player,\nrather than on the given $ABCD$.\n\nIndeed, we will prove that $A$ is its Miquel point;\nthis follows from the following two claims.\n\\begin{claim*}\n  The self-intersecting quadrilateral $PQDB$ is cyclic.\n\\end{claim*}\n\\begin{proof}\n  By power of a point from $C$:\n  $CQ \\cdot CD = CA \\cdot CE = CB \\cdot CP$.\n\\end{proof}\n\\begin{claim*}\n  Point $E$ lies on line $PQ$.\n\\end{claim*}\n\\begin{proof}\n  $\\dang AEP = \\dang ABP = \\dang ABC = \\dang ADC\n  = \\dang ADQ = \\dang AEQ$.\n\\end{proof}\n\n\\begin{center}\n\\begin{asy}\npair P = dir(240);\npair B = dir(300);\npair Q = dir(20);\npair D = dir(50);\npair E = extension(Q, P, B, D);\npair C = extension(D, Q, B, P);\npair H = extension(D, P, B, Q);\npair A = foot(H, E, C);\nfilldraw(unitcircle, opacity(0.1)+lightcyan, lightblue);\n\npair G = extension(D, A, B, C);\npair F = extension(B, A, C, D);\n\nfilldraw(circumcircle(P, A, E), opacity(0.1)+green, heavygreen);\nfilldraw(circumcircle(Q, A, E), opacity(0.1)+green, heavygreen);\nfilldraw(circumcircle(A, B, C), opacity(0.05)+yellow, heavygreen+dotted);\ndraw(B--F--C, gray);\ndraw(D--G--C, gray);\ndraw(P--H--B, blue);\ndraw(P--B--Q--D--cycle, blue);\ndraw(A--C, gray);\ndraw(P--Q, blue);\ndraw(B--D, blue);\n\npair M = extension(P, F, G, Q);\ndraw(F--P, heavycyan);\ndraw(G--Q, heavycyan);\n\ndot(\"$P$\", P, dir(P));\ndot(\"$B$\", B, dir(B));\ndot(\"$Q$\", Q, dir(Q));\ndot(\"$D$\", D, dir(D));\ndot(\"$E$\", E, dir(E));\ndot(\"$C$\", C, dir(C));\ndot(\"$H$\", H, dir(H));\ndot(\"$A$\", A, dir(E-C));\ndot(\"$G$\", G, dir(G));\ndot(\"$F$\", F, dir(F));\ndot(\"$M$\", M, dir(B-M));\n\n/* TSQ Source:\n\nP = dir 240\nB = dir 300\nQ = dir 20\nD = dir 50\nE = extension Q P B D\nC = extension D Q B P\nH = extension D P B Q\nA = foot H E C RE-C\nunitcircle 0.1 lightcyan / lightblue\n\nG = extension D A B C\nF = extension B A C D\n\ncircumcircle P A E 0.1 green / heavygreen\ncircumcircle Q A E 0.1 green / heavygreen\ncircumcircle A B C 0.05 yellow / heavygreen dotted\nB--F--C gray\nD--G--C gray\nP--H--B blue\nP--B--Q--D--cycle blue\nA--C gray\nP--Q blue\nB--D blue\n\nM = extension P F G Q\nF--P heavycyan\nG--Q heavycyan\n\n*/\n\\end{asy}\n\\end{center}\n\nTo finish, let $H = \\ol{PD} \\cap \\ol{BQ}$.\nBy properties of the Miquel point, we have $A$ is the\nfoot from $H$ to $\\ol{CE}$.\nBut also, points $M$, $A$, $H$ are collinear\nby Pappus theorem on $\\ol{BPG}$ and $\\ol{DQF}$, as desired.\n\n\\paragraph{Second solution (projective).}\nWe start with a synthetic observation.\n\\begin{claim*}\n  The line $\\ol{AC}$ bisects $\\angle PAD$ and $\\angle BAQ$.\n\\end{claim*}\n\\begin{proof}\n  Angle chase:\n  $\\dang PAC = \\dang PAE = \\dang PBE = \\dang CBD = \\dang CAD$.\n\\end{proof}\n\nThere are three ways to finish from here:\n\\begin{itemize}\n  \\ii (Michael Kural) Suppose the external bisector\n  of $\\angle PAD$ and $\\angle BAQ$\n  meet lines $BC$ and $DC$ at $X$ and $Y$.\n  Then \\[ -1 = (GP;XC) = (FD;YC) \\]\n  which is enough to imply that $\\ol{XY}$, $\\ol{GQ}$, $\\ol{PF}$\n  are concurrent (by so-called prism lemma).\n\n  \\ii (Daniel Liu) Alternatively,\n  apply the dual Desargues involution theorem\n  to complete quadrilateral $GQFPCM$, through the point $A$.\n  This gives that an involutive pairing of\n  \\[ (AC,AM) \\; (AP,AQ) \\; (AG, AF). \\]\n  This is easier to see if we project it onto the\n  line $\\ell$ through $C$ perpendicular to $\\ol{AC}$:\n  let $P'$, $Q'$, $G'$, $F'$ be the images of the last four lines,\n  so $C$ is the common midpoint of $\\ol{F'Q'}$ and $\\ol{G'P'}$.\n  Hence the involution swapping $G' \\leftrightarrow F'$ and $P' \\leftrightarrow Q'$\n  coincides with negative inversion through $C$ with power $\\sqrt{CP' \\cdot CQ'}$\n  which implies that $\\ol{AM} \\cap \\ell$ is an infinity point, as desired.\n\n  \\ii (Kada Williams) The official solution instead shows the external angle\n  bisector by a long trig calculation.\n\\end{itemize}\n\n\\paragraph{Third solution (inversion, Andrew Wu).}\nNoting that $CE \\cdot CA = CP \\cdot CB = CQ \\cdot CD$,\nwe perform an inversion at $C$ swapping these pairs of points.\nThe point $G$ is mapped to a point $G^\\ast$ ray $CB$\nfor which $QEG^\\ast C$ is cyclic, but then\n\\[ \\dang CG^\\ast E = \\dang CQE = \\dang CQP = \\dang DBC = \\dang CBE \\]\nand so we conclude $EB = EG^\\ast$.\nSimilarly, $ED = EF^\\ast$.\n\nFinally, $M^\\ast = (CG^\\ast D) \\cap (CF^\\ast B) \\neq C$,\nand we wish to show that $\\angle EM^\\ast C = 90\\dg$.\n\n\\begin{center}\n\\begin{asy}\npair D = dir(100);\npair B = dir(220);\npair C = dir(320);\npair E = 0.3*D+0.7*B;\npair K = foot(E, B, C);\npair L = foot(E, D, C);\npair Gs = 2*K-B;\npair Fs = 2*L-D;\npair Ms = (D*B-Fs*Gs)/(D+B-Fs-Gs);\n\nfilldraw(circumcircle(Gs, D, C), opacity(0.05)+yellow, orange);\nfilldraw(circumcircle(Fs, B, C), opacity(0.05)+yellow, orange);\n\nfill(B--C--D--cycle, opacity(0.1)+yellow);\ndraw(B--C--D, orange);\ndraw(B--D, red);\ndraw(Gs--E--K, red);\ndraw(Fs--E--L, red);\nfilldraw(circumcircle(E, L, K), opacity(0.1)+red, lightred+dashed);\n\ndot(\"$D$\", D, dir(D));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$E$\", E, dir(E));\ndot(\"$K$\", K, dir(K));\ndot(\"$L$\", L, dir(L));\ndot(\"$G^\\ast$\", Gs, dir(Gs));\ndot(\"$F^\\ast$\", Fs, dir(30));\ndot(\"$M^\\ast$\", Ms, dir(Ms));\n\n/* TSQ Source:\n\nD = dir 100\nB = dir 220\nC = dir 320\nE = 0.3*D+0.7*B\nK = foot E B C\nL = foot E D C\nG* = 2*K-B\nF* = 2*L-D R30\nM* = (D*B-Fs*Gs)/(D+B-Fs-Gs)\n\ncircumcircle Gs D C 0.05 yellow / orange\ncircumcircle Fs B C 0.05 yellow / orange\n\n!fill(B--C--D--cycle, opacity(0.1)+yellow);\nB--C--D orange\nB--D red\nGs--E--K red\nFs--E--L red\ncircumcircle E L K 0.1 red / lightred dashed\n\n*/\n\\end{asy}\n\\end{center}\n\nNote that $M^\\ast$ is the center of the\nspiral similarity sending $\\ol{BG^\\ast}$ to $\\ol{F^\\ast D}$.\nHence it also maps the midpoint $K$ of $BG^\\ast$\nto the midpoint $L$ of $\\ol{F^\\ast E}$.\nConsequently, $M^\\ast$ lies on the circumcircle $KLC$ as well.\nIn other words, $ELCKM^\\ast$ is a cyclic pentagon\nwith circumdiameter $\\ol{CE}$, as desired.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2018}
{"id": "usamo-2018-q6", "question": "Let $a_n$ be the number of permutations $(x_1, \\dots, x_n)$ of $(1, \\dots, n)$\nsuch that the ratios $x_k / k$ are all distinct.\nProve that $a_n$ is odd for all $n \\ge 1$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10232388}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a_n$ be the number of permutations $(x_1, \\dots, x_n)$ of $(1, \\dots, n)$\nsuch that the ratios $x_k / k$ are all distinct.\nProve that $a_n$ is odd for all $n \\ge 1$.\n\\end{mdframed}\nThis is the official solution; the proof has two main insights.\n\nThe first idea:\n\\begin{lemma*}\n  If a permutation $x$ works, so does the inverse permutation.\n\\end{lemma*}\n\nThus it suffices to consider permutations $x$\nin which all cycles have length at most $2$.\nOf course, there can be at most one fixed point (since that gives the ratio $1$),\nand hence exactly one if $n$ is odd, none if $n$ is even.\n\nWe consider the graph $K_n$ such that the edge\n$\\{i,j\\}$ is labeled with $i / j$ (for $i < j$).\nThe permutations we're considering are then equivalent to maximal\nmatchings of this $K_n$.\nWe call such a matching \\emph{fantastic} if it has all distinct edge labels.\n\n\\bigskip\n\nNow the second insight is that if edges $ab$ and $cd$\nhave the same label for $a<b$ and $c<d$, then so do edges $ac$ and $bd$.\nThus:\n\\begin{definition*}\n  Given a matching $\\mathcal M$ as above we say the \\emph{neighbors}\n  of $\\mathcal M$ are those other matchings obtained as follows:\n  for each label $\\ell$, we take some disjoint pairs of edges (possibly none)\n  with label $\\ell$ and apply the above switching operation\n  (in which we replace $ab$ and $cd$ with $ac$ and $bd$).\n\\end{definition*}\nThis neighborship relation is reflexive, and most importantly it is \\emph{symmetric}\n(because one can simply reverse the moves).\nBut it is not transitive.\n\nThe second observation is that:\n\\begin{claim*}\n  The matching $\\mathcal M$ has an odd number of neighbors\n  (including itself) if and only if it is fantastic.\n\\end{claim*}\n\\begin{proof}\n  Consider the label $\\ell$, and assume it appears $n_\\ell \\ge 1$ times.\n\n  If we pick $k$ disjoint pairs and swap them, the number of ways to do this is\n  $\\binom{n_\\ell}{2k} (2k-1)!!$, and so the total\n  number of ways to perform operations on the edges labeled $\\ell$ is\n  \\[ \\sum_k \\binom{n_\\ell}{2k} (2k-1)!!\n    \\equiv \\sum_k \\binom{n_\\ell}{2k}\n    = 2^{n_\\ell-1} \\pmod 2. \\]\n  This is even if and only if $n_\\ell > 1$.\n\n  Finally, note that the number of neighbors\n  of $\\mathcal M$ is the product across all $\\ell$ of the above.\n  So it is odd if and only if each factor is odd,\n  if and only if $n_\\ell = 1$ for every $\\ell$.\n\\end{proof}\n\nTo finish, consider a huge simple graph $\\Gamma$ on all the\nmaximal matchings, with edge relations given by neighbor relation\n(we don't consider vertices to be connected to themselves).\nObserve that:\n\\begin{itemize}\n  \\ii The fantastic matchings of the vertices of $\\Gamma$ have odd degrees\n  (one less than the neighbor count).\n  \\ii The other matchings correspond to isolated vertices\n  (of degree zero, with no other neighbors) of $\\Gamma$.\n  \\ii The graph $\\Gamma$ has an even number of vertices of odd degree\n  (this is true for any simple graph, see ``handshake lemma'').\n  \\ii The number of vertices of $\\Gamma$ is odd,\n  namely $\\left( 2\\left\\lceil n/2 \\right\\rceil - 1 \\right)!!$.\n\\end{itemize}\nThis concludes the proof.\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "USAMO", "year": 2018}
{"id": "putnam-2013-a1", "question": "Recall that a regular icosahedron is a convex polyhedron\nhaving 12 vertices and 20 faces;\nthe faces are congruent equilateral triangles.\nOn each face of a regular icosahedron is written a nonnegative integer\nsuch that the sum of all 20 integers is 39. Show that there are \ntwo faces that share a vertex and have the same integer written on them.", "solution": "Suppose otherwise. Then each vertex $v$ is a vertex for five faces, all of which have different labels, and so the sum of the labels of the five faces incident to $v$ is at least $0+1+2+3+4 = 10$. Adding this sum over all vertices $v$ gives $3 \\times 39 = 117$, since each face's label is counted three times. Since there are $12$ vertices, we conclude that $10 \\times 12 \\leq 117$, contradiction.\n\n\\noindent\n\\textbf{Remark:}\nOne can also obtain the desired result by showing that any collection of five faces must contain two faces that share a vertex; it then follows that each label can appear at most $4$ times, and so the sum of all labels is at least $4(0+1+2+3+4) = 40 > 39$, contradiction.", "category": "Geometry", "source": "PUTNAM", "year": 2013}
{"id": "putnam-2013-a2", "question": "Let $S$ be the set of all positive integers that are \\emph{not} perfect squares. For $n$ in $S$, consider choices of integers\n$a_1, a_2, \\dots, a_r$ such that $n < a_1<  a_2 < \\cdots < a_r$\nand $n \\cdot a_1 \\cdot a_2 \\cdots a_r$ is a perfect square, and\nlet $f(n)$ be the minumum of $a_r$ over all such choices. For example,\n$2 \\cdot 3 \\cdot 6$ is a perfect square, while $2 \\cdot 3$, $2 \\cdot 4$, \n$2 \\cdot 5$, $2 \\cdot 3 \\cdot 4$, $2 \\cdot 3 \\cdot 5$, $2 \\cdot 4 \\cdot 5$, and $2 \\cdot 3 \\cdot 4 \\cdot 5$ are not, and so $f(2) = 6$.\nShow that the function $f$ from $S$ to the integers is one-to-one.", "solution": "Suppose to the contrary that $f(n) = f(m)$ with $n<m$, and let $n\\cdot a_1\\cdots a_r$, $m\\cdot b_1\\cdots b_s$ be perfect squares where $n < a_1 < \\cdots < a_r$, $m < b_1 < \\cdots < b_s$, $a_r,b_s$ are minimal and $a_r=b_s$. Then $(n\\cdot a_1\\cdots a_r)\\cdot (m\\cdot b_1\\cdots b_s)$ is also a perfect square. Now eliminate any factor in this product that appears twice (i.e., if $a_i = b_j$ for some $i,j$, then delete $a_i$ and $b_j$ from this product). The product of what remains must also be a perfect square, but this is now a product of distinct integers, the smallest of which is $n$ and the largest of which is strictly smaller than $a_r = b_s$. This contradicts the minimality of $a_r$.\n\n\\noindent\n\\textbf{Remark:}\nSequences whose product is a perfect square occur naturally in the \\emph{quadratic sieve} algorithm for factoring large integers. However,\nthe behavior of the function $f(n)$ seems to be somewhat erratic. \nKarl Mahlburg points out the upper bound $f(n) \\leq 2n$ for $n \\geq 5$, which holds because the interval $(n, 2n)$ contains an integer of the form $2m^2$. A trivial lower bound is $f(n) \\geq n+p$ where $p$ is the least prime factor of $n$. For $n = p$ prime, the bounds agree and we have $f(p) = 2p$. For more discussion, see \n\\url{https://oeis.org/A006255}.", "category": "Number Theory", "source": "PUTNAM", "year": 2013}
{"id": "putnam-2013-a3", "question": "Suppose that the real numbers $a_0, a_1, \\dots, a_n$ and\n$x$, with $0 < x < 1$, satisfy\n\\[\n\\frac{a_0}{1-x} + \\frac{a_1}{1-x^2} + \\cdots + \\frac{a_n}{1 - x^{n+1}} = 0.\n\\]\nProve that there exists a real number $y$ with $0 < y < 1$ such that\n\\[\na_0 + a_1 y + \\cdots + a_n y^n = 0.\n\\]", "solution": "Suppose on the contrary that $a_0 + a_1 y + \\cdots + a_n y^n$ is nonzero for $0 < y < 1$. By the intermediate value theorem, this is only possible if $a_0 + a_1 y + \\cdots + a_n y^n$ has the same sign for $0 < y < 1$; without loss of generality, we may assume that $a_0 + a_1 y + \\cdots + a_n y^n > 0$ for $0 < y < 1$. For the given value of $x$, we then have\n\\[\na_0 x^m + a_1 x^{2m} + \\cdots + a_n x^{(n+1)m} \\geq 0\n\\]\nfor $m=0,1,\\dots$, with strict inequality for $m>0$.\nTaking the sum over all $m$ is absolutely convergent and hence valid; this yields\n\\[\n\\frac{a_0}{1-x} + \\frac{a_1}{1-x^2} + \\cdots + \\frac{a_n}{1-x^{n+1}} > 0,\n\\]\na contradiction.", "category": "Algebra", "source": "PUTNAM", "year": 2013}
{"id": "putnam-2013-a4", "question": "A finite collection of digits $0$ and $1$ is written around a circle.\nAn \\emph{arc} of length $L \\geq 0$ consists of $L$ consecutive digits around the circle. For each arc $w$, let $Z(w)$ and $N(w)$ denote the number of $0$'s in $w$ and the number of $1$'s in $w$, respectively.\nAssume that $\\left| Z(w) - Z(w') \\right| \\leq 1$ for any two arcs $w, w'$ of the same length. Suppose that some arcs $w_1,\\dots,w_k$ have the property that\n\\[\nZ = \\frac{1}{k} \\sum_{j=1}^k Z(w_j) \\mbox{ and }\nN = \\frac{1}{k} \\sum_{j=1}^k N(w_j)\n\\]\nare both integers. Prove that there exists an arc $w$ with $Z(w) = Z$\nand $N(w) = N$.", "solution": "Let $w_1',\\ldots,w_k'$ be arcs such that: $w_j'$ has the same length as $w_j$; $w_1'$ is the same as $w_1$; and $w_{j+1}'$ is adjacent to $w_j'$ (i.e., the last digit of $w_j'$ comes right before the first digit of $w_{j+1}'$). Since $w_j$ has length $Z(w_j)+N(w_j)$, the sum of the lengths of $w_1,\\ldots,w_k$ is $k(Z+N)$, and so the concatenation of $w_1',\\ldots,w_k'$ is a string of $k(Z+N)$ consecutive digits around the circle. (This string may wrap around the circle, in which case some of these digits may appear more than once in the string.) Break this string into $k$ arcs $w_1'',\\ldots,w_k''$ each of length $Z+N$, each adjacent to the previous one. (Note that if the number of digits around the circle is $m$, then $Z+N \\leq m$ since $Z(w_j)+N(w_j) \\leq m$ for all $j$, and thus each of $w_1'',\\ldots,w_k''$ is indeed an arc.)\n\nWe claim that for some $j=1,\\ldots,k$, $Z(w_j'')=Z$ and $N(w_j'')=N$ (where the second equation follows from the first since $Z(w_j'')+N(w_j'')=Z+N$). Otherwise, since all of the $Z(w_j'')$ differ by at most $1$, either $Z(w_j'') \\leq Z-1$ for all $j$ or $Z(w_j'') \\geq Z+1$ for all $j$. In either case,\n$|kZ - \\sum_j Z(w_j')| = |kZ-\\sum_j Z(w_j'')| \\geq k$. But since $w_1=w_1'$, we have\n$|kZ - \\sum_j Z(w_j')| = |\\sum_{j=1}^k (Z(w_j)-Z(w_j'))| = |\\sum_{j=2}^k (Z(w_j)-Z(w_j'))| \\leq \\sum_{j=2}^k |Z(w_j)-Z(w_j')| \\leq k-1$, contradiction.", "category": "Combinatorics", "source": "PUTNAM", "year": 2013}
{"id": "putnam-2013-a5", "question": "For $m \\geq 3$, a list of $\\binom{m}{3}$ real numbers $a_{ijk}$ ($1 \\leq i < < j < k \\leq m$) is said to be \\emph{area definite} for $\\mathbb{R}^n$ if the inequality\n\\[\n\\sum_{1 \\leq i < j < k \\leq m} a_{ijk} \\cdot \\mathrm{Area}(\\Delta A_i A_j A_k) \\geq 0\n\\]\nholds for every choice of $m$ points $A_1,\\dots,A_m$ in $\\mathbb{R}^n$.\nFor example, the list of four numbers $a_{123} = a_{124} = a_{134} = 1$, $a_{234} = -1$ is area definite for $\\mathbb{R}^2$. Prove that if a list of $\\binom{m}{3}$ numbers is area definite for $\\mathbb{R}^2$,\nthen it is area definite for $\\mathbb{R}^3$.", "solution": "Let $A_1,\\ldots,A_m$ be points in $\\mathbb{R}^3$, and let $\\hat{n}_{ijk}$ denote a unit vector normal to $\\Delta A_iA_jA_k$ (unless $A_i,A_j,A_k$ are collinear, there are two possible choices for $\\hat{n}_{ijk}$). If $\\hat{n}$ is a unit vector in $\\mathbb{R}^3$, and $\\Pi_{\\hat{n}}$ is a plane perpendicular to $\\hat{n}$, then the area of the orthogonal projection of $\\Delta A_iA_jA_k$ onto $\\Pi_{\\hat{n}}$ is $\\text{Area}(\\Delta A_iA_jA_k) |\\hat{n}_{ijk} \\cdot \\hat{n}|$. Thus if $\\{a_{ijk}\\}$ is area definite for $\\mathbb{R}^2$, then for any $\\hat{n}$,\n\\[\n\\sum a_{ijk} \\text{Area}(\\Delta A_iA_jA_k) |\\hat{n}_{ijk} \\cdot \\hat{n}| \\geq 0.\n\\]\nNote that integrating $|\\hat{n}_{ijk} \\cdot \\hat{n}|$ over $\\hat{n} \\in S^2$, the unit sphere in $\\mathbb{R}^3$, with respect to the natural measure on $S^2$ gives a positive number $c$, which is independent of $\\hat{n}_{ijk}$ since the measure on $S^2$ is rotation-independent. Thus integrating the above inequality over $\\hat{n}$ gives\n$c \\sum a_{ijk} \\text{Area}(\\Delta A_iA_jA_k) \\geq 0$. It follows that $\\{a_{ijk}\\}$ is area definite for $\\mathbb{R}^3$, as desired. \n\n\\noindent\n\\textbf{Remark:}\nIt is not hard to check (e.g., by integration in spherical coordinates) that the constant $c$ occurring above is equal to $2\\pi$. It follows that for any convex body $C$ in $\\mathbb{R}^3$, the average over $\\hat{n}$ of the area of the projection of $C$ onto $\\Pi_{\\hat{n}}$ equals $1/4$ of the surface area of $C$. \n\nMore generally, let $C$ be a convex body in $\\mathbb{R}^n$.\nFor $\\hat{n}$ a unit vector, let $\\Pi_{\\hat{n}}$ denote the hyperplane through the origin perpendicular to $\\hat{n}$. Then the average over $\\hat{n}$ of the volume of the projection of $C$ onto $\\Pi_{\\hat{n}}$ equals a constant (depending only on $n$) times the $(n-1)$-dimensional surface area of $C$. \n\nStatements of this form inhabit the field of \\emph{inverse problems}, in which one attempts to reconstruct information about a geometric object from low-dimensional samples. This field has important applications in imaging and tomography.", "category": "Geometry", "source": "PUTNAM", "year": 2013}
{"id": "putnam-2013-a6", "question": "Define a function $w: \\mathbb{Z} \\times \\mathbb{Z} \\to \\mathbb{Z}$\nas follows. For $\\left| a \\right|, \\left| b \\right| \\leq 2$,\nlet $w(a,b)$ be as in the table shown; otherwise, let $w(a,b) = 0$.\n\\begin{center}\n\\begin{tabular}{|cc|r|r|r|r|r|}\n\\hline\n\\multicolumn{2}{|c|}{\\multirow{2}{*}{$w(a,b)$}} & \\multicolumn{5}{|c|}{$b$} \\\\\n&  & -2 & -1 & 0 & 1 & 2 \\\\\n\\hline\n& -2 & -1 & -2 & 2 & -2 & -1 \\\\\n& -1 & -2 & 4 & -4 & 4 & -2 \\\\\n$a$ & 0 & 2 & -4 & 12 & -4 & 2 \\\\\n& 1 & -2 & 4 & -4 & 4 & -2 \\\\ \n& 2 &  -1 & -2 & 2 & -2 & -1 \\\\\n\\hline\n\\end{tabular}\n\\end{center}\nFor every finite subset $S$ of $\\mathbb{Z} \\times \\mathbb{Z}$,\ndefine\n\\[\nA(S) = \\sum_{(\\mathbf{s}, \\mathbf{s}') \\in S \\times S} w(\\mathbf{s} - \\mathbf{s}').\n\\]\nProve that if $S$ is any finite nonempty subset of $\\mathbb{Z} \\times \\mathbb{Z}$, then $A(S) > 0$.\n(For example, if $S = \\{(0,1), (0,2), (2,0), (3,1)\\}$, then the terms in $A(S)$ are $12, 12, 12, 12, 4, 4, 0, 0, 0,0,-1,-1,-2,-2,-4,-4$.)", "solution": "(by Harm Derksen)\nConsider the generating functions\n\\begin{align*}\nf(x,y) &= \\sum_{(a,b) \\in S} x^a y^b, \\\\\ng(x,y) &= \\sum_{(a,b) \\in \\mathbb{Z}^2} w(a,b) x^a y^b.\n\\end{align*}\nThen $A(S)$ is the constant coefficient of the Laurent polynomial\n$h(x,y) = f(x,y) f(x^{-1}, y^{-1}) g(x,y)$. We may compute this coefficient by averaging over unit circles:\n\\begin{align*}\n(2 \\pi)^2 A(S) &= \\int_0^{2\\pi} \\int_0^{2\\pi} h(e^{is}, e^{it})\\,dt\\,ds \\\\\n&= \\int_0^{2\\pi} \\int_0^{2\\pi} \\left| f(e^{is}, e^{it}) \\right|^2 g(e^{is}, e^{it}) \\,dt\\,ds.\n\\end{align*}\nConsequently, it is enough to check that $g(e^{is}, e^{it})$ is a nonnegative real number for all $s,t \\in \\mathbb{R}$. But\n$g(e^{is}, e^{it}) = 16 G(\\cos s,\\cos t)$ for\n\\[\nG(z,w) = zw + z^2 + w^2 - z^2 w - zw^2 - z^2w^2.\n\\]\nIf $z,w \\in [-1,1]$ and $zw \\geq 0$, then\n\\[\nG(z,w) = zw(1-zw) + z^2(1-w) + w^2(1-z) \\geq 0.\n\\]\nIf $z,w \\in [-1,1]$ and $zw \\leq 0$, then\n\\[\nG(z,w) = (z+w)^2 - zw(1+z)(1+w) \\geq 0.\n\\]\nHence $g(e^{is},e^{it}) \\geq 0$ as desired.", "category": "Algebra", "source": "PUTNAM", "year": 2013}
{"id": "putnam-2013-b1", "question": "For positive integers $n$, let the numbers $c(n)$ be determined by \nthe rules $c(1) = 1$, $c(2n) = c(n)$, and $c(2n+1) = (-1)^n c(n)$.\nFind the value of \n\\[\n\\sum_{n=1}^{2013} c(n) c(n+2).\n\\]", "solution": "Note that \n\\begin{align*}\nc(2k+1)c(2k+3) &= (-1)^k c(k) (-1)^{k+1} c(k+1) \\\\\n&= -c(k)c(k+1) \\\\ \n&= -c(2k)c(2k+2).\n\\end{align*}\nIt follows that $\\sum_{n=2}^{2013} c(n)c(n+2) = \\sum_{k=1}^{1006} (c(2k)c(2k+2)+c(2k+1)c(2k+3)) = 0$,\nand so the desired sum is $c(1)c(3) = -1$. \n\n\\textbf{Remark}: Karl Mahlburg points out the general formula\n$c(n) = (-1)^{b_0 b_1 + b_1 b_2 + \\dots + b_{k-1} b_k}$\nfor $n$ having binary representation $b_k \\cdots b_0$.", "category": "Number Theory", "source": "PUTNAM", "year": 2013}
{"id": "putnam-2013-b2", "question": "Let $C = \\bigcup_{N=1}^\\infty C_N$, where $C_N$ denotes the set of those `cosine polynomials' of the form\n\\[\nf(x) = 1 + \\sum_{n=1}^N a_n \\cos(2 \\pi n x)\n\\]\nfor which:\n\\begin{enumerate}", "solution": "We claim that the maximum value of $f(0)$ is $3$. This is attained for\n$N=2$, $a_1=\\frac{4}{3}$, $a_2=\\frac{2}{3}$: in this case $f(x) = 1+\\frac{4}{3} \\cos(2\\pi x)+\\frac{2}{3} \\cos(4\\pi x) =\n1+\\frac{4}{3} \\cos(2\\pi x)+\\frac{2}{3}(2\\cos^2(2\\pi x)-1) = \\frac{1}{3} (2\\cos(2\\pi x)+1)^2$ is always nonnegative.\n\nNow suppose that $f = 1 + \\sum_{n=1}^N a_n \\cos(2\\pi nx) \\in C$. When $n$ is an integer, $\\cos(2\\pi n/3)$ equals $0$ if $3|n$ and $-1/2$ otherwise. Thus $a_n \\cos(2\\pi n/3) = -a_n/2$ for all $n$, and\n$f(1/3) = 1-\\sum_{n=1}^N (a_n/2)$. Since $f(1/3) \\geq 0$, $\\sum_{n=1}^N a_n \\leq 2$, whence $f(0) = 1 + \\sum_{n=1}^N a_n \\leq 3$.", "category": "Algebra", "source": "PUTNAM", "year": 2013}
{"id": "putnam-2013-b3", "question": "Let $\\mathcal{P}$ be a nonempty collection of subsets of $\\{1,\\dots, n\\}$ such that:\n\\begin{enumerate}", "solution": "Yes, such numbers must exist. To define them, we make the following observations.\n\n\\setcounter{lemma}{0}\n\\begin{lemma}\nFor any $i \\in \\{1,\\dots,n\\}$, if there exists any $S \\in P$ containing $i$, then there exist $S,T \\in P$ such that $S$ is the disjoint union of $T$ with $\\{i\\}$.\n\\end{lemma}\n\\begin{proof}\nLet $S$ be an element of $P$ containing $i$ of minimum cardinality.\nBy (ii), there must be a subset $T \\subset S$ containing $P$ with exactly one fewer element than $S$. These sets have the desired form.\n\\end{proof}\n\n\\begin{lemma}\nSuppose $S_1, S_2, T_1, T_2 \\in P$ have the property that for some $i \\in \\{1,\\dots,n\\}$, $S_1$ is the disjoint union of $T_1$ with $\\{i\\}$ and $S_2$ is the disjoint union of $T_2$ with $\\{i\\}$. Then \n\\[\nf(S_1) - f(T_1) = f(S_2) - f(T_2).\n\\]\n\\end{lemma}\n\\begin{proof}\nBy (i) we have\n\\begin{align*}\nf(T_1 \\cup T_2 \\cup \\{i\\}) &= f(S_1) + f(T_2) - f(T_1 \\cap T_2) \\\\\nf(T_1 \\cup T_2 \\cup \\{i\\}) &= f(T_1) + f(S_2) - f(T_1 \\cap T_2),\n\\end{align*}\nfrom which the claim follows immediately.\n\\end{proof}\n\nWe now define $f_1,\\dots,f_n$ as follows. If $i$ does not appear in any element of $P$, we put $f_i = 0$. Otherwise, by Lemma~1, we can find \n$S, T \\in P$ such that $S$ is the disjoint union of $T$ with $\\{i\\}$. We then set $f_i = f(S) - f(T)$; by Lemma~2, this does not depend on the choice of $S,T$.\n\nTo check that $f(S) = \\sum_{i \\in S} f_i$ for $S \\in P$, note first that $\\emptyset \\in P$ by repeated application of (ii) and that $f(\\emptyset) = 0$ by hypothesis. This provides the base case for an induction on the cardinality of $S$; for any nonempty $S \\in P$, we may apply (ii) to find $T \\subset S$ such that $S$ is the disjoint union of $T$ and some singleton set $\\{j\\}$. By construction and the induction hypothesis, we have $f(S) = f(T) + f_j = j + \\sum_{i \\in T} f_i = \\sum_{i \\in S} f_i$ as desired.", "category": "Combinatorics", "source": "PUTNAM", "year": 2013}
{"id": "putnam-2013-b4", "question": "For any continuous real-valued function $f$ defined on the interval $[0,1]$, let\n\\begin{gather*}\n\\mu(f) = \\int_0^1 f(x)\\,dx, \\,\n\\mathrm{Var}(f) = \\int_0^1 (f(x) - \\mu(f))^2\\,dx, \\\\\nM(f) = \\max_{0 \\leq x \\leq 1} \\left| f(x) \\right|.\n\\end{gather*}\nShow that if $f$ and $g$ are continuous real-valued functions\ndefined on the interval $[0,1]$,\nthen\n\\[\n\\mathrm{Var}(fg) \\leq 2 \\mathrm{Var}(f) M(g)^2 + 2 \\mathrm{Var}(g) M(f)^2.\n\\]", "solution": "\\newcommand{\\Var}{\\mathrm{Var}}\n\nWrite $f_0(x) = f(x)-\\mu(f)$ and $g_0(x) = g(x)-\\mu(g)$, so that $\\int_0^1 f_0(x)^2\\,dx = \\Var(f)$, $\\int_0^1 g_0(x)^2\\,dx = \\Var(g)$, and $\\int_0^1 f_0(x)\\,dx = \\int_0^1 g_0(x)\\,dx = 0$. Now since $|g(x)| \\leq M(g)$ for all $x$, $0\\leq \\int_0^1 f_0(x)^2(M(g)^2-g(x)^2)\\,dx = \\Var(f) M(g)^2-\\int_0^1 f_0(x)^2g(x)^2\\,dx$, and similarly $0 \\leq \\Var(g)M(f)^2-\\int_0^1 f(x)^2g_0(x)^2\\,dx$. Summing gives\n\\begin{equation}\n\\Var(f)M(g)^2+\\Var(g)M(f)^2\n\\label{eq:1}\n\\geq \\int_0^1 (f_0(x)^2g(x)^2+f(x)^2g_0(x)^2)\\,dx.\n\\end{equation}\nNow\n\\begin{align*}\n&\\int_0^1 (f_0(x)^2g(x)^2+f(x)^2g_0(x)^2)\\,dx-\\Var(fg) \\\\&= \\int_0^1 (f_0(x)^2g(x)^2+f(x)^2g_0(x)^2-(f(x)g(x)-\\int_0^1 f(y)g(y)\\,dy)^2)\\,dx;\n\\end{align*}\nsubstituting $f_0(x)+\\mu(f)$ for $f(x)$ everywhere and $g_0(x)+\\mu(g)$ for $g(x)$ everywhere, and using the fact that $\\int_0^1 f_0(x)\\,dx = \\int_0^1 g_0(x)\\,dx = 0$, we can expand and simplify the right hand side of this equation to obtain\n\\begin{align*}\n&\\int_0^1 (f_0(x)^2g(x)^2+f(x)^2g_0(x)^2)\\,dx-\\Var(fg) \\\\\n&= \\int_0^1 f_0(x)^2g_0(x)^2\\,dx \\\\\n&-2\\mu(f)\\mu(g)\\int_0^1 f_0(x)g_0(x)\\,dx +(\\int_0^1 f_0(x)g_0(x)\\,dx)^2 \\\\\n&\\geq -2\\mu(f)\\mu(g)\\int_0^1 f_0(x)g_0(x)\\,dx.\n\\end{align*}\nBecause of \\eqref{eq:1}, it thus suffices to show that\n\\begin{equation}\n2\\mu(f)\\mu(g)\\int_0^1 f_0(x)g_0(x)\\,dx\n\\label{eq:3} \\leq \\Var(f)M(g)^2+\\Var(g)M(f)^2.\n\\end{equation}\nNow since $(\\mu(g) f_0(x)-\\mu(f) g_0(x))^2 \\geq 0$ for all $x$, we have\n\\begin{align*}\n2\\mu(f)\\mu(g) \\int_0^1 f_0(x)g_0(x)\\,dx\n& \\leq \\int_0^1 (\\mu(g)^2 f_0(x)^2 + \\mu(f)^2 g_0(x)^2) dx \\\\\n& = \\Var(f) \\mu(g)^2 + \\Var(g) \\mu(f)^2 \\\\\n& \\leq \\Var(f) M(g)^2 + \\Var(g) M(f)^2,\n\\end{align*}\nestablishing \\eqref{eq:3} and completing the proof.", "category": "Algebra", "source": "PUTNAM", "year": 2013}
{"id": "putnam-2013-b5", "question": "Let $X = \\{1, 2, \\dots, n\\}$, and let $k \\in X$. Show that there are exactly $k \\cdot n^{n-1}$ functions $f: X \\to X$ such that for every $x \\in X$ there is a $j \\geq 0$ such that $f^{(j)}(x) \\leq k$.\n[Here $f^{(j)}$ denotes the $j$\\textsuperscript{th} iterate of $f$, so that $f^{(0)}(x) = x$ and $f^{(j+1)}(x) = f(f^{(j)}(x))$.]", "solution": "\\setcounter{lemma}{0}\n\\textbf{First solution:}\nWe assume $n \\geq 1$ unless otherwise specified.\nFor $T$ a set and $S_1, S_2$ two subsets of $T$, we say that a function $f: T \\to T$ \\emph{iterates $S_1$ into $S_2$} if for each $x \\in S_1$, there is a $j \\geq 0$ such that $f^{(j)}(x) \\in S_2$.\n\n\\begin{lemma}\nFix $k \\in X$. Let $f,g: X \\to X$ be two functions such that $f$ iterates $X$ into $\\{1,\\dots,k\\}$ and $f(x) = g(x)$ for $x \\in \\{k+1,\\dots,n\\}$. Then $g$ also iterates $X$ into $\\{1,\\dots,k\\}$.\n\\end{lemma}\n\\begin{proof}\nFor $x \\in X$, by hypothesis there exists a nonnegative integer $j$ such that $f^{(j)}(x) \\in \\{1,\\dots,k\\}$. Choose the integer $j$ as small as possible; then $f^{(i)}(x) \\in \\{k+1,\\dots,n\\}$ for $0 \\leq i<j$. By induction on $i$, we have $f^{(i)}(x) = g^{(i)}(x)$ for $i=0,\\dots,j$, so in particular $g^{(j)}(x) \\in \\{1,\\dots,k\\}$. This proves the claim.\n\\end{proof}\n\nWe proceed by induction on $n-k$, the case $n-k=0$ being trivial.\nFor the induction step, we need only confirm that the number $x$ of functions $f: X \\to X$ which iterate $X$ into $\\{1,\\dots,k+1\\}$ but not into $\\{1,\\dots,k\\}$ is equal to $n^{n-1}$. These are precisely the functions for which there is a unique cycle $C$ containing only numbers in $\\{k+1,\\dots,n\\}$ and said cycle contains $k+1$. Suppose $C$ has length $\\ell \\in \\{1,\\dots,n-k\\}$. For a fixed choice of $\\ell$, we may choose the underlying set of $C$ in\n$\\binom{n-k-1}{\\ell-1}$ ways and the cycle structure in $(\\ell-1)!$ ways. Given $C$, the functions $f$ we want are the ones that act on $C$ as specified and iterate $X$ into\n$\\{1,\\dots,k\\} \\cup C$.\nBy Lemma~1, the number of such functions is\n$n^{-\\ell}$ times the total number of functions that iterate $X$ into\n$\\{1,\\dots,k\\} \\cup C$.\nBy the induction hypothesis,\nwe compute the number of functions  which iterate $X$ into $\\{1,\\dots,k+1\\}$ but not into $\\{1,\\dots,k\\}$ to be\n\\[\n\\sum_{\\ell=1}^{n-k} (n-k-1)\\cdots(n-k-\\ell+1)\n(k+\\ell) n^{n-\\ell-1}\n\\]\nBy rewriting this as a telescoping sum, we get\n\\begin{align*}\n&\\sum_{\\ell=1}^{n-k} (n-k-1)\\cdots(n-k-\\ell+1)\n(n) n^{n-\\ell-1} \\\\\n&- \\sum_{\\ell=1}^{n-k} (n-k-1)\\cdots(n-k-\\ell+1)\n(n-k-\\ell) n^{n-\\ell-1} \\\\\n&=\\sum_{\\ell=0}^{n-k-1} (n-k-1)\\cdots(n-k-\\ell) n^{n-\\ell-1} \\\\\n&- \\sum_{\\ell=1}^{n-k} (n-k-1)\\cdots\n(n-k-\\ell) n^{n-\\ell-1} \\\\\n&= n^{n-1}.\n\\end{align*}\nas desired.\n\n\\textbf{Second solution:}\nFor $T$ a set, $f: T \\to T$ a function, and $S$ a subset of $T$,\nwe define the \\emph{contraction} of $f$ at $S$ as the function $g: \\{* \\} \\cup (T-S) \\to \\{*\\}  \\cup (T-S)$\ngiven by\n\\[\ng(x) = \\begin{cases} * & x = *  \\\\\n* & x \\neq *, f(x) \\in S \\\\\nf(x) & x \\neq *, f(x) \\notin S.\n\\end{cases}\n\\]\n\\begin{lemma}\nFor $S \\subseteq X$ of cardinality $\\ell \\geq 0$,\nthere are $\\ell n^{n-\\ell-1}$ functions $f: \\{*\\} \\cup X \\to \\{*\\} \\cup X$ with $f^{-1}(*) = \\{*\\} \\cup S$\nwhich iterate $X$ into $\\{*\\}$.\n\\end{lemma}\n\\begin{proof}\nWe induct on $n$. If $\\ell = n$ then there is nothing to check.\nOtherwise, put $T = f^{-1}(S)$, which must be nonempty.\nThe contraction $g$ of $f$ at $\\{*\\} \\cup S$ is then a function on $\\{*\\} \\cup (X-S)$ with $f^{-1}(*) = \\{*\\} \\cup T$ which iterates $X-S$ into $\\{*\\}$. Moreover, for given $T$, each such $g$ arises from\n$\\ell^{\\# T}$ functions of the desired form.\nSumming over $T$ and invoking the induction hypothesis, we see that the number of functions $f$ is \n\\begin{align*}\n&\\sum_{k=1}^{n-\\ell} \\binom{n-\\ell}{k} \\ell^k \\cdot k (n-\\ell)^{n-\\ell-k-1} \\\\\n&=\\sum_{k=1}^{n-\\ell} \\binom{n-\\ell-1}{k-1} \\ell^k (n-\\ell)^{n-\\ell-k} \n= \\ell n^{n-\\ell-1}\n\\end{align*}\nas claimed.\n\\end{proof}\n\nWe now count functions $f: X \\to X$ which iterate $X$ into $\\{1,\\dots,k\\}$ as follows. By Lemma~1 of the first solution, this count equals $n^k$ times the number of functions with $f(1) = \\cdots = f(k) = 1$  which iterate $X$ into $\\{1,\\dots,k\\}$. For such a function $f$, put $S = \\{k+1,\\dots,n\\} \\cap f^{-1}(\\{1,\\dots,k\\})$ and let $g$ be the contraction of $f$\nat $\\{1,\\dots,k\\}$; then $g^{-1}(*) = * \\cup \\{S\\}$ and $g$ iterates \nits domain into $*$. By Lemma~2, for $\\ell = \\#S$, there are\n$\\ell (n-k)^{n-k-\\ell-1}$ such functions $g$.\nFor given $S$, each such $g$ gives rise to $k^{\\ell}$ functions $f$ with $f(1) = \\cdots = f(k) = 1$  which iterate $X$ into $\\{1,\\dots,k\\}$.\nThus the number of such functions $f$ is\n\\begin{align*}\n&\\sum_{\\ell=0}^{n-k} \\binom{n-k}{\\ell} k^{\\ell} \\ell (n-k)^{n-k-\\ell-1} \\\\\n&= \\sum_{\\ell=0}^{n-k} \\binom{n-k-1}{\\ell-1} k^{\\ell} (n-k)^{n-k-\\ell}\\\\\n&= k n^{n-k-1}.\n\\end{align*}\nThe desired count is this times $n^k$, or $k n^{n-1}$ as desired.\n\n\\textbf{Remark:}\nFunctions of the sort counted in Lemma~2 can be identified with rooted trees on the vertex set $\\{*\\} \\cup X$ with root $*$. Such trees can be counted using \\emph{Cayley's formula}, a special case of \\emph{Kirchoff's matrix tree theorem}. The matrix tree theorem can also be used to show directly that the number of rooted forests on $n$ vertices with $k$ fixed roots is $k n^{n-k-1}$; the desired count follows immediately from this formula plus Lemma~1. (One can also use Pr\\\"ufer sequences for a more combinatorial interpretation.)", "category": "Combinatorics", "source": "PUTNAM", "year": 2013}
{"id": "putnam-2013-b6", "question": "Let $n \\geq 1$ be an odd integer. Alice and Bob play the following game,\ntaking alternating turns, with Alice playing first. \nThe playing area consists of $n$ spaces, arranged in a line.\nInitially all spaces are empty.\nAt each turn, a player either\n\\begin{itemize}", "solution": "We show that the only winning first move for Alice is to place a stone in the central space. We start with some terminology.\n\n%Divide the playing area into the \\emph{left half}, the \\emph{central %space}, and the \\emph{right half}.\nBy a \\emph{block} of stones, we mean a (possibly empty) sequence of stones occupying consecutive spaces. By the \\emph{extremal blocks}, we mean the (possibly empty) maximal blocks adjacent to the left and right ends of the playing area.\n\nWe refer to a legal move consisting of placing a stone in an empty space as a move of \\emph{type 1}, and any other legal move as being of \\emph{type 2}.\nFor $i=0,\\dots,n$, let $P_i$ be the collection of positions containing $i$ stones. Define the \\emph{end zone} as the union $Z = P_{n-1} \\cup P_n$. In this language, we make the following observations.\n\\begin{itemize}", "category": "Combinatorics", "source": "PUTNAM", "year": 2013}
{"id": "tst-2018-q1", "question": "Let $n \\ge 2$ be a positive integer,\nand let $\\sigma(n)$ denote the sum of the positive divisors of $n$.\nProve that the $n$\\textsuperscript{th} smallest positive integer\nrelatively prime to $n$ is at least $\\sigma(n)$,\nand determine for which $n$ equality holds.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p9513094}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n \\ge 2$ be a positive integer,\nand let $\\sigma(n)$ denote the sum of the positive divisors of $n$.\nProve that the $n$\\textsuperscript{th} smallest positive integer\nrelatively prime to $n$ is at least $\\sigma(n)$,\nand determine for which $n$ equality holds.\n\\end{mdframed}\nThe equality case is $n = p^e$ for\n$p$ prime and a positive integer $e$.\nIt is easy to check that this works.\n\n\\bigskip\n\n\\paragraph{First solution.}\nIn what follows, by $[a,b]$ we mean $\\{a,a+1,\\dots,b\\}$.\nFirst, we make the following easy observation.\n\\begin{claim*}\n  If $a$ and $d$ are positive integers,\n  then precisely $\\varphi(d)$ elements\n  of $[a, a + d - 1]$ are relatively prime to $d$.\n\\end{claim*}\n\nLet $d_1$, $d_2$, \\dots, $d_k$ denote\ndenote the divisors of $n$ in some order.\nConsider the intervals\n\\begin{align*}\n  I_1 &= [1, d_1], \\\\\n  I_2 &= [d_1+1, d_1+d_2] \\\\\n  &\\vdotswithin= \\\\\n  I_k &= [d_1+\\dots+d_{k-1}+1, d_1+\\dots+d_k].\n\\end{align*}\nof length $d_1, \\dots, d_k$ respectively.\nThe $j$th interval will have exactly $\\varphi(d_j)$ elements\nwhich are relatively prime $d_j$,\nhence at most $\\varphi(d_j)$ which are relatively prime to $n$.\nConsequently, in $I = \\bigcup_{j=1}^k I_k$\nthere are at most\n\\[ \\sum_{j=1}^k \\varphi(d_j) = \\sum_{d \\mid n} \\varphi(d) = n \\]\nintegers relatively prime to $n$.\nOn the other hand $I = [1,\\sigma(n)]$ so this implies the inequality.\n\nWe see that the equality holds for $n = p^e$.\nAssume now $p < q$ are distinct primes dividing $n$.\nReorder the divisors $d_i$ so that $d_1 = q$.\nThen $p,q \\in I_1$, and so $I_1$ should contain\nstrictly fewer than $\\varphi(d_1)=q-1$ elements\nrelatively prime to $n$, hence the inequality is strict.\n\n\\paragraph{Second solution (Ivan Borsenco and Evan Chen).}\nLet $n = p_1^{e_1} \\dots p_k^{e_k}$,\nwhere $p_1 < p_2 < \\dots$.\nWe are going to assume $k \\ge 2$,\nsince the $k=1$ case was resolved in the very beginning,\nand prove the strict inequality.\n\nFor a general $N$, the number of relatively prime integers in $[1,N]$ is\ngiven exactly by\n\\[ f(N) = N - \\sum_i \\left\\lfloor \\frac{N}{p_i} \\right\\rfloor\n  + \\sum_{i<j} \\left\\lfloor \\frac{N}{p_i p_j} \\right\\rfloor - \\dots \\]\naccording to the inclusion-exclusion principle.\nSo, we wish to show that $f(\\sigma(n)) < n$ (as $k \\ge 2$).\nDiscarding the error terms from the floors\n(noting that we get at most $1$ from the negative floors)\ngives\n\\begin{align*}\n  f(N) &< 2^{k-1} + N - \\sum_i \\frac{N}{p_i}\n    + \\sum_{i<j} \\frac{N}{p_i p_j} - \\dots \\\\\n  &= 2^{k-1} + N \\prod_i \\left( 1 - p_i\\inv \\right) \\\\\n  &= 2^{k-1} + \\prod_i \\left( 1 - p_i\\inv \\right)\n    \\left( 1 + p_i + p_i^2 + \\dots + p_i^{e_i} \\right) \\\\\n  &= 2^{k-1} + \\prod_i \\left( p_i^{e_i} - p_i\\inv \\right).\n\\end{align*}\nThe proof is now divided into two cases.\nIf $k=2$ we have\n\\begin{align*}\n  f(N) &< 2 + \\left( p_1^{e_1} - p_1\\inv \\right)\\left( p_2^{e_2} -\n  p_2\\inv \\right) \\\\\n  &= 2 + n - \\frac{p_2^{e_2}}{p_1} - \\frac{p_1^{e_1}}{p_2}\n    + \\frac{1}{p_1p_2} \\\\\n  &\\le 2 + n - \\frac{p_2}{p_1} - \\frac{p_1}{p_2}\n    + \\frac{1}{p_1p_2} \\\\\n  &= n + \\frac{1-(p_1-p_2)^2}{p_1p_2} \\le n.\n\\end{align*}\nOn the other hand if $k \\ge 3$ we may now write\n\\begin{align*}\n  f(N) &< 2^{k-1} + \\left[ \\prod_{i=2}^{k-1} \\left( p_i^{e_i} \\right)\n    \\right] \\left( p_1^{e_1} - p_1\\inv \\right) \\\\\n  &= 2^{k-1} + n - \\frac{p_2^{e_2} \\dots p_k^{e_k}}{p_1} \\\\\n  &\\le 2^{k-1} + n - \\frac{p_2 p_3 \\dots p_k}{p_1}.\n\\end{align*}\nIf $p_1 = 2$, then one can show\nby induction that $p_2 p_3 \\dots p_k \\ge 2^{k+1}-1$,\nwhich implies the result.\nIf $p_1 > 2$, then one can again show by induction\n$p_3 \\dots p_k \\ge 2^k-1$ (since $p_3 \\ge 7$),\nwhich also implies the result.\n\\pagebreak", "category": "Number Theory", "source": "TST", "year": 2018}
{"id": "tst-2018-q2", "question": "Find all functions $f \\colon \\ZZ^2 \\to [0,1]$\nsuch that for any integers $x$ and $y$,\n\\[ f(x, y) = \\frac{f(x-1, y) + f(x, y-1)}{2}. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p9513099}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all functions $f \\colon \\ZZ^2 \\to [0,1]$\nsuch that for any integers $x$ and $y$,\n\\[ f(x, y) = \\frac{f(x-1, y) + f(x, y-1)}{2}. \\]\n\\end{mdframed}\nWe claim that the only functions $f$ are constant functions.\n(It is easy to see that they work.)\n\n\\paragraph{First solution (hands-on).}\nFirst, iterating the functional equation\nrelation to the $n$th level shows that\n\\[ f(x, y) = \\frac{1}{2^n} \\sum_{i=0}^n \\binom{n}{i} f(x-i, y-(n-i)). \\]\nIn particular,\n\\begin{align*}\n  |f(x, y) - f(x-1, y+1)|\n  &= \\frac{1}{2^n} \\left\\lvert \\sum_{i=0}^{n+1} f(x-i, y-(n-i)) \\cdot\n  \\left(\\binom{n}{i} - \\binom{n}{i-1} \\right) \\right\\rvert \\\\\n  &\\le \\frac{1}{2^n} \\sum_{i=0}^{n+1} \\left\\lvert\n    \\binom{n}{i} - \\binom{n}{i-1} \\right\\rvert \\\\\n  &= \\frac{1}{2^n} \\cdot 2\\binom{n}{\\lfloor n/2 \\rfloor}\n\\end{align*}\nwhere we define $\\binom{n}{n+1} = \\binom{n}{-1} = 0$ for convenience.\nSince \\[ \\binom{n}{\\lfloor n/2 \\rfloor} = o(2^n) \\]\nit follows that $f$ must be constant.\n\n\\begin{remark*}\nA very similar proof extends to $d$ dimensions.\n\\end{remark*}\n\n\\paragraph{Second solution (random walks, Mark Sellke).}\nWe show that if $x+y=x'+y'$ then $f(x,y)=f(x',y')$.\nLet $Z_n$, $Z'_n$ be random walks starting at $(x,y)$\nand $(x',y')$ and moving down/left.\nThen $f(Z_n)$ is a martingale so we have\n\\[\\mathbb E[f(Z_n)]=f(x,y), \\qquad\n  \\mathbb E[f(Z'_n)]=f(x',y') .\\]\nWe'll take $Z_n$, $Z'_n$ to be independent until they hit each other,\nafter which they will stay together.  Then\n\\[|\\mathbb E[f(Z_n)-f(Z'_n)]| \\leq \\mathbb E[|f(Z_n)-f(Z'_n)|]\n  \\leq p_n\\]\nwhere $p_n$ is the probability that $Z_n$, $Z'_n$ never collide.\nBut the distance between $Z_n$, $Z'_n$\nis essentially a $1$-dimensional random walk,\nso they will collide with probability $1$, meaning $\\lim_{n\\to\\infty} p_n=0$.\nHence\n\\[ |f(x,y)-f(x',y')| = |\\mathbb E[f(Z_n)-f(Z'_n)]| = o(1)\\]\nas desired.\n\n\\begin{remark*}\nIf the problem were in $\\ZZ^d$ for large $d$,\nthis solution wouldn't work as written\nbecause the independent random walks wouldn't hit each other.\nHowever, this isn't a serious problem\nbecause $Z_n$, $Z'_n$ don't have to be independent\nbefore hitting each other.\nIndeed, if every time $Z_n,Z'_n$ agree on a new coordinate\nwe force them to agree on that coordinate forever,\nwe can make the two walks individually have the distribution\nof a coordinate-decreasing random walk but make them intersect\neventually with probability $1$.\nThe difference in each coordinate will be a $1$-dimensional\nrandom walk which gets stuck at $0$.\n\\end{remark*}\n\n\n\\paragraph{Third solution (martingales).}\nImagine starting at $(x, y)$\nand taking a random walk down and to the left.\nThis is a martingale.\nAs $f$ is bounded, this martingale converges with probability $1$.\nLet $X_1, X_2, \\dots$ each be random variables\nthat represent either down moves or left moves with equal probability.\nNote that by the Hewitt-Savage 0-1 law,\nwe have that for any real numbers $a < b$,\n\\[ \\Pr\\left[ \\lim_{n \\to \\infty} f((x, y)+X_1+X_2+\\dots + X_n)\n  \\in [a, b] \\right] \\in \\{0,1\\}. \\]\nHence, there exists a single value $v$ such that with probability $1$,\n\\[ \\Pr\\left[\\lim_{n \\to \\infty} f((x, y)+X_1+X_2+\\dots + X_n)\n  = v\\right] = 1. \\]\nObviously, this value $v$ must equal $f(x, y)$.\nNow, we show this value $v$ is the same for all $(x, y)$.\nNote that any two starting points have a positive chance of meeting.\nTherefore, we are done.\n\\pagebreak", "category": "Combinatorics", "source": "TST", "year": 2018}
{"id": "tst-2018-q3", "question": "At a university dinner,\nthere are $2017$ mathematicians who each order two distinct entr\\'ees,\nwith no two mathematicians ordering the same pair of entr\\'{e}es.\nThe cost of each entr\\'ee is equal\nto the number of mathematicians who ordered it,\nand the university pays for each mathematician's\nless expensive entr\\'ee (ties broken arbitrarily).\nOver all possible sets of orders,\nwhat is the maximum total amount the university could have paid?", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p9513105}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nAt a university dinner,\nthere are $2017$ mathematicians who each order two distinct entr\\'ees,\nwith no two mathematicians ordering the same pair of entr\\'{e}es.\nThe cost of each entr\\'ee is equal\nto the number of mathematicians who ordered it,\nand the university pays for each mathematician's\nless expensive entr\\'ee (ties broken arbitrarily).\nOver all possible sets of orders,\nwhat is the maximum total amount the university could have paid?\n\\end{mdframed}\nIn graph theoretic terms:\nwe wish to determine the maximum possible value of\n\\[ S(G) \\coloneq \\sum_{e = vw} \\min \\left( \\deg v, \\deg w \\right) \\]\nacross all graphs $G$ with $2017$ edges.\nFor each edge $e = vw$, we refer to $\\min \\left( \\deg v, \\deg w \\right)$ as the label.\n\nWe claim the answer is $63 \\cdot \\binom{64}{2} + 1 = 127009$.\n\n\\paragraph{First solution (combinatorial, Evan Chen).}\nFirst define $L_k$ to consist of a clique on $k$ vertices,\nplus a single vertex connected to exactly one vertex of the clique.\nHence $L_k$ has $k+1$ vertices, $\\binom k2+1$ edges,\nand $S(L_k) = (k-1) \\binom k2 + 1$.\nIn particular, $L_{64}$ achieves the claimed maximum,\nso it suffices to prove the upper bound.\n\n\\begin{lemma*}\n  Let $G$ be a graph such that either\n  \\begin{itemize}\n    \\ii $G$ has $\\binom k2$ edges for some $k \\ge 3$ or\n    \\ii $G$ has $\\binom k2 + 1$ edges for some $k \\ge 4$.\n  \\end{itemize}\n  Then there exists a graph $G^\\ast$ with the same number of edges\n  such that $S(G^\\ast) \\ge S(G)$, and moreover $G^\\ast$ has a universal vertex\n  (i.e.\\ a vertex adjacent to every other vertex).\n\\end{lemma*}\n\n\\begin{proof}\n  Fix $k$ and the number $m$ of edges.\n  We prove the result by induction on the number $n$ of vertices in $G$.\n  Since the lemma has two parts,\n  we will need two different base cases:\n  \\begin{enumerate}\n    \\item Suppose $n = k$ and $m = \\binom k2$.\n    Then $G$ must be a clique so pick $G^\\ast = G$.\n\n    \\item Suppose $n = k+1$ and $m = \\binom k2 + 1$.\n    If $G$ has no universal vertex, we claim we may take $G^\\ast = L_k$.\n    Indeed each vertex of $G$ has degree at most $k-1$, and the average degree is\n    \\[ \\frac{2m}{n} = \\frac{k^2-k+2}{k+1} < k-1 \\]\n    using here $k \\ge 4$.\n    Thus there exists a vertex $w$ of degree $1 \\le d \\le k-2$.\n    The edges touching $w$ will have label at most $d$ and hence\n    \\begin{align*}\n       S(G) &\\le (k-1)(m-d) + d^2 = (k-1)m - d(k-1-d) \\\\\n       &\\le (k-1)m - (k-2) = (k-1) \\binom k2 + 1 = S(G^\\ast).\n    \\end{align*}\n  \\end{enumerate}\n  Now we settle the inductive step.\n  Let $w$ be a vertex with minimal degree $0 \\le d < k-1$, with neighbors $w_1$, \\dots, $w_d$.\n  By our assumption, for each $w_i$ there exists a vertex $v_i$ for which $v_i w_i \\notin E$.\n  Now, we may delete all edges $ww_i$ and in their place put $v_i w_i$,\n  and then delete the vertex $w$.\n  This gives a graph $G'$, possibly with multiple edges\n  (if $v_i = w_j$ and $w_j = v_i$), and with one fewer vertex.\n\n  \\begin{center}\n  \\begin{asy}\n    defaultpen(fontsize(11pt));\n    unitsize(1cm);\n\n    dotfactor *= 1.5;\n    pair A = (-1,1);\n    pair B = (0,1);\n    pair X = (-1,0);\n    pair Y = (0,0);\n    pair Z = (1,0);\n    pair W = (0,-1);\n\n    picture[] Gs = new picture[3];\n    Gs[0] = new picture;\n    Gs[1] = new picture;\n    Gs[2] = new picture;\n\n\n    draw(Gs[0], W--X, red);\n    draw(Gs[0], W--Y, red);\n    draw(Gs[0], W--Z, red);\n\n    draw(Gs[1], X--B, red);\n    draw(Gs[1], Y..(0.5, 0.2)..Z, red);\n    draw(Gs[1], Y..(0.5,-0.2)..Z, red);\n\n    draw(Gs[2], X--B, red);\n    draw(Gs[2], Y..(0.5,-0.2)..Z, red);\n    draw(Gs[2], A--Y, blue);\n\n    for (int i=0; i<3; ++i) {\n      dot(Gs[i], A);\n      dot(Gs[i], B);\n      dot(Gs[i], X);\n      dot(Gs[i], Y);\n      dot(Gs[i], Z);\n      draw(Gs[i], A--B--Z--A--X--Y--B);\n    }\n    dot(Gs[0], \"$w$\", W, dir(-90));\n\n    label(Gs[0], \"$G$\", B, 2*dir(90));\n    label(Gs[1], \"$G'$\", B, 2*dir(90));\n    label(Gs[2], \"$G''$\", B, 2*dir(90));\n\n    add(shift(-3,0) * Gs[0]);\n    add(shift(0,0) * Gs[1]);\n    add(shift(3,0) * Gs[2]);\n  \\end{asy}\n  \\end{center}\n\n  We then construct a graph $G''$ by taking any pair of double edges,\n  deleting one of them, and adding any missing edge of $G''$ in its place.\n  (This is always possible, since when $m = \\binom k2$ we have $n-1 \\ge k$\n  and when $m = \\binom k2 +1$ we have $n-1 \\ge k+1$.)\n\n  Thus we have arrived at a simple graph $G''$ with one fewer vertex.\n  We also observe that we have $S(G'') \\ge S(G)$;\n  after all every vertex in $G''$ has degree at least as large as it did in $G$,\n  and the $d$ edges we deleted have been replaced with\n  new edges which will have labels at least $d$.\n  Hence we may apply the inductive hypothesis to the graph $G''$\n  to obtain $G^\\ast$ with $S(G^\\ast) \\ge S(G'') \\ge S(G)$.\n\\end{proof}\n\nThe problem then is completed once we prove the following:\n\\begin{claim*}\n  For any graph $G$,\n  \\begin{itemize}\n    \\ii If $G$ has $\\binom k2$ edges for $k \\ge 3$,\n    then $S(G) \\le \\binom k2 \\cdot (k-1)$.\n    \\ii If $G$ has $\\binom k2 + 1$ edges for $k \\ge 4$,\n    then $S(G) \\le \\binom k2 \\cdot (k-1) + 1$.\n  \\end{itemize}\n\\end{claim*}\n\n\\begin{proof}\nWe prove both parts at once by induction on $k$,\nwith the base case $k = 3$ being plain\n(there is nothing to prove in the second part for $k=3$).\nThus assume $k \\ge 4$.\nBy the earlier lemma, we may assume $G$ has a universal vertex $v$.\nFor notational convenience, we say $G$ has $\\binom k2 + \\eps$ edges\nfor $\\eps \\in \\{0,1\\}$, and $G$ has $p+1$ vertices, where $p \\ge k-1 + \\eps$.\n\nLet $H$ be the subgraph obtained when $v$ is deleted.\nThen $m = \\binom k2 + \\eps - p$ is the number of edges in $H$;\nfrom $p \\ge k-1+\\eps$ we have $m \\le \\binom{k-1}{2}$\nand so we may apply the inductive hypothesis to $H$ to deduce\n$S(H) \\le \\binom{k-1}{2} \\cdot (k-2)$.\n\n\\begin{center}\n\\begin{asy}\ndefaultpen(fontsize(11pt));\nsize(4.5cm);\n\ndotfactor *= 1.5;\npair V = (0,2);\n\npair A = (-1.5,0);\npair B = (-1.0,0);\npair C = (+1.5,0);\n\nfor (real x=-1.5; x<=1.5; x+=0.5) {\n  draw(V--(x,0));\n}\nlabel(\"$\\dots$\", midpoint(B--C));\ndot(\"$w_1$\", A, dir(-90));\ndot(\"$w_2$\", B, dir(-90));\ndot(\"$w_p$\", C, dir(-90));\ndot(\"$v$\", V, dir(90), red);\n\n\nreal EX = 2;\nreal EY = 0.8;\ndraw(ellipse((0,0), EX, EY), dashed);\nlabel(\"$H$\", (EX, -EY));\n\\end{asy}\n\\end{center}\nNow the labels of edges $vw_i$ have sum\n\\[\n  \\sum_{i=1}^p \\min \\left( \\deg_G v, \\deg_G w_i \\right)\n  = \\sum_{i=1}^p \\deg_G w_i\n  = \\sum_{i=1}^p (\\deg_H w_i + 1) =  2m + p.\n\\]\nFor each of the edges contained in $H$,\nthe label on that edge has increased by exactly $1$,\nso those edges contribute $S(H)+m$.\nIn total,\n\\begin{align*}\n  S(G) &= 2m + p + \\left( S(H)+m \\right) = (m+p) + 2m + S(H) \\\\\n  &\\le \\binom k2 + \\eps + 2\\binom{k-1}{2} + \\binom{k-1}{2}(k-2)\n  = \\binom k2 (k-1) + \\eps. \\qedhere\n\\end{align*}\n\\end{proof}\n\n\\paragraph{Second solution (algebraic, submitted by contestant James Lin).}\nWe give a different proof of $S(G) \\le 127009$.\nThe proof proceeds using the following two claims,\nwhich will show that $S(G) \\le 127010$ for all graphs $G$.\nThen a careful analysis of the equality cases will show\nthat this bound is not achieved for any graph $G$.\nSince the example $L_{64}$ earlier has $S(L_{64}) = 127009$,\nthis will solve the problem.\n\n\\begin{lemma*}\n  [Combinatorial bound]\n  Let $G$ be a graph with $2017$ edges and let\n  $d_1 \\ge d_2 \\ge \\dots \\ge d_n$ be the degree sequence of the graph\n  (thus $n \\ge 65$).\n  Then \\[ S(G) \\le d_2 + 2d_3 + 3d_4 + \\dots + 63d_{64} + d_{65}. \\]\n\\end{lemma*}\n\\begin{proof}\n  Let $v_1$, \\dots, $v_n$ be the corresponding vertices.\n  For any edge $e = \\{v_i, v_j\\}$ with $i < j$,\n  we consider associating each edge $e$ with $v_j$,\n  and computing the sum $S(G)$ indexing over associated vertices.\n  To be precise, if we let $a_i$ denote the number of edges\n  associated to $v_i$, we now have $a_i \\le i-1$, $\\sum a_i = 2017$, and\n  \\[ S(G) = \\sum_{i=1}^n a_i d_i. \\]\n  The inequality\n  $\\sum a_i d_i \\le d_2 + 2d_3 + 3d_4 + \\dots + 63d_{64} + d_{65}$\n  then follows for smoothing reasons\n  (by ``smoothing'' the $a_i$), since the $d_i$ are monotone.\n  This proves the given inequality.\n\\end{proof}\n\nOnce we have this property, we handle the bounding completely algebraically.\n\\begin{lemma*}\n  [Algebraic bound]\n  Let $x_1 \\ge x_2 \\ge \\dots \\ge x_{65}$ be any nonnegative integers\n  such that $\\sum_{i=1}^{65} x_i \\le 4034$.\n  Then \\[ x_2 + 2x_3 + \\dots + 63x_{64} + x_{65} \\le 127010. \\]\n  Moreover, equality occurs if and only if\n  $x_1 = x_2 = x_3 = \\dots = x_{64} = 63$ and $x_{65} = 2$.\n\\end{lemma*}\n\\begin{proof}\n  Let $A$ denote the left-hand side of the inequality.\n  We begin with a smoothing argument.\n  \\begin{itemize}\n    \\ii Suppose there are indices $1 \\le i < j \\le 64$\n    such that $x_i > x_{i+1} \\ge x_{j-1} > x_j$.\n    Then replacing $(x_i, x_j)$ by $(x_i-1, x_j+1)$\n    strictly increases $A$ preserving all conditions.\n    Thus we may assume all numbers in $\\{x_1, \\dots, x_{64}\\}$\n    differ by at most $1$.\n    \\ii Suppose $x_{65} \\ge 4$.\n    Then we can replace $(x_1, x_2, x_3, x_4, x_{65})$\n    by $(x_1+1, x_2+1, x_3+1, x_4+1, x_{65}-4)$\n    and strictly increase $A$.\n    Hence we may assume $x_{65} \\le 3$.\n  \\end{itemize}\n  We will also tacitly assume $\\sum x_i = 4034$,\n  since otherwise we can increase $x_1$.\n  These two properties leave only four sequences to examine:\n  \\begin{itemize}\n    \\ii $x_1 = x_2 = x_3 = \\dots = x_{63} = 63$, $x_{64} = 62$,\n    and $x_{65} = 3$, which gives $A = 126948$.\n    \\ii $x_1 = x_2 = x_3 = \\dots = x_{63} = x_{64} = 63$ and $x_{65} = 2$,\n    which gives $A = 127010$.\n    \\ii $x_1 = 64$, $x_2 = x_3 = \\dots = x_{63} = x_{64} = 63$ and $x_{65} = 1$,\n    which gives $A = 127009$.\n    \\ii $x_1 = x_2 = 64$, $x_3 = \\dots = x_{63} = x_{64} = 63$ and $x_{65} = 0$,\n    which gives $A = 127009$.\n  \\end{itemize}\n  This proves that $A \\le 127010$.\n  To see that equality occurs only in the second case above,\n  note that all the smoothing operations other than incrementing $x_1$ were strict,\n  and that $x_1$ could not have been incremented in this way\n  as $x_1 = x_2 = 63$.\n\\end{proof}\n\nThis shows that $S(G) \\le 127010$ for all graphs $G$,\nso it remains to show equality never occurs.\nRetain the notation $d_i$ and $a_i$ of the combinatorial bound now;\nwe would need to have $d_1 = \\dots = d_{64} = 63$ and $d_{65} = 2$\n(in particular, deleting isolated vertices from $G$, we may assume $n=65$).\nIn that case, we have $a_i \\le i-1$ but also $a_{65} = 2$ by definition\n(the last vertex gets all edges associated to it).\nFinally,\n\\begin{align*}\n  S(G) &= \\sum_{i=1}^n a_i d_i = 63(a_1 + \\dots + a_{64}) + a_{65} \\\\\n  &= 63(2017-a_{65}) + a_{65} \\le 63 \\cdot 2015 + 2 = 126947\n\\end{align*}\ncompleting the proof.\n\n\\begin{remark*}\n  Another way to finish once $S(G) \\le 127010$\n  is note there is a unique graph\n  (up to isomorphism and deletion of universal vertices)\n  with degree sequence\n  $(d_1, \\dots, d_{65}) = (63, \\dots, 63, 2)$.\n  Indeed, the complement of the graph\n  has degree sequence $(1, \\dots, 1, 63)$,\n  and so it must be a $63$-star plus a single edge.\n  One can then compute $S(G)$ explicitly for this graph.\n\\end{remark*}\n\n\\paragraph{Some further remarks.}\n\n\\begin{remark*}\n  Interestingly, the graph $C_4$ has $\\binom 32+1 = 4$ edges\n  and $S(C_4) = 8$, while $S(L_3) = 7$.\n  This boundary case is visible in the combinatorial solution\n  in the base case of the first claim.\n  It also explains why we end up with the bound $S(G) \\le 127010$\n  in the second algebraic solution,\n  and why it is necessary to analyze the equality cases so carefully;\n  observe in $k=3$ the situation $d_1 = d_2 = d_3 = d_4 = 2$.\n\\end{remark*}\n\n\\begin{remark*}\n  Some comments about further context for this problem:\n  \\begin{itemize}\n  \\ii The obvious generalization of $2017$ to any constant\n  was resolved in September 2018 by Mehtaab Sawhney and Ashwin Sah.\n  The relevant paper is\n  \\emph{On the discrepancy between two Zagreb indices},\n  published in Discrete Mathematics, Volume 341, Issue 9, pages 2575-2589.\n  The arXiv link is \\url{https://arxiv.org/pdf/1801.02532.pdf}.\n\n  \\ii The quantity\n  \\[ S(G) = \\sum_{e = vw} \\min \\left( \\deg v, \\deg w \\right) \\]\n  in the problem has an interpretation:\n  it can be used to provide a bound on the\n  number of triangles in a graph $G$.\n  To be precise, $\\# E(G) \\le \\frac 13 S(G)$,\n  since an edge $e = vw$ is part of at most $\\min(\\deg v, \\deg w)$ triangles.\n\n  \\ii For \\emph{planar} graphs it is known $S(G) \\le 18n-36$\n  and it is conjectured that for $n$ large enough, $S(G) \\le 18n-72$.\n  See \\url{https://mathoverflow.net/a/273694/70654}.\n  \\end{itemize}\n\\end{remark*}\n\n\\paragraph{Authorship comments.}\nI came up with the quantity $S(G)$\nin a failed attempt to provide a bound on the number of triangles in a graph,\nsince this is natural to consider when you do a standard\ndouble-counting via the edges of the triangle.\nI think the problem was actually APMO 1989,\nand I ended up not solving the problem (the solution is much simpler),\nbut the quantity $S(G)$ stuck in my head for a while after that.\n\nLater on that month I was keeping Danielle company while\nshe was working on art project (flower necklace),\nand with not much to do except doodle on tables\nI began thinking about $S(G)$ again.\nI did have the sense that $S(G)$ should be maximized\nat a graph close to a complete graph.\nBut to my frustration I could not prove it for a long time.\nFinally after many hours of trying various approaches\nI was able to at least show that $S(G)$ was maximized\nfor complete graphs if the number of edges was a triangular number.\n\nI had come up with this in March 2016,\nwhich would have been perfect since $2016$ is a triangular number,\nbut it was too late to submit it to any contest\n(the USAMO and IMO deadlines were long past).\nSo on December 31, 2016 I finally sat down and solved it for the case $2017$,\nwhich took another few hours of thought, then submitted it to that year's IMO.\nTo my dismay it was rejected, but I passed it along to the USA TST after that,\nthus making it just in time for the close of the calendar year.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Combinatorics", "source": "TST", "year": 2018}
{"id": "tst-2018-q4", "question": "Let $n$ be a positive integer and let $S \\subseteq \\{0,1\\}^n$\nbe a set of binary strings of length $n$.\nGiven an odd number $x_1, \\dots, x_{2k+1} \\in S$ of binary strings\n(not necessarily distinct), their \\emph{majority} is defined as\nthe binary string $y \\in \\{0,1\\}^n$ for which\nthe $i$\\textsuperscript{th} bit of $y$ is the most common bit\namong the $i$\\textsuperscript{th} bits of $x_1$, \\dots, $x_{2k+1}$.\n(For example, if $n=4$ the majority of\n$0000$, $0000$, $1101$, $1100$, $0101$ is $0100$.)\n\nSuppose that for some positive integer $k$,\n$S$ has the property $P_k$ that the majority of any $2k+1$\nbinary strings in $S$ (possibly with repetition) is also in $S$.\nProve that $S$ has the same property $P_k$ for all\npositive integers $k$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p9735607}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n$ be a positive integer and let $S \\subseteq \\{0,1\\}^n$\nbe a set of binary strings of length $n$.\nGiven an odd number $x_1, \\dots, x_{2k+1} \\in S$ of binary strings\n(not necessarily distinct), their \\emph{majority} is defined as\nthe binary string $y \\in \\{0,1\\}^n$ for which\nthe $i$\\textsuperscript{th} bit of $y$ is the most common bit\namong the $i$\\textsuperscript{th} bits of $x_1$, \\dots, $x_{2k+1}$.\n(For example, if $n=4$ the majority of\n$0000$, $0000$, $1101$, $1100$, $0101$ is $0100$.)\n\nSuppose that for some positive integer $k$,\n$S$ has the property $P_k$ that the majority of any $2k+1$\nbinary strings in $S$ (possibly with repetition) is also in $S$.\nProve that $S$ has the same property $P_k$ for all\npositive integers $k$.\n\\end{mdframed}\nLet $M$ denote the majority function (of any length).\n\n\\paragraph{First solution (induction).}\nWe prove all $P_k$ are equivalent by induction on $n \\ge 2$,\nwith the base case $n = 2$ being easy to check by hand.\n(The case $n=1$ is also vacuous; however,\nthe inductive step is not able to go from $n=1$ to $n=2$.)\n\nFor the inductive step, we proceed by contradiction;\nassume $S$ satisfies $P_{\\ell}$, but not $P_{k}$,\nso there exist $x_1, \\dots, x_{2k+1} \\in S$\nwhose majority $y = M(x_1, \\dots, x_k)$ is not in $S$.\nWe contend that:\n\\begin{claim*}\n  Let $y_i$ be the string which differs from $y$\n  only in the $i$\\ts{th} bit.\n  Then $y_i \\in S$.\n\\end{claim*}\n\\begin{proof}\n  For a string $s \\in S$\n  we let $\\hat s$ denote the string $s$ with the $i$\\ts{th} bit deleted\n  (hence with $n-1$ bits).\n  Now let \\[ T = \\left\\{ \\hat s \\mid s \\in S \\right\\}. \\]\n  Since $S$ satisfies $P_\\ell$, so does $T$;\n  thus by the induction hypothesis on $n$, $T$ satisfies $P_{k}$.\n\n  Consequently, $T \\ni M(\\hat{x}_1, \\dots, \\hat{x}_{2k+1}) = \\hat y$.\n  Thus there exists $s \\in S$ such that $\\hat s = \\hat y$.\n  This implies $s = y$ or $s = y_i$.\n  But since we assumed $y \\notin S$ it follows $y_i \\in S$ instead.\n\\end{proof}\n\nNow take any $2\\ell+1$ copies of the $y_i$, about equally often\n(i.e.\\ the number of times\nany two $y_i$ are taken differs by at most $1$).\nWe see the majority of these is $y$ itself, contradiction.\n\n\\paragraph{Second solution (circuit construction).}\nNote that $P_k \\implies P_1$ for any $k$, since\n\\[ M( \\underbrace{a,\\dots,a}_k, \\underbrace{b,\\dots,b}_k, c )\n  = M(a,b,c) \\]\nfor any $a$, $b$, $c$.\n\nWe will now prove $P_1 + P_k \\implies P_{k+1}$ for any $k$,\nwhich will prove the result.\nActually, we will show that the majority\nof any $2k+3$ strings $x_1$, \\dots, $x_{2k+3}$\ncan be expressed by $3$ and $(2k+1)$-majorities.\nWLOG assume that $M(x_1, \\dots, x_{2k+3}) = 0\\dots0$,\nand let $\\odot$ denote binary AND.\n\\begin{claim*}\n  We have $M(x_1, x_2, M(x_3, \\dots, x_{2k+3})) = x_1 \\odot x_2$.\n\\end{claim*}\n\\begin{proof}\n  Consider any particular bit.\n  The result is clear if the bits are equal.\n  Otherwise, if they differ,\n  the result follows from the original hypothesis that\n  $M(x_1, \\dots, x_{2k+3}) = 0\\dots0$\n  (removing two differing bits does not change the majority).\n\\end{proof}\nBy analogy we can construct any $x_i \\odot x_j$.\nFinally, note that\n\\[ M(x_1 \\odot x_2, x_2 \\odot x_3, \\dots,\n  x_{2k+1} \\odot x_{2k+2}) = 0\\dots0, \\]\nas desired. (Indeed, if we look at any index,\nthere were at most $k+1$ $1$'s in the $x_i$ strings,\nand hence there will be at most $k$ $1$'s among\n$x_i \\odot x_{i+1}$ for $i=1,\\dots,2k+1$.)\n\n\\begin{remark*}\n  The second solution can be interpreted in circuit language\n  as showing that all ``$2k+1$-majority gates'' are equivalent.\n  See also \\url{https://cstheory.stackexchange.com/a/21399/48303},\n  in which Valiant gives a probabilistic construction to prove\n  that one can construct $(2k+1)$-majority gates from a\n  \\emph{polynomial} number of $3$-majority gates.\n  No explicit construction is known for this.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "TST", "year": 2018}
{"id": "tst-2018-q5", "question": "Let $ABCD$ be a convex cyclic quadrilateral which is not a kite,\nbut whose diagonals are perpendicular and meet at $H$.\nDenote by $M$ and $N$ the midpoints of $\\ol{BC}$ and $\\ol{CD}$.\nRays $MH$ and $NH$ meet $\\ol{AD}$ and $\\ol{AB}$ at $S$ and $T$, respectively.\nProve there exists a point $E$, lying outside quadrilateral $ABCD$,\nsuch that\n\\begin{itemize}\n  \\ii ray $EH$ bisects both angles $\\angle BES$, $\\angle TED$, and\n  \\ii $\\angle BEN = \\angle MED$.\n\\end{itemize}", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p9735608}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABCD$ be a convex cyclic quadrilateral which is not a kite,\nbut whose diagonals are perpendicular and meet at $H$.\nDenote by $M$ and $N$ the midpoints of $\\ol{BC}$ and $\\ol{CD}$.\nRays $MH$ and $NH$ meet $\\ol{AD}$ and $\\ol{AB}$ at $S$ and $T$, respectively.\nProve there exists a point $E$, lying outside quadrilateral $ABCD$,\nsuch that\n\\begin{itemize}\n  \\ii ray $EH$ bisects both angles $\\angle BES$, $\\angle TED$, and\n  \\ii $\\angle BEN = \\angle MED$.\n\\end{itemize}\n\\end{mdframed}\nThe main claim is that $E$ is the\nintersection of $(ABCD)$ with the circle with diameter $\\ol{AH}$.\n\\begin{center}\n\\begin{asy}\nsize(10cm);\npair A = dir(100);\npair B = dir(190);\npair D = dir(-10);\npair F = -A;\npair H = foot(A, B, D);\npair E = foot(A, F, H);\npair C = -A+2*foot(origin, A, H);\n\nfilldraw(unitcircle, opacity(0.1)+lightcyan, lightblue);\ndraw(A--B--C--D--cycle, lightblue);\ndraw(A--B--F--D--cycle, lightblue);\ndraw(A--C, lightblue);\ndraw(B--D, lightblue);\npair M = midpoint(B--C);\npair N = midpoint(D--C);\npair S = foot(H, A, D);\npair T = foot(H, A, B);\ndraw(M--S, lightblue);\ndraw(N--T, lightblue);\n\nfilldraw(circumcircle(B, T, S), opacity(0.1)+yellow, orange);\n// pair Q = midpoint(A--H);\ndraw(H--F, lightblue);\npair P = midpoint(H--F);\nfilldraw(B--T--S--D--cycle, opacity(0.1)+yellow, orange+1);\n// draw(P--Q, blue);\ndraw(A--F, blue);\ndraw(circumcircle(E, B, M), lightgreen);\ndraw(circumcircle(E, D, N), lightgreen);\ndraw(H--E--A, orange);\ndraw(circumcircle(A, T, S), lightgreen);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$D$\", D, dir(D));\ndot(\"$F$\", F, dir(F));\ndot(\"$H$\", H, dir(H));\ndot(\"$E$\", E, dir(E));\ndot(\"$C$\", C, dir(C));\ndot(\"$M$\", M, dir(M));\ndot(\"$N$\", N, dir(N));\ndot(\"$S$\", S, dir(S));\ndot(\"$T$\", T, dir(T));\n// dot(\"$Q$\", Q, dir(200));\ndot(\"$P$\", P, dir(P));\n\n/* TSQ Source:\n\n!size(10cm);\nA = dir 100\nB = dir 190\nD = dir -10\nF = -A\nH = foot A B D\nE = foot A F H\nC = -A+2*foot origin A H\n\nunitcircle 0.1 lightcyan / lightblue\nA--B--C--D--cycle lightblue\nA--B--F--D--cycle lightblue\nA--C lightblue\nB--D lightblue\nM = midpoint B--C\nN = midpoint D--C\nS = foot H A D\nT = foot H A B\nM--S lightblue\nN--T lightblue\n\ncircumcircle B T S 0.1 yellow / orange\nQ = midpoint A--H R200\nH--F lightblue\nP = midpoint H--F\nB--T--S--D--cycle 0.1 yellow / orange+1\nP--Q blue\nA--F blue\ncircumcircle E B M lightgreen\ncircumcircle E D N lightgreen\nH--E--A orange\ncircumcircle A T S lightgreen\n\n*/\n\\end{asy}\n\\end{center}\n\nThe following observation can be quickly made\nwithout reference to $E$.\n\\begin{lemma*}\n  We have $\\angle HSA = \\angle HTA = 90\\dg$.\n  Consequently, quadrilateral $BTSD$ is cyclic.\n\\end{lemma*}\n\\begin{proof}\n  This is direct angle chasing.\n  In fact, $\\ol{HM}$ passes through the circumcenter of $\\triangle BHC$\n  and $\\triangle HAD \\sim \\triangle HCB$,\n  so $\\ol{HS}$ ought to be the altitude of $\\triangle HAD$.\n\\end{proof}\n\nFrom here it follows that $E$ is the Miquel point of\ncyclic quadrilateral $BTSD$.\nDefine $F$ to be the point diametrically opposite $A$,\nso that $E$, $H$, $F$ are collinear, $\\ol{CF} \\parallel \\ol{BD}$.\nBy now we already have\n\\[ \\dang BEH = \\dang BEF = \\dang BAF = \\dang CAD = \\dang HAS = \\dang HES \\]\nso $\\ol{EH}$ bisects $\\angle BES$, and $\\angle TED$.\nHence it only remains to show $\\angle BEM = \\angle NED$;\nwe present several proofs below.\n\n\\paragraph{First proof (original solution).}\nLet $P$ be the circumcenter of $BTSD$.\nThe properties of the Miquel point imply $P$ lies on\nthe common bisector $\\ol{EH}$ already,\nand it also lies on the perpendicular bisector of $\\ol{BD}$,\nhence it must be the midpoint of $\\ol{HF}$.\n\nWe now contend quadrilaterals $BMPS$ and $DNPT$ are cyclic.\nObviously $\\ol{MP}$ is the external angle bisector of $\\angle BMS$,\nand $PB = PS$, so $P$ is the arc midpoint of $(BMS)$.\nThe proof for $DNPT$ is analogous.\n\nIt remains to show $\\angle BEN = \\angle MED$,\nor equivalently $\\angle BEM = \\angle NED$.\nBy properties of Miquel point we have $E \\in (BMPS) \\cap (TPND)$, so\n\\[ \\dang BEM = \\dang BPM = \\dang PBD = \\dang BDP = \\dang NPD = \\dang NED \\]\nas desired.\n\n\\paragraph{Second proof (2011 G4).}\nBy 2011 G4, the circumcircle of $\\triangle EMN$\nis tangent to the circumcircle of $ABCD$.\nHence if we extend $\\ol{EM}$ and $\\ol{EN}$ to meet $(ABCD)$\nagain at $X$ and $Y$, we get $\\ol{XY} \\parallel \\ol{MN} \\parallel \\ol{BD}$.\nThus $\\dang BEM = \\dang BEX = \\dang YED = \\dang NED$.\n\n\\paragraph{Third proof (involutions, submitted by Daniel Liu).}\nLet $G = \\ol{BN} \\cap \\ol{MD}$ denote the centroid of $\\triangle BCD$,\nand note that it lies on $\\ol{EHF}$.\n\nNow consider the dual of Desargues involution theorem on complete\nquadrilateral $BMDNCG$ at point $E$.\nWe get\n\\[ (EB,ED), \\quad (EM,EN), \\quad (EC,EG) \\]\nform an involutive pairing.\n\nHowever, the bisector of $\\angle BED$, say $\\ell$,\nis also the angle bisector of $\\angle CEF$ (since $\\ol{CF} \\parallel \\ol{BD}$).\nSo the involution we found must coincide with reflection across $\\ell$.\nThis means $\\angle MEN$ is bisected by $\\ell$ as well, as desired.\n\n\\paragraph{Authorship comments.}\nThis diagram actually comes from the inverted\npicture in IMO 2014/3 (which I attended).\nI had heard for many years that one could\nsolve this problem quickly by inversion at $H$ afterwards.\nBut when I actually tried to do it during an OTIS class\nyears later, I ended up with the picture in the TST problem,\nand couldn't see why it was true!\nIn the process of trying to reconstruct this rumored solution,\nI ended up finding most of the properties\nthat ended up in the January TST problem\n(but were overkill for the original IMO problem).\n\nLet us make the equivalence explicit\nby deducing the IMO problem from our work.\n\nLet rays $EM$ and $EN$ meet the circumcircles of $\\triangle BHC$\nand $\\triangle BNC$ again at $X$ and $Y$, with $EM < EX$ and $EN < EY$.\nAs above we concluded $EM/EX = EN/EY$\nand so $\\ol{MN} \\parallel \\ol{XY} \\implies \\ol{XY} \\perp \\ol{AHC}$.\n\nNow consider an inversion at $H$ which swaps\n$B \\leftrightarrow D$ and $A \\leftrightarrow C$.\nThe point $E$ goes to $E^\\ast$ diametrically opposite $A$.\nPoints $X$ and $Y$ go to points on $X^\\ast \\in \\ol{AD}$ and $Y^\\ast \\in \\ol{AB}$.\nSince the reflection of $E$ across $\\ol{PX}$ is supposed to lie on $(BAE)$,\nit follows that the circumcenter of $\\triangle HX^\\ast E^\\ast$\nlies on $\\ol{AD}$.\nConsequently $X^\\ast$ plays the role of point ``$T$'' in the IMO problem.\nThen $Y^\\ast$ plays the role of point ``$S$'' in the IMO problem.\n\nNow the fact that $(HX^\\ast Y^\\ast)$ is tangent to $\\ol{BD}$\nis equivalent to $\\ol{XY} \\perp \\ol{AHC}$ which we already knew.\n\\pagebreak", "category": "Geometry", "source": "TST", "year": 2018}
{"id": "tst-2018-q6", "question": "Alice and Bob play a game.\nFirst, Alice secretly picks a finite set $S$\nof lattice points in the Cartesian plane.\nThen, for every line $\\ell$ in the plane\nwhich is horizontal, vertical, or has slope $+1$ or $-1$,\nshe tells Bob the number of points of $S$ that lie on $\\ell$.\nBob wins if he can then determine the set $S$.\n\nProve that if Alice picks $S$ to be of the form\n\\[ S = \\left\\{ (x,y) \\in \\ZZ^2 \\mid m \\le x^2+y^2 \\le n \\right\\} \\]\nfor some positive integers $m$ and $n$, then Bob can win.\n(Bob does not know in advance that $S$ is of this form.)", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p9735613}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nAlice and Bob play a game.\nFirst, Alice secretly picks a finite set $S$\nof lattice points in the Cartesian plane.\nThen, for every line $\\ell$ in the plane\nwhich is horizontal, vertical, or has slope $+1$ or $-1$,\nshe tells Bob the number of points of $S$ that lie on $\\ell$.\nBob wins if he can then determine the set $S$.\n\nProve that if Alice picks $S$ to be of the form\n\\[ S = \\left\\{ (x,y) \\in \\ZZ^2 \\mid m \\le x^2+y^2 \\le n \\right\\} \\]\nfor some positive integers $m$ and $n$, then Bob can win.\n(Bob does not know in advance that $S$ is of this form.)\n\\end{mdframed}\nClearly Bob can compute the number $N$ of points.\n\nThe main claim is that:\n\\begin{claim*}\n  Fix $m$ and $n$ as in the problem statement.\n  Among all sets $T \\subseteq \\ZZ^2$ with $N$ points,\n  the set $S$ is the \\emph{unique} one which maximizes the value of\n  \\[ F(T):=\\sum_{(x,y)\\in T} (x^2+y^2)(m+n-(x^2+y^2)).  \\]\n\\end{claim*}\n\\begin{proof}\n  Indeed, the different points in $T$ do not interact in this sum,\n  so we simply want the points $(x,y)$ with $x^2+y^2$\n  as close as possible to $\\frac{m+n}{2}$ which is exactly what $S$ does.\n\\end{proof}\nAs a result of this observation,\nit suffices to show that Bob has enough information to\ncompute $F(S)$ from the data given.\n(There is no issue with fixing $m$ and $n$,\nsince Bob can find an upper bound on the magnitude\nof the points and then check all pairs $(m,n)$ smaller than that.)\nThe idea is that he knows the full distribution of each of\n$X$, $Y$, $X+Y$, $X-Y$ and hence can compute sums\nover $T$ of any power of a single one of those linear functions.\nBy taking linear combinations we can hence compute $F(S)$.\n\nLet us make the relations explicit.\nFor ease of exposition we take $Z=(X,Y)$ to be a\nuniformly random point from the set $S$.\nThe information is precisely the individual distributions\nof $X$, $Y$, $X+Y$, and $X-Y$.\nNow compute\n\\begin{align*}\n  \\frac{F(S)}{N} &= \\mathbb E\\left[ (m+n)(X^2+Y^2) - (X^2+Y^2)^2 \\right] \\\\\n  &= (m+n) \\left( \\mathbb E[X^2] + \\mathbb E[Y^2] \\right)\n  - \\mathbb E[X^4] - \\mathbb E[Y^4] - 2 \\mathbb E[X^2 Y^2].\n\\end{align*}\nOn the other hand,\n\\[ \\mathbb E[X^2Y^2]\n  = \\frac{\\mathbb E[(X+Y)^4] + \\mathbb E[(X-Y)^4]\n  - 2\\mathbb E[X^4] - 2\\mathbb E[Y^4]}{12}. \\]\nThus we have written $F(S)$ in terms of the distributions\nof $X$, $Y$, $X-Y$, $X+Y$ which completes the proof.\n\n\\begin{remark*}[Mark Sellke]\n  \\begin{itemize}\n  \\ii This proof would have worked just as well if we\n  allowed arbitrary $[0,1]$-valued weights on points\n  with finitely many weights non-zero.\n  There is an obvious continuum generalization one\n  can make concerning the indicator function for an annulus.\n  It's a simpler but fun problem to characterize\n  when just the vertical/horizontal directions determine the distribution.\n  \\ii An obstruction to purely combinatorial arguments\n  is that if you take an octagon with points $(\\pm a,\\pm b)$\n  and $(\\pm b,\\pm a)$ then the two ways to pick every other point\n  (going around clockwise) are indistinguishable by Bob.\n  This at least shows that Bob's task is far from possible in general,\n  and hints at proving an inequality.\n  \\ii A related and more standard fact\n  (among a certain type of person)\n  is that given a probability distribution $\\mu$ on $\\RR^n$,\n  if I tell you the distribution of \\emph{all} $1$-dimensional\n  projections of $\\mu$, that determines $\\mu$ uniquely.\n  This works because this information gives me the Fourier transform $\\hat{\\mu}$,\n  and Fourier transforms are injective.\n\n  For the continuum version of this problem,\n  this connection gives a much larger family of counterexamples\n  to any proposed extension to arbitrary non-annular shapes.\n  Indeed, take a fast-decaying smooth function\n  $f \\colon \\RR^2 \\to \\RR$ which vanishes on the four lines\n  \\[ x=0, \\; y=0, \\; x+y=0, \\; x-y=0.\\]\n  Then the Fourier transform $\\hat f$ will have mean $0$\n  on each line $\\ell$ as in the problem statement.\n  Hence the positive and negative parts of $\\hat f$\n  will not be distinguishable by Bob.\n  \\end{itemize}\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Geometry", "source": "TST", "year": 2018}
{"id": "putnam-2009-a1", "question": "Let $f$ be a real-valued function on the plane such that for every\nsquare $ABCD$ in the plane, $f(A)+f(B)+f(C)+f(D)=0$. Does it follow that\n$f(P)=0$ for all points $P$ in the plane?", "solution": "Yes, it does follow. Let $P$ be any point in the plane. Let $ABCD$ be any square with center $P$.\nLet $E,F,G,H$ be the midpoints of the segments $AB, BC, CD, DA$, respectively. The function\n$f$ must satisfy the equations\n\\begin{align*}\n0 &= f(A) + f(B) + f(C) + f(D) \\\\\n0 &= f(E) + f(F) + f(G) + f(H) \\\\\n0 &= f(A) + f(E) + f(P) + f(H) \\\\\n0 &= f(B) + f(F) + f(P) + f(E) \\\\\n0 &= f(C) + f(G) + f(P) + f(F) \\\\\n0 &= f(D) + f(H) + f(P) + f(G).\n\\end{align*}\nIf we add the last four equations, then subtract the first equation and twice the second equation,\nwe obtain $0 = 4f(P)$, whence $f(P) = 0$.\n\n\\textbf{Remark.} Problem 1 of the 1996 Romanian IMO team selection exam asks the same\nquestion with squares replaced by regular polygons of any (fixed) number of vertices.", "category": "Algebra", "source": "PUTNAM", "year": 2009}
{"id": "putnam-2009-a2", "question": "Functions $f,g,h$ are differentiable on some open interval around $0$\nand satisfy the equations and initial conditions\n\\begin{gather*}\nf' = 2f^2gh+\\frac{1}{gh},\\quad f(0)=1, \\\\\ng'=fg^2h+\\frac{4}{fh}, \\quad g(0)=1, \\\\\nh'=3fgh^2+\\frac{1}{fg}, \\quad h(0)=1.\n\\end{gather*}\nFind an explicit formula for $f(x)$, valid in some open interval around $0$.", "solution": "Multiplying the first differential equation by $gh$, the second by $fh$,\nand the third by $fg$, and summing gives\n\\[\n(fgh)' = 6(fgh)^2+6.\n\\]\nWrite $k(x) = f(x)g(x)h(x)$; then $k' = 6k^2+6$ and $k(0) = 1$. One\nsolution for this differential equation with this initial condition is\n$k(x) = \\tan(6x+\\pi/4)$; by standard uniqueness, this must necessarily\nhold for $x$ in some open interval around $0$. Now the first given\nequation becomes\n\\begin{align*}\nf'/f &= 2k(x)+1/k(x) \\\\\n&= 2\\tan(6x+\\pi/4)+\\cot(6x+\\pi/4);\n\\end{align*}\nintegrating both sides gives\n\\[\n\\ln(f(x)) = \\frac{-2\\ln\\cos(6x+\\pi/4) + \\ln\\sin(6x+\\pi/4)}{6}+c,\n\\]\nwhence $f(x) = e^c\n\\left(\\frac{\\sin(6x+\\pi/4)}{\\cos^2(6x+\\pi/4)}\\right)^{1/6}$.\nSubstituting $f(0)=1$ gives $e^c = 2^{-1/12}$ and thus $f(x) = 2^{-1/12}\n\\left(\\frac{\\sin(6x+\\pi/4)}{\\cos^2(6x+\\pi/4)}\\right)^{1/6}$.\n\n\\textbf{Remark.} The answer can be put in alternate forms using\ntrigonometric identities. One particularly simple one is\n\\[\n f(x) = (\\sec 12x)^{1/12} (\\sec 12x + \\tan 12x)^{1/4}.\n\\]", "category": "Algebra", "source": "PUTNAM", "year": 2009}
{"id": "putnam-2009-a3", "question": "Let $d_n$ be the determinant of the $n \\times n$ matrix whose entries, from\nleft to right and then from top to bottom, are $\\cos 1, \\cos 2, \\dots, \\cos\nn^2$. (For example,\n\\[\n d_3 = \\left| \\begin{matrix} \\cos 1 & \\cos 2 & \\cos 3 \\\\\n               \\cos 4 & \\cos 5 & \\cos 6 \\\\\n\\cos 7 & \\cos 8 & \\cos 9\n              \\end{matrix} \\right|.\n\\]\nThe argument of $\\cos$ is always in radians, not degrees.) Evaluate\n$\\lim_{n\\to\\infty} d_n$.", "solution": "The limit is $0$; we will show this by checking that $d_n = 0$ for all $n \\geq 3$.\nStarting from the given matrix, add the third column to the first column; this does not change the\ndeterminant. However, thanks to the identity\n$\\cos x + \\cos y = 2 \\cos \\frac{x+y}{2} \\cos \\frac{x-y}{2}$,\nthe resulting matrix has the form\n\\[\n \\begin{pmatrix} 2 \\cos 2 \\cos 1 & \\cos 2 & \\cdots \\\\\n  2 \\cos (n+2) \\cos 1 & \\cos (n+2) & \\cdots \\\\\n  2 \\cos (2n+2) \\cos 1 & 2 \\cos (2n+2) & \\cdots \\\\\n\\vdots & \\vdots & \\ddots\n \\end{pmatrix}\n\\]\nwith the first column being a multiple of the second. Hence $d_n = 0$.\n\n\\textbf{Remark.}\nAnother way to draw the same conclusion is to observe that the given matrix is the sum\nof the two rank 1 matrices $A_{jk} = \\cos (j-1)n \\cos k$ and $B_{jk} = -\\sin (j-1)n \\sin k$,\nand so has rank at most 2. One can also use the matrices\n$A_{jk} = e^{i((j-1)n+k)}$, $B_{jk} = e^{-i(j-1)n+k}$.", "category": "Algebra", "source": "PUTNAM", "year": 2009}
{"id": "putnam-2009-a4", "question": "Let $S$ be a set of rational numbers such that\n\\begin{enumerate}", "solution": "The answer is no; indeed, $S = \\mathbb{Q} \\setminus \\{n+2/5 \\,|\\,\nn\\in\\mathbb{Z}\\}$ satisfies the given conditions. Clearly $S$ satisfies\n(a) and (b); we need only check that it satisfies (c). It suffices to\nshow that if $x = p/q$ is a fraction with $(p,q)=1$ and $p>0$, then we\ncannot have $1/(x(x-1)) = n+2/5$ for an integer $n$. Suppose otherwise; then\n\\[\n(5n+2)p(p-q) = 5q^2.\n\\]\nSince $p$ and $q$ are relatively prime, and $p$ divides $5q^2$, we must\nhave $p\\,|\\,5$, so $p=1$ or $p=5$. On the other hand, $p-q$ and $q$ are\nalso relatively prime, so $p-q$ divides $5$ as well, and $p-q$ must be\n$\\pm 1$ or $\\pm 5$. This leads to eight possibilities for $(p,q)$:\n$(1,0)$,  $(5,0)$,  $(5,10)$, $(1,-4)$, $(1,2)$, $(1,6)$, $(5,4)$,\n$(5,6)$. The first three are impossible, while the final five lead to\n$5n+2 = 16,-20,-36,16,-36$ respectively, none of which holds for\nintegral $n$.\n\n\\textbf{Remark.} More generally, no rational number of the form $m/n$,\nwhere $m,n$ are relatively prime and neither of $\\pm m$ is a quadratic\nresidue mod $n$, need be in $S$. If $x=p/q$ is in lowest terms and\n$1/(x(x-1)) = m/n+k$ for some integer $k$, then $p(p-q)$ is relatively\nprime to $q^2$; $q^2/(p(p-q)) = (m+kn)/n$ then implies that $m+kn = \\pm\nq^2$ and so $\\pm m$ must be a quadratic residue mod $n$.", "category": "Number Theory", "source": "PUTNAM", "year": 2009}
{"id": "putnam-2009-a5", "question": "Is there a finite abelian group $G$ such that the product of the\norders of all its elements is $2^{2009}$?", "solution": "No, there is no such group.\nBy the structure theorem for finitely generated abelian groups,\n$G$ can be written as a product of cyclic groups.\nIf any of these factors has odd order, then $G$ has an element of odd order,\nso the product of the orders of all of its elements cannot be a power of 2.\n\nWe may thus consider only abelian $2$-groups hereafter.\nFor such a group $G$, the product of the orders of all of its elements\nhas the form $2^{k(G)}$ for some nonnegative integer $G$, and we must show\nthat it is impossible to achieve $k(G) = 2009$.\nAgain by the structure theorem, we may write\n\\[\nG \\cong \\prod_{i=1}^\\infty (\\ZZ/2^i \\ZZ)^{e_i}\n\\]\nfor some nonnegative integers $e_1,e_2,\\dots$, all but finitely many of\nwhich are $0$.\n\nFor any nonnegative integer $m$, the elements of $G$ of order at most $2^m$\nform a subgroup isomorphic to\n\\[\n\\prod_{i=1}^\\infty (\\ZZ/2^{\\min\\{i,m\\}} \\ZZ)^{e_i},\n\\]\nwhich has $2^{s_m}$ elements for $s_m = \\sum_{i=1}^\\infty \\min\\{i,m\\} e_i$.\nHence\n\\[\nk(G) = \\sum_{i=1}^\\infty i(2^{s_i} - 2^{s_{i-1}}).\n\\]\nSince $s_1 \\leq s_2 \\leq \\cdots$, $k(G)+1$ is always divisible by $2^{s_1}$.\nIn particular, $k(G) = 2009$ forces $s_1 \\leq 1$.\n\nHowever, the only cases where $s_1 \\leq 1$ are where all of the $e_i$ are $0$,\nin which case $k(G) = 0$, or where $e_i = 1$ for some $i$ and $e_j = 0$\nfor $j \\neq i$, in which case $k(G) = (i-1)2^i + 1$.\nThe right side is a strictly increasing function\nof $i$ which equals $1793$ for $i=8$ and $4097$ for $i=9$, so it can never equal\n2009. This proves the claim.\n\n\\textbf{Remark.} One can also arrive at the key congruence by dividing $G$\ninto equivalence classes, by declaring two elements to be equivalent if they generate the\nsame cyclic subgroup of $G$.\nFor $h>0$, an element of order $2^h$ belongs to an equivalence class of size $2^{h-1}$,\nso the products of the orders of the elements of this equivalence class is $2^j$\nfor $j = h 2^{h-1}$. This quantity is divisible by 4 as long as $h > 1$;\nthus to have $k(G) \\equiv 1 \\pmod{4}$, the number of elements of $G$ of order 2 must be\ncongruent to 1 modulo 4. However, there are exactly $2^e-1$ such elements,\nfor $e$ the number of cyclic factors of $G$. Hence $e = 1$, and one concludes as in the\ngiven solution.", "category": "Number Theory", "source": "PUTNAM", "year": 2009}
{"id": "putnam-2009-a6", "question": "Let $f:[0,1]^2 \\to \\mathbb{R}$ be a continuous function on the closed unit\nsquare such that $\\frac{\\partial f}{\\partial x}$ and $\\frac{\\partial f}{\\partial y}$ exist\nand are continuous on the interior $(0,1)^2$. Let $a = \\int_0^1 f(0,y)\\,dy$,\n$b = \\int_0^1 f(1,y)\\,dy$, $c = \\int_0^1 f(x,0)\\,dx$, $d = \\int_0^1 f(x,1)\\,dx$.\nProve or disprove: There must be a point $(x_0,y_0)$ in $(0,1)^2$ such that\n\\[\n\\frac{\\partial f}{\\partial x} (x_0,y_0) = b - a\n\\quad \\mbox{and} \\quad\n\\frac{\\partial f}{\\partial y} (x_0,y_0) = d - c.\n\\]", "solution": "We disprove the assertion using the example\n\\[\nf(x,y) = 3(1 + y)(2x-1)^2 -y.\n\\]\nWe have $b-a = d-c = 0$ because the identity $f(x,y) = f(1-x,y)$ forces $a=b$,\nand because\n\\begin{align*}\nc &= \\int_0^1 3(2x-1)^2\\,dx = 1, \\\\\nd &= \\int_0^1 (6(2x-1)^2-1)\\,dx = 1.\n\\end{align*}\nMoreover, the partial derivatives\n\\begin{align*}\n \\frac{\\partial f}{\\partial x}(x_0,y_0) &= 3(1+y_0)(8x_0-4) \\\\\n\\frac{\\partial f}{\\partial y}(x_0,y_0) &= 3(2x_0-1)^2-1.\n\\end{align*}\nhave no common zero in $(0,1)^2$. Namely,\nfor the first partial to vanish, we must have $x_0 = 1/2$ since\n$1 + y_0$ is nowhere zero, but for $x_0 = 1/2$\nthe second partial cannot vanish.\n\n\\textbf{Remark.}\nThis problem amounts to refuting a potential generalization of the Mean Value Theorem to bivariate\nfunctions. Many counterexamples are possible. Kent Merryfield suggests\n$y \\sin(2 \\pi x)$, for which all four of the boundary integrals vanish;\nhere the partial derivatives are $2\\pi y \\cos (2 \\pi x)$ and $\\sin (2 \\pi x)$.\nCatalin Zara suggests $x^{1/3} y^{2/3}$. Qingchun Ren suggests $xy(1-y)$.", "category": "Geometry", "source": "PUTNAM", "year": 2009}
{"id": "putnam-2009-b1", "question": "Show that every positive rational number can be written as a quotient of products of factorials\nof (not necessarily distinct) primes. For example,\n\\[\n\\frac{10}{9} = \\frac{2!\\cdot 5!}{3!\\cdot 3! \\cdot 3!}.\n\\]\n\\,", "solution": "Every positive rational number can be uniquely written in lowest terms\nas $a/b$ for $a,b$ positive integers. We prove the statement in the\nproblem by induction on the largest prime dividing either $a$ or $b$\n(where this is considered to be $1$ if $a=b=1$). For the base case, we\ncan write $1/1 = 2!/2!$. For a general $a/b$, let $p$ be the largest\nprime dividing either $a$ or $b$; then $a/b = p^k a'/b'$ for some $k\\neq\n0$ and positive integers $a',b'$ whose largest prime factors are\nstrictly less than $p$. We now have $a/b = (p!)^k \\frac{a'}{(p-1)!^k b'}$,\nand all prime factors of $a'$ and $(p-1)!^k b'$ are strictly less than $p$.\nBy the induction assumption, $\\frac{a'}{(p-1)!^k b'}$ can be written as a\nquotient of products of prime factorials, and so $a/b = (p!)^k\n\\frac{a'}{(p-1)!^k b'}$ can as well. This completes the induction.\n\n\\textbf{Remark.} Noam Elkies points out that the representations are unique\nup to rearranging and canceling common factors.", "category": "Number Theory", "source": "PUTNAM", "year": 2009}
{"id": "putnam-2009-b2", "question": "A game involves jumping to the right on the real number line. If $a$ and $b$ are real numbers\nand $b > a$, the cost of jumping from $a$ to $b$ is $b^3-ab^2$. For what real numbers\n$c$ can one travel from $0$ to $1$ in a finite number of jumps with total cost exactly $c$?", "solution": "The desired real numbers $c$ are precisely those for which $1/3 < c \\leq 1$.\nFor any positive integer $m$ and any\nsequence $0 = x_0 < x_1 < \\cdots < x_m = 1$,\nthe cost of jumping along this sequence is\n$\\sum_{i=1}^m (x_i - x_{i-1})x_i^2$. Since\n\\begin{align*}\n1 = \\sum_{i=1}^m (x_i - x_{i-1}) &\\geq \\sum_{i=1}^m (x_i - x_{i-1})x_i^2 \\\\\n&> \\sum_{i=1}^m \\int_{x_i}^{x_{i-1}} t^2\\,dt \\\\\n&= \\int_0^1 t^2\\,dt = \\frac{1}{3},\n\\end{align*}\nwe can only achieve costs $c$ for which $1/3 < c \\leq 1$.\n\nIt remains to check that any such $c$ can be achieved.\nSuppose $0 = x_0 < \\dots < x_m = 1$ is a sequence with $m \\geq 1$.\nFor $i=1,\\dots,m$,\nlet $c_i$ be the cost of the sequence $0, x_i, x_{i+1},\\dots,x_m$.\nFor $i > 1$ and $0 < y \\leq x_{i-1}$,\nthe cost of the sequence $0, y, x_{i}, \\dots, x_m$\nis\n\\[\nc_{i} + y^3 + (x_i - y)x_i^2 - x_i^3\n= c_i - y(x_i^2 - y^2),\n\\]\nwhich is less than $c_i$ but approaches $c_i$ as $y \\to 0$.\nBy continuity, for $i=2,\\dots,m$,\nevery value in the interval $[c_{i-1}, c_{i})$ can be achieved,\nas can $c_m = 1$ by the sequence $0,1$.\n\nTo show that all costs $c$ with $1/3 < c \\leq 1$ can be achieved, it now suffices\nto check that for every $\\epsilon > 0$, there exists a sequence with cost at most\n$1/3 + \\epsilon$. For instance, if we take $x_i = i/m$ for $i=0,\\dots,m$, the cost\nbecomes\n\\[\n\\frac{1}{m^3} (1^2 + \\cdots + m^2)\n = \\frac{(m+1)(2m+1)}{6m^2},\n\\]\nwhich converges to $1/3$ as $m \\to +\\infty$.\n\n\\textbf{Reinterpretation.} The cost of jumping along a particular sequence is an\nupper Riemann sum of the function $t^2$. The fact that this function admits a Riemann\nintegral implies that for any $\\epsilon > 0$, there exists $\\delta_0$ such that the\ncost of the sequence $x_0,\\dots,x_m$ is at most $1/3 + \\epsilon$ as long as\n$\\max_i \\{x_i - x_{i-1}\\} < \\epsilon$. (The computation of the integral using the\nsequence $x_i = i/m$ was already known to Archimedes.)", "category": "Algebra", "source": "PUTNAM", "year": 2009}
{"id": "putnam-2009-b3", "question": "Call a subset $S$ of $\\{1, 2, \\dots, n\\}$ \\emph{mediocre} if it has the following property:\nWhenever $a$ and $b$ are elements of $S$ whose average is an integer, that average is also\nan element of $S$. Let $A(n)$ be the number of mediocre subsets of $\\{1,2,\\dots,n\\}$.\n[For instance, every subset of $\\{1,2,3\\}$ except $\\{1,3\\}$ is mediocre, so $A(3) =7$.]\nFind all positive integers $n$ such that $A(n+2) - 2A(n+1) + A(n) = 1$.", "solution": "The answer is $n=2^k-1$ for some integer $k\\geq 1$.\nThere is a bijection between mediocre subsets of $\\{1,\\ldots,n\\}$ and\nmediocre subsets of $\\{2,\\ldots,n+1\\}$ given by adding $1$ to each\nelement of the subset; thus $A(n+1)-A(n)$ is the number of mediocre\nsubsets of $\\{1,\\ldots,n+1\\}$ that contain $1$. It follows that\n$A(n+2)-2A(n+1)+A_n = (A(n+2)-A(n+1))-(A(n+1)-A(n))$ is the difference\nbetween the number of mediocre subsets of $\\{1,\\ldots,n+2\\}$ containing\n$1$ and the number of mediocre subsets of $\\{1,\\ldots,n+1\\}$ containing\n$1$. This difference is precisely the number of mediocre subsets of\n$\\{1,\\ldots,n+2\\}$ containing both $1$ and $n+2$, which we term\n``mediocre subsets containing the endpoints.'' Since $\\{1,\\ldots,n+2\\}$\nitself is a mediocre subset of itself containing the endpoints, it\nsuffices to prove that this is the only mediocre subset of\n$\\{1,\\ldots,n+2\\}$ containing the endpoints if and only if $n=2^k-1$ for\nsome $k$.\n\nIf $n$ is not of the form $2^k-1$, then we can write $n+1 = 2^a b$ for\nodd $b>1$. In this case, the set $\\{1+m b \\, | \\, 0 \\leq m \\leq 2^a\\}$\nis a mediocre subset of $\\{1,\\ldots,n+2\\}$ containing the endpoints: the\naverage of $1+m_1 b$ and $1+m_2 b$, namely $1+\\frac{m_1+m_2}{2} b$, is\nan integer if and only if $m_1+m_2$ is even, in which case this average\nlies in the set.\n\nIt remains to show that if $n=2^k-1$, then the only mediocre subset of\n$\\{1,\\ldots,n+2\\}$ containing the endpoints is itself. This is readily\nseen by induction on $k$. For $k=1$, the statement is obvious. For\ngeneral $k$, any mediocre subset $S$ of $\\{1,\\ldots,n+2=2^k+1\\}$\ncontaining $1$ and $2^k+1$ must also contain their average, $2^{k-1}+1$.\nBy the induction assumption, the only mediocre subset of\n$\\{1,\\ldots,2^{k-1}+1\\}$ containing the endpoints is itself, and so $S$\nmust contain all integers between $1$ and $2^{k-1}+1$. Similarly, a\nmediocre subset of $\\{2^{k-1}+1,\\ldots,2^k+1\\}$ containing the endpoints\ngives a mediocre subset of $\\{1,\\ldots,2^{k-1}+1\\}$ containing the\nendpoints by subtracting $2^{k-1}$ from each element. By the induction\nassumption again, it follows that $S$ must contain all integers between\n$2^{k-1}+1$ and $2^k+1$. Thus $S = \\{1,\\ldots,2^k+1\\}$ and the induction\nis complete.\n\n\\textbf{Remark.} One can also proceed by checking that a nonempty subset of\n$\\{1,\\dots,n\\}$ is mediocre if and only if it is an arithmetic progression\nwith odd common difference. Given this fact, the number of\nmediocre subsets of $\\{1,\\dots,n+2\\}$ containing the endpoints is seen to be\nthe number of odd factors of $n+1$, from which the desired result is evident.\n(The sequence $A(n)$ appears as sequence A124197 in the Encyclopedia of Integer Sequences.)", "category": "Combinatorics", "source": "PUTNAM", "year": 2009}
{"id": "putnam-2009-b4", "question": "Say that a polynomial with real coefficients in two variables, $x,y$, is \\emph{balanced} if\nthe average value of the polynomial on each circle centered at the origin is $0$.\nThe balanced polynomials of degree at most $2009$ form a vector space $V$ over $\\mathbb{R}$.\nFind the dimension of $V$.", "solution": "Any polynomial $P(x,y)$ of degree at most $2009$ can be written uniquely\nas a sum $\\sum_{i=0}^{2009} P_i(x,y)$ in which $P_i(x,y)$ is a homogeneous\npolynomial of degree $i$.\nFor $r>0$, let $C_r$ be the path $(r\\cos \\theta, r\\sin \\theta)$\nfor $0 \\leq \\theta \\leq 2\\pi$. Put $\\lambda(P_i) = \\oint_{C_1} P_i$; then\nfor $r>0$,\n\\[\n\\oint_{C_r} P = \\sum_{i=0}^{2009} r^i \\lambda(P_i).\n\\]\nFor fixed $P$, the right side is a polynomial in $r$, which vanishes for\nall $r>0$ if and only if its coefficients vanish.\nIn other words,\n$P$ is balanced\nif and only if $\\lambda(P_i) = 0$ for $i=0,\\dots,2009$.\n\nFor $i$ odd, we have $P_i(-x,-y) = -P_i(x,y)$.\nHence $\\lambda(P_i) = 0$, e.g.,\nbecause the contributions to the integral from\n$\\theta$ and $\\theta + \\pi$ cancel.\n\nFor $i$ even, $\\lambda(P_i)$ is a linear function of the coefficients of\n$P_i$. This function is not identically zero, e.g., because for $P_i =\n(x^2 + y^2)^{i/2}$, the integrand is always positive and so\n$\\lambda(P_i) > 0$. The kernel of $\\lambda$ on the space of homogeneous\npolynomials of degree $i$ is thus a subspace of codimension 1.\n\nIt follows that the dimension of $V$ is\n\\[\n(1 + \\cdots + 2010) - 1005 = (2011 - 1) \\times 1005 = 2020050.\n\\]", "category": "Algebra", "source": "PUTNAM", "year": 2009}
{"id": "putnam-2009-b5", "question": "Let $f: (1, \\infty) \\to \\mathbb{R}$ be a differentiable function such that\n\\[\n f'(x) = \\frac{x^2 - f(x)^2}{x^2 (f(x)^2 + 1)}\n\\qquad \\mbox{for all $x>1$.}\n\\]\nProve that $\\lim_{x \\to \\infty} f(x) = \\infty$.", "solution": "\\textbf{First solution.}\nIf $f(x) \\geq x$ for all $x > 1$, then the desired conclusion clearly holds.\nWe may thus assume hereafter that there exists $x_0 > 1$ for which $f(x_0) < x_0$.\n\nRewrite the original differential equation as\n\\[\n f'(x) = 1 - \\frac{x^2 + 1}{x^2} \\frac{f(x)^2}{1 + f(x)^2}.\n\\]\nPut $c_0 = \\min\\{0, f(x_0) - 1/x_0\\}$.\nFor all $x \\geq x_0$, we have $f'(x) > -1/x^2$ and so\n\\[\nf(x) \\geq f(x_0) -\\int_{x_0}^x dt/t^2 > c_0.\n\\]\nIn the other direction, we claim that $f(x) < x$ for all $x \\geq x_0$.\nTo see this, suppose the contrary; then by continuity, there is a least\n$x \\geq x_0$ for which $f(x) \\geq x$, and this least value satisfies $f(x) = x$.\nHowever, this forces $f'(x) = 0 < 1$ and so\n$f(x-\\epsilon) > x-\\epsilon$ for $\\epsilon > 0$ small,\ncontradicting the choice of $x$.\n\nPut $x_1 = \\max\\{x_0, -c_0\\}$. For $x \\geq x_1$, we have\n$|f(x)| < x$ and so $f'(x) > 0$.\nIn particular, the limit $\\lim_{x \\to +\\infty} f(x) = L$\nexists.\n\nSuppose that $L < +\\infty$; then $\\lim_{x \\to +\\infty}\nf'(x) = 1/(1 + L^2) > 0$. Hence for any sufficiently small $\\epsilon > 0$,\nwe can choose $x_2 \\geq x_1$ so that $f'(x) \\geq \\epsilon$\nfor $x \\geq x_2$. But then $f(x) \\geq f(x_2) + \\epsilon(x-x_2)$,\nwhich contradicts $L < +\\infty$. Hence $L = +\\infty$,\nas desired.\n\n\\textbf{Variant.} (by Leonid Shteyman) One obtains a similar argument by\nwriting\n\\[\n f'(x) = \\frac{1}{1 + f(x)^2} - \\frac{f(x)^2}{x^2(1+f(x)^2)},\n\\]\nso that\n\\[\n-\\frac{1}{x^2} \\leq f'(x) - \\frac{1}{1 + f(x)^2} \\leq 0.\n\\]\nHence $f'(x) - 1/(1 + f(x)^2)$ tends to 0 as $x \\to +\\infty$, so $f(x)$ is bounded below, and\ntends to $+\\infty$\nif and only if the improper integral $\\int dx/(1+f(x)^2)$ diverges. However, if the integral were to\nconverge, then as $x \\to +\\infty$ we would have $1/(1+f(x)^2) \\to 0$; however, since $f$ is bounded below,\nthis again forces $f(x) \\to +\\infty$.\n\n\\textbf{Second solution.} (by Catalin Zara)\nThe function $g(x) = f(x)+x$ satisfies the differential equation\n\\[\ng'(x) = 1 + \\frac{1 - (g(x)/x - 1)^2}{1 + x^2(g(x)/x - 1)^2}.\n\\]\nThis implies that $g'(x) > 0$ for all $x > 1$, so\nthe limit $L_1 = \\lim_{x \\to +\\infty} g(x)$ exists. In addition, we cannot have\n$L_1 < +\\infty$, or else we would have\n$\\lim_{x \\to +\\infty} g'(x) = 0$ whereas the differential equation forces\nthis limit to be 1.\nHence $g(x) \\to +\\infty$ as $x \\to +\\infty$.\n\nSimilarly, the function $h(x) = -f(x) + x$ satisfies the differential equation\n\\[\nh'(x) = 1 - \\frac{1 - (h(x)/x - 1)^2}{1 + x^2(h(x)/x - 1)^2}.\n\\]\nThis implies that $h'(x) \\geq 0$ for all $x$,\nso the limit $L_2 = \\lim_{x \\to +\\infty} h(x)$ exists. In addition, we cannot have\n$L_2 < +\\infty$, or else we would have\n$\\lim_{x \\to +\\infty} h'(x) = 0$ whereas the differential equation forces\nthis limit to be 1.\nHence $h(x) \\to +\\infty$ as $x \\to +\\infty$.\n\nFor some $x_1 > 1$, we must have $g(x), h(x) > 0$ for all $x \\geq x_1$. For\n$x \\geq x_1$, we have $|f(x)| < x$ and hence $f'(x) > 0$, so the limit\n$L = \\lim_{x \\to +\\infty} f(x)$ exists. Once again,\nwe cannot have $L < +\\infty$, or else we would have\n$\\lim_{x \\to +\\infty} f'(x) = 0$ whereas the original differential equation (e.g., in the form\ngiven in the first solution) forces\nthis limit to be $1/(1 + L^2) > 0$.\nHence $f(x) \\to +\\infty$ as $x \\to \\infty$, as desired.\n\n\\textbf{Third solution.}\n(by Noam Elkies)\nConsider the function $g(x) = f(x) + \\frac{1}{3}f(x)^3$, for which\n\\[\n g'(x) = f'(x)(1 + f(x)^2) = 1 - \\frac{f(x)^2}{x^2}\n\\]\nfor $x>1$. Since evidently $g'(x) < 1$,\n$g(x) - x$ is bounded above for $x$ large.\nAs in the first solution,\n$f(x)$ is bounded below for $x$ large,\nso $\\frac{1}{3} f(x)^3 - x$ is bounded above by some $c>0$. For $x \\geq c$,\nwe obtain $f(x) \\leq (6x)^{1/3}$.\n\nSince $f(x)/x \\to 0$ as $x \\to +\\infty$, $g'(x) \\to 1$ and so\n$g(x)/x \\to 1$. Since $g(x)$ tends to $+\\infty$,\nso does $f(x)$. (With a tiny bit of extra work, one shows that in fact $f(x)/(3x)^{1/3} \\to 1$ as $x \\to +\\infty$.)", "category": "Algebra", "source": "PUTNAM", "year": 2009}
{"id": "putnam-2009-b6", "question": "Prove that for every positive integer $n$, there is a sequence of integers\n$a_0, a_1, \\dots, a_{2009}$ with $a_0 = 0$ and $a_{2009} = n$ such that each term\nafter $a_0$ is either an earlier term plus $2^k$ for some nonnegative integer $k$,\nor of the form $b\\,\\mathrm{mod}\\,c$ for some earlier positive terms $b$ and $c$.\n[Here $b\\,\\mathrm{mod}\\,c$ denotes the remainder when $b$ is divided by $c$,\nso $0 \\leq (b\\,\\mathrm{mod}\\,c) < c$.]\n\n\\end{itemize}\n\n\\end{document}", "solution": "\\textbf{First solution.}\n(based on work of Yufei Zhao)\nSince any sequence of the desired form remains of the desired form upon multiplying each term by 2,\nwe may reduce to the case where $n$ is odd. In this case, take $x = 2^h$ for some\npositive integer $h$ for which $x \\geq n$, and set\n\\begin{align*}\na_0 &= 0\\\\\na_1 &= 1\\\\\na_2 &= 2x+1 = a_1 + 2x \\\\\na_3 &= (x+1)^2 = a_2 + x^2 \\\\\na_4 &= x^n+1 = a_1 + x^n\\\\\na_5 &= n(x+1) = a_4 \\mod a_3\\\\\na_6 &= x \\\\\na_7 &= n = a_5 \\mod a_6.\n\\end{align*}\nWe may pad the sequence to the desired length by taking\n$a_8 = \\cdots = a_{2009} = n$.\n\n\\textbf{Second solution.}\n(by James Merryfield)\nSuppose first that $n$ is not divisible by 3. Recall that since $2$ is a primitive root modulo\n$3^2$, it is also a primitive root modulo $3^h$ for any positive integer $h$. In particular,\nif we choose $h$ so that $3^{2h} > n$, then\nthere exists a positive integer $c$ for which $2^c \\mod 3^{2h} = n$.\nWe now take $b$ to be a positive integer for which $2^b > 3^{2h}$, and then put\n\\begin{align*}\na_0 &= 0\\\\\na_1 &= 1\\\\\na_2 &= 3 = a_1 + 2\\\\\na_3 &= 3 + 2^b \\\\\na_4 &= 2^{2hb} \\\\\na_5 &= 3^{2h} = a_4 \\mod a_3 \\\\\na_6 &= 2^c \\\\\na_7 &= n = a_6 \\mod a_5.\n\\end{align*}\nIf $n$ is divisible by 3, we can force $a_7 = n-1$ as in the above\nconstruction, then put $a_{8} = a_7 + 1 = n$. In both cases, we then pad the sequence\nas in the first solution.\n\n\\textbf{Remark.}\nHendrik Lenstra, Ronald van Luijk, and Gabriele Della Torre\nsuggest the following variant of the first solution requiring only 6 steps.\nFor $n$ odd and $x$ as in the first solution, set\n\\begin{align*}\na_0 &= 0\\\\\na_1 &= 1\\\\\na_2 &= x+1 = a_1 + x\\\\\na_3 &= x^n+x+1 = a_2 + x^n\\\\\na_4 &= x^{(n-1)(\\phi(a_3)-1)}\\\\\na_5 &= \\frac{x^n+1}{x+1} = a_4 \\mod a_3 \\\\\na_6 &= n = a_5 \\mod a_2.\n\\end{align*}\nIt seems unlikely that a shorter solution can be constructed without relying on\nany deep number-theoretic conjectures.\n\n\\end{itemize}\n\\end{document}", "category": "Combinatorics", "source": "PUTNAM", "year": 2009}
{"id": "imo-2010-q1", "question": "Find all functions $f \\colon \\RR \\to \\RR$ such that for all $x,y \\in \\RR$,\n\\[ f(\\left\\lfloor x\\right\\rfloor y) = f(x)\\left\\lfloor f(y)\\right\\rfloor. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1935849}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all functions $f \\colon \\RR \\to \\RR$ such that for all $x,y \\in \\RR$,\n\\[ f(\\left\\lfloor x\\right\\rfloor y) = f(x)\\left\\lfloor f(y)\\right\\rfloor. \\]\n\\end{mdframed}\nThe only solutions are $f(x) \\equiv c$,\nwhere $c = 0$ or $1 \\le c < 2$.\nIt's easy to see these work.\n\nPlug in $x=0$ to get $f(0) = f(0) \\left\\lfloor f(y) \\right\\rfloor$,\nso either\n\\[ 1 \\le f(y) < 2 \\quad \\forall y\n  \\qquad\\text{or}\\qquad f(0) = 0 \\]\n\nIn the first situation,\nplug in $y=0$ to get $f(x) \\left\\lfloor f(0) \\right\\rfloor = f(0)$,\nthus $f$ is constant.\nThus assume henceforth $f(0) = 0$.\n\nNow set $x=y=1$ to get\n\\[ f(1) = f(1) \\left\\lfloor f(1) \\right\\rfloor \\]\nso either $f(1) = 0$ or $1 \\le f(1) < 2$.\nWe split into cases:\n\\begin{itemize}\n  \\ii If $f(1) = 0$, pick $x=1$ to get $f(y) \\equiv 0$.\n  \\ii If $1 \\le f(1) < 2$,\n  then $y=1$ gives\n  \\[ f(\\left\\lfloor x \\right\\rfloor) = f(x) \\]\n  from $y=1$, in particular $f(x) = 0$ for $0 \\le x < 1$.\n  Choose $(x,y) = \\left( 2, \\half \\right)$ to get\n  $f(1) = f(2) \\left\\lfloor f\\left( \\half \\right) \\right\\rfloor = 0$.\n\\end{itemize}\n\\pagebreak", "category": "Algebra", "source": "IMO", "year": 2010}
{"id": "imo-2010-q2", "question": "Let $I$ be the incenter of a triangle $ABC$ and let $\\Gamma$ be its circumcircle.\nLet line $AI$ intersect $\\Gamma$ again at $D$.\nLet $E$ be a point on arc $\\widehat{BDC}$ and $F$ a point on side $BC$ such that\n\\[ \\angle BAF = \\angle CAE < \\tfrac12 \\angle BAC. \\]\nFinally, let $G$ be the midpoint of $\\ol{IF}$.\nProve that $\\ol{DG}$ and $\\ol{EI}$ intersect on $\\Gamma$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1935927}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $I$ be the incenter of a triangle $ABC$ and let $\\Gamma$ be its circumcircle.\nLet line $AI$ intersect $\\Gamma$ again at $D$.\nLet $E$ be a point on arc $\\widehat{BDC}$ and $F$ a point on side $BC$ such that\n\\[ \\angle BAF = \\angle CAE < \\tfrac12 \\angle BAC. \\]\nFinally, let $G$ be the midpoint of $\\ol{IF}$.\nProve that $\\ol{DG}$ and $\\ol{EI}$ intersect on $\\Gamma$.\n\\end{mdframed}\nLet $\\ol{EI}$ meet $\\Gamma$ again at $K$.\nThen it suffices to show that $\\ol{KD}$ bisects $\\ol{IF}$.\nLet $\\ol{AF}$ meet $\\Gamma$ again at $H$, so $\\ol{HE} \\parallel \\ol{BC}$.\nBy Pascal theorem on \\[ AHEKDD \\]\nwe then obtain that $P = \\ol{AH} \\cap \\ol{KD}$ lies on a line through $I$\nparallel to $\\ol{BC}$.\n\nLet $I_A$ be the $A$-excenter,\nand set $Q = \\ol{I_AF} \\cap \\ol{IP}$, and $T = \\ol{AIDI_A} \\cap \\ol{BFC}$.\nThen\n\\[ -1 = (AI;TI_A) \\overset{F} = (IQ;\\infty P) \\]\nwhere $\\infty$ is the point at infinity along $\\ol{IPQ}$.\nThus $P$ is the midpoint of $\\ol{IQ}$.\nSince $D$ is the midpoint of $\\ol{II_A}$ by ``Fact 5'',\nit follows that $\\ol{DP}$ bisects $\\ol{IF}$.\n\n\\begin{center}\n\\begin{asy}\nsize(9cm);\n\npair A = dir(110);\npair B = dir(210);\npair C = dir(330);\npair D = dir(-90);\npair I = incenter(A, B, C);\npair I_A = 2*D-I;\n\npair E = dir(310);\npair K = -E+2*foot(origin, E, I);\npair H = B*C/E;\npair F = extension(B, C, A, H);\npair G = extension(D, K, I, F);\npair P = extension(A, F, D, G);\npair Q = extension(I, P, I_A, F);\n\ndraw(A--B--C--cycle, lightblue);\nfilldraw(unitcircle, opacity(0.1)+lightcyan, lightblue);\n\ndraw(A--I_A, lightblue);\ndraw(A--H--E--K--D--cycle, orange);\ndraw((D+0.3)--(D-0.3), orange);\ndraw(I--Q--I_A, red);\ndraw(I--F, blue);\npair T = extension(B, C, A, D);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$D$\", D, dir(220));\ndot(\"$I$\", I, dir(10));\ndot(\"$I_A$\", I_A, dir(I_A));\ndot(\"$E$\", E, dir(E));\ndot(\"$K$\", K, dir(K));\ndot(\"$H$\", H, dir(H));\ndot(\"$F$\", F, dir(F));\ndot(\"$G$\", G, dir(350));\ndot(\"$P$\", P, dir(45));\ndot(\"$Q$\", Q, dir(Q));\ndot(\"$T$\", T, dir(T));\n\n/* TSQ Source:\n\n!size(9cm);\n\nA = dir 110\nB = dir 210\nC = dir 330\nD = dir -90 R220\nI = incenter A B C R10\nI_A = 2*D-I\n\nE = dir 310\nK = -E+2*foot origin E I\nH = B*C/E\nF = extension B C A H\nG = extension D K I F R350\nP = extension A F D G R45\nQ = extension I P I_A F\n\nA--B--C--cycle lightblue\nunitcircle 0.1 lightcyan / lightblue\n\nA--I_A lightblue\nA--H--E--K--D--cycle orange\n(D+0.3)--(D-0.3) orange\nI--Q--I_A red\nI--F blue\nT = extension B C A D\n\n*/\n\\end{asy}\n\\end{center}\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2010}
{"id": "imo-2010-q3", "question": "Find all functions $g \\colon \\ZZ_{>0} \\to \\ZZ_{>0}$ such that\n\\[ \\left( g(m)+n \\right)\\left( g(n)+m \\right) \\]\nis always a perfect square.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1935854}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all functions $g \\colon \\ZZ_{>0} \\to \\ZZ_{>0}$ such that\n\\[ \\left( g(m)+n \\right)\\left( g(n)+m \\right) \\]\nis always a perfect square.\n\\end{mdframed}\nFor $c \\ge 0$, the function $g(n) = n+c$ works;\nwe prove this is the only possibility.\n\nFirst, the main point of the problem is that\n\\begin{claim*}\n  We have $g(n) \\equiv g(n') \\pmod p \\implies n \\equiv n' \\pmod p$.\n\\end{claim*}\n\\begin{proof}\n  Pick a large integer $M$ such that\n  \\[ \\nu_p(M+g(n)), \\quad \\nu_p(M+g(n')) \\quad\n    \\text{are both odd}. \\]\n  (It's not hard to see this is always possible.)\n  Now, since each of\n  \\begin{align*}\n    \\left( M + g(n) \\right)&\\left( n + g(M)  \\right) \\\\\n    \\left( M + g(n') \\right)&\\left( n' + g(M)  \\right)\n  \\end{align*}\n  is a square, we get $n \\equiv n' \\equiv -M \\pmod p$.\n\\end{proof}\n\nThis claim implies that\n\\begin{itemize}\n  \\ii The numbers $g(n)$ and $g(n+1)$ differ by $\\pm 1$ for any $n$, and\n  \\ii The function $g$ is injective.\n\\end{itemize}\nIt follows $g$ is a linear function with slope $\\pm 1$, hence done.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Number Theory", "source": "IMO", "year": 2010}
{"id": "imo-2010-q4", "question": "Let $P$ be a point interior to triangle $ABC$ (with $CA \\neq CB$).\nThe lines $AP$, $BP$ and $CP$ meet again its circumcircle $\\Gamma$\nat $K$, $L$, $M$, respectively.\nThe tangent line at $C$ to $\\Gamma$ meets the line $AB$ at $S$.\nShow that from $SC = SP$ follows $MK = ML$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1936916}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $P$ be a point interior to triangle $ABC$ (with $CA \\neq CB$).\nThe lines $AP$, $BP$ and $CP$ meet again its circumcircle $\\Gamma$\nat $K$, $L$, $M$, respectively.\nThe tangent line at $C$ to $\\Gamma$ meets the line $AB$ at $S$.\nShow that from $SC = SP$ follows $MK = ML$.\n\\end{mdframed}\nWe present two solutions using harmonic bundles.\n\n\\paragraph{First solution (Evan Chen).}\nLet $N$ be the antipode of $M$, and let $NP$ meet $\\Gamma$ again at $D$.\nFocus only on $CDMN$ for now (ignoring the condition).\nThen $C$ and $D$ are feet of altitudes in $\\triangle MNP$;\nit is well-known that the circumcircle of $\\triangle CDP$\nis orthogonal to $\\Gamma$\n(passing through the orthocenter of $\\triangle MPN$).\n\\begin{center}\n\\begin{asy}\npair N = dir(100);\npair M = -N;\npair L = dir(150);\npair K = N*N/L;\npair C = dir(122);\npair D = conj(C);\npair P = extension(D, N, M, C);\npair A = -K+2*foot(origin, K, P);\npair B = -L+2*foot(origin, L, P);\npair S = circumcenter(C, P, D);\nfilldraw(unitcircle, opacity(0.1)+lightgreen, heavygreen);\ndraw(C--S--D, heavygreen);\ndraw(A--C--B--S, lightblue);\ndraw(A--D--B, lightblue);\nfilldraw(L--N--K--M--cycle, opacity(0.1)+lightred, lightred);\ndraw(M--N, lightred);\ndraw(K--L, lightred);\ndraw(A--K, dashed+orange);\ndraw(B--L, dashed+orange);\ndraw(C--M, dashed+orange);\ndraw(D--N, dashed+orange);\ndraw(S--P, heavygreen);\ndraw(arc(S,abs(S-D),-60,60), heavygreen);\n\ndot(\"$N$\", N, dir(N));\ndot(\"$M$\", M, dir(M));\ndot(\"$L$\", L, dir(170));\ndot(\"$K$\", K, dir(K));\ndot(\"$C$\", C, dir(80));\ndot(\"$D$\", D, dir(280));\ndot(\"$P$\", P, dir(P));\ndot(\"$A$\", A, dir(220));\ndot(\"$B$\", B, dir(B));\ndot(\"$S$\", S, dir(S));\n\n/* TSQ Source:\n\nN = dir 100\nM = -N\nL = dir 150 R170\nK = N*N/L\nC = dir 122 R80\nD = conj(C) R280\nP = extension D N M C\nA = -K+2*foot origin K P R220\nB = -L+2*foot origin L P\nS = circumcenter C P D\nunitcircle 0.1 lightgreen / heavygreen\nC--S--D heavygreen\nA--C--B--S lightblue\nA--D--B lightblue\nL--N--K--M--cycle 0.1 lightred / lightred\nM--N lightred\nK--L lightred\nA--K dashed orange\nB--L dashed orange\nC--M dashed orange\nD--N dashed orange\nS--P heavygreen\n!draw(arc(S,abs(S-D),-60,60), heavygreen);\n\n*/\n\\end{asy}\n\\end{center}\nNow, we are given that point $S$ is such that $\\ol{SC}$\nis tangent to $\\Gamma$, and $SC = SP$.\nIt follows that $S$ is the circumcenter of $\\triangle CDP$,\nand hence $\\ol{SC}$ and $\\ol{SD}$ are tangents to $\\Gamma$.\n\nThen $-1 = (AB;CD) \\overset{P}{=} (KL;MN)$.\nSince $\\ol{MN}$ is a diameter, this implies $MK = ML$.\n\n\\begin{remark*}\n  I think it's more natural to come up with\n  this solution in reverse.\n  Namely, suppose we define the points the other way:\n  let $\\ol{SD}$ be the other tangent, so $(AB;CD) = -1$.\n  Then project through $P$ to get $(KL;MN) = -1$,\n  where $N$ is the second intersection of $\\ol{DP}$.\n  However, if $ML = MK$ then $KMLN$ must be a kite.\n  Thus one can recover the solution in reverse.\n\\end{remark*}\n\n\\paragraph{Second solution (Sebastian Jeon).}\nWe have \\[ SP^2 = SC^2 = SA \\cdot SB\n  \\implies\n  \\dang SPA = \\dang PBA = \\dang LBA = \\dang LKA = \\dang LKP \\]\n(the latter half is Reim's theorem).\nTherefore $\\ol{SP}$ and $\\ol{LK}$ are \\emph{parallel}.\n\nNow, let $\\ol{SP}$ meet $\\Gamma$ again at $X$ and $Y$,\nand let $Q$ be the antipode of $P$ on $(S)$.\nThen\n\\[ SP^2 = SQ^2 = SX \\cdot SY\n  \\implies (PQ;XY) = -1 \\implies \\angle QCP = 90\\dg \\]\nthat $\\ol{CP}$ bisects $\\angle XCY$.\nSince $\\ol{XY} \\parallel \\ol{KL}$,\nit follows $\\ol{CP}$ bisects to $\\angle LCK$ too.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2010}
{"id": "imo-2010-q5", "question": "Each of the six boxes $B_1$, $B_2$, $B_3$, $B_4$, $B_5$, $B_6$\ninitially contains one coin.\nThe following two types of operations are allowed:\n\\begin{enumerate}\n  \\ii Choose a non-empty box $B_j$, $1\\leq j \\leq 5$,\n  remove one coin from $B_j$ and add two coins to $B_{j+1}$;\n  \\ii Choose a non-empty box $B_k$, $1\\leq k \\leq 4$,\n  remove one coin from $B_k$ and swap the contents\n  (possibly empty) of the boxes $B_{k+1}$ and $B_{k+2}$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1936917}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nEach of the six boxes $B_1$, $B_2$, $B_3$, $B_4$, $B_5$, $B_6$\ninitially contains one coin.\nThe following two types of operations are allowed:\n\\begin{enumerate}\n  \\ii Choose a non-empty box $B_j$, $1\\leq j \\leq 5$,\n  remove one coin from $B_j$ and add two coins to $B_{j+1}$;\n  \\ii Choose a non-empty box $B_k$, $1\\leq k \\leq 4$,\n  remove one coin from $B_k$ and swap the contents\n  (possibly empty) of the boxes $B_{k+1}$ and $B_{k+2}$.\n\\end{enumerate}\nDetermine if there exists a finite sequence of operations of the allowed types,\nsuch that the five boxes $B_1$, $B_2$, $B_3$, $B_4$, $B_5$ become empty,\nwhile box $B_6$ contains exactly $2010^{2010^{2010}}$ coins.\n\\end{mdframed}\nFirst,\n\\begin{align*}\n  (1,1,1,1,1,1) &\\to (0,3,1,0,3,1) \\to (0,0,7,0,0,7) \\\\\n  &\\to (0,0,6,2,0,7) \\to (0,0,6,1,2,7) \\to (0,0,6,1,0,11) \\\\\n  &\\to (0,0,6,0,11,0) \\to (0,0,5,11,0,0).\n\\end{align*}\nand henceforth we ignore boxes $B_1$ and $B_2$,\nlooking at just the last four boxes;\nso we write the current position as $(5,11,0,0)$.\n\nWe prove a lemma:\n\\begin{claim*}\n  Let $k \\ge 0$ and $n > 0$.\n  From $(k,n,0,0)$ we may reach $(k-1,2^n,0,0)$.\n\\end{claim*}\n\\begin{proof}\n  Working with only the last three boxes for now,\n  \\begin{align*}\n    (n,0,0) &\\to (n-1, 2, 0) \\to (n-1, 0, 4) \\\\\n    &\\to (n-2, 4, 0) \\to (n-2, 0, 8) \\\\\n    &\\to (n-3, 8, 0) \\to (n-3, 0, 16) \\\\\n    &\\to \\dots \\to (1, 2^{n-1}, 0) \\to (1, 0, 2^n) \\to (0, 2^n, 0).\n  \\end{align*}\n  Finally we have $(k,n,0,0) \\to (k,0,2^n,0) \\to (k-1,2^n, 0,0)$.\n\\end{proof}\n\nNow from $(5,11,0,0)$ we go as follows:\n\\begin{align*} (5,11,0,0) &\\to (4, 2^{11}, 0, 0)\n  \\to \\left(3, 2^{2^{11}}, 0, 0\\right)\n  \\to \\left(2, 2^{2^{2^{11}}}, 0, 0\\right) \\\\\n  &\\to \\left( 1, 2^{2^{2^{2^{11}}}}, 0, 0\\right)\n  \\to \\left(0, 2^{2^{2^{2^{2^{11}}}}}, 0, 0\\right).\n\\end{align*}\nLet $A = 2^{2^{2^{2^{2^{11}}}}} > 2010^{2010^{2010}} = B$.\nThen by using move 2 repeatedly on the fourth box\n(i.e., throwing away several coins by swapping the empty $B_5$ and $B_6$),\nwe go from $(0,A,0,0)$ to $(0,B/4,0,0)$.\nFrom there we reach $(0,0,0,B)$.\n\\pagebreak", "category": "Combinatorics", "source": "IMO", "year": 2010}
{"id": "imo-2010-q6", "question": "Let $a_1, a_2, a_3, \\dots$ be a sequence of positive real numbers, and $s$ be a positive integer, such that\n\\[\n  a_n =\n  \\max \\{ a_k + a_{n-k} \\mid 1 \\leq k \\leq n-1 \\}\n  \\text{ for all $n > s$}.\n\\]\nProve there exist positive integers $\\ell \\leq s$ and $N$, such that\n\\[\n  a_n =\n  a_{\\ell} + a_{n - \\ell} \\text{ for all $n \\ge N$}.\n\\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1936918}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a_1, a_2, a_3, \\dots$ be a sequence of positive real numbers, and $s$ be a positive integer, such that\n\\[\n  a_n =\n  \\max \\{ a_k + a_{n-k} \\mid 1 \\leq k \\leq n-1 \\}\n  \\text{ for all $n > s$}.\n\\]\nProve there exist positive integers $\\ell \\leq s$ and $N$, such that\n\\[\n  a_n =\n  a_{\\ell} + a_{n - \\ell} \\text{ for all $n \\ge N$}.\n\\]\n\\end{mdframed}\nLet \\[ w_1 = \\frac{a_1}{1}, \\quad w_2 = \\frac{a_2}{2},\n    \\quad \\dots, \\quad w_s = \\frac{a_s}{s}. \\]\n(The choice of the letter $w$ is for ``weight''.)\nWe claim the right choice of $\\ell$\nis the one maximizing $w_\\ell$.\n\nOur plan is to view each $a_n$ as a linear combination\nof the weights $w_1, \\dots, w_s$ and track their coefficients.\n\nTo this end, let's define an \\emph{$n$-type}\nto be a vector $T = \\left< t_1, \\dots, t_s\\right>$\nof nonnegative integers such that\n\\begin{itemize}\n  \\ii $n = t_1 + \\dots + t_s$; and\n  \\ii $t_i$ is divisible by $i$ for every $i$.\n\\end{itemize}\nWe then define its \\emph{valuation} as $v(T) = \\sum_{i=1}^s w_i t_i$.\n\nNow we define a $n$-type to be \\emph{valid}\naccording to the following recursive rule.\nFor $1 \\le n \\le s$ the only valid $n$-types are\n\\begin{align*}\n  T_1 &= \\left< 1, 0, 0, \\dots, 0 \\right> \\\\\n  T_2 &= \\left< 0, 2, 0, \\dots, 0 \\right> \\\\\n  T_3 &= \\left< 0, 0, 3, \\dots, 0 \\right> \\\\\n  &\\vdotswithin= \\\\\n  T_s &= \\left< 0, 0, 0, \\dots, s \\right>\n\\end{align*}\nfor $n = 1, \\dots, s$, respectively.\nThen for any $n > s$, an $n$-type is valid\nif it can be written as the sum of a valid $k$-type\nand a valid $(n-k)$-type, componentwise.\nThese represent the linear combinations possible in the recursion;\nin other words the recursion in the problem is phrased as\n\\[ a_n = \\max_{T \\text{ is a valid $n$-type}} v(T). \\]\n\nIn fact, we have the following description of valid $n$-types:\n\\begin{claim*}\n  Assume $n > s$.\n  Then an $n$-type $\\left< t_1, \\dots, t_s \\right>$ is valid\n  if and only if either\n  \\begin{itemize}\n    \\ii there exist indices $i < j$ with $i+j > s$,\n    $t_i \\ge i$ and $t_j \\ge j$; or\n    \\ii there exists an index $i > s/2$\n    with $t_i \\ge 2i$.\n  \\end{itemize}\n\\end{claim*}\n\\begin{proof}\n  Immediate by forwards induction on $n > s$\n  that all $n$-types have this property.\n\n  The reverse direction is by downwards induction on $n$.\n  Indeed if $\\sum_i \\frac{t_i}{i} > 2$,\n  then we may subtract off on of $\\{T_1, \\dots, T_s\\}$\n  while preserving the condition;\n  and the case $\\sum_i \\frac{t_i}{i} = 2$\n  is essentially by definition.\n\\end{proof}\n\\begin{remark*}\n  The claim is a bit confusingly stated in its two cases;\n  really the latter case should be thought of as the situation\n  $i=j$ but requiring that $t_i/i$ is counted with multiplicity.\n\\end{remark*}\n\nNow, for each $n > s$ we pick a valid $n$-type $T_n$\nwith $a_n = v(T_n)$;\nif there are ties, we pick one for which the $\\ell$th\nentry is as large as possible.\n\\begin{claim*}\n  For any $n > s$ and index $i \\neq \\ell$,\n  the $i$th entry of $T_n$\n  is at most $2s + \\ell i$.\n\\end{claim*}\n\\begin{proof}\n  If not, we can go back $i\\ell$ steps to get\n  a valid $(n-i\\ell)$-type $T$\n  achieved by decreasing the $i$th entry of $T_n$ by $i \\ell$.\n  But then we can add $\\ell$ to the $\\ell$th entry $i$\n  times to get another $n$-type $T'$ which obviously\n  has valuation at least as large,\n  but with larger $\\ell$th entry.\n\\end{proof}\n\nNow since all other entries in $T_n$ are bounded,\neventually the sequence $(T_n)_{n > s}$\njust consists of repeatedly\nadding $1$ to the $\\ell$th entry, as required.\n\n\\begin{remark*}\nOne big step is to consider $w_k = a_k / k$.\nYou can get this using wishful thinking\nor by examining small cases.\n(In addition this normalization makes it easier\nto see why the largest $w$ plays an important role,\nsince then in the definition of type,\nthe $n$-types all have a sum of $n$.\nUnfortunately, it makes the characterization\nof valid $n$-types somewhat clumsier too.)\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "IMO", "year": 2010}
{"id": "tst-2015-q1", "question": "Let $ABC$ be a scalene triangle with incenter $I$ whose incircle is\ntangent to $\\ol{BC}$, $\\ol{CA}$, $\\ol{AB}$ at $D$, $E$, $F$,\nrespectively.  Denote by $M$ the midpoint of $\\ol{BC}$ and\nlet $P$ be a point in the interior of $\\triangle ABC$\nso that $MD = MP$ and $\\angle PAB = \\angle PAC$.\nLet $Q$ be a point on the incircle such that $\\angle AQD = 90^{\\circ}$.\nProve that either $\\angle PQE = 90^{\\circ}$ or $\\angle PQF = 90^{\\circ}$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3683109}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a scalene triangle with incenter $I$ whose incircle is\ntangent to $\\ol{BC}$, $\\ol{CA}$, $\\ol{AB}$ at $D$, $E$, $F$,\nrespectively.  Denote by $M$ the midpoint of $\\ol{BC}$ and\nlet $P$ be a point in the interior of $\\triangle ABC$\nso that $MD = MP$ and $\\angle PAB = \\angle PAC$.\nLet $Q$ be a point on the incircle such that $\\angle AQD = 90^{\\circ}$.\nProve that either $\\angle PQE = 90^{\\circ}$ or $\\angle PQF = 90^{\\circ}$.\n\\end{mdframed}\nWe present two solutions.\n\n\\paragraph{Official solution.}\nAssume without loss of generality that $AB < AC$; we show $\\angle PQE=90^{\\circ}$.\n\\begin{center}\n  \\begin{asy}\n    size(9cm);\n\n    pair A = dir(130);\n    pair B = dir(210);\n    pair C = dir(330);\n    filldraw(A--B--C--cycle, opacity(0.2)+palecyan, blue);\n    pair I = incenter(A, B, C);\n    filldraw(incircle(A, B, C), opacity(0.3)+palered, red);\n    pair D = foot(I, B, C);\n    pair E = foot(I, C, A);\n    pair F = foot(I, A, B);\n\n    pair M = midpoint(B--C);\n    pair P = extension(A, I, D, E);\n    draw(A--P, orange);\n\n    pair D1 = 2*M-D;\n    pair Q = foot(D, A, D1);\n    draw(P--Q--E, heavyred+1);\n    draw(M--Q, red);\n    markrightangle(E,Q,P,heavyred+1);\n\n    pair N = midpoint(A--B);\n    draw(N--M, dashed+orange);\n    draw(D--E, dashed+orange);\n\n    filldraw(CP(M, P), opacity(0.2)+palegreen, heavygreen+dashed);\n\n    pair T = extension(A, Q, B, C);\n    pair S = extension(D, I, A, T);\n    draw(A--T, heavygreen);\n    draw(D--Q, red);\n    draw(D--S, dashed+red);\n\n    dot(\"$A$\", A, dir(A));\n    dot(\"$B$\", B, dir(B));\n    dot(\"$C$\", C, dir(C));\n    dot(\"$I$\", I, dir(I));\n    dot(\"$D$\", D, dir(D));\n    dot(\"$E$\", E, dir(P-D));\n    dot(\"$F$\", F, dir(F));\n    dot(\"$M$\", M, dir(M));\n    dot(\"$P$\", P, dir(200));\n    dot(\"$Q$\", Q, dir(25));\n    dot(\"$N$\", N, dir(N));\n    dot(\"$T$\", T, dir(T));\n    dot(\"$S$\", S, dir(70));\n\n    /* Source generated by TSQ\n\n    A = dir 130\n    B = dir 210\n    C = dir 330\n    A--B--C--cycle\n    I = incenter A B C\n    incircle A B C\n    D = foot I B C\n    E = foot I C A RP-D\n    F = foot I A B\n\n    M = midpoint B--C\n    P = extension A I D E R200\n    A--P\n\n    D1 := 2*M-D\n    Q = foot D A D1 R25\n    E--Q--P--M--Q\n    !markrightangle(E,Q,P,heavyred+1);\n\n    N = midpoint A--B\n    N--M dotted\n    D--E dotted\n\n    CP M P dashed\n\n    T = extension A Q B C\n    S = extension D I A T R70\n    A--T\n    D--Q\n    D--S dashed\n\n    */\n  \\end{asy}\n\\end{center}\n\nFirst, we claim that $D$, $P$, $E$ are collinear.\nLet $N$ be the midpoint of $\\ol{AB}$.\nIt is well-known that the three lines $MN$, $DE$, $AI$ are concurrent at a point\n(see for example problem 6 of USAJMO 2014).\nLet $P'$ be this intersection point, noting that $P'$ actually lies on segment $DE$.\nThen $P'$ lies inside $\\triangle ABC$ and moreover\n\\[ \\triangle DP'M \\sim \\triangle DEC \\]\nso $MP' = MD$.\nHence $P'=P$, proving the claim.\n\nLet $S$ be the point diametrically opposite $D$ on the incircle,\nwhich is also the second intersection of $\\ol{AQ}$ with the incircle.\nLet $T = \\ol{AQ} \\cap \\ol{BC}$.\nThen $T$ is the contact point of the $A$-excircle;\nconsequently, \\[ MD = MP = MT \\] and we obtain a circle with diameter $\\ol{DT}$.\nSince $\\angle DQT = \\angle DQS = 90^{\\circ}$ we have $Q$ on this circle as well.\n\nAs $\\ol{SD}$ is tangent to the circle with diameter $\\ol{DT}$,\nwe obtain \\[ \\angle PQD = \\angle SDP = \\angle SDE = \\angle SQE. \\]\nSince $\\angle DQS = 90^{\\circ}$, $\\angle PQE = 90^{\\circ}$ too.\n\n\\paragraph{Solution using spiral similarity.}\nWe will ignore for now the point $P$.\nAs before define $S$, $T$ and note $\\ol{AQST}$ collinear,\nas well as $DPQT$ cyclic on circle $\\omega$ with diameter $\\ol{DT}$.\n\nLet $\\tau$ be the spiral similarity at $Q$\nsending $\\omega$ to the incircle.\nWe have $\\tau(T) = D$, $\\tau(D) = S$, $\\tau(Q) = Q$.\nNow\n\\[ I = \\ol{DD} \\cap \\ol{QQ} \\implies\n\\tau(I) = \\ol{SS} \\cap \\ol{QQ} \\]\nand hence we conclude $\\tau(I)$ is the pole of $\\ol{ASQT}$\nwith respect to the incircle, which lies on line $EF$.\n\nThen since $\\ol{AI} \\perp \\ol{EF}$ too,\nwe deduce $\\tau$ sends line $AI$ to line $EF$,\nhence $\\tau(P)$ must be either $E$ or $F$ as desired.\n\n\\paragraph{Authorship comments.}\nWritten April 2014.\nI found this problem while playing with GeoGebra.\nSpecifically, I started by drawing in the points $A$, $B$, $C$,\n$I$, $D$, $M$, $T$, common points.\nI decided to add in the circle with diameter $DT$,\nbecause of the synergy it had with the rest of the picture.\nAfter a while of playing around,\nI intersected ray $AI$ with the circle to get $P$,\nand was surprised to find that $D$, $P$, $E$ were collinear,\nwhich I thought was impossible since the setup should have been symmetric.\nOn further reflection, I realized it was because $AI$\nintersected the circle twice, and set about trying to prove this.\nI noticed the relation $\\angle PQE = 90\\dg$ in my attempts\nto prove the result, even though this ended up being a corollary\nrather than a useful lemma.\n\\pagebreak", "category": "Geometry", "source": "TST", "year": 2015}
{"id": "tst-2015-q2", "question": "Prove that for every positive integer $n$, there exists a set $S$ of $n$ positive integers\nsuch that for any two distinct $a,b \\in S$, $a-b$ divides $a$ and $b$\nbut none of the other elements of $S$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3683110}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nProve that for every positive integer $n$, there exists a set $S$ of $n$ positive integers\nsuch that for any two distinct $a,b \\in S$, $a-b$ divides $a$ and $b$\nbut none of the other elements of $S$.\n\\end{mdframed}\nThe idea is to look for a\nsequence $d_1, \\dots, d_{n-1}$ of ``differences''\nsuch that the following two conditions hold.\nLet $s_i = d_1 + \\dots + d_{i-1}$,\nand $t_{i,j} = d_i + \\dots + d_{j-1}$ for $i \\le j$.\n\\begin{enumerate}\n\\item[(i)] No two of the $t_{i,j}$ divide each other.\n\\item[(ii)] There exists an integer $a$\n   satisfying the CRT equivalences\n   \\[ a \\equiv -s_i \\pmod{t_{i,j}} \\quad \\forall i \\le j \\]\n\\end{enumerate}\nThen the sequence $a+s_1$, $a+s_2$, \\dots, $a+s_n$ will work.\nFor example, when $n=3$ we can take $(d_1,d_2)=(2,3)$ giving\n\\[ 10 \\overbrace{\\underbrace{\\qquad}_2 12 \\underbrace{\\qquad}_3}^5 15 \\]\nbecause the only conditions we need satisfy are\n\\begin{align*}\n  a &\\equiv 0 \\pmod 2 \\\\\n  a &\\equiv 0 \\pmod 5 \\\\\n  a &\\equiv -2 \\pmod 3.\n\\end{align*}\n\nBut with this setup we can just construct the $d_i$ inductively.\nTo go from $n$ to $n+1$, take a $d_1, \\dots, d_{n-1}$\nand let $p$ be a prime\nnot dividing any of the $d_i$.\nMoreover, let $M$ be a multiple of $\\prod_{i \\le j} t_{i,j}$ coprime to $p$.\nThen we claim that $d_1M, d_2M, \\dots, d_{n-1}M, p$\nis such a difference sequence.\nFor example, the previous example extends as follows with $M = 300$ and $p=7$.\n\\[\n   a \\overbrace{\\underbrace{\\qquad}_{600} b\n   \\overbrace{\\underbrace{\\qquad}_{900} c\n   \\underbrace{\\qquad}_{7}}^{907}}^{1507} d\n\\]\nThe new numbers $p$, $p+Mt_{n-1,n}$, $p+Mt_{n-2,n}$, \\dots\\\nare all relatively prime to everything else.\nHence (i) still holds.\nTo see that (ii) still holds,\njust note that we can still get a family of solutions\nfor the first $n$ terms, and then the last $(n+1)$st term\ncan be made to work by Chinese Remainder Theorem\nsince all the new $p+Mt_{n-2,n}$ are coprime to everything.\n\\pagebreak", "category": "Number Theory", "source": "TST", "year": 2015}
{"id": "tst-2015-q3", "question": "A physicist encounters $2015$ atoms called usamons.\nEach usamon either has one electron or zero electrons,\nand the physicist can't tell the difference.\nThe physicist's only tool is a diode.\nThe physicist may connect the diode from any usamon $A$\nto any other usamon $B$.  (This connection is directed.)\nWhen she does so, if usamon $A$ has an electron and usamon $B$\ndoes not, then the electron jumps from $A$ to $B$.\nIn any other case, nothing happens.  In addition,\nthe physicist cannot tell whether an electron jumps during any given step.\nThe physicist's goal is to isolate two usamons that she is 100\\%\nsure are currently in the same state.\nIs there any series of diode usage that makes this possible?", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3683111}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA physicist encounters $2015$ atoms called usamons.\nEach usamon either has one electron or zero electrons,\nand the physicist can't tell the difference.\nThe physicist's only tool is a diode.\nThe physicist may connect the diode from any usamon $A$\nto any other usamon $B$.  (This connection is directed.)\nWhen she does so, if usamon $A$ has an electron and usamon $B$\ndoes not, then the electron jumps from $A$ to $B$.\nIn any other case, nothing happens.  In addition,\nthe physicist cannot tell whether an electron jumps during any given step.\nThe physicist's goal is to isolate two usamons that she is 100\\%\nsure are currently in the same state.\nIs there any series of diode usage that makes this possible?\n\\end{mdframed}\nThe answer is no.\nCall the usamons $U_1, \\dots, U_m$ (here $m=2015$).\nConsider models $M_k$ of the following form:\n$U_1, \\dots, U_k$ are all charged for some $0 \\le k \\le m$\nand the other usamons are not charged.\nNote that for any pair there's a model\nwhere they are different states, by construction.\n\nWe can consider the physicist as acting\non these $m+1$ models simultaneously,\nand trying to reach a state where there's a pair\nin all models which are all the same charge.\n(This is a necessary condition for a winning strategy to exist.)\n\nBut we claim that any diode operation $U_i \\to U_j$\nresults in the $m+1$ models being an isomorphic copy\nof the previous set.\nIf $i < j$ then the diode operation can be interpreted\nas just swapping $U_i$ with $U_j$, which doesn't change anything.\nMoreover if $i > j$ the operation never does anything.\nThe conclusion follows from this.\n\n\\begin{remark*}\n  This problem is not a ``standard'' olympiad problem,\n  so I can't say it's trivial.\n  But the idea is pretty natural I think.\n\n  You can motivate it as follows:\n  there's a sequence of diode operations\n  you can do which forces the situation to be one of the $M_k$ above:\n  first, use the diode into $U_1$ for all other $U_i$'s,\n  so that either no electrons exist at all or $U_1$ has an electron.\n  Repeat with the other $U_i$.\n  This leaves us at the situation described at the start of the problem.\n  Then you could guess the answer was ``no'' just based on the fact\n  that it's impossible for $n=2,3$\n  and that there doesn't seem to be a reasonable strategy.\n\n  In this way it's possible to give a pretty good description\n  of what it's possible to do.\n  One possible phrasing:\n  ``the physicist can arrange the usamons in a line such that\n  all the charged usamons are to the left of the un-charged usamons,\n  but can't determine the \\emph{number} of charged usamons''.\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Combinatorics", "source": "TST", "year": 2015}
{"id": "tst-2015-q4", "question": "Let $f \\colon \\QQ \\to \\QQ$ be a function such that for any $x,y \\in \\QQ$,\nthe number $f(x+y)-f(x)-f(y)$ is an integer.\nDecide whether there must exist a constant $c$\nsuch that $f(x) - cx$ is an integer for every rational number $x$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p4628083}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $f \\colon \\QQ \\to \\QQ$ be a function such that for any $x,y \\in \\QQ$,\nthe number $f(x+y)-f(x)-f(y)$ is an integer.\nDecide whether there must exist a constant $c$\nsuch that $f(x) - cx$ is an integer for every rational number $x$.\n\\end{mdframed}\nNo, such a constant need not exist.\n\nOne possible solution is as follows:\ndefine a sequence by $x_0 = 1$ and\n\\begin{align*}\n  2x_1 &= x_0 \\\\\n  2x_2 &= x_1 + 1 \\\\\n  2x_3 &= x_2 \\\\\n  2x_4 &= x_3 + 1 \\\\\n  2x_5 &= x_4 \\\\\n  2x_6 &= x_5 + 1 \\\\\n  &\\vdotswithin=\n\\end{align*}\nSet $f(2^{-k}) = x_k$ and $f(2^k)=2^k$ for $k=0,1,\\dots$.\nThen, let\n\\[ f\\left( a \\cdot 2^k + \\frac bc \\right)\n  = a f\\left( 2^k \\right) + \\frac bc \\]\nfor odd integers $a$, $b$, $c$.\nOne can verify this works.\n\nA second shorter solution (given by the proposer) is to set,\nwhenever $\\gcd(p,q) = 1$ and $q > 0$,\n\\[ f\\left( \\frac pq \\right)\n  = \\frac pq \\left( 1! + 2! + \\dots + q! \\right). \\]\n\n\n\\begin{remark*}\n  Silly note: despite appearances,\n  $f(x) = \\left\\lfloor x \\right\\rfloor$\n  is not a counterexample since one can take $c = 0$.\n\\end{remark*}\n\\pagebreak", "category": "Number Theory", "source": "TST", "year": 2015}
{"id": "tst-2015-q5", "question": "Fix a positive integer $n$.\nFind the smallest positive integer $\\chi$ for which\nthere exists a tournament on $n$ vertices,\nand a coloring of each of the tournament's edges by one of $\\chi$ colors, such that:\nany two directed edges $u \\to v$ and $v \\to w$ have different colors.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p4628085}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFix a positive integer $n$.\nFind the smallest positive integer $\\chi$ for which\nthere exists a tournament on $n$ vertices,\nand a coloring of each of the tournament's edges by one of $\\chi$ colors, such that:\nany two directed edges $u \\to v$ and $v \\to w$ have different colors.\n\\end{mdframed}\nThe answer is\n\\[ \\chi = \\left\\lceil \\log_2 n \\right\\rceil. \\]\n\nFirst, we prove by induction on $n$\nthat $\\chi \\ge \\log_2 n$ for any coloring and any tournament.\nThe base case $n = 1$ is obvious.\nNow given any tournament, consider any used color $c$.\nThen it should be possible to divide the tournament\ninto two subsets $A$ and $B$ such that all $c$-colored edges point from $A$ to $B$\n(for example by letting $A$ be all vertices\nwhich are the starting point of a $c$-edge).\n\\begin{center}\n\\begin{asy}\n  size(5cm);\n  filldraw(box( (-2,-2), (-0.6,2) ), opacity(0.1)+lightcyan, lightblue );\n  filldraw(box( (0.6,-2), (2,2) ), opacity(0.1)+lightcyan, lightblue );\n  label(\"$A$\", (-2,0), dir(180), blue);\n  label(\"$B$\", ( 2,0), dir(  0), blue);\n  label(\"all edges colored $c$\", (0,2), dir(90), deepgreen);\n  draw( (-1.3,1.2)--(1.5,0.2), deepgreen, EndArrow);\n  draw( (-0.9,-0.2)--(1.1, -0.1), deepgreen, EndArrow);\n  draw( (-1.4, 0.4)--(0.9, 0.8), deepgreen, EndArrow);\n  draw( (-1.4, -0.8)--(1.3, -0.6), deepgreen, EndArrow);\n  draw( (-1.3, -0.5)--(1.2, -1.6), deepgreen, EndArrow);\n\\end{asy}\n\\end{center}\nOne of $A$ and $B$ has size at least $n/2$, say $A$.\nSince $A$ has no $c$ edges,\nand uses at least $\\log_2 |A|$ colors other than $c$, we get\n\\[ \\chi \\ge 1 + \\log_2 (n/2) = \\log_2 n \\]\ncompleting the induction.\n\nOne can read the construction off from the argument above,\nbut here is a concrete description.\nFor each integer $n$, consider the tournament whose vertices are\nthe binary representations of $S  =\\{0, \\dots, n-1\\}$.\nInstantiate colors $c_1$, $c_2$, \\dots.\nThen for $v, w \\in S$,\nwe look at the smallest order bit for which they differ; say the $k$th one.\nIf $v$ has a zero in the $k$th bit, and $w$ has a one in the $k$th bit,\nwe draw $v \\to w$.\nMoreover we color the edge with color $c_k$.\nThis works and uses at most $\\left\\lceil \\log_2 n \\right\\rceil$ colors.\n\n\\begin{remark*}\n  [Motivation]\n  The philosophy ``combinatorial optimization'' applies here.\n  The idea is given any color $c$,\n  we can find sets $A$ and $B$ such that all $c$-edges point $A$ to $B$.\n  Once you realize this, the next insight is to realize\n  that you may as well color \\emph{all} the edges from $A$ to $B$ by $c$;\n  after all, this doesn't hurt the condition and makes your life easier.\n  Hence, if $f$ is the answer, we have already a proof that\n  $f(n) = 1 + \\max \\left( f(|A|), f(|B|) \\right)$\n  and we choose $|A| \\approx |B|$.\n  This optimization also gives the inductive construction.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "TST", "year": 2015}
{"id": "tst-2015-q6", "question": "Let $ABC$ be a non-equilateral triangle\nand let $M_a$, $M_b$, $M_c$ be the midpoints\nof the sides $BC$, $CA$, $AB$, respectively.\nLet $S$ be a point lying on the Euler line.\nDenote by $X$, $Y$, $Z$ the second intersections\nof $M_a S$, $M_b S$, $M_c S$ with the nine-point circle.\nProve that $AX$, $BY$, $CZ$ are concurrent.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p4628087}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a non-equilateral triangle\nand let $M_a$, $M_b$, $M_c$ be the midpoints\nof the sides $BC$, $CA$, $AB$, respectively.\nLet $S$ be a point lying on the Euler line.\nDenote by $X$, $Y$, $Z$ the second intersections\nof $M_a S$, $M_b S$, $M_c S$ with the nine-point circle.\nProve that $AX$, $BY$, $CZ$ are concurrent.\n\\end{mdframed}\nWe assume now and forever that $ABC$ is scalene since the problem\nfollows by symmetry in the isosceles case.\nWe present four solutions.\n\n\\paragraph{First solution by barycentric coordinates (Evan Chen).}\nLet $AX$ meet $M_b M_c$ at $D$,\nand let $X$ reflected over $M_b M_c$'s midpoint be $X'$.\nLet $Y'$, $Z'$, $E$, $F$ be similarly defined.\n\n\\begin{center}\n\\begin{asy}\npair M_a = dir(110);\npair M_b = dir(210);\npair M_c = dir(330);\npair A = M_b+M_c-M_a;\npair B = M_c+M_a-M_b;\npair C = M_a+M_b-M_c;\npair O = circumcenter(A, B, C);\npair S = 0.65*O;\npair N = origin;\npair X = -M_a+2*foot(N,M_a,S);\npair Y = -M_b+2*foot(N,M_b,S);\npair Z = -M_c+2*foot(N,M_c,S);\nfilldraw(unitcircle, opacity(0.1)+lightcyan, lightblue);\ndraw(M_a--M_b--M_c--cycle, lightblue);\ndraw(A--B--C--cycle, lightblue);\ndraw(X--M_a, cyan);\ndraw(Y--M_b, cyan);\ndraw(Z--M_c, cyan);\n\npair D = extension(X, A, M_b, M_c);\npair Dp = M_b+M_c-D;\n\npair E = extension(Y, B, M_c, M_a);\npair Ep = M_c+M_a-E;\npair F = extension(Z, C, M_a, M_b);\npair Fp = M_a+M_b-F;\n\ndraw(A--D, deepgreen);\ndraw(B--E, deepgreen);\ndraw(C--F, deepgreen);\n\ndraw(M_a--Dp, lightred);\ndraw(M_b--Ep, lightred);\ndraw(M_c--Fp, lightred);\n\ndraw(M_a--D, lightred+dotted);\ndraw(M_b--E, lightred+dotted);\ndraw(M_c--F, lightred+dotted);\n\ndot(\"$X$\", X, dir(250));\ndot(\"$Y$\", Y, dir(80));\ndot(\"$Z$\", Z, dir(200));\n\ndot(\"$M_a$\", M_a, dir(M_a));\ndot(\"$M_b$\", M_b, dir(M_b));\ndot(\"$M_c$\", M_c, dir(M_c));\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$S$\", S, dir(310));\ndot(\"$D$\", D, dir(D));\ndot(\"$D'$\", Dp, dir(Dp));\ndot(\"$E$\", E, dir(E));\ndot(\"$E'$\", Ep, dir(Ep));\ndot(\"$F$\", F, dir(220));\ndot(\"$F'$\", Fp, dir(Fp));\n\n/* TSQ Source:\n\nM_a = dir 110\nM_b = dir 210\nM_c = dir 330\nA = M_b+M_c-M_a\nB = M_c+M_a-M_b\nC = M_a+M_b-M_c\nO := circumcenter A B C\nS = 0.65*O R310\nN := origin R45\nX := -M_a+2*foot(N,M_a,S)\nY := -M_b+2*foot(N,M_b,S)\nZ := -M_c+2*foot(N,M_c,S)\nunitcircle 0.1 lightcyan / lightblue\nM_a--M_b--M_c--cycle lightblue\nA--B--C--cycle lightblue\nX--M_a cyan\nY--M_b cyan\nZ--M_c cyan\n\nD = extension X A M_b M_c\nD' = M_b+M_c-D\n\nE = extension Y B M_c M_a\nE' = M_c+M_a-E\nF = extension Z C M_a M_b R220\nF' = M_a+M_b-F\n\nA--D deepgreen\nB--E deepgreen\nC--F deepgreen\n\nM_a--Dp lightred\nM_b--Ep lightred\nM_c--Fp lightred\n\nM_a--D lightred dotted\nM_b--E lightred dotted\nM_c--F lightred dotted\n\n!dot(\"$X$\", X, dir(250));\n!dot(\"$Y$\", Y, dir(80));\n!dot(\"$Z$\", Z, dir(200));\n\n*/\n\\end{asy}\n\\end{center}\n\nBy Cevian Nest Theorem it suffices to\nprove that $M_a D$, $M_b E$, $M_c F$ are concurrent.\nTaking the isotomic conjugate and recalling that\n$M_a M_b A M_c$ is a parallelogram,\nwe see that it suffices to prove\n$M_a X'$, $M_b Y'$, $M_c Z'$ are concurrent.\n\nWe now use barycentric coordinates on $\\triangle M_a M_b M_c$.\nLet \\[ S = \\left( a^2S_A + t : b^2S_B + t : c^2S_C + t \\right) \\]\n(possibly $t=\\infty$ if $S$ is the centroid).\nLet $v = b^2S_B+t$, $w=c^2S_C+t$.\nHence \\[ X = \\left( -a^2 vw : (b^2w+c^2v)v : (b^2w+c^2v)w \\right). \\]\nConsequently,\n\\[ X' = \\left( a^2vw : -a^2vw + (b^2w+c^2v)w : -a^2vw + (b^2w+c^2v)v \\right) \\]\nWe can compute\n\\[ b^2w+c^2v = (bc)^2(S_B+S_C)+ (b^2+c^2)t = (abc)^2 + (b^2+c^2)t. \\]\nThus\n\\[ -a^2v+b^2w+c^2v\n  = (b^2+c^2)t + (abc)^2 - (ab)^2S_B - a^2t =\n  S_A( (ab)^2 +t ). \\]\nFinally\n\\[ X' = \\left( a^2vw :\n  S_A (c^2S_C+t) \\left( (ab)^2 +2t \\right) :\n  S_A (b^2S_B+t) \\left( (ac)^2 +2t \\right)\n  \\right) \\]\nand from this it's evident that $AX'$, $BY'$, $CZ'$ are concurrent.\n\n\\paragraph{Second solution by moving points (Anant Mudgal).}\nLet $H_a$, $H_b$, $H_c$ be feet of altitudes,\nand let $\\gamma$ denote the nine-point circle.\nThe main claim is that:\n\\begin{claim*}\n  Lines $XH_a$, $YH_b$, $ZH_c$ are concurrent,\n\\end{claim*}\n\\begin{proof}\n  In fact, we claim that the concurrence point lies on the Euler line $\\ell$.\n  This gives us a way to apply the moving points method:\n  fix triangle $ABC$ and animate $S \\in \\ell$;\n  then the map\n  \\begin{align*}\n    \\ell & \\to \\gamma \\to \\ell \\\\\n    S &\\mapsto X \\mapsto S_a \\coloneq \\ell \\cap \\ol{H_a X}\n  \\end{align*}\n  is projective, because it consists of two perspectivities.\n  So we want the analogous maps $S \\mapsto S_b$, $S \\mapsto S_c$ to coincide.\n  For this it suffices to check three positions of $S$;\n  since you're such a good customer here are four.\n  \\begin{itemize}\n    \\ii If $S$ is the orthocenter of $\\triangle M_a M_b M_c$\n    (equivalently the circumcenter of $\\triangle ABC$)\n    then $S_a$ coincides with the circumcenter of $M_a M_b M_c$\n    (equivalently the nine-point center of $\\triangle ABC$).\n    By symmetry $S_b$ and $S_c$ are too.\n\n    \\ii If $S$ is the circumcenter of $\\triangle M_a M_b M_c$\n    (equivalently the nine-point center of $\\triangle ABC$)\n    then $S_a$ coincides with the de Longchamps point of $\\triangle M_a M_b M_c$\n    (equivalently orthocenter of $\\triangle ABC$).\n    By symmetry $S_b$ and $S_c$ are too.\n\n    \\ii If $S$ is either of the intersections of the Euler\n    line with $\\gamma$, then $S = S_a = S_b = S_c$\n    (as $S = X = Y = Z$).\n  \\end{itemize}\n  This concludes the proof.\n\\end{proof}\n\n\\begin{center}\n\\begin{asy}\npair M_a = dir(110);\npair M_b = dir(210);\npair M_c = dir(330);\npair A = M_b+M_c-M_a;\npair B = M_c+M_a-M_b;\npair C = M_a+M_b-M_c;\npair O = circumcenter(A, B, C);\npair S = 0.75*O;\npair N = origin;\n\npair X = -M_a+2*foot(N,M_a,S);\npair Y = -M_b+2*foot(N,M_b,S);\npair Z = -M_c+2*foot(N,M_c,S);\n\nfilldraw(unitcircle, opacity(0.1)+lightcyan, lightblue);\ndraw(M_a--M_b--M_c--cycle, lightblue);\ndraw(A--B--C--cycle, lightblue);\ndraw(X--M_a, cyan);\ndraw(Y--M_b, cyan);\ndraw(Z--M_c, cyan);\n\npair H_a = M_b*M_c/M_a;\npair H_b = M_c*M_a/M_b;\npair H_c = M_a*M_b/M_c;\n\ndraw(X--A, deepgreen);\ndraw(Y--B, deepgreen);\ndraw(Z--C, deepgreen);\n\nfilldraw(H_a--H_b--H_c--cycle, opacity(0.1)+lightred, lightred);\ndraw(H_a--X, lightred);\ndraw(H_b--Y, lightred);\ndraw(H_c--Z, lightred);\n\ndot(\"$X$\", X, dir(250));\ndot(\"$Y$\", Y, dir(80));\ndot(\"$Z$\", Z, dir(200));\n\ndot(\"$M_a$\", M_a, dir(M_a));\ndot(\"$M_b$\", M_b, dir(M_b));\ndot(\"$M_c$\", M_c, dir(M_c));\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$S$\", S, dir(310));\ndot(\"$H_a$\", H_a, dir(H_a));\ndot(\"$H_b$\", H_b, dir(H_b));\ndot(\"$H_c$\", H_c, dir(H_c));\n\n/* TSQ Source:\n\nM_a = dir 110\nM_b = dir 210\nM_c = dir 330\nA = M_b+M_c-M_a\nB = M_c+M_a-M_b\nC = M_a+M_b-M_c\nO := circumcenter A B C\nS = 0.75*O R310\nN := origin R45\n\nX := -M_a+2*foot(N,M_a,S)\nY := -M_b+2*foot(N,M_b,S)\nZ := -M_c+2*foot(N,M_c,S)\n\nunitcircle 0.1 lightcyan / lightblue\nM_a--M_b--M_c--cycle lightblue\nA--B--C--cycle lightblue\nX--M_a cyan\nY--M_b cyan\nZ--M_c cyan\n\nH_a = M_b*M_c/M_a\nH_b = M_c*M_a/M_b\nH_c = M_a*M_b/M_c\n\nX--A deepgreen\nY--B deepgreen\nZ--C deepgreen\n\nH_a--H_b--H_c--cycle 0.1 lightred / lightred\nH_a--X lightred\nH_b--Y lightred\nH_c--Z lightred\n\n!dot(\"$X$\", X, dir(250));\n!dot(\"$Y$\", Y, dir(80));\n!dot(\"$Z$\", Z, dir(200));\n\n*/\n\\end{asy}\n\\end{center}\n\nWe now use Trig Ceva to carry over the concurrence.\nBy sine law,\n\\[ \\frac{\\sin \\angle M_{c}AX}{\\sin \\angle AM_{c}X}\n  =\\frac{M_{c}X}{AX} \\]\nand a similar relation for $M_b$ gives that\n\\[ \\frac{\\sin \\angle M_{c}AX}{\\sin \\angle M_{b}AX}\n  = \\frac{\\sin \\angle AM_{c}X}{\\sin \\angle AM_{b}X} \\cdot \\frac{M_{c}X}{M_{b}X}\n  = \\frac{\\sin \\angle AM_{c}X}{\\sin \\angle AM_{b}X}\n  \\cdot \\frac{\\sin \\angle XM_{a}M_{c}}{\\sin \\angle XM_{a}M_{b}}. \\]\nThus multiplying cyclically gives\n\\[ \\prod_{\\text{cyc}} \\frac{\\sin \\angle M_{c}AX}{\\sin \\angle M_{b}AX}\n  = \\prod_{\\text{cyc}} \\frac{\\sin \\angle AM_{c}X}{\\sin \\angle AM_{b}X}\n  \\prod_{\\text{cyc}} \\frac{\\sin \\angle XM_{a}M_{c}}{\\sin \\angle XM_{a}M_{b}}. \\]\nThe latter product on the right-hand side equals $1$\nby Trig Ceva on $\\triangle M_a M_b M_c$ with cevians\n$\\ol{M_a X}$, $\\ol{M_b Y}$, $\\ol{M_c Z}$.\nThe former product also equals $1$\nby Trig Ceva for the concurrence in the previous claim\n(and the fact that $\\angle AM_{c}X=\\angle H_{c}H_{a}X$).\nHence the left-hand side equals $1$, implying the result.\n\n\\paragraph{Third solution by moving points (Gopal Goel).}\nIn this solution,\nwe will instead use barycentric coordinates with resect to $\\triangle ABC$\nto bound the degrees suitably,\nand then verify for seven distinct choices of $S$.\n\nWe let $R$ denote the radius of $\\triangle ABC$,\nand $N$ the nine-point center.\n\nFirst, imagine solving for $X$ in the following way.\nSuppose $\\vec X = (1-t_a) \\vec M_a + t_a \\vec S$.\nThen, using the dot product\n(with $\\left\\lvert \\vec v \\right\\rvert^2 = \\vec v \\cdot \\vec v$ in general)\n\\begin{align*}\n  \\frac14 R^2\n  &= \\left\\lvert \\vec X - \\vec N \\right\\rvert^2 \\\\\n  &= \\left\\lvert t_a(\\vec S - \\vec M_a) + \\vec M_a - \\vec N \\right\\rvert^2 \\\\\n  &= \\left\\lvert t_a(\\vec S - \\vec M_a) \\right\\rvert^2\n    + 2t_a \\left( \\vec S - \\vec M_a \\right) \\cdot \\left( \\vec M_a - \\vec N \\right)\n    + \\left\\lvert \\vec M_a - \\vec N \\right\\rvert^2 \\\\\n  &= t_a^2 \\left\\lvert (\\vec S - \\vec M_a) \\right\\rvert^2\n    + 2t_a \\left( \\vec S - \\vec M_a \\right) \\cdot \\left( \\vec M_a - \\vec N \\right)\n    + \\frac 14 R^2\n\\end{align*}\nSince $t_a \\neq 0$ we may solve to obtain\n\\[ t_a = -\\frac{2(\\vec M_a - \\vec N) \\cdot (\\vec S - \\vec M_a)}%\n  {\\left\\lvert \\vec S - \\vec M_a \\right\\rvert^2}.  \\]\nNow imagine $S$ varies along the Euler line,\nmeaning there should exist linear functions\n$\\alpha, \\beta, \\gamma \\colon \\RR \\to \\RR$ such that\n\\[ S = \\left( \\alpha(s) , \\beta(s) , \\gamma(s) \\right)\n  \\qquad s \\in \\RR \\]\nwith $\\alpha(s) + \\beta(s) + \\gamma(s) = 1$.\nThus $t_a = \\frac{f_a}{g_a} = \\frac{f_a(s)}{g_a(s)}$\nis the quotient of a linear function\n$f_a(s)$ and a quadratic function $g_a(s)$.\n\nSo we may write:\n\\begin{align*}\n  X &= (1-t_a) \\left( 0, \\half, \\half \\right)\n    + t_a \\left( \\alpha, \\beta, \\gamma \\right) \\\\\n  &= \\left( t_a \\alpha, \\half(1-t_a) + t_a \\beta,\n    \\half(1-t_a) + t_a \\gamma \\right) \\\\\n  &= \\left( 2f_a \\alpha : g_a - f_a + 2f_a \\beta : g_a - f_a + 2 f_a \\gamma \\right).\n\\end{align*}\nThus the coordinates of $X$ are quadratic polynomials in $s$\nwhen written in this way.\n\nIn a similar way, the coordinates of $Y$ and $Z$\nshould be quadratic polynomials in $s$.\nThe Ceva concurrence condition\n\\[ \\prod_{\\text{cyc}} \\frac{g_a-f_a+2f_a\\beta}{g_a-f_a+2f_a\\gamma}\n  = 1 \\]\nis thus a polynomial in $s$ of degree at most six.\nOur goal is to verify it is identically zero,\nthus it suffices to check seven positions of $S$.\n\n\\begin{itemize}\n  \\ii If $S$ is the circumcenter of $\\triangle M_a M_b M_c$\n  (equivalently the nine-point center of $\\triangle ABC$)\n  then $\\ol{AX}$, $\\ol{BY}$, $\\ol{CZ}$\n  are altitudes of $\\triangle ABC$.\n\n  \\ii If $S$ is the centroid of $\\triangle M_a M_b M_c$\n  (equivalently the centroid of $\\triangle ABC$),\n  then $\\ol{AX}$, $\\ol{BY}$, $\\ol{CZ}$\n  are medians of $\\triangle ABC$.\n\n  \\ii If $S$ is either of the intersections of the Euler\n  line with $\\gamma$, then $S = X = Y = Z$\n  and all cevians concur at $S$.\n\n  \\ii If $S$ lies on the $\\ol{M_a M_b}$,\n  then $Y = M_a$, $X = M_c$, and thus $\\ol{AX} \\cap \\ol{BY} = C$,\n  which is of course concurrent with $\\ol{CZ}$\n  (regardless of $Z$).\n  Similarly if $S$ lies on the other sides of $\\triangle M_a M_b M_c$.\n\\end{itemize}\nThus we are also done.\n\n\\paragraph{Fourth solution using Pascal (official one).}\nWe give a different proof of the claim that\n$\\ol{XH_a}$, $\\ol{YH_b}$, $\\ol{ZH_c}$ are concurrent\n(and then proceed as in the end of the second solution).\n\nLet $H$ denote the orthocenter, $N$ the nine-point center,\nand moreover let $N_a$, $N_b$, $N_c$ denote the midpoints\nof $\\ol{AH}$, $\\ol{BH}$, $\\ol{CH}$,\nwhich also lie on the nine-point circle\n(and are the antipodes of $M_a$, $M_b$, $M_c$).\n\\begin{itemize}\n  \\ii By Pascal's theorem on $M_b N_b H_b M_c N_c H_c$,\n  the point $P = \\ol{M_c H_b} \\cap \\ol{M_b H_c}$\n  is collinear with $N = \\ol{M_b N_b} \\cap \\ol{M_c N_c}$,\n  and $H = \\ol{N_b H_b} \\cap \\ol{N_c H_c}$.\n  So $P$ lies on the Euler line.\n\n  \\ii By Pascal's theorem on $M_b Y H_b M_c Z H_c$,\n  the point $\\ol{YH_b} \\cap \\ol{ZH_c}$ is collinear\n  with $S = \\ol{M_b Y} \\cap \\ol{M_c Z}$\n  and $P = \\ol{M_b H_c} \\cap \\ol{M_c H_b}$.\n  Hence $YH_b$ and $ZH_c$ meet on the Euler line, as needed.\n\\end{itemize}\n\\pagebreak\n\n\n\\end{document}", "category": "Geometry", "source": "TST", "year": 2015}
{"id": "egmo-2015-q1", "question": "Let $\\triangle ABC$ be an acute-angled triangle,\nand let $D$ be the foot of the altitude from $C$.\nThe angle bisector of $\\angle ABC$ intersects $CD$ at $E$ and\nmeets the circumcircle $\\omega$ of $\\triangle ADE$ again at $F$.\nIf $\\angle ADF = 45^{\\circ}$, show that $CF$ is tangent to $\\omega$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p4725314}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $\\triangle ABC$ be an acute-angled triangle,\nand let $D$ be the foot of the altitude from $C$.\nThe angle bisector of $\\angle ABC$ intersects $CD$ at $E$ and\nmeets the circumcircle $\\omega$ of $\\triangle ADE$ again at $F$.\nIf $\\angle ADF = 45^{\\circ}$, show that $CF$ is tangent to $\\omega$.\n\\end{mdframed}\n\\begin{center}\n\\begin{asy}\npair A = dir(0);\npair B = dir(180);\npair F = dir(65);\npair D = extension(A, B, F, dir(205));\npair K = F*F;\npair C = extension(D, D+dir(90), B, K);\npair E = extension(B, F, C, D);\n\nfilldraw(unitcircle, palecyan+opacity(0.2), heavyblue);\nfilldraw(circumcircle(A, D, E), palered+opacity(0.2), red+dotted);\n\nfilldraw(CP(E,D), pink+opacity(0.2), magenta);\ndraw(arc(F,abs(E-F),170,310), orange+dashed);\n\ndraw(K--A--B--C--D, deepcyan);\ndraw(C--A, deepcyan+dashed);\ndraw(B--F--A, deepgreen);\ndraw(F--D, deepgreen);\ndraw(C--F, mediumred);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$F$\", F, dir(F));\ndot(\"$D$\", D, dir(225));\ndot(\"$K$\", K, dir(K));\ndot(\"$C$\", C, dir(C));\ndot(\"$E$\", E, dir(165));\n\\end{asy}\n\\end{center}\n\nLet $BC$ meet the circle with diameter $\\ol{AB}$ at $K$.\nBy the conditions of the problem, we have $FK = FE = FA$.\nThus $E$ is the incenter of $\\triangle KBA$.\n\nBy angle chasing, we can now show that\n\\[ \\angle KFE = 90^{\\circ} - \\frac12 \\angle KEF = \\angle BCD, \\]\nso $KCFE$ is cyclic and thus\n\\[ \\angle CKE = 135^{\\circ} \\implies \\angle CFE = 45^{\\circ} \\]\nas needed.\n\\begin{remark*}\n  One can also realize $CKEF$ is cyclic by noting\n  \\[ BE \\cdot BF = BD \\cdot BA = BK \\cdot BC. \\]\n\\end{remark*}\n\n\\begin{remark*}\n  Another approach is to use barycentric coordinates on $\\triangle ABK$.\n  Letting $a=BK$, $b=AK$, $c=AB$ we have $E = (a:b:c)$, $D = (s-b:s-a:0)$, and\n  \\[ F = (a(a+c) : -b^2 : c(a+c))\n    = (a(a+c) : a^2-c^2 : c(a+c))\n  = (a : a-c : c). \\]\n\\end{remark*}\n\\pagebreak", "category": "Geometry", "source": "EGMO", "year": 2015}
{"id": "egmo-2015-q2", "question": "A \\emph{domino} is a $2 \\times 1$ or $1 \\times 2$ tile.\nDetermine in how many ways exactly $n^2$ dominoes can be placed\nwithout overlapping on a $2n \\times 2n$ chessboard\nso that every $2 \\times 2$ square contains at least\ntwo uncovered unit squares which lie in the same row or column.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p4725316}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA \\emph{domino} is a $2 \\times 1$ or $1 \\times 2$ tile.\nDetermine in how many ways exactly $n^2$ dominoes can be placed\nwithout overlapping on a $2n \\times 2n$ chessboard\nso that every $2 \\times 2$ square contains at least\ntwo uncovered unit squares which lie in the same row or column.\n\\end{mdframed}\nGeneralizing the problem slightly,\nthe answer is $\\binom{m+n}{n}^2$ for a $2m \\times 2n$ rectangle,\n\nThe proof is the following nice bijection\nbetween valid domino tilings and pairs of lattice paths joining\nopposite corners of the grid, that travel along the borders of the\nobvious $2 \\times 2$ squares.\n\n\\begin{center}\n\\begin{asy}\nsize(10cm);\npen[] colors = {olive, deepmagenta, heavycyan, heavygreen};\n\nfill((0,0)--(2,0)--(2,4)--(4,4)--(4,8)--(0,8)--cycle, cyan+opacity(0.2));\nfill((2,0)--(6,0)--(6,2)--(4,2)--(4,4)--(2,4)--cycle, green+opacity(0.2));\nfill(box((4,4),(6,8)), purple+opacity(0.2));\nfill((4,2)--(6,2)--(6,0)--(8,0)--(8,8)--(6,8)--(6,4)--(4,4)--cycle, yellow+opacity(0.2));\n\nfor (int i=1; i<=4; ++i) {\n  draw((0,2*i-1)--(8,2*i-1), lightgray+1);\n  draw((2*i-1,0)--(2*i-1,8), lightgray+1);\n}\nfor (int i=0; i<=4; ++i) {\n  draw((0,2*i)--(8,2*i), gray+1.5+linetype(\"3 2\"));\n  draw((2*i,0)--(2*i,8), gray+1.5+linetype(\"3 2\"));\n}\n\npath red_path = (0,0)--(2,0)--(2,4)--(6,4)--(6,8)--(8,8);\npath blue_path = (0,8)--(4,8)--(4,2)--(6,2)--(6,0)--(8,0);\ndraw(red_path, lightred+7);\ndraw(red_path, heavyred+3);\ndraw(blue_path, lightcyan+7);\ndraw(blue_path, blue+3);\n\nreal eps = 0.22;\npath dom = (eps,1-eps)--(1-eps,1-eps)--(1-eps,eps-1)--(eps,eps-1)--cycle;\nvoid draw_domino(real x, real y, int n) {\n  filldraw(\n    shift(2*x-1,2*y-1)*rotate(90*n)*dom,\n    colors[n]+opacity(0.7),\n    black+1.3\n  );\n}\n\ndraw_domino(4,4,0); draw_domino(4,3,0); draw_domino(4,2,0); draw_domino(4,1,0); draw_domino(3,2,0);\ndraw_domino(3,3,1); draw_domino(3,4,1);\ndraw_domino(1,1,2); draw_domino(1,2,2); draw_domino(1,3,2); draw_domino(1,4,2); draw_domino(2,3,2); draw_domino(2,4,2);\ndraw_domino(2,2,3); draw_domino(2,1,3); draw_domino(3,1,3);\n\\end{asy}\n\\end{center}\n\n\\begin{remark*}\n  The main reason I was able to make the correct guess\n  of the answer was because I generalized\n  the problem to rectangular boards rather than to square boards.\n  Three possible motivations:\n  \\begin{itemize}\n    \\ii The problem felt very recursive,\n    in that smaller instances of the problem would appear as sub-cases.\n    In particular, my computation for $(m,n)=(2,2)$ requires $(m,n)=(2,1)$ as a subcase anyways.\n    \\ii The problem makes it otherwise too difficult to examine small cases.\n    \\ii $(m,n)=(2,1)$ gives another perfect square $3^2=9$\n    so there is good reason to believe that something is going on here too.\n  \\end{itemize}\n  Once you have the guess down, it becomes more clear that\n  any recursive solution is likely to fail (due to the square),\n  and one needs to find a ``combinatorial'' interpretation for the problem.\n  The two paths as shown is a natural one,\n  and with a little work one gets the bijection above.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "EGMO", "year": 2015}
{"id": "egmo-2015-q3", "question": "Let $n, m$ be integers greater than $1$,\nand let $a_1, a_2, \\dots, a_m$ be positive integers\nnot greater than $n^m$.\nProve that there exist integers $b_1, b_2, \\dots, b_m$ not greater than $n$ such that\n\\[ \\gcd(a_1 + b_1, a_2 + b_2, \\dots, a_m + b_m) < n. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p4725324}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n, m$ be integers greater than $1$,\nand let $a_1, a_2, \\dots, a_m$ be positive integers\nnot greater than $n^m$.\nProve that there exist integers $b_1, b_2, \\dots, b_m$ not greater than $n$ such that\n\\[ \\gcd(a_1 + b_1, a_2 + b_2, \\dots, a_m + b_m) < n. \\]\n\\end{mdframed}\nIn fact, we will prove that it's possible to choose $b_i \\in \\{0,1\\}$!\n\nAssume not, and all GCD's are at least $n$.\nConsider the choices:\n\\begin{itemize}\n  \\ii $b_1 = \\dots = b_m = 0$.\n  \\ii $b_1 = b_2 = \\dots = b_{k-1} = b_{k+1} = b_m = 0$ and $b_k = 1$,\n  for some $2 \\le k \\le m$.\n\\end{itemize}\nThis generates $m$ gcd's, say $g_1$, \\dots, $g_m$.\nEach divides $a_1$.\nMoreover, they are pairwise coprime, s\n\\[ a_1 \\ge \\prod_i g_i = n(n+1) \\dots + (n+m-1) > n^m \\]\nwhich is impossible.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Number Theory", "source": "EGMO", "year": 2015}
{"id": "egmo-2015-q4", "question": "Determine whether or not there exists an infinite sequence\n$a_1$, $a_2$, \\dots\\ of positive integers satisfying\n\\[ a_{n+2} = a_{n+1} + \\sqrt{a_{n+1}+a_{n}} \\]\nfor every positive integer $n$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p4728593}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nDetermine whether or not there exists an infinite sequence\n$a_1$, $a_2$, \\dots\\ of positive integers satisfying\n\\[ a_{n+2} = a_{n+1} + \\sqrt{a_{n+1}+a_{n}} \\]\nfor every positive integer $n$.\n\\end{mdframed}\nIn fact, we will show the following stronger result:\nthe largest $N$ for which one can find $(a_1, \\dots, a_N)$ satisfying\n(for all $1 \\le n \\le N-2$) is actually $N = 5$.\nThis largest $N$ is obtained\nfor example by $(a_1,a_2,a_3,a_4,a_5) = (477,7,29,35,43)$.\n\\begin{remark*}\n  Basically, the idea is to choose $a_3$ first; then as long as the number\n  \\[ s \\coloneq \\sqrt{a_3 + a_4} = \\sqrt{2a_3 + \\sqrt{a_2 + a_3}} \\]\n  is as integer, the rest of the sequence can be chosen to have integer values.\n  Unfortunately, $a_1$ may turn out to be negative in this situation.\n  But if one experiments with numbers, it should be possible to ensure $a_2 < a_3$,\n  and after this no further obstructions arise.\n\n  For example, if one makes the arbitrary starting choice $s = 10$,\n  then choosing $a_3 = 46$ gives the nice choice $a_2 = 18$, thus $a_1 = 766$.\n  (We picked this number so that $2a_3 + \\sqrt{a_3}$ was just under $100$.)\n  Meanwhile, moving forward, $a_4 = 46 + \\sqrt{46+18} = 54$\n  and $a_5 = 54 + \\sqrt{46+54} = 64$.\n  Hence $(a_1,a_2,a_3,a_4,a_5) = (766, 18, 46, 54, 64)$ is another example.\n\\end{remark*}\n\nLet\n\\[ x_n \\coloneq a_{n+1}-a_n = \\sqrt{a_{n}+a_{n-1}}. \\]\nWe will rewrite everything in terms of the $(x_n)$.\nSince the $(a_n)$ are strictly increasing for $n \\ge 2$\nso are the $(x_n)$ when $n \\ge 3$.\nFor $n \\ge 2$ observe that\n\\[ x_{n+1}^2 - x_n^2 = a_{n+1} - a_{n-1}\n  = \\left( a_{n+1}-a_{n} \\right) + \\left( a_{n}-a_{n-1} \\right) = x_n + x_{n-1} \\]\nthus\n\\[ x_{n+1}-x_n = \\frac{x_n+x_{n-1}}{x_{n+1}+x_n}. \\]\nBut suppose $n \\ge 4$.\nThen since the $x_n$ are supposed to be strictly increasing, the right-hand side is $< 1$.\nYet $x_{n+1} - x_n \\ge 1$ as well, which is a contradiction.\n\nThus it is impossible to have six terms in the sequence.\n\\pagebreak", "category": "Algebra", "source": "EGMO", "year": 2015}
{"id": "egmo-2015-q5", "question": "Let $m, n$ be positive integers with $m > 1$.\nAnastasia partitions the integers $1, 2, \\dots , 2m$ into $m$ pairs.\nBoris then chooses one integer from each pair\nand finds the sum of these chosen integers.\nProve that Anastasia can select the pairs\nso that Boris cannot make his sum equal to $n$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p4728599}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $m, n$ be positive integers with $m > 1$.\nAnastasia partitions the integers $1, 2, \\dots , 2m$ into $m$ pairs.\nBoris then chooses one integer from each pair\nand finds the sum of these chosen integers.\nProve that Anastasia can select the pairs\nso that Boris cannot make his sum equal to $n$.\n\\end{mdframed}\nOverall the idea is to try find a few constructions which eliminate most of the cases,\nthen clean out the last few ones leftover.\n% (It's like using reavers on zerglings:\n% knock out 90\\% of the lings with a couple scarabs\n% and then have the zealots finish the rest.)\n\n\\begin{itemize}\n  \\ii If $n \\notin [m^2, m^2+m]$, then use the construction\n  \\[\n  \\begin{array}{ccccc}\n    1 & 3 & \\dots & 2m-3 & 2m-1 \\\\\n    2 & 4 & \\dots & 2m-2 & 2m\n  \\end{array}\n  \\]\n\n  \\ii If $n \\not\\equiv 1 + 2 + \\dots + m = \\half m(m+1) \\pmod m$, use the construction\n  \\[\n  \\begin{array}{ccccc}\n    1 & 2 & \\dots & m-1 & m \\\\\n    m+1 & m+2 & \\dots & 2m-1 & 2m\n  \\end{array}\n  \\]\n\\end{itemize}\nHenceforth, assume $m \\ge 4$ (smaller cases can be dispensed with by hand).\n\\begin{itemize}\n  \\ii Assume $m$ is odd, and either $n = m^2$ and $n = m^2 + m$.\n  Use the construction\n  \\[\n    \\begin{array}{ccccc}\n      1 & 2 & \\dots & m-1 & m \\\\\n      m+2 & m+3 & \\dots & 2m & m+1\n    \\end{array}.\n  \\]\n  The possible values of this modulo $m+1$ are\n  \\[ \\tfrac 12 m(m+1) + \\{0,1\\} \\equiv \\tfrac12(m+1) + \\{0,1\\} \\pmod{m+1} \\]\n  since $m$ is odd.\n  But $m^2$ and $m^2+m$ leave residues $1$ and $2$ modulo $m$, done.\n\n  \\ii Assume $m$ is even (so $m+1$ is odd), and $n = m^2 + \\half m \\equiv \\half \\pmod{m+1}$.\n  The same pairing as before has possible residues\n  \\[ \\tfrac 12m (m+1) + \\{0,1\\} \\equiv \\{0,1\\} \\pmod{m+1}. \\]\n  This completes the proof.\n\\end{itemize}\n\\pagebreak", "category": "Combinatorics", "source": "EGMO", "year": 2015}
{"id": "egmo-2015-q6", "question": "Let $H$ be the orthocenter and $G$ be the centroid of\nacute-angled triangle $ABC$ with $AB \\neq AC$.\nThe line $AG$ intersects the circumcircle\nof $ABC$ at $A$ and $P$.\nLet $P'$ be the reflection of $P$ in the line $BC$.\nProve that $\\angle CAB = 60$ if and only if $HG = GP'$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p4728597}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $H$ be the orthocenter and $G$ be the centroid of\nacute-angled triangle $ABC$ with $AB \\neq AC$.\nThe line $AG$ intersects the circumcircle\nof $ABC$ at $A$ and $P$.\nLet $P'$ be the reflection of $P$ in the line $BC$.\nProve that $\\angle CAB = 60$ if and only if $HG = GP'$.\n\\end{mdframed}\nThe following complex numbers solution was given by Stefan Tudose.\nFirst\n\\[ \\frac{pa(b+c)-bc(p+a)}{pa-bc}\n= \\frac{b+c}{2} \\implies p\n= -\\frac{2bc-ab-ac}{bc(2a-b-c)}. \\]\nThen\n\\[ p' = b+c-bc\\ol p = \\frac{ab+ac-b^2-c^2}{2a-b-c}. \\]\n\nNow let $D$ be the midpoint of $\\ol{HP'}$.\nThen\n\\begin{align*}\n  d = \\frac{h+p'}{2} & = \\frac{a^2-b^2-c^2+ab+ac-bc}{2a-b-c} \\\\\n  h-p' &= \\frac{2(a^2-bc)}{2a-b-c} \\\\\n  g-d &= \\frac{2b^2+2c^2-a^2+bc-2ab-2ac}{3(2a-b-c)}\n\\end{align*}\nThen $HG = GP' \\iff \\ol{GD} \\perp \\ol{HP'}$ and we have\n\\[\n  \\frac{g-d}{h-p'}\n  = \\frac{2b^2+2c^2-a^2+bc-2ab-2ac}{6(a^2-bc)}\n\\]\nwhich we would like to be pure imaginary.\nHowever the negative conjugate equals\n\\[\n  \\ol{\\left( \\frac{g-d}{h-p'} \\right)}\n  = -\\frac{2a^2c^2+2a^2b^2-b^2c^2+a^2bc-2abc^2-2ab^2c}{6bc(bc-a^2)}.\n\\]\nExpanding, the condition we have becomes\n\\[ b^3c+bc^3+b^2c^2=a^2bc+a^2c^2+a^2b^2\n  \\iff (b^2+bc+c^2)(a^2-bc) = 0. \\]\nNow $b^2+bc+c^2=0 \\iff \\angle A = 60\\dg$ as desired.\n\n\\begin{remark*}\n  One can also proceed by $|g-h| = |g-p'|$\n  which is longer but ultimately the same calculation.\n\\end{remark*}\n\\begin{remark*}\n  The condition $AB \\neq AC$ is not cosmetic;\n  it cannot be dropped from the problem condition.\n  This is reflected in the presence of $a^2-bc$ factor.\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Geometry", "source": "EGMO", "year": 2015}
{"id": "egmo-2013-q1", "question": "The side $BC$ of the triangle $ABC$\nis extended beyond $C$ to $D$ so that $CD = BC$.\nThe side $CA$ is extended beyond $A$ to $E$ so that $AE = 2CA$.\nProve that if $AD=BE$ then the triangle $ABC$ is right-angled.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3013167}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nThe side $BC$ of the triangle $ABC$\nis extended beyond $C$ to $D$ so that $CD = BC$.\nThe side $CA$ is extended beyond $A$ to $E$ so that $AE = 2CA$.\nProve that if $AD=BE$ then the triangle $ABC$ is right-angled.\n\\end{mdframed}\nLet ray $DA$ meet $\\ol{BE}$ at $M$.\nConsider the triangle $EBD$.\nSince the point lies on median $\\ol{EC}$, and $EA = 2AC$,\nit follows that $A$ is the centroid of $\\triangle EBD$.\n\n\\begin{center}\n\\begin{asy}\npair A = dir(50);\npair B = dir(180);\npair C = dir(0);\ndraw(A--B--C--cycle, black+1.4);\npair D = 2*C-B;\npair E = 3*A-2*C;\ndraw(C--D);\ndraw(A--E);\ndraw(B--E, dotted);\ndraw(A--D, dotted);\n\npair M = extension(A, D, B, E);\ndraw(B--E--D--M);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(-90));\ndot(\"$C$\", C, dir(-90));\ndot(\"$D$\", D, dir(D));\ndot(\"$E$\", E, dir(E));\ndot(\"$M$\", M, dir(M));\n\n/* TSQ Source:\n\nA = dir 50\nB = dir 180 R-90\nC = dir 0 R-90\nA--B--C--cycle black+1.4\nD = 2*C-B\nE = 3*A-2*C\nC--D\nA--E\nB--E dotted\nA--D dotted\n\nM = extension A D B E\nB--E--D--M\n\n*/\n\\end{asy}\n\\end{center}\n\n\nSo $M$ is the midpoint of $\\ol{BE}$.\nMoreover $MA = \\frac 12 AD = \\frac 12 BE$; so $MA = MB = ME$ and hence $\\triangle ABE$ is inscribed in a circle with diameter $\\ol{BE}$.\nThus $\\angle BAE = 90\\dg$, so $\\angle BAC = 90\\dg$.\n\\pagebreak", "category": "Geometry", "source": "EGMO", "year": 2013}
{"id": "egmo-2013-q2", "question": "Determine all integers $m$ for which the $m \\times m$ square can be dissected\ninto five rectangles, the side lengths of which are\nthe integers $1$, $2$, \\dots, $10$ in some order.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3013170}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nDetermine all integers $m$ for which the $m \\times m$ square can be dissected\ninto five rectangles, the side lengths of which are\nthe integers $1$, $2$, \\dots, $10$ in some order.\n\\end{mdframed}\nThe answer is that this is possible if and only if $m = 11$ or $m = 13$.\n\n\\paragraph{Constructions for $m=11$ and $m=13$.}\nSee the figures below.\n\\begin{center}\n\\begin{asy}\nsize(12cm);\npicture p11, p13;\npen b = black+2.5;\nfilldraw(p11, box((0,0), (11,11)), palegreen, b);\nfilldraw(p11, box((0,0), (8,5)), palecyan, b);\nfilldraw(p11, box((7,9), (11,11)), palecyan, b);\nfilldraw(p11, box((8,0), (11,9)), palered, b);\nfilldraw(p11, box((0,5), (7,11)), palered, b);\nfor (int i=0; i<11; ++i) {\nfor (int j=0; j<11; ++j) {\n  draw(p11, shift(i,j)*unitsquare, black);\n}\n}\nadd(p11);\n\nfilldraw(p13, box((0,0), (13,13)), palegreen, b);\nfilldraw(p13, box((0,0), (8,3)), palecyan, b);\nfilldraw(p13, box((6,4), (13,13)), palecyan, b);\nfilldraw(p13, box((8,0), (13,4)), palered, b);\nfilldraw(p13, box((0,3), (6,13)), palered, b);\nfor (int i=0; i<13; ++i) {\nfor (int j=0; j<13; ++j) {\n  draw(p13, shift(i,j)*unitsquare, black);\n}\n}\nadd(shift(13,-1)*p13);\n\\end{asy}\n\\end{center}\n\n\\paragraph{Proof the task is impossible unless $11 \\le m \\le 13$.}\nThe total area of the rectangles is of the form $A = a_1 b_1 + \\dots + a_5 b_5$\nfor $(a_1, \\dots, b_5)$ a permutation of $(1, \\dots, 10)$.\nBy applying the rearrangement inequality repeatedly one can prove that\n\\[ A \\le 1 \\cdot 2 + 3 \\cdot 4 + 5 \\cdot 6 + 7 \\cdot 8 + 9 \\cdot 10 = 190. \\]\nAnalogously, we can get a matching lower bound\n\\[ A \\ge 1 \\cdot 10 + 2 \\cdot 9 + 3 \\cdot 8 + 4 \\cdot 7 + 5 \\cdot 6 = 110. \\]\nSince $A = m^2$ for integer $m$, it follows $11 \\le m \\le 13$.\n\n\\paragraph{Proof the task is impossible for $m=12$.}\nIt remains to rule out such a tiling for a $12 \\times 12$ square.\nWe start with the following structure claim:\n\\begin{claim*}\n  Any tiling for $m > 10$ must either be the spiral pattern below or a reflection of it.\n  \\begin{center}\n  \\begin{asy}\n    size(3cm);\n    draw(box((0,0),(7,7)), black+1.5);\n    draw((0,2)--(5,2), black+1);\n    draw((5,0)--(5,4), black+1);\n    draw((3,4)--(7,4), black+1);\n    draw((3,7)--(3,2), black+1);\n  \\end{asy}\n  \\end{center}\n\\end{claim*}\n\\begin{proof}\n  Label the square $ABCD$.\n  Because $m > 10$, each corner of the square must be part of a different rectangle.\n  Consider the rectangle covering $A$, and let the vertex opposite $A$ be $A'$.\n  Define $B'$, $C'$, $D'$ similarly.\n\n  We contend that no two of $A'$, $B'$, $C'$, $D'$ coincide.\n  Indeed, if $A' = C'$, then we get the figure on the left where the two\n  purple rectangles are part of the tiling.\n  The remaining two ``quadrants'' must be dissected into three rectangles,\n  but there is general a quadrant cannot be divided into either $2$ or $3$ rectangles\n  in aw way that doesn't create two equal lengths.\n  \\begin{center}\n  \\begin{asy}\n    size(7cm);\n    picture pl;\n    draw(pl, box((0,0),(7,7)), black+1.5);\n    label(pl, \"$A$\", (0,0), dir(225));\n    label(pl, \"$B$\", (7,0), dir(315));\n    label(pl, \"$C$\", (7,7), dir(45));\n    label(pl, \"$D$\", (0,7), dir(135));\n    dotfactor *= 2;\n    picture pr = rotate(0)*pl;\n    filldraw(pl, box((0,0), (5,3)), mediummagenta, black+1.5);\n    filldraw(pl, box((7,7), (5,3)), mediummagenta, black+1.5);\n    filldraw(pr, box((0,0), (5,3)), mediummagenta, black+1.5);\n    filldraw(pr, box((5,3), (7,0)), mediummagenta, black+1.5);\n    label(pl, \"$A'=C'$\", (5,3), dir(135));\n    label(pr, \"$A'=B'$\", (5,3), dir(90));\n    dot(pl, (5,3));\n    dot(pr, (5,3));\n    add(shift(0,0)*pl);\n    add(shift(11,0)*pr);\n  \\end{asy}\n  \\end{center}\n  Meanwhile, if $A' = B'$, the two purple rectangles\n  already obviously have a common dimension (right figure).\n\n  Hence $A'$, $B'$, $C'$, $D'$ are all different points.\n  They must each be part of some rectangle not using the corner.\n  Moreover, every rectangle in the dissection has at least one vertex\n  not on the boundary of the square.\n  So the fifth rectangle must be $A'B'C'D'$ exactly.\n\\end{proof}\n\nNow on to the proof that $m = 12$ is impossible.\nAssume for contradiction a construction exists and refer to the spiral figure above.\nNote that because $12 > 1 + 10$,\nthe side length $1$ cannot belong to any edge of the outer $12 \\times 12$ square.\nThis means that $1$ must be a side length of the center rectangle.\nMoreover, because the outer square has perimeter $48$,\nand we know $1+2+\\dots+10 = 55$, the center rectangle has perimeter $7$.\nIn other words, the inner rectangle must be $1 \\times 6$ exactly.\n\\begin{center}\n\\begin{asy}\n  size(5cm);\n  draw(box((0,0),(12,12)), black+1.5);\n  draw((0,2)--(5,2), black+1);\n  draw((5,0)--(5,8), black+1);\n  draw((4,8)--(12,8), black+1);\n  draw((4,12)--(4,2), black+1);\n  label(\"$6$\", (5,4), dir(0));\n  label(\"$1$\", (4.5,8), dir(90));\n\\end{asy}\n\\end{center}\nHence, we would need to partition the remaining numbers $\\{2,3,4,5,7,8,9,10\\}$\ninto eight pairs such that two pairs differ by $1$ and differ by $6$\n(in the picture, the paired numbers are on opposite sides of the square).\nNote that $7$ must be paired with $8$ (since $7 \\pm 6$ and $7-1$ are not available)\nand $5$ must be paired with $4$ (since $5 \\pm 6$ and $5+1$ are not available).\nBut then the remaining pairs need to have difference $6$,\nand there is no way to form two such pairs from $\\{2,3,9,10\\}$.\nThis produces the desired contradiction.\n\\pagebreak", "category": "Geometry", "source": "EGMO", "year": 2013}
{"id": "egmo-2013-q3", "question": "Let $n$ be a positive integer.\n\\begin{enumerate}\n  \\ii[(a)]\n  Prove that there exists a set $S$ of $6n$ positive integers\n  such that the least common multiple of any two is at most $32n^2$.\n  \\ii[(b)]\n  Show that every set $T$ of $6n$ positive integers\n  contains two elements with least common multiple\n  exceeding $9n^2$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3013178}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n$ be a positive integer.\n\\begin{enumerate}\n  \\ii[(a)]\n  Prove that there exists a set $S$ of $6n$ positive integers\n  such that the least common multiple of any two is at most $32n^2$.\n  \\ii[(b)]\n  Show that every set $T$ of $6n$ positive integers\n  contains two elements with least common multiple\n  exceeding $9n^2$.\n\\end{enumerate}\n\\end{mdframed}\nFor part (a), let\n\\[ S = \\{1, 2, \\dots, 4n\\} \\cup \\{4n+2, 4n+4, \\dots, 8n\\} \\]\nwhich works.\n\nFor (b),\nthe main idea is as follows.\nLet $x_0 < x_1 < \\dots < x_m$ be these integers.\nAssume for contradiction the LCM's are less than $L$.\nThe main idea is the estimate\n\\[\n  L\n  \\ge \\frac{x_i x_{i+1}}{\\gcd(x_i, x_{i+1})}\n  \\ge \\frac{x_i x_{i+1}}{x_{i+1} - x_i}\n\\]\nwhence\n\\[ \\frac{1}{L} \\le \\frac{1}{x_i} - \\frac{1}{x_{i+1}}. \\]\nso taking the sum starting from any $k$ gives\n\\[ \\frac{m+1-k}{L} \\le \\frac{1}{x_k} - \\frac{1}{x_m} < \\frac 1{x_k}. \\]\nFor $(k,m) = (3n,6n)$ and $L = 9n^2$ this is a contradiction\n(since $x_k \\ge 3n$).\n\n\\begin{remark*}\n  China TST 2007/6 follows the same idea.\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Number Theory", "source": "EGMO", "year": 2013}
{"id": "egmo-2013-q4", "question": "Find all positive integers $a$ and $b$ for which there are three consecutive integers at which the polynomial $P(n) = \\frac1b(n^5+a)$ takes integer values.", "solution": "", "category": "Number Theory", "source": "EGMO", "year": 2013}
{"id": "egmo-2013-q5", "question": "Let $\\Omega$ be the circumcircle of the triangle $ABC$.\nThe circle $\\omega$ is tangent to the sides $AC$ and $BC$,\nand it is internally tangent to the circle $\\Omega$ at the point $P$.\nA line parallel to $AB$ intersecting the\ninterior of triangle $ABC$ is tangent to $\\omega$ at $Q$.\nProve that $\\angle ACP = \\angle QCB$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3014767}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $\\Omega$ be the circumcircle of the triangle $ABC$.\nThe circle $\\omega$ is tangent to the sides $AC$ and $BC$,\nand it is internally tangent to the circle $\\Omega$ at the point $P$.\nA line parallel to $AB$ intersecting the\ninterior of triangle $ABC$ is tangent to $\\omega$ at $Q$.\nProve that $\\angle ACP = \\angle QCB$.\n\\end{mdframed}\nFirst, let us extend $\\ol{AQ}$ to meet $\\ol{BC}$ at $Q_1$.\nBy homothety, we see that $Q_1$ is just the\ncontact point of the $A$-excircle with $\\ol{BC}$.\n\n\\begin{center}\n\\begin{asy}\n  size(7cm);\n  pair A = Drawing(\"A\", dir(100), dir(100));\n  pair B = Drawing(\"B\", dir(210), dir(190));\n  pair C = Drawing(\"C\", dir(330), dir(350));\n  pair I = incenter(A,B,C);\n  pair Ia = 2*dir(-90)-I;\n  pair Ib = 2*dir(35)-I;\n  pair Ic = 2*dir(155)-I;\n  draw(unitcircle);\n  pair E = dir(90);\n  pair T = Drawing(\"P\", 2*foot(origin,I,E)-E, dir(I-E));\n  pair K = extension(A,B,T,midpoint(I--Ic));\n  pair L = extension(A,C,T,midpoint(I--Ib));\n  path w = Drawing(circumcircle(T,K,L));\n\n  Drawing(\"I_A\", Ia, dir(-90));\n  pair Q1 = Drawing(\"Q_1\", foot(Ia, B, C), dir(45));\n  pair Q = Drawing(\"Q\", IP(A--Q1, w), dir(45));\n  draw(arc(Ia, abs(Ia-Q1), -20, 200));\n  draw(B--C);\n  draw(A--foot(Ia, A, B));\n  draw(A--foot(Ia, A, C));\n  draw(T--A--Q1);\n  draw( (Q-0.8)--(Q+0.8) );\n\\end{asy}\n\\end{center}\n\nNow let us perform an inversion around $A$\nwith radius $\\sqrt{AB \\cdot AC}$ followed by\na reflection around the angle bisector;\ncall this map $\\Psi$.\nNote that $\\Psi$ fixes $B$ and $C$.\nMoreover it swaps $\\ol{BC}$ and $(ABC)$.\nHence, this map swaps the $A$-excircle\nwith the $A$-mixtilinear incircle $\\omega$.\nHence $\\Psi$ swaps $P$ and $Q_1$.\nIt follows that $\\ol{AP}$ and $\\ol{AQ_1}$\nare isogonal with respect to $\\angle BAC$,\nmeaning $\\angle BAP = \\angle CAQ_1$.\nSince $\\angle CAQ = \\angle CAQ_1$ we are done.\n\\pagebreak", "category": "Geometry", "source": "EGMO", "year": 2013}
{"id": "egmo-2013-q6", "question": "Snow White and the Seven Dwarves are living in their house in the forest.\nOn each of 16 consecutive days, some of the dwarves worked in the diamond mine\nwhile the remaining dwarves collected berries in the forest.\nNo dwarf performed both types of work on the same day.\nOn any two different (not necessarily consecutive) days,\nat least three dwarves each performed both types of work.\nFurther, on the first day, all seven dwarves worked in the diamond mine.\nProve that, on one of these 16 days, all seven dwarves were collecting berries.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3014769}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nSnow White and the Seven Dwarves are living in their house in the forest.\nOn each of 16 consecutive days, some of the dwarves worked in the diamond mine\nwhile the remaining dwarves collected berries in the forest.\nNo dwarf performed both types of work on the same day.\nOn any two different (not necessarily consecutive) days,\nat least three dwarves each performed both types of work.\nFurther, on the first day, all seven dwarves worked in the diamond mine.\nProve that, on one of these 16 days, all seven dwarves were collecting berries.\n\\end{mdframed}\nLet $Q_n$ denote the vector space $\\left\\{ 0,1 \\right\\}^n$.\nFor a vector $v$, let $v[i]$ denote the $i$th component.\nWe may identify each day with a vector $v_k$,\nwhere $v_k[i] = 0$ if dwarf $i$ worked in the diamond mine,\nand $v_k[i] = 1$ otherwise.\nLet $V = \\left\\{ v_1, v_2, \\dots, v_{16} \\right\\}$\nbe the subset of $Q_7$ in the problem,\nand assume $v_{16} = 0000000$.\n\nWe first prove the following:\n\\begin{lemma*}\n  Exactly two vectors start with each of $000$, $001$, \\dots, $111$.\n  Similar statements hold for any choice of three indices.\n\\end{lemma*}\n\\begin{proof}\n  If three vectors start with $000$ (say)\n  then we run into problems.\n\\end{proof}\n\nNow we know that $v_{16}$ is the all-null vector.\nIgnoring that vector (and hence considering just the first $15$ vectors),\nlet $n_i$ be the number of $1$'s in $v_i$, where $i = 1, 2, \\dots, 15$.\n\\begin{claim*}\n  We have\n  \\begin{align*}\n  \\sum_{i=1}^{15} \\binom{n_i}{1} &= \\frac{16}{2} \\binom{7}{1} = 56 \\\\\n  \\sum_{i=1}^{15} \\binom{n_i}{2} &= \\frac{16}{2^2} \\binom{7}{2} = 84 \\\\\n  \\sum_{i=1}^{15} \\binom{n_i}{3} &= \\frac{16}{2^3} \\binom{7}{3} = 70.\n  \\end{align*}\n\\end{claim*}\n\\begin{proof}\n  This follows using the lemma and double counting.\n  For example, the third equation is counting\n  the number of quadruples $(i, j_1, j_2, j_3)$\n  such that the $i$th string has a $1$\n  in the $j_1$th, $j_2$th, $j_3$th position, where $j_1 < j_2 < j_3$.\n  The left-hand side counts the number when summed by $i$;\n  the right-hand side counts the number according\n  to the $\\binom73$ choices of $(j_1, j_2, j_3)$.\n\\end{proof}\n\nWe may then rewrite the lemma as\n\\begin{align*}\n  \\sum_{i=1}^{15} n_i &= 56 \\\\\n  \\sum_{i=1}^{15} n_i^2 &= 2 \\cdot 84 + 56 = 224 \\\\\n  \\sum_{i=1}^{15} n_i^3 &= 6 \\cdot 70 + 3 \\cdot 224 - 2 \\cdot 56 = 980.\n\\end{align*}\nNow remark that $(n_i-3)(n_i-4)(n_i-7) \\le 0$ for each integer $1 \\le n_i \\le 7$.\nWe compute\n\\begin{align*}\n  0 &\\ge \\sum_{i=1}^{15} (n_i-3)(n_i-4)(n_i-7) \\\\\n  &= \\sum_{i=1}^{15} n_i^3 - 14n_i^2 + 61n_i - 84 \\\\\n  &= 1 \\cdot 980 - 14 \\cdot 224 + 61 \\cdot 56 - 15 \\cdot 84 \\\\\n  &= 980 - 3136 + 3416 - 1260 \\\\\n  &= 0.\n\\end{align*}\nThis implies that $n_i \\in \\left\\{ 3,4,7 \\right\\}$ for each $i$.\nIf $n_i \\neq 7$ for any $i$ then we have\n\\[ 224 = \\sum n_i^2 \\equiv 15 \\cdot 2 \\not\\equiv 0 \\pmod{7} \\]\nwhich is impossible.\nThis means that $n_i = 7$ for some $i$, and therefore, $1111111 \\in V$, as desired.\n\n\\begin{remark*}\n  Up to permutation there turns out to be a unique set of $16$ vectors.\n  Xinyang Chen gives the following compact description of the unique solution:\n  \\begin{itemize}\n    \\ii $0000000$ and $1111111$, of course\n    \\ii $1101000$ and its six \\emph{cyclic shifts} $0110100$, $0011010$, etc.\n    \\ii The complements of the above seven strings (i.e.\\ $0010111$, $1001011$, etc.).\n  \\end{itemize}\n  To write out all sixteen explicitly as a TL;DR:\n  \\begin{align*}\n    \\Big\\{ 0000000, 1111111,\n      & 1101000, 0110100, 0011010, 0001101, 1000110, 0100011, 1010001 \\\\\n      & 0010111, 1001011, 1100101, 1110010, 0111001, 1011100, 0101110 \\Big\\}.\n  \\end{align*}\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "EGMO", "year": 2013}
{"id": "tst-2017-q1", "question": "In a sports league, each team uses a set of at most $t$ signature colors.\nA set $S$ of teams is \\emph{color-identifiable} if one can assign\neach team in $S$ one of their signature colors,\nsuch that no team in $S$ is assigned\n\\emph{any} signature color of a different team in $S$.\nFor all positive integers $n$ and $t$,\ndetermine the maximum integer $g(n,t)$ such that:\nIn any sports league with exactly $n$ distinct colors\npresent over all teams, one can always\nfind a color-identifiable set of size at least $g(n,t)$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p7389115}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nIn a sports league, each team uses a set of at most $t$ signature colors.\nA set $S$ of teams is \\emph{color-identifiable} if one can assign\neach team in $S$ one of their signature colors,\nsuch that no team in $S$ is assigned\n\\emph{any} signature color of a different team in $S$.\nFor all positive integers $n$ and $t$,\ndetermine the maximum integer $g(n,t)$ such that:\nIn any sports league with exactly $n$ distinct colors\npresent over all teams, one can always\nfind a color-identifiable set of size at least $g(n,t)$.\n\\end{mdframed}\nAnswer: $\\left\\lceil n/t \\right\\rceil$.\n\nTo see this is an upper bound, note that one can easily construct\na sports league with that many teams anyways.\n\nA quick warning:\n\\begin{remark*}\n  [Misreading the problem]\n  It is common to misread the problem by ignoring the word ``any''.\n  Here is an illustration.\n\n  Suppose we have two teams, MIT and Harvard;\n  the colors of MIT are red/gray/black, and the colors of Harvard are red/white.\n  (Thus $n=4$ and $t=3$.)\n  The assignment of MIT to gray and Harvard to red is \\emph{not} acceptable\n  because red is a signature color of MIT, even though not the one assigned.\n\\end{remark*}\n\nWe present two proofs of the lower bound.\n\n\\paragraph{Approach by deleting teams (Gopal Goel).}\nInitially, place all teams in a set $S$.\nThen we repeat the following algorithm:\n\\begin{quote}\nIf there is a team all of whose signature colors\nare shared by some other team in $S$ already, then we delete that team.\n\\end{quote}\n(If there is more than one such team, we pick arbitrarily.)\n\nAt the end of the process, all $n$ colors are still present at least once,\nso at least $\\left\\lceil n/t \\right\\rceil$ teams remain.\nMoreover, since the algorithm is no longer possible,\nthe remaining set $S$ is already color-identifiable.\n\n\\begin{remark*}\n  [Gopal Goel]\n  It might seem counter-intuitive that we are \\emph{deleting} teams from the full set\n  when the original problem is trying to get a large set $S$.\n\n  This is less strange when one thinks\n  of it instead as ``safely deleting useless teams''.\n  Basically, if one deletes such a team,\n  the problem statement implies that the task must still be possible,\n  since $g(n,t)$ does not depend on the number of teams:\n  $n$ is the number of colors present, and deleting a useless team does not change this.\n  It turns out that this optimization is already enough to solve the problem.\n\\end{remark*}\n\n\\paragraph{Approach by adding colors.}\nFor a constructive algorithmic approach,\nthe idea is to greedy pick by color (rather than by team),\ntaking at each step the least used color.\nSelect the color $C_1$ with the \\emph{fewest} teams using it, and a team $T_1$ using it.\nThen delete all colors $T_1$ uses, and all teams which use $C_1$.\nNote that\n\\begin{itemize}\n  \\ii By problem condition, this deletes at most $t$ teams total.\n  \\ii Any remaining color $C$ still has at least one user.\n  Indeed, if not, then $C$ had the same set of teams\n  as $C_1$ did (by minimality of $C$),\n  but then it should have deleted as a color of $T_1$.\n\\end{itemize}\n\nNow repeat this algorithm with $C_2$ and $T_2$, and so on.\nThis operations uses at most $t$ colors each time,\nso we select at least $\\left\\lceil n/t \\right\\rceil$ colors.\n\n\\begin{remark*}\n  A greedy approach by team \\emph{does not work}.\n  For example, suppose we try to ``grab teams until no more can be added''.\n\n  As before, assume our league has teams, MIT and Harvard;\n  the colors of MIT are red/gray/black, and the colors of Harvard are red/white.\n  (Thus $n=4$ and $t=3$.)\n  If we start by selecting MIT and red, then\n  it is impossible to select any more teams; but $g(n,t) = 2$.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "TST", "year": 2017}
{"id": "tst-2017-q2", "question": "Let $ABC$ be an acute scalene triangle with circumcenter $O$,\nand let $T$ be on line $BC$ such that $\\angle TAO = 90\\dg$.\nThe circle with diameter $\\ol{AT}$\nintersects the circumcircle of $\\triangle BOC$ at two points\n$A_1$ and $A_2$, where $OA_1 < OA_2$.\nPoints $B_1$, $B_2$, $C_1$, $C_2$ are defined analogously.\n\\begin{enumerate}\n  \\ii[(a)]\n  Prove that $\\ol{AA_1}$, $\\ol{BB_1}$, $\\ol{CC_1}$ are concurrent.\n  \\ii[(b)]\n  Prove that $\\ol{AA_2}$, $\\ol{BB_2}$, $\\ol{CC_2}$ are concurrent\n  on the Euler line of triangle $ABC$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p7389108}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be an acute scalene triangle with circumcenter $O$,\nand let $T$ be on line $BC$ such that $\\angle TAO = 90\\dg$.\nThe circle with diameter $\\ol{AT}$\nintersects the circumcircle of $\\triangle BOC$ at two points\n$A_1$ and $A_2$, where $OA_1 < OA_2$.\nPoints $B_1$, $B_2$, $C_1$, $C_2$ are defined analogously.\n\\begin{enumerate}\n  \\ii[(a)]\n  Prove that $\\ol{AA_1}$, $\\ol{BB_1}$, $\\ol{CC_1}$ are concurrent.\n  \\ii[(b)]\n  Prove that $\\ol{AA_2}$, $\\ol{BB_2}$, $\\ol{CC_2}$ are concurrent\n  on the Euler line of triangle $ABC$.\n\\end{enumerate}\n\\end{mdframed}\nLet triangle $ABC$ have circumcircle $\\Gamma$.\nLet $\\triangle XYZ$ be the tangential triangle of $\\triangle ABC$\n(hence $\\Gamma$ is the incircle of $\\triangle XYZ$),\nand denote by $\\Omega$ its circumcircle.\nSuppose the symmedian $\\ol{AX}$ meets $\\Gamma$ again at $D$,\nand let $M$ be the midpoint of $\\ol{AD}$.\nFinally, let $K$ be the Miquel point of quadrilateral $ZBCY$,\nmeaning it is the intersection of $\\Omega$\nand the circumcircle of $\\triangle BOC$ (other than $X$).\n\n\\begin{center}\n\\begin{asy}\nsize(12cm);\npair A = dir(115);\npair B = dir(200);\npair C = dir(340);\ndraw(A--B--C--cycle, blue);\nfilldraw(circumcircle(A, B, C), opacity(0.1)+lightblue, blue);\npair O = circumcenter(A, B, C);\n\npair X = 2*B*C/(B+C);\npair Y = 2*C*A/(C+A);\npair Z = 2*A*B/(A+B);\n\nfilldraw(circumcircle(X, Y, Z), opacity(0.1)+lightcyan, cyan);\ndraw(X--Y--Z--cycle, cyan);\n\nfilldraw(circumcircle(B, O, C), opacity(0.1)+heavycyan, heavycyan);\npair T = extension(Y, Z, B, C);\ndraw(Z--T, lightcyan);\ndraw(T--B, blue+dashed);\n\npair D = -A+2*foot(O, A, X);\npair U = foot(A, B, C);\nfilldraw(circumcircle(T, A, U), opacity(0.1)+lightgreen, heavygreen);\n\npair V = circumcenter(X, Y, Z);\npair M = midpoint(A--D);\npair L = IP(V--(Y+Z-V), circumcircle(X, Y, Z));\npair K = extension(L, A, O, U);\ndraw(A--X, heavycyan);\ndraw(K--L, heavygreen+dashed);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$O$\", O, dir(O));\ndot(\"$X$\", X, dir(X));\ndot(\"$Y$\", Y, dir(Y));\ndot(\"$Z$\", Z, dir(Z));\ndot(\"$T$\", T, dir(T));\ndot(\"$D$\", D, dir(D));\ndot(\"$M$\", M, dir(M));\ndot(\"$L$\", L, dir(L));\ndot(\"$K$\", K, dir(K));\n\n/* TSQ Source:\n\n!size(12cm);\nA = dir 115\nB = dir 200\nC = dir 340\nA--B--C--cycle blue\ncircumcircle A B C 0.1 lightblue / blue\nO = circumcenter A B C\n\nX = 2*B*C/(B+C)\nY = 2*C*A/(C+A)\nZ = 2*A*B/(A+B)\n\ncircumcircle X Y Z 0.1 lightcyan / cyan\nX--Y--Z--cycle cyan\n\ncircumcircle B O C 0.1 heavycyan / heavycyan\nT = extension Y Z B C\nZ--T lightcyan\nT--B blue dashed\n\nD = -A+2*foot O A X\nU := foot A B C\ncircumcircle T A U 0.1 lightgreen / heavygreen\n\nV := circumcenter X Y Z\nM = midpoint A--D\nL = IP V--(Y+Z-V) circumcircle X Y Z\nK = extension L A O U\nA--X heavycyan\nK--L heavygreen dashed\n\n*/\n\\end{asy}\n\\end{center}\n\nWe first claim that $M$ and $K$ are $A_1$ and $A_2$.\nIn that case $OM < OA < OK$, so $M = A_1$, $K = A_2$.\n\nTo see that $M = A_1$, note that $\\angle OMX = 90\\dg$,\nand moreover that $\\ol{TA}$, $\\ol{TD}$ are tangents to $\\Gamma$,\nwhence we also have $M = \\ol{TO} \\cap \\ol{AD}$.\nThus $M$ lies on both $(BOC)$ and $(AT)$.\nThis solves part (a) of the problem:\nthe concurrency point is the symmedian point of $\\triangle ABC$.\n\nNow, note that since $K$ is the Miquel point,\n\\[ \\frac{ZK}{YK} = \\frac{ZB}{YC} = \\frac{ZA}{YA} \\]\nand hence $\\ol{KA}$ is an angle bisector of $\\angle ZKY$.\nThus from $(TA;YZ)=-1$ we obtain $\\angle TKA = 90\\dg$.\n\nIt remains to show $\\ol{AK}$ passes through a fixed point on the Euler line.\nWe claim it is the exsimilicenter of $\\Gamma$ and $\\Omega$.\nLet $L$ be the midpoint of the arc $YZ$ of $\\triangle XYZ$ not containing $X$.\nThen we know that $K$, $A$, $L$ are collinear.\nNow the positive homothety sending $\\Gamma$ to $\\Omega$ maps $A$ to $L$;\nthis proves the claim.\nFinally, it is well-known that the line through $O$\nand the circumcenter of $\\triangle XYZ$\ncoincides with the Euler line of $\\triangle ABC$;\nhence done.\n\nA second approach to (b) presented by many contestants\nis to take an inversion around the circumcircle of $ABC$.\nIn that situation, the part reduces to the following\nknown lemma: if $\\ol{AH_a}$, $\\ol{BH_b}$, $\\ol{CH_c}$\nare the altitudes of a triangle,\nthen the circumcircles of triangles $OAH_a$, $BOH_b$, $COH_c$\nare coaxial, and the radical axis coincides with the Euler line.\nIndeed one simply observes that the orthocenter\nhas equal power to all three circles.\n\n\\paragraph{Authorship comments.}\nThis problem was inspired by the fact that $K$, $A$, $L$\nare collinear in the figure,\nwhich was produced by one of my students (Ryan Kim)\nin a solution to a homework problem.\nI realized for example that this implied that line $AK$\npassed through the $X_{56}$ point of $\\triangle XYZ$\n(which lies on the Euler line of $\\triangle ABC$).\n\nThis problem was the result of playing around with\nthe resulting very nice picture:\nall the power comes from the ``magic'' point $K$.\n\\pagebreak", "category": "Geometry", "source": "TST", "year": 2017}
{"id": "tst-2017-q3", "question": "Let $P, Q \\in \\RR[x]$ be relatively prime nonconstant polynomials.\nShow that there can be at most three real numbers $\\lambda$\nsuch that $P + \\lambda Q$ is the square of a polynomial.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p7389123}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $P, Q \\in \\RR[x]$ be relatively prime nonconstant polynomials.\nShow that there can be at most three real numbers $\\lambda$\nsuch that $P + \\lambda Q$ is the square of a polynomial.\n\\end{mdframed}\nThis is true even with $\\RR$ replaced by $\\CC$,\nand it will be necessary to work in this generality.\n\n\\paragraph{First solution using transformations.}\nWe will prove the claim in the following form:\n\n\\begin{claim*}\nAssume $P, Q \\in \\CC[x]$ are relatively prime.\nIf $\\alpha P + \\beta Q$ is a square for four different\nchoices of the ratio $[\\alpha : \\beta]$\nthen $P$ and $Q$ must be constant.\n\\end{claim*}\n\nCall pairs $(P,Q)$ as in the claim \\emph{bad};\nso we wish to show the only bad pairs are pairs of constant polynomials.\nAssume not, and take a bad pair with $\\deg P + \\deg Q$ minimal.\n\nBy a suitable M\\\"obius transformation,\nwe may transform $(P,Q)$ so that the four ratios are $[1:0]$,\n$[0:1]$, $[1:-1]$ and $[1:-k]$,\nso we find there are polynomials $A$ and $B$ such that\n\\begin{align*}\n  A^2 - B^2 &= C^2 \\\\\n  A^2 - k B^2 &= D^2\n\\end{align*}\nwhere $A^2 = P+\\lambda_1 Q$, $B^2 = P+\\lambda_2 Q$, say.\nOf course $\\gcd(A,B) = 1$.\n\nConsequently, we have $C^2 = (A+B)(A-B)$\nand $D^2 = (A+\\mu B)(A-\\mu B)$ where $\\mu^2 = k$.\nNow $\\gcd(A,B) = 1$, so $A+B$, $A-B$, $A+ \\mu B$ and $A - \\mu B$\nare squares; id est $(A,B)$ is bad.\nThis is a contradiction, since $\\deg A + \\deg B < \\deg P + \\deg Q$.\n\n\\paragraph{Second solution using derivatives (by Zack Chroman).}\nWe will assume without loss of generality that $\\deg P \\neq \\deg Q$;\nif not, then one can replace $(P,Q)$ with $(P+cQ,Q)$\nfor a suitable constant $c$.\n\nThen, there exist $\\lambda_i \\in \\CC$ and polynomials $R_i$\nfor $i=1,2,3,4$ such that\n\\begin{align*}\n  P + \\lambda_i Q &= R_i^2 \\\\\n  \\implies P' + \\lambda_i Q' &= 2 R_i R_i' \\\\\n  \\implies R_i &\\mid Q'(P+\\lambda_i Q) - Q(P' + \\lambda_i Q')\n  = Q'P - QP'.\n\\end{align*}\nOn the other hand by Euclidean algorithm it follows that\n$R_i$ are relatively prime to each other.\nTherefore\n\\[ R_1 R_2 R_3 R_4 \\mid Q' P - Q P'. \\]\nHowever, we have\n\\begin{align*}\n  \\sum_1^4 \\deg R_i\n  &\\ge \\frac{3\\max(\\deg P, \\deg Q) + \\min(\\deg P, \\deg Q)}{2} \\\\\n  &\\ge \\deg P + \\deg Q > \\deg(Q'P - QP').\n\\end{align*}\nThis can only occur if $Q'P - QP' = 0$ or $(P/Q)' = 0$\nby the quotient rule!\nBut $P/Q$ can't be constant, the end.\n\n\\begin{remark*}\n  The result is previously known; see e.g.\\\n  Lemma 1.6 of \\url{http://math.mit.edu/~ebelmont/ec-notes.pdf}\n  or Exercise 6.5.L(a) of Vakil's notes.\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Algebra", "source": "TST", "year": 2017}
{"id": "tst-2017-q4", "question": "You are cheating at a trivia contest.\nFor each question, you can peek at each of the\n$n > 1$ other contestant's guesses before writing your own.\nFor each question, after all guesses are submitted, the emcee announces the correct answer.\nA correct guess is worth $0$ points.\nAn incorrect guess is worth $-2$ points for other contestants,\nbut only $-1$ point for you, because you hacked the scoring system.\nAfter announcing the correct answer, the emcee proceeds to read out the next question.\nShow that if you are leading by $2^{n-1}$ points at any time,\nthen you can surely win first place.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p7732191}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nYou are cheating at a trivia contest.\nFor each question, you can peek at each of the\n$n > 1$ other contestant's guesses before writing your own.\nFor each question, after all guesses are submitted, the emcee announces the correct answer.\nA correct guess is worth $0$ points.\nAn incorrect guess is worth $-2$ points for other contestants,\nbut only $-1$ point for you, because you hacked the scoring system.\nAfter announcing the correct answer, the emcee proceeds to read out the next question.\nShow that if you are leading by $2^{n-1}$ points at any time,\nthen you can surely win first place.\n\\end{mdframed}\nWe will prove the result with $2^{n-1}$ replaced\neven by $2^{n-2}+1$.\n\nWe first make the following reductions.\nFirst, change the weights to be $+1$, $-1$, $0$ respectively\n(rather than $0$, $-2$, $-1$); this clearly has no effect.\nAlso, WLOG that all contestants except you initially have score zero\n(and that your score exceeds $2^{n-2}$).\nWLOG ignore rounds in which all answers are the same.\nFinally, ignore rounds in which you get the correct answer,\nsince that leaves you at least as well off as before --- in other words,\nwe'll assume your score is always fixed,\nbut you can pick any group of people with the same answers\nand ensure they lose 1 point,\nwhile some other group gains $1$ point.\n\nThe key observation is the following.\nConsider two rounds $R_1$ and $R_2$ such that:\n\\begin{itemize}\n  \\ii In round $R_1$, some set $S$ of contestants gains a point.\n  \\ii In round $R_2$, the set $S$ of contestants all have the same answer.\n\\end{itemize}\nThen, if we copy the answers of contestants in $S$ during $R_2$,\nthen the sum of the scorings in $R_1$ and $R_2$ cancel each other out.\nIn other words we can then ignore $R_1$ and $R_2$ forever.\n\nWe thus consider the following strategy.\nWe keep a list $\\mathcal L$ of subsets of $\\{1, \\dots, n\\}$, initially empty.\nNow do the following strategy:\n\\begin{itemize}\n  \\ii On a round, suppose there exists a set $S$ of people\n  with the same answer such that $S \\in \\mathcal L$.\n  $($If multiple exist, choose one arbitrarily.)\n  Then, copy the answer of $S$, causing them to lose a point.\n  Delete $S$ from $\\mathcal L$.\n  (Importantly, we do not add any new sets to $\\mathcal L$.)\n  \\ii Otherwise, copy any set $T$ of contestants,\n  selecting $|T| \\ge n/2$ if possible.\n  Let $S$ be the set of contestants who answer correctly (if any),\n  and add $S$ to the list $\\mathcal L$.\n  Note that $|S| \\le n/2$, since $S$ is disjoint from $T$.\n\\end{itemize}\nBy construction, $\\mathcal L$ has no duplicate sets.\nSo the score of any contestant $c$ is bounded above by the number of times\nthat $c$ appears among sets in $\\mathcal L$.\nThe number of such sets is clearly at most $\\half \\cdot 2^{n-1}$.\nSo, if you lead by $2^{n-2}+1$ then you ensure victory.\nThis completes the proof!\n\n\\begin{remark*}\nSeveral remarks are in order.\nFirst, we comment on the bound $2^{n-2} + 1$ itself.\nThe most natural solution using only the\nlist idea gives an upper bound of $(2^n-2)+1$,\nwhich is the number of nonempty proper subsets of $\\{1, \\dots, n\\}$.\nThen, there are two optimizations one can observe:\n\\begin{itemize}\n  \\ii In fact we can improve to the number of times\n  any particular contestant $c$ appears in some set,\n  rather than the total number of sets.\n  \\ii When adding new sets $S$ to $\\mathcal L$, one can ensure $|S| \\le n/2$.\n\\end{itemize}\nEither observation alone improves the bound from $2^n-1$ to $2^{n-1}$,\nbut both together give the bound $2^{n-2} + 1$.\nAdditionally, when $n$ is odd the calculation of subsets\nactually gives $2^{n-2} - \\half \\binom{n-1}{\\frac{n-1}{2}} + 1$.\nThis gives the best possible value at both $n=2$ and $n=3$.\nIt seems likely some further improvements are possible,\nand the true bound is suspected to be polynomial in $n$.\n\nSecondly, the solution is highly motivated by considering a true/false contest\nin which only two distinct answers are given per question.\nHowever, a natural mistake (which graders assessed as a two-point deduction)\nis to try and prove that in fact one can ``WLOG'' we are in the two-question case.\nThe proof of this requires substantially more care than expected.\nFor instance, set $n = 3$.\nIf $\\mathcal L = \\left\\{ \\{1\\}, \\{2\\}, \\{3\\}  \\right\\}$\nthen it becomes impossible to prevent a duplicate set from appearing\nin $\\mathcal L$ if all contestants give distinct answers.\nOne might attempt to fix this by instead adding to $\\mathcal L$\nthe \\emph{complement} of the set $T$ described above.\nThe example $\\mathcal L = \\left\\{ \\{1,2\\}, \\{2,3\\}, \\{3,1\\}  \\right\\}$\n(followed again by a round with all distinct answers)\nshows that this proposed fix does not work either.\nThis issue affects all variations of the above approach.\n\nBecause the USA TST did not have any solution-writing process at this time,\nthis issue was not noticed until January 15 (less than a week before the exam).\nWhen it was brought up by email by Evan,\nevery organizer who had testsolved the problem had apparently made the same error.\n\\end{remark*}\n\\begin{remark*}\n  Here are some motivations for the solution:\n  \\begin{enumerate}\n    \\ii The exponential bound $2^n$ suggests looking at subsets.\n    \\ii The $n = 2$ case suggests the idea of ``repeated rounds''.\n    (I think this $n=2$ case is actually really good.)\n    \\ii The ``two distinct answers'' case suggests looking at rounds\n    as partitions (even though the WLOG does not work,\n    at least not without further thought).\n    \\ii There's something weird about this problem:\n    it's a finite bound over unbounded time.\n    This is a hint to \\emph{not} worry excessively about\n    the actual scores, which turn out to be almost irrelevant.\n  \\end{enumerate}\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "TST", "year": 2017}
{"id": "tst-2017-q5", "question": "Let $ABC$ be a triangle with altitude $\\ol{AE}$.\nThe $A$-excircle touches $\\ol{BC}$ at $D$,\nand intersects the circumcircle at two points $F$ and $G$.\nProve that one can select points $V$ and $N$\non lines $DG$ and $DF$ such that quadrilateral $EVAN$ is a rhombus.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p7732197}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle with altitude $\\ol{AE}$.\nThe $A$-excircle touches $\\ol{BC}$ at $D$,\nand intersects the circumcircle at two points $F$ and $G$.\nProve that one can select points $V$ and $N$\non lines $DG$ and $DF$ such that quadrilateral $EVAN$ is a rhombus.\n\\end{mdframed}\nLet $I$ denote the incenter, $J$ the $A$-excenter,\nand $L$ the midpoint of $\\ol{AE}$.\nDenote by $\\ol{IY}$, $\\ol{IZ}$ the tangents\nfrom $I$ to the $A$-excircle.\nNote that lines $\\ol{BC}$, $\\ol{GF}$, $\\ol{YZ}$ then concur at $H$\n(unless $AB=AC$, but this case is obvious),\nas it's the radical center of cyclic hexagon $BICYJZ$,\nthe circumcircle and the $A$-excircle.\n\n\\begin{center}\n\\begin{asy}\nsize(12cm);\npair A = dir(110);\npair B = dir(210);\npair C = dir(330);\npair I = incenter(A, B, C);\npair M = dir(270);\npair J = 2*M-I;\npair D = foot(J, B, C);\npair E = foot(A, B, C);\n\npair F = IP(CP(J, D), unitcircle);\npair G = OP(CP(J, D), unitcircle);\n\nfilldraw(unitcircle, opacity(0.1)+lightblue, lightblue);\ndraw(arc(J,abs(D-J),-30,210), lightblue);\n\npair L = midpoint(A--E);\npair V = extension(G, D, L, L+B-C);\npair N = extension(F, D, L, L+B-C);\ndraw(A--B--C--cycle, lightblue);\ndraw(A--E, lightblue);\ndraw(G--V, lightblue);\ndraw(N--F, lightblue);\nfilldraw(E--V--A--N--cycle, opacity(0.1)+lightgreen, heavygreen);\ndraw(V--N, heavygreen);\npair H = extension(G, F, B, C);\ndraw(C--H--G, lightblue);\n\nfilldraw(circumcircle(B, I, C), opacity(0.1)+lightred, lightred);\npair Y = IP(circumcircle(B, I, C), circumcircle(D, F, G));\npair Z = OP(circumcircle(B, I, C), circumcircle(D, F, G));\npair T = -D+2*foot(J, D, I);\ndraw(T--H, blue);\ndraw(Z--H, blue);\ndraw(L--T, blue);\ndraw(Y--I--Z, blue);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$I$\", I, dir(I));\ndot(\"$M$\", M, dir(M));\ndot(\"$J$\", J, dir(J));\ndot(\"$D$\", D, dir(D));\ndot(\"$E$\", E, dir(E));\ndot(\"$F$\", F, dir(270));\ndot(\"$G$\", G, dir(270));\ndot(\"$L$\", L, dir(L));\ndot(\"$V$\", V, dir(V));\ndot(\"$N$\", N, dir(N));\ndot(\"$H$\", H, dir(H));\ndot(\"$Y$\", Y, dir(Y));\ndot(\"$Z$\", Z, dir(Z));\ndot(\"$T$\", T, dir(T));\n\n/* TSQ Source:\n\n!size(12cm);\nA = dir 110\nB = dir 210\nC = dir 330\nI = incenter A B C\nM = dir 270\nJ = 2*M-I\nD = foot J B C\nE = foot A B C\n\nF = IP CP J D unitcircle R270\nG = OP CP J D unitcircle R270\n\nunitcircle 0.1 lightblue / lightblue\n!draw(arc(J,abs(D-J),-30,210), lightblue);\n\nL = midpoint A--E\nV = extension G D L L+B-C\nN = extension F D L L+B-C\nA--B--C--cycle lightblue\nA--E lightblue\nG--V lightblue\nN--F lightblue\nE--V--A--N--cycle 0.1 lightgreen / heavygreen\nV--N heavygreen\nH = extension G F B C\nC--H--G lightblue\n\ncircumcircle B I C 0.1 lightred / lightred\nY = IP circumcircle B I C circumcircle D F G\nZ = OP circumcircle B I C circumcircle D F G\nT = -D+2*foot J D I\nT--H blue\nZ--H blue\nL--T blue\nY--I--Z blue\n\n*/\n\\end{asy}\n\\end{center}\n\nNow let $\\ol{HD}$ and $\\ol{HT}$ be the tangents from $H$ to the $A$-excircle.\nIt follows that $\\ol{DT}$ is the symmedian of $\\triangle DZY$,\nhence passes through $I = \\ol{YY} \\cap \\ol{ZZ}$.\nMoreover, it's well known that $\\ol{DI}$ passes through $L$,\nthe midpoint of the $A$-altitude (for example by homothety).\nFinally, $(DT;FG) = -1$, hence project through $D$ onto the line through $L$\nparallel to $\\ol{BC}$ to obtain $(\\infty L; VN) = -1$ as desired.\n\n\\paragraph{Authorship comments.}\nThis is a joint proposal with Danielle Wang (mostly by her).\nThe formulation given was that the tangents to the $A$-excircle\nat $F$ and $G$ was on line $\\ol{DI}$;\nI solved this formulation using the radical axis argument above.\nI then got the idea to involve the point $L$,\nalready knowing it was on $\\ol{DI}$.\nObserving the harmonic quadrilateral,\nI took perspectivity through $M$ onto the line through $L$ parallel to $\\ol{BC}$\n(before this I had tried to use the $A$-altitude with little luck).\nThis yields the rhombus in the problem.\n\\pagebreak", "category": "Geometry", "source": "TST", "year": 2017}
{"id": "tst-2017-q6", "question": "Prove that there are infinitely many triples $(a,b,p)$ of integers,\nwith $p$ prime and $0 < a \\le b < p$,\nfor which $p^5$ divides $(a+b)^p - a^p - b^p$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p7732203}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nProve that there are infinitely many triples $(a,b,p)$ of integers,\nwith $p$ prime and $0 < a \\le b < p$,\nfor which $p^5$ divides $(a+b)^p - a^p - b^p$.\n\\end{mdframed}\nThe key claim is that if $p \\equiv 1 \\pmod 3$,\nthen\n\\[ p(x^2+xy+y^2)^2 \\text{ divides } (x+y)^p - x^p - y^p \\]\nas polynomials in $x$ and $y$.\nSince it's known that one can select $a$ and $b$ such that\n$p^2 \\mid a^2 + ab + b^2$, the conclusion follows.\n(The theory of quadratic forms tells us we can do it with $p^2 = a^2+ab+b^2$;\nThue's lemma lets us do it by solving $x^2+x+1 \\equiv 0 \\pmod{p^2}$.)\n\nTo prove this, it is the same to show that\n\\[ (x^2+x+1)^2 \\text{ divides } F(x) \\coloneq (x+1)^p - x^p - 1. \\]\nsince the binomial coefficients $\\binom pk$ are clearly divisible by $p$.\nLet $\\zeta$ be a third root of unity.\nThen $F(\\zeta) = (1+\\zeta)^p - \\zeta^p - 1 = -\\zeta^2 - \\zeta - 1 = 0$.\nMoreover, $F'(x) = p(x+1)^{p-1} -  px^{p-1}$,\nso $F'(\\zeta) = p - p = 0$.\nHence $\\zeta$ is a double root of $F$ as needed.\n\n(Incidentally, $p = 2017$ works!)\n\n\\begin{remark*}\nOne possible motivation for this solution is the case $p = 7$.\nIt is nontrivial even to prove that $p^2$ can divide the expression\nif we exclude the situation $a+b=p$ (which provably never achieves $p^3$).\nAs $p = 3, 5$ fails considering the $p = 7$ polynomial gives\n\\[ (x+1)^7 - x^7 - 1 = 7x(x+1) \\left( x^4 + 2x^3 + 3x^2 + 2x + 1 \\right). \\]\nThe key is now to notice that the last factor is $(x^2+x+1)^2$,\nwhich suggests the entire solution.\n\nIn fact, even if $p \\equiv 2 \\pmod 3$,\nthe polynomial $x^2+x+1$ still divides $(x+1)^p-x^p-1$.\nSo even the $p = 5$ case can motivate the main idea.\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Number Theory", "source": "TST", "year": 2017}
{"id": "egmo-2018-q1", "question": "Let $ABC$ be a triangle with $CA=CB$ and $\\angle{ACB}=120^{\\circ}$,\nand let $M$ be the midpoint of $AB$.\nLet $P$ be a variable point of the circumcircle of $ABC$,\nand let $Q$ be the point on the segment $CP$ such that $QP = 2QC$.\nIt is given that the line through $P$ and perpendicular to $AB$\nintersects the line $MQ$ at a unique point $N$.\nProve that there exists a fixed circle such that $N$\nlies on this circle for all possible positions of $P$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10185390}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle with $CA=CB$ and $\\angle{ACB}=120^{\\circ}$,\nand let $M$ be the midpoint of $AB$.\nLet $P$ be a variable point of the circumcircle of $ABC$,\nand let $Q$ be the point on the segment $CP$ such that $QP = 2QC$.\nIt is given that the line through $P$ and perpendicular to $AB$\nintersects the line $MQ$ at a unique point $N$.\nProve that there exists a fixed circle such that $N$\nlies on this circle for all possible positions of $P$.\n\\end{mdframed}\nSince $\\vec N = 3\\vec Q - 2\\vec M$,\nit suffices to show $Q$ moves on a fixed circle.\nThat fixed circle is the image of $(CAB)$ under a homothety at $C$ with ratio $1/3$,\nso we are done.\n\\begin{center}\n\\begin{asy}\npair C = dir(90);\npair A = dir(150);\npair B = dir(30);\npair M = midpoint(A--B);\npair P = dir(-40);\npair Q = (2*C+P)/3;\npair N = extension(M, Q, P, P+C);\ndraw(unitcircle);\n\ndraw(A--B--C--cycle, dotted);\ndraw(C--P--N--M--cycle);\n\ndot(\"$C$\", C, dir(C));\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$M$\", M, dir(270));\ndot(\"$P$\", P, dir(P));\ndot(\"$Q$\", Q, dir(225));\ndot(\"$N$\", N, dir(N));\n\n/* TSQ Source:\n\nC = dir 90\nA = dir 150\nB = dir 30\nM = midpoint A--B R270\nP = dir -40\nQ = (2*C+P)/3 R225\nN = extension M Q P P+C\nunitcircle\n\nA--B--C--cycle dotted\nC--P--N--M--cycle\n\n*/\n\\end{asy}\n\\end{center}\n\n\\begin{remark*}\n  Note that points $A$ and $B$ are superfluous,\n  and the choice of constant $2$ or the definition of $M$\n  is also arbitrary (only the fact that $\\ol{CM} \\parallel \\ol{PN}$ matters).\n  Moreover, the condition $\\angle ACB = 120^{\\circ}$ is never used either.\n\n  As a result, I did not find this problem very inspiring.\n\\end{remark*}\n\\pagebreak", "category": "Geometry", "source": "EGMO", "year": 2018}
{"id": "egmo-2018-q2", "question": "Consider the set\n\\[ A = \\left\\{ 1 + \\frac 1k : k = 1, 2, 3, \\dots \\right\\}. \\]\nFor every integer $x \\ge 2$, let $f(x)$ denote\nthe minimum integer such that $x$ can be written as the product\nof $f(x)$ elements of $A$ (not necessarily distinct).\nProve that there are infinitely many pairs of integers $x \\ge 2$\nand $y \\ge 2$ for which \\[ f(xy) < f(x) + f(y). \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10185417}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nConsider the set\n\\[ A = \\left\\{ 1 + \\frac 1k : k = 1, 2, 3, \\dots \\right\\}. \\]\nFor every integer $x \\ge 2$, let $f(x)$ denote\nthe minimum integer such that $x$ can be written as the product\nof $f(x)$ elements of $A$ (not necessarily distinct).\nProve that there are infinitely many pairs of integers $x \\ge 2$\nand $y \\ge 2$ for which \\[ f(xy) < f(x) + f(y). \\]\n\\end{mdframed}\nOne of many constructions: let $n = 2^e+1$\nfor $e \\equiv 5 \\pmod{10}$\nand let $x = 11$, $y = n/11$ be our two integers.\n\nWe prove two lemmas:\n\\begin{claim*}\n  For any $m \\ge 2$ we have\n  $f(m) \\ge \\left\\lceil \\log_2 m \\right\\rceil$.\n\\end{claim*}\n\\begin{proof}\n  This is obvious.\n\\end{proof}\n\nIt follows that $f(n) = e+1$, since $n = \\frac{n}{n-1} \\cdot 2^e$.\n\n\\begin{claim*}\n  $f(11) = 5$.\n\\end{claim*}\n\\begin{proof}\n  We have $11 = \\frac{33}{32} \\cdot \\frac 43 \\cdot 2^3$.\n  So it suffices to prove $f(11) > 4$.\n\n  Note that a decomposition of $11$ must\n  contain a fraction at most $\\frac{11}{10} = 1.1$.\n  But $2^3 \\cdot 1.1 = 8.8 < 11$, contradiction.\n\\end{proof}\n\nTo finish, note that\n\\[ f(11) + f(n/11) \\ge 5 + \\log_2(n/11) = 1 + \\log_2(16n/11) > 1 + e = 1 + f(n). \\]\n\n\\begin{remark*}\n  Most solutions seem to involve picking $n$ such that\n  $f(n)$ is easy to compute.\n  Indeed, it's hard to get nontrivial lower bounds other than the log,\n  and even harder to actually come up with complicated constructions.\n  It might be said the key to this problem\n  is doing as little number theory as possible.\n\\end{remark*}\n\\pagebreak", "category": "Number Theory", "source": "EGMO", "year": 2018}
{"id": "egmo-2018-q3", "question": "The $n$ contestants of EGMO are named $C_1$, $C_2$, \\dots, $C_n$.\nAfter the competition,\nthey queue in front of the restaurant according to the following rules.\n\\begin{itemize}\n  \\ii The Jury chooses the initial order of the contestants in the queue.\n  \\ii Every minute, the Jury chooses an integer $i$ with $1 \\leq i \\leq n$.\n  \\begin{itemize}\n    \\ii If contestant $C_i$ has at least $i$ other contestants in front of her,\n    she pays one euro to the Jury and moves forward in the queue by exactly $i$ positions.\n    \\ii If contestant $C_i$ has fewer than $i$ other contestants in front of her,\n    the restaurant opens and the process ends.\n  \\end{itemize}\n\\end{itemize}\nFor every $n$, prove that this process must terminate\nand determine the maximum number of euros\nthat the Jury can collect by cunningly choosing\nthe initial order and the sequence of moves.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10185368}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nThe $n$ contestants of EGMO are named $C_1$, $C_2$, \\dots, $C_n$.\nAfter the competition,\nthey queue in front of the restaurant according to the following rules.\n\\begin{itemize}\n  \\ii The Jury chooses the initial order of the contestants in the queue.\n  \\ii Every minute, the Jury chooses an integer $i$ with $1 \\leq i \\leq n$.\n  \\begin{itemize}\n    \\ii If contestant $C_i$ has at least $i$ other contestants in front of her,\n    she pays one euro to the Jury and moves forward in the queue by exactly $i$ positions.\n    \\ii If contestant $C_i$ has fewer than $i$ other contestants in front of her,\n    the restaurant opens and the process ends.\n  \\end{itemize}\n\\end{itemize}\nFor every $n$, prove that this process must terminate\nand determine the maximum number of euros\nthat the Jury can collect by cunningly choosing\nthe initial order and the sequence of moves.\n\\end{mdframed}\nThe maximum money is\n$1 + 3 + 7 + \\dots + (2^{n-1}-1) = 2^n-n-1$,\nwhich is finite.\n\nCall the 1-euro process a jump,\nand let $x_i$ denote the number of times that $C_i$ jumps.\nNote that:\n\\begin{itemize}\n  \\ii Whenever $C_i$ jumps it must jump over some $C_j$ with $j > i$.\n  \\ii Contestant $C_i$ can jump over a $C_j$ with $j > i$ at most $1 + x_j$ times.\n\\end{itemize}\nNow, we have $x_n = 0$ and in general,\n\\begin{align*}\n  x_{n-1} &\\le 1 + x_n \\le 1 \\\\\n  x_{n-2} &\\le (1 + x_{n-1}) + (1 + x_{n-2}) \\le 3 \\\\\n  x_{n-3} &\\le (1 + x_{n-1}) + (1 + x_{n-2}) + (1 + x_{n-3}) \\le 7\n\\end{align*}\nand so on, which gives the bound.\n\nThe construction is inductive; here is the example for $n = 3$,\nwith the food towards the right:\n\\[\n  \\begin{array}{ccc}\n    C_1 & C_2 & C_3 \\\\\n    C_2 & C_1 & C_3 \\\\\n    C_2 & C_3 & C_1 \\\\\n    C_3 & C_1 & C_2 \\\\\n    C_3 & C_2 & C_1\n  \\end{array}\n\\]\nIn general, we can start the contestants in reverse order,\napply inductive hypothesis to $C_1$ through $C_{n-1}$ to flip their order,\nthen have $C_1$, $C_2$, $\\dots$, $C_{n-1}$ jump over $C_n$,\nthen repeat.\nThis gives a construction with value $a_1 = 0$\nand $a_n = 2a_{n-1} + (n-1)$ which is the same as the bound.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Combinatorics", "source": "EGMO", "year": 2018}
{"id": "egmo-2018-q4", "question": "Let $n \\ge 3$ be an integer.\nSeveral non-overlapping dominoes are placed on an $n \\times n$ board.\nThe \\emph{value} of a row or column is the number of dominoes\nthat cover at least one cell of that row or column.\nA domino configuration is called \\emph{balanced} if there exists\nsome $k \\ge 1$ such that every row and column has value $k$.\n\nProve that a balanced configuration exists for every $n \\ge 3$\nand find the minimum number of dominoes needed\nin such a configuration.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10191585}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n \\ge 3$ be an integer.\nSeveral non-overlapping dominoes are placed on an $n \\times n$ board.\nThe \\emph{value} of a row or column is the number of dominoes\nthat cover at least one cell of that row or column.\nA domino configuration is called \\emph{balanced} if there exists\nsome $k \\ge 1$ such that every row and column has value $k$.\n\nProve that a balanced configuration exists for every $n \\ge 3$\nand find the minimum number of dominoes needed\nin such a configuration.\n\\end{mdframed}\nThe answer is $2n/3$ when $n \\equiv 0 \\pmod 3$, and $2n$ otherwise.\n\n\\paragraph{Proof this is best possible.}\nTo prove these are best possible, assume there are $d$ dominoes.\n\\begin{claim*}\n  In any balanced configuration, we always have $k \\cdot 2n = 3d$.\n\\end{claim*}\n\\begin{proof}\n  Consider counting the number of ordered pairs\n  \\[ (\\text{row or column},\n    \\text{domino touching at least one cell in that row or column}). \\]\n  On the one hand, this is equal to $k \\cdot 2n$,\n  because there are $2n$ choices for the row and column,\n  and by the balanced hypothesis, there are $k$ dominoes for that row or column.\n\n  On the other hand, it must be equal to $3d$,\n  because for each domino there are either one column and two rows it touches,\n  or two columns and one row.\n\n  Hence the result.\n\\end{proof}\n\nWritten another way, we have\n\\[ d = 2n \\cdot \\frac{k}{3}. \\]\nSince $k \\ge 1$, the first few possible values of $d$ are $2n/3$, $4n/3$, $2n$, \\dots.\nSo we get a lower bound by taking the first integer in this sequence.\n\n\\paragraph{Constructions.}\nWhen $n \\equiv 0 \\pmod 3$, one takes block-diagonal\ncopies of the following $3 \\times 3$ square with $k = 1$.\n\\[\n  \\begin{bmatrix}\n    A & A & \\\\\n      &   & B \\\\\n      &   & B\n  \\end{bmatrix}.\n\\]\n\nOn the other hand, we give below construction for $4 \\le n \\le 7$\nwhich have $k = 3$ and $2n$ dominoes.\nBy taking block-diagonal copies of these, we obtain a $k = 3$ construction\nusing $2n$ dominoes for any value of $n \\ge 4$.\n\\[\n  \\begin{bmatrix}\n    A & A & B & C \\\\\n    D & D & B & C \\\\\n    W & X & Y & Y \\\\\n    W & X & Z & Z\n  \\end{bmatrix}\n  \\qquad\n  \\begin{bmatrix}\n    A & A & B & B & C \\\\\n    H & X &   &   & C \\\\\n    H & X &   &   & D \\\\\n    G &   & Y & Y & D \\\\\n    G & F & F & E & E\n  \\end{bmatrix}\n\\]\n\\[\n  \\begin{bmatrix}\n    A & A & B & C & & \\\\\n    D & D & B & C & & \\\\\n    & & W & W & Y & Z \\\\\n    & & X & X & Y & Z \\\\\n    P & Q & & & R & R \\\\\n    P & Q & & & S & S \\\\\n  \\end{bmatrix}\n  \\qquad\n  \\begin{bmatrix}\n    A & A & B & B &   &   & C \\\\\n      & W & W &   &   & X & C \\\\\n      &   & P &   &   & X & D \\\\\n    H &   & P &   &   &   & D \\\\\n    H & Z &   & Q & Q &   &   \\\\\n    G & Z &   &   & Y & Y &   \\\\\n    G &   &   & F & F & E & E\n  \\end{bmatrix}\n\\]\n\n\\begin{remark*}\n  Most of the difficulty of the problem is the construction for $n \\in \\{5,7\\}$.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "EGMO", "year": 2018}
{"id": "egmo-2018-q5", "question": "Let $\\Gamma $ be the circumcircle of triangle $ABC$.\nA circle $\\Omega$ is tangent to the line segment $AB$\nand is tangent to $\\Gamma$ at a point\nlying on the same side of the line $AB$ as $C$.\nThe angle bisector of $\\angle BCA$ intersects $\\Omega$\nat two different points $P$ and $Q$. Prove that $\\angle ABP = \\angle QBC$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10191590}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $\\Gamma $ be the circumcircle of triangle $ABC$.\nA circle $\\Omega$ is tangent to the line segment $AB$\nand is tangent to $\\Gamma$ at a point\nlying on the same side of the line $AB$ as $C$.\nThe angle bisector of $\\angle BCA$ intersects $\\Omega$\nat two different points $P$ and $Q$. Prove that $\\angle ABP = \\angle QBC$.\n\\end{mdframed}\nIf we let $M$ denote the midpoint of arc $\\widehat{AB}$\nthen the inversion at $M$ with radius $MA = MB$ fixes $\\Omega$,\nso it swaps $P$ and $Q$, thus\n\\[ \\dang MPB = \\dang QBM. \\]\n\\begin{center}\n\\begin{asy}\npair A = dir(210);\npair B = dir(330);\npair C = dir(110);\npair T = dir(20);\npair M = dir(270);\npair S = extension(T, M, A, B);\npair O = extension(origin, T, S, S+M);\npair P = IP(CP(O, T), C--M);\npair Q = OP(CP(O, T), C--M);\nfilldraw(unitcircle, opacity(0.1)+lightcyan, deepcyan);\ndraw(C--M, deepcyan);\ndraw(A--B--C--cycle, deepcyan);\nfilldraw(CP(O, T), opacity(0.1)+lightgreen, deepgreen);\n\ndraw(A--P--B--Q--cycle, lightred);\ndraw(M--T, blue+dotted);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$T$\", T, dir(T));\ndot(\"$M$\", M, dir(M));\ndot(\"$S$\", S, dir(S));\ndot(\"$P$\", P, dir(140));\ndot(\"$Q$\", Q, dir(Q));\n\n/* TSQ Source:\n\nA = dir 210\nB = dir 330\nC = dir 110\nT = dir 20\nM = dir 270\nS = extension T M A B\nO := extension origin T S S+M\nP = IP CP O T C--M R140\nQ = OP CP O T C--M\nunitcircle 0.1 lightcyan / deepcyan\nC--M deepcyan\nA--B--C--cycle deepcyan\nCP O T 0.1 lightgreen / deepgreen\n\nA--P--B--Q--cycle lightred\nM--T blue dotted\n\n*/\n\\end{asy}\n\\end{center}\nBut\n\\begin{align*}\n  \\dang MPB &= \\dang MCB + \\dang CBP \\\\\n  \\dang QBM &= \\dang ABM + \\dang QBA\n\\end{align*}\nimplying the desired isogonality,\nsince $\\dang ABM = \\dang ACM  = \\dang MCB$.\n\\pagebreak", "category": "Geometry", "source": "EGMO", "year": 2018}
{"id": "egmo-2018-q6", "question": "Fix a real number $0 < t < \\half$.\n\\begin{enumerate}\n  \\ii [(a)]\n  Prove that there exists a positive integer $n$\n  such that for every set $S$ of $n$ positive integers,\n  the following holds:\n  there exist distinct $x, y \\in S$ and \\emph{nonnegative} integer $m \\ge 0$\n  such that $|x-my| \\le ty$.\n  \\ii [(b)]\n  Determine whether there exists an infinite set $S$\n  of positive integers such that the following holds:\n  for any distinct $x, y \\in S$ and \\emph{positive} integer $m > 0$,\n  we have $|x-my| > ty$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10191603}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFix a real number $0 < t < \\half$.\n\\begin{enumerate}\n  \\ii [(a)]\n  Prove that there exists a positive integer $n$\n  such that for every set $S$ of $n$ positive integers,\n  the following holds:\n  there exist distinct $x, y \\in S$ and \\emph{nonnegative} integer $m \\ge 0$\n  such that $|x-my| \\le ty$.\n  \\ii [(b)]\n  Determine whether there exists an infinite set $S$\n  of positive integers such that the following holds:\n  for any distinct $x, y \\in S$ and \\emph{positive} integer $m > 0$,\n  we have $|x-my| > ty$.\n\\end{enumerate}\n\\end{mdframed}\n\\paragraph{Solution to (a).}\nAssume not. Let $S = \\left\\{ s_1 < \\dots < s_n \\right\\}$.\nConsider\n\\[ 1 > \\frac{s_1}{s_2} > \\frac{s_1}{s_3} > \\dots > \\frac{s_1}{s_n} > t. \\]\nNote that two of the fractions above are within a factor of\n$t^{1/(n-1)}$ of each other; taking $n$ large enough so that\n$t^{1/(n-1)} \\ge 1-t$ gives the conclusion.\n\n\n\\paragraph{Solution to (b).}\nYes, such a set $S$ exists.\n\nTo construct it, we employ a greedy algorithm.\nLet $N$ be a large integer such that $t < 1/2-1/N$.\nWe define $S = \\left\\{ s_1 < s_2 < \\dots \\right\\}$ inductively as follows.\n\\begin{itemize}\n\\ii First, let $s_1$ be any prime number exceeding $N$.\n\n\\ii Then, given $s_1$, \\dots, $s_k$,\nwe let $s_{k+1}$ equal a prime number which is greater than $2s_k$,\nand is congruent to $\\tfrac{s_i-1}{2} \\pmod{s_i}$ for $i = 1, \\dots, k$.\nThis is possible by Chinese remainder theorem and Dirichlet theorem.\n\\end{itemize}\n\nBy construction, this works: if $i < j$ then $s_i / s_j < 1/2$\nwhile $s_j / s_i$ has fractional part within $s_i^{-1}$ of $1/2$.\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "EGMO", "year": 2018}
{"id": "tst-2014-q1", "question": "Let $ABC$ be an acute triangle, and let $X$ be a variable interior point\non the minor arc $BC$ of its circumcircle.\nLet $P$ and $Q$ be the feet of the perpendiculars from $X$ to lines $CA$ and $CB$, respectively.\nLet $R$ be the intersection of line $PQ$ and the perpendicular from $B$ to $AC$.\nLet $\\ell$ be the line through $P$ parallel to $XR$.\nProve that as $X$ varies along minor arc $BC$,\nthe line $\\ell$ always passes through a fixed point.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3332310}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be an acute triangle, and let $X$ be a variable interior point\non the minor arc $BC$ of its circumcircle.\nLet $P$ and $Q$ be the feet of the perpendiculars from $X$ to lines $CA$ and $CB$, respectively.\nLet $R$ be the intersection of line $PQ$ and the perpendicular from $B$ to $AC$.\nLet $\\ell$ be the line through $P$ parallel to $XR$.\nProve that as $X$ varies along minor arc $BC$,\nthe line $\\ell$ always passes through a fixed point.\n\\end{mdframed}\nThe fixed point is the orthocenter,\nsince $\\ell$ is a Simson line.\nSee Lemma 4.4 of \\emph{Euclidean Geometry in Math Olympiads}.\n\\pagebreak", "category": "Geometry", "source": "TST", "year": 2014}
{"id": "tst-2014-q2", "question": "Let $a_1$, $a_2$, $a_3$, \\dots be a sequence of integers,\nwith the property that every consecutive group of $a_i$'s\naverages to a perfect square.\nMore precisely, for all positive integers $n$ and $k$, the quantity\n \\[ \\frac{a_n + a_{n+1} + \\dots + a_{n+k-1}}{k} \\]\nis always the square of an integer.\nProve that the sequence must be constant\n(all $a_i$ are equal to the same perfect square).", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3332299}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a_1$, $a_2$, $a_3$, \\dots be a sequence of integers,\nwith the property that every consecutive group of $a_i$'s\naverages to a perfect square.\nMore precisely, for all positive integers $n$ and $k$, the quantity\n \\[ \\frac{a_n + a_{n+1} + \\dots + a_{n+k-1}}{k} \\]\nis always the square of an integer.\nProve that the sequence must be constant\n(all $a_i$ are equal to the same perfect square).\n\\end{mdframed}\nLet $\\nu_p(n)$ denote the largest exponent of $p$ dividing $n$.\nThe problem follows from the following proposition.\n\n\\begin{proposition*}\n  Let $(a_n)$ be a sequence of integers and let $p$ be a prime.\n  Suppose that every consecutive group of $a_i$'s\n  with length at most $p$ averages to a perfect square.\n  Then $\\nu_p(a_i)$ is independent of $i$.\n\\end{proposition*}\n\nWe proceed by induction on the smallest value of $\\nu_p(a_i)$ as $i$ ranges\n(which must be even, as each of the $a_i$ are themselves a square).\nFirst we prove two claims.\n\n\\begin{claim*}\n  If $j \\equiv k \\pmod p$ then $a_j \\equiv a_k \\pmod{p}$.\n\\end{claim*}\n\\begin{proof}\n  Taking groups of length $p$ in our given,\n  we find that $p \\mid a_j +\\dots + a_{j+p-1}$\n  and $p \\mid a_{j+1} + \\dots + a_{j+p}$ for any $j$.\n  So $a_j \\equiv a_{j+p} \\pmod p$ and the conclusion follows.\n\\end{proof}\n\n\\begin{claim*}\n  If some $a_i$ is divisible by $p$ then all of them are.\n\\end{claim*}\n\\begin{proof}\n  The case $p=2$ is trivial so assume $p \\ge 3$.\n  Without loss of generality (via shifting indices)\n  assume that $a_1 \\equiv 0 \\pmod{p}$, and define\n  \\[ S_n = a_1 + a_2 + \\dots + a_n \\equiv a_2 + \\dots + a_n \\pmod{p}. \\]\n  Call an integer $k$ with $2 \\le k < p$ a\n  \\textbf{pivot} if $1-k^{-1}$ is a quadratic nonresidue modulo $p$.\n\n  We claim that for any pivot $k$, $S_k \\equiv 0 \\pmod{p}$.\n  If not, then\n  \\[ \\frac{a_1 + a_2 + \\dots + a_k}{k}\n    \\text{ and } \\frac{a_2 + \\dots + a_k}{k-1} \\]\n  are both qudaratic residues.\n  Division implies that $\\frac{k-1}{k} = 1 - k\\inv$ is a\n  quadratic residue, contradiction.\n\n  Next we claim that there is an integer $m$\n  with $S_m \\equiv S_{m+1} \\equiv 0 \\pmod{p}$,\n  which implies $p \\mid a_{m+1}$.\n  If $2$ is a pivot, then we simply take $m=1$.\n  Otherwise, there are $\\frac12(p-1)$ pivots,\n  one for each nonresidue (which includes neither $0$ nor $1$),\n  and all pivots lie in $[3,p-1]$,\n  so we can find an $m$ such that $m$ and $m+1$ are both pivots.\n\n  Repeating this procedure starting with $a_{m+1}$\n  shows that $a_{2m+1}, a_{3m+1}, \\dots$ must all be divisible by $p$.\n  Combined with the first claim and the fact that $m < p$,\n  we find that all the $a_i$ are divisible by $p$.\n\\end{proof}\n\nThe second claim establishes the base case of our induction.\nNow assume all $a_i$ are divisible by $p$ and hence $p^2$.\nThen all the averages in our proposition (with length at most $p$)\nare divisible by $p$ and hence $p^2$.\nThus the map $a_i \\mapsto \\frac{1}{p^2} a_i$ gives a new sequence\nsatisfying the proposition, and our inductive hypothesis completes the proof.\n\n\\begin{remark*}\n  There is a subtle bug that arises\n  if one omits the condition that $k \\le p$ in the proposition.\n  When $k = p^2$ the average $\\frac{a_1 + \\dots + a_{p^2}}{p^2}$\n  is not necessarily divisible by $p$\n  even if all the $a_i$ are.\n  Hence it is not valid to divide through by $p$.\n  This is why the condition $k \\le p$ was added.\n\\end{remark*}\n\\pagebreak", "category": "Number Theory", "source": "TST", "year": 2014}
{"id": "tst-2014-q3", "question": "Let $n$ be an even positive integer,\nand let $G$ be an $n$-vertex (simple) graph\nwith exactly $\\frac{n^2}{4}$ edges.\nAn unordered pair of distinct vertices $\\{x,y\\}$\nis said to be \\emph{amicable} if they have a common neighbor\n(there is a vertex $z$ such that $xz$ and $yz$ are both edges).\nProve that $G$ has at least $2\\binom{n/2}{2}$\npairs of vertices which are amicable.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3332307}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n$ be an even positive integer,\nand let $G$ be an $n$-vertex (simple) graph\nwith exactly $\\frac{n^2}{4}$ edges.\nAn unordered pair of distinct vertices $\\{x,y\\}$\nis said to be \\emph{amicable} if they have a common neighbor\n(there is a vertex $z$ such that $xz$ and $yz$ are both edges).\nProve that $G$ has at least $2\\binom{n/2}{2}$\npairs of vertices which are amicable.\n\\end{mdframed}\nFirst, we prove the following lemma.\n(\\url{https://en.wikipedia.org/wiki/Friendship_paradox}).\n\\begin{lemma*}\n  [On average, your friends are more popular than you]\n  For a vertex $v$, let $a(v)$ denote\n  the average degree of the neighbors of $v$\n  (setting $a(v) = 0$ if $\\deg v = 0$).\n  Then\n  \\[ \\sum_v a(v) \\ge \\sum_v \\deg v = 2 \\# E. \\]\n\\end{lemma*}\n\\begin{proof}\n  Ignoring isolated vertices, we can write\n  \\begin{align*}\n    \\sum_v a(v)\n    &= \\sum_v \\frac{\\sum_{w \\sim v} \\deg w}{\\deg v} \\\\\n    &= \\sum_{v} \\sum_{w \\sim v} \\frac{\\deg w}{\\deg v} \\\\\n    &= \\sum_{\\text{edges } vw} \\left(\n      \\frac{\\deg w}{\\deg v} + \\frac{\\deg v}{\\deg w} \\right) \\\\\n    &\\overset{\\text{AM-GM}}{\\ge} \\sum_{\\text{edges } vw} 2\n      = 2\\#E = \\sum_{v} \\deg v\n  \\end{align*}\n  as desired.\n\\end{proof}\n\\begin{corollary*}\n  [On average, your most popular friend is more popular than you]\n  For a vertex $v$, let $m(v)$ denote\n  the maximum degree of the neighbors of $v$\n  (setting $m(v) = 0$ if $\\deg v = 0$).\n  Then\n  \\[ \\sum_v m(v) \\ge \\sum_v \\deg v = 2 \\# E. \\]\n\\end{corollary*}\n\nWe can use this to count amicable pairs\nby noting that any particular vertex $v$ is in\nat least $m(v)-1$ amicable pairs.\nSo, the number of amicable pairs is at least\n\\[ \\half \\sum_v (m(v)-1) \\ge \\# E - \\half \\# V. \\]\n\nNote that up until now we haven't used any information about $G$.\nBut now if we plug in $\\# E = n^2/4$, $\\# V = n$,\nthen we get exactly the desired answer.\n(Equality holds for $G = K_{n/2, n/2}$.)\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Combinatorics", "source": "TST", "year": 2014}
{"id": "tst-2014-q4", "question": "Let $n$ be a positive even integer,\nand let $c_1$, $c_2$, \\dots, $c_{n-1}$ be real numbers satisfying\n\\[ \\sum_{i=1}^{n-1} \\left\\lvert c_i-1 \\right\\rvert < 1. \\]\nProve that\n\\[ 2x^n - c_{n-1}x^{n-1} + c_{n-2}x^{n-2} - \\dots - c_1x^1 + 2 \\]\nhas no real roots.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3476290}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n$ be a positive even integer,\nand let $c_1$, $c_2$, \\dots, $c_{n-1}$ be real numbers satisfying\n\\[ \\sum_{i=1}^{n-1} \\left\\lvert c_i-1 \\right\\rvert < 1. \\]\nProve that\n\\[ 2x^n - c_{n-1}x^{n-1} + c_{n-2}x^{n-2} - \\dots - c_1x^1 + 2 \\]\nhas no real roots.\n\\end{mdframed}\nWe will prove the polynomial is positive for all $x \\in \\RR$.\nAs $c_i > 0$, the result is vacuous for $x \\le 0$,\nso we restrict attention to $x > 0$.\n\nThen letting $c_i = 1 - d_i$ for each $i$,\nthe inequality we want to prove becomes\n\\[ x^n + 1 + \\frac{x^{n+1}+1}{x+1} > \\sum_1^{n-1} d_i x^i\n  \\qquad\\text{given } \\sum |d_i| < 1.  \\]\nBut obviously $x^n+1 > x^i$ for any $1 \\le i \\le n-1$ and $x > 0$.\nSo in fact $x^n+1 > \\sum_1^{n-1} |d_i| x^i$ holds for $x > 0$,\nas needed.\n\\pagebreak", "category": "Algebra", "source": "TST", "year": 2014}
{"id": "tst-2014-q5", "question": "Let $ABCD$ be a cyclic quadrilateral,\nand let $E$, $F$, $G$, and $H$ be the midpoints of $AB$, $BC$, $CD$, and $DA$ respectively.\nLet $W$, $X$, $Y$ and $Z$ be the orthocenters of\ntriangles $AHE$, $BEF$, $CFG$ and $DGH$, respectively.\nProve that the quadrilaterals $ABCD$ and $WXYZ$ have the same area.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3476291}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABCD$ be a cyclic quadrilateral,\nand let $E$, $F$, $G$, and $H$ be the midpoints of $AB$, $BC$, $CD$, and $DA$ respectively.\nLet $W$, $X$, $Y$ and $Z$ be the orthocenters of\ntriangles $AHE$, $BEF$, $CFG$ and $DGH$, respectively.\nProve that the quadrilaterals $ABCD$ and $WXYZ$ have the same area.\n\\end{mdframed}\nThe following solution is due to Grace Wang.\n\nWe begin with:\n\\begin{claim*}\n  Point $W$ has coordinates $\\half(2a+b+d)$.\n\\end{claim*}\n\\begin{proof}\n  The orthocenter of $\\triangle DAB$ is $d+a+b$,\n  and $\\triangle AHE$ is homothetic to $\\triangle DAB$\n  through $A$ with ratio $1/2$.\n  Hence $w = \\half(a+(d+a+b))$ as needed.\n\\end{proof}\n\nBy symmetry, we have\n\\begin{align*}\n  w &= \\half(2a+b+d) \\\\\n  x &= \\half(2b+c+a) \\\\\n  y &= \\half(2c+d+b) \\\\\n  z &= \\half(2d+a+c).\n\\end{align*}\nWe see that $w-y = a-c$, $x-z = b-d$.\nSo the diagonals of $WXYZ$ have the same length as those\nof $ABCD$ as well as the same directed angle between them.\nThis implies the areas are equal, too.\n\\pagebreak", "category": "Geometry", "source": "TST", "year": 2014}
{"id": "tst-2014-q6", "question": "For a prime $p$, a subset $S$ of residues modulo $p$\nis called a \\emph{sum-free multiplicative subgroup}\nof $\\FF_p$ if\n\\begin{itemize}\n  \\ii there is a nonzero residue $\\alpha$ modulo $p$\n  such that $S = \\left\\{ 1, \\alpha^1, \\alpha^2, \\dots \\right\\}$\n  (all considered mod $p$), and\n  \\ii there are no $a,b,c \\in S$\n  (not necessarily distinct) such that $a+b \\equiv c \\pmod p$.\n\\end{itemize}\nProve that for every integer $N$,\nthere is a prime $p$ and a sum-free multiplicative subgroup $S$\nof $\\FF_p$ such that $\\left\\lvert S \\right\\rvert \\ge N$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3476292}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFor a prime $p$, a subset $S$ of residues modulo $p$\nis called a \\emph{sum-free multiplicative subgroup}\nof $\\FF_p$ if\n\\begin{itemize}\n  \\ii there is a nonzero residue $\\alpha$ modulo $p$\n  such that $S = \\left\\{ 1, \\alpha^1, \\alpha^2, \\dots \\right\\}$\n  (all considered mod $p$), and\n  \\ii there are no $a,b,c \\in S$\n  (not necessarily distinct) such that $a+b \\equiv c \\pmod p$.\n\\end{itemize}\nProve that for every integer $N$,\nthere is a prime $p$ and a sum-free multiplicative subgroup $S$\nof $\\FF_p$ such that $\\left\\lvert S \\right\\rvert \\ge N$.\n\\end{mdframed}\nWe first prove the following general lemma.\n\n\\begin{lemma*}\n  If $f,g \\in \\ZZ[X]$ are relatively prime nonconstant polynomials,\n  then for sufficiently large primes $p$,\n  they have no common root modulo $p$.\n\\end{lemma*}\n\\begin{proof}\n  By B\\'{e}zout Lemma,\n  there exist polynomials $a(X)$ and $b(X)$ in $\\ZZ[X]$\n  and a nonzero constant $c \\in \\ZZ$ satisfying the identity\n  \\[ a(X) f(X) + b(X) g(X) \\equiv c. \\]\n  So, plugging in $X = r$ we get $p \\mid c$,\n  so the set of permissible primes $p$ is finite.\n\\end{proof}\n\nWith this we can give the construction.\n\\begin{claim*}\n  Suppose that\n  \\begin{itemize}\n    \\ii $n$ is a positive integer with $n \\not\\equiv 0 \\pmod 3$;\n    \\ii $p$ is a prime which is $1 \\bmod n$; and\n    \\ii $\\alpha$ is a primitive $n$'th root of unity modulo $p$.\n  \\end{itemize}\n  Then $|S| = n$ and, if $p$ is sufficiently large in $n$,\n  is also sum-free.\n\\end{claim*}\n\\begin{proof}\n  The assertion $|S|=n$ is immediate from the choice of $\\alpha$.\n  As for sum-free, assume for contradiction that\n  \\[ 1 + \\alpha^k \\equiv \\alpha^m \\pmod p \\]\n  for some integers $k,m \\in \\ZZ$.\n  This means $(X+1)^n-1$ and $X^n-1$ have common root $X=\\alpha^k$.\n\n  But\n  \\[ \\gcd_{\\ZZ[x]} \\Big( (X+1)^n-1, \\; X^n-1 \\Big)\n    = 1 \\qquad \\forall n \\not\\equiv 0 \\pmod 3 \\]\n  because when $3 \\nmid n$ the two polynomials\n  have no common complex roots.\n  (Indeed, if $|\\omega| = |1+\\omega| = 1$\n  then $\\omega = -\\half \\pm \\frac{\\sqrt3}{2}i$.)\n\n  Thus $p$ is bounded by the lemma, as desired.\n\\end{proof}\n\\pagebreak\n\n\n\\end{document}", "category": "Number Theory", "source": "TST", "year": 2014}
{"id": "tstst-2014-q1", "question": "Let $\\leftarrow$ denote the left arrow key on a standard keyboard. If\none opens a text editor and types the keys\n``ab$\\leftarrow$ cd $\\leftarrow \\leftarrow$ e $\\leftarrow \\leftarrow$ f'',\nthe result is ``faecdb''.\nWe say that a string $B$ is \\emph{reachable} from a string $A$ if\nit is possible to insert some amount of $\\leftarrow$'s in $A$,\nsuch that typing the resulting characters produces $B$.\nSo, our example shows that ``faecdb'' is reachable from ``abcdef''.\n\nProve that for any two strings $A$ and $B$,\n$A$ is reachable from $B$ if and only if $B$ is reachable from $A$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3549404}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $\\leftarrow$ denote the left arrow key on a standard keyboard. If\none opens a text editor and types the keys\n``ab$\\leftarrow$ cd $\\leftarrow \\leftarrow$ e $\\leftarrow \\leftarrow$ f'',\nthe result is ``faecdb''.\nWe say that a string $B$ is \\emph{reachable} from a string $A$ if\nit is possible to insert some amount of $\\leftarrow$'s in $A$,\nsuch that typing the resulting characters produces $B$.\nSo, our example shows that ``faecdb'' is reachable from ``abcdef''.\n\nProve that for any two strings $A$ and $B$,\n$A$ is reachable from $B$ if and only if $B$ is reachable from $A$.\n\\end{mdframed}\nObviously $A$ and $B$ should have the\nsame multiset of characters, and we focus only on that situation.\n\n\\begin{claim*}\n  If $A = 123 \\dots n$\n  and $B = \\sigma(1) \\sigma(2) \\dots \\sigma(n)$\n  is a permutation of $A$,\n  then $B$ is reachable if and only if\n  it is \\textbf{213-avoiding},\n  i.e.\\ there are no indices $i < j < k$\n  such that $\\sigma(j) < \\sigma(i) < \\sigma(k)$.\n\\end{claim*}\n\\begin{proof}\n  This is clearly necessary.\n  To see its sufficient, one can just type $B$ inductively:\n  after typing $k$, the only way to get stuck is if\n  $k+1$ is to the right of $k$ and there is some character in the way;\n  this gives a 213 pattern.\n\\end{proof}\n\n\\begin{claim*}\n  A permutation $\\sigma$ on $\\{1, \\dots, n\\}$\n  is 213-avoiding if and only if the inverse $\\sigma\\inv$ is.\n\\end{claim*}\n\\begin{proof}\n  Suppose $i < j < k$ and $\\sigma(j) < \\sigma(i) < \\sigma(k)$.\n  Let $i' = \\sigma(j)$, $j' = \\sigma(i)$, $k' = \\sigma(k)$;\n  then $i' < j' < k'$ and $\\sigma\\inv(j') < \\sigma\\inv(i') < \\sigma\\inv(k')$.\n\\end{proof}\n\nThis essentially finishes the problem.\nSuppose $B$ is reachable from $A$.\nBy using the typing pattern,\nwe get some permutation $\\sigma \\colon \\{1, \\dots, n\\}$\nsuch that the $i$th character of $A$\nis the $\\sigma(i)$th character of $B$,\nand which is 213-avoiding by the claim.\n(The permutation is unique if $A$ has all distinct characters,\nbut there could be multiple if $A$ has repeated ones.)\nThen $\\sigma\\inv$ is 213-avoiding too\nand gives us a way to change $B$ into $A$.\n\\pagebreak", "category": "Combinatorics", "source": "TSTST", "year": 2014}
{"id": "tstst-2014-q2", "question": "Consider a convex pentagon circumscribed about a circle.\nWe name the lines that connect vertices of the pentagon with\nthe opposite points of tangency with the circle \\emph{gergonnians}.\n\\begin{enumerate}\n  \\ii[(a)] Prove that if four gergonnians are concurrent,\n    then all five of them are concurrent.\n  \\ii[(b)] Prove that if there is a triple of gergonnians\n    that are concurrent, then there is another triple\n    of gergonnians that are concurrent.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3549405}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nConsider a convex pentagon circumscribed about a circle.\nWe name the lines that connect vertices of the pentagon with\nthe opposite points of tangency with the circle \\emph{gergonnians}.\n\\begin{enumerate}\n  \\ii[(a)] Prove that if four gergonnians are concurrent,\n    then all five of them are concurrent.\n  \\ii[(b)] Prove that if there is a triple of gergonnians\n    that are concurrent, then there is another triple\n    of gergonnians that are concurrent.\n\\end{enumerate}\n\\end{mdframed}\nThis problem is insta-killed by taking a homography\nsending the concurrency point (in either part)\nto the center of the circle while fixing the incircle.\nAlternatively, one may send any four of the tangency points to a rectangle.\n\nHere are the details.\nLet $ABCDE$ be a pentagon with gergonnians\n$\\ol{AV}$, $\\ol{BW}$, $\\ol{CX}$, $\\ol{DY}$, $\\ol{EZ}$.\nWe prove the following lemma, which\n(up to a suitable permutation of point names)\nsolves both parts (a) and (b).\n\\begin{lemma*}\n  The gergonnians $\\ol{AV}$, $\\ol{CX}$, $\\ol{DY}$\n  are concurrent if and only if the gergonnians\n  $\\ol{AV}$, $\\ol{BW}$, $\\ol{EZ}$ are concurrent.\n\\end{lemma*}\n\\begin{proof}\n  We prove the first set implies the second\n  (the converse direction being identical).\n  Suppose $\\ol{AV}$, $\\ol{CX}$, $\\ol{DY}$ intersect at $P$\n  and take a homography fixing the circle\n  and moving $P$ to its center.\n\n  \\begin{center}\n  \\begin{asy}\n  size(7cm);\n  pair Y = dir(115);\n  pair X = -conj(Y);\n  pair V = dir(270);\n  pair Z = X*X/V;\n  pair W = Y*Y/V;\n\n  pair A = 2*X*Y/(X+Y);\n  pair B = 2*Y*Z/(Y+Z);\n  pair C = 2*Z*V/(Z+V);\n  pair D = 2*V*W/(V+W);\n  pair E = 2*W*X/(W+X);\n\n  filldraw(A--B--C--D--E--cycle, opacity(0.1)+lightblue, blue);\n  filldraw(unitcircle, opacity(0.1)+lightcyan, blue);\n\n  pair P = origin;\n  draw(C--X, red);\n  draw(D--Y, red);\n  draw(A--V, red);\n\n  draw(B--W, heavygreen+dashed);\n  draw(E--Z, heavygreen+dashed);\n\n  dot(\"$Y$\", Y, dir(Y));\n  dot(\"$X$\", X, dir(X));\n  dot(\"$V$\", V, dir(V));\n  dot(\"$Z$\", Z, dir(Z));\n  dot(\"$W$\", W, dir(W));\n  dot(\"$A$\", A, dir(A));\n  dot(\"$B$\", B, dir(B));\n  dot(\"$C$\", C, dir(C));\n  dot(\"$D$\", D, dir(D));\n  dot(\"$E$\", E, dir(E));\n  dot(\"$P$\", P, dir(0));\n\n  /* Source generated by TSQ */\n  \\end{asy}\n  \\end{center}\n\n  Then $X$ and $Y$ are symmetric around $\\ol{APV}$\n  by hypothesis.\n  Since $D = \\ol{VV} \\cap \\ol{PY}$, $C = \\ol{VV} \\cap \\ol{PX}$,\n  it follows that $C$ and $D$,\n  and hence $Z$ and $W$,\n  are also symmetric around $\\ol{APV}$.\n  Consequently $B$ and $E$ are symmetric too.\n  So $\\ol{BW}$ and $\\ol{EZ}$ meet on $\\ol{AV}$.\n\\end{proof}\n\\pagebreak", "category": "Geometry", "source": "TSTST", "year": 2014}
{"id": "tstst-2014-q3", "question": "Find all polynomials $P(x)$ with real coefficients that satisfy\n\\[ P(x \\sqrt 2) = P(x + \\sqrt{1-x^2}) \\]\nfor all real numbers $x$ with $\\lvert x \\rvert \\le 1$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3549407}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all polynomials $P(x)$ with real coefficients that satisfy\n\\[ P(x \\sqrt 2) = P(x + \\sqrt{1-x^2}) \\]\nfor all real numbers $x$ with $\\lvert x \\rvert \\le 1$.\n\\end{mdframed}\nThe answer is any polynomial of the form\n$P(x) = f(U(x/\\sqrt2))$, where $f \\in \\RR[x]$\nand $U$ is the unique polynomial satisfying $U(\\cos\\theta) = \\cos(8\\theta)$.\n\nLet $Q(x) = P(x \\sqrt 2)$; then the condition reads\n\\[\n  Q(\\cos\\theta) = Q\\left( \\frac{1}{\\sqrt2}(\\cos\\theta+\\sin\\theta) \\right)\n  = Q(\\cos(\\theta-45\\dg)) \\qquad \\forall \\; 0 \\le \\theta \\le 180\\dg.\n\\]\nWe call a polynomial \\emph{good} if it satisfies this functional equation.\nIt's easy to see $U$ itself is good, and hence so is any polynomial of the form\n$g(U(x))$ for $g \\in \\RR[x]$.\nOur goal is to show that every good $Q$ is of this form.\n\nThe proof is by induction on $\\deg Q$, where the case $\\deg Q = 0$ is vacuous.\nNote that\n\\begin{align*}\n  Q(\\cos136\\dg) &= Q(\\cos91\\dg)\n  = Q(\\cos46\\dg) = Q(\\cos1\\dg) = Q(\\cos-44\\dg) \\\\\n  &= Q(\\cos44\\dg) = Q(\\cos89\\dg) = Q(\\cos134\\dg) = Q(\\cos179\\dg).\n\\end{align*}\nHence $Q$ is equal at eight distinct values\n(not nine since $\\cos -44\\dg = \\cos44\\dg$ is repeated).\nSo it follows that the quotient\n\\[ \\wt Q(x) \\coloneq \\frac{Q(x) - Q(\\cos1\\dg)}{U(x) - U(\\cos1\\dg)} \\]\nis also a good polynomial, because the polynomial\n$U(x) - U(\\cos1\\dg)$ is the degree-eight polynomial with those distinct values as roots.\n\nIn particular, $\\deg Q \\ge 8$ unless $Q$ is constant, and in fact\n\\[ Q(x) = \\left[ U(x) - U(\\cos 1\\dg) \\right] \\wt Q(x) + Q(\\cos(1\\dg)) \\]\nso if one applies the induction hypothesis to $\\wt Q(x)$\n(which has degree $\\deg Q - 8$), the proof is completed.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Algebra", "source": "TSTST", "year": 2014}
{"id": "tstst-2014-q4", "question": "Let $P(x)$ and $Q(x)$ be arbitrary polynomials with real coefficients,\nwith $P \\neq 0$, and let $d = \\deg P$.\nProve that there exist polynomials $A(x)$ and $B(x)$,\nnot both zero, such that $\\max \\{ \\deg A, \\deg B \\} \\le d/2$\nand $P(x) \\mid A(x) + Q(x) \\cdot B(x)$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3549409}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $P(x)$ and $Q(x)$ be arbitrary polynomials with real coefficients,\nwith $P \\neq 0$, and let $d = \\deg P$.\nProve that there exist polynomials $A(x)$ and $B(x)$,\nnot both zero, such that $\\max \\{ \\deg A, \\deg B \\} \\le d/2$\nand $P(x) \\mid A(x) + Q(x) \\cdot B(x)$.\n\\end{mdframed}\nLet $V$ be the vector space of real polynomials with degree at most $d/2$.\nConsider maps of linear spaces\n\\begin{align*}\n  V^{\\oplus 2} &\\to \\RR[x] / (P(x)) \\\\\n  \\text{by} \\qquad (A,B) &\\mapsto A+QB \\pmod P.\n\\end{align*}\nThe domain has dimension\n\\[ 2 \\left( \\left\\lfloor d/2 \\right\\rfloor + 1 \\right) \\]\nwhile the codomain has dimension $d$.\nFor dimension reasons it has nontrivial kernel.\n\\pagebreak", "category": "Algebra", "source": "TSTST", "year": 2014}
{"id": "tstst-2014-q5", "question": "Find the maximum number $E$ such that the following holds:\nthere is an edge-colored graph with $60$ vertices and $E$ edges,\nwith each edge colored either red or blue, such that in that coloring,\nthere is no monochromatic cycles of length $3$\nand no monochromatic cycles of length $5$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3549412}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind the maximum number $E$ such that the following holds:\nthere is an edge-colored graph with $60$ vertices and $E$ edges,\nwith each edge colored either red or blue, such that in that coloring,\nthere is no monochromatic cycles of length $3$\nand no monochromatic cycles of length $5$.\n\\end{mdframed}\nThe answer is $E = 30^2 + 2 \\cdot 15^2 = 6 \\cdot 15^2 = 1350$.\n\nFirst, we prove $E \\le 1350$.  Observe that:\n\\begin{claim*}\n  $G$ contains no $K_5$.\n\\end{claim*}\n\\begin{proof}\n  It's a standard fact that the only triangle-free two-coloring\n  of the edges of $K_5$ is the union of two monochromatic $C_5$'s.\n\\end{proof}\nHence by Tur\\'{a}n theorem we have $E \\le \\binom42 \\cdot 15^2 = 1350$.\n\nTo show this is achievable, take a red $K_{30,30}$,\nand on each side draw a blue $K_{15,15}$.\nThis graph has no monochromatic odd cycles at all as desired.\n\\pagebreak", "category": "Combinatorics", "source": "TSTST", "year": 2014}
{"id": "tstst-2014-q6", "question": "Suppose we have distinct positive integers $a$, $b$, $c$, $d$\nand an odd prime $p$ not dividing any of them,\nand an integer $M$ such that if one considers the infinite sequence\n\\begin{align*}\n  ca &- db \\\\\n  ca^2 &- db^2 \\\\\n  ca^3 &- db^3 \\\\\n  ca^4 &- db^4 \\\\\n  &\\vdots\n\\end{align*}\nand looks at the highest power of $p$ that divides each of them,\nthese powers are not all zero, and are all at most $M$.\nProve that there exists some $T$ (which may depend on $a,b,c,d,p,M$)\nsuch that whenever $p$ divides an element of this sequence,\nthe maximum power of $p$ that divides that element is exactly $p^T$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3549417}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nSuppose we have distinct positive integers $a$, $b$, $c$, $d$\nand an odd prime $p$ not dividing any of them,\nand an integer $M$ such that if one considers the infinite sequence\n\\begin{align*}\n  ca &- db \\\\\n  ca^2 &- db^2 \\\\\n  ca^3 &- db^3 \\\\\n  ca^4 &- db^4 \\\\\n  &\\vdots\n\\end{align*}\nand looks at the highest power of $p$ that divides each of them,\nthese powers are not all zero, and are all at most $M$.\nProve that there exists some $T$ (which may depend on $a,b,c,d,p,M$)\nsuch that whenever $p$ divides an element of this sequence,\nthe maximum power of $p$ that divides that element is exactly $p^T$.\n\\end{mdframed}\nBy orders, the indices of terms divisible by $p$\nis an arithmetic subsequence of $\\NN$:\nsay they are $\\kappa$, $\\kappa + \\lambda$, $\\kappa + 2\\lambda$, \\dots,\nwhere $\\lambda$ is the order of $a/b$.\nThat means we want\n\\[ \\nu_p \\left( c a^{\\kappa + n\\lambda} - d b^{\\kappa + n \\lambda} \\right)\n  = \\nu_p \\left(\n    \\left( \\frac{a^\\lambda}{b^\\lambda} \\right)^n\n    - \\frac{d a^\\kappa}{c b^{\\kappa}} \\right)\n\\]\nto be constant.\nThus, we have reduced the problem to the following proposition:\n\\begin{proposition*}\n  Let $p$ be an odd prime.\n  Let $x, y \\in \\QQ_{>0}$ such that $x \\equiv y \\equiv 1 \\pmod p$.\n  If the sequence $\\nu_p\\left( x^n - y \\right)$ of positive integers\n  is nonconstant, then it is unbounded.\n\\end{proposition*}\n\nFor this it would be sufficient to prove the following claim.\n\\begin{claim*}\n  Let $p$ be an odd prime.\n  Let $x, y \\in \\QQ_{>0}$ such that $x \\equiv y \\equiv 1 \\pmod p$.\n  Suppose $m$ and $n$ are positive integers such that\n  \\[ d = \\nu_p(x^n-y) < \\nu_p(x^m-y) = e. \\]\n  Then there exists $\\ell$ such that $\\nu_p(x^\\ell - y) \\ge e + 1$.\n\\end{claim*}\n\\begin{proof}\nFirst, note that\n$\\nu_p(x^m - x^n) = \\nu_p\\left( (x^m-y) - (x^n-y) \\right) = d$\nand so by exponent lifting we can find \\emph{some} $k$ such that\n\\[ \\nu_p(x^k-1) = e \\]\nnamely $k = p^{e-d}|m-n|$.\n(In fact, one could also choose more carefully\n$k = p^{e-d} \\cdot \\gcd(m-n, p^\\infty)$,\nso that $k$ is a power of $p$.)\n\nSuppose we set $x^k = p^e u + 1$ and $x^m = p^e v + y$\nwhere $u,v \\in \\QQ$ aren't divisible by $p$.\nNow for any integer $1 \\le r \\le p-1$ we consider\n\\begin{align*}\n  x^{kr+m}-y &= (p^e u + 1)^r \\cdot (p^e v + y) - y \\\\\n  &= p^e \\left( v + yu \\cdot r \\right) + p^{2e} \\left( \\dots \\right).\n\\end{align*}\nBy selecting $r$ with $r \\equiv -v/u \\pmod p$,\nwe ensure $p^{e+1} \\mid x^{kr+m} - y$,\nhence $\\ell = kr+m$ is as desired.\n\\end{proof}\n\n\\begin{remark*}\n  One way to motivate the proof of the claim is as follows.\n  Suppose we are given $\\nu_p(x^m-y) = e$,\n  and we wish to find $\\ell$ such that $\\nu_p(x^\\ell - y) > e$.\n  Then, it is necessary (albeit insufficient) that\n  \\[ x^{\\ell-m} \\equiv 1 \\pmod{p^e} \\text{ but }\n    x^{\\ell-m} \\not\\equiv 1 \\pmod{p^{e+1}}. \\]\n  In particular, we need $\\nu_p(x^{\\ell-m}-1) = e$ exactly.\n  So the $k$ in the claim must exist if we are going to succeed.\n\n  On the other hand, if $k$ is \\emph{some} integer for which\n  $\\nu_p(x^k-1) = e$, then by choosing $\\ell-m$ to be some\n  multiple of $k$ with no extra factors of $p$,\n  we hope that we can get $\\nu_p(x^\\ell-y) = e+1$.\n  That's why we write $\\ell = kr+m$ and see what happens when we expand.\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Number Theory", "source": "TSTST", "year": 2014}
{"id": "putnam-2015-a1", "question": "Let $A$ and $B$ be points on the same branch of the hyperbola $xy=1$. Suppose that $P$ is a point lying between $A$ and $B$ on this hyperbola, such that the area of the triangle $APB$ is as large as possible. Show that the region bounded by the hyperbola and the chord $AP$ has the same area as the region bounded by the hyperbola and the chord $PB$.", "solution": "\\textbf{First solution:}\nWithout loss of generality, assume that $A$ and $B$ lie in the first quadrant with $A = (t_1,1/t_1)$, $B = (t_2,1/t_2)$, and $t_1<t_2$. If $P = (t,1/t)$ with $t_1 \\leq t \\leq t_2$, then the area of triangle $APB$ is\n\\[\n\\frac{1}{2} \\left| \\begin{matrix} 1 & 1 & 1 \\\\ t_1 & t & t_2 \\\\ 1/t_1 & 1/t & 1/t_2 \\end{matrix} \\right| = \\frac{t_2-t_1}{2t_1t_2} (t_1+t_2-t-t_1t_2/t).\n\\]\nWhen $t_1,t_2$ are fixed, this is maximized when $t+t_1t_2/t$ is minimized, which by AM-GM exactly holds when $t = \\sqrt{t_1t_2}$.\n\nThe line $AP$ is given by $y = \\frac{t_1+t-x}{tt_1}$, and so the area of the region bounded by the hyperbola and $AP$ is\n\\[\n\\int_{t_1}^t \\left( \\frac{t_1+t-x}{tt_1} - \\frac{1}{x} \\right) \\,dx = \\frac{t}{2t_1}-\\frac{t_1}{2t}-\\log \\left(\\frac{t}{t_1} \\right),\n\\]\nwhich at $t = \\sqrt{t_1t_2}$ is equal to $\\frac{t_2-t_1}{2\\sqrt{t_1t_2}} - \\log(\\sqrt{t_2/t_1})$. Similarly, the area of the region bounded by the hyperbola and $PB$ is $\\frac{t_2}{2t}-\\frac{t}{2t_2}-\\log \\frac{t_2}{t}$, which at $t = \\sqrt{t_1t_2}$ is also $\\frac{t_2-t_1}{2\\sqrt{t_1t_2}} - \\log(\\sqrt{t_2/t_1})$, as desired.\n\n\\noindent\n\\textbf{Second solution:}\nFor any $\\lambda > 0$, the map $(x,y) \\mapsto (\\lambda x, \\lambda^{-1} y)$ preserves both areas and the hyperbola $xy=1$. We may thus rescale the picture so that\n$A,B$ are symmetric across the line $y=x$, with $A$ above the line. As $P$ moves from $A$ to $B$, the area of $APB$ increases until $P$ passes through the point $(1,1)$, then decreases. Consequently, $P = (1,1)$ achieves the maximum area, and the desired equality is obvious by symmetry.\nAlternatively, since the hyperbola is convex, the maximum is uniquely achieved at the point where the tangent line is parallel to $AB$, and by symmetry that point is $P$.", "category": "Geometry", "source": "PUTNAM", "year": 2015}
{"id": "putnam-2015-a2", "question": "Let $a_0=1$, $a_1=2$, and $a_n=4a_{n-1}-a_{n-2}$ for $n\\geq 2$. Find an odd prime factor of $a_{2015}$.", "solution": "\\noindent\n\\textbf{First solution:}\nOne possible answer is $181$.\nBy induction, we have $a_n = ((2+\\sqrt{3})^n+(2-\\sqrt{3})^n)/2 = (\\alpha^n+\\beta^n)/2$ for all $n$, where $\\alpha = 2+\\sqrt{3}$ and $\\beta = 2-\\sqrt{3}$. Now note that if $k$ is an odd positive integer and $a_n \\neq 0$, then\n$\\frac{a_{kn}}{a_n} = \\frac{\\alpha^{kn}+\\beta^{kn}}{\\alpha^n+\\beta^n}\n= \\alpha^{(k-1)n}-\\alpha^{(k-2)n}\\beta^n+\\cdots-\\alpha^n\\beta^{(k-2)n}+\\beta^{(k-1)n}$.\nThis expression is both rational (because $a_n$ and $a_{kn}$ are integers) and of the form $a+b\\sqrt{3}$ for some integers $a,b$ by the expressions for $\\alpha,\\beta$; it follows that it must be an integer, and so $a_{kn}$ is divisible by $a_n$. Applying this to $n=5$ and $k=403$, we find that $a_{2015}$ is divisible by $a_5 = 362$ and thus by $181$.\n\n\\noindent\n\\textbf{Second solution:}\nBy rewriting the formula for $a_n$ as $a_{n-2} = 4a_{n-1} - a_n$, we may extend the sequence backwards to define $a_n$ for all integers $n$. Since $a_{-1} = 2$, we may see by induction that $a_{-n} = a_n$ for all $n$. For any integer $m$ and any prime $p$ dividing $a_m$,\n$p$ also divides $a_{-m}$; on the other hand, $p$ cannot divide $a_{-m+1}$, as otherwise $p$ would also divide $a_{-m+2}, \\dots, a_0 = 1$, a contradiction. We can thus find an integer $k$ such that $a_{m+1} \\equiv k a_{-m+1} \\pmod{p}$; by induction on $n$, we see that\n$a_n \\equiv k a_{n-2m} \\pmod{p}$ for all $n$. In particular, if $k$ is odd, then $p$ also divides $a_{km}$; we thus conclude (again) that $a_{2015}$ is divisible by $a_5 = 362$ and thus by $181$.\n\n\\noindent\n\\textbf{Remark:}\nAlthough it was not needed in the solution, we note in passing that if $a_n \\equiv 0 \\pmod{p}$, then $a_{2n+k} \\equiv -a_{k} \\pmod{p}$ for all $k$.\n\n\\noindent\n\\textbf{Remark:} One can find other odd prime factors of $a_{2015}$ in the same manner. For example, $a_{2015}$ is divisible by each of the following quantities. (The prime factorizations were computed using\nthe \\texttt{Magma} computer algebra system.)\n\\begin{align*}\na_{13} &= 2 \\times 6811741 \\\\\na_{31} &= 2 \\times 373 \\times 360250962984637 \\\\\na_{5 \\cdot 13} &= 2 \\times 181 \\times 6811741 \\\\\n&\\quad \\times 3045046274679316654761356161 \\\\\na_{5 \\cdot 31} &= 1215497709121 \\times 28572709494917432101 \\\\\n&\\quad \\times\n13277360555506179816997827126375881581 \\\\\na_{13 \\cdot 31} &= 2 \\times 373 \\times 193441 \\times 6811741 \\times 360250962984637 \\\\\n&\\quad \\times 16866100753000669 \\\\\n&\\quad \\times 79988387992470656916594531961 \\times p_{156}\n\\end{align*}\nwhere $p_{156}$ is a prime of 156 decimal digits. Dividing $a_{2015}$ by the product of the primes appearing in this list yields a number $N$ of 824 decimal digits which is definitely not prime, because $2^N \\not\\equiv 2 \\pmod{N}$, but whose prime factorization we have been unable to establish. Note that $N$ is larger than a 2048-bit RSA modulus, so the difficulty of factoring it is not surprising.\n\nOne thing we can show is that each prime factor of $N$ is %divisible by \ncongruent to $1$ modulo \n$6 \\times 2015 = 12090$, thanks to the following lemma.\n\n\\begin{lemma*}\nLet $n$ be an odd integer. Then any odd prime factor $p$ of $a_n$ which does not divide $a_m$ for any divisor $m$ of $n$ is congruent to $1$ modulo $\\lcm(6,n)$. (By either solution of the original problem, $p$ also does not divide $a_m$ for any positive integer $m<n$.)\n\\end{lemma*}\n\\begin{proof}\nWe first check that $p \\equiv 1 \\pmod{3}$.\nIn $\\FF_q = \\FF_p(\\sqrt{3})$ we have $(\\alpha/\\beta)^n \\equiv -1$. If $p \\equiv 2 \\pmod{3}$,\nthen $q = p^2$ and $\\alpha$ and $\\beta$ are conjugate in $p$; consequently, the equality\n$\\alpha^n = -\\beta^n$ in $\\FF_{q^2}$ means that $\\alpha^n = c \\sqrt{3}$, $\\beta^n = - c \\sqrt{3}$ for some $c \\in \\FF_p$. But then $-3c^2 = \\alpha^n \\beta^n = 1$ in $\\FF_q$ and hence in $\\FF_p$, which contradicts $p \\equiv 2 \\pmod{3}$ by quadratic reciprocity.\n\nBy the previous paragraph, $\\alpha$ and $\\beta$ may be identified with elements of $\\FF_p$, and we have $(\\alpha/\\beta)^n \\equiv -1$, but the same does not hold with $n$ replaced by any smaller value. Since $\\FF_p^\\times$ is a cyclic group of order $p-1$, this forces $p \\equiv 1 \\pmod{n}$ as claimed.\n\\end{proof}", "category": "Number Theory", "source": "PUTNAM", "year": 2015}
{"id": "putnam-2015-a3", "question": "Compute\n\\[\n\\log_2 \\left( \\prod_{a=1}^{2015} \\prod_{b=1}^{2015} (1+e^{2\\pi i a b/2015}) \\right)\n\\]\nHere $i$ is the imaginary unit (that is, $i^2=-1$).", "solution": "The answer is $13725$.\nWe first claim that if $n$ is odd, then $\\prod_{b=1}^{n} (1+e^{2\\pi i ab/n}) = 2^{\\gcd(a,n)}$. To see this, write $d = \\gcd(a,n)$ and $a = da_1$, $n=dn_1$ with $\\gcd(a_1,n_1) = 1$. Then\n$a_1, 2a_1,\\dots,n_1 a_1$ modulo $n_1$ is a permutation of $1,2,\\dots,n_1$ modulo $n_1$, and so $\\omega^{a_1},\\omega^{2a_1},\\dots,\\omega^{n_1 a_1}$ is a permutation of $\\omega,\\omega^2,\\ldots,\\omega^{n_1}$;  it follows that for $\\omega = e^{2\\pi i/n_1}$,\n\\[\n\\prod_{b=1}^{n_1} (1+e^{2\\pi i a b/n}) =\n\\prod_{b=1}^{n_1} (1+e^{2\\pi i a_1 b/n_1}) = \\prod_{b=1}^{n_1} (1+\\omega^b).\n\\]\nNow since the roots of $z^{n_1}-1$ are $\\omega,\\omega^2,\\ldots,\\omega^{n_1}$, it follows that\n$z^{n_1}-1 = \\prod_{b=1}^{n_1} (z-\\omega^b)$. Setting $z=-1$ and using the fact that $n_1$ is odd gives $\\prod_{b=1}^{n_1} (1+\\omega^b) = 2$. \n\nFinally,\n$\\prod_{b=1}^{n} (1+e^{2\\pi i ab/n}) = (\\prod_{b=1}^{n_1} (1+e^{2\\pi i ab/n}))^d = 2^d$, and we have proven the claim.\n\nFrom the claim, we find that\n\\begin{align*}\n&\\log_2 \\left( \\prod_{a=1}^{2015} \\prod_{b=1}^{2015} (1+e^{2\\pi i a b/2015}) \\right) \\\\\n&= \\sum_{a=1}^{2015} \\log_2 \\left(\\prod_{b=1}^{2015} (1+e^{2\\pi i a b/2015}) \\right) \\\\\n&= \\sum_{a=1}^{2015} \\gcd(a,2015).\n\\end{align*}\nNow for each divisor $d$ of $2015$, there are $\\phi(2015/d)$ integers between $1$ and $2015$ inclusive whose $\\gcd$ with $2015$ is $d$. Thus\n\\[\n\\sum_{a=1}^{2015} \\gcd(a,2015) = \\sum_{d|2015} d\\cdot \\phi(2015/d).\n\\]\nWe factor $2015 = pqr$ with $p=5$, $q=13$, and $r=31$, and calculate\n\\begin{align*}\n&\\sum_{d|pqr} d\\cdot \\phi(pqr/d) \\\\\n&= 1 \\cdot (p-1)(q-1)(r-1) + p \\cdot (q-1)(r-1) \\\\\n&\\quad + q\\cdot (p-1)(r-1) + r\\cdot (p-1)(q-1) + pq \\cdot (r-1) \\\\\n& \\quad + pr\\cdot (q-1) + qr\\cdot (p-1) + pqr \\cdot 1 \\\\\n&\\quad = (2p-1)(2q-1)(2r-1).\n\\end{align*}\nWhen $(p,q,r) = (5,13,31)$, this is equal to $13725$.\n\n\\noindent\n\\textbf{Remark:}\nNoam Elkies suggests the following similar but shorter derivation of the equality\n$\\prod_{b=1}^{n_1} (1 + \\omega^b) = 2$: write\n\\[\n\\prod_{b=1}^{n_1-1} (1 + \\omega^b) = \\frac{\\prod_{b=1}^{n_1 - 1} (1 - \\omega^{2b})}{\\prod_{b=1}^{n_1-1} (1 - \\omega^b)}\n\\]\nand note (as above) that $\\omega^2, \\omega^{4}, \\dots, \\omega^{2(n_1-1)}$ is a permutation of $\\omega, \\dots, \\omega^{n_1-1}$, so the two products in the fraction are equal.\n\n\\noindent\n\\textbf{Remark:}\nThe function $f(n) = \\sum_{d|n} d\\cdot \\phi(n/d)$ is multiplicative: for any two coprime positive integers $m,n$, we have $f(mn) = f(m) f(n)$. This follows from the fact that $f(n)$ is the convolution of the two multiplicative functions $n \\mapsto n$ and $n \\mapsto \\phi(n)$; it can also be seen directly using the Chinese remainder theorem.", "category": "Number Theory", "source": "PUTNAM", "year": 2015}
{"id": "putnam-2015-a4", "question": "For each real number $x$, let\n\\[\nf(x) = \\sum_{n\\in S_x} \\frac{1}{2^n},\n\\]\nwhere $S_x$ is the set of positive integers $n$ for which $\\lfloor nx \\rfloor$ is even. What is the largest real number $L$ such that $f(x) \\geq L$ for all $x \\in [0,1)$? (As usual, $\\lfloor z \\rfloor$ denotes the greatest integer less than or equal to $z$.)", "solution": "The answer is $L = 4/7$. For $S \\subset \\mathbb{N}$, let $F(S) = \\sum_{n\\in S} 1/2^n$, so that $f(x) = F(S_x)$. Note that for $T = \\{1,4,7,10,\\ldots\\}$, we have $F(T) = 4/7$.\n\nWe first show by contradiction that for any $x \\in [0,1)$, $f(x) \\geq 4/7$.\nSince each term in the geometric series $\\sum_n 1/2^n$ is equal to the sum of all subsequent terms, if $S,S'$ are different subsets of $\\mathbb{N}$ and the smallest positive integer in one of $S,S'$ but not in the other is in $S$, then $F(S) \\geq F(S')$. Assume $f(x) < 4/7$; then the smallest integer in one of $S_x,T$ but not in the other is in $T$. Now $1 \\in S_x$ for any $x \\in [0,1)$, and we conclude that there are three consecutive integers $n,n+1,n+2$ that are not in $S_x$: that is, $\\lfloor nx\\rfloor$, $\\lfloor (n+1)x\\rfloor$, $\\lfloor (n+2)x\\rfloor$ are all odd. Since the difference between consecutive terms in $nx$, $(n+1)x$, $(n+2)x$ is $x<1$, we conclude that $\\lfloor nx\\rfloor = \\lfloor (n+1)x\\rfloor = \\lfloor (n+2)x\\rfloor$ and so $x<1/2$. But then $2\\in S_x$ and so $f(x) \\geq 3/4$, contradicting our assumption.\n\nIt remains to show that $4/7$ is the greatest lower bound for $f(x)$, $x\\in [0,1)$.\nFor any $n$, choose $x = 2/3-\\epsilon$ with $0<\\epsilon<1/(9n)$; then for $1\\leq k\\leq n$, we have $0<m\\epsilon<1/3$ for $m \\leq 3n$, and so\n\\begin{align*}\n\\lfloor (3k-2)x \\rfloor &= \\lfloor (2k-2)+2/3-(3k-2)\\epsilon \\rfloor = 2k-2 \\\\\n\\lfloor (3k-1)x \\rfloor &= \\lfloor (2k-1)+1/3-(3k-1)\\epsilon \\rfloor = 2k-1 \\\\\n\\lfloor (3k)x \\rfloor &= \\lfloor (2k-1)+1-3k\\epsilon \\rfloor = 2k-1.\n\\end{align*}\nIt follows that $S_x$ is a subset of $S = \\{1,4,7,\\ldots,3n-2,3n+1,3n+2,3n+3,\\ldots\\}$, and so\n$f(x) = F(S_x) \\leq f(S) = (1/2+1/2^4+\\cdots+1/2^{3n+1})+1/2^{3n+1}$. This last expression tends to $4/7$ as $n\\to\\infty$, and so no number greater than $4/7$ can be a lower bound for $f(x)$ for all $x\\in [0,1)$.", "category": "Number Theory", "source": "PUTNAM", "year": 2015}
{"id": "putnam-2015-a5", "question": "Let $q$ be an odd positive integer, and let $N_q$ denote the number of integers $a$ such that $0 < a < q/4$ and $\\gcd(a,q) = 1$. Show that $N_q$ is odd if and only if $q$ is of the form $p^k$ with $k$ a positive integer and $p$ a prime congruent to $5$ or $7$ modulo $8$.", "solution": "\\textbf{First solution:}\nBy inclusion-exclusion, we have\n\\begin{align*}\nN_q    &= \\sum_{d|q} \\mu(d) \\left\\lfloor \\frac{\\lfloor q/4\\rfloor}{d} \\right\\rfloor \\\\\n       &= \\sum_{d|q} \\mu(d) \\left\\lfloor \\frac{q/d}{4} \\right\\rfloor \\\\\n  &\\equiv \\sum_{d|q \\mbox{\\, \\small squarefree}} \\left\\lfloor \\frac{q/d}{4}  \\right\\rfloor  \\pmod{2},\n\\end{align*}\nwhere $\\mu$ is the M\\\"obius function.\nNow\n\\[\n\\left\\lfloor \\frac{q/d}{4} \\right\\rfloor \\equiv \\begin{cases} 0 \\pmod{2} & \\mbox{if } q/d\\equiv 1, 3 \\pmod{8} \\\\\n1 \\pmod{2} & \\mbox{if } q/d\\equiv 5, 7 \\pmod{8}.\n\\end{cases}\n\\]\nSo $N_q$ is odd if and only if $q$ has an odd number of squarefree factors $q/d$ congruent to $5$ or $7$ (mod~8).\n\nIf $q$ has a prime factor $p$ congruent to 1 or 3 (mod~8), then the squarefree factors $d$ of $q$ occur in pairs $c,pc$, which are either both 1 or 3 (mod~8) or both 5 or 7 (mod~8).  Hence $q$ must have an even number of factors that are congruent to $5$ or $7$ (mod~8), and so $N_q$ is even in this case.\n\nIf $q$ has two prime factors $p_1$ and $p_2$, each congruent to either 5 or 7 (mod~8), then the squarefree factors $d$ of $q$ occur in quadruples $d,p_1d,q_1d,p_1q_1d$, which are then congruent respectively to some permutation of 1,3,5,7 (mod~8) (if $p_1$ and $p_2$ are distinct mod 8) or are congruent respectively to $d,p_1d,p_1d,d$ (mod~8). Either way, we see that exactly two of the four residues are congruent to $5$ or $7$ (mod~8).  Thus again $q$ must have an even number of factors that are $5$ or $7$ (mod~8), and so $N_q$ is even in this case as well.\n\nIf $q=1$, then $N_q=0$ is even.  The only case that remains is that $q=p^k$ is a positive power of a prime $p$ congruent to 5 or 7 (mod~8).  In this case, $q$ has two squarefree factors, $1$ and $p$, of which exactly one is congruent to $5$ or $7$ (mod~8).  We conclude that $N_q$ is odd in this case, as desired.\n\n\\noindent\n\\textbf{Second solution:}\n\nConsider the set $S$ of all integers in $\\{1,\\ldots,q-1\\}$ that are even and relatively prime to $q$.  Then the product of all elements in $S$ is\n\\[\n2^{\\phi(q)/2}\\prod_{{1\\leq a\\leq (q-1)/2}\\atop{(a,q)=1}} a.\n\\]\nOn the other hand, we can rewrite the set of elements in $S \\pmod{q}$ as a set $T$ of residues in the interval $[-(q-1)/2,(q-1)/2]$.  Then for each $1\\leq a\\leq (q-1)/2$ with $(a,q)=1$, $T$ contains exactly one element from $\\{a,-a\\}$: if $-2r \\equiv 2s \\pmod{q}$ for some $r,s\\in\\{1,\\ldots,(q-1)/2\\}$, then $r \\equiv -s \\pmod{q}$, which is impossible given the ranges of $r$ and $s$.  Thus the product of all elements in $T$ is\n\\[\n(-1)^n \\prod_{{1\\leq a\\leq (q-1)/2}\\atop{(a,q)=1}} a,\n\\]\nwhere $n$ denotes the number of elements of $S$ greater than $(q-1)/2$.\nWe conclude that $(-1)^n \\equiv 2^{\\phi(q)/2} \\pmod{q}$.\n\nHowever, note that the number of elements of $S$ less than $(q-1)/2$ is equal to $N_q$, since dividing these numbers by 2 gives exactly the numbers counted by $N_q$. Hence the total cardinality of $S$ is $N_q + n$; however, this cardinality also equals $\\phi(q)/2$ because the numbers in $\\{1,\\dots,q-1\\}$ relatively prime to $q$ come in pairs\n$\\{a,q-a\\}$ in each of which exactly one member is even. We thus obtain\n\\begin{align*}\n(-1)^{N_q} &= (-1)^{\\phi(q)/2 + n} \\\\\n&\\equiv (-1)^{\\phi(q)/2} 2^{\\phi(q)/2} = (-2)^{\\phi(q)/2} \\pmod{q}.\n\\end{align*}\nIf $q=1$, then $N_q$ is even.  If $q$ has more than one prime factor, then the group $(\\mathbb{Z}/q\\mathbb{Z})^\\times$ has exponent dividing $\\phi(q)/2$, so $(-1)^{N_q}\\equiv (-2)^{\\phi(q)/2} \\equiv 1 \\pmod{q}$, and thus $N_q$ must be even in this case as well.  Finally, suppose that $q$ is a prime power $p^k$ with $p$ odd and $k$ positive.  Since $(\\mathbb{Z}/q\\mathbb{Z})^\\times$ is a cyclic group of order $\\phi(q)=p^{k-1}(p-1)$, in which the only square roots of unity are $\\pm 1$, it follows that $(-2)^{\\phi(q)/2}\\equiv \\pm 1 \\pmod{q}$ in accordance with whether $(-2)^{(p-1)/2} \\equiv \\pm 1 \\pmod{p}$, i.e., whether $-2$ is a quadratic residue or nonresidue.  But recall that $-2$ is a quadratic residue modulo $p$ if and only if $p\\equiv 1, 3 \\pmod{8}$. Thus $N_q$ is odd in this case if and only if $p\\equiv 5$ or $7 \\pmod{8}$.\n\nWe conclude that for any odd integer $q\\geq 1$, the quantity $N_q$ is odd if and only if $q=p^k$ with $k$ positive and $p$ a prime that is 5 or 7 (mod~8).\n\n\\noindent\n\\textbf{Remark:} The combination of the two solutions recovers Gauss's criterion for when $-2$ is a quadratic residue modulo $p$, with essentially the original proof.", "category": "Number Theory", "source": "PUTNAM", "year": 2015}
{"id": "putnam-2015-a6", "question": "Let $n$ be a positive integer. Suppose that $A$, $B$, and $M$ are $n\\times n$ matrices with real entries such that $AM = MB$, and such that $A$ and $B$ have the same characteristic polynomial. Prove that $\\det(A-MX) = \\det(B-XM)$ for every $n\\times n$ matrix $X$ with real entries.", "solution": "\\textbf{First solution:}\n(by Noam Elkies)\nUsing row and column operations, we may construct invertible matrices $U,V$ such that\n$U^{-1} M V$ is a block diagonal matrix of the form\n\\[\n\\begin{pmatrix} I & 0 \\\\ 0 & 0 \\end{pmatrix}.\n\\]\nPut $A' = U^{-1} A U, M' = U^{-1} M V, B' = V^{-1} B V$, $X' = V^{-1} X U$,\nso that $A' M' = M' B'$,\n$\\det(A-MX) = \\det(U^{-1}(A-MX)U) = \\det(A' - M'X')$,\nand\n$\\det(B-XM) = \\det(V^{-1}(B-XM)V) = \\det(B' - X'M')$.\nForm the corresponding block decompositions\n\\[\nA' = \\begin{pmatrix} A_{11} & A_{12} \\\\ A_{21} & A_{22} \\end{pmatrix},\nB' = \\begin{pmatrix} B_{11} & B_{12} \\\\ B_{21} & B_{22} \\end{pmatrix},\nX' = \\begin{pmatrix} X_{11} & X_{12} \\\\ X_{21} & X_{22} \\end{pmatrix}.\n\\]\nWe then have\n\\[\nA' M' = \\begin{pmatrix} A_{11} & 0 \\\\ A_{21} & 0 \\end{pmatrix}, \\qquad\nM' B' = \\begin{pmatrix} B_{11} & B_{12} \\\\ 0 & 0 \\end{pmatrix},\n\\]\nso we must have $A_{11} = B_{11}$ and $A_{21} = B_{12} = 0$;\nin particular, the characteristic polynomial of $A$ is the product of the characteristic polynomials of $A_{11}$ and $A_{22}$, and the characteristic polynomial of $B$ is the product of the characteristic polynomials of $B_{11}$ and $B_{22}$. Since $A_{11} = B_{11}$, it follows that $A_{22}$ and $B_{22}$ have the same characteristic polynomial.\nSince\n\\[\nX' M' = \\begin{pmatrix} X_{11} & 0 \\\\ X_{21} & 0 \\end{pmatrix}, \\qquad\nM' X' = \\begin{pmatrix} X_{11} & X_{12} \\\\ 0 & 0 \\end{pmatrix},\n\\]\nwe conclude that\n\\begin{align*}\n\\det(A-MX) &= \\det(A'-M'X') \\\\\n&= \\det \\begin{pmatrix} A_{11}-X_{11} & A_{12} - X_{12} \\\\ 0 & A_{22} \\end{pmatrix} \\\\\n&= \\det(A_{11}-X_{11}) \\det(A_{22}) \\\\\n&= \\det(B_{11}-X_{11}) \\det(B_{22}) \\\\\n&= \\det \\begin{pmatrix} B_{11}-X_{11} & 0 \\\\ B_{21}-X_{21} & B_{22} \\end{pmatrix} \\\\\n&= \\det(B'-X'M') \\\\\n&= \\det(B-XM),\n\\end{align*}\nas desired. (By similar arguments, $A-MX$ and $B-XM$ have the same characteristic polynomial.)\n\n\\noindent\n\\textbf{Second solution:}\nWe prove directly that $A-MX$ and $B-XM$ have the same characteristic polynomial, i.e., for any $t \\in \\mathbb{R}$, writing $A_t = A-tI$, $B_t = B-tI$, we have\n\\[\n\\det(A_t - MX) = \\det(B_t - XM).\n\\]\nFor fixed $A,B,M$, the stated result is a polynomial identity in $t$ and the entries of $X$. It thus suffices to check it assuming that $A_t,B_t, X$ are all invertible.\nSince $AM = MB$, we also have $A_t M = M B_t$, so $A_tMB_t^{-1} = M$.\nSince $\\det(A_t) = \\det(B_t)$ by hypothesis,\n\\begin{align*}\n\\det(A_t - MX) &= \\det (A_t - A_tM B_t^{-1} X)\\\\\n&= \\det(A_t) \\det(1 - M B_t^{-1} X) \\\\\n&= \\det(A_t) \\det(X) \\det(B_t)^{-1} \\det(X^{-1} B_t - M) \\\\\n&= \\det(X) \\det(X^{-1} B_t - M) \\\\\n&= \\det(B_t - XM).\n\\end{align*}\n\n\\noindent\n\\textbf{Remark:}\nOne can also assert directly that\n$\\det(1 - M B_t^{-1} X) = \\det(1 - X M B_t^{-1})$ using the fact that for any square matrices $U$ and $V$, $UV$ and $VU$ have the same characteristic polynomial; \nthe latter is again proved by reducing to the case where one of the two matrices is invertible, in which case the two matrices are similar.\n\n\\noindent\n\\textbf{Third solution:}\n(by Lev Borisov)\nWe will check that for each positive integer $k$,\n\\[\n\\Trace((A-MX)^k) = \\Trace((B- XM)^k).\n\\]\nThis will imply that $A-MX$ and $B-XM$ have the same characteristic polynomial, yielding the desired result.\n\nWe establish the claim by expanding both sides and comparing individual terms.\nBy hypothesis, $A^k$ and $B^k$ have the same characteristic polynomial, so\n$\\Trace(A^k) = \\Trace(B^k)$. \nTo compare the other terms, it suffices to check that for any sequence $i_1, i_2,\\dots, i_m$ of nonnegative integers,\n\\begin{align*}\n& \\Trace(A^{i_1} MX A^{i_2} MX \\cdots A^{i_{m-1}} MX A^{i_m})\\\\\n&\\quad =\n\\Trace(B^{i_1} XM B^{i_2} XM \\cdots B^{i_{m-1}} XM B^{i_m}).\n\\end{align*}\nTo establish this equality, first apply the remark following the previous solution to write\n\\begin{align*}\n& \\Trace(A^{i_1} MX A^{i_2} MX \\cdots A^{i_{m-1}} MX A^{i_m})\\\\\n&\\quad =\n\\Trace(A^{i_m + i_1} MX A^{i_2} MX \\cdots A^{i_{m-1}} MX).\n\\end{align*}\nThen apply the relation $AM = MB$ repeatedly to commute $M$ past $A$, to obtain\n\\[\n\\Trace(M B^{i_m + i_1} X M B^{i_2} XM \\cdots XM B^{i_{m-1}} X).\n\\]\nFinally, apply the remark again to shift $MB^{i_m}$ from the left end to the right end.\n\n\\noindent\n\\textbf{Remark:}\nThe conclusion holds with $\\RR$ replaced by an arbitrary field.\nIn the second solution, one must reduce to the case of an infinite field, e.g., by replacing the original field with an algebraic closure. The third solution only applies to fields of characteristic 0 or positive characteristic greater than $n$.\n\n\\noindent\n\\textbf{Remark:}\nIt is tempting to try to reduce to the case where $M$ is invertible, as in this case $A-MX$ and $B-XM$ are in fact similar. However, it is not clear how to make such an argument work.", "category": "Algebra", "source": "PUTNAM", "year": 2015}
{"id": "putnam-2015-b1", "question": "Let $f$ be a three times differentiable function (defined on $\\mathbb{R}$ and real-valued) such that $f$ has at least five distinct real zeros. Prove that $f + 6f' + 12f'' + 8f'''$ has at least two distinct real zeros.", "solution": "Let $g(x) = e^{x/2} f(x)$. Then $g$ has at least $5$ distinct real zeroes,\nand by repeated applications of Rolle's theorem, $g', g'', g'''$ have at least $4,3,2$ distinct real zeroes, respectively. But\n\\[\ng'''(x) = \\frac{1}{8} e^{x/2} (f(x) + 6 f'(x) + 12 f''(x) + 8 f'''(x))\n\\]\nand $e^{x/2}$ is never zero, so we obtain the desired result.", "category": "Algebra", "source": "PUTNAM", "year": 2015}
{"id": "putnam-2015-b2", "question": "Given a list of the positive integers $1,2,3,4,\\dots$, take the first three numbers\n$1,2,3$ and their sum $6$ and cross all four numbers off the list. Repeat with the three \nsmallest remaining numbers $4,5,7$ and their sum $16$. Continue in this way, crossing off the three smallest remaining numbers and their sum, and consider the sequence of sums produced: $6, 16, 27, 36, \\dots$. Prove or disprove that there is some number in the sequence whose base 10 representation ends with $2015$.\n\n\\,", "solution": "We will prove that 42015 is such a number in the sequence.\nLabel the sequence of sums $s_0, s_1, \\dots$, and let $a_n, b_n, c_n$ be the summands of $s_n$ in ascending order. We prove the following two statements for each nonnegative integer $n$: \\begin{enumerate}", "category": "Number Theory", "source": "PUTNAM", "year": 2015}
{"id": "putnam-2015-b3", "question": "Let $S$ be the set of all $2 \\times 2$ real matrices\n\\[\nM = \\begin{pmatrix} a & b \\\\\nc & d \\end{pmatrix}\n\\]\nwhose entries $a,b,c,d$ (in that order) form an arithmetic progression. Find all matrices $M$ in $S$ for which there is some integer $k>1$ such that $M^k$ is also in $S$.", "solution": "\\textbf{First solution:}\nAny element of $S$ can be written as $M = \\alpha A + \\beta B$, where $A = \\left( \\begin{smallmatrix} 1 & 1 \\\\ 1 & 1 \\end{smallmatrix} \\right)$, $B = \\left( \\begin{smallmatrix} -3 & -1 \\\\ 1 & 3 \\end{smallmatrix} \\right)$, and $\\alpha,\\beta \\in \\mathbb{R}$. Note that $A^2 = \\left( \\begin{smallmatrix} 4 & 4 \\\\ 4 & 4 \\end{smallmatrix} \\right)$ and\n$B^3 = \\left( \\begin{smallmatrix} -24 & -8 \\\\ 8 & 24 \\end{smallmatrix} \\right)$ are both in $S$, and so any matrix of the form $\\alpha A$ or $\\beta B$, $\\alpha,\\beta\\in\\mathbb{R}$, satisfies the given condition.\n\nWe claim that these are also the only matrices in $S$ satisfying the given condition. Indeed, suppose $M = \\alpha A + \\beta B$ where $\\alpha,\\beta \\neq 0$. Let $C = \\left( \\begin{smallmatrix} 1 & 1/\\sqrt{2} \\\\ -1 & 1/\\sqrt{2} \\end{smallmatrix} \\right)$ with inverse\n$C^{-1} = \\left( \\begin{smallmatrix} 1/2 & -1/2 \\\\ 1/\\sqrt{2} & 1/\\sqrt{2} \\end{smallmatrix} \\right)$. If we define $D = C^{-1}MC$, then $D = 2\\alpha \\left( \\begin{smallmatrix} 0 & \\gamma \\\\ \\gamma & 1 \\end{smallmatrix} \\right)$ where $\\gamma = -\\frac{\\beta\\sqrt{2}}{\\alpha}$. Now suppose that $M^k$ is in $S$ with $k\\geq 2$. Since $\\left( \\begin{smallmatrix} 1 & -1 \\end{smallmatrix} \\right) A \\left( \\begin{smallmatrix} 1 \\\\ -1 \\end{smallmatrix} \\right) = \\left( \\begin{smallmatrix} 1 & -1 \\end{smallmatrix} \\right) B \\left( \\begin{smallmatrix} 1 \\\\ -1 \\end{smallmatrix} \\right) = 0$,\nwe have $\\left( \\begin{smallmatrix} 1 & -1 \\end{smallmatrix} \\right) M^k \\left( \\begin{smallmatrix} 1 \\\\ -1 \\end{smallmatrix} \\right) = 0$, and so the upper left entry of $C^{-1} M^k C = D^k$ is $0$. On the other hand, from the expression for $D$, an easy induction on $k$ shows that\n$D^k = (2\\alpha)^k \\left( \\begin{smallmatrix} \\gamma^2 p_{k-1} & \\gamma p_k \\\\\n\\gamma p_k & p_{k+1} \\end{smallmatrix} \\right)$, where $p_k$ is defined inductively by $p_0 = 0$, $p_1 = 1$, $p_{k+2} = \\gamma^2 p_k + p_{k+1}$. In particular, it follows from the inductive definition that $p_k > 0$ when $k \\geq 1$, whence the upper left entry of $D^k$ is nonzero when $k \\geq 2$, a contradiction.\n\n\\noindent\n\\textbf{Remark:}\nA variant of this solution can be obtained by diagonalizing the matrix $M$.\n\n\\textbf{Second solution:}\nIf $a,b,c,d$ are in arithmetic progression, then we may write\n\\[\na = r-3s, b=r-s, c=r+s, d=r+3s\n\\]\nfor some $r,s$. If $s=0$, then clearly all powers of $M$ are in $xS$. Also, if $r=0$, then one easily checks that $M^3$ is in $S$.\n\nWe now assume $rs\\neq 0$, and show that in that case $M$ cannot be in $S$. First, note that the characteristic polynomial of $M$ is $x^2-2rx-8s^2$, and since $M$ is nonsingular (as $s\\neq 0$), this is also the minimal polynomial of $M$ by the Cayley-Hamilton theorem.  By repeatedly using the relation $M^2=2rM+8s^2I$, we see that for each positive integer, we have $M^k = t_k M + u_k I$ for unique real constants $t_k, u_k$ (uniqueness follows from the independence of $M$ and $I$).  Since $M$ is in $S$, we see that $M^k$ lies in $S$ only if $u_k=0$.\n\nOn the other hand, we claim that if $k>1$, then $rt_k>0$ and $u_k>0$ if $k$ is even, and $t_k>0$ and $ru_k>0$ if $k$ is odd (in particular, $u_k$ can never be zero).  The claim is true for $k=2$ by the relation $M^2=2rM+8s^2I$. Assuming the claim for $k$, and multiplying both sides of the relation $M^k = t_k M + u_k I$ by $M$, yields\n\\[\nM^{k+1} = t_k (2rM+8s^2I) + u_k M = (2rt_k+u_k) M + 8s^2t_k I,\n\\]\nimplying the claim for $k+1$.\n\n\\noindent\n\\textbf{Remark:}\n(from \\url{artofproblemsolving.com}, user \\texttt{hoeij})\nOnce one has $u_k = 0$, one can also finish using the relation $M \\cdot M^k = M^k \\cdot M$.", "category": "Algebra", "source": "PUTNAM", "year": 2015}
{"id": "putnam-2015-b4", "question": "Let $T$ be the set of all triples $(a,b,c)$ of positive integers for which there exist triangles with side lengths $a,b,c$. Express\n\\[\n\\sum_{(a,b,c) \\in T} \\frac{2^a}{3^b 5^c} \n\\]\nas a rational number in lowest terms.", "solution": "\\textbf{First solution:}\nThe answer is $17/21$. For fixed $b,c$, there is a triangle of side lengths $a,b,c$ if and only if $|b-c|<a<b+c$. It follows that the desired sum is\n\\[\nS = \\sum_{b,c} \\frac{1}{3^b5^c} \\left(\\sum_{a=|b-c|+1}^{b+c-1} 2^a \\right) = \\sum_{b,c} \\frac{2^{b+c}-2^{|b-c|+1}}{3^b5^c}.\n\\]\nWe write this as $S = S_1+S_2$ where $S_1$ sums over positive integers $b,c$ with $b\\leq c$ and $S_2$ sums over $b>c$. Then\n\\begin{align*}\nS_1 &= \\sum_{b=1}^\\infty \\sum_{c=b}^\\infty \\frac{2^{b+c}-2^{c-b+1}}{3^b 5^c} \\\\\n&= \\sum_{b=1}^\\infty \\left( \\left( \\left(\\frac{2}{3}\\right)^b-\\frac{2}{6^b} \\right) \\sum_{c=b}^\\infty \\left(\\frac{2}{5} \\right)^c \\right) \\\\\n&= \\sum_{b=1}^\\infty \\left( \\left(\\frac{2}{3}\\right)^b-\\frac{2}{6^b} \\right) \\frac{5}{3} \\left( \\frac{2}{5} \\right)^b \\\\\n&= \\sum_{b=1}^\\infty \\left( \\frac{5}{3} \\left(\\frac{4}{15}\\right)^b - \\frac{10}{3} \\left(\\frac{1}{15}\\right)^b \\right) \\\\\n&= \\frac{85}{231}.\n\\end{align*}\nSimilarly,\n\\begin{align*}\nS_2 &= \\sum_{c=1}^\\infty \\sum_{b=c+1}^\\infty \\frac{2^{b+c}-2^{b-c+1}}{3^b 5^c} \\\\\n&= \\sum_{c=1}^\\infty \\left( \\left( \\left(\\frac{2}{5}\\right)^c-\\frac{2}{10^c} \\right) \\sum_{b=c+1}^\\infty \\left(\\frac{2}{3} \\right)^b \\right) \\\\\n&= \\sum_{c=1}^\\infty \\left( \\left(\\frac{2}{5}\\right)^c-\\frac{2}{10^c} \\right) 3 \\left( \\frac{2}{3} \\right)^{c+1} \\\\\n&= \\sum_{c=1}^\\infty \\left( 2 \\left(\\frac{4}{15}\\right)^c - 4 \\left(\\frac{1}{15}\\right)^c \\right) \\\\\n&= \\frac{34}{77}.\n\\end{align*}\nWe conclude that $S = S_1+S_2 = \\frac{17}{21}$.\n\n\\noindent\n\\textbf{Second solution:}\nRecall that the real numbers $a,b,c$ form the side lengths of a triangle if and only if\n\\[\ns-a, s-b, s-c > 0 \\qquad s = \\frac{a+b+c}{2},\n\\]\nand that if we put $x = 2(s-a), y = 2(s-b), z = 2(s-c)$,\n\\[\na = \\frac{y+z}{2}, b = \\frac{z+x}{2}, c = \\frac{x+y}{2}.\n\\]\nTo generate all \\emph{integer} triples $(a,b,c)$ which form the side lengths of a triangle, we must also assume that $x,y,z$ are either all even or all odd. We may therefore write the original sum as\n\\[\n%\\sum_{(a,b,c) \\in T} \\frac{2^a}{3^b 5^c}\n%=\n\\sum_{x,y,z >0 \\mbox{\\small \\,odd}} \\frac{2^{(y+z)/2}}{3^{(z+x)/2} 5^{(x+y)/2}}\n+ \\sum_{x,y,z >0 \\mbox{\\small \\,even}} \\frac{2^{(y+z)/2}}{3^{(z+x)/2} 5^{(x+y)/2}}.\n\\]\nTo unify the two sums, we substitute in the first case  $x = 2u+1, y = 2v+1, z = 2w+1$ and in the second case $x = 2u+2, y = 2v+2, z = 2w+2$ to obtain\n\\begin{align*}\n\\sum_{(a,b,c) \\in T} \\frac{2^a}{3^b 5^c}\n&= \\sum_{u,v,w=1}^\\infty \\frac{2^{v+w}}{3^{w+u} 5^{u+v}} \\left( 1 + \\frac{2^{-1}}{3^{-1} 5^{-1}} \\right) \\\\\n&= \\frac{17}{2} \\sum_{u=1}^\\infty \\left( \\frac{1}{15} \\right)^u \\sum_{v=1}^\\infty\n\\left( \\frac{2}{5} \\right)^v \\sum_{w=1}^\\infty \\left( \\frac{2}{3} \\right)^w \\\\\n&= \\frac{17}{2} \\frac{1/15}{1-1/15} \\frac{2/5}{1-2/5} \\frac{2/3}{1-2/3} \\\\\n&= \\frac{17}{21}.\n\\end{align*}", "category": "Combinatorics", "source": "PUTNAM", "year": 2015}
{"id": "putnam-2015-b5", "question": "Let $P_n$ be the number of permutations $\\pi$ of $\\{1,2,\\dots,n\\}$ such that\n\\[\n|i-j| = 1 \\mbox{ implies } |\\pi(i) -\\pi(j)| \\leq 2\n\\]\nfor all $i,j$ in $\\{1,2,\\dots,n\\}$. Show that for $n \\geq 2$, the quantity\n\\[\nP_{n+5} - P_{n+4} - P_{n+3} + P_n\n\\]\ndoes not depend on $n$, and find its value.", "solution": "The answer is 4.\n\nAssume $n \\geq 3$ for the moment.\nWe write the permutations $\\pi$ counted by $P_n$ as sequences $\\pi(1),\\pi(2),\\ldots,\\pi(n)$.  Let $U_n$ be the number of permutations counted by $P_n$ that end with $n-1,n$; let $V_n$ be the number ending in $n,n-1$; let $W_n$ be the number starting with $n-1$ and ending in $n-2,n$; let $T_n$ be the number ending in $n-2,n$ but not starting with $n-1$; and let $S_n$ be the number which has $n-1,n$ consecutively in that order, but not at the beginning or end.\nIt is clear that every permutation $\\pi$ counted by $P_n$ either lies in exactly one of the sets counted by $U_n, V_n, W_n, T_n, S_n$, or is the reverse of such a permutation.  Therefore\n\\[\nP_n = 2 (U_n + V_n + W_n+ T_n+ S_n).\n\\]\nBy examining how each of the elements in the sets counted by $U_{n+1}, V_{n+1}, W_{n+1}, T_{n+1}, S_{n+1}$ can be obtained from a (unique) element in one of the sets counted by $U_n, V_n, W_n, T_n, S_n$ by suitably inserting the element $n+1$, we obtain the recurrence relations\n\\begin{align*}\nU_{n+1} &= U_n+W_n+T_n, \\\\\nV_{n+1}&=U_n, \\\\\nW_{n+1}&=W_n, \\\\\nT_{n+1}&=V_n, \\\\\nS_{n+1}&=S_n+V_n.\n\\end{align*}\nAlso, it is clear that $W_n=1$ for all $n$. \n\nSo far we have assumed $n \\geq 3$, but it is straightforward to extrapolate the sequences $P_n,U_n,V_n,W_n,T_n,S_n$ back to $n=2$ to preserve the preceding identities. Hence for all $n \\geq 2$,\n\\begin{align*}\nP_{n+5} &= 2(U_{n+5}+V_{n+5}+W_{n+5}+T_{n+5}+S_{n+5}) \\\\\n&= 2((U_{n+4}+W_{n+4}+T_{n+4})+U_{n+4}\\\\\n& \\qquad + W_{n+4}+V_{n+4}+(S_{n+4}+V_{n+4})) \\\\\n&= P_{n+4} + 2(U_{n+4}+W_{n+4}+V_{n+4}) \\\\\n&= P_{n+4} + 2((U_{n+3}+W_{n+3}+T_{n+3})+W_{n+3}+U_{n+3}) \\\\\n&= P_{n+4} + P_{n+3} + 2(U_{n+3}-V_{n+3}+W_{n+3}-S_{n+3}) \\\\\n&= P_{n+4} + P_{n+3} + 2((U_{n+2}+W_{n+2}+T_{n+2})-U_{n+2}\\\\\n&\\qquad +W_{n+2}-(S_{n+2}-V_{n+2})) \\\\\n&= P_{n+4} + P_{n+3} + 2(2W_{n+2}+T_{n+2}-S_{n+2}-V_{n+2}) \\\\\n&= P_{n+4} + P_{n+3} + 2(2W_{n+1}+V_{n+1}\\\\\n&\\qquad -(S_{n+1}+V_{n+1})-U_{n+1}) \\\\\n&= P_{n+4} + P_{n+3} + 2(2W_n+U_n-(S_n+V_n)-U_n\\\\\n&\\qquad -(U_n+W_n+T_n)) \\\\\n&= P_{n+4} + P_{n+3} - P_n + 4,\n\\end{align*}\nas desired.\n\n\\noindent\n\\textbf{Remark:}\nThere are many possible variants of the above solution obtained by dividing the permutations up according to different features. For example, Karl Mahlburg suggests \nwriting \n\\[\nP_n = 2P'_n, \\qquad P'_n = Q'_n + R'_n\n\\]\nwhere $P'_n$ counts those permutations counted by $P_n$ for which $1$ occurs before 2,\nand $Q'_n$ counts those permutations counted by $P'_n$ for which $\\pi(1) = 1$. One then has the recursion\n\\[\nQ'_n = Q'_{n-1} + Q'_{n-3} + 1\n\\]\ncorresponding to the cases where $\\pi(1), \\pi(2) = 1,2$; where $\\pi(1), \\pi(2), \\pi(3) = 1,3,2$;  and the unique case $1,3,5,\\dots,6,4,2$. Meanwhile, one has\n\\[\nR'_n = R'_{n-1} + Q'_{n-2}\n\\]\ncorresponding to the cases containing $3,1,2,4$ (where removing 1 and reversing gives a permutation counted by $R'_{n-1}$); and where $4$ occurs before $3, 1, 2$ (where removing $1,2$ and reversing gives a permutation counted by $Q'_{n-2}$).\n\n\\noindent\n\\textbf{Remark:}\nThe permutations counted by $P_n$ are known as {\\it key permutations}, and have been studied by E.S. Page, Systematic generation of ordered sequences using recurrence relations, {\\it The Computer Journal} {\\bf 14} (1971), no. 2, 150--153.  We have used the same notation for consistency with the literature. The sequence of the $P_n$ also appears as entry A003274 in the On-line Encyclopedia of Integer Sequences (\\url{http://oeis.org}).", "category": "Combinatorics", "source": "PUTNAM", "year": 2015}
{"id": "putnam-2015-b6", "question": "For each positive integer $k$, let $A(k)$ be the number of odd divisors of $k$ in the interval $[1, \\sqrt{2k})$. Evaluate\n\\[\n\\sum_{k=1}^\\infty (-1)^{k-1} \\frac{A(k)}{k}.\n\\]\n\n\\end{itemize}\n\n\\end{document}", "solution": "(from \\url{artofproblemsolving.com})\nWe will prove that the sum converges to $\\pi^2/16$.\nNote first that the sum does not converge absolutely, so we are not free to rearrange it arbitrarily. For that matter, the standard alternating sum test does not apply because the absolute values of the terms does not decrease to 0, so even the convergence of the sum must be established by hand.\n\nSetting these issues aside momentarily, note that\nthe elements of the set counted by $A(k)$ are those odd positive integers $d$ for which $m = k/d$ is also an integer and $d < \\sqrt{2dm}$; if we write $d = 2\\ee-1$, then the condition on $m$ reduces to $m \\geq \\ee$. In other words, the original sum equals\n\\[\nS_1 := \\sum_{k=1}^\\infty \\sum_{{\\ee \\geq 1, m \\geq \\ee}\\atop{k = m(2\\ee-1)}} \\frac{(-1)^{m-1}}{m(2\\ee-1)},\n\\]\nand we would like to rearrange this to\n\\[\nS_2 := \\sum_{\\ee=1}^\\infty \\frac{1}{2\\ee-1} \\sum_{m=\\ee}^\\infty \\frac{(-1)^{m-1}}{m},\n\\]\nin which both sums converge by the alternating sum test. In fact a bit more is true:\nwe have\n\\[\n\\left| \\sum_{m=\\ee}^\\infty \\frac{(-1)^{m-1}}{m} \\right| < \\frac{1}{\\ee},\n\\]\nso the outer sum converges absolutely.\nIn particular, $S_2$ is the limit of the truncated sums\n\\[\nS_{2,n} = \\sum_{\\ee(2\\ee-1) \\leq n} \\frac{1}{2\\ee-1} \\sum_{m=\\ee}^\\infty \\frac{(-1)^{m-1}}{m}.\n\\]\nTo see that $S_1$ converges to the same value as $S_2$, write\n\\[\nS_{2,n} - \\sum_{k=1}^n (-1)^{k-1} \\frac{A(k)}{k} =\n\\sum_{\\ee(2\\ee-1) \\leq n} \\frac{1}{2\\ee-1} \\sum_{m=\\lfloor \\frac{n}{2\\ee-1}+1 \\rfloor}^\\infty\n\\frac{(-1)^{m-1}}{m}.\n\\]\nThe expression on the right is bounded above in absolute value by the sum $\\sum_{\\ee(2\\ee-1) \\leq n} \\frac{1}{n}$, in which the number of summands is\n%at most $\\sqrt{n/2}$ and so the total is bounded by $1/\\sqrt{2n}$.\nat most $\\sqrt{n}$ (since $\\sqrt{n}(2\\sqrt{n}-1)\\geq n$), and so the total is bounded above by $1/\\sqrt{n}$.\nHence the difference converges to zero as $n \\to \\infty$; that is, $S_1$ converges and equals $S_2$.\n\nWe may thus focus hereafter on computing $S_2$. We begin by writing\n\\[\nS_2 = \\sum_{\\ee=1}^\\infty \\frac{1}{2\\ee-1} \\sum_{m=\\ee}^\\infty (-1)^{m-1} \\int_0^1 t^{m-1}\\,dt.\n\\]\nOur next step will be to interchange the inner sum and the integral, but again this requires some justification.\n\\begin{lemma}\nLet $f_0, f_1, \\dots$ be a sequence of continuous functions on $[0,1]$ such that for each $x \\in [0,1]$, we have\n\\[\nf_0(x) \\geq f_1(x) \\geq \\cdots \\geq 0.\n\\]\nThen\n\\[\n\\sum_{n=0}^\\infty (-1)^n \\int_0^1 f_n(t)\\,dt = \\int_0^1 \\left( \\sum_{n=0}^\\infty (-1)^n f_n(t) \\right)\\,dt\n\\]\nprovided that both sums converge.\n\\end{lemma}\n\\begin{proof}\nPut $g_n(t) = f_{2n}(t) - f_{2n+1}(t) \\geq 0$; we may then rewrite the desired equality as\n\\[\n\\sum_{n=0}^\\infty \\int_0^1 g_n(t) \\,dt = \\int_0^1 \\left( \\sum_{n=0}^\\infty g_n(t) \\right)\\,dt,\n\\]\nwhich is a case of the Lebesgue monotone convergence theorem.\n\\end{proof}\nBy Lemma~1, we have\n\\begin{align*}\nS_2 &= \\sum_{\\ee=1}^\\infty \\frac{1}{2\\ee-1} \\int_0^1 \\left( \\sum_{m=\\ee}^\\infty (-1)^{m-1} t^{m-1} \\right) \\,dt \\\\\n&=  \\sum_{\\ee=1}^\\infty \\frac{1}{2\\ee-1} \\int_0^1 \\frac{(-t)^{\\ee-1}}{1+t}  \\,dt.\n\\end{align*}\nSince the outer sum is absolutely convergent, we may freely interchange it with the integral:\n\\begin{align*}\nS_2 &=  \\int_0^1 \\left(\n\\sum_{\\ee=1}^\\infty \\frac{1}{2\\ee-1}  \\frac{(-t)^{\\ee-1}}{1+t} \\right)\\,dt \\\\\n&= \\int_0^1 \\frac{1}{\\sqrt{t}(1+t)} \\left( \\sum_{\\ee=1}^\\infty \\frac{(-1)^{\\ee-1} t^{\\ee-1/2}}{2\\ee-1} \\right) \\,dt \\\\\n&= \\int_0^1 \\frac{1}{\\sqrt{t}(1+t)} \\arctan(\\sqrt{t})\\,dt \\\\\n&= \\int_0^1 \\frac{2}{1+u^2} \\arctan(u)\\,du \\qquad (u = \\sqrt{t}) \\\\\n&= \\arctan(1)^2 - \\arctan(0)^2 = \\frac{\\pi^2}{16}.\n\\end{align*}\n\n\\end{itemize}\n\\end{document}", "category": "Number Theory", "source": "PUTNAM", "year": 2015}
{"id": "putnam-2010-a1", "question": "Given a positive integer $n$, what is the largest $k$ such that the\nnumbers $1,2,\\dots,n$ can be put into $k$ boxes so that the sum of the numbers\nin each box is the same? [When $n=8$, the example $\\{1,2,3,6\\}, \\{4,8\\}, \\{5,7\\}$\nshows that the largest $k$ is \\emph{at least} 3.]", "solution": "The largest such $k$ is $\\lfloor \\frac{n+1}{2} \\rfloor = \\lceil \\frac{n}{2} \\rceil$.\nFor $n$ even, this value is achieved by the partition\n\\[\n\\{1, n\\}, \\{2, n-1\\}, \\dots;\n\\]\nfor $n$ odd, it is achieved by the partition\n\\[\n\\{n\\}, \\{1, n-1\\}, \\{2, n-2\\}, \\dots.\n\\]\nOne way to see that this is optimal is to note that the common sum can never be less than $n$,\nsince $n$ itself belongs to one of the boxes. This implies that $k \\leq (1 + \\cdots + n)/n = (n+1)/2$.\nAnother argument is that if $k > (n+1)/2$, then there would have to be two boxes with one number each\n(by the pigeonhole principle), but such boxes could not have the same sum.\n\n\n\\textbf{Remark.} A much subtler question would be to find the smallest $k$ (as a function of $n$)\nfor which no such arrangement exists.", "category": "Combinatorics", "source": "PUTNAM", "year": 2010}
{"id": "putnam-2010-a2", "question": "Find all differentiable functions $f:\\mathbb{R} \\to \\mathbb{R}$ such that\n\\[\nf'(x) = \\frac{f(x+n)-f(x)}{n}\n\\]\nfor all real numbers $x$ and all positive integers $n$.", "solution": "The only such functions are those of the form $f(x) = cx+d$ for some real numbers $c,d$ (for which the\nproperty is obviously satisfied). To see this, suppose that $f$ has the desired property. Then for any $x \\in \\RR$,\n\\begin{align*}\n2f'(x) &= f(x+2)-f(x) \\\\\n&= (f(x+2) - f(x+1)) + (f(x+1) - f(x)) \\\\\n&= f'(x+1) + f'(x).\n\\end{align*}\nConsequently, $f'(x+1) = f'(x)$.\n\nDefine the function $g: \\RR \\to \\RR$ by $g(x) = f(x+1) - f(x)$, and put $c = g(0)$, $d = f(0)$. For all $x \\in \\RR$,\n$g'(x) = f'(x+1) -f'(x) = 0$, so $g(x) = c$ identically,\nand $f'(x) = f(x+1)-f(x) = g(x) = c$, so $f(x) = cx+d$ identically as desired.", "category": "Algebra", "source": "PUTNAM", "year": 2010}
{"id": "putnam-2010-a3", "question": "Suppose that the function $h:\\mathbb{R}^2\\to \\mathbb{R}$ has continuous partial\nderivatives and satisfies the equation\n\\[\nh(x,y) = a \\frac{\\partial h}{\\partial x}(x,y) +\nb \\frac{\\partial h}{\\partial y}(x,y)\n\\]\nfor some constants $a,b$. Prove that if there is a constant $M$ such that\n$|h(x,y)|\\leq M$ for all $(x,y) \\in \\mathbb{R}^2$, then $h$ is identically zero.", "solution": "If $a=b=0$, then the desired result holds trivially, so we assume that at least one of $a,b$ is nonzero.\nPick any point $(a_0, b_0) \\in \\mathbb{R}^2$, and let $L$ be the line given by the parametric equation\n$L(t) = (a_0,b_0) + (a,b) t$ for $t\\in \\mathbb{R}$. By the chain rule and the given equation, we have $\\frac{d}{dt}(h\\circ L) = h\\circ L$. If we write $f = h\\circ L:\\mathbb{R} \\to \\mathbb{R}$, then $f'(t) = f(t)$ for all $t$. It follows that $f(t) = Ce^t$ for some constant $C$. Since $|f(t)| \\leq M$ for all $t$, we must have $C=0$.\nIt follows that $h(a_0,b_0) = 0$; since $(a_0,b_0)$ was an arbitrary point,\n$h$ is identically $0$ over all of $\\mathbb{R}^2$.", "category": "Algebra", "source": "PUTNAM", "year": 2010}
{"id": "putnam-2010-a4", "question": "Prove that for each positive integer $n$, the number\n$10^{10^{10^n}} + 10^{10^n} + 10^n - 1$\nis not prime.", "solution": "Put\n\\[\nN = 10^{10^{10^n}} + 10^{10^n} + 10^n - 1.\n\\]\nWrite $n = 2^m k$ with $m$ a nonnegative integer and $k$ a positive odd integer.\nFor any nonnegative integer $j$,\n\\[\n10^{2^m j} \\equiv (-1)^j \\pmod{10^{2^m} + 1}.\n\\]\nSince $10^n \\geq n \\geq 2^m \\geq m+1$, $10^n$ is divisible by $2^n$ and hence by $2^{m+1}$,\nand similarly $10^{10^n}$ is divisible by $2^{10^n}$ and hence by $2^{m+1}$. It follows that\n\\[\nN \\equiv 1 + 1 + (-1) + (-1) \\equiv 0 \\pmod{10^{2^m} + 1}.\n\\]\nSince $N \\geq 10^{10^n} > 10^n + 1 \\geq 10^{2^m} + 1$, it follows that $N$ is composite.", "category": "Number Theory", "source": "PUTNAM", "year": 2010}
{"id": "putnam-2010-a5", "question": "Let $G$ be a group, with operation $*$. Suppose that\n\\begin{enumerate}", "solution": "We start with three lemmas.\n\\setcounter{lemma}{0}\n\\begin{lemma}\nIf $\\mathbf{x},\\mathbf{y} \\in G$ are nonzero orthogonal vectors, then $\\mathbf{x}*\\mathbf{x}$ is parallel to $\\mathbf{y}$.\n\\end{lemma}\n\\begin{proof}\nPut $\\mathbf{z} = \\mathbf{x} \\times \\mathbf{y} \\neq 0$, so that $\\mathbf{x},\\mathbf{y}$, and $\\mathbf{z} = \\mathbf{x}*\\mathbf{y}$ are nonzero and mutually orthogonal.\nThen $\\mathbf{w} = \\mathbf{x} \\times \\mathbf{z} \\neq 0$, so $\\mathbf{w} = \\mathbf{x}*\\mathbf{z}$ is nonzero and orthogonal to $\\mathbf{x}$ and $\\mathbf{z}$.\nHowever, if $(\\mathbf{x}*\\mathbf{x}) \\times \\mathbf{y} \\neq 0$, then $\\mathbf{w} = \\mathbf{x}*(\\mathbf{x}*\\mathbf{y}) = (\\mathbf{x}*\\mathbf{x})*\\mathbf{y} = (\\mathbf{x}*\\mathbf{x}) \\times \\mathbf{y}$ is also orthogonal to $\\mathbf{y}$, a contradiction.\n\\end{proof}\n\\begin{lemma}\nIf $\\mathbf{x} \\in G$ is nonzero, and there exists $\\mathbf{y} \\in G$ nonzero and orthogonal to $\\mathbf{x}$, then $\\mathbf{x}*\\mathbf{x} = 0$.\n\\end{lemma}\n\\begin{proof}\nLemma~1 implies that $\\mathbf{x}*\\mathbf{x}$ is parallel to both $\\mathbf{y}$ and $\\mathbf{x} \\times \\mathbf{y}$, so it must be zero.\n\\end{proof}\n\\begin{lemma}\nIf $\\mathbf{x},\\mathbf{y} \\in G$ commute, then $\\mathbf{x} \\times \\mathbf{y} = 0$.\n\\end{lemma}\n\\begin{proof}\nIf $\\mathbf{x} \\times \\mathbf{y} \\neq 0$, then $\\mathbf{y} \\times \\mathbf{x}$ is nonzero\nand distinct from $\\mathbf{x} \\times \\mathbf{y}$. Consequently,\n$\\mathbf{x}*\\mathbf{y} = \\mathbf{x} \\times \\mathbf{y}$\nand $\\mathbf{y}*\\mathbf{x} = \\mathbf{y} \\times \\mathbf{x} \\neq \\mathbf{x} * \\mathbf{y}$.\n\\end{proof}\n\nWe proceed now to the proof. Assume by way of contradiction that there exist $\\mathbf{a},\\mathbf{b} \\in G$ with $\\mathbf{a} \\times \\mathbf{b}\n\\neq 0$. Put $\\mathbf{c} = \\mathbf{a}\\times \\mathbf{b} = \\mathbf{a}*\\mathbf{b}$, so that $\\mathbf{a},\\mathbf{b},\\mathbf{c}$ are nonzero and linearly independent. Let $\\mathbf{e}$ be the identity\nelement of $G$. Since $\\mathbf{e}$ commutes with $\\mathbf{a},\\mathbf{b},\\mathbf{c}$, by Lemma~3 we have $\\mathbf{e} \\times \\mathbf{a} = \\mathbf{e} \\times \\mathbf{b} = \\mathbf{e} \\times \\mathbf{c} = 0$.\nSince $\\mathbf{a},\\mathbf{b},\\mathbf{c}$ span $\\RR^3$, $\\mathbf{e} \\times \\mathbf{x} = 0$ for all $\\mathbf{x} \\in \\RR^3$, so $\\mathbf{e} = 0$.\n\nSince $\\mathbf{b},\\mathbf{c}$, and $\\mathbf{b} \\times \\mathbf{c} = \\mathbf{b}*\\mathbf{c}$ are nonzero and mutually orthogonal, Lemma~2 implies\n\\[\n\\mathbf{b}*\\mathbf{b} = \\mathbf{c}*\\mathbf{c} = (\\mathbf{b}*\\mathbf{c})*(\\mathbf{b}*\\mathbf{c}) = 0 = \\mathbf{e}.\n\\]\nHence $\\mathbf{b}*\\mathbf{c} = \\mathbf{c}*\\mathbf{b}$, contradicting Lemma~3 because $\\mathbf{b} \\times \\mathbf{c} \\neq 0$.\nThe desired result follows.", "category": "Algebra", "source": "PUTNAM", "year": 2010}
{"id": "putnam-2010-a6", "question": "Let $f:[0,\\infty)\\to \\mathbb{R}$ be a strictly decreasing continuous function\nsuch that $\\lim_{x\\to\\infty} f(x) = 0$. Prove that\n$\\int_0^\\infty \\frac{f(x)-f(x+1)}{f(x)}\\,dx$ diverges.", "solution": "\\textbf{First solution.}\nNote that the hypotheses on $f$ imply that $f(x) > 0$ for all $x \\in [0, +\\infty)$,\nso the integrand is a continuous function of $f$ and the integral makes sense. Rewrite the integral as\n\\[\n\\int_0^\\infty \\left(1 - \\frac{f(x+1)}{f(x)} \\right)\\,dx,\n\\]\nand suppose by way of contradiction that it converges to a finite limit $L$.\nFor $n \\geq 0$, define the Lebesgue measurable set\n\\[\nI_n = \\{x \\in [0,1]: 1 - \\frac{f(x+n+1)}{f(x+n)} \\leq 1/2 \\}.\n\\]\nThen $L \\geq \\sum_{n=0}^\\infty \\frac{1}{2} (1 - \\mu(I_n))$,\nso the latter sum converges.\nIn particular, there exists a nonnegative integer $N$ for which $\\sum_{n=N}^\\infty (1 - \\mu(I_n)) < 1$;\nthe intersection\n\\[\nI = \\bigcup_{n=N}^\\infty I_n = [0,1] - \\bigcap_{n=N}^\\infty ([0,1] - I_n)\n\\]\nthen has positive Lebesgue measure.\n\nBy Taylor's theorem with remainder, for $t \\in [0,1/2]$,\n\\begin{align*}\n-\\log (1-t) &\\leq t + \\frac{t^2}{2} \\sup_{t \\in [0,1/2]} \\left\\{\\frac{1}{(1-t)^2}\n\\right\\} \\\\\n&= t + 2 t^2 \\leq 2t.\n\\end{align*}\nFor each nonnegative integer $n \\geq N$, we then have\n\\begin{align*}\nL &\\geq \\int_N^{n} \\left(1 - \\frac{f(x+1)}{f(x)} \\right)\\,dx \\\\\n&= \\sum_{i=N}^{n-1} \\int_0^1 \\left( 1 - \\frac{f(x+i+1)}{f(x+i)}\\right)\\,dx \\\\\n&\\geq \\sum_{i=N}^{n-1} \\int_I \\left( 1 - \\frac{f(x+i+1)}{f(x+i)}\\right)\\,dx \\\\\n&\\geq \\frac{1}{2} \\sum_{i=N}^{n-1} \\int_I \\log \\frac{f(x+i)}{f(x+i+1)}\\,dx \\\\\n&= \\frac{1}{2} \\int_I \\left( \\sum_{i=N}^{n-1} \\log \\frac{f(x+i)}{f(x+i+1)}\\right) \\,dx \\\\\n&= \\frac{1}{2} \\int_I \\log \\frac{f(x+N)}{f(x+n)} \\,dx.\n\\end{align*}\nFor each $x \\in I$, $\\log f(x+N)/f(x+n)$ is a strictly increasing unbounded function of $n$.\nBy the monotone convergence theorem, the integral $\\int_I \\log (f(x+N)/f(x+n)) \\,dx$ grows without bound\nas $n \\to +\\infty$, a contradiction. Thus the original integral diverges, as desired.\n\n\\textbf{Remark.}\nThis solution is motivated by the commonly-used fact that an infinite product\n$(1 + x_1)(1 + x_2) \\cdots$ converges absolutely if and only if the sum\n$x_1 + x_2 + \\cdots$ converges absolutely. The additional measure-theoretic argument at the beginning is needed\nbecause one cannot bound $-\\log(1-t)$ by a fixed multiple of $t$ uniformly for all $t \\in [0,1)$.\n\nGreg Martin suggests a variant solution that avoids use of Lebesgue measure.\nNote first that if $f(y) > 2f(y+1)$, then either $f(y) > \\sqrt{2} f(y+1/2)$ or $f(y+1/2) > \\sqrt{2} f(y+1)$,\nand in either case we deduce that\n\\[\n\\int_{y-1/2}^{y+1/2} \\frac{f(x)-f(x+1)}{f(x)}\\,dx > \\frac{1}{2} \\left(1 - \\frac{1}{\\sqrt{2}} \\right)  > \\frac{1}{7}.\n\\]\nIf there exist arbitrarily large values of $y$ for which $f(y) > 2f(y+1)$, we deduce that\nthe original integral is greater than any multiple of $1/7$, and so diverges. Otherwise,\nfor $x$ large we may argue that\n\\[\n\\frac{f(x)-f(x+1)}{f(x)} > \\frac{3}{5} \\log \\frac{f(x)}{f(x+1)}\n\\]\nas in the above solution, and again get divergence using a telescoping sum.\n\n\\textbf{Second solution.}\n(Communicated by Paul Allen.)\nLet $b>a$ be nonnegative integers. Then\n\\begin{align*}\n\\int_a^b \\frac{f(x)-f(x+1)}{f(x)}dx &=\n\\sum_{k=a}^{b-1} \\int_0^1 \\frac{f(x+k)-f(x+k+1)}{f(x+k)}dx \\\\\n&= \\int_0^1 \\sum_{k=a}^{b-1} \\frac{f(x+k)-f(x+k+1)}{f(x+k)}dx \\\\\n&\\geq \\int_0^1 \\sum_{k=a}^{b-1} \\frac{f(x+k)-f(x+k+1)}{f(x+a)}dx \\\\\n&= \\int_0^1 \\frac{f(x+a)-f(x+b)}{f(x+a)} dx.\n\\end{align*}\nNow since $f(x)\\rightarrow 0$, given $a$, we can choose an integer $l(a)>a$ for which $f(l(a)) < f(a+1)/2$; then $\\frac{f(x+a)-f(x+l(a))}{f(x+a)} \\geq 1 - \\frac{f(l(a))}{f(a+1)} > 1/2$ for all $x\\in [0,1]$. Thus if we define a sequence of integers $a_n$ by $a_0=0$, $a_{n+1}=l(a_n)$, then\n\\begin{align*}\n\\int_0^\\infty \\frac{f(x)-f(x+1)}{f(x)} dx &=\n\\sum_{n=0}^\\infty \\int_{a_n}^{a_{n+1}} \\frac{f(x)-f(x+1)}{f(x)} dx \\\\\n&> \\sum_{n=0}^\\infty \\int_0^1 (1/2) dx,\n\\end{align*}\nand the final sum clearly diverges.\n\n\\textbf{Third solution.}\n(By Joshua Rosenberg, communicated by Catalin Zara.)\nIf the original integral converges, then\non one hand the integrand $(f(x)-f(x+1))/f(x) = 1 - f(x+1)/f(x)$\ncannot tend to 1 as $x \\to \\infty$.\nOn the other hand, for any $a \\geq 0$,\n\\begin{align*}\n0 &< \\frac{f(a+1)}{f(a)} \\\\\n&< \\frac{1}{f(a)} \\int_a^{a+1} f(x)\\,dx \\\\\n&= \\frac{1}{f(a)} \\int_a^\\infty (f(x) - f(x+1))\\,dx \\\\\n&\\leq \\int_a^\\infty \\frac{f(x) - f(x+1)}{f(x)}\\,dx,\n\\end{align*}\nand the last expression tends to 0 as $a \\to \\infty$.\nHence by the squeeze theorem, $f(a+1)/f(a) \\to 0$ as $a \\to \\infty$, a contradiction.", "category": "Algebra", "source": "PUTNAM", "year": 2010}
{"id": "putnam-2010-b1", "question": "Is there an infinite sequence of real numbers $a_1, a_2, a_3, \\dots$ such that\n\\[\na_1^m + a_2^m + a_3^m + \\cdots = m\n\\]\nfor every positive integer $m$?", "solution": "\\textbf{First solution.}\nNo such sequence exists. If it did, then the Cauchy-Schwartz inequality would imply\n\\begin{align*}\n8 &= (a_1^2 + a_2^2 +  \\cdots)(a_1^4 + a_2^4 + \\cdots) \\\\\n&\\geq (a_1^3 + a_2^3 + \\cdots)^2 = 9,\n\\end{align*}\ncontradiction.\n\n\\textbf{Second solution.}\n(Communicated by Catalin Zara.)\nSuppose that such a sequence exists.\nIf $a_k^2 \\in [0,1]$ for all $k$, then $a_k^4 \\leq a_k^2$ for all $k$, and so\n\\[\n4 = a_1^4 + a_2^4 + \\cdots \\leq a_1^2 + a_2^2 + \\cdots = 2,\n\\]\ncontradiction. There thus exists a positive integer $k$ for which $a_k^2 \\geq 1$.\nHowever, in this case, for $m$ large, $a_k^{2m} > 2m$ and so\n$a_1^{2m} + a_2^{2m} + \\cdots \\neq 2m$.\n\n\\textbf{Third solution.}\nWe generalize the second solution to show that for any positive integer $k$, it is impossible for a sequence\n$a_1, a_2,\\dots$ of complex numbers to satisfy the given conditions in case\nthe series $a_1^k + a_2^k + \\cdots$ converges absolutely. This includes the original problem by taking\n$k=2$, in which case the series $a_1^2 + a_2^2 + \\cdots$ consists of nonnegative\nreal numbers and so converges absolutely if it converges at all.\n\nSince the sum $\\sum_{i=1}^\\infty |a_i|^k$ converges by hypothesis, we can find a positive integer $n$\nsuch that $\\sum_{i=n+1}^\\infty |a_i|^k < 1$. For each positive integer $d$, we then have\n\\[\n\\left|kd - \\sum_{i=1}^n a_i^{kd} \\right|\n\\leq \\sum_{i=n+1}^\\infty |a_i|^{kd} < 1.\n\\]\nWe thus cannot have $|a_1|,\\dots,|a_n| \\leq 1$, or else the sum $\\sum_{i=1}^n a_i^{kd}$ would be bounded\nin absolute value by $n$ independently of $d$. But if we put $r = \\max\\{|a_1|,\\dots,|a_n|\\} > 1$, we\nobtain another contradiction because for any $\\epsilon > 0$,\n\\[\n\\limsup_{d \\to \\infty} (r-\\epsilon)^{-kd} \\left| \\sum_{i=1}^n a_i^{kd} \\right| > 0.\n\\]\nFor instance, this follows from applying the root test to the rational function\n\\[\n\\sum_{i=1}^n \\frac{1}{1 - a_i^k z} = \\sum_{d=0}^\\infty \\left( \\sum_{i=1}^n a_i^{kd} \\right) z^d,\n\\]\nwhich has a pole within the circle $|z| \\leq r^{-1/k}$.\n(An elementary proof is also possible.)\n\n\\textbf{Fourth solution.}\n(Communicated by Noam Elkies.)\nSince $\\sum_k a_k^2 = 2$, for each positive integer $k$ we have $a_k^2 \\leq 2$ and so $a_k^4 \\leq 2 a_k^2$,\nwith equality only for $a_k^2 \\in \\{0,2\\}$. Thus to have $\\sum_k a_k^4 = 4$, there must be a single index\n$k$ for which $a_k^2 = 2$, and the other $a_k$ must all equal 0. But then $\\sum_k a_k^{2m} = 2^m \\neq 2m$\nfor any positive integer $m>2$.\n\n\\textbf{Remark.} Manjul Bhargava points out it is easy to construct sequences of complex numbers with the\ndesired property if we drop the condition of absolute convergence. Here is an inductive construction\n(of which several variants are possible).\nFor $n=1,2,\\dots$ and $z \\in \\CC$, define the finite sequence\n\\[\ns_{n,z} = \\left( \\frac{1}{z} e^{2 \\pi i j/n}: j = 0, \\dots, n-1 \\right).\n\\]\nThis sequence has the property that for any positive integer $j$, the sum of the $j$-th powers\nof the terms of $s_{n,z}$ equals $1/z^{j}$ if $j$ is divisible by $n$ and 0 otherwise.\nMoreover, any partial sum of $j$-th powers is bounded in absolute value by $n/|z|^j$.\n\nThe desired sequence will be constructed as follows. Suppose that we have a finite sequence\nwhich has the correct sum of $j$-th powers for $j=1,\\dots,m$. (For instance, for $m=1$,\nwe may start with the singleton sequence 1.) We may then extend it to a new sequence which has\nthe correct sum of $j$-th powers for $j=1,\\dots,m+1$, by appending $k$ copies of $s_{m+1,z}$\nfor suitable choices of a positive integer $k$ and a complex number $z$ with $|z| < m^{-2}$.\nThis last restriction ensures that the resulting infinite sequence $a_1,a_2,\\dots$ is such that\nfor each positive integer $m$, the series $a_1^m + a_2^m + \\cdots$ is convergent (though not absolutely\nconvergent). Its partial sums include a subsequence equal to the constant value $m$, so the sum of the series\nmust equal $m$ as desired.", "category": "Algebra", "source": "PUTNAM", "year": 2010}
{"id": "putnam-2010-b2", "question": "Given that $A$, $B$, and $C$ are noncollinear points in the plane with integer coordinates\nsuch that the distances $AB$, $AC$, and $BC$ are integers, what is the smallest possible value of $AB$?", "solution": "The smallest distance is 3, achieved by $A = (0,0)$, $B = (3,0)$, $C = (0,4)$.\nTo check this, it suffices to check that $AB$ cannot equal 1 or 2. (It cannot equal 0\nbecause if two of the points were to coincide, the three points would be collinear.)\n\nThe triangle inequality implies that $|AC - BC| \\leq AB$, with equality if and only if $A,B,C$\nare collinear. If $AB = 1$, we may assume without loss of generality that $A = (0,0)$, $B = (1,0)$.\nTo avoid collinearity, we must have $AC = BC$, but this forces $C = (1/2, y)$ for some $y \\in \\RR$,\na contradiction. (One can also treat this case by scaling by a factor of 2 to reduce to the case $AB=2$,\ntreated in the next paragraph.)\n\nIf $AB = 2$, then we may assume without loss of generality that $A = (0,0), B = (2,0)$.\nThe triangle inequality implies $|AC - BC| \\in \\{0,1\\}$.\nAlso, for $C = (x,y)$, $AC^2 = x^2 + y^2$ and $BC^2 = (2-x)^2 + y^2$ have the same parity;\nit follows that $AC = BC$. Hence $c = (1,y)$ for some $y \\in \\RR$, so $y^2$ and $y^2+1=BC^2$\nare consecutive perfect squares. This can only happen for $y = 0$, but then $A,B,C$ are collinear,\na contradiction again.\n\n\\textbf{Remark.} Manjul Bhargava points out that more generally, a \\emph{Heronian triangle}\n(a triangle with integer sides and rational area) cannot have a side of length 1 or 2 (and again\nit is enough to treat the case of length 2). The original\nproblem follows from this because a triangle whose vertices have integer coordinates has area\nequal to half an integer (by Pick's formula or the explicit formula for the area as a determinant).", "category": "Geometry", "source": "PUTNAM", "year": 2010}
{"id": "putnam-2010-b3", "question": "There are 2010 boxes labeled $B_1, B_2, \\dots, B_{2010}$, and $2010n$ balls have been distributed\namong them, for some positive integer $n$. You may redistribute the balls by a sequence of moves,\neach of which consists of choosing an $i$ and moving \\emph{exactly} $i$ balls from box $B_i$ into any\none other box. For which values of $n$ is it possible to reach the distribution with exactly $n$ balls\nin each box, regardless of the initial distribution of balls?\n\\medskip", "solution": "It is possible if and only if $n \\geq 1005$.\nSince\n\\[\n1 + \\cdots + 2009 = \\frac{2009 \\times 2010}{2} = 2010 \\times 1004.5,\n\\]\nfor $n \\leq 1004$, we can start with an initial distribution in which each box\n$B_i$ starts with at most $i-1$ balls (so in particular $B_1$ is empty).\nFrom such a distribution, no moves are possible, so\nwe cannot reach the desired final distribution.\n\nSuppose now that $n \\geq 1005$.\nBy the pigeonhole principle, at any time, there exists at least one index $i$ for which the box $B_i$\ncontains at least $i$ balls. We will describe any such index as being \\emph{eligible}.\nThe following sequence of operations then has the desired effect.\n\\begin{itemize}", "category": "Combinatorics", "source": "PUTNAM", "year": 2010}
{"id": "putnam-2010-b4", "question": "Find all pairs of polynomials $p(x)$ and $q(x)$ with real coefficients for which\n\\[\np(x) q(x+1) - p(x+1) q(x) = 1.\n\\]", "solution": "\\textbf{First solution.}\nThe pairs $(p,q)$ satisfying the given equation are those of the form $p(x) = ax+b, q(x) = cx+d$\nfor $a,b,c,d \\in \\RR$ such that $bc- ad = 1$. We will see later that these indeed give solutions.\n\nSuppose $p$ and $q$ satisfy the given equation; note that neither $p$ nor $q$ can be identically zero.\nBy subtracting the equations\n\\begin{align*}\np(x) q(x+1) - p(x+1) q(x) &= 1 \\\\\np(x-1) q(x) - p(x) q(x-1) &= 1,\n\\end{align*}\nwe obtain the equation\n\\[\np(x) (q(x+1) + q(x-1)) = q(x) (p(x+1) + p(x-1)).\n\\]\nThe original equation implies that $p(x)$ and $q(x)$ have no common nonconstant factor,\nso $p(x)$ divides $p(x+1) + p(x-1)$. Since each of $p(x+1)$ and $p(x-1)$ has the same degree and leading\ncoefficient as $p$, we must have\n\\[\np(x+1) + p(x-1) = 2p(x).\n\\]\nIf we define the polynomials $r(x) = p(x+1) - p(x)$, $s(x) = q(x+1) - q(x)$,\nwe have $r(x+1) = r(x)$, and similarly $s(x+1) = s(x)$.\nPut\n\\[\na = r(0), b = p(0), c = s(0), d = q(0).\n\\]\nThen $r(x) = a, s(x) = c$ for all $x \\in \\ZZ$, and hence identically;\nconsequently, $p(x) = ax + b, q(x) = cx + d$ for all $x \\in \\ZZ$, and hence identically.\nFor $p$ and $q$ of this form,\n\\[\np(x) q(x+1) - p(x+1) q(x) = bc - ad,\n\\]\nso we get a solution if and only if $bc-ad=1$, as claimed.\n\n\\textbf{Second solution.}\n(Communicated by Catalin Zara.)\nAgain, note that $p$ and $q$ must be nonzero.\nWrite\n\\begin{align*}\np(x) &= p_0 + p_1 x + \\cdots + p_m x^m \\\\\nq(x) &= q_0 + q_1 x + \\cdots + q_n x^n\n\\end{align*}\nwith $p_m, q_n \\neq 0$, so that $m = \\deg(p), n = \\deg(q)$. It is enough to derive a contradiction\nassuming that $\\max\\{m,n\\} > 1$, the remaining cases being treated as in the\nfirst solution.\n\nPut $R(x) = p(x) q(x+1) - p(x+1) q(x)$. Since $m+n \\geq 2$ by assumption,\nthe coefficient of $x^{m+n-1}$ in $R(x)$\nmust vanish. By easy algebra, this coefficient equals $(m-n) p_m q_n$, so we must have $m=n > 1$.\n\nFor $k=1,\\dots,2m-2$, the coefficient of $x^k$ in $R(x)$ is\n\\[\n\\sum_{i+j>k, j>i} \\left( \\binom{j}{k-i} - \\binom{i}{k-j} \\right)(p_i q_j - p_j q_i)\n\\]\nand must vanish.\nFor $k=2m-2$, the only summand is for $(i,j) = (m-1,m)$, so $p_{m-1} q_m = p_m q_{m-1}$.\n\nSuppose now that $h \\geq 1$ and that $p_i q_j = p_j q_i$ is known to vanish whenever\n$j>i \\geq h$. (By the previous paragraph, we initially have this for $h=m-1$.)\nTake $k = m+h-2$ and note that the conditions $i+j > h, j \\leq m$ force $i \\geq h-1$.\nUsing the hypothesis, we see that the only possible nonzero contribution to the coefficient of $x^k$ in $R(x)$\nis from $(i,j) = (h-1,m)$. Hence $p_{h-1} q_m = p_m q_{h-1}$; since $p_m, q_m \\neq 0$, this implies\n$p_{h-1} q_j = p_j q_{h-1}$ whenever $j > h-1$.\n\nBy descending induction, we deduce that $p_i q_j = p_j q_i$ whenever $j>i \\geq 0$. Consequently,\n$p(x)$ and $q(x)$ are scalar multiples of each other, forcing $R(x) = 0$, a contradiction.\n\n\\textbf{Third solution.}\n(Communicated by David Feldman.)\nAs in the second solution, we note that there are no solutions where $m = \\deg(p), n = \\deg(q)$\nare distinct and $m+n \\geq 2$. Suppose $p,q$ form a solution with $m = n \\geq 2$.\nThe desired identity asserts that the matrix\n\\[\n\\begin{pmatrix}\np(x) & p(x+1) \\\\\nq(x) & q(x+1)\n\\end{pmatrix}\n\\]\nhas determinant 1. This condition is preserved by replacing $q(x)$ with $q(x) - tp(x)$ for any\nreal number $t$. In particular, we can choose $t$ so that $\\deg(q(x) - tp(x)) < m$;\nwe then obtain a contradiction.", "category": "Algebra", "source": "PUTNAM", "year": 2010}
{"id": "putnam-2010-b5", "question": "Is there a strictly increasing function $f: \\mathbb{R} \\to \\mathbb{R}$ such that $f'(x) = f(f(x))$ for all $x$?", "solution": "\\textbf{First solution.}\nThe answer is no. Suppose otherwise. For the condition to make sense, $f$ must be differentiable.\nSince $f$ is strictly increasing, we must have $f'(x) \\geq 0$ for all $x$.\nAlso, the function $f'(x)$ is strictly increasing: if $y>x$ then $f'(y) = f(f(y)) > f(f(x)) = f'(x)$.\nIn particular, $f'(y) > 0$ for all $y \\in \\RR$.\n\nFor any $x_0 \\geq -1$, if $f(x_0) = b$ and $f'(x_0) = a > 0$, then $f'(x) > a$ for $x>x_0$ and thus $f(x) \\geq a(x-x_0)+b$ for $x\\geq x_0$. Then either $b < x_0$ or\n$a = f'(x_0) = f(f(x_0)) = f(b) \\geq a(b-x_0)+b$. In the latter case,\n$b \\leq a(x_0+1)/(a+1) \\leq x_0+1$. We conclude in either case that $f(x_0) \\leq x_0+1$ for all $x_0 \\geq -1$.\n\nIt must then be the case that $f(f(x)) = f'(x) \\leq 1$ for all $x$, since otherwise $f(x) > x+1$ for large $x$. Now by the above reasoning, if $f(0) = b_0$ and $f'(0) = a_0>0$, then $f(x) > a_0x+b_0$ for $x>0$. Thus for $x > \\max\\{0,-b_0/a_0\\}$, we have\n$f(x) > 0$ and $f(f(x)) > a_0x+b_0$. But then $f(f(x)) > 1$ for sufficiently large $x$, a contradiction.\n\n\\textbf{Second solution.}\n(Communicated by Catalin Zara.)\nSuppose such a function exists. Since $f$ is strictly increasing and differentiable, so is $f \\circ f = f'$.\nIn particular, $f$ is twice differentiable; also, $f''(x) = f'(f(x)) f'(x)$ is the product of two strictly\nincreasing nonnegative functions, so it is also strictly increasing and nonnegative. In particular, we can choose\n$\\alpha>0$ and $M \\in \\RR$ such that $f''(x) > 4\\alpha$ for all $x \\geq M$. Then for all $x \\geq M$,\n\\[\nf(x) \\geq f(M) + f'(M)(x-M) + 2\\alpha (x-M)^2.\n\\]\nIn particular, for some $M' > M$, we have $f(x) \\geq \\alpha x^2$ for all $x \\geq M'$.\n\nPick $T>0$ so that $\\alpha T^2 > M'$. Then for $x \\geq T$,\n$f(x) > M'$ and so $f'(x) = f(f(x)) \\geq \\alpha f(x)^2$.\nNow\n\\[\n\\frac{1}{f(T)} - \\frac{1}{f(2T)}\n= \\int_T^{2T} \\frac{f'(t)}{f(t)^2}\\,dt \\geq \\int_T^{2T} \\alpha\\,dt;\n\\]\nhowever, as $T \\to \\infty$, the left side of this inequality\ntends to 0 while the right side tends to $+\\infty$,\na contradiction.\n\n\\textbf{Third solution.}\n(Communicated by Noam Elkies.)\nSince $f$ is strictly increasing, for some $y_0$, we can define the inverse function\n$g(y)$ of $f$ for $y \\geq y_0$. Then $x = g(f(x))$, and we may differentiate to find that\n$1 = g'(f(x)) f'(x) = g'(f(x)) f(f(x))$. It follows that $g'(y) = 1/f(y)$ for $y \\geq y_0$;\nsince $g$ takes arbitrarily large values, the integral $\\int_{y_0}^\\infty dy/f(y)$ must diverge.\nOne then gets a contradiction from any reasonable lower bound on $f(y)$ for $y$ large,\ne.g., the bound $f(x) \\geq \\alpha x^2$ from the second solution. (One can also\nstart with a linear lower bound $f(x) \\geq \\beta x$, then use the integral expression for $g$\nto deduce that $g(x) \\leq \\gamma \\log x$, which in turn forces $f(x)$ to grow exponentially.)", "category": "Algebra", "source": "PUTNAM", "year": 2010}
{"id": "putnam-2010-b6", "question": "Let $A$ be an $n \\times n$ matrix of real numbers for some $n \\geq 1$.\nFor each positive integer $k$, let $A^{[k]}$ be the matrix obtained by raising each entry to the $k$th\npower. Show that if $A^k = A^{[k]}$ for $k=1,2,\\dots,n+1$, then $A^k = A^{[k]}$ for all $k \\geq 1$.\n\n\\end{itemize}\n\n\\end{document}", "solution": "For any polynomial $p(x)$, let $[p(x)]A$ denote the $n\\times n$ matrix obtained by replacing each entry $A_{ij}$ of $A$ by $p(A_{ij})$; thus $A^{[k]} = [x^k]A$. Let $P(x) = x^n + a_{n-1}x^{n-1} + \\cdots + a_0$ denote the characteristic polynomial of $A$. By the Cayley-Hamilton theorem,\n\\begin{align*}\n0 &= A \\cdot P(A) \\\\\n&= A^{n+1} + a_{n-1}A^n+\\cdots+a_0 A \\\\\n&= A^{[n+1]}+a_{n-1}A^{[n]}+\\cdots + a_0 A^{[1]} \\\\\n&=[xp(x)]A.\n\\end{align*}\nThus each entry of $A$ is a root of the polynomial $xp(x)$.\n\nNow suppose $m \\geq n+1$. Then\n\\begin{align*}\n0 &= [x^{m+1-n}P(x)]A  \\\\\n&= A^{[m+1]} + a_{n-1} A^{[m]} + \\cdots + a_0 A^{[m+1-n]}\n\\end{align*}\nsince each entry of $A$ is a root of $x^{m+1-n}P(x)$. On the other hand,\n\\begin{align*}\n0 &= A^{m+1-n} \\cdot P(A) \\\\\n&= A^{m+1} + a_{n-1} A^m + \\cdots + a_0 A^{m+1-n}.\n\\end{align*}\nTherefore if $A^k = A^{[k]}$ for $m+1-n \\leq k \\leq m$, then $A^{m+1} = A^{[m+1]}$. The desired result follows by induction on $m$.\n\n\\textbf{Remark.}\nDavid Feldman points out that the result is best possible in the following sense: there exist\nexamples of $n \\times n$ matrices $A$ for which $A^k = A^{[k]}$ for $k=1,\\dots,n$ but $A^{n+1} \\neq A^{[n+1]}$.\n\n\\end{itemize}\n\\end{document}", "category": "Algebra", "source": "PUTNAM", "year": 2010}
{"id": "tstst-2017-q1", "question": "Let $ABC$ be a triangle with circumcircle $\\Gamma$,\ncircumcenter $O$, and orthocenter $H$.\nAssume that $AB \\neq AC$ and $\\angle A \\neq 90\\dg$.\nLet $M$ and $N$ be the midpoints of $\\ol{AB}$ and $\\ol{AC}$,\nrespectively, and let $E$ and $F$ be the feet of the altitudes\nfrom $B$ and $C$ in $\\triangle ABC$, respectively.\nLet $P$ be the intersection point of line $MN$\nwith the tangent line to $\\Gamma$ at $A$.\nLet $Q$ be the intersection point,\nother than $A$, of $\\Gamma$ with the circumcircle of $\\triangle AEF$.\nLet $R$ be the intersection point of lines $AQ$ and $EF$.\nProve that $\\ol{PR} \\perp \\ol{OH}$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p8526098}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle with circumcircle $\\Gamma$,\ncircumcenter $O$, and orthocenter $H$.\nAssume that $AB \\neq AC$ and $\\angle A \\neq 90\\dg$.\nLet $M$ and $N$ be the midpoints of $\\ol{AB}$ and $\\ol{AC}$,\nrespectively, and let $E$ and $F$ be the feet of the altitudes\nfrom $B$ and $C$ in $\\triangle ABC$, respectively.\nLet $P$ be the intersection point of line $MN$\nwith the tangent line to $\\Gamma$ at $A$.\nLet $Q$ be the intersection point,\nother than $A$, of $\\Gamma$ with the circumcircle of $\\triangle AEF$.\nLet $R$ be the intersection point of lines $AQ$ and $EF$.\nProve that $\\ol{PR} \\perp \\ol{OH}$.\n\\end{mdframed}\n\\paragraph{First solution (power of a point).}\nLet $\\gamma$ denote the nine-point circle of $ABC$.\n\\begin{center}\n\\begin{asy}\npair A = dir(125);\npair B = dir(210);\npair C = dir(330);\npair M = midpoint(A--B);\npair N = midpoint(A--C);\npair O = origin;\npair H = A+B+C;\n\ndraw(A--B--C--cycle, blue);\npair E = foot(B, A, C);\npair F = foot(C, A, B);\ndraw(B--E, lightblue);\ndraw(C--F, lightblue);\npair R = extension(E, F, B, C);\npair Q = -A+2*foot(O, A, R);\n\nfilldraw(unitcircle, opacity(0.1)+lightcyan, blue);\ndraw(A--R--E, heavygreen);\npair P = extension(M, N, A, A+dir(90)*A);\ndraw(A--P--N, red);\nfilldraw(circumcircle(A, M, N), opacity(0.1)+lightred, red);\nfilldraw(circumcircle(A, E, F), opacity(0.1)+lightgreen, heavygreen);\n\nfilldraw(circumcircle(M, N, E), opacity(0.1)+lightcyan, heavycyan);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$M$\", M, dir(145));\ndot(\"$N$\", N, dir(20));\ndot(\"$O$\", O, dir(315));\ndot(\"$H$\", H, dir(H));\ndot(\"$E$\", E, dir(40));\ndot(\"$F$\", F, dir(F));\ndot(\"$R$\", R, dir(R));\ndot(\"$Q$\", Q, dir(Q));\ndot(\"$P$\", P, dir(P));\n\n/* TSQ Source:\n\nA = dir 125\nB = dir 210\nC = dir 330\nM = midpoint A--B R145\nN = midpoint A--C R20\nO = origin R315\nH = A+B+C\n\nA--B--C--cycle blue\nE = foot B A C R40\nF = foot C A B\nB--E lightblue\nC--F lightblue\nR = extension E F B C\nQ = -A+2*foot O A R\n\nunitcircle 0.1 lightcyan / blue\nA--R--E heavygreen\nP = extension M N A A+dir(90)*A\nA--P--N red\ncircumcircle A M N 0.1 lightred / red\ncircumcircle A E F 0.1 lightgreen / heavygreen\n\ncircumcircle M N E 0.1 lightcyan / heavycyan\n\n*/\n\\end{asy}\n\\end{center}\nNote that\n\\begin{itemize}\n  \\ii $PA^2 = PM \\cdot PN$,\n  so $P$ lies on the radical axis of $\\Gamma$ and $\\gamma$.\n  \\ii $RA \\cdot RQ = RE \\cdot RF$,\n  so $R$ lies on the radical axis of $\\Gamma$ and $\\gamma$.\n\\end{itemize}\nThus $\\ol{PR}$ is the radical axis of $\\Gamma$ and $\\gamma$,\nwhich is evidently perpendicular to $\\ol{OH}$.\n\n\\begin{remark*}\n  In fact, by power of a point one may also observe\n  that $R$ lies on $\\ol{BC}$,\n  since it is on the radical axis of $(AQFHE)$, $(BFEC)$, $(ABC)$.\n  Ironically, this fact is not used in the solution.\n\\end{remark*}\n\n\\paragraph{Second solution (barycentric coordinates).}\nAgain note first $R \\in \\ol{BC}$ (although this can be avoided too).\nWe compute the points in much the same way as before.\nSince $\\ol{AP} \\cap \\ol{BC} = (0 : b^2 : -c^2)$\nwe have \\[ P = \\left( b^2-c^2 : b^2 : -c^2  \\right) \\]\n(since $x=y+z$ is the equation of line $\\ol{MN}$).\nNow in Conway notation we have\n\\[ R = \\ol{EF} \\cap \\ol{BC} = (0 : S_C : -S_B)\n  =\\left( 0 : a^2+b^2-c^2 : -a^2+b^2-c^2 \\right). \\]\nHence\n\\[ \\overrightarrow{PR}\n  = \\frac{1}{2(b^2-c^2)} \\left( b^2-c^2 , c^2-a^2 , a^2-b^2 \\right).  \\]\nOn the other hand, we have\n$\\overrightarrow{OH} = \\vec A + \\vec B + \\vec C$.\nSo it suffices to check that\n\\[ \\sum_{\\text{cyc}} a^2\\left( (a^2-b^2) + (c^2-a^2) \\right) = 0 \\]\nwhich is immediate.\n\n\\paragraph{Third solution (complex numbers).}\nLet $ABC$ be the unit circle.\nWe first compute $P$ as the midpoint of $A$ and $\\ol{AA} \\cap \\ol{BC}$:\n\\begin{align*}\n  p &= \\half \\left( a + \\frac{a^2(b+c)-bc\\cdot2a}{a^2-bc} \\right) \\\\\n  &= \\frac{a(a^2-bc)+a^2(b+c)-2abc}{2(a^2-bc)}.\n\\end{align*}\nUsing the remark above, $R$ is the inverse of $D$ with\nrespect to the circle with diameter $\\ol{BC}$,\nwhich has radius $\\left\\lvert \\half(b-c) \\right\\rvert$.\nThus\n\\begin{align*}\n  r - \\frac{b+c}{2}\n  &= \\frac{\\frac14(b-c)\\left( \\frac1b-\\frac1c \\right)}%\n  {\\ol{\\half\\left( a-\\frac{bc}{a} \\right)}} \\\\\n  r &= \\frac{b+c}{2}\n  + \\frac{-\\half \\frac{(b-c)^2}{bc}}{\\frac1a-\\frac{a}{bc}} \\\\\n  &= \\frac{b+c}{2} + \\frac{a(b-c)^2}{2(a^2-bc)} \\\\\n  &= \\frac{a(b-c)^2+(b+c)(a^2-bc)}{2(a^2-bc)}.\n\\end{align*}\nExpanding and subtracting gives\n\\[ p-r = \\frac{a^3-abc-ab^2-ac^2+b^2c+bc^2}{2(a^2-bc)}\n  = \\frac{(a+b+c)(a-b)(a-c)}{2(a^2-bc)} \\]\nwhich is visibly equal to the negation of its conjugate\nonce the factor of $a+b+c$ is deleted.\n\n(Actually, one can guess this factorization ahead of time\nby noting that if $A=B$, then $P=B=R$, so $a-b$ must be a factor;\nanalogously $a-c$ must be as well.)\n\\pagebreak", "category": "Geometry", "source": "TSTST", "year": 2017}
{"id": "tstst-2017-q2", "question": "Ana and Banana are playing a game. First Ana picks a word,\nwhich is defined to be a nonempty sequence of capital English letters.\nThen Banana picks a nonnegative integer $k$ and challenges Ana\nto supply a word with exactly $k$ subsequences which are equal to Ana's word.\nAna wins if she is able to supply such a word, otherwise she loses.\nFor example, if Ana picks the word ``TST'', and Banana chooses $k = 4$,\nthen Ana can supply the word ``TSTST'' which has $4$ subsequences\nwhich are equal to Ana's word.\nWhich words can Ana pick so that she can win no matter what value of\n$k$ Banana chooses?", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p8526115}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nAna and Banana are playing a game. First Ana picks a word,\nwhich is defined to be a nonempty sequence of capital English letters.\nThen Banana picks a nonnegative integer $k$ and challenges Ana\nto supply a word with exactly $k$ subsequences which are equal to Ana's word.\nAna wins if she is able to supply such a word, otherwise she loses.\nFor example, if Ana picks the word ``TST'', and Banana chooses $k = 4$,\nthen Ana can supply the word ``TSTST'' which has $4$ subsequences\nwhich are equal to Ana's word.\nWhich words can Ana pick so that she can win no matter what value of\n$k$ Banana chooses?\n\\end{mdframed}\nFirst we introduce some notation.\nDefine a \\emph{block} of letters to be a maximal\ncontiguous subsequence of consecutive letters.\nFor example, the word $AABBBCAAA$ has four blocks, namely $AA$, $BBB$, $C$, $AAA$.\nThroughout the solution, we fix the word $A$ that Ana picks,\nand introduce the following notation for its $m$ blocks:\n\\[ A =\n  A_1 A_2 \\dots A_m\n  = \\underbrace{a_1 \\dots a_1}_{x_1}\n  \\underbrace{a_2 \\dots a_2}_{x_2}\n  \\dots\n  \\underbrace{a_m \\dots a_m}_{x_m}.\n\\]\nA \\emph{rainbow} will be a subsequence equal to Ana's initial word $A$\n(meaning Ana seeks words with exactly $k$ rainbows).\nFinally, for brevity, let $A_i = \\underbrace{a_i \\dots a_i}_{x_i}$,\nso $A = A_1 \\dots A_m$.\n\nWe prove two claims that resolve the problem.\n\\begin{claim*}\n  If $x_i = 1$ for some $i$, then for any $k \\ge 1$, the word\n  \\[ W = A_1 \\dots A_{i-1} \\underbrace{a_i \\dots a_i}_{k} A_{i+1} \\dots A_m  \\]\n  obtained by repeating the $i$th letter $k$ times\n  has exactly $k$ rainbows.\n\\end{claim*}\n\\begin{proof}\n  Obviously there are at least $\\binom{k}{k-1}=k$ rainbows,\n  obtained by deleting $k-1$ choices of the letter $a_i$\n  in the repeated block.\n  We show they are the only ones.\n\n  Given a rainbow, consider the location of this singleton block in $W$.\n  It cannot occur within the first $|A_1| + \\dots + |A_{i-1}|$ letters,\n  nor can it occur within the final $|A_{i+1}| + \\dots + |A_m|$ letters.\n  So it must appear in the $i$th block of $W$.\n  That implies that all the other $a_i$'s in the\n  $i$th block of $W$ must be deleted, as desired.\n  (This last argument is actually nontrivial, and has some substance;\n  many students failed to realize that the upper bound requires care.)\n\\end{proof}\n\n\\begin{claim*}\n  If $x_i \\ge 2$ for all $i$, then no word $W$ has exactly two rainbows.\n\\end{claim*}\n\\begin{proof}\n  We prove if there are two rainbows of $W$, then we can construct\n  at least three rainbows.\n\n  Let $W = w_1 \\dots w_n$ and consider the two rainbows of $W$.\n  Since they are not the same, there must be a block $A_p$ of the rainbow,\n  of length $\\ell \\ge 2$, which do not occupy the same locations in $W$.\n\n  Assume the first rainbow uses $w_{i_1}$, \\dots, $w_{i_\\ell}$ for this block\n  and the second rainbow uses $w_{j_1}$, \\dots, $w_{j_\\ell}$ for this block.\n  Then among the letters $w_q$ for\n  $\\min(i_1, j_1) \\le q \\le \\max(i_\\ell, j_\\ell)$,\n  there must be at least $\\ell+1$ copies of the letter $a_p$.\n  Moreover, given a choice of $\\ell$ copies of the letter $a_p$\n  in this range, one can complete the subsequence to a rainbow.\n  So the number of rainbows is at least $\\binom{\\ell+1}{\\ell} \\ge \\ell+1$.\n\n  Since $\\ell \\ge 2$, this proves $W$ has at least three rainbows.\n\\end{proof}\n\nIn summary, Ana wins if and only if $x_i = 1$ for some $i$,\nsince she can duplicate the isolated letter $k$ times;\nbut if $x_i \\ge 2$ for all $i$ then Banana only needs to supply $k = 2$.\n\\pagebreak", "category": "Combinatorics", "source": "TSTST", "year": 2017}
{"id": "tstst-2017-q3", "question": "Consider solutions to the equation\n\\[ x^2 - cx + 1 = \\frac{f(x)}{g(x)} \\]\nwhere $f$ and $g$ are nonzero polynomials with nonnegative real coefficients.\nFor each $c > 0$, determine the minimum possible degree of $f$, or show\nthat no such $f$, $g$ exist.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p8526130}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nConsider solutions to the equation\n\\[ x^2 - cx + 1 = \\frac{f(x)}{g(x)} \\]\nwhere $f$ and $g$ are nonzero polynomials with nonnegative real coefficients.\nFor each $c > 0$, determine the minimum possible degree of $f$, or show\nthat no such $f$, $g$ exist.\n\\end{mdframed}\nFirst, if $c \\ge 2$ then we claim no such $f$ and $g$ exist.\nIndeed, one simply takes $x=1$ to get $f(1)/g(1) \\le 0$, impossible.\n\nFor $c < 2$, let $c = 2 \\cos \\theta$, where $0 < \\theta < \\pi$.\nWe claim that $f$ exists and has minimum degree equal to $n$,\nwhere $n$ is defined as the smallest integer\nsatisfying $\\sin n\\theta \\le 0$.\nIn other words\n\\[ n = \\left\\lceil \\frac{\\pi}{\\arccos(c/2)} \\right\\rceil. \\]\n\nFirst we show that this is necessary.\nTo see it, write explicitly\n\\[ g(x) = a_0 + a_1 x + a_2 x^2 + \\dots + a_{n-2} x^{n-2} \\]\nwith each $a_i \\ge 0$, and $a_{n-2} \\neq 0$.\nAssume that $n$ is such that $\\sin(k\\theta) \\ge 0$ for $k=1,\\dots,n-1$.\nThen, we have the following system of inequalities:\n\\begin{align*}\n  a_1 &\\ge 2 \\cos \\theta \\cdot a_0 \\\\\n  a_0 + a_2 &\\ge 2 \\cos \\theta \\cdot a_1 \\\\\n  a_1 + a_3 &\\ge 2 \\cos \\theta \\cdot a_2 \\\\\n  &\\vdots \\\\\n  a_{n-5} + a_{n-3} &\\ge 2 \\cos \\theta \\cdot a_{n-4} \\\\\n  a_{n-4} + a_{n-2} &\\ge 2 \\cos \\theta \\cdot a_{n-3} \\\\\n  a_{n-3} &\\ge 2 \\cos \\theta \\cdot a_{n-2}.\n\\end{align*}\nNow, multiply the first equation by $\\sin\\theta$,\nthe second equation by $\\sin2\\theta$, et cetera,\nup to $\\sin\\left( (n-1)\\theta \\right)$.\nThis choice of weights is selected since we have\n\\[ \\sin \\left( k\\theta \\right) + \\sin\\left( (k+2)\\theta \\right)\n  = 2 \\sin\\left( (k+1)\\theta \\right) \\cos \\theta \\]\nso that summing the entire expression\ncancels nearly all terms and leaves only\n\\[ \\sin\\left( (n-2)\\theta \\right) a_{n-2}\n  \\ge \\sin\\left( (n-1)\\theta  \\right) \\cdot 2\\cos\\theta \\cdot a_{n-2} \\]\nand so by dividing by $a_{n-2}$ and using the same identity\ngives us $\\sin(n\\theta) \\le 0$, as claimed.\n\nThis bound is best possible, because the example\n\\[ a_k = \\sin\\left( (k+1)\\theta \\right) \\ge 0 \\]\nmakes all inequalities above sharp, hence giving\na working pair $(f,g)$.\n\n\\begin{remark*}\nCalvin Deng points out that a cleaner proof of the lower bound\nis to take $\\alpha = \\cos \\theta + i \\sin \\theta$.\nThen $f(\\alpha) = 0$, but by condition the imaginary part of $f(\\alpha)$\nis apparently strictly positive, contradiction.\n\\end{remark*}\n\n\n\\begin{remark*}\n  Guessing that $c < 2$ works at all (and realizing $c \\ge 2$ fails)\n  is the first part of the problem.\n\n  The introduction of trigonometry into the solution may seem magical,\n  but is motivated in one of two ways:\n  \\begin{itemize}\n    \\ii Calvin Deng points out that it's possible to\n    guess the answer from small cases:\n    For $c \\le 1$ we have $n = 3$, tight at $\\frac{x^3+1}{x+1} = x^2-x+1$,\n    and essentially the ``sharpest $n=3$ example''.\n    A similar example exists at $n = 4$ with\n    $\\frac{x^4+1}{x^2+\\sqrt 2 x+1} = x^2-\\sqrt2x+1$\n    by the Sophie-Germain identity.\n    In general, one can do long division to extract\n    an optimal value of $c$ for any given $n$,\n    although $c$ will be the root of some polynomial.\n\n    The thresholds $c \\le 1$ for $n = 3$, $c \\le \\sqrt 2$ for $n = 4$,\n    $c \\le \\frac{1+\\sqrt5}{2}$ for $n = 5$,\n    and $c \\le 2$ for $n < \\infty$ suggest the unusual form of the\n    answer via trigonometry.\n\n    \\ii One may imagine trying to construct a polynomial\n    recursively / greedily by making all inequalities above hold\n    (again the ``sharpest situation'' in which $f$ has few coefficients).\n    If one sets $c = 2t$, then we have\n    \\[ a_0 = 1, \\quad a_1 = 2t, \\quad a_2 = 4t^2-1, \\quad\n      a_3 = 8t^3-4t, \\quad \\dots \\]\n    which are the Chebyshev polynomials of the second type.\n    This means that trigonometry is essentially mandatory.\n    (One may also run into this when by using standard linear recursion techniques,\n    and noting that the characteristic polynomial\n    has two conjugate complex roots.)\n  \\end{itemize}\n\\end{remark*}\n\n\\begin{remark*}\n  Mitchell Lee notes that an IMO longlist problem from 1997 shows that\n  if $P(x)$ is any polynomial satisfying $P(x) > 0$ for $x > 0$,\n  then $(x+1)^n P(x)$ has nonnegative coefficients\n  for large enough $n$.\n  This show that $f$ and $g$ at least exist for $c \\le 2$,\n  but provides no way of finding the best possible $\\deg f$.\n\n  Meghal Gupta also points out that showing $f$ and $g$ exist\n  is possible in the following way:\n  \\[ \\left( x^2-1.99x+1 \\right) \\left( x^2+1.99x+1 \\right)\n    = \\left( x^4 - 1.9601x^2 + 1 \\right) \\]\n  and so on, repeatedly multiplying by the ``conjugate''\n  until all coefficients become positive.\n  To my best knowledge, this also does not give any way\n  of actually minimizing $\\deg f$,\n  although Ankan Bhattacharya points out that this construction\n  is actually optimal in the case where $n$ is a power of $2$.\n\\end{remark*}\n\n\\begin{remark*}\n  It's pointed out that Matematicheskoe Prosveshchenie, issue 1, 1997, page 194\n  contains a nearly analogous result,\n  available at \\url{https://mccme.ru/free-books/matpros/pdf/mp-01.pdf}\n  with solutions presented in \\url{https://mccme.ru/free-books/matpros/pdf/mp-05.pdf},\n  pages 221--223;\n  and \\url{https://mccme.ru/free-books/matpros/pdf/mp-10.pdf}, page 274.\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Algebra", "source": "TSTST", "year": 2017}
{"id": "tstst-2017-q4", "question": "Find all nonnegative integer solutions to \\[ 2^a + 3^b + 5^c = n!. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p8526131}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all nonnegative integer solutions to \\[ 2^a + 3^b + 5^c = n!. \\]\n\\end{mdframed}\nFor $n \\le 4$, one can check the only solutions are:\n\\begin{align*}\n  2^2 + 3^0 + 5^0 &= 3! \\\\\n  2^1 + 3^1 + 5^0 &= 3! \\\\\n  2^4 + 3^1 + 5^1 &= 4!.\n\\end{align*}\nNow we prove there are no solutions for $n \\ge 5$.\n\nA tricky way to do this is to take modulo $120$, since\n\\begin{align*}\n  2^a \\pmod{120} &\\in \\{ 1, 2, 4, 8, 16, 32, 64 \\} \\\\\n  3^b \\pmod{120} &\\in \\{ 1, 3, 9, 27, 81 \\} \\\\\n  5^c \\pmod{120} &\\in \\{ 1, 5, 25 \\}\n\\end{align*}\nand by inspection one notes that no three\nelements have vanishing sum modulo $120$.\n\nI expect most solutions to instead use casework.\nHere is one possible approach with cases (with $n \\ge 5$).\nFirst, we analyze the cases where $a < 3$:\n\\begin{itemize}\n  \\ii $a=0$: No solutions for parity reasons.\n  \\ii $a=1$: since $3^b + 5^c \\equiv 6 \\pmod 8$,\n  we find $b$ even and $c$ odd (hence $c \\neq 0$).\n  Now looking modulo $5$ gives that $3^b + 5^c \\equiv 3 \\pmod 5$,\n  \\ii $a=2$: From $3^b + 5^c \\equiv 4 \\pmod 8$,\n  we find $b$ is odd and $c$ is even.\n  Now looking modulo $5$ gives a contradiction,\n  even if $c = 0$,\n  since $3^b \\in \\{2,3 \\pmod 5\\}$ but $3^b + 5^c \\equiv 1 \\pmod 5$.\n\\end{itemize}\nHenceforth assume $a \\ge 3$.\nNext, by taking modulo $8$ we have $3^b+5^c \\equiv 0 \\pmod 8$,\nwhich forces both $b$ and $c$ to be odd (in particular, $b,c > 0$).\nWe now have\n\\begin{align*}\n  2^a + 5^c &\\equiv 0 \\pmod 3 \\\\\n  2^a + 3^b &\\equiv 0 \\pmod 5.\n\\end{align*}\nThe first equation implies $a$ is even,\nbut the second equation requires $a$ to be odd, contradiction.\nHence no solutions with $n \\ge 5$.\n\\pagebreak", "category": "Number Theory", "source": "TSTST", "year": 2017}
{"id": "tstst-2017-q5", "question": "Let $ABC$ be a triangle with incenter $I$.\nLet $D$ be a point on side $BC$ and let $\\omega_B$ and $\\omega_C$\nbe the incircles of $\\triangle ABD$ and $\\triangle ACD$, respectively.\nSuppose that $\\omega_B$ and $\\omega_C$ are tangent to segment $BC$\nat points $E$ and $F$, respectively.\nLet $P$ be the intersection of segment $AD$ with the\nline joining the centers of $\\omega_B$ and $\\omega_C$.\nLet $X$ be the intersection point of lines $BI$ and $CP$\nand let $Y$ be the intersection point of lines $CI$ and $BP$.\nProve that lines $EX$ and $FY$ meet on the incircle of $\\triangle ABC$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p8526136}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle with incenter $I$.\nLet $D$ be a point on side $BC$ and let $\\omega_B$ and $\\omega_C$\nbe the incircles of $\\triangle ABD$ and $\\triangle ACD$, respectively.\nSuppose that $\\omega_B$ and $\\omega_C$ are tangent to segment $BC$\nat points $E$ and $F$, respectively.\nLet $P$ be the intersection of segment $AD$ with the\nline joining the centers of $\\omega_B$ and $\\omega_C$.\nLet $X$ be the intersection point of lines $BI$ and $CP$\nand let $Y$ be the intersection point of lines $CI$ and $BP$.\nProve that lines $EX$ and $FY$ meet on the incircle of $\\triangle ABC$.\n\\end{mdframed}\n\\paragraph{First solution (homothety).}\nLet $Z$ be the diametrically opposite point on the incircle.\nWe claim this is the desired intersection.\n\n\\begin{center}\n\\begin{asy}\npair A = dir(110);\npair B = dir(210);\npair C = dir(330);\n\nfilldraw(A--B--C--cycle, opacity(0.1)+lightred, red);\nfilldraw(incircle(A, B, C), opacity(0.1)+lightcyan, lightblue);\n\npair D = 0.35*B+0.65*C;\ndraw(A--D, red);\n\npair I_B = incenter(A, B, D);\npair I_C = incenter(A, C, D);\npair E = foot(I_B, B, C);\npair F = foot(I_C, B, C);\n\nfilldraw(incircle(A, B, D), opacity(0.1)+green, heavygreen);\nfilldraw(incircle(A, C, D), opacity(0.1)+green, heavygreen);\npair I = incenter(A, B, C);\n\npair P = extension(I_B, I_C, A, D);\ndraw(I_B--I_C, heavygreen);\n\npair X = extension(B, I, C, P);\npair Y = extension(C, I, B, P);\npair Z = extension(E, X, F, Y);\ndraw(B--I--C, red);\ndraw(X--C, dotted+heavygreen);\ndraw(Y--B, dotted+heavygreen);\ndraw(E--Z--F, dashed+heavygreen);\n\npair T = extension(B, C, I_B, I_C);\ndraw(I_C--T, dotted+heavygreen);\ndraw(C--T, dotted+red);\npair W = foot(I, B, C);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(270));\ndot(\"$C$\", C, dir(270));\ndot(\"$D$\", D, dir(D));\ndot(\"$I_B$\", I_B, dir(170));\ndot(\"$I_C$\", I_C, dir(30));\ndot(\"$E$\", E, dir(E));\ndot(\"$F$\", F, dir(F));\ndot(\"$I$\", I, dir(90));\ndot(\"$P$\", P, dir(250));\ndot(\"$X$\", X, dir(160));\ndot(\"$Y$\", Y, dir(20));\ndot(\"$Z$\", Z, dir(140));\ndot(\"$T$\", T, dir(T));\ndot(\"$W$\", W, dir(W));\n\n/* TSQ Source:\n\nA = dir 110\nB = dir 210 R270\nC = dir 330 R270\n\nA--B--C--cycle 0.1 lightred / red\nincircle A B C 0.1 lightcyan / lightblue\n\nD = 0.35*B+0.65*C\nA--D red\n\nI_B = incenter A B D R170\nI_C = incenter A C D R30\nE = foot I_B B C\nF = foot I_C B C\n\nincircle A B D 0.1 green / heavygreen\nincircle A C D 0.1 green / heavygreen\nI = incenter A B C R90\n\nP = extension I_B I_C A D R250\nI_B--I_C heavygreen\n\nX = extension B I C P R160\nY = extension C I B P R20\nZ = extension E X F Y R140\nB--I--C red\nX--C dotted heavygreen\nY--B dotted heavygreen\nE--Z--F dashed heavygreen\n\nT = extension B C I_B I_C\nI_C--T dotted heavygreen\nC--T dotted red\nW = foot I B C\n\n*/\n\\end{asy}\n\\end{center}\n\nNote that:\n\\begin{itemize}\n  \\ii $P$ is the insimilicenter of $\\omega_B$ and $\\omega_C$\n  \\ii $C$ is the exsimilicenter of $\\omega$ and $\\omega_C$.\n\\end{itemize}\nThus by Monge theorem, the insimilicenter of $\\omega_B$ and $\\omega$\nlies on line $CP$.\n\nThis insimilicenter should also lie on the line joining the\ncenters of $\\omega$ and $\\omega_B$, which is $\\ol{BI}$,\nhence it coincides with the point $X$.\nSo $X \\in \\ol{EZ}$ as desired.\n\n\\paragraph{Second solution (harmonic).}\nLet $T = \\ol{I_B I_C} \\cap \\ol{BC}$, and $W$ the foot from $I$ to $\\ol{BC}$.\nDefine $Z = \\ol{FY} \\cap \\ol{IW}$.\nBecause $\\angle I_B D I_C = 90\\dg$, we have\n\\[ -1 = (I_B I_C; PT) \\overset{B}{=} (I I_C; YC)\n  \\overset{F}{=} (I\\infty; ZW) \\]\nSo $I$ is the midpoint of $\\ol{ZW}$ as desired.\n\n\\paragraph{Third solution (outline, barycentric, Andrew Gu).}\nLet $AD = t$, $BD = x$, $CD = y$, so $a=x+y$ and by Stewart's theorem we have\n\\begin{equation}\n  (x+y)(xy+t^2) = b^2x+c^2y.\n  \\label{eq:17TSTST5stewart}\n\\end{equation}\nWe then have $D = (0:y:x)$ and so\n\\[ \\ol{AI_B} \\cap \\ol{BC} = \\left( 0 : y + \\frac{tx}{c+t} : \\frac{cx}{c+t} \\right) \\]\nhence intersection with $BI$ gives\n\\begin{align*}\n  I_B &= (ax : cy+at : cx).\n  \\intertext{Similarly,}\n  I_C &= (ay : by : bx+at).\n\\end{align*}\n\nThen, we can compute\n\\[ P = \\left( 2axy : y(at+bx+cy) : x(at+bx+cy) \\right) \\]\nsince $P \\in \\ol{I_B I_C}$, and clearly $P \\in \\ol{AD}$.\nIntersection now gives\n\\begin{align*}\n  X &= \\left( 2ax : at+bx+cy : 2cx \\right) \\\\\n  Y &= \\left( 2ay : 2by : at+bx+cy \\right).\n\\end{align*}\n\nFinally, we have $BE = \\half(c+x-t)$, and similarly for $CF$.\nNow if we reflect\n$D = (0, \\frac{s-c}{a}, \\frac{s-b}{a})$ over\n$I = (\\frac{a}{2s}, \\frac{b}{2s}, \\frac{c}{2s})$, we get the antipode\n\\[ Q \\coloneq \\left( 4a^2 : -a^2+2ab-b^2+c^2 : -a^2+2ac-c^2+b^2 \\right). \\]\nWe may then check $Q$ lies on each of lines $EX$ and $FY$\n(by checking $\\det(Q,E,X)=0$ using the equation \\eqref{eq:17TSTST5stewart}).\n\\pagebreak", "category": "Geometry", "source": "TSTST", "year": 2017}
{"id": "tstst-2017-q6", "question": "A sequence of positive integers $(a_{n})_{n \\geq 1}$ is of\n\\emph{Fibonacci type} if it satisfies the recursive relation\n$a_{n+2}=a_{n+1}+a_{n}$ for all $n \\geq 1$.\nIs it possible to partition the set of positive integers\ninto an infinite number of Fibonacci type sequences?", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p8526142}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA sequence of positive integers $(a_{n})_{n \\geq 1}$ is of\n\\emph{Fibonacci type} if it satisfies the recursive relation\n$a_{n+2}=a_{n+1}+a_{n}$ for all $n \\geq 1$.\nIs it possible to partition the set of positive integers\ninto an infinite number of Fibonacci type sequences?\n\\end{mdframed}\nYes, it is possible.\nThe following solutions were written for me by Kevin Sun and Mark Sellke.\nWe let $F_1 = F_2 = 1$, $F_3 = 2$, $F_4 = 3$, $F_5 = 5$, \\dots\ndenote the Fibonacci numbers.\n\n\\paragraph{First solution (Kevin Sun).}\nWe are going to appeal to the so-called Zeckendorf theorem:\n\\begin{theorem*}\n  [Zeckendorf]\n  Every positive integer can be uniquely expressed\n  as the sum of nonconsecutive Fibonacci numbers.\n\\end{theorem*}\nThis means every positive integer has a\nZeckendorf (``Fibonacci-binary'') representation\nwhere we put $1$ in the $i$th digit from the right\nif $F_{i+1}$ is used.\nThe idea is then to take the following so-called \\emph{Wythoff array}:\n\\begin{itemize}\n  \\ii \\textbf{Row 1}: $1$, $2$, $3$, $5$, \\dots\n  \\ii \\textbf{Row 101}: $1+3$, $2+5$, $3+8$, \\dots\n  \\ii \\textbf{Row 1001}: $1+5$, $2+8$, $3+13$, \\dots\n  \\ii \\textbf{Row 10001}: $1+8$, $2+13$, $3+21$, \\dots\n  \\ii \\textbf{Row 10101}: $1+3+8$, $2+5+13$, $3+8+21$, \\dots\n  \\ii \\dots et cetera.\n\\end{itemize}\nMore concretely, the array has the following rows to start:\n\\[\n\\begin{matrix}\n1&2&3&5&8&13&21&\\dotsb\\\\\n4&7&11&18&29&47&76&\\dotsb\\\\\n6&10&16&26&42&68&110&\\dotsb\\\\\n9&15&24&39&63&102&165&\\dotsb\\\\\n12&20&32&52&84&136&220&\\dotsb\\\\\n14&23&37&60&97&157&254&\\dotsb\\\\\n17&28&45&73&118&191&309&\\dotsb\\\\\n\\vdots&\\vdots&\\vdots&\\vdots&\\vdots&\\vdots&\\vdots&\\ddots\\\\\n\\end{matrix}.\n\\]\n\nHere are the full details.\n\nWe begin by outlining a proof of Zeckendorf's theorem,\nwhich implies the representation above is unique.\nNote that if $F_k$ is the greatest Fibonacci number at most $n$,\nthen \\[n - F_k < F_{k+1} - F_{k} = F_{k-1}.\\]\nIn particular, repeatedly subtracting off the largest $F_k$\nfrom $n$ will produce one such representation with\nno two consecutive Fibonacci numbers.\nOn the other hand, this $F_k$ must be used, as\n\\[ n \\ge F_k > F_{k-1} + F_{k-3} + F_{k-5} + \\dotsb \\]\nThis shows, by a simple inductive argument,\nthat such a representation exists and unique.\n\nWe write $n = \\ol{a_k\\dotso a_1}_{\\text{Fib}}$\nfor the Zeckendorf representation as we described\n(where $a_i = 1$ if $F_{i+1}$ is used).\nNow for each $\\ol{a_k\\dotso a_1}_{\\text{Fib}}$\nwith $a_1 = 1$, consider the sequence\n\\[ \\ol{a_k\\dotso a_1}_{\\text{Fib}}, \\;\n  \\ol{a_k\\dotso a_1 0}_{\\text{Fib}}, \\;\n  \\ol{a_k\\dotso a_1 00}_{\\text{Fib}}, \\; \\dots \\]\nThese sequences are Fibonacci-type by definition,\nand partition the positive integers since\neach positive integer has exactly one Fibonacci base representation.\n\n\\paragraph{Second solution.} Call an infinite set of integers $S$ \\textit{sandwiched} if there exist increasing sequences $\\{a_i\\}_{i=0}^{\\infty}, \\{b_i\\}_{i=0}^{\\infty}$ such that the following are true:\n\\begin{itemize}\n\\item $a_i + a_{i+1} = a_{i+2}$ and $b_i + b_{i+1} = b_{i+2}$.\n\\item The intervals $[a_i+1,b_i-1]$ are disjoint and are nondecreasing in length.\n\\item $\\displaystyle S = \\bigcup_{i=0}^{\\infty} [a_i+1,b_i-1]$.\n\\end{itemize}\n\nWe claim that if $S$ is any nonempty sandwiched set, then $S$ can be partitioned into a Fibonacci-type sequence (involving the smallest element of $S$) and two smaller sandwiched sets. If this claim is proven, then we can start with $\\NN \\setminus \\{1,2,3,5,\\dots\\}$, which is a sandwiched set, and repeatedly perform this partition, which will eventually sort each natural number into a Fibonacci-type sequence.\n\nLet $S$ be a sandwiched set given by $\\{a_i\\}_{i=0}^{\\infty}, \\{b_i\\}_{i=0}^{\\infty}$, so the smallest element in $S$ is $x = a_0 + 1$. Note that $y = a_1+1$ is also in $S$ and $x < y$. Then consider the Fibonacci-type sequence given by $f_0 = x, f_1 = y$, and $f_{k+2} = f_{k+1} + f_k$. We can then see that $f_i \\in [a_i+1,b_i-1]$, as the sum of numbers in the intervals $[a_{k}+1,b_{k}-1]$, $[a_{k+1}+1,b_{k+1}-1]$ lies in the interval \\[[a_{k} + a_{k+1} + 2,b_k + b_{k+1}-2] = [a_{k+2}+2,b_{k+2}-2] \\subset [a_{k+2}+1,b_{k+2}-1].\\]\n\nTherefore, this gives a natural partition of $S$ into this sequence and two sets: \\begin{align*} S_1 &= \\bigcup_{i=0}^{\\infty} [a_i+1,f_i-1] \\\\ \\text{and} \\,\\, S_2 &= \\bigcup_{i=0}^{\\infty} [f_i+1,b_i-1].\\end{align*} (For convenience, $[x,x-1]$ will be treated as the empty set.)\n\nWe now show that $S_1$ and $S_2$ are sandwiched. Since $\\{a_i\\}$, $\\{f_i\\}$, and $\\{b_i\\}$ satisfy the Fibonacci recurrence, it is enough to check that the intervals have nondecreasing lengths. For $S_1$, that is equivalent to $f_{k+1} - a_{k+1} \\ge f_k - a_k$ for each $k$. Fortunately, for $k \\ge 1$, the difference is $f_{k-1} - a_{k-1} \\ge 0$, and for $k = 0$, $f_1 - a_1 = 1 = f_0 - a_0$. Similarly for $S_2$, checking $b_{k+1} - f_{k+1} \\ge b_k - f_k$ is easy for $k \\ge 1$ as $b_{k-1} - f_{k-1} \\ge 0$, and \\[(b_{1} - f_1) - (b_0 - f_0) = (b_1 - a_1) - (b_0 - a_0),\\] which is nonnegative since the lengths of intervals in $S$ are nondecreasing.\n\nTherefore we have shown that $S_1$ and $S_2$ are sandwiched. (Note that some of the $[a_i+1,f_i-1]$ may be empty, which would shift some indices back.) Since this gives us a procedure to take a set $S$ and produce a Fibonacci-type sequence with its smallest element, along which two other sandwiched types, we can partition $\\NN$ into an infinite number of Fibonacci-type sequences.\n\n\\paragraph{Third solution.} We add Fibonacci-type sequences one-by-one. At each step, let $x$ be the smallest number that has not been used in any previous sequence. We generate a new Fibonacci-type sequence as follows. Set $a_0 = x$ and for $i \\ge 1$, set \\[a_i = \\left \\lfloor \\varphi a_{i-1} + \\frac{1}{2} \\right \\rfloor.\\] Equivalently, $a_{i}$ is the closest integer to $\\varphi a_{i-1}$. \\\\\nIt suffices to show that this sequence is Fibonacci-type and that no two sequences generated in this way overlap.\nWe first show that for a positive integer $n$, \\[\\left \\lfloor \\varphi \\left \\lfloor \\varphi n + \\frac{1}{2} \\right \\rfloor + \\frac{1}{2} \\right \\rfloor = n + \\left \\lfloor \\varphi n + \\frac{1}{2} \\right \\rfloor . \\]\nIndeed, \\begin{align*} \\left \\lfloor \\varphi \\left \\lfloor \\varphi n + \\frac{1}{2} \\right \\rfloor + \\frac{1}{2} \\right \\rfloor &= \\left \\lfloor (1 + \\varphi^{-1}) \\left \\lfloor \\varphi n + \\frac{1}{2} \\right \\rfloor + \\frac{1}{2}\\right \\rfloor \\\\\n&= \\left \\lfloor \\varphi n + \\frac{1}{2} \\right \\rfloor + \\left \\lfloor \\varphi^{-1} \\left \\lfloor \\varphi n + \\frac{1}{2}\\right \\rfloor + \\frac{1}{2} \\right \\rfloor.\n\\end{align*}\nNote that $\\left \\lfloor \\varphi n + \\frac{1}{2} \\right \\rfloor = \\varphi n + c$ for some $|c| \\le \\frac{1}{2}$; this implies that $\\varphi^{-1}\\left \\lfloor \\varphi n + \\frac{1}{2} \\right \\rfloor$ is within $\\varphi^{-1}\\cdot \\frac{1}{2} < \\frac{1}{2}$ of $n$, so its closest integer is $n$, proving the claim.\n\nTherefore these sequences are Fibonacci-type. Additionally, if $a \\neq b$, then $|\\varphi a - \\varphi b| \\ge \\varphi > 1$. Then \\[a \\neq b \\implies \\left \\lfloor \\varphi a + \\frac{1}{2} \\right \\rfloor \\neq \\left \\lfloor \\varphi b + \\frac{1}{2} \\right \\rfloor,\\]\nand since the first term of each sequence is chosen to not overlap with any previous sequences, these sequences are disjoint.\n\n\\begin{remark*}\n  Ankan Bhattacharya points out that the same sequence\n  essentially appears in IMO 1993, Problem 5 --- in other words,\n  a strictly increasing function $f \\colon \\ZZ_{>0} \\to \\ZZ_{>0}$ with $f(1) = 2$,\n  and $f(f(n)) = f(n) + n$.\n\n  Nikolai Beluhov sent us an older reference from March 1977,\n  where Martin Gardner wrote in his column about Wythoff's Nim.\n  The relevant excerpt goes:\n  \\begin{quote}\n    ``Imagine that we go through the infinite sequence of safe pairs (in\n    the manner of Eratosthenes' sieve for sifting out primes) and cross\n    out the infinite set of all safe pairs that are pairs in the Fibonacci\n    sequence. The smallest pair that is not crossed out is 4/7. We can now\n    cross out a second infinite set of safe pairs, starting with 4/7, that\n    are pairs in the Lucas sequence. An infinite number of safe pairs, of\n    which the lowest is now 6/10, remain. This pair too begins another\n    infinite Fibonacci sequence, all of whose pairs are safe. The process\n    continues forever. Robert Silber, a mathematician at North Carolina\n    State University, calls a safe pair ``primitive'' if it is the first\n    safe pair that generates a Fibonacci sequence.''\n  \\end{quote}\n  The relevant article by Robert Silber is\n  \\emph{A Fibonacci Property of Wythoff Pairs},\n  from The Fibonacci Quarterly 11/1976.\n\\end{remark*}\n\n\n\\paragraph{Fourth solution (Mark Sellke).}\nFor later reference let \\[ f_1=0, f_2=1, f_3=1, \\dots \\]\ndenote the ordinary Fibonacci numbers.\nWe will denote the Fibonacci-like sequences by $F^i$ and the elements with subscripts;\nhence $F^2_1$ is the first element of the second sequence.\nOur construction amounts to just iteratively add new sequences;\nhence the following claim is the whole problem.\n\n\\begin{lemma*}\n  For any disjoint collection of Fibonacci-like sequences\n  $F^1,\\dots,F^k$ and any integer $m$ contained in none of them,\n  there is a new Fibonacci-like sequence $F^{k+1}$ beginning\n  with $F^{k+1}_1=m$ which is disjoint from the previous sequences.\n\\end{lemma*}\n\nObserve first that for each sequence $F^j$ there is $c^j\\in \\RR^n$ such that\n\\[ F^j_n=c^j\\phi^n+o(1)  \\]\nwhere \\[\\phi=\\frac{1+\\sqrt{5}}{2}.\\]\n\nCollapse the group $(\\RR^+,\\times)$ into the half-open interval\n$J = \\left\\{ x \\mid 1 \\le x < \\phi \\right\\}$\nby defining $T(x)=y$ for the unique $y\\in J$ with $x=y\\phi^n$ for some integer $n$.\n\nFix an interval $I=[a,b]\\subseteq [1.2,1.3]$ (the last condition is to\navoid wrap-around issues) which contains none of the $c^j$, and take\n$\\varepsilon<0.001$ to be small enough that in fact each $c^j$ has\ndistance at least $10\\varepsilon$ from $I$; this means any $c_j$ and\nelement of $I$ differ by at least a $(1+10\\varepsilon)$ factor. The idea\nwill be to take $F^{k+1}_1=m$ and $F^{k+1}_2$ to be a large such that\nthe induced values of $F^{k+1}_j$ grow like $k\\phi^j$ for $j\\in\nT^{-1}(I)$, so that $F^{k+1}_n$ is separated from the $c^j$ after\napplying $T$. What's left to check is the convergence.\n\nNow let \\[c=\\lim_{n\\to\\infty} \\frac{f_n}{\\phi^n}\\] and take\n$M$ large enough that for $n>M$ we have\n\\[\\left|\\frac{f_n}{c\\phi^n}-1\\right|<\\varepsilon.\\]\n\nNow $\\frac{T^{-1}(I)}{c}$ contains arbitrarily large integers,\nso there are infinitely many $N$ with $cN\\in T^{-1}(I)$ with $N>\\frac{10m}{\\varepsilon}$.\nWe claim that for any such $N$, the sequence $F^{(N)}$ defined by\n\\[F^{(N)}_1=m,F^{(N)}_2=N\\] will be very multiplicatively similar to the\nnormal Fibonacci numbers up to rescaling;\nindeed for $j=2,j=3$ we have $\\frac{F_2^{(N)}}{f_2}=N,\\frac{F_3^{(N)}}{f_3}=N+m$\nand so by induction we will have\n\\[ \\frac{F^{(N)}_j}{f_j} \\in [N,N+m] \\subseteq [N,N(1+\\varepsilon)] \\]\nfor $j\\geq 2$.\nTherefore, up to small multiplicative errors, we have\n\\[F_j^{(N)}\\approx Nf_j\\approx cN\\phi^j.\\]\nFrom this we see that for $j>M$ we have\n\\[T(F_j^{(N)})\\in  T(cN)\\cdot [1-2\\varepsilon,1+2\\varepsilon].\\]\nIn particular, since $T(cN)\\in I$ and $I$ is separated from each $c_j$\nby a factor of $(1+10\\varepsilon)$,\nwe get that $F_j^{(N)}$ is not in any of $F^1,F^2,\\dots,F^k$.\n\nFinishing is easy, since we now have a uniform estimate on how many\nterms we need to check for a new element before the exponential growth\ntakes over. We will just use pigeonhole to argue that there are few\npossible collisions among those early terms, so we can easily pick a\nvalue of $N$ which avoids them all. We write it out below.\n\nFor large $L$, the set \\[S_L=(I\\cdot \\phi^L)\\cap\\ZZ\\] contains at\nleast $k_I\\phi^L$ elements. As $N$ ranges over $S_L$, for each fixed\n$j$, the value of $F^{(N)}_j$ varies by at most a factor of $1.1$\nbecause we imposed $I\\subseteq [1.2,1.3]$ and so this is true for the\nfirst two terms, hence for all subsequent terms by induction. Now\nsuppose $L$ is very large, and consider a fixed pair $(i,j)$ with $i\\leq\nk$ and $j\\leq M$. We claim there is at most $1$ possible value $k$ such\nthat the term $F^i_k$ could equal $F^{(N)}_j$ for some $N\\in S_L$;\nindeed, the terms of $F^i$ are growing at exponential rate with factor\n$\\phi>1.1$, so at most one will be in a given interval of multiplicative\nwidth at most $1.1$.\n\nHence, of these $k_I\\phi^L$ values of $N$, at most $kM$ could cause\nproblems, one for each pair $(i,j)$. However by monotonicity of\n$F^{(N)}_j$ in $N$, at most $1$ value of $N$ causes a collision for each\npair $(i,j)$. Hence for large $L$ so that $k_I\\phi^L>10kM$ we can find a\nsuitable $N\\in S_L$ by pigeonhole and the sequence $F^{(N)}$ defined by\n$(m,N,N+m,\\dots)$ works.\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "TSTST", "year": 2017}
{"id": "tstst-2011-q1", "question": "Find all real-valued functions $f$ defined on pairs of real numbers,\nhaving the following property: for all real numbers $a, b, c$,\nthe median of $f(a,b), f(b,c), f(c,a)$ equals the median of $a, b, c$.\n\n(The \\emph{median} of three real numbers, not necessarily distinct,\nis the number that is in the middle when the three numbers\nare arranged in nondecreasing order.)", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2374841}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all real-valued functions $f$ defined on pairs of real numbers,\nhaving the following property: for all real numbers $a, b, c$,\nthe median of $f(a,b), f(b,c), f(c,a)$ equals the median of $a, b, c$.\n\n(The \\emph{median} of three real numbers, not necessarily distinct,\nis the number that is in the middle when the three numbers\nare arranged in nondecreasing order.)\n\\end{mdframed}\nThe following solution is joint with Andrew He.\n\nWe prove the following main claim,\nfrom which repeated applications can deduce the problem.\n\n\\begin{claim*}\n  Let $a < b < c$ be arbitrary. On $\\{a,b,c\\}^2$,\n  $f$ takes one of the following two forms,\n  where the column indicates the $x$-value\n  and the row indicates the $y$-value.\n  \\[\n   \\begin{array}{c|rrr}\n    f & a & b & c \\\\ \\hline\n    a & a & b & \\ge c \\\\\n    b & \\le a & b & \\ge c \\\\\n    c & \\le a & b & c\n   \\end{array}\n   \\qquad\n   \\text{or}\n   \\qquad\n   \\begin{array}{c|rrr}\n    f & a & b & c \\\\ \\hline\n    a & a & \\le a & \\le a \\\\\n    b & b & b & b \\\\\n    c & \\ge c & \\ge c & c\n   \\end{array}\n  \\]\n\\end{claim*}\n\\begin{proof}\n  First, we of course have $f(x,x) = x$ for all $x$.\n  Now:\n  \\begin{itemize}\n  \\ii By considering the assertion for $(a,a,c)$ and $(a,c,c)$\n  we see that one of $f(a,c)$ and $f(c,a)$ is $\\ge c$\n  and the other is $\\le a$.\n  \\ii Hence, by considering $(a,b,c)$ we find that\n  one of $f(a,b)$ and $f(b,c)$ must be $b$,\n  and similarly for $f(b,a)$ and $f(c,b)$.\n  \\ii Now, WLOG $f(b,a) = b$; we prove we get the first case.\n  \\ii By considering $(a,a,b)$ we deduce $f(a,b) \\le a$,\n  so $f(b,c) = b$ and then $f(c,b) \\ge c$.\n  \\ii Finally, considering $(c,b,a)$ once again\n  in conjunction with the first bullet, we arrive at the conclusion\n  that $f(a,c) \\le a$; similarly $f(c,a) \\ge c$.\n  \\qedhere\n  \\end{itemize}\n\\end{proof}\nFrom this it's easy to obtain that $f(x,y) \\equiv x$\nor $f(x,y) \\equiv y$ are the only solutions.\n\\pagebreak", "category": "Algebra", "source": "TSTST", "year": 2011}
{"id": "tstst-2011-q2", "question": "Two circles $\\omega_1$ and $\\omega_2$ intersect at points $A$ and $B$.\nLine $\\ell$ is tangent to $\\omega_1$ at $P$\nand to $\\omega_2$ at $Q$ so that $A$ is closer to $\\ell$ than $B$.\nLet $X$ and $Y$ be points on major arcs $\\arc{PA}$\n(on $\\omega_1$) and $\\arc{AQ}$ (on $\\omega_2$), respectively,\nsuch that $AX/PX = AY/QY = c$.\nExtend segments $PA$ and $QA$ through $A$ to $R$ and $S$,\nrespectively, such that $AR = AS = c\\cdot PQ$.\nGiven that the circumcenter of triangle $ARS$ lies on line $XY$,\nprove that $\\angle XPA = \\angle AQY$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2374843}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nTwo circles $\\omega_1$ and $\\omega_2$ intersect at points $A$ and $B$.\nLine $\\ell$ is tangent to $\\omega_1$ at $P$\nand to $\\omega_2$ at $Q$ so that $A$ is closer to $\\ell$ than $B$.\nLet $X$ and $Y$ be points on major arcs $\\arc{PA}$\n(on $\\omega_1$) and $\\arc{AQ}$ (on $\\omega_2$), respectively,\nsuch that $AX/PX = AY/QY = c$.\nExtend segments $PA$ and $QA$ through $A$ to $R$ and $S$,\nrespectively, such that $AR = AS = c\\cdot PQ$.\nGiven that the circumcenter of triangle $ARS$ lies on line $XY$,\nprove that $\\angle XPA = \\angle AQY$.\n\\end{mdframed}\nWe begin as follows:\n\\begin{claim*}\n  There is a spiral similarity centered at $X$ mapping $AR$ to $PQ$.\n  Similarly there is a spiral similarity centered at $Y$ mapping $SA$ to $PQ$.\n\\end{claim*}\n\\begin{proof}\n  Since $\\dang XAR = \\dang XAP = \\dang XPQ$,\n  and $AR/AX = PQ/PX$ is given.\n\\end{proof}\nNow the composition of the two spiral similarities\n\\[ AR \\xmapsto{X} PQ \\xmapsto{Y} SA \\]\nmust be a rotation, since $AR = AS$.\nThe center of this rotation must coincide with the circumcenter $O$ of $\\triangle ARS$,\nwhich is known to lie on line $XY$.\n\n\\begin{center}\n\\begin{asy}\nimport graph; size(10cm);\npen uququq = rgb(0.25098,0.25098,0.25098); pen zzttqq = rgb(0.6,0.2,0.);\ndraw((13.97096,-7.13004)--(20.23013,-5.53182)--(27.19232,-12.23004)--cycle, linewidth(0.6) + zzttqq);\ndraw(circle((25.,-3.), 9.48683), linewidth(0.6) + uququq);\ndraw(circle((13.,-3.), 4.24264), linewidth(0.6) + uququq);\n\ndraw((13.97096,-7.13004)--(16.,0.), linewidth(0.6) + red);\ndraw((13.97096,-7.13004)--(11.14589,0.81605), linewidth(0.6) + red);\ndraw((11.14589,0.81605)--(25.35640,-1.57297), linewidth(0.6) + blue);\ndraw((27.19232,-12.23004)--(20.85410,5.53296), linewidth(0.6) + red);\ndraw((27.19232,-12.23004)--(16.,0.), linewidth(0.6) + red);\ndraw((20.85410,5.53296)--(9.74299,-7.13207), linewidth(0.6) + blue);\ndraw((13.97096,-7.13004)--(20.23013,-5.53182), linewidth(0.6) + zzttqq);\ndraw((20.23013,-5.53182)--(27.19232,-12.23004), linewidth(0.6) + zzttqq);\ndraw((27.19232,-12.23004)--(13.97096,-7.13004), linewidth(0.6) + zzttqq);\ndraw((20.23013,-5.53182)--(19.26755,-9.17733), linewidth(0.6));\ndraw((11.14589,0.81605)--(20.85410,5.53296), linewidth(0.6));\ndot(\"$A$\", (16.,0.), dir(100));\ndot(\"$Q$\", (20.85410,5.53296), dir(120));\ndot(\"$P$\", (11.14589,0.81605), dir(120));\ndot(\"$X$\", (13.97096,-7.13004), dir(280));\ndot(\"$Y$\", (27.19232,-12.23004), dir(280));\ndot(\"$R$\", (25.35640,-1.57297), dir((8.043, 16.110)));\ndot(\"$S$\", (9.74299,-7.13207), dir(225));\ndot(\"$O$\", (19.26755,-9.17733), dir(45));\ndot(\"$O'$\", (20.23013,-5.53182), dir(135));\n\\end{asy}\n\\end{center}\n\nAs $O$ is a fixed-point of the composed map above,\nwe may let $O'$ be the image of $O$ under the rotation at $X$,\nso that\n\\[ \\triangle XPA \\overset{+}{\\sim} \\triangle XO'O, \\qquad\n  \\triangle YQA \\overset{+}{\\sim} \\triangle YO'O. \\]\nBecause\n\\[ \\frac{XO}{XO'} = \\frac{XA}{XP} = c \\frac{YQ}{YA} = \\frac{YO}{YO'} \\]\nit follows $\\ol{O'O}$ bisects $\\angle XO'Y$.\nFinally, we have\n\\[ \\dang XPA = \\dang XO'O = \\dang OO'Y = \\dang AQY. \\]\n\n\\begin{remark*}\n  Indeed, this also shows $\\ol{XP} \\parallel \\ol{YQ}$; so the positive homothety\n  from $\\omega_1$ to $\\omega_2$ maps $P$ to $Q$ and $X$ to $Y$.\n\\end{remark*}\n\\pagebreak", "category": "Geometry", "source": "TSTST", "year": 2011}
{"id": "tstst-2011-q3", "question": "Prove that there exists a real constant $c$\nsuch that for any pair $(x,y)$ of real numbers,\nthere exist relatively prime integers $m$ and $n$\nsatisfying the relation\n\\[ \\sqrt{(x-m)^2 + (y-n)^2} < c \\log(x^2+y^2+2). \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2374845}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nProve that there exists a real constant $c$\nsuch that for any pair $(x,y)$ of real numbers,\nthere exist relatively prime integers $m$ and $n$\nsatisfying the relation\n\\[ \\sqrt{(x-m)^2 + (y-n)^2} < c \\log(x^2+y^2+2). \\]\n\\end{mdframed}\nThis is actually the same problem as USAMO 2014/6. Surprise!\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Geometry", "source": "TSTST", "year": 2011}
{"id": "tstst-2011-q4", "question": "Acute triangle $ABC$ is inscribed in circle $\\omega$.\nLet $H$ and $O$ denote its orthocenter and circumcenter, respectively.\nLet $M$ and $N$ be the midpoints of sides $AB$ and $AC$, respectively.\nRays $MH$ and $NH$ meet $\\omega$ at $P$ and $Q$, respectively.\nLines $MN$ and $PQ$ meet at $R$.\nProve that $\\ol{OA} \\perp \\ol{RA}$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2374848}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nAcute triangle $ABC$ is inscribed in circle $\\omega$.\nLet $H$ and $O$ denote its orthocenter and circumcenter, respectively.\nLet $M$ and $N$ be the midpoints of sides $AB$ and $AC$, respectively.\nRays $MH$ and $NH$ meet $\\omega$ at $P$ and $Q$, respectively.\nLines $MN$ and $PQ$ meet at $R$.\nProve that $\\ol{OA} \\perp \\ol{RA}$.\n\\end{mdframed}\nLet $MH$ and $NH$ meet the nine-point circle again at $P'$ and $Q'$, respectively.\nRecall that $H$ is the center of the homothety between\nthe circumcircle and the nine-point circle.\nFrom this we can see that $P$ and $Q$ are the images of this homothety, meaning that\n\\[ HQ = 2HQ' \\quad\\text{and}\\quad HP = 2HP'. \\]\nSince $M$, $P'$, $Q'$, $N$ are cyclic, Power of a Point gives us\n\\[ MH \\cdot HP' = HN \\cdot HQ'. \\]\nMultiplying both sides by two, we thus derive\n\\[ HM \\cdot HP = HN \\cdot HQ. \\]\nIt follows that the points $M$, $N$, $P$, $Q$ are concyclic.\n\n\\begin{center}\n  \\begin{asy}\n    size(11cm);\n    defaultpen(fontsize(8pt));\n    pair A = dir(110);\n    pair B = dir(210);\n    pair C = dir(330);\n    pair H = A+B+C;\n    pair O = circumcenter(A, B, C);\n    pair M = midpoint(A--B);\n    pair N = midpoint(A--C);\n    pair U = -C;\n    pair V = -B;\n    pair P = -U+2*foot(O, U, H);\n    pair Q = -V+2*foot(O, V, H);\n    pair R = extension(M, N, P, Q);\n\n    draw(A--B--C--cycle, blue);\n    draw(unitcircle, blue);\n    draw(M--P);\n    draw(N--Q);\n    draw(circumcircle(M, N, midpoint(B--C)), green);\n    draw(circumcircle(P, Q, M), red+dashed);\n    draw(P--R--A);\n    draw(R--N, dotted);\n    draw(circumcircle(A, M, N), dashed);\n\n    pair Qp = midpoint(H--Q);\n    pair Pp = midpoint(H--P);\n\n    dot(\"$A$\", A, dir(A));\n    dot(\"$B$\", B, dir(250));\n    dot(\"$C$\", C, dir(C));\n    dot(\"$H$\", H, dir(-90));\n    dot(\"$O$\", O, dir(315));\n    dot(\"$M$\", M, 1.4*dir(150));\n    dot(\"$N$\", N, dir(20));\n    dot(\"$P$\", P, dir(P));\n    dot(\"$Q$\", Q, dir(Q));\n    dot(\"$R$\", R, dir(R));\n    dot(\"$Q'$\", Qp, dir(255));\n    dot(\"$P'$\", Pp, dir(Pp));\n\n    /* Source generated by TSQ */\n  \\end{asy}\n\\end{center}\n\nLet $\\omega_1$, $\\omega_2$, $\\omega_3$ denote the circumcircles of\n$MNPQ$, $AMN$, and $ABC$, respectively.\nThe radical axis of $\\omega_1$ and $\\omega_2$ is line $MN$, while the\nradical axis of $\\omega_1$ and $\\omega_3$ is line $PQ$.\nHence the line $R$ lies on the radical axis of $\\omega_2$ and $\\omega_3$.\n\nBut we claim that $\\omega_2$ and $\\omega_3$ are internally tangent at $A$.\nThis follows by noting the homothety at $A$ with ratio $2$ sends\n$M$ to $B$ and $N$ to $C$.\nHence the radical axis of $\\omega_2$ and $\\omega_3$ is a line tangent to\nboth circles at $A$.\n\nHence $\\ol{RA}$ is tangent to $\\omega_3$.\nTherefore, $\\ol{RA} \\perp \\ol{OA}$.\n\\pagebreak", "category": "Geometry", "source": "TSTST", "year": 2011}
{"id": "tstst-2011-q5", "question": "At a certain orphanage, every pair of orphans are either friends or enemies.\nFor every three of an orphan's friends,\nan even number of pairs of them are enemies.\nProve that it's possible to assign each orphan two parents\nsuch that every pair of friends shares exactly one parent,\nno pair of enemies shares any parents,\nand no three parents are in a love triangle (where each pair of them has a child).", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2374849}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nAt a certain orphanage, every pair of orphans are either friends or enemies.\nFor every three of an orphan's friends,\nan even number of pairs of them are enemies.\nProve that it's possible to assign each orphan two parents\nsuch that every pair of friends shares exactly one parent,\nno pair of enemies shares any parents,\nand no three parents are in a love triangle (where each pair of them has a child).\n\\end{mdframed}\nOf course, we consider the graph with vertices as children and edges as friendships.\nConsider all the maximal cliques in the graph.\n\n\\begin{claim*}\nEvery vertex is in at most two maximal cliques.\n\\end{claim*}\n\n\\begin{proof}\n  Indeed, consider a vertex $v$ adjacent to $w_1$ and $w_2$,\n  but with $w_1$ not adjacent to $w_2$.\n  Then by condition, any third vertex $u$\n  must be adjacent to exactly one of $w_1$ and $w_2$.\n  Moreover, given vertices $u$ and $u'$ adjacent to $w_1$,\n  vertices $u$ and $u'$ are adjacent too.\n  This proves the claim.\n\\end{proof}\n\nNow, for every maximal clique we assign a particular parent to all vertices in that clique,\nadding in additional distinct parents if there are any deficient children.\nThis satisfies the friendship/enemy condition.\nMoreover, one can readily check that there are no love triangles:\ngiven children $a$, $b$, $c$ such that $a$ and $b$ share a parent\nwhile $a$ and $c$ share another parent,\naccording to the claim $b$ and $c$ can't share a third parent.\nThis completes the problem.\n\n\\begin{remark*}\n  This solution is highly motivated for the following reason:\n  by experimenting with small cases,\n  one quickly finds that given some vertices which form a clique,\n  one \\emph{must} assign some particular parent to all vertices in that clique.\n  That is, the requirements of the problem are sufficiently rigid\n  that there is no room for freedom on our part,\n  so we know \\emph{a priori} that an assignment based on cliques\n  (as above) must work.\n  From there we know exactly what to prove,\n  and everything else follows through.\n\n  Ironically, the condition that there be no love triangle\n  actually makes the problem easier, because it tells us exactly what to do!\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "TSTST", "year": 2011}
{"id": "tstst-2011-q6", "question": "Let $a,b,c$ be real numbers in the interval $[0,1]$\nwith $a+b,b+c,c+a \\ge 1$.  Prove that\n\\[ 1 \\le (1-a)^2 + (1-b)^2 + (1-c)^2\n  + \\frac{2\\sqrt2 abc}{\\sqrt{a^2+b^2+c^2}}. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2374852}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a,b,c$ be real numbers in the interval $[0,1]$\nwith $a+b,b+c,c+a \\ge 1$.  Prove that\n\\[ 1 \\le (1-a)^2 + (1-b)^2 + (1-c)^2\n  + \\frac{2\\sqrt2 abc}{\\sqrt{a^2+b^2+c^2}}. \\]\n\\end{mdframed}\nThe following approach is due to Ashwin Sah.\n\nWe will prove the inequality for any $a$, $b$, $c$\nthe sides of a possibly degenerate triangle\n(which is implied by the condition),\nignoring the particular constant $1$.\nHomogenizing, we instead prove the problem\nin the following form:\n\\begin{claim*}\n  We have\n  \\[ k^2 \\le (k-a)^2 + (k-b)^2 + (k-c)^2\n    + \\frac{2\\sqrt2 abc}{\\sqrt{a^2+b^2+c^2}} \\]\n  for any $a$, $b$, $c$, $k$\n  with $(a,b,c)$ the sides of a\n  possibly degenerate triangle.\n\\end{claim*}\n\\begin{proof}\n  For any particular $(a,b,c)$ this is a quadratic in $k$\n  of the form $2k^2 - 2(a+b+c)k + C \\ge 0$;\n  thus we will verify it holds for $k = \\half(a+b+c)$.\n\n  Letting $x = \\half(b+c-a)$ as is usual,\n  the problem rearranges to\n  In that case, the problem amounts to\n  \\[ (x+y+z)^2 \\le x^2+y^2+z^2\n    + \\frac{2(x+y)(y+z)(z+x)}{\\sqrt{x^2+y^2+z^2+xy+yz+zx}} \\]\n  or equivalently\n  \\[ x^2+y^2+z^2+xy+yz+zx\n    \\le \\left( \\frac{(x+y)(y+z)(z+x)}{xy+yz+zx} \\right)^2. \\]\n  To show this, one may let $t = xy+yz+zx$,\n  then using $(x+y)(x+z) = x^2+B$ this becomes\n  \\[ t^2(x^2+y^2+z^2+t)\n    \\le (x^2+t)(y^2+t)(z^2+t) \\]\n  which is obvious upon expansion.\n\\end{proof}\n\n\\begin{remark*}\n  The inequality holds actually for\n  all real numbers $a$, $b$, $c$,\n  with very disgusting proofs.\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 3}", "category": "Geometry", "source": "TSTST", "year": 2011}
{"id": "tstst-2011-q7", "question": "Let $ABC$ be a triangle.\nIts excircles touch sides $BC$, $CA$, $AB$ at $D$, $E$, $F$.\nProve that the perimeter of triangle $ABC$ is\nat most twice that of triangle $DEF$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2374855}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle.\nIts excircles touch sides $BC$, $CA$, $AB$ at $D$, $E$, $F$.\nProve that the perimeter of triangle $ABC$ is\nat most twice that of triangle $DEF$.\n\\end{mdframed}\nSolution by August Chen:\nIt turns out that it is enough to take the\northogonal projection of $EF$ onto side $BC$\n(which has length $a-(s-a)(\\cos B + \\cos C)$)\nand sum cyclically:\n\\begin{align*}\n  -s + \\sum_{\\text{cyc}} EF &\\ge\n  -s +\n  \\sum_{\\text{cyc}}\n  \\left[ a - (s-a)\\left( \\cos B + \\cos C \\right) \\right] \\\\\n  &= s - \\sum_{\\text{cyc}} a \\cos A\n    = \\sum_{\\text{cyc}} a \\left( \\half - \\cos A \\right) \\\\\n  &= R \\sum_{\\text{cyc}}\n  \\sin A (1 - 2 \\cos A) \\\\\n  &= R \\sum_{\\text{cyc}} \\left( \\sin A - \\sin2A \\right).\n\\end{align*}\nThus we're done upon noting that\n\\[ \\frac{\\sin2B + \\sin2C}{2} = \\sin(B+C) \\cos(B-C)\n  = \\sin A \\cos(B-C) \\le \\sin A. \\]\n(Alternatively, one can avoid trigonometry by substituting\n$\\cos A = \\frac{b^2+c^2-a^2}{2bc}$\nand doing some routine but long calculation.)\n\\pagebreak", "category": "Geometry", "source": "TSTST", "year": 2011}
{"id": "tstst-2011-q8", "question": "Let $x_0$, $x_1$, \\dots, $x_{n_0-1}$ be integers,\nand let $d_1$, $d_2$, \\dots, $d_k$ be positive integers\nwith $n_0 = d_1 > d_2 > \\dotsb > d_k$ and\n$\\gcd(d_1, d_2, \\dots, d_k) = 1$.\nFor every integer $n \\geq n_0$, define\n\\[ x_n = \\left\\lfloor \\frac{x_{n-d_1} + x_{n-d_2}\n  + \\dots + x_{n-d_k}}{k} \\right\\rfloor. \\]\nShow that the sequence $(x_n)$ is eventually constant.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2374856}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $x_0$, $x_1$, \\dots, $x_{n_0-1}$ be integers,\nand let $d_1$, $d_2$, \\dots, $d_k$ be positive integers\nwith $n_0 = d_1 > d_2 > \\dotsb > d_k$ and\n$\\gcd(d_1, d_2, \\dots, d_k) = 1$.\nFor every integer $n \\geq n_0$, define\n\\[ x_n = \\left\\lfloor \\frac{x_{n-d_1} + x_{n-d_2}\n  + \\dots + x_{n-d_k}}{k} \\right\\rfloor. \\]\nShow that the sequence $(x_n)$ is eventually constant.\n\\end{mdframed}\nNote that if the initial terms are contained\nin some interval $[A,B]$ then they will remain in that interval.\nThus the sequence is eventually periodic.\nDiscard initial terms and let the period be $T$;\nwe will consider all indices modulo $T$ from now on.\n\nLet $M$ be the maximal term in the sequence\n(which makes sense since the sequence is periodic).\nNote that if $x_n = M$, we must have\n$x_{n-d_i} = M$ for all $i$ as well.\nBy taking a linear combination $\\sum c_i d_i \\equiv 1 \\pmod T$\n(possibly be Bezout's theorem, since $\\gcd_i(d_i)=1$),\nwe conclude $x_{n-1} = M$, as desired.\n\\pagebreak", "category": "Number Theory", "source": "TSTST", "year": 2011}
{"id": "tstst-2011-q9", "question": "Let $n$ be a positive integer.\nSuppose we are given $2^n+1$ distinct sets,\neach containing finitely many objects.\nPlace each set into one of two categories, the red sets and the blue sets,\nso that there is at least one set in each category.\nWe define the \\textit{symmetric difference} of two sets as\nthe set of objects belonging to exactly one of the two sets.\nProve that there are at least $2^n$ different sets which\ncan be obtained as the symmetric difference of a red set and a blue set.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2374857}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n$ be a positive integer.\nSuppose we are given $2^n+1$ distinct sets,\neach containing finitely many objects.\nPlace each set into one of two categories, the red sets and the blue sets,\nso that there is at least one set in each category.\nWe define the \\textit{symmetric difference} of two sets as\nthe set of objects belonging to exactly one of the two sets.\nProve that there are at least $2^n$ different sets which\ncan be obtained as the symmetric difference of a red set and a blue set.\n\\end{mdframed}\nWe can interpret the problem as working with\nbinary strings of length $\\ell \\ge n+1$,\nwith $\\ell$ the number of elements across all sets.\n\nLet $F$ be a field of cardinality $2^\\ell$,\nhence $F \\cong \\FF_2^{\\oplus \\ell}$.\n\nThen, we can think of red/blue as elements of $F$,\nso we have some $B \\subseteq F$, and an $R \\subseteq F$.\nWe wish to prove that $|B+R| \\ge 2^n$.\nWant $|B + R| \\ge 2^n$.\n\nEquivalently, any element of a set $X$ with $|X| = 2^n - 1$\nshould omit some element of $|B+R|$.\nTo prove this: we know $|B| + |R| = 2^n+1$, and define\n\\[ P(b,r) = \\prod_{x \\in X} (b+r-x). \\]\nConsider $b^{|B|-1} r^{|R|-1}$.\nThe coefficient of is $\\binom{2^n-1}{|B|-1}$,\nwhich is odd (say by Lucas theorem),\nso the nullstellensatz applies.\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "TSTST", "year": 2011}
{"id": "imo-2016-q1", "question": "In convex pentagon $ABCDE$ with $\\angle B > 90\\dg$,\nlet $F$ be a point on $\\ol{AC}$ such that $\\angle FBC = 90\\dg$.\nIt is given that $FA=FB$, $DA=DC$, $EA=ED$,\nand rays $\\ol{AC}$ and $\\ol{AD}$ trisect $\\angle BAE$.\nLet $M$ be the midpoint of $\\ol{CF}$.\nLet $X$ be the point such that $AMXE$ is a parallelogram.\nShow that $\\ol{FX}$, $\\ol{EM}$, $\\ol{BD}$ are concurrent.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6637656}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nIn convex pentagon $ABCDE$ with $\\angle B > 90\\dg$,\nlet $F$ be a point on $\\ol{AC}$ such that $\\angle FBC = 90\\dg$.\nIt is given that $FA=FB$, $DA=DC$, $EA=ED$,\nand rays $\\ol{AC}$ and $\\ol{AD}$ trisect $\\angle BAE$.\nLet $M$ be the midpoint of $\\ol{CF}$.\nLet $X$ be the point such that $AMXE$ is a parallelogram.\nShow that $\\ol{FX}$, $\\ol{EM}$, $\\ol{BD}$ are concurrent.\n\\end{mdframed}\nHere is a ``long'' solution which I think\nshows where the ``power'' in the configuration comes from\n(it should be possible to come up with shorter solutions\nby cutting more directly to the desired conclusion).\nThroughout the proof, we let\n\\[ \\theta = \\angle FAB = \\angle FBA = \\angle DAC = \\angle DCA\n  = \\angle EAD = \\angle EDA. \\]\n\nWe begin by focusing just on $ABCD$ with point $F$,\nignoring for now the points $E$ and $X$\n(and to some extent even point $M$).\nIt turns out this is a very familiar configuration.\n\\begin{lemma*}\n  [Central lemma]\n  The points $F$ and $C$\n  are the incenter and $A$-excenter of $\\triangle DAB$.\n  Moreover, $\\triangle DAB$ is isosceles with $DA = DB$.\n\\end{lemma*}\n\\begin{proof}\n  The proof uses three observations:\n  \\begin{itemize}\n  \\ii We already know that $\\ol{FAC}$ is the angle bisector of $\\angle ABD$.\n  \\ii We were given $\\angle FBC = 90\\dg$.\n  \\ii Next, note that $\\triangle AFB \\sim \\triangle ADC$\n  (they are similar isosceles triangles).\n  From this it follows that $AF \\cdot AC = AB \\cdot AD$.\n  \\end{itemize}\n  These three facts, together with $F$ lying inside $\\triangle ABD$,\n  are enough to imply the result.\n\\end{proof}\n\\begin{center}\n  \\begin{asy}\n  pair F = dir(157);\n  pair C = -F;\n  pair B = conj(F);\n  pair M = origin;\n  pair A = dir(F-C)*abs(F-B)+F;\n\n  pair t(pair X) { return A + (X-A) * (F-A) / (B-A); }\n\n  pair D = t(C);\n\n  filldraw(A--F--B--cycle, opacity(0.1)+red, gray);\n  filldraw(A--C--D--cycle, opacity(0.1)+orange, gray);\n  filldraw(F--B--C--cycle, opacity(0.1)+lightcyan, gray);\n\n  draw(circumcircle(A, B, D), orange+dashed);\n  draw(circumcircle(B, C, F), orange+dashed);\n  draw(B--D, gray);\n  draw(F--D, gray);\n  draw(A--B--D--cycle, black+0.8);\n\n  dot(\"$F$\", F, dir(115));\n  dot(\"$C$\", C, dir(C));\n  dot(\"$B$\", B, dir(B));\n  dot(\"$M$\", M, dir(280));\n  dot(\"$A$\", A, dir(A));\n  dot(\"$D$\", D, dir(60));\n\n  /* TSQ Source:\n\n  F = dir 157 R115\n  C = -F\n  B = conj(F)\n  M = origin R280\n  A = dir(F-C)*abs(F-B)+F\n\n  !pair t(pair X) { return A + (X-A) * (F-A) / (B-A); }\n\n  D = t(C) R60\n\n  A--F--B--cycle 0.1 red / gray\n  A--C--D--cycle 0.1 orange / gray\n  F--B--C--cycle 0.1 lightcyan / gray\n\n  circumcircle A B D orange dashed\n  circumcircle B C F orange dashed\n  B--D gray\n  F--D gray\n  A--B--D--cycle black+0.8\n\n  */\n  \\end{asy}\n  \\end{center}\n\n\n\\begin{corollary*}\n  The point $M$ is the midpoint of arc $\\widehat{BD}$ of $(DAB)$,\n  and the center of cyclic quadrilateral $FDCB$.\n\\end{corollary*}\n\\begin{proof}\n  Fact 5.\n\\end{proof}\n\nUsing these observations as the anchor\nfor everything that follows,\nwe now prove several claims about $X$ and $E$ in succession.\n\\begin{center}\n\\begin{asy}\npair F = dir(157);\npair C = -F;\npair B = conj(F);\npair M = origin;\npair A = dir(F-C)*abs(F-B)+F;\n\npair t(pair X) { return A + (X-A) * (F-A) / (B-A); }\n\npair D = t(C);\npair E = t(D);\n\npair X = E+M-A;\n\ndraw(E--F, lightgreen);\ndraw(D--M, lightgreen);\ndraw(B--D, lightblue);\ndraw(F--X, lightblue);\ndraw(M--E, lightblue);\n\nfilldraw(A--F--B--cycle, opacity(0.1)+red, gray);\nfilldraw(A--C--D--cycle, opacity(0.1)+orange, gray);\nfilldraw(A--E--D--cycle, opacity(0.1)+yellow, gray);\nfilldraw(F--B--C--cycle, opacity(0.1)+lightcyan, gray);\n\ndraw(A--E--X--M--cycle, heavygreen);\n\ndraw(circumcircle(E, F, X), lightgreen+dashed);\ndraw(circumcircle(A, B, D), orange);\ndraw(circumcircle(B, C, F), orange);\n\ndot(\"$F$\", F, dir(45));\ndot(\"$C$\", C, dir(C));\ndot(\"$B$\", B, dir(B));\ndot(\"$M$\", M, dir(260));\ndot(\"$A$\", A, dir(A));\ndot(\"$D$\", D, dir(60));\ndot(\"$E$\", E, dir(E));\ndot(\"$X$\", X, dir(X));\n\n/* TSQ Source:\n\nF = dir 157 R45\nC = -F\nB = conj(F)\nM = origin R260\nA = dir(F-C)*abs(F-B)+F\n\n!pair t(pair X) { return A + (X-A) * (F-A) / (B-A); }\n\nD = t(C) R60\nE = t(D)\n\nX = E+M-A\n\nE--F lightgreen\nD--M lightgreen\nB--D lightblue\nF--X lightblue\nM--E lightblue\n\nA--F--B--cycle 0.1 red / gray\nA--C--D--cycle 0.1 orange / gray\nA--E--D--cycle 0.1 yellow / gray\nF--B--C--cycle 0.1 lightcyan / gray\n\nA--E--X--M--cycle heavygreen\n\ncircumcircle E F X lightgreen dashed\ncircumcircle A B D orange\ncircumcircle B C F orange\n\n*/\n\\end{asy}\n\\end{center}\n\n\\begin{claim*}\n  Point $E$ is the midpoint of arc $\\widehat{AD}$\n  in $(ABMD)$, and hence lies on ray $BF$.\n\\end{claim*}\n\\begin{proof}\n  This follows from\n  $\\angle EDA = \\theta = \\angle EBA$.\n\\end{proof}\n\n\n\\begin{claim*}\n  Points $X$ is the second intersection of ray $\\ol{ED}$\n  with $(BFDC)$.\n\\end{claim*}\n\\begin{proof}\n  First, $\\ol{ED} \\parallel \\ol{AC}$ already since\n  $\\angle AED = 180\\dg - 2\\theta$\n  and $\\angle CAE = 2\\theta$.\n\n  Now since $DB = DA$, we get $MB = MD = ED = EA$.\n  Thus, $MX = AE = MB$,\n  so $X$ also lies on the circle $(BFDC)$ centered at $M$.\n\\end{proof}\n\n\\begin{claim*}\n  The quadrilateral $EXMF$ is an isosceles trapezoid.\n\\end{claim*}\n\\begin{proof}\n  We already know $\\ol{EX} \\parallel \\ol{FM}$.\n  Since $\\angle EFA = 180\\dg - \\angle AFB = 2\\theta = \\angle FAE$,\n  we have $EF = EA$ as well (and $F \\neq A$).\n  As $EXMA$ was a parallelogram,\n  it follows $EXMF$ is an isosceles trapezoid.\n\\end{proof}\n\nThe problem then follows by radical axis theorem\non the three circles $(AEDMB)$, $(BFDXC)$ and $(EXMF)$.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2016}
{"id": "imo-2016-q2", "question": "Find all integers $n$ for which each cell of $n \\times n$ table\ncan be filled with one of the letters $I$, $M$ and $O$ in such a way that:\n\\begin{itemize}\n\\item In each row and column,  one third of the entries are $I$,\none third are $M$ and one third are $O$; and\n\\item in any diagonal, if the number of entries on the diagonal is a multiple of three,\nthen one third of the entries are $I$, one third are $M$ and one third are $O$.\n\\end{itemize}\nNote that an $n \\times n$ table has $4n-2$ diagonals.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6637677}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all integers $n$ for which each cell of $n \\times n$ table\ncan be filled with one of the letters $I$, $M$ and $O$ in such a way that:\n\\begin{itemize}\n\\item In each row and column,  one third of the entries are $I$,\none third are $M$ and one third are $O$; and\n\\item in any diagonal, if the number of entries on the diagonal is a multiple of three,\nthen one third of the entries are $I$, one third are $M$ and one third are $O$.\n\\end{itemize}\nNote that an $n \\times n$ table has $4n-2$ diagonals.\n\\end{mdframed}\nThe answer is $n$ divisible by $9$.\n\nFirst we construct $n=9$ and by extension every multiple of $9$.\n\\[\n \\begin{array}{|ccc|ccc|ccc|} \\hline\n  I & I & I & M & M & M & O & O & O \\\\\n  M & M & M & O & O & O & I & I & I \\\\\n  O & O & O & I & I & I & M & M & M \\\\\\hline\n  I & I & I & M & M & M & O & O & O \\\\\n  M & M & M & O & O & O & I & I & I \\\\\n  O & O & O & I & I & I & M & M & M \\\\\\hline\n  I & I & I & M & M & M & O & O & O \\\\\n  M & M & M & O & O & O & I & I & I \\\\\n  O & O & O & I & I & I & M & M & M \\\\\\hline\n \\end{array}\n\\]\n\nWe now prove $9 \\mid n$ is necessary.\n\nLet $n = 3k$, which divides the given grid into $k^2$ sub-boxes\n(of size $3 \\times 3$ each).\nWe say a multiset of squares $S$ is \\emph{clean} if\nthe letters distribute equally among them;\nnote that unions of clean multisets are clean.\n\nConsider the following clean sets (given to us by problem statement):\n\\begin{itemize}\n\\ii All columns indexed $2 \\pmod 3$,\n\\ii All rows indexed $2 \\pmod 3$, and\n\\ii All $4k-2$ diagonals mentioned in the problem.\n\\end{itemize}\nTake their union.\nThis covers the center of each box four times,\nand every other cell exactly once.\nWe conclude the set of $k^2$ center squares\nare clean, hence $3 \\mid k^2$ and so $9 \\mid n$,\nas desired.\n\nShown below is the sums over all diagonals only,\nand of the entire union.\n\\[\n \\begin{array}{|ccc|ccc|ccc|} \\hline\n  1 &   & 1 & 1 &   & 1 & 1 &   & 1 \\\\\n  & 2 &   &   & 2 &   &   & 2 &   \\\\\n  1 &   & 1 & 1 &   & 1 & 1 &   & 1 \\\\\\hline\n  1 &   & 1 & 1 &   & 1 & 1 &   & 1 \\\\\n  & 2 &   &   & 2 &   &   & 2 &   \\\\\n  1 &   & 1 & 1 &   & 1 & 1 &   & 1 \\\\\\hline\n  1 &   & 1 & 1 &   & 1 & 1 &   & 1 \\\\\n  & 2 &   &   & 2 &   &   & 2 &   \\\\\n  1 &   & 1 & 1 &   & 1 & 1 &   & 1 \\\\\\hline\n \\end{array}\n \\qquad\n \\begin{array}{|ccc|ccc|ccc|} \\hline\n    1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 \\\\\n    1 & 4 & 1 & 1 & 4 & 1 & 1 & 4 & 1 \\\\\n    1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 \\\\\\hline\n    1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 \\\\\n    1 & 4 & 1 & 1 & 4 & 1 & 1 & 4 & 1 \\\\\n    1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 \\\\\\hline\n    1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 \\\\\n    1 & 4 & 1 & 1 & 4 & 1 & 1 & 4 & 1 \\\\\n    1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 \\\\\\hline\n \\end{array}\n\\]\n\\pagebreak", "category": "Combinatorics", "source": "IMO", "year": 2016}
{"id": "imo-2016-q3", "question": "Let $P=A_1A_2\\dots A_k$ be a convex polygon in the plane.\nThe vertices $A_1$, $A_2$, \\dots, $A_k$ have integral coordinates\nand lie on a circle. Let $S$ be the area of $P$.\nAn odd positive integer $n$ is given such that\nthe squares of the side lengths of $P$ are integers divisible by $n$.\nProve that $2S$ is an integer divisible by $n$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6637660}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $P=A_1A_2\\dots A_k$ be a convex polygon in the plane.\nThe vertices $A_1$, $A_2$, \\dots, $A_k$ have integral coordinates\nand lie on a circle. Let $S$ be the area of $P$.\nAn odd positive integer $n$ is given such that\nthe squares of the side lengths of $P$ are integers divisible by $n$.\nProve that $2S$ is an integer divisible by $n$.\n\\end{mdframed}\nSolution by Jeck Lim:\nWe will prove the result just for $n = p^e$\nwhere $p$ is an odd prime and $e \\ge 1$.\nThe case $k=3$ is resolved by Heron's formula directly:\nwe have $S = \\frac14\\sqrt{2(a^2b^2 + b^2c^2 + c^2a^2) - a^4-b^4-c^4}$,\nso if $p^e \\mid \\gcd(a^2,b^2,c^2)$ then $p^{2e} \\mid S^2$.\n\nNow we show we can pick a diagonal and induct down on $k$ by using inversion.\n\nLet the polygon be $A_1 A_2 \\dots A_{k+1}$\nand suppose for contradiction that all sides are divisible by $p^e$\nbut no diagonals are.\nLet $O = A_{k+1}$ for notational convenience.\nBy applying inversion around $O$ with radius $1$,\nwe get the ``generalized Ptolemy theorem''\n\\[\n  \\frac{A_1A_2}{OA_1 \\cdot OA_2}\n  + \\frac{A_2A_3}{OA_2 \\cdot OA_3}\n  + \\dots\n  + \\frac{A_{k-1} A_k}{OA_{k-1} \\cdot OA_k}\n  = \\frac{A_1 A_k}{OA_1 \\cdot OA_k}\n\\]\nor, making use of square roots,\n\\[\n  \\sqrt{\\frac{A_1A_2^2}{OA_1^2 \\cdot OA_2^2}}\n  + \\sqrt{\\frac{A_2A_3^2}{OA_2^2 \\cdot OA_3^2}}\n  + \\dots\n  + \\sqrt{\\frac{A_{k-1} A_k^2}{OA_{k-1}^2 \\cdot OA_k^2}}\n  = \\sqrt{\\frac{A_1 A_k^2}{OA_1^2 \\cdot OA_k^2}}\n\\]\nSuppose $\\nu_p$ of all diagonals is strictly less than $e$.\nThen the relation becomes\n\\[ \\sqrt{q_1} + \\dots + \\sqrt{q_{k-1}} = \\sqrt q \\]\nwhere $q_i$ are positive rational numbers.\nSince there are no nontrivial relations between square roots\n(see \\href{https://qchu.wordpress.com/2009/07/02/square-roots-have-no-unexpected-linear-relationships/}{this link})\nthere is a positive rational number $b$\nsuch that $r_i = \\sqrt{q_i/b}$ and $r = \\sqrt{q/b}$\nare all rational numbers.\nThen\n\\[ \\sum r_i = r. \\]\nHowever, the condition implies that $\\nu_p(q_i^2) > \\nu_p(q^2)$ for all $i$\n(check this for $i=1$, $i=k-1$ and $2 \\le i \\le k-2$),\nand hence $\\nu_p(r_i) > \\nu_p(r)$.\nThis is absurd.\n\n\\begin{remark*}\n  I think you basically have to use some Ptolemy-like geometric property,\n  and also all correct solutions I know of for $n = p^e$\n  depend on finding a diagonal and inducting down.\n  (Actually, the case $k=4$ is pretty motivating;\n  Ptolemy implies one can cut in two.)\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Geometry", "source": "IMO", "year": 2016}
{"id": "imo-2016-q4", "question": "A set of positive integers is called \\emph{fragrant}\nif it contains at least two elements and each of its elements\nhas a prime factor in common with at least one of the other elements.\nLet $P(n)=n^2+n+1$.\nWhat is the smallest possible positive integer value of $b$ such that\nthere exists a non-negative integer $a$ for which the set\n\\[ \\{P(a+1),P(a+2),\\dots,P(a+b)\\} \\]\nis fragrant?", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6642559}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA set of positive integers is called \\emph{fragrant}\nif it contains at least two elements and each of its elements\nhas a prime factor in common with at least one of the other elements.\nLet $P(n)=n^2+n+1$.\nWhat is the smallest possible positive integer value of $b$ such that\nthere exists a non-negative integer $a$ for which the set\n\\[ \\{P(a+1),P(a+2),\\dots,P(a+b)\\} \\]\nis fragrant?\n\\end{mdframed}\nThe answer is $b = 6$.\n\nFirst, we prove $b \\ge 6$ must hold.\nIt is not hard to prove the following divisibilities by Euclid:\n\\begin{align*}\n \\gcd(P(n), P(n+1)) &\\mid 1 \\\\\n \\gcd(P(n), P(n+2)) &\\mid 7 \\\\\n \\gcd(P(n), P(n+3)) &\\mid 3 \\\\\n \\gcd(P(n), P(n+4)) &\\mid 19.\n\\end{align*}\nNow assume for contradiction $b \\le 5$.\nThen any GCD's among $P(a+1)$, \\dots, $P(a+b)$ must be among $\\{3, 7, 19\\}$.\nConsider a multi-graph on $\\{a+1, \\dots, a+b\\}$ where we join two elements with nontrivial GCD\nand label the edge with the corresponding prime.\nThen we readily see there is at most one edge each of $\\{3, 7, 19\\}$:\nid est at most one edge of gap $2$, $3$, $4$ (and no edges of gap $1$).\n(By the gap of an edge $e = \\{u,v\\}$ we mean $|u - v|$.)\nBut one can see that it's now impossible for every vertex to have nonzero degree, contradiction.\n\nTo construct $b = 6$ we use the Chinese remainder theorem: select $a$ with\n\\begin{align*}\n a+1 & \\equiv 7 \\pmod{19} \\\\\n a+5 & \\equiv 11 \\pmod{19} \\\\\n a+2 & \\equiv 2 \\pmod{7} \\\\\n a+4 & \\equiv 4 \\pmod{7} \\\\\n a+3 & \\equiv 1 \\pmod{3} \\\\\n a+6 & \\equiv 1 \\pmod{3}\n\\end{align*}\nwhich does the trick.\n\\pagebreak", "category": "Number Theory", "source": "IMO", "year": 2016}
{"id": "imo-2016-q5", "question": "The equation\n\\[ (x-1)(x-2)\\dots(x-2016)=(x-1)(x-2)\\dots (x-2016) \\]\nis written on the board, with $2016$ linear factors on each side.\nWhat is the least possible value of $k$ for which it is possible to\nerase exactly $k$ of these $4032$ linear factors so that at least\none factor remains on each side and the resulting equation\nhas no real solutions?", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6642565}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nThe equation\n\\[ (x-1)(x-2)\\dots(x-2016)=(x-1)(x-2)\\dots (x-2016) \\]\nis written on the board, with $2016$ linear factors on each side.\nWhat is the least possible value of $k$ for which it is possible to\nerase exactly $k$ of these $4032$ linear factors so that at least\none factor remains on each side and the resulting equation\nhas no real solutions?\n\\end{mdframed}\nThe answer is $2016$.\nObviously this is necessary in order to delete duplicated factors.\nWe now prove it suffices to deleted $2 \\pmod 4$ and $3 \\pmod 4$\nguys from the left-hand side, and $0 \\pmod 4$,\n$1 \\pmod 4$ from the right-hand side.\n\nConsider the $1008$ inequalities\n\\begin{align*}\n  (x-1)(x-4) &< (x-2)(x-3) \\\\\n  (x-5)(x-8) &< (x-6)(x-7) \\\\\n  (x-9)(x-12) &< (x-10)(x-11) \\\\\n  &\\vdots \\\\\n  (x-2013)(x-2016) &< (x-2014)(x-2015).\n\\end{align*}\nNotice that in all these inequalities, at most one of them\nhas non-positive numbers in it, and we never have both zero.\nIf there is exactly one negative term among the $1008 \\cdot 2 = 2016$ sides,\nit is on the left and we can multiply all together.\nThus the only case that remains is if $x \\in (4m-2, 4m-1)$ for some $m$,\nsay the $m$th inequality.\nIn that case, the two sides of that inequality differ by a factor of at least $9$.\n\n\\begin{claim*}\n  We have \\[ \\prod_{k \\ge 0} \\frac{(4k+2)(4k+3)}{(4k+1)(4k+4)} < e. \\]\n\\end{claim*}\n\\begin{proof}\n  [Proof of claim using logarithms]\n  It's equivalent to prove\n  \\[ \\sum_{k \\ge 0} \\log \\left( 1 + \\frac{2}{(4k+1)(4k+4)} \\right) < 1. \\]\n  To this end, we use the deep fact that $\\log(1+t) \\le t$,\n  and thus it follows from\n  $\\sum_{k \\ge 0} \\frac{1}{(4k+1)(4k+4)} < \\half$,\n  which one can obtain for example by noticing\n  it's less than $\\frac14\\frac{\\pi^2}{6}$.\n\\end{proof}\n\\begin{remark*}\n  [Elementary proof of claim, given by Espen Slettnes]\n  To avoid calculus as above, for each $N \\ge 0$, note the partial product is bounded by\n  \\begin{align*}\n    \\prod_{k=0}^N \\frac{(4k+2)(4k+3)}{(4k+1)(4k+4)}\n    &=\n    \\frac 21 \\cdot \\left( \\frac 34 \\cdot \\frac 65 \\right)\n      \\cdot \\left( \\frac 78 \\cdot \\frac{10}{9} \\right) \\cdot \\dots\n      \\cdot \\frac{4N+3}{4N+4} \\\\\n    &< 2 \\cdot 1 \\cdot 1 \\cdot \\dots \\cdot \\frac{4N+3}{4N+4}\n    < 2 < e. \\qedhere\n  \\end{align*}\n\\end{remark*}\n\nThis solves the problem, because then the factors being multiplied\non by the positive inequalities before the\n$m$th one are both less than $e$, and $e^2 < 9$.\nIn symbols, for $4m-2 < x < 4m-1$ we should have\n\\[ \\frac{(x-(4m-6))(x-(4m-5))}{(x-(4m-7))(x-(4m-4))}\n  \\times \\dots \\times \\frac{(x-2)(x-3)}{(x-1)(x-4)} < e \\]\nand\n\\[ \\frac{(x-(4m+2))(x-(4m+3))}{(x-(4m+1))(x-(4m+4))}\n  \\times \\dots \\times \\frac{(x-2014)(x-2015)}{(x-2013)(x-2016)} < e \\]\nbecause the $(k+1)$st term of each left-hand side\nis at most $\\frac{(4k+2)(4k+3)}{(4k+1)(4k+4)}$, for $k \\ge 0$.\nAs $e^2 < 9$, we're okay.\n\\pagebreak", "category": "Algebra", "source": "IMO", "year": 2016}
{"id": "imo-2016-q6", "question": "There are $n\\ge 2$ line segments in the plane such that\nevery two segments cross and no three segments meet at a point.\nGeoff has to choose an endpoint of each segment and place a frog\non it facing the other endpoint. Then he will clap his hands $n-1$ times.\nEvery time he claps, each frog will immediately jump forward\nto the next intersection point on its segment.\nFrogs never change the direction of their jumps.\nGeoff wishes to place the frogs in such a way that no two of them\nwill ever occupy the same intersection point at the same time.\n\n\\begin{enumerate}[(a)]\n  \\ii Prove that Geoff can always fulfill his wish if $n$ is odd.\n  \\ii Prove that Geoff can never fulfill his wish if $n$ is even.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6642576}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nThere are $n\\ge 2$ line segments in the plane such that\nevery two segments cross and no three segments meet at a point.\nGeoff has to choose an endpoint of each segment and place a frog\non it facing the other endpoint. Then he will clap his hands $n-1$ times.\nEvery time he claps, each frog will immediately jump forward\nto the next intersection point on its segment.\nFrogs never change the direction of their jumps.\nGeoff wishes to place the frogs in such a way that no two of them\nwill ever occupy the same intersection point at the same time.\n\n\\begin{enumerate}[(a)]\n  \\ii Prove that Geoff can always fulfill his wish if $n$ is odd.\n  \\ii Prove that Geoff can never fulfill his wish if $n$ is even.\n\\end{enumerate}\n\\end{mdframed}\nThe following solution was communicated to me by Yang Liu.\n\nImagine taking a larger circle $\\omega$ encasing\nall $\\binom{n}{2}$ intersection points.\nDenote by $P_1$, $P_2$, \\dots, $P_{2n}$ the order of the points on $\\omega$\nin clockwise order; we imagine placing the frogs on $P_i$ instead.\nObserve that, in order for every pair of segments to meet,\neach line segment must be of the form $P_i P_{i+n}$.\n\\begin{center}\n\\begin{asy}\n  draw(unitcircle);\n  pair P_1 = dir(100);\n  pair P_2 = dir(150);\n  pair P_3 = dir(190);\n  pair P_4 = dir(210);\n  pair P_5 = dir(280);\n  pair P_6 = dir(340);\n  pair P_7 = dir(2);\n  pair P_8 = dir(55);\n  dot(\"$1$\", P_1, dir(P_1));\n  dot(\"$2$\", P_2, dir(P_2));\n  dot(\"$3$\", P_3, dir(P_3));\n  dot(\"$4$\", P_4, dir(P_4));\n  dot(\"$5$\", P_5, dir(P_5));\n  dot(\"$6$\", P_6, dir(P_6));\n  dot(\"$7$\", P_7, dir(P_7));\n  dot(\"$8$\", P_8, dir(P_8));\n  draw(P_1--P_5);\n  draw(P_2--P_6);\n  draw(P_3--P_7);\n  draw(P_4--P_8);\n  dot(extension(P_1, P_5, P_2, P_6), red);\n  dot(extension(P_1, P_5, P_3, P_7), red);\n  dot(extension(P_1, P_5, P_4, P_8), red);\n  dot(extension(P_2, P_6, P_3, P_7), red);\n  dot(extension(P_2, P_6, P_4, P_8), red);\n  dot(extension(P_3, P_7, P_4, P_8), red);\n\\end{asy}\n\\end{center}\nThen:\n\\begin{enumerate}[(a)]\n  \\ii Place the frogs on $P_1$, $P_3$, \\dots, $P_{2n-1}$.\n  A simple parity arguments shows this works.\n\n  \\ii Observe that we cannot place frogs on consecutive $P_i$,\n  so the $n$ frogs must be placed on alternating points.\n  But since we also are supposed to not place frogs on\n  diametrically opposite points,\n  for even $n$ we immediately get a contradiction.\n\\end{enumerate}\n\n\\begin{remark*}\nYang says: this is easy to guess if you just do a\nfew small cases and notice that the pairs of\n``violating points'' just forms a large cycle around.\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "IMO", "year": 2016}
{"id": "putnam-2002-a1", "question": "Let $k$ be a fixed positive integer. The $n$-th derivative of\n$\\frac{1}{x^k - 1}$ has the form $\\frac{P_n(x)}{(x^k - 1)^{n+1}}$\nwhere $P_n(x)$ is a polynomial. Find $P_n(1)$.", "solution": "By differentiating $P_n(x)/(x^k-1)^{n+1}$, we find that\n$P_{n+1}(x) = (x^k-1)P_n'(x)-(n+1)kx^{k-1}P_n(x)$; substituting\n$x=1$ yields $P_{n+1}(1) = -(n+1)k P_n(1)$.  Since $P_0(1)=1$, an\neasy induction gives $P_n(1) = (-k)^n n!$ for all $n \\geq 0$.\n\nNote: one can also argue by expanding in Taylor series around $1$.\nNamely, we have\n\\[\n\\frac{1}{x^k - 1} = \\frac{1}{k(x-1) + \\cdots}\n= \\frac{1}{k} (x-1)^{-1} + \\cdots,\n\\]\nso\n\\[\n\\frac{d^n}{dx^n} \\frac{1}{x^k - 1}\n= \\frac{(-1)^n n!}{k (x-1)^{-n-1}}\n\\]\nand\n\\begin{align*}\nP_n(x) &= (x^k - 1)^{n+1} \\frac{d^n}{dx^n} \\frac{1}{x^k - 1} \\\\\n&= (k (x-1) + \\cdots)^{n+1} \\left( \\frac{(-1)^n n!}{k}(x-1)^{-n-1}\n+ \\cdots \\right) \\\\\n&= (-k)^n n! + \\cdots.\n\\end{align*}", "category": "Algebra", "source": "PUTNAM", "year": 2002}
{"id": "putnam-2002-a2", "question": "Given any five points on a sphere, show that some four of them\nmust lie on a closed hemisphere.", "solution": "Draw a great circle through two of the points. There are two\nclosed hemispheres with this great circle as boundary, and each of\nthe other three points lies in one of them. By the pigeonhole principle,\ntwo of those three points lie in the same hemisphere, and that hemisphere\nthus contains four of the five given points.\n\nNote: by a similar argument, one can prove that among any $n+3$ points on\nan $n$-dimensional sphere, some $n+2$ of them lie on a closed hemisphere.\n(One cannot get by with only $n+2$ points: put them at the vertices of\na regular simplex.)\nNamely, any $n$ of the points lie on a great sphere, which forms the boundary\nof two hemispheres; of the remaining three points, some two lie in the\nsame hemisphere.", "category": "Geometry", "source": "PUTNAM", "year": 2002}
{"id": "putnam-2002-a3", "question": "Let $n \\geq 2$ be an integer and $T_n$ be the number of non-empty\nsubsets $S$ of $\\{1, 2, 3, \\dots, n\\}$ with the property that the\naverage of the elements of $S$ is an integer. Prove that\n$T_n - n$ is always even.", "solution": "Note that each of the sets $\\{1\\}, \\{2\\}, \\dots, \\{n\\}$ has the\ndesired property. Moreover, for each set $S$ with integer average $m$\nthat does not contain $m$, $S \\cup \\{m\\}$ also has average $m$,\nwhile for each set $T$ of more than one element with integer average\n$m$ that contains $m$, $T \\setminus \\{m\\}$ also has average $m$.\nThus the subsets other than $\\{1\\}, \\{2\\}, \\dots, \\{n\\}$ can be grouped\nin pairs, so $T_n - n$ is even.", "category": "Combinatorics", "source": "PUTNAM", "year": 2002}
{"id": "putnam-2002-a4", "question": "In Determinant Tic-Tac-Toe, Player 1 enters a 1 in an empty\n$3 \\times 3$ matrix. Player 0 counters with a 0 in a vacant position,\nand play continues in turn until the $3 \\times 3$ matrix is\ncompleted with five 1's and four 0's. Player 0 wins if the\ndeterminant is 0 and player 1 wins otherwise. Assuming both\nplayers pursue optimal strategies, who will win and how?", "solution": "(partly due to David Savitt)\nPlayer 0 wins with optimal play. In fact, we prove that Player 1 cannot\nprevent Player 0 from creating a row of all zeroes, a column of all\nzeroes, or a $2 \\times 2$ submatrix of all zeroes. Each of these forces\nthe determinant of the matrix to be zero.\n\nFor $i,j=1, 2,3$, let $A_{ij}$ denote the position in row $i$ and\ncolumn $j$. Without loss of generality, we may assume that Player\n1's first move is at $A_{11}$. Player 0 then plays at $A_{22}$:\n\\[\n\\begin{pmatrix}\n1 & * & * \\\\\n* & 0 & * \\\\\n* & * & *\n\\end{pmatrix}\n\\]\nAfter Player 1's second move, at least one of $A_{23}$ and $A_{32}$\nremains vacant. Without loss of generality, assume $A_{23}$ remains\nvacant; Player 0 then plays there.\n\nAfter Player 1's third move, Player 0 wins by playing at $A_{21}$ if that\nposition is unoccupied. So assume instead that Player 1 has played there.\nThus of Player 1's three moves so far, two are at $A_{11}$ and $A_{21}$.\nHence for $i$ equal to one of 1 or 3, and for $j$ equal to one of 2 or 3,\nthe following are both true:\n\\begin{enumerate}", "category": "Algebra", "source": "PUTNAM", "year": 2002}
{"id": "putnam-2002-a5", "question": "Define a sequence by $a_0=1$, together with the rules\n$a_{2n+1} = a_n$ and $a_{2n+2} = a_n + a_{n+1}$ for each\ninteger $n \\geq 0$. Prove that every positive rational number\nappears in the set\n\\[\n\\left\\{ \\frac{a_{n-1}}{a_n}: n \\geq 1 \\right\\} =\n\\left\\{ \\frac{1}{1}, \\frac{1}{2}, \\frac{2}{1}, \\frac{1}{3},\n\\frac{3}{2}, \\dots \\right\\}.\n\\]", "solution": "It suffices to prove that for any relatively prime positive integers\n$r,s$, there exists an integer $n$ with $a_n = r$ and $a_{n+1} = s$.\nWe prove this by induction on $r+s$, the case $r+s=2$ following\nfrom the fact that $a_0=a_1 = 1$. Given $r$ and $s$ not both 1 with\n$\\gcd(r,s) = 1$, we must have $r \\neq s$. If $r>s$, then by\nthe induction hypothesis we have $a_n = r-s$ and $a_{n+1} = s$ for\nsome $n$; then $a_{2n+2} = r$ and $a_{2n+3} = s$. If $r< s$,\nthen we have $a_n = r$ and $a_{n+1} = s-r$ for some $n$; then\n$a_{2n+1} = r$ and $a_{2n+2} = s$.\n\nNote: a related problem is as follows. Starting with the sequence\n\\[\n\\frac{0}{1}, \\frac{1}{0},\n\\]\nrepeat the following operation: insert between each pair\n$\\frac{a}{b}$ and $\\frac{c}{d}$ the pair $\\frac{a+c}{b+d}$.\nProve that each positive rational number eventually appears.\n\nObserve that by induction, if $\\frac{a}{b}$ and $\\frac{c}{d}$\nare consecutive terms in the sequence, then $bc - ad = 1$. The\nsame holds for consecutive terms of the $n$-th \\emph{Farey sequence}, the\nsequence of rational numbers in $[0,1]$ with denominator\n(in lowest terms) at most $n$.", "category": "Number Theory", "source": "PUTNAM", "year": 2002}
{"id": "putnam-2002-a6", "question": "Fix an integer $b \\geq 2$. Let $f(1) = 1$, $f(2) = 2$, and for each\n$n \\geq 3$, define $f(n) = n f(d)$, where $d$ is the number of\nbase-$b$ digits of $n$. For which values of $b$ does\n\\[\n\\sum_{n=1}^\\infty \\frac{1}{f(n)}\n\\]\nconverge?", "solution": "The sum converges for $b=2$ and diverges for $b \\geq 3$.\nWe first consider $b \\geq 3$. Suppose the sum converges;\nthen the fact\nthat $f(n) = n f(d)$ whenever $b^{d-1} \\leq n \\leq b^{d} - 1$ yields\n\\begin{equation} \\label{a6eq1}\n\\sum_{n=1}^\\infty \\frac{1}{f(n)}\n= \\sum_{d=1}^\\infty \\frac{1}{f(d)} \\sum_{n=b^{d-1}}^{b^d - 1} \\frac{1}{n}.\n\\end{equation}\nHowever, by comparing the integral of $1/x$ with a Riemann sum,\nwe see that\n\\begin{align*}\n\\sum_{n=b^{d-1}}^{b^d - 1} \\frac{1}{n}\n&> \\int_{b^{d-1}}^{b^d} \\frac{dx}{x} \\\\\n&= \\log (b^d) - \\log (b^{d-1}) = \\log b,\n\\end{align*}\nwhere $\\log$ denotes the natural logarithm. Thus \\eqref{a6eq1} yields\n\\[\n\\sum_{n=1}^\\infty \\frac{1}{f(n)}\n> (\\log b) \\sum_{n=1}^\\infty \\frac{1}{f(n)},\n\\]\na contradiction since $\\log b > 1$ for $b \\geq 3$. Therefore the\nsum diverges.\n\nFor $b=2$, we have a slightly different identity because $f(2) \\neq\n2 f(2)$. Instead, for any positive integer $i$, we have\n\\begin{equation} \\label{a6eq2}\n\\sum_{n=1}^{2^i-1} \\frac{1}{f(n)}\n= 1 + \\frac{1}{2} + \\frac{1}{6} +\n\\sum_{d=3}^i \\frac{1}{f(d)} \\sum_{n=2^{d-1}}^{2^d - 1} \\frac{1}{n}.\n\\end{equation}\nAgain comparing an integral to a Riemann sum, we see that for $d\\geq 3$,\n\\begin{align*}\n\\sum_{n=2^{d-1}}^{2^d - 1} \\frac{1}{n} &<\n\\frac{1}{2^{d-1}} - \\frac{1}{2^d} + \\int_{2^{d-1}}^{2^d} \\frac{dx}{x}\n\\\\\n&= \\frac{1}{2^d} + \\log 2 \\\\\n&\\leq \\frac{1}{8} + \\log 2 < 0.125 + 0.7 < 1.\n\\end{align*}\nPut $c = \\frac{1}{8} + \\log 2$ and $L = 1+\\frac{1}{2} +\n\\frac{1}{6(1-c)}$. Then we can prove that $\\sum_{n=1}^{2^i-1}\n\\frac{1}{f(n)} < L$ for all $i \\geq 2$ by induction on $i$. The case\n$i=2$ is clear. For the induction, note that by \\eqref{a6eq2},\n\\begin{align*}\n\\sum_{n=1}^{2^i-1} \\frac{1}{f(n)}\n&< 1 + \\frac{1}{2} + \\frac{1}{6} + c \\sum_{d=3}^i \\frac{1}{f(d)} \\\\\n&< 1 + \\frac{1}{2} + \\frac{1}{6} + c \\frac{1}{6(1-c)} \\\\\n&= 1 + \\frac{1}{2} + \\frac{1}{6(1-c)} = L,\n\\end{align*}\nas desired. We conclude that $\\sum_{n=1}^\\infty \\frac{1}{f(n)}$\nconverges to a limit less than or equal to $L$.\n\nNote: the above argument proves that the sum for $b=2$ is at most\n$L < 2.417$. One can also obtain a lower bound by the same technique,\nnamely $1 + \\frac{1}{2} + \\frac{1}{6(1 - c')}$ with $c' = \\log 2$.\nThis bound exceeds $2.043$. (By contrast, summing the first 100000 terms of\nthe series only yields a lower bound of $1.906$.)\nRepeating the same arguments with $d \\geq 4$\nas the cutoff yields the upper bound $2.185$ and the lower bound $2.079$.", "category": "Number Theory", "source": "PUTNAM", "year": 2002}
{"id": "putnam-2002-b1", "question": "Shanille O'Keal shoots free throws on a basketball court. She hits\nthe first and misses the second, and thereafter the probability that\nshe hits the next shot is equal to the proportion of shots she\nhas hit so far. What is the probability she hits exactly 50 of\nher first 100 shots?", "solution": "The probability is $1/99$. In fact, we show by induction on $n$\nthat after $n$ shots, the probability of having made any number of\nshots from $1$ to $n-1$ is equal to $1/(n-1)$. This is evident\nfor $n=2$. Given the result for $n$, we see that the probability of\nmaking $i$ shots after $n+1$ attempts is\n\\begin{align*}\n\\frac{i-1}{n} \\frac{1}{n-1} + \\left( 1 - \\frac{i}{n} \\right) \\frac{1}{n-1}\n&= \\frac{(i-1) + (n-i)}{n(n-1)} \\\\\n&= \\frac{1}{n},\n\\end{align*}\nas claimed.", "category": "Combinatorics", "source": "PUTNAM", "year": 2002}
{"id": "putnam-2002-b2", "question": "Consider a polyhedron with at least five faces such that exactly three\nedges emerge from each of its vertices. Two players play the following\ngame:\n\\begin{verse}\n\\noindent\nEach player, in turn, signs his or her name on a previously\nunsigned face. The winner is the player who first succeeds in\nsigning three faces that share a common vertex.\n\\end{verse}\nShow that the player who signs first will always win by playing\nas well as possible.", "solution": "(Note: the problem statement assumes that all polyhedra are connected\nand that no two edges share more than one face,\nso we will do likewise. In particular, these are true for all convex\npolyhedra.)\nWe show that in fact the first player can win on the third move.\nSuppose the polyhedron has a face $A$ with at least four edges. If\nthe first player plays there first, after the second player's first move\nthere will be three consecutive faces $B,C,D$ adjacent to $A$ which\nare all unoccupied. The first player wins by playing in $C$; after\nthe second player's second move, at least one of $B$ and $D$ remains\nunoccupied, and either is a winning move for the first player.\n\nIt remains to show that the polyhedron has a face with at least four\nedges. (Thanks to Russ Mann for suggesting the following argument.)\nSuppose on the contrary that each face has only three edges.\nStarting with any face $F_1$ with vertices $v_1, v_2, v_3$, let\n$v_4$ be the other endpoint of the third edge out of $v_1$. Then\nthe faces adjacent to $F_1$ must have vertices $v_1, v_2, v_4$;\n$v_1, v_3, v_4$; and $v_2, v_3, v_4$. Thus $v_1, v_2, v_3, v_4$ form\na polyhedron by themselves, contradicting the fact that the given\npolyhedron is connected and has at least five vertices.\n(One can also deduce this using Euler's formula\n$V - E + F = 2 - 2g$, where $V,E,F$ are the numbers of vertices,\nedges and faces, respectively, and $g$ is the genus of the polyhedron.\nFor a convex polyhedron, $g=0$ and you get the ``usual'' Euler's formula.)\n\nNote: Walter Stromquist points out the following counterexample if\none relaxes the assumption that a pair of faces may not share multiple\nedges. Take a tetrahedron and remove a smaller tetrahedron from the\ncenter of an edge; this creates two small triangular faces and turns two\nof the original faces into hexagons. Then the second player can draw\nby signing one of the hexagons, one of the large triangles, and one\nof the small triangles. (He does this by ``mirroring'': wherever the first\nplayer signs, the second player signs the other face of the same type.)", "category": "Combinatorics", "source": "PUTNAM", "year": 2002}
{"id": "putnam-2002-b3", "question": "Show that, for all integers $n > 1$,\n\\[\n\\frac{1}{2ne} < \\frac{1}{e} - \\left( 1 - \\frac{1}{n} \\right)^n\n< \\frac{1}{ne}.\n\\]", "solution": "The desired inequalities can be rewritten as\n\\[\n1 - \\frac{1}{n} < \\exp\\left( 1 + n \\log \\left( 1 - \\frac{1}{n} \\right)\n\\right) < 1 - \\frac{1}{2n}.\n\\]\nBy taking logarithms, we can rewrite the desired inequalities as\n\\begin{align*}\n-\\log \\left( 1 - \\frac{1}{2n} \\right)\n&< -1 - n \\log \\left( 1 - \\frac{1}{n} \\right) \\\\\n&< -\\log \\left( 1 - \\frac{1}{n} \\right).\n\\end{align*}\nRewriting these in terms of the Taylor expansion of\n$-\\log(1-x)$, we see that the desired result is also equivalent\nto\n\\[\n\\sum_{i=1}^\\infty \\frac{1}{i 2^i n^i}\n< \\sum_{i=1}^\\infty \\frac{1}{(i+1) n^i}\n< \\sum_{i=1}^\\infty \\frac{1}{i n^i},\n\\]\nwhich is evident because the inequalities hold term by term.\n\nNote: David Savitt points out that the upper bound can be improved from\n$1/(ne)$ to $2/(3ne)$ with a slightly more complicated argument. (In\nfact, for any $c>1/2$, one has an upper bound of $c/(ne)$, but only\nfor $n$ above a certain bound depending on $c$.)", "category": "Number Theory", "source": "PUTNAM", "year": 2002}
{"id": "putnam-2002-b4", "question": "An integer $n$, unknown to you, has been randomly chosen in the\ninterval $[1, 2002]$ with uniform probability. Your objective is\nto select $n$ in an \\textbf{odd} number of guesses. After\neach incorrect guess, you are informed whether $n$ is higher\nor lower, and you \\textbf{must} guess an integer on your next turn\namong the numbers that are still feasibly correct. Show that you\nhave a strategy so that the chance of winning is greater than $2/3$.", "solution": "Use the following strategy: guess $1, 3, 4, 6, 7, 9, \\dots$\nuntil the target number $n$ is revealed to be equal to or lower than one\nof these guesses. If $n \\equiv 1 \\pmod{3}$, it will be guessed on an\nodd turn. If $n \\equiv 0 \\pmod{3}$, it will be guessed on an even turn.\nIf $n \\equiv 2 \\pmod{3}$, then $n+1$ will be guessed on an even turn,\nforcing a guess of $n$ on the next turn. Thus the probability\nof success with this strategy is $1335/2002 > 2/3$.\n\nNote: for any positive integer $m$, this strategy wins when the\nnumber is being guessed from $[1,m]$ with probability\n$\\frac{1}{m} \\lfloor \\frac{2m+1}{3} \\rfloor$. We can prove that\nthis is best possible as follows.\nLet $a_m$ denote $m$ times\nthe probability of winning when playing optimally.  Also, let $b_m$\ndenote $m$ times the corresponding probability of winning if the\nobjective is to select the number in an even number of guesses\ninstead.  (For definiteness, extend the definitions to incorporate\n$a_0 = 0$ and $b_0=0$.)\n\nWe first claim that $a_m = 1 + \\max_{1\\leq k\\leq m} \\{b_{k-1} +\nb_{m-k}\\}$ and $b_m = \\max_{1\\leq k\\leq m} \\{a_{k-1} + a_{m-k}\\}$ for $m\n\\geq 1$.  To establish the first recursive identity, suppose that our\nfirst guess is some integer $k$. We automatically win if $n=k$, with\nprobability $1/m$. If $n<k$, with probability $(k-1)/m$, then we wish\nto guess an integer in $[1,k-1]$ in an even number of guesses; the\nprobability of success when playing optimally is $b_{k-1}/(k-1)$, by\nassumption.  Similarly, if $n<k$, with probability $(m-k)/m$, then the\nsubsequent probability of winning is $b_{m-k}/(m-k)$.  In sum, the\noverall probability of winning if $k$ is our first guess is\n$(1+b_{k-1}+b_{m-k})/m$. For optimal strategy, we choose $k$ such that\nthis quantity is maximized. (Note that this argument still holds if\n$k=1$ or $k=m$, by our definitions of $a_0$ and $b_0$.)  The first\nrecursion follows, and the second recursion is established similarly.\n\nWe now prove by induction that $a_m = \\lfloor (2m+1)/3 \\rfloor$ and\n$b_m = \\lfloor 2m/3 \\rfloor$ for $m \\geq 0$. The inductive step relies\non the inequality $\\lfloor x \\rfloor + \\lfloor y \\rfloor \\leq \\lfloor\nx+y \\rfloor$, with equality when one of $x,y$ is an integer. Now\nsuppose that $a_i = \\lfloor (2i+1)/3 \\rfloor$ and\n$b_i = \\lfloor 2i/3 \\rfloor$ for $i < m$. Then\n\\begin{align*}\n1+b_{k-1}+b_{m-k} &= 1+\\left\\lfloor \\frac{2(k-1)}{3} \\right\\rfloor +\n\\left\\lfloor\n\\frac{2(m-k)}{3} \\right\\rfloor \\\\\n&\\leq \\left\\lfloor \\frac{2m}{3} \\right\\rfloor\n\\end{align*}\nand similarly $a_{k-1}+a_{m-k} \\leq \\lfloor (2m+1)/3 \\rfloor$, with\nequality in both cases attained, e.g., when $k=1$.\nThe inductive formula for $a_m$ and $b_m$ follows.", "category": "Combinatorics", "source": "PUTNAM", "year": 2002}
{"id": "putnam-2002-b5", "question": "A palindrome in base $b$ is a positive integer whose base-$b$\ndigits read the same backwards and forwards; for example,\n$2002$ is a 4-digit palindrome in base 10. Note that 200 is not\na palindrome in base 10, but it is the 3-digit palindrome\n242 in base 9, and 404 in base 7. Prove that there is an integer\nwhich is a 3-digit palindrome in base $b$ for at least 2002\ndifferent values of $b$.", "solution": "(due to Dan Bernstein)\nPut $N = 2002!$. Then for $d=1, \\dots, 2002$,\nthe number $N^2$ written in base $b = N/d - 1$ has digits\n$d^2, 2d^2, d^2$. (Note that these really are digits because\n$2(2002)^2 < (2002!)^2/2002 - 1$.)\n\nNote: one can also produce an integer $N$ which has base $b$\ndigits $1, *, 1$ for $n$ different values of $b$, as follows.\nChoose $c$ with $0 < c < 2^{1/n}$. For $m$ a large positive integer,\nput $N = 1 + (m+1)\\cdots (m+n)\\lfloor cm \\rfloor^{n-2}$.\nFor $m$ sufficiently large, the bases\n\\[\nb = \\frac{N-1}{(m+i)m^{n-2}} = \\prod_{j \\neq i} (m+j)\n\\]\nfor $i=1, \\dots, n$ will\nhave the properties that $N \\equiv 1 \\pmod{b}$ and $b^2 < N < 2b^2$\nfor $m$ sufficiently large.\n\nNote (due to Russ Mann):\none can also give a ``nonconstructive'' argument. Let $N$ be a\nlarge positive integer. For $b \\in (N^2, N^3)$, the number of 3-digit\nbase-$b$ palindromes in the range $[b^2, N^6 - 1]$ is at least\n\\[\n\\left\\lfloor \\frac{N^6 - b^2}{b} \\right\\rfloor - 1\n\\geq \\frac{N^6}{b^2} - b - 2,\n\\]\nsince there is a palindrome in each interval $[kb, (k+1)b-1]$ for\n$k=b, \\dots, b^2-1$. Thus the average number of bases for which\na number in $[1, N^6-1]$ is at least\n\\[\n\\frac{1}{N^6} \\sum_{b=N^2+1}^{N^3-1} \\left( \\frac{N^6}{b} - b-2 \\right)\n\\geq  \\log(N) - c\n\\]\nfor some constant $c>0$. Take $N$ so that the right side exceeds $2002$;\nthen at least one number in $[1, N^6-1]$ is a base-$b$ palindrome\nfor at least 2002 values of $b$.", "category": "Number Theory", "source": "PUTNAM", "year": 2002}
{"id": "putnam-2002-b6", "question": "Let $p$ be a prime number. Prove that the determinant of the matrix\n\\[\n\\begin{pmatrix}\nx & y & z \\\\\nx^p & y^p & z^p \\\\\nx^{p^2} & y^{p^2} & z^{p^2}\n\\end{pmatrix}\n\\]\nis congruent modulo $p$ to a product of polynomials of the form\n$ax+by+cz$, where $a,b,c$ are integers. (We say two integer\npolynomials are congruent modulo $p$ if corresponding coefficients\nare congruent modulo $p$.)\n\n\\end{itemize}\n\\end{document}", "solution": "We prove that the determinant is congruent modulo $p$ to\n\\begin{equation} \\label{b6eq2}\nx \\prod_{i=0}^{p-1} (y+ix) \\prod_{i,j=0}^{p-1} (z + ix + jy).\n\\end{equation}\nWe first check that\n\\begin{equation} \\label{b6eq1}\n\\prod_{i=0}^{p-1} (y+ix) \\equiv y^p - x^{p-1} y \\pmod{p}.\n\\end{equation}\nSince both sides are homogeneous as polynomials in $x$ and $y$,\nit suffices to check \\eqref{b6eq1}\nfor $x=1$, as a congruence between polynomials. Now note that\nthe right side has $0,1,\\dots,p-1$ as roots modulo $p$, as does\nthe left side. Moreover, both sides have the same leading coefficient.\nSince they both have degree only $p$, they must then coincide.\n\nWe thus have\n\\begin{multline*}\nx \\prod_{i=0}^{p-1} (y+ix) \\prod_{i,j=0}^{p-1} (z + ix + jy) \\\\\n\\begin{aligned}\n&\\equiv x (y^p - x^{p-1}y) \\prod_{j=0}^{p-1} ((z+jy)^p - x^{p-1} (z+jy)) \\\\\n&\\equiv (xy^p - x^p y) \\prod_{j=0}^{p-1} (z^p - x^{p-1} z + j y^p - j x^{p-1}\ny) \\\\\n&\\equiv (xy^p - x^p y) ((z^p - x^{p-1} z)^p \\\\\n&\\quad - (y^p - x^{p-1}y)^{p-1}(z^p\n- x^{p-1}z)) \\\\\n &\\equiv (xy^p - x^p y)(z^{p^2} - x^{p^2 - p}z^p) \\\\\n&\\quad - x(y^p - x^{p-1}y)^p\n(z^p - x^{p-1}z) \\\\\n&\\equiv xy^p z^{p^2} - x^p y z^{p^2} - x^{p^2-p+1} y^p z^p\n+ x^{p^2} y z^p \\\\\n&\\quad - xy^{p^2}z^p + x^{p^2-p+1} y^p z^p\n+ x^py^{p^2}z - x^{p^2} y^p z \\\\\n&\\equiv x y^p z^{p^2} + y z^p x^{p^2} + z x^p y^{p^2} \\\\\n&\\quad\n- x z^p y^{p^2} - y x^p z^{p^2} - z y^p x^{p^2},\n\\end{aligned}\n\\end{multline*}\nwhich is precisely the desired determinant.\n\nNote: a simpler conceptual proof is as follows. (Everything in this\nparagraph will be modulo $p$.) Note that for any\nintegers $a,b,c$, the column vector $[ax + by + cz, (ax + by + cz)^p,\n(ax + by + cz)^{p^2}]$ is a linear combination of the columns of the\ngiven matrix. Thus $ax+by+cz$ divides the determinant.\nIn particular, all of the factors of \\eqref{b6eq2} divide the determinant;\nsince both \\eqref{b6eq2} and the determinant have degree $p^2+p+1$,\nthey agree up to a scalar multiple. Moreover, they have the same\ncoefficient of $z^{p^2} y^p x$ (since this term only appears in\nthe expansion of \\eqref{b6eq2} when you choose the first term in\neach factor). Thus the determinant is congruent to \\eqref{b6eq2}, as desired.\n\nEither argument can be used to generalize to a corresponding $n \\times n$\ndeterminant, called a Moore determinant;\nwe leave the precise formulation to the reader. Note\nthe similarity with the classical Vandermonde determinant: if\n$A$ is the $n \\times n$ matrix with $A_{ij} = x_i^j$ for\n$i,j=0, \\dots, n-1$, then\n\\[\n\\det(A) = \\prod_{1 \\leq i < j \\leq n} (x_j - x_i).\n\\]\n\n\\end{itemize}\n\n\\end{document}", "category": "Number Theory", "source": "PUTNAM", "year": 2002}
{"id": "putnam-2003-a1", "question": "Let $n$ be a fixed positive integer. How many ways are there to write  $n$\nas a sum of positive integers,  \n\\[\nn = a_1 + a_2 + \\cdots + a_k,\n\\]\nwith  $k$  an\narbitrary positive integer and  $a_1 \\le a_2 \\le \\cdots \\le a_k \\le a_1  + 1$?\nFor example, with $n=4$ there are four ways: 4, 2+2, 1+1+2, 1+1+1+1.", "solution": "There are $n$ such sums. More precisely, there is exactly one such sum\nwith $k$ terms for each of $k=1, \\dots, n$ (and clearly no others).\nTo see this, note that if $n = a_1 + a_2 + \\cdots + a_k$ with\n$a_1 \\leq a_2 \\leq \\cdots \\leq a_k \\leq a_1 + 1$, then\n\\begin{align*}\nka_1 &= a_1 + a_1 + \\cdots + a_1 \\\\\n&\\leq n \\leq a_1 + (a_1 + 1) + \\cdots + (a_1 + 1) \\\\\n&= ka_1 + k-1.\n\\end{align*}\nHowever, there is a unique integer $a_1$ satisfying these inequalities,\nnamely $a_1 = \\lfloor n/k \\rfloor$. Moreover, once $a_1$ is fixed,\nthere are $k$ different possibilities for the sum $a_1 + a_2 + \\cdots + a_k$:\nif $i$ is the last integer such that $a_i = a_1$, then the sum equals\n$ka_1 + (i-1)$. The possible values of $i$ are $1, \\dots, k$,\nand exactly one of these sums comes out equal to $n$, proving\nour claim.\n\n\\textbf{Note:}\nIn summary, there is a unique partition of $n$ with $k$ terms that is\n``as equally spaced as possible''.\nOne can also obtain essentially the same construction inductively: except\nfor the all-ones sum, each partition of $n$ is obtained by ``augmenting''\na unique partition of $n-1$.", "category": "Combinatorics", "source": "PUTNAM", "year": 2003}
{"id": "putnam-2003-a2", "question": "Let $a_1, a_2, \\dots, a_n$  and  $b_1, b_2, \\dots, b_n$\nbe nonnegative real numbers.\nShow that\n\\begin{align*}\n& (a_1 a_2 \\cdots a_n)^{1/n} + (b_1 b_2 \\cdots b_n)^{1/n} \\\\\n&\\leq [(a_1+b_1) (a_2+b_2) \\cdots (a_n + b_n) ]^{1/n}.\n\\end{align*}", "solution": "\\textbf{First solution:}\nAssume without loss of generality that $a_i + b_i > 0$\nfor each $i$ (otherwise both sides of the desired inequality are zero).\nThen the AM-GM inequality gives\n\\begin{multline*}\n\\left( \\frac{a_1\\cdots a_n}{(a_1+b_1)\\cdots(a_n+b_n)} \\right)^{1/n} \\\\\n\\leq \\frac{1}{n} \\left( \\frac{a_1}{a_1 + b_1} + \\cdots + \\frac{a_n}{a_n+b_n}\n\\right),\n\\end{multline*}\nand likewise with the roles of $a$ and $b$ reversed. Adding these two\ninequalities and clearing denominators yields the desired result.\n\n\\textbf{Second solution:}\nWrite the desired inequality in the form\n\\[\n(a_1 + b_1)\\cdots(a_n+b_n) \\geq\n[(a_1\\cdots a_n)^{1/n} + (b_1\\cdots b_n)^{1/n}]^n,\n\\]\nexpand both sides, and compare the terms on both sides\nin which $k$ of the terms are among the $a_i$. On the left,\none has the product of each $k$-element subset of $\\{1, \\dots, n\\}$;\non the right, one has\n\\[\n\\binom{n}{k} (a_1\\cdots a_n)^{k/n} \\cdots (b_1 \\dots b_n)^{(n-k)/n},\n\\]\nwhich is precisely $\\binom{n}{k}$ times the geometric mean of the terms\non the left.  Thus AM-GM shows that the terms under consideration on the\nleft exceed those on the right; adding these inequalities over all $k$\nyields the desired result.\n\n\\textbf{Third solution:}\nSince both sides are continuous in each $a_i$, it is sufficient to\nprove the claim with $a_1, \\dots, a_n$ all positive (the general case\nfollows by taking limits as some of the $a_i$ tend to zero).\nPut $r_i = b_i/a_i$; then the given inequality is equivalent to\n\\[\n(1 + r_1)^{1/n} \\cdots (1+r_n)^{1/n} \\geq 1 + (r_1\\cdots r_n)^{1/n}.\n\\]\nIn terms of the function\n\\[\nf(x) = \\log(1 + e^x)\n\\]\nand the quantities $s_i = \\log r_i$,\nwe can rewrite the desired inequality as\n\\[\n\\frac{1}{n}(f(s_1) + \\cdots + f(s_n)) \\geq f\\left( \\frac{s_1 + \\cdots +\ns_n}{n} \\right).\n\\]\nThis will follow from Jensen's inequality if we can verify that $f$\nis a convex function; it is enough to check that $f''(x) > 0$ for all $x$.\nIn fact,\n\\[\nf'(x) = \\frac{e^x}{1+e^x} = 1 - \\frac{1}{1+e^x}\n\\]\nis an increasing function of $x$, so $f''(x) > 0$ and Jensen's inequality\nthus yields the desired result. (As long as the $a_i$ are all positive,\nequality holds when $s_1 = \\cdots = s_n$, i.e., when the vectors\n$(a_1, \\dots, a_n)$ and $(b_1, \\dots, b_n)$. Of course other equality\ncases crop up if some of the $a_i$ vanish, i.e., if $a_1=b_1=0$.)\n\n\\textbf{Fourth solution:}\nWe apply induction on $n$, the case $n=1$ being evident.\nFirst we verify the auxiliary inequality\n\\[\n(a^n + b^n)(c^n + d^n)^{n-1} \\geq (ac^{n-1} + b d^{n-1})^n\n\\]\nfor $a,b,c,d \\geq 0$.\nThe left side can be written as\n\\begin{align*}\na^n c^{n(n-1)} &+ b^n d^{n(n-1)} \\\\\n&+ \\sum_{i=1}^{n-1} \\binom{n-1}{i} b^n c^{ni} d^{n(n-1-i)} \\\\\n&+ \\sum_{i=1}^{n-1} \\binom{n-1}{i-1} a^n c^{n(i-1)} d^{n(n-i)}.\n\\end{align*}\nApplying the weighted AM-GM inequality between matching terms in the two\nsums yields\n\\begin{multline*}\n(a^n + b^n)(c^n + d^n)^{n-1} \\geq a^n c^{n(n-1)} + b^n d^{n(n-1)} \\\\\n+ \\sum_{i=1}^{n-1} \\binom{n}{i} a^i b^{n-i} c^{(n-1)i} d^{(n-1)(n-i)},\n\\end{multline*}\nproving the auxiliary inequality.\n\nNow given the auxiliary inequality and the $n-1$ case of the desired\ninequality, we apply the auxiliary inequality with $a = a_1^{1/n}$,\n$b = b_1^{1/n}$, $c = (a_2 \\cdots a_n)^{1/n(n-1)}$,\n$d = (b_2 \\dots b_n)^{1/n(n-1)}$. The right side will be the $n$-th\npower of the desired inequality. The left side comes out to\n\\[\n(a_1 + b_1)((a_2 \\cdots a_n)^{1/(n-1)} + (b_2 \\cdots b_n)^{1/(n-1)})^{n-1},\n\\]\nand by the induction hypothesis, the second factor is less than\n$(a_2 + b_2)\\cdots(a_n+b_n)$. This yields the desired result.\n\n\\textbf{Note:}\nEquality holds if and only if $a_i=b_i=0$ for some $i$ or if the vectors\n$(a_1, \\dots, a_n)$ and $(b_1, \\dots, b_n)$ are proportional.\nAs pointed out by Naoki Sato, the problem also appeared on the 1992\nIrish Mathematical Olympiad.\nIt is also a special case of a classical inequality,\nknown as H\\\"older's inequality, which generalizes the\nCauchy-Schwarz inequality (this is visible from the $n=2$ case); the\nfirst solution above is adapted from the standard proof of H\\\"older's\ninequality.\nWe don't know whether the declaration\n``Apply H\\\"older's inequality'' by itself is considered\nan acceptable solution to this problem.", "category": "Algebra", "source": "PUTNAM", "year": 2003}
{"id": "putnam-2003-a3", "question": "Find the minimum value of\n\\[\n  | \\sin x + \\cos x + \\tan x + \\cot x + \\sec x + \\csc x |\n\\]\nfor real numbers  $x$.", "solution": "\\textbf{First solution:}\nWrite\n\\begin{align*}\nf(x) &= \\sin x + \\cos x + \\tan x + \\cot x + \\sec x + \\csc x \\\\\n&= \\sin x + \\cos x + \\frac{1}{\\sin x \\cos x} + \\frac{\\sin x + \\cos x}{\\sin x\n\\cos x}.\n\\end{align*}\nWe can write $\\sin x + \\cos x = \\sqrt{2} \\cos(\\pi/4 - x)$; this suggests\nmaking the substitution $y = \\pi/4 - x$. In this new coordinate,\n\\[\n\\sin x \\cos x = \\frac{1}{2} \\sin 2x = \\frac{1}{2} \\cos 2y,\n\\]\nand writing $c = \\sqrt{2} \\cos y$, we have\n\\begin{align*}\nf(y) &= (1 + c)\\left(1 + \\frac{2}{c^2 -1} \\right) - 1 \\\\\n&= c + \\frac{2}{c - 1}.\n\\end{align*}\nWe must analyze this function of $c$ in the range $[-\\sqrt{2}, \\sqrt{2}]$.\nIts value at $c=-\\sqrt{2}$ is $2 - 3\\sqrt{2} < -2.24$, and at\n$c = \\sqrt{2}$ is $2 + 3\\sqrt{2}>6.24$.\nIts derivative is $1 - 2/(c-1)^2$, which vanishes when\n$(c-1)^2 = 2$, i.e., where $c = 1 \\pm \\sqrt{2}$. Only the value\n$c = 1 - \\sqrt{2}$ is in bounds, at which\nthe value of $f$ is $1-2\\sqrt{2} > -1.83$. As for the pole at $c=1$,\nwe observe that $f$ decreases as $c$ approaches from below\n(so takes negative values for all $c<1$) and increases as $c$\napproaches from above (so takes positive values for all $c>1$); from\nthe data collected so far, we see that $f$ has no sign crossings, so\nthe minimum of $|f|$ is achieved at a critical point of $f$.\nWe conclude that the minimum of $|f|$ is $2 \\sqrt{2} - 1$.\n\nAlternate derivation (due to Zuming Feng): We can also minimize $|c + 2/(c-1)|$\nwithout calculus (or worrying about boundary conditions). For $c>1$, we have\n\\[\n1 + (c-1) + \\frac{2}{c-1} \\geq 1 + 2 \\sqrt{2}\n\\]\nby AM-GM on the last two terms, with equality for $c-1 = \\sqrt{2}$\n(which is out of range).\nFor $c<1$, we similarly have\n\\[\n-1 + 1-c + \\frac{2}{1-c} \\geq -1 + 2\\sqrt{2},\n\\]\nhere with equality for $1-c = \\sqrt{2}$.\n\n\\textbf{Second solution:}\nWrite\n\\[\nf(a,b) = a+b + \\frac{1}{ab} + \\frac{a+b}{ab}.\n\\]\nThen the problem is to minimize $|f(a,b)|$ subject to the constraint\n$a^2+b^2-1 = 0$. Since the constraint region has no boundary, it is\nenough to check the value at each critical point and each potential\ndiscontinuity (i.e., where $ab=0$) and select the smallest value\n(after checking that $f$ has no sign crossings).\n\nWe locate the critical points using the Lagrange multiplier condition:\nthe gradient of $f$ should be parallel to that of the constraint, which is\nto say, to the vector $(a,b)$. Since\n\\[\n\\frac{\\partial f}{\\partial a}\n= 1 - \\frac{1}{a^2 b} - \\frac{1}{a^2}\n\\]\nand similarly for $b$, the proportionality yields\n\\[\na^2 b^3 - a^3 b^2 + a^3 - b^3 + a^2 - b^2 = 0.\n\\]\nThe irreducible factors of the left side are $1+a$, $1+b$,\n$a-b$, and $ab-a-b$. So we must check what happens when any of\nthose factors, or $a$ or $b$, vanishes.\n\nIf $1+a = 0$, then $b=0$, and the singularity of $f$ becomes removable\nwhen restricted to the circle. Namely, we have\n\\[\nf = a + b + \\frac{1}{a} + \\frac{b+1}{ab}\n\\]\nand $a^2+b^2-1 = 0$ implies $(1+b)/a = a/(1-b)$. Thus we have\n$f = -2$; the same occurs when $1+b=0$.\n\nIf $a-b=0$, then $a=b=\\pm \\sqrt{2}/2$ and either\n$f = 2 + 3 \\sqrt{2} > 6.24$, or $f = 2 - 3 \\sqrt{2} < -2.24$.\n\nIf $a=0$, then either $b = -1$ as discussed above, or $b=1$. In the\nlatter case, $f$ blows up as one approaches this point, so there cannot\nbe a global minimum there.\n\nFinally, if $ab-a-b = 0$, then\n\\[\na^2b^2 = (a + b)^2 = 2ab + 1\n\\]\nand so $ab = 1 \\pm \\sqrt{2}$. The plus sign is impossible since\n$|ab| \\leq 1$, so $ab = 1 - \\sqrt{2}$ and\n\\begin{align*}\nf(a,b) &= ab + \\frac{1}{ab} + 1 \\\\\n&= 1 - 2 \\sqrt{2} > -1.83.\n\\end{align*}\nThis yields the smallest value of $|f|$ in the list (and indeed no sign\ncrossings are possible), so $2\\sqrt{2}-1$ is the desired minimum of $|f|$.\n\n\\textbf{Note:} Instead of using the geometry of the graph of $f$ to rule\nout sign crossings, one can verify explicitly that $f$ cannot\ntake the value 0. In the first solution, note that $c + 2/(c-1)=0$\nimplies $c^2 - c + 2 = 0$, which has no real roots.\nIn the second solution, we would have\n\\[\na^2 b + ab^2 + a + b =  -1.\n\\]\nSquaring both sides and simplifying yields\n\\[\n2a^3b^3 + 5a^2b^2 + 4ab = 0,\n\\]\nwhose only real root is $ab=0$. But the cases with $ab=0$ do not yield\n$f=0$, as verified above.", "category": "Algebra", "source": "PUTNAM", "year": 2003}
{"id": "putnam-2003-a4", "question": "Suppose that $a,b,c,A,B,C$  are real numbers, $a\\ne 0$ and $A \\ne 0$, such that\n\\[\n          | a x^2 + b x + c | \\leq | A x^2 + B x + C |\n\\]\nfor all real numbers  $x$. Show that\n\\[\n              | b^2 - 4 a c | \\leq | B^2 - 4 A C |.\n\\]", "solution": "We split into three cases.\nNote first that $|A| \\geq |a|$, by applying the condition for large $x$.\n\n\\textbf{Case 1: $B^2 - 4AC > 0$.}\nIn this case $Ax^2 + Bx + C$ has two distinct real roots $r_1$ and $r_2$.\nThe condition implies that $ax^2 + bx + c$ also vanishes at $r_1$ and $r_2$,\nso $b^2 - 4ac > 0$.\nNow\n\\begin{align*}\nB^2 - 4AC &= A^2(r_1-r_2)^2 \\\\\n&\\geq a^2(r_1 - r_2)^2 \\\\\n&= b^2 - 4ac.\n\\end{align*}\n\n\\textbf{Case 2: $B^2 - 4AC \\leq 0$ and $b^2 - 4ac \\leq 0$.}\nAssume without loss of generality that $A \\geq a > 0$, and that $B=0$\n(by shifting $x$). Then $Ax^2 + Bx + C \\geq ax^2 + bx + c \\geq 0$ for all $x$;\nin particular, $C \\geq c \\geq 0$. Thus\n\\begin{align*}\n4AC - B^2 &= 4AC \\\\\n&\\geq 4ac \\\\\n&\\geq 4ac - b^2.\n\\end{align*}\nAlternate derivation (due to Robin Chapman): the ellipse\n$Ax^2 + Bxy + Cy^2 = 1$ is contained within\nthe ellipse $ax^2 + bxy + cy^2 = 1$,\nand their respective enclosed areas are $\\pi/(4AC-B^2)$ and\n$\\pi/(4ac-b^2)$.\n\n\\textbf{Case 3: $B^2 - 4AC \\leq 0$ and $b^2 - 4ac > 0$.}\nSince $Ax^2 + Bx + C$ has a graph not crossing the $x$-axis,\nso do $(Ax^2 + Bx + C) \\pm (ax^2 + bx + c)$. Thus\n\\begin{gather*}\n(B-b)^2 - 4(A-a)(C-c) \\leq 0, \\\\\n(B+b)^2 - 4(A+a)(C+c) \\leq 0\n\\end{gather*}\nand adding these together yields\n\\[\n2(B^2 - 4AC) + 2(b^2 - 4ac) \\leq 0.\n\\]\nHence $b^2 - 4ac \\leq 4AC - B^2$, as desired.", "category": "Algebra", "source": "PUTNAM", "year": 2003}
{"id": "putnam-2003-a5", "question": "A Dyck $n$-path is a lattice path of  $n$  upsteps $(1,1)$ and  $n$\n  downsteps $(1,-1)$\nthat starts at the origin  $O$  and never dips below the  $x$-axis.\nA return is a maximal sequence of contiguous downsteps that terminates\non the  $x$-axis. For example, the Dyck 5-path illustrated has two returns,\nof length  3  and  1  respectively.\n\\begin{center}\n\\begin{tikzpicture}[scale=.5]\n\\fill (0,0) circle (.2); \\fill (1,1) circle (.2); \\fill (2,2) circle (.2);\n\\fill (3,1) circle (.2); \\fill (4,2) circle (.2); \\fill (5,3) circle (.2);\n\\fill (6,2) circle (.2); \\fill (7,1) circle (.2); \\fill (8,0) circle (.2);\n\\fill (9,1) circle (.2); \\fill (10,0) circle (.2);\n\\draw (0,0) -- (2,2) -- (3,1) -- (5,3) -- (8,0) -- (9,1) -- (10,0) -- cycle;\n\\draw (-.3,-.1) node[anchor=north] {$O$};\n\\end{tikzpicture}\n\\end{center}\nShow that there is a one-to-one correspondence between the Dyck  $n$-paths\nwith no return of even length and the Dyck $(n-1)$-paths.", "solution": "\\textbf{First solution:}\nWe represent a Dyck $n$-path by a sequence $a_1\\cdots a_{2n}$, where\neach $a_i$ is either $(1,1)$ or $(1,-1)$.\n\nGiven an $(n-1)$-path $P=a_1\\cdots a_{2n-2}$, we distinguish two cases.\nIf $P$ has no returns of even-length, then let $f(P)$ denote the $n$-path\n$(1,1)(1,-1)P$.  Otherwise, let $a_ia_{i+1}\\cdots a_{j}$ denote the\nrightmost even-length return in $P$, and let $f(P)=(1,1)a_1a_2\\cdots\na_j(1,-1)a_{j+1}\\cdots a_{2n-2}$.  Then $f$ clearly maps the set of Dyck\n$(n-1)$-paths to the set of Dyck $n$-paths having no even return.\n\nWe claim that $f$ is bijective; to see this, we simply construct the\ninverse mapping.  Given an $n$-path $P$, let $R=a_ia_{i+1}...a_j$\ndenote the leftmost return in $P$, and let $g(P)$ denote the\npath obtained by removing $a_1$ and $a_j$ from $P$.  Then evidently\n$f \\circ g$ and $g \\circ f$ are identity maps, proving the claim.\n\n\\textbf{Second solution:} (by Dan Bernstein)\nLet $C_n$ be the number of Dyck paths of length $n$, let $O_n$ be the number\nof Dyck paths whose final return has odd length, and let $X_n$ be the number\nof Dyck paths with no return of even length.\n\nWe first exhibit a recursion for $O_n$; note that $O_0 = 0$.\nGiven a Dyck $n$-path\nwhose final return has odd length, split it just after its next-to-last return.\nFor some $k$ (possibly zero), this yields\na Dyck $k$-path, an upstep, a Dyck $(n-k-1)$-path whose odd return\nhas even length, and a downstep. Thus for $n \\geq 1$,\n\\[\nO_n = \\sum_{k=0}^{n-1} C_k (C_{n-k-1} - O_{n-k-1}).\n\\]\n\nWe next exhibit a similar recursion for $X_n$; note that $X_0 = 1$.\nGiven a Dyck $n$-path with no even return,\nsplitting as above yields for some $k$\na Dyck $k$-path with no even return,\nan upstep, a Dyck $(n-k-1)$-path whose final return has even length,\nthen a downstep. Thus for $n \\geq 1$,\n\\[\nX_n = \\sum_{k=0}^{n-1} X_k (C_{n-k-1} - O_{n-k-1}).\n\\]\n\nTo conclude, we verify that $X_n = C_{n-1}$ for $n \\geq 1$,\nby induction on $n$. This is\nclear for $n=1$ since $X_1 = C_0 = 1$. Given $X_k = C_{k-1}$ for $k<n$, we have\n\\begin{align*}\nX_n  &=\n\\sum_{k=0}^{n-1} X_k (C_{n-k-1} - O_{n-k-1}) \\\\\n&= C_{n-1} - O_{n-1} + \\sum_{k=1}^{n-1} C_{k-1} (C_{n-k-1} - O_{n-k-1}) \\\\\n&= C_{n-1} - O_{n-1} + O_{n-1} \\\\\n&= C_{n-1},\n\\end{align*}\nas desired.\n\n\\textbf{Note:}\nSince the problem only asked about the \\emph{existence} of a\none-to-one correspondence, we believe that any proof, bijective or not,\nthat the two sets\nhave the same cardinality is an acceptable solution. (Indeed, it would be\nhighly unusual to insist on using or not using a specific proof technique!)\nThe second solution\nabove can also be phrased in terms of generating functions.\nAlso, the $C_n$ are well-known to equal the Catalan numbers\n$\\frac{1}{n+1} \\binom{2n}{n}$; the problem at hand is part of a famous\nexercise in Richard Stanley's \\textit{Enumerative Combinatorics, Volume 1}\ngiving 66 combinatorial interpretations of the Catalan numbers.", "category": "Combinatorics", "source": "PUTNAM", "year": 2003}
{"id": "putnam-2003-a6", "question": "For a set  $S$  of nonnegative integers, let  $r_S(n)$  denote the number of\nordered pairs  $(s_1, s_2)$  such that  $s_1 \\in S$, $s_2 \\in S$, $s_1 \\ne\ns_2$,\nand  $s_1 + s_2 = n$.  Is it possible to partition the nonnegative\nintegers into two sets  $A$  and  $B$  in such a way that  $r_A(n) = r_B(n)$\nfor all  $n$ ?", "solution": "\\textbf{First solution:} Yes, such a partition is possible. To achieve it,\nplace each integer into $A$ if it has an even number of 1s in its binary\nrepresentation, and into $B$ if it has an odd number. (One discovers this\nby simply attempting to place the first few numbers by hand and noticing\nthe resulting pattern.)\n\nTo show that $r_A(n) = r_B(n)$, we exhibit a bijection between the pairs\n$(a_1, a_2)$ of distinct elements of $A$ with $a_1 + a_2 = n$ and the\npairs $(b_1, b_2)$ of distinct elements of $B$ with $b_1 + b_2 = n$.\nNamely, given a pair $(a_1, a_2)$ with $a_1+a_2 = n$, write both numbers\nin binary and find the lowest-order place in which they differ (such a\nplace exists because $a_1 \\neq a_2$). Change both numbers in that place\nand call the resulting numbers $b_1, b_2$. Then $a_1 + a_2 = b_1 + b_2 =\nn$, but the parity of the number of 1s in $b_1$ is opposite that of $a_1$,\nand likewise between $b_2$ and $a_2$. This yields the desired bijection.\n\n\\textbf{Second solution:} (by Micah Smukler)\nWrite $b(n)$ for the number of 1s in the base 2 expansion of $n$,\nand $f(n) = (-1)^{b(n)}$.\nThen\nthe desired partition can be described as $A = f^{-1}(1)$ and $B = f^{-1}(-1)$.\nSince $f(2n) + f(2n+1) = 0$, we have\n\\[\n\\sum_{i=0}^n f(n) = \\begin{cases} 0 & \\mbox{$n$ odd} \\\\\nf(n) & \\mbox{$n$ even.} \\end{cases}\n\\]\nIf $p,q$ are both in $A$, then $f(p) + f(q) = 2$;\nif $p,q$ are both in $B$, then $f(p) + f(q) = -2$; if $p,q$ are\nin different sets, then $f(p) + f(q) = 0$. In other words,\n\\[\n2(r_A(n) - r_B(n)) = \\sum_{p+q=n,p < q} (f(p) + f(q))\n\\]\nand it suffices to show that the sum on the right is always zero.\nIf $n$ is odd, that sum is visibly $\\sum_{i=0}^n f(i) = 0$.\nIf $n$ is even, the sum equals\n\\[\n\\left(\\sum_{i=0}^n f(i) \\right) - f(n/2) = f(n) - f(n/2) = 0.\n\\]\nThis yields the desired result.\n\n\\textbf{Third solution:} (by Dan Bernstein)\nPut $f(x) = \\sum_{n \\in A} x^n$ and $g(x) = \\sum_{n \\in B} x^n$; then\nthe value of $r_A(n)$ (resp.\\ $r_B(n)$) is the coefficient of $x^n$\nin $f(x)^2 - f(x^2)$ (resp.\\ $g(x)^2 - g(x^2)$). From the evident identities\n\\begin{align*}\n\\frac{1}{1-x} &= f(x) + g(x) \\\\\nf(x) &= f(x^2) + xg(x^2) \\\\\ng(x) &= g(x^2) + xf(x^2),\n\\end{align*}\nwe have\n\\begin{align*}\nf(x) - g(x) &= f(x^2) - g(x^2) + xg(x^2) - xf(x^2) \\\\\n&= (1-x)(f(x^2) - g(x^2)) \\\\\n&= \\frac{f(x^2) - g(x^2)}{f(x) + g(x)}.\n\\end{align*}\nWe deduce that $f(x)^2 - g(x)^2 = f(x^2) - g(x^2)$, yielding the desired\nequality.\n\n\\textbf{Note:}\nThis partition is actually unique, up to interchanging $A$ and $B$.\nMore precisely, the condition that $0 \\in A$ and $r_A(n) = r_B(n)$ for\n$n=1, \\dots, m$ uniquely determines the positions of $0, \\dots, m$. We\nsee this by induction on $m$: given the result for $m-1$, switching the\nlocation of $m$ changes $r_A(m)$ by one and does not change $r_B(m)$, so\nit is not possible for both positions to work.  Robin Chapman points out\nthis problem is solved in D.J. Newman's \\textit{Analytic Number Theory}\n(Springer, 1998); in that solution, one uses generating functions to find\nthe partition and establish its uniqueness, not just verify it.", "category": "Combinatorics", "source": "PUTNAM", "year": 2003}
{"id": "putnam-2003-b1", "question": "Do there exist polynomials  $a(x), b(x), c(y), d(y)$  such that\n\\[\n       1 + x y + x^2 y^2 = a(x) c(y) + b(x) d(y)\n\\]\nholds identically?", "solution": "No, there do not.\n\n\\textbf{First solution:}\nSuppose the contrary.  By setting $y=-1,0,1$ in succession, we see that\nthe polynomials $1-x+x^2, 1, 1+x+x^2$ are linear combinations of $a(x)$\nand $b(x)$.  But these three polynomials are linearly independent, so\ncannot all be written as linear combinations of two other polynomials,\ncontradiction.\n\nAlternate formulation: the given equation expresses a diagonal matrix with\n$1,1,1$ and zeroes on the diagonal, which has rank 3, as the sum of two\nmatrices of rank 1. But the rank of a sum of matrices is at most the sum\nof the ranks of the individual matrices.\n\n\\textbf{Second solution:}\nIt is equivalent (by relabeling and rescaling)\nto show that $1 + xy + x^2y^2$ cannot be written\nas $a(x) d(y) - b(x) c(y)$.\nWrite $a(x) = \\sum a_i x^i$,\n$b(x) = \\sum b_i x^i$, $c(y) = \\sum c_j y^j$,\n$d(y) = \\sum d_j y^j$. We now start comparing coefficients\nof $1 + xy + x^2 y^2$. By comparing coefficients of\n$1+xy + x^2y^2 $ and $a(x)d(y) - b(x)c(y)$, we get\n\\begin{align*}\n1 &= a_id_i - b_i c_i \\qquad (i=0,1,2)\\\\\n0 &= a_id_j - b_i c_j \\qquad (i \\neq j).\n\\end{align*}\nThe first equation says that $a_i$ and $b_i$ cannot both vanish,\nand $c_i$ and $d_i$ cannot both vanish. The second equation says that\n$a_i/b_i = c_j/d_j$ when $i \\neq j$, where both sides should be viewed\nin $\\RR \\cup \\{\\infty\\}$ (and neither is undetermined if\n$i,j \\in \\{0,1,2\\}$). But then\n\\[\na_0/b_0 = c_1/d_1 = a_2/b_2 = c_0/d_0\n\\]\ncontradicting the equation $a_0d_0 - b_0c_0 = 1$.\n\n\\textbf{Third solution:}\nWe work over the complex numbers, in which we have a primitive cube root\n$\\omega$ of 1. We also use without further comment unique factorization\nfor polynomials in two variables over a field.  And we keep the relabeling\nof the second solution.\n\nSuppose the contrary.  Since $1+xy+x^2y^2 = (1 - xy/\\omega)(1 -\nxy/\\omega^2)$, the rational function $a(\\omega/y) d(y) - b(\\omega/y) c(y)$\nmust vanish identically (that is, coefficient by coefficient).  If one of\nthe polynomials, say $a$, vanished identically, then one of $b$ or $c$\nwould also, and the desired inequality could not hold. So none of them\nvanish identically, and we can write\n\\[\n\\frac{c(y)}{d(y)} = \\frac{a(\\omega/y)}{b(\\omega/y)}.\n\\]\nLikewise,\n\\[\n\\frac{c(y)}{d(y)}= \\frac{a(\\omega^2/y)}{b(\\omega^2/y)}.\n\\]\nPut $f(x) = a(x)/b(x)$; then we have $f(\\omega x) = f(x)$ identically. That is,\n$a(x) b(\\omega x) = b(x) a(\\omega x)$. Since $a$ and $b$ have no common\nfactor (otherwise $1+xy+x^2y^2$ would have a factor divisible only by\n$x$, which it doesn't since it doesn't vanish identically for any particular\n$x$), $a(x)$ divides $a(\\omega x)$. Since they have the same degree, they\nare equal up to scalars. It follows that one of $a(x), xa(x), x^2a(x)$\nis a polynomial in $x^3$ alone, and likewise for $b$ (with the same\npower of $x$).\n\nIf $xa(x)$ and $xb(x)$, or $x^2 a(x)$ and $x^2 b(x)$, are polynomials in\n$x^3$, then $a$ and $b$ are divisible by $x$, but we know $a$ and $b$ have no\ncommon factor. Hence $a(x)$ and $b(x)$ are polynomials in $x^3$. Likewise,\n$c(y)$ and $d(y)$ are polynomials in $y^3$. But then $1 + xy + x^2 y^2 =\na(x)d(y) - b(x) c(y)$ is a polynomial in $x^3$ and $y^3$, contradiction.\n\n\\textbf{Note:}\nThe third solution only works over fields of characteristic not equal to 3,\nwhereas the other two work over arbitrary fields. (In the first solution,\none must replace $-1$ by another value if working in characteristic 2.)", "category": "Algebra", "source": "PUTNAM", "year": 2003}
{"id": "putnam-2003-b2", "question": "Let  $n$  be a positive integer. Starting with the sequence\n$1, \\frac{1}{2}, \\frac{1}{3}, \\dots, \\frac{1}{n}$,\nform a new sequence of  $n-1$  entries\n$\\frac{3}{4}, \\frac{5}{12}, \\dots, \\frac{2n-1}{2n(n-1)}$\nby taking the averages of\ntwo consecutive entries in the first sequence. Repeat the\naveraging of neighbors on the second sequence to obtain a third\nsequence of  $n-2$  entries, and continue until the final sequence produced\nconsists of a single number  $x_n$.  Show that  $x_n < 2/n$.", "solution": "It is easy to see by induction that the $j$-th entry of the $k$-th\nsequence (where the original sequence is $k=1$) is\n$\\sum_{i=1}^k \\binom{k-1}{i-1}/(2^{k-1} (i+j-1))$, and so\n$x_n = \\frac{1}{2^{n-1}} \\sum_{i=1}^n \\binom{n-1}{i-1}/i$.\nNow $\\binom{n-1}{i-1}/i = \\binom{n}{i}/n$; hence\n\\[\nx_n = \\frac{1}{n2^{n-1}} \\sum_{i=1}^n \\binom{n}{i}\n= \\frac{2^n-1}{n 2^{n-1}} < 2/n,\n\\]\nas desired.", "category": "Combinatorics", "source": "PUTNAM", "year": 2003}
{"id": "putnam-2003-b3", "question": "Show that for each positive integer  n,\n\\[\n    n! = \\prod_{i=1}^n  \\mathrm{lcm}\\{1, 2, \\dots, \\lfloor n/i\\rfloor\\} .\n\\]\n(Here $\\mathrm{lcm}$ denotes the least common multiple, and\n$\\lfloor x \\rfloor$ denotes the greatest integer $\\leq x$.)", "solution": "\\textbf{First solution:}\nIt is enough to show that for each prime $p$, the exponent of $p$ in\nthe prime factorization of both sides is the same.\nOn the left side, it is well-known that the exponent of $p$ in the\nprime factorization of $n!$ is\n\\[\n\\sum_{i =1}^n \\left\\lfloor \\frac{n}{p^i} \\right\\rfloor.\n\\]\n(To see this, note that the $i$-th term counts the multiples of $p^i$ among\n$1, \\dots, n$, so that a number divisible exactly by $p^i$ gets counted\nexactly $i$ times.)  This number can be reinterpreted as the cardinality\nof the set $S$ of points in the plane with positive integer coordinates\nlying on or under the curve $y = np^{-x}$: namely, each summand is the\nnumber of points of $S$ with $x=i$.\n\nOn the right side, the exponent of $p$ in the prime factorization of $\\lcm(1,\n\\dots, \\lfloor n/i \\rfloor)$ is $\\lfloor \\log_p \\lfloor n/i \\rfloor \\rfloor\n= \\lfloor \\log_p (n/i) \\rfloor$.  However, this is precisely the number\nof points of $S$ with $y=i$. Thus\n\\[\n\\sum_{i=1}^n\n\\lfloor \\log_p \\lfloor n/i \\rfloor \\rfloor\n= \\sum_{i =1}^n \\left\\lfloor \\frac{n}{p^i} \\right\\rfloor,\n\\]\nand the desired result follows.\n\n\\textbf{Second solution:}\nWe prove the result by induction on $n$, the case $n=1$ being obvious.\nWhat we actually show is that going from $n-1$ to $n$ changes both\nsides by the same multiplicative factor, that is,\n\\[\nn = \\prod_{i=1}^{n-1} \\frac{\\lcm\\{1, 2, \\dots, \\lfloor n/i \\rfloor\\}}{\\lcm\n\\{1, 2, \\dots, \\lfloor (n-1)/i \\rfloor\\}}.\n\\]\nNote that the $i$-th term in the product is equal to 1 if $n/i$ is not\nan integer, i.e., if $n/i$ is not a divisor of $n$.\nIt is also equal to 1 if $n/i$ is a divisor of $n$ but not a prime power,\nsince any composite number divides the lcm of all smaller numbers.\nHowever, if $n/i$ is a power of $p$, then the $i$-th term is equal to $p$.\n\nSince $n/i$ runs over all proper divisors of $n$, the product on the right\nside includes one factor of the prime $p$\nfor each factor of $p$ in the prime factorization of $n$. Thus the whole\nproduct is indeed equal to $n$, completing the induction.", "category": "Number Theory", "source": "PUTNAM", "year": 2003}
{"id": "putnam-2003-b4", "question": "Let $f(z) = a z^4 + b z^3 + c z^2 + d z + e = a(z-r_1)(z-r_2)(z-r_3)(z-r_4)$\nwhere  $a,b,c,d,e$  are integers, $a \\ne 0$.  Show that if  $r_1 + r_2$  is a\nrational number and $r_1 + r_2 \\ne r_3 + r_4$,  then  $r_1 r_2$  is a\nrational number.", "solution": "\\textbf{First solution:}\nPut $g = r_1 + r_2$, $h = r_3 + r_4$, $u = r_1r_2$, $v = r_3r_4$.\nWe are given that $g$ is rational. The following are also rational:\n\\begin{align*}\n\\frac{-b}{a} &= g+h \\\\\n\\frac{c}{a} &= gh + u + v \\\\\n\\frac{-d}{a} &= gv + hu\n\\end{align*}\nFrom the first line, $h$ is rational. From the second line, $u+v$\nis rational. From the third line, $g(u+v) - (gv+hu) =\n(g-h)u$ is rational. Since $g \\neq h$, $u$ is rational, as desired.\n\n\\textbf{Second solution:} This solution uses some basic\nGalois theory. We may assume $r_1 \\neq r_2$, since otherwise they are both\nrational and so then is $r_1r_2$.\n\nLet $\\tau$ be an automorphism of the field of algebraic numbers; then $\\tau$\nmaps each $r_i$ to another one, and fixes the rational number $r_1 + r_2$.\nIf $\\tau(r_1)$ equals one of $r_1$ or $r_2$, then $\\tau(r_2)$ must equal\nthe other one, and vice versa.  Thus $\\tau$ either fixes the set $\\{r_1,\nr_2\\}$ or moves it to $\\{r_3, r_4\\}$. But if the latter happened, we would\nhave $r_1 +r_2 = r_3+r_4$, contrary to hypothesis.  Thus $\\tau$ fixes the\nset $\\{r_1, r_2\\}$ and in particular the number $r_1r_2$. Since this is\ntrue for any $\\tau$, $r_1r_2$ must be rational.\n\n\\textbf{Note:} The conclusion fails if we allow\n$r_1 + r_2 = r_3 + r_4$. For\ninstance, take the polynomial $x^4 - 2$ and label its roots so that\n$(x-r_1)(x-r_2) = x^2 - \\sqrt{2}$ and\n$(x-r_3)(x-r_4) = x^2 + \\sqrt{2}$.", "category": "Algebra", "source": "PUTNAM", "year": 2003}
{"id": "putnam-2003-b5", "question": "Let  $A,B$, and $C$  be equidistant points on the circumference of a circle\nof unit radius centered at  $O$,  and let  $P$  be any point in the circle's\ninterior.  Let  $a, b, c$  be the distance from  $P$  to $A, B, C$,\nrespectively.\nShow that there is a triangle with side lengths  $a, b, c$,  and that the\narea of this triangle depends only on the distance from  $P$  to  $O$.", "solution": "\\textbf{First solution:}\nPlace the unit circle on the complex plane so that $A,B,C$ correspond\nto the complex numbers $1,\\omega,\\omega^2$, where\n$\\omega=e^{2\\pi i/3}$, and let $P$ correspond to the complex number\n$x$. The distances $a,b,c$ are then $|x-1|,|x-\\omega|,|x-\\omega^2|$.\nNow the identity\n\\[\n(x-1) + \\omega(x-\\omega) + \\omega^2(x-\\omega^2) = 0\n\\]\nimplies that there is a triangle whose sides, as vectors, correspond\nto the complex numbers $x-1, \\omega(x-\\omega), \\omega^2(x-\\omega^2)$;\nthis triangle has sides of length $a,b,c$.\n\nTo calculate the area of this triangle, we first note a more general\nformula. If a triangle in the plane has vertices at $0$,\n$v_1=s_1+it_1$, $v_2=s_2+it_2$, then it is well known that the area\nof the triangle is $|s_1t_2-s_2t_1|/2 = |v_1\\overline{v_2}-\nv_2\\overline{v_1}|/4$. In our case, we have $v_1 = x-1$\nand $v_2 = \\omega(x-\\omega)$; then\n\\[\nv_1\\overline{v_2} - v_2\\overline{v_1}\n= (\\omega^2-\\omega)(x\\overline{x}-1)\n= i\\sqrt{3}(|x|^2-1).\n\\]\nHence the area of the triangle is $\\sqrt{3}(1-|x|^2)/4$, which depends\nonly on the distance $|x|$ from $P$ to $O$.\n\n\\textbf{Second solution:} (by Florian Herzig)\nLet $A'$, $B'$, $C'$ be the points obtained by intersecting the lines\n$AP$, $BP$, $CP$ with the unit circle. Let $d$ denote $OP$. Then $A'P =\n(1-d^2)/a$, etc., by using the power of the point $P$. As triangles $A'B'P$\nand $BAP$ are similar, we get that $A'B' = AB \\cdot A'P/b = \\sqrt 3\n(1-d^2)/(ab)$. It follows that triangle $A'B'C'$ has sides proportional\nto $a$, $b$, $c$, by a factor of $\\sqrt 3 (1-d^2)/(abc)$. In particular,\nthere is a triangle with sides $a$, $b$, $c$, and it has circumradius $R =\n(abc)/(\\sqrt 3 (1-d^2))$. Its area is $abc/(4R) = \\sqrt 3 (1-d^2)/4$.\n\n\\textbf{Third solution:} (by Samuel Li)\nConsider the rotation by the angle $\\pi/3$ around $A$ carrying $B$ to $C$, and let $P_A$ be the image of $P$;\ndefine $P_B, P_C$ similarly.\nLet $A'$ be the intersection of the tangents to the circle at $B, C$; define $B', C'$, similarly.\nPut $\\ell = AB = BC = CA$; we then have\n\\begin{gather*}\nAB' = AC' = BC' = BA' = CA' = CB' = \\ell \\\\\nPA = PP_A = P_A A = P_B C' = P_C A' = a \\\\\nPB = PP_B = P_B B = P_C A' = P_A C' = b \\\\\nPC = PP_C = P_C C = P_A B' = P_B A' = c.\n\\end{gather*}\n\nThe triangle $\\triangle A'B'C'$ has area four times that of $\\triangle ABC$.\nWe may dissect it into twelve triangles by first splitting it into three quadrilaterals $PAC'B$, $PBC'A, PCA'B$, then splitting each of these in four around the respective interior points $P_B, P_C, P_A$. \nOf the resulting twelve triangles, three have side lengths $a,b,c$, while three are equilateral triangles\nof respective sides lengths $a,b,c$. The other six are isomorphic to two copies each of\n$\\triangle PAB, \\triangle PBC, \\triangle PCA$, so their total area is twice that of $\\triangle ABC$.\n\nIt thus suffices to compute $a^2 + b^2 + c^2$ in terms of the radius of the circle and the distance $OP$.\nThis can be done readily in terms of\n$OP$ using vectors, Cartesian coordinates, or complex numbers as in the first solution.", "category": "Geometry", "source": "PUTNAM", "year": 2003}
{"id": "putnam-2003-b6", "question": "Let  $f(x)$  be  a continuous real-valued function defined on the interval\n$[0,1]$. Show that\n\\[\n   \\int_0^1 \\int_0^1 | f(x) + f(y) |\\,dx\\,dy \\geq \\int_0^1 |f(x)|\\,dx.\n\\]\n\n\\end{itemize}\n\\end{document}", "solution": "\\textbf{First solution:} (composite of solutions by Feng Xie and David\nPritchard)\nLet $\\mu$ denote Lebesgue measure on $[0,1]$. Define\n\\begin{align*}\nE_+ &= \\{x \\in [0,1]: f(x) \\geq 0\\} \\\\\nE_- &= \\{x \\in [0,1]: f(x) < 0\\};\n\\end{align*}\nthen $E_+$, $E_-$ are measurable and $\\mu(E_+) + \\mu(E_-) = 1$.\nWrite $\\mu_+$ and $\\mu_-$ for $\\mu(E_+)$ and $\\mu(E_-)$.\nAlso define\n\\begin{align*}\nI_+ &= \\int_{E_+} |f(x)|\\,dx \\\\\nI_- &= \\int_{E_-} |f(x)|\\,dx,\n\\end{align*}\nso that $\\int_0^1 |f(x)|\\,dx = I_+ + I_-$.\n\nFrom the triangle inequality $|a+b| \\geq \\pm(|a| - |b|)$,\nwe have the inequality\n\\begin{align*}\n&\\iint_{E_+ \\times E_-} |f(x) + f(y)|\\,dx\\,dy \\\\\n&\\geq\n\\pm \\iint_{E_+ \\times E_-} (|f(x)| - |f(y)|)\\,dx\\,dy \\\\\n&= \\pm ( \\mu_- I_+ - \\mu_+ I_-),\n\\end{align*}\nand likewise with $+$ and $-$ switched. Adding these inequalities together\nand allowing all possible choices of the signs, we get\n\\begin{align*}\n&\\iint_{(E_+ \\times E_-) \\cup (E_- \\times E_+)} |f(x) + f(y)|\\,dx\\,dy \\\\\n&\\geq\n\\max\\left\\{ 0, 2 (\\mu_- I_+ - \\mu_+ I_-), 2 (\\mu_+ I_- - \\mu_- I_+) \\right\\}.\n\\end{align*}\nTo this inequality, we add the equalities\n\\begin{align*}\n\\iint_{E_+ \\times E_+} |f(x) + f(y)|\\,dx\\,dy &= 2 \\mu_+ I_+ \\\\\n\\iint_{E_- \\times E_-} |f(x) + f(y)|\\,dx\\,dy &= 2 \\mu_- I_- \\\\\n-\\int_0^1 |f(x)|\\,dx &= -(\\mu_+ + \\mu_-)(I_+ + I_-)\n\\end{align*}\nto obtain\n\\begin{multline*}\n\\int_0^1 \\int_0^1 |f(x)+f(y)|\\,dx\\,dy - \\int_0^1 |f(x)|\\,dx \\\\\n\\geq \\max\\{ (\\mu_+ - \\mu_-)(I_+ + I_-)+ 2\\mu_-(I_- - I_+), \\\\\n(\\mu_+ - \\mu_-)(I_+ - I_-), \\\\\n(\\mu_- - \\mu_+)(I_+ + I_-)+ 2\\mu_+(I_+ - I_-) \\}.\n\\end{multline*}\nNow simply note that for each of the possible comparisons between\n$\\mu_+$ and $\\mu_-$, and between $I_+$ and $I_-$, one of the three\nterms above is manifestly nonnegative. This yields the desired result.\n\n\\textbf{Second solution:}\nWe will show at the end that it\nis enough to prove a discrete analogue: if $x_1, \\dots, x_n$\nare real numbers, then\n\\[\n\\frac{1}{n^2} \\sum_{i,j=1}^n |x_i + x_j| \\geq \\frac{1}{n}\n\\sum_{i=1}^n |x_i|.\n\\]\nIn the meantime, we concentrate on this assertion.\n\nLet $f(x_1, \\dots, x_n)$ denote the difference between the two sides.\nWe induct\non the number of nonzero values of $|x_i|$. We leave for later the base case,\nwhere there is at most one such value. Suppose instead for now that there\nare two or more. Let $s$ be the smallest, and suppose without loss of\ngenerality that $x_1 = \\cdots = x_a = s$, $x_{a+1} = \\cdots = x_{a+b} = -s$,\nand for $i > a+b$, either $x_i = 0$ or $|x_i| > s$. (One of $a,b$ might be\nzero.)\n\nNow consider\n\\[\nf(\\overbrace{t, \\cdots,t}^{\\mbox{$a$ terms}},\\overbrace{-t,\\cdots,-t}^{\\mbox{$b$ terms}},x_{a+b+1},\\cdots, x_n)\n\\]\nas a function of $t$.\nIt is piecewise linear near $s$; in fact, it is\nlinear between 0 and\nthe smallest nonzero value among $|x_{a+b+1}|, \\dots, |x_n|$\n(which exists by hypothesis). Thus its minimum is achieved by one (or both)\nof those two endpoints. In other words, we can reduce the\nnumber of distinct nonzero absolute values among the $x_i$ without\nincreasing $f$. This\nyields the induction, pending verification of the base case.\n\nAs for the base case, suppose that $x_1 = \\cdots = x_a = s > 0$,\n$x_{a+1} = \\cdots = x_{a+b} = -s$, and $x_{a+b+1} = \\cdots = x_n = 0$.\n(Here one or even both of $a,b$ could be zero, though the latter case\nis trivial.)\nThen\n\\begin{multline*}\nf(x_1, \\dots, x_n) = \\frac{s}{n^2} (2a^2 + 2b^2 + (a+b)(n-a-b)) \\\\\n- \\frac{s}{n} (a+b) = \\frac{s}{n^2} (a^2 -2ab + b^2) \\geq 0.\n\\end{multline*}\nThis proves the base case of the induction, completing the solution\nof the discrete analogue.\n\nTo deduce the original statement from the discrete analogue,\napproximate both integrals\nby equally-spaced Riemann sums and take limits. This works because\ngiven a continuous function\non a product of closed intervals,\nany sequence of Riemann sums with mesh size tending to zero\nconverges to the integral. (The domain is compact, so\nthe function is uniformly continuous. Hence for any $\\epsilon > 0$\nthere is a cutoff below\nwhich any mesh size forces the\ndiscrepancy between the Riemann sum and the integral to be less than\n$\\epsilon$.)\n\nAlternate derivation (based on a solution by Dan Bernstein):\nfrom the discrete analogue, we have\n\\[\n\\sum_{1 \\leq i<j\\leq n} |f(x_i) + f(x_j)| \\geq \\frac{n-2}{2}\n\\sum_{i=1}^n |f(x_i)|,\n\\]\nfor all $x_1, \\dots, x_n \\in [0,1]$. Integrating both sides as\n$(x_1, \\dots, x_n)$ runs over\n$[0,1]^n$ yields\n\\begin{align*}\n&\\frac{n(n-1)}{2} \\int_0^1 \\int_0^1 |f(x)+f(y)|\\,dy\\,dx \\\\\n&\\geq\n\\frac{n(n-2)}{2} \\int_0^1 |f(x)|\\,dx,\n\\end{align*}\nor\n\\[\n\\int_0^1 \\int_0^1 |f(x)+f(y)|\\,dy\\,dx\n\\geq\n\\frac{n-2}{n-1} \\int_0^1 |f(x)|\\,dx.\n\\]\nTaking the limit as $n \\to \\infty$ now yields the desired result.\n\n\\textbf{Third solution:} (by David Savitt)\nWe give an argument which yields the following improved result.  Let\n$\\mu_p$ and $\\mu_n$ be the measure of the sets $\\{ x \\ : \\ f(x) > 0\\}$ and\n$\\{ x \\ : \\ f(x) < 0\\}$ respectively, and let $\\mu \\le 1/2$ be\n$\\min(\\mu_p,\\mu_n)$.  Then\n\\begin{align*}\n& \\int_{0}^{1} \\int_{0}^{1} |f(x) + f(y)|\\,dx\\,dy \\\\\n&\\ge (1 + (1-2\\mu)^2)\n\\int_{0}^{1} |f(x)|\\,dx.\n\\end{align*}\nNote that the constant can be seen to be best possible by considering a\nsequence of functions tending towards the step function which is $1$ on\n$[0,\\mu]$ and $-1$ on $(\\mu,1]$.\n\nSuppose without loss of generality that $\\mu = \\mu_p$.  As in the second\nsolution, it suffices to prove a\nstrengthened discrete analogue, namely\n\\[\n\\frac{1}{n^2} \\sum_{i,j} |a_i + a_j| \\ge\n    \\left(1 + \\left(1 - \\frac{2p}{n}\\right)^2\\right)\\left(\\frac{1}{n}\n    \\sum_{i=1}^{n} |a_i| \\right),\n\\]\nwhere $p \\le n/2$ is the number of $a_1,\\ldots,a_n$ which are positive.\n(We need only make sure to choose meshes so that $p/n \\to \\mu$ as\n$n \\to \\infty$.)\nAn equivalent inequality is\n\\[\n\\sum_{1 \\le i < j \\le n} | a_i + a_j | \\ge \\left(n - 1 - 2p +\n    \\frac{2p^2}{n}\\right) \\sum_{i=1}^{n} | a_i |.\n\\]\n\nWrite $r_i = |a_i|$, and assume without loss of generality that $r_i \\ge\nr_{i+1}$ for each $i$. Then for $i<j$,\n$|a_i + a_j| = r_i + r_j$ if $a_i$ and $a_j$\nhave the same sign, and is $r_i - r_j$ if they have opposite signs. The\nleft-hand side is therefore equal to\n\\[\n\\sum_{i = 1}^n (n - i) r_i + \\sum_{j = 1}^n r_j C_j,\n\\]\nwhere\n\\begin{multline*}\nC_j = \\#\\{ i < j \\ : \\sgn(a_i) = \\sgn(a_j)\\} \\\\\n- \\#\\{ i < j : \\sgn(a_i) \\neq \\sgn(a_j)\\}.\n\\end{multline*}\n\nConsider the partial sum $P_k = \\sum_{j = 1}^{k} C_j$.  If exactly $p_k$ of\n$a_1,\\ldots,a_k$ are positive, then this sum is equal to\n\\[\n\\binom{p_k}{2} + \\binom{k-p_k}{2} - \\left[ \\binom {k}{2} -\n\\binom{p_k}{2} - \\binom{k-p_k}{2} \\right],\n\\]\nwhich expands and simplifies to\n\\[\n-2 p_k (k-p_k) + \\binom{k}{2} \\,.\n\\]\nFor $k \\le 2p$ even, this partial sum would be minimized with $p_k = \\frac{k}{2}$,\nand would then equal $-\\frac{k}{2}$; for $k < 2p$ odd, this partial sum would\nbe minimized with $p_k = \\frac{k \\pm 1}{2}$, and would then equal\n$-\\frac{k-1}{2}$.  Either way, $P_k \\ge - \\lfloor \\frac{k}{2} \\rfloor$.  On the other\nhand, if $k > 2p$, then\n\\[\n-2 p_k (k-p_k) + \\binom{k}{2} \\ge -2 p(k-p) + \\binom{k}{2}\n\\]\nsince $p_k$ is at most $p$. Define $Q_k$ to\nbe $- \\lfloor \\frac{k}{2} \\rfloor$ if $k \\le\n2p$ and $-2 p(k-p) + \\binom{k}{2}$ if $k \\ge 2p$, so that $P_k \\ge Q_k$.  Note\nthat $Q_1=0$.\n\nPartial summation gives\n\\begin{align*}\n\\sum_{j = 1}^n r_j C_j & =  r_n P_n + \\sum_{j=2}^{n} (r_{j-1} - r_j)\nP_{j-1} \\\\\n& \\ge r_n Q_n + \\sum_{j=2}^{n} (r_{j-1} - r_j) Q_{j-1} \\\\\n& =  \\sum_{j=2}^{n} r_j (Q_j - Q_{j-1}) \\\\\n& =  - r_2 - r_4 - \\cdots - r_{2p} + \\sum_{j = 2p+1}^{n} (j-1-2p) r_j.\n\\end{align*}\nIt follows that\n\\begin{align*}\n\\sum_{1 \\le i < j \\le n} | a_i + a_j | \n    &= \\sum_{i = 1}^n (n - i) r_i + \\sum_{j = 1}^n r_j C_j \\\\\n& \\ge \\sum_{i = 1}^{2p} (n - i - [ i \\ \\text{even}]) r_i \\\\\n&\\quad + \\sum_{i = 2p+1}^{n} (n - 1 - 2p) r_i \\\\\n&  = (n-1-2p) \\sum_{i=1}^{n} r_i \\\\\n&\\quad + \\sum_{i=1}^{2p} (2p + 1 - i - [i \\ \\text{even}]) r_i \\\\\n&  \\ge  (n-1-2p) \\sum_{i=1}^{n} r_i + p \\sum_{i=1}^{2p} r_i \\\\\n&  \\ge  (n-1-2p) \\sum_{i=1}^{n} r_i + p\\frac{2p}{n} \\sum_{i=1}^{n} r_i\\,,\n\\end{align*}\nas desired.  The next-to-last and last inequalities each follow from the\nmonotonicity of the $r_i$'s, the former by pairing the $i^{\\textrm{th}}$\nterm with the $(2p+1-i)^{\\textrm{th}}$.\n\n\\textbf{Note:}\nCompare the closely related Problem 6 from the 2000 USA Mathematical\nOlympiad: prove that\nfor any nonnegative real numbers $a_1, \\dots, a_n, b_1, \\dots, b_n$,\none has\n\\[\n\\sum_{i,j=1}^n \\min\\{a_i a_j,b_i b_j\\} \\leq\n\\sum_{i,j=1}^n \\min\\{a_i b_j,a_j b_i\\}.\n\\]\n\n\\end{itemize}\n\n\\end{document}", "category": "Geometry", "source": "PUTNAM", "year": 2003}
{"id": "putnam-2007-a1", "question": "Find all values of $\\alpha$ for which the curves $y = \\alpha x^2 +\n\\alpha x + \\frac{1}{24}$ and $x = \\alpha y^2 + \\alpha y + \\frac{1}{24}$\nare tangent to each other.", "solution": "The only such $\\alpha$ are $2/3, 3/2, (13 \\pm \\sqrt{601})/12$.\n\n\\textbf{First solution:}\nLet $C_1$ and $C_2$ be the curves\n$y=\\alpha x^2 + \\alpha x + \\frac{1}{24}$\nand $x=\\alpha y^2 + \\alpha y + \\frac{1}{24}$, respectively,\nand let $L$ be the line $y=x$.\nWe consider three cases.\n\nIf $C_1$ is tangent to $L$, then the point of tangency $(x,x)$ satisfies\n\\[\n2\\alpha x + \\alpha = 1, \\qquad x = \\alpha x^2 + \\alpha x + \\frac{1}{24};\n\\]\nby symmetry, $C_2$ is tangent to $L$ there, so $C_1$ and $C_2$ are tangent.\nWriting $\\alpha = 1/(2x+1)$ in the first equation and substituting into\nthe second, we must have\n\\[\nx = \\frac{x^2+x}{2x+1} + \\frac{1}{24},\n\\]\nwhich simplifies to $0 = 24x^2 - 2x - 1\n= (6x+1)(4x-1)$, or $x \\in \\{1/4, -1/6\\}$. This yields\n$\\alpha = 1/(2x+1) \\in \\{2/3, 3/2\\}$.\n\nIf $C_1$ does not intersect $L$, then $C_1$ and $C_2$ are separated by $L$\nand so cannot be tangent.\n\nIf $C_1$ intersects $L$ in two distinct points $P_1, P_2$, then it is not\ntangent to $L$ at either point. Suppose at one of these points, say $P_1$,\nthe tangent to $C_1$ is perpendicular to $L$; then by symmetry, the same\nwill be true of $C_2$, so $C_1$ and $C_2$ will be tangent at $P_1$. In this\ncase, the point $P_1 = (x,x)$ satisfies\n\\[\n2 \\alpha x + \\alpha = -1, \\qquad x = \\alpha x^2 + \\alpha x + \\frac{1}{24};\n\\]\nwriting $\\alpha = -1/(2x+1)$ in the first equation and substituting into\nthe second, we have\n\\[\nx = -\\frac{x^2+x}{2x+1} + \\frac{1}{24},\n\\]\nor\n$x = (-23 \\pm \\sqrt{601})/72$.\nThis yields\n$\\alpha = -1/(2x+1) = (13 \\pm \\sqrt{601})/12$.\n\nIf instead the tangents to $C_1$ at $P_1, P_2$ are not perpendicular to\n$L$, then we claim there cannot be any point where $C_1$ and $C_2$ are tangent.\nIndeed, if we count intersections of $C_1$ and $C_2$ (by using $C_1$ to\nsubstitute for $y$ in $C_2$, then solving for $y$), we get at most four\nsolutions counting multiplicity. Two of these are $P_1$ and $P_2$,\nand any point of tangency counts for two more. However, off of $L$,\nany point of tangency would have a mirror image which is also a point of\ntangency, and there cannot be six solutions. Hence we have now found all\npossible $\\alpha$.\n\n\\textbf{Second solution:}\nFor any nonzero value of $\\alpha$, the two\nconics will intersect in four points in the complex projective plane\n$\\mathbb{P}^2(\\mathbb{C})$. To determine the\n$y$-coordinates of these intersection points, subtract the two equations\nto obtain\n\\[\n(y-x) = \\alpha(x-y)(x+y) + \\alpha(x-y).\n\\]\nTherefore, at\na point of intersection we have either $x=y$, or $x = -1/\\alpha - (y+1)$.\nSubstituting these two possible linear conditions into the second\nequation shows that the $y$-coordinate of a point of intersection is a\nroot of either\n$Q_1(y) = \\alpha y^2+(\\alpha-1)y + 1/24$ or\n$Q_2(y) = \\alpha y^2 + (\\alpha+1) y + 25/24 +1/\\alpha$.\n\nIf two curves\nare tangent, then the $y$-coordinates of at least two of the\nintersection points will coincide; the converse is also true because one of the\ncurves is the graph of a function in $x$. The coincidence\noccurs precisely when either\nthe discriminant of at least one of $Q_1$ or $Q_2$ is zero, or\nthere is a common root of $Q_1$ and $Q_2$. Computing the discriminants of $Q_1$\nand $Q_2$ yields (up to constant factors) $f_1(\\alpha)=6\\alpha^2 -\n13\\alpha + 6$ and $f_2(\\alpha)=6\\alpha^2 - 13\\alpha - 18$, respectively.\nIf on the other hand $Q_1$ and $Q_2$ have a common root, it must\nbe also a root of $Q_2(y) - Q_1(y) = 2y +1 + 1/\\alpha$,\nyielding $y = -(1+\\alpha)/(2\\alpha)$ and\n$0 = Q_1(y) = -f_2(\\alpha)/(24 \\alpha)$.\n\nThus the values of\n$\\alpha$ for which the two curves are tangent must be contained in the\nset of zeros of $f_1$ and $f_2$, namely $2/3$, $3/2$, and\n$(13\\pm\\sqrt{601})/12$.\n\n\\textbf{Remark:}\nThe fact that the two conics in $\\mathbb{P}^2(\\CC)$ meet in four points, counted\nwith multiplicities, is a special case of \\emph{B\\'ezout's theorem}: two\ncurves in $\\mathbb{P}^2(\\CC)$ of degrees $m, n$ and not sharing any common component\nmeet in exactly $mn$ points when counted with multiplicity.\n\nMany solvers were surprised that the proposers chose the parameter $1/24$\nto give two rational roots and two nonrational roots. In fact, they had\nno choice in the matter: attempting to make all four roots rational\nby replacing $1/24$ by $\\beta$ amounts\nto asking for $\\beta^2 + \\beta$ and $\\beta^2 + \\beta + 1$ to be perfect\nsquares. This cannot happen outside of trivial cases ($\\beta = 0, -1$)\nultimately because the elliptic curve 24A1 (in Cremona's notation)\nover $\\mathbb{Q}$ has rank $0$. (Thanks to Noam Elkies for providing this\ncomputation.)\n\nHowever, there are choices that make the radical milder,\ne.g., $\\beta = 1/3$  gives\n$\\beta^2 + \\beta = 4/9$ and $\\beta^2 + \\beta + 1 = 13/9$,\nwhile $\\beta = 3/5$ gives $\\beta^2 + \\beta = 24/25$\nand $\\beta^2 + \\beta + 1 = 49/25$.", "category": "Geometry", "source": "PUTNAM", "year": 2007}
{"id": "putnam-2007-a2", "question": "Find the least possible area of a convex set in the plane that\nintersects both branches of the hyperbola $xy = 1$ and both branches of\nthe hyperbola $xy = -1$. (A set $S$ in the plane is called \\emph{convex}\nif for any two points in $S$ the line segment connecting them is\ncontained in $S$.)", "solution": "The minimum is 4, achieved by the square with vertices $(\\pm 1, \\pm 1)$.\n\n\\textbf{First solution:}\nTo prove that 4 is a lower bound, let $S$ be a convex set of the desired\nform. Choose $A,B,C,D \\in S$ lying on the branches of the two hyperbolas,\nwith $A$ in the upper right\nquadrant, $B$ in the upper left, $C$ in the lower left, $D$ in the lower right.\nThen the area of the quadrilateral $ABCD$ is a lower bound for\nthe area of $S$.\n\nWrite $A = (a,1/a)$,\n$B = (-b,1/b)$, $C = (-c,-1/c)$, $D = (d, -1/d)$ with $a,b,c,d > 0$.\nThen the area of the quadrilateral $ABCD$ is\n\\[\n\\frac{1}{2}(a/b + b/c + c/d + d/a + b/a + c/b + d/c + a/d),\n\\]\nwhich by the arithmetic-geometric mean inequality is at least\n$4$.\n\n\\textbf{Second solution:}\nChoose $A,B,C,D$ as in the first solution.\nNote that both the hyperbolas and the area of the convex hull of $ABCD$ are\ninvariant under the transformation $(x,y) \\mapsto (xm, y/m)$ for any\n$m>0$. For $m$ small, the counterclockwise angle from the line $AC$ to\nthe line $BD$ approaches 0; for $m$ large, this angle approaches $\\pi$.\nBy continuity, for some $m$ this angle becomes $\\pi/2$, that is,\n$AC$ and $BD$ become perpendicular. The area of $ABCD$\nis then $AC \\cdot BD$.\n\nIt thus suffices to note that $AC \\geq 2 \\sqrt{2}$ (and similarly for $BD$).\nThis holds because if we draw the tangent lines to the hyperbola $xy=1$\nat the points $(1,1)$ and $(-1,-1)$, then $A$ and $C$ lie outside the region\nbetween these lines. If we project the segment $AC$ orthogonally\nonto the line $x=y=1$, the resulting projection has length at\nleast $2 \\sqrt{2}$,\nso $AC$ must as well.\n\n\\textbf{Third solution:}\n(by Richard Stanley)\nChoose $A,B,C,D$ as in the first solution. Now fixing $A$ and $C$, move $B$ and\n$D$ to the points at which the tangents to the curve are parallel to the line\n$AC$. This does not increase the area of the quadrilateral $ABCD$ (even if\nthis quadrilateral is not convex).\n\nNote that $B$ and $D$ are now diametrically opposite; write $B = (-x, 1/x)$\nand $D = (x, -1/x)$. If we thus repeat the\nprocedure, fixing $B$ and $D$ and moving $A$ and $C$ to the points where the\ntangents are parallel to $BD$, then $A$ and $C$ must move to $(x, 1/x)$\nand $(-x,-1/x)$, respectively, forming a rectangle of area 4.\n\n\\textbf{Remark:}\nMany geometric solutions are possible. An example suggested by David Savitt\n(due to Chris Brewer):\nnote that $AD$ and $BC$ cross the\npositive and negative $x$-axes, respectively, so the convex hull of $ABCD$\ncontains $O$. Then check that the area of triangle $OAB$ is at least 1, et cetera.", "category": "Geometry", "source": "PUTNAM", "year": 2007}
{"id": "putnam-2007-a3", "question": "Let $k$ be a positive integer. Suppose that the integers $1, 2, 3,\n\\dots, 3k+1$ are written down in random order. What is the probability\nthat at no time during this process, the sum of the integers that have\nbeen written up to that time is a positive integer divisible by 3? Your\nanswer should be in closed form, but may include factorials.", "solution": "Assume that we have an ordering of $1,2,\\dots,3k+1$ such\n  that no initial subsequence sums to $0$ mod $3$. If we omit the\n  multiples of $3$ from this ordering, then the remaining sequence mod\n  $3$ must look like $1,1,-1,1,-1,\\ldots$ or $-1,-1,1,-1,1,\\ldots$.\n  Since there is one more integer in the ordering congruent to $1$ mod\n  $3$ than to $-1$, the sequence mod $3$ must look like\n  $1,1,-1,1,-1,\\ldots$.\n\n  It follows that the ordering satisfies the given condition if and\n  only if the following two conditions hold: the first element in the\n  ordering is not divisible by $3$, and the sequence mod $3$ (ignoring\nzeroes) is of the form $1,1,-1,1,-1,\\ldots$. The two conditions are\n  independent, and the probability of the first is $(2k+1)/(3k+1)$\nwhile the probability of the second is\n$1/\\binom{2k+1}{k}$,\n  since there are $\\binom{2k+1}{k}$ ways to order $(k+1)$ $1$'s and $k$\n  $-1$'s.\n  Hence the desired probability is the product of these two, or\n  $\\frac{k!(k+1)!}{(3k+1)(2k)!}$.", "category": "Combinatorics", "source": "PUTNAM", "year": 2007}
{"id": "putnam-2007-a4", "question": "A \\emph{repunit} is a positive integer whose digits in base 10 are\nall ones. Find all polynomials $f$ with real coefficients such that if\n$n$ is a repunit, then so is $f(n)$.", "solution": "Note that $n$ is a repunit if and only if $9n+1 = 10^m$ for some power of\n10 greater than 1. Consequently, if we put\n\\[\ng(n) = 9f\\left( \\frac{n-1}{9} \\right) + 1,\n\\]\nthen $f$ takes repunits to repunits if and only if $g$ takes powers of 10\ngreater than 1 to powers of 10 greater than 1. We will show that the only\nsuch functions $g$ are those of the form $g(n) = 10^c n^d$ for $d \\geq 0$,\n$c \\geq 1-d$ (all of which clearly work),\nwhich will mean that the desired polynomials $f$ are those of the form\n\\[\nf(n) = \\frac{1}{9}(10^c (9n+1)^d - 1)\n\\]\nfor the same $c,d$.\n\nIt is convenient to allow ``powers of 10'' to be of the form\n$10^k$ for any integer $k$. With this convention, it suffices to check that\nthe polynomials $g$ taking powers of 10 greater than 1 to powers of 10\nare of the form $10^c n^d$ for any integers $c,d$ with $d \\geq 0$.\n\n\\textbf{First solution:}\nSuppose that the leading term of $g(x)$ is $ax^d$, and note that\n$a>0$. As $x \\to \\infty$, we have $g(x)/x^d \\to a$; however, for $x$\na power of 10 greater than 1, $g(x)/x^d$ is a power of 10.\nThe set of powers of 10 has no positive limit point, so $g(x)/x^d$\nmust be equal to $a$ for $x = 10^k$ with $k$ sufficiently large,\nand we must have $a = 10^c$ for some $c$.\nThe polynomial $g(x) - 10^c x^d$ has infinitely many roots, so\nmust be identically zero.\n\n\\textbf{Second solution:}\nWe proceed by induction on $d = \\deg(g)$.\nIf $d=0$, we have $g(n) = 10^c$ for some $c$. Otherwise,\n$g$ has rational coefficients by Lagrange's interpolation formula (this\napplies to any polynomial of degree $d$ taking at least $d+1$\ndifferent rational numbers to rational numbers), so $g(0) = t$ is rational.\nMoreover, $g$ takes each value only finitely many times, so the sequence\n$g(10^0), g(10^1), \\dots$ includes arbitrarily large powers of 10.\nSuppose that $t \\neq 0$; then we can choose a positive integer $h$ such that\nthe numerator of $t$ is not divisible by $10^h$.\nBut for $c$ large enough, $g(10^c) - t$ has numerator divisible by\n$10^b$ for some $b>h$, contradiction.\n\nConsequently, $t=0$, and we may apply the induction hypothesis to $g(n)/n$\nto deduce the claim.\n\n\\textbf{Remark:} The second solution amounts to the fact that $g$, being\na polynomial with rational coefficients, is continuous for the $2$-adic\nand $5$-adic topologies on $\\mathbb{Q}$. By contrast, the first solution\nuses the ``$\\infty$-adic'' topology, i.e., the usual real topology.", "category": "Number Theory", "source": "PUTNAM", "year": 2007}
{"id": "putnam-2007-a5", "question": "Suppose that a finite group has exactly $n$ elements of order $p$,\nwhere $p$ is a prime. Prove that either $n=0$ or $p$ divides $n+1$.", "solution": "In all solutions, let $G$ be a finite group of order $m$.\n\n\\textbf{First solution:}\nBy Lagrange's theorem, if $m$ is\nnot divisible by $p$, then $n = 0$. Otherwise, let $S$ be the set of\n$p$-tuples $(a_0,\\dots,a_{p-1}) \\in G^p$ such that $a_0 \\cdots a_{p-1} = e$;\nthen $S$ has cardinality $m^{p-1}$, which is divisible by $p$.\nNote that this set is invariant under cyclic permutation, that is,\nif $(a_0,\\dots,a_{p-1}) \\in S$, then $(a_1,\\dots,a_{p-1},a_0) \\in S$ also.\nThe fixed points under this operation are the tuples\n$(a,\\dots,a)$ with $a^p = e$; all other tuples can be grouped into orbits\nunder cyclic permutation, each of which has size $p$. Consequently,\nthe number of $a \\in G$ with $a^p = e$ is divisible by $p$; since that number\nis $n+1$ (only $e$ has order 1), this proves the claim.\n\n\\textbf{Second solution:}\n(by Anand Deopurkar)\nAssume that $n > 0$, and let $H$ be any subgroup of $G$ of order $p$.\nLet $S$ be the set of all elements of $G \\setminus H$\nof order dividing $p$, and let\n$H$ act on $G$ by conjugation. Each orbit has size $p$ except for those\nwhich consist of individual elements $g$ which commute with $H$.\nFor each such $g$, $g$ and $H$ generate an elementary abelian subgroup of\n$G$ of order $p^2$. However, we can group these $g$ into sets of size\n$p^2-p$ based on which subgroup they generate together with $H$.\nHence the cardinality of $S$ is divisible by $p$; adding the $p-1$\nnontrivial elements of $H$ gives $n \\equiv -1 \\pmod{p}$ as desired.\n\n\\textbf{Third solution:}\nLet $S$ be the set of elements in $G$ having order dividing $p$, and let\n$H$ be an elementary abelian $p$-group of maximal order in $G$.  If\n$|H|=1$, then we are done.  So assume $|H|=p^k$ for some $k\\geq 1$, and\nlet $H$ act on $S$ by conjugation.  Let $T\\subset S$ denote the set of\nfixed points of this action.  Then the size of every $H$-orbit on $S$\ndivides $p^k$, and so $|S|\\equiv |T| \\pmod{p}$.\nOn the other hand, $H\\subset T$, and if $T$ contained an element not in $H$,\nthen that would contradict the maximality of $H$.  It follows that\n$H=T$, and so $|S|\\equiv |T| = |H| = p^k \\equiv 0 \\pmod{p}$,\ni.e., $|S|=n+1$ is a multiple of $p$.\n\n\\textbf{Remark:} This result is a theorem of Cauchy; the first solution\nabove is due to McKay. A more general (and more difficult) result was proved\nby Frobenius: for any positive integer $m$, if $G$ is a finite group of order\ndivisible by $m$, then the number of elements of $G$ of order dividing $m$\nis a multiple of $m$.", "category": "Number Theory", "source": "PUTNAM", "year": 2007}
{"id": "putnam-2007-a6", "question": "A \\emph{triangulation} $\\mathcal{T}$ of a polygon $P$ is a finite\ncollection of triangles whose union is $P$, and such that the\nintersection of any two triangles is either empty, or a shared vertex,\nor a shared side. Moreover, each side is a side of exactly one triangle\nin $\\mathcal{T}$. Say that $\\mathcal{T}$ is \\emph{admissible} if every\ninternal vertex is shared by 6 or more triangles. For example, [figure\nomitted.] Prove that there is an integer $M_n$, depending only on $n$,\nsuch that any admissible triangulation of a polygon $P$ with $n$ sides\nhas at most $M_n$ triangles.", "solution": "For an admissible triangulation $\\mathcal{T}$, number the\n  vertices of $P$ consecutively $v_1,\\dots,v_n$, and let $a_i$ be the\n  number of edges in $\\mathcal{T}$ emanating from $v_i$; note that\n  $a_i \\geq 2$ for all $i$.\n\n  We first claim that $a_1+\\dots+a_n \\leq 4n-6$. Let $V,E,F$ denote\n  the number of vertices, edges, and faces in $\\mathcal{T}$. By\n  Euler's Formula, $(F+1)-E+V=2$ (one must add 1 to the face count for the\n  region exterior to $P$). Each face has three edges, and each edge but the\n  $n$ outside edges belongs to two faces; hence $F = 2E-n$. On the\n  other hand, each edge has two endpoints, and each of the $V-n$\n  internal vertices is an endpoint of at least $6$ edges; hence\n  $a_1+\\dots+a_n+6(V-n) \\leq 2E$. Combining this inequality with the\n  previous two equations gives\n\\begin{align*}\na_1+\\dots+a_n &\\leq 2E+6n-6(1-F+E) \\\\\n&= 4n-6,\n\\end{align*}\nas claimed.\n\nNow set $A_3 = 1$ and $A_n = A_{n-1}+2n-3$ for $n \\geq 4$; we will\nprove by induction on $n$ that $\\mathcal{T}$ has at most $A_n$\ntriangles. For $n=3$, since $a_1+a_2+a_3=6$, $a_1=a_2=a_3=2$ and hence\n$\\mathcal{T}$ consists of just one triangle.\n\nNext assume that an admissible triangulation of an $(n-1)$-gon has at\nmost $A_{n-1}$ triangles, and let $\\mathcal{T}$ be an admissible\ntriangulation of an $n$-gon. If any $a_i = 2$, then we can remove the\ntriangle of $\\mathcal{T}$ containing vertex $v_i$ to obtain an\nadmissible triangulation of an $(n-1)$-gon; then the number of\ntriangles in $\\mathcal{T}$ is at most $A_{n-1}+1 < A_n$ by induction.\nOtherwise, all $a_i \\geq 3$. Now the average of $a_1,\\dots,a_n$ is\nless than $4$, and thus there are more $a_i = 3$ than $a_i \\geq 5$. It\nfollows that there is a sequence of $k$ consecutive vertices in $P$\nwhose degrees are $3,4,4,\\ldots,4,3$ in order, for some $k$ with\n$2\\leq k\\leq n-1$ (possibly $k=2$, in which case there are no degree\n$4$ vertices separating the degree $3$ vertices). If we remove from\n$\\mathcal{T}$ the $2k-1$ triangles which contain at least one of these\nvertices, then we are left with an admissible triangulation of an\n$(n-1)$-gon. It follows that there are at most $A_{n-1}+2k-1 \\leq\nA_{n-1}+2n-3 = A_n$ triangles in $\\mathcal{T}$. This completes the\ninduction step and the proof.\n\n\\textbf{Remark:}\nWe can refine the bound $A_n$ somewhat.\nSupposing that $a_i \\geq 3$ for all\n$i$, the fact that $a_1 + \\cdots + a_n \\leq 4n-6$ implies that there are at least\nsix more indices $i$ with $a_i = 3$ than with $a_i \\geq 5$. Thus there exist\nsix sequences with degrees $3,4,\\dots,4,3$, of total length at most\n$n+6$. We may thus choose a sequence of length $k \\leq \\lfloor \\frac{n}{6}\n\\rfloor + 1$, so we may improve the upper bound to $A_n = A_{n-1} +\n2 \\lfloor \\frac{n}{6} \\rfloor + 1$, or asymptotically\n$\\frac{1}{6} n^2$.\n\nHowever (as noted by Noam Elkies), a hexagonal swatch of a triangular\nlattice, with the boundary as close to regular as possible,\nachieves asymptotically $\\frac{1}{6} n^2$ triangles.", "category": "Combinatorics", "source": "PUTNAM", "year": 2007}
{"id": "putnam-2007-b1", "question": "Let $f$ be a polynomial with positive integer coefficients. Prove\nthat if $n$ is a positive integer, then $f(n)$ divides $f(f(n)+1)$ if\nand only if $n=1$. [Editor's note: one must assume $f$ is nonconstant.]", "solution": "The problem fails if $f$ is allowed to be constant, e.g., take $f(n) = 1$.\nWe thus assume that $f$ is nonconstant.\nWrite $f(n) = \\sum_{i=0}^d a_i n^i$ with $a_i > 0$. Then\n\\begin{align*}\nf(f(n)+1) &= \\sum_{i=0}^d a_i (f(n) + 1)^i \\\\\n&\\equiv f(1) \\pmod{f(n)}.\n\\end{align*}\nIf $n = 1$, then this implies that $f(f(n)+1)$ is divisible by $f(n)$.\nOtherwise, $0 < f(1) < f(n)$ since $f$ is nonconstant and has positive\ncoefficients, so $f(f(n)+1)$ cannot be divisible by $f(n)$.", "category": "Number Theory", "source": "PUTNAM", "year": 2007}
{"id": "putnam-2007-b2", "question": "Suppose that $f: [0,1] \\to \\mathbb{R}$ has a continuous derivative\nand that $\\int_0^1 f(x)\\,dx = 0$. Prove that for every $\\alpha \\in (0,1)$,\n\\[\n\\left| \\int_0^\\alpha f(x)\\,dx \\right| \\leq \\frac{1}{8} \\max_{0 \\leq x\n\\leq 1} |f'(x)|.\n\\]", "solution": "Put $B = \\max_{0 \\leq x \\leq 1} |f'(x)|$\nand $g(x) = \\int_0^x f(y)\\,dy$. Since $g(0) = g(1) = 0$, the maximum value\nof $|g(x)|$ must occur at a critical point $y \\in (0,1)$ satisfying\n$g'(y) = f(y) = 0$. We may thus take $\\alpha = y$ hereafter.\n\nSince $\\int_0^\\alpha f(x)\\,dx = -\\int_0^{1-\\alpha} f(1-x)\\,dx$,\nwe may assume that $\\alpha \\leq 1/2$. By then substituting $-f(x)$\nfor $f(x)$ if needed, we may assume that $\\int_0^\\alpha f(x)\\,dx \\geq 0$.\n{}From the inequality $f'(x) \\geq -B$, we deduce\n$f(x) \\leq B(\\alpha - x)$ for $0 \\leq x \\leq \\alpha$, so\n\\begin{align*}\n\\int_0^\\alpha f(x)\\,dx \\leq &\\int_0^\\alpha B(\\alpha-x)\\,dx \\\\\n&= -\\left. \\frac{1}{2} B (\\alpha - x)^2 \\right|_0^\\alpha \\\\\n&= \\frac{\\alpha^2}{2} B \\leq \\frac{1}{8} B\n\\end{align*}\nas desired.", "category": "Algebra", "source": "PUTNAM", "year": 2007}
{"id": "putnam-2007-b3", "question": "Let $x_0 = 1$ and for $n \\geq 0$, let $x_{n+1} = 3x_n + \\lfloor x_n\n\\sqrt{5} \\rfloor$. In particular, $x_1 = 5$, $x_2 = 26$, $x_3 = 136$,\n$x_4 = 712$. Find a closed-form expression for $x_{2007}$. ($\\lfloor a\n\\rfloor$ means the largest integer $\\leq a$.)", "solution": "\\textbf{First solution:}\nObserving that $x_2/2 = 13$, $x_3/4=34$, $x_4/8=89$, we\nguess that $x_n = 2^{n-1} F_{2n+3}$, where $F_k$ is the $k$-th\nFibonacci number. Thus we claim that $x_n = \\frac{2^{n-1}}{\\sqrt{5}}\n(\\alpha^{2n+3}-\\alpha^{-(2n+3)})$, where $\\alpha =\n\\frac{1+\\sqrt{5}}{2}$, to make the answer $x_{2007} =\n\\frac{2^{2006}}{\\sqrt{5}}(\\alpha^{3997}-\\alpha^{-3997})$.\n\nWe prove the claim by induction; the base case $x_0 = 1$ is true, and\nso it suffices to show that the recursion $x_{n+1} = 3x_n + \\lfloor\nx_n \\sqrt{5} \\rfloor$ is satisfied for our formula for $x_n$. Indeed,\nsince $\\alpha^2 = \\frac{3+\\sqrt{5}}{2}$, we have\n\\begin{align*}\nx_{n+1}-(3+\\sqrt{5})x_n &= \\frac{2^{n-1}}{\\sqrt{5}}\n(2(\\alpha^{2n+5}-\\alpha^{-(2n+5)}) \\\\\n&\\quad-(3+\\sqrt{5})(\\alpha^{2n+3}-\\alpha^{-(2n+3)})) \\\\\n&= 2^n \\alpha^{-(2n+3)}.\n\\end{align*}\nNow $2^n \\alpha^{-(2n+3)} =\n(\\frac{1-\\sqrt{5}}{2})^3 (3-\\sqrt{5})^n$ is between $-1$ and $0$; the\nrecursion follows since $x_n,x_{n+1}$ are integers.\n\n\\textbf{Second solution:}\n(by Catalin Zara)\nSince $x_n$ is rational, we have $0 < x_n \\sqrt{5} - \\lfloor x_n \\sqrt{5}\n\\rfloor < 1$. We now have the inequalities\n\\begin{gather*}\nx_{n+1}-3x_n < x_n \\sqrt{5} < x_{n+1} -3x_n+1 \\\\\n(3+\\sqrt{5})x_n - 1 < x_{n+1} < (3+\\sqrt{5})x_n \\\\\n4x_n - (3-\\sqrt{5}) < (3-\\sqrt{5})x_{n+1} < 4x_n \\\\\n3x_{n+1} - 4x_n < x_{n+1} \\sqrt{5} < 3x_{n+1}-4x_n + (3-\\sqrt{5}).\n\\end{gather*}\nSince $0 < 3-\\sqrt{5} < 1$, this yields $\\lfloor x_{n+1} \\sqrt{5}\n\\rfloor = 3x_{n+1} - 4x_n$, so we can rewrite the recursion as\n$x_{n+1} = 6x_n - 4x_{n-1}$ for $n \\geq 2$. It is routine to solve\nthis recursion to obtain the same solution as above.\n\n\\textbf{Remark:}\nWith an initial 1 prepended,\nthis becomes\nsequence A018903 in Sloane's On-Line Encyclopedia of Integer Sequences:\n(\\texttt{http://www.research.att.com/\\~{}njas/ sequences/}).\nTherein, the sequence is described as the case $S(1,5)$ of the sequence\n$S(a_0, a_1)$ in which $a_{n+2}$ is the least integer for which\n$a_{n+2}/a_{n+1}>a_{n+1}/a_n$. Sloane cites\n D. W. Boyd, Linear recurrence relations for some generalized Pisot sequences,\n\\textit{Advances in Number Theory (Kingston, ON, 1991)}, Oxford Univ.\nPress, New York, 1993, p.\\ 333--340.", "category": "Number Theory", "source": "PUTNAM", "year": 2007}
{"id": "putnam-2007-b4", "question": "Let $n$ be a positive integer. Find the number of pairs $P, Q$ of\npolynomials with real coefficients such that\n\\[\n(P(X))^2 + (Q(X))^2 = X^{2n} + 1\n\\]\nand $\\deg P > \\deg Q$.", "solution": "The number of pairs is $2^{n+1}$. The degree condition forces\n$P$ to have degree $n$ and leading coefficient $\\pm 1$; we may count\npairs in which $P$ has leading coefficient 1 as long as we multiply by $2$\nafterward.\n\nFactor both sides:\n\\begin{align*}\n& (P(X) + Q(X)i)(P(X) - Q(X)i) \\\\\n& = \\prod_{j=0}^{n-1}\n(X - \\exp(2 \\pi i (2j+1)/(4n))) \\\\\n& \\quad \\cdot \\prod_{j=0}^{n-1}\n(X + \\exp(2 \\pi i (2j+1)/(4n))).\n\\end{align*}\nThen each choice of $P,Q$ corresponds to equating $P(X) + Q(X)i$\nwith the product of some $n$ factors on the right,\nin which we choose exactly of the two factors for each $j=0,\\dots,n-1$.\n(We must take exactly $n$\nfactors because as a polynomial in $X$ with complex coefficients, $P(X) + Q(X)i$\nhas degree exactly $n$. We must choose one for each $j$ to ensure that\n$P(X) + Q(X)i$ and $P(X) -Q(X)i$ are complex conjugates, so that $P, Q$ have\nreal coefficients.) Thus there are $2^n$ such pairs;\nmultiplying by 2 to allow $P$ to have\nleading coefficient $-1$ yields the desired result.\n\n\\textbf{Remark:} If we allow $P$ and $Q$ to have complex coefficients but\nstill require $\\deg(P) > \\deg(Q)$, then the number of pairs increases\nto $2\\binom{2n}{n}$, as we may choose any $n$ of the $2n$ factors of\n$X^{2n}+1$ to use to form $P(X) + Q(X)i$.", "category": "Algebra", "source": "PUTNAM", "year": 2007}
{"id": "putnam-2007-b5", "question": "Let $k$ be a positive integer. Prove that there exist polynomials\n$P_0(n), P_1(n), \\dots, P_{k-1}(n)$ (which may depend on $k$) such that\nfor any integer $n$,\n\\[\n\\left\\lfloor \\frac{n}{k} \\right\\rfloor^k = P_0(n) + P_1(n) \\left\\lfloor\n\\frac{n}{k} \\right\\rfloor + \\cdots + P_{k-1}(n) \\left\\lfloor \\frac{n}{k}\n\\right\\rfloor^{k-1}.\n\\]\n($\\lfloor a \\rfloor$ means the largest integer $\\leq a$.)", "solution": "For $n$ an integer, we have\n$\\left\\lfloor \\frac{n}{k} \\right\\rfloor = \\frac{n-j}{k}$ for $j$\nthe unique integer in $\\{0,\\dots,k-1\\}$ congruent to $n$ modulo $k$;\nhence\n\\[\n\\prod_{j=0}^{k-1} \\left( \\left\\lfloor \\frac{n}{k} \\right\\rfloor - \\frac{n-j}{k}\n\\right) = 0.\n\\]\nBy expanding this out, we obtain\nthe desired polynomials $P_0(n), \\dots, P_{k-1}(n)$.\n\n\\textbf{Remark:} Variants of this solution are possible that\nconstruct the $P_i$\nless explicitly, using Lagrange interpolation or Vandermonde determinants.", "category": "Algebra", "source": "PUTNAM", "year": 2007}
{"id": "putnam-2007-b6", "question": "For each positive integer $n$, let $f(n)$ be the number of ways to\nmake $n!$ cents using an unordered collection of coins, each worth $k!$\ncents for some $k$, $1 \\leq k \\leq n$. Prove that for some constant $C$,\nindependent of $n$,\n\\[\nn^{n^2/2 - Cn} e^{-n^2/4} \\leq f(n) \\leq n^{n^2/2 + Cn}e^{-n^2/4}.\n\\]\n\n\\end{itemize}\n\n\\end{document}", "solution": "(Suggested by Oleg Golberg)\nAssume $n \\geq 2$, or else the problem\nis trivially false.\nThroughout this proof, any $C_i$ will be a positive constant whose exact\nvalue is immaterial.\nAs in the proof of Stirling's approximation, we\nestimate for any fixed $c \\in \\RR$,\n\\[\n\\sum_{i=1}^n (i+c) \\log i =\n\\frac{1}{2} n^2 \\log n - \\frac{1}{4} n^2 + O(n \\log n)\n\\]\nby comparing the sum to an integral. This gives\n\\begin{align*}\nn^{n^2/2-C_1 n} e^{-n^2/4} &\\leq 1^{1+c} 2^{2+c} \\cdots n^{n+c} \\\\\n&\\leq n^{n^2/2+C_2 n} e^{-n^2/4}.\n\\end{align*}\nWe now interpret $f(n)$ as counting the number of $n$-tuples\n$(a_1, \\dots, a_n)$ of nonnegative integers such that\n\\[\na_1 1! + \\cdots + a_n n! = n!.\n\\]\nFor an upper bound on $f(n)$, we use the inequalities\n$0 \\leq a_i \\leq n!/i!$ to deduce that there are at most $n!/i! + 1 \\leq 2(n!/i!)$\nchoices for $a_i$. Hence\n\\begin{align*}\nf(n) &\\leq 2^n \\frac{n!}{1!} \\cdots \\frac{n!}{n!} \\\\\n&= 2^n 2^1 3^2 \\cdots n^{n-1} \\\\\n&\\leq n^{n^2/2+C_3 n} e^{-n^2/4}.\n\\end{align*}\nFor a lower bound on $f(n)$, we note that if $0 \\leq a_i < (n-1)!/i!$\nfor $i=2,\\dots,n-1$ and $a_n = 0$,\nthen $0 \\leq a_2 2! + \\cdots + a_n n! \\leq n!$, so there is a unique\nchoice of $a_1$ to complete this to a solution of\n$a_1 1! + \\cdots + a_n n! = n!$. Hence\n\\begin{align*}\nf(n) &\\geq \\frac{(n-1)!}{2!} \\cdots \\frac{(n-1)!}{(n-1)!} \\\\\n&= 3^1 4^2 \\cdots (n-1)^{n-3} \\\\\n&\\geq n^{n^2/2+C_4 n} e^{-n^2/4}.\n\\end{align*}\n\n\\end{itemize}\n\\end{document}", "category": "Combinatorics", "source": "PUTNAM", "year": 2007}
{"id": "imo-2017-q1", "question": "For each integer $a_0 > 1$, define the sequence $a_0$, $a_1$, $a_2$,\n\\dots, by\n\\[\n  a_{n+1} =\n  \\begin{cases}\n    \\sqrt{a_n} & \\text{if $\\sqrt{a_n}$ is an integer,} \\\\\n    a_n + 3 & \\text{otherwise}\n  \\end{cases}\n\\]\nfor each $n \\ge 0$.\nDetermine all values of $a_0$ for which there is a number $A$\nsuch that $a_n = A$ for infinitely many values of $n$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p8633268}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFor each integer $a_0 > 1$, define the sequence $a_0$, $a_1$, $a_2$,\n\\dots, by\n\\[\n  a_{n+1} =\n  \\begin{cases}\n    \\sqrt{a_n} & \\text{if $\\sqrt{a_n}$ is an integer,} \\\\\n    a_n + 3 & \\text{otherwise}\n  \\end{cases}\n\\]\nfor each $n \\ge 0$.\nDetermine all values of $a_0$ for which there is a number $A$\nsuch that $a_n = A$ for infinitely many values of $n$.\n\\end{mdframed}\nThe answer is $a_0 \\equiv 0 \\pmod 3$ only.\n\n\\paragraph{First solution.}\nWe first compute the minimal term of any sequence, periodic or not.\n\n\\begin{lemma*}\n  Let $c$ be the smallest term in $a_n$.\n  Then either $c \\equiv 2 \\pmod 3$ or $c = 3$.\n\\end{lemma*}\n\\begin{proof}\n  Clearly $c \\neq 1, 4$.\n  Assume $c \\not\\equiv 2 \\pmod 3$.\n  As $c$ is not itself a square,\n  the next perfect square after $c$ in the sequence\n  is one of $\\left( \\left\\lfloor \\sqrt c \\right\\rfloor + 1\\right)^2$,\n  $\\left( \\left\\lfloor \\sqrt c \\right\\rfloor + 2\\right)^2$,\n  or $\\left( \\left\\lfloor \\sqrt c \\right\\rfloor + 3\\right)^2$.\n  So by minimality we require\n  \\[ c \\le \\left\\lfloor \\sqrt c \\right\\rfloor + 3 \\le \\sqrt c + 3 \\]\n  which requires $c \\le 5$.\n  Since $c \\neq 1,2,4,5$ we conclude $c = 3$.\n\\end{proof}\n\nNow we split the problem into two cases:\n\n\\begin{itemize}\n\\ii If $a_0 \\equiv 0 \\pmod 3$, then all terms of the sequence are $0 \\pmod 3$.\nThe smallest term of the sequence is thus $3$ by the lemma\nand we have \\[ 3 \\to 6 \\to 9 \\to 3 \\]\nso $A = 3$ works fine.\n\n\\ii If $a_0 \\not\\equiv 0 \\pmod 3$,\nthen no term of the sequence is $0 \\pmod 3$,\nand so in particular $3$ does not appear in the sequence.\nSo the smallest term of the sequence is $2 \\pmod 3$ by lemma.\nBut since no squares are $2 \\pmod 3$,\nthe sequence $a_k$ grows without bound forever after,\nso no such $A$ can exist.\n\\end{itemize}\n\nHence the answer is $a_0 \\equiv 0 \\pmod 3$ only.\n\n\\paragraph{Second solution.}\nWe clean up the argument by proving the following lemma.\n\\begin{lemma*}\n  If $a_n$ is constant modulo $3$ and not $2 \\pmod 3$,\n  then $a_n$ must eventually cycle in the form\n  $(m, m+3, m+6, \\dots, m^2)$,\n  with no squares inside the cycle except $m^2$.\n\\end{lemma*}\n\\begin{proof}\n  Observe that $a_n$ must eventually hit a square, say $a_k = c^2$;\n  the next term is $a_{k+1} = c$.\n  Then it is forever impossible to exceed $c^2$ again,\n  by what is essentially discrete intermediate value theorem.\n  Indeed, suppose $a_\\ell > c^2$ and take $\\ell > k$ minimal\n  (in particular $a_{\\ell} \\neq \\sqrt{a_{\\ell-1}}$).\n  % We have $a_{\\ell-1} \\neq a_{\\ell}^2$, since otherwise.\n  Thus $a_{\\ell-1} \\in \\{c^2-2, c^2-1, c^2\\}$\n  and thus for modulo $3$ reasons we have $a_{\\ell-1} = c^2$.\n  But that should imply $a_\\ell = c < c^2$, contradiction.\n\n  We therefore conclude $\\sup \\{a_n, a_{n+1}, \\dots \\}$ is a\n  decreasing integer sequence in $n$.\n  It must eventually stabilize, say at $m^2$.\n  Now we can't hit a square between $m$ and $m^2$,\n  and so we are done.\n\\end{proof}\n\nNow, we contend that all $a_0 \\equiv 0 \\pmod 3$ work.\nIndeed, for such $a_0$ we have $a_n \\equiv 0 \\pmod 3$ for all $n$,\nso the lemma implies that the problem statement is valid.\n\nNext, we observe that if $a_i \\equiv 2 \\pmod 3$,\nthen the sequence grows without bound afterwards\nsince no squares are $2 \\pmod 3$.\nIn particular, if $a_0 \\equiv 2 \\pmod 3$ the answer is no.\n\nFinally, we claim that if $a_0 \\equiv 1 \\pmod 3$,\nthen eventually some term is $2 \\pmod 3$.\nAssume for contradiction this is not so;\nthen $a_n \\equiv 1 \\pmod 3$ must hold forever,\nand the lemma applies to give us a cycle of the form\n$(m, m+3, \\dots, m^2)$ where $m \\equiv 1 \\pmod 3$.\nIn particular $m \\ge 4$ and\n\\[ m \\le (m-2)^2 < m^2 \\]\nbut $(m-2)^2 \\equiv 1 \\pmod 3$ which is a contradiction.\n\\pagebreak", "category": "Number Theory", "source": "IMO", "year": 2017}
{"id": "imo-2017-q2", "question": "Solve over $\\RR$ the functional equation\n\\[ f\\left( f(x)f(y) \\right) + f(x+y) = f(xy). \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p8633190}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nSolve over $\\RR$ the functional equation\n\\[ f\\left( f(x)f(y) \\right) + f(x+y) = f(xy). \\]\n\\end{mdframed}\nThe only solutions are $f(x) = 0$, $f(x) = x-1$ and $f(x)=1-x$,\nwhich clearly work.\n\nNote that\n\\begin{itemize}\n  \\ii If $f$ is a solution, so is $-f$.\n  \\ii Moreover, if $f(0)=0$ then setting $y=0$ gives $f\\equiv0$.\n  So henceforth we assume $f(0)>0$.\n\\end{itemize}\n\n\\begin{claim*}\n  We have $f(z) = 0 \\iff z =1$.\n  Also, $f(0)=1$ and $f(1)=0$.\n\\end{claim*}\n\\begin{proof}\n  For the forwards direction, if $f(z)=0$ and $z \\neq 1$\n  one may put $(x,y) = \\left( z, z(z-1)\\inv \\right)$\n  (so that $x+y=xy$) we deduce $f(0) = 0$\n  which is a contradiction.\n\n  For the reverse, $f(f(0)^2)=0$ by setting $x=y=0$,\n  and use the previous part.\n  We also conclude $f(1) = 0$, $f(0) = 1$.\n\\end{proof}\n\n\\begin{claim*}\n  If $f$ is injective, we are done.\n\\end{claim*}\n\\begin{proof}\n  Setting $y=0$ in the original equation\n  gives $f(f(x)) = 1-f(x)$.\n  We apply this three times on the expression $f^3(x)$:\n  \\[ f(1-f(x)) = f(f(f(x))) = 1 - f(f(x)) = f(x). \\]\n  Hence $1-f(x) = x$ or $f(x) = 1-x$.\n\\end{proof}\n\\begin{remark*}\n  The result $f(f(x)) + f(x) = 1$ also implies that surjectivity\n  would solve the problem.\n\\end{remark*}\n\n\\begin{claim*}\n  $f$ is injective.\n\\end{claim*}\n\\begin{proof}\n  Setting $y=1$ in the original equation gives\n  $f(x+1) = f(x)-1$, and by induction\n  \\begin{equation}\n    f(x+n) = f(x)-n.\n    \\label{eq:linshift}\n  \\end{equation}\n  Assume now $f(a) = f(b)$.\n  By using \\eqref{eq:linshift} we may shift $a$ and $b$\n  to be large enough that\n  we may find $x$ and $y$ obeying $x+y=a+1$, $xy=b$.\n  Setting these gives\n  \\begin{align*}\n    f(f(x)f(y)) &= f(xy) - f(x+y) = f(b) - f(a+1) \\\\\n    &= f(b) + 1 - f(a) = 1\n  \\end{align*}\n  from which we conclude\n  \\[ f\\left( f(x)f(y) + 1 \\right) = 0. \\]\n  Hence by the first claim\n  we have $f(x)f(y) + 1 = 1$, so $f(x)f(y) = 0$.\n  Applying the first claim again gives $1 \\in \\{x,y\\}$.\n  But that implies $a=b$.\n\\end{proof}\n\n\\begin{remark*}\n  Jessica Wan points out that\n  for any $a \\neq b$, at least one of $a^2 > 4(b-1)$\n  and $b^2 > 4(a-1)$ is true.\n  So shifting via \\eqref{eq:linshift}\n  is actually unnecessary for this proof.\n\\end{remark*}\n\n\\begin{remark*}\n  One can solve the problem over $\\QQ$\n  using only \\eqref{eq:linshift} and the easy parts.\n  Indeed, that already implies $f(n) = 1-n$ for all $n$.\n  Now we induct to show $f(p/q) = 1-p/q$ for all $0 < p < q$ (on $q$).\n  By choosing $x = 1+p/q$, $y = 1+q/p$,\n  we cause $xy = x+y$,\n  and hence $0 = f\\left( f(1+p/q)f(1+q/p) \\right)$\n  or $1 = f(1+p/q)f(1+q/p)$.\n\n  By induction we compute $f(1+q/p)$\n  and this gives $f(p/q+1) = f(p/q)-1$.\n\\end{remark*}\n\\pagebreak", "category": "Algebra", "source": "IMO", "year": 2017}
{"id": "imo-2017-q3", "question": "A hunter and an invisible rabbit play a game in the plane.\nThe rabbit and hunter start at points $A_0 = B_0$.\nIn the $n$th round of the game ($n \\ge 1$), three things occur in order:\n\\begin{enumerate}[(i)]\n  \\ii The rabbit moves invisibly from $A_{n-1}$ to a point $A_n$\n  such that $A_{n-1} A_n = 1$.\n  \\ii The hunter has a tracking device (e.g.\\ dog)\n  which reports an approximate location $P_n$ of the rabbit,\n  such that $P_n A_n \\le 1$.\n  \\ii The hunter moves visibly from $B_{n-1}$ to a point $B_n$\n  such that $B_{n-1} B_n = 1$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p8633324}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA hunter and an invisible rabbit play a game in the plane.\nThe rabbit and hunter start at points $A_0 = B_0$.\nIn the $n$th round of the game ($n \\ge 1$), three things occur in order:\n\\begin{enumerate}[(i)]\n  \\ii The rabbit moves invisibly from $A_{n-1}$ to a point $A_n$\n  such that $A_{n-1} A_n = 1$.\n  \\ii The hunter has a tracking device (e.g.\\ dog)\n  which reports an approximate location $P_n$ of the rabbit,\n  such that $P_n A_n \\le 1$.\n  \\ii The hunter moves visibly from $B_{n-1}$ to a point $B_n$\n  such that $B_{n-1} B_n = 1$.\n\\end{enumerate}\nLet $N = 10^9$. Can the hunter guarantee that $A_N B_N < 100$?\n\\end{mdframed}\nNo, the hunter cannot.\nWe will show how to increase the distance in the following way:\n\n\\begin{claim*}\n  Suppose the rabbit is at a distance $d \\ge 1$ from the hunter\n  at some point in time.\n  Then it can increase its distance to at least\n  $\\sqrt{d^2+\\half}$ in $4d$ steps\n  regardless of what the hunter already knows about the rabbit.\n\\end{claim*}\n\\begin{proof}\n  Consider a positive integer $n > d$, to be chosen later.\n  Let the hunter start at $B$ and the rabbit at $A$, as shown.\n  Let $\\ell$ denote line $AB$.\n\n  Now, we may assume the rabbit reveals its location $A$,\n  so that all previous information becomes irrelevant.\n\n  The rabbit chooses two points $X$ and $Y$ symmetric about $\\ell$\n  such that $XY = 2$ and $AX = AY = n$, as shown.\n  The rabbit can then hop to either $X$ or $Y$,\n  pinging the point $P_n$ on the $\\ell$ each time.\n  This takes $n$ hops.\n  \\begin{center}\n  \\begin{asy}\n    pair A = 2*dir(0);\n    pair B = dir(180);\n    pair H = B+4*A;\n    pair X = (2+63**0.5,1);\n    pair Y = (2+63**0.5,-1);\n\n    draw(B--H, blue);\n    draw(A--X, red, EndArrow(TeXHead), Margins);\n    draw(A--Y, red, EndArrow(TeXHead), Margins);\n    pair M = midpoint(X--Y);\n    draw(H--M, dotted);\n    draw(X--Y, dotted);\n    draw(X--H--Y, dashed+heavygreen);\n\n    dot(\"$A$\", A, dir(270));\n    label(\"rabbit\", A, dir(90));\n    dot(\"$B$\", B, dir(270));\n    label(\"hunter\", B, dir(90));\n    dot(\"$H$\", H, dir(270));\n    dot(\"$X$\", X, dir(X));\n    dot(\"$Y$\", Y, dir(Y));\n    dot(\"$M$\", M, dir(M));\n    label(\"$n$\", A--X, dir(90), red);\n    label(\"$n$\", A--Y, dir(-90), red);\n\n    /* TSQ Source:\n\n    A = 2*dir(0) R270\n    B = dir(180) R270\n    H = B+4*A R270\n    X = (2+63**0.5,1)\n    Y = (2+63**0.5,-1)\n\n    B--H blue\n    X--A--Y red\n    M = midpoint X--Y\n    H--M dotted\n    X--Y dotted\n    X--H--Y dashed heavygreen\n\n    */\n  \\end{asy}\n  \\end{center}\n\n  Now among all points $H$ the hunter can go to,\n  $\\min \\max \\{HX, HY\\}$ is clearly minimized with $H \\in \\ell$ by symmetry.\n  So the hunter moves to a point $H$ such that $BH = n$ as well.\n  In that case the new distance is $HX = HY$.\n\n  We now compute\n  \\begin{align*}\n    HX^2 &= 1 + HM^2 = 1 + \\left( \\sqrt{AX^2-1}-AH \\right)^2 \\\\\n    &= 1 + \\left( \\sqrt{n^2-1}-(n-d) \\right)^2 \\\\\n    &\\ge 1 + \\left( \\left( n-\\frac1n \\right) - (n-d) \\right)^2 \\\\\n    &= 1 + (d-1/n)^2\n  \\end{align*}\n  which exceeds $d^2 + \\half$ whenever $n \\ge 4d$.\n\\end{proof}\n\nIn particular we can always take $n = 400$ even very crudely;\napplying the lemma $2 \\cdot 100^2$ times,\nthis gives a bound of $400 \\cdot 2 \\cdot 100^2 < 10^9$, as desired.\n\n\\begin{remark*}\n  The step of revealing the location of the rabbit seems\n  critical because as far as I am aware it is basically\n  impossible to keep track of ping locations in the problem.\n\\end{remark*}\n\n\\begin{remark*}\n  Reasons to believe the answer is ``no'':\n  the $10^9$ constant,\n  and also that ``follow the last ping'' is losing for the hunter.\n\\end{remark*}\n\n\\begin{remark*}\n  I think there are roughly two ways you can approach the problem\n  once you recognize the answer.\n\n  \\begin{enumerate}[(i)]\n    \\ii Try and control the location of the pings\n    \\ii Abandon the notion of controlling possible locations,\n    and try to increase the distance by a little bit,\n    say from $d$ to $\\sqrt{d^2+\\varepsilon}$.\n    This involves revealing the location of the rabbit\n    before each iteration of several jumps.\n  \\end{enumerate}\n  I think it's clear that the difficulty of\n  my approach is realizing that (ii) is possible;\n  once you do, the two-point approach is more or less the only one possible.\n\n  My opinion is that (ii) is not that magical;\n  as I said it was the first idea I had.\n  But I am biased, because when I test-solved the problem\n  at the IMO it was called ``C5'' and not ``IMO3'';\n  this effectively told me it was unlikely that the official solution\n  was along the lines of (i),\n  because otherwise it would have been placed much later in the shortlist.\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Geometry", "source": "IMO", "year": 2017}
{"id": "imo-2017-q4", "question": "Let $R$ and $S$ be different points on a circle $\\Omega$\nsuch that $\\ol{RS}$ is not a diameter.\nLet $\\ell$ be the tangent line to $\\Omega$ at $R$.\nPoint $T$ is such that $S$ is the midpoint of $\\ol{RT}$.\nPoint $J$ is chosen on minor arc $RS$ of $\\Omega$ so that\nthe circumcircle $\\Gamma$ of triangle $JST$ intersects $\\ell$\nat two distinct points.\nLet $A$ be the common point of $\\Gamma$ and $\\ell$ closer to $R$.\nLine $AJ$ meets $\\Omega$ again at $K$.\nProve that line $KT$ is tangent to $\\Gamma$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p8639236}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $R$ and $S$ be different points on a circle $\\Omega$\nsuch that $\\ol{RS}$ is not a diameter.\nLet $\\ell$ be the tangent line to $\\Omega$ at $R$.\nPoint $T$ is such that $S$ is the midpoint of $\\ol{RT}$.\nPoint $J$ is chosen on minor arc $RS$ of $\\Omega$ so that\nthe circumcircle $\\Gamma$ of triangle $JST$ intersects $\\ell$\nat two distinct points.\nLet $A$ be the common point of $\\Gamma$ and $\\ell$ closer to $R$.\nLine $AJ$ meets $\\Omega$ again at $K$.\nProve that line $KT$ is tangent to $\\Gamma$.\n\\end{mdframed}\n\\paragraph{First solution (elementary).}\nFirst, note\n\\[ \\dang RKA = \\dang RKJ = \\dang RSJ = \\dang TSJ = \\dang TAJ = \\dang TAK \\]\nso $\\ol{RK} \\parallel \\ol{AT}$.\nNow,\n\\begin{itemize}\n  \\ii $\\ol{RA}$ is tangent at $R$ iff $\\triangle KRS \\sim \\triangle RTA$ (oppositely),\n  because both equate to $-\\dang RKS = \\dang SKR = \\dang SRA = \\dang TRA$.\n  \\ii Similarly, $\\ol{TK}$ is tangent at $T$\n  iff $\\triangle KTS \\sim \\triangle ART$.\n  \\ii The two similarities are equivalent because $RS = ST$\n  the SAS gives $KR \\cdot TA = RS \\cdot RT = TS \\cdot TR$.\n\\end{itemize}\n\n\\begin{center}\n\\begin{asy}\nsize(10cm);\npair T = dir(100);\npair S = dir(165);\npair R = 2*S-T;\npair E = dir(0);\npair A = IP(unitcircle, R--(R+100*E));\npair B = OP(unitcircle, R--(R+100*E));\npair K = extension(T, T+dir(90)*T, R, R+T-A);\ndraw(R--B, blue);\n\nfilldraw(unitcircle, opacity(0.05)+lightcyan, blue);\nfilldraw(circumcircle(R, S, K), opacity(0.05)+paleblue, heavycyan);\npair J = -A+2*foot(origin, A, K);\n\n\nfilldraw(K--R--A--T--cycle, opacity(0.1)+lightred, red);\ndraw(A--K, orange);\ndraw(R--T, orange);\n\n// invert\n\npair Js = extension(T, T+A-B, R, J);\npair Ks = extension(T, T+A-B, R, K);\ndraw(K--Ks, heavygreen);\ndraw(Ks--Js, heavygreen);\ndraw(Js--B, dotted+blue);\ndraw(R--Js, dotted+blue);\n\ndot(\"$T$\", T, dir(T));\ndot(\"$S$\", S, dir(355));\ndot(\"$R$\", R, dir(270));\ndot(\"$A$\", A, dir(225));\ndot(\"$B$\", B, dir(315));\ndot(\"$K$\", K, dir(200));\ndot(\"$J$\", J, dir(180));\ndot(\"$J^\\ast$\", Js, dir(Js));\ndot(\"$K^\\ast$\", Ks, dir(Ks));\n\n/* TSQ Source:\n\n!size(10cm);\nT = dir 100\nS = dir 165 R355\nR = 2*S-T R270\nE := dir 0\nA = IP unitcircle R--(R+100*E) R225\nB = OP unitcircle R--(R+100*E) R315\nK = extension T T+dir(90)*T R R+T-A R200\nT--K blue\nR--B blue\n\nunitcircle 0.05 lightcyan / blue\ncircumcircle R S K 0.05 paleblue / heavycyan\nJ = -A+2*foot origin A K R180\n\n\nK--R--A--T--cycle 0.1 lightred / red\nA--K orange\nR--T orange\n\n// invert\n\nJ* = extension T T+A-B R J\nK* = extension T T+A-B R K\nK--Ks heavygreen\nKs--Js heavygreen\nJs--B dotted blue\nR--Js dotted blue\n\n*/\n\\end{asy}\n\\end{center}\n\n\\begin{remark*}\n  The problem is actually symmetric with respect to two circles;\n  $\\ol{RA}$ is tangent at $R$ if and only if $\\ol{TK}$ at $T$.\n\\end{remark*}\n\n\\paragraph{Second solution (inversion).}\nConsider an inversion at $R$ fixing the circumcircle $\\Gamma$ of $TSJA$.\nThen:\n\\begin{itemize}\n  \\ii $T$ and $S$ swap,\n  \\ii $A$ and $B$ swap, where $B$ is the second intersection\n  of $\\ell$ with $\\Gamma$.\n  \\ii Circle $\\Omega$ inverts to the line through $T$\n  parallel to $\\ol{RAB}$, call it $\\ell$.\n  \\ii $J^\\ast$ is the second intersection of $\\ell$ with $\\Gamma$.\n  \\ii $K^\\ast$ is the intersection of $\\ell$ with the circumcircle\n  of $RBJ^\\ast$; this implies $RK^\\ast J^\\ast B$ is an isosceles trapezoid.\n  In particular, one reads $\\ol{RK^\\ast} \\parallel \\ol{AT}$ from this,\n  hence $RK^\\ast TA$ is a parallelogram.\n\\end{itemize}\nThus we wish to show the circumcircle of $RSK^\\ast$ is tangent to $\\Gamma$.\nBut that follows from the final parallelogram observed:\n$S$ is the center of the parallelogram since it is the midpoint of the diagonal.\n\n\\begin{remark*}\n  This also implies $RKTB$ is cyclic, from $\\ol{K^\\ast SA}$ collinear.\n  Moreover, quadrilateral $KK^\\ast TS$ is cyclic (by power of a point);\n  this leads to the second official solution to the problem.\n\\end{remark*}\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2017}
{"id": "imo-2017-q5", "question": "Fix $N \\ge 1$. A collection of $N(N+1)$ soccer players of distinct\nheights stand in a row.\nSir Alex Song wishes to remove $N(N-1)$ players from this row\nto obtain a new row of $2N$ players in which the following $N$\nconditions hold: no one stands between the two tallest players,\nno one stands between the third and fourth tallest players, \\dots,\nno one stands between the two shortest players.\nProve that this is possible.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p8639240}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFix $N \\ge 1$. A collection of $N(N+1)$ soccer players of distinct\nheights stand in a row.\nSir Alex Song wishes to remove $N(N-1)$ players from this row\nto obtain a new row of $2N$ players in which the following $N$\nconditions hold: no one stands between the two tallest players,\nno one stands between the third and fourth tallest players, \\dots,\nno one stands between the two shortest players.\nProve that this is possible.\n\\end{mdframed}\nSome opening remarks:\n\\textbf{location and height are symmetric to each other},\nif one thinks about this problem as permutation pattern avoidance.\nSo while officially there are multiple solutions,\nthey are basically isomorphic to one another,\nand I am not aware of any solution otherwise.\n\n\\begin{center}\n\\begin{asy}\nsize(10cm);\nint[] ys = {7,11,2,5,0,10,9,0,12,1,6,8,4,3};\nreal r = 0.2;\n\nfill(box((-1, 8.5),(4,4.5)), opacity(0.3)+lightred);\nfill(box((-1,12.5),(7,8.5)), opacity(0.3)+lightcyan);\nfill(box((-1, 4.5),(14,0.5)), opacity(0.3)+lightgreen);\nfill(box((4, 8.5),(14,4.5)), opacity(0.3)+gray);\nfill(box((7,12.5),(14,8.5)), opacity(0.3)+gray);\n\ndraw( (-1,4.5)--(14,4.5) );\ndraw( (-1,8.5)--(14,8.5) );\n\npair P(int x) {\n  return (x,ys[x]);\n}\n\npair O;\nint y;\npen c;\nfor (int x=0; x<=13; ++x) {\n  y = ys[x];\n  if (y==0) continue;\n  O = (x, y);\n  if ((y==7) || (y==5)) c = red;\n  else if ((y==10) || (y==9)) c = blue;\n  else if ((y==1) || (y==4)) c = heavygreen;\n  else c = gray;\n  filldraw(circle(O, r), c, black+1);\n  label(\"$\"+(string)y+\"$\", O+(r,0), 0.5*dir(0), c);\n}\n\npen border = black+2;\npen dash = dotted+1;\ndraw( (4,12.5)--(4,0.5), dash );\ndraw( (7,12.5)--(7,0.5), dash );\n\npath bracket(real x0, real x1) {\n  return (x0,0.7)--(x0,0.5)--(x1,0.5)--(x1,0.7);\n}\ndraw(bracket(-0.8,3.8), border);\ndraw(bracket(4.2,6.8), border);\ndraw(bracket(7.2,13.8), border);\n\\end{asy}\n\\end{center}\n\nTake a partition of $N$ groups in order by height:\n$G_1 = \\{1,\\dots,N+1\\}$, $G_2 = \\{N+2, \\dots, 2N+2\\}$, and so on.\nWe will pick two people from each group $G_k$.\n\nScan from the left until we find two people in the same group $G_k$.\nDelete all people scanned and also everyone in $G_k$.\nAll the groups still have at least $N$ people left,\nso we can induct down with the non-deleted people;\nthe chosen pair is to the far left anyways.\n\n\\begin{remark*}\n  The important bit is to \\emph{scan by position}\n  but \\emph{group by height},\n  and moreover not change the groups as we scan.\n  Dually, one can have a solution which scans by height\n  but groups by position.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "IMO", "year": 2017}
{"id": "imo-2017-q6", "question": "An \\emph{irreducible lattice point} is an ordered pair\nof integers $(x,y)$ satisfying $\\gcd(x,y) = 1$.\nProve that if $S$ is a finite set of irreducible lattice points\nthen there exists a nonconstant\n\\emph{homogeneous} polynomial $f(x,y)$ with integer coefficients\nsuch that $f(x,y)=1$ for each $(x,y) \\in S$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p8639242}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nAn \\emph{irreducible lattice point} is an ordered pair\nof integers $(x,y)$ satisfying $\\gcd(x,y) = 1$.\nProve that if $S$ is a finite set of irreducible lattice points\nthen there exists a nonconstant\n\\emph{homogeneous} polynomial $f(x,y)$ with integer coefficients\nsuch that $f(x,y)=1$ for each $(x,y) \\in S$.\n\\end{mdframed}\nWe present two solutions.\n\n\\paragraph{First solution (Dan Carmon, Israel).}\nWe prove the result by induction on $|S|$,\nwith the base case being Bezout's Lemma ($n=1$).\nFor the inductive step, suppose we want to add a given pair\n$(a_{m+1},b_{m+1})$ to $\\left\\{ (a_1, \\dots, a_m), (b_1, \\dots, b_m) \\right\\}$.\n\\begin{claim*}\n  [Standard]\n  By a suitable linear transformation we may assume\n  \\[ (a_{m+1},b_{m+1}) = (1,0). \\]\n\\end{claim*}\n\\begin{proof}\n  [Outline of proof]\n  It would be sufficient to show there exists a $2 \\times 2$ matrix\n  $T = \\left[ \\begin{smallmatrix} u & v \\\\ s & t \\end{smallmatrix} \\right]$\n  with integer entries such that $\\det T = 1$ and\n  $T \\cdot \\left[ \\begin{smallmatrix} a_{m+1} \\\\ b_{m+1} \\end{smallmatrix} \\right]\n  = \\left[ \\begin{smallmatrix} 1 \\\\ 0 \\end{smallmatrix} \\right]$.\n  Then we could apply $T$ to all the ordered pairs in $S$ (viewed as column vectors);\n  if $f$ was a polynomial that works on the transformed ordered pairs,\n  then $f(ux+vy, sx+ty)$ works for the original ordered pairs.\n  (Here, the condition that $\\det T = 1$ ensures that $T\\inv$ has integer entries,\n  and hence that $T$ maps irreducible lattice points to irreducible lattice points.)\n\n  To generate such a matrix $T$, choose\n  $T = \\left[ \\begin{smallmatrix} u & v  \\\\ -b_{m+1} & a_{m+1} \\end{smallmatrix} \\right]$\n  where $u$ and $v$ are chosen via B\\'{e}zout lemma so that $ua_{m+1} + vb_{m+1} = 1$.\n  This matrix $T$ is rigged so that $\\det T = 1$ and the leftmost column of $T\\inv$ is\n  $\\left[ \\begin{smallmatrix} a_{m+1} \\\\ b_{m+1} \\end{smallmatrix} \\right]$.\n\\end{proof}\n\\begin{remark*}\n  This transformation claim is not necessary to proceed;\n  the solution below can be rewritten to avoid it with only cosmetic edits.\n  However, it makes things a bit easier to read.\n\\end{remark*}\n\nLet $g(x,y)$ be a polynomial which works on the latter set.\nWe claim we can choose the new polynomial $f$ of the form\n\\[ f(x,y) = g(x,y)^{M} - C x^{\\deg g \\cdot M-m} \\prod_{i=1}^m (b_i x - a_i y). \\]\nwhere $C$ and $M$ are integer parameters we may adjust.\n\nSince $f(a_i, b_i) = 1$ by construction we just need\n\\[ 1 = f(1,0) = g(1,0)^M - C \\prod b_i. \\]\nIf $\\prod b_i = 0$ we are done,\nsince $b_i = 0 \\implies a_i = \\pm 1$ in that case\nand so $g(1, 0) = \\pm 1$, thus take $M = 2$.\nSo it suffices to prove:\n\\begin{claim*}\n  We have $\\gcd\\left( g(1,0), b_i \\right) = 1$ when $b_i \\neq 0$.\n\\end{claim*}\n\\begin{proof}\n  Fix $i$. If $b_i = 0$ then $a_i = \\pm 1$ and $g(\\pm 1,0) = \\pm 1$.\n  Otherwise know\n  \\[ 1 = g(a_i, b_i) \\equiv g(a_i, 0) \\pmod{b_i} \\]\n  and since the polynomial is homogeneous with $\\gcd(a_i, b_i) = 1$\n  it follows $g(1,0) \\not\\equiv 0 \\pmod{b_i}$ as well.\n\\end{proof}\nThen take $M$ a large multiple of $\\varphi(\\prod |b_i|)$ and we're done.\n\n\\paragraph{Second solution (Lagrange).}\nThe main claim is that:\n\\begin{claim*}\n  For every positive integer $N$,\n  there is a homogeneous polynomial $P(x,y)$ such that\n  $P(x,y) \\equiv 1 \\pmod N$ whenever $\\gcd(x,y) = 1$.\n\\end{claim*}\n(This claim is actually implied by the problem.)\n\\begin{proof}\n  For $N = p^e$ a prime take $(x^{p-1} + y^{p-1})^{\\varphi(N)}$\n  when $p$ is odd, and $(x^2+xy+y^2)^{\\varphi(N)}$ for $p=2$.\n\n  Now, if $N$ is a product of primes,\n  we can collate coefficient by coefficient using the\n  Chinese remainder theorem.\n%  Now suppose $N = q_1 q_2 \\dots q_k$ where $q_i$ are prime powers.\n%  Look at the polynomial $Q_i$ described above for $i=1, \\dots, k$.\n%  Now \\[ \\frac{N}{q_i} Q_i(x,y) \\equiv \\frac{N}{q_i} \\pmod{N} \\]\n%  for all $x$ and $y$;\n%  so we can put together the polynomials $\\frac{N}{q_i} Q_i$ by B\\'{e}zout lemma.\n\\end{proof}\n\nLet $S = \\left\\{ (a_i, b_i) \\mid i=1, \\dots, m \\right\\}$.\nWe have the natural homogeneous ``Lagrange polynomials''\n\\[ L_k(x,y) \\coloneq \\prod_{i \\neq k} (b_i x - a_i y) \\]\nNow let\n\\[ N \\coloneq \\prod_k L_k(x_k, y_k) \\]\nand take $P$ as in the claim.\nThen we can take a large power of $P$,\nand for each $i$ subtract an appropriate multiple of $L_i(x,y)$; that is, choose\n\\[\n  f(x,y)\n  = P(x,y)^{C} - \\sum_i L_i(x,y) \\cdot Q_i(x,y)\n\\]\nwhere $C$ is large enough that $C \\deg P > \\max_i \\deg L_i$,\nand $Q_i(x,y)$ is any homogeneous polynomial of degree $C \\deg P - \\deg L_i$\nsuch that $L_k(x_k, y_k) Q_k(x_k, y_k) = \\frac{P(x_k, y_k)^C - 1}{N} \\cdot L_k(x_k, y_k)$\n(which is an integer).\n\\pagebreak\n\n\n\\end{document}", "category": "Number Theory", "source": "IMO", "year": 2017}
{"id": "putnam-2004-a1", "question": "Basketball star Shanille O'Keal's team statistician\nkeeps track of the number, $S(N)$, of successful free throws she has made\nin her first $N$ attempts of the season.\nEarly in the season, $S(N)$  was less than 80\\% of  $N$,\nbut by the end of the season, $S(N)$ was more than 80\\% of $N$.\nWas there necessarily a moment in between when $S(N)$ was exactly 80\\% of\n$N$?", "solution": "Yes. Suppose otherwise. Then there would be an $N$ such that $S(N) < .8N$\nand $S(N+1) > .8(N+1)$; that is, O'Keal's free throw percentage is under $80\\%$\nat some point, and after one subsequent free throw (necessarily made),\nher percentage is over $80\\%$. If she makes $m$ of her first $N$ free\nthrows, then $m/N < 4/5$ and $(m+1)/(N+1) > 4/5$. This means that $5m <\n4n < 5m+1$, which is impossible since then $4n$ is an integer between the\nconsecutive integers $5m$ and $5m+1$.\n\n\\textbf{Remark:}\nThis same argument works for any fraction of the form\n$(n-1)/n$ for some integer $n>1$, but not for any other real number\nbetween $0$ and $1$.", "category": "Number Theory", "source": "PUTNAM", "year": 2004}
{"id": "putnam-2004-a2", "question": "For $i = 1,2$ let $T_i$ be a triangle with side lengths $a_i, b_i, c_i$,\nand area $A_i$.  Suppose that $a_1 \\le a_2,  b_1 \\le b_2,  c_1 \\le\nc_2$,\nand that $T_2$ is an acute triangle. Does it follow that $A_1\n\\le A_2$?", "solution": "\\textbf{First solution:} (partly due to Ravi Vakil)\nYes, it does follow.\nFor $i=1,2$,\nlet $P_i, Q_i, R_i$ be the vertices of $T_i$ opposide the sides of length\n$a_i, b_i, c_i$, respectively.\n\nWe first check the case where $a_1 = a_2$ (or $b_1 = b_2$ or $c_1 = c_2$,\nby the same argument after relabeling).\nImagine $T_2$ as being drawn with the base $Q_2R_2$\nhorizontal and the point $P_2$ above the line $Q_2R_2$. We may then\nposition $T_1$ so that $Q_1 = Q_2$, $R_1 = R_2$, and $P_1$ lies above the line\n$Q_1R_1 = Q_2R_2$. Then $P_1$ also lies inside the region bounded by the\ncircles through $P_2$ centered at $Q_2$ and $R_2$. Since $\\angle Q_2$\nand $\\angle R_2$ are acute, the part of this region above the line\n$Q_2R_2$ lies within $T_2$. In particular, the\ndistance from $P_1$ to the line $Q_2R_2$ is less than or equal to the\ndistance from $P_2$ to the line $Q_2R_2$; hence $A_1 \\leq A_2$.\n\nTo deduce the general case, put\n\\[\nr = \\max\\{a_1/a_2, b_1/b_2, c_1/c_2\\}.\n\\]\nLet $T_3$ be the triangle with sides $ra_2, rb_2, rc_2$, which\nhas area $r^2 A_2$. Applying the special case to $T_1$ and $T_3$,\nwe deduce that $A_1 \\leq r^2 A_2$; since $r \\leq 1$ by hypothesis,\nwe have $A_1 \\leq A_2$ as desired.\n\n\\textbf{Remark:}\nAnother geometric argument in the case $a_1 = a_2$\nis that since angles $\\angle Q_2$ and $\\angle R_2$\nare acute, the perpendicular to $Q_2R_2$ through $P_2$ separates $Q_2$ from\n$R_2$. If $A_1 > A_2$, then $P_1$ lies above the parallel to $Q_2R_2$\nthrough $P_2$; if then it lies on or to the left of the vertical line\nthrough $P_2$, we have $c_1 > c_2$ because the inequality holds\nfor both horizontal and vertical components (possibly with equality for one,\nbut not both). Similarly, if $P_1$ lies to the right of the vertical,\nthen $b_1 > b_2$.\n\n\\textbf{Second solution:} (attribution unknown)\nRetain notation as in the first paragraph of the first solution.\nSince the angle measures in any triangle add up to $\\pi$, some angle\nof $T_1$ must have measure less than or equal to its counterpart in\n$T_2$. Without loss of generality assume that $\\angle P_1 \\leq \\angle\nP_2$. Since the latter is acute (because $T_2$ is acute), we have\n$\\sin \\angle P_1 \\leq \\sin \\angle P_2$. By the Law of Sines,\n\\[\nA_1 = \\frac{1}{2} b_1 c_1 \\sin \\angle P_1 \\leq \\frac{1}{2}\nb_2 c_2 \\sin \\angle P_2 = A_2.\n\\]\n\n\\textbf{Remark:} Many other solutions are possible; for instance,\none uses Heron's formula for the area of a triangle in terms of\nits side lengths.", "category": "Geometry", "source": "PUTNAM", "year": 2004}
{"id": "putnam-2004-a3", "question": "Define a sequence $\\{ u_n \\}_{n=0}^\\infty$\nby  $u_0 = u_1 = u_2 = 1$, and thereafter by\nthe\ncondition that\n\\[\n\\det\\begin{pmatrix}\nu_n &   u_{n+1}\\\\\nu_{n+2} & u_{n+3}\n\\end{pmatrix}\n= n!\n\\]\nfor all $n \\ge 0$. Show that $u_n$ is an integer for all $n$.\n(By convention, $0! = 1$.)", "solution": "Define a sequence $v_n$ by $v_n = (n-1)(n-3)\\cdots(4)(2)$ if $n$ is\nodd and $v_n = (n-1)(n-3)\\cdots(3)(1)$ if $n$ is even; it suffices to\nprove that $u_n = v_n$ for all $n \\geq 2$. Now $v_{n+3} v_n =\n(n+2)(n)(n-1)!$ and $v_{n+2}v_{n+1} = (n+1)!$, and so $v_{n+3} v_n -\nv_{n+2} v_{n+1} = n!$. Since we can check that $u_n = v_n$ for\n$n=2,3,4$, and $u_n$ and $v_n$ satisfy the same recurrence, it\nfollows by induction that $u_n = v_n$ for all $n\\geq 2$, as desired.", "category": "Number Theory", "source": "PUTNAM", "year": 2004}
{"id": "putnam-2004-a4", "question": "Show that for any positive integer $n$ there is an integer $N$ such that\nthe product $x_1 x_2 \\cdots x_n$ can be expressed identically in the form\n\\[\nx_1 x_2 \\cdots x_n =\n\\sum_{i=1}^N  c_i\n( a_{i1} x_1 + a_{i2} x_2 + \\cdots + a_{in} x_n )^n\n\\]\nwhere the $c_i$ are rational numbers and each $a_{ij}$ is one of the\nnumbers $-1, 0, 1$.", "solution": "It suffices to verify that\n\\[\nx_1 \\cdots x_n = \\frac{1}{2^n n!} \\sum_{e_i \\in \\{-1,1\\}}\n(e_1\\cdots e_n) (e_1 x_1 + \\cdots + e_n x_n)^n.\n\\]\nTo check this, first note that the right side vanishes identically\nfor $x_1 = 0$, because each term cancels the corresponding term with $e_1$\nflipped. Hence the right side, as a polynomial, is divisible by $x_1$;\nsimilarly it is divisible by $x_2, \\dots, x_n$. Thus the right side\nis equal to $x_1\\cdots x_n$ times a scalar. (Another way to see this:\nthe right side is clearly odd as a polynomial in each individual variable,\nbut the only degree $n$ monomial in $x_1, \\dots, x_n$ with that property\nis $x_1 \\cdots x_n$.) Since each summand\ncontributes $\\frac{1}{2^n} x_1 \\cdots x_n$ to the sum, the scalar factor is\n1 and we are done.\n\n\\textbf{Remark:} Several variants on the above construction\nare possible; for instance,\n\\[\nx_1 \\cdots x_n = \\frac{1}{n!}\n\\sum_{e_i \\in \\{0,1\\}} (-1)^{n - e_1 - \\cdots - e_n}\n(e_1 x_1 + \\cdots + e_n x_n)^n\n\\]\nby the same argument as above.\n\n\\textbf{Remark:} These construction work over any field of characteristic\ngreater than $n$ (at least for $n>1$).\nOn the other hand, no construction is possible over\na field of characteristic $p \\leq n$, since the coefficient of\n$x_1\\cdots x_n$ in the expansion of\n$(e_1 x_1 + \\cdots + e_n x_n)^n$ is zero for any $e_i$.\n\n\\textbf{Remark:} Richard Stanley asks whether one can use fewer than\n$2^n$ terms, and what the smallest possible number is.", "category": "Algebra", "source": "PUTNAM", "year": 2004}
{"id": "putnam-2004-a5", "question": "An $m \\times n$ checkerboard is colored randomly: each square is\nindependently\nassigned red or black with probability $1/2$. We say that two squares,\n$p$ and $q$,  are in the same connected monochromatic region if there is\na sequence of squares, all of the same color, starting at $p$ and ending\nat $q$, in which successive squares in the sequence share a common side.\nShow that the expected number of connected monochromatic regions is\ngreater than $m n / 8$.", "solution": "\\textbf{First solution:}\nFirst recall that any graph with $n$ vertices and $e$ edges has at\nleast $n-e$ connected components (add each edge one at a time, and note\nthat it reduces the number of components by at most 1). Now\nimagine the squares of the checkerboard as a graph, whose vertices are\nconnected if the corresponding squares share a side and are\nthe same color. Let\n$A$ be the number of edges in the graph, and let $B$ be the number of\n4-cycles (formed by monochromatic $2 \\times 2$ squares).\nIf we remove the bottom edge of each 4-cycle, the resulting graph has\nthe same number of connected components as the original one;\nhence this number is at least\n\\[\nmn - A+B.\n\\]\nBy the linearity of expectation, the expected number of connected\ncomponents is at least\n\\[\nmn - E(A) + E(B).\n\\]\nMoreover, we may compute $E(A)$ by summing over the individual\npairs of adjacent squares, and we may compute $E(B)$ by summing over\nthe individual $2 \\times 2$ squares. Thus\n\\begin{align*}\nE(A) &= \\frac{1}{2}(m(n-1) + (m-1)n), \\\\\nE(B) &= \\frac{1}{8}(m-1)(n-1),\n\\end{align*}\nand so the expected number of components is at least\n\\begin{align*}\n& mn - \\frac{1}{2}(m(n-1)+(m-1)n) + \\frac{1}{8}(m-1)(n-1) \\\\\n&= \\frac{mn + 3m + 3n + 1}{8} >\n\\frac{mn}{8}.\n\\end{align*}\n\n\\textbf{Remark:}\nA ``dual'' approach is to consider\nthe graph whose vertices are the corners of the squares of the checkerboard,\nwith two vertices joined if they are adjacent and the edge between then\ndoes not separate two squares of the same color. In this approach,\nthe 4-cycles become isolated vertices, and the bound on components\nis replaced by a call to Euler's formula relating the vertices, edges\nand faces of a planar figure. (One must be careful, however, to correctly\nhandle faces which are not simply connected.)\n\n\\textbf{Second solution:} (by Noam Elkies)\nNumber the squares of the checkerboard $1, \\dots, mn$ by numbering the\nfirst row from left to right, then the second row, and so on. We prove\nby induction on $i$ that if we just consider the figure formed by the\nfirst $i$ squares, its expected number of monochromatic components is\nat least $i/8$. For $i=1$, this is clear.\n\nSuppose the $i$-th square does not abut the left edge or the top row\nof the board.\nThen we may divide into three cases.\n\\begin{itemize}", "category": "Combinatorics", "source": "PUTNAM", "year": 2004}
{"id": "putnam-2004-a6", "question": "Suppose that $f(x,y)$ is a continuous real-valued function on the unit\nsquare $0 \\le x \\le 1, 0 \\le y \\le 1$.  Show that\n\\begin{align*}\n& \\int_0^1 \\left( \\int_0^1  f(x,y) dx \\right)^2 dy +\n \\int_0^1 \\left( \\int_0^1  f(x,y) dy \\right)^2 dx \\\\\n&\\leq\n\\left( \\int_0^1 \\int_0^1  f(x,y) dx\\, dy \\right)^2 +\n\\int_0^1 \\int_0^1 \\left[ f(x,y) \\right]^2 dx\\,dy.\n\\end{align*}", "solution": "By approximating each integral with a Riemann sum, we may reduce to\nproving the discrete analogue: for $x_{ij} \\in \\RR$ for\n$i,j=1, \\dots, n$,\n\\begin{multline*}\nn \\sum_{i=1}^n \\left( \\sum_{j=1}^n x_{ij} \\right)^2\n+ n \\sum_{j=1}^n \\left( \\sum_{i=1}^n x_{ij} \\right)^2 \\\\\n\\leq \\left( \\sum_{i=1}^n \\sum_{j=1}^n x_{ij} \\right)^2\n+ n^2 \\sum_{i=1}^n \\sum_{j=1}^n x_{ij}^2.\n\\end{multline*}\nThe difference between the right side and the left side is\n\\[\n\\frac{1}{4} \\sum_{i,j,k,l=1}^n (x_{ij} + x_{kl} - x_{il} - x_{kj})^2,\n\\]\nwhich is evidently nonnegative. If you prefer not to discretize,\nyou may rewrite the original inequality as\n\\[\n\\int_0^1 \\int_0^1 \\int_0^1 \\int_0^1 F(x,y,z,w)^2\n\\,dx\\,dy\\,dz\\,dw \\geq 0\n\\]\nfor\n\\[\nF(x,y,z,w) = f(x,y) + f(z,w) - f(x,w) - f(z,y).\n\\]\n\n\\textbf{Remark:} (by Po-Ning Chen)\nThe discrete inequality can be arrived at more systematically\nby repeatedly applying the following identity: for\nany real $a_1, \\dots, a_n$,\n\\[\n\\sum_{1 \\leq i < j \\leq n} (x_i - x_j)^2\n= n \\sum_{i=1}^n x_i^2 - \\left( \\sum_{i=1}^n x_i \\right)^2.\n\\]\n\n\\textbf{Remark:} (by David Savitt)\nThe discrete inequality can also be interpreted as follows.\nFor $c,d \\in \\{1, \\dots, n-1\\}$ and $\\zeta_n = e^{2\\pi i/n}$, put\n\\[\nz_{c,d} = \\sum_{i,j} \\zeta_n^{c i + d j} x_{ij}.\n\\]\nThen the given inequality is equivalent to\n\\[\n\\sum_{c,d=1}^{n-1} |z_{c,d}|^2 \\geq 0.\n\\]", "category": "Geometry", "source": "PUTNAM", "year": 2004}
{"id": "putnam-2004-b1", "question": "Let $P(x) = c_n x^n + c_{n-1} x^{n-1} + \\cdots + c_0$ be a polynomial with\ninteger coefficients. Suppose that $r$ is a rational number such that\n$P(r) = 0$.  Show that the $n$ numbers\n\\begin{gather*}\nc_n r, \\, c_n r^2 + c_{n-1} r, \\, c_n r^3 + c_{n-1} r^2 + c_{n-2} r, \\\\\n\\dots, \\, c_n r^n + c_{n-1} r^{n-1} + \\cdots + c_1 r\n\\end{gather*}\nare integers.", "solution": "Let $k$ be an integer, $0\\leq k\\leq n-1$. Since $P(r)/r^k = 0$, we\nhave\n\\begin{multline*}\nc_n r^{n-k} + c_{n-1} r^{n-k+1} + \\dots + c_{k+1} r \\\\\n= - (c_k + c_{k-1} r^{-1} + \\dots + c_0 r^{-k}).\n\\end{multline*}\nWrite $r = p/q$ where $p$ and $q$ are relatively prime. Then the\nleft hand side of the above equation can be written as a fraction\nwith denominator $q^{n-k}$, while the right hand side is a fraction\nwith denominator $p^k$. Since $p$ and $q$ are relatively prime, both\nsides of the equation must be an integer, and the result follows.\n\n\\textbf{Remark:}\nIf we write $r = a/b$ in lowest terms, then $P(x)$ factors as $(bx-a)Q(x)$,\nwhere the polynomial $Q$ has integer coefficients because you can\neither do the long division from the left and get denominators divisible only\nby primes dividing $b$, or do it from the right and get denominators\ndivisible only by primes dividing $a$. The numbers given in the problem\nare none other than $a$ times the coefficients of $Q$.\nMore generally, if $P(x)$ is divisible,\nas a polynomial over the rationals, by a polynomial $R(x)$ with integer\ncoefficients, then $P/R$ also has integer coefficients; this is known\nas ``Gauss's lemma'' and holds in any unique factorization domain.", "category": "Algebra", "source": "PUTNAM", "year": 2004}
{"id": "putnam-2004-b2", "question": "Let $m$ and $n$ be positive integers.  Show that\n\\[\n\\frac{(m+n)!}{(m+n)^{m+n}}\n< \\frac{m!}{m^m} \\frac{n!}{n^n}.\n\\]", "solution": "\\textbf{First solution:}\nWe have\n\\[\n(m+n)^{m+n} > \\binom{m+n}{m} m^m n^n\n\\]\nbecause the binomial expansion of $(m+n)^{m+n}$ includes the term on\nthe right as well as some others. Rearranging this inequality yields\nthe claim.\n\n\\textbf{Remark:}\nOne can also interpret this argument combinatorially.\nSuppose that we choose $m+n$ times (with replacement) uniformly\nrandomly from a set of $m+n$ balls, of which $m$ are red and $n$ are\nblue. Then the probability of picking each ball exactly once is\n$(m+n)!/(m+n)^{m+n}$. On the other hand, if $p$ is the probability\nof picking exactly $m$ red balls, then $p<1$ and the probability\nof picking each ball exactly once is $p (m^m/m!)(n^n/n!)$.\n\n\\textbf{Second solution:} (by David Savitt)\nDefine\n\\[\nS_k = \\{i/k: i=1, \\dots, k\\}\n\\]\nand rewrite the desired inequality as\n\\[\n\\prod_{x \\in S_m} x \\prod_{y \\in S_n} y > \\prod_{z \\in S_{m+n}} z.\n\\]\nTo prove this, it suffices to check that if we sort the multiplicands\non both sides into increasing order, the $i$-th term on the left\nside is greater than or equal to the $i$-th term on the right side.\n(The equality is strict already for $i=1$, so you do get a strict inequality\nabove.)\n\nAnother way to say this is that for\nany $i$, the number of factors on the left side which are less than\n$i/(m+n)$ is less than $i$. But since $j/m < i/(m+n)$ is equivalent to\n$j < im/(m+n)$, that number is\n\\begin{align*}\n&\\left\\lceil \\frac{im}{m+n} \\right\\rceil -1 +\n\\left\\lceil \\frac{in}{m+n} \\right\\rceil -1 \\\\\n&\\leq \\frac{im}{m+n} + \\frac{in}{m+n} - 1 = i-1.\n\\end{align*}\n\n\\textbf{Third solution:}\nPut $f(x) = x (\\log (x+1) - \\log x)$; then for $x>0$,\n\\begin{align*}\nf'(x) &= \\log(1 + 1/x) - \\frac{1}{x+1} \\\\\nf''(x) &= - \\frac{1}{x(x+1)^2}.\n\\end{align*}\nHence $f''(x) < 0$ for all $x$; since $f'(x) \\to 0$ as $x \\to \\infty$,\nwe have $f'(x) > 0$ for $x>0$, so $f$ is strictly increasing.\n\nPut $g(m) = m \\log m - \\log(m!)$; then $g(m+1) - g(m) = f(m)$,\nso $g(m+1)-g(m)$ increases with $m$. By induction,\n$g(m+n) - g(m)$ increases with $n$ for any positive integer $n$,\nso in particular\n\\begin{align*}\ng(m+n) - g(m) &> g(n) - g(1) + f(m) \\\\\n&\\geq g(n)\n\\end{align*}\nsince $g(1) = 0$. Exponentiating yields the desired inequality.\n\n\\textbf{Fourth solution:} (by W.G. Boskoff and Bogdan Suceav\\u{a})\nWe prove the claim by induction on $m+n$. The base case is $m=n=1$, in which case\nthe desired inequality is obviously true: $2!/2^2 = 1/2 < 1 = (1!/1^1)(1!/1^1)$.\nTo prove the induction step, suppose $m+n > 2$; we must then have $m>1$ or $n>1$ or both.\nBecause the desired result is symmetric in $m$ and $n$, we may as well assume $n > 1$.\nBy the induction hypothesis, we have\n\\[\n\\frac{(m+n-1)!}{(m+n-1)^{m+n-1}} < \\frac{m!}{m^m} \\frac{(n-1)!}{(n-1)^{n-1}}.\n\\]\nTo obtain the desired inequality, it will suffice to check that\n\\[\n\\frac{(m+n-1)^{m+n-1}}{(m+n-1)!} \\frac{(m+n)!}{(m+n)^{m+n}}< \\frac{(n-1)^{n-1}}{(n-1)!} \\frac{n!}{(n)^{n}}\n\\]\nor in other words\n\\[\n\\left( 1 - \\frac{1}{m+n} \\right)^{m+n-1} < \\left(1 - \\frac{1}{n} \\right)^{n-1}.\n\\]\nTo show this, we check that the function $f(x) = (1 - 1/x)^{x-1}$\nis strictly decreasing for $x>1$; while this can be achieved using the weighted arithmetic-geometric mean\ninequality, we give a simple calculus proof instead. The derivative of $\\log f(x)$ is\n$\\log (1-1/x) + 1/x$, so it is enough to check that this is negative for $x>1$.\nAn equivalent statement is that $\\log (1-x) + x < 0$ for $0 < x < 1$;\nthis in turn holds because the function $g(x) = \\log(1-x) + x$ tends to 0 as $x \\to 0^+$\nand has derivative $1 - \\frac{1}{1-x} < 0$ for $0 < x < 1$.", "category": "Combinatorics", "source": "PUTNAM", "year": 2004}
{"id": "putnam-2004-b3", "question": "Determine all real numbers $a > 0$ for which there exists a nonnegative\ncontinuous function $f(x)$ defined on $[0,a]$ with the property that the\nregion\n\\[\nR = \\{ (x,y) ; 0\n\\le x \\le a, 0 \\le y \\le\nf(x) \\}\n\\]\nhas perimeter $k$ units and area $k$ square units for some real number $k$.", "solution": "The answer is $\\{a\\,|\\,a>2\\}$. If $a>2$, then the function $f(x) =\n2a/(a-2)$ has the desired property; both perimeter and area of $R$\nin this case are $2a^2/(a-2)$. Now suppose that $a\\leq 2$, and let\n$f(x)$ be a nonnegative continuous function on $[0,a]$. Let\n$P=(x_0,y_0)$ be a point on the graph of $f(x)$ with maximal\n$y$-coordinate; then the area of $R$ is at most $ay_0$ since it lies\nbelow the line $y=y_0$. On the other hand, the points $(0,0)$,\n$(a,0)$, and $P$ divide the boundary of $R$ into three sections. The\nlength of the section between $(0,0)$ and $P$ is at least the\ndistance between $(0,0)$ and $P$, which is at least $y_0$; the\nlength of the section between $P$ and $(a,0)$ is similarly at least\n$y_0$; and the length of the section between $(0,0)$ and $(a,0)$ is\n$a$. Since $a\\leq 2$, we have $2y_0 + a > ay_0$ and hence the\nperimeter of $R$ is strictly greater than the area of $R$.", "category": "Geometry", "source": "PUTNAM", "year": 2004}
{"id": "putnam-2004-b4", "question": "Let $n$ be a positive integer, $n \\ge\n2$, and put  $\\theta = 2 \\pi / n$.\nDefine points $P_k = (k,0)$ in the $xy$-plane, for $k = 1, 2\n, \\dots, n$.\nLet $R_k$ be the map that rotates the plane counterclockwise by the\nangle $\\theta$ about the point $P_k$.  Let $R$ denote the map obtained\nby applying, in order, $R_1$,  then $R_2, \\dots$,\nthen $R_n$.\nFor an arbitrary point $(x,y)$, find, and simplify, the coordinates\nof $R(x,y)$.", "solution": "\\textbf{First solution:}\nIdentify the $xy$-plane with the complex plane $\\mathbb{C}$, so that\n$P_k$ is the real number $k$. If $z$ is sent to $z'$ by a\ncounterclockwise rotation by $\\theta$ about $P_k$, then $z'-k =\ne^{i\\theta} (z-k)$; hence the rotation $R_k$ sends $z$ to $\\zeta z +\nk (1-\\zeta)$, where $\\zeta = e^{2\\pi i/n}$. It follows that $R_1$\nfollowed by $R_2$ sends $z$ to $\\zeta(\\zeta z +(1-\\zeta)) + 2\n(1-\\zeta) = \\zeta^2 z + (1-\\zeta)(\\zeta + 2)$, and so forth; an easy\ninduction shows that $R$ sends $z$ to\n\\[\n\\zeta^n z + (1-\\zeta)(\\zeta^{n-1} + 2 \\zeta^{n-2} + \\dots + (n-1)\n\\zeta + n).\n\\]\nExpanding the product $(1-\\zeta)(\\zeta^{n-1} + 2 \\zeta^{n-2} + \\dots\n+ (n-1) \\zeta + n)$ yields $-\\zeta^n - \\zeta^{n-1} - \\dots - \\zeta +\nn = n$. Thus $R$ sends $z$ to $z+n$; in cartesian coordinates,\n$R(x,y) = (x+n,y)$.\n\n\\textbf{Second solution:}\n(by Andy Lutomirski, via Ravi Vakil)\nImagine a regular $n$-gon of side length 1 placed with its top edge\non the $x$-axis and the left endpoint of that edge\nat the origin. Then the rotations\ncorrespond to rolling this $n$-gon along the $x$-axis; after the\n$n$ rotations, it clearly ends up in its original rotation and translated\n$n$ units to the right. Hence the whole plane must do so as well.\n\n\\textbf{Third solution:} (attribution unknown)\nViewing each $R_k$ as a function of a complex number $z$ as in the\nfirst solution, the function $R_n \\circ R_{n-1} \\circ \\cdots \\circ\nR_1(z)$ is linear in $z$ with slope $\\zeta^n = 1$. It thus equals\n$z + T$ for some $T \\in \\CC$. Since $f_1(1) = 1$, we can write\n$1+T = R_n \\circ \\cdots \\circ R_2(1)$. However, we also have\n\\[\nR_n \\circ \\cdots \\circ R_2(1) = R_{n-1} \\circ R_1(0) + 1\n\\]\nby the symmetry in how the $R_i$ are defined. Hence\n\\[\nR_n(1+T) = R_n \\circ R_1(0) + R_n(1) = T + R_n(1);\n\\]\nthat is, $R_n(T) = T$. Hence $T = n$, as desired.", "category": "Geometry", "source": "PUTNAM", "year": 2004}
{"id": "putnam-2004-b5", "question": "Evaluate\n\\[\n\\lim_{x \\to 1^-} \\prod_{n=0}^\\infty \\left(\\frac{1 + x^{n+1}}{1 +\nx^n}\\right)^{x^n}.\n\\]", "solution": "\\textbf{First solution:}\nBy taking logarithms, we see that the desired limit is $\\exp(L)$,\nwhere $L = \\lim_{x\\to 1^-} \\sum_{n=0}^{\\infty} x^n \\left(\n\\ln(1+x^{n+1}) - \\ln(1+x^n) \\right)$. Now\n\\begin{align*}\n&\\sum_{n=0}^N x^n \\left( \\ln(1+x^{n+1}) - \\ln(1+x^n) \\right) \\\\\n& = 1/x\n\\sum_{n=0}^N x^{n+1} \\ln(1+x^{n+1}) - \\sum_{n=0}^N x^n\\ln(1+x^n) \\\\\n&=\nx^N \\ln(1+x^{N+1}) - \\ln 2 + (1/x-1) \\sum_{n=1}^N x^n\\ln(1+x^n);\n\\end{align*}\nsince $\\lim_{N\\to\\infty} (x^N\\ln(1+x^{N+1})) = 0$ for $0<x<1$, we\nconclude that $L = - \\ln 2 + \\lim_{x\\to 1^-} f(x)$, where\n\\begin{align*}\nf(x) &= (1/x-1) \\sum_{n=1}^{\\infty} x^n\\ln(1+x^n) \\\\\n&= (1/x-1)\n\\sum_{n=1}^\\infty \\sum_{m=1}^\\infty (-1)^{m+1} x^{n+mn}/m.\n\\end{align*}\nThis final double sum converges absolutely when $0<x<1$, since\n\\begin{align*}\n\\sum_{n=1}^\\infty \\sum_{m=1}^\\infty x^{n+mn}/m &= \\sum_{n=1}^\\infty\nx^n (-\\ln(1-x^n)) \\\\\n&< \\sum_{n=1}^\\infty x^n (-\\ln(1-x)),\n\\end{align*}\nwhich converges. (Note that $-\\ln(1-x)$ and $-\\ln(1-x^n)$ are\npositive.) Hence we may interchange the summations in $f(x)$ to\nobtain\n\\begin{align*}\nf(x) &= (1/x-1) \\sum_{m=1}^\\infty \\sum_{n=1}^\\infty \\frac{(-1)^{m+1}\nx^{(m+1)n}}{m} \\\\\n&= (1/x-1) \\sum_{m=1}^\\infty \\frac{(-1)^{m+1}}\n{m}\\left(\\frac{x^m(1-x)}{1-x^{m+1}}\\right).\n\\end{align*}\nThis last sum converges absolutely uniformly in $x$, so it is legitimate\nto take limits term by term.\nSince $\\lim_{x\\to 1^-} \\frac{x^m{1-x}}{1-x^{m+1}} = \\frac{1}{m+1}$\nfor fixed $m$, we have\n\\begin{align*}\n\\lim_{x\\to 1^-} f(x) &= \\sum_{m=1}^\\infty \\frac{(-1)^{m+1}}{m(m+1)} \\\\\n&= \\sum_{m=1}^\\infty (-1)^{m+1}\\left( \\frac{1}{m}-\\frac{1}{m+1} \\right) \\\\\n&= 2 \\left( \\sum_{m=1}^\\infty \\frac{(-1)^{m+1}}{m} \\right) - 1 \\\\ &= 2\n\\ln 2 - 1,\n\\end{align*}\nand hence $L = \\ln 2 - 1$ and the desired limit is $2/e$.\n\n\\textbf{Remark:} Note that the last series is not absolutely convergent,\nso the recombination must be done without rearranging terms.\n\n\\textbf{Second solution:}\n(by Greg Price, via Tony Zhang and Anders Kaseorg)\nPut $t_n(x) = \\ln(1 + x^n)$;\nwe can then write $x^n = \\exp(t_n(x)) - 1$, and\n\\[\nL = \\lim_{x \\to 1^-} \\sum_{n=0}^\\infty (t_n(x) - t_{n+1}(x))(1 - \\exp(t_n(x))).\n\\]\nThe expression on the right is a Riemann sum approximating the\nintegral $\\int_0^{\\ln 2} (1-e^t)\\,dt$, over the subdivision of $[0,\\ln(2))$\ngiven by the $t_n(x)$. As $x \\to 1^-$, the maximum difference between\nconsecutive $t_n(x)$ tends to 0, so the Riemann sum tends to the value\nof the integral. Hence $L = \\int_0^{\\ln 2}(1 - e^t)\\,dt = \\ln 2 - 1$, as\ndesired.\n\n\\def\\calA{\\mathcal{A}}\n\\def\\calB{\\mathcal{B}}", "category": "Number Theory", "source": "PUTNAM", "year": 2004}
{"id": "putnam-2004-b6", "question": "Let $\\mathcal{A}$\nbe a non-empty set of positive integers, and let $N(x)$ denote\nthe number of elements of $\\mathcal{A}$ not exceeding $x$.\nLet $\\mathcal{B}$ denote the set\nof positive integers $b$ that can be written in the form $b = a - a'$ with\n$a \\in \\mathcal{A}$  and $a' \\in  \\mathcal{A}$. Let $b_1 < b_2 < \\cdots$\nbe the members of $\\mathcal{B}$,\nlisted in increasing order. Show that if the sequence $b_{i+1} - b_i$ is\nunbounded, then\n\\[\n\\lim_{x \\to\\infty}  N(x)/x  = 0.\n\\]\n\n\\end{itemize}\n\\end{document}", "solution": "\\textbf{First solution:}\n(based on a solution of Dan Bernstein)\nNote that for any $b$, the condition that $b \\notin \\calB$ already\nforces $\\limsup N(x)/x$ to be at most 1/2: pair off $2mb + n$ with\n$(2m+1)b+n$ for $n=1,\\dots, b$, and note that at most one member of each\npair may belong to $\\calA$.\nThe idea of the proof is to do something\nsimilar with pairs replaced by larger clumps, using long runs of\nexcluded elements of $B$.\n\nSuppose we have positive integers\n$b_0 = 1, b_1, \\dots, b_n$ with\nthe following properties:\n\\begin{enumerate}", "category": "Combinatorics", "source": "PUTNAM", "year": 2004}
{"id": "putnam-2001-a1", "question": "Consider a set $S$ and a binary operation $*$, i.e., for each $a,b\\in S$,\n$a*b\\in S$.  Assume $(a*b)*a=b$ for all $a,b\\in S$.  Prove that\n$a*(b*a)=b$ for all $a,b\\in S$.", "solution": "The hypothesis implies $((b*a)*b)*(b*a)=b$ for all $a,b\\in S$\n(by replacing $a$ by $b*a$), and\nhence $a*(b*a)=b$ for all $a,b\\in S$ (using $(b*a)*b = a$).", "category": "Algebra", "source": "PUTNAM", "year": 2001}
{"id": "putnam-2001-a2", "question": "You have coins $C_1,C_2,\\ldots,C_n$.  For each $k$, $C_k$ is biased so\nthat, when tossed, it has probability $1/(2k+1)$ of falling heads.\nIf the $n$ coins are tossed, what is the probability that the number of\nheads is odd?  Express the answer as a rational function of $n$.", "solution": "Let $P_n$ denote the desired probability.  Then $P_1=1/3$, and, for\n$n>1$,\n\\begin{align*}\n P_n &= \\left(\\frac{2n}{2n+1}\\right) P_{n-1}\n        +\\left(\\frac{1}{2n+1}\\right) (1-P_{n-1}) \\\\\n       &= \\left(\\frac{2n-1}{2n+1}\\right)P_{n-1} + \\frac{1}{2n+1}.\n\\end{align*}\nThe recurrence yields $P_2=2/5$, $P_3=3/7$, and by a simple\ninduction, one then checks that for general $n$ one has $P_n=n/(2n+1)$.\n\nNote: Richard Stanley points out the following noninductive argument.\nPut $f(x) = \\prod_{k=1}^n (x+2k)/(2k+1)$; then the coefficient of\n$x^i$ in $f(x)$ is the probability of getting exactly $i$ heads. Thus\nthe desired number is $(f(1) - f(-1))/2$, and both values of $f$ can\nbe computed directly: $f(1) = 1$, and\n\\[\nf(-1) = \\frac{1}{3} \\times \\frac{3}{5} \\times \\cdots \\times \\frac{2n-1}{2n+1}\n= \\frac{1}{2n+1}.\n\\]", "category": "Combinatorics", "source": "PUTNAM", "year": 2001}
{"id": "putnam-2001-a3", "question": "For each integer $m$, consider the polynomial\n\\[P_m(x)=x^4-(2m+4)x^2+(m-2)^2.\\] For what values of $m$ is $P_m(x)$\nthe product of two non-constant polynomials with integer coefficients?", "solution": "By the quadratic formula, if $P_m(x)=0$, then $x^2=m\\pm\n2\\sqrt{2m}+2$, and hence the four roots of $P_m$ are given by\n$S = \\{\\pm\\sqrt{m}\\pm\\sqrt{2}\\}$. If $P_m$ factors into two nonconstant\npolynomials over the integers, then some subset of $S$ consisting of one\nor two elements form the roots of a polynomial with integer coefficients.\n\nFirst suppose this subset has a single element, say $\\sqrt{m} \\pm \\sqrt{2}$;\nthis element must be a rational number.\nThen $(\\sqrt{m} \\pm \\sqrt{2})^2 = 2 + m \\pm  2 \\sqrt{2m}$ is an integer,\nso $m$ is twice a perfect square, say $m = 2n^2$. But then\n$\\sqrt{m} \\pm \\sqrt{2} = (n\\pm 1)\\sqrt{2}$ is only rational if $n=\\pm 1$,\ni.e., if $m = 2$.\n\nNext, suppose that the subset contains two elements; then we can take\nit to be one of $\\{\\sqrt{m} \\pm \\sqrt{2}\\}$, $\\{\\sqrt{2} \\pm \\sqrt{m}\\}$\nor $\\{\\pm (\\sqrt{m} + \\sqrt{2})\\}$. In all cases, the sum and the product\nof the elements of the\nsubset must be a rational number. In the first case, this means\n$2\\sqrt{m} \\in \\QQ$, so $m$ is a perfect square. In the second case,\nwe have $2 \\sqrt{2} \\in \\QQ$, contradiction. In the third case, we have\n$(\\sqrt{m} + \\sqrt{2})^2 \\in \\QQ$, or $m + 2 + 2\\sqrt{2m} \\in \\QQ$, which\nmeans that $m$ is twice a perfect square.\n\nWe conclude that $P_m(x)$ factors into two nonconstant polynomials over\nthe integers if and only if $m$ is either a square or twice a square.\n\nNote: a more sophisticated interpretation of this argument can be given\nusing Galois theory. Namely, if $m$ is neither a square nor twice a square,\nthen the number fields $\\QQ(\\sqrt{m})$ and $\\QQ(\\sqrt{2})$ are distinct\nquadratic fields, so their compositum is a number field of degree 4, whose\nGalois group acts transitively on $\\{\\pm \\sqrt{m} \\pm \\sqrt{2}\\}$. Thus\n$P_m$ is irreducible.", "category": "Algebra", "source": "PUTNAM", "year": 2001}
{"id": "putnam-2001-a4", "question": "Triangle $ABC$ has an area 1.  Points $E,F,G$ lie, respectively,\non sides $BC$, $CA$, $AB$ such that $AE$ bisects $BF$ at point $R$,\n$BF$ bisects $CG$ at point $S$, and $CG$ bisects $AE$ at point $T$.\nFind the area of the triangle $RST$.", "solution": "Choose $r,s,t$ so that $EC = rBC, FA = sCA, GB = tCB$, and let\n$[XYZ]$ denote the area of triangle $XYZ$. Then $[ABE] = [AFE]$ since\nthe triangles have the same altitude and base.\nAlso $[ABE] = (BE/BC) [ABC] = 1-r$, and\n$[ECF] = (EC/BC)(CF/CA)[ABC] = r(1-s)$ (e.g., by the law of sines).\nAdding this\nall up yields\n\\begin{align*}\n1 &= [ABE] + [ABF] + [ECF] \\\\\n&= 2(1-r) + r(1-s) = 2-r-rs\n\\end{align*}\nor $r(1+s) = 1$.\nSimilarly $s(1+t) = t(1+r) = 1$.\n\nLet $f: [0, \\infty) \\to [0, \\infty)$ be the function given by\n$f(x) = 1/(1+x)$; then $f(f(f(r))) = r$.\nHowever, $f(x)$ is strictly decreasing in $x$, so $f(f(x))$ is increasing\nand $f(f(f(x)))$ is decreasing. Thus there is at most one $x$ such that\n$f(f(f(x))) = x$;\nin fact, since the equation $f(z) = z$ has a positive root\n$z = (-1 + \\sqrt{5})/2$, we must have $r=s=t=z$.\n\nWe now compute $[ABF] = (AF/AC) [ABC] = z$,\n$[ABR] = (BR/BF) [ABF] = z/2$, analogously $[BCS] = [CAT] = z/2$, and\n$[RST] = |[ABC] - [ABR] - [BCS] - [CAT]| = |1 - 3z/2| = \\frac{7 - 3\n\\sqrt{5}}{4}$.\n\nNote: the key relation $r(1+s) = 1$ can also be derived by computing\nusing homogeneous coordinates or vectors.", "category": "Geometry", "source": "PUTNAM", "year": 2001}
{"id": "putnam-2001-a5", "question": "Prove that there are unique positive integers $a$, $n$ such that\n$a^{n+1}-(a+1)^n=2001$.", "solution": "Suppose $a^{n+1} - (a+1)^n = 2001$.\nNotice that $a^{n+1} + [(a+1)^n - 1]$ is a multiple of $a$; thus\n$a$ divides $2002 = 2 \\times 7 \\times 11 \\times 13$.\n\nSince $2001$ is divisible by 3, we must have $a \\equiv 1 \\pmod{3}$,\notherwise one of $a^{n+1}$ and $(a+1)^n$ is a multiple of 3 and the\nother is not, so their difference cannot be divisible by 3. Now\n$a^{n+1} \\equiv 1 \\pmod{3}$, so we must have $(a+1)^n \\equiv 1\n\\pmod{3}$, which forces $n$ to be even, and in particular at least 2.\n\nIf $a$ is even, then $a^{n+1} - (a+1)^n \\equiv -(a+1)^n \\pmod{4}$.\nSince $n$ is even, $-(a+1)^n \\equiv -1 \\pmod{4}$. Since $2001 \\equiv 1\n\\pmod{4}$, this is impossible. Thus $a$ is odd, and so must divide\n$1001 = 7 \\times 11 \\times 13$. Moreover, $a^{n+1} - (a+1)^n \\equiv a\n\\pmod{4}$, so $a \\equiv 1 \\pmod{4}$.\n\nOf the divisors of $7 \\times 11 \\times 13$, those congruent to 1 mod 3\nare precisely those not divisible by 11 (since 7 and 13 are both\ncongruent to 1 mod 3). Thus $a$ divides $7 \\times 13$. Now\n$a \\equiv 1 \\pmod{4}$ is only possible if $a$ divides $13$.\n\nWe cannot have $a=1$, since $1 - 2^n \\neq 2001$ for any $n$. Thus\nthe only possibility is $a = 13$. One easily checks that $a=13, n=2$ is a\nsolution; all that remains is to check that no other $n$ works. In fact,\nif $n > 2$, then $13^{n+1} \\equiv 2001 \\equiv 1 \\pmod{8}$.\nBut $13^{n+1} \\equiv 13 \\pmod{8}$ since $n$ is even, contradiction.\nThus $a=13, n=2$ is the unique solution.\n\nNote: once one has that $n$ is even, one can use that $2002\n=a^{n+1} + 1 - (a+1)^n$ is divisible by $a+1$ to rule out cases.", "category": "Number Theory", "source": "PUTNAM", "year": 2001}
{"id": "putnam-2001-a6", "question": "Can an arc of a parabola inside a circle of radius 1 have a length\ngreater than 4?", "solution": "The answer is yes.  Consider the arc of the parabola\n$y=Ax^2$ inside the circle $x^2+(y-1)^2 = 1$, where we initially assume\nthat $A > 1/2$.  This intersects the circle in three points,\n$(0,0)$ and $(\\pm \\sqrt{2A-1}/A, (2A-1)/A)$.  We claim that for\n$A$ sufficiently large, the length $L$ of the parabolic arc between\n$(0,0)$ and $(\\sqrt{2A-1}/A, (2A-1)/A)$ is greater than $2$, which\nimplies the desired result by symmetry.  We express $L$ using the\nusual formula for arclength:\n\\begin{align*}\nL &= \\int_0^{\\sqrt{2A-1}/A} \\sqrt{1+(2Ax)^2} \\, dx \\\\\n&= \\frac{1}{2A} \\int_0^{2\\sqrt{2A-1}} \\sqrt{1+x^2} \\, dx \\\\\n&= 2 + \\frac{1}{2A} \\left( \\int_0^{2\\sqrt{2A-1}}\n(\\sqrt{1+x^2}-x)\\,dx -2\\right),\n\\end{align*}\nwhere we have artificially introduced $-x$ into the integrand in the\nlast step.  Now, for $x \\geq 0$,\n\\[\n\\sqrt{1+x^2}-x = \\frac{1}{\\sqrt{1+x^2}+x} > \\frac{1}{2\\sqrt{1+x^2}}\n\\geq \\frac{1}{2(x+1)};\n\\]\nsince $\\int_0^\\infty dx/(2(x+1))$ diverges, so does\n$\\int_0^\\infty (\\sqrt{1+x^2}-x)\\,dx$.  Hence, for sufficiently large\n$A$, we have $\\int_0^{2\\sqrt{2A-1}} (\\sqrt{1+x^2}-x)\\,dx > 2$,\nand hence $L > 2$.\n\nNote: a numerical computation shows that one must take $A > 34.7$ to\nobtain $L > 2$, and that the maximum value of $L$ is about\n$4.0027$, achieved for $A \\approx 94.1$.", "category": "Geometry", "source": "PUTNAM", "year": 2001}
{"id": "putnam-2001-b1", "question": "Let $n$ be an even positive integer.  Write the numbers\n$1,2,\\ldots,n^2$ in the squares of an $n\\times n$ grid so that the\n$k$-th row, from left to right, is\n\\[(k-1)n+1,(k-1)n+2,\\ldots, (k-1)n+n.\\]\nColor the squares of the grid so that half of the squares in each\nrow and in each column are red and the other half are black (a\ncheckerboard coloring is one possibility).  Prove that for each\ncoloring, the sum of the numbers on the red squares is equal to\nthe sum of the numbers on the black squares.", "solution": "Let $R$ (resp.\\ $B$) denote the set of red (resp.\\ black) squares in\nsuch a coloring, and for $s\\in R\\cup B$, let $f(s)n+g(s)+1$ denote the\nnumber written in square $s$, where $0\\leq f(s),g(s)\\leq n-1$.\nThen it is clear that the value of $f(s)$ depends only on the row of\n$s$, while the value of $g(s)$ depends only on the column of $s$.  Since\nevery row contains exactly $n/2$ elements of $R$ and $n/2$ elements of $B$,\n\\[ \\sum_{s\\in R} f(s) = \\sum_{s\\in B} f(s) .\\]\nSimilarly, because every column contains exactly $n/2$ elements of $R$ and\n$n/2$ elements of $B$,\n\\[ \\sum_{s\\in R} g(s) = \\sum_{s\\in B} g(s) .\\]\nIt follows that\n\\[\\sum_{s\\in R} f(s)n+g(s)+1 = \\sum_{s\\in B} f(s)n+g(s)+1,\\]\nas desired.\n\nNote: Richard Stanley points out a theorem of Ryser (see Ryser,\n\\textit{Combinatorial Mathematics}, Theorem~3.1) that can also be applied.\nNamely, if $A$ and $B$ are $0-1$ matrices with the same row and column\nsums, then there is a sequence of operations on $2 \\times 2$ matrices\nof the form\n\\[\n\\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix} \\to\n\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n\\]\nor vice versa, which transforms $A$ into $B$. If we identify 0 and 1 with\nred and black, then the given coloring and the checkerboard coloring\nboth satisfy the sum condition. Since the desired result is clearly\ntrue for the checkerboard coloring, and performing the matrix operations\ndoes not affect this, the desired result follows in general.", "category": "Combinatorics", "source": "PUTNAM", "year": 2001}
{"id": "putnam-2001-b2", "question": "Find all pairs of real numbers $(x,y)$ satisfying the system\nof equations\n\\begin{align*}\n \\frac{1}{x} + \\frac{1}{2y} &= (x^2+3y^2)(3x^2+y^2) \\\\\n   \\frac{1}{x} - \\frac{1}{2y} &= 2(y^4-x^4).\n\\end{align*}", "solution": "By adding and subtracting the two given equations, we obtain\nthe equivalent pair of equations\n\\begin{align*}\n2/x &= x^4 + 10x^2y^2 + 5y^4 \\\\\n1/y &= 5x^4 + 10x^2y^2 + y^4.\n\\end{align*}\nMultiplying the former by\n$x$ and the latter by $y$, then adding and subtracting the two\nresulting equations, we obtain another pair of equations equivalent\nto the given ones,\n\\[\n3 = (x+y)^5, \\qquad 1 = (x-y)^5.\n\\]\nIt follows that\n$x = (3^{1/5}+1)/2$ and $y = (3^{1/5}-1)/2$ is the unique solution\nsatisfying the given equations.", "category": "Algebra", "source": "PUTNAM", "year": 2001}
{"id": "putnam-2001-b3", "question": "For any positive integer $n$, let $\\langle n\\rangle$ denote\nthe closest integer to $\\sqrt{n}$.  Evaluate\n\\[\\sum_{n=1}^\\infty \\frac{2^{\\langle n\\rangle}+2^{-\\langle n\\rangle}}\n                         {2^n}.\\]", "solution": "Since $(k-1/2)^2 = k^2-k+1/4$ and $(k+1/2)^2 = k^2+k+1/4$,\nwe have that $\\langle n \\rangle = k$ if and only if\n$k^2-k+1 \\leq n \\leq k^2+k$.  Hence\n\\begin{align*}\n\\sum_{n=1}^\\infty \\frac{2^{\\langle n \\rangle} + 2^{-\\langle n \\rangle}}{2^n}\n&= \\sum_{k=1}^\\infty \\sum_{n, \\langle n \\rangle = k}\n    \\frac{2^{\\langle n \\rangle} + 2^{-\\langle n \\rangle}}{2^n} \\\\\n&= \\sum_{k=1}^\\infty \\sum_{n=k^2-k+1}^{k^2+k} \\frac{2^k+2^{-k}}{2^n} \\\\\n&= \\sum_{k=1}^\\infty (2^k+2^{-k})(2^{-k^2+k}-2^{-k^2-k}) \\\\\n&= \\sum_{k=1}^\\infty (2^{-k(k-2)} - 2^{-k(k+2)}) \\\\\n&= \\sum_{k=1}^\\infty 2^{-k(k-2)} - \\sum_{k=3}^\\infty 2^{-k(k-2)} \\\\\n&= 3.\n\\end{align*}\n\nAlternate solution: rewrite the sum as $\\sum_{n=1}^\\infty\n2^{-(n+\\langle n \\rangle)} + \\sum_{n=1}^\\infty\n2^{-(n - \\langle n \\rangle)}$.\nNote that $\\langle n \\rangle \\neq \\langle n+1 \\rangle$\nif and only if $n = m^2+m$ for some $m$. Thus $n + \\langle n \\rangle$\nand $n - \\langle n \\rangle$ each increase by 1 except at $n=m^2+m$,\nwhere the former skips from $m^2+2m$ to $m^2+2m+2$ and the latter\nrepeats the value $m^2$. Thus the sums are\n\\[\n\\sum_{n=1}^\\infty 2^{-n} - \\sum_{m=1}^\\infty 2^{-m^2}\n+ \\sum_{n=0}^\\infty 2^{-n} + \\sum_{m=1}^\\infty 2^{-m^2}\n= 2+1=3.\n\\]", "category": "Number Theory", "source": "PUTNAM", "year": 2001}
{"id": "putnam-2001-b4", "question": "Let $S$ denote the set of rational numbers different from\n$\\{-1,0,1\\}$.  Define $f:S\\rightarrow S$ by $f(x)=x-1/x$.  Prove\nor disprove that\n\\[\\bigcap_{n=1}^\\infty f^{(n)}(S) = \\emptyset,\\]\nwhere $f^{(n)}$ denotes $f$ composed with itself $n$ times.", "solution": "For a rational number $p/q$ expressed in lowest terms, define\nits {\\it height} $H(p/q)$ to be $|p|+|q|$.  Then for any $p/q\\in S$\nexpressed in lowest terms, we have $H(f(p/q))=|q^2-p^2|+|pq|$; since\nby assumption $p$ and $q$ are nonzero integers with $|p|\\neq |q|$,\nwe have\n\\begin{align*}\nH(f(p/q)) - H(p/q) &= |q^2-p^2|+|pq| -|p| -|q| \\\\\n  &\\geq 3+ |pq| -|p| - |q| \\\\\n&= (|p|-1)(|q|-1) + 2 \\geq 2 .\n\\end{align*}\nIt follows that $f^{(n)}(S)$ consists solely of numbers of height\nstrictly larger than $2n+2$, and hence\n\\[\\cap_{n=1}^\\infty f^{(n)}(S) = \\emptyset.\\]\n\nNote: many choices for the height function are possible: one can\ntake $H(p/q) = \\max{|p|, |q|}$, or $H(p/q)$ equal to the total number of\nprime factors of $p$ and $q$, and so on. The key properties of the height\nfunction are that on one hand, there are only finitely many rationals with\nheight below any finite bound, and on the other hand, the height function\nis a sufficiently ``algebraic'' function of its argument that one can\nrelate the heights of $p/q$ and $f(p/q)$.", "category": "Algebra", "source": "PUTNAM", "year": 2001}
{"id": "putnam-2001-b5", "question": "Let $a$ and $b$ be real numbers in the interval $(0,1/2)$, and\nlet $g$ be a continuous real-valued function such that\n$g(g(x))= ag(x)+bx$ for all real $x$.  Prove that\n$g(x)=cx$ for some constant $c$.", "solution": "Note that $g(x) = g(y)$ implies that $g(g(x)) = g(g(y))$ and hence\n$x = y$ from the given equation. That is, $g$ is injective. Since $g$\nis also continuous, $g$ is either strictly increasing or strictly\ndecreasing. Moreover, $g$ cannot tend to a finite limit $L$ as $x \\to\n+\\infty$, or else we'd have $g(g(x)) - ag(x) = bx$, with the left side\nbounded and the right side unbounded. Similarly, $g$ cannot tend to\na finite limit as $x \\to -\\infty$. Together with monotonicity, this\nyields that $g$ is also surjective.\n\nPick $x_0$ arbitrary, and define $x_n$ for all $n \\in \\ZZ$ recursively\nby $x_{n+1} = g(x_n)$ for $n > 0$, and $x_{n-1} = g^{-1}(x_n)$ for $n<0$.\nLet $r_1 = (a + \\sqrt{a^2+4b})/2$ and $r_2 = (a - \\sqrt{a^2+4b})/2$ and\n$r_2$ be the roots of $x^2 - ax-b = 0$, so that $r_1 > 0 >\nr_2$ and $1 > |r_1| > |r_2|$. Then there exist $c_1, c_2 \\in \\RR$ such that\n$x_n = c_1 r_1^n + c_2 r_2^n$ for all $n \\in \\ZZ$.\n\nSuppose $g$ is strictly increasing. If $c_2 \\neq 0$ for some choice of\n$x_0$, then $x_n$ is dominated by $r_2^n$ for $n$ sufficiently\nnegative. But taking $x_n$ and $x_{n+2}$ for $n$ sufficiently negative of the\nright parity, we get $0 < x_n < x_{n+2}$ but $g(x_n) > g(x_{n+2})$,\ncontradiction. Thus $c_2 = 0$; since $x_0 = c_1$\nand $x_1 = c_1 r_1$, we have $g(x) = r_1 x$ for all $x$.\nAnalogously, if $g$ is strictly decreasing, then $c_2 = 0$ or else\n$x_n$ is dominated by $r_1^n$ for $n$ sufficiently positive. But taking\n$x_n$ and $x_{n+2}$ for $n$ sufficiently positive of the right parity,\nwe get $0 < x_{n+2} <x_n$ but $g(x_{n+2}) < g(x_n)$, contradiction.\nThus in that case, $g(x) = r_2 x$ for all $x$.", "category": "Algebra", "source": "PUTNAM", "year": 2001}
{"id": "putnam-2001-b6", "question": "Assume that $(a_n)_{n\\geq 1}$ is an increasing sequence of\npositive real numbers such that\n$\\lim a_n/n=0$.  Must there exist infinitely many positive integers\n$n$ such that $a_{n-i}+a_{n+i}<2a_n$ for $i=1,2,\\ldots,n-1$?\n\n\\end{itemize}\n\\end{document}", "solution": "Yes, there must exist infinitely many such $n$.\nLet $S$ be the convex hull of the set of points $(n,\na_n)$ for $n \\geq 0$. Geometrically, $S$ is the intersection of\nall convex sets (or even all halfplanes) containing the points\n$(n, a_n)$; algebraically, $S$ is the set of points $(x,y)$\nwhich can be written as $c_1(n_1, a_{n_1}) + \\cdots + c_k(n_k, a_{n_k})$\nfor some $c_1, \\dots, c_k$ which are nonnegative of sum 1.\n\nWe prove that for infinitely many $n$, $(n, a_n)$ is a vertex on the upper\nboundary of $S$, and that these $n$ satisfy the given\ncondition. The condition that $(n, a_n)$ is a vertex on the upper\nboundary of $S$ is equivalent to the existence of a line passing through\n$(n, a_n)$ with all other points of $S$ below it.\nThat is, there should exist $m>0$ such that\n\\begin{equation} \\label{eq1}\na_k < a_n + m(k-n) \\qquad \\forall k \\geq 1.\n\\end{equation}\n\nWe first show that $n=1$ satisfies (\\ref{eq1}). The condition\n$a_k/k \\to 0$ as $k \\to \\infty$\nimplies that $(a_k - a_1)/(k-1) \\to 0$ as well. Thus the\nset $\\{(a_k-a_1)/(k-1)\\}$ has an upper bound $m$, and now\n$a_k \\leq a_1 + m(k-1)$, as desired.\n\nNext, we show that given one $n$ satisfying (\\ref{eq1}), there exists a\nlarger one also satisfying (\\ref{eq1}). Again, the condition\n$a_k/k \\to 0$ as $k \\to \\infty$ implies that $(a_k-a_n)/(k-n) \\to 0$ as\n$k \\to \\infty$. Thus the sequence $\\{(a_k-a_n)/(k-n)\\}_{k>n}$ has a\nmaximum element; suppose $k = r$ is the largest value that\nachieves this maximum, and put\n$m = (a_r -a_n)/(r-n)$. Then the line through\n$(r, a_r)$ of slope $m$ lies strictly above $(k, a_k)$ for $k > r$\nand passes through or lies above $(k, a_k)$ for $k< r$.\nThus (\\ref{eq1})\nholds for $n=r$ with $m$ replaced by $m-\\epsilon$ for suitably small\n$\\epsilon > 0$.\n\nBy induction, we have that (\\ref{eq1}) holds for infinitely many $n$.\nFor any such $n$ there exists $m>0$ such that for $i=1, \\dots, n-1$, the\npoints $(n-i, a_{n-i})$ and $(n+i, a_{n+i})$ lie below the line through\n$(n, a_n)$ of slope $m$. That means $a_{n+i} < a_n + mi$\nand $a_{n-i} < a_n - mi$; adding these together gives\n$a_{n-i} + a_{n+i} < 2a_n$, as desired.\n\n\\end{itemize}\n\n\\end{document}", "category": "Number Theory", "source": "PUTNAM", "year": 2001}
{"id": "imo-2006-q1", "question": "Let $ABC$ be a triangle with incenter $I$.\nA point $P$ in the interior of the triangle satisfies\n\\[ \\angle PBA + \\angle PCA = \\angle PBC + \\angle PCB. \\]\nShow that $AP \\ge AI$ and that equality holds if and only if $P=I$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p571966}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle with incenter $I$.\nA point $P$ in the interior of the triangle satisfies\n\\[ \\angle PBA + \\angle PCA = \\angle PBC + \\angle PCB. \\]\nShow that $AP \\ge AI$ and that equality holds if and only if $P=I$.\n\\end{mdframed}\nThe condition rewrites as\n\\[\n  \\angle PBC + \\angle PCB\n  = (\\angle B - \\angle PBC)\n  + (\\angle C - \\angle PCB)\n  \\implies\n  \\angle PBC + \\angle PCB = \\frac{\\angle B + \\angle C}{2}\n\\]\nwhich means that\n\\[ \\angle BPC = 180\\dg - \\frac{\\angle B + \\angle C}{2}\n  = 90\\dg + \\frac{\\angle A}{2}\n  = \\angle BIC.\n\\]\nSince $P$ and $I$ are both inside $\\triangle ABC$\nthat implies $P$ lies on the circumcircle of $\\triangle BIC$.\n\nIt's well-known (by ``Fact 5'') that the circumcenter\nof $\\triangle BIC$ is the arc midpoint $M$ of $\\widehat{BC}$.\nTherefore\n\\[ AI + IM = AM \\le AP + PM \\implies AI \\le AP \\]\nwith equality holding iff $A$, $P$, $M$ are collinear, or $P=I$.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2006}
{"id": "imo-2006-q2", "question": "Let $P$ be a regular $2006$-gon.\nA diagonal is called \\emph{good} if its endpoints\ndivide the boundary of $P$ into two parts,\neach composed of an odd number of sides of $P$.\nThe sides of $P$ are also called \\emph{good}.\nSuppose $P$ has been dissected into triangles by $2003$ diagonals,\nno two of which have a common point in the interior of $P$.\nFind the maximum number of isosceles triangles having two good\nsides that could appear in such a configuration.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p571973}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $P$ be a regular $2006$-gon.\nA diagonal is called \\emph{good} if its endpoints\ndivide the boundary of $P$ into two parts,\neach composed of an odd number of sides of $P$.\nThe sides of $P$ are also called \\emph{good}.\nSuppose $P$ has been dissected into triangles by $2003$ diagonals,\nno two of which have a common point in the interior of $P$.\nFind the maximum number of isosceles triangles having two good\nsides that could appear in such a configuration.\n\\end{mdframed}\nCall a triangle with the desired property \\emph{special}.\nWe prove the maximum number of special triangles is $1003$,\nachieved by paring up the sides of the polygon.\n\nWe present two solutions for the upper bound.\nBoth of them rely first on two geometric notes:\n\\begin{itemize}\n  \\ii In a special triangle, the good sides are congruent\n  (and not congruent to the third side).\n  \\ii No two isosceles triangles share a good side.\n\\end{itemize}\n\n\\textbf{Solution using bijections}:\nCall a good diagonal \\textbf{special} if it's part of a special triangle;\nspecial diagonals come in pairs.\nConsider the minor arc cut out by a special diagonal $d$,\nwhich has an odd number of sides.\nSince special diagonals come in pairs,\none can associate to $d$ a side of the polygon\nnot covered by any special diagonals from $d$.\nHence there are at most $2006$ special diagonals,\nso at most $1003$ special triangles.\n\n\\textbf{Solution using graph theory}:\nConsider the tree $T$ formed by the $2004$\ntriangles in the dissection, with obvious adjacency.\nLet $F$ be the forest obtained by deleting\nany edge corresponding to a good diagonal.\nThen the resulting graph $F$ has only degrees $1$ and $3$,\nwith special triangles only occurring at degree $1$ vertices.\n\nIf there are $k$ good diagonals drawn,\nthen this forest consists of $k+1$ trees.\nA tree with $n_i$ vertices ($0 \\le i \\le k$)\nconsequently has $\\frac{n_i+2}{2}$ leaves.\nHowever by the earlier remark at least $k$ leaves\ndon't give special triangles\n(one on each side of a special diagonal);\nso the number of leaves that do give good triangles is at most\n\\[ -k + \\sum_i \\frac{n_i+2}{2}\n  = -k + \\frac{2004 + 2(k+1)}{2} = 1003. \\]\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2006}
{"id": "imo-2006-q3", "question": "Determine the least real number $M$ such that the inequality\n\\[ \\left\\lvert ab(a^2-b^2)+bc(b^2-c^2)+ca(c^2-a^2) \\right\\rvert\n  \\leq M\\left( a^2+b^2+c^2 \\right)^2 \\]\nholds for all real numbers $a$, $b$ and $c$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p571945}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nDetermine the least real number $M$ such that the inequality\n\\[ \\left\\lvert ab(a^2-b^2)+bc(b^2-c^2)+ca(c^2-a^2) \\right\\rvert\n  \\leq M\\left( a^2+b^2+c^2 \\right)^2 \\]\nholds for all real numbers $a$, $b$ and $c$.\n\\end{mdframed}\nIt's the same as\n\\[ \\left\\lvert (a-b)(b-c)(c-a)(a+b+c) \\right\\rvert\n\\le M \\left( a^2+b^2+c^2 \\right)^2. \\]\nLet $x=a-b$, $y=b-c$, $z=c-a$, $s=a+b+c$.\nThen we want to have\n\\[\n  \\left\\lvert xyzs \\right\\rvert\n  \\le \\frac{M}{9} (x^2+y^2+z^2+s^2)^2.\n\\]\nHere $x+y+z=0$.\n\nNow if $x$ and $y$ have the same sign,\nwe can replace them with the average\n(this increases the LHS and decreases RHS).\nSo we can have $x=y$, $z=-2x$.\nNow WLOG $x > 0$ to get\n\\[ 2x^3 \\cdot s \\le \\frac{M}{9} \\left( 6x^2+s^2 \\right)^2. \\]\nAfter this routine calculation gives\n$M = \\frac{9}{32}\\sqrt2$ works and is optimal\n(by $6x^2+s^2 = 2x^2 + 2x^2 + 2x^2 + s^2$ and AM-GM).\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Algebra", "source": "IMO", "year": 2006}
{"id": "imo-2006-q4", "question": "Determine all pairs $(x,y)$ of integers such that\n\\[ 1 + 2^x + 2^{2x+1} = y^2. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p572815}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nDetermine all pairs $(x,y)$ of integers such that\n\\[ 1 + 2^x + 2^{2x+1} = y^2. \\]\n\\end{mdframed}\nAnswers: $(0, \\pm 2)$, $(4, \\pm 23)$, which work.\n\nAssume $x \\ge 4$.\n\\[ 2^x \\left( 1 + 2^{x+1} \\right)\n  = 2^x + 2^{2x+1} = y^2 - 1 = (y-1)(y+1). \\]\nSo either:\n\\begin{itemize}\n  \\ii $y = 2^{x-1} m + 1$ for some odd $m$, so\n  \\[ 1 + 2^{x+1} = m\\left( 2^{x-2}m+1 \\right)\n    \\implies 2^x = \\frac{4(1-m)}{m^2-8}. \\]\n  \\ii $y = 2^{x-1} m - 1$ for some odd $m$, so\n  \\[ 1 + 2^{x+1} = m\\left( 2^{x-2}m-1 \\right)\n    \\implies 2^x = \\frac{4(1+m)}{m^2-8}. \\]\n\\end{itemize}\nIn particular we need $4|1 \\pm m| \\ge 2^4 |m^2-8|$,\nwhich is enough to imply $m < 5$.\nFrom here easily recover $x = 4$, $m = 3$ as the last solution\n(in the second case).\n\\pagebreak", "category": "Number Theory", "source": "IMO", "year": 2006}
{"id": "imo-2006-q5", "question": "Let $P(x)$ be a polynomial of degree $n > 1$\nwith integer coefficients and let $k$ be a positive integer.\nConsider the polynomial\n\\[ Q(x) = P(P(\\dots P(P(x)) \\dots )) \\] where $P$ occurs $k$ times.\nProve that there are at most $n$ integers $t$ such that $Q(t) = t$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p572821}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $P(x)$ be a polynomial of degree $n > 1$\nwith integer coefficients and let $k$ be a positive integer.\nConsider the polynomial\n\\[ Q(x) = P(P(\\dots P(P(x)) \\dots )) \\] where $P$ occurs $k$ times.\nProve that there are at most $n$ integers $t$ such that $Q(t) = t$.\n\\end{mdframed}\nFirst, we prove that:\n\\begin{claim*}\n  [Putnam 2000 et al]\n  If a number is periodic under $P$\n  then in fact it's fixed by $P \\circ P$.\n\\end{claim*}\n\\begin{proof}\n  Let $x_1$, $x_2$, \\dots, $x_n$ be a minimal orbit.\n  Then\n  \\[ x_i - x_{i+1} \\mid P(x_i) - P(x_{i+1})\n    = x_{i+1} - x_{i+2} \\]\n  and so on cyclically.\n\n  If any of the quantities are zero we are done.\n  Else, we must eventually have $x_i - x_{i+1} = -(x_{i+1} - x_{i+2})$,\n  so $x_i = x_{i+2}$ and we get $2$-periodicity.\n\\end{proof}\n\nThe tricky part is to study the $2$-orbits.\nSuppose there exists a fixed pair $u \\neq v$\nwith $P(u) = v$, $P(v) = u$.\n(If no such pair exists, we are already done.)\nLet $(a,b)$ be any other pair with $P(a) = b$, $P(b) = a$,\npossibly even $a = b$, but $\\{a,b\\} \\cap \\{u,v\\} = \\varnothing$.\nThen we should have\n\\[ u-a \\mid P(u)-P(a) = v-b\n  \\mid P(v) - P(b) = u-a \\]\nand so $u-a$ and $v-b$ divide each other (and are nonzero).\nSimilarly, $u-b$ and $v-a$ divide each other.\n\nHence $u-a = \\pm (v-b)$ and $u-b = \\pm (v-a)$.\nWe consider all four cases:\n\\begin{itemize}\n  \\ii If $u-a = v-b$ and $u-b = v-a$\n  then $u-v = b-a = a-b$, contradiction.\n  \\ii If $u-a = -(v-b)$ and $u-b = -(v-a)$\n  then $u+v = u-v = a+b$.\n  \\ii If $u-a = -(v-b)$ and $u-b = v-a$,\n  we get $a+b = u+v$ from the first one\n  (discarding the second).\n  \\ii If $u-a = v-b$ and $u-b = -(v-a)$,\n  we get $a+b = u+v$ from the second one\n  (discarding the first one).\n\\end{itemize}\nThus in all possible situations we have\n\\[ a+b = c \\coloneq u+v \\]\na fixed constant.\n\nTherefore, any pair $(a,b)$ with $P(a) = b$\nand $P(b) = a$ actually satisfies $P(a) = c-a$.\nAnd since $\\deg P > 1$,\nthis means there are at most $n$ roots to $a+P(a)=c$, as needed.\n\\pagebreak", "category": "Algebra", "source": "IMO", "year": 2006}
{"id": "imo-2006-q6", "question": "Assign to each side $b$ of a convex polygon $P$\nthe maximum area of a triangle that has $b$ as a side and is contained in $P$.\nShow that the sum of the areas assigned to the sides of $P$ is at least twice the area of $P$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p572824}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nAssign to each side $b$ of a convex polygon $P$\nthe maximum area of a triangle that has $b$ as a side and is contained in $P$.\nShow that the sum of the areas assigned to the sides of $P$ is at least twice the area of $P$.\n\\end{mdframed}\nWe say a polygon in \\emph{almost convex}\nif all its angles are at most $180\\dg$.\n\nNote that given any convex or almost convex polygon,\nwe can take any side $b$ and add another vertex on it, and the sum of the labels doesn't change\n(since the label of a side is the length of the side times the distance of the farthest point).\n\n\\begin{lemma*}\n  Let $N$ be an even integer.\n  Then any almost convex $N$-gon with area $S$\n  should have an inscribed triangle with area at least $2S/N$.\n\\end{lemma*}\nThe main work is the proof of the lemma.\n\nLabel the polygon $P_0 P_1 \\dots P_{N-1}$.\nConsider the $N/2$ major diagonals of the almost convex $N$-gon,\n$P_0 P_{N/2}$, $P_1 P_{N/2+1}$, et cetera.\nA \\emph{butterfly} refers to a self-intersecting quadrilateral\n$P_i P_{i+1} P_{i+1+N/2} P_{i+N/2}$.\nAn example of a butterfly is shown below for $N=8$.\n\\begin{center}\n\\begin{asy}\npair P_0 = (-1,-3);\npair P_1 = ( 0,-3);\npair P_2 = (2.5,-3);\npair P_3 = (3,0);\npair P_4 = (1.8,1.2);\npair P_5 = (1.1,1.9);\npair P_6 = (0.3,2.7);\npair P_7 = (-2,0.4);\nfilldraw(P_0--P_2--P_3--P_6--P_7--cycle, opacity(0.1)+lightcyan, blue);\n\nfilldraw(P_0--P_4--P_5--P_1--cycle, opacity(0.2)+lightred, red);\ndraw(P_1--P_5, red);\ndraw(P_2--P_6, red);\ndraw(P_3--P_7, red);\n\ndot(\"$P_0$\", P_0, dir(P_0));\ndot(\"$P_1$\", P_1, dir(P_1));\ndot(\"$P_2$\", P_2, dir(P_2));\ndot(\"$P_3$\", P_3, dir(P_3));\ndot(\"$P_4$\", P_4, dir(P_4));\ndot(\"$P_5$\", P_5, dir(P_5));\ndot(\"$P_6$\", P_6, dir(P_6));\ndot(\"$P_7$\", P_7, dir(P_7));\n\n/* TSQ Source:\n\nP_0 = (-1,-3)\nP_1 = ( 0,-3)\nP_2 = (2.5,-3)\nP_3 = (3,0)\nP_4 = (1.8,1.2)\nP_5 = (1.1,1.9)\nP_6 = (0.3,2.7)\nP_7 = (-2,0.4)\nP_0--P_2--P_3--P_6--P_7--cycle 0.1 lightcyan / blue\n\nP_0--P_4--P_5--P_1--cycle 0.2 lightred / red\nP_1--P_5 red\nP_2--P_6 red\nP_3--P_7 red\n\n*/\n\\end{asy}\n\\end{center}\n\n\\begin{claim*}\n  Every point $X$ in the polygon is contained in the wingspan of some butterfly.\n\\end{claim*}\n\\begin{proof}\n  Consider a windmill-like process which\n  \\begin{itemize}\n    \\ii starts from some oriented red line $P_0 P_{N/2}$, oriented to face $P_0 P_{N/2}$\n    \\ii rotates through $P_0 P_{N/2} \\cap P_1 P_{N/2+1}$ to get line $P_1 P_{N/2+1}$,\n    \\ii rotates through $P_1 P_{N/2+1} \\cap P_2 P_{N/2+2}$ to get line $P_2 P_{N/2+2}$,\n    \\ii \\dots et cetera, until returning to line $P_{N/2} P_0$,\n    but in the reverse orientation.\n  \\end{itemize}\n  At the end of the process, every point in the plane has switched sides with our moving line.\n  The moment that $X$ crosses the moving red line, we get it contained in a butterfly, as needed.\n\\end{proof}\n\n\\begin{claim*}\n  If $ABDC = P_i P_{i+1} P_{i+1+N/2} P_{i+N/2}$ is a butterfly,\n  one of the triangles $ABC$, $BCD$, $CDA$, $DAB$\n  has area at least that of the butterfly.\n\\end{claim*}\n\\begin{proof}\n  Let the diagonals of the butterfly meet at $O$,\n  and let $a = AO$, $b = BO$, $c = CO$, $d = DO$.\n  If we assume WLOG $d = \\min(a,b,c,d)$\n  then it follows $[ABC] = [AOB] + [BOC] \\ge [AOB] + [COD]$, as needed.\n\\end{proof}\n\nNow, since the $N/2$ butterflies cover an area of $S$,\nit follows that one of the butterflies\nhas area at least $S / (N/2) = 2S/N$,\nand so that butterfly gives a triangle with area at least $2S/N$,\ncompleting the proof of the lemma.\n\n\\paragraph{Main proof.}\nLet $a_1$, \\dots, $a_n$ be the numbers assigned to the sides.\nAssume for contradiction $a_1 + \\dots + a_n < 2S$.\nWe pick even integers $m_1$, $m_2$, \\dots, $m_n$ such that\n\\begin{align*}\n  \\frac{a_1}{S} &< \\frac{2m_1}{m_1 + \\dots + m_n} \\\\\n  \\frac{a_2}{S} &< \\frac{2m_2}{m_1 + \\dots + m_n} \\\\\n  &\\vdotswithin\\le \\\\\n  \\frac{a_n}{S} &< \\frac{2m_n}{m_1 + \\dots + m_n}.\n\\end{align*}\nwhich is possible by rational approximation,\nsince the right-hand sides sum to $2$ and the left-hand sides sum to strictly less than $2$.\n\nNow we break every side of $P$ into $m_i$ equal parts\nto get an almost convex $N$-gon, where $N = m_1 + \\dots + m_n$.\n\nThe main lemma then gives us a triangle $\\Delta$ of the almost convex $N$-gon\nwhich has area at least $\\frac{2S}{N}$.\nIf $\\Delta$ used the $i$th side then it then follows the label $a_i$ on that side should be\nat least $m_i \\cdot \\frac{2S}{N}$, contradiction.\n\\pagebreak\n\n\n\\end{document}", "category": "Geometry", "source": "IMO", "year": 2006}
{"id": "usamo-2017-q1", "question": "Prove that there exist infinitely many pairs of\nrelatively prime positive integers $a,b > 1$\nfor which $a+b$ divides $a^b+b^a$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p8108366}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nProve that there exist infinitely many pairs of\nrelatively prime positive integers $a,b > 1$\nfor which $a+b$ divides $a^b+b^a$.\n\\end{mdframed}\nOne construction: let $d \\equiv 1 \\pmod 4$, $d > 1$.\nLet $x = \\frac{d^d+2^d}{d+2}$. Then set\n\\[ a = \\frac{x+d}{2}, \\qquad\n  b = \\frac{x-d}{2}. \\]\nTo see this works, first check that $b$ is odd and $a$ is even.\nLet $d = a-b$ be odd.\nThen:\n\\begin{align*}\n  a+b \\mid a^b+b^a &\\iff\n  (-b)^b + b^a \\equiv 0 \\pmod{a+b} \\\\\n  &\\iff b^{a-b} \\equiv 1 \\pmod{a+b} \\\\\n  &\\iff b^d \\equiv 1 \\pmod{d+2b} \\\\\n  &\\iff (-2)^d \\equiv d^d \\pmod{d+2b} \\\\\n  &\\iff d+2b \\mid d^d + 2^d.\n\\end{align*}\nSo it would be enough that\n\\[ d+2b = \\frac{d^d+2^d}{d+2}\n  \\implies b = \\half \\left( \\frac{d^d+2^d}{d+2} - d \\right) \\]\nwhich is what we constructed.\nAlso, since $\\gcd(x,d) = 1$ it follows $\\gcd(a,b) = \\gcd(d,b) = 1$.\n\n\\begin{remark*}\n  Ryan Kim points out that in fact,\n  $(a,b) = (2n-1,2n+1)$ is always a solution.\n\\end{remark*}\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 2017}
{"id": "usamo-2017-q2", "question": "Let $m_1$, $m_2$, \\dots, $m_n$ be a collection of $n$ positive integers,\nnot necessarily distinct.\nFor any sequence of integers $A = (a_1, \\dots, a_n)$\nand any permutation $w = w_1, \\dots, w_n$ of $m_1, \\dots, m_n$,\ndefine an $A$-inversion of $w$ to be a pair of\nentries $w_i, w_j$ with $i < j$ for which\none of the following conditions holds:\n\\begin{itemize}\n  \\ii $a_i \\ge w_i > w_j$,\n    \\ii $w_j > a_i \\ge w_i$, or\n    \\ii $w_i > w_j > a_i$.\n\\end{itemize}\nShow that, for any two sequences of integers\n$A = (a_1, \\dots, a_n)$ and $B = (b_1, \\dots, b_n)$,\nand for any positive integer $k$, the number of permutations\nof $m_1, \\dots, m_n$ having exactly $k$ $A$-inversions\nis equal to the number of permutations of $m_1, \\dots, m_n$\nhaving exactly $k$ $B$-inversions.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p8108658}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $m_1$, $m_2$, \\dots, $m_n$ be a collection of $n$ positive integers,\nnot necessarily distinct.\nFor any sequence of integers $A = (a_1, \\dots, a_n)$\nand any permutation $w = w_1, \\dots, w_n$ of $m_1, \\dots, m_n$,\ndefine an $A$-inversion of $w$ to be a pair of\nentries $w_i, w_j$ with $i < j$ for which\none of the following conditions holds:\n\\begin{itemize}\n  \\ii $a_i \\ge w_i > w_j$,\n    \\ii $w_j > a_i \\ge w_i$, or\n    \\ii $w_i > w_j > a_i$.\n\\end{itemize}\nShow that, for any two sequences of integers\n$A = (a_1, \\dots, a_n)$ and $B = (b_1, \\dots, b_n)$,\nand for any positive integer $k$, the number of permutations\nof $m_1, \\dots, m_n$ having exactly $k$ $A$-inversions\nis equal to the number of permutations of $m_1, \\dots, m_n$\nhaving exactly $k$ $B$-inversions.\n\\end{mdframed}\nThe following solution was posted by Michael Ren,\nand I think it is the most natural one\n(since it captures all the combinatorial ideas\nusing a $q$-generating function that is easier to think about,\nand thus makes the problem essentially a long computation).\n\nDenote by $M$ our multiset of $n$ positive integers.\nDefine an \\emph{inversion} of a permutation to be pair $i < j$\nwith $w_i < w_j$ (which is a $(0,\\dots,0)$-inversion in the problem statement);\nthis is the usual definition\n(see \\url{https://en.wikipedia.org/wiki/Inversion_(discrete_mathematics)}).\nSo we want to show the number of $A$-inversions\nis equal to the number of usual inversions.\nIn what follows we count permutations on $M$ with multiplicity:\nso $M = \\{1,1,2\\}$ still has $3!=6$ permutations.\n\nWe are going to do what is essentially recursion,\nbut using generating functions in a variable $q$ to do our book-keeping.\n(Motivation: there's no good closed form for the number of inversions,\nbut there's a great generating function known --- which is even better\nfor us, since we're only trying to show two numbers are equal!)\nFirst, we prove two claims.\n\n\\begin{claim*}\n  For any positive integer $n$,\n  the generating function for the number of permutations\n  of $(1, 2, \\dots, n)$ with exactly $k$ inversions is\n  \\[ n!_q \\coloneq 1 \\cdot (1+q) \\cdot (1+q+q^2) \\cdot \\dots (1+q+\\dots+q^{n-1}). \\]\n\\end{claim*}\nHere we mean that the coefficient of $q^s$ above\ngives the number of permutations with exactly $s$ inversions.\n\\begin{proof}\n  This is an induction on $n$, with $n=1$ being trivial.\n  Suppose we choose the first element to be $i$, with $1 \\le i \\le n$.\n  Then there will always be exactly $i-1$ inversions\n  using the first element,\n  so this contributes $q^i \\cdot (n-1)!_q$.\n  Summing $1 \\le i \\le n$ gives the result.\n\\end{proof}\nUnfortunately, the main difficulty of the problem\nis that there are repeated elements,\nwhich makes our notation much more horrific.\n\nLet us define the following.\nWe take our given multiset $M$ of $n$ positive integers,\nwe suppose the distinct numbers are\n$\\theta_1 < \\theta_2 < \\dots < \\theta_m$.\nWe let $e_i$ be the number of times $\\theta_i$ appears.\nTherefore the multiplicities $e_i$ should have sums\n\\[ e_1 + \\dots + e_m = n \\]\nand $m$ denotes the number of distinct elements.\nFinally, we let\n\\[ F(e_1, \\dots, e_m)\n  = \\sum_{\\text{permutations } \\sigma}\n  q^{\\text{number inversions of } \\sigma} \\]\nbe the associated generating function for the number of inversions.\nFor example, the first claim we proved says that $F(1, \\dots, 1) = n!_q$.\n\n\\begin{claim*}\n  We have the explicit formula\n  \\[ F(e_1, \\dots, e_m) = n!_q \\cdot \\prod_{i=1}^m \\frac{e_i!}{e_i!_q}. \\]\n\\end{claim*}\n\\begin{proof}\n  First suppose we perturb all the elements slightly,\n  so that they are no longer equal.\n  Then the generating function would just be $n!_q$.\n\n  Then, we undo the perturbations for each group,\n  one at a time, and claim that we get the above $e_i!_q$ factor each time.\n  Indeed, put the permutations into classes of $e_1!$ each\n  where permutations in the same classes differ\n  only in the order of the perturbed $\\theta_1$'s\n  (with the other $n-e_1$ elements being fixed).\n  Then there is a factor of $e_1!_q$ from each class,\n  owing to the slightly perturbed inversions we added within each class.\n  So we remove that factor and add $e_1! \\cdot q^0$ instead.\n  This accounts for the first term of the product.\n\n  Repeating this now with each term of the product implies the claim.\n\\end{proof}\n\nThus we have the formula for the number of inversions in general.\nWe wish to show this also equals the generating function\nthe number of $A$-inversions, for any fixed choice of $A$.\nThis will be an induction by $n$, with the base case being immediate.\n\nFor the inductive step, fix $A$,\nand assume the first element satisfies\n$\\theta_k \\le a_1 < \\theta_{k+1}$ (so $0 \\le k \\le m$;\nwe for convenience set $\\theta_0 = -\\infty$ and $\\theta_m = +\\infty$).\nWe count the permutations based on what the first element\n$\\theta_i$ of the permutation is.\nThen:\n\\begin{itemize}\n  \\ii Consider permutations starting with\n  $\\theta_i \\in \\left\\{ \\theta_1, \\dots, \\theta_k \\right\\}$.\n  Then the number of inversions which will\n  use this first term is $(e_1 + \\dots + e_{i-1})\n  + (e_{k+1} + \\dots + e_m)$.\n  Also, there are $e_i$ ways to pick which\n  $\\theta_i$ gets used as the first term.\n  So we get a contribution of\n  \\[ q^{e_1 + \\dots + e_{i-1} + (e_{k+1} + \\dots + e_m)}\n    \\cdot e_i \\cdot F(e_1, \\dots, e_i-1, \\dots, e_m) \\]\n  in this case\n  (with inductive hypothesis to get the last $F$-term).\n\n  \\ii Now suppose $\\theta_i \\in \\left\\{ \\theta_{k+1}, \\dots, \\theta_m \\right\\}$.\n  Then the number of inversions which will\n  use this first term is $e_{k+1} + \\dots + e_{i-1}$.\n  Thus by a similar argument the contribution is\n  \\[ q^{e_{k+1} + \\dots + e_{i-1}}\n    \\cdot e_i \\cdot F(e_1, \\dots, e_i-1, \\dots, e_m). \\]\n\\end{itemize}\nTherefore, to complete the problem it suffices to prove\n\\begin{align*}\n  &\\phantom+ \\sum_{i=1}^k q^{(e_1 + \\dots + e_{i-1}) + (e_{k+1} + \\dots + e_m)}\n    \\cdot e_i \\cdot F(e_1, \\dots, e_i-1, \\dots, e_m) \\\\\n  &+ \\sum_{i=k+1}^m q^{e_{k+1} + \\dots + e_{i-1}}\n    \\cdot e_i \\cdot F(e_1, \\dots, e_i-1, \\dots, e_m) \\\\\n  &= F(e_1, \\dots, e_m).\n\\end{align*}\nNow, we see that\n\\[ \\frac{e_i \\cdot F(e_1, \\dots, e_i-1, \\dots, e_m)}{F(e_1, \\dots, e_m)}\n  = \\frac{1+\\dots+q^{e_i-1}}{1+q+\\dots+q^{n-1}}\n  = \\frac{1-q^{e_i}}{1-q^n} \\]\nso it's equivalent to show\n\\[ 1-q^n\n  = q^{e_{k+1} + \\dots + e_m} \\sum_{i=1}^k q^{e_1 + \\dots + e_{i-1}}(1-q^{e_i})\n  + \\sum_{i=k+1}^m q^{e_{k+1} + \\dots + e_{i-1}} (1-q^{e_i})\n\\]\nwhich is clear,\nsince the left summand telescopes to\n$q^{e_{k+1}+\\dots+e_m} - q^n$\nand the right summand telescopes to\n$1 - q^{e_{k+1}+\\dots+e_m}$.\n\n\n\\begin{remark*}\n  Technically, we could have skipped straight to the induction,\n  without proving the first two claims.\n  However I think the solution reads more naturally this way.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "USAMO", "year": 2017}
{"id": "usamo-2017-q3", "question": "Let $ABC$ be a scalene triangle with circumcircle $\\Omega$ and incenter $I$.\nRay $AI$ meets $\\ol{BC}$ at $D$ and $\\Omega$ again at $M$;\nthe circle with diameter $\\ol{DM}$ cuts $\\Omega$ again at $K$.\nLines $MK$ and $BC$ meet at $S$, and $N$ is the midpoint of $\\ol{IS}$.\nThe circumcircles of $\\triangle KID$ and $\\triangle MAN$\nintersect at points $L_1$ and $L_2$.\nProve that $\\Omega$ passes through the midpoint of either $\\ol{IL_1}$ or $\\ol{IL_2}$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p8108375}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a scalene triangle with circumcircle $\\Omega$ and incenter $I$.\nRay $AI$ meets $\\ol{BC}$ at $D$ and $\\Omega$ again at $M$;\nthe circle with diameter $\\ol{DM}$ cuts $\\Omega$ again at $K$.\nLines $MK$ and $BC$ meet at $S$, and $N$ is the midpoint of $\\ol{IS}$.\nThe circumcircles of $\\triangle KID$ and $\\triangle MAN$\nintersect at points $L_1$ and $L_2$.\nProve that $\\Omega$ passes through the midpoint of either $\\ol{IL_1}$ or $\\ol{IL_2}$.\n\\end{mdframed}\nLet $W$ be the midpoint of $\\ol{BC}$,\nlet $X$ be the point on $\\Omega$ opposite $M$.\nObserve that $\\ol{KD}$ passes through $X$,\nand thus lines $BC$, $MK$, $XA$ concur at\nthe orthocenter of $\\triangle DMX$, which we call $S$.\nDenote by $I_A$ the $A$-excenter of $ABC$.\n\nNext, let $E$ be the foot of the altitude from $I$ to $\\ol{XI_A}$;\nobserve that $E$ lies on the circle centered at $M$\nthrough $I$, $B$, $C$, $I_A$.\nThen, $S$ is the radical center of $\\Omega$\nand the circles with diameter $\\ol{IX}$ and $\\ol{II_A}$;\nhence line $SI$ passes through $E$;\naccordingly $I$ is the orthocenter of $\\triangle XSI_A$;\ndenote by $L$ the foot from $X$ to $\\ol{SI_A}$.\n\n\\begin{center}\n\\begin{asy}\nsize(10cm);\npair A = dir(160);\npair B = dir(210);\npair C = dir(330);\npair I = incenter(A, B, C);\npair D = extension(A, I, B, C);\npair M = circumcenter(B, I, C);\npair I_A = 2*M-I;\npair X = -M;\npair K = foot(M, D, X);\npair S = extension(M, K, B, C);\npair N = midpoint(I--S);\n\npair W = midpoint(B--C);\npair E = foot(I, X, I_A);\n\ndraw(A--B--C--cycle, orange);\nfilldraw(unitcircle, opacity(0.1)+lightred, orange);\nfilldraw(CP(M, I), opacity(0.1)+yellow, olive);\ndraw(A--I_A, orange);\ndraw(M--X, orange);\ndraw(S--E, olive);\ndraw(X--I_A, olive);\ndraw(B--S, orange);\n\npair L = foot(X, I_A, S);\ndraw(M--S--X--cycle, heavyred+1);\ndraw(X--K, heavyred+1);\ndraw(A--M, heavyred+1);\ndraw(S--W, heavyred+1);\n\ndraw(S--I_A, orange);\n\ndraw(circumcircle(K, I, D), palered+1);\nfilldraw(circumcircle(M, A, N), opacity(0.1)+yellow, palered+1);\ndraw(X--L, orange+1);\n\npair T = midpoint(I--L);\ndraw(T--M, orange);\n\ndot(\"$A$\", A, dir(150));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(-10));\ndot(\"$I$\", I, dir(I));\ndot(\"$D$\", D, dir(D));\ndot(\"$M$\", M, dir(M));\ndot(\"$I_A$\", I_A, dir(I_A));\ndot(\"$X$\", X, dir(X));\ndot(\"$K$\", K, dir(K));\ndot(\"$S$\", S, dir(S));\ndot(\"$N$\", N, dir(135));\ndot(\"$W$\", W, dir(-45));\ndot(\"$E$\", E, dir(45));\ndot(\"$L$\", L, dir(L));\ndot(\"$T$\", T, dir(T));\n\n/* Source generated by TSQ:\n\n!size(10cm);\nA = dir 160 R150\nB = dir 210\nC = dir 330 R-10\nI = incenter A B C\nD = extension A I B C\nM = circumcenter B I C\nI_A = 2*M-I\nX = -M\nK = foot M D X\nS = extension M K B C\nN = midpoint I--S R135\n\nW = midpoint B--C R-45\nE = foot I X I_A R45\n\nA--B--C--cycle orange\nunitcircle 0.1 lightred / orange\nCP M I 0.1 yellow / olive\nA--I_A orange\nM--X orange\nS--E olive\nX--I_A olive\nB--S orange\n\nL = foot X I_A S\nM--S--X--cycle heavyred+1\nX--K heavyred+1\nA--M heavyred+1\nS--W heavyred+1\n\nS--I_A orange\n\ncircumcircle K I D palered+1\ncircumcircle M A N 0.1 yellow / palered+1\nX--L orange+1\n\nT = midpoint I--L\nT--M orange\n\n*/\n\\end{asy}\n\\end{center}\n\nWe claim that this $L$ lies on\nboth the circumcircle of $\\triangle KID$ and $\\triangle MAN$.\nIt lies on the circumcircle of $\\triangle MAN$\nsince this circle is the nine-point circle of $\\triangle XSI_A$.\nAlso, $XD \\cdot XK = XW \\cdot XM = XA \\cdot XS = XI \\cdot XL$,\nso $KDIL$ are concyclic.\n%For the other, note that $\\triangle MWI \\sim \\triangle MIX$,\n%according to which $\\angle IWM = \\angle MIX = 180^{\\circ} - \\angle LIM = 180^{\\circ} - \\angle MLI$,\n%enough to imply that quadrilateral $MWIL$ is cyclic.\n%But lines $IL$, $DK$, and $WM$ meet at $X$, implying the conclusion.\n\nAll that remains to show is that the\nmidpoint $T$ of $\\ol{IL}$ lies on $\\Omega$.\nBut this follows from the fact that\n$\\ol{TM} \\parallel \\ol{LI_A} \\implies \\angle MTX = 90^{\\circ}$,\nthus the problem is solved.\n\n\\begin{remark*}\n  Some additional facts about this picture:\n  the point $T$ is the contact point of the $A$-mixtilinear incircle\n  (since it is collinear with $X$ and $I$),\n  while the point $K$ is such that $\\ol{AK}$ is an $A$-symmedian\n  (since $\\ol{KD}$ and $\\ol{AD}$ bisect $\\angle A$ and $\\angle K$, say).\n\\end{remark*}\n\n\\begin{center}\n\\begin{asy}\npair I_A = dir(115);\npair I_B = dir(215);\npair I_C = dir(325);\npair A = foot(I_A, I_B, I_C);\npair B = foot(I_B, I_C, I_A);\npair C = foot(I_C, I_A, I_B);\npair X = midpoint(I_B--I_C);\npair S = extension(B, C, I_B, I_C);\npair I = incenter(A, B, C);\npair L = extension(X, I, S, I_A);\n\npair D = extension(A, I, B, C);\npair M = midpoint(I--I_A);\npair K = foot(M, D, X);\npair N = midpoint(I--S);\n\ndraw(I_A--I_B--I_C--cycle, heavycyan);\nfilldraw(circumcircle(I_A, I_B, I_C), opacity(0.1)+palered, heavycyan);\nfilldraw(circumcircle(A, B, C), opacity(0.1)+orange, orange);\ndraw(A--B--C--cycle, orange);\n\ndraw(S--I_A, orange);\ndraw(S--I, olive);\ndraw(S--I_B, heavycyan);\ndraw(A--I_A, heavycyan);\n\nfilldraw(circumcircle(K, I, D), opacity(0.07)+yellow, palered+1);\nfilldraw(circumcircle(M, A, N), opacity(0.07)+yellow, palered+1);\ndraw(X--L, orange+1);\n\npair T = midpoint(I--L);\ndraw(M--X, olive);\ndraw(K--X, olive);\ndraw(M--S, olive);\ndraw(X--I_A, heavycyan);\ndraw(S--C, orange);\n\nfilldraw(circumcircle(I, B, C), opacity(0.1)+palecyan, heavycyan);\n\ndot(\"$I_A$\", I_A, dir(I_A));\ndot(\"$I_B$\", I_B, dir(I_B));\ndot(\"$I_C$\", I_C, dir(I_C));\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$X$\", X, dir(X));\ndot(\"$S$\", S, dir(S));\ndot(\"$I$\", I, dir(I));\ndot(\"$L$\", L, dir(L));\ndot(\"$D$\", D, dir(D));\ndot(\"$M$\", M, dir(M));\ndot(\"$K$\", K, dir(K));\ndot(\"$N$\", N, dir(80));\ndot(\"$T$\", T, dir(T));\n\n/* TSQ Source:\n\nI_A = dir 115\nI_B = dir 215\nI_C = dir 325\nA = foot I_A I_B I_C\nB = foot I_B I_C I_A\nC = foot I_C I_A I_B\nX = midpoint I_B--I_C\nS = extension B C I_B I_C\nI = incenter A B C\nL = extension X I S I_A\n\nD = extension A I B C\nM = midpoint I--I_A\nK = foot M D X\nN = midpoint I--S R80\n\nI_A--I_B--I_C--cycle heavycyan\ncircumcircle I_A I_B I_C 0.1 palered / heavycyan\ncircumcircle A B C 0.1 orange / orange\nA--B--C--cycle orange\n\nS--I_A orange\nS--I olive\nS--I_B heavycyan\nA--I_A heavycyan\n\ncircumcircle K I D 0.07 yellow / palered+1\ncircumcircle M A N 0.07 yellow / palered+1\nX--L orange+1\n\nT = midpoint I--L\nM--X olive\nK--X olive\nM--S olive\nX--I_A heavycyan\nS--C orange\n\ncircumcircle I B C 0.1 palecyan / heavycyan\n\n*/\n\\end{asy}\n\\end{center}\n\n\\begin{remark*}\n  In fact, the point $L$ is the Miquel point of cyclic quadrilateral\n  $I_B I_C B C$ (inscribed in the circle with diameter $\\ol{I_B I_C}$).\n  This implies many of the properties that $L$ has above.\n  For example, it directly implies that $L$ lies on the circumcircles\n  of triangles $I_A I_B I_C$ and $BCI_A$,\n  and that the point $L$ lies on $\\ol{SI_A}$\n  (since $S = \\ol{BC} \\cap \\ol{I_B I_C}$).\n  For this reason, many students found it easier to think about\n  the problem in terms of $\\triangle I_A I_B I_C$ rather than $\\triangle ABC$.\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Geometry", "source": "USAMO", "year": 2017}
{"id": "usamo-2017-q4", "question": "Let $P_1$, $P_2$, \\dots, $P_{2n}$ be $2n$ distinct points on the\nunit circle $x^2+y^2=1$, other than $(1,0)$.\nEach point is colored either red or blue,\nwith exactly $n$ red points and $n$ blue points.\nLet $R_1$, $R_2$, \\dots, $R_n$ be any ordering of the red points.\nLet $B_1$ be the nearest blue point to $R_1$ traveling\ncounterclockwise around the circle starting from $R_1$.\nThen let $B_2$ be the nearest of the remaining blue points to $R_2$\ntraveling counterclockwise around the circle from $R_2$, and so on,\nuntil we have labeled all of the blue points $B_1$, \\dots, $B_n$.\nShow that the number of counterclockwise arcs of the form $R_i \\to B_i$\nthat contain the point $(1,0)$ is independent of the way we chose the\nordering $R_1$, \\dots, $R_n$ of the red points.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p8117190}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $P_1$, $P_2$, \\dots, $P_{2n}$ be $2n$ distinct points on the\nunit circle $x^2+y^2=1$, other than $(1,0)$.\nEach point is colored either red or blue,\nwith exactly $n$ red points and $n$ blue points.\nLet $R_1$, $R_2$, \\dots, $R_n$ be any ordering of the red points.\nLet $B_1$ be the nearest blue point to $R_1$ traveling\ncounterclockwise around the circle starting from $R_1$.\nThen let $B_2$ be the nearest of the remaining blue points to $R_2$\ntraveling counterclockwise around the circle from $R_2$, and so on,\nuntil we have labeled all of the blue points $B_1$, \\dots, $B_n$.\nShow that the number of counterclockwise arcs of the form $R_i \\to B_i$\nthat contain the point $(1,0)$ is independent of the way we chose the\nordering $R_1$, \\dots, $R_n$ of the red points.\n\\end{mdframed}\nWe present two solutions, one based on\nswapping and one based on an invariant.\n\n\\paragraph{First ``local'' solution by swapping two points.}\nLet $1 \\le i < n$ be any index and consider the two red points\n$R_i$ and $R_{i+1}$.\nThere are two blue points $B_i$ and $B_{i+1}$ associated with them.\n\n\\begin{claim*}\n  If we swap the locations of points $R_i$ and $R_{i+1}$ then\n  the new arcs $R_i \\to B_i$ and $R_{i+1} \\to B_{i+1}$\n  will cover the same points.\n\\end{claim*}\n\\begin{proof}\n  Delete all the points $R_1$, \\dots, $R_{i-1}$\n  and $B_1$, \\dots, $B_{i-1}$;\n  instead focus on the positions of $R_i$ and $R_{i+1}$.\n\n  The two blue points can then be located in three possible ways:\n  either $0$, $1$, or $2$ of them lie on the arc $R_i \\to R_{i+1}$.\n  For each of the cases below, we illustrate on the left\n  the locations of $B_i$ and $B_{i+1}$\n  and the corresponding arcs in green;\n  then on the right we show the modified picture\n  where $R_i$ and $R_{i+1}$ have swapped.\n  (Note that by hypothesis there are no other blue points in the green arcs).\n  \\begin{center}\n  \\begin{asy}\n    unitsize(1cm);\n    pair O = (0,0);\n    picture init(bool flip) {\n      picture pic;\n      draw(pic, unitcircle);\n      if (flip) {\n        dot(pic, \"$R_{i}$\", dir(0), dir(0), red);\n        dot(pic, \"$R_{i+1}$\", dir(180), dir(180), red);\n      }\n      else {\n        dot(pic, \"$R_{i+1}$\", dir(0), dir(0), red);\n        dot(pic, \"$R_{i}$\", dir(180), dir(180), red);\n      }\n      return pic;\n    }\n\n    picture L1 = init(true);\n    picture L2 = init(true);\n    picture L3 = init(true);\n    picture R1 = init(false);\n    picture R2 = init(false);\n    picture R3 = init(false);\n\n    real r = 0.8;\n    real s = 0.9;\n\n    // Case 1\n    dot(L1, \"$B_i$\", dir(60), dir(60), blue);\n    dot(L1, \"$B_{i+1}$\", dir(120), dir(120), blue);\n    dot(R1, \"$B_i$\", dir(60), dir(60), blue);\n    dot(R1, \"$B_{i+1}$\", dir(120), dir(120), blue);\n    draw(L1, arc(O, r,   0,  60), deepgreen, EndArrow(TeXHead));\n    draw(L1, arc(O, s, 180, 480), deepgreen, EndArrow(TeXHead));\n    draw(R1, arc(O, r, 180, 420), deepgreen, EndArrow(TeXHead));\n    draw(R1, arc(O, s,   0, 120), deepgreen, EndArrow(TeXHead));\n    dot(L1, dir(140), blue);\n    dot(L1, dir(150), blue);\n    dot(R1, dir(140), blue);\n    dot(R1, dir(150), blue);\n\n    // Case 2\n    dot(L2, \"$B_i$\", dir(90), dir(90), blue);\n    dot(L2, \"$B_{i+1}$\", dir(270), dir(270), blue);\n    dot(R2, \"$B_i$\", dir(270), dir(270), blue);\n    dot(R2, \"$B_{i+1}$\", dir(90), dir(90), blue);\n    draw(L2, arc(O, s,   0,  90), deepgreen, EndArrow(TeXHead));\n    draw(L2, arc(O, s, 180, 270), deepgreen, EndArrow(TeXHead));\n    draw(R2, arc(O, s, 180, 270), deepgreen, EndArrow(TeXHead));\n    draw(R2, arc(O, s,   0,  90), deepgreen, EndArrow(TeXHead));\n    dot(L2, dir(128), blue);\n    dot(L2, dir(155), blue);\n    dot(R2, dir(128), blue);\n    dot(R2, dir(155), blue);\n    dot(L2, dir(297), blue);\n    dot(L2, dir(335), blue);\n    dot(R2, dir(297), blue);\n    dot(R2, dir(335), blue);\n\n    // Case 3\n    dot(L3, \"$B_i$\", dir(240), dir(240), blue);\n    dot(L3, \"$B_{i+1}$\", dir(300), dir(300), blue);\n    dot(R3, \"$B_i$\", dir(240), dir(240), blue);\n    dot(R3, \"$B_{i+1}$\", dir(300), dir(300), blue);\n    draw(L3, arc(O, r,   0, 240), deepgreen, EndArrow(TeXHead));\n    draw(L3, arc(O, s, 180, 300), deepgreen, EndArrow(TeXHead));\n    draw(R3, arc(O, r, 180, 240), deepgreen, EndArrow(TeXHead));\n    draw(R3, arc(O, s,   0, 300), deepgreen, EndArrow(TeXHead));\n    dot(L3, dir(328), blue);\n    dot(L3, dir(342), blue);\n    dot(R3, dir(328), blue);\n    dot(R3, dir(342), blue);\n\n\n    real t = 3.5;\n    add(shift(0,0)*L1);\n    add(shift(t,0)*R1);\n    add(shift(0,-t)*L2);\n    add(shift(t,-t)*R2);\n    add(shift(0,-2*t)*L3);\n    add(shift(t,-2*t)*R3);\n\n    label(\"Case 1\", (-2.5,0));\n    label(\"Case 2\", (-2.5,-t));\n    label(\"Case 3\", (-2.5,-2*t));\n  \\end{asy}\n  \\end{center}\n  Observe that in all cases, the number of arcs covering\n  any given point on the circumference is not changed.\n  Consequently, this proves the claim.\n\\end{proof}\n\nFinally, it is enough to recall that any permutation\nof the red points can be achieved by swapping consecutive points\n(put another way: $(i \\; i+1)$ generates the permutation group $S_n$).\nThis solves the problem.\n\n\\begin{remark*}\n  This proof does \\emph{not} work if one tries to swap\n  $R_i$ and $R_j$ if $|i-j| \\neq 1$.\n  For example if we swapped $R_i$ and $R_{i+2}$\n  then there are some issues caused by the\n  possible presence of the blue point $B_{i+1}$\n  in the green arc $R_{i+2} \\to B_{i+2}$.\n\\end{remark*}\n\n\\paragraph{Second longer solution using an invariant.}\nVisually, if we draw all the segments $R_i \\to B_i$\nthen we obtain a set of $n$ chords.\nSay a chord is \\emph{inverted} if satisfies the problem condition,\nand \\emph{stable} otherwise.\nThe problem contends that the number of stable/inverted chords\ndepends only on the layout of the points\nand not on the choice of chords.\n\n\\begin{center}\n\\begin{asy}\nsize(6cm);\npair A(int i) { return dir(22.5+45*i); }\n\ndraw(unitcircle, gray);\ndot(\"$(1,0)$\", dir(0), dir(0));\n\ndotfactor *= 2;\ndraw(A(7)--A(0), EndArrow, Margins);\ndraw(A(1)--A(2), EndArrow, Margins);\ndraw(A(3)--A(5), EndArrow, Margins);\ndraw(A(4)--A(6), EndArrow, Margins);\n\ndot(\"$-1$\", A(0), A(0), blue);\ndot(\"$0$\", A(1), A(1), red);\ndot(\"$-1$\", A(2), A(2), blue);\ndot(\"$0$\", A(3), A(3), red);\ndot(\"$+1$\", A(4), A(4), red);\ndot(\"$0$\", A(5), A(5), blue);\ndot(\"$-1$\", A(6), A(6), blue);\ndot(\"$0$\", A(7), A(7), red);\n\\end{asy}\n\\end{center}\n\nIn fact we'll describe the number of inverted chords explicitly.\nStarting from $(1,0)$ we keep a running tally of $R-B$;\nin other words we start the counter at $0$ and decrement by $1$ at each\nblue point and increment by $1$ at each red point.\nLet $x \\le 0$ be the lowest number ever recorded. Then:\n\\begin{claim*}\n  The number of inverted chords is $-x$\n  (and hence independent of the choice of chords).\n\\end{claim*}\n\nThis is by induction on $n$.\nI think the easiest thing is to delete chord $R_1 B_1$;\nnote that the arc cut out by this chord contains no blue points.\nSo if the chord was stable certainly no change to $x$.\nOn the other hand, if the chord is inverted,\nthen in particular the last point before $(1,0)$ was red,\nand so $x < 0$.  In this situation one sees that deleting the chord\nchanges $x$ to $x+1$, as desired.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2017}
{"id": "usamo-2017-q5", "question": "Find all real numbers $c > 0$ such that there exists a labeling\nof the lattice points in $\\ZZ^2$ with positive integers for which:\n\\begin{itemize}\n  \\ii only finitely many distinct labels occur, and\n  \\ii for each label $i$, the distance between any two points\n  labeled $i$ is at least $c^i$.\n\\end{itemize}", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p8117096}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all real numbers $c > 0$ such that there exists a labeling\nof the lattice points in $\\ZZ^2$ with positive integers for which:\n\\begin{itemize}\n  \\ii only finitely many distinct labels occur, and\n  \\ii for each label $i$, the distance between any two points\n  labeled $i$ is at least $c^i$.\n\\end{itemize}\n\\end{mdframed}\nThe answer is $c < \\sqrt2$. Here is a solution with Calvin Deng.\n\nThe construction for any $c < \\sqrt 2$ can be done as follows.\nCheckerboard color the lattice points and label the black ones with $1$.\nThe white points then form a copy of $\\ZZ^2$ again\nscaled up by $\\sqrt 2$ so we can repeat the procedure with $2$\non half the resulting points.\nContinue this dyadic construction until a large $N$\nfor which $c^N < 2^{\\half (N-1)}$,\nat which point we can just label all the points with $N$.\n\nI'll now prove that $c = \\sqrt 2$ (and hence $c \\ge \\sqrt 2$) can't be done.\n\\begin{claim*}\n  It is impossible to fill a $2^n \\times 2^n$ square\n  with labels not exceeding $2n$.\n\\end{claim*}\nThe case $n = 1$ is clear.\nSo now assume it's true up to $n-1$;\nand assume for contradiction a $2^n \\times 2^n$ square\n$S$ only contains labels up to $2n$.\n(Of course every $2^{n-1} \\times 2^{n-1}$ square\ncontains an instance of a label at least $2n-1$.)\n\n\\begin{center}\n\\begin{asy}\nunitsize(0.75cm);\n\nfor (int i=0; i<=8; ++i) {\n  if ((i!=0) && (i!=4) && (i!=8)) {\n    draw( (0,i)--(8,i), gray );\n    draw( (i,0)--(i,8), gray );\n  }\n  else {\n    draw( (0,i)--(8,i), black+1 );\n    draw( (i,0)--(i,8), black+1 );\n  }\n}\n\n\nfilldraw( box((2.1,4.1),(5.9,7.9)), opacity(0.2)+palered, red+1 );\nfilldraw( box((1.1,2.1),(4.9,5.9)), opacity(0.2)+lightgreen, blue+1 );\nfill(box((0,4),(4,8)), opacity(0.1)+lightcyan);\nlabel(\"$A$\", (3.5,8), dir(90), red);\nlabel(\"$B$\", (2.5,2), dir(-90), blue);\n\nlabel(\"$2$\", (0.5,7.5));\nlabel(\"$1$\", (1.5,7.5));\nlabel(\"$2$\", (2.5,7.5));\nlabel(\"$1$\", (3.5,7.5));\nlabel(\"$1$\", (0.5,6.5));\nlabel(\"$5$\", (1.5,6.5), red);\nlabel(\"$1$\", (2.5,6.5));\nlabel(\"$3$\", (3.5,6.5));\nlabel(\"$2$\", (0.5,5.5));\nlabel(\"$1$\", (1.5,5.5));\nlabel(\"$2$\", (2.5,5.5));\nlabel(\"$1$\", (3.5,5.5));\nlabel(\"$1$\", (0.5,4.5));\nlabel(\"$3$\", (1.5,4.5));\nlabel(\"$1$\", (2.5,4.5));\nlabel(\"$4$\", (3.5,4.5));\nlabel(\"$6$\", (5.5,6.5), blue);\n\\end{asy}\n\\end{center}\n\nNow, we contend there are fewer than four copies of $2n$:\n\\begin{lemma*}\n  In a unit square, among any four points,\n  two of these points have distance $\\le 1$ apart.\n\\end{lemma*}\n\\begin{proof}\n  Look at the four rays emanating from the origin and note\n  that two of them have included angle $\\le 90\\dg$.\n\\end{proof}\n\nSo WLOG the northwest quadrant has no $2n$'s.\nTake a $2n-1$ in the northwest and draw a square of size $2^{n-1} \\times 2^{n-1}$\ndirectly right of it (with its top edge coinciding with the top of $S$).\nThen $A$ can't contain $2n-1$, so it must contain a $2n$ label;\nthat $2n$ label must be in the northeast quadrant.\n\nThen we define a square $B$ of size $2^{n-1} \\times 2^{n-1}$ as follows.\nIf $2n-1$ is at least as high $2n$, let $B$ be a $2^{n-1} \\times 2^{n-1}$\nsquare which touches $2n-1$ north and is bounded east by $2n$.\nOtherwise let $B$ be the square that touches $2n-1$ west\nand is bounded north by $2n$.\nWe then observe $B$ can neither have $2n-1$ nor $2n$ in it, contradiction.\n\n\\begin{remark*}\n  To my knowledge, essentially all density arguments fail\n  because of hexagonal lattice packing.\n\\end{remark*}\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2017}
{"id": "usamo-2017-q6", "question": "Find the minimum possible value of\n\\[ \\frac{a}{b^3+4} + \\frac{b}{c^3+4} + \\frac{c}{d^3+4} + \\frac{d}{a^3+4} \\]\ngiven that $a$, $b$, $c$, $d$ are nonnegative real numbers\nsuch that $a+b+c+d=4$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p8117097}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind the minimum possible value of\n\\[ \\frac{a}{b^3+4} + \\frac{b}{c^3+4} + \\frac{c}{d^3+4} + \\frac{d}{a^3+4} \\]\ngiven that $a$, $b$, $c$, $d$ are nonnegative real numbers\nsuch that $a+b+c+d=4$.\n\\end{mdframed}\nThe minimum $\\frac23$ is achieved\nat $(a,b,c,d) = (2,2,0,0)$ and cyclic permutations.\n\nThe problem is an application of the tangent line trick:\nwe observe the miraculous identity\n\\[ \\frac{1}{b^3+4} \\ge \\frac14 - \\frac{b}{12} \\]\nsince $12-(3-b)(b^3+4) = b(b+1)(b-2)^2 \\ge 0$.\nMoreover,\n\\[ ab+bc+cd+da = (a+c)(b+d)\n  \\le \\left( \\frac{(a+c)+(b+d)}{2} \\right)^2 = 4.  \\]\nThus\n\\[ \\sum_{\\text{cyc}} \\frac{a}{b^3+4}\n  \\ge \\frac{a+b+c+d}{4} - \\frac{ab+bc+cd+da}{12}\n  \\ge 1 - \\frac13 = \\frac23. \\]\n\n\\begin{remark*}\n  The main interesting bit is the equality at $(a,b,c,d) = (2,2,0,0)$.\n  This is the main motivation for trying tangent line trick,\n  since a lower bound of the form $\\sum a(1-\\lambda b)$\n  preserves the unusual equality case above.\n  Thus one takes the tangent at $b=2$ which miraculously\n  passes through the point $(0,1/4)$ as well.\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Algebra", "source": "USAMO", "year": 2017}
{"id": "putnam-2018-a1", "question": "Find all ordered pairs $(a,b)$ of positive integers for which\n\\[\n\\frac{1}{a} + \\frac{1}{b} = \\frac{3}{2018}.\n\\]", "solution": "By clearing denominators and regrouping, we see that the given equation is equivalent to \n\\[\n(3a-2018)(3b-2018) = 2018^2.\n\\]\nEach of the factors is congruent to $1 \\pmod 3$. There are $6$ positive factors of $2018^2 = 2^2 \\cdot 1009^2$ that are congruent to $1 \\pmod 3$: $1$, $2^2$, $1009$, $2^2 \\cdot 1009$, $1009^2$, $2^2 \\cdot 1009^2$. These lead to the $6$ possible pairs: $(a,b) = (673,1358114)$, $(674,340033)$, $(1009,2018)$, $(2018,1009)$, $(340033,674)$, and $(1358114,673)$.\n\nAs for negative factors, the ones that are congruent to $1 \\pmod 3$ are $-2, -2 \\cdot 1009, -2 \\cdot 1009^2$.\nHowever, all of these lead to pairs where $a \\leq 0$ or $b \\leq 0$.", "category": "Number Theory", "source": "PUTNAM", "year": 2018}
{"id": "putnam-2018-a2", "question": "Let $S_1, S_2, \\dots, S_{2^n-1}$ be the nonempty subsets of $\\{1,2,\\dots,n\\}$ in some order, and let\n$M$ be the $(2^n-1) \\times (2^n-1)$ matrix whose $(i,j)$ entry is\n\\[\nm_{ij} = \\begin{cases} 0 & \\mbox{if }S_i \\cap S_j = \\emptyset; \\\\\n1 & \\mbox{otherwise.}\n\\end{cases}\n\\]\nCalculate the determinant of $M$.", "solution": "The answer is $1$ if $n=1$ and $-1$ if $n>1$. Write $M_n$ for a $(2^n-1) \\times (2^n-1)$ matrix of the given form, and note that $\\det M_n$ does not depend on the ordering of the subsets: transposing two subsets has the effect of transposing two rows and then transposing two columns in $M_n$, and this does not change the determinant.\n\nClearly $\\det M_1 = 1$. We claim that for $n>1$, $\\det M_n = -(\\det M_{n-1})^2$, and the desired answer will follow by induction. Let $S_1',\\ldots,S_{2^{n-1}-1}'$ denote the nonempty subsets of $\\{1,\\ldots,n-1\\}$ in any order, with resulting matrix $M_{n-1}$. Let $m_{ij}'$ denote the $(i,j)$ entry of $M_{n-1}$. Now order the nonempty subsets $S_1,\\ldots,S_{2^n-1}$ of $\\{1,\\ldots,n\\}$ as follows: \n\\[\nS_i= \\begin{cases} S_i' &  i \\leq 2^{n-1}-1 \\\\\nS_{i-2^{n-1}+1}' \\cup \\{n\\} & 2^{n-1} \\leq i \\leq 2^n-2 \\\\\n\\{n\\} & i=2^{n}-1.\n\\end{cases}\n\\]\n(For example, if $S_1', \\dots, S_{2^{n-1}-1}'$ are ordered in lexicographic order\nas binary strings, then so are $S_1,\\dots,S_{2^n-1}$.)\nLet $M_n$ be the resulting matrix. Then we have:\n\\[\nM_n = \\left( \\begin{array}{ccc|ccc|c}\n&&&&&& 0 \\\\\n& M_{n-1} &&& M_{n-1} && \\vdots \\\\\n&&&&&& 0 \\\\ \\hline\n&&&1 & \\cdots & 1 & 1 \\\\\n& M_{n-1} && \\vdots & \\ddots & \\vdots & \\vdots \\\\\n&&&1 &\\cdots & 1 & 1 \\\\ \\hline\n0 & \\cdots & 0 & 1 & \\cdots & 1 & 1\n\\end{array} \\right).\n\\]\n\nIn $M_n$, perform the following operations, which do not change the determinant: subtract the final row from rows $2^{n-1}$ through $2^n-2$, and then subtract the final column from columns $2^{n-1}$ through $2^n-2$. The result is the matrix\n\\[\n\\left( \\begin{array}{ccc|ccc|c}\n&&&&&& 0 \\\\\n& M_{n-1} &&& M_{n-1} && \\vdots \\\\\n&&&&&& 0 \\\\ \\hline\n&&&0 & \\cdots & 0 & 0 \\\\\n& M_{n-1} && \\vdots & \\ddots & \\vdots & \\vdots \\\\\n&&&0 &\\cdots & 0 & 0 \\\\ \\hline\n0 & \\cdots & 0 & 0 & \\cdots & 0 & 1\n\\end{array} \\right).\n\\]\n\nWe can remove the final row and column without changing the determinant. Now swap the first $2^{n-1}-1$ rows with the final $2^{n-1}-1$ rows: this changes the determinant by an overall factor of $(-1)^{(2^{n-1}-1)^2} = -1$. The result is the block-diagonal matrix $\\left( \\begin{matrix} M_{n-1} & 0 \\\\ M_{n-1} & M_{n-1} \\end{matrix} \\right)$, whose determinant is $(\\det M_{n-1})^2$. Thus $\\det M_n = -(\\det M_{n-1})^2$ as desired.", "category": "Algebra", "source": "PUTNAM", "year": 2018}
{"id": "putnam-2018-a3", "question": "Determine the greatest possible value of $\\sum_{i=1}^{10} \\cos(3x_i)$ for real numbers $x_1,x_2,\\dots,x_{10}$\nsatisfying $\\sum_{i=1}^{10} \\cos(x_i) = 0$.", "solution": "The maximum value is $480/49$.\nSince $\\cos(3x_i) = 4 \\cos(x_i)^3 - 3 \\cos(x_i)$, it is equivalent to maximize $4 \\sum_{i=1}^{10} y_i^3$\nfor $y_1,\\dots,y_{10} \\in [-1,1]$ with $\\sum_{i=1}^{10} y_i = 0$; \nnote that this domain is compact, so the maximum value is guaranteed to exist.\nFor convenience, we establish something slightly stronger: we maximize $4 \\sum_{i=1}^{n} y_i^3$\nfor $y_1,\\dots,y_{n} \\in [-1,1]$ with $\\sum_{i=1}^{n} y_i = 0$, where $n$ may be any even nonnegative integer up to $10$,\nand show that the maximum is achieved when $n=10$.\n\nWe first study the effect of varying $y_i$ and $y_j$ while fixing their sum. If that sum is $s$,\nthen the function $y \\mapsto y^3 + (s-y)^3$ has constant second derivative $6s$, so it is either everywhere convex or everywhere concave. Consequently, if $(y_1,\\dots,y_{n})$ achieves the maximum, then for any two indices $i<j$,\nat least one of the following must be true:\n\\begin{itemize}", "category": "Algebra", "source": "PUTNAM", "year": 2018}
{"id": "putnam-2018-a4", "question": "Let $m$ and $n$ be positive integers with $\\gcd(m,n) = 1$, and let\n\\[\na_k = \\left\\lfloor \\frac{mk}{n} \\right\\rfloor - \\left\\lfloor \\frac{m(k-1)}{n} \\right\\rfloor\n\\]\nfor $k=1,2,\\dots,n$.\nSuppose that $g$ and $h$ are elements in a group $G$ and that \n\\[\ngh^{a_1} gh^{a_2} \\cdots gh^{a_n} = e,\n\\]\nwhere $e$ is the identity element. Show that $gh= hg$. (As usual, $\\lfloor x \\rfloor$ denotes the greatest integer\nless than or equal to $x$.)", "solution": "\\noindent\n\\textbf{First solution.}\nWe prove the claim by induction on $m+n$.\nFor the base case, suppose that $n=1$; we then have $m=1$ and the given equation becomes $gh=e$. The claim then reduces to the fact that a one-sided inverse in $G$ is also a two-sided inverse. (Because $G$ is a group, $g$ has an inverse $g^{-1}$; since $gh = e$, we have $h = g^{-1}(gh) = g^{-1} e = g^{-1}$, so $hg = e = gh$.)\n\nSuppose now that $n>1$. In case $m>n$, set $\\tilde{g} = g h$, $\\tilde{h} = h$, and\n\\[\nb_k = \\left\\lfloor \\frac{(m-n)k}{n} \\right\\rfloor - \\left\\lfloor \\frac{(m-n)(k-1)}{n} \\right\\rfloor \n\\quad (k=1,\\dots,n).\n\\]\nthen\n\\[\n\\tilde{g} \\tilde{h}^{b_1} \\cdots \\tilde{g} \\tilde{h}^{b_n} = gh^{a_1} \\cdots gh^{a_n} = e,\n\\]\nso the induction hypothesis implies that $\\tilde{g}$ and $\\tilde{h}$ commute; this implies that $g$ and $h$ commute.\n\nIn case $m < n$, note that $a_k \\in \\{0,1\\}$ for all $k$. Set $\\tilde{g} = h^{-1}$, $\\tilde{h} = g^{-1}$, and\n\\[\nb_l = \\left\\lfloor \\frac{n \\ell}{m} \\right\\rfloor - \\left\\lfloor \\frac{n(\\ell-1)}{m} \\right\\rfloor \n\\quad (\\ell=1,\\dots,m);\n\\]\nwe claim that \n\\[\n\\tilde{g}\\tilde{h}^{b_1}\\cdots\\tilde{g}\\tilde{h}^{b_m} = (gh^{a_1}\\cdots gh^{a_n})^{-1} = e,\n\\]\nso the induction hypothesis implies that $\\tilde{h}$ and $\\tilde{g}$ commute; this implies that $g$ and $h$ commute.\n\nTo clarify this last equality, consider a lattice walk starting from $(0,0)$, ending at $(n,m)$, staying below the line\n$y = mx/n$, and keeping as close to this line as possible. If one follows this walk and records the element $g$ for each horizontal step and $h$ for each vertical step, one obtains the word $gh^{a_1}\\cdots gh^{a_n}$. \nNow take this walk, reflect across the line $y = x$, rotate by a half-turn, then translate to put the endpoints at $(0,0)$ and $(m,n)$; this is the analogous walk for the pair $(n,m)$.\n\n\\noindent\n\\textbf{Remark.}\nBy tracing more carefully through the argument, one sees in addition that there exists an element $k$ of $G$\nfor which $g = k^m, h = k^{-n}$.\n\n\\noindent\n\\textbf{Second solution.} (by Greg Martin)\nSince $\\gcd(m,n) = 1$, there exist integers $x,y$ such that $mx + ny = 1$; we may further assume that \n$x \\in \\{1,\\dots,n\\}$. We first establish the identity\n\\[\na_{k-x} = \\begin{cases}\na_k - 1 & \\mbox{if $k \\equiv 0 \\pmod{n}$} \\\\\na_k + 1 & \\mbox{if $k \\equiv 1 \\pmod{n}$} \\\\\na_k & \\mbox{otherwise}.\n\\end{cases}\n\\]\nNamely, by writing $-mx = ny-1$, we see that\n\\begin{align*}\na_{k-x} &= \\left\\lfloor \\frac{m(k-x)}{n} \\right\\rfloor - \\left\\lfloor \\frac{m(k-x-1)}{n} \\right\\rfloor\n\\\\\n&= \\left\\lfloor \\frac{mk+ny-1}{n} \\right\\rfloor - \\left\\lfloor \\frac{m(k-1)+ny-1}{n} \\right\\rfloor \\\\\n&= \\left\\lfloor \\frac{mk-1}{n} \\right\\rfloor - \\left\\lfloor \\frac{m(k-1)-1}{n} \\right\\rfloor\n\\end{align*}\nand so\n\\begin{align*}\na_{k-x} - a_k &= \\left( \\left\\lfloor \\frac{mk-1}{n} \\right\\rfloor - \\left\\lfloor \\frac{mk}{n} \\right\\rfloor \\right)\n\\\\\n&\\quad\n- \\left( \\left\\lfloor \\frac{m(k-1)-1}{n} \\right\\rfloor - \\left\\lfloor \\frac{m(k-1)}{n} \\right\\rfloor \\right).\n\\end{align*}\nThe first parenthesized expression equals 1 if $n$ divides $mk$, or equivalently $n$ divides $k$, and 0 otherwise.\nSimilarly, the second parenthesized expression equals 1 if $n$ divides $k-1$ and 0 otherwise. This proves the stated identity.\n\nWe now use the given relation $g h^{a_1} \\cdots g h^{a_n} = e$ to write\n\\begin{align*}\nghg^{-1}h^{-1} &= gh(h^{a_1} g h^{a_2} \\cdots gh^{a_{n-1}} g h^{a_n})h^{-1} \\\\\n&= gh^{a_1+1} gh^{a_2} \\cdots gh^{a_{n-1}} gh^{a_n-1} \\\\\n&= gh^{a_{1-x}} \\cdots gh^{a_{n-x}} \\\\\n&= (gh^{a_{n+1-x}} \\cdots gh^{a_{n}}) (gh^{a_1} \\cdots gh^{a_{n-x}}).\n\\end{align*}\nThe two parenthesized expressions multiply in the opposite order to $g h^{a_1} \\cdots g h^{a_n} = e$, so they must be\n(two-sided) inverses of each other. We deduce that $ghg^{-1} h^{-1} = e$, meaning that $g$ and $h$ commute.\n\n\\noindent\n\\textbf{Third solution.} (by Sucharit Sarkar)\nLet $T$ denote the torus $\\mathbb{R}^2/\\mathbb{Z}^2$. The line segments from $(0,0)$ to $(1,0)$ and from $(0,0)$ to $(0,1)$ are closed loops in $T$, and we denote them by $g$ and $h$ respectively. Now let $p$ be the (image of the) point $(\\epsilon,-\\epsilon)$ in $T$ for some $0<\\epsilon\\ll 1$. The punctured torus $T \\setminus \\{p\\}$ deformation retracts onto the union of the loops $g$ and $h$, and so $\\pi_1(T\\setminus\\{p\\})$, the fundamental group of $T\\setminus\\{p\\}$ based at $(0,0)$, is the free group on two generators, $\\langle g,h\\rangle$.\n\nLet $\\gamma$ and $\\tilde{\\gamma}$ denote the following loops based at $(0,0)$ in $T$: $\\gamma$ is the image of the line segment from $(0,0)$ to $(n,m)$ under the projection $\\mathbb{R}^2 \\to T$, and $\\tilde{\\gamma}$ is the image of the lattice walk from $(0,0)$ to $(n,m)$, staying just below the line $y=mx/n$, that was described in the first solution. There is a straight-line homotopy with fixed endpoints between the two paths in $\\mathbb{R}^2$ from $(0,0)$ to $(n,m)$, the line segment and the lattice walk, and this homotopy does not pass through any point of the form $(a+\\epsilon,b-\\epsilon)$ for $a,b\\in\\mathbb{Z}$ by the construction of the lattice walk. It follows that $\\gamma$ and $\\tilde{\\gamma}$ are homotopic loops in $T \\setminus \\{p\\}$. Since the class of $\\tilde{\\gamma}$ in $\\pi_1(T\\setminus\\{p\\})$ is evidently $gh^{a_1}gh^{a_2}\\cdots gh^{a_n}$, it follows that the class of $\\gamma$ in $\\pi_1(T\\setminus\\{p\\})$ is the same.\n\nNow since $\\gcd(m,n)=1$, there is an element $\\phi \\in GL_2(\\mathbb{Z})$ sending $(n,m)$ to $(1,0)$, which then sends the line segment from $(0,0)$ to $(n,m)$ to the segment from $(0,0)$ to $(1,0)$. Then $\\phi$ induces a homeomorphism of $T$ sending $\\gamma$ to $g$, which in turn induces an isomorphism $\\phi_* :\\thinspace \\pi_1(T\\setminus \\{p\\}) \\to \\pi_1(T\\setminus \\{\\phi^{-1}(p)\\})$. Both fundamental groups are equal to $\\langle g,h\\rangle$, and we conclude that $\\phi_*$ sends $gh^{a_1}gh^{a_2}\\cdots gh^{a_n}$ to $g$. It follows that $\\phi_*$ induces an isomorphism\n\\[\n\\langle g,h\\,|\\,gh^{a_1}gh^{a_2}\\cdots gh^{a_n} \\rangle \\to \\langle g,h \\,|\\, g\\rangle \\cong \\langle h\\rangle \\cong \\mathbb{Z}.\n\\]\n\nSince $\\mathbb{Z}$ is abelian, $g$ and $h$ must commute in $\\langle g,h\\,|\\,gh^{a_1}gh^{a_2}\\cdots gh^{a_n}\\rangle$, whence they must also commute in $G$.", "category": "Algebra", "source": "PUTNAM", "year": 2018}
{"id": "putnam-2018-a5", "question": "Let $f: \\mathbb{R} \\to \\mathbb{R}$ be an infinitely differentiable function satisfying $f(0) = 0$, $f(1)= 1$,\nand $f(x) \\geq 0$ for all $x \\in \\mathbb{R}$. Show that there exist a positive integer $n$ and a real number $x$\nsuch that $f^{(n)}(x) < 0$.", "solution": "\\textbf{First solution.}\nCall a function $f\\colon \\mathbb{R} \\to \\mathbb{R}$ \\textit{ultraconvex} if $f$ is infinitely differentiable and $f^{(n)}(x) \\geq 0$ for all $n \\geq 0$ and all $x \\in \\mathbb{R}$, where $f^{(0)}(x) = f(x)$;\nnote that if $f$ is ultraconvex, then so is $f'$.\nDefine the set\n\\[\nS = \\{ f :\\thinspace \\mathbb{R} \\to \\mathbb{R} \\,|\\,f \\text{ ultraconvex and } f(0)=0\\}.\n\\]\nFor $f \\in S$, we must have $f(x) = 0$ for all $x < 0$: if $f(x_0) > 0$ for some $x_0 < 0$, then\nby the mean value theorem there exists $x \\in (0,x_0)$ for which $f'(x) = \\frac{f(x_0)}{x_0} < 0$.\nIn particular, $f'(0) = 0$, so $f' \\in S$ also.\n\nWe show by induction that for all $n \\geq 0$,\n\\[\nf(x) \\leq \\frac{f^{(n)}(1)}{n!} x^n \\qquad (f \\in S, x \\in [0,1]).\n\\]\nWe induct with base case $n=0$, which holds because any $f \\in S$ is nondecreasing. Given the claim for $n=m$,\nwe apply the induction hypothesis to $f' \\in S$ to see that\n\\[\nf'(t) \\leq \\frac{f^{(n+1)}(1)}{n!} t^n \\qquad (t \\in [0,1]),\n\\]\nthen integrate both sides from $0$ to $x$ to conclude.\n\nNow for $f \\in S$, we have $0 \\leq f(1) \\leq \\frac{f^{(n)}(1)}{n!}$ for all $n \\geq 0$. \nOn the other hand, by Taylor's theorem with remainder,\n\\[\nf(x) \\geq \\sum_{k=0}^n \\frac{f^{(k)}(1)}{k!}(x-1)^k \\qquad (x \\geq 1).\n\\]\nApplying this with $x=2$, we obtain $f(2) \\geq \\sum_{k=0}^n \\frac{f^{(k)}(1)}{k!}$ for all $n$;\nthis implies that $\\lim_{n\\to\\infty}  \\frac{f^{(n)}(1)}{n!} = 0$.\nSince $f(1) \\leq \\frac{f^{(n)}(1)}{n!}$, we must have $f(1) = 0$.\n\nFor $f \\in S$, we proved earlier that $f(x) = 0$ for all $x\\leq 0$, as well as for $x=1$. Since\nthe function $g(x) = f(cx)$ is also ultraconvex for $c>0$, we also have $f(x) = 0$ for all $x>0$;\nhence $f$ is identically zero.\n\nTo sum up, if $f\\colon \\mathbb{R} \\to \\mathbb{R}$ is infinitely differentiable, $f(0)=0$, and $f(1) = 1$,\nthen $f$ cannot be ultraconvex. This implies the desired result.\n\n\\noindent\n\\textbf{Variant.}\n(by Yakov Berchenko-Kogan)\nAnother way to show that any $f \\in S$ is identically zero is to show that for $f \\in S$ and $k$ a positive integer,\n\\[\nf(x) \\leq \\frac{x}{k} f'(x) \\qquad (x \\geq 0).\n\\]\nWe prove this by induction on $k$.\nFor the base case $k=1$, note that $f''(x) \\geq 0$ implies that $f'$ is nondecreasing. For $x \\geq 0$, we thus have\n\\[\nf(x) = \\int_0^x f'(t)\\,dt \\leq \\int_0^x f'(x)\\,dt = x f'(x).\n\\]\nTo pass from $k$ to $k+1$, apply the induction hypothesis to $f'$ and integrate by parts to obtain\n\\begin{align*}\nkf(x) &= \\int_0^x k f'(t)\\,dt \\\\\n&\\leq \\int_0^x t f''(t)\\,dt \\\\\n&= xf'(x) - \\int_0^x f'(t)\\,dt = xf'(x) - f(x).\n\\end{align*}\n\n\n\n\\noindent\n\\textbf{Remark.}\nNoam Elkies points out that one can refine the argument to show that\nif $f$ is ultraconvex, then it is analytic (i.e., it is represented by an entire Taylor series about any point, as opposed to a function like $f(x) = e^{-1/x^2}$ whose Taylor series at $0$ is identically zero);\nhe attributes the following argument to \nPeter Shalen. Let $g_n(x) = \\sum_{k=0}^n \\frac{1}{k!} f^{(k})(0) x^k$ be the $n$-th order Taylor polynomial of $f$.\nBy Taylor's theorem with remainder (a/k/a Lagrange's theorem), $f(x) - g_n(x)$ is everywhere nonnegative;\nconsequently, for all $x \\geq 0$, the Taylor series $\\sum_{n=0}^\\infty \\frac{1}{n!} f^{(n)}(0) x^n$\nconverges and is bounded above by $f$. But since $f^{(n+1)}(x)$ is nondecreasing, Lagrange's theorem \nalso implies that $f(x) - g_n(x) \\leq \\frac{1}{(n+1)!} f^{(n+1)}(x)$; for fixed $x \\geq 0$, the right side \ntends to 0 as $n \\to \\infty$. Hence $f$ is represented by its Taylor series for $x \\geq 0$, and so\nis analytic for $x>0$; by replacing $f(x)$ with $f(x-c)$, we may conclude that $f$ is everywhere analytic.\n\n\\noindent\n\\textbf{Remark.}\nWe record some properties of the class of ultraconvex functions.\n\\begin{itemize}", "category": "Algebra", "source": "PUTNAM", "year": 2018}
{"id": "putnam-2018-a6", "question": "Suppose that $A,B,C,$ and $D$ are distinct points, no three of which lie on a line,\nin the Euclidean plane. Show\nthat if the squares of the lengths of the line segments $AB$, $AC$, $AD$, $BC$, $BD$, and $CD$\nare rational numbers, then\nthe quotient\n\\[\n\\frac{\\mathrm{area}(\\triangle ABC)}{\\mathrm{area}(\\triangle ABD)}\n\\]\nis a rational number.", "solution": "\\textbf{First solution.}\nChoose a Cartesian coordinate system with origin at the midpoint of $AB$ and positive $x$-axis containing $A$.\nBy the condition on $AB$, we have $A = (\\sqrt{a}, 0)$, $B = (-\\sqrt{a}, 0)$ for some positive rational number $a$.\nLet $(x_1, y_1)$ and $(x_2, y_2)$ be the respective coordinates of $C$ and $D$; by computing the lengths\nof the segments $AC, BC, AD, BD, CD$, we see that the quantities\n\\begin{gather*}\n(x_1 - \\sqrt{a})^2 + y_1^2, \\quad (x_1 + \\sqrt{a})^2 + y_1^2, \\\\\n(x_2 - \\sqrt{a})^2 + y_2^2, \\quad (x_2 + \\sqrt{a})^2 + y_2^2, \\\\\n(x_1 - x_2)^2 + (y_1 - y_2)^2\n\\end{gather*}\nare all rational numbers. By adding and subtracting the first two quantities, and similarly for the next two, we see that the quantities\n\\[\nx_1^2 + y_1^2,\\quad x_1 \\sqrt{a}, \\quad x_2^2 + y_2^2, \\quad x_2 \\sqrt{a}\n\\]\nare rational numbers. Since $a$ is a rational number, so then are\n\\begin{align*}\nx_1^2 &= \\frac{(x_1 \\sqrt{a})^2}{a} \\\\\nx_2^2 &= \\frac{(x_2 \\sqrt{a})^2}{a} \\\\\nx_1x_2 &= \\frac{(x_1 \\sqrt{a})(x_2 \\sqrt{a})}{a} \\\\\ny_1^2 &= (x_1^2 + y_1^2) - x_1^2 \\\\\ny_2^2 &= (x_2^2 + y_2^2) - x_2^2.\n\\end{align*}\nNow note that the quantity\n\\[\n(x_1 - x_2)^2 + (y_1 - y_2)^2 = x_1^2 -2x_1 x_2 + x_2^2 + y_1^2 - 2y_1y_2 + y_2^2\n\\]\nis known to be rational, as is every summand on the right except $-2y_1y_2$; thus $y_1y_2$ is also rational.\nSince $y_1^2$ is also rational, so then is $y_1/y_2 = (y_1y_2)/(y_1^2)$;\nsince\n\\[\n\\mathrm{area}(\\triangle ABC) = \\sqrt{a} y_1, \\qquad \\mathrm{area}(\\triangle ABD) = \\sqrt{a} y_2,\n\\]\nthis yields the desired result.\n\n\n\\noindent\n\\textbf{Second solution.} (by Manjul Bhargava)\nLet $\\mathbf{b},\\mathbf{c}, \\mathbf{d}$ be the vectors $AB, AC, AD$ viewed as column vectors.\nThe desired ratio is given by\n\\begin{align*}\n\\frac{\\det(\\mathbf{b},\\mathbf{c})}{\\det(\\mathbf{b},\\mathbf{d})} &= \\frac{\\det(\\mathbf{b},\\mathbf{c})^T \\det(\\mathbf{b},\\mathbf{c}) }{ \\det(\\mathbf{b},\\mathbf{c})^T\\det(\\mathbf{b},\\mathbf{d})} \\\\\n&= \\det \\begin{pmatrix} \\mathbf{b} \\cdot \\mathbf{b} & \\mathbf{b} \\cdot \\mathbf{c} \\\\\n\\mathbf{c} \\cdot \\mathbf{b} & \\mathbf{c} \\cdot \\mathbf{c}\n\\end{pmatrix}\n\\det \\begin{pmatrix}\n\\mathbf{b} \\cdot \\mathbf{b} & \\mathbf{b} \\cdot \\mathbf{d} \\\\\n\\mathbf{c} \\cdot \\mathbf{b} & \\mathbf{c} \\cdot \\mathbf{d}\n\\end{pmatrix}^{-1}.\n\\end{align*}\n\nThe square of the length of $AB$ is $\\mathbf{b} \\cdot \\mathbf{b}$, so this quantity is rational.\nThe square of the lengths of $AC$ and $BC$ are $\\mathbf{c} \\cdot \\mathbf{c}$ and\n$(\\mathbf{c} - \\mathbf{b}) \\cdot (\\mathbf{c} - \\mathbf{b}) = \\mathbf{b} \\cdot \\mathbf{b} + \\mathbf{c} \\cdot \\mathbf{c}\n- 2 \\mathbf{b} \\cdot \\mathbf{c}$, so $\\mathbf{b} \\cdot \\mathbf{c} = \\mathbf{c} \\cdot \\mathbf{b}$ is rational.\nSimilarly, using $AD$ and $BD$, we deduce that $\\mathbf{d} \\cdot \\mathbf{d}$ and $\\mathbf{b} \\cdot \\mathbf{d}$ is rational; then using $CD$, we deduce that $\\mathbf{c} \\cdot \\mathbf{d}$ is rational.\n\n\\noindent\n\\textbf{Third solution.}\n(by David Rusin)\nRecall that Heron's formula (for the area of a triangle in terms of its side length) admits the following three-dimensional analogue due to Piero della Francesca: if $V$ denotes the volume of a tetrahedron with vertices $A,B,C,D \\in \\mathbb{R}^3$, then\n\\[\n288 V^2 = \\det\n\\begin{pmatrix}\n0 & AB^2 & AC^2 & AD^2 & 1 \\\\\nAB^2 & 0 & BC^2 & BD^2 & 1 \\\\\nAC^2 & BC^2 & 0 & CD^2 & 1 \\\\\nAD^2 & BD^2 & CD^2 & 0 & 1 \\\\\n1 & 1 & 1 & 1 & 0\n\\end{pmatrix}\n\\]\nIn particular, the determinant vanishes if and only if $A,B,C,D$ are coplanar. From the identity\n\\begin{gather*}\n64(4 \\mathrm{Area}(\\triangle ABC)^2 \\mathrm{Area}(\\triangle ABD)^2 - 9 AB^2 V^2) \\\\\n= (AB^4 - AB^2(AC^2 + AD^2 + BC^2 + BD^2 - 2CD^2) \\\\ + (AC^2-BC^2)(AD^2-BD^2))^2\n\\end{gather*}\nwe see that $\\mathrm{Area}(\\triangle ABC) \\mathrm{Area}(\\triangle ABD)$ is rational;\nsince each of the areas has rational square, we deduce the claim.\n\n\\noindent\n\\textbf{Fourth solution.}\n(by Greg Martin)\nDefine the signed angles $\\alpha = \\angle BAC, \\beta = \\angle BAD, \\gamma = \\angle CAD$, so that $\\alpha + \\gamma = \\beta$. By the Law of Cosines,\n\\begin{align*}\n2 AB \\cdot AC \\cos \\alpha &= AB^2 + AC^2 - BC^2 \\in \\mathbb{Q} \\\\\n2  AB \\cdot AD \\cos \\beta &= AB^2 + AD^2 - BD^2 \\in \\mathbb{Q} \\\\\n2  AC \\cdot AD \\cos \\gamma &= AC^2 + AD^2 - CD^2 \\in \\mathbb{Q}.\n\\end{align*}\nIn particular, $(2 AB \\cdot AC \\cos \\alpha)^2 \\in \\mathbb{Q}$, and so\n$\\cos^2 \\alpha \\in \\mathbb{Q}$ and $\\sin^2 \\alpha = 1 - \\cos^2 \\alpha \\in \\mathbb{Q}$,\nand similarly for the other two angles.\n\nApplying the addition formula to $\\cos \\beta$, we deduce that\n\\[\n2  AB \\cdot AD \\cos \\alpha \\cos \\gamma - \n2 AB \\cdot AD \\sin \\alpha \\sin \\gamma \\in \\mathbb{Q}. \n\\]\nThe first of these terms equals\n\\[\n\\frac{(2 AB \\cdot AC \\cos \\alpha)(2 AB \\cdot AC \\cos \\alpha)}{AC^2} \\in \\mathbb{Q},\n\\]\nso the second term must also be rational. But now\n\\begin{align*}\n\\frac{\\mathrm{Area}(\\triangle ABC)}{\\mathrm{Area}(\\triangle ACD)}\n&= \\frac{AB \\cdot AC \\sin \\alpha}{AC \\cdot AD \\sin \\gamma} \\\\\n&= \\frac{2 AB \\cdot AD \\sin \\alpha \\sin \\gamma}{2 AD^2 \\sin^2 \\gamma} \\in \\mathbb{Q}\n\\end{align*}\nas desired.\n\n\\noindent\n\\textbf{Remark.}\nDerek Smith observes that this result\nis Proposition 1 of: M. Knopf, J. Milzman, D. Smith, D. Zhu and D. Zirlin,\nLattice embeddings of planar point sets, \\textit{Discrete and Computational Geometry} \\textbf{56} (2016), 693--710.\n\n\\noindent\n\\textbf{Remark.}\nIt is worth pointing out that it is indeed possible to choose points $A,B,C,D$ satisfying the conditions of the problem;\n one can even ensure that the lengths of all four segments are themselves rational.\nFor example, it was originally observed by Euler that one can find an infinite set of points on the unit circle whose pairwise distances are all rational numbers.\nOne way to see this is to apply the linear fractional transformation $f(z) = \\frac{z+i}{z-i}$ to the Riemann sphere to carry the real axis (plus $\\infty$) to the unit circle, then compute that\n\\[\n\\left| f(z_1) - f(z_2) \\right| = \\frac{2|z_1-z_2||}{|(z_1-i)(z_2-i)|}.\n\\]\nLet $S$ be the set of rational numbers $z$ for which $2(z^2 + 1)$ is a perfect square; the set $f(S)$ has the desired property provided that it is infinite. That can be checked in various ways; for instance, the equation\n$2(x^2+1) = (2y)^2$ equates to $x^2-2y^2 = -1$ (a modified Brahmagupta-Pell equation), which has infinitely many solutions even over the integers:\n\\[\nx + y \\sqrt{2} = (1 + \\sqrt{2})^{2n+1}.\n\\]", "category": "Geometry", "source": "PUTNAM", "year": 2018}
{"id": "putnam-2018-b1", "question": "Let $\\mathcal{P}$ be the set of vectors defined by\n\\[\n\\mathcal{P} = \\left\\{ \\left. \\begin{pmatrix} a \\\\ b \\end{pmatrix} \\right| 0 \\leq a \\leq 2, 0 \\leq b \\leq 100, \\mbox{ and } a,b \\in \\mathbb{Z} \\right\\}.\n\\]\nFind all $\\mathbf{v} \\in \\mathcal{P}$ such that the set $\\mathcal{P} \\setminus \\{ \\mathbf{v} \\}$ obtained by omitting\nvector $\\mathbf{v}$ from $\\mathcal{P}$ can be partitioned into two sets of equal size and equal sum.", "solution": "The answer is the collection of vectors $(1,b)$ where $0 \\leq b \\leq 100$ and $b$ is even.\n (For ease of typography, we write tuples instead of column vectors.)\n\nFirst we show that if $\\mathcal{P} \\setminus \\{\\mathbf{v}\\}$ can be partitioned into subsets $S_1$ and $S_2$ of equal size and equal sum, then $\\mathbf{v}$ must be of the form $(1,b)$ where $b$ is even. For a finite nonempty set $S$ of vectors in $\\mathbb{Z}^2$, let $\\Sigma(S)$ denote the sum of the vectors in $S$. \nSince the average $x$- and $y$-coordinates in $\\mathcal{P}$ are $1$ and $50$, respectively, and there are $3\\cdot 101$ elements in $\\mathcal{P}$, we have\n\\[\n\\Sigma(P) = 303 \\cdot (1,50) = (303,15150). \n\\]\nOn the other hand, \n\\[\n\\Sigma(P) = \\mathbf{v}+\\Sigma(S_1)+\\Sigma(S_2) = \\mathbf{v}+2\\Sigma(S_1). \n\\]\nBy parity considerations, the entries of $\\mathbf{v}$ must be odd and even, respectively, and thus $\\mathbf{v}$ is of the claimed form.\n\nNext suppose $\\mathbf{v} = (1,b)$ where $b$ is even. Note that $\\mathcal{P} \\setminus \\{(1,50)\\}$ can be partitioned into $151$ pairs of (distinct) vectors $(x,y)$ and $(2-x,100-y)$, each summing to $(2,100)$. If $b \\neq 50$ then three of these pairs are $\\{(1,b),(1,100-b)\\}$,$\\{(2,b),(0,100-b)\\}$, and $\\{(2,25+b/2),(0,75-b/2)\\}$. Of the remaining $148$ pairs, assign half of them to $S_1$ and half to $S_2$, and then complete the partition of $\\mathcal{P} \\setminus \\{\\mathbf{v}\\}$ by assigning $(0,100-b)$, $(2,25+b/2)$, and $(1,50)$ to $S_1$ and $(1,100-b)$, $(2,b)$, and $(0,75-b/2)$ to $S_2$. (Note that the three vectors assigned to each of $S_1$ and $S_2$ have the same sum $(3,175-b/2)$.) By construction, $S_1$ and $S_2$ have the same number of elements, and $\\Sigma(S_1) = \\Sigma(S_2)$.\n\nFor $b=50$, this construction does not work because $(1,b) = (100-b)$, but a slight variation can be made.\n In this case, three of the pairs in $\\mathcal{P} \\setminus \\{(1,50)\\}$ are $\\{(2,50),(0,50)\\}$, $\\{(1,51),(1,49)\\}$, and $\\{(0,49),(2,51)\\}$. Assign half of the other $148$ pairs to $S_1$ and half to $S_2$, and complete the partition of\n$\\mathcal{P} \\setminus \\{(1,50)\\}$ by assigning $(2,50)$, $(1,51)$, and $(0,49)$ to $S_1$ and $(0,50)$, $(1,49)$, and $(2,51)$ to $S_2$.", "category": "Geometry", "source": "PUTNAM", "year": 2018}
{"id": "putnam-2018-b2", "question": "Let $n$ be a positive integer, and let $f_n(z) = n + (n-1) z + (n-2)z^2 + \\cdots + z^{n-1}$. Prove that\n$f_n$ has no roots in the closed unit disk $\\{z \\in \\mathbb{C}\\colon |z| \\leq 1 \\}$.", "solution": "\\textbf{First solution.}\nNote first that $f_n(1) > 0$, so $1$ is not a root of $f_n$.\nNext, note that\n\\[\n(z-1)f_n(z) = z^n + \\cdots + z - n;\n\\]\nhowever, for $\\left| z \\right| \\leq 1$, we have \n$\\left| z^n + \\cdots + z \\right| \\leq n$ by the triangle inequality;\nequality can only occur if $z,\\dots,z^n$ have norm 1 and the same argument, which only happens for $z=1$.\nThus there can be no root of $f_n$ with $|z| \\leq 1$.\n\n\n\\noindent\n\\textbf{Second solution.}\n(by Karl Mahlburg)\nDefine the polynomial\n\\[\ng_n(z) = nz^{n-1} + \\cdots + 2z + 1\n\\]\nand note that $z^{n-1} g_n(z^{-1}) = f_n(z)$.\nSince $f_n(0) \\neq 0$, to prove the claim it is equivalent to show that $g_n$\nhas no roots in the region $|z| \\geq 1$.\n\nNow note that $g_n(z) = h_n'(z)$ for\n\\[\nh_n(z) = z^n + \\cdots + z + 1,\n\\]\na polynomial with roots $e^{2\\pi ij/(n+1)}$ for $j=0,\\dots,n$.\nBy the Gauss-Lucas theorem, the roots of $g_n$ lie in the convex hull of the roots of $h_n$,\nand moreover cannot be vertices of the convex hull because $h_n$ has no repeated roots.\nThis implies the claim.\n\n\\noindent\n\\textbf{Remark.}\nYet another approach is to use the \\emph{Enestr\\\"om-Kakeya theorem}: if $P_n(z) = a_0 + \\cdots + a_n z^n$\nis a polynomial with real coefficients satisfying $|a_n|  \\geq \\cdots \\geq |a_0| > 0$, then the roots of $P_n(z)$\nall satisfy $|z| \\leq 1$. Namely, applying this to the polynomial $g_n(z/c)$ for \n$c = n/(n-1)$ shows that the roots of $g_n$ all satisfy $\\left|z \\right| \\leq 1/c$. \n\n\\noindent\n\\textbf{Remark.}\nFor a related problem, see problem A5 from the 2014 Putnam competition.", "category": "Algebra", "source": "PUTNAM", "year": 2018}
{"id": "putnam-2018-b3", "question": "Find all positive integers $n < 10^{100}$ for which simultaneously $n$ divides $2^n$, $n-1$ divides $2^n-1$,\nand $n-2$ divides $2^n - 2$.", "solution": "The values of $n$ with this property are $2^{2^\\ell}$ for $\\ell = 1,2,4,8$.\nFirst, note that $n$ divides $2^n$ if and only if $n$ is itself a power of 2; we may thus write $n = 2^m$ and note that\nif $n<10^{100}$, then\n\\[\n2^m = n < 10^{100} < (10^3)^{34} < (2^{10})^{34} = 2^{340}.\n\\]\nMoreover, the case $m=0$ does not lead to a solution because for $n=1$, $n-1 = 0$ does not divide $2^n-1 = 1$; we \nmay thus assume $1 \\leq m \\leq 340$.\n\nNext, note that modulo $n-1 = 2^m-1$, the powers of $2$ cycle with period $m$ (the terms\n$2^0, \\dots, 2^{m-1}$ remain the same upon reduction, and then the next term repeats the initial 1); consequently,\n$n-1$ divides $2^n-1$ if and only if $m$ divides $n$, which happens if and only if $m$ is a power of 2.\nWrite $m = 2^\\ell$ and note that $2^\\ell < 340 < 512$, so $\\ell < 9$. The case $\\ell=0$ does not lead to a solution because for $n=2$, $n-2 =0$ does not divide $2^n-2 = 2$; we may thus assume $1 \\leq \\ell \\leq 8$.\n\nFinally, note that $n-2 = 2^m-2$ divides $2^n-2$ if and only if $2^{m-1} - 1$ divides $2^{n-1} - 1$.\nBy the same logic as the previous paragraph, this happens if and only if $m-1$ divides $n-1$,\nthat is, if $2^\\ell - 1$ divides $2^m-1$. This in turn happens if and only if $\\ell$ divides $m = 2^\\ell$,\nwhich happens if and only if $\\ell$ is a power of 2. The values allowed by the bound $\\ell < 9$ are\n$\\ell = 1,2,4,8$; for these values, $m \\leq 2^8 = 256$ and\n\\[\nn = 2^m \\leq 2^{256} \\leq (2^3)^{86} < 10^{86} < 10^{100},\n\\]\nso the solutions listed do satisfy the original inequality.", "category": "Number Theory", "source": "PUTNAM", "year": 2018}
{"id": "putnam-2018-b4", "question": "Given a real number $a$, we define a sequence by $x_0 = 1$, $x_1 = x_2 = a$, and $x_{n+1} = 2x_n x_{n-1} - x_{n-2}$ for $n \\geq 2$. Prove that if $x_n = 0$ for some $n$, then the sequence is periodic.", "solution": "We first rule out the case $|a|>1$. In this case, we prove that $|x_{n+1}| \\geq |x_n|$ for all $n$, meaning that we cannot have $x_n = 0$. We proceed by induction; the claim is true for $n=0,1$ by hypothesis. To prove the claim for  $n \\geq 2$, write\n\\begin{align*}\n|x_{n+1}| &= |2x_nx_{n-1}-x_{n-2}| \\\\\n&\\geq 2|x_n||x_{n-1}|-|x_{n-2}| \\\\\n&\\geq |x_n|(2|x_{n-1}|-1) \\geq |x_n|,\n\\end{align*} \nwhere the last step follows from $|x_{n-1}| \\geq |x_{n-2}| \\geq \\cdots \\geq |x_0| = 1$.\n\nWe may thus assume hereafter that $|a|\\leq 1$. We can then write $a = \\cos b$ for some $b \\in [0,\\pi]$. \nLet $\\{F_n\\}$ be the Fibonacci sequence, defined as usual by $F_1=F_2=1$ and $F_{n+1}=F_n+F_{n-1}$. We show by induction that\n\\[\nx_n = \\cos(F_n b) \\qquad (n \\geq 0).\n\\]\nIndeed, this is true for $n=0,1,2$; given that it is true for $n \\leq m$, then\n\\begin{align*}\n2x_mx_{m-1}&=2\\cos(F_mb)\\cos(F_{m-1}b) \\\\\n&= \\cos((F_m-F_{m-1})b)+\\cos((F_m+F_{m-1})b) \\\\\n&= \\cos(F_{m-2}b)+\\cos(F_{m+1}b)\n\\end{align*}\nand so \n$x_{m+1} = 2x_mx_{m-1}-x_{m-2} = \\cos(F_{m+1}b)$. This completes the induction.\n\n\nSince $x_n = \\cos(F_n b)$, if $x_n=0$ for some $n$ then $F_n b = \\frac{k}{2} \\pi$ for some odd integer $k$. In particular, we can write $b = \\frac{c}{d}(2\\pi)$ where $c = k$ and $d = 4F_n$ are integers.\n\n\nLet $x_n$ denote the pair $(F_n,F_{n+1})$, where each entry in this pair is viewed as an element of $\\mathbb{Z}/d\\mathbb{Z}$. Since there are only finitely many possibilities for $x_n$, there must be some $n_2>n_1$ such that $x_{n_1}=x_{n_2}$. Now $x_n$ uniquely determines both $x_{n+1}$ and $x_{n-1}$, and it follows that the sequence $\\{x_n\\}$ is periodic: for $\\ell = n_2-n_1$, $x_{n+\\ell} = x_n$ for all $n \\geq 0$. In particular, $F_{n+\\ell} \\equiv F_n \\pmod{d}$ for all $n$. But then $\\frac{F_{n+\\ell}c}{d}-\\frac{F_n c}{d}$ is an integer, and so\n\\begin{align*}\nx_{n+\\ell} &= \\cos\\left(\\frac{F_{n+\\ell}c}{d}(2\\pi)\\right)\\\\\n& = \\cos\\left(\\frac{F_n c}{d}(2\\pi)\\right) = x_n\n\\end{align*}\nfor all $n$. Thus the sequence $\\{x_n\\}$ is periodic, as desired.\n\n\\noindent\n\\textbf{Remark.}\nKarl Mahlburg points out that one can motivate the previous solution by computing the terms\n\\[\nx_2 = 2a^2 - 1, x_3 = 4a^3 - 3a, x_4 = 16a^5 - 20a^3 + 5a\n\\]\nand recognizing these as the Chebyshev polynomials $T_2, T_3, T_5$. (Note that $T_3$ was used in the solution of\nproblem A3.)\n\n\\noindent\n\\textbf{Remark.}\nIt is not necessary to handle the case $\\left| a \\right| > 1$ separately; the cosine function extends\nto a surjective analytic function on $\\mathbb{C}$ and continues to satisfy the addition formula,\nso one can write $a = \\cos b$ for some $b \\in \\mathbb{C}$\nand then proceed as above.", "category": "Algebra", "source": "PUTNAM", "year": 2018}
{"id": "putnam-2018-b5", "question": "Let $f = (f_1, f_2)$ be a function from $\\mathbb{R}^2$ to $\\mathbb{R}^2$ with continuous partial derivatives\n$\\frac{\\partial f_i}{\\partial x_j}$ that are positive everywhere. Suppose that\n\\[\n\\frac{\\partial f_1}{\\partial x_1} \\frac{\\partial f_2}{\\partial x_2} - \\frac{1}{4} \\left( \\frac{\\partial f_1}{\\partial x_2}  + \\frac{\\partial f_2}{\\partial x_1} \\right)^2 > 0\n\\]\neverywhere. Prove that $f$ is one-to-one.", "solution": "Let $(a_1,a_2)$ and $(a_1',a_2')$ be distinct points in $\\mathbb{R}^2$; we want to show that $f(a_1,a_2) \\neq f(a_1',a_2')$. Write $(v_1,v_2) = (a_1',a_2')-(a_1,a_2)$, and let $\\gamma(t) = (a_1,a_2)+t(v_1,v_2)$, $t \\in [0,1]$, be the path between $(a_1,a_2)$ and $(a_1',a_2')$. Define a real-valued function $g$ by $g(t) = (v_1,v_2) \\cdot f(\\gamma(t))$.\nBy the Chain Rule, \n\\[\nf'(\\gamma(t)) = \\left( \\begin{matrix} \\partial f_1/\\partial x_1 & \\partial f_1/\\partial x_2 \\\\ \\partial f_2/\\partial x_1 & \\partial f_2/\\partial x_2 \\end{matrix} \\right) \\left(\n\\begin{matrix} v_1 \\\\ v_2 \\end{matrix} \\right). \n\\]\nAbbreviate $\\partial f_i/\\partial x_j$ by $f_{ij}$; then\n\\begin{align*}\ng'(t) &= \\left( \\begin{matrix} v_1 & v_2 \\end{matrix} \\right) \\left( \\begin{matrix} f_{11} & f_{12} \\\\ f_{21} & f_{22} \\end{matrix} \\right) \\left( \\begin{matrix} v_1 \\\\ v_2 \\end{matrix} \\right) \\\\\n&= f_{11} v_1^2 + (f_{12}+f_{21})v_1v_2+f_{22} v_2^2 \\\\\n&= f_{11} \\left(v_1+\\frac{f_{12}+f_{21}}{2f_{11}} v_2 \\right)^2 + \\frac{4f_{11}f_{22}-(f_{12}+f_{21})^2}{4f_{11}} v_2^2 \\\\\n& \\geq 0\n\\end{align*}\nsince $f_{11}$ and $f_{11}f_{22}-(f_{12}+f_{21})^2/4$ are positive by assumption. Since the only way that equality could hold is if $v_1$ and $v_2$ are both $0$, we in fact have $g'(t)>0$ for all $t$. But if $f(a_1,a_2) = f(a_1',a_2')$, then $g(0) = g(1)$, a contradiction.\n\n\\noindent\n\\textbf{Remark.}\nA similar argument shows more generally that $f:\\thinspace \\mathbb{R}^n \\to \\mathbb{R}^n$ is injective if at all points in $\\mathbb{R}^n$, the Jacobian matrix $Df$ satisfies the following property: the quadratic form associated to the bilinear form with matrix $Df$ (or the symmetrized bilinear form with matrix $(Df+(Df)^T)/2$) is positive definite. In the setting of the problem, the symmetrized matrix is\n\\[\n\\left( \\begin{matrix} f_{11} & (f_{12}+f_{21})/2 \\\\ (f_{12}+f_{21})/2 & f_{22} \\end{matrix} \\right),\n\\]\nand this is positive definite if and only if $f_{11}$ and the determinant of the matrix are both positive\n(Sylvester's criterion). Note that the assumptions that $f_{12},f_{21}>0$ are unnecessary for the argument;\nit is also easy to see that the hypotheses $f_{11}, f_{12} > 0$ are also superfluous.\n(The assumption $f_{11}f_{22}-(f_{12}+f_{21})^2 > 0$ implies $f_{11} f_{22} > 0$, so both are nonzero and of the same sign; by continuity, this common sign must be constant over all of $\\mathbb{R}^2$. If it is negative, then\napply the same logic to $(-f_1, -f_2)$.)", "category": "Geometry", "source": "PUTNAM", "year": 2018}
{"id": "putnam-2018-b6", "question": "Let $S$ be the set of sequences of length $2018$ whose terms  are in the set $\\{1,2,3,4,5,6,10\\}$ and sum to $3860$.\nProve that the cardinality of $S$ is at most\n\\[\n2^{3860} \\cdot \\left( \\frac{2018}{2048} \\right)^{2018}.\n\\]\n\n\\end{itemize}\n\n\\end{document}", "solution": "(by Manjul Bhargava)\nLet $a(k,n)$ denote the number of sequences of length $k$ taken from the set $\\{1,2,3,4,5,6,10\\}$ and having sum $n$.\nWe prove that \n\\[\na(k,n) < 2^n \\left( \\frac{2018}{2048} \\right)^k\n\\]\nby double induction on $n+k$ and $n-k$.  The claim is clearly true when $n-k \\leq 0$ and in particular when $n=k=1$, the smallest case for $n+k$.\n\nWe categorize the sequences counted by $a(k,n)$ by whether they end in $1,2,3,4,5,6,10$; removing the last\nterm of such a sequence yields a sequence counted by $a(k-1,n-1), a(k-1,n-2), a(k-1,n-3), a(k-1,n-4), a(k-1,n-5), a(k-1,n-6), a(k-1,n-10)$, respectively.  Therefore,\n\\begin{align*}\na(k,n) &= a(k-1,n-1) + \\cdots \\\\\n&\\quad + a(k-1,n-6) + a(k-1,n-10) \\\\\n&< (  2^{n-1} + \\cdots +   2^{n-6}  +  2^{n-10} ) \\left( \\frac{2018}{2048} \\right)^{k-1} \\\\\n&= 2^n \\left( \\frac{1}{2} + \\cdots + \\frac{1}{64} + \\frac{1}{1024} \\right) \\left( \\frac{2018}{2048} \\right)^{k-1} \\\\\n&= 2^n \\left( \\frac{1009}{1024} \\right) \\left( \\frac{2018}{2048} \\right)^{k-1} \\\\\n&= 2^n \\left( \\frac{2018}{2048} \\right)^{k}\n\\end{align*}\nwhere we used directly the induction hypothesis to obtain the inequality on the second line.\nThe case $k=2018, n=3860$ yields the desired result.\n\n\\noindent\n\\textbf{Remark.}\nK. Soundararajan suggests the following reinterpretation of this argument. The quantity $a(k,n)$ can be interpreted as the coefficient of $x^n$ in $(x + x^2 + \\cdots + x^6 + x^{10})^k$. Since this polynomial has nonnegative coefficients, \nfor any $x$, we have\n\\[\na(k,n) x^n < (x + x^2 + \\cdots + x^6 + x^{10})^k.\n\\]\nSubstituting $x = \\frac{1}{2}$ yields the bound stated above.\n\nOn a related note, Alexander Givental suggests that the value $n=3860$ (which is otherwise irrelevant to the problem) may have been chosen for the following reason: as a function of $x$, the upper bound $x^{-n} (x+x^2 + \\cdots + x^6 + x^{10})^k$\nis minimized when\n\\[\n\\frac{x(1 + 2x + \\cdots + 6x^5 + x^9)}{x + x^2 + \\cdots + x^6 + x^{10}} = \\frac{n}{k}.\n\\]\nIn order for this to hold for $x = 1/2$, $k=2018$, one must take $n = 3860$.\n\n\\noindent\n\\textbf{Remark.}\nFor purposes of comparison, the stated bound is about $10^{1149}$, while the trivial upper bound\ngiven by counting all sequences of length 2018 of positive integers that sum to 3860 is\n\\[\n\\binom{3859}{2017} \\sim 10^{1158}.\n\\]\nThe latter can be easily derived by a ``stars and bars'' argument: visualize each sequence of this form by representing the value $n$ by $n$ stars and inserting a bar between adjacent terms of the sequence. The resulting string of symbols consists of one star at the beginning, 2017 bar-star combinations, and 3860-2018 more stars.\n\nUsing a computer, it is practical to compute the exact cardinality of $S$ by finding the coefficient of $x^{3860}$ in\n$(x + x^2 + \\cdots + x^6 + x^{10})^{2018}$. For example, this can be done in \\texttt{Sage} in a couple of seconds as follows. (The truncation is truncated modulo $x^{4000}$ for efficiency.)\n\n\\begin{verbatim}\nsage: P.<x> = PowerSeriesRing(ZZ, 4000)\nsage: f = (x + x^2 + x^3 + x^4 + \\\n....:      x^5 + x^6 + x^10)^2018\nsage: m = list(f)[3860]\nsage: N(m)\n8.04809122940636e1146\n\\end{verbatim}\n\nThis computation shows that the upper bound of the problem differs from the true value by a factor of about 150.\n\n\n\\end{itemize}\n\\end{document}", "category": "Combinatorics", "source": "PUTNAM", "year": 2018}
{"id": "imo-2012-q1", "question": "Let $ABC$ be a triangle and $J$ the center of the $A$-excircle.\nThis excircle is tangent to the side $BC$ at $M$,\nand to the lines $AB$ and $AC$ at $K$ and $L$, respectively.\nThe lines $LM$ and $BJ$ meet at $F$, and the lines $KM$ and $CJ$ meet at $G$.\nLet $S$ be the point of intersection of the lines $AF$ and $BC$,\nand let $T$ be the point of intersection of the lines $AG$ and $BC$.\nProve that $M$ is the midpoint of $\\ol{ST}$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2736397}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle and $J$ the center of the $A$-excircle.\nThis excircle is tangent to the side $BC$ at $M$,\nand to the lines $AB$ and $AC$ at $K$ and $L$, respectively.\nThe lines $LM$ and $BJ$ meet at $F$, and the lines $KM$ and $CJ$ meet at $G$.\nLet $S$ be the point of intersection of the lines $AF$ and $BC$,\nand let $T$ be the point of intersection of the lines $AG$ and $BC$.\nProve that $M$ is the midpoint of $\\ol{ST}$.\n\\end{mdframed}\nWe employ barycentric coordinates with reference $\\triangle ABC$.\nAs usual $a = BC$, $b = CA$, $c = AB$, $s = \\half(a+b+c)$.\n\nIt's obvious that $K = ( -(s-c): s : 0)$, $M = ( 0 : s-b : s-c)$.\nAlso, $J = (-a : b : c)$.\nWe then obtain\n\\[ G = \\left( -a: b : \\frac{-as + (s-c)b}{s-b} \\right). \\]\nIt follows that\n\\[ T = \\left( 0 : b : \\frac{-as + (s-c)}{s-b} \\right) = ( 0 : b(s-b) : b(s-c) - as). \\]\nNormalizing, we see that $T = \\left( 0, -\\frac{b}{a}, 1 + \\frac{b}{a} \\right)$,\nfrom which we quickly obtain $MT = s$.\nSimilarly, $MS = s$, so we're done.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2012}
{"id": "imo-2012-q2", "question": "Let $a_2$, $a_3$, \\dots, $a_n$ be positive reals with product $1$,\nwhere $n \\ge 3$.\nShow that\n\\[ (1+a_2)^2 (1+a_3)^3 \\dots (1+a_n)^n > n^n. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2736375}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a_2$, $a_3$, \\dots, $a_n$ be positive reals with product $1$,\nwhere $n \\ge 3$.\nShow that\n\\[ (1+a_2)^2 (1+a_3)^3 \\dots (1+a_n)^n > n^n. \\]\n\\end{mdframed}\nTry the dumbest thing possible: by AM-GM,\n\\begin{align*}\n  (1 + a_2)^2 &\\ge 2^2 a_2 \\\\\n  (1 + a_3)^3 = \\left( \\half + \\half + a_3 \\right)^3 &\\ge \\frac{3^3}{2^2} a_3 \\\\\n  (1 + a_4)^4 = \\left( \\frac13 + \\frac13 + \\frac13 + a_4 \\right)^4\n    &\\ge \\frac{4^4}{3^3} a_4 \\\\\n  &\\vdotswithin=\n\\end{align*}\nand so on.\nMultiplying these all gives the result.\nThe inequality is strict since it's not possible\nthat $a_2 = 1$, $a_3 = \\half$, et cetera.\n\\pagebreak", "category": "Algebra", "source": "IMO", "year": 2012}
{"id": "imo-2012-q3", "question": "The liar's guessing game is a game played between two players $A$ and $B$.\nThe rules of the game depend on two fixed positive integers $k$ and $n$\nwhich are known to both players.\n\nAt the start of the game $A$\nchooses integers $x$ and $N$ with $1 \\le x \\le N$.\nPlayer $A$ keeps $x$ secret, and truthfully tells $N$ to player $B$.\nPlayer $B$ now tries to obtain information about $x$\nby asking player $A$ questions as follows:\neach question consists of $B$ specifying an arbitrary set $S$\nof positive integers (possibly one specified in some previous question),\nand asking $A$ whether $x$ belongs to $S$.\nPlayer $B$ may ask as many questions as he wishes.\nAfter each question, player $A$ must immediately answer\nit with yes or no, but is allowed to lie as many times as she wants;\nthe only restriction is that, among any $k+1$ consecutive answers,\nat least one answer must be truthful.\n\nAfter $B$ has asked as many questions as he wants,\nhe must specify a set $X$ of at most $n$ positive integers.\nIf $x$ belongs to $X$, then $B$ wins;\notherwise, he loses.\nProve that:\n\n\\begin{enumerate}[(a)]\n  \\ii If $n \\ge 2^k$, then $B$ can guarantee a win.\n  \\ii For all sufficiently large $k$,\n  there exists an integer $n \\ge (1.99)^k$\n  such that $B$ cannot guarantee a win.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2736406}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nThe liar's guessing game is a game played between two players $A$ and $B$.\nThe rules of the game depend on two fixed positive integers $k$ and $n$\nwhich are known to both players.\n\nAt the start of the game $A$\nchooses integers $x$ and $N$ with $1 \\le x \\le N$.\nPlayer $A$ keeps $x$ secret, and truthfully tells $N$ to player $B$.\nPlayer $B$ now tries to obtain information about $x$\nby asking player $A$ questions as follows:\neach question consists of $B$ specifying an arbitrary set $S$\nof positive integers (possibly one specified in some previous question),\nand asking $A$ whether $x$ belongs to $S$.\nPlayer $B$ may ask as many questions as he wishes.\nAfter each question, player $A$ must immediately answer\nit with yes or no, but is allowed to lie as many times as she wants;\nthe only restriction is that, among any $k+1$ consecutive answers,\nat least one answer must be truthful.\n\nAfter $B$ has asked as many questions as he wants,\nhe must specify a set $X$ of at most $n$ positive integers.\nIf $x$ belongs to $X$, then $B$ wins;\notherwise, he loses.\nProve that:\n\n\\begin{enumerate}[(a)]\n  \\ii If $n \\ge 2^k$, then $B$ can guarantee a win.\n  \\ii For all sufficiently large $k$,\n  there exists an integer $n \\ge (1.99)^k$\n  such that $B$ cannot guarantee a win.\n\\end{enumerate}\n\\end{mdframed}\nCall the players Alice and Bob.\n\n\\textbf{Part (a)}: We prove the following.\n\\begin{claim*}\nIf $N \\ge 2^k+1$, then in $2k+1$ questions,\nBob can rule out some number in $\\{1, \\dots, 2^k+1\\}$\nform being equal to $x$.\n\\end{claim*}\n\\begin{proof}\n  First, Bob asks the question $S_0 = \\{ 2^k+1 \\}$\n  until Alice answers ``yes''\n  or until Bob has asked $k+1$ questions.\n  If Alice answers ``no'' to all of these then Bob rules out $2^k+1$.\n  So let's assume Alice just said ``yes''.\n\n  Now let $T = \\{1, \\dots, 2^k\\}$.\n  Then, he asks $k$-follow up questions $S_1$, \\dots, $S_k$\n  defined as follows:\n  \\begin{itemize}\n    \\ii $S_1 = \\{1, 3, 5, 7, \\dots, 2^k-1\\}$ consists of all numbers\n    in $T$ whose least significant digit in binary is $1$.\n    \\ii $S_2 = \\{ 2, 3, 6, 7, \\dots, 2^k-2, 2^k-1\\}$\n    consists of all numbers in $T$ whose second least\n    significant digit in binary is $1$.\n    \\ii More generally $S_i$\n    consists of all numbers in $T$ whose $i$th least\n    significant digit in binary is $1$.\n  \\end{itemize}\n  WLOG Alice answers these all as ``yes'' (the other cases are similar).\n  Among the last $k+1$ answers at least one must be truthful,\n  and the number $2^k$ (having zeros in all relevant digits)\n  does not appear in any of $S_0$, \\dots, $S_k$ and is ruled out.\n\\end{proof}\nThus in this way Bob can repeatedly find non-possibilities for $x$\n(and then relabel the remaining candidates $1$, \\dots, $N-1$)\nuntil he arrives at a set of at most $2^k$ numbers.\n\n\\textbf{Part (b)}:\nIt suffices to consider $n = \\left\\lceil 1.99^k \\right\\rceil$\nand $N = n+1$ for large $k$.\nAt the $t$th step, Bob asks some question $S_t$;\nwe phrase each of Alice's answers in the form ``$x \\notin B_t$'',\nwhere $B_t$ is either $S_t$ or its complement.\n(You may think of these as ``bad sets'';\nthe idea is to show we can avoid having any number\nappear in $k+1$ consecutive bad sets,\npreventing Bob from ruling out any numbers.)\n\nMain idea: for every number $1 \\le x \\le N$,\nat time step $t$ we define its \\emph{weight}\nto be \\[ w(x) = 1.998^e \\]\nwhere $e$ is the largest number\nsuch that $x \\in B_{t-1} \\cap B_{t-2} \\cap \\dots \\cap B_{t-e}$.\n\n\\begin{claim*}\n  Alice can ensure the total weight never exceeds $1.998^{k+1}$\n  for large $k$.\n\\end{claim*}\n\n\\begin{proof}\n  Let $W_{t}$ denote the sum of weights after the $t$th question.\n  We have $W_0 = N < 1000n$.\n  We will prove inductively that $W_t < 1000n$ always.\n\n  At time $t$, Bob specifies a question $S_t$.\n  We have Alice choose $B_t$ as whichever of $S_t$ or $\\ol{S_t}$\n  has lesser total weight, hence at most $W_t/2$.\n  The weights of for $B_t$ increase by a factor of $1.998$,\n  while the weights for $\\ol{B_t}$ all reset to $1$.\n  So the new total weight after time $t$ is\n  \\[ W_{t+1} \\le 1.998 \\cdot \\frac{W_t}{2}\n    + \\# \\ol{B_t} \\le 0.999 W_t + n. \\]\n  Thus if $W_t < 1000n$ then $W_{t+1} < 1000n$.\n\n  To finish, note that\n  $1000n < 1000 \\left( 1.99^k + 1 \\right) < 1.998^{k+1}$\n  for $k$ large.\n\\end{proof}\n\nIn particular, no individual number can have weight $1.998^{k+1}$.\nThus for every time step $t$ we have\n\\[ B_t \\cap B_{t+1} \\cap \\dots \\cap B_{t+k} = \\varnothing. \\]\nThen once Bob stops, if he declares a set of $n$ positive integers,\nand $x$ is an integer Bob did not choose,\nthen Alice's question history is consistent with $x$ being Alice's number,\nas among any $k+1$ consecutive answers\nshe claimed that $x \\in \\ol{B_t}$ for some $t$ in that range.\n\n\\begin{remark*}\n  [Motivation]\n  In our $B_t$ setup, let's think backwards.\n  The problem is equivalent to avoiding $e = k+1$ at any time step $t$,\n  for any number $x$.\n  That means\n  \\begin{itemize}\n    \\ii have at most two elements with $e = k$ at time $t-1$,\n    \\ii thus have at most four elements with $e = k-1$ at time $t-2$,\n    \\ii thus have at most eight elements with $e = k-2$ at time $t-3$,\n    \\ii and so on.\n  \\end{itemize}\n  We already exploited this in solving part (a).\n  In any case it's now natural to try letting $w(x) = 2^e$,\n  so that all the cases above sum to ``equally bad'' situations:\n  since $8 \\cdot 2^{k-2} = 4 \\cdot 2^{k-1} = 2 \\cdot 2^k$, say.\n\n  However, we then get $W_{t+1} \\le \\half (2W_t) + n$,\n  which can increase without bound due to contributions\n  from numbers resetting to zero.\n  The way to fix this is to change the weight to $w(x) = 1.998^e$,\n  taking advantage of the little extra space we have\n  due to having $n \\ge 1.99^k$ rather than $n \\ge 2^k$.\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Combinatorics", "source": "IMO", "year": 2012}
{"id": "imo-2012-q4", "question": "Find all functions $f \\colon \\ZZ \\to \\ZZ$ such that,\nfor all integers $a$, $b$, $c$ that satisfy $a+b+c=0$,\nthe following equality holds:\n\\[ f(a)^2+f(b)^2+f(c)^2 = 2f(a)f(b)+2f(b)f(c)+2f(c)f(a). \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2737336}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all functions $f \\colon \\ZZ \\to \\ZZ$ such that,\nfor all integers $a$, $b$, $c$ that satisfy $a+b+c=0$,\nthe following equality holds:\n\\[ f(a)^2+f(b)^2+f(c)^2 = 2f(a)f(b)+2f(b)f(c)+2f(c)f(a). \\]\n\\end{mdframed}\nAnswer: for arbitrary $k \\in \\ZZ$, we have\n\\begin{enumerate}[(i)]\n  \\ii $f(x) = kx^2$,\n  \\ii $f(x) = 0$ for even $x$, and $f(x) = k$ for odd $x$, and\n  \\ii $f(x) = 0$ for $x \\equiv 0 \\pmod 4$,\n  $f(x) = k$ for odd $x$, and $f(x) = 4k$ for $x \\equiv 2 \\pmod 4$.\n\\end{enumerate}\nThese can be painfully seen to work.\n(It's more natural to think of these as\n$f(x) = x^2$, $f(x) = x^2 \\pmod 4$, $f(x) = x^2 \\pmod 8$,\nand multiples thereof.)\n\nSet $a=b=c=0$ to get $f(0)=0$.\nThen set $c=0$ to get $f(a) = f(-a)$, so $f$ is even.\nNow \\[ f(a)^2 + f(b)^2 + f(a+b)^2\n= 2f(a+b)\\left( f(a)+f(b) \\right) + 2f(a)f(b) \\]\nor\n\\[ \\left( f(a+b) - \\left( f(a)+f(b) \\right) \\right)^2\n  = 4f(a)f(b). \\]\nHence $f(a)f(b)$ is a perfect square for all $a,b \\in \\ZZ$.\nSo there exists a $\\lambda$ such that $f(n) = \\lambda g(n)^2$, where $g(n) \\ge 0$.\nFrom here we recover\n\\[ \\boxed{g(a+b) = \\pm g(a) \\pm g(b)}. \\]\nAlso $g(0) = 0$.\n\nLet $k = g(1) \\neq 0$.\nWe now split into cases on $g(2)$:\n\\begin{itemize}\n  \\ii $g(2) = 0$. Put $b = 2$ in original to get\n  $g(a+2) = \\pm g(a) = +g(a)$.\n  \\ii $g(2) = 2k$. Cases on $g(4)$:\n  \\begin{itemize}\n    \\ii $g(4) = 0$, then we get\n    $(g(n))_{n\\ge0} = (0,1,2,1,0,1,2,1,\\dots)$.  This works.\n    \\ii $g(4) = 4k$. This only happens when\n    $g(1) = k$, $g(2) = 2k$, $g(3) = 3k$, $g(4) = 4k$.\n    Then\n    \\begin{itemize}\n      \\ii $g(5) = \\pm 3k \\pm 2k = \\pm 4k \\pm k$.\n      \\ii $g(6) = \\pm4k \\pm 2k = \\pm5k \\pm k$.\n      \\ii \\dots\n    \\end{itemize}\n    and so by induction $g(n) = nk$.\n  \\end{itemize}\n\\end{itemize}\n\\pagebreak", "category": "Algebra", "source": "IMO", "year": 2012}
{"id": "imo-2012-q5", "question": "Let $ABC$ be a triangle with $\\angle BCA = 90\\dg$,\nand let $D$ be the foot of the altitude from $C$.\nLet $X$ be a point in the interior of the segment $CD$.\nLet $K$ be the point on the segment $AX$ such that $BK = BC$.\nSimilarly, let $L$ be the point on the segment $BX$ such that $AL = AC$.\nLet $M = \\ol{AL} \\cap \\ol{BK}$.\nProve that $MK = ML$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2737425}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle with $\\angle BCA = 90\\dg$,\nand let $D$ be the foot of the altitude from $C$.\nLet $X$ be a point in the interior of the segment $CD$.\nLet $K$ be the point on the segment $AX$ such that $BK = BC$.\nSimilarly, let $L$ be the point on the segment $BX$ such that $AL = AC$.\nLet $M = \\ol{AL} \\cap \\ol{BK}$.\nProve that $MK = ML$.\n\\end{mdframed}\nLet $\\omega_A$ and $\\omega_B$ be the circles through $C$\ncentered at $A$ and $B$;\nextend rays $AK$ and $BL$ to hit $\\omega_B$ and $\\omega_A$ again at $K^\\ast$, $L^\\ast$.\nBy radical center $X$,\nwe have $KLK^{\\ast}L^{\\ast}$ is cyclic,\nsay with circumcircle $\\omega$.\n\n\\begin{center}\n  \\begin{asy}\n    size(10cm);\n    pair A = Drawing(\"A\", dir(180), dir(225));\n    pair B = Drawing(\"B\", dir(0), dir(-45));\n    pair C = Drawing(\"C\", dir(140), 1.2*dir(110));\n    draw(A--B--C--cycle);\n    pair D = Drawing(\"D\", (C.x,0), dir(-90));\n    pair X = Drawing(\"X\", 0.55*C+0.45*D, dir(-80));\n\n    pair K = Drawing(\"K\", IP(A--X, Drawing(CP(B,C))), dir(-50));\n    pair L = Drawing(\"L\", IP(B--X, Drawing(CP(A,C))), dir(240));\n    pair K1= Drawing(\"K^\\ast\", 2*foot(B,A,K)-K, dir(60));\n    pair L1= Drawing(\"L^\\ast\", 2*foot(A,B,L)-L, dir(L-B));\n    draw(A--K1);\n    draw(B--L1);\n    draw(circumcircle(K,L,K1), dashed);\n\n    /*\n    pair O = Drawing(\"O\", circumcenter(K,L,K1), dir(90));\n    draw(A--O--B, dotted);\n    draw(O--D, dotted);\n    */\n\n    pair M = Drawing(\"M\", extension(A,L,B,K), dir(270));\n    draw(A--L, dotted);\n    draw(B--K, dotted);\n\n    clip((1.2,-0.4)--(1.2,2.3)--(-2.4,2.3)--(-2.4,-0.4)--cycle);\n  \\end{asy}\n\\end{center}\n\nBy orthogonality of $(A)$ and $(B)$ we find that\n$\\ol{AL}$, $\\ol{AL^\\ast}$,\n$\\ol{BK}$, $\\ol{BK^\\ast}$ are tangents to $\\omega$\n(in particular, $KLK^{\\ast}L^{\\ast}$ is harmonic).\nIn particular $\\ol{MK}$ and $\\ol{ML}$ are tangents to $\\omega$,\nso $MK = ML$.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2012}
{"id": "imo-2012-q6", "question": "Find all positive integers $n$\nfor which there exist non-negative integers $a_1, a_2, \\dots, a_n$\nsuch that\n\\[ \\frac{1}{2^{a_1}} + \\frac{1}{2^{a_2}} + \\dots + \\frac{1}{2^{a_n}}\n  = \\frac{1}{3^{a_1}} + \\frac{2}{3^{a_2}} + \\dots + \\frac{n}{3^{a_n}}\n  = 1. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2737435}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all positive integers $n$\nfor which there exist non-negative integers $a_1, a_2, \\dots, a_n$\nsuch that\n\\[ \\frac{1}{2^{a_1}} + \\frac{1}{2^{a_2}} + \\dots + \\frac{1}{2^{a_n}}\n  = \\frac{1}{3^{a_1}} + \\frac{2}{3^{a_2}} + \\dots + \\frac{n}{3^{a_n}}\n  = 1. \\]\n\\end{mdframed}\nThe answer is $n \\equiv 1, 2 \\pmod 4$.\nTo see these are necessary,\nnote that taking the latter equation modulo $2$ gives\n\\[ 1 = \\frac{1}{3^{a_1}} + \\frac{2}{3^{a_2}} + \\dots + \\frac{n}{3^{a_n}}\n\\equiv 1 + 2 + .. + n \\pmod 2. \\]\n\nNow we prove these are sufficient.\nThe following nice construction was posted on AOPS\nby the user \\texttt{cfheolpiixn}.\n\n\\begin{claim*}\n  If $n = 2k-1$ works then so does $n = 2k$.\n\\end{claim*}\n\\begin{proof}\n  Replace\n  \\[ \\frac{k}{3^r} = \\frac{k}{3^{r+1}} + \\frac{2k}{3^{r+1}}.\n    \\qquad(\\ast) \\qedhere \\]\n\\end{proof}\n\n\\begin{claim*}\n  If $n = 4k+2$ works then so does $n = 4k + 13$.\n\\end{claim*}\n\\begin{proof}\n  First use the identity\n  \\[\n    \\frac{k+2}{3^r} = \\frac{k+2}{3^{r+2}}\n    + \\frac{4k+ 3}{3^{r+3}}\n    + \\frac{4k+ 5}{3^{r+3}}\n    + \\frac{4k+ 7}{3^{r+3}}\n    + \\frac{4k+ 9}{3^{r+3}}\n    + \\frac{4k+11}{3^{r+3}}\n    + \\frac{4k+13}{3^{r+3}}\n  \\]\n  to fill in the odd numbers.\n  The even numbers can then be instantiated with $(\\ast)$ too.\n\\end{proof}\n\nThus it suffices to construct base cases\nfor $n = 1$, $n = 5$, $n = 9$.\nThey are\n\\begin{align*}\n  1 &= \\frac{1}{3^0} \\\\\n  &= \\frac{1}{3^2} + \\frac{2}{3^2} + \\frac{3}{3^2}\n    + \\frac{4}{3^3} + \\frac{5}{3^3} \\\\\n  &= \\frac{1}{3^2} + \\frac{2}{3^3} + \\frac{3}{3^3}\n  + \\frac{4}{3^3} + \\frac{5}{3^3} + \\frac{6}{3^4}\n  + \\frac{7}{3^4} + \\frac{8}{3^4} + \\frac{9}{3^4}.\n\\end{align*}\n\\pagebreak\n\n\n\\end{document}", "category": "Number Theory", "source": "IMO", "year": 2012}
{"id": "usamo-2001-q1", "question": "Each of eight boxes contains six balls.\nEach ball has been colored with one of $n$ colors,\nsuch that no two balls in the same box are the same color,\nand no two colors occur together in more than one box.\nFind with proof the smallest possible $n$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p337868}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nEach of eight boxes contains six balls.\nEach ball has been colored with one of $n$ colors,\nsuch that no two balls in the same box are the same color,\nand no two colors occur together in more than one box.\nFind with proof the smallest possible $n$.\n\\end{mdframed}\nThe answer is $n = 23$.\nShown below is a construction using that many colors,\nwhich we call $\\{1,2,\\dots,15,a,\\dots,f,X,Y\\}$.\n\\[\n  \\begin{bmatrix}\n    X & X & X & 1 & 2 & 3 & 4 & 5 \\\\\n    1 & 6 & 11 & 6 & 7 & 8 & 9 & 10 \\\\\n    2 & 7 & 12 & 11 & 12 & 13 & 14 & 15 \\\\\n    3 & 8 & 13 & Y & Y & Y & a & b \\\\\n    4 & 9 & 14 & a & c & e & c & d \\\\\n    5 & 10 & 15 & b & d & f & e & f\n  \\end{bmatrix}\n\\]\nWe present now two proofs that $n = 23$ is best possible.\nI think the first is more motivated --- it will\nactually show us how we could come up with the example above.\n\n\\paragraph{First solution (hands-on).}\nWe say a color $x$ is \\emph{overrated}\nif it is used at least three times.\nFirst we make the following smoothing argument.\n\\begin{claim*}\n  Suppose some box contains a ball of overrated color $x$\n  plus a ball of color $y$ used only once.\n  Then we can change one ball of color $x$ to color $y$\n  while preserving all the conditions.\n\\end{claim*}\n\\begin{proof}\n  Obvious.\n  (Though the color $x$ could cease to be overrated after this operation.)\n\\end{proof}\nBy applying this operation as many times as possible,\nwe arrive at a situation in which whenever we have\na box with an overrated color,\nthe other colors in the box are used twice or more.\n\nAssume now $n \\le 23$ and the assumption;\nwe will show the equality case must of the form we gave.\nSince there are a total of $48$ balls,\nat least two colors are overrated.\nLet $X$ be an overrated color and take three boxes where it appears.\nThen there are $15$ more distinct colors, say $\\{1, \\dots, 15\\}$\nlying in those boxes.\nEach of them must appear at least once more,\nso we arrive at the situation\n\\[\n  \\begin{bmatrix}\n    X & X & X & 1 & 2 & 3 & 4 & 5 \\\\\n    1 & 6 & 11 & 6 & 7 & 8 & 9 & 10 \\\\\n    2 & 7 & 12 & 11 & 12 & 13 & 14 & 15 \\\\\n    3 & 8 & 13 \\\\\n    4 & 9 & 14 \\\\\n    5 & 10 & 15 \\\\\n  \\end{bmatrix}\n\\]\nup to harmless permutation of the color names.\nNow, note that none of these $15$ colors can reappear.\nSo it remains to fill up the last five boxes.\n\nNow, there is at least one more overrated color,\ndistinct from any we have seen; call it $Y$.\nIn the three boxes $Y$ appears in,\nthere must be six new colors,\nand this gives the lower bound $n \\ge 1 + 15 + 1 + 6 = 23$\nwhich we sought,\nwith equality occurring as we saw above.\n\n\\begin{remark*}\n  [Partial progresses]\n  The fact that $\\binom{16}{2} = 120 = 8 \\binom{6}{2}$\n  (suggesting the bound $n \\ge 16$) is misleading\n  and not that helpful.\n\n  There is a simple argument showing that $n$\n  should be much larger than $16$.\n  Imagine opening the boxes in any order.\n  The first box must contain six new colors.\n  The second box must contain five new colors,\n  and so on; thus $n \\ge 6 + 5 + 4 + 3 + 2 + 1 = 21$.\n  This is sharp for seven boxes, as the example below shows.\n  \\[\n    \\begin{bmatrix}\n      1 & 1 & 2 & 3 & 4 & 5 & 6 \\\\\n      2 & 7 & 7 & 8 & 9 & 10 & 11 \\\\\n      3 & 8 & 12 & 12 & 13 & 14 & 15 \\\\\n      4 & 9 & 13 & 16 & 16 & 17 & 18 \\\\\n      5 & 10 & 14 & 17 & 19 & 19 & 20 \\\\\n      6 & 11 & 15 & 18 & 20 & 21 & 21\n    \\end{bmatrix}\n  \\]\n  However, one cannot add an eight box,\n  suggesting the answer should be a little larger than $21$.\n  One possible eight box is $\\{1,12,19,a,b,c\\}$\n  which gives $n \\le 24$; but the true answer is a little trickier.\n\\end{remark*}\n\n\\paragraph{Second solution (slick).}\nHere is a short proof from the official solutions of the bound.\nConsider the $8 \\times 6$ grid of colors as before.\nFor each ball $b$, count the number of times $n_b$ its color is used,\nand write the fraction $\\frac{1}{n_b}$.\n\nOn the one hand, we should have\n\\[ n = \\sum_{\\text{all $48$ balls $b$}} \\frac{1}{n_b}. \\]\nOn the other hand, for any given box $B$, we have\n$\\sum_{b \\in B} (n_b-1) \\le 7$, as among the other seven boxes\nat most one color from $B$ appears.\nTherefore, $\\sum_{b \\in B} n_b \\le 13$,\nand a smoothing argument this implies\n\\[ \\sum_{b \\in B} \\frac{1}{n_b} \\ge \\frac13 \\cdot 1 + \\frac12 \\cdot 5\n  = \\frac{17}{6}. \\]\nThus, $n \\ge 8 \\cdot \\frac{17}{6} = 22.66\\dots$, so $n \\ge 23$.\n\\pagebreak", "category": "Combinatorics", "source": "USAMO", "year": 2001}
{"id": "usamo-2001-q2", "question": "Let $ABC$ be a triangle and let $\\omega$ be its incircle.\nDenote by $D_1$ and $E_1$ the points where $\\omega$\nis tangent to sides $BC$ and $AC$, respectively.\nDenote by $D_2$ and $E_2$ the points on sides $BC$ and $AC$,\nrespectively, such that $CD_2=BD_1$ and $CE_2=AE_1$,\nand denote by $P$ the point of intersection of segments $AD_2$ and $BE_2$.\nCircle $\\omega$ intersects segment $AD_2$ at two points,\nthe closer of which to the vertex $A$ is denoted by $Q$.\nProve that $AQ=D_2P$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p337870}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle and let $\\omega$ be its incircle.\nDenote by $D_1$ and $E_1$ the points where $\\omega$\nis tangent to sides $BC$ and $AC$, respectively.\nDenote by $D_2$ and $E_2$ the points on sides $BC$ and $AC$,\nrespectively, such that $CD_2=BD_1$ and $CE_2=AE_1$,\nand denote by $P$ the point of intersection of segments $AD_2$ and $BE_2$.\nCircle $\\omega$ intersects segment $AD_2$ at two points,\nthe closer of which to the vertex $A$ is denoted by $Q$.\nProve that $AQ=D_2P$.\n\\end{mdframed}\nWe have that $P$ is the Nagel point\n\\[ P = \\left( s-a : s-b : s-c \\right). \\]\nTherefore,\n\\[ \\frac{PD_2}{AD_2} = \\frac{s-a}{(s-a)+(s-b)+(s-c)} = \\frac{s-a}{s}. \\]\nMeanwhile, $Q$ is the antipode of $D_1$.\nThe classical homothety at $A$ mapping $Q$ to $D_1$\n(by mapping the incircle to the $A$-excircle)\nhas ratio $\\frac{s-a}{s}$ as well\n(by considering the length of the tangents from $A$),\nso we are done.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2001}
{"id": "usamo-2001-q3", "question": "Let $a, b, c$ be nonnegative real numbers\nsuch that $a^2+b^2+c^2 + abc = 4$.\nShow that \\[ 0 \\le ab + bc + ca - abc \\le 2. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p96705}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a, b, c$ be nonnegative real numbers\nsuch that $a^2+b^2+c^2 + abc = 4$.\nShow that \\[ 0 \\le ab + bc + ca - abc \\le 2. \\]\n\\end{mdframed}\nThe left-hand side of the inequality is trivial;\njust note that $\\min \\left\\{ a,b,c \\right\\} \\le 1$.\nHence, we focus on the right side.\nWe use Lagrange Multipliers.\n\nDefine \\[ U = \\left\\{ (a,b,c) \\mid a,b,c > 0\n  \\text{ and } a^2+b^2+c^2 < 1000 \\right\\}. \\]\nThis is an intersection of open sets, so it is open.\nIts closure is\n\\[ \\ol U = \\left\\{ (a,b,c) \\mid a,b,c \\ge 0\n\\text{ and } a^2+b^2+c^2 \\le 1000 \\right\\}. \\]\nHence the constraint set\n\\[ \\ol S = \\left\\{ \\mathbf{x} \\in \\ol U \\mid g(\\mathbf{x}) = 4 \\right\\} \\]\nis compact, where $g(a,b,c) = a^2+b^2+c^2+abc$.\n\nDefine \\[ f(a,b,c) = a^2+b^2+c^2+ab+bc+ca. \\]\nIt's equivalent to show that $f \\le 6$ subject to $g$.\nOver $\\ol S$, it must achieve a global maximum.\nNow we consider two cases.\n\nIf $\\mathbf{x}$ lies on the boundary,\nthat means one of the components is zero\n(since $a^2+b^2+c^2=1000$ is clearly impossible).\nWLOG $c=0$, then we wish to show $a^2+b^2+ab \\le 6$\nfor $a^2+b^2=4$, which is trivial.\n\nNow for the interior $U$, we may use the method of Lagrange Multipliers.\nConsider a local maximum $\\mathbf{x} \\in U$.\nCompute \\[ \\nabla f = \\left<2a+b+c, 2b+c+a, 2c+a+b \\right> \\]\nand \\[ \\nabla g = \\left<2a+bc, 2b+ca, 2c+ab\\right>. \\]\nOf course, $\\nabla g \\neq \\mathbf 0$ everywhere,\nso introducing our multiplier yields\n\\[ \\left<2a+b+c,a+2b+c,a+b+2c\\right> = \\lambda \\left<2a+bc,2b+ca,2c+ab\\right>. \\]\nNote that $\\lambda \\neq 0$ since $a,b,c > 0$.\nSubtracting $2a+b+c = \\lambda(2a+bc)$ from $a+2b+c = \\lambda(2b+ca)$\nimplies that \\[ (a-b)(\\left[ 2\\lambda - 1 \\right] - \\lambda c) = 0. \\]\nWe can derive similar equations for the others.\nHence, we have three cases.\n\\begin{enumerate}\n  \\ii If $a=b=c$, then $a=b=c=1$, and this satisfies $f(1,1,1) \\le 6$.\n  \\ii If $a$, $b$, $c$ are pairwise distinct,\n  then we derive $a = b = c = 2 - \\lambda^{-1}$, contradiction.\n  \\ii Now suppose that $a=b \\neq c$.\n\n  Meanwhile, the constraint (with $a=b$) reads\n  \\begin{align*}\n    a^2+b^2+c^2+abc=4\n    &\\iff c^2 + a^2c + (2a^2-4) = 0 \\\\\n    &\\iff (c+2)(c-(2-a^2)) = 0\n  \\end{align*}\n  which since $c > 0$ gives $c = 2-a^2$.\n\n  Noah Walsh points out that at this point,\n  we don't need to calculate the critical point;\n  we just directly substitute $a=b$ and $c=2-a^2$ into\n  the desired inequality:\n  \\[ a^2+2a(2-a^2)-a^2(2-a^2) = (a-1)^2(a^2-2) + 2 \\le 2 \\]\n  since $a \\le \\sqrt 2$.\n  So any point here satisfies the inequality anyways.\n\\end{enumerate}\n\\begin{remark*}\n  It can actually be shown that the critical point\n  in the third case we skipped is pretty close: it is given by\n  \\[ a = b = \\frac{1+\\sqrt{17}}{4}\n    \\quad c = \\frac{1}{8} \\left( 7 - \\sqrt{17} \\right). \\]\n  This satisfies\n  \\[ f(a,b,c) = 3a^2+2ac+c^2\n    = \\frac{1}{32} \\left( 121 + 17\\sqrt{17} \\right)\n    \\approx 5.97165 \\]\n  which is just a bit less than $6$.\n\\end{remark*}\n\\begin{remark*}\n  Equality holds for the upper bound if $(a,b,c)=(1,1,1)$\n  or $(a,b,c)=(\\sqrt2,\\sqrt2,0)$ and permutations.\n  The lower bound is achieved if $(a,b,c)=(2,0,0)$ and permutations.\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Algebra", "source": "USAMO", "year": 2001}
{"id": "usamo-2001-q4", "question": "Let $ABC$ be a triangle and $P$ any point\nsuch that $PA$, $PB$, $PC$ are the sides of an obtuse triangle,\nwith $PA$ the longest side.\nProve that $\\angle BAC$ is acute.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p337872}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle and $P$ any point\nsuch that $PA$, $PB$, $PC$ are the sides of an obtuse triangle,\nwith $PA$ the longest side.\nProve that $\\angle BAC$ is acute.\n\\end{mdframed}\nUsing Ptolemy's inequality and Cauchy-Schwarz,\n\\begin{align*}\n  PA \\cdot BC\n  &\\le PB \\cdot AC + PC \\cdot AB \\\\\n  &\\le \\sqrt{(PB^2+PC^2)(AB^2+AC^2)} \\\\\n  &< \\sqrt{PA^2 \\cdot (AB^2+AC)^2} = PA \\cdot \\sqrt{AB^2+AC^2}\n\\end{align*}\nmeaning $BC^2 < AB^2+AC^2$, so $\\angle BAC$ is acute.\n\n\\begin{remark*}\n  [Lokman G\\\"{o}k\\c{c}e]\n  Here is another approach using Euler's quadrilateral formula.\n  Let $M$ and $N$ be midpoints of $AP$ and $BC$, respectively.\n  For the points $A$, $B$, $P$, $C$; apply Euler's quadrilateral formula to get\n  \\[ AB^2 + BP^2 + PC^2 + CA^2 = AP^2 + BC^2 + 4MN^2 \\geq AP^2 + BC^2. \\]\n  We are given that $AP^2 > BP^2 + PC^2$, so $AB^2 + AC^2 > BC^2$,\n  and we get $\\angle BAC$ is acute.\n\\end{remark*}\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2001}
{"id": "usamo-2001-q5", "question": "Let $S \\subseteq \\ZZ$ be such that:\n\\begin{enumerate}\n  \\ii[(a)] there exist $a,b \\in S$ with\n  $\\gcd(a,b) = \\gcd(a-2, b-2) = 1$;\n  \\ii[(b)] if $x$ and $y$ are elements of $S$ (possibly equal),\n  then $x^2-y$ also belongs to $S$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p337875}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $S \\subseteq \\ZZ$ be such that:\n\\begin{enumerate}\n  \\ii[(a)] there exist $a,b \\in S$ with\n  $\\gcd(a,b) = \\gcd(a-2, b-2) = 1$;\n  \\ii[(b)] if $x$ and $y$ are elements of $S$ (possibly equal),\n  then $x^2-y$ also belongs to $S$.\n\\end{enumerate}\nProve that $S = \\ZZ$.\n\\end{mdframed}\nCall an integer $d > 0$ \\emph{shifty} if\n$S = S+d$ (meaning $S$ is invariant under shifting by $d$).\n\nFirst, note that if $u, v \\in S$, then for any $x \\in S$,\n\\[ v^2 - (u^2-x) = (v^2-u^2) + x \\in S. \\]\nSince we can easily check that $|S| > 1$\nand $S \\neq \\{n, -n\\}$ we conclude there exists a shifty integer.\n\nWe claim $1$ is shifty, which implies the problem.\nAssume for contradiction that $1$ is not shifty.\nThen for GCD reasons the set of shifty integers must be $d \\ZZ$ for some $d \\ge 2$.\n\n\\begin{claim*}\n  We have $S \\subseteq \\left\\{ x : x^2 \\equiv m \\pmod d \\right\\}$ for some fixed $m$.\n\\end{claim*}\n\\begin{proof}\n  Otherwise if we take any $p,q \\in S$ with distinct squares modulo $d$,\n  then $q^2-p^2 \\not\\equiv 0 \\pmod d$ is shifty, which is impossible.\n\\end{proof}\n\nNow take $a,b \\in S$ as in (a).\nIn that case we need to have\n\\[ a^2 \\equiv b^2 \\equiv (a^2-a)^2 \\equiv (b^2-b)^2 \\pmod d. \\]\nPassing to a prime $p \\mid d$, we have the following:\n\\begin{itemize}\n  \\ii Since $a^2 \\equiv (a^2-a)^2 \\pmod p$ or equivalently $a^3(a-2) \\equiv 0 \\pmod p$,\n  either $a \\equiv 0 \\pmod p$ or $a \\equiv 2 \\pmod p$.\n  \\ii Similarly, either $b \\equiv 0 \\pmod p$ or $b \\equiv 2 \\pmod p$.\n  \\ii Since $a^2 \\equiv b^2 \\pmod p$, or $a \\equiv \\pm b \\pmod p$, we find either\n  $a \\equiv b \\equiv 0 \\pmod p$ or $a \\equiv b \\equiv 2 \\pmod p$ (even if $p=2$).\n\\end{itemize}\nThis is a contradiction.\n\n\\begin{remark*}\n  The condition (a) cannot be dropped, since otherwise we may take\n  $S = \\left\\{ 2 \\pmod p \\right\\}$ or $S = \\left\\{ 0 \\pmod p \\right\\}$, say.\n\\end{remark*}\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 2001}
{"id": "usamo-2001-q6", "question": "Each point in the plane is assigned a real number.\nSuppose that for any nondegenerate triangle, the number at its incenter\nis the arithmetic mean of the three numbers at its vertices.\nProve that all points in the plane are equal to each other.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p337877}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nEach point in the plane is assigned a real number.\nSuppose that for any nondegenerate triangle, the number at its incenter\nis the arithmetic mean of the three numbers at its vertices.\nProve that all points in the plane are equal to each other.\n\\end{mdframed}\nFirst, we claim that in an isosceles trapezoid $ABCD$ we have $a+c=b+d$.\nIndeed, suppose WLOG that rays $BA$ and $CD$ meet at $X$.\nThen triangles $XAC$ and $XBD$ share an incircle, proving the claim.\n\nNow, given any two points $A$ and $B$, construct regular pentagon $ABCDE$.\nWe have $a+c=b+d=c+e=d+a=e+b$, so $a=b=c=d=e$.\n\\pagebreak\n\n\n\\end{document}", "category": "Geometry", "source": "USAMO", "year": 2001}
{"id": "putnam-2008-a1", "question": "Let $f: \\mathbb{R}^2 \\to \\mathbb{R}$ be a function such that $f(x,y) + f(y,z)\n+ f(z,x) = 0$ for all real numbers $x$, $y$, and $z$. Prove that there exists\na function $g: \\mathbb{R} \\to \\mathbb{R}$ such that $f(x,y) = g(x) - g(y)$\nfor all real numbers $x$ and $y$.", "solution": "The function $g(x) = f(x,0)$ works. Substituting $(x,y,z) = (0,0,0)$ into the given functional equation yields $f(0,0) = 0$, whence substituting $(x,y,z) = (x,0,0)$ yields $f(x,0)+f(0,x)=0$. Finally, substituting $(x,y,z) = (x,y,0)$ yields $f(x,y) = -f(y,0)-f(0,x) = g(x)-g(y)$.\n\n\\textbf{Remark:} A similar argument shows that the possible functions $g$\nare precisely those of the form  $f(x,0) + c$ for some $c$.", "category": "Algebra", "source": "PUTNAM", "year": 2008}
{"id": "putnam-2008-a2", "question": "Alan and Barbara play a game in which they take turns filling entries of\nan initially empty $2008 \\times 2008$ array. Alan plays first. At each\nturn, a player chooses a real number and places it in a vacant entry.\nThe game ends when all the entries are filled. Alan wins if the\ndeterminant of the resulting matrix is nonzero; Barbara wins if it is zero.\nWhich player has a winning strategy?", "solution": "Barbara wins using one of the following strategies.\n\n\\textbf{First solution:}\nPair each entry of the first row with the entry directly below it in\nthe second row. If Alan ever writes a number in one of the first two\nrows, Barbara writes the same number in the other entry in the pair.\nIf Alan writes a number anywhere other than the first two rows, Barbara\ndoes likewise.\nAt the end, the resulting matrix will have two identical rows, so its\ndeterminant will be zero.\n\n\\textbf{Second solution:} (by Manjul Bhargava)\nWhenever Alan writes a number $x$ in an entry in some row, Barbara writes\n$-x$ in some other entry in the same row.\nAt the end, the resulting matrix will have all rows summing to zero,\nso it cannot have full rank.", "category": "Algebra", "source": "PUTNAM", "year": 2008}
{"id": "putnam-2008-a3", "question": "Start with a finite sequence $a_1, a_2, \\dots, a_n$ of positive integers.\nIf possible, choose two indices $j < k$ such that $a_j$ does not divide\n$a_k$, and replace $a_j$ and $a_k$ by $\\mathrm{gcd}(a_j, a_k)$\nand $\\mathrm{lcm}(a_j, a_k)$, respectively. Prove that if this process is\nrepeated, it must eventually stop and the final sequence does not depend\non the choices made. (Note: gcd means greatest common divisor and lcm\nmeans least common multiple.)", "solution": "We first prove that the process stops. Note first that the product\n$a_1 \\cdots a_n$ remains constant, because\n$a_j a_k = \\gcd(a_j, a_k) \\lcm(a_j, a_k)$. Moreover,\nthe last number in the sequence can never decrease, because it is always\nreplaced by its least common multiple with another number.\nSince it is bounded above (by the product\nof all of the numbers), the last number must eventually reach its\nmaximum value, after which it remains constant throughout. After this\nhappens, the next-to-last number will never decrease, so it eventually\nbecomes constant, and so on. After finitely many steps, all of the numbers\nwill achieve their final values, so\nno more steps will be possible. This only happens when\n$a_j$ divides $a_k$ for all pairs $j < k$.\n\nWe next check that there is only one possible final sequence.\nFor $p$ a prime and $m$ a nonnegative integer, we claim that the number\nof integers in the list divisible by $p^m$ never changes. To see this,\nsuppose we replace $a_j, a_k$ by $\\gcd(a_j, a_k),\\lcm(a_j,a_k)$.\nIf neither of $a_j, a_k$ is divisible by $p^m$, then neither of\n$\\gcd(a_j, a_k),\\lcm(a_j,a_k)$ is either.\nIf exactly one $a_j, a_k$ is divisible by $p^m$, then\n$\\lcm(a_j,a_k)$ is divisible by $p^m$ but $\\gcd(a_j, a_k)$ is not.\n\n$\\gcd(a_j, a_k),\\lcm(a_j,a_k)$ are as well.\n\nIf we started out with exactly $h$ numbers not divisible by $p^m$,\nthen in the final sequence $a'_1, \\dots, a'_n$, the numbers\n$a'_{h+1}, \\dots, a'_n$ are divisible by $p^m$ while the numbers\n$a'_1, \\dots, a'_h$ are not. Repeating this argument for each\npair $(p,m)$ such that $p^m$ divides the initial product\n$a_1,\\dots,a_n$, we can determine the exact prime factorization\nof each of $a'_1,\\dots,a'_n$. This proves that the final sequence\nis unique.\n\n\\textbf{Remark:}\n(by David Savitt and Noam Elkies)\nHere are two other ways to prove the termination.\nOne is to observe that $\\prod_j a_j^j$\nis \\emph{strictly} increasing at each step, and bounded above by\n$(a_1\\cdots a_n)^n$. The other is to notice that $a_1$ is nonincreasing\nbut always positive, so eventually becomes constant; then\n$a_2$ is nonincreasing but always positive, and so on.\n\n\\textbf{Reinterpretation:}\nFor each $p$, consider the sequence consisting of the\nexponents of $p$ in the prime factorizations of $a_1,\\dots,a_n$.\nAt each step, we pick two positions $i$ and $j$ such that the exponents\nof some prime $p$ are in the wrong order at positions $i$ and $j$.\nWe then sort these two position into the correct order for every prime $p$\nsimultaneously.\n\nIt is clear that this can only terminate with all sequences being sorted\ninto the correct order. We must still check that the process terminates;\nhowever, since all but finitely many of the exponent\nsequences consist of all zeroes,\nand each step makes a nontrivial switch in at least one of the other exponent\nsequences, it is enough to check the case of a single exponent sequence.\nThis can be done as in the first solution.\n\n\\textbf{Remark:}\nAbhinav Kumar suggests the following proof that the process always terminates\nin at most  $\\binom{n}{2}$ steps.\n(This is a variant of the worst-case analysis of the \\emph{bubble sort}\nalgorithm.)\n\nConsider the number of pairs $(k,l)$\nwith $1 \\leq k < l \\leq n$ such that $a_k$ does not divide $a_l$\n(call these \\emph{bad pairs}).\nAt each step, we find one bad pair $(i,j)$ and eliminate it, and we do not\ntouch any pairs that do not involve either $i$ or $j$.\nIf $i < k < j$, then neither of the pairs $(i,k)$ and $(k,j)$ can become\nbad,\nbecause $a_i$ is replaced by a divisor of itself, while $a_j$ is replaced by\na multiple of itself. If $k < i$, then $(k,i)$ can only become a bad pair if\n$a_k$ divided $a_i$ but not $a_j$, in which case $(k,j)$ stops being bad.\nSimilarly, if $k > j$, then $(i,k)$ and $(j,k)$\neither stay the same or switch status. Hence the number of bad pairs\ngoes down by at least 1 each time; since it is at most $\\binom{n}{2}$\nto begin with, this is an upper bound for the number of steps.\n\n\\textbf{Remark:}\nThis problem is closely related to the classification theorem for\nfinite abelian groups. Namely, if $a_1,\\dots,a_n$\nand $a'_1,\\dots,a'_n$ are the sequences obtained at two different\nsteps in the process, then the abelian groups\n$\\ZZ/a_1 \\ZZ \\times \\cdots \\times \\ZZ/a_n \\ZZ$\nand\n$\\ZZ/a'_1 \\ZZ \\times \\cdots \\times \\ZZ/a'_n \\ZZ$\nare isomorphic. The final sequence gives a canonical\npresentation of this group; the terms of this sequence are called the\n\\emph{elementary divisors} or \\emph{invariant factors} of the group.\n\n\\textbf{Remark:} (by Tom Belulovich)\nA \\emph{lattice} is a partially ordered set $L$ in which for\nany two $x,y \\in L$, there is a unique minimal element $z$ with $z \\geq\nx$ and $z \\geq y$, called the \\emph{join} and denoted $x \\wedge y$,\nand there is a unique maximal element $z$ with $z \\leq x$ and $z \\leq y$,\ncalled the \\emph{meet} and denoted $x \\vee y$. In terms of a lattice $L$,\none can pose the following generalization of the given problem.\nStart with $a_1,\\dots,a_n \\in L$. If $i < j$ but $a_i \\not\\leq a_j$,\nit is permitted to replace $a_i, a_j$ by $a_i \\vee a_j, a_i \\wedge a_j$,\nrespectively. The same argument as above shows that this always terminates\nin at most $\\binom{n}{2}$ steps. The question is, under what conditions on\nthe lattice $L$ is the final sequence uniquely determined by the initial\nsequence?\n\nIt turns out that this holds if and only if $L$ is \\emph{distributive},\ni.e., for any $x,y,z \\in L$,\n\\[\nx \\wedge (y \\vee z)\n= (x \\wedge y) \\vee (x \\wedge z).\n\\]\n(This is equivalent to the same axiom with the operations interchanged.)\nFor example, if $L$ is a \\emph{Boolean algebra}, i.e., the set of subsets\nof a given set $S$ under inclusion, then $\\wedge$ is union, $\\vee$\nis intersection, and the distributive law holds.\nConversely, any finite\ndistributive lattice is contained in a Boolean algebra by a theorem of\nBirkhoff. The correspondence takes each  $x \\in L$ to the set of\n$y \\in L$ such that $x \\geq y$ and $y$ cannot be written as a join\nof two elements of $L \\setminus \\{y\\}$. (See for instance\nBirkhoff, \\textit{Lattice Theory}, Amer. Math. Soc., 1967.)\n\nOn one hand, if $L$ is distributive, it can be shown that the $j$-th term\nof the final sequence is equal to the meet of $a_{i_1} \\wedge \\cdots\n\\wedge a_{i_j}$ over all sequences $1 \\leq i_1 < \\cdots < i_j \\leq n$.\nFor instance, this can be checked by forming the smallest subset $L'$\nof $L$ containing $a_1,\\dots,a_n$ and closed under meet and join,\nthen embedding $L'$ into a Boolean algebra using\nBirkhoff's theorem, then checking the claim for all Boolean algebras.\nIt can also be checked directly (as suggested by Nghi Nguyen)\nby showing that for $j=1,\\dots,n$,\nthe meet of all joins of $j$-element subsets of $a_1,\\dots,a_n$ is\ninvariant at each step.\n\nOn the other hand,\na lattice fails to be distributive if and only if\nit contains five elements $a,b,c,0,1$ such that either the only relations\namong them are implied by\n\\[\n1 \\geq a,b,c \\geq 0\n\\]\n(this lattice is sometimes called the \\emph{diamond}),\nor the only relations among them  are implied by\n\\[\n1 \\geq a \\geq b \\geq 0, \\qquad 1 \\geq c \\geq 0\n\\]\n(this lattice is sometimes called the \\emph{pentagon}).\n(For a proof, see the Birkhoff reference given above.) For each of these\nexamples, the initial sequence $a,b,c$ fails to determine the final\nsequence; for the diamond, we can end up with $0, *, 1$ for\nany of $* = a,b,c$, whereas for the pentagon we can end up with\n$0, *, 1$ for any of $* = a, b$.\n\nConsequently, the final sequence is determined by the initial sequence\nif and only if $L$ is distributive.", "category": "Number Theory", "source": "PUTNAM", "year": 2008}
{"id": "putnam-2008-a4", "question": "Define $f: \\mathbb{R} \\to \\mathbb{R}$ by\n\\[\nf(x) = \\begin{cases} x & \\mbox{if $x \\leq e$} \\\\ x f(\\ln x) &\n\\mbox{if $x > e$.} \\end{cases}\n\\]\nDoes $\\sum_{n=1}^\\infty \\frac{1}{f(n)}$ converge?", "solution": "The sum diverges. From the definition, $f(x) = x$ on $[1,e]$, $x\\ln x$ on $(e,e^e]$, $x\\ln x\\ln\\ln x$ on $(e^e,e^{e^e}]$, and so forth. It follows that on $[1,\\infty)$, $f$ is positive, continuous, and increasing. Thus $\\sum_{n=1}^\\infty \\frac{1}{f(n)}$, if it converges, is bounded below by $\\int_1^{\\infty} \\frac{dx}{f(x)}$; it suffices to prove that the integral diverges.\n\nWrite $\\ln^1 x  = \\ln x $ and $\\ln^k x = \\ln(\\ln^{k-1} x)$ for $k \\geq 2$; similarly write $\\exp^1 x = e^x$ and $\\exp^k x  = e^{\\exp^{k-1} x}$. If we write $y = \\ln^k x$, then $x = \\exp^k y$ and $dx = (\\exp^ky)(\\exp^{k-1}y)\\cdots (\\exp^1y)dy =\nx(\\ln^1 x) \\cdots (\\ln^{k-1}x)dy$. Now on\n$[\\exp^{k-1} 1,\\exp^k 1]$, we have\n$f(x) = x(\\ln^1 x) \\cdots (\\ln^{k-1}x)$, and thus substituting $y=\\ln^k x$ yields\n\\[\n\\int_{\\exp^{k-1} 1}^{\\exp^k 1} \\frac{dx}{f(x)} =\n\\int_{0}^{1} dy = 1.\n\\]\nIt follows that $\\int_1^{\\infty} \\frac{dx}{f(x)} = \\sum_{k=1}^{\\infty} \\int_{\\exp^{k-1} 1}^{\\exp^k 1} \\frac{dx}{f(x)}$ diverges, as desired.", "category": "Algebra", "source": "PUTNAM", "year": 2008}
{"id": "putnam-2008-a5", "question": "Let $n \\geq 3$ be an integer. Let $f(x)$ and $g(x)$ be polynomials\nwith real coefficients such that the points\n$(f(1), g(1)), (f(2), g(2)), \\dots, (f(n), g(n))$\nin $\\mathbb{R}^2$ are the vertices of a regular $n$-gon in\ncounterclockwise order. Prove that at least one of $f(x)$\nand $g(x)$ has degree greater than or equal to $n-1$.", "solution": "Form the polynomial $P(z) = f(z) + i g(z)$ with complex coefficients.\nIt suffices to prove that $P$ has degree at least $n-1$, as then one\nof $f, g$ must have degree at least $n-1$.\n\nBy replacing $P(z)$ with $a P(z) + b$ for suitable $a,b \\in \\CC$,\nwe can force the regular $n$-gon to have vertices\n$\\zeta_n, \\zeta_n^2, \\dots, \\zeta_n^n$ for\n$\\zeta_n = \\exp(2 \\pi i/n)$. It thus suffices to check that\nthere cannot exist a polynomial $P(z)$ of degree at most $n-2$\nsuch that $P(i) = \\zeta_n^i$ for $i=1,\\dots,n$.\n\nWe will prove more generally that for any complex number\n$t \\notin \\{0,1\\}$, and any integer $m \\geq 1$,\nany polynomial $Q(z)$ for which\n$Q(i) = t^i$ for $i=1,\\dots,m$ has degree at least $m-1$.\nThere are several ways to do this.\n\n\\textbf{First solution:}\nIf $Q(z)$ has degree $d$ and leading coefficient $c$,\nthen $R(z) = Q(z+1) - t Q(z)$ has degree $d$ and leading coefficient $(1-t)c$.\nHowever, by hypothesis, $R(z)$ has the distinct roots\n$1,2,\\dots,m-1$, so we must have $d \\geq m-1$.\n\n\\textbf{Second solution:}\nWe proceed by induction on $m$.\nFor the base case $m=1$, we have $Q(1) = t^1 \\neq 0$,\nso $Q$ must be nonzero, and so its degree is at least $0$.\nGiven the assertion for $m-1$, if $Q(i) = t^i$ for $i=1,\\dots,m$,\nthen the polynomial $R(z) = (t-1)^{-1} (Q(z+1) - Q(z))$ has degree\none less than that of $Q$,\nand satisfies $R(i) = t^i$ for $i=1,\\dots,m-1$. Since $R$ must have\ndegree at least $m-2$ by the induction hypothesis, $Q$ must have\ndegree at least $m-1$.\n\n\\textbf{Third solution:}\nWe use the method of \\emph{finite differences} (as in the second\nsolution) but without induction. Namely,\nthe $(m-1)$-st finite difference\nof $P$ evaluated at 1 equals\n\\[\n\\sum_{j=0}^{m-1} (-1)^j \\binom{m-1}{j} Q(m-j)\n= t(1 - t)^{m-1} \\neq 0,\n\\]\nwhich is impossible if $Q$ has degree less than $m-1$.\n\n\\textbf{Remark:} One can also establish the claim by computing\na Vandermonde-type determinant, or by using the Lagrange interpolation\nformula to compute the leading coefficient of $Q$.", "category": "Geometry", "source": "PUTNAM", "year": 2008}
{"id": "putnam-2008-a6", "question": "Prove that there exists a constant $c>0$ such that in every\nnontrivial finite group $G$ there exists a sequence of length\nat most $c \\log |G|$ with the property that each element of $G$\nequals the product of some subsequence. (The elements of $G$ in the\nsequence are not required to be distinct. A \\emph{subsequence}\nof a sequence is obtained by selecting some of the terms,\nnot necessarily consecutive, without reordering them; for\nexample, $4, 4, 2$ is a subsequence of $2, 4, 6, 4, 2$, but\n$2, 2, 4$ is not.)", "solution": "For notational convenience, we will interpret the problem as\nallowing the empty subsequence, whose product is the identity element of\nthe group. To solve the problem in the interpretation where the empty\nsubsequence is not allowed, simply append the identity element to the sequence\ngiven by one of the following solutions.\n\n\\textbf{First solution:}\nPut $n = |G|$.\nWe will say that a sequence $S$ \\emph{produces}\nan element $g \\in G$ if $g$ occurs as the product of some subsequence\nof $S$.\nLet $H$ be the set of elements produced by the sequence $S$.\n\nStart with $S$ equal to the empty sequence. If at any point\nthe set $H^{-1}H = \\{h_1 h_2: h_1^{-1}, h_2 \\in H\\}$ fails to be\nall of $G$, extend $S$ by appending an element $g$ of $G$ not in\n$H^{-1} H$. Then $Hg \\cap H$ must be empty, otherwise there would\nbe an equation of the form $h_1 g= h_2 $ with $h_1, h_2 \\in G$,\nor $g = h_1^{-1} h_2$, a contradiction. Thus we can extend $S$ by one\nelement and double the size of $H$.\n\nAfter $k \\leq \\log_2 n$ steps, we must obtain a sequence $S\n= a_1,\\dots,a_k$ for which $H^{-1} H = G$. Then\nthe sequence $a_k^{-1}, \\dots, a_1^{-1}, a_1, \\dots, a_k$\nproduces all of $G$ and has length at most $(2/\\ln 2) \\ln n$.\n\n\\textbf{Second solution:}\n\nPut $m = |H|$. We will show that we can append one element\n$g$ to $S$ so that the resulting sequence of $k+1$ elements will produce\nat least $2m-m^2/n$ elements of $G$. To see this, we compute\n\\begin{align*}\n\\sum_{g \\in G} |H \\cup Hg|\n&= \\sum_{g \\in G} (|H| + |Hg| - |H \\cap Hg|) \\\\\n&= 2mn - \\sum_{g \\in G} |H \\cap Hg| \\\\\n&= 2mn - |\\{(g,h) \\in G^2: h \\in H \\cap Hg\\}| \\\\\n&= 2mn - \\sum_{h \\in H} |\\{g \\in G: h \\in Hg\\}| \\\\\n&= 2mn - \\sum_{h \\in H} |H^{-1} h| \\\\\n&= 2mn - m^2.\n\\end{align*}\nBy the pigeonhole principle, we have $|H \\cup Hg| \\geq 2m - m^2/n$ for\nsome choice of $g$, as claimed.\n\nIn other words, by extending the sequence by one element,\nwe can replace the ratio $s = 1-m/n$ (i.e., the fraction\nof elements of $G$ not generated by $S$)\nby a quantity no greater than\n\\[\n1-(2m-m^2/n)/n = s^2.\n\\]\nWe start out with $k = 0$ and $s = 1 - 1/n$;\nafter $k$ steps, we have $s \\leq (1-1/n)^{2^k}$.\nIt is enough to prove that for some $c > 0$, we can always find\nan integer $k \\leq c \\ln n$ such that\n\\[\n\\left(1 - \\frac{1}{n} \\right)^{2^k} < \\frac{1}{n},\n\\]\nas then we have $n-m < 1$ and hence $H = G$.\n\nTo obtain this last inequality, put\n\\[\nk = \\lfloor 2 \\log_2 n \\rfloor < (2/\\ln 2) \\ln n,\n\\]\nso that $2^{k+1} \\geq n^2$.\nFrom the facts that $\\ln n \\leq \\ln 2 + (n-2)/2 \\leq n/2$ and\n$\\ln (1-1/n) < -1/n$ for all $n \\geq 2$, we have\n\\[\n2^k \\ln \\left( 1 - \\frac{1}{n} \\right) < -\\frac{n^2}{2n} =  -\\frac{n}{2} < -\\ln n,\n\\]\nyielding the desired inequality.\n\n\\textbf{Remark:} An alternate approach in the second solution\nis to distinguish betwen the cases of $H$ small (i.e.,\n$m < n^{1/2}$, in which case $m$ can be replaced by a value\nno less than $2m-1$) and $H$ large.\nThis strategy is used in a number of recent results\nof Bourgain, Tao, Helfgott, and others on \\emph{small doubling}\nor \\emph{small tripling}\nof subsets of finite groups.\n\nIn the second solution, if we avoid the rather weak inequality\n$\\ln n \\leq n/2$, we instead get sequences of length\n$\\log_2 (n \\ln n) = \\log_2(n) + \\log_2 (\\ln n)$.\nThis is close to optimal: one cannot use fewer than $\\log_2 n$\nterms because the number of subsequences must be at least $n$.", "category": "Combinatorics", "source": "PUTNAM", "year": 2008}
{"id": "putnam-2008-b1", "question": "What is the maximum number of rational points that can lie on a circle\nin $\\mathbb{R}^2$ whose center is not a rational point? (A \\emph{rational\npoint} is a point both of whose coordinates are rational numbers.)", "solution": "There are at most two such points. For example,\nthe points $(0,0)$ and $(1,0)$ lie on a circle with center\n$(1/2, x)$ for any real number $x$, not necessarily rational.\n\nOn the other hand, suppose $P = (a,b), Q = (c,d), R = (e,f)$\nare three rational points that lie\non a circle. The midpoint $M$ of the side $PQ$ is\n$((a+c)/2, (b+d)/2)$, which is again rational. Moreover, the slope\nof the line $PQ$ is $(d-b)/(c-a)$, so the slope of the line through\n$M$ perpendicular to $PQ$ is $(a-c)/(b-d)$, which is rational or infinite.\n\nSimilarly, if $N$ is the midpoint of $QR$, then $N$ is a rational point\nand the line through $N$ perpendicular to $QR$ has rational slope.\nThe center of the circle lies on both of these lines, so its\ncoordinates $(g,h)$ satisfy two linear equations with rational\ncoefficients, say $Ag + Bh = C$ and $Dg + Eh = F$. Moreover,\nthese equations have a unique solution. That solution must then be\n\\begin{align*}\ng &= (CE - BD)/(AE - BD) \\\\\nh &= (AF - BC)/(AE - BD)\n\\end{align*}\n(by elementary algebra, or Cramer's rule),\nso the center of the circle is rational. This proves the desired result.\n\n\\textbf{Remark:} The above solution is deliberately more verbose\nthan is really necessary. A shorter way to say this is that any two distinct\nrational points determine a \\emph{rational line}\n(a line of the form $ax + by + c = 0$ with $a,b,c$ rational),\nwhile any two nonparallel rational lines intersect at a rational point.\nA similar statement holds with the rational numbers replaced by any\nfield.\n\n\\textbf{Remark:} A more explicit argument is to show that the equation of\nthe circle through the rational points $(x_1, y_1), (x_2, y_2), (x_3, y_3)$ is\n\\[\n0 = \\det \\begin{pmatrix}\nx_1^2 + y_1^2 & x_1 & y_1 & 1 \\\\\nx_2^2 + y_2^2 & x_2 & y_2 & 1 \\\\\nx_3^2 + y_3^2 & x_3 & y_3 & 1 \\\\\nx^2 + y^2 & x & y & 1 \\\\\n\\end{pmatrix}\n\\]\nwhich has the form $a(x^2+y^2) + dx + ey + f = 0$ for $a,d,e,f$ rational.\nThe center of this circle is $(-d/(2a), -e/(2a))$, which is again a rational\npoint.", "category": "Geometry", "source": "PUTNAM", "year": 2008}
{"id": "putnam-2008-b2", "question": "Let $F_0(x) = \\ln x$. For $n \\geq 0$ and $x > 0$, let\n$F_{n+1}(x) = \\int_0^x F_n(t)\\,dt$. Evaluate\n\\[\n\\lim_{n \\to \\infty} \\frac{n! F_n(1)}{\\ln n}.\n\\]", "solution": "We claim that $F_n(x) = (\\ln x-a_n)x^n/n!$, where $a_n = \\sum_{k=1}^n 1/k$. Indeed, temporarily write $G_n(x) = (\\ln x-a_n)x^n/n!$ for $x>0$ and $n\\geq 1$; then $\\lim_{x\\to 0} G_n(x) = 0$ and $G_n'(x) = (\\ln x-a_n+1/n) x^{n-1}/(n-1)! = G_{n-1}(x)$, and the claim follows by the Fundamental Theorem of Calculus and induction on $n$.\n\nGiven the claim, we have $F_n(1) = -a_n/n!$ and so we need to evaluate $-\\lim_{n\\to\\infty} \\frac{a_n}{\\ln n}$. But since the function $1/x$ is strictly decreasing for $x$ positive, $\\sum_{k=2}^n 1/k = a_n-1$ is bounded below by $\\int_2^n dx/x = \\ln n-\\ln 2$ and above by $\\int_1^n dx/x=\\ln n$. It follows that $\\lim_{n\\to\\infty} \\frac{a_n}{\\ln n} = 1$, and the desired limit is $-1$.", "category": "Algebra", "source": "PUTNAM", "year": 2008}
{"id": "putnam-2008-b3", "question": "What is the largest possible radius of a circle contained in a 4-dimensional\nhypercube of side length 1?", "solution": "The largest possible radius is $\\frac{\\sqrt{2}}{2}$.\nIt will be convenient to solve\nthe problem for a hypercube of side length 2 instead, in which case\nwe are trying to show that the largest radius is $\\sqrt{2}$.\n\nChoose coordinates so that the interior of the hypercube\nis the set $H = [-1,1]^4$ in $\\RR^4$. Let $C$ be a circle\ncentered at the point $P$. Then $C$ is contained both in $H$\nand its reflection across $P$; these intersect in a rectangular\nparalellepiped each of whose pairs of opposite faces are at most\n2 unit apart. Consequently, if we translate $C$ so that its center\nmoves to the point $O = (0,0,0,0)$ at the center of $H$,\nthen it remains entirely inside $H$.\n\nThis means that the answer we seek equals the largest possible radius\nof a circle $C$ contained in $H$ \\emph{and centered at $O$}.\nLet $v_1 = (v_{11}, \\dots, v_{14})$ and $v_2 = (v_{21},\\dots,v_{24})$\nbe two points on $C$ lying on radii perpendicular to each other.\nThen the points of the circle can be expressed as\n$v_1 \\cos \\theta + v_2 \\sin \\theta$ for $0 \\leq \\theta < 2\\pi$.\nThen $C$ lies in $H$ if and only if for each $i$, we have\n\\[\n|v_{1i} \\cos \\theta + v_{2i} \\sin \\theta|\n\\leq 1 \\qquad (0 \\leq \\theta < 2\\pi).\n\\]\nIn geometric terms, the vector $(v_{1i}, v_{2i})$ in $\\RR^2$\nhas dot product at most 1 with every unit vector. Since this holds\nfor the unit vector in the same direction as\n$(v_{1i}, v_{2i})$, we must have\n\\[\nv_{1i}^2 + v_{2i}^2 \\leq 1 \\qquad (i=1,\\dots,4).\n\\]\nConversely, if this holds, then the Cauchy-Schwarz inequality\nand the above analysis imply that $C$ lies in $H$.\n\nIf $r$ is the radius of $C$, then\n\\begin{align*}\n2 r^2 &= \\sum_{i=1}^4 v_{1i}^2 + \\sum_{i=1}^4 v_{2i}^2 \\\\\n&= \\sum_{i=1}^4 (v_{1i}^2 + v_{2i}^2) \\\\\n&\\leq 4,\n\\end{align*}\nso $r \\leq \\sqrt{2}$.\nSince this is achieved by the circle\nthrough $(1,1,0,0)$ and $(0,0,1,1)$,\nit is the desired maximum.\n\n\\textbf{Remark:}\nOne may similarly ask for the radius of the largest $k$-dimensional\nball inside an $n$-dimensional unit hypercube; the given problem is\nthe case $(n,k) = (4,2)$.\nDaniel Kane gives the following argument to show that the maximum radius\nin this case is $\\frac{1}{2} \\sqrt{\\frac{n}{k}}$.\n(Thanks for Noam Elkies for passing this along.)\n\nWe again scale up by a factor of 2, so that we are trying to show that\nthe maximum radius $r$ of a $k$-dimensional ball contained in the hypercube\n$[-1,1]^n$ is $\\sqrt{\\frac{n}{k}}$. Again, there is no loss of generality\nin centering the ball at the origin. Let $T: \\RR^k \\to \\RR^n$ be a\nsimilitude carrying the unit ball to this embedded $k$-ball.\nThen there exists a vector $v_i \\in \\RR^k$ such that\nfor $e_1,\\dots,e_n$ the standard basis of $\\RR^n$,\n$x \\cdot v_i = T(x) \\cdot e_i$ for all $x \\in \\RR^k$.\nThe condition of the problem is equivalent to requiring\n$|v_i| \\leq 1$ for all $i$, while the radius $r$ of the embedded ball\nis determined by the fact that for all $x \\in \\RR^k$,\n\\[\nr^2 (x \\cdot x) = T(x) \\cdot T(x) = \\sum_{i=1}^n x \\cdot v_i.\n\\]\nLet $M$ be the matrix with columns $v_1,\\dots,v_k$; then $MM^T = r^2 I_k$,\nfor $I_k$ the $k \\times k$ identity matrix. We then have\n\\begin{align*}\nkr^2 &= \\Trace(r^2 I_k) = \\Trace(MM^T)\\\\\n&= \\Trace(M^TM) = \\sum_{i=1}^n |v_i|^2 \\\\\n&\\leq n,\n\\end{align*}\nyielding the upper bound $r \\leq \\sqrt{\\frac{n}{k}}$.\n\nTo show that this bound is optimal, it is enough to show that one can\nfind an orthogonal projection of $\\RR^n$ onto $\\RR^k$ so that the\nprojections of the $e_i$ all have the same norm (one can then rescale\nto get the desired configuration of  $v_1,\\dots,v_n$). We construct\nsuch a configuration by a ``smoothing'' argument. Startw with any\nprojection.\nLet $w_1,\\dots,w_n$ be the projections of $e_1,\\dots,e_n$.\nIf the desired condition is not\nachieved, we can choose $i,j$ such that\n\\[\n|w_i|^2 < \\frac{1}{n} (|w_1|^2 + \\cdots + |w_n|^2) < |w_j|^2.\n\\]\nBy precomposing\nwith a suitable rotation that fixes $e_h$ for $h \\neq i,j$,\nwe can vary $|w_i|, |w_j|$ without varying $|w_i|^2 + |w_j|^2$\nor $|w_h|$ for $h \\neq i,j$. We can thus choose such a rotation to\nforce one of $|w_i|^2, |w_j|^2$ to become equal to\n$\\frac{1}{n} (|w_1|^2 + \\cdots + |w_n|^2)$.\nRepeating at most $n-1$ times gives the desired configuration.", "category": "Geometry", "source": "PUTNAM", "year": 2008}
{"id": "putnam-2008-b4", "question": "Let $p$ be a prime number. Let $h(x)$ be a polynomial with integer coefficients\nsuch that $h(0), h(1), \\dots, h(p^2-1)$ are distinct modulo $p^2$.\nShow that $h(0), h(1), \\dots, h(p^3-1)$ are distinct modulo $p^3$.", "solution": "We use the identity given by Taylor's theorem:\n\\[\nh(x+y) = \\sum_{i=0}^{\\deg(h)} \\frac{h^{(i)}(x)}{i!} y^i.\n\\]\nIn this expression, $h^{(i)}(x)/i!$ is a polynomial in $x$\nwith integer coefficients, so its value at an integer $x$ is an\ninteger.\n\nFor $x = 0,\\dots,p-1$, we deduce that\n\\[\nh(x+p) \\equiv h(x) + p h'(x) \\pmod{p^2}.\n\\]\n(This can also be deduced more directly using the binomial theorem.)\nSince we assumed $h(x)$ and $h(x+p)$ are distinct modulo $p^2$,\nwe conclude that $h'(x) \\not\\equiv 0 \\pmod{p}$. Since $h'$\nis a polynomial with integer coefficients, we have\n$h'(x) \\equiv h'(x + mp) \\pmod{p}$ for any integer $m$,\nand so $h'(x) \\not\\equiv 0 \\pmod{p}$ for \\emph{all} integers $x$.\n\nNow for $x= 0,\\dots,p^2-1$ and $y=0,\\dots,p-1$, we write\n\\[\nh(x + y p^2) \\equiv h(x) + p^2 y h'(x) \\pmod{p^3}.\n\\]\nThus $h(x), h(x+p^2),\\dots,h(x+(p-1)p^2)$ run over all of the residue\nclasses modulo $p^3$ congruent to $h(x)$ modulo $p^2$.\nSince the $h(x)$ themselves cover all the residue classes modulo $p^2$,\nthis proves that $h(0), \\dots, h(p^3-1)$ are distinct modulo $p^3$.\n\n\\textbf{Remark:}\nMore generally, the same proof shows that for any integers $d,e > 1$,\n$h$ permutes the residue classes modulo $p^d$ if and only if it permutes\nthe residue classes modulo $p^e$. The argument used in the proof is related\nto a general result in number theory known as\n\\emph{Hensel's lemma}.", "category": "Number Theory", "source": "PUTNAM", "year": 2008}
{"id": "putnam-2008-b5", "question": "Find all continuously differentiable functions $f: \\mathbb{R} \\to \\mathbb{R}$\nsuch that for every rational number $q$, the number $f(q)$ is rational\nand has the same denominator as $q$. (The denominator of a rational number\n$q$ is the unique positive integer $b$ such that $q = a/b$\nfor some integer $a$ with $\\mathrm{gcd}(a,b) = 1$.)\n(Note: gcd means greatest common\ndivisor.)", "solution": "The functions $f(x) = x+n$ and $f(x)=-x+n$ for any integer $n$ clearly satisfy the condition of the problem; we claim that these are the only possible $f$.\n\nLet $q=a/b$ be any rational number with $\\gcd(a,b)=1$ and $b>0$. For $n$ any positive integer, we have\n\\[\n\\frac{f(\\frac{an+1}{bn}) - f(\\frac{a}{b})}{\\frac{1}{bn}}\n= bn f\\left(\\frac{an+1}{bn}\\right) - nb f\\left(\\frac{a}{b}\\right)\n\\]\nis an integer by the property of $f$. Since $f$ is differentiable at $a/b$, the left hand side has a limit. It follows that for sufficiently large $n$, both sides must be equal to some integer $c=f'(\\frac{a}{b})$: $f(\\frac{an+1}{bn}) = f(\\frac{a}{b})+\\frac{c}{bn}$. Now $c$ cannot be $0$, since otherwise $f(\\frac{an+1}{bn}) = f(\\frac{a}{b})$ for sufficiently large $n$ has denominator $b$ rather than $bn$. Similarly, $|c|$ cannot be greater than $1$: otherwise\nif we take $n=k|c|$ for $k$ a sufficiently large positive integer,\nthen $f(\\frac{a}{b})+\\frac{c}{bn}$ has denominator $bk$, contradicting the fact that $f(\\frac{an+1}{bn})$ has denominator $bn$. It follows that $c = f'(\\frac{a}{b}) = \\pm 1$.\n\nThus the derivative of $f$ at any rational number is $\\pm 1$. Since $f$ is continuously differentiable, we conclude that $f'(x) = 1$ for all real $x$ or $f'(x) = -1$ for all real $x$. Since $f(0)$ must be an integer (a rational number with denominator $1$), $f(x)=x+n$ or $f(x)=-x+n$ for some integer $n$.\n\n\\textbf{Remark:}\nAfter showing that $f'(q)$ is an integer for each $q$, one can instead\nargue that $f'$ is a continuous function from the rationals to the integers,\nso must be constant. One can then write $f(x) = ax+b$ and check that\n$b \\in \\ZZ$ by evaluation at $a=0$, and that $a= \\pm 1$ by evaluation at\n$x=1/a$.", "category": "Number Theory", "source": "PUTNAM", "year": 2008}
{"id": "putnam-2008-b6", "question": "Let $n$ and $k$ be positive integers. Say that a permutation $\\sigma$\nof $\\{1,2,\\dots,n\\}$ is \\emph{$k$-limited} if $|\\sigma(i) - i| \\leq k$\nfor all $i$. Prove that the number of $k$-limited permutations of\n$\\{1,2,\\dots,n\\}$ is odd if and only if $n \\equiv 0$ or $1$\n(mod $2k+1$).\n\n\\end{itemize}\n\n\\end{document}", "solution": "In all solutions,\nlet $F_{n,k}$ be the number of $k$-limited permutations of\n$\\{1,\\dots,n\\}$.\n\n\\textbf{First solution:}\n(by Jacob Tsimerman)\nNote that any permutation is $k$-limited if and only if its inverse is\n$k$-limited. Consequently, the number of $k$-limited permutations of\n$\\{1,\\dots,n\\}$ is the same as the number of $k$-limited involutions\n(permutations equal to their inverses) of $\\{1,\\dots,n\\}$.\n\nWe use the following fact several times: the number of involutions\nof $\\{1,\\dots,n\\}$ is odd if $n=0,1$ and even otherwise. This follows from\nthe fact that non-involutions come in pairs, so the number of involutions\nhas the same parity as the number of permutations, namely $n!$.\n\nFor $n \\leq k+1$, all involutions are $k$-limited.\nBy the previous paragraph, $F_{n,k}$ is odd for $n=0,1$ and even for\n$n=2,\\dots,k+1$.\n\nFor $n > k+1$, group the  $k$-limited involutions into classes based on\ntheir actions on $k+2,\\dots,n$. Note that for $C$ a class and $\\sigma \\in C$,\nthe set of elements of $A = \\{1,\\dots,k+1\\}$ which map into $A$ under\n$\\sigma$ depends only on $C$, not on $\\sigma$. Call this set $S(C)$; then\nthe size of $C$ is exactly the number of involutions of $S(C)$.\nConsequently, $|C|$ is even unless $S(C)$ has at most one element.\nHowever, the element 1 cannot map out of $A$ because we are looking at\n$k$-limited involutions. Hence if $S(C)$ has one element and $\\sigma \\in C$,\nwe must have $\\sigma(1) = 1$. Since $\\sigma$ is $k$-limited and\n$\\sigma(2)$ cannot belong to $A$, we must have $\\sigma(2) = k+2$. By\ninduction, for $i=3,\\dots,k+1$, we must have  $\\sigma(i) = k+i$.\n\nIf $n < 2k+1$, this shows that no class $C$ of odd cardinality can exist,\nso $F_{n,k}$ must be even. If $n \\geq 2k+1$, the classes of odd cardinality\nare in bijection with $k$-limited involutions of $\\{2k+2,\\dots,n\\}$,\nso $F_{n,k}$ has the same parity as $F_{n-2k-1,k}$. By induction on $n$,\nwe deduce the desired result.\n\n\\textbf{Second solution:}\n(by Yufei Zhao)\nLet $M_{n,k}$ be the $n \\times n$ matrix with\n\\[\n(M_{n,k})_{ij} = \\begin{cases} 1 & |i-j|\\leq k \\\\ 0 & \\mbox{otherwise.}\n\\end{cases}\n\\]\nWrite $\\det(M_{n,k})$ as the sum over permutations\n$\\sigma$ of $\\{1,\\dots,n\\}$ of\n$(M_{n,k})_{1 \\sigma(1)} \\cdots (M_{n,k})_{n \\sigma(n)}$\ntimes the signature of $\\sigma$. Then $\\sigma$ contributes $\\pm 1$\nto $\\det (M_{n,k})$ if $\\sigma$ is $k$-limited and 0 otherwise.\nWe conclude that\n\\[\n\\det(M_{n,k}) \\equiv F_{n,k} \\pmod{2}.\n\\]\nFor the rest of the solution, we interpret $M_{n,k}$ as a matrix\nover the field of two elements. We compute its determinant using\nlinear algebra modulo 2.\n\nWe first show that for $n \\geq 2k+1$,\n\\[\nF_{n,k} \\equiv F_{n-2k-1,k} \\pmod{2},\n\\]\nprovided that we interpret $F_{0,k} = 1$. We do this by\ncomputing $\\det(M_{n,k})$ using row and column operations.\nWe will verbally describe these operations for general $k$,\nwhile illustrating with the example $k=3$.\n\nTo begin with, $M_{n,k}$ has the following form.\n\\[\n\\left(\n\\begin{array}{ccccccc|c}\n1 & 1 & 1 & 1 & 0 & 0 & 0 & \\emptyset \\\\\n1 & 1 & 1 & 1 & 1 & 0 & 0 & \\emptyset \\\\\n1 & 1 & 1 & 1 & 1 & 1 & 0 & \\emptyset \\\\\n1 & 1 & 1 & 1 & 1 & 1 & 1 & \\emptyset \\\\\n0 & 1 & 1 & 1 & 1 & 1 & 1 & ? \\\\\n0 & 0 & 1 & 1 & 1 & 1 & 1 & ? \\\\\n0 & 0 & 0 & 1 & 1 & 1 & 1 & ? \\\\\n\\hline\n\\emptyset & \\emptyset & \\emptyset & \\emptyset & ? & ? & ? & *\n\\end{array}\n\\right)\n\\]\nIn this presentation, the first $2k+1$ rows and columns are shown\nexplicitly; the remaining rows and columns are shown in a compressed format.\nThe symbol $\\emptyset$ indicates that the unseen entries are all zeroes,\nwhile the symbol $?$ indicates that they are not. The symbol $*$ in the\nlower right corner represents the matrix $F_{n-2k-1,k}$.\nWe will preserve the unseen structure of the matrix by only adding\nthe first $k+1$ rows or columns to any of the others.\n\nWe first add row 1 to each of rows $2, \\dots, k+1$.\n\\[\n\\left(\n\\begin{array}{ccccccc|c}\n1 & 1 & 1 & 1 & 0 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 1 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 1 & 1 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 1 & 1 & 1 & \\emptyset \\\\\n0 & 1 & 1 & 1 & 1 & 1 & 1 & ? \\\\\n0 & 0 & 1 & 1 & 1 & 1 & 1 & ? \\\\\n0 & 0 & 0 & 1 & 1 & 1 & 1 & ? \\\\\n\\hline\n\\emptyset & \\emptyset & \\emptyset & \\emptyset & ? & ? & ? & *\n\\end{array}\n\\right)\n\\]\nWe next add column 1 to each of columns $2, \\dots, k+1$.\n\\[\n\\left(\n\\begin{array}{ccccccc|c}\n1 & 0 & 0 & 0 & 0 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 1 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 1 & 1 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 1 & 1 & 1 & \\emptyset \\\\\n0 & 1 & 1 & 1 & 1 & 1 & 1 & ? \\\\\n0 & 0 & 1 & 1 & 1 & 1 & 1 & ? \\\\\n0 & 0 & 0 & 1 & 1 & 1 & 1 & ? \\\\\n\\hline\n\\emptyset & \\emptyset & \\emptyset & \\emptyset & ? & ? & ? & *\n\\end{array}\n\\right)\n\\]\nFor $i=2$, for each of $j=i+1,\\dots,2k+1$\nfor which the $(j, k+i)$-entry is nonzero,\nadd row $i$ to row $j$.\n\\[\n\\left(\n\\begin{array}{ccccccc|c}\n1 & 0 & 0 & 0 & 0 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 1 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 0 & 1 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 0 & 1 & 1 & \\emptyset \\\\\n0 & 1 & 1 & 1 & 0 & 1 & 1 & ? \\\\\n0 & 0 & 1 & 1 & 0 & 1 & 1 & ? \\\\\n0 & 0 & 0 & 1 & 0 & 1 & 1 & ? \\\\\n\\hline\n\\emptyset & \\emptyset & \\emptyset & \\emptyset & \\emptyset & ? & ? & *\n\\end{array}\n\\right)\n\\]\nRepeat the previous step for $i=3,\\dots,k+1$ in succession.\n\\[\n\\left(\n\\begin{array}{ccccccc|c}\n1 & 0 & 0 & 0 & 0 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 1 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 0 & 1 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 0 & 0 & 1 & \\emptyset \\\\\n0 & 1 & 1 & 1 & 0 & 0 & 0 & ? \\\\\n0 & 0 & 1 & 1 & 0 & 0 & 0 & ? \\\\\n0 & 0 & 0 & 1 & 0 & 0 & 0 & ? \\\\\n\\hline\n\\emptyset & \\emptyset & \\emptyset & \\emptyset & \\emptyset & \\emptyset & \\emptyset & *\n\\end{array}\n\\right)\n\\]\nRepeat the two previous steps with the roles of the rows and columns reversed.\nThat is, for $i=2,\\dots,k+1$,\nfor each of $j=i+1,\\dots,2k+1$\nfor which the $(j, k+i)$-entry is nonzero,\nadd row $i$ to row $j$.\n\\[\n\\left(\n\\begin{array}{ccccccc|c}\n1 & 0 & 0 & 0 & 0 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 1 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 0 & 1 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 0 & 0 & 1 & \\emptyset \\\\\n0 & 1 & 0 & 0 & 0 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 1 & 0 & 0 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 1 & 0 & 0 & 0 & \\emptyset \\\\\n\\hline\n\\emptyset & \\emptyset & \\emptyset & \\emptyset & \\emptyset & \\emptyset & \\emptyset & *\n\\end{array}\n\\right)\n\\]\nWe now have a block diagonal matrix in which the top left\nblock is a $(2k+1) \\times (2k+1)$ matrix with nonzero determinant (it\nresults from reordering the rows of the identity matrix), the bottom right\nblock is $M_{n-2k-1,k}$, and the other two blocks are zero. We conclude that\n\\[\n\\det(M_{n,k}) \\equiv \\det(M_{n-2k-1,k})\n\\pmod{2},\n\\]\nproving the desired congruence.\n\nTo prove the desired result, we must now check that\n$F_{0,k}, F_{1,k}$ are odd and $F_{2,k}, \\dots, F_{2k,k}$ are even.\nFor $n=0,\\dots,k+1$, the matrix $M_{n,k}$ consists of all ones,\nso its determinant is 1 if $n=0,1$ and 0 otherwise.\n(Alternatively, we have $F_{n,k} = n!$ for $n=0,\\dots,k+1$,\nsince every permutation of $\\{1,\\dots,n\\}$ is $k$-limited.)\nFor $n=k+2,\\dots,2k$,\nobserve that rows $k$ and $k+1$ of $M_{n,k}$  both consist of all ones,\nso $\\det(M_{n,k}) = 0$ as desired.\n\n\\textbf{Third solution:} (by Tom Belulovich)\nDefine $M_{n,k}$ as in the second solution. We prove\n$\\det(M_{n,k})$ is odd for $n \\equiv 0,1 \\pmod{2k+1}$ and even otherwise,\nby directly determining whether or not $M_{n,k}$ is invertible as a matrix\nover the field of two elements.\n\nLet $r_i$ denote row $i$ of $M_{n,k}$.\nWe first check that if $n \\equiv 2, \\dots, 2k \\pmod{2k+1}$, then $M_{n,k}$\nis not invertible. In this case, we can find integers $0 \\leq a < b \\leq k$\nsuch that $n + a + b \\equiv 0 \\pmod{2k+1}$.\nPut $j = (n+a+b)/(2k+1)$. We can then write the\nall-ones vector both as\n\\[\n\\sum_{i=0}^{j-1} r_{k+1-a + (2k+1)i}\n\\]\nand as\n\\[\n\\sum_{i=0}^{j-1} r_{k+1-b + (2k+1)i}.\n\\]\nHence $M_{n,k}$ is not invertible.\n\nWe next check that if $n \\equiv 0,1 \\pmod{2k+1}$, then $M_{n,k}$\nis invertible. Suppose that $a_1,\\dots,a_n$ are scalars such that\n$a_1 r_1 + \\cdots + a_n r_n$ is the zero vector. The $m$-th coordinate\nof this vector equals $a_{m-k} + \\cdots + a_{m+k}$, where we regard\n$a_i$ as zero if $i \\notin \\{1,\\dots,n\\}$. By comparing consecutive\ncoordinates, we obtain\n\\[\na_{m-k} = a_{m+k+1} \\qquad (1 \\leq m < n).\n\\]\nIn particular, the $a_i$ repeat with period $2k+1$.\nTaking $m=1,\\dots,k$ further yields that\n\\[\na_{k+2} = \\cdots = a_{2k+1} = 0\n\\]\nwhile taking $m=n-k, \\dots,n-1$ yields\n\\[\na_{n-2k} =  \\dots = a_{n-1-k} = 0.\n\\]\nFor $n \\equiv 0 \\pmod{2k+1}$, the latter can be rewritten as\n\\[\na_1 = \\cdots = a_k = 0\n\\]\nwhereas for $n \\equiv 1 \\pmod{2k+1}$, it can be rewritten as\n\\[\na_2 = \\cdots = a_{k+1} = 0.\n\\]\nIn either case, since we also have\n\\[\na_1 + \\cdots + a_{2k+1} = 0\n\\]\nfrom the $(k+1)$-st coordinate, we deduce that all of the $a_i$ must be\nzero, and so $M_{n,k}$ must be invertible.\n\n\n\\textbf{Remark:}\nThe matrices $M_{n,k}$ are examples of \\emph{banded matrices},\nwhich occur frequently in numerical applications of linear algebra.\nThey are also examples of \\emph{Toeplitz matrices}.\n\n\\end{itemize}\n\\end{document}", "category": "Combinatorics", "source": "PUTNAM", "year": 2008}
{"id": "imo-2014-q1", "question": "Let $a_0 < a_1 < a_2 < \\dotsb$ be an infinite sequence of positive integers.\nProve that there exists a unique integer $n\\geq 1$ such that\n\\[ a_n < \\frac{a_0+a_1+a_2+\\dotsb+a_n}{n} \\le a_{n+1}. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3542095}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a_0 < a_1 < a_2 < \\dotsb$ be an infinite sequence of positive integers.\nProve that there exists a unique integer $n\\geq 1$ such that\n\\[ a_n < \\frac{a_0+a_1+a_2+\\dotsb+a_n}{n} \\le a_{n+1}. \\]\n\\end{mdframed}\nFedor Petrov presents the following nice solution.\nLet us define the sequence\n\\[ b_n = \\left( a_n - a_{n-1} \\right) + \\dots + \\left( a_n - a_1 \\right). \\]\nSince $(a_n)_n$ is increasing, we get $(b_n)_n$ is strictly increasing,\nand moreover $b_1 = 0$.\nThe problem requires an $n$ such that\n\\[ b_n < a_0 \\le b_{n+1} \\]\nwhich obviously exists and is unique.\n\\pagebreak", "category": "Number Theory", "source": "IMO", "year": 2014}
{"id": "imo-2014-q2", "question": "Let $n \\ge 2$ be an integer.\nConsider an $n \\times n$ chessboard consisting of $n^2$ unit squares.\nA configuration of $n$ rooks on this board is \\emph{peaceful}\nif every row and every column contains exactly one rook.\nFind the greatest positive integer $k$ such that,\nfor each peaceful configuration of $n$ rooks,\nthere is a $k \\times k$ square which does not\ncontain a rook on any of its $k^2$ unit squares.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3542094}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n \\ge 2$ be an integer.\nConsider an $n \\times n$ chessboard consisting of $n^2$ unit squares.\nA configuration of $n$ rooks on this board is \\emph{peaceful}\nif every row and every column contains exactly one rook.\nFind the greatest positive integer $k$ such that,\nfor each peaceful configuration of $n$ rooks,\nthere is a $k \\times k$ square which does not\ncontain a rook on any of its $k^2$ unit squares.\n\\end{mdframed}\nThe answer is $k = \\left\\lfloor \\sqrt{n-1} \\right\\rfloor$.\n\n\\paragraph{Proof that the property holds when $n \\ge k^2+1$.}\nFirst, assume $n > k^2$ for some $k$.\nWe will prove we can find an empty $k \\times k$ square.\nIndeed, let $R$ be a rook in the uppermost column,\nand draw $k$ squares of size $k \\times k$ directly below it, aligned.\nThere are at most $k-1$ rooks among these squares, as desired.\n\n\\begin{center}\n\\begin{asy}\nunitsize(0.75cm);\nusepackage(\"chessfss\");\n\nfor (int i=1; i<=4; ++i) {\n  draw( (0,i)--(5,i), gray );\n  draw( (i,0)--(i,5), gray );\n}\ndraw(box( (0,0),(5,5) ), black);\n\nfilldraw( box((1.1,2.1),(2.9,3.9)), opacity(0.2)+palered, red+1 );\nfilldraw( box((1.1,0.1),(2.9,1.9)), opacity(0.2)+lightgreen, blue+1 );\nlabel(\"\\WhiteRookOnBlack\", (1.5,4.5));\n\\end{asy}\n\\end{center}\n\n\\paragraph{Construction for all $n \\le k^2$.}\nWe first give an example where for $n = k^2$ showing there may be no empty $k \\times k$ square.\nWe draw the example for $k=3$ (with the generalization being obvious);\n\n\\begin{center}\n\\begin{asy}\nunitsize(0.8cm);\nusepackage(\"chessfss\");\nfilldraw(box( (0,0), (3,3) ), opacity(0.2)+palered, black+1);\nfilldraw(box( (3,0), (6,3) ), opacity(0.2)+lightgreen, black+1);\nfilldraw(box( (6,0), (9,3) ), opacity(0.2)+lightcyan, black+1);\n\nfilldraw(box( (0,3), (3,6) ), opacity(0.2)+lightgreen, black+1);\nfilldraw(box( (3,3), (6,6) ), opacity(0.2)+lightcyan, black+1);\nfilldraw(box( (6,3), (9,6) ), opacity(0.2)+palered, black+1);\n\nfilldraw(box( (0,6), (3,9) ), opacity(0.2)+lightcyan, black+1);\nfilldraw(box( (3,6), (6,9) ), opacity(0.2)+palered, black+1);\nfilldraw(box( (6,6), (9,9) ), opacity(0.2)+lightgreen, black+1);\n\nfor (int i=1; i<=8; ++i) {\n  if ( (i-3)*(i-6) != 0) {\n    draw( (0,i)--(9,i), gray );\n    draw( (i,0)--(i,9), gray );\n  }\n}\n\nlabel(\"\\BlackRookOnWhite\", (0.5,0.5));\nlabel(\"\\BlackRookOnWhite\", (3.5,1.5));\nlabel(\"\\BlackRookOnWhite\", (6.5,2.5));\n\nlabel(\"\\BlackRookOnWhite\", (1.5,3.5));\nlabel(\"\\BlackRookOnWhite\", (4.5,4.5));\nlabel(\"\\BlackRookOnWhite\", (7.5,5.5));\n\nlabel(\"\\BlackRookOnWhite\", (2.5,6.5));\nlabel(\"\\BlackRookOnWhite\", (5.5,7.5));\nlabel(\"\\BlackRookOnWhite\", (8.5,8.5));\n\\end{asy}\n\\end{center}\n\nTo show that this works,\nconsider for each rook drawing an $k \\times k$ square of $X$'s\nwhose bottom-right hand corner is the rook (these may go off the board).\nThese indicate positions where one cannot\nplace the upper-left hand corner of any square.\nIt's easy to see that these cover the entire board,\nexcept parts of the last $k-1$ columns,\nwhich don't matter anyways.\n\nIt remains to check that $n \\le k^2$ also all work\n(omitting this step is a common mistake).\nFor this, we can delete rows and column to get an $n \\times n$ board,\nand then fill in any gaps where we accidentally deleted a rook.\n\\pagebreak", "category": "Combinatorics", "source": "IMO", "year": 2014}
{"id": "imo-2014-q3", "question": "Convex quadrilateral $ABCD$ has $\\angle ABC = \\angle CDA = 90\\dg$.\nPoint $H$ is the foot of the perpendicular from $A$ to $\\ol{BD}$.\nPoints $S$ and $T$ lie on sides $AB$ and $AD$,\nrespectively, such that $H$ lies inside triangle $SCT$ and\n\\[ \\angle CHS - \\angle CSB = 90^{\\circ},\n  \\quad \\angle THC - \\angle DTC = 90^{\\circ}. \\]\nProve that line $BD$ is tangent to the circumcircle of triangle $TSH$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3542092}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nConvex quadrilateral $ABCD$ has $\\angle ABC = \\angle CDA = 90\\dg$.\nPoint $H$ is the foot of the perpendicular from $A$ to $\\ol{BD}$.\nPoints $S$ and $T$ lie on sides $AB$ and $AD$,\nrespectively, such that $H$ lies inside triangle $SCT$ and\n\\[ \\angle CHS - \\angle CSB = 90^{\\circ},\n  \\quad \\angle THC - \\angle DTC = 90^{\\circ}. \\]\nProve that line $BD$ is tangent to the circumcircle of triangle $TSH$.\n\\end{mdframed}\n\\paragraph{First solution (mine).}\nFirst we rewrite the angle condition in a suitable way.\n\\begin{claim*}\n  We have $\\angle ATH = \\angle TCH + 90\\dg$.\n  Thus the circumcenter of $\\triangle CTH$ lies on $\\ol{AD}$.\n  Similarly the circumcenter of $\\triangle CSH$ lies on $\\ol{AB}$.\n\\end{claim*}\n\\begin{proof}\n  \\begin{align*}\n    \\dang ATH &= \\dang DTH \\\\\n    &= \\dang DTC + \\dang CTH \\\\\n    &= \\dang DTC - \\dang THC - \\dang HCT \\\\\n    &= 90\\dg - \\dang HCT = 90\\dg + \\dang TCH.\n  \\end{align*}\n  which implies conclusion.\n\\end{proof}\n\n\\begin{center}\n\\begin{asy}\npair A = dir(110);\npair B = dir(200);\npair D = dir(-20);\npair C = -A;\npair H = foot(A, B, D);\npair Cs = -C+2*foot(origin, H, C);\npair As = -A+2*foot(origin, A, H);\n\nfilldraw(unitcircle, opacity(0.1)+lightcyan, lightblue);\ndraw(A--B--C--D--cycle, lightblue);\n\npair M = midpoint(B--As);\npair N = midpoint(D--As);\n\npair U = IP(Cs--N, circumcircle(D, H, As));\npair V = IP(Cs--M, circumcircle(B, H, As));\npair Ss = D+As-U;\npair Ts = B+As-V;\npair T = extension(Ts, H, A, D);\npair S = extension(Ss, H, A, B);\n\npair O_D = circumcenter(C, H, T);\n\nfilldraw(circumcircle(C, H, T), opacity(0.1)+yellow, red);\npair P = extension(A, H, O_D, midpoint(T--H));\ndraw(A--H, lightblue);\ndraw(B--D, lightblue);\n\ndraw(H--C--T--cycle, red);\ndraw(H--O_D, lightblue);\ndraw(P--O_D, heavygreen);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$D$\", D, dir(D));\ndot(\"$C$\", C, dir(C));\ndot(\"$H$\", H, dir(H));\ndot(\"$T$\", T, dir(80));\ndot(\"$S$\", S, dir(S));\ndot(\"$O_D$\", O_D, dir(45));\ndot(\"$P$\", P, dir(45));\n\n/* TSQ Source:\n\nA = dir 110\nB = dir 200\nD = dir -20\nC = -A\nH = foot A B D\nC* := -C+2*foot origin H C R80\nA* := -A+2*foot origin A H\n\nunitcircle 0.1 lightcyan / lightblue\nA--B--C--D--cycle lightblue\n\nM := midpoint B--As\nN := midpoint D--As\n\nU := IP Cs--N circumcircle D H As\nV := IP Cs--M circumcircle B H As\nS* := D+As-U\nT* := B+As-V\nT = extension Ts H A D R80\nS = extension Ss H A B\n\nO_D = circumcenter C H T R45\n\ncircumcircle C H T 0.1 yellow / red\nP = extension A H O_D midpoint T--H R45\nA--H lightblue\nB--D lightblue\n\nH--C--T--cycle red\nH--O_D lightblue\nP--O_D heavygreen\n\n*/\n\\end{asy}\n\\end{center}\n\nLet the perpendicular bisector of $TH$ meet $AH$ at $P$ now.\nIt suffices to show that $\\frac{AP}{PH}$ is symmetric in $b = AD$ and $d=AB$,\nbecause then $P$ will be the circumcenter of $\\triangle TSH$.\nTo do this, set $AH = \\frac{bd}{2R}$ and $AC=2R$.\n\nLet $O$ denote the circumcenter of $\\triangle CHT$.\nUse the Law of Cosines on $\\triangle ACO$ and $\\triangle AHO$,\nusing variables $x=AO$ and $r=HO$.\nWe get that\n\\[ r^2 = x^2 + AH^2 - 2x \\cdot AH \\cdot \\frac{d}{2R} = x^2 + (2R)^2 - 2bx. \\]\nBy the angle bisector theorem,\n$\\frac{AP}{PH} = \\frac{AO}{HO}$.\n\nThe rest is computation: notice that\n\\[ r^2 - x^2 = h^2 - 2xh \\cdot \\frac{d}{2R} = (2R)^2 - 2bx \\]\nwhere $h = AH = \\frac{bd}{2R}$, whence\n\\[ x = \\frac{(2R)^2-h^2}{2b - 2h \\cdot \\frac{d}{2R}}. \\]\nMoreover,\n\\[ \\frac{1}{2} \\left( \\frac{r^2}{x^2}-1 \\right)\n= \\frac{1}{x} \\left( \\frac 2x R^2 - b \\right). \\]\nNow, if we plug in the $x$ in the\nright-hand side of the above, we obtain\n\\[ \\frac{2b-2h \\cdot \\frac{d}{2R}}{4R^2-h^2}\n  \\left( \\frac{2b-2h \\cdot \\frac{d}{2R}}{4R^2-h^2} \\cdot 2R^2 - b\\right)\n  = \\frac{2h}{(4R^2-h^2)^2} \\left( b- h \\cdot \\frac{d}{2R} \\right)\n  \\left( -2hdR + bh^2 \\right). \\]\nPulling out a factor of $-2Rh$ from the rightmost term,\nwe get something that is symmetric in $b$ and $d$, as required.\n\n\\paragraph{Second solution (Victor Reis).}\nHere is the fabled solution using inversion at $H$.\nFirst, we rephrase the angle conditions in the following ways:\n\\begin{itemize}\n  \\ii $\\ol{AD} \\perp (THC)$,\n  which is equivalent to the claim from the first solution.\n  \\ii $\\ol{AB} \\perp (SHC)$, by symmetry.\n  \\ii $\\ol{AC} \\perp (ABCD)$, by definition.\n\\end{itemize}\nNow for concreteness we will use a negative inversion at $H$\nwhich swaps $B$ and $D$ and overlay it on the original diagram.\nAs usual we denote inverses with stars.\n\nLet us describe the inverted problem.\nWe let $M$ and $N$ denote the midpoints of $\\ol{A^\\ast B^\\ast}$\nand $\\ol{A^\\ast D^\\ast}$, which are the centers of\n$(HA^\\ast B^\\ast)$ and $(HA^\\ast D^\\ast)$.\nFrom $\\ol{T^\\ast C^\\ast} \\perp (HA^\\ast D^\\ast)$,\nwe know have $C^\\ast$, $M$, $T^\\ast$ collinear.\nSimilarly, $C^\\ast$, $N$, $S^\\ast$ are collinear.\nWe have that $(A^\\ast H C^\\ast)$ is orthogonal to $(ABCD)$ which remains fixed.\nWe wish to show $\\ol{T^\\ast S^\\ast}$ and $\\ol{MN}$ are parallel.\n\n\\begin{center}\n\\begin{asy}\npair A = dir(100);\npair B = dir(200);\npair D = dir(-20);\npair C = -A;\npair H = foot(A, B, D);\npair Cs = -C+2*foot(origin, H, C);\npair As = -A+2*foot(origin, A, H);\n\nfilldraw(unitcircle, opacity(0.1)+lightcyan, lightblue);\ndraw(A--B--C--D--cycle, lightblue);\n\nfilldraw(circumcircle(B, H, As), opacity(0.1)+lightgreen, dotted+heavygreen);\nfilldraw(circumcircle(D, H, As), opacity(0.1)+lightgreen, dotted+heavygreen);\n\npair M = midpoint(B--As);\npair N = midpoint(D--As);\n\npair U = IP(Cs--N, circumcircle(D, H, As));\npair V = IP(Cs--M, circumcircle(B, H, As));\npair Ss = D+As-U;\npair Ts = B+As-V;\npair T = extension(Ts, H, A, D);\npair S = extension(Ss, H, A, B);\n\ndraw(Ts--Cs--Ss, heavygreen);\ndraw(Ts--Ss, red);\ndraw(B--D, lightblue);\ndraw(A--As, lightblue);\ndraw(A--B--As--D--cycle, lightblue);\ndraw(C--Cs--A--cycle, lightblue);\n\ndraw(S--Ss, dotted+blue);\ndraw(T--Ts, dotted+blue);\ndraw(M--N, red);\n\nfilldraw(circumcircle(As, M, N), opacity(0.1)+lightred, red+dashed);\nfilldraw(circumcircle(As, H, Cs), opacity(0.1)+pink, purple+dashed);\nclip(box((-1.4,-1.4),(2,2)));\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$D$\", D, dir(D));\ndot(\"$C$\", C, dir(C));\ndot(\"$H$\", H, dir(H));\ndot(\"$C^\\ast$\", Cs, dir(80));\ndot(\"$A^\\ast$\", As, dir(As));\ndot(\"$M$\", M, dir(M));\ndot(\"$N$\", N, dir(N));\ndot(\"$S^\\ast$\", Ss, dir(Ss));\ndot(\"$T^\\ast$\", Ts, dir(Ts));\ndot(\"$T$\", T, dir(50));\ndot(\"$S$\", S, dir(S));\n\n/* TSQ Source:\n\nA = dir 100\nB = dir 200\nD = dir -20\nC = -A\nH = foot A B D\nC* = -C+2*foot origin H C R80\nA* = -A+2*foot origin A H\n\nunitcircle 0.1 lightcyan / lightblue\nA--B--C--D--cycle lightblue\n\ncircumcircle B H As 0.1 lightgreen / dotted heavygreen\ncircumcircle D H As 0.1 lightgreen / dotted heavygreen\n\nM = midpoint B--As\nN = midpoint D--As\n\nU := IP Cs--N circumcircle D H As\nV := IP Cs--M circumcircle B H As\nS* = D+As-U\nT* = B+As-V\nT = extension Ts H A D R50\nS = extension Ss H A B\n\nTs--Cs--Ss heavygreen\nTs--Ss red\nB--D lightblue\nA--As lightblue\nA--B--As--D--cycle lightblue\nC--Cs--A--cycle lightblue\n\nS--Ss dotted blue\nT--Ts dotted blue\nM--N red\n\ncircumcircle As M N 0.1 lightred / red dashed\ncircumcircle As H Cs 0.1 pink / purple dashed\n!clip(box((-1.4,-1.4),(2,2)));\n\n*/\n\\end{asy}\n\\end{center}\n\nLot $\\omega$ denote the circumcircle of $\\triangle A^\\ast H C^\\ast$,\nwhich is orthogonal to the original circle $(ABCD)$.\nIt would suffices to show $(A^\\ast H C^\\ast)$\nis an $H$-Apollonius circle with respect to $\\ol{MN}$,\nfrom which we would get $C^\\ast M / H M = C^\\ast N / H N$.\n\nHowever, $\\omega$ through $H$ and $A$,\nhence it center lies on line $MN$.\nMoreover $\\omega$ is orthogonal to $(A^\\ast MN)$\n(since $(A^\\ast MN)$ and $(A^\\ast BD)$ are homothetic).\nThis is enough (for example, if we let $O$ denote the center of $\\omega$,\nwe now have $\\mathrm{r}(\\omega)^2 = OH^2 = OM \\cdot ON$).\n(Note in this proof that the fact that $C^\\ast$ lies on $(ABCD)$\nis not relevant.)\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Geometry", "source": "IMO", "year": 2014}
{"id": "imo-2014-q4", "question": "Let $P$ and $Q$ be on segment $BC$ of an acute triangle $ABC$\nsuch that $\\angle PAB=\\angle BCA$ and $\\angle CAQ=\\angle ABC$.\nLet $M$ and $N$ be points on $\\ol{AP}$ and $\\ol{AQ}$,\nrespectively, such that $P$ is the midpoint of $\\ol{AM}$\nand $Q$ is the midpoint of $\\ol{AN}$.\nProve that $\\ol{BM}$ and $\\ol{CN}$ meet on the\ncircumcircle of $\\triangle ABC$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3543136}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $P$ and $Q$ be on segment $BC$ of an acute triangle $ABC$\nsuch that $\\angle PAB=\\angle BCA$ and $\\angle CAQ=\\angle ABC$.\nLet $M$ and $N$ be points on $\\ol{AP}$ and $\\ol{AQ}$,\nrespectively, such that $P$ is the midpoint of $\\ol{AM}$\nand $Q$ is the midpoint of $\\ol{AN}$.\nProve that $\\ol{BM}$ and $\\ol{CN}$ meet on the\ncircumcircle of $\\triangle ABC$.\n\\end{mdframed}\nWe give three solutions.\n\n\\paragraph{First solution by harmonic bundles.}\nLet $\\ol{BM}$ intersect the circumcircle again at $X$.\n\n\\begin{center}\n\\begin{asy}\npair A = dir(70);\npair B = dir(190);\npair C = dir(350);\nfilldraw(unitcircle, opacity(0.1)+palecyan, lightblue);\nfilldraw(A--B--C--cycle, opacity(0.1)+heavycyan, blue);\n\npair T = 2*B*C/(B+C);\npair P = extension(A, B+A-T, B, C);\npair Q = extension(A, C+A-T, B, C);\npair M = 2*P-A;\npair N = 2*Q-A;\npair X = extension(B, M, C, N);\ndraw(B--M, lightblue);\ndraw(C--N, lightblue);\n\ndraw(A--M, lightred);\ndraw(A--N, orange);\nreal r = 0.4;\ndraw((B+r*dir(B-T))--(B+r*dir(T-B)), lightred);\ndraw((C+r*dir(C-T))--(C+r*dir(T-C)), orange);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$P$\", P, dir(225));\ndot(\"$Q$\", Q, dir(225));\ndot(\"$M$\", M, dir(M));\ndot(\"$N$\", N, dir(N));\ndot(\"$X$\", X, dir(280));\n\n/* TSQ Source:\n\nA = dir 70\nB = dir 190\nC = dir 350\nunitcircle 0.1 palecyan / lightblue\nA--B--C--cycle 0.1 heavycyan / blue\n\nT := 2*B*C/(B+C)\nP = extension A B+A-T B C R225\nQ = extension A C+A-T B C R225\nM = 2*P-A\nN = 2*Q-A\nX = extension B M C N R280\nB--M lightblue\nC--N lightblue\n\nA--M lightred\nA--N orange\n! real r = 0.4;\n(B+r*dir(B-T))--(B+r*dir(T-B)) lightred\n(C+r*dir(C-T))--(C+r*dir(T-C)) orange\n\n*/\n\\end{asy}\n\\end{center}\n\nThe angle conditions imply that the tangent to $(ABC)$ at $B$\nis parallel to $\\ol{AP}$.\nLet $\\infty$ be the point at infinity along line $AP$.\nThen \\[ -1 = (AM;P\\infty) \\overset{B}{=} (AX;BC). \\]\nSimilarly, if $\\ol{CN}$ meets the circumcircle at $Y$\nthen $(AY;BC) = -1$ as well.\nHence $X=Y$, which implies the problem.\n\n\\paragraph{Second solution by similar triangles.}\nOnce one observes $\\triangle CAQ \\sim \\triangle CBA$,\none can construct $D$ the reflection of $B$ across $A$,\nso that $\\triangle CAN \\sim \\triangle CBD$.\nSimilarly, letting $E$ be the reflection of $C$ across $A$,\nwe get $\\triangle BAP \\sim \\triangle BCA\n\\implies \\triangle BAM \\sim \\triangle BCE$.\nNow to show $\\angle ABM + \\angle ACN = 180\\dg$\nit suffices to show $\\angle EBC + \\angle BCD = 180\\dg$,\nwhich follows since $BCDE$ is a parallelogram.\n\n\\paragraph{Third solution by barycentric coordinates.}\nSince $PB = c^2/a$ we have\n\\[ P = (0 : a^2-c^2 : c^2) \\]\nso the reflection $\\vec M = 2\\vec P - \\vec A$ has coordinates\n\\[ M = (-a^2 : 2(a^2-c^2) : 2c^2). \\]\n\nSimilarly $N = (-a^2 : 2b^2 : 2(b^2-a^2))$. Thus\n\\[ \\ol{BM} \\cap \\ol{CN} = (-a^2 : 2b^2 : 2c^2) \\]\nwhich clearly lies on the circumcircle,\nand is in fact the point identified in the first solution.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2014}
{"id": "imo-2014-q5", "question": "For every positive integer $n$,\nthe Bank of Cape Town issues coins of denomination $\\frac 1n$.\nGiven a finite collection of such coins (of not necessarily different denominations)\nwith total value at most $99 + \\frac12$, prove that it is possible to split\nthis collection into $100$ or fewer groups, such that each group has total value at most $1$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3543144}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFor every positive integer $n$,\nthe Bank of Cape Town issues coins of denomination $\\frac 1n$.\nGiven a finite collection of such coins (of not necessarily different denominations)\nwith total value at most $99 + \\frac12$, prove that it is possible to split\nthis collection into $100$ or fewer groups, such that each group has total value at most $1$.\n\\end{mdframed}\nWe'll prove the result\nfor at most $k - \\frac{k}{2k+1}$ with $k$ groups.\nFirst, perform the following optimizations.\n\\begin{itemize}\n  \\ii If any coin of size $\\frac{1}{2m}$ appears twice,\n  then replace it with a single coin of size $\\frac{1}{m}$.\n  \\ii If any coin of size $\\frac{1}{2m+1}$ appears $2m+1$ times,\n  group it into a single group and induct downwards.\n\\end{itemize}\nApply this operation repeatedly until it cannot be done anymore.\n\nNow construct boxes $B_0$, $B_1$, \\dots, $B_{k-1}$.\nIn box $B_0$ put any coins of size $\\tfrac 12$ (clearly there is at most one).\nMore generally for $m \\ge 0$, $B_m$, put coins of size\n$\\frac{1}{2m+1}$ and $\\frac{1}{2m+2}$\n(there at most $2m$ of the former and at most one of the latter).\nNote that\n\\[ \\text{total weight in $B_m$} \\le 2m \\cdot \\frac{1}{2m+1} + \\frac{1}{2m+2} < 1. \\]\nFinally, place the remaining ``light'' coins of size at most $\\frac{1}{2k+1}$ in a pile.\n\\begin{remark*}\n  One way to explain where this boxing comes from is to imagine\n  what happens after applying the operation repeatedly until it can't be done any more.\n  We expect the most troublesome situation would be if the leftover coins are\n  as large as possible, which looks like\n  \\[ \\half, \\qquad \\frac13 \\times 2, \\qquad \\frac14, \\qquad \\frac15 \\times 4,\n    \\qquad \\frac16, \\qquad \\frac17 \\times 6, \\qquad \\frac 18, \\qquad \\dots \\]\n  Seeing this the boxing $B_i$ is quite reasonable because it groups these\n  into groups of almost $1$ without too much effort:\n  \\begin{align*}\n    B_0 &\\longrightarrow \\half \\\\\n    B_1 &\\longrightarrow \\frac13 \\cdot 2 + \\frac 14 = \\frac{11}{12} \\\\\n    B_2 &\\longrightarrow \\frac15 \\cdot 4 + \\frac 16 = \\frac{29}{30} \\\\\n    B_3 &\\longrightarrow \\frac17 \\cdot 6 + \\frac 18 = \\frac{55}{56} \\\\\n    &\\vdotswithin\\longrightarrow\n  \\end{align*}\n\\end{remark*}\n\nThen just toss coins from the pile into the boxes arbitrarily,\nother than the proviso that no box should have its weight exceed $1$.\nWe claim this uses up all coins in the pile.\nAssume not, and that some coin remains in the pile\nwhen all the boxes are saturated.\nThen all the boxes must have at least $1 -\\frac{1}{2k+1}$,\nmeaning the total amount in the boxes is strictly greater than\n\\[ k \\left( 1 - \\frac{1}{2k+1} \\right) > k - \\tfrac 12 \\]\nwhich is a contradiction.\n\\begin{remark*}\n  This gets a stronger bound $k - \\frac{k}{2k+1}$ than the requested $k-\\tfrac 12$.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "IMO", "year": 2014}
{"id": "imo-2014-q6", "question": "A set of lines in the plane is in \\emph{general position}\nif no two are parallel and no three pass through the same point.\nA set of lines in general position cuts the plane into regions,\nsome of which have finite area; we call these its \\emph{finite regions}.\nProve that for all sufficiently large $n$,\nin any set of $n$ lines in general position\nit is possible to colour at least $\\sqrt{n}$ lines blue\nin such a way that none of its finite regions\nhas a completely blue boundary.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3543151}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA set of lines in the plane is in \\emph{general position}\nif no two are parallel and no three pass through the same point.\nA set of lines in general position cuts the plane into regions,\nsome of which have finite area; we call these its \\emph{finite regions}.\nProve that for all sufficiently large $n$,\nin any set of $n$ lines in general position\nit is possible to colour at least $\\sqrt{n}$ lines blue\nin such a way that none of its finite regions\nhas a completely blue boundary.\n\\end{mdframed}\nSuppose we have colored $k$ of the lines blue, and that\nit is not possible to color any additional lines.\nThat means any of the $n-k$ non-blue lines\nis the side of some finite region with\nan otherwise entirely blue perimeter.\nFor each such line $\\ell$, select one such region,\nand take the next counterclockwise vertex;\nthis is the intersection of two blue lines $v$.\nWe'll say $\\ell$ is the \\emph{eyelid} of $v$.\n\n\\begin{center}\n \\begin{asy}\n  size(2cm);\n  pair A = dir(  0); dot(A);\n  pair B = dir( 72); dot(B);\n  pair C = dir(144); dot(C);\n  pair D = dir(216); dot(D);\n  pair E = dir(288); dot(E);\n  draw(D--E--A--B--C, blue);\n  draw(C--D, red);\n  label(\"$\\ell$\", 0.5*C+0.5*D, dir(180));\n  label(\"$v$\", E, dir(E));\n \\end{asy}\n\\end{center}\n\nYou can prove without too much difficulty that every intersection of two blue lines\nhas at most two eyelids.\nSince there are $\\binom k2$ such intersections, we see that\n\\[ n-k \\le 2 \\binom k2 = k^2 - k\\]\nso $n \\le k^2$, as required.\n\n\\begin{remark*}\nIn fact, $k = \\sqrt n$ is ``sharp for greedy algorithms'',\nas illustrated below for $k=3$:\n\\begin{center}\n\\begin{asy}\nsize(2.5cm);\nreal R = 7;\nreal r = 3;\nreal e = 2;\npair A = R * dir(90);\npair B = R * dir(210);\npair C = R * dir(330);\ndraw( (A-r*dir(B-A)) -- (B-r*dir(A-B)), blue );\ndraw( (B-r*dir(C-B)) -- (C-r*dir(B-C)), blue );\ndraw( (C-r*dir(A-C)) -- (A-r*dir(C-A)), blue );\nvoid yanpi(pair P) {\ndot(P, blue);\ndraw( (P+e*dir(P)*dir(70)) -- (P+e*dir(P)*dir(-70)), red);\ndraw( (P+e*dir(P)*dir(110)) -- (P+e*dir(P)*dir(-110)), red);\n}\nyanpi(A);\nyanpi(B);\nyanpi(C);\n\\end{asy}\n\\end{center}\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "IMO", "year": 2014}
{"id": "putnam-2016-a1", "question": "Find the smallest positive integer $j$ such that for every polynomial $p(x)$ with integer coefficients and for every integer $k$, the integer\n\\[\np^{(j)}(k) = \\left. \\frac{d^j}{dx^j} p(x) \\right|_{x=k} \n\\] \n(the $j$-th derivative of $p(x)$ at $k$) is divisible by 2016.", "solution": "The answer is $j=8$. First suppose that $j$ satisfies the given condition. For $p(x) = x^j$, we have $p^{(j)}(x) = j!$ and thus $j!$ is divisible by $2016$. Since $2016$ is divisible by $2^5$ and $7!$ is not, it follows that $j \\geq 8$. Conversely, we claim that $j=8$ works. Indeed, let $p(x) = \\sum_{m=0}^n a_m x^m$ be a polynomial with integer coefficients; then if $k$ is any integer, \n\\begin{align*}\np^{(8)}(k) &= \\sum_{m=8}^n m(m-1)\\cdots (m-7) a_m k^{m-8} \\\\\n&= \\sum_{m=8}^n {m\\choose 8} 8! a_m k^{m-8}\n\\end{align*}\nis divisible by $8! = 20 \\cdot 2016$, and so $p^{(8)}(k)$ is divisible by $2016$.\n\n\\noindent\n\\textbf{Remark:}\nBy the same reasoning, if one replaces $2016$ in the problem by a general integer $N$,\nthen the minimum value of $j$ is the smallest one for which $N$ divides $j!$.\nThis can be deduced from P\\'olya's observation that the set of integer-valued polynomials is the free $\\ZZ$-module generated by the binomial polynomials $\\binom{x}{n}$ for $n=0,1,\\dots$. That statement can be extended to polynomials evaluated on a subset of a Dedekind domain using Bhargava's method of \\emph{$P$-orderings}; we do not know if this generalization can be adapted to the analogue of this problem, where one considers polynomials whose $j$-th derivatives take integral values on a prescribed subset.", "category": "Algebra", "source": "PUTNAM", "year": 2016}
{"id": "putnam-2016-a2", "question": "Given a positive integer $n$, let $M(n)$ be the largest integer $m$ such that \n\\[\n\\binom{m}{n-1} > \\binom{m-1}{n}.\n\\]\nEvaluate \n\\[\n\\lim_{n \\to \\infty} \\frac{M(n)}{n}.\n\\]", "solution": "The answer is $\\frac{3+\\sqrt{5}}{2}$. Note that for $m > n+1$, both binomial coefficients are nonzero and their ratio is\n\\begin{align*}\n{m\\choose n-1}/{m-1\\choose n} &= \\frac{m!n!(m-n-1)!}{(m-1)!(n-1)!(m-n+1)!} \\\\\n&= \\frac{mn}{(m-n+1)(m-n)}.\n\\end{align*}\nThus the condition ${m\\choose{n-1}} > {{m-1}\\choose n}$ is equivalent to $(m-n+1)(m-n)-mn < 0$. The left hand side of this last inequality is a quadratic function of $m$ with roots\n\\begin{align*}\n\\alpha(n) &= \\frac{3n-1+\\sqrt{5n^2-2n+1}}{2}, \\\\\n\\beta(n) &= \\frac{3n-1-\\sqrt{5n^2-2n+1}}{2},\n\\end{align*}\nboth of which are real since $5n^2-2n+1 = 4n^2+(n-1)^2 > 0$; it follows that $m$ satisfies the given inequality if and only if $\\beta(n) < m < \\alpha(n)$. (Note in particular that since $\\alpha(n)-\\beta(n) = \\sqrt{5n^2-2n+1} > 1$, there is always some integer $m$ between $\\beta(n)$ and $\\alpha(n)$.)\n\n\nWe conclude that $M(n)$ is the greatest integer strictly less than $\\alpha(n)$, and thus that \n$\\alpha(n)-1 \\leq M(n) < \\alpha(n)$. Now\n\\[\n\\lim_{n\\to\\infty} \\frac{\\alpha(n)}{n} = \\lim_{n\\to\\infty} \\frac{3-\\frac{1}{n}+\\sqrt{5-\\frac{2}{n}+\\frac{1}{n^2}}}{2}\n= \\frac{3+\\sqrt{5}}{2}\n\\]\nand similarly $\\lim_{n\\to\\infty} \\frac{\\alpha(n)-1}{n} = \\frac{3+\\sqrt{5}}{2}$, and so by the sandwich theorem, $\\lim_{n\\to\\infty} \\frac{M(n)}{n} = \\frac{3+\\sqrt{5}}{2}$.", "category": "Combinatorics", "source": "PUTNAM", "year": 2016}
{"id": "putnam-2016-a3", "question": "Suppose that $f$ is a function from $\\mathbb{R}$ to $\\mathbb{R}$ such that\n\\[\nf(x) + f\\left( 1 - \\frac{1}{x} \\right) = \\arctan x\n\\]\nfor all real $x \\neq 0$. (As usual, $y = \\arctan x$ means $-\\pi/2 < y < \\pi/2$ and $\\tan y = x$.) Find \n\\[\n\\int_0^1 f(x)\\,dx.\n\\]", "solution": "The given functional equation, along with the same equation but with $x$ replaced by $\\frac{x-1}{x}$ and $\\frac{1}{1-x}$ respectively, yields:\n\\begin{align*}\nf(x) + f\\left(1-\\frac{1}{x}\\right) &= \\tan^{-1}(x) \\\\\nf\\left(\\frac{x-1}{x}\\right) + f\\left(\\frac{1}{1-x}\\right) &= \\tan^{-1}\\left(\\frac{x-1}{x}\\right) \\\\\nf\\left(\\frac{1}{1-x}\\right) + f(x) &= \\tan^{-1}\\left(\\frac{1}{1-x}\\right).\n\\end{align*}\nAdding the first and third equations and subtracting the second gives:\n\\[\n2f(x) = \\tan^{-1}(x) + \\tan^{-1}\\left(\\frac{1}{1-x}\\right) - \\tan^{-1}\\left(\\frac{x-1}{x}\\right).\n\\]\nNow $\\tan^{-1}(t) + \\tan^{-1}(1/t)$ is equal to $\\pi/2$ if $t>0$ and $-\\pi/2$ if $t<0$; it follows that for $x \\in (0,1)$,\n\\begin{align*}\n2(f(x)+f(1-x)) &= \\left(\\tan^{-1}(x)+\\tan^{-1}(1/x)\\right)\\\\\n&\\,\\, + \\left(\\tan^{-1}(1-x)+\\tan^{-1}\\left(\\frac{1}{1-x}\\right)\\right) \\\\\n&\\,\\,- \n\\left(\\tan^{-1}\\left(\\frac{x-1}{x}\\right) + \\tan^{-1}\\left(\\frac{x}{x-1}\\right) \\right) \\\\\n&= \\frac{\\pi}{2} + \\frac{\\pi}{2} + \\frac{\\pi}{2} \\\\\n&= \\frac{3\\pi}{2}.\n\\end{align*}\nThus\n\\[\n4\\int_0^1 f(x)\\,dx = 2\\int_0^1 (f(x)+f(1-x))dx = \\frac{3\\pi}{2}\n\\]\nand finally $\\int_0^1 f(x)\\,dx = \\frac{3\\pi}{8}$.\n\n\\noindent\n\\textbf{Remark:}\nOnce one has the formula for $f(x)$, one can also (with some effort) directly evaluate the integral of each summand over $[0,1]$ to obtain the same result. A much cleaner variant of this approach (suggested on AoPS, user \\texttt{henrikjb}) is to write\n\\[\n\\tan^{-1}(x) = \\int_0^y \\frac{1}{1+y^2}\\,dy\n\\]\nand do a change of variable on the resulting double integral.", "category": "Algebra", "source": "PUTNAM", "year": 2016}
{"id": "putnam-2016-a4", "question": "Consider a $(2m-1) \\times (2n-1)$ rectangular region, where $m$ and $n$ are integers such that $m, n \\geq 4$. This region is to be tiled using tiles of the two types shown:\n\\[\n\\setlength{\\unitlength}{4144sp}%\n%\n\\begingroup\\makeatletter\\ifx\\SetFigFont\\undefined%\n\\gdef\\SetFigFont#1#2#3#4#5{%\n  \\reset@font\\fontsize{#1}{#2pt}%\n  \\fontfamily{#3}\\fontseries{#4}\\fontshape{#5}%\n  \\selectfont}%\n\\fi\\endgroup%\n\\begin{picture}(2724,924)(1339,-1423)\n\\thinlines\n{\\put(1351,-511){\\line( 0,-1){900}}\n\\put(1351,-1411){\\line( 1, 0){450}}\n\\put(1801,-1411){\\line( 0, 1){450}}\n\\put(1801,-961){\\line( 1, 0){450}}\n\\put(2251,-961){\\line( 0, 1){450}}\n\\put(2251,-511){\\line(-1, 0){900}}\n}%\n{\\multiput(1351,-961)(128.57143,0.00000){4}{\\line( 1, 0){ 64.286}}\n\\multiput(1801,-961)(0.00000,128.57143){4}{\\line( 0, 1){ 64.286}}\n}%\n{\\put(2701,-961){\\line( 0,-1){450}}\n\\put(2701,-1411){\\line( 1, 0){900}}\n\\put(3601,-1411){\\line( 0, 1){450}}\n\\put(3601,-961){\\line( 1, 0){450}}\n\\put(4051,-961){\\line( 0, 1){450}}\n\\put(4051,-511){\\line(-1, 0){900}}\n\\put(3151,-511){\\line( 0,-1){450}}\n\\put(3151,-961){\\line(-1, 0){450}}\n}%\n{\\multiput(3151,-1411)(0.00000,128.57143){4}{\\line( 0, 1){ 64.286}}\n\\multiput(3151,-961)(128.57143,0.00000){4}{\\line( 1, 0){ 64.286}}\n\\multiput(3601,-961)(0.00000,128.57143){4}{\\line( 0, 1){ 64.286}}\n}%\n\\end{picture}%\n\\]\n(The dotted lines divide the tiles into $1 \\times 1$ squares.)\nThe tiles may be rotated and reflected, as long as their sides are parallel to the sides\nof the rectangular region. They must all fit within the region, and they must cover it completely without overlapping.\n\nWhat is the minimum number of tiles required to tile the region?", "solution": "The minimum number of tiles is $mn$. To see that this many are required, label the squares $(i,j)$ with $1\\leq i\\leq 2m-1$ and $1\\leq j\\leq 2n-1$, and for each square with $i,j$ both odd, color the square red; then no tile can cover more than one red square, and there are $mn$ red squares.\n\nIt remains to show that we can cover any $(2m-1) \\times (2n-1)$ rectangle with $mn$ tiles when $m,n \\geq 4$. First note that we can tile any $2 \\times (2k-1)$ rectangle with $k\\geq 3$ by $k$ tiles: one of the first type, then $k-2$ of the second type, and finally one of the first type. Thus if we can cover a $7\\times 7$ square with $16$ tiles, then we can do the general $(2m-1) \\times (2n-1)$ rectangle, by decomposing this rectangle into a $7\\times 7$ square in the lower left corner, along with $m-4$ $(2\\times 7)$ rectangles to the right of the square, and $n-4$ $((2m-1)\\times 2)$ rectangles above, and tiling each of these rectangles separately, for a total of $16+4(m-4)+m(n-4) = mn$ tiles.\n\nTo cover the $7 \\times 7$ square, note that the tiling must consist of 15 tiles of the first type and 1 of the second type, and that any $2 \\times 3$ rectangle can be covered using 2 tiles of the first type. We may thus construct a suitable covering by covering all but the center square with eight $2 \\times 3$ rectangles, in such a way that we can attach the center square to one of these rectangles to get a shape that can be covered by two tiles. An example of such a covering, with the remaining $2 \\times 3$ rectangles left intact for visual clarity, is depicted below. (Many other solutions are possible.)\n\\[\n\\setlength{\\unitlength}{4144sp}%\n%\n\\begingroup\\makeatletter\\ifx\\SetFigFont\\undefined%\n\\gdef\\SetFigFont#1#2#3#4#5{%\n  \\reset@font\\fontsize{#1}{#2pt}%\n  \\fontfamily{#3}\\fontseries{#4}\\fontshape{#5}%\n  \\selectfont}%\n\\fi\\endgroup%\n\\begin{picture}(3174,3174)(1339,-7723)\n\\thinlines\n{\\put(1351,-7711){\\framebox(3150,3150){}}\n}%\n{\\put(1351,-5911){\\line( 1, 0){945}}\n\\put(2296,-5911){\\line( 0, 1){1350}}\n}%\n{\\put(2296,-5911){\\line( 1, 0){405}}\n\\put(2701,-5911){\\line( 0,-1){1800}}\n}%\n{\\put(1351,-6811){\\line( 1, 0){1350}}\n}%\n{\\put(2701,-6361){\\line( 1, 0){1800}}\n}%\n{\\put(3601,-6361){\\line( 0,-1){1350}}\n}%\n{\\put(3151,-6361){\\line( 0, 1){1800}}\n}%\n{\\put(3151,-5461){\\line( 1, 0){1350}}\n}%\n{\\multiput(2296,-5011)(128.57143,0.00000){4}{\\line( 1, 0){ 64.286}}\n\\multiput(2746,-5011)(0.00000,-128.57143){4}{\\line( 0,-1){ 64.286}}\n\\multiput(2746,-5461)(115.71429,0.00000){4}{\\line( 1, 0){ 57.857}}\n}%\n\\end{picture}%\n\\]", "category": "Geometry", "source": "PUTNAM", "year": 2016}
{"id": "putnam-2016-a5", "question": "Suppose that $G$ is a finite group generated by the two elements $g$ and $h$, where the order of $g$ is odd. Show that every element of $G$ can be written in the form\n\\[\ng^{m_1} h^{n_1} g^{m_2} h^{n_2} \\cdots g^{m_r} h^{n_r}\n\\]\nwith $1 \\leq r \\leq |G|$ and $m_1, n_1, m_2, n_2, \\ldots, m_r, n_r \\in \\{-1, 1\\}$. \n(Here $|G|$ is the number of elements of $G$.)\n\n\\,", "solution": "\\noindent\n\\textbf{First solution:}\nFor $s \\in G$ and $r$ a positive integer, define a \\emph{representation of $s$ of length $r$}\nto be a sequence of values $m_1, n_1, \\ldots, m_r, n_r \\in \\{-1, 1\\}$ for which\n\\[\ns = g^{m_1} h^{n_1} \\cdots g^{m_r} h^{n_r}.\n\\]\nWe first check that every $s \\in G$ admits at least one representation of some length; this is equivalent to saying that the set $S$ of $s \\in G$ which admit representations of some length\nis equal to $G$ itself. \nSince $S$ is closed under the group operation and $G$ is finite, $S$ is also closed under formation of inverses and contains the identity element; that is, $S$ is a subgroup of $G$.\nIn particular, $S$ contains not only $gh$ but also its inverse $h^{-1} g^{-1}$; since $S$ also contains $g^{-1} h$, we deduce that $S$ contains $g^{-2}$. \nSince $g$ is of odd order in $G$, $g^{-2}$ is also a generator of the cyclic subgroup containing $g$; it follows that $g \\in S$ and hence $h \\in S$. Since we assumed that $g,h$ generate $G$,\nwe now conclude that $S = G$, as claimed.\n\nTo complete the proof, we must now check that for each $s \\in G$, the smallest possible length of a representation of $s$ cannot exceed $|G|$. Suppose the contrary, and let\n\\[\ns = g^{m_1} h^{n_1} \\cdots g^{m_r} h^{n_r}\n\\]\nbe a representation of the smallest possible length. Set\n\\[\ns_i = g^{m_1} h^{n_1} \\cdots g^{m_i} h^{n_i} \\qquad (i=0,\\dots,r-1),\n\\]\ninterpreting $s_0$ as $e$; since $r>|G|$ by hypothesis, by the pigeonhole principle there must exist indices $0 \\leq i < j \\leq r-1$ such that $s_i = s_j$. Then\n\\[\ns = g^{m_1} h^{n_1} \\cdots g^{m_i} h^{n_i} g^{m_{j+1}} h^{n_{j+1}} \\cdots g^{m_r} h^{n_r} \n\\]\nis another representation of $s$ of length strictly less than $r$, a contradiction.\n\n\\noindent\n\\textbf{Remark:}\nIf one considers $s_1,\\dots,s_r$ instead of $s_0,\\dots,s_{r-1}$, then the case $s=e$ must be handled separately: otherwise, one might end up with a representation of length 0 which is disallowed by the problem statement.\n\n\\noindent\n\\textbf{Reinterpretation:} \nNote that the elements $gh, gh^{-1}, g^{-1} h, g^{-1} h^{-1}$ generate $gh(g^{-1}h)^{-1} = g^2$ and hence all of $G$ (again using the hypothesis that $g$ has odd order, as above). Form the Cayley digraph on the set $G$, i.e., the directed graph with an edge from $s_1$ to $s_2$ whenever $s_2 = s_1 *$ for $* \\in \\{gh, gh^{-1}, g^{-1} h, g^{-1} h^{-1}\\}$. Since $G$ is finite, this digraph is strongly connected: there exists at least one path from any vertex to any other vertex (traveling all edges in the correct direction). The shortest such path cannot repeat any vertices (except the starting and ending vertices in case they coincide), and so has length at most $|G|$.\n\n\\noindent\n\\textbf{Second solution:}\nFor $r$ a positive integer, let $S_r$ be the set of $s \\in G$ which admit a representation of length at most $r$ (terminology as in the first solution); obviously $S_r \\subseteq S_{r+1}$.\nWe will show that $S_r \\neq S_{r+1}$ unless $S_r = G$; this will imply by induction on $r$ that $\\#S_r \\geq \\min\\{r, |G|\\}$ and hence that $S_r = G$ for some $r \\leq |G|$.\n\nSuppose that $S_r = S_{r+1}$.\nThen the map $s \\mapsto sgh$ defines an injective map $S_r \\to S_{r+1} = S_r$,\nso $S_r$ is closed under right multiplication by $gh$. By the same token, $S_r$ is closed under right multiplication by each of $gh^{-1}, g^{-1}h, g^{-1}h^{-1}$.\nSince $gh, gh^{-1}, g^{-1}h, g^{-1}h^{-1}$ generate $G$ as in the first solution, it follows that $S_r = G$ as claimed.\n\n\\noindent\n\\textbf{Remark:} The condition on the order of $g$ is needed to rule out the case where $G$ admits a (necessarily normal) subgroup $H$ of index 2 not containing either $g$ or $h$; in this case, all products of the indicated form belong to $H$.\nOn the other hand, if one assumes that both $g$ and $h$ have odd order, then one can say a bit more: there exists some positive integer $r$ with $1 \\leq r \\leq |G|$ such that every element of $G$ has a representation of length exactly $r$. (Namely, the set of such elements for a given $r$ strictly increases in size until it is stable under right multiplication by both\n$gh(g^{-1}h)^{-1} = g^2$ and $gh(gh^{-1})^{-1} = gh^2g^{-1}$, but under the present hypotheses these generate $G$.)", "category": "Algebra", "source": "PUTNAM", "year": 2016}
{"id": "putnam-2016-a6", "question": "Find the smallest constant $C$ such that for every real polynomial $P(x)$ of degree 3 that has a root in the interval $[0,1]$,\n\\[\n\\int_0^1 \\left| P(x) \\right|\\,dx \\leq C \\max_{x \\in [0,1]} \\left| P(x) \\right|.\n\\]", "solution": "We prove that the smallest such value of $C$ is $5/6$.\n\n\\noindent\n\\textbf{First solution:}\n(based on a suggestion of Daniel Kane)\n\nWe first reduce to the case where $P$ is nonnegative in $[0,1]$ and $P(0) = 0$.\nTo achieve this reduction, suppose that a given value $C$ obeys the inequality for such $P$.\nFor $P$ general,\ndivide the interval $[0,1]$ into subintervals $I_1,\\dots,I_k$ at the roots of $P$.\nWrite $\\ell(I_i)$ for the length of the interval $I_i$; since each interval is bounded by a root of $P$, we may make a linear change of variable to see that\n\\[\n\\int_{I_i} |P(x)|\\,dx \\leq C \\ell(I_i) \\max_{x \\in I_i} |P(x)| \\quad (i=1,\\dots,k).\n\\]\nSumming over $i$ yields the desired inequality.\n\nSuppose now that $P$ takes nonnegative values on $[0,1]$, $P(0) = 0$, and $\\max_{x \\in [0,1]} P(x) = 1$. Write $P(x) = ax^3 + bx^2 + cx$ for some $a,b,c \\in \\RR$; then\n\\begin{align*}\n\\int_0^1 P(x)\\,dx &= \\frac{1}{4} a + \\frac{1}{3} b + \\frac{1}{2} c \\\\\n&= \\frac{2}{3} \\left( \\frac{1}{8} a + \\frac{1}{4} b + \\frac{1}{2} c \\right)\n+ \\frac{1}{6} (a+b+c) \\\\\n&= \\frac{2}{3} P\\left( \\frac{1}{2} \\right) + \\frac{1}{6} P(1) \\\\\n&\\leq \\frac{2}{3} + \\frac{1}{6} = \\frac{5}{6}.\n\\end{align*}\nConsequently, the originally claimed inequality holds with $C = 5/6$. To prove that this value is best possible, it suffices to exhibit a polynomial $P$ as above with $\\int_0^1 P(x)\\,dx = 5/6$; we will verify that\n\\[\nP(x) = 4x^3 - 8x^2 + 5x\n\\]\nhas this property. It is apparent that $\\int_0^1 P(x)\\, dx =5/6$.\nSince $P'(x) = (2x-1)(6x-5)$ and \n\\[\nP(0) = 0, \\,P\\left( \\frac{1}{2} \\right) = 1, \\,\nP\\left( \\frac{5}{6} \\right) = \\frac{25}{27}, P(1) = 1,\n\\]\nit follows that $P$ increases from 0 at $x=0$ to 1 at $x=1/2$, then decreases to a positive value at $x=5/6$, then increases to 1 at $x=1$. Hence $P$ has the desired form.\n\n\\noindent\n\\textbf{Remark:}\nHere is some conceptual motivation for the preceding solution.\nLet $V$ be the set of polynomials of degree at most 3 vanishing at 0, viewed as a three-dimensional vector space over $\\RR$.\nLet $S$ be the subset of $V$ consisting of those polynomials $P(x)$ for which\n$0 \\leq P(x) \\leq 1$ for all $x \\in [0,1]$; this set is convex and compact. We may then compute the minimal $C$ as the maximum value of $\\int_0^1 P(x)\\,dx$ over all $P \\in S$, provided that the maximum is achieved for some polynomial of degree exactly 3. (Note that any extremal polynomial must satisfy\n$\\max_{x \\in [0,1]} P(x) = 1$, as otherwise we could multiply it by some constant $c>1$ so as to increase $\\int_0^1 P(x)\\,dx$.)\n\nLet $f: V \\to \\RR$ be the function taking $P(x)$ to $\\int_0^1 P(x)\\,dx$. This function is linear, so we can characterize its extrema on $S$ easily: there exist exactly two level surfaces for $f$ which are supporting planes for $S$, and the intersections of these two planes\nwith $S$ are the minima and the maxima. It is obvious that the unique minimum is achieved by the zero polynomial, so this accounts for one of the planes.\n\nIt thus suffices to exhibit a single polynomial $P(x) \\in S$ such that the level plane of $f$ through $P$ is a supporting plane for $S$. \nThe calculation made in the solution amounts to verifying that\n\\[\nP(x) = 4x^3 - 8x^2 + 5x\n\\]\nhas this property, by interpolating between the constraints $P(1/2) \\leq 1$ and $P(1) \\leq 1$.\n\nThis still leaves the matter of correctly guessing the optimal polynomial. If one supposes that it should be extremized both at $x=1$ and at an interval value of the disc, it is forced to have the form $P(x) = 1 + (x-1)(cx-1)^2$ for some $c>0$; the interpolation property then pins down $c$ uniquely.\n\n\\noindent\n\\textbf{Second solution:}\n(by James Merryfield, via AoPS)\nAs in the first solution, we may assume that $P$ is nonnegative on $[0,1]$ and $P(0)= 0$.\nSince $P$ has degree at most 3, Simpson's rule for approximating $\\int_0^1 P(x)\\,dx$ is an exact formula:\n\\[\n\\int_0^1 P(x)\\,dx = \\frac{1}{6}( P(0) + 4 P\\left( \\frac{1}{2} \\right) + P(1)).\n\\]\nThis immediately yields the claimed inequality for $C = 5/6$. Again as in the first solution,\nwe obtain an example showing that this value is best possible.", "category": "Algebra", "source": "PUTNAM", "year": 2016}
{"id": "putnam-2016-b1", "question": "Let $x_0,x_1,x_2,\\dots$ be the sequence such that $x_0=1$ and for $n \\geq 0$,\n\\[\nx_{n+1} = \\ln(e^{x_n} - x_n)\n\\]\n(as usual, the function $\\ln$ is the natural logarithm). Show that the infinite series\n\\[\nx_0 + x_1 + x_2 + \\cdots\n\\]\nconverges and find its sum.", "solution": "Note that the function $e^x - x$ is strictly increasing for $x>0$ (because its derivative is $e^x - 1$, which is positive because $e^x$ is strictly increasing), and its value at 0 is 1.\nBy induction on $n$, we see that $x_n > 0$ for all $n$.\n\nBy exponentiating the equation defining $x_{n+1}$, we obtain the expression\n\\[\nx_n = e^{x_n} - e^{x_{n+1}}.\n\\]\nWe use this equation repeatedly to acquire increasingly precise information about the sequence $\\{x_n\\}$.\n\\begin{itemize}", "category": "Algebra", "source": "PUTNAM", "year": 2016}
{"id": "putnam-2016-b2", "question": "Define a positive integer $n$ to be \\emph{squarish} if either $n$ is itself a perfect square or the distance from $n$ to the nearest perfect square is a perfect square. For example, 2016 is squarish, because the nearest perfect square to 2016 is $45^2 = 2025$ and $2025-2016=9$ is a perfect square. (Of the positive integers between 1 and 10, only 6 and 7 are not squarish.)\n\nFor a positive integer $N$, let $S(N)$ be the number of squarish integers between 1 and $N$,\ninclusive. Find positive constants $\\alpha$ and $\\beta$ such that\n\\[\n\\lim_{N \\to \\infty} \\frac{S(N)}{N^\\alpha} = \\beta,\n\\]\nor show that no such constants exist.", "solution": "We prove that the limit exists for $\\alpha = \\frac{3}{4}$, $\\beta =\\frac{4}{3}$. \n\nFor any given positive integer $n$, the integers which are closer to $n^2$ than to any other perfect square are the ones in the interval $[n^2 - n - 1, n^2 + n]$. The number of squarish numbers in this interval is $1 + \\lfloor \\sqrt{n-1} \\rfloor + \\lfloor \\sqrt{n} \\rfloor$.\nRoughly speaking, this means that \n\\[\nS(N) \\sim \\int_0^{\\sqrt{N}} 2 \\sqrt{x} \\,dx = \\frac{4}{3} N^{3/4}.\n\\]\nTo make this precise, we use the bounds $x-1 \\leq \\lfloor x \\rfloor \\leq x$,\nand the upper and lower Riemann sum estimates for the integral of $\\sqrt{x}$,\nto derive upper and lower bounds on $S(N)$:\n\\begin{align*}\nS(N) &\\geq \\sum_{n=1}^{\\lfloor \\sqrt{N} \\rfloor - 1} \n(2 \\sqrt{n-1}-1) \\\\\n&\\geq \\int_0^{\\lfloor \\sqrt{N} \\rfloor - 2} 2\\sqrt{x} \\,dx - \\sqrt{N} \\\\\n&\\geq \\frac{4}{3} (\\sqrt{N} - 3)^{3/2} - \\sqrt{N}\n\\end{align*}\n\n\\begin{align*}\nS(N) &\\leq \\sum_{n=1}^{\\lceil \\sqrt{N} \\rceil} (2 \\sqrt{n} + 1) \\\\\n&\\leq \\int_0^{\\lceil \\sqrt{N}\\rceil + 1} 2 \\sqrt{x}\\,dx  + \\sqrt{N} + 1\\\\\n&\\leq \\frac{4}{3} (\\sqrt{N} + 2)^{3/2} + \\sqrt{N} + 1.\n\\end{align*}\n\n\\noindent\n\\textbf{Remark:}\nJohn Rickert points out that when $N = n^4$, one can turn the previous estimates into exact calculations to obtain the formula\n\\[\nS(N) = \\frac{4}{3}\\left( n^3 + \\frac{n}{2} \\right) = \\frac{4}{3} N^{3/4} + \\frac{2}{3} N^{1/4}.\n\\]\nFor general $N$, one can then use the estimates\n\\begin{align*}\n\\frac{4}{3} (N-1)^{3/4} + \\frac{2}{3} (N-1)^{1/4}\n&\\leq\nS(\\lfloor N^{1/4} \\rfloor^4) \\\\\n&\\leq S(N) \\\\\n&\\leq S(\\lceil N^{1/4} \\rceil^4) \\\\\n&\\leq \\frac{4}{3} (N+1)^{3/4} + \\frac{2}{3} (N+1)^{1/4}\n\\end{align*}\nto obtain the desired limit.", "category": "Number Theory", "source": "PUTNAM", "year": 2016}
{"id": "putnam-2016-b3", "question": "Suppose that $S$ is a finite set of points in the plane such that the area of triangle\n$\\triangle ABC$ is at most 1 whenever $A$, $B$, and $C$ are in $S$. Show that there exists a triangle of area 4 that (together with its interior) covers the set $S$.", "solution": "Since $S$ is finite, we can choose three points $A,B,C$ in $S$ so as to maximize the area of the triangle $ABC$. Let $A', B', C'$ be the points in the plane such that $A,B,C$ are the midpoints of the segments $B'C', C'A', A'B'$; the triangle $A'B'C'$ is similar to $ABC$ with sides twice as long, so its area is 4 times that of $ABC$ and hence no greater than 4.\n\nWe claim that this triangle has the desired effect; that is, every point $P$ of $S$ is contained within the triangle $A'B'C'$. \n(To be precise, the problem statement requires a triangle of area exactly 4, which need not be the case for $A'B'C'$, but this is trivially resolved by scaling up by a homothety.)\nTo see this, note that since the area of the triangle $PBC$ is no more than that of $ABC$, $P$ must lie in the half-plane bounded by $B'C'$ containing $B$ and $C$. Similarly, $P$ must lie in the half-plane bounded by $C'A'$ containing\n$C$ and $A$, and the half-plane bounded by $A'B'$ containing $A$ and $B$. These three half-planes intersect precisely in the region bounded by the triangle $A'B'C'$, proving the claim.", "category": "Geometry", "source": "PUTNAM", "year": 2016}
{"id": "putnam-2016-b4", "question": "Let $A$ be a $2n \\times 2n$ matrix, with entries chosen independently at random. Every entry is chosen to be 0 or 1, each with probability $1/2$. Find the expected value of $\\det(A-A^t)$ (as a function of $n$), where $A^t$ is the transpose of $A$.", "solution": "The expected value equals\n\\[\n\\frac{(2n)!}{4^n n!}.\n\\]\n\\noindent\n\\textbf{First solution:}\n\nWrite the determinant of $A-A^t$ as the sum over permutations $\\sigma$ of $\\{1,\\dots,2n\\}$ of the product\n\\[\n\\sgn(\\sigma)\n\\prod_{i=1}^{2n}\n(A-A^t)_{i \\sigma(i)} \n=\n\\sgn(\\sigma) \\prod_{i=1}^{2n} (A_{i \\sigma(i)} - A_{\\sigma(i) i});\n\\]\nthen the expected value of the determinant is the sum over $\\sigma$ of the expected value of this product, which we denote by $E_\\sigma$. \n\nNote that if we partition $\\{1,\\dots,2n\\}$ into orbits for the action of $\\sigma$, then partition the factors of the product accordingly, then no entry of $A$ appears in more than one of these factors; consequently, these factors are independent random variables. This means that we can compute $E_\\sigma$ as the product of the expected values of the individual factors.\n\nIt is obvious that any orbit of size 1 gives rise to the zero product, and hence the expected value of the corresponding factor is zero. For an orbit of size $m \\geq 3$, the corresponding factor contains $2m$ distinct matrix entries, so again we may compute the expected value of the factor as the product of the expected values of the individual terms $A_{i \\sigma(i)} - A_{\\sigma(i) i}$. However, the distribution of this term is symmetric about 0, so its expected value is 0.\n\nWe conclude that $E_\\sigma = 0$ unless $\\sigma$ acts with $n$ orbits of size 2. To compute $E_\\sigma$ in this case, assume without loss of generality that the orbits of $\\sigma$ are\n$\\{1,2\\}, \\dots, \\{2n-1,2n\\}$; note that $\\sgn(\\sigma) = (-1)^n$. Then $E_\\sigma$ is the expected value of\n$\\prod_{i=1}^n -(A_{(2i-1)2i} - A_{2i(2i-1)})^2$, which is $(-1)^n$ times the $n$-th power\nof the expected value of $(A_{12} - A_{21})^2$. Since $A_{12} - A_{21}$ takes the values $-1, 0, 1$ with probabilities $\\frac{1}{4}, \\frac{1}{2}, \\frac{1}{4}$, its square takes the values\n$0,1$ with probabilities $\\frac{1}{2}, \\frac{1}{2}$; we conclude that\n\\[\nE_\\sigma = 2^{-n}.\n\\]\nThe permutations $\\sigma$ of this form correspond to unordered partitions of $\\{1,\\dots,2n\\}$ into $n$ sets of size 2, so there are\n\\[\n\\frac{(2n)!}{n!(2!)^n}\n\\]\nsuch permutations. Putting this all together yields the claimed result.\n\n\\noindent\n\\textbf{Second solution:}\n(by Manjul Bhargava)\nNote that the matrix $A-A^t$ is skew-symmetric: \n\\[\n(A-A^t)^t = A^t-A = -(A-A^t).\n\\]\nThe determinant of a $2n \\times 2n$ skew-symmetric matrix $M$ is the square of the {\\it Pfaffian} of $M$, which is a polynomial of degree $n$ in the entries of $M$ defined as follows. Define a {\\it perfect matching} of $\\{1,\\ldots,2n\\}$ to be a permutation of $\\{1,\\ldots,2n\\}$ that is the product of $n$ disjoint transpositions. Then the Pfaffian of $M$ is given by\n\\begin{equation}\\label{pfaffeq}\n\\sum_{\\alpha} \\sgn(\\alpha) M_{i_1,j_1}\\cdots M_{i_n,j_n}\n\\end{equation}\nwhere the sum is over perfect matchings $\\alpha=(i_1,j_1)\\cdots(i_n,j_n)$,\nand $\\sgn(\\alpha)$ denotes the sign of the permutation\n$\\left(\\begin{smallmatrix}\n1&2&3&4&\\cdots & (2n-1)&2n \\\\\ni_1&j_1&i_2&j_2& \\cdots & i_n & j_n\n\\end{smallmatrix} \\right)$.\nThe determinant of $M$ is then the square of \\eqref{pfaffeq}, i.e.,\n\\begin{equation}\\label{deteq} \\det(M)=\\sum_{\\alpha,\\beta} \\sgn(\\alpha)\\sgn(\\beta) M_{i_1,j_1}\\cdots M_{i_n,j_n}M_{i'_1,j'_1}\\cdots M_{i'_n,j'_n}\n\\end{equation}\nwhere the sum is now over ordered pairs $$(\\alpha=(i_1,j_1)\\cdots(i_n,j_n),\\beta=(i'_1,j'_1)\\cdots(i'_n,j'_n))$$ of perfect matchings.\n\nTaking $M = A - A^t$, so that $M_{ij} = A_{ij} - A_{ji}$,\nwe wish to find the expected value of \\eqref{deteq}; again, this is the sum of the expected values of each summand in \\eqref{deteq}. Note that each $M_{ij}$ with $i < j$ is an independent random variable taking the values $-1,0,1$ with probabilities $\\frac14,\\frac12,\\frac14$, respectively.\n\nConsider first a summand in \\eqref{deteq} with $\\alpha\\neq \\beta$. Then some factor $M_{ij}$  occurs with exponent 1; since the distribution of $M_{ij}$ is symmetric about 0, any such summand has expected value 0.\n\nConsider next a summand in \\eqref{deteq} with $\\alpha= \\beta$. This summand is a product of distinct factors of the form $M_{ij}^2$; from the distributions of the $M_{ij}$, we see that the expected value of each of these terms is $1/2^n$.\n\nSince the total number of perfect matchings $\\alpha$ is $(2n)!/(2^nn!)$, the expected value of $(\\ref{deteq})$ is therefore $(2n)!/(2^nn!)\\cdot 1/2^n=(2n)!/(4^nn!)$, as desired.", "category": "Algebra", "source": "PUTNAM", "year": 2016}
{"id": "putnam-2016-b5", "question": "Find all functions $f$ from the interval $(1, \\infty)$ to $(1, \\infty)$ with the following property:\nif $x,y \\in (1, \\infty)$ and $x^2 \\leq y \\leq x^3$, then $(f(x))^2 \\leq f(y) \\leq (f(x))^3$.", "solution": "It is obvious that for any $c>0$, the function $f(x) = x^c$ has the desired property; we will prove that conversely, any function with the desired property has this form for some $c$.\n\nDefine the function $g: (0, \\infty) \\to (0, \\infty)$ given by\n$g(x) = \\log f(e^x)$; this function has the property that if $x,y \\in (0, \\infty)$\nand $2x \\leq y \\leq 3x$, then $2g(x) \\leq g(y) \\leq 3g(x)$. \nIt will suffice to show that there exists $c>0$ such that $g(x) = cx$ for all $x >0$.\n\nSimilarly, define the function $h: \\RR \\to \\RR$ given by\n$h(x) = \\log g(e^x)$; this function has the property that if $x,y \\in \\RR$\nand $x + \\log 2 \\leq y \\leq x + \\log 3$, then $h(x) + \\log 2 \\leq h(y) \\leq h(x) + \\log 3$. \nIt will suffice to show that there exists $c>0$ such that $h(x) = x + c$ for all $x \\in \\RR$\n(as then $h(x) = e^c x$ for all $x>0$).\n\nBy interchanging the roles of $x$ and $y$, we may restate the condition on $h$ as follows:\nif $x - \\log 3 \\leq y \\leq x - \\log 2$, then $h(x) - \\log 3 \\leq h(y) \\leq h(x) - \\log 2$. \nThis gives us the cases $a+b=0,1$ of the following statement, which we will establish in full by induction on $a+b$: for any nonnegative integers $a,b$, for all $x,y \\in \\RR$ such that\n\\[\nx + a \\log 2 - b \\log 3 \\leq y \\leq x + a \\log 3 - b \\log 2,\n\\]\nwe have\n\\[\nh(x) + a \\log 2 - b \\log 3 \\leq h(y) \\leq h(x) + a \\log 3 - b \\log 2.\n\\]\nTo this end, suppose that $a+b>0$ and that the claim is known for all smaller values of $a+b$. In particular, either $a>0$ or $b>0$; the two cases are similar, so we treat only the first one. Define the function\n\\[\nj(t) = \\frac{(a+b-1)t - b(\\log 2 + \\log 3)}{a+b},\n\\]\nso that\n\\begin{gather*}\nj(a \\log 2 - b \\log 3) = (a-1) \\log 2 - b \\log 3, \\\\\nj(a \\log 3 - b \\log 2) = (a-1) \\log 3 - b \\log 2.\n\\end{gather*}\nFor $t \\in [a \\log 2 - b \\log 3, a \\log 3 - b \\log 2]$ and $y = x+t$,\nwe have $\\log 2 \\leq t-j(t) \\leq \\log 3$ and hence\n\\begin{gather*}\n(a-1) \\log 2 - b \\log 3 \\leq h(x+j(t)) - h(x) \\leq (a-1) \\log 3 - b \\log 2 \\\\\n\\log 2 \\leq h(y)-h(x+j(t)) \\leq \\log 3; \n\\end{gather*}\nthis completes the induction.\n\nNow fix two values $x,y \\in \\RR$ with $x \\leq y$. Since $\\log 2$ and $\\log 3$ are linearly independent over $\\QQ$, the fractional parts of the nonnegative integer multiples of $\\log 3/\\log 2$ are dense in $[0,1)$. (This result is due to Kronecker; a stronger result of Weyl shows that the fractional parts are uniformly distributed in $[0,1)$.)\nIn particular, for any $\\epsilon > 0$ and any $N > 0$, we can find integers $a,b > N$ such that\n\\[\ny-x < a \\log 3 - b \\log 2 < y-x + \\epsilon.\n\\]\nBy writing\n\\begin{align*}\na \\log 2 - b \\log 3& = \\frac{\\log 2}{\\log 3}(a \\log 3 - b \\log 2) \\\\\n&\\,\\,- b \\frac{(\\log 3)^2 - (\\log 2)^2}{\\log 3},\n\\end{align*}\nwe see that this quantity tends to $-\\infty$ as $N \\to \\infty$; in particular, for $N$ sufficiently large we have that $a \\log 2 - b \\log 3 < y-x$. We thus have\n$h(y) \\leq h(x) + a \\log 2 - b \\log 3 < y-x + \\epsilon$; since $\\epsilon>0$ was chosen arbitrarily, we deduce that $h(y)-h(x) \\leq y-x$. A similar argument shows that $h(y)-h(x) \\geq y-x$; we deduce that $h(y) - h(x) = y-x$, or equivalently $h(y)-y = h(x) - x$. In other words, the function $x \\mapsto h(x) - x$ is constant, as desired.", "category": "Algebra", "source": "PUTNAM", "year": 2016}
{"id": "putnam-2016-b6", "question": "Evaluate\n\\[\n\\sum_{k=1}^\\infty \\frac{(-1)^{k-1}}{k} \\sum_{n=0}^\\infty \\frac{1}{k2^n + 1}.\n\\]\n\\end{itemize}\n\n\\end{document}", "solution": "Let $S$ denote the desired sum. We will prove that $S=1$.\n\n\\noindent\n\\textbf{First solution:}\nWrite\n\\[\n\\sum_{n=0}^\\infty \\frac{1}{k2^n+1} = \\frac{1}{k+1} + \\sum_{n=1}^\\infty \\frac{1}{k2^n+1}; \n\\]\nthen we may write $S = S_1+S_2$ where \n\\begin{align*} \nS_1 &= \\sum_{k=1}^\\infty \\frac{(-1)^{k-1}}{k(k+1)} \\\\\nS_2 &= \\sum_{k=1}^\\infty \\frac{(-1)^{k-1}}{k} \\sum_{n=1}^\\infty \\frac{1}{k2^n+1}.\n\\end{align*}\nThe rearrangement is valid because both $S_1$ and $S_2$ converge absolutely in $k$, by comparison to $\\sum 1/k^2$.\n\nTo compute $S_1$, note that \n\\begin{align*}\n\\sum_{k=1}^N \\frac{(-1)^{k-1}}{k(k+1)} &= \\sum_{k=1}^N  (-1)^{k-1}\\left(\\frac{1}{k}-\\frac{1}{k+1} \\right) \\\\\n&= -1+\\frac{(-1)^N}{N+1}+2\\sum_{k=1}^N \\frac{(-1)^{k-1}}{k}\n\\end{align*}\nconverges to $2\\ln 2-1$ as $N\\to\\infty$, and so $S_1 = 2\\ln 2-1$.\n\nTo compute $S_2$, write $\\frac{1}{k2^n+1} = \\frac{1}{k2^n}\\cdot \\frac{1}{1+1/(k2^n)}$ as the geometric series $\\sum_{m=0}^\\infty \\frac{(-1)^m}{k^{m+1} 2^{mn+n}}$, whence\n\\[\nS_2 = \\sum_{k=1}^\\infty \\sum_{n=1}^\\infty \\sum_{m=0}^\\infty \\frac{(-1)^{k+m-1}}{k^{m+2} 2^{mn+n}}.\n\\]\n(This step requires $n \\geq 1$, as otherwise the geometric series would not converge for $k=0$.)\nNow note that this triple sum converges absolutely: we have\n\\begin{align*}\n\\sum_{m=0}^\\infty \\frac{1}{k^{m+2} 2^{mn+n}} &= \n\\frac{1}{k^2 2^n} \\cdot \\frac{1}{1-\\frac{1}{k 2^n}} \\\\\n&= \\frac{1}{k(k2^n-1)} \\leq \\frac{1}{k^2 2^{n-1}}\n\\end{align*}\nand so\n\\begin{align*}\n\\sum_{k=1}^\\infty \\sum_{n=1}^\\infty \\sum_{m=0}^\\infty \\frac{1}{k^{m+2} 2^{mn+n}} &\\leq\n\\sum_{k=1}^\\infty \\sum_{n=1}^\\infty  \\frac{1}{k^2 2^{n-1}}\\\\\n &= \\sum_{k=1}^\\infty \\frac{2}{k^2} < \\infty.\n \\end{align*}\n\nThus we can rearrange the sum to get\n\\[\nS_2 = \\sum_{m=0}^\\infty (-1)^m \\left( \\sum_{n=1}^\\infty \\frac{1}{2^{mn+n}}\\right) \\left(\\sum_{k=1}^\\infty \n\\frac{(-1)^{k-1}}{k^{m+2}} \\right).\n\\]\nThe sum in $n$ is the geometric series \n\\[\n\\frac{1}{2^{m+1}(1-\\frac{1}{2^{m+1}})} = \\frac{1}{2^{m+1}-1}.\n\\]\nIf we write the sum in $k$ as $S_3$, then note that\n\\[\n\\sum_{k=1}^\\infty \\frac{1}{k^{m+2}} = S_3 + 2 \\sum_{k=1}^\\infty \\frac{1}{(2k)^{m+2}}\n= S_3 + \\frac{1}{2^{m+1}} \\sum_{k=1}^\\infty \\frac{1}{k^{m+2}}\n\\]\n(where we can rearrange terms in the first equality because all of the series converge absolutely), and so \n\\[\nS_3 = \\left(1-\\frac{1}{2^{m+1}}\\right)  \\sum_{k=1}^\\infty \\frac{1}{k^{m+2}}.\n\\]\nIt follows that\n\\begin{align*}\nS_2 &= \\sum_{m=0}^\\infty \\frac{(-1)^m}{2^{m+1}} \\sum_{k=1}^\\infty \\frac{1}{k^{m+2}} \\\\\n&= \\sum_{k=1}^\\infty \\frac{1}{2k^2} \\sum_{m=0}^\\infty \\left(-\\frac{1}{2k}\\right)^m \\\\\n&= \\sum_{k=1}^\\infty \\frac{1}{k(2k+1)} \\\\\n&= 2 \\sum_{k=1}^\\infty \\left( \\frac{1}{2k} - \\frac{1}{2k+1} \\right) = 2(1-\\ln 2).\n\\end{align*}\nFinally, we have $S = S_1 + S_2 = 1$.\n\n\\noindent\n\\textbf{Second solution:}\n(by Tewodros Amdeberhan)\nSince $\\int_0^1 x^t\\,dx = \\frac{1}{1+t}$ for any $t \\geq 1$, we also have\n\\[\nS = \\sum_{k=1}^\\infty  \\sum_{n=0}^\\infty \\frac{(-1)^{k-1}}{k} \\int_0^1 x^{k2^n}\\,dx.\n\\]\nAgain by absolute convergence, we are free to permute the integral and the sums:\n\\begin{align*}\nS &= \\int_0^1 dx\\, \\sum_{n=0}^\\infty \\sum_{k=1}^\\infty \\frac{(-1)^{k-1}}{k} x^{k2^n} \\\\\n&= \\int_0^1 dx\\, \\sum_{n=0}^\\infty \\log (1 + x^{2^n}).\n\\end{align*}\nDue to the uniqueness of binary expansions of nonnegative integers, we have the identity\nof formal power series\n\\[\n\\frac{1}{1 - x} = \\prod_{n=0}^\\infty (1 + x^{2^n});\n\\]\nthe product converges absolutely for $0 \\leq x < 1$. We thus have\n\\begin{align*}\nS &= -\\int_0^1 \\log (1-x)\\,dx \\\\\n&= \\left((1-x) \\log (1-x) - (1-x)\\right)_0^1 \\\\\n&= 1.\n\\end{align*}\n\n\\noindent\n\\textbf{Third solution:}\n(by Serin Hong)\nAgain using absolute convergence, we may write\n\\[\nS = \\sum_{m=2}^\\infty \\frac{1}{m} \\sum_{k} \\frac{(-1)^{k-1}}{k}\n\\]\nwhere $k$ runs over all positive integers for which $m = k2^n+1$ for some $n$.\nIf we write $e$ for the 2-adic valuation of $m-1$ and $j = (m-1)2^{-e}$ for the odd part of $m-1$, then the values of $k$ are $j 2^i$ for $i=0,\\dots,e$. The inner sum can thus be evaluated as\n\\[\n\\frac{1}{j} - \\sum_{i=1}^e \\frac{1}{2^i j}\n= \\frac{1}{2^e j} = \\frac{1}{m-1}.\n\\]\nWe thus have\n\\[\nS = \\sum_{m=2}^\\infty \\frac{1}{m(m-1)} \\\\\n= \\sum_{m=2}^\\infty \\left( \\frac{1}{m-1} - \\frac{1}{m} \\right) \\\\\n= 1.\n\\]\n\n\\noindent\n\\textbf{Fourth solution:}\n(by Liang Xiao)\nLet $S_0$ and $S_1$ be the sums $\\sum_k \\frac{1}{k} \\sum_{n=0}^\\infty \\frac{1}{k2^n+1}$\nwith $k$ running over all odd and all even positive integers, respectively, so that \n\\[\nS = S_0 - S_1.\n\\]\nIn $S_1$, we may write $k = 2\\ell$ to obtain\n\\begin{align*}\nS_1 &= \\sum_{\\ell=1}^\\infty \\frac{1}{2\\ell} \\sum_{n=0}^\\infty \\frac{1}{\\ell 2^{n+1} + 1} \\\\\n&= \\frac{1}{2} (S_0 + S_1) - \\sum_{\\ell=1}^\\infty \\frac{1}{2\\ell(\\ell+1)} \\\\\n&= \\frac{1}{2} (S_0 + S_1) - \\frac{1}{2}\n\\end{align*}\nbecause the last sum telescopes; this immediately yields $S = 1$.\n\n\\end{itemize}\n\\end{document}", "category": "Number Theory", "source": "PUTNAM", "year": 2016}
{"id": "imo-2002-q1", "question": "Let $n$ be a positive integer.\nLet $T$ be the set of points $(x,y)$ in the plane\nwhere $x$ and $y$ are non-negative integers with $x+y<n$.\nEach point of $T$ is coloured red or blue, subject to the following condition:\nif a point $(x,y)$ is red,\nthen so are all points $(x',y')$ of $T$ with $x'\\leq x$ and $y'\\leq y$.\nLet $A$ be the number of ways to choose $n$ blue points with distinct $x$-coordinates,\nand let $B$ be the number of ways to choose $n$ blue points with distinct $y$-coordinates.\nProve that $A=B$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p118710}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n$ be a positive integer.\nLet $T$ be the set of points $(x,y)$ in the plane\nwhere $x$ and $y$ are non-negative integers with $x+y<n$.\nEach point of $T$ is coloured red or blue, subject to the following condition:\nif a point $(x,y)$ is red,\nthen so are all points $(x',y')$ of $T$ with $x'\\leq x$ and $y'\\leq y$.\nLet $A$ be the number of ways to choose $n$ blue points with distinct $x$-coordinates,\nand let $B$ be the number of ways to choose $n$ blue points with distinct $y$-coordinates.\nProve that $A=B$.\n\\end{mdframed}\nLet $a_x$ denote the number of blue points\nwith a given $x$-coordinate.\nDefine $b_y$ to be the number of blue points\nwith a given $y$-coordinate.\n\nWe actually claim that\n\\begin{claim*}\nThe multisets $\\mathcal A \\coloneq \\{ a_x \\mid x \\}$\nand $\\mathcal B \\coloneq \\{ b_y \\mid y \\}$ are equal.\n\\end{claim*}\n\\begin{proof}\nBy induction on the number of red points.\nIf there are no red points at all,\nthen $\\mathcal A = \\mathcal B = \\{1, \\dots, n\\}$.\n\\begin{center}\n\\begin{asy}\nsize(5cm);\ndraw( (1,5)--(1,2)--(4,2), lightgreen );\nfor (int i=0; i<=6; ++i) {\nfor (int j=0; j<=6-i; ++j) {\ndot( (i,j), blue+1.5 );\n}\n}\ndot( (0,0), red+3 );\ndot( (1,0), red+3 );\ndot( (2,0), red+3 );\ndot( (3,0), red+3 );\ndot( (0,1), red+3 );\ndot( (1,1), red+3 );\ndot( (0,2), red+3 );\ndot( (1,2), red+4 );\ndot( (0,3), red+3 );\ndot( (0,4), red+3 );\ndraw(circle( (1,2), 0.2 ), red );\n\\end{asy}\n\\end{center}\nThe proof consists of two main steps.\nFirst, suppose we color a single point $P = (x,y)$\nfrom blue to red (while preserving the condition).\nBefore the coloring, we have $a_x = b_y = n-(x+y)$;\nafterwards $a_x = b_y = n-(x+y)-1$\nand no other numbers change, as desired.\n\nWe also must show that this operation\n(repeatedly adding a single point $P$) reaches all\npossible shapes of red points.\nThis is well-known as the red points form a Young tableaux;\nfor example, one way is to add all the points with $x=0$\nfirst one by one, then all the points with $x=1$, and so on.\nSo the induction implies the result.\n\\end{proof}\nFinally, \\[ A = \\prod_{x=0}^{n-1} a_x = \\prod_{y=0}^{n-1} b_y = B. \\]\n\\pagebreak", "category": "Combinatorics", "source": "IMO", "year": 2002}
{"id": "imo-2002-q2", "question": "Let $BC$ be a diameter of circle $\\omega$ with center $O$. Let $A$ be a point\nof circle $\\omega$ such that $0^\\circ < \\angle AOB < 120^\\circ$. Let $D$ be the midpoint\nof arc $AB$ not containing $C$. Line $\\ell$ passes through $O$ and is\nparallel to line $AD$. Line $\\ell$ intersects line $AC$ at $J$.\nThe perpendicular bisector of segment $OA$ intersects circle $\\omega$ at $E$\nand $F$. Prove that $J$ is the incenter of triangle $CEF$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p118672}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $BC$ be a diameter of circle $\\omega$ with center $O$. Let $A$ be a point\nof circle $\\omega$ such that $0^\\circ < \\angle AOB < 120^\\circ$. Let $D$ be the midpoint\nof arc $AB$ not containing $C$. Line $\\ell$ passes through $O$ and is\nparallel to line $AD$. Line $\\ell$ intersects line $AC$ at $J$.\nThe perpendicular bisector of segment $OA$ intersects circle $\\omega$ at $E$\nand $F$. Prove that $J$ is the incenter of triangle $CEF$.\n\\end{mdframed}\nBy construction, $AEOF$ is a rhombus with $60\\dg$-$120\\dg$ angles.\nConsequently, we may set $s = AO = AE = AF = EO = EF$.\n\\begin{center}\n\\begin{asy}\npair B = dir(0);\npair C = dir(180);\npair D = dir(37);\npair A = D*D;\npair E = dir(60)*A;\npair F = dir(-60)*A;\npair O = origin;\npair J = A+O-D;\nfilldraw(unitcircle, opacity(0.1)+lightcyan, heavycyan);\n\nfilldraw(A--B--C--cycle, opacity(0.1)+lightcyan, heavycyan);\ndraw(A--D, red);\ndraw(O--J, red);\nfilldraw(C--E--F--cycle, opacity(0.1)+green, heavygreen);\nfilldraw(A--E--O--F--cycle, opacity(0.1)+lightblue, blue);\ndraw(E--F, blue);\ndraw(A--O, blue);\n\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$D$\", D, dir(D));\ndot(\"$A$\", A, dir(A));\ndot(\"$E$\", E, dir(E));\ndot(\"$F$\", F, dir(F));\ndot(\"$O$\", O, dir(-90));\ndot(\"$J$\", J, dir(J));\n\n/* TSQ Source:\n\nB = dir 0\nC = dir 180\nD = dir 37\nA = D*D\nE = dir(60)*A\nF = dir(-60)*A\nO = origin R-90\nJ = A+O-D\nunitcircle 0.1 lightcyan / heavycyan\n\nA--B--C--cycle 0.1 lightcyan / heavycyan\nA--D red\nO--J red\nC--E--F--cycle 0.1 green / heavygreen\nA--E--O--F--cycle 0.1 lightblue / blue\nE--F blue\nA--O blue\n\n*/\n\\end{asy}\n\\end{center}\n\\begin{claim*}\n  We have $AJ = s$ too.\n\\end{claim*}\n\\begin{proof}\n  It suffices to show $AJ = AO$ which is angle chasing.\n  Let $\\theta = \\angle BOD = \\angle DOA$,\n  so $\\angle BOA = 2\\theta$.\n  Thus $\\angle CAO = \\half \\angle BOA = \\theta$.\n  However $\\angle AOJ = \\angle OAD = 90\\dg - \\half \\theta$,\n  as desired.\n\\end{proof}\nThen, since $AE = AJ = AF$,\nwe are done by the infamous Fact 5.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2002}
{"id": "imo-2002-q3", "question": "Find all pairs of positive integers $m, n \\ge 3$ for which there exist infinitely many\npositive integers $a$ such that\n\\[ \\frac{a^m+a-1}{a^n+a^2-1} \\]\nis itself an integer.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p118695}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all pairs of positive integers $m, n \\ge 3$ for which there exist infinitely many\npositive integers $a$ such that\n\\[ \\frac{a^m+a-1}{a^n+a^2-1} \\]\nis itself an integer.\n\\end{mdframed}\nThe condition is equivalent to $a^n+a^2-1$\ndividing $a^m+a-1$ as polynomials.\nThe big step is the following analytic one.\n\n\\begin{claim*}\n  We must have $m \\le 2n$.\n\\end{claim*}\n\\begin{proof}\n  Assume on contrary $m > 2n$\n  and let $0 < r < 1$ be the unique real number\n  with $r^n+r^2 = 1$, hence $r^m+r = 1$.\n  But now\n  \\begin{align*}\n    0 &= r^m + r - 1 \\le r^{2n+1} + r - 1 \\\\\n    &= r\\left( (1-r^2)^2+1 \\right) - 1 \\\\\n    &= -(1-r)\\left( r^4+r^3-r^2-r+1 \\right) \\\\\n    &= -(1-r)\\left( r^4 + (1-r)(1-r^2) \\right).\n  \\end{align*}\n  Hewer, $1-r > 0$ and $r^4 + (1-r)(1-r^2) > 0$ are both obvious for $0 < r < 1$.\n  So this is a contradiction.\n\\end{proof}\n\nNow for the algebraic part.\nObviously $m > n$.\n\\begin{align*}\n  a^n+a^2-1 &\\mid a^m+a-1 \\\\\n  \\iff a^n+a^2-1 &\\mid (a^m+a-1)(a+1) = a^m(a+1) + (a^2-1)  \\\\\n  \\iff a^n+a^2-1 &\\mid a^m(a+1) - a^n \\\\\n  \\iff a^n+a^2-1 &\\mid a^{m-n}(a+1) - 1.\n\\end{align*}\nThe right-hand side has degree $m-n+1 \\le n+1$,\nand the leading coefficients are both $+1$.\nSo the only possible situations are\n\\begin{align*}\n  a^{m-n}(a+1) - 1 &= (a+1)\\left( a^n+a^2-1 \\right) \\\\\n  a^{m-n}(a+1) + 1 &=  a^n+a^2-1.\n\\end{align*}\nThe former fails by just taking $a=-1$;\nthe latter implies $(m,n) = (5,3)$.\nAs our work was reversible, this also implies $(m,n) = (5,3)$ works, done.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Number Theory", "source": "IMO", "year": 2002}
{"id": "imo-2002-q4", "question": "Let $n \\ge 2$ be a positive integer\nwith divisors $1 = d_1 < d_2 < \\dots < d_k = n$.\nProve that $d_1d_2 + d_2d_3 + \\dots + d_{k-1} d_k$ is always less than $n^2$,\nand determine when it is a divisor of $n^2$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p118687}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n \\ge 2$ be a positive integer\nwith divisors $1 = d_1 < d_2 < \\dots < d_k = n$.\nProve that $d_1d_2 + d_2d_3 + \\dots + d_{k-1} d_k$ is always less than $n^2$,\nand determine when it is a divisor of $n^2$.\n\\end{mdframed}\nWe always have\n\\begin{align*}\n  d_k d_{k-1} + d_{k-1} d_{k-2} + \\dots + d_2 d_1\n  &< n \\cdot \\frac n2 + \\frac n2 \\cdot \\frac n3 + \\dots \\\\\n  &= \\left( \\frac{1}{1 \\cdot 2} + \\frac{1}{2 \\cdot 3} + \\dots \\right) n^2 = n^2.\n\\end{align*}\nThis proves the first part.\n\nFor the second, we claim that this only happens\nwhen $n$ is prime (in which case we get $d_1 d_2 = n$).\nAssume $n$ is not prime (equivalently $k \\ge 2$)\nand let $p$ be the smallest prime dividing $n$.\nThen\n\\[ d_k d_{k-1} + d_{k-1} d_{k-2} + \\dots + d_2 d_1\n  > d_k d_{k-1} = \\frac{n^2}{p} \\]\nexceeds the largest proper divisor of $n^2$,\nbut is less than $n^2$, so does not divide $n^2$.\n\\pagebreak", "category": "Number Theory", "source": "IMO", "year": 2002}
{"id": "imo-2002-q5", "question": "Find all functions $f \\colon \\RR \\to \\RR$ such that\n\\[ \\left(f(x)+f(z)\\right)\\left(f(y)+f(t)\\right)\n  = f(xy-zt)+f(xt+yz) \\]\nfor all real numbers $x$, $y$, $z$, $t$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p118703}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all functions $f \\colon \\RR \\to \\RR$ such that\n\\[ \\left(f(x)+f(z)\\right)\\left(f(y)+f(t)\\right)\n  = f(xy-zt)+f(xt+yz) \\]\nfor all real numbers $x$, $y$, $z$, $t$.\n\\end{mdframed}\nThe answer is $f(x) \\equiv 0$, $f(x) \\equiv 1/2$\nand $f(x) \\equiv x^2$ which are easily seen to work.\nLet's prove they are the only ones;\nwe show two solutions.\n\n\\paragraph{First solution (multiplicativity).}\nLet $P(x,y,z,t)$ denote the given statement.\n\\begin{itemize}\n  \\ii By comparing $P(x,1,0,0)$ and $P(0,0,1,x)$\n  we get $\\boxed{f \\text{ even}}$.\n  \\ii By $P(0,y,0,t)$ we get for nonconstant $f$\n  that $f(0) = 0$.\n  If $f$ is constant we get the solutions earlier,\n  so in the sequel assume $\\boxed{f(0) = 0}$.\n  \\ii By $P(x,y,0,0)$ we get $\\boxed{f(xy) = f(x) f(y)}$.\n  Note in particular that for any real number $x$ we now have\n  \\[ f(x) = f(|x|) = f\\left( \\sqrt{|x|} \\right)^2 \\ge 0 \\]\n  that is, $f \\ge 0$.\n\\end{itemize}\n\nFrom $P(x,y,y,x)$ we now have\n\\[ f(x^2 + y^2) = \\left( f(x) + f(y) \\right)^2\n  = f(x^2) + 2f(x)f(y) + f(y^2) \\ge f(x^2) \\]\nso $f$ is weakly increasing.\nCombined with $f$ multiplicative and nonconstant,\nthis implies $f(x) = |x|^r$ for some real number $r$.\n\nFinally, $P(1,1,1,1)$ gives $f(2) = 4f(1)$,\nso $f(x) \\equiv x^2$.\n\n\\paragraph{Second solution (ELMO).}\nLet $P(x,y,z,t)$ denote the statement.\nAssume $f$ is nonconstant,\nas before we derive that $f$ is even, $f(0) = 0$,\nand $f(x) \\ge 0$ for all $x$.\n\nNow comparing $P(x,y,z,t)$ and $P(z,y,x,t)$ we obtain\n\\[ f(xy-zt) + f(xt+yz) =\n  \\left( f(x)+f(z) \\right)\n  \\left( f(y)+f(t) \\right)\n  = f(xy+zt) + f(xt-yz) \\]\nwhich in particular implies that\n\\[ f(a-d) + f(b+c) = f(a+d) + f(b-c)\n\\qquad \\text{ if } ad=bc \\text{ and } a,b,c,d > 0. \\]\nThus the restriction of $f$ to $(0,\\infty)$ satisfies\n\\textbf{ELMO 2011, problem 4}\nwhich implies that $f(x) = kx^2+\\ell$ for constants $k$ and $\\ell$.\nFrom here we recover the original.\n\n(Minor note: technically ELMO 2011/4 is $f \\colon (0,\\infty) \\to (0,\\infty)$\nbut we only have $f \\ge 0$,\nhowever the proof for the ELMO problem\nworks as long as $f$ is bounded below;\nwe could also just apply the ELMO problem to $f+0.01$ instead.)\n\\pagebreak", "category": "Algebra", "source": "IMO", "year": 2002}
{"id": "imo-2002-q6", "question": "Let $n \\ge 3$ be a positive integer.\nLet $C_1$, $C_2$, \\dots, $C_n$ be unit circles in the plane,\nwith centers $O_1$, $O_2$, \\dots, $O_n$ respectively.\nIf no line meets more than two of the circles, prove that\n\\[ \\sum_{1 \\le i < j \\le n } \\frac{1}{O_i O_j}\n  \\le \\frac{(n-1)\\pi}{4}. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p118677}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n \\ge 3$ be a positive integer.\nLet $C_1$, $C_2$, \\dots, $C_n$ be unit circles in the plane,\nwith centers $O_1$, $O_2$, \\dots, $O_n$ respectively.\nIf no line meets more than two of the circles, prove that\n\\[ \\sum_{1 \\le i < j \\le n } \\frac{1}{O_i O_j}\n  \\le \\frac{(n-1)\\pi}{4}. \\]\n\\end{mdframed}\nFor brevity, let $d_{ij}$ be the length of $O_{ij}$\nand let $\\angle(ijk)$ be shorthand for $\\angle O_i O_j O_k$\n(or its measure in radians).\n\nFirst, we eliminate the circles completely\nand reduce the problem to angles using the following fact\n(which is in part motivated by the mysterious\npresence of $\\pi$ on right-hand side,\nand also brings $d_{ij}\\inv$ into the picture).\n\n\\begin{lemma*}\n  For any indices $i$, $j$, $m$ we have the inequalities\n  \\[ \\angle (imj) \\ge\n      \\max \\left( \\frac{2}{d_{mi}}, \\frac{2}{d_{mj}} \\right)\n      \\quad\\text{and}\\quad\n    \\pi - \\angle (imj) \\ge\n    \\max \\left( \\frac{2}{d_{mi}}, \\frac{2}{d_{mj}} \\right). \\]\n\\end{lemma*}\n\\begin{proof}\n  We first prove the former line.\n  Consider the altitude from $O_i$ to $O_m O_j$.\n  The altitude must have length at least $2$,\n  otherwise its perpendicular bisector passes\n  intersects all of $C_i$ , $C_m$, $C_j$.\n  Thus\n  \\[ 2 \\le d_{mi} \\sin \\angle(imj) \\le \\angle(imj) \\]\n  proving the first line.\n  The second line follows by considering the external\n  angle formed by lines $O_m O_i$ and $O_m O_j$\n  instead of the internal one.\n\\end{proof}\n\nOur idea now is for any index $m$\nwe will make an estimate on\n$\\sum_{\\substack{1 \\le i \\le n \\\\ i \\neq b}} \\frac{1}{d_{bi}}$\nfor each index $b$.\nIf the centers formed a convex polygon,\nthis would be much simpler,\nbut because we do not have this assumption some more care is needed.\n\n\\begin{claim*}\n  Suppose $O_a$, $O_b$, $O_c$ are consecutive vertices\n  of the convex hull.\n  Then\n  \\[ \\frac{n-1}{n-2} \\dang(abc) \\ge \\frac{2}{d_{1b}} + \\frac{2}{d_{2b}}\n    + \\dots + \\frac{2}{d_{nb}} \\]\n  where the term $\\frac{2}{d_{bb}}$ does not appear (obviously).\n\\end{claim*}\n\n\\begin{proof}\n  WLOG let's suppose $(a,b,c) = (2,1,n)$ and\n  that rotating ray $O_2 O_1$ hits $O_3$, $O_4$, \\dots, $O_n$\n  in that order.\n  We have\n  \\begin{align*}\n    \\frac{2}{d_{12}} &\\le \\angle(213) \\\\\n    \\frac{2}{d_{13}} &\\le \\min \\left\\{ \\angle(213), \\angle(314) \\right\\} \\\\\n    \\frac{2}{d_{14}} &\\le \\min \\left\\{ \\angle(314), \\angle(415) \\right\\} \\\\\n    &\\vdotswithin=  \\\\\n    \\frac{2}{d_{1(n-1)}} &\\le\n      \\min \\left\\{ \\angle((n-2)1(n-1)), \\angle((n-1)1n) \\right\\} \\\\\n    \\frac{2}{d_{1n}} &\\le \\angle\\left( (n-1) 1 n \\right).\n  \\end{align*}\n  Of the $n-1$ distinct angles appearing on the right-hand side,\n  we let $\\kappa$ denote the smallest of them.\n  We have $\\kappa \\le \\frac{1}{n-2} \\angle(21n)$\n  by pigeonhole principle.\n  Then we pick the minimums on the right-hand side in\n  the unique way such that summing gives\n  \\begin{align*}\n    \\sum_{i=2}^n \\frac{2}{d_{1i}}\n    &\\ge \\left( \\angle(213)+\\angle(314)+\\dots+\\angle( (n-1)1n ) \\right)\n      + \\kappa \\\\\n    &\\ge \\angle(21n) + \\frac{1}{n-2} \\angle(21n) = \\frac{n-1}{n-2} \\angle(21n)\n  \\end{align*}\n  as desired.\n\\end{proof}\n\n\nNext we show a bound that works for any center,\neven if it does not lie on the convex hull $\\mathcal H$.\n\\begin{claim*}\n  For any index $b$ we have\n  \\[ \\frac{n-1}{n-2} \\pi \\ge \\frac{2}{d_{1b}} + \\frac{2}{d_{2b}}\n    + \\dots + \\frac{2}{d_{nb}} \\]\n  where the term $\\frac{2}{d_{bb}}$ does not appear (obviously).\n\\end{claim*}\n\\begin{proof}\n  This is the same argument as in the previous proof,\n  with the modification that\n  because $O_b$ could lie inside the convex hull now,\n  our rotation argument should use lines instead of rays\n  (in order for the angle to be $\\pi$ rather than $2\\pi$).\n  This is why the first lemma is stated with two cases;\n  we need it now.\n\n  Again WLOG $b=1$.\n  Consider line $O_{1} O_2$ (rather than just the ray)\n  and imagine rotating it counterclockwise through $O_2$;\n  suppose that this line passes through $O_3$, $O_4$, \\dots, $O_{n}$\n  in that order before returning to $O_{2}$ again.\n  We let $\\dang (i1j) \\in \\{ \\angle (i1j), \\pi-\\angle(i1j) \\} \\in [0, \\pi)$ %chktex 9\n  be the counterclockwise rotations obtained in this way,\n  so that\n  \\[ \\dang(21n) = \\dang(213) + \\dang(314) +\n    + \\dots + \\dang((n-1)1n). \\]\n  (This is not ``directed angles'', but related.)\n\n  Then we get bounds\n  \\begin{align*}\n    \\frac{2}{d_{12}} &\\le \\dang(213) \\\\\n    \\frac{2}{d_{13}} &\\le \\min \\left\\{ \\dang(213), \\dang(314) \\right\\} \\\\\n    &\\vdotswithin=  \\\\\n    \\frac{2}{d_{1(n-1)}} &\\le\n      \\min \\left\\{ \\dang((n-2)1(n-1)), \\dang((n-1)1n) \\right\\} \\\\\n    \\frac{2}{d_{1n}} &\\le \\dang\\left\\{ (n-1) 1 n \\right\\}\n  \\end{align*}\n  as in the last proof, and so as before we get\n  \\[ \\sum_{i=1}^n \\frac{2}{d_{1i}} \\le \\frac{n-1}{n-2} \\dang(21n) \\]\n  which is certainly less than $\\frac{n-1}{n-2} \\pi$.\n\\end{proof}\n\nNow suppose there were $r$ vertices in the convex hull.\nIf we sum the first claim across all $b$ on the hull,\nand the second across all $b$ not on the hull (inside it),\nwe get\n\\begin{align*}\n  \\sum_{1 \\le i<j \\le n} \\frac{2}{d_{ij}}\n  &= \\half \\sum_b \\sum_{i \\neq b} \\frac{2}{d_{bi}} \\\\\n  &\\le \\half \\cdot \\frac{n-1}{n-2} \\left( (r-2)\\pi + (n-r)\\pi  \\right) \\\\\n  &= \\frac{(n-1)\\pi}{4}\n\\end{align*}\nas needed (with $(r-2)\\pi$ being the sum of angles in the hull).\n\\pagebreak\n\n\n\\end{document}", "category": "Geometry", "source": "IMO", "year": 2002}
{"id": "usamo-1999-q1", "question": "Some checkers placed on an $n \\times n$ checkerboard satisfy the following conditions:\n\\begin{enumerate}\n  \\ii[(a)] every square that does not contain a checker shares a side with one that does;\n  \\ii[(b)] given any pair of squares that contain checkers,\n  there is a sequence of squares containing checkers,\n  starting and ending with the given squares,\n  such that every two consecutive squares of the sequence share a side.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p340035}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nSome checkers placed on an $n \\times n$ checkerboard satisfy the following conditions:\n\\begin{enumerate}\n  \\ii[(a)] every square that does not contain a checker shares a side with one that does;\n  \\ii[(b)] given any pair of squares that contain checkers,\n  there is a sequence of squares containing checkers,\n  starting and ending with the given squares,\n  such that every two consecutive squares of the sequence share a side.\n\\end{enumerate}\nProve that at least $(n^{2}-2)/3$ checkers have been placed on the board.\n\\end{mdframed}\nTake a spanning tree on the set $V$ of checkers\nwhere the $|V|-1$ edges of the tree are given by orthogonal adjacency.\nBy condition (a) we have\n\\[ \\sum_{v \\in V} (4-\\deg v) \\ge n^2 - |V| \\]\nand since $\\sum_{v \\in V} \\deg v = 2(|V|-1)$ we get\n\\[ 4|V| - \\left( 2|V|-2 \\right) \\ge n^2 - |V| \\]\nwhich implies $|V| \\ge \\frac{n^2-2}{3}$.\n\\pagebreak", "category": "Combinatorics", "source": "USAMO", "year": 1999}
{"id": "usamo-1999-q2", "question": "Let $ABCD$ be a convex cyclic quadrilateral.\nProve that \\[ |AB - CD| + |AD - BC| \\geq 2|AC - BD|. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p340036}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABCD$ be a convex cyclic quadrilateral.\nProve that \\[ |AB - CD| + |AD - BC| \\geq 2|AC - BD|. \\]\n\\end{mdframed}\nLet the diagonals meet at $P$,\nand let $AP = pq$, $DP = pr$, $BP = qs$, $CP = rs$.\nThen set $AB = qx$, $CD = rx$, $AD = py$, $BC = sy$.\n\n\nIn this way we compute\n\\[ \\left\\lvert AC-BD \\right\\rvert\n  = \\left\\lvert (p-s)(q-r) \\right\\rvert  \\]\nand\n\\[ \\left\\lvert AB-CD \\right\\rvert\n  = \\left\\lvert q-r \\right\\rvert x. \\]\nBy triangle inequality on $\\triangle AXB$,\nwe have $x \\ge \\left\\lvert p-s \\right\\rvert$.\nSo $\\left\\lvert AB-CD \\right\\rvert \\ge \\left\\lvert AC-BD \\right\\rvert$.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 1999}
{"id": "usamo-1999-q3", "question": "Let $p > 2$ be a prime and let $a$, $b$, $c$, $d$ be integers not divisible by $p$,\nsuch that\n\\[ \\left\\{ \\dfrac{ra}{p} \\right\\} + \\left\\{ \\dfrac{rb}{p} \\right\\}\n  + \\left\\{ \\dfrac{rc}{p} \\right\\} + \\left\\{ \\dfrac{rd}{p} \\right\\} = 2  \\]\nfor any integer $r$ not divisible by $p$.\n(Here, $\\{t\\} = t - \\left\\lfloor t \\right\\rfloor$ is the fractional part.)\nProve that at least two of the numbers\n$a+b$, $a+c$, $a+d$, $b+c$, $b+d$, $c+d$ are divisible by $p$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p340038}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $p > 2$ be a prime and let $a$, $b$, $c$, $d$ be integers not divisible by $p$,\nsuch that\n\\[ \\left\\{ \\dfrac{ra}{p} \\right\\} + \\left\\{ \\dfrac{rb}{p} \\right\\}\n  + \\left\\{ \\dfrac{rc}{p} \\right\\} + \\left\\{ \\dfrac{rd}{p} \\right\\} = 2  \\]\nfor any integer $r$ not divisible by $p$.\n(Here, $\\{t\\} = t - \\left\\lfloor t \\right\\rfloor$ is the fractional part.)\nProve that at least two of the numbers\n$a+b$, $a+c$, $a+d$, $b+c$, $b+d$, $c+d$ are divisible by $p$.\n\\end{mdframed}\nFirst of all, we apparently have $r(a+b+c+d) \\equiv 0 \\pmod p$\nfor every prime $p$, so it automatically follows that $a+b+c+d \\equiv 0 \\pmod p$.\nBy scaling appropriately, and also replacing each number with its remainder modulo $p$,\nwe are going to assume that\n\\[ 1 = a \\le b \\le c \\le d < p. \\]\nWe are going to prove that $d = p-1$, which will solve the problem.\n\n\\begin{claim*}\n  For each integer $r = 1, 2, \\dots, p-1$ we have\n  \\[ 2(r-1) = \\left\\lfloor \\frac{rb}{p} \\right\\rfloor\n    + \\left\\lfloor \\frac{rc}{p} \\right\\rfloor\n    + \\left\\lfloor \\frac{rd}{p} \\right\\rfloor. \\]\n\\end{claim*}\n\\begin{proof}\n  By plugging in $r=1$ to the given we have $a+b+c+d=2p$.\n  Now, we have\n  \\[ 2 = \\sum_{\\text{cyc}} \\left( \\frac{ra}{p}\n    - \\left\\lfloor \\frac{ra}{p} \\right\\rfloor \\right) \\]\n  and since $a+b+c+d=2p$ the conclusion follows.\n\\end{proof}\n\n%We now define $x = b/p$, $y = c/p$, $z = d/p$.\n%Hence $0 < x \\le y \\le z < 1$.\n%Our goal it show that $z = (p-1)/p$.\n\nWe vaguely outline the approach now, before giving a formalization.\nImagine the interval $[0,1]$.\nOne by one, for each $r = 1, 2, 3, \\dots, p-1$,\nwe mark the fractions with denominator $r$ on this number line;\nthe resulting pictures may be better known as \\emph{Farey fractions}.\nAt each step, we can place the three numbers $b/p$, $c/p$, $d/p$\ninto one of the resulting sub-intervals.\nOur goal is to show that $d/p$ is always in the rightmost interval,\nwhile $b/p$ and $c/p$ are always to the right of symmetrically mirrored points.\nAn example of a possible diagram is shown below (not to scale).\n\\begin{center}\n\\begin{asy}\n  unitsize(11cm);\n  real h = 0.05;\n  draw( (0,0)--(1,0) );\n  void tick(string s, real x, real t, pen p) {\n    label(s, (x,-t), dir(-90), p);\n    draw((x,-t)--(x,t), p);\n  }\n  tick(\"$0$\", 0, h, black);\n  tick(\"$1$\", 1, h, black);\n  tick(\"$\\frac{1}{2}$\", 1/2, h, black);\n  tick(\"$\\frac{1}{3}$\", 1/3, 0.7*h, blue);\n  tick(\"$\\frac{2}{3}$\", 2/3, 0.7*h, blue);\n  tick(\"$\\frac{1}{4}$\", 1/4, 0.5*h, deepgreen);\n  tick(\"$\\frac{3}{4}$\", 3/4, 0.5*h, deepgreen);\n  tick(\"$\\frac{1}{5}$\", 1/6, 0.3*h, gray); // white lie\n  tick(\"$\\frac{2}{5}$\", 2/5, 0.3*h, gray);\n  tick(\"$\\frac{3}{5}$\", 3/5, 0.3*h, gray);\n  tick(\"$\\frac{4}{5}$\", 5/6, 0.3*h, gray); // white lie\n  dot(\"$\\boxed{\\frac{b}{p}}$\", (0.3,0), dir(90), red);\n  dot(\"$\\boxed{\\frac{c}{p}}$\", (0.72,0), dir(90), red);\n  dot(\"$\\boxed{\\frac{d}{p}}$\", (0.95,0), dir(90), red);\n\\end{asy}\n\\end{center}\n\nIn symbols, it will be enough to prove the following.\n\\begin{claim*}\n  For each $r = 1, 2, \\dots, p-2$ we have\n  $\\frac{r-1}{r} < \\frac dp < 1$.\n\n  Equivalently, for each $r = 1, 2, \\dots, p-2$\n  we have $\\left\\lfloor \\frac{rb}{p} \\right\\rfloor\n  + \\left\\lfloor \\frac{rc}{p} \\right\\rfloor = r-1$.\n\\end{claim*}\n\\begin{proof}\n  Assume this is not true and take the minimal counterexample $r > 1$.\n  Then evidently\n  \\[ r-1 > \\left\\lfloor \\frac{rd}{p} \\right\\rfloor\n    \\ge \\left\\lfloor \\frac{(r-1)d}{p} \\right\\rfloor\n    = r-2.  \\]\n  Now, we have that\n  \\[ 2(r-1) = \\left\\lfloor \\frac{rb}{p} \\right\\rfloor\n    + \\left\\lfloor \\frac{rc}{p} \\right\\rfloor\n    + \\underbrace{\\left\\lfloor \\frac{rd}{p} \\right\\rfloor}_{= r-2}.  \\]\n  Thus\n  $\\left\\lfloor \\frac{rb}{p} \\right\\rfloor >\n  \\left\\lfloor \\frac{(r-1)b}{p} \\right\\rfloor$,\n  and $\\left\\lfloor \\frac{rc}{p} \\right\\rfloor >\n  \\left\\lfloor \\frac{(r-1)b}{p} \\right\\rfloor$.\n  An example of this situation is illustrated below with $r = 7$\n  (not to scale).\n  \\begin{center}\n  \\begin{asy}\n    unitsize(11cm);\n    real h = 0.05;\n    draw( (0,0)--(1,0) );\n    void tick(string s, real x, real t, pen p) {\n      label(s, (x,-t), dir(-90), p);\n      draw((x,-t)--(x,t), p);\n    }\n    tick(\"$0$\", 0, h, black);\n    tick(\"$1$\", 1, h, black);\n    tick(\"$\\frac{1}{2}$\", 1/2, h, black);\n    tick(\"$\\frac{1}{3}$\", 1/3, 0.7*h, blue);\n    tick(\"$\\frac{2}{3}$\", 2/3, 0.7*h, blue);\n    tick(\"$\\frac{1}{4}$\", 1/4, 0.5*h, deepgreen);\n    tick(\"$\\frac{3}{4}$\", 3/4, 0.5*h, deepgreen);\n    tick(\"$\\frac{1}{5}$\", 1/6, 0.3*h, gray);\n    tick(\"$\\frac{2}{5}$\", 2/5, 0.3*h, gray);\n    tick(\"$\\frac{3}{5}$\", 3/5, 0.3*h, gray);\n    tick(\"$\\frac{4}{5}$\", 5/6, 0.3*h, gray);\n    tick(\"$\\frac{1}{6}$\", 1/8, 0.3*h, gray);\n    tick(\"$\\frac{5}{6}$\", 7/8, 0.3*h, gray);\n    dot(\"$\\boxed{\\frac{b}{p}}$\", (0.31,0), dir(90), red);\n    dot(\"$\\boxed{\\frac{c}{p}}$\", (0.725,0), dir(90), red);\n    dot(\"$\\boxed{\\frac{d}{p}}$\", (0.92,0), dir(90), red);\n    tick(\"$\\dfrac{2}{7}$\", 2/7, 1.5*h, red+1);\n    tick(\"$\\dfrac{5}{7}$\", 0.7, 1.5*h, red+1);\n    tick(\"$\\dfrac{6}{7}$\", 0.9, 1.5*h, red+1);\n\n    tick(\"$\\dfrac{7}{8}$\", 0.95, 2*h, orange+1);\n    tick(\"$\\dfrac{3}{8}$\", 0.375, 2*h, orange+1);\n    tick(\"$\\dfrac{6}{8}$\", 0.75, 2*h, orange+1);\n  \\end{asy}\n  \\end{center}\n  Right now, $\\frac bp$ and $\\frac cp$\n  are just to the right of\n  $\\frac ur$ and $\\frac vr$ for some $u$ and $v$ with $u+v=r$.\n  The issue is that the there is some fraction just to the right of\n  $\\frac bp$ and $\\frac cp$ from an earlier value of $r$,\n  and by hypothesis its denominator is going to be strictly greater than $1$.\n\n  It is at this point we are going to use the properties of Farey sequences.\n  When we consider the fractions with denominator $r+1$,\n  they are going to lie outside of the interval\n  they we have constrained $\\frac bp$ and $\\frac cp$ to lie in.\n\n  Indeed, our minimality assumption on $r$ guarantees that there is no\n  fraction with denominator less than $r$ between $\\frac ur$ and $\\frac bp$.\n  So if $\\frac ur < \\frac bp < \\frac st$\n  (where $\\frac ur$ and $\\frac st$ are the closest fractions\n  with denominator at most $r$ to $\\frac bp$)\n  then Farey theory says the next fraction\n  inside the interval $[\\frac ur, \\frac st]$\n  is $\\frac{u+s}{r+t}$, and since $t > 1$, we have $r+t > r+1$.\n  In other words, we get an inequality of the form\n  \\[ \\frac ur < \\frac bp < \\underbrace{\\text{something}}_{=s/t} \\le \\frac{u+1}{r+1}. \\]\n\n  The same holds for $\\frac cp$ as\n  \\[ \\frac vr < \\frac cp < \\text{something} \\le \\frac{v+1}{r+1}. \\]\n  Finally,\n  \\[ \\frac dp < \\frac{r-1}{r} < \\frac{r}{r+1}. \\]\n  So now we have that\n  \\[ \\left\\lfloor \\frac{(r+1)b}{p} \\right\\rfloor\n    + \\left\\lfloor \\frac{(r+1)c}{p} \\right\\rfloor\n    + \\left\\lfloor \\frac{(r+1)d}{p} \\right\\rfloor\n    \\le u + v + (r-1) = 2r-1 \\]\n  which is a contradiction.\n\\end{proof}\nNow, since\n\\[ \\frac{p-3}{p-2} < \\frac dp\n  \\implies d > \\frac{p(p-3)}{p-2} = p - 1 - \\frac{2}{p-2} \\]\nwhich for $p > 2$ gives $d = p-1$.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Number Theory", "source": "USAMO", "year": 1999}
{"id": "usamo-1999-q4", "question": "Let $a_1$, $a_2$, \\dots, $a_n$ be a sequence of $n > 3$ real numbers\nsuch that\n\\[ a_1 + \\dots + a_n \\ge n \\quad\\text{and}\\quad\n  a_1^2 + \\dots + a_n^2 \\ge n^2. \\]\nProve that $\\max(a_1, \\dots, a_n) \\ge 2$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p63591}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a_1$, $a_2$, \\dots, $a_n$ be a sequence of $n > 3$ real numbers\nsuch that\n\\[ a_1 + \\dots + a_n \\ge n \\quad\\text{and}\\quad\n  a_1^2 + \\dots + a_n^2 \\ge n^2. \\]\nProve that $\\max(a_1, \\dots, a_n) \\ge 2$.\n\\end{mdframed}\nProceed by contradiction, assuming $a_i < 2$ for all $i$.\n\nIf all $a_i \\ge 0$, then $ n^2 \\le \\sum_i a_i^2 < n \\cdot 2^2$,\ncontradiction.\n\nOtherwise, assume at least one $a_i$ is negative.\nNote that if $-x$ and $-y$ are both present in the sequence ($x,y>0$),\nthen we can replace them with $-(x+y)$ and $0$.\nSo we may assume that there is exactly one negative term, say $a_n = -M$.\n\nNow, smooth all the nonnegative $a_i$ to be $2$,\nmaking all inequalities strict.\nNow, we have that\n\\begin{align*}\n  2(n-1) - M &> n \\\\\n  4(n-1) + M^2 &> n^2.\n\\end{align*}\nThis gives $n-2 < M < n-2$, contradiction.\n\nEquality in the original occurs when $n-1$ of the $a_i$ are equal to $2$\nand the last one is equal to $-(n-2)$.\n\\pagebreak", "category": "Algebra", "source": "USAMO", "year": 1999}
{"id": "usamo-1999-q5", "question": "The Y2K Game is played on a $1 \\times 2000$ grid as follows.\nTwo players in turn write either an S or an O in an empty square.\nThe first player who produces three consecutive boxes that spell SOS wins.\nIf all boxes are filled without producing SOS then the game is a draw.\nProve that the second player has a winning strategy.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p340040}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nThe Y2K Game is played on a $1 \\times 2000$ grid as follows.\nTwo players in turn write either an S or an O in an empty square.\nThe first player who produces three consecutive boxes that spell SOS wins.\nIf all boxes are filled without producing SOS then the game is a draw.\nProve that the second player has a winning strategy.\n\\end{mdframed}\nThe main insight is that a construct of the form\n\\[ S \\; \\square \\; \\square \\; S \\]\n(here the $\\square$ is blank)\nwill kill any player which plays inside it.\nWe call this a \\emph{trap} accordingly.\n\n\\begin{claim*}\n  The second player can force a trap to exist;\n  in this case the game will never end in a draw.\n\\end{claim*}\n\\begin{proof}\n  Actually the second player can construct a trap\n  on her second turn by playing an $S$ far enough away\n  from the edges of the board and the first player's initial move.\n\\end{proof}\n\n\\begin{claim*}\n  The second player always has a move which prevents\n  her from losing.\n\\end{claim*}\n\\begin{proof}\n  Since there are an odd number of empty squares at the start of\n  the second player's turn,\n  there must be a square which is bordered by either\n  two filled or two empty squares.\n  The second player can then play $O$ in this square,\n  which is always safe.\n\\end{proof}\n\nTogether these two claims finish the problem.\n\n\\begin{remark*}\n  Actually, one can show that the ``only'' way to lose\n  is to be forced to play inside a trap.\n  Indeed, suppose playing in a certain cell $c$ loses.\n  If we wrote $O$, that means $c$ is bordered by exactly one $S$,\n  with a blank cell on the neighbor.\n  But we could also write $S$; checking cases we find $c$\n  is part of a trap.\n\n  Thus a player can lose only if all blank cells\n  are in traps; ergo, the number of blank cells is even.\n  This never happens for the second player.\n  Thus this gives an alternative solution,\n  and moreover a reason to believe that all\n  correct solutions must involve traps.\n\n  A similar proof shows that for large $n$, with a $1 \\times n$ board,\n  the first player has a winning strategy for odd $n$,\n  and the second player has a winning strategy for even $n$.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "USAMO", "year": 1999}
{"id": "usamo-1999-q6", "question": "Let $ABCD$ be an isosceles trapezoid with $AB \\parallel CD$.\nThe inscribed circle $\\omega$ of triangle $BCD$ meets $CD$ at $E$.\nLet $F$ be a point on the (internal) angle bisector of $\\angle DAC$\nsuch that $EF \\perp CD$.\nLet the circumscribed circle of triangle $ACF$\nmeet line $CD$ at $C$ and $G$.\nProve that the triangle $AFG$ is isosceles.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p340041}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABCD$ be an isosceles trapezoid with $AB \\parallel CD$.\nThe inscribed circle $\\omega$ of triangle $BCD$ meets $CD$ at $E$.\nLet $F$ be a point on the (internal) angle bisector of $\\angle DAC$\nsuch that $EF \\perp CD$.\nLet the circumscribed circle of triangle $ACF$\nmeet line $CD$ at $C$ and $G$.\nProve that the triangle $AFG$ is isosceles.\n\\end{mdframed}\nNote $E$ is contact point of $A$-excircle of $\\triangle ACD$,\nso $F$ is $A$-excenter.\nHence $CF$ is external angle bisector of $\\angle ACG$\nwhich implies $FA = FG$\n(since $F$ is the arc midpoint on the circumcircle of $AFG$).\n\\pagebreak\n\n\n\\end{document}", "category": "Geometry", "source": "USAMO", "year": 1999}
{"id": "usamo-2011-q1", "question": "Let $a$, $b$, $c$ be positive real numbers\nsuch that $a^2+b^2+c^2+(a+b+c)^2 \\le 4$. Prove that\n\\[ \\frac{ab+1}{(a+b)^2} + \\frac{bc+1}{(b+c)^2} + \\frac{ca+1}{(c+a)^2} \\ge 3. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2254758}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a$, $b$, $c$ be positive real numbers\nsuch that $a^2+b^2+c^2+(a+b+c)^2 \\le 4$. Prove that\n\\[ \\frac{ab+1}{(a+b)^2} + \\frac{bc+1}{(b+c)^2} + \\frac{ca+1}{(c+a)^2} \\ge 3. \\]\n\\end{mdframed}\nThe condition becomes $2 \\ge a^2+b^2+c^2 + ab+bc+ca$.\nTherefore,\n\\begin{align*}\n  \\sum_{\\text{cyc}} \\frac{2ab+2}{(a+b)^2}\n  &\\ge \\sum_{\\text{cyc}} \\frac{2ab+(a^2+b^2+c^2+ab+bc+ca)}{(a+b)^2} \\\\\n  &= \\sum_{\\text{cyc}} \\frac{(a+b)^2+(c+a)(c+b)}{(a+b)^2} \\\\\n  &= 3 + \\sum_{\\text{cyc}} \\frac{(c+a)(c+b)}{(a+b)^2} \\\\\n  &\\ge 3 + 3\\sqrt[3]{\\prod_{\\text{cyc}} \\frac{(c+a)(c+b)}{(a+b)^2}}\n  = 3 + 3 = 6\n\\end{align*}\nwith the last line by AM-GM.\nThis completes the proof.\n\\pagebreak", "category": "Algebra", "source": "USAMO", "year": 2011}
{"id": "usamo-2011-q2", "question": "An integer is assigned to each vertex of a regular pentagon\nso that the sum of the five integers is $2011$.\nA turn of a solitaire game consists of subtracting an integer $m$\n(not necessarily positive) from each of the integers at two neighboring vertices\nand adding $2m$ to the opposite vertex, which is not adjacent\nto either of the first two vertices.\n(The amount $m$ and the vertices chosen can vary from turn to turn.)\nThe game is won at a certain vertex if, after some number of turns,\nthat vertex has the number $2011$ and the other four vertices have the number $0$.\nProve that for any choice of the initial integers,\nthere is exactly one vertex at which the game can be won.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2254765}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nAn integer is assigned to each vertex of a regular pentagon\nso that the sum of the five integers is $2011$.\nA turn of a solitaire game consists of subtracting an integer $m$\n(not necessarily positive) from each of the integers at two neighboring vertices\nand adding $2m$ to the opposite vertex, which is not adjacent\nto either of the first two vertices.\n(The amount $m$ and the vertices chosen can vary from turn to turn.)\nThe game is won at a certain vertex if, after some number of turns,\nthat vertex has the number $2011$ and the other four vertices have the number $0$.\nProve that for any choice of the initial integers,\nthere is exactly one vertex at which the game can be won.\n\\end{mdframed}\nCall the vertices $0$, $1$, $2$, $3$, $4$ in order.\nFirst, notice that the quantity\n\\[ S \\coloneq N_1 + 2N_2 + 3N_3 + 4N_4 \\pmod 5 \\]\nis invariant, where $N_i$ is the amount at vertex $i$.\nThis immediately implies that at most one vertex can win,\nsince in a winning situation all $N_i$ are $0$ except for one, which is $2011$.\n(For example, if $S \\equiv 3 \\pmod 5$, any victory must occur at the\nvertex $3$, via $N_3 = 2011$, $N_0 = N_1 = N_2 = N_4 = 0$.)\n\nNow we prove we can win on this unique vertex.\nLet $a_i$, $x_i$ denote the number initially at $i$\nand $x_i$ denote $\\sum m$ over all $m$ where vertex $i$ gains $2m$.\nWLOG the possible vertex is $0$,\nmeaning $a_1 + 2a_2 + 3a_3 + 4a_4 \\equiv 0 \\pmod 5$.\nMoreover we want\n\\begin{align*}\n  2011 &= a_0 + 2x_0 - x_2 - x_3 \\\\\n  0 &= a_1 + 2x_1 - x_3 - x_4 \\\\\n  0 &= a_2 + 2x_2 - x_4 - x_0 \\\\\n  0 &= a_3 + 2x_3 - x_0 - x_1 \\\\\n  0 &= a_4 + 2x_4 - x_1 - x_2.\n\\end{align*}\nWe can ignore the first equation since its the sum of the other four,\nand we can WLOG shift $x_0 \\to 0$ by shifting each $x_i$ by a fixed amount.\nWe will now solve the resulting system of equations.\n\nFirst, we have \\[ x_4 = 2x_2 + a_2 \\text{ and } x_1 = 2x_3 + a_3. \\]\nUsing these to remove all instances of $x_1$ and $x_4$ gives\n\\[ 2x_2-3x_3 = 2a_3+a_1-a_2 \\text{ and } 2x_3-3x_2 = 2a_2+a_4-a_3 \\]\nwhence we have a two-variable system of equations!\nTo verify its solution is integral, note that\n\\[ x_2-x_3 = \\frac{a_1 - 3a_2 + 3a_3 - a_4}{5} \\]\nis an integer, since\n\\[ a_1 - 3a_2 + 3a_3 - a_4 \\equiv a_1 + 2a_2 + 3a_3 + 4a_4 \\equiv 0 \\pmod 5. \\]\nAbbreviating $\\frac{a_1 - 3a_2 + 3a_3 - a_4}{5}$ as $k$, we obtain the desired $x_i$:\n\\begin{align*}\n  x_2 &= 2a_3+a_1-a_2 + 2k \\\\\n  x_3 &= x_2 + k \\\\\n  x_1 &= 2x_3 + a_3 \\\\\n  x_4 &= 2x_2 + a_2 \\\\\n  x_0 &= 0.\n\\end{align*}\nThis is the desired integer solution.\n\n\\begin{remark*}\n  In principle, you could unwind all the definitions above to explicitly\n  write every $x_i$ as a function of $a_1$, $a_2$, $a_3$, $a_4$.\n  If you did this, you could get the long equations\n  \\begin{align*}\n    x_0 &= 0 \\\\\n    x_1 &= -\\tfrac15(6a_1 + 2a_2 + 3a_3 + 4a_4) \\\\\n    x_2 &= -\\tfrac15(2a_1 + 4a_2 + a_3 + 3a_4) \\\\\n    x_3 &= -\\tfrac15(3a_1 + a_2 + 4a_3 + 2a_4) \\\\\n    x_4 &= -\\tfrac15(4a_1 + 3a_2 + 2a_3 + 6a_4)\n  \\end{align*}\n  which indeed are all integers whenever $a_1 + 2a_2 + 3a_3 + 4a_4 \\equiv 0 \\pmod 5$.\n\n  However, this is quite tedious and also unnecessary to solve the problem.\n  That's because we only care that the $x_i$ are integers,\n  and do not need to actually know the values.\n  This lets us work more indirectly to avoid long calculation, as we did above.\n\\end{remark*}\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2011}
{"id": "usamo-2011-q3", "question": "In hexagon $ABCDEF$, which is nonconvex but not self-intersecting,\nno pair of opposite sides are parallel.\nThe internal angles satisfy\n$\\angle A=3\\angle D$, $\\angle C=3\\angle F$, and $\\angle E=3\\angle B$.\nFurthermore $AB=DE$, $BC=EF$, and $CD=FA$.\nProve that diagonals $\\ol{AD}$, $\\ol{BE}$, and $\\ol{CF}$\nare concurrent.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2254803}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nIn hexagon $ABCDEF$, which is nonconvex but not self-intersecting,\nno pair of opposite sides are parallel.\nThe internal angles satisfy\n$\\angle A=3\\angle D$, $\\angle C=3\\angle F$, and $\\angle E=3\\angle B$.\nFurthermore $AB=DE$, $BC=EF$, and $CD=FA$.\nProve that diagonals $\\ol{AD}$, $\\ol{BE}$, and $\\ol{CF}$\nare concurrent.\n\\end{mdframed}\nWe present the official solution.\nWe say a hexagon is \\emph{satisfying}\nif it obeys the six conditions;\nnote that intuitively we expect three degrees of freedom\nfor satisfying hexagons.\n\nMain idea:\n\\begin{claim*}\nIn a satisfying hexagon,\n$B$, $D$, $F$ are reflections of $A$, $C$, $E$ across\nthe sides of $\\triangle ACE$.\n\\end{claim*}\n(This claim looks plausible because every excellent hexagon is satisfying,\nand both configuration spaces are three-dimensional.)\nCall a hexagon of this shape ``excellent'';\nin a excellent hexagon the diagonals clearly concur (at the orthocenter).\n\nSet $\\beta = \\angle B$, $\\delta = \\angle D$, $\\varphi = \\angle F$.\n\nNow given a satisfying hexagon $ABCDEF$,\nconstruct a ``phantom hexagon'' $A'B'C'D'E'F'$\nwith the same angles which is excellent (see figure).\nThis is possible since $\\beta + \\delta + \\varphi = 180\\dg$.\n\n\\begin{center}\n\\begin{asy}\nsize(12cm);\n\nvoid MA(string s, pair A, pair O, pair B) {\n  markangle(11.0, A,O,B);\n  label(\"$\"+s+\"$\", O, 4*dir((pair)incenter(A,O,B)-O));\n}\n\npair A = dir(110);\npair C = dir(205);\npair E = dir(335);\npair B = -E+2*foot(E, A, C);\npair D = -A+2*foot(A, C, E);\npair F = -C+2*foot(C, E, A);\n\nfilldraw(A--B--C--D--E--F--cycle, opacity(0.1)+lightgreen, heavygreen);\ndraw(A--C--E--cycle, green);\ndraw(A--D, dashed+green);\ndraw(B--E, dashed+green);\ndraw(C--F, dashed+green);\n\nMA(\"\\beta\", C,B,A);\nMA(\"\\delta\", E,D,C);\nMA(\"\\varphi\", A,F,E);\n\ntransform t = shift(-4,0);\n\nadd(t*CC());\n\n\n// Again\n\npair Ap = A;\npair Cp = C;\npair Ep = E;\npair Bp = B;\npair Dp = D;\npair Fp = F;\n\nfilldraw(A--B--C--D--E--F--cycle, opacity(0.1)+lightcyan, heavycyan);\ndraw(A--C--E--cycle, heavycyan);\ndraw(A--D, dashed+heavycyan);\ndraw(B--E, dashed+heavycyan);\ndraw(C--F, dashed+heavycyan);\n\nMA(\"\\beta\", C,B,A);\nMA(\"\\delta\", E,D,C);\nMA(\"\\varphi\", A,F,E);\n\nMA(\"\\beta\", A,E,C);\nMA(\"\\varphi\", E,C,A);\nMA(\"\\delta\", C,A,E);\n\n\npair A = t*A;\npair B = t*B;\npair C = t*C;\npair D = t*D;\npair E = t*E;\npair F = t*F;\n\ndot(\"$A'$\", Ap, dir(Ap));\ndot(\"$C'$\", Cp, dir(Cp));\ndot(\"$E'$\", Ep, dir(Ep));\ndot(\"$B'$\", Bp, dir(Bp));\ndot(\"$D'$\", Dp, dir(Dp));\ndot(\"$F'$\", Fp, dir(Fp));\ndot(\"$A$\", A, dir(120));\ndot(\"$B$\", B, dir(135));\ndot(\"$C$\", C, dir(225));\ndot(\"$D$\", D, dir(270));\ndot(\"$E$\", E, dir(350));\ndot(\"$F$\", F, dir(45));\n\n/* TSQ Source:\n\n!size(12cm);\n\nA := dir 110\nC := dir 205\nE := dir 335\nB := -E+2*foot E A C\nD := -A+2*foot A C E\nF := -C+2*foot C E A\n\nA--B--C--D--E--F--cycle 0.1 lightgreen / heavygreen\nA--C--E--cycle green\nA--D dashed green\nB--E dashed green\nC--F dashed green\n\n!MA(\"\\beta\", C,B,A, 0.2);\n!MA(\"\\delta\", E,D,C, 0.2);\n!MA(\"\\varphi\", A,F,E, 0.2);\n\n! transform t = shift(-4,0);\n\n!add(t*CC());\n\n\n// Again\n\nA' = A\nC' = C\nE' = E\nB' = B\nD' = D\nF' = F\n\nA--B--C--D--E--F--cycle 0.1 lightcyan / heavycyan\nA--C--E--cycle heavycyan\nA--D dashed heavycyan\nB--E dashed heavycyan\nC--F dashed heavycyan\n! anglepen = heavycyan;\n\n!MA(\"\\beta\", C,B,A, 0.2);\n!MA(\"\\delta\", E,D,C, 0.2);\n!MA(\"\\varphi\", A,F,E, 0.2);\n\n!MA(\"\\beta\", A,E,C, 0.2);\n!MA(\"\\varphi\", E,C,A, 0.2);\n!MA(\"\\delta\", C,A,E, 0.2);\n\n\nA = t*A R120\nB = t*B R135\nC = t*C R225\nD = t*D R270\nE = t*E R350\nF = t*F R45\n\n*/\n\n\\end{asy}\n\\end{center}\n\n\nThen it would suffice to prove that:\n\\begin{lemma*}\n  A satisfying hexagon is uniquely determined by its angles\n  up to similarity.\n  That is, at most one hexagon\n  (up to similarity) has angles $\\beta$, $\\delta$, $\\gamma$ as above.\n\\end{lemma*}\n\\begin{proof}\n  Consider any two satisfying hexagons $ABCDEF$ and $A'B'C'D'E'F'$\n  (not necessarily as constructed above!) with the same angles.\n  We show they are similar.\n\n  To do this, consider the unit complex numbers\n  in the directions $\\overrightarrow{BA}$ and $\\overrightarrow{DE}$\n  respectively and let $\\vec x$ denote their sum.\n  Define $\\vec y$, $\\vec z$ similarly.\n  Note that the condition $\\ol{AB} \\nparallel \\ol{DE}$\n  implies $\\vec x \\neq 0$, and similarly.\n  Then we have the identities\n  \\[ AB \\cdot \\vec x + CD \\cdot \\vec y + EF \\cdot \\vec z\n    = A'B' \\cdot \\vec x + C'D' \\cdot \\vec y + E'F' \\cdot \\vec z\n    = 0. \\]\n\n  So we would obtain $AB : CD : EF = A'B' : C'D' : E'F'$\n  if only we could show that $\\vec x$, $\\vec y$, $\\vec z$\n  are not multiples of each other\n  (linear dependency reasons).\n  This is a tiresome computation with arguments,\n  but here it is.\n\n  First note that none of $\\beta$, $\\delta$, $\\varphi$\n  can be $90\\dg$,\n  since otherwise we get a pair of parallel sides.\n  Now work in the complex plane,\n  fix a reference such that $\\vec A - \\vec B$ has argument $0$,\n  and assume $ABCDEF$ are labelled counterclockwise.\n  Then\n  \\begin{itemize}\n    \\ii $\\vec B - \\vec C$ has argument $\\pi-\\beta$\n    \\ii $\\vec C - \\vec D$ has argument $-(\\beta+3\\varphi)$\n    \\ii $\\vec D - \\vec E$ has argument $\\pi-(\\beta+3\\varphi+\\delta)$\n    \\ii $\\vec E - \\vec F$ has argument $-(4\\beta+3\\varphi+\\delta)$\n    % \\ii $\\vec F - \\vec A$ has argument $\\pi-(4\\beta+4\\varphi+\\delta)$\n  \\end{itemize}\n  So the argument of $\\vec x$ has argument\n  $\\frac{\\pi-(\\beta+3\\varphi+\\delta)}{2} \\pmod \\pi$.\n  The argument of $\\vec y$ has argument\n  $\\frac{\\pi-(5\\beta+3\\varphi+\\delta)}{2} \\pmod \\pi$.\n  Their difference is $2\\beta \\pmod \\pi$, and since $\\beta \\neq 90\\dg$,\n  it follows that $\\vec x$ and $\\vec y$ are not\n  multiples of each other; the other cases are similar.\n\\end{proof}\n\nThen the lemma implies $ABCDEF \\sim A'B'C'D'E'F$ and we're done.\n\n\\begin{remark*}\n  This problem turned out to be known already.\n  It appears in this reference:\n  \\begin{quote}\n  Nikolai Beluhov, \\emph{Matematika}, 2008, issue 6, problem 3.\n  \\end{quote}\n  It was reprinted as Kvant, 2009, issue 2, problem M2130;\n  the reprint is available at\n  \\url{http://kvant.ras.ru/pdf/2009/2009-02.pdf}.\n\\end{remark*}\n\n\\begin{remark*}\n  The vector perspective also shows the condition about parallel\n  sides cannot be dropped.\n  Here is a counterexample from Ryan Kim\n  in the event that it is.\n  \\begin{center}\n  \\begin{asy}\n  pair A = dir(140);\n  pair C_0 = conj(A);\n  pair E = -A;\n  pair B_0 = 2*C_0-E;\n  pair D_0 = 2*C_0-A;\n  pair F = extension(A, E*E/C_0, E, A*A/C_0);\n\n\n  pair C = C_0+2*C_0;\n  pair B = B_0+2*C_0;\n  pair D = D_0+2*C_0;\n\n  filldraw(A--B--C--D--E--F--cycle, opacity(0.1)+lightcyan, heavycyan);\n\n  draw(A--D, heavygreen);\n  draw(B--E, heavygreen);\n  draw(C--F, heavygreen);\n  draw(A--C_0--E--cycle, blue);\n\n  draw(B_0--C--D_0--C_0--cycle, orange+dashed);\n\n  dot(\"$A$\", A, dir(A));\n  dot(\"$C_0$\", C_0, dir(45));\n  dot(\"$E$\", E, dir(E));\n  dot(\"$B_0$\", B_0, dir(135));\n  dot(\"$D_0$\", D_0, dir(315));\n  dot(\"$F$\", F, dir(F));\n  dot(\"$C$\", C, dir(C));\n  dot(\"$B$\", B, dir(B));\n  dot(\"$D$\", D, dir(D));\n\n  /* TSQ Source:\n\n  A = dir 140\n  C_0 = conj(A) R45\n  E = -A\n  B_0 = 2*C_0-E R135\n  D_0 = 2*C_0-A R315\n  F = extension A E*E/C_0 E A*A/C_0\n\n\n  C = C_0+2*C_0\n  B = B_0+2*C_0\n  D = D_0+2*C_0\n\n  A--B--C--D--E--F--cycle 0.1 lightcyan / heavycyan\n\n  A--D heavygreen\n  B--E heavygreen\n  C--F heavygreen\n  A--C_0--E--cycle blue\n\n  B_0--C--D_0--C_0--cycle orange dashed\n\n  */\n  \\end{asy}\n  \\end{center}\n  By adjusting the figure above so that\n  the triangles are right isosceles (instead of just right),\n  one also finds an example of a hexagon which is satisfying\n  and whose diagonals are concurrent,\n  but which is \\emph{not} excellent.\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Geometry", "source": "USAMO", "year": 2011}
{"id": "usamo-2011-q4", "question": "Consider the assertion that for each positive integer $n\\geq2$,\nthe remainder upon dividing $2^{2^n}$ by $2^n-1$ is a power of $4$.\nEither prove the assertion or find (with proof) a counterexample.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2254810}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nConsider the assertion that for each positive integer $n\\geq2$,\nthe remainder upon dividing $2^{2^n}$ by $2^n-1$ is a power of $4$.\nEither prove the assertion or find (with proof) a counterexample.\n\\end{mdframed}\nWe claim $n = 25$ is a counterexample.\nSince $2^{25} \\equiv 2^0 \\pmod{2^{25}-1}$, we have\n\\[ 2^{2^{25}} \\equiv 2^{2^{25} \\bmod{25}}\n  \\equiv 2^7 \\bmod{2^{25}-1} \\]\nand the right-hand side is actually the remainder,\nsince $0 < 2^7 < 2^{25}$.\nBut $2^7$ is not a power of $4$.\n\n\\begin{remark*}\n  Really, the problem is just equivalent\n  for asking $2^n$ to have odd remainder when divided by $n$.\n\\end{remark*}\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 2011}
{"id": "usamo-2011-q5", "question": "Let $P$ be a point inside convex quadrilateral $ABCD$.\nPoints $Q_1$ and $Q_2$ are located within $ABCD$ such that\n\\begin{align*}\n\\angle Q_1BC=\\angle ABP, & \\qquad \\angle Q_1CB=\\angle DCP, \\\\\n\\angle Q_2AD=\\angle BAP, & \\qquad \\angle Q_2DA=\\angle CDP.\n\\end{align*}\nProve that $\\ol{Q_1Q_2} \\parallel \\ol{AB}$\nif and only if $\\ol{Q_1Q_2} \\parallel \\ol{CD}$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2254841}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $P$ be a point inside convex quadrilateral $ABCD$.\nPoints $Q_1$ and $Q_2$ are located within $ABCD$ such that\n\\begin{align*}\n\\angle Q_1BC=\\angle ABP, & \\qquad \\angle Q_1CB=\\angle DCP, \\\\\n\\angle Q_2AD=\\angle BAP, & \\qquad \\angle Q_2DA=\\angle CDP.\n\\end{align*}\nProve that $\\ol{Q_1Q_2} \\parallel \\ol{AB}$\nif and only if $\\ol{Q_1Q_2} \\parallel \\ol{CD}$.\n\\end{mdframed}\nIf $\\ol{AB} \\parallel \\ol{CD}$ there is nothing to prove.\nOtherwise let $X = \\ol{AB} \\cap \\ol{CD}$.\nThen the $Q_1$ and $Q_2$ are the isogonal conjugates of $P$\nwith respect to triangles $XBC$ and $XAD$.\nThus $X$, $Q_1$, $Q_2$ are collinear,\non the isogonal of $\\ol{XP}$ with respect to\n$\\angle DXA = \\angle CXB$.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2011}
{"id": "usamo-2011-q6", "question": "Let $A$ be a set with $|A|=225$, meaning that $A$ has $225$ elements.\nSuppose further that there are eleven subsets $A_1, \\dots, A_{11}$ of $A$\nsuch that $|A_i|=45$ for $1\\leq i\\leq11$ and $|A_i\\cap A_j|=9$\nfor $1\\leq i<j\\leq11$.\nProve that $|A_1\\cup A_2\\cup\\dots\\cup A_{11}|\\geq 165$,\nand give an example for which equality holds.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2254871}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $A$ be a set with $|A|=225$, meaning that $A$ has $225$ elements.\nSuppose further that there are eleven subsets $A_1, \\dots, A_{11}$ of $A$\nsuch that $|A_i|=45$ for $1\\leq i\\leq11$ and $|A_i\\cap A_j|=9$\nfor $1\\leq i<j\\leq11$.\nProve that $|A_1\\cup A_2\\cup\\dots\\cup A_{11}|\\geq 165$,\nand give an example for which equality holds.\n\\end{mdframed}\nIgnore the $225$ --- it is irrelevant.\n\nDenote the elements of $A_1 \\cup \\dots \\cup A_{11}$\nby $a_1$, \\dots, $a_n$,\nand suppose that $a_i$ appears $x_i$ times among $A_i$\nfor each $1 \\le i \\le n$ (so $1 \\le x_i \\le 11$).\nThen we have\n\\[ \\sum_{i=1}^{11} x_i = \\sum_{i=1}^{11} |A_i| = 45 \\cdot 11 \\]\nand\n\\[ \\sum_{i=1}^{11} \\binom{x_i}{2} = \\sum_{1 \\le i < j \\le 11}\n  \\left\\lvert A_i \\cap A_j \\right\\rvert\n  = \\binom{11}{2} \\cdot 9. \\]\nTherefore, we deduce that\n$\\sum x_i = 495$ and $\\sum_i x_i^2 = 1485$.\nNow, by Cauchy Schwarz\n\\[ n \\left( \\sum_i x_i^2 \\right) \\ge \\left( \\sum x_i \\right)^2 \\]\nwhich implies $n \\ge \\frac{495^2}{1485} = 165$.\n\nEquality occurs if we let $A$ consist of the $165$\nthree-element subsets of $\\left\\{ 1, \\dots, 11 \\right\\}$\n(plus $60$ of your favorite reptiles\nif you really insist $|A|=225$).\nThen we let $A_i$ denote those subsets containing $i$,\nof which there are $\\binom{10}{2} = 45$,\nand so that $|A_i \\cap A_j| = \\binom 91 = 9$.\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "USAMO", "year": 2011}
{"id": "egmo-2014-q1", "question": "Determine all real constants $t$ such that whenever $a$, $b$ and $c$ are the lengths of sides of a triangle, then so are $a^2+bct$, $b^2+cat$, $c^2+abt$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3459747}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nDetermine all real constants $t$ such that whenever $a$, $b$ and $c$ are the lengths of sides of a triangle, then so are $a^2+bct$, $b^2+cat$, $c^2+abt$.\n\\end{mdframed}\n\\paragraph{Answer.}\nWe will show the answer is exactly \\[ 2/3 \\le t \\le 2. \\]\n\n\\paragraph{Proof.}\nApply the substitution $a=y+z$, $b=z+x$, $c=x+y$.\nWe need the inequality\n\\begin{align*}\n  a^2 + bct & < b^2 + ca t + c^2 + ab t \\\\\n  (y+z)^2 + (x+y)(x+z) t &< (x+y)^2+(x+z)^2 + (y+z)(2x+y+z) t \\\\\n  \\iff [x^2-(xy+xz+yz+y^2+z^2)]t &< 2x^2+2xy+2xz-2yz \\\\\n\\end{align*}\nto be true for all $(x,y,z) \\in \\RR_{>0}^3$\n(checking only one inequality is enough by symmetry).\nWriting this is a quadratic in $x$, we want\n\\[ Q(x) \\coloneq (2-t)x^2 + (2+t)(y+z)x + ((y^2+yz+z^2)t - 2yz) > 0. \\]\n\n\\begin{claim*}\n  Except when $t=2$,\n  the quadratic $Q$ always has two real roots.\n\\end{claim*}\n\\begin{proof}\nThe discriminant is\n\\begin{align*}\n  D &= [(2+t)(y+z)]^2 - 4(2-t)\\left( (y^2+yz+z^2)t - 2yz \\right) \\\\\n  &= \\left( (2+t)^2 - 4(2-t)t \\right)(y^2+z^2)\n  + \\left( 2(2+t)^2-4(2-t)(t-2) \\right) yz \\\\\n  &= \\left( 5t^2-4t+4 \\right)(y^2+z^2) + \\left( 6t^2-8t+24  \\right) yz > 0\n\\end{align*}\nwhich means $Q$ always has two real roots\n(aside for the single exceptional case $t=2$,\nin which $Q$ is not a quadratic).\n\\end{proof}\n\nNow, we make a few closing observations.\n\\begin{itemize}\n  \\ii It is clear we need $t \\le 2$,\n  since a negative leading coefficient will\n  cause the inequality to fail for $x \\gg y,z$.\n  \\ii The case $t=2$ obviously has $Q > 0$ always.\n  \\ii For $t < 2$, as $Q$ always has two real roots,\n  the assertion is true if and only if all coefficients\n  of $Q$ are nonnegative.\n  \\ii When $t \\ge \\frac23$,\n  we have $(2+t)(y+z) > 0$ obviously, and from\n  \\[ \\frac{y^2+yz+z^2}{3} \\ge yz \\]\n  the constant coefficient is nonnegative as well.\n  Thus when $\\boxed{\\frac23 \\le t \\le 2}$\n  we indeed have $Q(x) > 0$ for $x,y,z > 0$.\n  \\ii If $t < \\frac23$,\n  then by letting $y=z$ fails the condition.\n\\end{itemize}\n\\pagebreak", "category": "Geometry", "source": "EGMO", "year": 2014}
{"id": "egmo-2014-q2", "question": "Let $D$ and $E$ be points in the interiors of sides $AB$ and $AC$,\nrespectively, of a triangle $ABC$, such that $DB = BC = CE$.\nLet the lines $CD$ and $BE$ meet at $F$.\nProve that the incenter $I$ of triangle $ABC$,\nthe orthocenter $H$ of triangle $DEF$ and\nthe midpoint $M$ of the arc $BAC$ of the circumcircle of triangle $ABC$\nare collinear.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3459750}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $D$ and $E$ be points in the interiors of sides $AB$ and $AC$,\nrespectively, of a triangle $ABC$, such that $DB = BC = CE$.\nLet the lines $CD$ and $BE$ meet at $F$.\nProve that the incenter $I$ of triangle $ABC$,\nthe orthocenter $H$ of triangle $DEF$ and\nthe midpoint $M$ of the arc $BAC$ of the circumcircle of triangle $ABC$\nare collinear.\n\\end{mdframed}\n\\paragraph{First solution (Cynthia Du).}\nLet $BI$ and $CI$ meet the circumcircle again at $M_B$, $M_C$.\nObserve that we have the spiral congruence\n\\[ \\triangle MDB \\sim \\triangle MEC \\]\nfrom $\\dang MBD = \\dang MBA = \\dang MCA = \\dang MCE$\nand $BD = EC$, $BM = CM$.\nThat is, $M$ is the Miquel point of $BDEC$.\n\n\\begin{center}\n\\begin{asy}\npair A = dir(110);\npair B = dir(240);\npair C = dir(300);\n\ndraw(A--B--C--cycle, heavycyan);\nfilldraw(unitcircle, opacity(0.1)+lightcyan, heavycyan);\n\npair I = incenter(A, B, C);\npair D = -C+2*foot(C, I, B);\npair E = -B+2*foot(B, I, C);\n\npair M_B = circumcenter(A, I, C);\npair M_C = circumcenter(A, I, B);\npair M = dir(90);\n\nfilldraw(M--D--B--cycle, opacity(0.1)+lightgreen, heavygreen);\nfilldraw(M--E--C--cycle, opacity(0.1)+lightgreen, heavygreen);\ndraw(B--M_B, heavycyan);\ndraw(C--M_C, heavycyan);\n\npair T = extension(M, E, B, I);\npair S = extension(M, D, C, I);\n\ndraw(circumcircle(D, I, E), lightred+dashed);\ndraw(D--S, heavygreen);\ndraw(E--T, heavygreen);\ndraw(D--I--E, lightred);\n\ndraw(C--D, lightgreen);\ndraw(B--E, lightgreen);\npair F = extension(C, D, B, E);\npair H = orthocenter(D, E, F);\ndraw(D--H--E, heavycyan);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$I$\", I, dir(I));\ndot(\"$D$\", D, dir(D));\ndot(\"$E$\", E, dir(E));\ndot(\"$M_B$\", M_B, dir(M_B));\ndot(\"$M_C$\", M_C, dir(M_C));\ndot(\"$M$\", M, dir(M));\ndot(\"$T$\", T, dir(T));\ndot(\"$S$\", S, dir(S));\ndot(\"$F$\", F, dir(F));\ndot(\"$H$\", H, dir(90));\n\n/* TSQ Source:\n\nA = dir 110\nB = dir 240\nC = dir 300\n\nA--B--C--cycle heavycyan\nunitcircle 0.1 lightcyan / heavycyan\n\nI = incenter A B C\nD = -C+2*foot C I B\nE = -B+2*foot B I C\n\nM_B = circumcenter A I C\nM_C = circumcenter A I B\nM = dir 90\n\nM--D--B--cycle 0.1 lightgreen / heavygreen\nM--E--C--cycle 0.1 lightgreen / heavygreen\nB--M_B heavycyan\nC--M_C heavycyan\n\nT = extension M E B I\nS = extension M D C I\n\ncircumcircle D I E lightred dashed\nD--S heavygreen\nE--T heavygreen\nD--I--E lightred\n\nC--D lightgreen\nB--E lightgreen\nF = extension C D B E\nH = orthocenter D E F R90\nD--H--E heavycyan\n\n*/\n\\end{asy}\n\\end{center}\n\nLet $T = \\ol{ME} \\cap \\ol{BI}$ and $S = \\ol{MD} \\cap \\ol{CI}$.\nFirst, since $\\ol{BI}$ is the perpendicular bisector of $\\ol{CD}$\nwe have that\n\\[ \\dang DIT = \\dang CIT = \\dang CIB = 90\\dg - \\half \\angle A\n  = \\dang MCB = \\dang MED = \\dang TED \\]\nand so $D$, $I$, $T$, $E$ is cyclic.\nSimilarly $S$ lies on this circle too.\nBut $\\dang SDE = \\dang EDM = \\dang MED = \\dang TED$\nso in fact $\\ol{ST} \\parallel \\ol{DE}$ (isosceles trapezoid).\n\nThen $\\triangle IST$ and $\\triangle HDE$ are homothetic,\nso $\\ol{IH}$, $\\ol{DS}$, and $\\ol{ET}$ concur (at $M$).\n\n\\paragraph{Second solution (Evan Chen).}\nObserve that we have the spiral congruence\n\\[ \\triangle MDB \\sim \\triangle MEC \\]\nfrom $\\dang MBD = \\dang MBA = \\dang MCA = \\dang MCE$\nand $BD = EC$, $BM = CM$.\nThat is, $M$ is the Miquel point of $BDEC$.\n\n\\begin{center}\n  \\begin{asy}\n  pair A = dir(110);\n  pair B = dir(240);\n  pair C = dir(300);\n\n  draw(A--B--C--cycle, heavycyan);\n  filldraw(unitcircle, opacity(0.1)+lightcyan, heavycyan);\n\n  pair I = incenter(A, B, C);\n  pair D = -C+2*foot(C, I, B);\n  pair E = -B+2*foot(B, I, C);\n  pair M = dir(90);\n  pair F = extension(C, D, B, E);\n\n  pair X = midpoint(B--D);\n  pair Y = midpoint(C--E);\n  draw(X--M--Y, red+dotted);\n  pair H = orthocenter(D, E, F);\n\n  draw(C--D, lightgreen);\n  draw(B--E, lightgreen);\n  draw(I--M, red+dotted);\n\n  draw(CP(X, B), red+dashed);\n  draw(CP(Y, C), red+dashed);\n  filldraw(B--D--E--C--cycle, opacity(0.1)+yellow, lightgreen);\n\n  dot(\"$A$\", A, dir(A));\n  dot(\"$B$\", B, dir(B));\n  dot(\"$C$\", C, dir(C));\n  dot(\"$I$\", I, dir(I));\n  dot(\"$D$\", D, dir(120));\n  dot(\"$E$\", E, dir(75));\n  dot(\"$M$\", M, dir(M));\n  dot(\"$F$\", F, dir(F));\n  dot(\"$X$\", X, dir(A+B));\n  dot(\"$Y$\", Y, dir(A+C));\n  dot(\"$H$\", H, dir(90));\n\n  /* TSQ Source:\n\n  A = dir 110\n  B = dir 240\n  C = dir 300\n\n  A--B--C--cycle heavycyan\n  unitcircle 0.1 lightcyan / heavycyan\n\n  I = incenter A B C\n  D = -C+2*foot C I B R120\n  E = -B+2*foot B I C R75\n  M = dir 90\n  F = extension C D B E\n\n  X = midpoint B--D RA+B\n  Y = midpoint C--E RA+C\n  X--M--Y red dotted\n  H = orthocenter D E F R90\n\n  C--D lightgreen\n  B--E lightgreen\n  I--M red dotted\n\n  CP X B red dashed\n  CP Y C red dashed\n  B--D--E--C--cycle 0.1 yellow / lightgreen\n\n  */\n  \\end{asy}\n\\end{center}\n\nLet $X$ and $Y$ be the midpoints of $\\ol{BD}$ and $\\ol{CE}$.\nThen $MX = MY$ by our congruence.\n\nConsider now the circles with diameters $\\ol{BD}$ and $\\ol{CE}$.\nWe now claim that $H$, $I$, $M$ all lie on the radical axis\nof these circles.\nNote that $I$ is the orthocenter of $\\triangle BFC$\nand $H$ is the orthocenter of $\\triangle DEF$,\nso this follows from the so-called Steiner line of $BCDE$\n(perpendicular to Gauss line $\\ol{XY}$).\nFor $M$, we observe $MX^2 - XB^2 = MY^2 - YC^2$ thus completing the proof.\n\n\\paragraph{Third solution (homothety, official solution).}\nExtend $DH$ and $EH$ to meet $BI$ and $CI$ at $D_1$ and $E_1$.\nNote $DD_1 \\perp BE$, $CI \\perp BE$, so $DD_1 \\parallel CI$.\nSimilarly $EE_1 \\parallel BI$.\nSo $HE_1ID_1$.\n\n\\begin{center}\n  \\begin{asy}\n    size(9cm);\n    pair A = dir(100);\n    pair B = dir(240);\n    pair C = dir(300);\n    pair I = incenter(A, B, C);\n    pair D = -C+2*foot(C, B, I);\n    pair E = -B+2*foot(B, C, I);\n    pair F = extension(B, E, C, D);\n    pair H = orthocenter(D, E, F);\n    draw(A--B--C--cycle);\n    draw(B--E);\n    draw(C--D);\n\n    pair D_1 = extension(D, H, B, I);\n    pair E_1 = extension(E, H, C, I);\n    pair D_2 = dir(20);\n    pair E_2 = dir(170);\n    draw(unitcircle);\n\n    pair M = D_2+E_2-I;\n\n    draw(circumcircle(B, C, D_1));\n    draw(B--D_2--M--E_2--C);\n    draw(E_1--E, dotted);\n    draw(M--I, dotted);\n    draw(D_1--D, dotted);\n\n\n    dot(\"$A$\", A, dir(A));\n    dot(\"$B$\", B, dir(B));\n    dot(\"$C$\", C, dir(C));\n    dot(\"$I$\", I, dir(I));\n    dot(\"$D$\", D, dir(D));\n    dot(\"$E$\", E, dir(E));\n    dot(\"$F$\", F, dir(F));\n    dot(\"$H$\", H, dir(90));\n    dot(\"$D_1$\", D_1, dir(100));\n    dot(\"$E_1$\", E_1, dir(80));\n    dot(\"$D_2$\", D_2, dir(D_2));\n    dot(\"$E_2$\", E_2, dir(E_2));\n    dot(\"$M$\", M, dir(M));\n\n    /* Source generated by TSQ\n\n    A = dir 100\n    B = dir 240\n    C = dir 300\n    I = incenter A B C\n    D = -C+2*foot C B I\n    E = -B+2*foot B C I\n    F = extension B E C D\n    H = orthocenter D E F R90\n    A--B--C--cycle\n    B--E\n    C--D\n\n    D_1 = extension D H B I R100\n    E_1 = extension E H C I R80\n    D_2 = dir 20\n    E_2 = dir 170\n    unitcircle\n\n    M = D_2+E_2-I\n\n    circle B C D_1\n    B--D_2--M--E_2--C\n    E_1--E dotted\n    M--I dotted\n    D_1--D dotted\n\n    */\n  \\end{asy}\n\\end{center}\n\nAngle chase to show that $B$, $E_1$, $F$, $C$ are cyclic --\n$\\angle DCE_1 = \\angle DCI$ is computable in terms of $ABC$\nand \\[ \\angle E_1BF = \\angle E_1BE = \\angle E_1EB = \\angle HEF = \\angle HDF = \\angle HDC = \\angle DCE_1 = \\angle FCE_1. \\]\nThus $B$, $D_1$, $F$, $C$ are also cyclic.\nSo $B$, $D_1$, $E_1$, $C$ are cyclic.\n\nExtend $BI$ and $CI$ to meet the circumcircle again at $D_2$ and $E_2$.\nDirect computation gives that $ME_2ID_2$ is also a parallelogram.\nWe also get $E_1D_1$ is parallel to $E_2D_2$\n(both are antiparallel to $BC$ through $\\angle BIC$).\nSo we have homothetic paralellograms and that finishes the problem.\n\\pagebreak", "category": "Geometry", "source": "EGMO", "year": 2014}
{"id": "egmo-2014-q3", "question": "We denote the number of positive divisors of a positive integer $m$ by $d(m)$\nand the number of distinct prime divisors of $m$ by $\\omega(m)$.\nLet $k$ be a positive integer.\nProve that there exist infinitely many positive integers $n$\nsuch that $\\omega(n) = k$ and\n$d(n)$ does not divide $d(a^2+b^2)$\nfor any positive integers $a, b$ satisfying $a + b = n$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3459754}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nWe denote the number of positive divisors of a positive integer $m$ by $d(m)$\nand the number of distinct prime divisors of $m$ by $\\omega(m)$.\nLet $k$ be a positive integer.\nProve that there exist infinitely many positive integers $n$\nsuch that $\\omega(n) = k$ and\n$d(n)$ does not divide $d(a^2+b^2)$\nfor any positive integers $a, b$ satisfying $a + b = n$.\n\\end{mdframed}\nLet $n = 2^{p-1}t$, where $t \\equiv 5 \\pmod 6$, $\\omega(t) = k-1$,\nand $p \\gg t$ is a sufficiently large prime.\nLet $a+b=n$ and $a^2+b^2=c$.\nWe claim that $p \\nmid d(c)$,\nwhich solves the problem since $p \\mid d(n)$.\n\nFirst, note that $3 \\nmid a^2+b^2$, since $3 \\nmid n$.\nNext, note that $c < 2n^2 < 5^{p-1}$ (since $p \\gg t$)\nso no exponent of an odd prime in $c$ exceeds $p-2$.\nMoreover, $c < 2^{3p-1}$.\n\nSo, it remains to check that $\\nu_2(c) \\notin \\{p-1, 2p-1\\}$.\nOn the one hand, if $\\nu_2(a) < \\nu_2(b)$,\nthen $\\nu_2(a) = p-1$ and $\\nu_2(c) = 2\\nu_2(a) = 2p-2$.\nOn the other hand, if $\\nu_2(a) = \\nu_2(b)$\nthen $\\nu_2(a) \\le p-2$, and $\\nu_2(c) = 2\\nu_2(a)+1$\nis odd and less than $2p-1$.\n\n\\begin{remark*}\n  Personally, I find the condition to be artificial,\n  but the construction is kind of fun.\n\n  I also think the scores on this problem during the real contest\n  are low mostly because of the difficulty of problem 2.\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Number Theory", "source": "EGMO", "year": 2014}
{"id": "egmo-2014-q4", "question": "Determine all positive integers $n\\geq 2$ for which there exist integers\n$x_1$, $x_2$, \\dots, $x_{n-1}$ satisfying the condition that\nif $0<i<n$, $0<j<n$, $i\\neq j$ and $n$ divides $2i+j$, then $x_i<x_j$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3460731}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nDetermine all positive integers $n\\geq 2$ for which there exist integers\n$x_1$, $x_2$, \\dots, $x_{n-1}$ satisfying the condition that\nif $0<i<n$, $0<j<n$, $i\\neq j$ and $n$ divides $2i+j$, then $x_i<x_j$.\n\\end{mdframed}\nThe answer is $n = 2^k$ and $n = 3 \\cdot 2^k$, for each $k \\ge 0$ (excluding $n=1$).\n\nWe work with the set $S = \\{1, 2, \\dots, n-1\\} \\bmod n$\nof nonzero residues modulo $n$ instead.\nWe define the relation $\\prec$ on $S$ to mean that\n$2i + j \\equiv 0 \\pmod n$ and $i \\neq j$, for $i,j \\in S$.\nThen the problem satisfies the conditions if and only if $\\prec$ has no cycles,\ni.e.\\ $\\prec$ imposes a partial order on $S$.\n\nThe existence of a cycle for $\\prec$ is equivalent to some choice of $t_1 \\in S$\nand an integer $m \\ge 2$ such that\n\\[ t_1 \\prec t_2 \\prec \\dots \\prec t_m \\prec t_1. \\]\nUnwinding the definition, this is equivalent to two conditions:\n\\begin{itemize}\n  \\ii We need $t_i \\not\\equiv t_{i+1} \\pmod n$ for $i=1,\\dots,m$ (where $t_{m+1}=t_1$).\n  This is equivalent to\n  \\[ 3 \\cdot 2^{i-1} \\cdot t_1 \\equiv 0 \\pmod n \\qquad (\\heartsuit). \\]\n  \\ii For $t_m \\prec t_1$ to be true, we need\n  \\[ (-2)^m t_1 \\equiv t_1 \\pmod n \\iff \\left( (-2)^m-1 \\right) t_1 \\equiv 0 \\pmod n.\n    \\qquad (\\spadesuit) \\]\n\\end{itemize}\nWe now analyze three cases:\n\\begin{itemize}\n  \\ii Let $n = 2^k$.\n  Suppose for contradiction some cycle exists.\n  Then $(-2)^m-1$ is coprime to $n$,\n  so $(\\spadesuit)$ would imply $t_1 \\equiv 0 \\pmod n$, contradiction.\n\n  \\ii Let $n = 3 \\cdot 2^k$.\n  Suppose for contradiction some cycle exists.\n  If $(\\spadesuit)$ holds for some $m$, then $2^k \\mid t_1$,\n  so the only possibility is that $t_1 \\equiv \\pm 2^k \\pmod{n}$\n  and $3 \\mid (-2)^m-1$.\n  However, in that case $(\\heartsuit)$ is violated for $i=1$, contradiction.\n\n  \\ii Suppose $n$ had an $n$ has an odd divisor $d \\mid n$ and $d \\ge 5$.\n  Then taking $t_1 = n/d$ and $m = \\varphi(d)$, the equation $(\\spadesuit)$ is true.\n  Moreover, $(\\heartsuit)$ is true because there is at least one odd prime $p$\n  with $\\nu_p(n) > \\nu_p(3t_1) = \\nu_p(3n/d)$ (since $d \\ge 5$ is odd).\n  So indeed it's possible to construct a cycle.\n\\end{itemize}\nThus these are all the answers and the only answers.\n\\pagebreak", "category": "Combinatorics", "source": "EGMO", "year": 2014}
{"id": "egmo-2014-q5", "question": "Let $n$ be a positive integer.\nWe have $n$ boxes where each box contains a non-negative number of pebbles.\nIn each move we are allowed to take two pebbles from a box we choose,\nthrow away one of the pebbles and put the other pebble in another box we choose.\nAn initial configuration of pebbles is called \\emph{solvable} if it is possible\nto reach a configuration with no empty box, in a finite (possibly zero) number of moves.\nDetermine all initial configurations of pebbles which are not solvable,\nbut become solvable when an additional pebble is added to a box,\nno matter which box is chosen.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3460733}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n$ be a positive integer.\nWe have $n$ boxes where each box contains a non-negative number of pebbles.\nIn each move we are allowed to take two pebbles from a box we choose,\nthrow away one of the pebbles and put the other pebble in another box we choose.\nAn initial configuration of pebbles is called \\emph{solvable} if it is possible\nto reach a configuration with no empty box, in a finite (possibly zero) number of moves.\nDetermine all initial configurations of pebbles which are not solvable,\nbut become solvable when an additional pebble is added to a box,\nno matter which box is chosen.\n\\end{mdframed}\nThe point of the problem is to characterize all the solvable configurations.\nWe claim that it is given by the following:\n\\begin{claim*}\n  A configuration $(a_1, \\dots, a_n)$ is solvable\n  if and only if\n  \\[ \\sum_1^n \\left\\lceil \\frac{a_i}{2} \\right\\rceil \\ge n. \\]\n\\end{claim*}\n\n\\begin{proof}\n  The proof is by induction on the number of stones.\n  If there are fewer than $n$ stones there is nothing to prove.\n  Now assume there are at least $n$ stones,\n  and let $S = \\sum \\left\\lceil a_i/2 \\right\\rceil$.\n  Then:\n  \\begin{itemize}\n    \\ii If $S < n$, this remains true after any operation,\n    so by induction the configuration is not solvable.\n    \\ii Suppose $S \\ge n$, and also that there is an empty box\n    (else we are already done).\n    Then there must be some box with at least two stones.\n    In that case, using those two stones to fill the empty box\n    does not change the value of $S$,\n    but decreases the total number of stones by one, as desired.\n    \\qedhere\n  \\end{itemize}\n\\end{proof}\n\nFrom here we may then extract the answer to the original problem:\nwe require all $a_i$ to be even and $\\sum a_i = 2n-2$.\n\n\\begin{remark*}\n  It should be unsurprising that a criteria of this form exists,\n  since (1) intuitively, one loses nothing by filling\n  empty boxes as soon as possible,\n  and then ignoring boxes with one pebble in them,\n  (2) the set of configurations is a graded partially ordered set,\n  so one can inductively look at small cases.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "EGMO", "year": 2014}
{"id": "egmo-2014-q6", "question": "Solve over $\\RR$ the functional equation\n\\[ f(y^2+2xf(y)+f(x)^2) = (y+f(x)) (x+f(y)). \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3460735}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nSolve over $\\RR$ the functional equation\n\\[ f(y^2+2xf(y)+f(x)^2) = (y+f(x)) (x+f(y)). \\]\n\\end{mdframed}\nA key motivation throughout the problem\nis that the left-hand side is asymmetric\nwhile the right-hand side is symmetric.\nThus any time we plug in two values for $x$ and $y$\nwe will also plug in the opposite pair.\nOnce $f$ is injective this will basically kill the problem.\n\nFirst, we prove the following.\n\\begin{lemma*}\n  There is a unique $z \\in \\RR$ such that $f(z) = 0$.\n\\end{lemma*}\n\\begin{proof}\n  Clearly by putting $y=-f(x)$ such $z$ exists.\n  Now, suppose $f(u) = f(v) = 0$.\n  Then:\n  \\begin{itemize}\n    \\ii Plug $(x,y) = (u,v)$ gives $f(v^2) = uv$.\n    \\ii Plug $(x,y) = (v,u)$ gives $f(u^2) = uv$.\n    \\ii Plug $(x,y) = (u,u)$ gives $f(u^2) = u^2$.\n    \\ii Plug $(x,y) = (v,v)$ gives $f(v^2) = v^2$.\n  \\end{itemize}\n  Consequently $u^2 = uv = v^2$ which yields $u = v$.\n\\end{proof}\n\nNext let $(x,y) = (z,0)$ and $(x,y) = (0,z)$ to get\n\\begin{align*}\n  & f\\left( 2zf(0) \\right)\n  = f\\left( z^2 + f(0)^2 \\right) = 0 \\\\\n  \\implies & 2z f(0) = z^2 + f(0)^2 = z \\\\\n  \\implies &\\boxed{f(0) = z \\in \\left\\{ 0, \\half \\right\\}}.\n\\end{align*}\n\nWe now set to prove:\n\\begin{lemma*}\n  The function $f$ is injective.\n\\end{lemma*}\n\\begin{proof}\n  By putting $(x,y)=(x,z)$ and $(x,y)=(z,x)$ we get\n  \\[ f\\left( f(x)^2 + z^2 \\right) = f\\left( 2zf(x) + x^2 \\right) = x(z+f(x)). \\]\n  Now suppose $f(x_1) = f(x_2)$ but $x_1 \\neq x_2$.\n  This can only happen if $f(x_1) = f(x_2) = -z$.\n  And now \\[ f(x_i)^2 + z^2 = 2zf(x_i) + x_i^2 = z \\qquad i = 1, 2. \\]\n  Solving, we have $x_i = \\pm 1$, $z = \\half$,\n  (since $z = 0$ is not permissible).\n  Thus we have ``almost injectivity''.\n\n  Now plug in $(x,y) = (-1,0)$ and $(x,y) = (0,-1)$ in\n  the original and equate in order to obtain\n  $f(-\\frac34) = f(\\frac54)$, which contradicts the work above.\n\\end{proof}\n\nFinally we may use the symmetry trick in full to obtain\n\\[ y^2 + 2xf(y) + f(x)^2 = x^2 + 2yf(x) + f(y)^2. \\qquad(\\heartsuit) \\]\nIn particular, by setting $y=0$ we obtain\n\\[ f(x)^2 = \\left( z - x \\right)^2. \\]\nTwo easy cases remain:\n\\begin{itemize}\n  \\ii In the $z=0$ case simply note\n  that $(\\heartsuit)$ gives\n  $2xf(y) = 2yf(x)$, so for $x \\neq 0$\n  the value $f(x)/x$ is constant\n  and hence $f(x) \\equiv \\pm x$ follows.\n  \\ii In the $z=\\half$ case $(\\heartsuit)$ becomes\n  $ \\left( 2f(y)+1 \\right)x = \\left( 2f(x)+1 \\right)y $\n  and hence we're done again by the same reasoning.\n\\end{itemize}\n\\pagebreak\n\n\n\\end{document}", "category": "Algebra", "source": "EGMO", "year": 2014}
{"id": "usamo-1996-q1", "question": "Prove that the average of the numbers $n \\sin n^{\\circ}$ for\n$n = 2,4,6,\\dots,180$ is $\\cot 1^{\\circ}$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p353049}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nProve that the average of the numbers $n \\sin n^{\\circ}$ for\n$n = 2,4,6,\\dots,180$ is $\\cot 1^{\\circ}$.\n\\end{mdframed}\nBecause\n\\[ n \\sin n\\dg + (180-n) \\sin(180\\dg-n\\dg) = 180 \\sin n\\dg \\]\nSo enough to show that\n\\[ \\sum_{n=0}^{89} \\sin (2n)\\dg = \\cot1\\dg \\]\nLet $\\zeta = \\cos2\\dg + i \\sin 2 \\dg$ be a primitive root.\nThen\n\\begin{align*}\n  \\sum_{n=0}^{89} \\frac{\\zeta^n - \\zeta^{-n}}{2i}\n  &= \\frac{1}{2i}\n  \\left[ \\frac{\\zeta^{90}-1}{\\zeta-1} - \\frac{\\zeta^{-90} - 1}{\\zeta^{-1}-1} \\right] \\\\\n  &= \\frac{1}{2i}\n  \\left[ \\frac{-2}{\\zeta-1} - \\frac{-2}{\\zeta^{-1}-1} \\right] \\\\\n  &= \\frac{1}{-i} \\frac{\\zeta\\inv-\\zeta}{(\\zeta-1)(\\zeta\\inv-1)}\n  = i \\cdot \\frac{\\zeta+1}{\\zeta-1}.\n\\end{align*}\nAlso,\n\\begin{align*}\n  \\cot 1\\dg &= \\frac{\\cos 1\\dg}{\\sin 1\\dg}\n  = \\frac{(\\cos1\\dg)^2}{\\cos1\\dg\\sin1\\dg} \\\\\n  &= \\frac{\\frac{\\cos2\\dg+1}{2}}{\\frac{\\sin2\\dg}{2}}\n  = \\frac{\\half(\\zeta+\\zeta\\inv)+1}{\\frac{1}{2i}(\\zeta-\\zeta\\inv)} \\\\\n  &= i \\cdot \\frac{(\\zeta+1)^2}{\\zeta^2-1} = i \\cdot \\frac{\\zeta+1}{\\zeta-1}.\n\\end{align*}\nSo we're done.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 1996}
{"id": "usamo-1996-q2", "question": "For any nonempty set $S$ of real numbers,\nlet $\\sigma(S)$ denote the sum of the elements of $S$.\nGiven a set $A$ of $n$ positive integers,\nconsider the collection of all distinct sums $\\sigma(S)$ as $S$ ranges\nover the nonempty subsets of $A$.\nProve that this collection of sums can be\npartitioned into $n$ classes so that in each class,\nthe ratio of the largest sum to the smallest sum does not exceed $2$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p353051}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFor any nonempty set $S$ of real numbers,\nlet $\\sigma(S)$ denote the sum of the elements of $S$.\nGiven a set $A$ of $n$ positive integers,\nconsider the collection of all distinct sums $\\sigma(S)$ as $S$ ranges\nover the nonempty subsets of $A$.\nProve that this collection of sums can be\npartitioned into $n$ classes so that in each class,\nthe ratio of the largest sum to the smallest sum does not exceed $2$.\n\\end{mdframed}\nBy induction on $n$ with $n=1$ being easy.\n\nFor the inductive step, assume\n\\[ A = \\left\\{ a_1 > a_2 > \\dots > a_n \\right\\}. \\]\nFix any index $k$ with the property that\n\\[ a_k > \\frac{\\sigma(A)}{2^k} \\]\n(which must exist since $\\half+\\frac14+\\dots+\\frac{1}{2^k} < 1$).\nThen\n\\begin{itemize}\n  \\ii We make $k$ classes for the sums between $\\frac{\\sigma(A)}{2^k}$\n  and $\\sigma(A)$; this handles every set\n  which has any element in $\\{a_1, \\dots, a_k\\}$.\n  \\ii We make $n-k$ classes via induction hypothesis\n  on $\\{a_{k+1}, \\dots, a_n\\}$.\n\\end{itemize}\nThis solves the problem.\n\n\\begin{remark*}\n  An easy small case to motivate this is the situation $k=1$,\n  which means that the largest element $a_1 \\in A$\n  is enormous compared to all the other elements of $A$,\n  specifically $a_1 > a_2 + a_3 + \\dots + a_n$.\n  In that case, all the sums involving this giant $a_1$ need to be in their own class.\n\n  The idea of the solution is to make this argument work even if $a_1$\n  is not quite that enormous but the sum of the largest few numbers\n  is big compared to the rest of $A$.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "USAMO", "year": 1996}
{"id": "usamo-1996-q3", "question": "Let $ABC$ be a triangle. Prove that there is a line $\\ell$ (in the plane\nof triangle $ABC$) such that the intersection of the interior of\ntriangle $ABC$ and the interior of its reflection $A'B'C'$ in $\\ell$ has\narea more than $\\frac23$ the area of triangle $ABC$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p353052}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle. Prove that there is a line $\\ell$ (in the plane\nof triangle $ABC$) such that the intersection of the interior of\ntriangle $ABC$ and the interior of its reflection $A'B'C'$ in $\\ell$ has\narea more than $\\frac23$ the area of triangle $ABC$.\n\\end{mdframed}\nAll that's needed is:\n\\begin{claim*}\n  If $ABC$ is a triangle where $\\half < \\frac{AB}{AC} < 1$, then\n  the $\\angle A$ bisector works.\n\\end{claim*}\n\\begin{proof}\n  Let the $\\angle A$-bisector meet $BC$ at $D$.\n  The overlapped area is $2[ABD]$ and\n  \\[ \\frac{[ABD]}{[ABC]} = \\frac{BD}{BC} = \\frac{AB}{AB+AC} \\]\n  by angle bisector theorem.\n\\end{proof}\n\nIn general, suppose $x < y < z$ are sides of a triangle.\nThen $\\half < \\frac yz < 1$ by triangle inequality as needed.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Geometry", "source": "USAMO", "year": 1996}
{"id": "usamo-1996-q4", "question": "An $n$-term sequence $(x_1, x_2, \\dots, x_n)$\nin which each term is either $0$ or $1$ is called a binary sequence of length $n$.\nLet $a_n$ be the number of binary sequences of length $n$ containing\nno three consecutive terms equal to $0$, $1$, $0$ in that order.\nLet $b_n$ be the number of binary sequences of length $n$ that\ncontain no four consecutive terms equal to 0, 0, 1, 1 or 1, 1, 0, 0 in that order.\nProve that $b_{n+1} = 2a_n$ for all positive integers $n$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p353058}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nAn $n$-term sequence $(x_1, x_2, \\dots, x_n)$\nin which each term is either $0$ or $1$ is called a binary sequence of length $n$.\nLet $a_n$ be the number of binary sequences of length $n$ containing\nno three consecutive terms equal to $0$, $1$, $0$ in that order.\nLet $b_n$ be the number of binary sequences of length $n$ that\ncontain no four consecutive terms equal to 0, 0, 1, 1 or 1, 1, 0, 0 in that order.\nProve that $b_{n+1} = 2a_n$ for all positive integers $n$.\n\\end{mdframed}\nConsider the map from\nsequences of the latter form to sequences of the first form by\n\\[ (y_1, \\dots, y_{n+1}) \\mapsto (y_1 + y_2, y_2 + y_3, \\dots, y_n + y_{n+1}). \\]\nIt is $2$-to-$1$. The end.\n\\pagebreak", "category": "Combinatorics", "source": "USAMO", "year": 1996}
{"id": "usamo-1996-q5", "question": "Let $ABC$ be a triangle, and $M$ an interior point such that\n$\\angle MAB=10^\\circ$, $\\angle MBA=20^\\circ$, $\\angle MAC=40^\\circ$ and $\\angle MCA=30^\\circ$.\nProve that the triangle is isosceles.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle, and $M$ an interior point such that\n$\\angle MAB=10^\\circ$, $\\angle MBA=20^\\circ$, $\\angle MAC=40^\\circ$ and $\\angle MCA=30^\\circ$.\nProve that the triangle is isosceles.\n\\end{mdframed}\nLet $\\theta = \\angle MBC < 80\\dg$.\nBy trig Ceva, we get\n\\[\n  \\frac{\\sin 10\\dg}{\\sin 40\\dg} \\cdot \\frac{\\sin \\theta}{\\sin 20\\dg}\n  \\cdot \\frac{\\sin 30\\dg}{\\sin (80\\dg-\\theta)} = 1.\n\\]\nThis simplifies to\n\\[ \\sin \\theta = 4 \\sin(80\\dg- \\theta) \\sin 40\\dg \\cos 10\\dg.\\]\n\\begin{claim*}\n  We have $\\theta=60\\dg$.\n\\end{claim*}\n\\begin{proof}\n  The left-hand side is increasing in $\\theta$ and the right-hand\n  side is decreasing in $\\theta$,\n  so at most one value of $\\theta$ works.\n  But we also have\n  \\begin{align*}\n    4\\sin20\\dg \\sin40\\dg \\cos10\\dg\n    &= 2\\left( \\cos20\\dg-\\cos60\\dg \\right) \\cos 10\\dg \\\\\n    &= 2\\cos20\\dg \\cos 10\\dg + \\sin 80\\dg \\\\\n    &= (\\cos 30\\dg - \\cos 10\\dg) + \\sin 80\\dg = \\cos 30\\dg\n  \\end{align*}\n  as desired.\n\\end{proof}\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 1996}
{"id": "usamo-1996-q6", "question": "Determine with proof whether there is a subset $X \\subseteq \\ZZ$\nwith the following property: for any $n \\in \\ZZ$,\nthere is exactly one solution to $a+2b = n$, with $a,b \\in X$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p353061}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nDetermine with proof whether there is a subset $X \\subseteq \\ZZ$\nwith the following property: for any $n \\in \\ZZ$,\nthere is exactly one solution to $a+2b = n$, with $a,b \\in X$.\n\\end{mdframed}\nThe idea is generating functions, but extra care is required\nsince exponents will be in $\\ZZ$ rather than in $\\ZZ_{\\ge 0}$.\n\nHowever, consider formally the limit\n\\[ f(x) = \\prod_{k \\ge 0} \\left( 1 + x^{(-4)^k} \\right). \\]\nFor size reasons, this indeed converges formally to a power series,\nin the sense that the coefficient of any $x^k$\nis eventually zero or one for all partial sums.\n\nWe claim $X = \\{ n : [x^n] f(x) = 1 \\}$ works.\n\nFor a given $n$, we can truncate the sum at some large $N$ again for size reasons.\nFor convenience assume $N$ is even.\nNow set\n\\[ f_N(x) = \\prod_{k = 0}^N \\left( 1 + x^{(-4)^k}  \\right). \\]\nNext, we compute\n\\[\n  f_N(x) f_N(x^2)\n  = \\frac{(1+x)(1+x^2) \\dots ( 1+x^{2^{2N+1}} )}%\n  {x^{2+8+\\dots+2^{2N-1}}}\n  = \\dots + x^{-2} + x^{-1} + 1 + x + x^2 + \\dots\n\\]\nas desired.\n\n\\begin{remark*}\n  The analogous problem with $\\ZZ$ replaced by $\\ZZ_{\\ge 0}$ is easier to think about;\n  this has the same generating function but it's easier to think about.\n  In that case, the desired $X'$ is also equivalently be described as the set of numbers\n  whose base-$4$ representation has only $0$ and $1$.\n  Then every base $4$-number can be written uniquely as $a+2b$ for $a,b \\in X'$,\n  by looking digit-by-digit.\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Number Theory", "source": "USAMO", "year": 1996}
{"id": "tstst-2012-q1", "question": "Determine all infinite strings of letters with the following properties:\n\\begin{enumerate}\n  \\item[(a)] Each letter is either $T$ or $S$,\n  \\item[(b)] If position $i$ and $j$ both have the letter $T$,\n    then position $i+j$ has the letter $S$,\n  \\item[(c)] There are infinitely many integers $k$ such that position $2k-1$ has the $k$th $T$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2745864}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nDetermine all infinite strings of letters with the following properties:\n\\begin{enumerate}\n  \\item[(a)] Each letter is either $T$ or $S$,\n  \\item[(b)] If position $i$ and $j$ both have the letter $T$,\n    then position $i+j$ has the letter $S$,\n  \\item[(c)] There are infinitely many integers $k$ such that position $2k-1$ has the $k$th $T$.\n\\end{enumerate}\n\\end{mdframed}\nWe wish to find all infinite sequences $a_1, a_2, \\dots$\nof positive integers satisfying the following properties:\n \\begin{enumerate}[(a)]\n  \\item $a_1 < a_2 < a_3 < \\dotsb$,\n  \\item there are no positive integers $i$, $j$, $k$, not necessarily distinct, such that $a_i+a_j=a_k$,\n  \\item there are infinitely many $k$ such that $a_k = 2k-1$.\n \\end{enumerate}\n\nIf $a_k=2k-1$ for some $k>1$, let $A_k=\\{a_1,a_2,\\dots,a_k\\}$.\nBy (b) and symmetry, we have\n\\[ 2k-1\n  \\ge \\frac{|A_k-A_k|-1}{2}+|A_k|\n  \\ge \\frac{2|A_k|-2}{2}+|A_k| = 2k-1. \\]\nBut in order for $|A_k-A_k|=2|A_k|-1$,\nwe must have $A_k$ an arithmetic progression,\nwhence $a_n=2n-1$ for all $n$ by taking $k$ arbitrarily large.\n\\pagebreak", "category": "Combinatorics", "source": "TSTST", "year": 2012}
{"id": "tstst-2012-q2", "question": "Let $ABCD$ be a quadrilateral with $AC = BD$.\nDiagonals $AC$ and $BD$ meet at $P$.\nLet $\\omega_1$ and $O_1$ denote the circumcircle and circumcenter of triangle $ABP$.\nLet $\\omega_2$ and $O_2$ denote the circumcircle and circumcenter of triangle $CDP$.\nSegment $BC$ meets $\\omega_1$ and $\\omega_2$ again at $S$ and $T$\n(other than $B$ and $C$), respectively.\nLet $M$ and $N$ be the midpoints of minor arcs $\\arc{SP}$ (not including $B$)\nand $\\arc{TP}$ (not including $C$).\nProve that $\\ol{MN} \\parallel \\ol{O_1O_2}$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2745851}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABCD$ be a quadrilateral with $AC = BD$.\nDiagonals $AC$ and $BD$ meet at $P$.\nLet $\\omega_1$ and $O_1$ denote the circumcircle and circumcenter of triangle $ABP$.\nLet $\\omega_2$ and $O_2$ denote the circumcircle and circumcenter of triangle $CDP$.\nSegment $BC$ meets $\\omega_1$ and $\\omega_2$ again at $S$ and $T$\n(other than $B$ and $C$), respectively.\nLet $M$ and $N$ be the midpoints of minor arcs $\\arc{SP}$ (not including $B$)\nand $\\arc{TP}$ (not including $C$).\nProve that $\\ol{MN} \\parallel \\ol{O_1O_2}$.\n\\end{mdframed}\nLet $Q$ be the second intersection point of $\\omega_1$, $\\omega_2$.\nSuffice to show $\\ol{QP} \\perp \\ol{MN}$.\nNow $Q$ is the center of a spiral \\emph{congruence}\nwhich sends $\\ol{AC} \\mapsto \\ol{BD}$.\nSo $\\triangle QAB$ and $\\triangle QCD$ are similar isosceles.\nNow, \\[ \\dang QPA = \\dang QBA = \\dang DCQ = \\dang DPQ \\]\nand so $\\ol{QP}$ is bisects $\\angle BPC$.\n\n\\begin{center}\n\\begin{asy}\nsize(12cm);\npair Q = dir(80);\npair B = dir(190);\npair C = dir(350);\npair A = shift(Q)*rotate(-40)*shift(-Q)*B;\npair D = shift(Q)*rotate(40)*shift(-Q)*C;\npair P = extension(A, C, B, D);\ndraw(circumcircle(A, B, P));\ndraw(circumcircle(C, D, P));\nfilldraw(A--B--C--D--cycle, opacity(0.1)+lightcyan, lightcyan);\nfilldraw(Q--A--C--cycle, opacity(0.1)+lightgreen, lightblue);\nfilldraw(Q--B--D--cycle, opacity(0.1)+lightgreen, lightblue);\npair O_1 = circumcenter(A, B, P);\npair O_2 = circumcenter(C, D, P);\npair S = -B+2*foot(O_1, B, C);\npair T = -C+2*foot(O_2, B, C);\npair M = circumcenter(S, P, incenter(B, S, P));\npair N = circumcenter(T, P, incenter(C, T, P));\ndraw(M--N, blue);\ndraw(O_1--O_2, blue);\npair I = incenter(P, B, C);\ndraw(Q--I, blue);\ndraw(B--I--C, blue);\n\ndot(\"$Q$\", Q, dir(Q));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$A$\", A, dir(A));\ndot(\"$D$\", D, dir(D));\ndot(\"$P$\", P, dir(60));\ndot(\"$O_1$\", O_1, dir(150));\ndot(\"$O_2$\", O_2, dir(10));\ndot(\"$S$\", S, dir(-90));\ndot(\"$T$\", T, dir(-90));\ndot(\"$M$\", M, dir(100));\ndot(\"$N$\", N, dir(35));\ndot(\"$I$\", I, dir(45));\n\n/* TSQ Source:\n\nQ = dir 80\nB = dir 190\nC = dir 350\nA = shift(Q)*rotate(-40)*shift(-Q)*B\nD = shift(Q)*rotate(40)*shift(-Q)*C\nP = extension A C B D\ncircumcircle A B P\ncircumcircle C D P\nA--B--C--D--cycle 0.1 lightcyan / lightcyan\nQ--A--C--cycle 0.1 lightgreen / lightblue\nQ--B--D--cycle 0.1 lightgreen / lightblue\nO_1 = circumcenter A B P\nO_2 = circumcenter C D P\nS = -B+2*foot O_1 B C\nT = -C+2*foot O_2 B C\nM = circumcenter S P incenter B S P\nN = circumcenter T P incenter C T P\nM--N blue\nO_1--O_2 blue\nI = incenter P B C\nQ--I blue\nB--I--C blue\n\n*/\n\\end{asy}\n\\end{center}\n\n\nNow, let $I = \\ol{BM} \\cap \\ol{CN} \\cap \\ol{PQ}$\nbe the incenter of $\\triangle PBC$.\nThen $IM \\cdot IB = IP \\cdot IQ = IN \\cdot IC$, so $BMNC$ is cyclic,\nmeaning $\\ol{MN}$ is antiparallel to $\\ol{BC}$ through $\\angle BIC$.\nSince $\\ol{QPI}$ passes through the circumcenter of $\\triangle BIC$,\nit follows now $\\ol{QPI} \\perp \\ol{MN}$ as desired.\n\\pagebreak", "category": "Geometry", "source": "TSTST", "year": 2012}
{"id": "tstst-2012-q3", "question": "Let $\\NN$ be the set of positive integers.\nLet $f \\colon \\NN \\to \\NN$ be a function satisfying the following two conditions:\n\\begin{enumerate}[(a)]\n \\ii $f(m)$ and $f(n)$ are relatively prime whenever $m$ and $n$ are relatively prime.\n \\ii $n \\le f(n) \\le n+2012$ for all $n$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2745877}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $\\NN$ be the set of positive integers.\nLet $f \\colon \\NN \\to \\NN$ be a function satisfying the following two conditions:\n\\begin{enumerate}[(a)]\n \\ii $f(m)$ and $f(n)$ are relatively prime whenever $m$ and $n$ are relatively prime.\n \\ii $n \\le f(n) \\le n+2012$ for all $n$.\n\\end{enumerate}\nProve that for any natural number $n$ and any prime $p$,\nif $p$ divides $f(n)$ then $p$ divides $n$.\n\\end{mdframed}\n\\paragraph{First short solution, by Jeffrey Kwan.}\nLet $p_0$, $p_1$, $p_2$, \\dots\\ denote the\nsequence of all prime numbers, in any order.\nPick \\emph{any} primes $q_i$ such that\n\\[ q_0 \\mid f(p_0), \\quad q_1 \\mid f(p_1), \\quad\n  q_2 \\mid f(p_2), \\; \\text{ etc}. \\]\nThis is possible since each $f$ value above exceeds $1$.\nAlso, since by hypothesis the $f(p_i)$ are pairwise coprime,\nthe primes $q_i$ are all pairwise distinct.\n\n\\begin{claim*}\n  We must have $q_i = p_i$ for each $i$.\n  (Therefore, $f(p_i)$ is a power of $p_i$ for each $i$.)\n\\end{claim*}\n\\begin{proof}\n  Assume to the contrary that $q_0 \\neq p_0$.\n  By changing labels if necessary, assume\n  $\\min(p_1, p_2, \\dots, p_{2012}) > 2012$.\n  Then by Chinese remainder theorem we can choose\n  an integer $m$ such that\n  \\begin{align*}\n    m+i &\\equiv 0 \\pmod{q_i} \\\\\n    m &\\not\\equiv 0 \\pmod{p_i}\n  \\end{align*}\n  for $0 \\le i \\le 2012$.\n  But now $f(m)$ should be coprime to all $f(p_i)$,\n  ergo coprime to $q_0 q_1 \\dots q_{2012}$,\n  violating $m \\le f(m) \\le m+2012$.\n\\end{proof}\n\nAll that is left to do is note that whenever $p \\nmid n$,\nwe have $\\gcd(f(p), f(n)) = 1$, hence $p \\nmid f(n)$.\nThis is the contrapositive of the problem statement.\n\n\n\\paragraph{Second solution with a grid.}\nFix $n$ and $p$, and assume for contradiction $p \\nmid n$.\n\n\\begin{claim*}\n  There exists a large integer $N$ with $f(N) = N$,\n  that also satisfies $N \\equiv 1 \\pmod n$ and $N \\equiv 0 \\pmod p$.\n\\end{claim*}\n\\begin{proof}\n  We'll need to pick both $N$ and an ancillary integer $M$.\n  Here is how: pick $2012 \\cdot 2013$ distinct primes $q_{i,j} > n+p+2013$\n  for every $i=1,\\dots,2012$ and $j=0,\\dots,2012$,\n  and use it to fill in the following table:\n  \\[\n    \\begin{array}{c|cccc}\n      & N+1 & N+2 & \\dots & N+2012 \\\\ \\hline\n      M & q_{0,1} & q_{0,2} & \\dots & q_{0,2012} \\\\\n      M+1 & q_{1,1} & q_{1,2} & \\dots & q_{1,2012} \\\\\n      \\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n      M+2012 & q_{2012,1} & q_{2012,2} & \\dots & q_{2012,2012}\n    \\end{array}.\n  \\]\n  By the Chinese Remainder Theorem, we can construct $N$\n  such that $N+1 \\equiv 0 \\pmod{q_{i,1}}$ for every $i$,\n  and similarly for $N+2$, and so on.\n  Moreover, we can also tack on the extra conditions\n  $N \\equiv 0 \\pmod p$ and $N \\equiv 1 \\pmod n$ we wanted.\n\n  Notice that $N$ cannot be divisible by any of the $q_{i,j}$'s,\n  since the $q_{i,j}$'s are greater than $2012$.\n\n  After we've chosen $N$, we can pick $M$ such that $M \\equiv 0 \\pmod{q_{0,j}}$ for every $j$,\n  and similarly $M+1 \\equiv 0 \\pmod{q_{1,j}}$, et cetera.\n  Moreover, we can tack on the condition $M \\equiv 1 \\pmod N$,\n  which ensures $\\gcd(M,N) = 1$.\n\n  What does this do?\n  We claim that $f(N) = N$ now.\n  Indeed $f(M)$ and $f(N)$ are relatively prime; but look at the table!\n  The table tells us that $f(M)$ must have a common factor\n  with each of $N+1, \\dots, N+2012$.\n  So the only possibility is that $f(N) = N$.\n\\end{proof}\n\nNow we're basically done.\nSince $N \\equiv 1 \\pmod n$, we have $\\gcd(N,n) = 1$\nand hence $1 = \\gcd(f(N), f(n)) = \\gcd(N, f(n))$.\nBut $p \\mid N$ and $p \\mid f(n)$, contradiction.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Number Theory", "source": "TSTST", "year": 2012}
{"id": "tstst-2012-q4", "question": "In scalene triangle $ABC$, let the feet of the perpendiculars\nfrom $A$ to $\\ol{BC}$, $B$ to $\\ol{CA}$, $C$ to $\\ol{AB}$\nbe $A_1, B_1, C_1$, respectively.\nDenote by $A_2$ the intersection of lines $BC$ and $B_1C_1$.\nDefine $B_2$ and $C_2$ analogously.\nLet $D$, $E$, $F$ be the respective midpoints\nof sides $\\ol{BC}$, $\\ol{CA}$, $\\ol{AB}$.\nShow that the perpendiculars from $D$ to $\\ol{AA_2}$,\n$E$ to $\\ol{BB_2}$ and $F$ to $\\ol{CC_2}$ are concurrent.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2745854}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nIn scalene triangle $ABC$, let the feet of the perpendiculars\nfrom $A$ to $\\ol{BC}$, $B$ to $\\ol{CA}$, $C$ to $\\ol{AB}$\nbe $A_1, B_1, C_1$, respectively.\nDenote by $A_2$ the intersection of lines $BC$ and $B_1C_1$.\nDefine $B_2$ and $C_2$ analogously.\nLet $D$, $E$, $F$ be the respective midpoints\nof sides $\\ol{BC}$, $\\ol{CA}$, $\\ol{AB}$.\nShow that the perpendiculars from $D$ to $\\ol{AA_2}$,\n$E$ to $\\ol{BB_2}$ and $F$ to $\\ol{CC_2}$ are concurrent.\n\\end{mdframed}\nWe claim that they pass through the orthocenter $H$.\nIndeed, consider the circle with diameter $\\ol{BC}$,\nwhich circumscribes quadrilateral $BCB_1C_1$ and has center $D$.\nThen by Brocard theorem, $\\ol{AA_2}$ is the polar of line $H$.\nThus $\\ol{DH} \\perp \\ol{AA_2}$.\n\\pagebreak", "category": "Geometry", "source": "TSTST", "year": 2012}
{"id": "tstst-2012-q5", "question": "A rational number $x$ is given.\nProve that there exists a sequence\n$x_0, x_1, x_2, \\dots$ of rational numbers\nwith the following properties:\n\\begin{enumerate}[(a)]\n  \\item $x_0=x$;\n  \\item for every $n\\ge1$, either $x_n = 2x_{n-1}$ or $x_n = 2x_{n-1} + \\frac{1}{n}$;\n  \\item $x_n$ is an integer for some $n$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2745867}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA rational number $x$ is given.\nProve that there exists a sequence\n$x_0, x_1, x_2, \\dots$ of rational numbers\nwith the following properties:\n\\begin{enumerate}[(a)]\n  \\item $x_0=x$;\n  \\item for every $n\\ge1$, either $x_n = 2x_{n-1}$ or $x_n = 2x_{n-1} + \\frac{1}{n}$;\n  \\item $x_n$ is an integer for some $n$.\n\\end{enumerate}\n\\end{mdframed}\nThink of the sequence as a process over time.\nWe'll show that:\n\\begin{claim*}\n  At any given time $t$,\n  if the denominator of $x_t$ has some odd prime power $q = p^e$,\n  then we can delete a factor of $p$ from the denominator,\n  while only adding powers of two to the denominator.\n\\end{claim*}\n(Thus we can just delete off all the odd primes one by one\nand then double appropriately many times.)\n\n\\begin{proof}\nThe idea is to add only fractions of the form $(2^k q)\\inv$.\n\nIndeed, let $n$ be large,\nand suppose $t < 2^{r+1} q < 2^{r+2} q < \\dots < 2^{r+m} q < n$.\nFor some binary variables $\\eps_i \\in \\{0,1\\}$ we can have\n\\[ x_n = 2^{n-t} x_t\n  + c_1 \\cdot \\frac{\\eps_1}{q}\n  + c_2 \\cdot \\frac{\\eps_2}{q}\n  \\dots\n  + c_s \\cdot \\frac{\\eps_m}{q}\n\\]\nwhere $c_i$ is some power of $2$\n(to be exact, $c_i = \\frac{2^{n-2^{r+i}q}}{2^{r+1}}$,\nbut the exact value doesn't matter).\n\nIf $m$ is large enough the set $\\{0,c_1\\} + \\{0,c_2\\} + \\dots + \\{0, c_m\\}$\nspans everything modulo $p$.\n(Actually, Cauchy-Davenport implies $m=p$ is enough,\nbut one can also just use Pigeonhole to notice some residue appears\nmore than $p$ times, for $m = O(p^2)$.)\nThus we can eliminate one factor of $p$ from the denominator, as desired.\n\\end{proof}\n\\pagebreak", "category": "Number Theory", "source": "TSTST", "year": 2012}
{"id": "tstst-2012-q6", "question": "Positive real numbers $x, y, z$ satisfy $xyz+xy+yz+zx = x+y+z+1$.\nProve that\n\\[ \\frac{1}{3} \\left( \\sqrt{\\frac{1+x^2}{1+x}}\n  + \\sqrt{\\frac{1+y^2}{1+y}}\n  + \\sqrt{\\frac{1+z^2}{1+z}} \\right)\n  \\le \\left( \\frac{x+y+z}{3} \\right)^{5/8} . \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2745861}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nPositive real numbers $x, y, z$ satisfy $xyz+xy+yz+zx = x+y+z+1$.\nProve that\n\\[ \\frac{1}{3} \\left( \\sqrt{\\frac{1+x^2}{1+x}}\n  + \\sqrt{\\frac{1+y^2}{1+y}}\n  + \\sqrt{\\frac{1+z^2}{1+z}} \\right)\n  \\le \\left( \\frac{x+y+z}{3} \\right)^{5/8} . \\]\n\\end{mdframed}\nThe key is the identity\n\\begin{align*}\n  \\frac{x^2+1}{x+1} &= \\frac{(x^2+1)(y+1)(z+1)}{(x+1)(y+1)(z+1)} \\\\\n  &= \\frac{x(xyz+xy+xz)+x^2+yz+y+z+1}{2(1+x+y+z)} \\\\\n  &= \\frac{x(x+y+z+1-yz) + x^2+yz+y+z+1}{2(1+x+y+z)} \\\\\n  &= \\frac{(x+y)(x+z) + x^2 + \\left( x-xyz+y+z+1 \\right)}{2(1+x+y+z)} \\\\\n  &= \\frac{2(x+y)(x+z)}{2(1+x+y+z)} \\\\\n  &= \\frac{(x+y)(x+z)}{1+x+y+z}.\n\\end{align*}\n\\begin{remark*}\n  The ``trick'' can be rephrased as\n  $(x^2+1)(y+1)(z+1) = 2(x+y)(x+z)$.\n\\end{remark*}\nAfter this, straight Cauchy in the obvious way will do it\n(reducing everything to an inequality in $s = x+y+z$).\nOne writes\n\\begin{align*}\n  \\left( \\sum_{\\text{cyc}} \\frac{\\sqrt{(x+y)(x+z)}}{\\sqrt{1+s}} \\right)^2\n  &\\le \\frac{\\left( \\sum_{\\text{cyc}} x+y \\right)\n    \\left( \\sum_{\\text{cyc}} x+z \\right)}{1+s} \\\\\n  &= \\frac{4s^2}{1+s}\n\\end{align*}\nand so it suffices to check that $\\frac{4s^2}{1+s} \\le 9(s/3)^{5/4}$,\nwhich is true because\n\\[ (s/3)^5 \\cdot 9^4 \\cdot (1+s)^4 - (4s^2)^4\n  = s^5 (s-3)^2 (27s^2 + 14s + 3) \\ge 0. \\]\n\\pagebreak\n\n\\section{Solutions to Day 3}", "category": "Geometry", "source": "TSTST", "year": 2012}
{"id": "tstst-2012-q7", "question": "Triangle $ABC$ is inscribed in circle $\\Omega$.\nThe interior angle bisector of angle $A$ intersects side $BC$\nand $\\Omega$ at $D$ and $L$ (other than $A$), respectively.\nLet $M$ be the midpoint of side $BC$.\nThe circumcircle of triangle $ADM$ intersects sides\n$AB$ and $AC$ again at $Q$ and $P$ (other than $A$), respectively.\nLet $N$ be the midpoint of segment $PQ$,\nand let $H$ be the foot of the perpendicular from $L$ to line $ND$.\nProve that line $ML$ is tangent to the circumcircle of triangle $HMN$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2745857}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nTriangle $ABC$ is inscribed in circle $\\Omega$.\nThe interior angle bisector of angle $A$ intersects side $BC$\nand $\\Omega$ at $D$ and $L$ (other than $A$), respectively.\nLet $M$ be the midpoint of side $BC$.\nThe circumcircle of triangle $ADM$ intersects sides\n$AB$ and $AC$ again at $Q$ and $P$ (other than $A$), respectively.\nLet $N$ be the midpoint of segment $PQ$,\nand let $H$ be the foot of the perpendicular from $L$ to line $ND$.\nProve that line $ML$ is tangent to the circumcircle of triangle $HMN$.\n\\end{mdframed}\nBy angle chasing, equivalent to show $\\ol{MN} \\parallel \\ol{AD}$,\nso discard the point $H$.\nWe now present a three solutions.\n\n\\paragraph{First solution using vectors.}\nWe first contend that:\n\\begin{claim*}\n  We have $QB = PC$.\n\\end{claim*}\n\\begin{proof}\n  Power of a Point gives $BM \\cdot BD = AB \\cdot QB$.\n  Then use the angle bisector theorem.\n\\end{proof}\nNow notice that the vector\n\\[ \\overrightarrow{MN}\n  = \\half \\left( \\overrightarrow{BQ} + \\overrightarrow{CP} \\right) \\]\nwhich must be parallel to the angle bisector\nsince $\\overrightarrow{BQ}$ and $\\overrightarrow{CP}$\nhave the same magnitude.\n\n\n\\paragraph{Second solution using spiral similarity.}\nlet $X$ be the arc midpoint of $BAC$.\nThen $ADMX$ is cyclic with diameter $\\ol{XD}$,\nand hence $X$ is the Miquel point of $QBPC$ and thus the midpoint of arc $BAC$.\nMoreover $\\ol{XND}$ collinear (as $XP=XQ$, $DP=DQ$) on $(APQ)$.\n\n\\begin{center}\n\\begin{asy}\npair A = dir(130);\npair B = dir(210);\npair C = dir(330);\ndraw(A--B--C--cycle, lightblue);\nfilldraw(unitcircle, opacity(0.1)+lightblue, blue);\n\npair L = dir(-90);\npair D = extension(A, L, B, C);\npair M = midpoint(B--C);\npath w = circumcircle(A,D,M);\ndraw(w, dashed+orange);\npair Q = OP(A--B, w);\npair P = IP(A--C, w);\npair N = midpoint(P--Q);\npair H = foot(L, N, D);\n\npair X = dir(90);\n\ndraw(A--L, blue);\ndraw(circumcircle(H, D, M), lightblue+dotted);\ndraw(P--Q, blue);\n\ndraw(Q--X--C, blue);\ndraw(N--H, lightblue+dotted);\ndraw(M--L, lightblue+dotted);\n\nfilldraw(X--N--M--cycle, opacity(0.1)+lightgreen, heavygreen);\nfilldraw(X--P--C--cycle, opacity(0.1)+lightgreen, heavygreen);\nfilldraw(X--Q--B--cycle, opacity(0.1)+lightgreen, heavygreen);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$L$\", L, dir(L));\ndot(\"$D$\", D, dir(D));\ndot(\"$M$\", M, dir(-90));\ndot(\"$Q$\", Q, dir(Q));\ndot(\"$P$\", P, dir(10));\ndot(\"$N$\", N, dir(130));\ndot(\"$H$\", H, dir(H));\ndot(\"$X$\", X, dir(X));\n\n/* TSQ Source:\n\nA = dir 130\nB = dir 210\nC = dir 330\nA--B--C--cycle lightblue\nunitcircle 0.1 lightblue / blue\n\nL = dir -90\nD = extension A L B C\nM = midpoint B--C R-90\n!path w = circumcircle(A,D,M);\nw dashed orange\nQ = OP A--B w\nP = IP A--C w R10\nN = midpoint P--Q R130\nH = foot L N D\n\nX = dir 90\n\nA--L blue\ncircumcircle H D M lightblue dotted\nP--Q blue\n\nQ--X--C blue\nN--H lightblue dotted\nM--L lightblue dotted\n\nX--N--M--cycle 0.1 lightgreen / heavygreen\nX--P--C--cycle 0.1 lightgreen / heavygreen\nX--Q--B--cycle 0.1 lightgreen / heavygreen\n\n*/\n\\end{asy}\n\\end{center}\nThen $\\triangle XNM \\sim \\triangle XPC$ spirally, and\n\\[ \\dang XMN = \\dang XCP = \\dang XCA = \\dang XLA \\]\nthus done.\n\n\n\\paragraph{Third solution using barycentrics (mine).}\nOnce reduced to $\\ol{MN} \\parallel \\ol{AB}$,\nstraight bary will also work.\nBy power of a point one obtains\n\\begin{align*}\n  P &= \\left( a^2 : 0 : 2b(b+c)-a^2 \\right) \\\\\n  Q &= \\left( a^2 : 2c(b+c)-a^2 : 0 \\right) \\\\\n  \\implies N &= \\left( a^2(b+c) : 2bc(b+c) - ba^2 : 2bc(b+c)-ca^2 \\right).\n\\end{align*}\nNow the point at infinity along $\\ol{AD}$ is $(-(b+c):b:c)$\nand so we need only verify\n\\[\n  \\det \\begin{bmatrix}\n    a^2(b+c) & 2bc(b+c) - ba^2 & 2bc(b+c)-ca^2 \\\\\n    0 & 1 & 1 \\\\\n    -(b+c) & b & c\n  \\end{bmatrix}\n  = 0\n\\]\nwhich follows since the first row is $-a^2$\ntimes the third row plus $2bc(b+c)$ times the second row.\n\\pagebreak", "category": "Geometry", "source": "TSTST", "year": 2012}
{"id": "tstst-2012-q8", "question": "Let $n$ be a positive integer.\nConsider a triangular array of nonnegative integers as follows:\n\\begin{center}\n\\begin{asy}\n  size(8cm);\n  defaultpen(fontsize(10pt));\n  label(scale(0.8)*\"Row $1$:\", (-6, 2.9));\n  label(scale(0.8)*\"Row $2$:\", (-6, 2.2));\n  label(scale(0.8)*\"$\\vdots$\", (-6, 1.5));\n  label(scale(0.8)*\"Row $n-1$:\", (-6, 0.8));\n  label(scale(0.8)*\"Row $n$:\", (-6, 0.1));\n\n  label(\"$a_{0,1}$\", (0,2.8));\n\n  label(\"$a_{0,2}$\", (-1,2.1));\n  label(\"$a_{1,2}$\", ( 1,2.1));\n\n  label(rotate(90)*\"$\\ddots$\", (-2,1.5));\n  label(\"$\\vdots$\", ( 0,1.5));\n  label(\"$\\ddots$\", ( 2,1.5));\n\n  label(\"$a_{0,n-1}$\", (-3,0.7));\n  label(\"$a_{1,n-1}$\", (-1,0.7));\n  label(\"$\\dots$\", (1,0.7));\n  label(\"$a_{n-2,n-1}$\", (3,0.7));\n\n  label(\"$a_{0,n}$\", (-4,0));\n  label(\"$a_{1,n}$\", (-2,0));\n  label(\"$a_{2,n}$\", (-0,0));\n  label(\"$\\dots$\", (2,0));\n  label(\"$a_{n-1,n}$\", (4,0));\n\\end{asy}\n\\end{center}\nCall such a triangular array \\textit{stable} if for every $0 \\le i < j < k \\le n$ we have\n\\[ a_{i,j} + a_{j,k} \\le a_{i,k} \\le a_{i,j} + a_{j,k} + 1. \\]\nFor $s_1$, \\dots, $s_n$ any nondecreasing sequence of nonnegative integers,\nprove that there exists a unique stable triangular array such that\nthe sum of all of the entries in row $k$ is equal to $s_k$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2745872}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n$ be a positive integer.\nConsider a triangular array of nonnegative integers as follows:\n\\begin{center}\n\\begin{asy}\n  size(8cm);\n  defaultpen(fontsize(10pt));\n  label(scale(0.8)*\"Row $1$:\", (-6, 2.9));\n  label(scale(0.8)*\"Row $2$:\", (-6, 2.2));\n  label(scale(0.8)*\"$\\vdots$\", (-6, 1.5));\n  label(scale(0.8)*\"Row $n-1$:\", (-6, 0.8));\n  label(scale(0.8)*\"Row $n$:\", (-6, 0.1));\n\n  label(\"$a_{0,1}$\", (0,2.8));\n\n  label(\"$a_{0,2}$\", (-1,2.1));\n  label(\"$a_{1,2}$\", ( 1,2.1));\n\n  label(rotate(90)*\"$\\ddots$\", (-2,1.5));\n  label(\"$\\vdots$\", ( 0,1.5));\n  label(\"$\\ddots$\", ( 2,1.5));\n\n  label(\"$a_{0,n-1}$\", (-3,0.7));\n  label(\"$a_{1,n-1}$\", (-1,0.7));\n  label(\"$\\dots$\", (1,0.7));\n  label(\"$a_{n-2,n-1}$\", (3,0.7));\n\n  label(\"$a_{0,n}$\", (-4,0));\n  label(\"$a_{1,n}$\", (-2,0));\n  label(\"$a_{2,n}$\", (-0,0));\n  label(\"$\\dots$\", (2,0));\n  label(\"$a_{n-1,n}$\", (4,0));\n\\end{asy}\n\\end{center}\nCall such a triangular array \\textit{stable} if for every $0 \\le i < j < k \\le n$ we have\n\\[ a_{i,j} + a_{j,k} \\le a_{i,k} \\le a_{i,j} + a_{j,k} + 1. \\]\nFor $s_1$, \\dots, $s_n$ any nondecreasing sequence of nonnegative integers,\nprove that there exists a unique stable triangular array such that\nthe sum of all of the entries in row $k$ is equal to $s_k$.\n\\end{mdframed}\nFirstly, here are illustrative examples showing the arrays\nfor $(s_1, s_2, s_3, s_4) = (2, 5, 9, x)$ where $9 \\le x \\le 14$.\n(The array has been left justified.)\n\\[\n  \\begin{bmatrix}\n    2 & \\swarrow \\\\\n    4 & 1 & \\swarrow \\\\\n    5 & 3 & 1 & \\swarrow \\\\\n    5 & 3 & 1 & 0\n  \\end{bmatrix}\n  \\begin{bmatrix}\n    2 & \\swarrow \\\\\n    4 & 1 & \\swarrow \\\\\n    5 & 3 & 1 & \\swarrow \\\\\n    \\mathbf{\\color{red} 6} & 3 & 1 & 0\n  \\end{bmatrix}\n  \\begin{bmatrix}\n    2 & \\swarrow \\\\\n    4 & 1 & \\swarrow \\\\\n    5 & 3 & 1 & \\swarrow \\\\\n    6 & 3 & \\mathbf{\\color{red} 2} & 0\n  \\end{bmatrix}\n\\]\n\\[\n  \\begin{bmatrix}\n    2 & \\swarrow \\\\\n    4 & 1 & \\swarrow \\\\\n    5 & 3 & 1 & \\swarrow \\\\\n    6 & \\mathbf{\\color{red} 4} & 2 & 0\n  \\end{bmatrix}\n  \\begin{bmatrix}\n    2 & \\swarrow \\\\\n    4 & 1 & \\swarrow \\\\\n    5 & 3 & 1 & \\swarrow \\\\\n    6 & 4 & 2 & \\mathbf{\\color{red} 1}\n  \\end{bmatrix}\n  \\begin{bmatrix}\n    2 & \\swarrow \\\\\n    4 & 1 & \\swarrow \\\\\n    5 & 3 & 1 & \\swarrow \\\\\n    \\mathbf{\\color{red} 7} & 4 & 2 & 1\n  \\end{bmatrix}\n\\]\n\n\nNow we outline the proof.\nBy induction on $n$, we may assume the first $n-1$ rows are fixed.\nNow, let $N = s_n$ vary.\nNow, we prove our result by (another) induction on $N \\ge s_{n-1}$.\n\nThe base case $N = s_{n-1}$ is done by copying\nthe $n-1$st row and adding a zero at the end.\nThis is also unique,\nsince $a_{i,n} \\ge a_{i-1,n} + a_{n-1,n}$ for all $i=0, \\dots, n-2$,\nwhence $\\sum a_{i,n} \\ge s_{n-1}$ follows.\n\nNow the inductive step is based on the following lemma,\nwhich illustrates the idea of a ``unique increasable entry''.\n\\begin{lemma*}\n  Fix a stable array\n  Construct a tournament on the $n$ entries\n  of the last row as follows: for $i < j$,\n  \\begin{itemize}\n    \\ii $a_{i,n} \\to a_{j,n}$\n    if $a_{i,n} = a_{i,j} + a_{j,n}$, and\n    \\ii $a_{j,n} \\to a_{i,n}$\n    if $a_{i,n} = a_{i,j} + a_{j,n} + 1$.\n  \\end{itemize}\n  Then this tournament is transitive.\n  Also, except for $N = s_{n-1}$, a $0$ entry is never a source.\n\\end{lemma*}\nIntuitively, $a_{i,n} \\to a_{j,n}$\nif $a_{i,n}$ blocks $a_{j,n}$ from increasing.\nFor instance, in the example\n\\[\n  \\begin{bmatrix}\n    2 & \\swarrow \\\\\n    4 & 1 & \\swarrow \\\\\n    5 & 3 & 1 & \\swarrow \\\\\n    \\mathbf 6 & 3 & 1 & 0\n  \\end{bmatrix}\n\\]\nthe tournament is $1 \\to 3 \\to 0 \\to 6$.\n\\begin{proof}\n  [Proof of lemma]\n  Let $0 \\le i < j < k < n$ be indices.\n  Let $x = a_{i,n}$, $y = a_{j,n}$, $z = a_{k,n}$,\n  $p = a_{i,j}$, $s = a_{i,k}$, $q = a_{j,k}$. Picture:\n  \\[\n    \\begin{bmatrix}\n      p & \\swarrow \\\\\n      s & q & \\swarrow \\\\\n      x & y & z\n    \\end{bmatrix}\n  \\]\n  If $x \\to y \\to z \\to x$ happens, that means\n  $x = y+p$, $y = q+z$, $x = s+z+1$,\n  which gives $s=p+q-1$, contradiction.\n  Similarly if $x \\leftarrow y \\leftarrow z \\leftarrow x$ then\n  $x = y+p+1$, $y = q+z+1$, $x = s+z$,\n  which gives $s=p+q+2$, also contradiction.\n\\end{proof}\n\nNow this allows us to perform our induction.\nIndeed, to show existence from $N$ to $N+1$\nwe take a source of the tournament above and increase it.\nConversely, to show uniqueness for $N$,\nnote that we can take the (nonzero) sink of the tournament and decrement it,\nwhich gives $N-1$; our uniqueness inductive hypothesis now finishes.\n\n\\begin{remark*}\n  Colin Tang found a nice proof of uniqueness:\n  \\[\n    s_k + \\sum_{i=1}^{k-1} a_{0,i} \\le ka_{0,k}\n    \\le s_k + \\sum_{i=1} \\left( a_{0,i} + 1 \\right)\n  \\]\n  and similarly for other entries.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "TSTST", "year": 2012}
{"id": "tstst-2012-q9", "question": "Given a set $S$ of $n$ variables, a binary operation $\\times$ on $S$ is called\n\\textit{simple} if it satisfies $(x \\times y) \\times z = x \\times (y \\times z)$\nfor all $x,y,z \\in S$ and $x \\times y \\in \\{x,y\\}$ for all $x,y \\in S$.\nGiven a simple operation $\\times$ on $S$, any string of elements in $S$\ncan be reduced to a single element, such as $xyz \\to x \\times (y \\times z)$.\nA string of variables in $S$ is called \\textit{full}\nif it contains each variable in $S$ at least once,\nand two strings are \\textit{equivalent} if they evaluate to the\nsame variable regardless of which simple $\\times$ is chosen.\nFor example $xxx$, $xx$, and $x$ are equivalent, but these are only full if $n=1$.\nSuppose $T$ is a set of full strings such that any full string is\nequivalent to exactly one element of $T$. Determine the number of elements of $T$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2745874}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nGiven a set $S$ of $n$ variables, a binary operation $\\times$ on $S$ is called\n\\textit{simple} if it satisfies $(x \\times y) \\times z = x \\times (y \\times z)$\nfor all $x,y,z \\in S$ and $x \\times y \\in \\{x,y\\}$ for all $x,y \\in S$.\nGiven a simple operation $\\times$ on $S$, any string of elements in $S$\ncan be reduced to a single element, such as $xyz \\to x \\times (y \\times z)$.\nA string of variables in $S$ is called \\textit{full}\nif it contains each variable in $S$ at least once,\nand two strings are \\textit{equivalent} if they evaluate to the\nsame variable regardless of which simple $\\times$ is chosen.\nFor example $xxx$, $xx$, and $x$ are equivalent, but these are only full if $n=1$.\nSuppose $T$ is a set of full strings such that any full string is\nequivalent to exactly one element of $T$. Determine the number of elements of $T$.\n\\end{mdframed}\nThe answer is $(n!)^2$.\nIn fact it is possible to essentially find all $\\times$:\none assigns a real number to each variable in $S$.\nThen $x \\times y$ takes the larger of $\\{x,y\\}$,\nand in the event of a tie picks either ``left'' or ``right'',\nwhere the choice of side is fixed among elements of each size.\n\n\\paragraph{First solution (Steven Hao).}\nThe main trick is the two lemmas, which are not hard to show\n(and are motivated by our conjecture).\n\\begin{align*}\n  xx &= x \\\\\n  xyxzx &= xyzx.\n\\end{align*}\n\nConsequently, define a \\textbf{double rainbow}\nto be the concatenation of two full strings of length $n$,\nof which there are $(n!)^2$.\nWe claim that these form equivalence classes for $T$.\n\nTo see that any string $s$ is equivalent to a double rainbow,\nnote that $s = ss$, and hence using the second identity above\nrepeatedly lets us reduce $ss$ to a double rainbow.\n\nTo see two distinct double rainbows $R_1$ and $R_2$ aren't equivalent,\none can use the construction mentioned in the beginning.\nSpecifically, take two variables $a$ and $b$ which do not\nappear in the same order in $R_1$ and $R_2$.\nThen it's not hard to see that $abab$, $abba$, $baab$, $baba$\nare pairwise non-equivalent by choosing ``left'' or ``right'' appropriately.\nNow construct $\\times$ on the whole set\nby having $a$ and $b$ be the largest variables,\nso the rest of the variables don't matter in the evaluation of the string.\n\n\\paragraph{Second solution outline (Ankan Bhattacharya).}\nWe outline a proof of the characterization claimed earlier,\nwhich will also give the answer $(n!)^2$.\nWe say $a \\sim b$ if $ab \\neq ba$.\nAlso, say $a > b$ if $ab = ba = a$.\nThe following are proved by finite casework,\nusing the fact that $\\{ab, bc, ca\\}$ always has exactly\ntwo distinct elements for any different $a$, $b$, $c$.\n\\begin{itemize}\n  \\ii If $a > b$ and $b > c$ then $a > c$.\n  \\ii If $a \\sim b$ and $b \\sim c$\n  then $ab = a$ if and only if $bc = b$.\n  \\ii If $a \\sim b$ and $b \\sim c$ then $a \\sim c$.\n  \\ii If $a \\sim b$ and $a > c$ then $b > c$.\n  \\ii If $a \\sim b$ and $c > a$ then $c > b$.\n\\end{itemize}\nThis gives us the total ordering on the elements\nand the equivalence classes by $\\sim$.\nIn this we way can check the claimed operations are the only ones.\n\nWe can then (as in the first solution) verify that every full string\nis equivalent to a unique double rainbow --- but this\ntime we prove it by simply considering all possible $\\times$,\nbecause we have classified them all.\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "TSTST", "year": 2012}
{"id": "usamo-2007-q1", "question": "Let $n$ be a positive integer.\nDefine a sequence by setting $a_1 = n$ and, for each $k > 1$,\nletting $a_k$ be the unique integer in the range $0 \\leq a_k \\leq k-1$\nfor which $a_1 + a_2 + \\dots + a_k$ is divisible by $k$.\n(For instance, when $n = 9$\nthe obtained sequence is $9,1,2,0,3,3,3,\\dots$.)\nProve that for any $n$ the sequence $a_1$, $a_2$, \\dots\neventually becomes constant.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p825490}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n$ be a positive integer.\nDefine a sequence by setting $a_1 = n$ and, for each $k > 1$,\nletting $a_k$ be the unique integer in the range $0 \\leq a_k \\leq k-1$\nfor which $a_1 + a_2 + \\dots + a_k$ is divisible by $k$.\n(For instance, when $n = 9$\nthe obtained sequence is $9,1,2,0,3,3,3,\\dots$.)\nProve that for any $n$ the sequence $a_1$, $a_2$, \\dots\neventually becomes constant.\n\\end{mdframed}\nFor each $k$, the number\n\\[ b_k \\coloneq \\frac 1k (a_1 + \\dots + a_k) \\]\nis a nonnegative integer.\n\\begin{claim*}\n  The sequence $(b_k)$ is eventually constant.\n\\end{claim*}\n\\begin{proof}\n  Since\n  \\[ b_{k+1}\n    = \\frac{a_1 + \\dots + a_k + a_{k+1}}{k+1}\n    \\le \\frac{k b_k + k}{k+1} < b_k + 1 \\]\n  and therefore $b_{k+1} \\le b_k$ for all $k$.\n  Hence the sequence $b_k$ must eventually be constant.\n\\end{proof}\n\nThis can only happen once the sequence is constant:\nindeed if $N$ is an index such that $b_N = b_{N+1} = \\dots = b$ then\n\\[ a_k = (k+1) b_{k+1} - k \\cdot b_k\n  = (k+1) \\cdot b - k \\cdot b = b \\]\nfor any $k \\ge N$.\nIn other words, $a_N = a_{N+1} = \\dots = b$ as well.\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 2007}
{"id": "usamo-2007-q2", "question": "Decide whether it possible to cover all lattice points in $\\RR^2$\nby an (infinite) family of disks whose interiors are disjoint\nsuch that the radius of each disk is at least $5$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p825495}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nDecide whether it possible to cover all lattice points in $\\RR^2$\nby an (infinite) family of disks whose interiors are disjoint\nsuch that the radius of each disk is at least $5$.\n\\end{mdframed}\nThe answer is no.\n\nAssume not.\nTake a disk $\\odot O$ not touching any member of the family,\nand then enlarge it until it is maximal.\nThen, it must be tangent to at least three other disks,\nsay $\\odot A$, $\\odot B$, $\\odot C$.\nSuppose WLOG that $\\angle AOB \\le 120\\dg$.\nDenote the radii of $\\odot O$, $\\odot A$, $\\odot B$ by $r$, $a$, $b$.\n\nBut the Law of Cosines gives\n\\[ (a+b)^2 \\le (a+r)^2 + (b+r)^2 + (a+r)(b+r) \\]\nwhich rewrites as\n\\[ 12r^2 \\ge (a-3r)(b-3r) \\ge (5-3r)^2 \\]\nwhich one can check is impossible for $r \\le 1/\\sqrt2$.\nThus $r > 1/\\sqrt2$.\n\nIn particular $(\\odot O)$ must contain a lattice point\nas it contains a unit square.\n\n\\begin{remark*}\n  The order of the argument here matters in subtle ways.\n  A common approach is to try and reduce to the ``optimal'' case\n  where we have three mutually tangent circles,\n  and then apply the Descarte circle theorem.\n  There are ways in which this approach can fail\n  if the execution is not done with care.\n  (In particular, one cannot simply say to reduce\n  to this case, without some justification.)\n\n  For example: it is not true that, given an infinite family of disks,\n  we can enlarge disks until we get three mutually tangent ones.\n  As a counterexample consider the ``square grid''\n  in which a circle is centered at $(10m, 10n)$ for each $m,n \\in \\ZZ$\n  and has radius $5$.\n  Thus it is also not possible to simply pick three nearby circles\n  and construct a circle tangent to all three:\n  that newly constructed circle might intersect a fourth disk\n  not in the picture.\n\n  Thus, when constructing the small disk $\\odot O$\n  in the above solution,\n  it seems easiest to start with a point not covered and grow $\\odot O$\n  until it is tangent to \\emph{some} three circles,\n  and then argue by cosine law.\n  Otherwise it not easy to determine which three\n  circles to start with.\n\n  In all solutions it seems easier to prove that a disjoint circle\n  of radius $1/\\sqrt2$ exists,\n  and then \\emph{finally} deduce it has a lattice point,\n  rather than trying to work the lattice point into the existence proof.\n\\end{remark*}\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2007}
{"id": "usamo-2007-q3", "question": "Let $S$ be a set containing $n^2+n-1$ elements.\nSuppose that the $n$-element subsets of $S$ are partitioned into two classes.\nProve that there are at least $n$ pairwise disjoint sets in the same class.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p825499}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $S$ be a set containing $n^2+n-1$ elements.\nSuppose that the $n$-element subsets of $S$ are partitioned into two classes.\nProve that there are at least $n$ pairwise disjoint sets in the same class.\n\\end{mdframed}\nWe present two solutions which are really equivalent, but phrased differently.\nWe refer to the two classes as ``red'' and ``blue'', respectively.\n\n\\paragraph{First solution (Grant Yu).}\nWe define a set of $n+1$ elements to be \\emph{useful}\nif it has $n$-element subsets in each class.\n\nConsider a \\textbf{maximal collection of disjoint useful sets}\nand assume there are $p$ such sets.\nThen, let $T$ be the set of elements remaining (i.e.\\ not in one of chosen useful sets).\n\\begin{claim*}\n  All subsets of $T$ of size $n$ are the same color.\n\\end{claim*}\n\\begin{proof}\n  Assume there was a red set $R$ in $T$.\n  Replace the elements of $R$ one by one\n  until we get to any other subset $R'$ of $T$.\n  At each step, because no sets of $T$ form a useful set,\n  the set remains red --- so $R'$ is red too.\n  Since $R'$ is arbitrary, this proves the claim.\n\\end{proof}\nWe have $|T| = n^2+n-1 - p(n+1)$, and in particular $p < n$.\nWLOG all sets in $T$ are red.\nWe can extract another red set from each of our chosen useful sets.\nSo we can get at least\n\\[ p + \\left\\lfloor \\frac{|T|}{n} \\right\\rfloor\n  = p + \\left\\lfloor n+1-p - \\frac{1+p}{n} \\right\\rfloor\n  \\ge p + (n-p) = n.  \\]\n\n\n\\paragraph{Second solution (by induction).}\nWe prove more strongly that:\n\\begin{claim*}\n  Let $S$ be a set containing $k \\cdot (n+1)-1$ elements.\n  Then we can find $k$ pairwise disjoint sets of the same color.\n\\end{claim*}\nThe proof is by induction on $k \\ge 1$.\nThe base case $k=1$ this is immediate; $\\binom{S}{n}$ is a single set.\n\nFor the inductive step, assume for contradiction the problem fails.\nLet $T$ be any subset of $S$ of size $(k-1)(n+1)-1$.\nBy the induction hypothesis, among the subsets of $T$ alone,\nwe can already find $k-1$ pairwise disjoint sets of the same color.\nNow $S \\setminus T$ has size $n+1$, and so we would have to have\nthat all $\\binom{n+1}{n}$ subsets of $S \\setminus T$ are the same color.\n\nBy varying $T$, the set $S \\setminus T$ ranges over all of $\\binom{S}{k+1}$.\nThis causes all sets to be the same color, contradiction.\n\n\\begin{remark*}\n  Victor Wang writes the following:\n  \\begin{quote}\n  I don't really like this problem,\n  but I think the main motivation for generalizing the problem\n  is that the original problem doesn't allow you to look at small cases.\n  (Also, it's not initially clear where the $n^2+n-1$ comes from.)\n  And pretty much the simplest way to get lots of similarly-flavored\n  small cases is to start with $k=2,3$ in\n  ``find the smallest $N(n,k)$ such that when we partition the $n$-subsets\n  of a $\\ge N(n,k)$-set into $2$ classes,\n  we can find some $k$ pairwise disjoint sets in the same class''.\n  \\end{quote}\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Combinatorics", "source": "USAMO", "year": 2007}
{"id": "usamo-2007-q4", "question": "An \\emph{animal} with $n$ \\emph{cells}\nis a connected figure consisting of $n$ equal-sized square cells\n(equivalently, a polyomino with $n$ cells).\nA \\emph{dinosaur} is an animal with at least $2007$ cells.\nIt is said to be \\emph{primitive}\nit its cells cannot be partitioned into two or more dinosaurs.\nFind with proof the maximum number of cells in a primitive dinosaur.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p825505}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nAn \\emph{animal} with $n$ \\emph{cells}\nis a connected figure consisting of $n$ equal-sized square cells\n(equivalently, a polyomino with $n$ cells).\nA \\emph{dinosaur} is an animal with at least $2007$ cells.\nIt is said to be \\emph{primitive}\nit its cells cannot be partitioned into two or more dinosaurs.\nFind with proof the maximum number of cells in a primitive dinosaur.\n\\end{mdframed}\nIn fact it's true for any tree with maximum degree $\\le 4$.\nHere is the solution of Andrew Geng.\n\nLet $T$ be such a tree (a spanning tree of the dinosaur graph)\nwhich corresponds to a primitive dinosaur.\n\n\\begin{claim*}\n  There exists a vertex $v$ such that when $v$ is deleted, no dinosaurs result.\n\\end{claim*}\n\\begin{proof}\n  Assume for contradiction that all vertices are bad\n  (leave a dinosaur when deleted).\n  Consider two adjacent vertices $v$, $w$ in $T$.\n  By checking possibilities, one sees that, say,\n  the dinosaur in $T-v$ contains $w$ and the dinosaur of $T-w$.\n  We can repeat in this way; since $T$ is acyclic,\n  this eventually becomes a contradiction.\n\\end{proof}\n\nWhen this vertex is deleted,\nwe get at most $4$ components, each with $\\le 2006$ vertices,\ngiving the answer of $4 \\cdot 2006 + 1 = 8025$.\nThe construction is easy (take a ``cross'', for example).\n\\pagebreak", "category": "Combinatorics", "source": "USAMO", "year": 2007}
{"id": "usamo-2007-q5", "question": "Prove that for every nonnegative integer $n$,\nthe number $7^{7^n}+1$ is the product\nof at least $2n+3$ (not necessarily distinct) primes.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p825508}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nProve that for every nonnegative integer $n$,\nthe number $7^{7^n}+1$ is the product\nof at least $2n+3$ (not necessarily distinct) primes.\n\\end{mdframed}\nWe prove this by induction on $n$ by showing that\n\\[ \\frac{X^7+1}{X+1} = X^6 - X^5 + \\dots + 1 \\]\nis never prime for $X = 7^{7^n}$,\nhence we gain at least two additional prime factors\nwhenever we increase $n$ by one.\n\nIndeed, the quotient may be written as\n\\[ \\left( X+1 \\right)^6 - 7X \\cdot (X^2+X+1)^2 \\]\nwhich becomes a difference of squares, hence composite.\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 2007}
{"id": "usamo-2007-q6", "question": "Let $ABC$ be an acute triangle\nwith $\\omega$, $S$, and $R$ being its incircle,\ncircumcircle, and circumradius, respectively.\nCircle $\\omega_{A}$ is tangent internally to $S$\nat $A$ and tangent externally to $\\omega$.\nCircle $S_{A}$ is tangent internally to $S$\nat $A$ and tangent internally to $\\omega$.\n\nLet $P_A$ and $Q_A$ denote\nthe centers of $\\omega_A$ and $S_A$, respectively.\nDefine points $P_B$, $Q_B$, $P_C$, $Q_C$ analogously.\nProve that\n\\[ 8 P_A Q_A \\cdot P_B Q_B \\cdot P_C Q_C \\le R^3 \\]\nwith equality if and only if triangle $ABC$ is equilateral.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p825515}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be an acute triangle\nwith $\\omega$, $S$, and $R$ being its incircle,\ncircumcircle, and circumradius, respectively.\nCircle $\\omega_{A}$ is tangent internally to $S$\nat $A$ and tangent externally to $\\omega$.\nCircle $S_{A}$ is tangent internally to $S$\nat $A$ and tangent internally to $\\omega$.\n\nLet $P_A$ and $Q_A$ denote\nthe centers of $\\omega_A$ and $S_A$, respectively.\nDefine points $P_B$, $Q_B$, $P_C$, $Q_C$ analogously.\nProve that\n\\[ 8 P_A Q_A \\cdot P_B Q_B \\cdot P_C Q_C \\le R^3 \\]\nwith equality if and only if triangle $ABC$ is equilateral.\n\\end{mdframed}\nIt turns out we can compute $P_AQ_A$ explicitly.\nLet us invert around $A$ with radius $s-a$\n(hence fixing the incircle) and then compose this\nwith a reflection around the angle bisector of $\\angle BAC$.\nWe denote the image of the composed map via\n\\[ \\bullet \\mapsto \\bullet^\\ast \\mapsto \\bullet^+. \\]\nWe overlay this inversion with the original diagram.\n\nLet $P_AQ_A$ meet $\\omega_A$ again at $P$ and $S_A$ again at $Q$.\nNow observe that $\\omega_A^\\ast$ is a line parallel to $S^\\ast$;\nthat is, it is perpendicular to $\\ol{PQ}$.\nMoreover, it is tangent to $\\omega^\\ast = \\omega$.\n\nNow upon the reflection,\nwe find that $\\omega^+ = \\omega^\\ast = \\omega$,\nbut line $\\ol{PQ}$ gets mapped to the altitude from $A$ to $\\ol{BC}$,\nsince $\\ol{PQ}$ originally contained the circumcenter $O$\n(isogonal to the orthocenter).\nBut this means that $\\omega_A^\\ast$ is none other than the $\\ol{BC}$!\nHence $P^+$ is actually the foot of the altitude from $A$\nonto $\\ol{BC}$.\n\nBy similar work, we find that $Q^+$\nis the point on $\\ol{AP^+}$ such that $P^+Q^+ = 2r$.\n\\begin{center}\n\\begin{asy}\n  size(8.5cm);\n  pair A = dir(140);\n  pair B = dir(210);\n  pair C = dir (330);\n  filldraw(A--B--C--cycle, opacity(0.1)+yellow, gray);\n  dot(\"$A$\", A, A);\n  dot(\"$B$\", B, B);\n  dot(\"$C$\", C, C);\n  draw(incircle(A,B,C), black+1);\n  pair D = foot(A,B,C);\n  dot(\"$P^+$\", D, dir(-45), brown);\n  draw(A--D, brown);\n  pair I = incenter(A,B,C);\n  pair O = circumcenter(A,B,C);\n\n  real a = abs(B-C);\n  real b = abs(C-A);\n  real c = abs(A-B);\n  real s = 0.5*(a+b+c);\n  real ha = abs(A-D);\n  real k = ((s-a)**3) / (s*ha*abs(A-I)**2);\n\n  pair PA = k*b*c/2*dir(O-A)+A;\n  dot(\"$P_A$\", PA, dir(255), blue);\n  draw(CP(PA,A), lightblue);\n  pair P = Drawing(\"P\", 2*PA-A, dir(180));\n\n  pair QA = PA + dir(PA-A)*( (s-a)*a**2 / (a*b*c) );\n  dot(\"$Q_A$\", QA, dir(-80)*1.4, blue);\n  draw(CP(QA,A), lightblue);\n  pair Q = Drawing(\"Q\", 2*QA-A, dir(-70));\n\n  draw(unitcircle, gray);\n  draw(A--Q);\n  real r = abs(I-foot(I,B,C));\n  Drawing(\"I\", I, dir(90));\n  pair X = I + dir(O-A)*r;\n  pair P1 = foot(X,P,Q);\n  draw(Line(X,P1,2.5), red, Arrows(TeXHead));\n  dot(\"$P^\\ast$\", P1, dir(5), red);\n  draw(CP(A, foot(I,A,B)), dashed+deepgreen);\n\n  pair Q2 = D+dir(A-D)*2*r;\n  dot(\"$Q^+$\", Q2, dir(145), brown);\n  draw(Q2--(I+r*dir(90)), brown);\n\\end{asy}\n\\end{center}\n\nNow we can compute all the lengths directly.  We have that\n\\[ AP_A = \\half AP = \\frac{(s-a)^2}{2AP^+}\n= \\half (s-a)^2 \\cdot \\frac{1}{h_a} \\]\nand\n\\[ AQ_A = \\half AQ = \\frac{(s-a)^2}{2AQ^+}\n= \\half (s-a)^2 \\cdot \\frac{1}{h_a-2r} \\]\nwhere $h_a = \\frac{2K}{a}$ is the length of the $A$-altitude, with $K$ the area of $ABC$ as usual. Now it follows that\n\\[ P_AQ_A = \\half (s-a)^2 \\left( \\frac{2r}{h_a(h_a-2r)} \\right). \\]\nThis can be simplified, as\n\\[ h_a - 2r = \\frac{2K}{a} - \\frac{2K}{s} = 2K \\cdot \\frac{s-a}{as}. \\]\nHence\n\\[ P_AQ_A = \\frac{a^2rs(s-a)}{4K^2} = \\frac{a^2(s-a)}{4K}. \\]\nHence, the problem is just asking us to show that\n\\[ a^2b^2c^2(s-a)(s-b)(s-c) \\le 8 (RK)^3. \\]\nUsing $abc=4RK$ and $(s-a)(s-b)(s-c) = \\frac 1s K^2 = rK$, we find that this becomes\n\\[ 2(s-a)(s-b)(s-c) \\le RK \\iff 2r \\le R \\]\nwhich follows immediately from $IO^2=R(R-2r)$.\nAlternatively, one may rewrite this as Schur's Inequality in the form\n\\[ abc \\ge (-a+b+c)(a-b+c)(a+b-c). \\]\n\\pagebreak\n\n\n\\end{document}", "category": "Geometry", "source": "USAMO", "year": 2007}
{"id": "egmo-2016-q1", "question": "Let $n$ be an odd positive integer,\nand let $x_1$, $x_2$, \\dots, $x_n$ be nonnegative real numbers.\nShow that\n\\[ \\min(x_i^2+x_{i+1}^2) \\le \\max(2x_jx_{j+1}) \\]\nwhere $1\\le i,j\\le n$ and $x_{n+1}=x_1$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6171538}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n$ be an odd positive integer,\nand let $x_1$, $x_2$, \\dots, $x_n$ be nonnegative real numbers.\nShow that\n\\[ \\min(x_i^2+x_{i+1}^2) \\le \\max(2x_jx_{j+1}) \\]\nwhere $1\\le i,j\\le n$ and $x_{n+1}=x_1$.\n\\end{mdframed}\nIt suffices to exhibit a single pair $(i,j)$ where\n\\[ x_i^2 + x_{i+1}^2 \\le 2 x_j x_{j+1}. \\]\n\nSince $n$ is odd we can find three adjacent $x_k$'s,\ncall them $a$, $b$, and $c$ (with $b$ in middle) such that $a \\ge b \\ge c$.\nThen indeed\n\\[ 2ab \\ge b^2+c^2 \\]\nso we're done.\n\n\\begin{remark*}\n  When $n$ is even, counterexamples to the problem statement alternate up and down,\n  such as $(1,100,1,100,1,100,\\dots)$.\n  This provides a reason why one should consider $a \\ge b \\ge c$ to exploit\n  the parity of $n$.\n\\end{remark*}\n\\pagebreak", "category": "Geometry", "source": "EGMO", "year": 2016}
{"id": "egmo-2016-q2", "question": "Let $ABCD$ be a cyclic quadrilateral,\nand let diagonals $AC$ and $BD$ intersect at $X$.\nLet $C_1,D_1$ and $M$ be the midpoints of segments $CX$, $DX$ and $CD$, respectively.\nLines $AD_1$ and $BC_1$ intersect at $Y$, and line $MY$ intersects diagonals $AC$ and $BD$\nat different points $E$ and $F$, respectively.\nProve that line $XY$ is tangent to the circle through $E$, $F$ and $X$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6171514}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABCD$ be a cyclic quadrilateral,\nand let diagonals $AC$ and $BD$ intersect at $X$.\nLet $C_1,D_1$ and $M$ be the midpoints of segments $CX$, $DX$ and $CD$, respectively.\nLines $AD_1$ and $BC_1$ intersect at $Y$, and line $MY$ intersects diagonals $AC$ and $BD$\nat different points $E$ and $F$, respectively.\nProve that line $XY$ is tangent to the circle through $E$, $F$ and $X$.\n\\end{mdframed}\nWe present two approaches.\n\n\\paragraph{First approach through isogonality lemma.}\nNote $ABC_1D_1$ is cyclic.\nBy the ``isogonality lemma'' applied to $\\triangle YC_1D_1$,\nit follows that $YX$ and $YM$ are isogonal\nwith respect to $\\triangle YC_1D_1$.\nThen\n\\[ \\angle EXY = \\angle XC_1Y + \\angle C_1YX\n= \\angle AD_1X + \\angle MYA = \\angle YFX \\]\nand we're done (angles are directed).\n\\begin{remark*}\nNote that the points $C$ and $D$ can be more or less deleted immediately.\nThe ``isogonality lemma'' people has mentioned has appeared in other places too.\nIn addition to the Taiwan TST 2014 round 2 problem 6, it also shows itself in\nELMO 2012/5, % http://aops.com/community/c6h486936p2728469\nBrMO2 2013/2, % http://www.aops.com/community/c6h518987\nSL 2009 G4, SL 2012 G2.\n\\end{remark*}\n\n\\paragraph{Solution with complex numbers, by Sanjana Das.}\nQuadrilateral $ABC_1D_1$ is also cyclic ($\\dang AC_1D_1 = \\dang ACD = \\dang ABD_1$).\nWe want $\\dang YXE = \\dang XFE$,\nor \\[\\dang(XY, AC) = \\dang(BD, MY).\\]\n\nNow use complex numbers with unit circle $(ABC_1D_1)$\n(using $c$ and $d$ to refer to $C_1$ and $D_1$ for berevity).\n\nWe want to check that $\\frac{(x - y)(m - y)}{(a - c)(b - d)}$ is real.\nFirst, if $Z = AB \\cap C_1D_1$, then $XY \\perp OZ$ where $O$ is the\ncircumcenter of $(ABC_1D_1)$ by Brocard's Theorem, so we want to show\n\\[ \\frac{(ab(c + d) - cd(a + b))\\cdot (y - m)}\n  {(a - c)(b - d)(ab - cd)} \\in i\\RR.\\]\nNow we have $m = c + d - x$, which means\n\\begin{align*}\n    y - m &= x + y - c - d \\\\\n    &= \\frac{ac(b +d) - bd(a +c)}{ac - bd} + \\frac{ad(b + c) - bc(a+ d)}{ad - bc} - c - d \\\\\n    &= \\frac{ab(2acd + 2bcd + c^3 + d^3 - ac^2 - ad^2 - bc^2 - bd^2 - c^2d - cd^2)}{(ac - bd)(ad - bc)} \\\\\n    &= -\\frac{ab(a + b - c - d)(c - d)^2}{(ac - bd)(ad - bc)}.\n\\end{align*}\nThis means our final expression is\n\\[-\\frac{ab(ab(c + d) - cd(a + b))(a + b - c - d)(c - d)^2}{(ac - bd)(ad - bc)(a - c)(b - d)(ab - cd)},\\]\nwhich is visibly the negative of its conjugate and is therefore imaginary.\n\\pagebreak", "category": "Geometry", "source": "EGMO", "year": 2016}
{"id": "egmo-2016-q3", "question": "Let $m$ be a positive integer. Consider a $4m \\times 4m$ array of square unit cells.\nTwo different cells are \\emph{related} to each other\nif they are in either the same row or in the same column.\nNo cell is related to itself.\nSome cells are colored blue, such that every cell is\nrelated to at least two blue cells.\nDetermine the minimum number of blue cells.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6171553}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $m$ be a positive integer. Consider a $4m \\times 4m$ array of square unit cells.\nTwo different cells are \\emph{related} to each other\nif they are in either the same row or in the same column.\nNo cell is related to itself.\nSome cells are colored blue, such that every cell is\nrelated to at least two blue cells.\nDetermine the minimum number of blue cells.\n\\end{mdframed}\nWe'll prove that the answer is at least $6m$.\nThe construction is to take\ndiagonal copies of the matrix\n\\[ \\begin{bmatrix}\n  & 1 & 1 & 1 \\\\\n  1 &&& \\\\\n  1 &&& \\\\\n  1 &&&\n \\end{bmatrix}. \\]\n\nWe present two proofs this is optimal.\n\n\\paragraph{Bipartite graph (Kevin Sun).}\nConsider the bipartite subgraph\n\\[ H \\subseteq K_{4m,4m} \\]\nwith vertices being rows/columns,\nand edges corresponding blue squares.\n\nAssume for contradiction the are fewer than $6m$ edges.\nThen there are at least $|V(H)|-|E(H)|=8m-6m=2m$\nconnected components in $H$,\nso some connected component has at most three vertices.\n\nWe consider two cases:\n\\begin{itemize}\n\\ii Note that if there are any isolated vertices $v$\n(connected components with no edges),\nthen it follows $H$ needs at least $8m$ edges,\nbecause every vertex on the opposite shore from $v$ has\nblue-degree at least $2$.\n\n\\ii Thus assume no isolated vertices exist.\nOn the other hand, every blue edge\nis incident to at least two more blue edges,\nso no connected component can have fewer than three edges.\nAs the connected components are bipartite,\nit follows each connected component has at least four vertices,\nwhich is impossible.\n\\end{itemize}\n\n\\paragraph{Brute force (mine).}\n%I'll admit that unlike P1 and P2 (which I solved in about five minutes each),\n%there is \\emph{no way} I would have gotten this problem under time pressure:\n%I had to stay up all night (despite a sore throat) to solve it.\n%Also, this solution (linear programming after optimization)\n%seems too silly to be true.\nWe prove that for a general $n \\times n$ board,\na good configuration has at least $\\frac32n$ blue squares.\nConsider any minimal good configuration\nwith $k$ squares, and assume $k \\le \\frac 32 n$\n(and we will prove $k \\ge \\frac32n$).\nWe observe that no column and row can be empty in a good\nconfiguration with $k \\le 2n$ squares.\n\nNow, assume there are $x_i$ columns with exactly $i$ blue squares,\nand $a_i$ rows with exactly $i$ blue squares (for $i = 1,\\dots,n$.)\nPermute the board to arrive at the following:\n\\[\n \\begin{array}{r|c|c|c|}\n  \\multicolumn{1}{c}{\\ }\n   & \\multicolumn{1}{c}{x_1\\text{ cols}}\n   & \\multicolumn{1}{c}{x_2\\text{ cols}}\n   & \\multicolumn{1}{c}{x_3+x_4+\\dots+x_n\\text{ cols}} \\\\\\cline{2-4}\n  a_1 \\text{ rows} & 0 & 0 & a_1 \\\\ \\cline{2-4}\n  a_2 \\text{ rows} & 0 & P & Q \\\\ \\cline{2-4}\n  &&& \\\\[1em]\n  a_3+\\dots+a_n & x_1 & R & S \\\\\n  \\text{rows} &&& \\\\[1em]\\cline{2-4}\n \\end{array}\n\\]\nIn each subgrid, the letter denotes the number of blue squares in that region.\nConsequently, we have $P+Q=2a_2$, $P+R=2x_2$,\nand $a_1+Q+S = 3x_3+4x_4+\\dots+nx_n$.\nWe also know that $n = \\sum a_i = \\sum x_i$ and $k = \\sum ia_i = \\sum ix_i$.\n\nWithout loss of generality we assume that $a_1 \\le x_1$.\nThen, it would suffice to prove that\n\\[ \\sum ia_i \\ge \\frac32 \\sum a_i \\iff a_1 \\le a_2 + 3a_3 + 5a_4 + \\dots. \\]\nWe observe that\n\\begin{align*}\n 0 &\\le S = 3x_3 + \\dots + nx_n - a_1 - Q \\\\\n &= \\left( a_1+2a_2+\\dots+na_n \\right) - (x_1+2x_2) - (a_1-Q) \\\\\n \\implies x_1 &\\le (3a_3+4a_4+\\dots+na_n) - (Q - 2a_2 + 2x_2) \\\\\n &= (3a_3+4a_4+\\dots+na_n) - R \\\\\n &\\le 3a_3 + 4a_4 + \\dots + na_n \\\\\n &\\le a_2 + 3a_3 + 5a_4 + \\dots + (2n-3)a_n.\n\\end{align*}\nSince we assumed $a_1 \\le x_1$, we are done.\n% http://aops.com/community/c6t30365f6h1226675_related_blue_squares_in_4m_by_4m_board\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Combinatorics", "source": "EGMO", "year": 2016}
{"id": "egmo-2016-q4", "question": "Two circles $\\omega_1$ and $\\omega_2$, of equal radius\nintersect at different points $X_1$ and $X_2$.\nConsider a circle $\\omega$ externally tangent to $\\omega_1$ at $T_1$\nand internally tangent to $\\omega_2$ at point $T_2$.\nProve that lines $X_1T_1$ and $X_2T_2$ intersect at a point lying on $\\omega$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6177803}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nTwo circles $\\omega_1$ and $\\omega_2$, of equal radius\nintersect at different points $X_1$ and $X_2$.\nConsider a circle $\\omega$ externally tangent to $\\omega_1$ at $T_1$\nand internally tangent to $\\omega_2$ at point $T_2$.\nProve that lines $X_1T_1$ and $X_2T_2$ intersect at a point lying on $\\omega$.\n\\end{mdframed}\nWe present two solutions,\none by homothety and another by inversion.\n\\paragraph{First solution (homothety).}\nConsider the composition of homotheties\n\\[ \\omega_1 \\xrightarrow{T_1} \\omega \\xrightarrow{T_2} \\omega_2. \\]\nThis is a negative homothety,\nand since $\\omega_1$ and $\\omega_2$ have equal radius,\nit follows that the composition is just reflection\nabout the midpoint of $\\ol{X_1X_2}$.\nIn particular, it sends $X_1$ to $X_2$,\nand thus $\\ol{X_1T_1} \\cap \\ol{X_2T_2}$\nis just the image of $X_1$ under the first homothety.\n\n\\paragraph{Second solution (inversion).}\nInvert around $X_1$.\nThen we have the following:\n\\begin{itemize}\n  \\ii $\\omega_1^\\ast$ and $\\omega_2^\\ast$ are lines intersecting at $X_2^\\ast$,\n  and $X_1$ is a point on the external angle bisector of the two lines.\n  \\ii The circle $\\omega^\\ast$ becomes tangent to the two lines\n  (in a region adjacent to $X_1$).\n  \\ii Let $P = \\ol{T_1^\\ast X_1} \\cap \\omega^\\ast$.\n  Then one wishes to show $X_1 X_2^\\ast P T_2^\\ast$ are concyclic.\n\\end{itemize}\nTo show this, notice that\n\\[ \\dang T_2^\\ast X_2^\\ast X_1 = \\dang T_1^\\ast T_2^\\ast X_2^\\ast\n  = \\dang T_2^\\ast P T_1^\\ast = \\dang T_2^\\ast P X_1. \\]\n% http://aops.com/community/c6t30365f6h1227238_geometry_tangent_circles\n\\pagebreak", "category": "Geometry", "source": "EGMO", "year": 2016}
{"id": "egmo-2016-q5", "question": "Let $k$ and $n$ be integers such that $k\\ge 2$ and $k \\le n \\le 2k-1$.\nPlace rectangular tiles, each of size $1 \\times k$ or $k \\times 1$\non a $n \\times n$ chessboard so that each tile covers\nexactly $k$ cells and no two tiles overlap.\nDo this until no further tile can be placed in this way.\nFor each such $k$ and $n$, determine the minimum number of tiles\nthat such an arrangement may contain.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6177809}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $k$ and $n$ be integers such that $k\\ge 2$ and $k \\le n \\le 2k-1$.\nPlace rectangular tiles, each of size $1 \\times k$ or $k \\times 1$\non a $n \\times n$ chessboard so that each tile covers\nexactly $k$ cells and no two tiles overlap.\nDo this until no further tile can be placed in this way.\nFor each such $k$ and $n$, determine the minimum number of tiles\nthat such an arrangement may contain.\n\\end{mdframed}\nThe answer is\n\\[\n \\begin{cases}\n  n & n=k \\text{ or } n = 2k-1 \\\\\n  2(n-k+1) & k < n < 2k-1.\n \\end{cases}\n\\]\nHere are constructions.\n\\begin{itemize}\n  \\ii For $n = k$ it's trivial.\n\n  \\ii For $k < n < 2k-1$, observe that one can construct\n  it when $n = k+1$ by simply filling in the perimeter\n  of the $(k+1) \\times (k+1)$ square with four dominoes,\n  then one can inductively obtain the next values\n  $n = k+2, k+3, \\dots$ by adding a new domino to each row and column,\n  hence increasing the count by $2$.\n  An example with $(k,n) = (5,8)$ is shown below.\n  \\[\n    \\begin{bmatrix}\n      w & w & w & w & w & x & a & b \\\\\n      y &   &   &   &   & x & a & b \\\\\n      y &   &   &   &   & x & a & b \\\\\n      y &   &   &   &   & x & a & b \\\\\n      y &   &   &   &   & x & a & b \\\\\n      y & z & z & z & z & z &   &   \\\\\n      c & c & c & c & c &   &   &   \\\\\n      d & d & d & d & d &   &   &   \\\\\n    \\end{bmatrix}\n  \\]\n\n  \\ii For $n = 2k-1$ one places a domino in each column,\n  alternating between upper-most possible and lower-most possible.\n  An example with $(k,n) = (3,5)$ is shown below.\n  \\[\n    \\begin{bmatrix}\n      a &   & c &   & e \\\\\n      a &   & c &   & e \\\\\n      a & b & c & d & e \\\\\n        & b &   & d &   \\\\\n        & b &   & d &   \\\\\n    \\end{bmatrix}\n  \\]\n\\end{itemize}\n\nNow we now prove this is optimal.\n\nCall a row (resp column) \\emph{bare}\nif it contains no horizontal (resp vertical) domino\ncontained completely inside it.\nThe main observation is that:\n\\begin{claim*}\n  The bare columns are consecutive, as are the bare rows.\n\\end{claim*}\n\\begin{proof}\n  Consider a vertical domino $D$ (say) in some column $C$,\n  and assume it is in the left half of the board.\n  Then the column to the left of $C$ must also contain a domino,\n  otherwise we could add the domino exactly to the left of $D$\n  since there is not enough space to fit a horizontal domino\n  to $D$'s left.\n\n  Inductively, then, every column left of $C$ is not bare.\n  Similarly, if $C$ had been on the right half of the board,\n  then all columns to the right of $C$ are not bare.\n\\end{proof}\n\nTo finish, we consider two cases.\n\\begin{itemize}\n  \\ii If there are no bare columns,\n  then we need at least $n$ dominoes,\n  since each column contains a domino.\n\n  Similarly, if there are no bare rows, we also need at least $n$ dominoes.\n\n  \\ii In the case there exist at least one bare row or bare column,\n  note that given $k$ (consecutive) bare columns,\n  then intersecting them with a bare row\n  gives a place where we can add an additional domino, contradiction.\n  So there are at most $k$ bare columns,\n  and hence at least $n-(k-1) = n-k+1$ vertical dominoes\n  (one per non-bare column).\n\n  Similarly, there are at least $n-k+1$ horizontal dominoes.\n  So there are at least $2(n-k+1)$ dominoes total.\n\\end{itemize}\nThis shows one always needs at least\n$\\min(n, 2(n-k+1))$ dominoes.\nThis resolves every case except $k = n$,\n(in which case the bound is true but not achievable).\nHowever, the case $k = n$ is trivial --- just note that\nall the dominoes must have the same orientation when $k = n$,\nso we are necessarily in the first case.\n\\pagebreak", "category": "Combinatorics", "source": "EGMO", "year": 2016}
{"id": "egmo-2016-q6", "question": "Let $S$ be the set of all positive integers $n$ such that $n^4$ has a divisor\nin the range $n^2 + 1$, $n^2+2$, \\dots, $n^2 + 2n$.\nProve that there are infinitely many elements of $S$ of\neach of the forms $7m$, $7m+1$, $7m+2$, $7m+5$, $7m+6$\nand no elements of $S$ of the form $7m+3$ and $7m+4$,\nwhere $m$ is an integer.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p6177824}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $S$ be the set of all positive integers $n$ such that $n^4$ has a divisor\nin the range $n^2 + 1$, $n^2+2$, \\dots, $n^2 + 2n$.\nProve that there are infinitely many elements of $S$ of\neach of the forms $7m$, $7m+1$, $7m+2$, $7m+5$, $7m+6$\nand no elements of $S$ of the form $7m+3$ and $7m+4$,\nwhere $m$ is an integer.\n\\end{mdframed}\nStart from the implication\n\\[ n^2 + k \\mid n^4 \\iff n^2 + k \\mid k^2. \\]\nSince $1 \\le k \\le 2n$, in fact the quotient $\\frac{k^2}{n^2+k}$\ncan only take values from $1$ to $3$.\nIn other words, $S$ is the set of integers $n$ for which at least one equation\n\\begin{align*}\n  n^2 + k &= k^2 \\\\\n  2(n^2 + k) &= k^2 \\\\\n  3(n^2 + k) &= k^2\n\\end{align*}\nhas at least one solution $1 \\le k \\le 2n$.\n\nThe first equation has no solutions with $k \\ge 1$\nsince we can put $(k-1)^2 < n^2 < k^2$.\nThe other two are Pell equations,\nand one can check that $n^2 \\equiv 2 \\pmod 7$ has no solutions at all\nfor $k \\pmod 7$ in either case.\nThe assertion about infinitely many solutions then follows by\nusing the Pell recursion, and taking modulo $7$.\n\\pagebreak\n\n\n\\end{document}", "category": "Number Theory", "source": "EGMO", "year": 2016}
{"id": "usamo-2014-q1", "question": "Let $a$, $b$, $c$, $d$ be real numbers such that $b-d \\ge 5$ and all zeros\n$x_1$, $x_2$, $x_3$, and $x_4$ of the polynomial $P(x)=x^4+ax^3+bx^2+cx+d$ are real.\nFind the smallest value the product $(x_1^2+1)(x_2^2+1)(x_3^2+1)(x_4^2+1)$ can take.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3477753}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a$, $b$, $c$, $d$ be real numbers such that $b-d \\ge 5$ and all zeros\n$x_1$, $x_2$, $x_3$, and $x_4$ of the polynomial $P(x)=x^4+ax^3+bx^2+cx+d$ are real.\nFind the smallest value the product $(x_1^2+1)(x_2^2+1)(x_3^2+1)(x_4^2+1)$ can take.\n\\end{mdframed}\nThe answer is $\\boxed{16}$.\nThis can be achieved by taking $x_1 = x_2 = x_3 = x_4 = 1$,\nwhence the product is $2^4 = 16$, and $b-d = 5$.\n\nWe now show the quantity is always at least $16$.\nWe prove:\n\\begin{claim*}\n  We always have $(x_1^2+1)(x_2^2+1)(x_3^2+1)(x_4^2+1) = (b-d-1)^2 + (a-c)^2$.\n\\end{claim*}\n\\begin{proof}\n  Let $i = \\sqrt{-1}$.\n  The key observation is that\n  \\[ \\prod_{j=1}^4 \\left( x_j^2 + 1 \\right)\n    = \\prod_{j=1}^4 (x_j - i)(x_j + i)\n    = P(i)P(-i) = |P(i)|^2. \\]\n  Since $P(i) = (-1+b-d) + (c-a)i$, the claim follows.\n\\end{proof}\nSince $b-d-1 \\ge 4$, we get the desired lower bound of $4^2+0^2=16$.\n\\pagebreak", "category": "Algebra", "source": "USAMO", "year": 2014}
{"id": "usamo-2014-q2", "question": "Find all $f \\colon \\ZZ \\to \\ZZ$ such that\n\\[ xf\\left( 2f(y)-x \\right) + y^2f\\left( 2x-f(y) \\right)\n  = \\frac{f(x)^2}{x} + f\\left( yf(y) \\right) \\]\nfor all $x,y \\in \\ZZ$ such that $x \\neq 0$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3477690}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all $f \\colon \\ZZ \\to \\ZZ$ such that\n\\[ xf\\left( 2f(y)-x \\right) + y^2f\\left( 2x-f(y) \\right)\n  = \\frac{f(x)^2}{x} + f\\left( yf(y) \\right) \\]\nfor all $x,y \\in \\ZZ$ such that $x \\neq 0$.\n\\end{mdframed}\nThe answer is $f(x) \\equiv 0$ and $f(x) \\equiv x^2$. Check that these work.\n\nNow let's prove these are the only solutions.\nPut $y=0$ to obtain\n\\[ x f\\left( 2f(0)-x \\right) = \\frac{f(x)^2}{x} + f(0).  \\]\n\nThe nicest part of the problem is the following step:\n\\begin{claim*}\n  We have $f(0)=0$.\n\\end{claim*}\n\\begin{proof}\n  If not, select a prime $p \\nmid f(0)$ and put $x=p \\neq 0$.\n  In the above, we find that $p \\mid f(p)^2$,\n  so $p \\mid f(p)$ and hence $p \\mid \\tfrac{f(p)^2}{p}$.\n  From here we derive $p \\mid f(0)$, contradiction.\n  Hence \\[ f(0) = 0. \\]\n\\end{proof}\n\n\\begin{claim*}\n  We have $f(x) \\in \\{0,x^2\\}$ for each individual $x$.\n\\end{claim*}\n\\begin{proof}\n  The above then implies that\n  \\[ x^2f(-x) = f(x)^2 \\]\n  holds for all nonzero $x$, but also for $x=0$.\n  Let us now check that $f$ is an even function.\n  In the above, we may also derive $f(-x)^2 = x^2f(x)$.\n  If $f(x) \\neq f(-x)$ (and hence $x \\neq 0$),\n  then subtracting the above and factoring implies that\n  $f(x) + f(-x) = -x^2$;\n  we can then obtain by substituting the relation\n  \\[ \\left[ f(x) + \\frac 12x^2 \\right]^2 = -\\frac 34 x^4 < 0 \\]\n  which is impossible.\n  This means $f(x)^2 = x^2f(x)$, thus\n  \\[ f(x) \\in \\{0, x^2\\} \\qquad \\forall x. \\]\n\\end{proof}\n\nNow suppose there exists a nonzero integer $t$ with $f(t) = 0$.\nWe will prove that $f(x) \\equiv 0$.\nPut $y=t$ in the given to obtain that\n\\[ t^2 f(2x) = 0 \\]\nfor any integer $x \\neq 0$, and hence conclude that $f(2 \\ZZ) \\equiv 0$.\nThen selecting $x = 2k \\neq 0$ in the given implies that\n\\[ y^2 f(4k-f(y)) = f(yf(y)). \\]\n\nAssume for contradiction that $f(m) = m^2$ now for some odd $m \\neq 0$.\nEvidently \\[ m^2 f(4k-m^2) = f(m^3). \\]\nIf $f(m^3) \\neq 0$ this forces $f(4k-m^2) \\neq 0$,\nand hence $m^2(4k-m^2)^2 = m^6$ for arbitrary $k \\neq 0$, which is clearly absurd.\nThat means \\[ f(4k-m^2) = f(m^2-4k) = f(m^3) = 0 \\] for each $k \\neq 0$.\nSince $m$ is odd, $m^2 \\equiv 1 \\pmod 4$,\nand so $f(n) = 0$ for all $n$ other than $\\pm m^2$\n(since we cannot select $k=0$).\n\nNow $f(m) = m^2$ means that $m = \\pm 1$.\nHence either $f(x) \\equiv 0$ or\n\\[ f(x) = \\begin{cases} 1 & x = \\pm 1 \\\\ 0 & \\text{otherwise}. \\end{cases} \\]\nTo show that the latter fails,\nwe simply take $x=5$ and $y=1$ in the given.\n\nHence, the only solutions are $f(x) \\equiv 0$ and $f(x) \\equiv x^2$.\n\\pagebreak", "category": "Algebra", "source": "USAMO", "year": 2014}
{"id": "usamo-2014-q3", "question": "Prove that there exists an infinite set of points\n\\[ \\dots, \\; P_{-3}, \\; P_{-2},\\; P_{-1},\\; P_0,\\; P_1,\\; P_2,\\; P_3,\\; \\dots \\]\nin the plane with the following property:\nFor any three distinct integers $a$, $b$, and $c$,\npoints $P_a$, $P_b$, and $P_c$ are collinear if and only if $a+b+c=2014$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3477763}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nProve that there exists an infinite set of points\n\\[ \\dots, \\; P_{-3}, \\; P_{-2},\\; P_{-1},\\; P_0,\\; P_1,\\; P_2,\\; P_3,\\; \\dots \\]\nin the plane with the following property:\nFor any three distinct integers $a$, $b$, and $c$,\npoints $P_a$, $P_b$, and $P_c$ are collinear if and only if $a+b+c=2014$.\n\\end{mdframed}\nThe construction\n\\[ P_n = \\left( n-\\frac{2014}{3},\n  \\left( n-\\frac{2014}{3} \\right)^3 \\right) \\]\nworks fine, and follows from the following claim:\n\\begin{claim*}\n  If $x$, $y$, $z$ are distinct real numbers\n  then the points $(x,x^3)$, $(y,y^3)$, $(z,z^3)$\n  are collinear if and only if $x+y+z=0$.\n\\end{claim*}\n\\begin{proof}\n  Note that by the ``shoelace formula'',\n  the collinearity is equivalent to\n  \\[\n    0 =\n    \\det \\begin{bmatrix}\n      x & x^3 & 1 \\\\\n      y & y^3 & 1 \\\\\n      z & z^3 & 1 \\\\\n    \\end{bmatrix}\n  \\]\n  But the determinant equals\n  \\[ \\sum_{\\text{cyc}} x(y^3-z^3)\n    = (x-y)(y-z)(z-x)(x+y+z). \\qedhere  \\]\n\\end{proof}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Geometry", "source": "USAMO", "year": 2014}
{"id": "usamo-2014-q4", "question": "Let $k$ be a positive integer.\nTwo players $A$ and $B$ play a game on an infinite grid of regular hexagons.\nInitially all the grid cells are empty.\nThen the players alternately take turns with $A$ moving first.\nIn her move, $A$ may choose two adjacent hexagons in the grid\nwhich are empty and place a counter in both of them.\nIn his move, $B$ may choose any counter on the board and remove it.\nIf at any time there are $k$ consecutive grid cells\nin a line all of which contain a counter, $A$ wins.\nFind the minimum value of $k$ for which $A$ cannot\nwin in a finite number of moves, or prove that no such minimum value exists.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3478584}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $k$ be a positive integer.\nTwo players $A$ and $B$ play a game on an infinite grid of regular hexagons.\nInitially all the grid cells are empty.\nThen the players alternately take turns with $A$ moving first.\nIn her move, $A$ may choose two adjacent hexagons in the grid\nwhich are empty and place a counter in both of them.\nIn his move, $B$ may choose any counter on the board and remove it.\nIf at any time there are $k$ consecutive grid cells\nin a line all of which contain a counter, $A$ wins.\nFind the minimum value of $k$ for which $A$ cannot\nwin in a finite number of moves, or prove that no such minimum value exists.\n\\end{mdframed}\nThe answer is $k = 6$.\n\n\\paragraph{Proof that $A$ cannot win if $k=6$.}\nWe give a strategy for $B$ to prevent $A$'s victory.\nShade in every third cell, as shown in the figure below.\nThen $A$ can never cover two shaded cells simultaneously on her turn.\nNow suppose $B$ always removes a counter on a shaded cell\n(and otherwise does whatever he wants).\nThen he can prevent $A$ from ever getting six consecutive counters,\nbecause any six consecutive cells contain two shaded cells.\n\n\\begin{center}\n  \\begin{asy}\n    path hexagon = scale(0.5)*(dir(30)--dir(90)--dir(150)--dir(210)--dir(270)--dir(330)--cycle);\n    unitsize(0.6cm);\n    void mark(int x, int y) {\n      pair P = dir(0)*x + dir(60)*y;\n      filldraw(shift(P)*hexagon, purple, black+1);\n    }\n    void spot(int x, int y) {\n      pair P = dir(0)*x + dir(60)*y;\n      draw(shift(P)*hexagon);\n    }\n    int N = 4;\n    for (int x=-N; x<=N; ++x) {\n      for (int y=-N; y<=N; ++y) {\n        if ( (abs(x+y)) > N ) continue;\n        if (\n          (x-y) % 3 == 0\n        ) mark(x,y);\n        else spot(x,y);\n      }\n    }\n  \\end{asy}\n\\end{center}\n\n\\paragraph{Example of a strategy for $A$ when $k=5$.}\nWe describe a winning strategy for $A$ explicitly.\nNote that after $B$'s first turn there is one counter,\nso then $A$ may create an equilateral triangle,\nand hence after $B$'s second turn there are two consecutive counters.\nThen, on her third turn,\n$A$ places a pair of counters two spaces away on the same line.\nLabel the two inner cells $x$ and $y$ as shown below.\n\\begin{center}\n  \\begin{asy}\n    path hexagon = scale(0.5)*(dir(30)--dir(90)--dir(150)--dir(210)--dir(270)--dir(330)--cycle);\n    unitsize(0.6cm);\n    void mark(int x, int y) {\n      pair P = dir(0)*x + dir(60)*y;\n      filldraw(shift(P)*hexagon, palecyan, black);\n      filldraw(CR(P, 0.3), paleblue, blue);\n    }\n    void spot(int x, int y) {\n      pair P = dir(0)*x + dir(60)*y;\n      draw(shift(P)*hexagon);\n    }\n    for (int x=-3; x<=4; ++x) {\n      for (int y=-2; y<=2; ++y) {\n        if ( x+y < -3 ) continue;\n        if ( x+y > 4 ) continue;\n        spot(x,y);\n      }\n    }\n    mark(-2, 0);\n    mark(-1, 0);\n    mark( 2, 0);\n    mark( 3, 0);\n    label(\"$x$\", (-1)*dir(0));\n    label(\"$y$\", (2)*dir(0));\n  \\end{asy}\n\\end{center}\nNow it is $B$'s turn to move;\nin order to avoid losing immediately,\nhe must remove either $x$ or $y$.\nThen on any subsequent turn, $A$ can replace $x$ or $y$\n(whichever was removed)\nand add one more adjacent counter.\nThis continues until either $x$ or $y$ has all its neighbors filled\n(we ask $A$ to do so in such a way that\nshe avoids filling in the two central cells between $x$ and $y$\nas long as possible).\n\nSo, let's say without loss of generality (by symmetry) that $x$\nis completely surrounded by tokens.\nAgain, $B$ must choose to remove $x$ (or $A$ wins on her next turn).\nAfter $x$ is removed by $B$, consider the following figure.\n\\begin{center}\n  \\begin{asy}\n    path hexagon = scale(0.5)*(dir(30)--dir(90)--dir(150)--dir(210)--dir(270)--dir(330)--cycle);\n    unitsize(0.6cm);\n    void mark(int x, int y) {\n      pair P = dir(0)*x + dir(60)*y;\n      filldraw(shift(P)*hexagon, palecyan, black);\n      filldraw(CR(P, 0.3), paleblue, blue);\n    }\n    void spot(int x, int y) {\n      pair P = dir(0)*x + dir(60)*y;\n      draw(shift(P)*hexagon);\n    }\n    for (int x=-4; x<=5; ++x) {\n      for (int y=-3; y<=3; ++y) {\n        if ( x+y < -4 ) continue;\n        if ( x+y > 5 ) continue;\n        spot(x,y);\n      }\n    }\n    mark(-2, 0);\n    mark( 0, 0);\n    mark( 0, -1);\n    mark(-1, 1);\n    mark(-1, -1);\n    mark(-2, 1);\n\n    mark( 2, 0);\n    mark( 2, 1);\n    mark( 3, 0);\n    label(\"$x$\", (-1)*dir(0));\n    label(\"$y$\", (2)*dir(0));\n    void win(int x, int y, pen p1, pen p2) {\n      pair P = dir(0)*x + dir(60)*y;\n      filldraw(shift(P)*hexagon, p1, p2);\n    }\n    win(1,0, lightgreen, deepgreen);\n    win(0,1, lightgreen, deepgreen);\n    win(0,2, lightred, red);\n    win(0,3, lightred, red);\n    win(4,0, lightred, red);\n    win(5,0, lightred, red);\n  \\end{asy}\n\\end{center}\nWe let $A$ play in the two marked green cells.\nThen, regardless of what move $B$ plays,\none of the two choices of moves marked in red lets $A$ win.\nThus, we have described a winning strategy when $k=5$ for $A$.\n\\pagebreak", "category": "Combinatorics", "source": "USAMO", "year": 2014}
{"id": "usamo-2014-q5", "question": "Let $ABC$ be a triangle with orthocenter $H$ and\nlet $P$ be the second intersection of the circumcircle of\ntriangle $AHC$ with the internal bisector of $\\angle BAC$.\nLet $X$ be the circumcenter of triangle $APB$\nand let $Y$ be the orthocenter of triangle $APC$.\nProve that the length of segment $XY$ is equal to\nthe circumradius of triangle $ABC$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3478581}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle with orthocenter $H$ and\nlet $P$ be the second intersection of the circumcircle of\ntriangle $AHC$ with the internal bisector of $\\angle BAC$.\nLet $X$ be the circumcenter of triangle $APB$\nand let $Y$ be the orthocenter of triangle $APC$.\nProve that the length of segment $XY$ is equal to\nthe circumradius of triangle $ABC$.\n\\end{mdframed}\n\\begin{center}\n\\begin{asy}\n  size(8cm);\n  pair A = Drawing(\"A\", dir(110), dir(110));\n  pair B = Drawing(\"B\", dir(210), dir(210));\n  pair C = Drawing(\"C\", dir(330), dir(330));\n  draw(A--B--C--cycle);\n  draw(unitcircle);\n  pair Q = dir(30); // 330 + 1/2 * (330-210) (mod 360)\n  Drawing(\"Q\", Q, Q);\n  pair P = A+C-A*C*conj(Q);\n  P = Drawing(\"P\", P, dir(Q-P));\n  pair X = Drawing(\"X\", circumcenter(A,P,B), dir(225));\n  pair Y = Drawing(\"Y\", orthocenter(A,P,C), dir(225));\n  pair X1 = Drawing(\"X'\", A+C-A*C*conj(X), dir(45));\n  pair Y1 = Drawing(\"Y'\", A+C-A*C*conj(Y), dir(45));\n  Drawing(\"H\", A+B+C, dir(170));\n  draw(circumcircle(A,P,C));\n  pair B1 = Drawing(\"B'\", A+C-A*C*conj(B), dir(45));\n  draw(A--Q--C--cycle);\n  draw(X--Y);\n  draw(X1--Y1);\n  Drawing(\"O\", origin, dir(45));\n\\end{asy}\n\\end{center}\n\nWe eliminate the floating orthocenter\nby reflecting $P$ across $\\ol{AC}$ to $Q$.\nThen $Q$ lies on $(ABC)$ and moreover $\\angle QAC = \\tfrac 12 \\angle BAC$.\nThis motivates us to reflect $B$, $X$, $Y$\nto $B'$, $X'$, $Y'$ and complex bash with respect to $\\triangle AQC$.\nObviously \\[ y' = a + q + c. \\]\nNow we need to compute $x'$.\nYou can get this using the formula\n\\[ x' = a + \\frac{(b'-a)(q-a)\\left( \\ol{q-a}-\\ol{b'-a} \\right)}{(b'-a)\\ol{(q-a)}\n  - \\ol{(b'-a)}(q-a)}. \\]\nUsing the angle condition we know\n$b = \\frac{c^3}{q^2}$, and then that\n\\[ b' = a+c - ac\\ol b = a+c-\\frac{aq^2}{c^2}. \\]\nTherefore\n\\begin{align*}\n  x' &= a + \\frac{\\left( c-\\frac{aq^2}{c^2} \\right)\\left( q-a \\right)\\left( \\frac 1q - \\frac 1a - \\frac 1c + \\frac{c^2}{aq^2}  \\right)}{\\left( c-\\frac{aq^2}{c^2} \\right)\\left( \\frac 1q - \\frac 1a \\right) - \\left( \\frac 1c - \\frac{c^2}{aq^2} \\right)\\left( q-a \\right)} \\\\\n  &= a + \\frac{\\frac{c^3-aq^2}{c^2} \\left( q-a \\right)\\left( \\frac 1q - \\frac 1a - \\frac 1c + \\frac{c^2}{aq^2} \\right)}{-\\frac{c^3-aq^2}{c^2}\\frac{q-a}{qa} + \\frac{c^3-aq^2}{aq^2c}(q-a)} \\\\\n  &= a + \\frac{\\frac 1q - \\frac 1a - \\frac 1c + \\frac{c^2}{aq^2}}{-\\frac{1}{qa} + \\frac{c}{aq^2}} \\\\\n  &= a + \\frac{c^2-q^2 + aq-\\frac{aq^2}{c}}{c-q} \\\\\n  &= a + c + q + \\frac{aq}{c}\n\\end{align*}\nwhence\n\\[ \\left\\lvert x'-y' \\right\\rvert\n  = \\left\\lvert \\frac{aq}{c} \\right\\rvert\n  = 1. \\]\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2014}
{"id": "usamo-2014-q6", "question": "Prove that there is a constant $c>0$ with the following property:\nIf $a$, $b$, $n$ are positive integers such that $\\gcd(a+i, b+j)>1$\nfor all $i, j \\in \\{0, 1, \\dots, n\\}$, then\n\\[ \\min\\{a, b\\}> (cn)^{n/2}. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3478578}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nProve that there is a constant $c>0$ with the following property:\nIf $a$, $b$, $n$ are positive integers such that $\\gcd(a+i, b+j)>1$\nfor all $i, j \\in \\{0, 1, \\dots, n\\}$, then\n\\[ \\min\\{a, b\\}> (cn)^{n/2}. \\]\n\\end{mdframed}\nLet $N = n+1$ and assume $N$ is (very) large.\nWe construct an $N \\times N$ with cells $(i,j)$\nwhere $0 \\le i, j \\le n$ and in each cell\nplace a prime $p$ dividing $\\gcd (a+i, b+j)$.\n\nThe central claim is at least $50\\%$ of the primes\nin this table exceed $0.001n^2$.\nWe count the maximum number of squares they could occupy:\n\\[\n  \\sum_p \\left\\lceil \\frac{N}{p} \\right\\rceil^2\n  \\le \\sum_p \\left( \\frac Np + 1 \\right)^2\n  = N^2 \\sum_p \\frac{1}{p^2} + 2N \\sum_p \\frac1p + \\sum_p 1. \\]\nHere the summation runs over primes $p \\le 0.001n^2$.\n\nLet $r = \\pi(0.001n^2)$ denote the number of such primes.\nNow we consider the following three estimates.\nFirst, \\[ \\sum_p \\frac{1}{p^2} < \\frac 12 \\]\nwhich follows by adding all the primes directly with some computation.\nMoreover,\n\\[ \\sum_p \\frac 1p < \\sum_{k=1}^r \\frac 1k = O(\\log r) < o(N) \\]\nusing the harmonic series bound,\nand \\[ \\sum_p 1 < r \\sim O \\left( \\frac{N^2}{\\ln N} \\right) < o(N^2) \\]\nvia Prime Number Theorem.\nHence the sum in question is certainly less than $\\half N^2$ for $N$ large\nenough, establishing the central claim.\n\nHence some column $a+i$ has at least one\nhalf of its primes greater than $0.001n^2$.\nBecause this is greater than $n$ for large $n$,\nthese primes must all be distinct,\nso $a+i$ exceeds their product,\nwhich is larger than\n\\[ \\left( 0.001n^2 \\right)^{N/2} > c^n \\cdot n^n \\]\nwhere $c$ is some constant (better than the requested bound).\n\\pagebreak\n\n\n\\end{document}", "category": "Number Theory", "source": "USAMO", "year": 2014}
{"id": "usamo-1997-q1", "question": "Let $p_1, p_2, p_3, \\dots$ be the prime numbers\nlisted in increasing order,\nand let $0 < x_0 < 1$ be a real number between 0 and 1.\nFor each positive integer $k$, define\n\\[ x_k = \\begin{cases} 0 & \\mbox{if} \\; x_{k-1} = 0, \\\\[.1in]\n  {\\displaystyle \\left\\{ \\frac{p_k}{x_{k-1}} \\right\\}}\n  & \\mbox{if} \\; x_{k-1} \\neq 0,\n  \\end{cases}  \\]\nwhere $\\{x\\}$ denotes the fractional part of $x$.\nFind, with proof, all $x_0$ satisfying $0 < x_0 < 1$\nfor which the sequence $x_0, x_1, x_2, \\dots$ eventually becomes $0$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p343871}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $p_1, p_2, p_3, \\dots$ be the prime numbers\nlisted in increasing order,\nand let $0 < x_0 < 1$ be a real number between 0 and 1.\nFor each positive integer $k$, define\n\\[ x_k = \\begin{cases} 0 & \\mbox{if} \\; x_{k-1} = 0, \\\\[.1in]\n  {\\displaystyle \\left\\{ \\frac{p_k}{x_{k-1}} \\right\\}}\n  & \\mbox{if} \\; x_{k-1} \\neq 0,\n  \\end{cases}  \\]\nwhere $\\{x\\}$ denotes the fractional part of $x$.\nFind, with proof, all $x_0$ satisfying $0 < x_0 < 1$\nfor which the sequence $x_0, x_1, x_2, \\dots$ eventually becomes $0$.\n\\end{mdframed}\nThe answer is $x_0$ rational.\n\nIf $x_0$ is irrational, then all $x_i$ are irrational by induction.\nSo the sequence cannot become zero.\n\nIf $x_0$ is rational, then all are.\nNow one simply observes that the denominators of $x_n$\nare strictly decreasing, until we reach $0 = \\frac 01$.\nThis concludes the proof.\n\n\\begin{remark*}\n  The sequence $p_k$ could have been any sequence of integers.\n\\end{remark*}\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 1997}
{"id": "usamo-1997-q2", "question": "Let $ABC$ be a triangle.\nTake noncollinear points $D$, $E$, $F$ on the perpendicular bisectors\nof $BC$, $CA$, $AB$ respectively.\nShow that the lines through $A$, $B$, $C$\nperpendicular to $EF$, $FD$, $DE$ respectively are concurrent.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p210283}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle.\nTake noncollinear points $D$, $E$, $F$ on the perpendicular bisectors\nof $BC$, $CA$, $AB$ respectively.\nShow that the lines through $A$, $B$, $C$\nperpendicular to $EF$, $FD$, $DE$ respectively are concurrent.\n\\end{mdframed}\nThe three lines are the radical axii of the three circles\ncentered at $D$, $E$, $F$, so they concur.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 1997}
{"id": "usamo-1997-q3", "question": "Prove that for any integer $n$,\nthere exists a unique polynomial $Q$ with coefficients\nin $\\{0,1,\\dots,9\\}$ such that $Q(-2) = Q(-5) = n$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p343873}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nProve that for any integer $n$,\nthere exists a unique polynomial $Q$ with coefficients\nin $\\{0,1,\\dots,9\\}$ such that $Q(-2) = Q(-5) = n$.\n\\end{mdframed}\nIf we let\n\\[ Q(x) = \\sum_{k \\ge 0} a_k x^k \\]\nthen $a_k$ is uniquely determined by $n \\pmod{2^k}$ and $n \\pmod{5^k}$.\nIndeed, we can extract the coefficients of $Q$\nexactly by the following algorithm:\n\\begin{itemize}\n  \\ii Define $b_0 = c_0 = n$.\n  \\ii For $i \\ge 0$, let $a_i$ be the unique digit\n  satisfying $a_i \\equiv b_i \\pmod 2$, $a_i \\equiv c_i \\pmod 5$.\n  Then, define\n  \\[ b_{i+1} = \\frac{b_i - a_i}{-2}, \\qquad\n    c_{i+1} = \\frac{c_i - a_i}{-5}. \\]\n\\end{itemize}\nThe proof is automatic by Chinese remainder theorem,\nso this shows uniqueness already.\nThe tricky part is to show that all $a_i$ are eventually zero\n(i.e.\\ the ``existence'' step is nontrivial\nbecause a polynomial may only have finitely many nonzero terms).\n\nIn fact, we will prove the following claim:\n\\begin{claim*}\n  Suppose $b_0$ and $c_0$ are any integers such that\n  \\[ b_0 \\equiv c_0 \\pmod 3.\\]\n  Then defining $b_i$ and $c_i$ as above,\n  we have $b_i \\equiv c_i \\pmod 3$ for all $i$,\n  and $b_N = c_N = 0$ for large enough $N$.\n\\end{claim*}\n\\begin{proof}\nDropping the subscripts for ease of notation,\nwe are looking at the map\n\\[ (b, c) \\mapsto \\left( \\frac{b-a}{-2},\n    \\frac{c-a}{-5} \\right) \\]\nfor some $0 \\le a \\le 9$ (a function in $b$ and $c$).\n\nThe $b \\equiv c \\pmod 3$ is clearly preserved.\nAlso, examining the size,\n\\begin{itemize}\n  \\ii If $|c| > 2$,\n  we have $\\left\\lvert \\frac{c-a}{-5} \\right\\rvert\n  \\le \\frac{|c|+9}{5} < |c|$.\n  Thus, we eventually reach a pair with $|c| \\le 2$.\n  \\ii Similarly, if $|b| > 9$,\n  we have $\\left\\lvert \\frac{b-a}{-2} \\right\\rvert\n  \\le \\frac{|b|+9}{2} < |b|$,\n  so we eventually reach a pair with $|b| \\le 9$.\n\\end{itemize}\nthis leaves us with $5 \\cdot 19 = 95$ ordered pairs to check\n(though only about one third have $b \\equiv c \\pmod 3$).\nThis can be done by the following code:\n\\begin{lstlisting}[language=Python]\nimport functools\n@functools.lru_cache()\ndef f(x0, y0):\n  if x0 == 0 and y0 == 0:\n    return 0\n  if x0 % 2 == (y0 % 5) % 2:\n    d = y0 % 5\n  else:\n    d = (y0 % 5) + 5\n\n  x1 = (x0 - d) // (-2)\n  y1 = (y0 - d) // (-5)\n\n  return 1 + f(x1, y1)\n\nfor x in range(-9, 10):\nfor y in range(-2, 3):\n  if (x % 3 == y % 3):\n    print(f\"({x:2d}, {y:2d}) finished in {f(x,y)} moves\")\n\\end{lstlisting}\nAs this gives the output\n\\begin{lstlisting}\n(-9,  0) finished in 5 moves\n(-8, -2) finished in 5 moves\n(-8,  1) finished in 5 moves\n(-7, -1) finished in 5 moves\n(-7,  2) finished in 5 moves\n(-6,  0) finished in 3 moves\n(-5, -2) finished in 3 moves\n(-5,  1) finished in 3 moves\n(-4, -1) finished in 3 moves\n(-4,  2) finished in 3 moves\n(-3,  0) finished in 3 moves\n(-2, -2) finished in 3 moves\n(-2,  1) finished in 3 moves\n(-1, -1) finished in 3 moves\n(-1,  2) finished in 3 moves\n( 0,  0) finished in 0 moves\n( 1, -2) finished in 2 moves\n( 1,  1) finished in 1 moves\n( 2, -1) finished in 2 moves\n( 2,  2) finished in 1 moves\n( 3,  0) finished in 2 moves\n( 4, -2) finished in 2 moves\n( 4,  1) finished in 2 moves\n( 5, -1) finished in 2 moves\n( 5,  2) finished in 2 moves\n( 6,  0) finished in 4 moves\n( 7, -2) finished in 4 moves\n( 7,  1) finished in 4 moves\n( 8, -1) finished in 4 moves\n( 8,  2) finished in 4 moves\n( 9,  0) finished in 4 moves\n\\end{lstlisting}\nwe are done.\n\\end{proof}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Algebra", "source": "USAMO", "year": 1997}
{"id": "usamo-1997-q4", "question": "To clip a convex $n$-gon means to choose a pair of consecutive sides $AB$, $BC$\nand to replace them by the three segments $AM$, $MN$, and $NC$,\nwhere $M$ is the midpoint of $AB$ and $N$ is the midpoint of $BC$.\nIn other words, one cuts off the triangle $MBN$ to obtain a convex $(n+1)$-gon.\nA regular hexagon $\\mathcal{P}_6$ of area 1 is clipped to obtain a heptagon $\\mathcal{P}_7$.\nThen $\\mathcal{P}_7$ is clipped (in one of the seven possible ways)\nto obtain an octagon $\\mathcal{P}_8$, and so on.\nProve that no matter how the clippings are done,\nthe area of $\\mathcal{P}_n$ is greater than $\\frac 13$, for all $n \\geq 6$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p343875}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nTo clip a convex $n$-gon means to choose a pair of consecutive sides $AB$, $BC$\nand to replace them by the three segments $AM$, $MN$, and $NC$,\nwhere $M$ is the midpoint of $AB$ and $N$ is the midpoint of $BC$.\nIn other words, one cuts off the triangle $MBN$ to obtain a convex $(n+1)$-gon.\nA regular hexagon $\\mathcal{P}_6$ of area 1 is clipped to obtain a heptagon $\\mathcal{P}_7$.\nThen $\\mathcal{P}_7$ is clipped (in one of the seven possible ways)\nto obtain an octagon $\\mathcal{P}_8$, and so on.\nProve that no matter how the clippings are done,\nthe area of $\\mathcal{P}_n$ is greater than $\\frac 13$, for all $n \\geq 6$.\n\\end{mdframed}\nCall the original hexagon $ABCDEF$.\nWe show the area common to triangles $ACE$ and $BDF$ is in every\n$\\mathcal{P}_n$; this solves the problem since the area is $1/3$.\n\nFor every side of a clipped polygon,\nwe define its \\emph{foundation} recursively as follows:\n\\begin{itemize}\n  \\ii $AB$, $BC$, $CD$, $DE$, $EF$, $FA$\n  are each their own foundation (we also call these \\emph{original sides}).\n  \\ii When a new clipped edge is added, its foundation is the union of the foundations\n  of the two edges it touches.\n\\end{itemize}\nHence, any foundations are nonempty subsets of original sides.\n\n\\begin{claim*}\n  All foundations are in fact at most two-element sets of adjacent original sides.\n\\end{claim*}\n\\begin{proof}\n  It's immediate by induction\n  that any two adjacent sides have at most two elements\n  in the union of their foundations, and if there are two,\n  they are two adjacent original sides.\n\\end{proof}\n\nNow, if a side has foundation contained in $\\{AB,BC\\}$, say,\nthen the side should be contained within triangle $ABC$.\nHence the side does not touch $AC$. This proves the problem.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 1997}
{"id": "usamo-1997-q5", "question": "If $a,b,c > 0$ prove that\n\\[\n  \\frac{1}{a^3+b^3+abc}\n  + \\frac{1}{b^3+c^3+abc}\n  + \\frac{1}{c^3+a^3+abc}\n  \\le \\frac{1}{abc}.\n\\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p2971}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nIf $a,b,c > 0$ prove that\n\\[\n  \\frac{1}{a^3+b^3+abc}\n  + \\frac{1}{b^3+c^3+abc}\n  + \\frac{1}{c^3+a^3+abc}\n  \\le \\frac{1}{abc}.\n\\]\n\\end{mdframed}\nFrom $a^3 + b^3 \\ge ab(a+b)$, the left-hand side becomes\n\\[\n  \\sum_{\\text{cyc}} \\frac{1}{a^3+b^3+abc}\n  \\le \\sum_{\\text{cyc}} \\frac{1}{ab(a+b+c)}\n  = \\frac{1}{abc} \\sum_{\\text{cyc}} \\frac{c}{a+b+c}\n  = \\frac{1}{abc}.\n\\]\n\\pagebreak", "category": "Algebra", "source": "USAMO", "year": 1997}
{"id": "usamo-1997-q6", "question": "Suppose the sequence of nonnegative integers\n$a_1, a_2, \\dots, a_{1997}$ satisfies\n\\[ a_i + a_j \\leq a_{i+j} \\leq a_i + a_j + 1  \\]\nfor all $i,j \\geq 1$ with $i + j \\leq 1997$.\nShow that there exists a real number $x$ such that\n$a_n = \\lfloor nx \\rfloor$ for all $1 \\leq n \\leq 1997$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p343876}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nSuppose the sequence of nonnegative integers\n$a_1, a_2, \\dots, a_{1997}$ satisfies\n\\[ a_i + a_j \\leq a_{i+j} \\leq a_i + a_j + 1  \\]\nfor all $i,j \\geq 1$ with $i + j \\leq 1997$.\nShow that there exists a real number $x$ such that\n$a_n = \\lfloor nx \\rfloor$ for all $1 \\leq n \\leq 1997$.\n\\end{mdframed}\nWe are trying to show there exists an $x \\in \\RR$\nsuch that\n\\[ \\frac{a_n}{n} \\le x < \\frac{a_n+1}{n} \\qquad \\forall n. \\]\nThis means we need to show\n\\[ \\max_i \\frac{a_i}{i} < \\min_j \\frac{a_j+1}{j}. \\]\nReplace 1997 by $N$.\nWe will prove this by induction,\nbut we will need some extra hypotheses on the indices $i,j$\nwhich are used above.\n\n\\begin{claim*}\n  Suppose that\n  \\begin{itemize}\n    \\ii Integers $a_1$, $a_2$, \\dots, $a_N$ satisfy the given conditions.\n    \\ii Let $i = \\opname{argmax}_n \\frac{a_n}{n}$;\n    if there are ties, pick the smallest $i$.\n    \\ii Let $j = \\opname{argmin}_n \\frac{a_n+1}{n}$;\n    if there are ties, pick the smallest $j$.\n  \\end{itemize}\n  Then \\[ \\frac{a_i}{i} < \\frac{a_j+1}{j}. \\]\n  Moreover, these two fractions are in lowest terms,\n  and are adjacent in the Farey sequence of order $\\max(i,j)$.\n\\end{claim*}\n\\begin{proof}\n  By induction on $N \\ge 1$ with the base case clear.\n  So suppose we have the induction hypothesis\n  with numbers $a_1$, \\dots, $a_{N-1}$,\n  with $i$ and $j$ as promised.\n\n  Now, consider the new number $a_N$.\n  We have two cases:\n  \\begin{itemize}\n    \\ii Suppose $i+j > N$.\n    Then, no fraction with denominator $N$\n    can lie strictly inside the interval;\n    so we may write for some integer $b$\n    \\[ \\frac bN \\le \\frac{a_i}{i}\n      < \\frac{a_j+1}{j} \\le \\frac{b+1}{N}. \\]\n    For purely algebraic reasons we have\n    \\[ \\frac{b-a_i}{N-i} \\le \\frac bN \\le \\frac{a_i}{i}\n      < \\frac{a_j+1}{j} \\le \\frac{b+1}{N}\n      \\le \\frac{b-a_j}{N-j}. \\]\n    Now,\n    \\begin{align*}\n      a_N &\\ge a_i + a_{N-i}\n        \\ge a_i + (N-i) \\cdot \\frac{a_i}{i} \\\\\n      &\\ge a_i + (b-a_i) = b \\\\\n      a_N &\\le a_j + a_{N-j} + 1\n        \\le (a_j+1) + (N-j) \\cdot \\frac{a_j+1}{j} \\\\\n      &= (a_j+1) + (b-a_j) = b+1.\n    \\end{align*}\n    Thus $a_N \\in \\{b,b+1\\}$.\n    This proves that $\\frac{a_N}{N} \\le \\frac{a_i}{i}$\n    while $\\frac{a_N+1}{N} \\ge \\frac{a_j+1}{j}$.\n    Moreover, the pair $(i,j)$ does not change,\n    so all inductive hypotheses carry over.\n\n    \\ii On the other hand, suppose $i+j = N$.\n    Then we have\n    \\[ \\frac{a_i}{i} < \\frac{a_i + a_j + 1}{N} < \\frac{a_j+1}{j}.  \\]\n    Now, we know $a_N$ could be either $a_i + a_j$ or $a_i + a_j + 1$.\n    If it's the former, then $(i,j)$ becomes $(i,N)$.\n    If it's the latter, then $(i,j)$ becomes $(N,j)$.\n    The properties of Farey sequences ensure that\n    the $\\frac{a_i + a_j + 1}{N}$ is reduced, either way.\n  \\end{itemize}\n\\end{proof}\n\\pagebreak\n\n\n\\end{document}", "category": "Number Theory", "source": "USAMO", "year": 1997}
{"id": "putnam-1995-a1", "question": "Let $S$ be a set of real numbers which is closed under\nmultiplication (that is, if $a$ and $b$ are in $S$, then so is $ab$).\nLet $T$ and $U$ be disjoint subsets of $S$ whose union is $S$. Given\nthat the product of any {\\em three} (not necessarily distinct)\nelements of $T$ is in $T$ and that the product of any three elements\nof $U$ is in $U$, show that at least one of the two subsets $T,U$ is\nclosed under multiplication.", "solution": "Suppose on the contrary that there exist $t_{1}, t_{2} \\in T$\nwith $t_{1}t_{2} \\in U$ and $u_{1}, u_{2} \\in U$ with $u_{1}u_{2} \\in\nT$. Then $(t_{1}t_{2})u_{1}u_{2} \\in U$ while\n$t_{1}t_{2}(u_{1}u_{2}) \\in T$, contradiction.", "category": "Algebra", "source": "PUTNAM", "year": 1995}
{"id": "putnam-1995-a2", "question": "For what pairs $(a,b)$ of positive real numbers does the\nimproper integral\n\\[\n\\int_{b}^{\\infty} \\left( \\sqrt{\\sqrt{x+a}-\\sqrt{x}} -\n\\sqrt{\\sqrt{x}-\\sqrt{x-b}} \\right)\\,dx\n\\]\nconverge?", "solution": "The integral converges iff $a=b$. The easiest proof uses\n``big-O'' notation and the fact that $(1+x)^{1/2} = 1 + x/2 +\nO(x^{2})$ for $|x|<1$. (Here $O(x^{2})$ means bounded by a constant\ntimes $x^{2}$.)\n\nSo\n\\begin{align*}\n\\sqrt{x+a}-\\sqrt{x} &= x^{1/2}(\\sqrt{1+a/x} - 1) \\\\\n&= x^{1/2}(1 + a/2x + O(x^{-2})),\n\\end{align*}\nhence\n\\[\n\\sqrt{\\sqrt{x+a} - \\sqrt{x}} = x^{1/4} (a/4x + O(x^{-2}))\n\\]\nand similarly\n\\[\n\\sqrt{\\sqrt{x} - \\sqrt{x-b}} = x^{1/4} (b/4x + O(x^{-2})).\n\\]\nHence the integral we're looking at is\n\\[\n\\int_{b}^{\\infty} x^{1/4} ((a-b)/4x + O(x^{-2}))\\,dx.\n\\]\nThe term $x^{1/4} O(x^{-2})$ is bounded by a constant times\n$x^{-7/4}$, whose integral converges. Thus we only have to decide\nwhether $x^{-3/4} (a-b)/4$ converges. But $x^{-3/4}$ has divergent\nintegral, so we get convergence if and only if $a=b$ (in which case\nthe integral telescopes anyway).", "category": "Geometry", "source": "PUTNAM", "year": 1995}
{"id": "putnam-1995-a3", "question": "The number $d_{1}d_{2}\\dots d_{9}$ has nine (not\nnecessarily distinct) decimal digits. The number $e_{1}e_{2}\\dots\ne_{9}$ is such that each of the nine 9-digit numbers formed by\nreplacing just one of the digits $d_{i}$ is $d_{1}d_{2}\\dots d_{9}$\nby the corresponding digit $e_{i}$ ($1 \\leq i \\leq 9$) is divisible\nby 7. The number $f_{1}f_{2}\\dots f_{9}$ is related to\n$e_{1}e_{2}\\dots e_{9}$ is the same way: that is, each of the nine\nnumbers formed by replacing one of the $e_{i}$ by the corresponding\n$f_{i}$ is divisible by 7. Show that, for each $i$, $d_{i}-f_{i}$ is\ndivisible by 7. [For example, if $d_{1}d_{2}\\dots d_{9} = 199501996$,\nthen $e_{6}$ may be 2 or 9, since $199502996$ and $199509996$ are\nmultiples of 7.]", "solution": "Let $D$ and $E$ be the numbers $d_{1}\\dots d_{9}$ and $e_{1}\\dots\ne_{9}$, respectively. We are given that $(e_{i} - d_{i})10^{9-i} + D\n\\equiv 0 \\pmod 7$ and $(f_{i} - e_{i})10^{9-i} + E \\equiv 0 \\pmod 7$\nfor $i=1, \\dots, 9$. Sum the first relation over $i=1,\\dots,9$ and we\nget $E - D + 9D \\equiv 0 \\pmod 7$, or $E + D \\equiv 0 \\pmod 7$. Now\nadd the first and second relations for any particular value of $i$\nand we get $(f_{i} - d_{i})10^{9-i} + E + D \\equiv 0 \\pmod 7$. But we\nknow $E+D$ is divisible by 7, and 10 is coprime to 7, so $d_{i} -\nf_{i} \\equiv 0 \\pmod 7$.", "category": "Number Theory", "source": "PUTNAM", "year": 1995}
{"id": "putnam-1995-a4", "question": "Suppose we have a necklace of $n$ beads. Each bead is\nlabeled with an integer and the sum of all these labels is $n-1$.\nProve that we can cut the necklace to form a string whose\nconsecutive labels $x_{1},x_{2},\\dots,x_{n}$ satisfy\n\\[\n\\sum_{i=1}^{k} x_{i} \\leq k-1 \\qquad \\mbox{for} \\quad k=1,2,\\dots,n.\n\\]", "solution": "Let $s_{k} = x_{1} + \\cdots + x_{k} - k(n-1)/n$, so that $s_{n} =\ns_{0} = 0$. These form a cyclic sequence that doesn't change when you\nrotate the necklace, except that the entire sequence gets translated\nby a constant. In particular, it makes sense to choose $x_{i}$ for\nwhich $s_{i}$ is maximum and make that one $x_{n}$; this way $s_{i}\n\\leq 0$ for all $i$, which gives $x_{1} + \\cdots + x_{i} \\leq\ni(n-1)/n$, but the right side may be replaced by $i-1$ since the left\nside is an integer.", "category": "Combinatorics", "source": "PUTNAM", "year": 1995}
{"id": "putnam-1995-a5", "question": "Let $x_{1},x_{2},\\dots,x_{n}$ be differentiable\n(real-valued) functions of a single variable $f$ which satisfy\n\\begin{align*}\n\\frac{dx_{1}}{dt} &= a_{11}x_{1} + a_{12}x_{2} + \\cdots +\na_{1n}x_{n} \\\\\n\\frac{dx_{2}}{dt} &= a_{21}x_{1} + a_{22}x_{2} + \\cdots +\na_{2n}x_{n} \\\\\n\\vdots && \\vdots \\\\\n\\frac{dx_{n}}{dt} &= a_{n1}x_{1} + a_{n2}x_{2} + \\cdots +\na_{nn}x_{n}\n\\end{align*}\nfor some constants $a_{ij}>0$. Suppose that for all $i$, $x_{i}(t)\n\\to 0$ as $t \\to \\infty$. Are the functions $x_{1},x_{2},\\dots,x_{n}$\nnecessarily linearly dependent?", "solution": "Everyone (presumably) knows that the set of solutions of a system of\nlinear first-order differential equations with constant coefficients\nis $n$-dimensional, with basis vectors of the form $f_{i}(t)\n\\vec{v}_{i}$ (i.e.\\ a function times a constant vector), where the\n$\\vec{v}_{i}$ are linearly independent. In\nparticular, our solution $\\vec{x}(t)$ can be written as $\\sum_{i=1}^{n}\nc_{i}f_{i}(t) \\vec{v}_{1}$.\n\nChoose a vector $\\vec{w}$ orthogonal to $\\vec{v}_{2}, \\dots,\n\\vec{v}_{n}$ but not to $\\vec{v}_1$. Since $\\vec{x}(t) \\to 0$ as $t\n\\to \\infty$, the same is true of $\\vec{w} \\cdot \\vec{x}$; but that is\nsimply $(\\vec{w} \\cdot \\vec{v}_{1}) c_{1} f_{1}(t)$. In other words,\nif $c_{i} \\neq 0$, then $f_{i}(t)$ must also go to 0.\n\nHowever, it is easy to exhibit a solution which does not go to 0. The\nsum of the eigenvalues of the matrix $A = (a_{ij})$, also known as the\ntrace of $A$, being the sum of the diagonal entries of $A$, is\nnonnegative, so $A$ has an eigenvalue $\\lambda$ with nonnegative real\npart, and a corresponding eigenvector $\\vec{v}$. Then $e^{\\lambda t}\n\\vec{v}$ is a solution that does not go to 0. (If $\\lambda$ is not\nreal, add this solution to its complex conjugate to get a real\nsolution, which still doesn't go to 0.)\n\nHence one of the $c_{i}$, say $c_{1}$, is zero, in which case\n$\\vec{x}(t) \\cdot \\vec{w} = 0$ for all $t$.", "category": "Algebra", "source": "PUTNAM", "year": 1995}
{"id": "putnam-1995-a6", "question": "Suppose that each of $n$ people writes down the numbers\n1,2,3 in random order in one column of a $3 \\times n$ matrix, with\nall orders equally likely and with the orders for different columns\nindependent of each other. Let the row sums $a,b,c$ of the resulting\nmatrix be rearranged (if necessary) so that $a \\leq b \\leq c$. Show\nthat for some $n \\geq 1995$, it is at least four times as likely that\nboth $b=a+1$ and $c=a+2$ as that $a=b=c$.", "solution": "View this as a random walk/Markov process with states $(i,j,k)$ the\ntriples of integers with sum 0, corresponding to the difference\nbetween the first, second and third rows with their average (twice\nthe number of columns). Adding a new column adds on a random\npermutation of the vector $(1,0,-1)$. I prefer to identify the\ntriple $(i,j,k)$ with the point $(i-j) + (j-k)\\omega +\n(k-i)\\omega^{2}$ in the plane, where $\\omega$ is a cube root of\nunity. Then adding a new column corresponds to moving to one of the\nsix neighbors of the current position in a triangular lattice.\n\nWhat we'd like to argue is that for large enough $n$, the ratio of\nthe probabilities of being in any two particular states goes to 1.\nThen in fact, we'll see that eventually, about six times as many\nmatrices have $a=b-1,b=c-1$ than $a=b=c$. This is a pain to prove,\nthough, and in fact is way more than we actually need.\n\nLet $C_{n}$ and $A_{n}$ be the probability that we are at the origin,\nor at a particular point adjacent to the origin, respectively. Then\n$C_{n+1} = A_{n}$. (In fact, $C_{n+1}$ is $1/6$ times the sum of the\nprobabilities of being at each neighbor of the origin at time $n$, but\nthese are all $A_{n}$.) So the desired result, which is that\n$C_{n}/A_{n} \\geq 2/3$ for some large $n$, is equivalent to\n$A_{n+1}/A_{n} \\geq 2/3$.\n\nSuppose on the contrary that this is not the case; then $A_{n} < c\n(2/3)^{n}$ for some constant $n$. However, if $n=6m$, the probability\nthat we chose each of the six types of moves $m$ times is already\n$(6m)!/[m!^{6} 6^{6m}]$, which by Stirling's approximation is\nasymptotic to a constant times $m^{-5/2}$. This term alone is bigger\nthan $c (2/3)^{n}$, so we must have $A_{n+1}/A_{n} \\geq 2/3$ for\nsome $n$. (In fact, we must have $A_{n+1}/A_{n} \\geq 1-\\epsilon$ for\nany $\\epsilon>0$.)", "category": "Combinatorics", "source": "PUTNAM", "year": 1995}
{"id": "putnam-1995-b1", "question": "For a partition $\\pi$ of $\\{1, 2, 3, 4, 5, 6, 7, 8, 9\\}$,\nlet $\\pi(x)$ be the number of elements in the part containing $x$.\nProve that for any two partitions $\\pi$ and $\\pi'$, there are two\ndistinct numbers $x$ and $y$ in $\\{1, 2, 3, 4, 5, 6, 7, 8, 9\\}$\nsuch that $\\pi(x) = \\pi(y)$ and $\\pi'(x) = \\pi'(y)$. [A {\\em\npartition} of a set $S$ is a collection of disjoint subsets (parts)\nwhose union is $S$.]", "solution": "For a given $\\pi$, no more than three different values of $\\pi(x)$\nare possible (four would require one part each of size at least\n1,2,3,4, and that's already more than 9 elements). If no such $x, y$\nexist, each pair $(\\pi(x), \\pi'(x))$ occurs for at most 1 element of\n$x$, and\nsince there are only $3 \\times 3$ possible pairs, each must occur\nexactly once. In particular, each value of $\\pi(x)$ must occur 3\ntimes. However, clearly any given value of $\\pi(x)$ occurs $k\\pi(x)$\ntimes, where $k$ is the number of distinct partitions of that size.\nThus $\\pi(x)$ can occur 3 times only if it equals 1 or 3, but we have\nthree distinct values for which it occurs, contradiction.", "category": "Combinatorics", "source": "PUTNAM", "year": 1995}
{"id": "putnam-1995-b2", "question": "An ellipse, whose semi-axes have lengths $a$ and $b$,\nrolls without slipping on the curve $y = c \\sin \\left( \\frac{x}{a}\n\\right)$. How are $a,b,c$ related, given that the ellipse completes\none revolution when it traverses one period of the curve?", "solution": "For those who haven't taken enough physics, ``rolling without\nslipping'' means that the perimeter of the ellipse and the curve pass\nat the same rate, so all we're saying is that the perimeter of the\nellipse equals the length of one period of the sine curve. So set up\nthe integrals:\n\\begin{multline*}\n\\int_{0}^{2\\pi} \\sqrt{(-a \\sin \\theta)^{2} + (b \\cos \\theta)^{2}}\\,\nd\\theta\\\\\n = \\int_{0}^{2\\pi a} \\sqrt{1 + (c/a \\cos x/a)^{2}}\\,dx.\n\\end{multline*}\nLet $\\theta = x/a$ in the second integral and write 1 as $\\sin^{2}\n\\theta + \\cos^{2} \\theta$ and you get\n\\begin{multline*}\n\\int_{0}^{2\\pi} \\sqrt{a^{2} \\sin^{2} \\theta + b^{2} \\cos^{2}\n\\theta}\\,d\\theta\\\\\n = \\int_{0}^{2\\pi} \\sqrt{a^{2} \\sin^{2} \\theta +\n(a^{2} + c^{2}) \\cos^{2} \\theta}\\,d\\theta.\n\\end{multline*}\nSince the left side is increasing as a function of $b$, we have\nequality if and only if $b^{2} = a^{2} + c^{2}$.", "category": "Geometry", "source": "PUTNAM", "year": 1995}
{"id": "putnam-1995-b3", "question": "To each positive integer with $n^{2}$ decimal digits, we\nassociate the determinant of the matrix obtained by writing the\ndigits in order across the rows. For example, for $n=2$, to the\ninteger 8617 we associate $\\det \\left(\n \\begin{array}{cc} 8 & 6 \\\\\n1 & 7 \\end{array} \\right) = 50$. Find, as a function of $n$, the\nsum of all the determinants associated with $n^{2}$-digit\nintegers. (Leading digits are assumed to be nonzero; for example,\nfor $n=2$, there are 9000 determinants.)", "solution": "For $n=1$ we obviously get 45, while for $n=3$ the answer is 0\nbecause it both changes sign (because determinants are alternating)\nand remains unchanged (by symmetry) when you switch any two rows other\nthan the first one. So only $n=2$ is left. By the multilinearity of\nthe determinant, the answer is the determinant of the matrix whose\nfirst (resp. second) row is the sum of all possible first (resp.\nsecond) rows. There are 90 first rows whose sum is the vector $(450,\n405)$, and 100 second rows whose sum is $(450, 450)$. Thus the answer\nis $450\\times 450 - 450 \\times 405 = 45 \\times 450 = 20250.$", "category": "Algebra", "source": "PUTNAM", "year": 1995}
{"id": "putnam-1995-b4", "question": "Evaluate\n\\[\n\\sqrt[8]{2207 - \\frac{1}{2207-\\frac{1}{2207-\\dots}}}.\n\\]\nExpress your answer in the form $\\frac{a+b\\sqrt{c}}{d}$, where\n$a,b,c,d$ are integers.", "solution": "The infinite continued fraction is defined as the limit of the\nsequence $L_{0} = 2207, L_{n+1} = 2207-1/L_{n}$. Notice that the\nsequence is strictly decreasing (by induction) and thus indeed has a\nlimit $L$, which satisfies $L = 2207 - 1/L$, or rewriting, $L^{2} -\n2207L + 1 = 0$. Moreover, we want the greater of the two roots.\n\nNow how to compute the eighth root of $L$? Notice that if $x$\nsatisfies the quadratic $x^{2} - ax + 1 = 0$, then we have\n\\begin{align*}\n0 &= (x^{2} - ax + 1)(x^{2} + ax + 1) \\\\\n&= x^{4} - (a^{2} - 2)x^{2} + 1.\n\\end{align*}\nClearly, then, the positive square roots of the quadratic $x^{2} -\nbx + 1$ satisfy the quadratic $x^{2} - (b^{2}+2)^{1/2}x + 1 = 0$. Thus\nwe compute that $L^{1/2}$ is the greater root of $x^{2} - 47x + 1 =\n0$, $L^{1/4}$ is the greater root of $x^{2} - 7x+ 1 =0$, and\n$L^{1/8}$ is the greater root of $x^{2} - 3x + 1 = 0$, otherwise\nknown as $(3 + \\sqrt{5})/2$.", "category": "Number Theory", "source": "PUTNAM", "year": 1995}
{"id": "putnam-1995-b5", "question": "A game starts with four heaps of beans, containing 3,4,5\nand 6 beans. The two players move alternately. A move consists of\ntaking \\textbf{either}\n\\begin{itemize}", "solution": "This problem is dumb if you know the Sprague-Grundy theory of normal\nimpartial games (see Conway, Berlekamp and Guy, {\\it Winning Ways},\nfor details). I'll describe how it applies here. To each position you\nassign a {\\em nim-value} as follows. A position with no moves (in\nwhich case the person to move has just lost) takes value 0. Any other\nposition is assigned the smallest number not assigned to a valid move\nfrom that position.\n\nFor a single pile, one sees that an empty pile has value 0, a pile of\n2 has value 1, a pile of 3 has value 2, a pile of 4 has value 0, a\npile of 5 has value 1, and a pile of 6 has value 0.\n\nYou add piles just like in standard Nim: the nim-value of the\ncomposite of two games (where at every turn you pick a game and make\na move there) is the ``base 2 addition without carries'' (i.e.\\\nexclusive OR) of the nim-values of the constituents. So our starting\nposition, with piles of 3, 4, 5, 6, has nim-value $2 \\oplus 0 \\oplus\n1 \\oplus 0 = 3$.\n\nA position is a win for the player to move if and only if it has a\nnonzero value, in which case the winning strategy is to always move to\na 0 position. (This is always possible from a nonzero position and\nnever from a zero position, which is precisely the condition that\ndefines the set of winning positions.) In this case, the winning move\nis to reduce the pile of 3 down to 2, and you can easily describe the\nentire strategy if you so desire.", "category": "Combinatorics", "source": "PUTNAM", "year": 1995}
{"id": "putnam-1995-b6", "question": "For a positive real number $\\alpha$, define\n\\[\nS(\\alpha) = \\{ \\lfloor n\\alpha \\rfloor : n = 1,2,3,\\dots \\}.\n\\]\nProve that $\\{1,2,3,\\dots\\}$ cannot be expressed as the disjoint\nunion of three sets $S(\\alpha), S(\\beta)$ and $S(\\gamma)$. [As\nusual, $\\lfloor x \\rfloor$ is the greatest integer $\\leq x$.]\n\n\\end{itemize}\n\\end{document}", "solution": "Obviously $\\alpha, \\beta, \\gamma$ have to be greater than 1, and no\ntwo can both be rational, so without loss of generality assume that\n$\\alpha$ and $\\beta$ are irrational.\nLet $\\{x\\} = x - \\lfloor x \\rfloor$ denote the fractional part of $x$.\nThen $m \\in S(\\alpha)$ if and only if $f(m/\\alpha) \\in (1-1/\\alpha,1)\n\\cup \\{0\\}$. In particular, this means that $S(\\alpha) \\cap \\{1,\n\\dots, n\\}$ contains $\\lceil (n+1)/\\alpha \\rceil -1$ elements, and\nsimilarly. Hence for every integer $n$,\n\\[\nn = \\left\\lceil \\frac{n+1}\\alpha \\right\\rceil +\n \\left\\lceil \\frac{n+1}\\beta \\right\\rceil +\n \\left\\lceil \\frac{n+1}\\gamma \\right\\rceil -3.\n\\]\nDividing through by $n$ and taking the limit as $n \\to \\infty$ shows\nthat $1/\\alpha + 1/\\beta + 1/\\gamma = 1$. That in turn implies that\nfor all $n$,\n\\[\n\\left\\{ - \\frac{n+1}{\\alpha} \\right\\} +\n\\left\\{ - \\frac{n+1}{\\beta} \\right\\} +\n\\left\\{ - \\frac{n+1}{\\gamma} \\right\\} = 2.\n\\]\nOur desired contradiction is equivalent to showing that the left side actually\ntakes the value 1 for some $n$. Since the left side is\nan integer, it suffices to show that $\\{ -(n+1)/\\alpha\\} +\n\\{-(n+1)/\\beta\\} < 1$ for some $n$.\n\nA result in ergodic theory (the two-dimensional version of the Weil\nequidistribution theorem) states that if $1,r,s$ are linearly\nindependent over the rationals, then the set of points $(\\{nr\\},\n\\{ns\\}$ is dense (and in fact equidistributed) in the unit square. In\nparticular, our claim definitely holds unless $a/\\alpha + b/\\beta =\nc$ for some integers $a,b,c$.\n\nOn the other hand, suppose that such a relation does hold. Since\n$\\alpha$ and $\\beta$ are irrational, by the one-dimensional Weil\ntheorem, the set of points $(\\{-n/\\alpha\\}, \\{-n/\\beta\\}$ is dense in\nthe set of $(x,y)$ in the unit square such that $ax + by$ is an integer.\nIt is simple enough to show that this set meets the region $\\{(x,y)\n\\in [0,1]^{2}: x+y<1\\}$ unless $a+b$ is an integer, and that would\nimply that $1/\\alpha + 1/\\beta$, a quantity between 0 and 1, is an\ninteger. We have our desired contradiction.\n\n\\end{itemize}\n\\end{document}", "category": "Number Theory", "source": "PUTNAM", "year": 1995}
{"id": "usamo-2009-q1", "question": "Given circles $\\omega_1$ and $\\omega_2$ intersecting at points $X$ and $Y$,\nlet $\\ell_1$ be a line through the center of $\\omega_1$\nintersecting $\\omega_2$ at points $P$ and $Q$\nand let $\\ell_2$ be a line through the center of $\\omega_2$\nintersecting $\\omega_1$ at points $R$ and $S$.\nProve that if $P$, $Q$, $R$, and $S$ lie on a circle\nthen the center of this circle lies on line $XY$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1485133}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nGiven circles $\\omega_1$ and $\\omega_2$ intersecting at points $X$ and $Y$,\nlet $\\ell_1$ be a line through the center of $\\omega_1$\nintersecting $\\omega_2$ at points $P$ and $Q$\nand let $\\ell_2$ be a line through the center of $\\omega_2$\nintersecting $\\omega_1$ at points $R$ and $S$.\nProve that if $P$, $Q$, $R$, and $S$ lie on a circle\nthen the center of this circle lies on line $XY$.\n\\end{mdframed}\nLet $r_1$, $r_2$, $r_3$ denote the\ncircumradii of $\\omega_1$, $\\omega_2$, and $\\omega_3$, respectively,\nwhere $\\omega_3$ is the circle through $P$, $Q$, $R$, $S$.\n\n\\begin{center}\n\\begin{asy}\npair O_1 = dir(220);\npair O_2 = dir(320);\npair O = dir(110);\npair T = foot(O, O_1, O_2);\npair X = midpoint(O--T);\npair Y = 2*T-X;\n\nfilldraw(CP(O_1, X), opacity(0.1)+lightcyan, lightblue);\nfilldraw(CP(O_2, X), opacity(0.1)+lightcyan, lightblue);\n\ndraw(O--Y, red+dashed);\n\npair K = foot(O_1, O, O_2);\npair P = IP(O_1--K, CP(O_2, X));\npair Q = 2*K-P;\ndraw(O_1--Q, red);\ndraw(O--O_2, heavycyan);\n\npair L = foot(O_2, O, O_1);\npair R = IP(O_2--L, CP(O_1, X));\npair S = 2*L-R;\ndraw(O_2--S, red);\ndraw(O--O_1, heavycyan);\n\ndraw(arc(O, abs(P-O), 180, 360), heavygreen);\n\ndot(\"$O_1$\", O_1, dir(O_1));\ndot(\"$O_2$\", O_2, dir(O_2));\ndot(\"$O$\", O, dir(O));\ndot(\"$X$\", X, dir(100));\ndot(\"$Y$\", Y, dir(Y));\ndot(\"$P$\", P, dir(120));\ndot(\"$Q$\", Q, dir(Q));\ndot(\"$R$\", R, dir(40));\ndot(\"$S$\", S, dir(S));\n\n/* TSQ Source:\n\nO_1 = dir 220\nO_2 = dir 320\nO = dir 110\nT := foot O O_1 O_2\nX = midpoint O--T R100\nY = 2*T-X\n\nCP O_1 X 0.1 lightcyan / lightblue\nCP O_2 X 0.1 lightcyan / lightblue\n\nO--Y red dashed\n\nK := foot O_1 O O_2\nP = IP O_1--K CP O_2 X R120\nQ = 2*K-P\nO_1--Q red\nO--O_2 heavycyan\n\nL := foot O_2 O O_1\nR = IP O_2--L CP O_1 X R40\nS = 2*L-R\nO_2--S red\nO--O_1 heavycyan\n\n!draw(arc(O, abs(P-O), 180, 360), heavygreen);\n\n*/\n\\end{asy}\n\\end{center}\n\nWe wish to show that $O_3$ lies on the radical axis of $\\omega_1$ and $\\omega_2$.\nLet us encode the conditions using power of a point.\nBecause $O_1$ is on the radical axis of $\\omega_2$ and $\\omega_3$,\n\\begin{align*}\n  \\opname{Pow}_{\\omega_2}(O_1) &= \\opname{Pow}_{\\omega_3}(O_1) \\\\\n  \\implies O_1O_2^2 - r_2^2 &= O_1O_3^2 - r_3^2.\n  \\intertext{Similarly, because $O_2$ is on the radical axis of $\\omega_1$ and $\\omega_3$, we have}\n  \\opname{Pow}_{\\omega_1}(O_2) &= \\opname{Pow}_{\\omega_3}(O_2) \\\\\n  \\implies O_1O_2^2 - r_1^2 &= O_2O_3^2 - r_3^2. \\\\\n  \\intertext{Subtracting the two gives}\n  (O_1O_2^2-r_2^2)-(O_1O_2^2-r_1^2) &= (O_1O_3^2-r_3^2)-(O_2O_3^2-r_3^2) \\\\\n  \\implies r_1^2-r_2^2 &= O_1O_3^2-O_2O_3^2 \\\\\n  \\implies O_2O_3^2 - r_2^2 &= O_1O_3^2 - r_1^2 \\\\\n  \\implies \\opname{Pow}_{\\omega_2}(O_3) &= \\opname{Pow}_{\\omega_1} (O_3)\n\\end{align*}\nas desired.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2009}
{"id": "usamo-2009-q2", "question": "Let $n$ be a positive integer.\nDetermine the size of the largest subset of $\\{ -n, -n+1, \\dots, n-1, n\\}$\nwhich does not contain three elements $a$, $b$, $c$ (not necessarily distinct)\nsatisfying $a+b+c=0$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1485139}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n$ be a positive integer.\nDetermine the size of the largest subset of $\\{ -n, -n+1, \\dots, n-1, n\\}$\nwhich does not contain three elements $a$, $b$, $c$ (not necessarily distinct)\nsatisfying $a+b+c=0$.\n\\end{mdframed}\nThe answer is $n$ with $n$ even and $n+1$ with $n$ odd;\nthe construction is to take all odd numbers.\n\nTo prove this is maximal, it suffices to show it for $n$ even;\nwe do so by induction on even $n \\ge 2$ with the base case being trivial.\nLetting $A$ be the subset, we consider three cases:\n\\begin{enumerate}[(i)]\n  \\ii If $|A \\cap \\{-n,-n+1,n-1,n\\}| \\le 2$,\n  then by the hypothesis for $n-2$ we are done.\n  \\ii If both $n \\in A$ and $-n \\in A$,\n  then there can be at most $n-2$ elements in $A \\setminus \\{\\pm n\\}$,\n  one from each of the pairs $(1,n-1)$, $(2,n-2)$, $\\dots$\n  and their negations.\n  \\ii If $n, n-1, -n+1 \\in A$ and $-n \\notin A$,\n  and at most $n-3$ more can be added,\n  one from each of $(1, n-2)$, $(2, n-3)$, $\\dots$\n  and $(-2, -n+2)$, $(-3, -n+3)$, $\\dots$.\n  (In particular $-1 \\notin A$.\n  Analogous case for $-A$ if $n \\notin A$.)\n\\end{enumerate}\nThus in all cases, $|A| \\le n$ as needed.\n\n\\begin{remark*}\n  A few examples of equality cases:\n  \\begin{itemize}\n    \\ii All odd numbers\n    \\ii All numbers with absolute value at least $n/2$\n    \\ii For $n$ even, the set $\\{1, 2, \\dots, n\\}$\n  \\end{itemize}\n  This list isn't exhaustive\n  e.g.\\ for $n=4$, the set $\\{-3,2,3,4\\}$ achieves the optimum.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "USAMO", "year": 2009}
{"id": "usamo-2009-q3", "question": "We define a \\emph{chessboard polygon} to be a simple polygon whose sides are\nsituated along lines of the form $x=a$ or $y=b$, where $a$ and $b$ are integers.\nThese lines divide the interior into unit squares, which are shaded alternately\ngray and white so that adjacent squares have different colors.\nTo tile a chessboard polygon by dominoes is to\nexactly cover the polygon by non-overlapping $ 1 \\times 2$ rectangles.\nFinally, a \\emph{tasteful tiling} is one which avoids the\ntwo configurations of dominoes and colors shown on the left below.\nTwo tilings of a $3 \\times 4$ rectangle are shown;\nthe first one is tasteful, while the second is not,\ndue to the vertical dominoes in the upper right corner.\n\n\\begin{center}\n\\begin{asy}\nsize(300);\npen rt = linewidth(2.5) + rgb(0.6,0.2,0.2);\nvoid chessboard(int a, int b, int eps, pair P) {\n  for(int i = 0; i < a; ++i) {\n  for(int j = 0; j < b; ++j) {\n    if((i+j+eps)#2 == (i+j+eps)/2)\n    fill(shift(P.x+i,P.y+j)*unitsquare,rgb(0.6,0.6,0.6));\n  }\n  }\n  draw(P--P+(a,0)--P+(a,b)--P+(0,b)--cycle, rt);\n}\n\nchessboard(2,2,0,(0,0));\nchessboard(2,2,1,(2.5,0));\nchessboard(4,3,1,(6,0));\nchessboard(4,3,1,(11,0));\nlabel(\"Distasteful tilings\",(2.25,2.5),fontsize(10));\n\n/* draw lines */\ndraw((1,0)--(1,2), rt);\ndraw((2.5,1)--(4.5,1), rt);\ndraw((7,0)--(7,2)--(6,2)--(10,2)--(9,2)--(9,0)--(9,1)--(7,1), rt);\ndraw((8,2)--(8,3), rt);\ndraw((12,0)--(12,2)--(11,2)--(13,2), rt);\ndraw((13,1)--(15,1)--(14,1)--(14,3), rt);\ndraw((13,0)--(13,3), rt);\n\\end{asy}\n\\end{center}\n\nProve that (a) if a chessboard polygon can be tiled by dominoes,\nthen it can be done so tastefully, and (b) such a tasteful tiling is unique.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1485321}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nWe define a \\emph{chessboard polygon} to be a simple polygon whose sides are\nsituated along lines of the form $x=a$ or $y=b$, where $a$ and $b$ are integers.\nThese lines divide the interior into unit squares, which are shaded alternately\ngray and white so that adjacent squares have different colors.\nTo tile a chessboard polygon by dominoes is to\nexactly cover the polygon by non-overlapping $ 1 \\times 2$ rectangles.\nFinally, a \\emph{tasteful tiling} is one which avoids the\ntwo configurations of dominoes and colors shown on the left below.\nTwo tilings of a $3 \\times 4$ rectangle are shown;\nthe first one is tasteful, while the second is not,\ndue to the vertical dominoes in the upper right corner.\n\n\\begin{center}\n\\begin{asy}\nsize(300);\npen rt = linewidth(2.5) + rgb(0.6,0.2,0.2);\nvoid chessboard(int a, int b, int eps, pair P) {\n  for(int i = 0; i < a; ++i) {\n  for(int j = 0; j < b; ++j) {\n    if((i+j+eps)#2 == (i+j+eps)/2)\n    fill(shift(P.x+i,P.y+j)*unitsquare,rgb(0.6,0.6,0.6));\n  }\n  }\n  draw(P--P+(a,0)--P+(a,b)--P+(0,b)--cycle, rt);\n}\n\nchessboard(2,2,0,(0,0));\nchessboard(2,2,1,(2.5,0));\nchessboard(4,3,1,(6,0));\nchessboard(4,3,1,(11,0));\nlabel(\"Distasteful tilings\",(2.25,2.5),fontsize(10));\n\n/* draw lines */\ndraw((1,0)--(1,2), rt);\ndraw((2.5,1)--(4.5,1), rt);\ndraw((7,0)--(7,2)--(6,2)--(10,2)--(9,2)--(9,0)--(9,1)--(7,1), rt);\ndraw((8,2)--(8,3), rt);\ndraw((12,0)--(12,2)--(11,2)--(13,2), rt);\ndraw((13,1)--(15,1)--(14,1)--(14,3), rt);\ndraw((13,0)--(13,3), rt);\n\\end{asy}\n\\end{center}\n\nProve that (a) if a chessboard polygon can be tiled by dominoes,\nthen it can be done so tastefully, and (b) such a tasteful tiling is unique.\n\\end{mdframed}\n\\paragraph{Proof of (a).} This is easier, and by induction.\nLet $\\mathcal P$ denote the chessboard polygon which can be tiled by dominoes.\n\nConsider a \\emph{lower-left} square $s$ of the polygon,\nand WLOG is it white (other case similar).\nThen we have two cases:\n\\begin{itemize}\n  \\ii If there exists a domino tiling of $\\mathcal P$\n  where $s$ is covered by a vertical domino,\n  then delete this domino and apply induction on the rest of $\\mathcal P$.\n  This additional domino will not cause any distasteful tilings.\n\n  \\ii Otherwise, assume $s$ is covered by a horizontal domino\n  in \\emph{every} tiling.\n  Again delete this domino and apply induction on the rest of $\\mathcal P$.\n  The resulting tasteful tiling should not have another horizontal domino\n  adjacent to the one covering $s$, because otherwise\n  we could have replaced that $2 \\times 2$ square\n  with two vertical dominoes to arrive in the first case.\n  So this additional domino will not cause any distasteful tilings.\n\\end{itemize}\n\n\\begin{remark*}\n  The second case can actually arise, for example in the following picture.\n  \\begin{center}\n  \\begin{asy}\n    unitsize(0.6cm);\n    fill(shift(1,0)*unitsquare,rgb(0.6,0.6,0.6));\n    fill(shift(0,1)*unitsquare,rgb(0.6,0.6,0.6));\n    fill(shift(2,1)*unitsquare,rgb(0.6,0.6,0.6));\n    draw( (0,0)--(0,3)--(1,3)--(1,2)--(3,2)--(3,1)--(2,1)--(2,0)--cycle,\n      linewidth(2.5) + rgb(0.6,0.2,0.2));\n  \\end{asy}\n  \\end{center}\n  Thus one cannot just try to cover $s$ with a vertical\n  domino and claim the rest of $\\mathcal P$ is tile-able.\n  So the induction is not as easy as one might hope.\n\n  One can phrase the solution algorithmically too,\n  in the following way: any time we see a distasteful tiling,\n  we rotate it to avoid the bad pattern.\n  The bottom-left corner eventually becomes stable,\n  and an induction shows the termination of the algorithm.\n\\end{remark*}\n\n\\paragraph{Proof of (b).} We now turn to proving uniqueness.\nSuppose for contradiction there are two distinct tasteful tilings.\nOverlaying the two tilings on top of each other induces\nseveral \\emph{cycles} of overlapping dominoes at positions where the tilings differ.\n\nHenceforth, it will be convenient to work with the lattice $\\ZZ^2$,\ntreating the squares as black/white points, and we do so.\nLet $\\gamma$ be any such cycle and let $s$ denote a\nlower left point, and again WLOG it is black.\nOrient $\\gamma$ counterclockwise henceforth.\nRestrict attention to the lattice polygon $\\mathcal Q$ enclosed by $\\gamma$\n(we consider points of $\\gamma$ as part of $\\mathcal Q$).\n\nIn one of the two tilings of (lattice points of) $\\mathcal Q$,\nthe point $s$ will be covered by a horizontal domino;\nin the other tiling $s$ will be covered by a vertical domino.\nFrom now on we will focus only on the latter one.\nObserve that we now have a set of dominoes along $\\gamma$,\nsuch that $\\gamma$ points from the white point to the black point\nwithin each domino.\n\nNow impose coordinates so that $s = (0,0)$.\nConsider the stair-case sequence of points\n$p_0 = s = (0,0)$, $p_1 = (1,0)$, $p_2 = (1,1)$, $p_3 = (2,1)$, and so on.\nBy hypothesis, $p_0$ is covered by a vertical domino.\nThen $p_1$ must be covered by a horizontal domino, to avoid a distasteful tiling.\nThen if $p_2$ is in $\\mathcal Q$, then it must be covered by a vertical domino\nto avoid a distasteful tiling, and so on.\nWe may repeat this argument as long the points $p_i$ lie inside $\\mathcal Q$.\n(See figure below; the staircase sequence is highlighted by red halos.)\n\\begin{center}\n\\begin{asy}\n  unitsize(1.5cm);\n\n  margin m = Margin(3,3);\n  arrowbar ar = EndArrow(TeXHead);\n  pen gamma = blue + 1;\n  draw( (0,0)--(1,0), gamma, ar, m);\n  draw( (1,0)--(2,0), gamma, ar, m);\n  draw( (2,0)--(3,0), gamma, ar, m);\n  draw( (3,0)--(3,-1), gamma, ar, m);\n  draw( (3,-1)--(4,-1), gamma, ar, m);\n  draw( (4,-1)--(4,0), gamma, ar, m);\n  draw( (4,0)--(4,1), gamma, ar, m);\n  draw( (4,1)--(4,2), gamma, ar, m);\n  draw( (4,2)--(3,2), gamma, ar, m);\n  draw( (3,2)--(3,3), gamma, ar, m);\n  draw( (3,3)--(4,3), gamma, ar, m);\n  draw( (4,3)--(4,4), gamma, ar, m);\n  draw( (4,4)--(3,4), gamma, ar, m);\n  draw( (3,4)--(2,4), gamma, ar, m);\n  draw( (2,4)--(1,4), gamma, ar, m);\n  draw( (1,4)--(1,3), gamma, ar, m);\n  draw( (1,3)--(0,3), gamma, ar, m);\n  draw( (0,3)--(0,2), gamma, ar, m);\n  draw( (0,2)--(0,1), gamma, ar, m);\n  draw( (0,1)--(0,0), gamma, ar, m);\n\n  fill( (0,0)--(3,0)--(3,-1)--(4,-1)--(4,2)--(3,2)\n    --(3,3)--(4,3)--(4,4)--(1,4)--(1,3)--(0,3)--cycle,\n    opacity(0.1) + lightcyan);\n  label(\"$s$\", (0,0), 1.5*dir(225));\n  label(\"$a$\", (3,2), 2*dir(45), red);\n  label(\"$b$\", (1,0), 2*dir(225), red);\n  draw( (3,2)--(1,0), lightred);\n\n  real r = 0.07;\n  filldraw(CR( (3,-1), r), gray, black);\n  filldraw(CR( (0,0), r), gray, black);\n  filldraw(CR( (2,0), r), gray, black);\n  filldraw(CR( (4,0), r), gray, black);\n  filldraw(CR( (1,1), r), gray, black);\n  filldraw(CR( (3,1), r), gray, black);\n  filldraw(CR( (0,2), r), gray, black);\n  filldraw(CR( (2,2), r), gray, black);\n  filldraw(CR( (4,2), r), gray, black);\n  filldraw(CR( (1,3), r), gray, black);\n  filldraw(CR( (3,3), r), gray, black);\n  filldraw(CR( (2,4), r), gray, black);\n  filldraw(CR( (4,4), r), gray, black);\n\n  filldraw(CR( (4,-1), r), white, black);\n  filldraw(CR( (1,0), r), white, black);\n  filldraw(CR( (3,0), r), white, black);\n  filldraw(CR( (0,1), r), white, black);\n  filldraw(CR( (2,1), r), white, black);\n  filldraw(CR( (4,1), r), white, black);\n  filldraw(CR( (1,2), r), white, black);\n  filldraw(CR( (3,2), r), white, black);\n  filldraw(CR( (0,3), r), white, black);\n  filldraw(CR( (2,3), r), white, black);\n  filldraw(CR( (4,3), r), white, black);\n  filldraw(CR( (1,4), r), white, black);\n  filldraw(CR( (3,4), r), white, black);\n\n  real s = 3*r;\n  fill(CR( (0,0), s), opacity(0.2)+lightred );\n  fill(CR( (1,0), s), opacity(0.2)+lightred );\n  fill(CR( (1,1), s), opacity(0.2)+lightred );\n  fill(CR( (2,1), s), opacity(0.2)+lightred );\n  fill(CR( (2,2), s), opacity(0.2)+lightred );\n  fill(CR( (3,2), s), opacity(0.2)+lightred );\n\n  pen domino = heavygreen+1.2;\n  path vd = box( (-0.4, -0.4), (0.4, 1.4) );\n  path hd = rotate(-90)*vd;\n  draw(shift(0,0)*vd, domino);\n  draw(shift(1,1)*vd, domino);\n  draw(shift(2,2)*vd, domino);\n  draw(shift(1,0)*hd, domino);\n  draw(shift(2,1)*hd, domino);\n  draw(shift(3,2)*hd, domino);\n\\end{asy}\n\\end{center}\n\nThe curve $\\gamma$ by definition should cross $y=x-1$ at the point $b = (1,0)$.\nLet $a$ denote the first point of this sequence\nafter $p_1$ for which $\\gamma$ \\emph{crosses} $y=x-1$ again.\n\nNow $a$ is tiled by a vertical domino whose black point is to the right of $\\ell$.\nBut the line segment $\\ell$ cuts $\\mathcal Q$ into two parts,\nand the orientation of $\\gamma$ has this path also entering from the right.\nThis contradicts the fact that the orientation of $\\gamma$\npoints only from white to black within dominoes.\nThis contradiction completes the proof.\n\n\\begin{remark*}\n  Note the problem is false if you allow holes\n  (consider a $3 \\times 3$ with the middle square deleted).\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Combinatorics", "source": "USAMO", "year": 2009}
{"id": "usamo-2009-q4", "question": "For $n \\ge 2$, let $a_1$, $a_2$, \\dots, $a_n$ be positive real numbers such that\n\\[\n  \\left( a_1 + a_2 + \\dots + a_n \\right)\n  \\left( \\frac{1}{a_1} + \\frac{1}{a_2} + \\dots + \\frac{1}{a_n} \\right)\n  \\le \\left( n + \\half \\right)^2.\n\\]\nProve that $\\max\\left( a_1, \\dots, a_n \\right) \\le 4 \\min\\left( a_1, \\dots, a_n \\right)$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1485147}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFor $n \\ge 2$, let $a_1$, $a_2$, \\dots, $a_n$ be positive real numbers such that\n\\[\n  \\left( a_1 + a_2 + \\dots + a_n \\right)\n  \\left( \\frac{1}{a_1} + \\frac{1}{a_2} + \\dots + \\frac{1}{a_n} \\right)\n  \\le \\left( n + \\half \\right)^2.\n\\]\nProve that $\\max\\left( a_1, \\dots, a_n \\right) \\le 4 \\min\\left( a_1, \\dots, a_n \\right)$.\n\\end{mdframed}\nAssume $a_1$ is the largest and $a_2$ is the smallest.\nLet $M = a_1/a_2$.\nWe wish to show $M \\le 4$.\n\nIn left-hand side of given, write as $a_2+a_1 + \\dots + a_n$.\nBy Cauchy Schwarz, one obtains\n\\begin{align*}\n  \\left( n+\\half \\right)^2 &\\ge\n    \\left( a_2 + a_1 + a_3 + \\dots + a_n  \\right)\n    \\left( \\frac{1}{a_1} + \\frac{1}{a_2} + \\frac{1}{a_3}\n      + \\dots + \\frac{1}{a_n} \\right) \\\\\n  &\\ge \\left(\\sqrt{\\frac{a_2}{a_1}} + \\sqrt{\\frac{a_1}{a_2}}\n    + 1 + \\dots + 1 \\right)^2 \\\\\n  &\\ge \\left(\\sqrt{1/M} + \\sqrt{M} + (n-2) \\right)^2.\n\\end{align*}\nExpanding and solving for $M$ gives $1/4 \\le M \\le 4$ as needed.\n\\pagebreak", "category": "Algebra", "source": "USAMO", "year": 2009}
{"id": "usamo-2009-q5", "question": "Trapezoid $ABCD$, with $\\ol{AB} \\parallel \\ol{CD}$,\nis inscribed in circle $\\omega$ and point $G$ lies inside triangle $BCD$.\nRays $AG$ and $BG$ meet $\\omega$ again at points $P$ and $Q$, respectively.\nLet the line through $G$ parallel to $\\ol{AB}$ intersect\n$\\ol{BD}$ and $\\ol{BC}$ at points $R$ and $S$, respectively.\nProve that quadrilateral $PQRS$ is cyclic\nif and only if $\\ol{BG}$ bisects $\\angle CBD$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1485200}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nTrapezoid $ABCD$, with $\\ol{AB} \\parallel \\ol{CD}$,\nis inscribed in circle $\\omega$ and point $G$ lies inside triangle $BCD$.\nRays $AG$ and $BG$ meet $\\omega$ again at points $P$ and $Q$, respectively.\nLet the line through $G$ parallel to $\\ol{AB}$ intersect\n$\\ol{BD}$ and $\\ol{BC}$ at points $R$ and $S$, respectively.\nProve that quadrilateral $PQRS$ is cyclic\nif and only if $\\ol{BG}$ bisects $\\angle CBD$.\n\\end{mdframed}\nPerform an inversion around $B$ with arbitrary radius,\nand denote the inverse of a point $Z$ with $Z^\\ast$.\n\n\\begin{center}\n  \\begin{asy}\n    unitsize(2cm);\n    pair A = Drawing(\"A\", dir(130), dir(130));\n    pair B = Drawing(\"B\", dir(50), dir(50));\n    pair C = Drawing(\"C\", dir(-20), dir(-20));\n    pair D = Drawing(\"D\", dir(200), dir(200));\n    pair Q = Drawing(\"Q\", dir(270), dir(270));\n    pair G = Drawing(\"G\", 0.3*Q+0.7*B, 1.414*dir(290));\n    pair R = Drawing(\"R\", extension(B,D,G,G-(1,0)), dir(135));\n    pair S = Drawing(\"S\", extension(B,C,G,G+(1,0)), dir(45));\n    pair P = Drawing(\"P\", 2*foot(origin,A,G)-A, dir(G-A));\n    draw(unitcircle);\n    draw(D--A--B--C--D--B--Q--P--A);\n    draw(R--S);\n    draw(circumcircle(P,Q,R), dashed);\n  \\end{asy}\n  \\quad\n  \\begin{asy}\n    unitsize(2cm);\n    pair B = Drawing(\"B\", dir(130), dir(110));\n    pair R = Drawing(\"R^\\ast\", dir(210), dir(210));\n    pair S = Drawing(\"S^\\ast\", dir(330), dir(330));\n    pair G = Drawing(\"G^\\ast\", dir(270), dir(290));\n    pair D = Drawing(\"D^\\ast\", .6*R+.4*B, 1.414*dir(230));\n    pair C = Drawing(\"C^\\ast\", .6*S+.4*B, 1.414*dir(-90));\n    pair Q = Drawing(\"Q^\\ast\", extension(B,G,C,D), dir(45));\n    pair A = Drawing(\"A^\\ast\", extension(B,2/(B+conj(B)),C,D), dir(180));\n    pair P = Drawing(\"P^\\ast\", 2*foot(circumcenter(A,B,G),C,D)-A,dir(-25));\n    draw(unitcircle);\n    draw(circumcircle(B,C,D));\n    draw(A--P);\n    draw(R--B--S--cycle);\n    draw(G--B);\n    draw(circumcircle(A,B,G));\n    draw(A--B);\n    /*\n    pair X = Drawing(\"X\", 2*foot(origin,P,G)-G, dir(P-G));\n    draw(G--X, dashed);\n    */\n  \\end{asy}\n\\end{center}\n\nAfter inversion, we obtain a cyclic quadrilateral\n$BS^\\ast G^\\ast R^\\ast$ and points $C^\\ast$, $D^\\ast$\non $\\ol{BS^\\ast}$, $\\ol{BR^\\ast}$,\nsuch that $(BC^\\ast D^\\ast)$ is tangent to $(BS^\\ast G^\\ast R^\\ast)$ ---\nin other words, so that $\\ol{C^\\ast D^\\ast}$\nis parallel to $\\ol{S^\\ast R^\\ast}$.\nPoint $A^\\ast$ lies on line $\\ol{C^\\ast D^\\ast}$\nso that $\\ol{A^\\ast B}$ is tangent to $(BS^\\ast G^\\ast R^\\ast)$.\nPoints $P^\\ast$ and $Q^\\ast$ are the\nintersections of $(A^\\ast BG^\\ast)$ and $\\ol{BG^\\ast}$\nwith line $C^\\ast D^\\ast$.\n\nObserve that $P^\\ast Q^\\ast R^\\ast S^\\ast$ is a trapezoid,\nso it is cyclic if and only if it isosceles.\n\nLet $X$ be the second intersection of line $G^\\ast P^\\ast$\nwith $(B S^\\ast R^\\ast)$.  Because\n\\[ \\dang Q^\\ast P^\\ast G^\\ast\n  = \\dang A^\\ast B G^\\ast = \\dang BXG^\\ast \\]\nwe find that $BXS^\\ast R^\\ast$ is an isosceles trapezoid.\n\nIf $G^\\ast$ is indeed the midpoint of the arc\nthen everything is clear by symmetry now.\nConversely, if $P^\\ast R^\\ast = Q^\\ast S^\\ast$ then\nthat means $P^\\ast Q^\\ast R^\\ast S^\\ast$ is a cyclic trapezoid,\nand hence that the perpendicular bisectors of\n$\\ol{P^\\ast Q^\\ast}$ and $\\ol{R^\\ast S^\\ast}$ are the same.\nHence $B$, $X$, $P^\\ast$, $Q^\\ast$ are symmetric around this line.\nThis forces $G^\\ast$ to be the midpoint of arc $R^\\ast S^\\ast$ as desired.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2009}
{"id": "usamo-2009-q6", "question": "Let $s_1, s_2, s_3, \\dots$ be an infinite,\nnonconstant sequence of rational numbers,\nmeaning it is not the case that $s_1 = s_2 = s_3 = \\dots$.\nSuppose that $t_1, t_2, t_3, \\dots$ is also an infinite,\nnonconstant sequence of rational numbers\nwith the property that $(s_i - s_j)(t_i - t_j)$\nis an integer for all $i$ and $j$.\nProve that there exists a rational number $r$\nsuch that $(s_i - s_j)r$ and $(t_i - t_j)/r$\nare integers for all $i$ and $j$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1485204}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $s_1, s_2, s_3, \\dots$ be an infinite,\nnonconstant sequence of rational numbers,\nmeaning it is not the case that $s_1 = s_2 = s_3 = \\dots$.\nSuppose that $t_1, t_2, t_3, \\dots$ is also an infinite,\nnonconstant sequence of rational numbers\nwith the property that $(s_i - s_j)(t_i - t_j)$\nis an integer for all $i$ and $j$.\nProve that there exists a rational number $r$\nsuch that $(s_i - s_j)r$ and $(t_i - t_j)/r$\nare integers for all $i$ and $j$.\n\\end{mdframed}\nFirst we eliminate the silly edge case:\n\\begin{claim*}\n  For some $i$ and $j$, we have\n  $(s_i - s_j)(t_i - t_j) \\neq 0$.\n\\end{claim*}\n\\begin{proof}\n  Assume not.\n  WLOG $s_1 \\neq s_2$, then $t_1 = t_2$.\n  Now select $i$ such that $t_i \\neq t_1 = t_2$.\n  Then either $t_i - s_1 \\neq 0$\n  or $t_i - s_2 \\neq 0$, contradiction.\n\\end{proof}\n\nSo, WLOG (by permutation) that $n = (s_1-s_2)(t_1-t_2) \\neq 0$.\nBy shifting and scaling appropriately,\nwe may assume\n\\[ s_1 = t_1 = 0, \\quad s_2 = 1, \\quad t_2 = n. \\]\nThus we deduce \\[ s_i t_i \\in \\ZZ, \\quad s_i t_j + s_j t_i \\in \\ZZ\n  \\qquad \\forall i,j. \\]\n\n\\begin{claim*}\n  For any index $i$,\n  $t_i \\in \\ZZ$, $s_i \\in \\frac 1n \\ZZ$.\n\\end{claim*}\n\\begin{proof}\n  We have $s_i t_i \\in \\ZZ$\n  and $t_i + n s_i \\in \\ZZ$ by problem condition.\n  By looking at $\\nu_p$ of this,\n  we conclude $ns_i, t_i \\in \\ZZ$\n  (since if either as negative $p$-adic value,\n  so does the other, and then $s_i t_i \\notin \\ZZ$).\n\\end{proof}\n\nLast claim:\n\\begin{claim*}\n  If $d = \\gcd t_\\bullet$, then $ds_i \\in \\ZZ$ for all $i$.\n\\end{claim*}\n\\begin{proof}\n  Consider a prime $p \\mid n$, and let $e = \\nu_p(t_j)$.\n  We will show $\\nu_p(s_i) \\ge -e$ for any $i$.\n\n  This is already true for $i = j$,\n  so assume $i \\neq j$.\n  Assume for contradiction $\\nu_p(s_i) < -e$.\n  Then $\\nu_p(t_i) > e = \\nu_p(t_k)$.\n  Since $\\nu_p(s_k) \\ge -e$ we deduce\n  $\\nu_p(s_i t_k) < \\nu_p(s_k t_i)$;\n  so $\\nu_p(s_i t_k) \\ge 0$ and $\\nu_p(s_i) \\ge -e$ as desired.\n\\end{proof}\n\\pagebreak\n\n\n\\end{document}", "category": "Number Theory", "source": "USAMO", "year": 2009}
{"id": "imo-1997-q1", "question": "In the plane there is an infinite chessboard.\nFor any pair of positive integers $m$ and $n$,\nconsider a right-angled triangle with vertices at lattice points\nand whose legs, of lengths $m$ and $n$, lie along edges of the squares.\nLet $S_1$ be the total area of the black part of the triangle\nand $S_2$ be the total area of the white part.\nLet $f(m,n) = | S_1 - S_2 |$.\n\n\\begin{enumerate}[(a)]\n  \\ii Calculate $f(m,n)$ for all positive integers $m$ and $n$\n  which are either both even or both odd.\n  \\ii Prove that $f(m,n) \\leq \\frac 12 \\max \\{m,n\\}$ for all $m$ and $n$.\n  \\ii Show that there is no constant $C$\n  such that $f(m,n) < C$ for all $m$ and $ n$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p356696}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nIn the plane there is an infinite chessboard.\nFor any pair of positive integers $m$ and $n$,\nconsider a right-angled triangle with vertices at lattice points\nand whose legs, of lengths $m$ and $n$, lie along edges of the squares.\nLet $S_1$ be the total area of the black part of the triangle\nand $S_2$ be the total area of the white part.\nLet $f(m,n) = | S_1 - S_2 |$.\n\n\\begin{enumerate}[(a)]\n  \\ii Calculate $f(m,n)$ for all positive integers $m$ and $n$\n  which are either both even or both odd.\n  \\ii Prove that $f(m,n) \\leq \\frac 12 \\max \\{m,n\\}$ for all $m$ and $n$.\n  \\ii Show that there is no constant $C$\n  such that $f(m,n) < C$ for all $m$ and $ n$.\n\\end{enumerate}\n\\end{mdframed}\nIn general, we say the \\emph{discrepancy} of a region in the plane\nequals its black area minus its white area.\nWe allow negative discrepancies,\nso discrepancy is additive and $f(m,n)$ equals the absolute value\nof the discrepancy of a right triangle with legs $m$ and $n$.\n\nFor (a), the answers are $0$ and $1/2$ respectively.\nTo see this, consider the figure shown below.\n\\begin{center}\n\\begin{asy}\n  size(8cm);\n  pair A = (0,5);\n  pair B = (9,0);\n  pair M = midpoint(A--B);\n  for (int i=0; i<=5; ++i) {\n    draw( (0,i)--(9,i), gray );\n  }\n  for (int j=0; j<=9; ++j) {\n    draw( (j,0)--(j,5), gray );\n  }\n  dot(\"$M$\", M, dir(50));\n  dot(\"$A$\", A, dir(90));\n  dot(\"$B$\", B, dir(0));\n  dot(\"$C$\", (0,0), dir(180));\n  filldraw(A--B--(0,0)--cycle, opacity(0.1)+yellow, black+1.5);\n  pair P = (0,2.5);\n  pair Q = (9,2.5);\n  dot(\"$P$\", P, dir(180));\n  dot(\"$Q$\", Q, dir(0));\n  draw(P--Q--B, blue+1.5);\n\\end{asy}\n\\end{center}\nNotice that triangles $APM$ and $BQM$ are congruent,\nand when $m \\equiv n \\pmod 2$, their colorings actually coincide.\nSo, the discrepancy of the triangle\nis exactly equal to the discrepancy of $CPQB$, which is an $m \\times n/2$\nrectangle and hence equal to $0$ or $1/2$ according to parity.\n\nFor (b), note that a triangle with legs $m$ and $n$, with $m$ even and $n$ odd,\ncan be dissected into one right triangle with legs $m$ and $n-1$\nplus a thin triangle of area $1/2$ which has height $m$ and base $1$.\nThe former region has discrepancy $0$ by (a),\nand the latter region obviously has discrepancy at most its area of $m/2$,\nhence $f(m,n) \\le m/2$ as needed.\n(An alternative slower approach, which requires a few cases,\nis to prove that two adjacent columns have at most discrepancy $1/2$.)\n\nFor (c), we prove:\n\\begin{claim*}\n  For each $k \\ge 1$, we have\n  \\[ f(2k, 2k+1)  = \\frac{2k-1}{6}. \\]\n\\end{claim*}\n\\begin{proof}\nAn illustration for $k=2$ is shown below,\nwhere we use $(0,0)$, $(0,2k)$, $(2k+1,0)$ as the three vertices.\n\\begin{center}\n\\begin{asy}\n  size(8cm);\n  fill( (0,4)--(5,0)--(5,4)--cycle, palered );\n  draw(box( (0,0), (5,4) ), black);\n  fill( (0,3)--(1,3)--(1,3.2)--(0,4)--cycle, gray);\n  fill( (1,2)--(2,2)--(2,2.4)--(1.25,3)--(1,3)--cycle, gray);\n  fill( (2,1)--(3,1)--(3,1.6)--(2.50,2)--(2,2)--cycle, gray);\n  fill( (3,0)--(4,0)--(4,0.8)--(3.75,1)--(3,1)--cycle, gray);\n  fill(shift(1,0)*unitsquare, gray);\n  fill(shift(0,1)*unitsquare, gray);\n  for (int i=1; i<4; ++i) {\n    draw( (0,i)--(5,i), gray );\n  }\n  for (int i=1; i<5; ++i) {\n    draw( (i,0)--(i,4), gray );\n  }\n  draw( (0,4)--(5,0)--(0,0)--cycle, blue+2 );\n\\end{asy}\n\\end{center}\nWLOG, the upper-left square is black, as above.\nThe $2k$ small white triangles just below the diagonal have area sum\n\\[ \\frac12 \\cdot \\frac{1}{2k+1} \\cdot \\frac{1}{2k}\n  \\left[ 1^2 + 2^2 + \\dots + (2k)^2 \\right] = \\frac{4k+1}{12} \\]\nThe area of the $2k$ black polygons sums just below the diagonal to\n\\[ \\sum_{i=1}^{2k} \\left( 1\n    - \\frac12 \\cdot \\frac{1}{2k+1} \\cdot \\frac{1}{2k} \\cdot i^2 \\right)\n  = 2k - \\frac{4k+1}{12} = \\frac{20k-1}{12}. \\]\nFinally, in the remaining $1+2+\\dots+2k$ squares,\nthere are $k$ more white squares than black squares.\nSo, it follows\n\\[ f(2k, 2k+1)\n    = \\left\\lvert -k + \\frac{20k-1}{12} - \\frac{4k+1}{12} \\right\\rvert\n    = \\frac{2k-1}{6}. \\]\n\\end{proof}\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 1997}
{"id": "imo-1997-q2", "question": "Let $ABC$ be a triangle with $\\angle A < \\min(\\angle B, \\angle C)$.\nThe points $B$ and $C$ divide the circumcircle of the triangle into two arcs.\nLet $U$ be an interior point of the arc between $B$ and $C$ which does not contain $A$.\nThe perpendicular bisectors of $ AB$ and $ AC$ meet the line $AU$ at $V$ and $W$, respectively.\nThe lines $BV$ and $CW$ meet at $T$.\n\nShow that $AU = TB + TC$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p356701}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle with $\\angle A < \\min(\\angle B, \\angle C)$.\nThe points $B$ and $C$ divide the circumcircle of the triangle into two arcs.\nLet $U$ be an interior point of the arc between $B$ and $C$ which does not contain $A$.\nThe perpendicular bisectors of $ AB$ and $ AC$ meet the line $AU$ at $V$ and $W$, respectively.\nThe lines $BV$ and $CW$ meet at $T$.\n\nShow that $AU = TB + TC$.\n\\end{mdframed}\nLet $\\ol{BTV}$ meet the circle again at $U_1$,\nso that $AU_1 UB$ is an isosceles trapezoid.\nDefine $U_2$ similarly.\n\n\\begin{center}\n\\begin{asy}\npair A = dir(110);\npair B = dir(230);\npair C = dir(310);\npair U = dir(250);\npair U_1 = A*B/U;\npair U_2 = A*C/U;\npair T = extension(B, U_1, C, U_2);\nfilldraw(unitcircle, opacity(0.1)+lightcyan, blue);\nfilldraw(A--B--C--cycle, opacity(0.1)+lightred, red);\ndraw(A--U, deepgreen);\ndraw(C--U_2, deepgreen);\ndraw(B--U_1, deepgreen);\ndraw(B--U_2, red);\ndraw(U_1--U--U_2, red);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$U$\", U, dir(U));\ndot(\"$U_1$\", U_1, dir(U_1));\ndot(\"$U_2$\", U_2, dir(U_2));\ndot(\"$T$\", T, dir(T));\n\n/* TSQ Source:\n\nA = dir 110\nB = dir 230\nC = dir 310\nU = dir 250\nU_1 = A*B/U\nU_2 = A*C/U\nT = extension B U_1 C U_2\nunitcircle 0.1 lightcyan / blue\nA--B--C--cycle 0.1 lightred / red\nA--U deepgreen\nC--U_2 deepgreen\nB--U_1 deepgreen\n\n*/\n\\end{asy}\n\\end{center}\nNow from the isosceles trapezoids we get\n\\[ AU = BU_1 = BT + TU_1 = BT + TC \\]\nas desired.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 1997}
{"id": "imo-1997-q3", "question": "Let $x_1$, $x_2$, \\dots, $x_n$ be real numbers satisfying the conditions:\n\\begin{align*}\n  |x_1 + x_2 + \\dots + x_n| &= 1 \\\\\n  |x_i| &\\le \\frac{n+1}{2} \\qquad \\text{for } i= 1,2, \\dots, n\n\\end{align*}\nShow that there exists a permutation $y_1$, $y_2$, \\dots, $y_n$\nof $x_1$, $x_2$, \\dots, $x_n$ such that\n\\[ | y_1 + 2 y_2 + \\dotsb + n y_n | \\leq \\frac {n + 1}{2}. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p356706}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $x_1$, $x_2$, \\dots, $x_n$ be real numbers satisfying the conditions:\n\\begin{align*}\n  |x_1 + x_2 + \\dots + x_n| &= 1 \\\\\n  |x_i| &\\le \\frac{n+1}{2} \\qquad \\text{for } i= 1,2, \\dots, n\n\\end{align*}\nShow that there exists a permutation $y_1$, $y_2$, \\dots, $y_n$\nof $x_1$, $x_2$, \\dots, $x_n$ such that\n\\[ | y_1 + 2 y_2 + \\dotsb + n y_n | \\leq \\frac {n + 1}{2}. \\]\n\\end{mdframed}\nWLOG $\\sum x_i = 1$ (by negating $x_i$) and $x_1 \\le x_2 \\le \\dots \\le x_n$.\nNotice that\n\\begin{itemize}\n\\ii The largest possible value of the sum in question is\n\\[ A = x_1 + 2x_2 + 3x_3 + \\dots + nx_n. \\]\nwhile the smallest value is\n\\[ B = nx_1 + (n-1)x_2 + \\dots + x_n. \\]\n\\ii Meanwhile, the \\emph{average} value across all permutations is\n\\[ 1 \\cdot \\frac1n + 2 \\cdot \\frac1n + \\dots + n \\cdot \\frac1n = \\frac{n+1}{2}. \\]\n\\end{itemize}\n\nNow imagine we transform the sum $A$ to the sum $B$,\none step at a time, by swapping adjacent elements.\nEvery time we do a swap of two neighboring $u \\le v$, the sum decreases by\n\\[ (iu + (i+1)v) - (iv + (i+1)u) = v-u \\le n+1. \\]\n\nWe want to prove we land in the interval\n\\[ I = \\left[ -\\frac{n+1}{2}, \\frac{n+1}{2} \\right] \\]\nat some point during this transformation.\nBut since $B \\le \\frac{n+1}{2} \\le A$ (since $\\frac{n+1}{2}$ was the average)\nand our step sizes were at most the length of the interval $I$,\nthis is clear.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Combinatorics", "source": "IMO", "year": 1997}
{"id": "imo-1997-q4", "question": "An $n \\times n$ matrix whose entries come\nfrom the set $S = \\{1, 2, \\dots , 2n - 1\\}$\nis called a \\emph{silver} matrix if,\nfor each $i = 1, 2, \\dots , n$,\nthe $i$-th row and the $i$-th column together\ncontain all elements of $S$. Show that:\n\\begin{enumerate}[(a)]\n\\ii there is no silver matrix for $n = 1997$;\n\\ii silver matrices exist for infinitely many values of $n$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p611}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nAn $n \\times n$ matrix whose entries come\nfrom the set $S = \\{1, 2, \\dots , 2n - 1\\}$\nis called a \\emph{silver} matrix if,\nfor each $i = 1, 2, \\dots , n$,\nthe $i$-th row and the $i$-th column together\ncontain all elements of $S$. Show that:\n\\begin{enumerate}[(a)]\n\\ii there is no silver matrix for $n = 1997$;\n\\ii silver matrices exist for infinitely many values of $n$.\n\\end{enumerate}\n\\end{mdframed}\n\\paragraph{Solution to (a)}.\nDefine a \\emph{cross} to be the union of the $i$th row and $i$th column.\nEvery cell of the matrix not on the diagonal is contained in exactly two crosses,\nwhile each cell on the diagonal is contained in one cross.\n\nOn the other hand, if a silver matrix existed for $n=1997$,\nthen each element of $S$ appears in all $1997$ crosses.\nSince $1997$ is odd, each number $s \\in S$ must appear on the diagonal an odd number of times.\n(For example, $s$ could appear on the diagonal once and off-diagonal $998$ times,\nor on the diagonal three times and off-diagonal $997$ times, etc.)\nIn particular, each number $s$ appears at least once on the diagonal.\n\nHowever, $|S| = 3993$ while there are only $1997$ diagonal cells.\nThis is a contradiction.\n\n\\paragraph{Solution to (b)}.\nWe construct a silver matrix $M_e$ for $n = 2^e$ for each $e \\ge 1$.\nWe write the first three explicitly for concreteness:\n\\begin{align*}\n  M_1 &= \\begin{bmatrix}\n    1 & 2 \\\\ 3 & 1\n  \\end{bmatrix} \\\\\n  M_2 &= \\begin{bmatrix}\n    {\\color{red}1} & {\\color{red}2} & 4 & 5 \\\\\n    {\\color{red}3} & {\\color{red}1} & 6 & 7 \\\\\n    7 & 5 & {\\color{red}1} & {\\color{red}2} \\\\\n    6 & 4 & {\\color{red}3} & {\\color{red}1}\n  \\end{bmatrix} \\\\\n  M_3 &= \\begin{bmatrix}\n    {\\color{red}1} & {\\color{red}2} & {\\color{red}4} & {\\color{red}5} & 8 & 9 & 11 & 12\\\\\n    {\\color{red}3} & {\\color{red}1} & {\\color{red}6} & {\\color{red}7} & 10 & 15 & 13 & 14 \\\\\n    {\\color{red}7} & {\\color{red}5} & {\\color{red}1} & {\\color{red}2} & 14 & 12 & 8 & 9 \\\\\n    {\\color{red}6} & {\\color{red}4} & {\\color{red}3} & {\\color{red}1} & 13 & 11 & 10 & 15 \\\\\n    15 & 9 & 11 & 12 & {\\color{red}1} & {\\color{red}2} & {\\color{red}4}\n    & {\\color{red}5} \\\\\n    10 & 8 & 13 & 14 & {\\color{red}3} & {\\color{red}1} & {\\color{red}6}\n    & {\\color{red}7} \\\\\n    14 & 12 & 15 & 9 & {\\color{red}7} & {\\color{red}5} & {\\color{red}1}\n    & {\\color{red}2} \\\\\n    13 & 11 & 10 & 8 & {\\color{red}6} & {\\color{red}4} & {\\color{red}3}\n    & {\\color{red}1} \\\\\n  \\end{bmatrix}\n\\end{align*}\nThe construction is described recursively as follows.\nLet\n\\[\n  M_e' = \\left[\n  \\begin{array}{c|c}\n    {\\color{red}M_{e-1}} & M_{e-1} + (2^e-1) \\\\ \\hline\n    M_{e-1} + (2^e-1) & {\\color{red}M_{e-1}} \\\\\n  \\end{array}\n  \\right].\n\\]\nThen to get from $M_e'$ to $M_e$,\nreplace half of the $2^e$'s with $2^{e+1}-1$:\nin the northeast quadrant, the even-indexed ones,\nand in the southwest quadrant, the odd-indexed ones.\n\n\\begin{remark*}\n  In fact, it turns out silver matrices exist for all even dimensions.\n  A claimed proof is outlined at \\url{https://aops.com/community/p7375020}.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "IMO", "year": 1997}
{"id": "imo-1997-q5", "question": "Find all pairs $(a,b)$ of positive integers satisfying\n\\[ a^{b^2} = b^a. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p3845}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all pairs $(a,b)$ of positive integers satisfying\n\\[ a^{b^2} = b^a. \\]\n\\end{mdframed}\nThe answer is $(1,1)$, $(16,2)$ and $(27,3)$.\n\nWe assume $a,b > 1$ for convenience.\nLet $T$ denote the set of non perfect powers other than $1$.\n\\begin{claim*}\nEvery integer greater than $1$\nis uniquely of the form $t^n$ for some $t \\in T$, $n \\in \\NN$.\n\\end{claim*}\n\\begin{proof}\n  Clear.\n\\end{proof}\n\nLet $a = s^m$, $b = t^n$.\n\\[ s^{m \\cdot (t^n)^2} = t^{n \\cdot s^m}. \\]\nHence $s = t$ and we have\n\\[ m \\cdot t^{2n} = n \\cdot t^m\n  \\implies t^{2n-m} = \\frac nm. \\]\nLet $n = t^e m$ and $2 \\cdot t^e m - m = e$, or\n\\[ e + m = 2t^e \\cdot m. \\]\nWe resolve this equation by casework\n\\begin{itemize}\n  \\ii If $e > 0$, then $2t^e \\cdot m > 2e \\cdot m > e+m$.\n  \\ii If $e=0$ we have $m=n$ and $m = 2m$, contradiction.\n  \\ii If $e = -1$ we apparently have\n  \\[ \\frac{2}{t} \\cdot m = m-1 \\implies\n    m = \\frac{t}{t-2} \\]\n  so $(t,m) = (3,3)$ or $(t,m) = (4,2)$.\n  \\ii If $e = -2$ we apparently have\n  \\[ \\frac{2}{t^2} \\cdot m = m - 2\n    \\implies m = \\frac{2}{1 - 2/t^2} = \\frac{2t^2}{t^2-2}. \\]\n  This gives $(t,m) = (2,2)$.\n  \\ii If $e \\le -3$ then let $k = -e \\ge 3$, so the equation is\n  \\[ m-k = \\frac{2m}{t^k}\n  \\iff m = \\frac{k \\cdot t^k}{t^k-2}\n    = k + \\frac{2k}{t^k-2}. \\]\n  However, for $k \\ge 3$ and $t \\ge 2$,\n  we always have $2k \\le t^k - 2$,\n  with equality only when $(t,k) = (2,3)$;\n  this means $m=4$, which is not a new solution.\n\\end{itemize}\n\\pagebreak", "category": "Number Theory", "source": "IMO", "year": 1997}
{"id": "imo-1997-q6", "question": "For each positive integer $n$,\nlet $f(n)$ denote the number of ways of representing $n$\nas a sum of powers of 2 with nonnegative integer exponents.\nRepresentations which differ only in the ordering\nof their summands are considered to be the same.\nFor instance, $f(4) = 4$,\nbecause the number $4$ can be represented in the following four ways:\n$4$; $2+2$; $2+1+1$; $1+1+1+1$.\n\nProve that for any integer $n \\geq 3$\nwe have $2^{\\frac{n^2}{4}} < f(2^n) < 2^{\\frac{n^2}2}$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p356713}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFor each positive integer $n$,\nlet $f(n)$ denote the number of ways of representing $n$\nas a sum of powers of 2 with nonnegative integer exponents.\nRepresentations which differ only in the ordering\nof their summands are considered to be the same.\nFor instance, $f(4) = 4$,\nbecause the number $4$ can be represented in the following four ways:\n$4$; $2+2$; $2+1+1$; $1+1+1+1$.\n\nProve that for any integer $n \\geq 3$\nwe have $2^{\\frac{n^2}{4}} < f(2^n) < 2^{\\frac{n^2}2}$.\n\\end{mdframed}\nIt's clear that $f$ is non-decreasing.\nBy sorting by the number of $1$'s we used,\nwe have the equation\n\\[ f(N) =\n  f\\left( \\left\\lfloor \\frac N2 \\right\\rfloor \\right)\n  +  f\\left( \\left\\lfloor \\frac N2 \\right\\rfloor -1 \\right)\n  +  f\\left( \\left\\lfloor \\frac N2 \\right\\rfloor -2 \\right)\n  + \\dots\n  + f(1) + f(0). \\quad (\\bigstar)\n\\]\n\n\\paragraph{Upper bound.}\nWe now prove the upper bound by induction.\nIndeed, the base case is trivial and for the inductive step\nwe simply use $(\\bigstar)$:\n\\[ f(2^n) = f(2^{n-1}) + f(2^{n-1}-1) + \\dots\n  < 2^{n-1} f(2^{n-1})\n  < 2^{n-1} \\cdot 2^{\\frac{(n-1)^2}{2}}\n  = 2^{\\frac{n^2}{2} - \\half}.\n\\]\n\n\\paragraph{Lower bound.}\nFirst, we contend that $f$ is convex.\nWe'll first prove this in the even case\nto save ourselves some annoyance:\n\\begin{claim*}\n  [$f$ is basically convex]\n  If $2 \\mid a+b$ then\n  we have $f(2a) + f(2b) \\ge 2 f\\left( a+b \\right)$.\n\\end{claim*}\n\\begin{proof}\n  Since $f(2k+1) = f(2k)$, we will only prove the first equation.\n  Assume WLOG $a \\ge b$ and use\n  $(\\bigstar)$ on all three $f$ expressions here;\n  after subtracting repeated terms, the inequality then rewrites as\n  \\[ \\sum_{(a+b)/2 \\le x \\le a} f(x)\n    \\ge \\sum_{b \\le x \\le (a+b)/2} f(x). \\]\n  This is true since there are an equal number of terms on each side\n  and $f$ is nondecreasing.\n\\end{proof}\n\\begin{claim*}\n  For each $1 \\le k < 2^{n-1}$, we have\n  \\[ f(2^{n-1} - k) + f(k+1) \\ge 2f(2^{n-2}) \\]\n\\end{claim*}\n\\begin{proof}\n  Use the fact that $f(2t+1)=f(2t)$ for all $t$\n  and then apply convexity as above.\n\\end{proof}\nNow we can carry out the induction:\n\\[ f(2^n) = f(2^{n-1}) + f(2^{n-1}-1) + \\dots\n  > 2^{n-1} f(2^{n-2}) + f(0)\n  > 2^{n-1} 2^{\\frac{(n-2)^2}{4}} = 2^{\\frac{n^2}{4}}.\n\\]\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "IMO", "year": 1997}
{"id": "putnam-2017-a1", "question": "Let $S$ be the smallest set of positive integers such that\n\\begin{enumerate}", "solution": "We claim that the positive integers not in $S$ are $1$ and all multiples of $5$. If $S$ consists of all other natural numbers, then $S$ satisfies the given conditions: note that the only perfect squares not in $S$ are $1$ and numbers of the form $(5k)^2$ for some positive integer $k$, and it readily follows that both (b) and (c) hold.\n\n\nNow suppose that $T$ is another set of positive integers satisfying (a), (b), and (c). Note from (b) and (c) that if $n \\in T$ then $n+5 \\in T$, and so $T$ satisfies the following property: \n\\begin{itemize}", "category": "Combinatorics", "source": "PUTNAM", "year": 2017}
{"id": "putnam-2017-a2", "question": "Let $Q_0(x) = 1$, $Q_1(x) = x$, and\n\\[\nQ_n(x) = \\frac{(Q_{n-1}(x))^2 - 1}{Q_{n-2}(x)}\n\\]\nfor all $n \\geq 2$. Show that, whenever $n$ is a positive integer, $Q_n(x)$ is equal to a polynomial with integer coefficients.", "solution": "\\textbf{First solution.}\nDefine $P_n(x)$ for $P_0(x) = 1$, $P_1(x) = x$, and $P_n(x) = x \nP_{n-1}(x)-P_{n-2}(x)$. We claim that $P_n(x) = Q_n(x)$ for all $n \\geq 0$;\nsince $P_n(x)$ clearly is a polynomial \nwith integer coefficients for all $n$, this will imply the desired result.\n\n Since $\\{P_n\\}$ and $\\{Q_n\\}$ are \nuniquely determined by their respective recurrence relations and the \ninitial conditions $P_0,P_1$ or $Q_0,Q_1$, it suffices to check that \n$\\{P_n\\}$ satisfies the same recurrence as $Q$: that is, \n$(P_{n-1}(x))^2-P_n(x)P_{n-2}(x) = 1$ for all $n \\geq 2$. Here is one \nproof of this: for $n \\geq 1$, define the $2\\times 2$ matrices \n\\[\nM_n = \n\\begin{pmatrix} P_{n-1}(x) & P_n (x) \\\\ P_{n-2}(x) & \nP_{n-1}(x) \\end{pmatrix}, \\quad T = \\begin{pmatrix} x & -1 \\\\ 1 & 0 \\end{pmatrix}\n\\]\nwith $P_{-1}(x) = 0$ (this value being consistent with the recurrence).\nThen $\\det(T) = 1$ and $T M_{n} = M_{n+1}$, so by induction on $n$ we have\n\\[\n(P_{n-1}(x))^2-P_n(x)P_{n-2}(x) = \\det(M_n) = \n\\det(M_1) = 1.\n\\]\n\n\\noindent\n\\textbf{Remark:}\nA similar argument shows that any second-order linear recurrent sequence also satisfies a quadratic second-order recurrence relation.\nA familiar example is the identity $F_{n-1} F_{n+1} - F_n^2 = (-1)^{n}$ for $F_n$ the $n$-th Fibonacci number. \nMore examples come from various classes of \\emph{orthogonal polynomials}, including the Chebyshev polynomials mentioned below.\n\n\\noindent\n\\textbf{Second solution.}\nWe establish directly that $Q_n(x) = x \nQ_{n-1}(x)-Q_{n-2}(x)$, which again suffices. \nFrom the equation\n\\[\n1 = Q_{n-1}(x)^2 - Q_n(x) Q_{n-2}(x) = Q_n(x)^2 - Q_{n+1}(x) Q_{n-1}(x)\n\\]\nwe deduce that\n\\[\nQ_{n-1}(x)(Q_{n-1}(x) + Q_{n+1}(x)) = Q_n(x) (Q_n(x) + Q_{n-2}(x)).\n\\]\nSince $\\deg(Q_n(x)) = n$ by an obvious induction, the polynomials $Q_n(x)$ are all nonzero. We may thus rewrite the previous equation as\n\\[\n\\frac{Q_{n+1}(x) + Q_{n-1}(x)}{Q_n(x)} = \\frac{Q_n(x) + Q_{n-2}(x)}{Q_{n-1}(x)},\n\\]\nmeaning that the rational functions $\\frac{Q_n(x) + Q_{n-2}(x)}{Q_{n-1}(x)}$\nare all equal to a constant value. By taking $n=2$ and computing from the definition that $Q_2(x) = x^2-1$,\nwe find the constant value to be $x$; this yields the desired recurrence.\n\n\\noindent\n\\textbf{Remark:}\nBy induction, one may also obtain the explicit formula\n\\[\nQ_n(x) = \\sum_{k=0}^{\\lfloor n/2 \\rfloor} (-1)^k \\binom{n-k}{k} x^{n-2k}.\n\\]\n\n\\noindent\n\\textbf{Remark:}\nIn light of the explicit formula for $Q_n(x)$,\nKarl Mahlburg suggests the following bijective interpretation of the identity\n$Q_{n-1}(x)^2 - Q_n(x) Q_{n-2}(x) = 1$.\nConsider the set $C_n$ of integer compositions of $n$ with all parts 1 or 2; \nthese are ordered tuples $(c_1, \\dots, c_k)$ such that $c_1 + \\cdots + c_k = n$ and $c_i  \\in \\{1,2\\}$ for all $i$.\nFor a given composition $c$, let $o(c)$ and $d(c)$ denote the number of 1's and 2's, respectively.\nDefine the generating function\n\\[\nR_n(x) = \\sum_{c \\in C_n} x^{o(c)};\n\\]\nthen $R_n(x) = \\sum_{j} \\binom{n-j}{j} x^{n-2j}$, so that $Q_n(x) = i^{-n/2} R_n(ix)$.\n(The polynomials $R_n(x)$ are sometimes called \\emph{Fibonacci polynomials}; they satisfy $R_n(1) = F_n$.\nThis interpretation of $F_n$ as the cardinality of $C_n$ first arose in the study of Sanskrit prosody, specifically the analysis of a line of verse as a sequence of long and short syllables, at least 500 years prior to\nthe work of Fibonacci.)\n\nThe original identity is equivalent to the identity\n\\[\nR_{n+1}(x) R_{n-1}(x) - R_n(x)^2 = (-1)^{n-1}.\n\\]\nThis follows because if we identify the composition $c$ with a tiling of a $1 \\times n$ rectangle by $1 \\times 1$ squares and $1 \\times 2$ dominoes, it is \\emph{almost} a bijection to place two tilings of length $n$ on top of each other, offset by one square, and hinge at the first possible point (which is the first square in either). This only fails when both tilings are all dominoes, which gives the term $(-1)^{n-1}$.\n\n\\noindent\n\\textbf{Remark:}\nThis problem appeared on the 2012 India National Math Olympiad; see\n\\url{https://artofproblemsolving.com/community/c6h1219629}.\nAnother problem based on the same idea is problem A2 from the 1993 Putnam.", "category": "Algebra", "source": "PUTNAM", "year": 2017}
{"id": "putnam-2017-a3", "question": "Let $a$ and $b$ be real numbers with $a<b$, and let $f$ and $g$ be continuous functions from $[a,b]$ to $(0, \\infty)$\nsuch that $\\int_a^b f(x)\\,dx = \\int_a^b g(x)\\,dx$ but $f \\neq g$. For every positive integer $n$, define\n\\[\nI_n = \\int_a^b \\frac{(f(x))^{n+1}}{(g(x))^n}\\,dx.\n\\]\nShow that $I_1, I_2, I_3, \\dots$ is an increasing sequence with $\\lim_{n \\to \\infty} I_n = \\infty$.", "solution": "\\textbf{First solution.}\nExtend the definition of $I_n$ to $n=0$, so that $I_0 = \\int_a^b f(x)\\,dx > 0$. Since $\\int_a^b (f(x)-g(x))\\,dx = 0$, we have\n\\begin{align*}\nI_1-I_0 &= \\int_a^b \\frac{f(x)}{g(x)}(f(x)-g(x)) \\, dx \\\\\n&= \\int_a^b \\frac{(f(x)-g(x))^2}{g(x)} \\,dx > 0,\n\\end{align*}\nwhere the inequality follows from the fact that the integrand is a nonnegative continuous function on $[a,b]$ that is not identically $0$. Now for $n \\geq 0$, the Cauchy--Schwarz inequality gives\n\\begin{align*}\nI_n I_{n+2} &= \\left( \\int_a^b \\frac{(f(x))^{n+1}}{(g(x))^n}\\,dx \\right) \\left( \\int_a^b \\frac{(f(x))^{n+3}}{(g(x))^{n+2}}\\,dx \\right) \\\\\n&\\geq \\left(\\int_a^b \\frac{(f(x))^{n+2}}{(g(x))^{n+1}}\\,dx \\right)^2 = I_{n+1}^2.\n\\end{align*}\nIt follows that the sequence $\\{I_{n+1}/I_n\\}_{n=0}^\\infty$ is nondecreasing. Since $I_1/I_0>1$, this implies that $I_{n+1}>I_n$ for all $n$; also,\n$I_n/I_0 = \\prod_{k=0}^{n-1} (I_{k+1}/I_k) \\geq (I_1/I_0)^n$, and so $\\lim_{n\\to\\infty} I_n = \\infty$ since $I_1/I_0>1$ and $I_0 > 0$.\n\n\\noindent\n\\textbf{Remark:}\nNoam Elkies suggests the following variant of the previous solution,\nwhich eliminates the need to separately check that $I_1 > I_0$.\nFirst, the proof that $I_n I_{n+2} \\geq I_{n+1}^2$ applies also for $n=-1$ under the convention that $I_{-1} = \\int_a^b g(x)\\,dx$ (as in the fourth solution below).\nSecond, this equality must be strict for each $n \\geq -1$: \notherwise, the equality condition in Cauchy--Schwarz would imply that \n$g(x) = c f(x)$ identically for some $c>0$, and the equality $\\int_a^b f(x)\\,dx = \\int_a^b g(x)\\,dx$ would then force $c=1$, contrary to assumption. Consequently, the sequence $I_{n+1}/I_n$ is strictly increasing; since\n$I_0/I_{-1} = 1$, it follows that for $n \\geq 0$, we again have $I_{n+1}/I_n \\geq I_1/I_0 > 1$ and so on.\n\n\\textbf{Second solution.}\n(from Art of Problem Solving, user \\texttt{MSTang})\nSince $\\int_a^b (f(x) - g(x))\\,dx = 0$,\nwe have\n\\begin{align*}\nI_{n+1} - I_n &= \\int_a^b \\left( \\frac{(f(x))^{n+2}}{(g(x))^{n+1}} - \\frac{(f(x))^{n+1}}{(g(x))^{n}} \\right)\\,dx \\\\\n&= \\int_a^b \\frac{(f(x))^{n+1}}{(g(x))^{n+1}} (f(x)-g(x))\\,dx \\\\\n&= \\int_a^b \\left(\\frac{(f(x))^{n+1}}{(g(x))^{n+1}} - 1 \\right) (f(x)-g(x))\\,dx \\\\\n&= \\int_a^b \\frac{(f(x)-g(x))^2 ((f(x))^n + \\cdots + g(x)^n)}{(g(x))^{n+1}}\\,dx.\n\\end{align*}\nThe integrand is continuous, nonnegative, and not identically zero; hence $I_{n+1} - I_n > 0$.\n\nTo prove that $\\lim_{n \\to \\infty} I_n = \\infty$, note that we cannot have $f(x) \\leq g(x)$ identically, as then\nthe equality $\\int_a^b f(x)\\,dx = \\int_a^b g(x)\\,dx$ would imply $f(x) = g(x)$ identically. That is, there exists\nsome $t \\in [a,b]$ such that $f(t) > g(t)$. By continuity, there exist a quantity $c > 1$\nand an interval $J = [t_0, t_1]$ in $[a,b]$ such that $f(x) \\geq c g(x)$ for all $x \\in J$. We then have\n\\[\nI_n \\geq \\int_{t_0}^{t_1} \\frac{(f(x))^{n+1}}{(g(x))^n}\\,dx \\\\\n\\geq c^n \\int_{t_0}^{t_1} f(x)\\,dx;\n\\]\nsince $f(x) > 0$ everywhere, we have $\\int_{t_0}^{t_1} f(x)\\,dx > 0$\nand hence $I_n$ is bounded below by a quantity which tends to $\\infty$.\n\n\\noindent\n\\textbf{Remark:}\nOne can also give a variation of the second half of the solution which shows directly that\n$I_{n+1} - I_n \\geq c^n d$ for some $c > 1, d>0$, thus proving both assertions at once.\n\n%\\textbf{Third solution.}\n%(from Art of Problem Solving, user \\texttt{kybard})\n%Write\n%\\begin{align*}\n%I_n - I_{n-1} &= \\int_a^b (1 + (f(x)-g(x))/g(x))^n (f(x)-g(x))\\,dx \\\\\n%&\\geq (1 + n (f(x)-g(x))/g(x)) (f(x)-g(x))\\,dx \\\\\n%&= n \\int_a^b \\frac{(f(x)-g(x))^2}{g(x)}\\,dx.\n%\\end{align*}\n%The integrand is nonnegative and not identically zero, so\n%$I_n - I_{n-1}$ is bounded below by $n$ times a positive constant. This proves both assertions at once.\n\n\\textbf{Third solution.}\n(from David Savitt, via Art of Problem Solving)\nExtend the definition of $I_n$ to all \\emph{real} $n$,\nand note that \n\\[\nI_{-1} = \\int_a^b g(x)\\,dx = \\int_a^b f(x)\\,dx = I_0.\n\\]\nBy writing\n\\[\nI_n = \\int_a^b \\exp((n+1)\\log f(x) - n \\log g(x))\\,dx,\n\\]\nwe see that the integrand is a strictly convex function of $n$, as then is $I_n$.\nIt follows that $I_n$ is strictly increasing and unbounded for $n \\geq 1$.\n\n\\textbf{Fourth solution.}\n(by David Rusin)\nAgain, extend the definition of $I_n$ to $n=-1$.\nNow note that for $n \\geq 0$ and $x \\in [a,b]$, we have\n\\[\n(f(x) - g(x)) \\left( \\left( \\frac{f(x)}{g(x)} \\right)^{n+1}  - \\left( \\frac{f(x)}{g(x)} \\right)^{n}  \\right) \\geq 0\n\\]\nbecause both factors have the same sign (depending on the comparison between $f(x)$ and $g(x)$);\nmoreover, equality only occurs when $f(x) = g(x)$. Since $f$ and $g$ are not identically equal, we deduce that\n\\[\nI_{n+1} - I_n > I_n - I_{n-1}\n\\]\nand so in particular\n\\[\nI_{n+1} - I_n \\geq I_1 - I_0 > I_0 - I_{-1} = 0.\n\\]\nThis proves both claims.\n\n\\textbf{Remark:}\nThis problem appeared in 2005 on an undergraduate math olympiad in Brazil.\nSee \\url{https://artofproblemsolving.com/community/c7h57686p354392} for discussion.", "category": "Algebra", "source": "PUTNAM", "year": 2017}
{"id": "putnam-2017-a4", "question": "A class with $2N$ students took a quiz, on which the possible scores were $0,1,\\dots,10$. Each of these scores\noccurred at least once, and the average score was exactly $7.4$. Show that the class can be divided into two groups of $N$ students in such a way that the average score for each group was exactly $7.4$.", "solution": "\\textbf{First solution.}\nLet $a_1,\\dots,a_{2N}$ be the scores in nondecreasing order, and define the sums\n$s_i = \\sum_{j=i+1}^{i+N} a_j$ for $i=0,\\dots,N$.\nThen $s_0 \\leq \\cdots \\leq s_{N}$\nand\n$s_0 + s_{N} = \\sum_{j=1}^{2N} a_j = 7.4(2N)$,\nso $s_0 \\leq 7.4N \\leq s_N$. Let $i$ be the largest index for which $s_i \\leq 7.4N$;\nnote that we cannot have $i = N$, as otherwise $s_0 = s_N = 7.4N$ and hence \n$a_1 = \\cdots = a_{2N} = 7.4$, contradiction.\nThen $7.4N - s_i < s_{i+1} - s_i = a_{i+N+1} - a_i$ and so\n\\[\na_i < s_i + a_{i+N+1} - 7.4N \\leq a_{i+N+1};\n\\]\nsince all possible scores occur, this means that we can find $N$ scores with sum $7.4N$\nby taking $a_{i+1}, \\dots, a_{i+N+1}$ and omitting one occurrence of the value $s_i + a_{i+N+1} - 7.4N$.\n\n\\noindent\n\\textbf{Remark:}\nDavid Savitt (via Art of Problem Solving) points out that a similar argument applies provided that\nthere are an even number of students, the total score is even, and the achieved scores form a block of consecutive integers.\n\n\\noindent\n\\textbf{Second solution.}\nWe first claim that for any integer $m$ with $15 \\leq m \\leq 40$, we can find five distinct elements of the set $\\{1,2,\\ldots,10\\}$ whose sum is $m$. Indeed, for $0 \\leq k \\leq 4$ and $1 \\leq \\ell \\leq 6$, we have\n\\[\n\\left(\\sum_{j=1}^k j \\right) + (k+\\ell) + \\left(\\sum_{j=k+7}^{10} j \\right) = 34-5k+\\ell,\\]\nand for fixed $k$ this takes all values from $35-5k$ to $40-5k$ inclusive; then as $k$ ranges from $0$ to $4$, this takes all values from $15$ to $40$ inclusive.\n\nNow suppose that the scores are $a_1,\\ldots,a_{2N}$, where we order the scores so that $a_k=k$ for $k \\leq 10$ and the subsequence $a_{11},a_{12},\\ldots,a_{2N}$ is nondecreasing. For $1 \\leq k \\leq N-4$, define $S_k = \\sum_{j=k+10}^{k+N+4} a_j$. Note that for each $k$, $S_{k+1}-S_k = a_{k+N+5}-a_{k+10}$ and so $0 \\leq S_{k+1}-S_k \\leq 10$. Thus $S_1,\\ldots,S_{N-4}$ is a nondecreasing sequence of integers where each term is at most $10$ more than the previous one. On the other hand, we have \n\\begin{align*}\nS_1 + S_{N-4} &= \\sum_{j=11}^{2N} a_j \\\\\n&= (7.4)(2N)-\\sum_{j=1}^{10} a_j \\\\\n&= (7.4)(2N)-55,\n\\end{align*}\nwhence $S_1 \\leq 7.4N-27.5 \\leq S_{N-4}$. It follows that there is some $k$ such that $S_k \\in [7.4N-40, 7.4N-15]$, since this interval has length $25$ and $7.4N-27.5$ lies inside it.\n\n\nFor this value of $k$, note that both $S_k$ and $7.4N$ are integers (the latter since the sum of all scores in the class is the integer $(7.4)(2N)$ and so $N$ must be divisible by $5$). Thus there is an integer $m$ with $15 \\leq m \\leq 40$ for which $S_k = 7.4N-m$. By our first claim, we can choose five scores from $a_1,\\ldots,a_{10}$ whose sum is $m$. When we add these to the sum of the $N-5$ scores $a_{k+10},\\ldots,a_{k+N+4}$, we get precisely $7.4N$. We have now found $N$ scores whose sum is $7.4N$ and thus whose average is $7.4$.\n\n\\noindent\n\\textbf{Third solution.}\nIt will suffices to show that given any partition of the students into two groups of $N$, if the sums are not equal we can bring them closer together by swapping one pair of students between the two groups. To state this symbolically,\nlet $S$ be the set of students and, for any subset $T$ of $S$, let $\\Sigma T$ denote the sum of the scores of the students in $T$; we then show that if $S = A \\cup B$ is a partition into two $N$-element sets with\n$\\Sigma A > \\Sigma B$, then there exist students $a \\in A, B \\in B$ such that the sets\n\\[\nA' = A \\setminus \\{a\\} \\cup \\{b\\}, \\qquad\nB' = A \\setminus \\{b\\} \\cup \\{a\\}\n\\]\nsatisfy\n\\[\n0 \\leq \\Sigma A' - \\Sigma B' < \\Sigma A - \\Sigma B.\n\\]\nIn fact, this argument will apply at the same level of generality as in the remark following the first solution.\n\nTo prove the claim, let \n$a_1,\\dots,a_n$ be the scores in $A$ and let $b_1,\\dots,b_n$ be the scores in $B$ (in any order).\nSince $\\Sigma A - \\Sigma B \\equiv \\Sigma S \\pmod{2}$ and the latter is even, we must have\n$\\Sigma A - \\Sigma B \\geq 2$.\nIn particular, there must exist indices $i,j \\in \\{1,\\dots,n\\}$ such that $a_i > b_j$.\nConsequently, if we sort the sequence $a_1,\\dots,a_n,b_1,\\dots,b_n$ into nondecreasing order,\nit must be the case that some term $b_j$ is followed by some term $a_i$.\nMoreover, since the achieved scores form a range of consecutive integers, we must in fact have\n$a_i = b_j + 1$. Consequently, if we take $a = a_i$, $b = b_j$, we then have\n$\\Sigma A' - \\Sigma' B = \\Sigma A - \\Sigma B - 2$, which proves the claim.", "category": "Combinatorics", "source": "PUTNAM", "year": 2017}
{"id": "putnam-2017-a5", "question": "Each of the integers from $1$ to $n$ is written on a separate card, and then the cards are combined into a deck and shuffled. Three players, $A$, $B$, and $C$, take turns in the order $A,B,C,A,\\dots$ choosing one card at random from the deck. (Each card in the deck is equally likely to be chosen.) After a card is chosen, that card and all higher-numbered cards are removed from the deck, and the remaining cards are reshuffled before the next turn. Play continues until one of the three players wins the game by drawing the card numbered $1$.\n\nShow that for each of the three players, there are arbitrarily large values of $n$ for which that player has the highest probability among the three players of winning the game.", "solution": "\\textbf{First solution.}\nLet $a_n, b_n, c_n$ be the probabilities that players $A$, $B$, $C$, respectively, will win the game.\nWe compute these by induction on $n$, starting with the values\n\\[\na_1 = 1, \\qquad b_1 = 0, \\qquad c_1 = 0.\n\\]\nIf player $A$ draws card $k$, then the resulting game state is that of a deck of $k-1$ cards with the players taking turns in the order $B,C,A,B,\\dots$. In this state, the probabilities that players $A, B, C$ will win are\n$c_{k-1}, a_{k-1}, b_{k-1}$ provided that we adopt the convention that\n\\[\na_0 = 0, \\qquad b_0 = 0, \\qquad c_0 = 1.\n\\]\nWe thus have\n\\[\na_n = \\frac{1}{n} \\sum_{k=1}^{n} c_{k-1}, \\quad\nb_n = \\frac{1}{n} \\sum_{k=1}^{n} a_{k-1}, \\quad\nc_n = \\frac{1}{n} \\sum_{k=1}^{n} b_{k-1}.\n\\]\nPut\n\\[\nx_n = a_n - b_n, \\quad y_n = b_n - c_n, \\quad z_n = c_n - a_n;\n\\]\nwe then have\n\\begin{align*}\n x_{n+1} &= \\frac{n}{n+1} x_n + \\frac{1}{n+1}z_n, \\\\\n y_{n+1} &= \\frac{n}{n+1} y_n + \\frac{1}{n+1}x_n, \\\\\n z_{n+1} &= \\frac{n}{n+1} z_n + \\frac{1}{n+1}y_n.\n\\end{align*}\nNote that if $a_{n+1} = b_{n+1} = c_{n+1} = 0$, then\n\\[\nx_n = -nz_n = n^2y_n = -n^3x_n = n^4z_n\n\\]\nand so $x_n = z_n = 0$, or in other words $a_n = b_n = c_n$. By induction on $n$, we deduce that \n$a_n, b_n, c_n$ cannot all be equal. That is, the quantities $x_n, y_n, z_n$ add up to zero and at most one of them\nvanishes; consequently, the quantity $r_n = \\sqrt{x_n^2 + y_n^2 + z_n^2}$ is always positive\nand the quantities\n\\[\nx'_n = \\frac{x_n}{r_n}, \\quad y'_n = \\frac{y_n}{r_n}, \\quad z'_n = \\frac{z_n}{r_n}\n\\]\nform the coordinates of a point $P_n$ on a fixed circle $C$ in $\\mathbb{R}^3$.\n\nLet $P'_n$ be the point $(z_n, x_n, y_n)$ obtained from $P_n$ by a clockwise rotation of angle $\\frac{2\\pi}{3}$.\nThe point $P_{n+1}$ then lies on the ray through the origin passing through the point dividing the chord from $P_n$ to $P'_n$ in the ratio $1:n$. \nThe (clockwise) arc from $P_n$ to $P_{n+1}$ therefore has a measure of\n\\[\n\\arctan \\frac{\\sqrt{3}}{2n-1}\n= \\frac{\\sqrt{3}}{2n-1} + O(n^{-3});\n\\]\nthese measures form a null sequence whose sum diverges. It follows that any arc of $C$ contains infinitely many of the $P_n$; taking a suitably short arc around the point $(\\frac{\\sqrt{2}}{2}, 0, -\\frac{\\sqrt{2}}{2})$, we deduce that for infinitely many $n$, $A$ has the highest winning probability, and similarly for $B$ and $C$.\n\n\\noindent\n\\textbf{Remark:}\nFrom the previous analysis, we also deduce that\n\\[\n\\frac{r_{n+1}}{r_n} = \\frac{\\sqrt{n^2-n+1}}{n+1} = 1 - \\frac{3}{2(n+1)} + O(n^{-2}),\n\\]\nfrom which it follows that $r_n \\sim c n^{-3/2}$ for some $c>0$.\n\n\\noindent\n\\textbf{Second solution.}\n(by Noam Elkies)\nIn this approach, we instead compute the probability $p_n(m)$ that the game ends after exactly $m$ turns\n(the winner being determined by the residue of $m$ mod 3).\nWe use the convention that $p_0(0) = 1$, $p_0(m) = 0$ for $m>0$.\nDefine the generating function $P_n(X) = \\sum_{m=0}^n p_n(m) x^m$.\nWe will establish that\n\\[\nP_n(X) = \\frac{X(X+1)\\cdots(X+n-1)}{n!}\n\\]\n(which may be guessed by computing $p_n(m)$ for small $n$ by hand). There are several ways to do this; for instance,\nthis follows from the recursion\n\\[\nP_n(X) = \\frac{1}{n} X P_{n-1}(X) + \\frac{(n-1)}{n} P_{n-1}(X).\n\\]\n(In this recursion, the first term corresponds to conditional probabilities given that the first card drawn is $n$,\nand the second term corresponds to the remaining cases.)\n\nLet $\\omega$ be a primitive cube root of 1. With notation as in the first solution,\nwe have\n\\[\nP_n(\\omega) = a_n + b_n \\omega + c_n \\omega;\n\\]\ncombining this with the explicit formula for $P_n(X)$ and the observation that\n\\[\n\\mathrm{arg}(w+n) = \\arctan \\frac{\\sqrt{3}}{2n-1}\n\\]\nrecovers the geometric description of $a_n, b_n, c_n$\ngiven in the first solution (as well as the remark following the first solution).\n\n\\noindent\n\\textbf{Third solution.}\nFor this argument, we use the auxiliary quantities\n\\[\na'_n = a_n - \\frac{1}{3}, \\quad b'_n = b_n - \\frac{1}{3}, \\quad c'_n = c_n - \\frac{1}{3};\n\\]\nthese satisfy the relations\n\\[\na'_n = \\frac{1}{n} \\sum_{k=1}^{n} c'_{k-1}, \\quad\nb'_n = \\frac{1}{n} \\sum_{k=1}^{n} a'_{k-1}, \\quad\nc'_n = \\frac{1}{n} \\sum_{k=1}^{n} b'_{k-1}\n\\]\nas well as \n\\begin{align*}\na'_{n+1} &= a'_n + \\frac{1}{n+1} (c'_n-a'_n)  \\\\\nb'_{n+1} &= b'_n + \\frac{1}{n+1} (a'_n-b'_n) \\\\\nc'_{n+1} &= c'_n + \\frac{1}{n+1} (b'_n-c'_n).\n\\end{align*}\nWe now show that $\\sum_{n=1}^\\infty a'_n$ cannot diverge to $+\\infty$\n(and likewise for $\\sum_{n=1}^\\infty b'_n$ and $\\sum_{n=1}^\\infty c'_n$ by similar reasoning).\nSuppose the contrary; then there exists some $\\epsilon > 0$ and some $n_0 > 0$ \nsuch that $\\sum_{k=1}^n a'_k \\geq \\epsilon$ for all $n \\geq n_0$.\nFor $n > n_0$, we have $b'_n \\geq \\epsilon$; this in turn implies that $\\sum_{n=1}^\\infty b'_n$ diverges to $+\\infty$.\nContinuing around the circle, we deduce that for $n$ sufficiently large, all three of $a'_n, b'_n, c'_n$ are positive;\nbut this contradicts the identity $a'_n + b'_n + c'_n = 0$. We thus conclude that $\\sum_{n=1}^\\infty a'_n$ does not diverge to $+\\infty$; in particular, $\\liminf_{n \\to \\infty} a'_n \\leq 0$.\n\nBy the same token, we may see that $\\sum_{n=1}^\\infty a'_n$ cannot converge to a positive limit $L$\n(and likewise for $\\sum_{n=1}^\\infty b'_n$ and $\\sum_{n=1}^\\infty c'_n$ by similar reasoning).\nNamely, this would imply that $b'_n \\geq L/2$ for $n$ sufficiently large, contradicting the previous argument.\n\nBy similar reasoning, $\\sum_{n=1}^\\infty a'_n$ cannot diverge to $-\\infty$ or converge to a negative limit $L$\n(and likewise for $\\sum_{n=1}^\\infty b'_n$ and $\\sum_{n=1}^\\infty c'_n$ by similar reasoning).\n\nWe next establish that there are infinitely many $n$ for which $a'_n > 0$ (and likewise for $b'_n$ and $c'_n$ by similar reasoning).\nSuppose to the contrary that for $n$ sufficiently large, we have $a'_n \\leq 0$. \nBy the previous arguments, the sum $\\sum_{n=1}^\\infty a'_n$ cannot diverge to $\\infty$ or converge to a nonzero limit;\nit must therefore converge to 0. In particular, for $n$ sufficiently large, we have\n$b'_n = \\sum_{k=1}^n a'_{k-1} \\geq 0$. Iterating the construction, we see that for $n$ sufficiently large,\nwe must have $c'_n \\leq 0$, $a'_n \\geq 0$, $b'_n \\leq 0$, and $c'_n \\geq 0$. As a result, for $n$\nsufficiently large we must have $a'_n = b'_n = c'_n = 0$; but we may rule this out as in the original solution.\n\nBy similar reasoning, we may deduce that there are infinitely many $n$ for which $a'_n < 0$ (and likewise for $b'_n$ and $c'_n$ by similar reasoning). We now continue using a suggestion of Jon Atkins.\nDefine the values of the sequence $x_n$ according to the relative comparison of $a'_n, b'_n, c'_n$ (using the fact that these cannot all be equal):\n\\begin{align*}\nx_n = 1: & \\quad a'_n \\leq b'_n < c'_n \\\\\nx_n = 2: & \\quad b'_n \\leq c'_n < a'_n \\\\\nx_n = 3: & \\quad c'_n \\leq a'_n < b'_n \\\\\nx_n = 4: & \\quad a'_n < c'_n \\leq b'_n \\\\\nx_n = 5: & \\quad b'_n < a'_n \\leq c'_n \\\\\nx_n = 6: & \\quad c'_n < b'_n \\leq a'_n.\n\\end{align*}\nWe consider these values as \\emph{states} and say that there is a \\emph{transition} from state $i$ to state $j$,\nand write $i \\Rightarrow j$, if for every $n \\geq 2$ with $x_n = i$ there exists $n' > n$ with $x_{n'} = j$.\n(In all cases when we use this notation, it will in fact be the case that the \\emph{first} value of $n'>n$ for which\n$x_{n'} \\neq i$ satisfes $x_{n'} = j$, but this is not logically necessary for our final conclusion.) \n\nSuppose that $x_n = 1$. By the earlier discussion, we must have $a'_{n'} > 0$ for some $n' > n$, and so we cannot have $x_{n'} = 1$ for all $n' > n$. On the other hand, as long as $x_n = 1$, we have \n\\begin{align*}\nc'_{n+1}-b'_{n+1} &= c'_n - b'_n + \\frac{1}{n+1}(2b'_n  - a'_n - c'_n) \\\\\n&= \\frac{n-1}{n+1} (c'_n - b'_n) + \\frac{1}{n+1}(c'_n - a'_n) > 0 \\\\\nc'_{n+1}-a'_{n+1} &= c'_n - a'_n + \\frac{1}{n+1}(a'_n + b'_n - 2c'_n) \\\\\n&= \\frac{n-1}{n+1} (c'_n - a'_n) + \\frac{1}{n+1}(b'_n - a'_n) > 0.\n\\end{align*}\nConsequently, for $n'$ the smallest value for which $x_{n'} \\neq x_n$, we must have $x_{n'} = 2$. \nBy this and two similar arguments, we deduce that\n\\[\n1 \\Rightarrow 5, \\quad 2 \\Rightarrow 6, \\quad 3 \\Rightarrow 4.\n\\]\nSuppose that $x_n = 4$. By the earlier discussion, we must have $a'_{n'} < 0$ for some $n' > n$, and so we cannot have $x_{n'} = 4$ for all $n' > n$. On the other hand, as long as $x_n = 4$, we have  \n\\begin{align*}\nb'_{n+1}-a'_{n+1} &=b'_n - a'_n + \\frac{1}{n+1} (2a'_n - b'_n - c'_n) \\\\\n&= \\frac{n-1}{n+1} (b'_n - a'_n) + \\frac{1}{n+1}(b'_n - c'_n) > 0 \\\\\nc'_{n+1}-a'_{n+1} &= c'_n - a'_n + \\frac{1}{n+1}(a'_n + b'_n - 2c'_n) \\\\\n&= \\frac{n-1}{n+1} (c'_n - a'_n) + \\frac{1}{n+1}(b'_n - a'_n) > 0.\n\\end{align*}\nConsequently, for $n'$ the smallest value for which $x_{n'} \\neq x_n$, we must have $x_{n'} = 1$. \nBy this and two similar arguments, we deduce that\n\\[\n4 \\Rightarrow 1, \\quad 5 \\Rightarrow 2, \\quad 6 \\Rightarrow 3.\n\\]\nCombining, we obtain\n\\[\n1 \\Rightarrow 5 \\Rightarrow 2 \\Rightarrow 6 \\Rightarrow 3 \\Rightarrow 4 \\Rightarrow 1\n\\]\nand hence the desired result.", "category": "Combinatorics", "source": "PUTNAM", "year": 2017}
{"id": "putnam-2017-a6", "question": "The 30 edges of a regular icosahedron are distinguished by labeling them $1,2,\\dots,30$. How many different ways \nare there to paint each edge red, white, or blue such that each of the 20 triangular faces of the icosahedron has two edges of the same color and a third edge of a different color? [Note: the top matter on each exam paper included the logo of the Mathematical Association of America, which is itself an icosahedron.]", "solution": "The number of such colorings is $2^{20} 3^{10} = 61917364224$.\n\n\\noindent\n\\textbf{First solution:}\nIdentify the three colors red, white, and blue with (in some order) the elements of the field $\\mathbb{F}_3$ of three elements (i.e., the ring of integers mod 3). \nThe set of colorings may then be identified with the $\\mathbb{F}_3$-vector space $\\mathbb{F}_3^E$\ngenerated by the set $E$ of edges. Let $F$ be the set of faces, and let $\\mathbb{F}_3^F$ be the $\\mathbb{F}_3$-vector space on the basis $F$; we may then define a linear transformation\n$T: \\mathbb{F}_3^E \\to \\mathbb{F}_3^F$ taking a coloring to the vector whose component corresponding to a given face equals the sum of the three edges of that face. The colorings we wish to count are the ones whose images under $T$ consist of vectors with no zero components.\n\nWe now show that $T$ is surjective. (There are many possible approaches to this step; for instance, see the following remark.) \nLet $\\Gamma$ be the dual graph of the icosahedron, that is, $\\Gamma$ has vertex set $F$ and two elements of $F$ are adjacent in $\\Gamma$ if they share an edge in the icosahedron. The graph $\\Gamma$ admits a hamiltonian path, that is, there exists an ordering\n$f_1,\\dots,f_{20}$ of the faces such that any two consecutive faces are adjacent in $\\Gamma$. \nFor example, such an ordering can be constructed with $f_1,\\dots,f_5$ being the five faces sharing a vertex of the icosahedron and $f_{16},\\dots,f_{20}$ being the five faces sharing the antipodal vertex.\n\nFor $i=1,\\dots,19$, let $e_i$ be the common edge of $f_i$ and $f_{i+1}$; these are obviously all distinct.\nBy prescribing components for $e_1,\\dots,e_{19}$ in turn and setting the others to zero,\nwe can construct an element of $\\mathbb{F}_3^E$ whose image under $T$ matches any given vector of $\\mathbb{F}_3^F$ in the components of $f_1,\\dots,f_{19}$. The vectors in $\\mathbb{F}_3^F$ obtained in this way thus form a 19-dimensional subspace; this subspace may also be described as the vectors for which the components of $f_1,\\dots,f_{19}$ have the same sum as the components of $f_{2},\\dots,f_{20}$. \n\nBy performing a mirror reflection, we can construct a second hamiltonian path $g_1,\\dots,g_{20}$ with the property that\n\\[\ng_1 = f_1, g_2 = f_5, g_3 = f_4, g_4 = f_3, g_5 = f_2.\n\\]\nRepeating the previous construction, we obtain a \\emph{different} 19-dimensional subspace of $\\mathbb{F}_3^F$ which is contained in the image of $T$. This implies that $T$ is surjective, as asserted earlier.\n\nSince $T$ is a surjective homomorphism from a 30-dimensional vector space to a 20-dimensional vector space, it has a 10-dimensional kernel. Each of the $2^{20}$ elements of $\\mathbb{F}_3^F$ with no zero components is then the image of exactly $3^{10}$ colorings of the desired form, yielding the result.\n\n\\noindent\n\\textbf{Remark:}\nThere are many ways to check that $T$ is surjective. One of the simplest is the following\n(from Art of Problem Solving, user \\texttt{Ravi12346}): form a vector in $\\mathbb{F}^E$ with components $2,1,2,1,2$ at the five edges around some vertex and all other components 0. This maps to a vector in $\\mathbb{F}^F$ with only a single nonzero component; by symmetry, every standard basis vector of $\\mathbb{F}^F$ arises in this way.\n\n\\noindent\n\\textbf{Second solution:}\n(from Bill Huang, via Art of Problem Solving user \\texttt{superpi83})\nLet $v$ and $w$ be two antipodal vertices of the icosahedron. Let $S_v$ (resp.\\ $S_w$) be the set of five edges incident to $v$ (resp.\\ $w$). Let $T_v$ (resp.\\ $T_w$) be the set of five edges of the pentagon formed by the opposite endpoints of the five edges in $S_v$ (resp. $S_w$). Let $U$ be the set of the ten remaining edges of the icosahedron.\n\nConsider any one of the $3^{10}$ possible colorings of $U$. The edges of $T_v \\cup U$ form the boundaries of five faces with no edges in common; thus each edge of $T_v$ can be colored in one of two ways consistent with the given condition,\nand similarly for $T_w$. That is, there are $3^{10} 2^{10}$ possible colorings of $T_v \\cup T_w \\cup U$ consistent with the given condition.\n\nTo complete the count, it suffices to check that there are exactly $2^5$ ways to color $S_v$ consistent with any given coloring of $T_v$. Using the linear-algebraic interpretation from the first solution, this follows by observing that\n(by the previous remark) the map from $\\mathbb{F}_3^{S_v}$ to the $\\mathbb{F}_3$-vector space on the faces incident to $v$ is surjective, and hence an isomorphism for dimensional reasons. A direct combinatorial proof is also possible.", "category": "Combinatorics", "source": "PUTNAM", "year": 2017}
{"id": "putnam-2017-b1", "question": "Let $L_1$ and $L_2$ be distinct lines in the plane. Prove that $L_1$ and $L_2$ intersect if and only if, for every\nreal number $\\lambda\\neq 0$ and every point $P$ not on $L_1$ or $L_2$, there exist points $A_1$ on $L_1$ and $A_2$\non $L_2$ such that $\\overrightarrow{PA_2} = \\lambda \\overrightarrow{PA_1}$.", "solution": "Recall that $L_1$ and $L_2$ intersect if and only if they are not parallel. \nIn one direction, suppose that $L_1$ and $L_2$ intersect. Then for any $P$ and $\\lambda$, the dilation (homothety) of the plane by a factor of $\\lambda$ with center $P$ carries $L_1$ to another line parallel to $L_1$ and hence not parallel to $L_2$. Let $A_2$ be the unique intersection of $L_2$ with the image of $L_1$, and let $A_1$ be the point on $L_1$ whose image under the dilation is $A_2$; then $\\overrightarrow{PA_2} = \\lambda \\overrightarrow{PA_1}$.\n\nIn the other direction, suppose that $L_1$ and $L_2$ are parallel. Let $P$ be any point in the region between $L_1$ and $L_2$ and take $\\lambda = 1$. Then for any point $A_1$ on $L_1$ and any point $A_2$ on $L_2$, the vectors \n$\\overrightarrow{PA_1}$ and $\\overrightarrow{PA_2}$ have components perpendicular to $L_1$ pointing in opposite directions; in particular, the two vectors cannot be equal.\n\n\\noindent\n\\textbf{Reinterpretation:}\n(by Karl Mahlburg)\nIn terms of vectors, we may find vectors $\\vec{v}_1, \\vec{v}_2$ and scalars $c_1, c_2$ such that\n$L_i = \\{\\vec{x} \\in \\mathbb{R}^2: \\vec{v}_i \\cdot \\vec{x} = c_i\\}$.\nThe condition in the problem amounts to finding a vector $\\vec{w}$ and a scalar $t$ such that\n$P + \\vec{w} \\in L_1, P + \\lambda w \\in L_2$; this comes down to solving the linear system\n\\begin{align*}\n\\vec{v}_1 \\cdot (P + \\vec{w}) &= c_1 \\\\\n\\vec{v}_2 \\cdot (P + \\lambda \\vec{w}) &= c_2\n\\end{align*}\nwhich is nondegenerate and solvable for all $\\lambda$ if and only if $\\vec{v}_1, \\vec{v}_2$ are linearly independent.", "category": "Geometry", "source": "PUTNAM", "year": 2017}
{"id": "putnam-2017-b2", "question": "Suppose that a positive integer $N$ can be expressed as the sum of $k$ consecutive positive integers\n\\[\nN = a + (a+1) +(a+2) + \\cdots + (a+k-1)\n\\]\nfor $k=2017$ but for no other values of $k>1$. Considering all positive integers $N$ with this property,\nwhat is the smallest positive integer $a$ that occurs in any of these expressions?", "solution": "We prove that the smallest value of $a$ is 16.\n\nNote that the expression for $N$ can be rewritten as $k(2a+k-1)/2$,\nso that $2N = k(2a+k-1)$. In this expression, $k>1$ by requirement;\n$k < 2a+k-1$ because $a>1$; and obviously $k$ and $2a+k-1$ have opposite parity. Conversely, for any factorization $2N = mn$ with $1<m<n$ and $m,n$ of opposite parity, we obtain an expression of $N$ in the desired form by taking\n$k = m$, $a = (n+1-m)/2$.\n\nWe now note that $2017$ is prime. (On the exam, solvers would have had to verify this by hand.\nSince $2017 < 45^2$, this can be done by trial division by the primes up to 43.)\nFor $2N = 2017(2a+2016)$ not to have another expression of the specified form, it must be the case that\n$2a+2016$ has no odd divisor greater than 1; that is, $2a+2016$ must be a power of 2.\nThis first occurs for $2a+2016=2048$, yielding the claimed result.\n\n\\textbf{Reinterpretation:}\n(by Karl Mahlburg)\nTo avoid $N$ having another representation, for $k = 2, \\dots, 2016$, we must have\n\\[\nN \\not\\equiv \\begin{cases} k/2 & k \\equiv 0 \\pmod{2} \\\\\n0 & k \\equiv 1 \\pmod{2}.\n\\end{cases}\n\\]\nConsequently, $N \\not\\equiv 0 \\pmod{p}$ for any odd prime $p<2017$\nand $N \\equiv 0 \\pmod{1024}$. Since $N$ must be divisible by 2017, this again yields the claimed value of $a$.", "category": "Number Theory", "source": "PUTNAM", "year": 2017}
{"id": "putnam-2017-b3", "question": "Suppose that $f(x) = \\sum_{i=0}^\\infty c_i x^i$ is a power series for which each coefficient $c_i$ is $0$ or $1$.\nShow that if $f(2/3) = 3/2$, then $f(1/2)$ must be irrational.", "solution": "Suppose by way of contradiction that $f(1/2)$ is rational. Then $\\sum_{i=0}^{\\infty} c_i 2^{-i}$ is the binary expansion of a rational number, and hence must be eventually periodic; that is, there exist some integers $m,n$ such that\n$c_i = c_{m+i}$ for all $i \\geq n$. We may then write\n\\[\nf(x) = \\sum_{i=0}^{n-1} c_i x^i + \\frac{x^n}{1-x^m} \\sum_{i=0}^{m-1} c_{n+i} x^i.\n\\]\nEvaluating at $x = 2/3$, we may equate $f(2/3) = 3/2$ with \n\\[\n\\frac{1}{3^{n-1}} \\sum_{i=0}^{n-1} c_i 2^i 3^{n-i-1} + \\frac{2^n 3^m}{3^{n+m-1}(3^m-2^m)} \\sum_{i=0}^{m-1} c_{n+i} 2^i 3^{m-1-i};\n\\]\nsince all terms on the right-hand side have odd denominator, the same must be true of the sum, a contradiction.\n\n\\noindent\n\\textbf{Remark:}\nGreg Marks asks whether the assumption that $f(2/3)=3/2$ further ensures that $f(1/2)$ is transcendental. \nWe do not know of any existing results that would imply this. However, the following result follows from a theorem of T. Tanaka (Algebraic independence of the values of power series generated by linear recurrences, \\textit{Acta Arith.} \\textbf{74} (1996), 177--190), building upon work of Mahler.\nLet $\\{a_n\\}_{n=0}^\\infty$ be a linear recurrent sequence of positive integers with characteristic polynomial $P$.\nSuppose that $P(0), P(1), P(-1) \\neq 0$ and that no two distinct roots of $P$ have ratio which is a root of unity. Then\nfor $f(x) = \\sum_{n=0}^\\infty x^{a_n}$, the values $f(1/2)$ and $f(2/3)$ are algebraically independent over $\\QQ$.\n(Note that for $f$ as in the original problem, the condition on ratios of roots of $P$ fails.)", "category": "Number Theory", "source": "PUTNAM", "year": 2017}
{"id": "putnam-2017-b4", "question": "Evaluate the sum\n\\begin{gather*}\n\\sum_{k=0}^\\infty \\left( 3 \\cdot \\frac{\\ln(4k+2)}{4k+2} - \\frac{\\ln(4k+3)}{4k+3} - \\frac{\\ln(4k+4)}{4k+4} - \\frac{\\ln(4k+5)}{4k+5} \\right) \\\\\n= 3 \\cdot \\frac{\\ln 2}{2} - \\frac{\\ln 3}{3} - \\frac{\\ln 4}{4} - \\frac{\\ln 5}{5}\n+ 3 \\cdot \\frac{\\ln 6}{6} - \\frac{\\ln 7}{7} \\\\ - \\frac{\\ln 8}{8} - \\frac{\\ln 9}{9}\n+ 3 \\cdot \\frac{\\ln 10}{10} - \\cdots .\n\\end{gather*}\n(As usual, $\\ln x$ denotes the natural logarithm of $x$.)", "solution": "We prove that the sum equals $ (\\log 2)^2$;\nas usual, we write $\\log x$ for the natural logarithm of $x$ instead of $\\ln x$.\nNote that of the two given expressions of the original sum, the first is absolutely convergent\n(the summands decay as $\\log(x)/x^2$) but the second one is not; we must thus be slightly careful when rearranging terms.\n\n\\noindent\n\\textbf{First solution.}\nDefine $a_k = \\frac{\\log k}{k} - \\frac{\\log(k+1)}{k+1}$. The infinite sum $\\sum_{k=1}^\\infty a_k$ converges to $0$ since $\\sum_{k=1}^n a_k$ telescopes to $-\\frac{\\log(n+1)}{n+1}$ and this converges to $0$ as $n\\to\\infty$. Note that $a_k > 0$ for $k \\geq 3$ since $\\frac{\\log x}{x}$ is a decreasing function of $x$ for $x>e$, and so the convergence of $\\sum_{k=1}^\\infty a_k$ is absolute.\n\nWrite $S$ for the desired sum. Then since $3a_{4k+2}+2a_{4k+3}+a_{4k+4} = (a_{4k+2}+a_{4k+4})+2(a_{4k+2}+a_{4k+3})$, we have\n\\begin{align*}\nS &= \\sum_{k=0}^\\infty (3a_{4k+2}+2a_{4k+3}+a_{4k+4}) \\\\\n&= \\sum_{k=1}^\\infty a_{2k}+\\sum_{k=0}^\\infty 2(a_{4k+2}+a_{4k+3}),\n\\end{align*}\nwhere we are allowed to rearrange the terms in the infinite sum since $\\sum a_k$ converges absolutely. Now\n$2(a_{4k+2}+a_{4k+3}) = \\frac{\\log(4k+2)}{2k+1}-\\frac{\\log(4k+4)}{2k+2} = a_{2k+1}+(\\log 2)(\\frac{1}{2k+1}-\\frac{1}{2k+2})$, and summing over $k$ gives\n\\begin{align*}\n\\sum_{k=0}^\\infty 2(a_{4k+2}+a_{4k+3}) &= \\sum_{k=0}^\\infty a_{2k+1} + (\\log 2) \\sum_{k=1}^\\infty \\frac{(-1)^{k+1}}{k}\\\\\n&= \\sum_{k=0}^\\infty a_{2k+1} +(\\log 2)^2.\n\\end{align*}\nFinally, we have \n\\begin{align*}\nS &= \\sum_{k=1}^\\infty a_{2k} + \\sum_{k=0}^\\infty a_{2k+1} +(\\log 2)^2 \\\\\n&= \\sum_{k=1}^\\infty a_k +(\\log 2)^2 = (\\log 2)^2.\n\\end{align*}\n\n\\noindent\n\\textbf{Second solution.}\nWe start with the following observation: for any positive integer $n$,\n\\[\n\\left. \\frac{d}{ds} n^{-s} \\right|_{s=1} = -(\\log n)n^{-s}.\n\\]\n(Throughout, we view $s$ as a \\emph{real} parameter, but see the remark below.)\nFor $s>0$, consider the absolutely convergent series\n\\[\nL(s) = \\sum_{k=0}^\\infty (3 (4k+2)^{-s} - (4k+3)^{-s} - (4k+4)^{-s} - (4k+5)^{-s});\n\\]\nin the same range we have\n\\begin{align*}\nL'(s) &= \\sum_{k=0}^\\infty \\left( 3 \\frac{\\log(4k+2)}{(4k+2)^s} - \\frac{\\log(4k+3)}{(4k+3)^s} \\right. \\\\\n&\\quad \\left. + \\frac{\\log(4k+4)}{(4k+4)^s} - \\frac{\\log(4k+5)}{(4k+5)^{s}} \\right),\n\\end{align*}\nso we may interchange the summation with taking the limit at $s=1$ to equate the original sum with $-L'(1)$.\n\nTo make further progress, we introduce the Riemann zeta function\n$\\zeta(s) = \\sum_{n=1}^\\infty n^{-s}$, which converges absolutely for $s>1$.\nIn that region, we may freely rearrange sums to write\n\\begin{align*}\nL(s) + \\zeta(s) &= 1 + 4 (2^{-s} + 6^{-s} + 10^{-s} + \\cdots) \\\\\n&= 1 + 2^{2-s} (1 + 3^{-s} + 5^{-s} + \\cdots) \\\\\n&= 1 + 2^{2-s} (\\zeta(s) - 2^{-s} - 4^{-s} - \\cdots) \\\\\n&= 1 + 2^{2-s} \\zeta(s) - 2^{2-2s} \\zeta(s).\n\\end{align*}\nIn other words, for $s > 1$, we have\n\\[\nL(s) = 1 + \\zeta(s) (-1 + 2^{2-s} - 2^{2-2s}).\n\\]\nNow recall that $\\zeta(s) - \\frac{s}{s-1}$ extends to a $C^\\infty$ function\nfor $s>0$, e.g., by applying Abel summation to obtain\n\\begin{align*}\n\\zeta(s) - \\frac{s}{s-1} &= \\sum_{n=1} n (n^{-s} - (n+1)^{-s}) - \\frac{s}{s-1}\\\\\n&= s \\sum_{n=1}^\\infty n \\int_n^{n+1} x^{-s-1}\\,dx  - \\frac{s}{s-1} \\\\\n&= -s \\int_1^\\infty (x - \\lfloor x \\rfloor) x^{-s-1}\\,dx.\n\\end{align*}\nAlso by writing $2^{2-s} = 2 \\exp((1-s) \\log 2$\nand $2^{2-2s} = \\exp(2(1-s)\\log 2)$, we may use the exponential series\nto compute the Taylor expansion of \n\\[\nf(s) = \\frac{-1 + 2^{2-s} - 2^{2-2s}}{s-1}\n\\]\nat $s=1$; we get\n\\[\nf(s) = -(\\log 2)^2 (s-1)^2 + O((s-1)^3).\n\\]\nConsequently, if we rewrite the previous expression for $L(s)$ as\n\\[\nL(s) =  1 + (s-1)\\zeta(s) \\cdot \\frac{-1 + 2^{2-s} - 2^{2-2s}}{s-1},\n\\]\nthen we have an equality of $C^\\infty$ functions for $s>1$, and\nhence (by continuity) an equality of Taylor series about $s=1$. \nThat is,\n\\[\nL(s) = 1 - (\\log 2)^2 (s-1) + O((s-1)^2),\n\\]\nwhich yields the desired result.\n\n\\noindent\n\\textbf{Remark:}\n\nThe use of series $\\sum_{n=1}^\\infty c_n n^{-s}$ as functions of a \\emph{real} parameter $s$\ndates back to Euler, who observed that the divergence of $\\zeta(s)$ as $s \\to 1$ gives a proof of the infinitude of primes distinct from Euclid's approach, and Dirichlet, who upgraded this idea to prove his theorem on the distribution of primes across arithmetic progressions. It was Riemann who introduced the idea of viewing these series as functions of a \\emph{complex} parameter, thus making it possible to use the tools of complex analysis (e.g., the residue theorem) and leading to the original proof of the prime number theorem by Hadamard and de la Vall\\'ee Poussin.\n\nIn the language of complex analysis, one may handle the convergence issues in the second solution \nin a different way: use the preceding calculation to establish the equality\n\\[\nL(s) = 1 + \\zeta(s) (-1 + 2^{2-s} - 2^{2-2s})\n\\]\nfor $\\mathrm{Real}(s) > 1$, then observe that both sides are holomorphic for $\\mathrm{Real}(s) > 0$\nand so the equality extends to that larger domain.", "category": "Algebra", "source": "PUTNAM", "year": 2017}
{"id": "putnam-2017-b5", "question": "A line in the plane of a triangle $T$ is called an \\emph{equalizer} if it divides $T$ into two regions having equal area and equal perimeter. Find positive integers $a>b>c$, with $a$ as small as possible, such that there exists a triangle with side lengths $a, b, c$ that has exactly two distinct equalizers.", "solution": "The desired integers are $(a,b,c) = (9,8,7)$.\n\nSuppose we have a triangle $T = \\triangle ABC$ with $BC=a$, $CA=b$, $AB=c$ and $a>b>c$.\nSay that a line is an \\textit{area equalizer} if it divides $T$ into two regions of equal area. A line intersecting $T$ must intersect two of the three sides of $T$. First consider a line intersecting the segments $AB$ at $X$ and $BC$ at $Y$, and let $BX=x$, $BY=y$. This line is an area equalizer if and only if $xy\\sin B = 2\\operatorname{area}(\\triangle XBY) = \\operatorname{area}(\\triangle ABC) = \\frac{1}{2}ac\\sin B$, that is, $2xy=ac$. Since $x \\leq c$ and $y \\leq a$, the area equalizers correspond to values of $x,y$ with $xy=ac/2$ and $x \\in [c/2,c]$. Such an area equalizer is also an equalizer if and only if $p/2=x+y$, where $p=a+b+c$ is the perimeter of $T$. If we write $f(x) = x+ac/(2x)$, then we want to solve $f(x) = p/2$ for $x \\in [c/2,c]$. Now note that $f$ is convex, $f(c/2) = a+c/2 > p/2$, and $f(c) = a/2+c < p/2$; it follows that there is exactly one solution to $f(x)=p/2$ in $[c/2,c]$.\nSimilarly, for equalizers intersecting $T$ on the sides $AB$ and $AC$, we want to solve $g(x) = p/2$ where $g(x) = x+bc/(2x)$ and $x \\in [c/2,c]$; since $g$ is convex and $g(c/2)<p/2$, $g(c) < p/2$, there are no such solutions.\n\n\nIt follows that if $T$ has exactly two equalizers, then it must have exactly one equalizer intersecting $T$ on the sides $AC$ and $BC$. Here we want to solve $h(x) = p/2$ where $h(x) = x+ab/(2x)$ and $x \\in [a/2,a]$. Now $h$ is convex and $h(a/2) > p/2$, $h(a) > p/2$; thus $h(x) = p/2$ has exactly one solution $x \\in [a/2,a]$ if and only if there is $x_0 \\in [a/2,a]$ with $h'(x_0) = 0$ and $h(x_0) = p/2$. The first condition implies $x_0 = \\sqrt{ab/2}$, and then the second condition gives $8ab = p^2$. Note that $\\sqrt{ab/2}$ is in $[a/2,a]$ since $a>b$ and $a<b+c<2b$.\n\n\nWe conclude that $T$ has two equalizers if and only if $8ab=(a+b+c)^2$. Note that $(a,b,c) = (9,8,7)$ works. We claim that this is the only possibility when $a>b>c$ are integers and $a \\leq 9$. Indeed, the only integers $(a,b)$ such that $2 \\leq b < a \\leq 9$ and $8ab$ is a perfect square are $(a,b) = (4,2)$, $(6,3)$, $(8,4)$, $(9,2)$, and $(9,8)$, and the first four possibilities do not produce triangles since they do not satisfy $a<2b$. This gives the claimed result.", "category": "Geometry", "source": "PUTNAM", "year": 2017}
{"id": "putnam-2017-b6", "question": "Find the number of ordered $64$-tuples $(x_0,x_1,\\dots,x_{63})$ such that $x_0,x_1,\\dots,x_{63}$ are distinct elements of $\\{1,2,\\dots,2017\\}$ and \n\\[\nx_0 + x_1 + 2x_2 + 3x_3 + \\cdots + 63 x_{63}\n\\]\nis divisible by 2017.\n\\end{itemize}\n\n\\end{document}", "solution": "\\textbf{First solution.}\nThe desired count is $\\frac{2016!}{1953!}- 63! \\cdot 2016$, which we compute using the principle of inclusion-exclusion.\nAs in A2, we use the fact that 2017 is prime; this means that we can do linear algebra over the field $\\mathbb{F}_{2017}$. In particular, every nonzero homogeneous linear equation in $n$ variables over $\\mathbb{F}_{2017}$ has exactly $2017^{n-1}$ solutions.\n\nFor $\\pi$ a partition of $\\{0,\\dots,63\\}$,\nlet $|\\pi|$ denote the number of distinct parts of $\\pi$,\nLet $\\pi_0$ denote the partition of $\\{0,\\dots,63\\}$ into 64 singleton parts.\nLet $\\pi_1$ denote the partition of $\\{0,\\dots,63\\}$ into one 64-element part.\nFor $\\pi, \\sigma$ two partitions of $\\{0,\\dots,63\\}$, write $\\pi | \\sigma$ if $\\pi$ is a refinement of $\\sigma$\n(that is, every part in $\\sigma$ is a union of parts in $\\pi$). By induction on $|\\pi|$, we may construct \na collection of integers $\\mu_\\pi$, one for each $\\pi$, with the properties that\n\\[\n\\sum_{\\pi | \\sigma} \\mu_\\pi = \\begin{cases} 1 & \\sigma = \\pi_0 \\\\ 0 & \\sigma \\neq \\pi_0 \\end{cases}.\n\\]\nDefine the sequence $c_0, \\dots, c_{63}$ by setting $c_0 = 1$ and $c_i = i$ for $i>1$.\nLet $N_\\pi$ be the number of ordered 64-tuples $(x_0,\\dots,x_{63})$ of elements of $\\mathbb{F}_{2017}$\nsuch that  $x_i = x_j$ whenever $i$ and $j$ belong to the same part and\n$\\sum_{i=0}^{63} c_i x_i$ is divisible by 2017. Then $N_\\pi$ equals $2017^{|\\pi|-1}$\nunless for each part $S$ of $\\pi$, the sum $\\sum_{i \\in S} c_i$ vanishes; in that case,\n$N_\\pi$ instead equals $2017^{|\\pi|}$.\nSince $c_0, \\dots, c_{63}$ are positive integers which sum to $1 + \\frac{63 \\cdot 64}{2} = 2017$, the second outcome only occurs for $\\pi = \\pi_1$. By inclusion-exclusion, the desired count may be written as \n\\[\n\\sum_{\\pi} \\mu_\\pi N_\\pi = 2016 \\cdot \\mu_{\\pi_1} + \\sum_{\\pi} \\mu_\\pi 2017^{|\\pi|-1}.\n\\]\nSimilarly, the number of ordered 64-tuples with no repeated elements may be written as\n\\[\n64! \\binom{2017}{64} = \\sum_{\\pi} \\mu_\\pi 2017^{|\\pi|}.\n\\]\nThe desired quantity may thus be written as $\\frac{2016!}{1953!} + 2016 \\mu_{\\pi_1}$.\n\nIt remains to compute $\\mu_{\\pi_1}$. We adopt an approach suggested by David Savitt: apply inclusion-exclusion\nto count distinct 64-tuples in an \\emph{arbitrary} set $A$. As above, this yields\n\\[\n|A|(|A|-1) \\cdots (|A|-63) = \\sum_{\\pi} \\mu_\\pi |A|^{|\\pi|}.\n\\]\nViewing both sides as polynomials in $|A|$ and comparing coefficients in degree 1 yields\n$\\mu_\\pi = -63!$ and thus the claimed answer.\n\n\\noindent\n\\textbf{Second solution.}\n(from Art of Problem Solving, user \\texttt{ABCDE})\nWe first prove an auxiliary result. \n\\begin{lemma*}\nFix a prime $p$ and define the function $f(k)$ on positive integers by the conditions\n\\begin{align*}\nf(1,p) &= 0 \\\\\nf(k,p) &= \\frac{(p-1)!}{(p-k)!} - kf(k-1,p) \\qquad (k>1).\n\\end{align*}\nThen for any positive integers $a_1,\\dots,a_k$ with\n$a_1 + \\cdots + a_k < p$, there are exactly $f(p)$ solutions to the equation $a_1 x_1 + \\cdots + a_k x_k = 0$\nwith $x_1,\\dots,x_k \\in \\mathbb{F}_p$ nonzero and pairwise distinct.\n\\end{lemma*}\n\\begin{proof}\nWe check the claim by induction, with the base case $k=1$ being obvious.\nFor the induction step, assume the claim for $k-1$.\nLet $S$ be the set of $k$-tuples of distinct elements of $\\mathbb{F}_p$;\nit consists of $\\frac{p!}{(p-k)!}$ elements.\nThis set is stable under the action of $i \\in \\mathbb{F}_p$ by translation:\n\\[\n(x_1,\\dots,x_k) \\mapsto (x_1 + i, \\dots, x_k + i).\n\\]\nSince $0 < a_1 \\cdots + a_k < p$, exactly one element of each orbit gives a solution of\n$a_1 x_1 + \\cdots + a_k x_k = 0$. Each of these solutions contributes to $f(k)$ except\nfor those in which $x_i = 0$ for some $i$.\nSince then $x_j \\neq 0$ for all $j \\neq i$, we may apply the induction hypothesis to see that there are\n$f(k-1,p)$ solutions that arise this way for a given $i$ (and these do not overlap).\nThis proves the claim.\n\\end{proof}\n\nTo compute $f(k,p)$ explicitly, it is convenient to work with the auxiliary function\n\\[\ng(k,p) = \\frac{p f(k,p)}{k!};\n\\]\nby the lemma, this satisfies $g(1,p) = 0$ and \n\\begin{align*}\ng(k,p) &= \\binom{p}{k} - g(k-1,p)  \\\\\n&= \\binom{p-1}{k} + \\binom{p-1}{k-1} - g(k-1, p) \\qquad (k>1).\n\\end{align*}\nBy induction on $k$, we deduce that\n\\begin{align*}\ng(k,p) - \\binom{p-1}{k} &= (-1)^{k-1} \\left( g(1,p) - \\binom{p-1}{1} \\right) \\\\\n &= (-1)^k (p-1)\n\\end{align*}\nand hence\n$g(k,p) = \\binom{p-1}{k} + (-1)^k (p-1)$.\n\nWe now set $p=2017$ and count the tuples in question.\nDefine $c_0,\\dots,c_{63}$ as in the first solution. Since $c_0 + \\cdots + c_{63} = p$,\nthe translation action of $\\mathbb{F}_p$ preserves the set of tuples; we may thus assume without loss of generality\nthat $x_0 = 0$ and multiply the count by $p$ at the end. That is, the desired answer is\n\\begin{align*}\n2017 f(63, 2017) &= 63! g(63, 2017) \\\\\n& = 63! \\left( \\binom{2016}{63} - 2016 \\right)\n\\end{align*}\nas claimed.\n\n\\end{itemize}\n\\end{document}", "category": "Combinatorics", "source": "PUTNAM", "year": 2017}
{"id": "putnam-1999-a1", "question": "Find polynomials $f(x)$,$g(x)$, and $h(x)$, if they exist, such\nthat for all $x$,\n\\[\n|f(x)|-|g(x)|+h(x) = \\begin{cases} -1 & \\mbox{if $x<-1$} \\\\\n                     3x+2 & \\mbox{if $-1 \\leq x \\leq 0$} \\\\\n                     -2x+2 & \\mbox{if $x>0$.}\n                     \\end{cases}\n\\]", "solution": "Note that if $r(x)$ and $s(x)$ are any two functions, then\n\\[ \\max(r,s) = (r+s + |r-s|)/2.\\]\nTherefore, if $F(x)$ is the given function, we have\n\\begin{align*}\nF(x)\\ &= \\max\\{-3x-3,0\\}-\\max\\{5x,0\\}+3x+2 \\\\\n      &= (-3x-3+|3x+3|)/2 \\\\\n      & \\qquad - (5x + |5x|)/2 + 3x+2 \\\\\n      &= |(3x+3)/2| - |5x/2| -x + \\frac{1}{2},\n\\end{align*}\nso we may set $f(x)=(3x+3)/2$, $g(x) = 5x/2$, and $h(x)=-x+\\frac{1}{2}$.", "category": "Algebra", "source": "PUTNAM", "year": 1999}
{"id": "putnam-1999-a2", "question": "Let $p(x)$ be a polynomial that is nonnegative for all real $x$.  Prove that\nfor some $k$, there are polynomials $f_1(x),\\dots,f_k(x$) such that\n\\[p(x) =  \\sum_{j=1}^k (f_j(x))^2.\\]", "solution": "First solution:\nFirst factor $p(x) = q(x) r(x)$, where $q$ has all real roots and $r$ has\nall complex roots. Notice that each root of $q$ has even\nmultiplicity, otherwise $p$ would have a sign change at that root.\nThus $q(x)$ has a square root $s(x)$.\n\nNow write $r(x) = \\prod_{j=1}^k (x - a_j)(x - \\overline{a_j})$\n(possible because $r$ has roots in complex conjugate pairs).\nWrite $\\prod_{j=1}^k (x - a_j) = t(x) + i u(x)$ with $t,x$\nhaving real coefficients. Then for $x$ real,\n\\begin{align*}\np(x) &= q(x) r(x) \\\\\n&= s(x)^2 (t(x) + iu(x)) (\\overline{t(x) + iu(x)}) \\\\\n&= (s(x)t(x))^2 + (s(x)u(x))^2.\n\\end{align*}\n(Alternatively, one can factor $r(x)$ as a product of quadratic\npolynomials with real coefficients, write each as a sum of squares, then\nmultiply together to get a sum of many squares.)\n\nSecond solution:\nWe proceed by induction on the degree of $p$, with base case where $p$\nhas degree 0. As in the first solution, we may reduce to a smaller degree\nin case $p$ has any real roots, so assume it has none. Then $p(x) > 0$\nfor all real $x$, and since $p(x) \\to \\infty$ for $x \\to \\pm \\infty$, $p$\nhas a minimum value $c$. Now $p(x) - c$ has real roots, so as above, we\ndeduce that $p(x) - c$ is a sum of squares. Now add one more square,\nnamely $(\\sqrt{c})^2$, to get $p(x)$ as a sum of squares.", "category": "Algebra", "source": "PUTNAM", "year": 1999}
{"id": "putnam-1999-a3", "question": "Consider the power series expansion\n\\[\\frac{1}{1-2x-x^2} = \\sum_{n=0}^\\infty a_n x^n.\\]\nProve that, for each integer $n\\geq 0$, there is an integer $m$ such that\n\\[a_n^2 + a_{n+1}^2 = a_m .\\]", "solution": "First solution:\nComputing the coefficient of $x^{n+1}$ in the identity\n$(1-2x-x^2)\\sum_{m=0}^\\infty a_m x^m = 1$ yields the recurrence\n$a_{n+1} = 2a_n + a_{n-1}$; the sequence $\\{a_n\\}$ is then characterized\nby this recurrence and the initial conditions $a_0 = 1, a_1 = 2$.\n\nDefine the sequence $\\{b_n\\}$ by\n$b_{2n} = a_{n-1}^2 + a_n^2,~b_{2n+1} = a_n(a_{n-1}+a_{n+1}).$\nThen\n\\begin{align*}\n2b_{2n+1}+b_{2n} &= 2a_na_{n+1}+2a_{n-1}a_n+a_{n-1}^2+a_n^2 \\\\\n&= 2a_na_{n+1} + a_{n-1}a_{n+1} + a_n^2 \\\\\n&= a_{n+1}^2 + a_n^2 = b_{2n+2},\n\\end{align*}\nand similarly $2b_{2n}+b_{2n-1} = b_{2n+1}$, so that $\\{b_n\\}$ satisfies\nthe same recurrence as $\\{a_n\\}$.  Since further $b_0=1,b_1=2$ (where\nwe use the recurrence for $\\{a_n\\}$ to calculate $a_{-1}=0$),\nwe deduce that $b_n=a_n$ for all $n$.  In particular,\n$a_n^2+a_{n+1}^2 = b_{2n+2} = a_{2n+2}$.\n\nSecond solution:\nNote that\n\\begin{multline*}\n\\frac{1}{1-2x-x^2} \\\\\n\\qquad = \\frac{1}{2\\sqrt{2}} \\left(\n\\frac{\\sqrt{2}+1}{1-(1+\\sqrt{2})x} + \\frac{\\sqrt{2}-1}{1-(1-\\sqrt{2})x}\n\\right)\n\\end{multline*}\nand that\n\\[\n\\frac{1}{1 + (1\\pm\\sqrt{2})x} = \\sum_{n=0}^\\infty (1\\pm\\sqrt{2})^n x^n,\n\\]\nso that\n\\[\na_n = \\frac{1}{2\\sqrt{2}} \\left((\\sqrt{2}+1)^{n+1} - (1-\\sqrt{2})^{n+1}\n\\right).\n\\]\nA simple computation (omitted here) now shows that\n$a_n^2 + a_{n+1}^2 = a_{2n+2}$.\n\nThird solution (by Richard Stanley):\nLet $A$ be the matrix $\\begin{pmatrix} 0 & 1 \\\\1 & 2 \\end{pmatrix}$.\nA simple induction argument shows that\n\\[\nA^{n+2} = \\begin{pmatrix} a_n & a_{n+1} \\\\ a_{n+1} & a_{n+2}\n\\end{pmatrix}.\n\\]\nThe desired result now follows from comparing the top left corner\nentries of the equality $A^{n+2} A^{n+2} = A^{2n+4}$.", "category": "Algebra", "source": "PUTNAM", "year": 1999}
{"id": "putnam-1999-a4", "question": "Sum the series\n\\[\\sum_{m=1}^\\infty \\sum_{n=1}^\\infty \\frac{m^2 n}{3^m(n3^m+m3^n)}.\\]", "solution": "Denote the series by $S$, and let $a_n = 3^n/n$.  Note that\n\\begin{align*}\nS &= \\sum_{m=1}^\\infty \\sum_{n=1}^\\infty \\frac{1}\n{a_m(a_m+a_n)} \\\\\n&= \\sum_{m=1}^\\infty \\sum_{n=1}^\\infty \\frac{1}{a_n(a_m+a_n)},\n\\end{align*}\nwhere the second equality follows by interchanging $m$ and $n$.\nThus\n\\begin{align*}\n2S &= \\sum_m \\sum_n \\left( \\frac{1}{a_m(a_m+a_n)} +\n\\frac{1}{a_n(a_m+a_n)}\\right) \\\\\n&= \\sum_m \\sum_n \\frac{1}{a_m a_n} \\\\\n&= \\left( \\sum_{n=1}^\\infty \\frac{n}{3^n} \\right)^2.\n\\end{align*}\nBut\n\\[\n\\sum_{n=1}^\\infty \\frac{n}{3^n} = \\frac34\n\\]\nsince, e.g., it's $f'(1)$,\nwhere\n\\[\nf(x) = \\sum_{n=0}^\\infty \\frac{x^n}{3^n} = \\frac{3}{3-x},\n\\]\nand we conclude that $S = 9/32$.", "category": "Combinatorics", "source": "PUTNAM", "year": 1999}
{"id": "putnam-1999-a5", "question": "Prove that there is a constant $C$ such that, if $p(x)$ is a polynomial\nof degree 1999, then\n\\[|p(0)|\\leq C \\int_{-1}^1 |p(x)|\\,dx.\\]", "solution": "First solution: (by Reid Barton)\nLet $r_1, \\dots, r_{1999}$ be the roots of $P$. Draw a disc of radius\n$\\epsilon$ around each $r_i$, where $\\epsilon < 1/3998$; this\ndisc covers a subinterval of $[-1/2,1/2]$\nof length at most $2\\epsilon$, and so of the 2000 (or fewer) uncovered\nintervals in $[-1/2,1/2]$,\none, which we call $I$, has length at least $\\delta = (1-3998\\epsilon)/2000\n> 0$.\nWe will exhibit an explicit lower bound for the integral of $|P(x)|/P(0)$ over this\ninterval, which will yield such a bound for the entire integral.\n\nNote that\n\\[\n\\frac{|P(x)|}{|P(0)|} = \\prod_{i=1}^{1999} \\frac{|x-r_i|}{|r_i|}.\n\\]\nAlso note that by construction, $|x - r_i| \\geq \\epsilon$ for each $x \\in I$.\nIf $|r_i| \\leq 1$, then we have $\\frac{|x-r_i|}{|r_i|} \\geq \\epsilon$. If $|r_i| > 1$, then\n\\[\n\\frac{|x-r_i|}{|r_i|} = |1 - x/r_i| \\geq 1 - |x/r_i| \\geq = 1/2\n> \\epsilon.\n\\]\nWe conclude that $\\int_I |P(x)/P(0)|\\,dx \\geq \\delta \\epsilon$,\nindependent of $P$.\n\nSecond solution:\nIt will be a bit more convenient to assume $P(0) = 1$ (which we\nmay achieve by rescaling unless $P(0)=0$, in which case\nthere is nothing to prove) and to prove that there exists $D>0$\nsuch that $\\int_{-1}^1 |P(x)|\\,dx \\geq D$, or even\nsuch that $\\int_0^1 |P(x)|\\,dx \\geq D$.\n\nWe first reduce to the case where $P$ has all of its roots in\n$[0,1]$. If this is not the case, we can\nfactor $P(x)$ as $Q(x) R(x)$, where $Q$ has all roots in\nthe interval and $R$ has none. Then $R$ is either always\npositive or always negative on $[0,1]$; assume the former.\nLet $k$ be the largest positive real number such that\n$R(x) - kx \\geq 0$ on $[0,1]$; then\n\\begin{align*}\n\\int_{-1}^1 |P(x)|\\,dx &= \\int_{-1}^1 |Q(x)R(x)|\\,dx \\\\\n&> \\int_{-1}^1 |Q(x)(R(x)-kx)|\\,dx,\n\\end{align*}\nand $Q(x)(R(x)-kx)$ has more roots in $[0,1]$ than does $P$\n(and has the same value at 0).\nRepeating this argument shows that $\\int_{0}^1 |P(x)|\\,dx$\nis greater than the corresponding integral for some polynomial\nwith all of its roots in $[0,1]$.\n\nUnder this assumption, we have\n\\[\nP(x) = c \\prod_{i=1}^{1999} (x-r_i)\n\\]\nfor some $r_i \\in (0,1]$. Since\n\\[\nP(0) = -c \\prod r_i = 1,\n\\]\nwe have\n\\[\n|c| \\geq \\prod |r_i^{-1}| \\geq 1.\n\\]\n\nThus it suffices to prove that if $Q(x)$ is a \\emph{monic} polynomial\nof degree 1999 with all of its roots in $[0,1]$,\nthen $\\int_0^1 |Q(x)|\\,dx \\geq D$ for some constant $D>0$. But the\nintegral of $\\int_0^1 \\prod_{i=1}^{1999} |x-r_i|\\,dx$ is a continuous\nfunction for $r_i \\in [0,1]$. The product of all of these intervals is\ncompact, so the integral achieves a minimum value for some $r_i$. This\nminimum is the desired $D$.\n\nThird solution (by Abe Kunin):\nIt suffices to prove the stronger inequality\n\\[\n\\sup_{x \\in [-1,1]} |P(x)| \\leq C \\int_{-1}^1 |P(x)|\\,dx\n\\]\nholds for some $C$.\nBut this follows immediately from the following standard fact: any two\nnorms on a finite-dimensional vector space (here the polynomials of\ndegree at most 1999) are equivalent. (The proof of this statement is also\na compactness argument: $C$ can be taken to be the maximum of the\nL1-norm divided by the sup norm over the set of polynomials with\nL1-norm 1.)\n\nNote: combining the first two approaches gives a constructive solution with\na constant that is better than that given by the first solution,\nbut is still far from optimal. I don't know\noffhand whether it is even known what the optimal constant and/or the\npolynomials achieving that constant are.", "category": "Algebra", "source": "PUTNAM", "year": 1999}
{"id": "putnam-1999-a6", "question": "The sequence $(a_n)_{n\\geq 1}$ is defined by $a_1=1, a_2=2, a_3=24,$ and, for $n\\geq 4$,\n\\[a_n = \\frac{6a_{n-1}^2a_{n-3} -\n8a_{n-1}a_{n-2}^2}{a_{n-2}a_{n-3}}.\\]\nShow that, for all n, $a_n$ is an integer multiple of $n$.", "solution": "Rearranging the given equation yields the much more tractable equation\n\\[\n\\frac{a_n}{a_{n-1}} = 6 \\, \\frac{a_{n-1}}{a_{n-2}}\n- 8 \\, \\frac{a_{n-2}}{a_{n-3}}.\n\\]\nLet $b_n = a_n/a_{n-1}$; with the initial conditions $b_2 = 2, b_3 = 12$,\none easily obtains $b_n = 2^{n-1} (2^{n-2} - 1)$, and so\n\\[\na_n = 2^{n(n-1)/2} \\prod_{i=1}^{n-1} (2^i - 1).\n\\]\n\nTo see that $n$ divides $a_n$, factor $n$ as $2^k m$, with $m$\nodd. Then note that $k \\leq n \\leq n(n-1)/2$, and that there\nexists $i \\leq m-1$ such that $m$ divides $2^i-1$, namely $i =\n\\phi(m)$ (Euler's totient function: the number of integers in\n$\\{1, \\dots, m\\}$ relatively prime to $m$).", "category": "Algebra", "source": "PUTNAM", "year": 1999}
{"id": "putnam-1999-b1", "question": "Right triangle $ABC$ has right angle at $C$ and $\\angle BAC =\\theta$;\nthe point $D$ is chosen on $AB$ so that $|AC|=|AD|=1$; the point $E$\nis chosen on $BC$ so that $\\angle CDE = \\theta$.  The perpendicular\nto $BC$ at $E$ meets $AB$ at $F$.  Evaluate $\\lim_{\\theta\\rightarrow 0}\n|EF|$.", "solution": "The answer is 1/3.\nLet $G$ be the point obtained by reflecting $C$ about the line $AB$.\nSince $\\angle ADC = \\frac{\\pi-\\theta}{2}$, we find that\n$\\angle BDE = \\pi - \\theta - \\angle ADC = \\frac{\\pi-\\theta}{2}\n= \\angle ADC = \\pi - \\angle BDC = \\pi - \\angle BDG$, so that $E,D,G$\nare collinear.  Hence\n\\[\n|EF| = \\frac{|BE|}{|BC|} = \\frac{|BE|}{|BG|} = \\frac{\\sin\n(\\theta/2)}{\\sin (3\\theta/2)},\n\\]\nwhere we have used the law of sines in $\\triangle BDG$.  But by\nl'H\\^opital's Rule,\n\\[\n\\lim_{\\theta \\rightarrow 0}\n\\frac{\\sin(\\theta/2)}{\\sin(3\\theta/2)} =\n\\lim_{\\theta \\rightarrow 0}\n\\frac{\\cos(\\theta/2)}{3\\cos(3\\theta/2)} = 1/3.\n\\]", "category": "Geometry", "source": "PUTNAM", "year": 1999}
{"id": "putnam-1999-b2", "question": "Let $P(x)$ be a polynomial of degree $n$ such that $P(x)=Q(x)P''(x)$,\nwhere $Q(x)$ is a quadratic polynomial and $P''(x)$ is the second\nderivative of $P(x)$.  Show that if $P(x)$ has at least two distinct\nroots then it must have $n$ distinct roots.", "solution": "First solution:\nSuppose that $P$ does not have $n$ distinct roots; then it has\na root of multiplicity at least $2$, which we may assume is $x=0$\nwithout loss of generality.  Let $x^k$ be the greatest power of $x$\ndividing $P(x)$, so that $P(x) = x^k R(x)$ with $R(0) \\neq 0$;\na simple computation yields\n\\[\nP''(x) = (k^2-k)x^{k-2} R(x) + 2kx^{k-1} R'(x) + x^k R''(x).\n\\]\nSince $R(0) \\neq 0$ and $k\\geq 2$, we conclude that the greatest power of $x$\ndividing $P''(x)$ is $x^{k-2}$.  But $P(x) = Q(x) P''(x)$, and so\n$x^2$ divides $Q(x)$.\nWe deduce (since $Q$ is quadratic)\nthat $Q(x)$ is a constant $C$ times $x^2$; in fact, $C=1/(n(n-1))$ by\ninspection of the leading-degree terms of $P(x)$ and $P''(x)$.\n\nNow if $P(x) = \\sum_{j=0}^n a_j x^j$, then the relation\n$P(x) = Cx^2 P''(x)$ implies that $a_j = Cj(j-1)a_j$ for all $j$;\nhence $a_j = 0$ for $j \\leq n-1$, and we conclude that $P(x) = a_n x^n$,\nwhich has all identical roots.\n\nSecond solution (by Greg Kuperberg): Let $f(x) = P''(x)/P(x) = 1/Q(x)$. By\nhypothesis, $f$ has at most two poles (counting multiplicity).\n\nRecall that for any complex polynomial $P$, the roots of $P'$ lie within the convex\nhull of $P$. To show this, it suffices to show that if the roots of $P$ lie on one\nside of a line, say on the positive side of the imaginary axis, then $P'$ has no\nroots on the other side. That follows because if $r_1, \\dots, r_n$ are the roots of $P$,\n\\[\n\\frac{P'(z)}{P(z)} = \\sum_{i=1}^n \\frac{1}{z-r_i}\n\\]\nand if $z$ has negative real part, so does $1/(z-r_i)$ for $i=1, \\dots, n$,\nso the sum is nonzero.\n\nThe above argument also carries through if $z$ lies on the\nimaginary axis, provided that $z$ is not equal to a root of $P$. Thus we also have that\nno roots of $P'$ lie on the sides of the convex hull of $P$, unless they are also\nroots of $P$.\n\nFrom this we conclude that if $r$ is a root of $P$ which is a vertex of the convex hull\nof the roots, and\nwhich is not also a root of $P'$,\nthen $f$ has a single pole at $r$ (as $r$ cannot be a root of $P''$).\nOn the other hand, if $r$ is a root of $P$ which is also a root of $P'$, it\nis a multiple root, and then $f$ has a double pole at $r$.\n\nIf $P$ has roots not all equal, the convex hull of its roots has at least two\nvertices.", "category": "Algebra", "source": "PUTNAM", "year": 1999}
{"id": "putnam-1999-b3", "question": "Let $A=\\{(x,y):0\\leq x,y<1\\}$.  For $(x,y)\\in A$, let\n\\[S(x,y) = \\sum_{\\frac{1}{2}\\leq \\frac{m}{n}\\leq 2} x^m y^n,\\]\nwhere the sum ranges over all pairs $(m,n)$ of positive integers\nsatisfying the indicated inequalities.  Evaluate\n\\[\\lim_{(x,y)\\rightarrow (1,1), (x,y)\\in A} (1-xy^2)(1-x^2y)S(x,y).\\]", "solution": "We first note that\n\\[\n\\sum_{m,n > 0} x^m y^n = \\frac{xy}{(1-x)(1-y)}.\n\\]\nSubtracting $S$ from this gives two sums, one of which is\n\\[\n\\sum_{m \\geq 2n+1} x^m y^n = \\sum_n y^n \\frac{x^{2n+1}}{1-x}\n= \\frac{x^3y}{(1-x)(1-x^2y)}\n\\]\nand the other of which sums to $xy^3/[(1-y)(1-xy^2)]$. Therefore\n\\begin{align*}\nS(x,y) &= \\frac{xy}{(1-x)(1-y)} - \\frac{x^3y}{(1-x)(1-x^2y)} \\\\\n&\\qquad - \\frac{xy^3}{(1-y)(1-xy^2)} \\\\\n&= \\frac{xy(1+x+y+xy-x^2y^2)}{(1-x^2y)(1-xy^2)}\n\\end{align*}\nand the desired limit is\n\\[\n\\lim_{(x,y) \\to (1,1)} xy(1+x+y+xy-x^2y^2) = 3.\n\\]", "category": "Combinatorics", "source": "PUTNAM", "year": 1999}
{"id": "putnam-1999-b4", "question": "Let $f$ be a real function with a continuous third derivative such that $f(x),\nf'(x), f''(x), f'''(x)$ are positive for all $x$.  Suppose that\n$f'''(x)\\leq f(x)$ for all $x$.  Show that $f'(x)<2f(x)$ for all $x$.", "solution": "\\setcounter{equation}{0}\n(based on work by Daniel Stronger)\nWe make repeated use of the following fact: if $f$ is a differentiable function on all of\n$\\RR$, $\\lim_{x \\to -\\infty} f(x) \\geq 0$, and $f'(x) > 0$ for all $x \\in \\RR$, then\n$f(x) > 0$ for all $x \\in \\RR$. (Proof: if $f(y) < 0$ for some $x$, then $f(x)< f(y)$ for all\n$x<y$ since $f'>0$, but then $\\lim_{x \\to -\\infty} f(x) \\leq f(y) < 0$.)\n\nFrom the inequality $f'''(x) \\leq f(x)$ we obtain\n\\[\nf'' f'''(x) \\leq f''(x) f(x) < f''(x) f(x) + f'(x)^2\n\\]\nsince $f'(x)$ is positive. Applying the fact to the difference between the right and left sides,\nwe get\n\\begin{equation}\n\\frac{1}{2} (f''(x))^2 < f(x) f'(x).\n\\end{equation}\n\nOn the other hand, since $f(x)$ and $f'''(x)$ are both positive for all $x$,\nwe have\n\\[\n2f'(x) f''(x) < 2f'(x)f''(x) + 2f(x) f'''(x).\n\\]\nApplying the fact to the difference between the sides yields\n\\begin{equation}\nf'(x)^2 \\leq 2f(x) f''(x).\n\\end{equation}\nCombining (1) and (2), we obtain\n\\begin{align*}\n\\frac{1}{2} \\left( \\frac{f'(x)^2}{2f(x)} \\right)^2\n&< \\frac{1}{2} (f''(x))^2 \\\\\n&< f(x) f'(x),\n\\end{align*}\nor $(f'(x))^3 < 8 f(x)^3$. We conclude $f'(x) < 2f(x)$, as desired.\n\nNote: one can actually prove the result with a smaller constant in place of\n2, as follows. Adding $\\frac{1}{2} f'(x) f'''(x)$ to both sides\nof (1) and again invoking the original bound\n$f'''(x) \\leq f(x)$, we get\n\\begin{align*}\n\\frac{1}{2} [f'(x) f'''(x) + (f''(x))^2] &< f(x) f'(x) + \\frac{1}{2} f'(x) f'''(x) \\\\\n&\\leq \\frac{3}{2} f(x) f'(x).\n\\end{align*}\nApplying the fact again, we get\n\\[\n\\frac{1}{2} f'(x) f''(x) < \\frac{3}{4} f(x)^2.\n\\]\nMultiplying both sides by $f'(x)$ and applying the fact once more, we get\n\\[\n\\frac{1}{6} (f'(x))^3 < \\frac{1}{4} f(x)^3.\n\\]\nFrom this we deduce $f'(x) < (3/2)^{1/3} f(x) < 2f(x)$, as desired.\n\nI don't know what the best constant is, except that it is not less than 1\n(because $f(x) = e^x$ satisfies the given conditions).", "category": "Algebra", "source": "PUTNAM", "year": 1999}
{"id": "putnam-1999-b5", "question": "For an integer $n\\geq 3$, let $\\theta=2\\pi/n$.  Evaluate the determinant of the\n$n\\times n$ matrix $I+A$, where $I$ is the $n\\times n$ identity matrix and\n$A=(a_{jk})$ has entries $a_{jk}=\\cos(j\\theta+k\\theta)$ for all $j,k$.", "solution": "First solution:\nWe claim that the eigenvalues of $A$ are $0$ with multiplicity $n-2$,\nand $n/2$ and $-n/2$, each with multiplicity $1$.  To prove this claim,\ndefine vectors $v^{(m)}$, $0\\leq m\\leq n-1$, componentwise by\n$(v^{(m)})_k = e^{ikm\\theta}$, and note that the $v^{(m)}$ form a basis\nfor $\\CC^n$.  (If we arrange the $v^{(m)}$ into an $n\\times n$ matrix,\nthen the determinant of this matrix is a Vandermonde product which is\nnonzero.)  Now note that\n\\begin{align*}\n(Av^{(m)})_j &= \\sum_{k=1}^n \\cos(j\\theta+k\\theta) e^{ikm\\theta} \\\\\n&= \\frac{e^{ij\\theta}}{2} \\sum_{k=1}^n e^{ik(m+1)\\theta}\n+ \\frac{e^{-ij\\theta}}{2} \\sum_{k=1}^n e^{ik(m-1)\\theta}.\n\\end{align*}\nSince $\\sum_{k=1}^n e^{ik\\ell\\theta} = 0$ for integer $\\ell$ unless\n$n\\,|\\,\\ell$, we conclude that $Av^{(m)}=0$ for $m=0$ or for\n$2 \\leq m \\leq n-1$.  In addition, we find that $(Av^{(1)})_j =\n\\frac{n}{2} e^{-ij\\theta} = \\frac{n}{2}(v^{(n-1)})_j$ and $(Av^{(n-1)})_j =\n\\frac{n}{2} e^{ij\\theta} = \\frac{n}{2}(v^{(1)})_j$, so that\n$A(v^{(1)} \\pm v^{(n-1)}) = \\pm \\frac{n}{2} (v^{(1)} \\pm v^{(n-1)})$.\nThus $\\{v^{(0)},v^{(2)},v^{(3)},\\ldots,v^{(n-2)},\nv^{(1)}+v^{(n-1)},v^{(1)}-v^{(n-1)}\\}$ is a basis for $\\CC^n$ of\neigenvectors of $A$ with the claimed eigenvalues.\n\nFinally, the determinant of $I+A$ is the product of $(1+\\lambda)$\nover all eigenvalues $\\lambda$ of $A$; in this case,\n$\\det (I+A) = (1+n/2)(1-n/2) = 1-n^2/4$.\n\nSecond solution (by Mohamed Omar): Set $x = e^{i \\theta}$ and write\n\\[\nA = \\frac{1}{2} u^T u + \\frac{1}{2} v^T v = \\frac{1}{2} \\begin{pmatrix} u^T& v^T \\end{pmatrix}\n\\begin{pmatrix} u \\\\ v \\end{pmatrix}\n\\]\nfor\n\\[\nu = \\begin{pmatrix} x & x^2 & \\cdots & x^n \\end{pmatrix},\nv = \\begin{pmatrix} x^{-1} & x^{-2} & \\cdots & x^n \\end{pmatrix}.\n\\]\nWe now use the fact that for $R$ an $n \\times m$ matrix and $S$ an $m \\times n$ matrix,\n\\[\n\\det (I_n + RS) = \\det(I_m + SR).\n\\]\nThis yields\n\\begin{align*}\n&\\det(I_N + A) \\\\\n&\\quad = \\det \\left( I_n + \\frac{1}{2} \\begin{pmatrix} u^T & v^T \\end{pmatrix}\n\\begin{pmatrix} u \\\\ v \\end{pmatrix} \\right) \\\\\n&\\quad = \\det \\left( I_2 + \\frac{1}{2} \\begin{pmatrix} u \\\\ v \\end{pmatrix}\\begin{pmatrix} u^T & v^T \\end{pmatrix}\n \\right) \\\\\n &\\quad = \\frac{1}{4} \\det \\begin{pmatrix} 2 + u u^T & uv^T \\\\\n vu^T & 2 + vv^T \\end{pmatrix} \\\\\n &\\quad = \\frac{1}{4} \\det \\begin{pmatrix} 2 + (x^2 + \\cdots + x^{2n}) & n \\\\\n n & 2 + (x^{-2} + \\cdots + x^{-2n}) \\end{pmatrix} \\\\\n  &\\quad = \\frac{1}{4} \\det \\begin{pmatrix} 2 & n \\\\\n n & 2 \\end{pmatrix} = 1 - \\frac{n^2}{4}.\n\\end{align*}", "category": "Algebra", "source": "PUTNAM", "year": 1999}
{"id": "putnam-1999-b6", "question": "Let $S$ be a finite set of integers, each greater than 1.  Suppose that\nfor each integer $n$ there is some $s\\in S$ such that $\\gcd(s,n)=1$ or\n$\\gcd(s,n)=s$.  Show that there exist $s,t\\in S$ such that $\\gcd(s,t)$\nis prime.\n\n\\end{itemize}\n\\end{document}", "solution": "First solution:\nChoose a sequence $p_1, p_2, \\dots$ of primes as follows. Let $p_1$ be any prime\ndividing an element of $S$. To define $p_{j+1}$ given $p_1, \\dots, p_j$,\nchoose an integer $N_j \\in S$ relatively prime to $p_1 \\cdots p_j$ and let\n$p_{j+1}$ be a prime divisor of $N_j$, or stop if no such $N_j$ exists.\n\nSince $S$ is finite, the above algorithm eventually terminates in a finite\nsequence $p_1, \\dots, p_k$.\nLet $m$ be the smallest integer such that $p_1 \\cdots p_m$ has a divisor in $S$.\n(By the assumption on $S$ with $n=p_1\\cdots p_k$,\n$m=k$ has this property, so $m$ is well-defined.)\nIf $m=1$, then $p_1\\in S$, and we are done, so assume $m\\geq 2$.\nAny divisor $d$ of $p_1\\cdots p_m$ in $S$ must be a multiple of $p_m$, or else\nit would also be a divisor of $p_1 \\cdots p_{m-1}$, contradicting the choice\nof $m$. But now $\\gcd(d, N_{m-1}) = p_m$, as desired.\n\nSecond solution (from \\texttt{sci.math}):\nLet $n$ be the smallest integer such that $\\gcd(s,n) > 1$ for all $s$ in\n$n$; note that $n$ obviously has no repeated prime factors.\nBy the condition on $S$, there exists $s \\in S$ which divides $n$.\n\nOn the other hand, if $p$ is a prime divisor of $s$, then by the choice\nof $n$, $n/p$ is relatively prime to some element $t$ of $S$. Since $n$ cannot\nbe relatively prime to $t$, $t$ is divisible by $p$, but not by any other\nprime divisor of $n$ (as those primes divide $n/p$). Thus $\\gcd(s,t) = p$,\nas desired.\n\n\\end{itemize}\n\n\\end{document}", "category": "Number Theory", "source": "PUTNAM", "year": 1999}
{"id": "imo-2001-q1", "question": "Let $ABC$ be an acute-angled triangle with $O$ as its circumcenter.\nLet $P$ on line $BC$ be the foot of the altitude from $A$.\nAssume that $\\angle BCA \\ge \\angle ABC + 30\\dg$.\nProve that $\\angle CAB + \\angle COP < 90\\dg$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p119192}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be an acute-angled triangle with $O$ as its circumcenter.\nLet $P$ on line $BC$ be the foot of the altitude from $A$.\nAssume that $\\angle BCA \\ge \\angle ABC + 30\\dg$.\nProve that $\\angle CAB + \\angle COP < 90\\dg$.\n\\end{mdframed}\nThe conclusion rewrites as\n\\begin{align*}\n  \\angle COP &< 90\\dg - \\angle A = \\angle OCP \\\\\n  \\iff PC &< PO \\\\\n  \\iff PC^2 &< PO^2 \\\\\n  \\iff PC^2 &< R^2 - PB \\cdot PC \\\\\n  \\iff PC \\cdot BC &< R^2 \\\\\n  \\iff ab \\cos C  &< R^2 \\\\\n  \\iff \\sin A \\sin B \\cos C & < \\frac14.\n\\end{align*}\nNow\n\\[ \\cos C \\sin B\n  = \\half \\left( \\sin(C+B)-\\sin(C-B) \\right)\n  \\le \\half \\left( 1 - \\half \\right) = \\frac 14 \\]\nwhich finishes when combined with $\\sin A < 1$.\n\n\\begin{remark*}\n  If we allow $ABC$ to be right then\n  equality holds when $\\angle A = 90\\dg$,\n  $\\angle C = 60\\dg$, $\\angle B = 30\\dg$.\n  This motivates the choice of estimates\n  after reducing to a trig inequality.\n\\end{remark*}\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2001}
{"id": "imo-2001-q2", "question": "Let $a$, $b$, $c$ be positive reals. Prove that\n\\[ \\frac{a}{\\sqrt{a^2+8bc}} + \\frac{b}{\\sqrt{b^2+8ca}} + \\frac{c}{\\sqrt{c^2+8ab}} \\ge 1. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p119168}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a$, $b$, $c$ be positive reals. Prove that\n\\[ \\frac{a}{\\sqrt{a^2+8bc}} + \\frac{b}{\\sqrt{b^2+8ca}} + \\frac{c}{\\sqrt{c^2+8ab}} \\ge 1. \\]\n\\end{mdframed}\nBy Holder, we have\n\\[\n  \\left( \\sum_{\\text{cyc}} \\frac{a}{\\sqrt{a^2+8bc}} \\right)^2\n  \\left( \\sum_{\\text{cyc}} a(a^2+8bc) \\right)\n  \\ge (a+b+c)^3.\n\\]\nSo it suffices to show $(a+b+c)^3 \\ge a^3+b^3+c^3+24abc$ which is clear by expanding.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2001}
{"id": "imo-2001-q3", "question": "Twenty-one girls and twenty-one boys took part in a mathematical competition.\nIt turned out that each contestant solved at most six problems,\nand for each pair of a girl and a boy,\nthere was at least one problem that was solved by both the girl and the boy.\nShow that there is a problem that was solved by at least three girls and at least three boys.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p119191}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nTwenty-one girls and twenty-one boys took part in a mathematical competition.\nIt turned out that each contestant solved at most six problems,\nand for each pair of a girl and a boy,\nthere was at least one problem that was solved by both the girl and the boy.\nShow that there is a problem that was solved by at least three girls and at least three boys.\n\\end{mdframed}\nWe will show the contrapositive.\nThat is, assume that\n\\begin{itemize}\n  \\ii For each pair of a girl and a boy,\n  there was at least one problem that was\n  solved by both the girl and the boy.\n  \\ii Assume every problem is either solved\n  mostly by girls (at most two boys)\n  or mostly by boys (at most two girls).\n\\end{itemize}\nThen we will prove that then some contestant\nsolved more than six problems.\n\nCreate a $21 \\times 21$ grid with boys as columns\nand girls as rows, and in each cell\nwrite the name of a problem solved by the pair.\nColor the cell \\textbf{green} if at most two girls solved that problem,\nand color it \\textbf{blue} if at most two boys solved that problem.\n(G for girl, B for boy.\nIt's possible both colors are used for some cell.)\n\nWLOG, there are more green cells than blue,\nso (by pigeonhole) take a column (boy) with that property.\nThat means the boy's column has at least $11$ green squares.\nBy hypothesis, those corresponds to at least $6$ different problems\nsolved. Now there are two cases:\n\\begin{itemize}\n  \\ii If there are any blue-only squares,\n  then that square means a seventh distinct problems.\n  \\ii If the entire column is green,\n  then among the $21$ green squares\n  there are at least $11$ distinct problems solved\n  in that column.\n\\end{itemize}\n\n\\begin{remark*}\nThe number $21$ cannot be decreased.\nHere is an example of $20$ boys and $20$ girls\nwho solve problems named $A$-$J$\nand $0$-$9$, which motivates the solution to begin with.\n\\begin{center}\n\\scriptsize \\ttfamily\n{\\color{green}0000000000}{\\color{blue}AABBCCDDEE} \\\\\n{\\color{green}0000000000}{\\color{blue}AABBCCDDEE} \\\\\n{\\color{green}1111111111}{\\color{blue}AABBCCDDEE} \\\\\n{\\color{green}1111111111}{\\color{blue}AABBCCDDEE} \\\\\n{\\color{green}2222222222}{\\color{blue}AABBCCDDEE} \\\\\n{\\color{green}2222222222}{\\color{blue}AABBCCDDEE} \\\\\n{\\color{green}3333333333}{\\color{blue}AABBCCDDEE} \\\\\n{\\color{green}3333333333}{\\color{blue}AABBCCDDEE} \\\\\n{\\color{green}4444444444}{\\color{blue}AABBCCDDEE} \\\\\n{\\color{green}4444444444}{\\color{blue}AABBCCDDEE} \\\\\n{\\color{blue}FFGGHHIIJJ}{\\color{green}5555555555} \\\\\n{\\color{blue}FFGGHHIIJJ}{\\color{green}5555555555} \\\\\n{\\color{blue}FFGGHHIIJJ}{\\color{green}6666666666} \\\\\n{\\color{blue}FFGGHHIIJJ}{\\color{green}6666666666} \\\\\n{\\color{blue}FFGGHHIIJJ}{\\color{green}7777777777} \\\\\n{\\color{blue}FFGGHHIIJJ}{\\color{green}7777777777} \\\\\n{\\color{blue}FFGGHHIIJJ}{\\color{green}8888888888} \\\\\n{\\color{blue}FFGGHHIIJJ}{\\color{green}8888888888} \\\\\n{\\color{blue}FFGGHHIIJJ}{\\color{green}9999999999} \\\\\n{\\color{blue}FFGGHHIIJJ}{\\color{green}9999999999}\n\\end{center}\n\\end{remark*}\n\n\\begin{remark*}\n  This took me embarrassingly long,\n  but part of the work of the problem seemed to be\n  finding the right ``data structure'' to get a foothold.\n  I think the grid is good because we want to fill each intersection,\n  then we consider for each cell a problem to put.\n\n  I initially wanted to capture the full data by writing\n  in each green cell the row index of the other girl who solved it,\n  and similarly for the blue cells.\n  (That led naturally to the colors, there were two types of cells.)\n  This was actually helpful for finding the equality case above,\n  but once I realized the equality case\n  I also realized that I could discard the extra information\n  and only remember the colors.\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Combinatorics", "source": "IMO", "year": 2001}
{"id": "imo-2001-q4", "question": "Let $n > 1$ be an odd integer and let $c_1$, $c_2$, \\dots, $c_n$ be integers.\nFor each permutation $a = (a_1, a_2, \\dots, a_n)$\nof $\\{1,2,\\dots,n\\}$, define $S(a) = \\sum_{i=1}^n c_i a_i$.\nProve that there exist two permutations $a \\neq b$\nof $\\{1,2,\\dots,n\\}$ such that $n!$ is a divisor of $S(a)-S(b)$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p119174}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n > 1$ be an odd integer and let $c_1$, $c_2$, \\dots, $c_n$ be integers.\nFor each permutation $a = (a_1, a_2, \\dots, a_n)$\nof $\\{1,2,\\dots,n\\}$, define $S(a) = \\sum_{i=1}^n c_i a_i$.\nProve that there exist two permutations $a \\neq b$\nof $\\{1,2,\\dots,n\\}$ such that $n!$ is a divisor of $S(a)-S(b)$.\n\\end{mdframed}\nAssume for contradiction that all the $S(a)$ are distinct modulo $n!$.\nThen summing across all permutations gives\n\\begin{align*}\n  1 + 2 + \\dots + n!\n  &\\equiv \\sum_a S(a) \\\\\n  &= \\sum_a \\sum_{i=1}^n c_i a_i \\\\\n  &= \\sum_{i=1}^n c_i \\sum_a a_i \\\\\n  &= \\sum_{i=1}^n c_i \\cdot \\left( (n-1)! \\cdot (1+\\dots+n) \\right) \\\\\n  &= (n-1)! \\cdot \\frac{n(n+1)}{2} \\sum_{i=1}^n c_i \\\\\n  &= n! \\cdot \\frac{n+1}{2} \\sum_{i=1}^n c_i \\\\\n  &\\equiv 0\n\\end{align*}\nsince $\\half(n+1)$ is an integer.\nBut on the other hand\n$1 + 2 + \\dots + n! = \\frac{n!(n!+1)}{2}$\nwhich is not divisible by $n!$ if $n > 1$,\nas the quotient is the non-integer $\\frac{n!+1}{2}$.\nThis is a contradiction.\n\\pagebreak", "category": "Combinatorics", "source": "IMO", "year": 2001}
{"id": "imo-2001-q5", "question": "Let $ABC$ be a triangle.\nLet $\\ol{AP}$ bisect $\\angle BAC$ and let $\\ol{BQ}$ bisect $\\angle ABC$,\nwith $P$ on $\\ol{BC}$ and $Q$ on $\\ol{AC}$.\nIf $AB + BP = AQ + QB$ and $\\angle BAC = 60\\dg$,\nwhat are the angles of the triangle?", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p119207}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle.\nLet $\\ol{AP}$ bisect $\\angle BAC$ and let $\\ol{BQ}$ bisect $\\angle ABC$,\nwith $P$ on $\\ol{BC}$ and $Q$ on $\\ol{AC}$.\nIf $AB + BP = AQ + QB$ and $\\angle BAC = 60\\dg$,\nwhat are the angles of the triangle?\n\\end{mdframed}\nThe answer is $\\angle B = 80\\dg$ and $\\angle C = 40\\dg$.\nSet $x = \\angle ABQ = \\angle QBC$, so that $\\angle QCB = 120\\dg - 2x$.\nWe observe $\\angle AQB = 120\\dg - x$ and $\\angle APB = 150\\dg - 2x$.\n\n\\begin{center}\n\\begin{asy}\n  pair A = dir(130);\n  pair B = dir(210);\n  pair C = dir(330);\n  pair I = incenter(A, B, C);\n  pair P = extension(A, I, B, C);\n  pair Q = extension(B, I, A, C);\n\n  dot(\"$A$\", A, dir(A));\n  dot(\"$B$\", B, dir(B));\n  dot(\"$C$\", C, dir(C));\n  dot(\"$P$\", P, dir(P));\n  dot(\"$Q$\", Q, dir(Q));\n\n  draw(A--B--C--cycle);\n  draw(A--P);\n  draw(B--Q);\n\n  label(\"$30^\\circ$\", A+0.3*dir((pair)incenter(B,A,P)-A));\n  label(\"$30^\\circ$\", A+0.3*dir((pair)incenter(P,A,C)-A));\n  label(rotate(-20)*\"$120^\\circ-2x$\", C+0.3*dir((pair)incenter(A,C,B)-C));\n  label(\"$x$\", B+0.2*dir((pair)incenter(C,B,Q)-B));\n  label(\"$x$\", B+0.2*dir((pair)incenter(Q,B,A)-B));\n\\end{asy}\n\\end{center}\n\nNow by the law of sines, we may compute\n\\begin{align*}\n  BP &= AB \\cdot \\frac{\\sin 30\\dg}{\\sin (150\\dg- 2x)}  \\\\\n  AQ &= AB \\cdot \\frac{\\sin x}{\\sin (120\\dg- x)}  \\\\\n  QB &= AB \\cdot \\frac{\\sin 60\\dg}{\\sin (120\\dg- x)}.\n\\end{align*}\nSo, the relation $AB + BP = AQ + QB$ is exactly\n\\[ 1 + \\frac{\\sin 30\\dg}{\\sin (150\\dg - 2x)}\n= \\frac{\\sin x + \\sin 60\\dg}{\\sin (120\\dg - x)}. \\]\nThis is now a trig problem, and we simply solve for $x$.\nThere are many possible approaches\nand we just present one.\n\nFirst of all, we can write\n\\[ \\sin x + \\sin 60\\dg\n  = 2\\sin \\left( \\half (x+60\\dg) \\right)\n  \\cos \\left( \\half (x-60\\dg) \\right). \\]\nOn the other hand, $\\sin (120\\dg - x) = \\sin(x+60\\dg)$ and\n\\[ \\sin (x+60\\dg)\n  = 2 \\sin \\left( \\half (x+60\\dg) \\right)\n  \\cos \\left( \\half(x+60\\dg) \\right) \\]\nso\n\\[ \\frac{\\sin x + \\sin 60\\dg}{\\sin (120\\dg - x)}\n  = \\frac{\\cos \\left( \\half x - 30\\dg \\right)}%\n  {\\cos \\left( \\half x + 30\\dg \\right)}. \\]\nLet $y = \\half x$ for brevity now. Then\n\\begin{align*}\n  \\frac{\\cos(y-30\\dg)}{\\cos(y+30\\dg)} - 1\n  &= \\frac{\\cos(y-30\\dg)-\\cos(y+30\\dg)}{\\cos(y+30\\dg)} \\\\\n  &= \\frac{2 \\sin (30\\dg) \\sin y}{\\cos(y+30\\dg)} \\\\\n  &= \\frac{\\sin y}{\\cos (y+30\\dg)}.\n\\end{align*}\nHence the problem is just\n\\begin{align*}\n  \\frac{\\sin 30\\dg}{\\sin(150\\dg - 4y)} &= \\frac{\\sin y}{\\cos(y+30\\dg)}. \\\\\n  \\intertext{Equivalently,}\n  \\cos(y+30\\dg) &= 2\\sin y \\sin (150\\dg -4y) \\\\\n  &= \\cos(5y-150\\dg) - \\cos(150\\dg-3y) \\\\\n  &= -\\cos(5y+30\\dg) + \\cos(3y+30\\dg).\n\\end{align*}\nNow we are home free, because $3y+30\\dg$\nis the average of $y+30\\dg$ and $5y+30\\dg$.\nThat means we can write\n\\[ \\frac{\\cos(y+30\\dg)+\\cos(5y+30\\dg)}{2} = \\cos(3y+30\\dg) \\cos(2y). \\]\nHence\n\\[ \\cos(3y+30\\dg) \\left( 2\\cos(2y)-1 \\right) = 0. \\]\nRecall that\n\\[ y = \\half x = \\frac 14 \\angle B\n  < \\frac 14 \\left( 180\\dg - \\angle A \\right) = 30\\dg. \\]\nHence it is not possible that $\\cos(2y) = \\half$,\nsince the smallest positive value of $y$\nthat satisfies this is $y=30\\dg$.\nSo $\\cos (3y+30\\dg) = 0$.\n\nThe only permissible value of $y$ is then $y = 20\\dg$,\ngiving $\\angle B = 80\\dg$ and $\\angle C = 40\\dg$.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2001}
{"id": "imo-2001-q6", "question": "Let $a > b > c > d > 0$ be integers satisfying\n\\[ ac + bd = (b+d+a-c)(b+d-a+c).  \\]\nProve that $ab + cd$ is not prime.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p119217}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a > b > c > d > 0$ be integers satisfying\n\\[ ac + bd = (b+d+a-c)(b+d-a+c).  \\]\nProve that $ab + cd$ is not prime.\n\\end{mdframed}\nThe problem condition is equivalent to\n\\[ ac + bd = (b+d)^2 - (a-c)^2 \\]\nor\n\\[ a^2-ac+c^2 = b^2+bd+d^2. \\]\n\nLet us construct a quadrilateral $WXYZ$ such that\n$WX = a$, $XY = c$, $YZ = b$, $ZW = d$,\nand \\[ WY = \\sqrt{a^2-ac+c^2} = \\sqrt{b^2+bd+d^2}.\\]\nThen by the law of cosines, we obtain $\\angle WXY = 60\\dg$\nand $\\angle WZY = 120\\dg$.\nHence this quadrilateral is cyclic.\n\n\\begin{center}\n  \\begin{asy}\n    pair X = dir(110);\n    pair W = dir(210);\n    pair Y = dir(330);\n    pair Z = dir(280);\n    draw(unitcircle, blue);\n    draw(W--X--Y--Z--cycle);\n    draw(W--Y, red);\n\n    pair a = midpoint(W--X);\n    pair c = midpoint(X--Y);\n    pair b = midpoint(Y--Z);\n    pair d = midpoint(Z--W);\n\n    dot(\"$X$\", X, dir(X));\n    dot(\"$W$\", W, dir(W));\n    dot(\"$Y$\", Y, dir(Y));\n    dot(\"$Z$\", Z, dir(Z));\n\n    label(\"$a$\", a, dir(a));\n    label(\"$b$\", b, -dir(b));\n    label(\"$c$\", c, dir(c));\n    label(\"$d$\", d, -dir(d));\n    label(minipage(\"\\begin{align*} & \\sqrt{a^2-ac+c^2} \\\\ =& \\sqrt{b^2+bd+d^2}\\end{align*}\"), (W+Y)/2, dir(90), red);\n  \\end{asy}\n\\end{center}\n\nBy the more precise version of Ptolemy's theorem,\nwe find that\n\\[ WY^2 = \\frac{(ab+cd)(ad+bc)}{ac+bd}. \\]\n\nNow assume for contradiction that that $ab+cd$ is a prime $p$.\nRecall that we assumed $a > b > c > d$.\nIt follows, for example by rearrangement inequality, that\n\\[ p = ab+cd > ac+bd > ad+bc. \\]\nLet $y = ac+bd$ and $x = ad+bc$ now.\nThe point is that \\[ p \\cdot \\frac xy \\]\ncan never be an integer if $p$ is prime and $x < y < p$.\nBut $WY^2 = a^2-ac+c^2$ is clearly an integer, and this is a contradiction.\n\nHence $ab+cd$ cannot be prime.\n\n\\begin{remark*}\n  It may be tempting to try to apply the more typical form of\n  Ptolemy to get $ab+cd = WY \\cdot XZ$;\n  the issue with this approach is that $WY$ and $XZ$ are usually not integers.\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Number Theory", "source": "IMO", "year": 2001}
{"id": "usamo-2010-q1", "question": "Let $AXYZB$ be a convex pentagon inscribed in a semicircle of diameter $AB$.\nDenote by $P$, $Q$, $R$, $S$ the feet of the perpendiculars\nfrom $Y$ onto lines $AX$, $BX$, $AZ$, $BZ$, respectively.\nProve that the acute angle formed by lines $PQ$ and $RS$ is half the size of $\\angle XOZ$,\nwhere $O$ is the midpoint of segment $AB$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1860802}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $AXYZB$ be a convex pentagon inscribed in a semicircle of diameter $AB$.\nDenote by $P$, $Q$, $R$, $S$ the feet of the perpendiculars\nfrom $Y$ onto lines $AX$, $BX$, $AZ$, $BZ$, respectively.\nProve that the acute angle formed by lines $PQ$ and $RS$ is half the size of $\\angle XOZ$,\nwhere $O$ is the midpoint of segment $AB$.\n\\end{mdframed}\nWe present two possible approaches.\nThe first approach is just ``bare-hands'' angle chasing.\nThe second approach requires more insight but makes it clearer what is going on;\nit shows the intersection point of lines $PQ$ and $RS$ is the foot\nfrom the altitude from $Y$ to $AB$ using Simson lines.\nThe second approach also has the advantage that it works even if $\\ol{AB}$\nis not a diameter of the circle.\n\n\\paragraph{First approach using angle chasing.}\nDefine $T = \\ol{PQ} \\cap \\ol{RS}$.\nAlso, let $2\\alpha$, $2\\beta$, $2\\gamma$, $2\\delta$ denote the measures of arcs\n$\\arc{AX}$, $\\arc{XY}$, $\\arc{YZ}$, $\\arc{ZB}$, respectively,\nso that $\\alpha + \\beta + \\gamma + \\delta = 90\\dg$.\n\n\\begin{center}\n\\begin{asy}\npair A = dir(180);\npair B = dir(0);\npair X = dir(140);\npair Y = dir(100);\npair Z = dir(60);\n\npair P = foot(Y, A, X);\npair Q = foot(Y, B, X);\npair R = foot(Y, A, Z);\npair S = foot(Y, B, Z);\n\npair T = extension(P, Q, R, S);\n\ndraw(A--X--Y--Z--B, orange);\nfilldraw(unitcircle, opacity(0.1)+orange, red);\n\ndraw(Y--P, red);\ndraw(Y--Q, red);\ndraw(Y--R, red);\ndraw(Y--S, red);\ndraw(P--X--B, brown);\ndraw(P--T--S, red);\ndraw(S--Z--A, brown);\n\npair O = origin;\ndraw(arc(O, B, Z), blue+1.3, Margin(2,2));\ndraw(arc(O, Z, Y), blue+1.3, Margin(2,2));\ndraw(arc(O, Y, X), blue+1.3, Margin(2,2));\ndraw(arc(O, X, A), blue+1.3, Margin(2,2));\n\nlabel(\"$2\\alpha$\", dir(160), dir(160), blue);\nlabel(\"$2\\beta$\",  dir(122), dir(122), blue);\nlabel(\"$2\\gamma$\", dir( 82), dir( 82), blue);\nlabel(\"$2\\delta$\", dir( 30), dir( 30), blue);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$X$\", X, dir(X));\ndot(\"$Y$\", Y, dir(Y));\ndot(\"$Z$\", Z, dir(Z));\ndot(\"$P$\", P, dir(P));\ndot(\"$Q$\", Q, dir(210));\ndot(\"$R$\", R, dir(340));\ndot(\"$S$\", S, dir(S));\ndot(\"$T$\", T, dir(-90));\n\n/* TSQ Source:\n\nA = dir 180\nB = dir 0\nX = dir 140\nY = dir 100\nZ = dir 60\n\nP = foot Y A X\nQ = foot Y B X\nR = foot Y A Z\nS = foot Y B Z\n\nT = extension P Q R S\n\nA--X--Y--Z--B orange\nunitcircle 0.1 orange / red\n\nY--P red\nY--Q red\nY--R red\nY--S red\nP--X--B brown\nP--T--S red\nS--Z--A brown\n\n*/\n\\end{asy}\n\\end{center}\nWe now compute the following angles:\n\\begin{align*}\n  \\angle SRY &= \\angle SZY = 90\\dg - \\angle YZA = 90\\dg - (\\alpha + \\beta) \\\\\n  \\angle YQP &= \\angle YXP = 90\\dg - \\angle BXY = 90\\dg - (\\gamma + \\delta) \\\\\n  \\angle QYR &= 180\\dg - \\angle (\\ol{ZR}, \\ol{QX})\n    = 180\\dg - \\frac{2\\beta + 2\\gamma + 180\\dg}{2} = 90\\dg - (\\beta + \\gamma).\n\\end{align*}\nHence, we can then compute\n\\begin{align*}\n  \\angle RTQ &= 360\\dg - \\left(\n    \\angle QYR + (180\\dg - \\angle SRY) + (180\\dg - \\angle YQP) \\right) \\\\\n  &= \\angle SRY + \\angle YQP - \\angle QYR \\\\\n  &= \\left( 90\\dg - (\\alpha + \\beta) \\right) + \\left( 90\\dg - (\\gamma + \\delta) \\right)\n    - \\left( 90\\dg - (\\beta + \\gamma) \\right) \\\\\n  &= 90\\dg - (\\alpha + \\delta) \\\\\n  &= \\beta + \\gamma.\n\\end{align*}\nSince $\\angle XOZ = \\frac{2\\beta+2\\gamma}{2} = \\beta+\\gamma$, the proof is complete.\n\n\n\\paragraph{Second approach using Simson lines, ignoring the diameter condition.}\nIn this solution, we will ignore the condition that $\\ol{AB}$ is a diameter;\nthe solution works equally well without it,\nas long as $O$ is redefined as the center of $(AXYZB)$ instead.\nWe will again show the angle formed by lines $PQ$ and $RS$ is half the measure of $\\arc{XZ}$.\n\nUnlike the previous solution, we instead define $T$ to be the foot from $Y$ to $\\ol{AB}$.\nThen the Simson line of $Y$ with respect to $\\triangle XAB$ passes through $P$, $Q$, $T$.\nSimilarly, the Simson line of $Y$ with respect to $\\triangle ZAB$ passes through $R$, $S$, $T$.\nTherefore, point $T$ coincides with $\\ol{PQ} \\cap \\ol{RS}$.\n\n\\begin{center}\n\\begin{asy}\npair A = dir(205);\npair B = -conj(A);\npair X = dir(140);\npair Y = dir(100);\npair Z = dir(60);\n\npair P = foot(Y, A, X);\npair Q = foot(Y, B, X);\npair R = foot(Y, A, Z);\npair S = foot(Y, B, Z);\n\npair T = extension(P, Q, R, S);\n\ndraw(A--X--Y--Z--B, orange);\nfilldraw(unitcircle, opacity(0.1)+orange, red);\n\ndraw(Y--P, red);\ndraw(Y--Q, red);\ndraw(Y--R, red);\ndraw(Y--S, red);\ndraw(P--X--B, brown);\ndraw(P--T--S, red);\ndraw(S--Z--A, brown);\n\ndraw(A--B, deepcyan+1.4);\ndraw(Y--T, deepcyan+1.4);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$X$\", X, dir(X));\ndot(\"$Y$\", Y, dir(Y));\ndot(\"$Z$\", Z, dir(Z));\ndot(\"$P$\", P, dir(P));\ndot(\"$Q$\", Q, dir(210));\ndot(\"$R$\", R, dir(340));\ndot(\"$S$\", S, dir(S));\ndot(\"$T$\", T, dir(-90));\n\n/* TSQ Source:\n\nA = dir 180\nB = dir 0\nX = dir 140\nY = dir 100\nZ = dir 60\n\nP = foot Y A X\nQ = foot Y B X\nR = foot Y A Z\nS = foot Y B Z\n\nT = extension P Q R S\n\nA--X--Y--Z--B orange\nunitcircle 0.1 orange / red\n\nY--P red\nY--Q red\nY--R red\nY--S red\nP--X--B brown\nP--T--S red\nS--Z--A brown\n\n*/\n\\end{asy}\n\\end{center}\n\nNow it's straightforward to see $APYRT$ is cyclic (in the circle with diameter $\\ol{AY}$),\nand therefore\n\\[ \\angle RTY = \\angle RAY = \\angle ZAY. \\]\nSimilarly,\n\\[ \\angle YTQ = \\angle YBQ = \\angle YBX. \\]\nSumming these gives $\\angle RTQ$ is equal to half the measure of arc $\\arc{XZ}$ as needed.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2010}
{"id": "usamo-2010-q2", "question": "There are $n$ students standing in a circle, one behind the other.\nThe students have heights $h_1<h_2<\\dots <h_n$.\nIf a student with height $h_k$ is standing directly\nbehind a student with height $h_{k-2}$ or less,\nthe two students are permitted to switch places.\nProve that it is not possible to make more than\n$\\binom{n}{3}$ such switches\nbefore reaching a position in which no\nfurther switches are possible.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1860777}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nThere are $n$ students standing in a circle, one behind the other.\nThe students have heights $h_1<h_2<\\dots <h_n$.\nIf a student with height $h_k$ is standing directly\nbehind a student with height $h_{k-2}$ or less,\nthe two students are permitted to switch places.\nProve that it is not possible to make more than\n$\\binom{n}{3}$ such switches\nbefore reaching a position in which no\nfurther switches are possible.\n\\end{mdframed}\nThe main claim is the following observation,\nwhich is most motivated in the situation $j-i = 2$.\n\\begin{claim*}\n  The students with heights $h_i$ and $h_j$\n  switch at most $|j-i|-1$ times.\n\\end{claim*}\n\\begin{proof}\n  By induction on $d = |j-i|$, assuming $j > i$.\n  For $d = 1$ there is nothing to prove.\n\n  For $d \\ge 2$, look at only students $h_j$, $h_{i+1}$\n  and $h_{i}$ ignoring all other students.\n  After $h_j$ and $h_i$ switch the first time,\n  the relative ordering of the students must be\n  $h_i \\to h_j \\to h_{i+1}$.\n  Thereafter $h_j$ must always switch with $h_{i+1}$\n  before switching with $h_i$,\n  so the inductive hypothesis applies to give the bound\n  $1 + j - (i+1) - 1 = j-i - 1$.\n\\end{proof}\nHence, the number of switches is at most\n\\[ \\sum_{1 \\le i < j \\le n} \\left( |j-i| - 1 \\right) = \\binom n3. \\]\n\\pagebreak", "category": "Combinatorics", "source": "USAMO", "year": 2010}
{"id": "usamo-2010-q3", "question": "The $2010$ positive real numbers $a_1$, $a_2$, \\dots , $a_{2010}$\nsatisfy the inequality $a_i a_j \\le i+j$\nfor all $1 \\le i < j \\le 2010$.\nDetermine, with proof, the largest possible value\nof the product $a_1a_2\\dots a_{2010}$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1860806}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nThe $2010$ positive real numbers $a_1$, $a_2$, \\dots , $a_{2010}$\nsatisfy the inequality $a_i a_j \\le i+j$\nfor all $1 \\le i < j \\le 2010$.\nDetermine, with proof, the largest possible value\nof the product $a_1a_2\\dots a_{2010}$.\n\\end{mdframed}\nThe answer is $3 \\times 7 \\times 11 \\times \\dots \\times 4019$,\nwhich is clearly an upper bound\n(and it's not too hard to show this is the lowest\nnumber we may obtain by multiplying $1005$ equalities together;\nthis is essentially the rearrangement inequality).\nThe tricky part is the construction.\nIntuitively we want $a_i \\approx \\sqrt{2i}$,\nbut the details require significant care.\n\nNote that if this is achievable,\nwe will require $a_n a_{n+1} = 2n+1$ for all odd $n$.\nHere are two constructions:\n\\begin{itemize}\n\\ii One can take the sequence such that $a_{2008} a_{2010} = 4018$\n  and $a_n a_{n+1} = 2n+1$ for all $n = 1, 2, \\dots, 2009$.\n  This can be shown to work by some calculation. As an illustrative example,\n  \\[ a_1 a_4 = \\frac{a_1a_2 \\cdot a_3a_4}{a_2a_3} = \\frac{3 \\cdot 7}{5} < 5. \\]\n\n\\ii In fact one can also take $a_n = \\sqrt{2n}$ for all even $n$\n  (and hence $a_{n-1} = \\sqrt{2n} - \\frac{1}{\\sqrt{2n}}$ for such even $n$).\n\\end{itemize}\n\n\\begin{remark*}\nThis is a chief example of an ``abstract'' restriction-based approach.\nOne can motivate it in three steps:\n\\begin{itemize}\n\\ii The bound $3 \\cdot 7 \\cdot \\dots \\cdot 4019$ is provably best possible\nupper bound by pairing the inequalities;\nalso the situation with $2010$ replaced by $4$\nis constructible with bound $21$.\n\\ii We have $a_n \\approx \\sqrt{2n}$ heuristically;\nin fact $a_n = \\sqrt{2n}$ satisfies inequalities by AM-GM.\n\\ii So we are most worried about $a_i a_j \\le i+j$\nwhen $|i-j|$ is small, like $|i-j| = 1$.\n\\end{itemize}\nI then proceeded to spend five hours on various constructions,\nbut it turns out that the right thing to do was just require\n$a_k a_{k+1} = 2k+1$, to make sure these pass:\nand the problem almost solves itself.\n\\end{remark*}\n\n\\begin{remark*}\n  When $2010$ is replaced by $4$\n  it is not too hard to manually write an explicit example:\n  say $a_1 = \\frac{\\sqrt3}{1.1}$, $a_2 = 1.1\\sqrt3$,\n  $a_3 = \\frac{\\sqrt7}{1.1}$ and $a_4 = 1.1\\sqrt7$.\n  So this is a reason one might guess that\n  $3 \\times 7 \\times \\dots \\times 4019$\n  can actually be achieved in the large case.\n\\end{remark*}\n\n\\begin{remark*}\n  Victor Wang says:\n  I believe we can actually prove that WLOG (!) assume $a_i a_{i+1} = 2i+1$\n  for all $i$ (but there are other ways to motivate that as well,\n  like linear programming after taking logs),\n  which makes things a bit simpler to think about.\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Algebra", "source": "USAMO", "year": 2010}
{"id": "usamo-2010-q4", "question": "Let $ABC$ be a triangle with $\\angle A = 90\\dg$.\nPoints $D$ and $E$ lie on sides $AC$ and $AB$, respectively,\nsuch that $\\angle ABD = \\angle DBC$ and $\\angle ACE = \\angle ECB$.\nSegments $BD$ and $CE$ meet at $I$.\nDetermine whether or not it is possible for segments $AB$, $AC$, $BI$, $ID$, $CI$, $IE$\nto all have integer lengths.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1860753}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle with $\\angle A = 90\\dg$.\nPoints $D$ and $E$ lie on sides $AC$ and $AB$, respectively,\nsuch that $\\angle ABD = \\angle DBC$ and $\\angle ACE = \\angle ECB$.\nSegments $BD$ and $CE$ meet at $I$.\nDetermine whether or not it is possible for segments $AB$, $AC$, $BI$, $ID$, $CI$, $IE$\nto all have integer lengths.\n\\end{mdframed}\nThe answer is no.\nWe prove that it is not even possible that $AB$, $AC$, $CI$, $IB$ are all integers.\n\n\\begin{center}\n  \\begin{asy}\n    size(5cm);\n    pair B = dir(140);\n    pair A = conj(B);\n    pair C = -B;\n    filldraw(A--B--C--cycle, opacity(0.1)+lightblue, blue);\n    pair I = incenter(A, B, C);\n    pair D = extension(B, I, A, C);\n    pair E = extension(C, I, A, B);\n    draw(B--D);\n    draw(C--E);\n    filldraw(incircle(A,B,C), opacity(0.1)+lightred, red+dotted);\n\n    dot(\"$B$\", B, dir(B));\n    dot(\"$A$\", A, dir(A));\n    dot(\"$C$\", C, dir(C));\n    dot(\"$I$\", I, dir(45));\n    dot(\"$D$\", D, dir(D));\n    dot(\"$E$\", E, dir(E));\n\n    /* Source generated by TSQ */\n  \\end{asy}\n\\end{center}\n\nFirst, we claim that $\\angle BIC = 135\\dg$.\nTo see why, note that\n\\[ \\angle IBC + \\angle ICB = \\frac{\\angle B}{2} + \\frac{\\angle C}{2}\n  = \\frac{90\\dg}{2} = 45\\dg. \\]\nSo, $\\angle BIC = 180\\dg - (\\angle IBC + \\angle ICB) = 135\\dg$, as desired.\n\nWe now proceed by contradiction.\nThe Pythagorean theorem implies\n\\[ BC^2 = AB^2 + AC^2 \\]\nand so $BC^2$ is an integer.\nHowever, the law of cosines gives\n\\begin{align*}\n  BC^2 &= BI^2 + CI^2 - 2 BI \\cdot CI \\cos \\angle BIC \\\\\n  &= BI^2 + CI^2 + BI \\cdot CI \\cdot \\sqrt 2.\n\\end{align*}\nwhich is irrational, and this produces the desired contradiction.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2010}
{"id": "usamo-2010-q5", "question": "Let $q = \\frac{3p-5}{2}$ where $p$ is an odd prime, and let\n\\[ S_q = \\frac{1}{2\\cdot 3 \\cdot 4} + \\frac{1}{5\\cdot 6 \\cdot 7}\n+ \\dots + \\frac{1}{q(q+1)(q+2)}. \\]\nProve that if $\\frac{1}{p}-2S_q = \\frac{m}{n}$ for integers $m$ and $n$,\nthen $m - n$ is divisible by $p$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1860791}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $q = \\frac{3p-5}{2}$ where $p$ is an odd prime, and let\n\\[ S_q = \\frac{1}{2\\cdot 3 \\cdot 4} + \\frac{1}{5\\cdot 6 \\cdot 7}\n+ \\dots + \\frac{1}{q(q+1)(q+2)}. \\]\nProve that if $\\frac{1}{p}-2S_q = \\frac{m}{n}$ for integers $m$ and $n$,\nthen $m - n$ is divisible by $p$.\n\\end{mdframed}\nBy partial fractions, we have\n\\[\n  \\frac{2}{(3k-1)(3k)(3k+1)}\n  = \\frac{1}{3k-1} - \\frac{2}{3k} + \\frac{1}{3k+1}.\n\\]\nThus\n\\begin{align*}\n  2S_q\n  &= \\left( \\frac12 - \\frac23 + \\frac14 \\right)\n  + \\left( \\frac 15 - \\frac26 + \\frac17 \\right)\n  + \\dots\n  + \\left( \\frac1q - \\frac2{q+1} + \\frac{1}{q+2} \\right) \\\\\n  &= \\left( \\half + \\frac13 + \\frac14 + \\dots + \\frac{1}{q+2} \\right)\n  - 3\\left( \\frac13 + \\frac 16 + \\dots + \\frac{1}{q+1} \\right) \\\\\n  &= \\left( \\half + \\frac13 + \\frac14 + \\dots + \\frac{1}{q+2} \\right)\n  - \\left( \\frac11 + \\frac 12 + \\dots + \\frac{1}{\\frac{q+1}{3}} \\right) \\\\\n  \\implies 2S_q - \\frac1p + 1\n  &=  \\left( \\frac11 + \\frac12 + \\dots + \\frac{1}{p-1} \\right)\n  + \\left( \\frac{1}{p+1} + \\frac{1}{p+2} \\dots + \\frac{1}{q+2} \\right)\n  - \\left( \\frac11 + \\frac 12 + \\dots + \\frac{1}{\\frac{q+1}{3}} \\right)\n\\end{align*}\n\nNow we are ready to take modulo $p$.\nThe given says that $q-p+2 = \\frac{q+1}{3}$, so\n\\begin{align*}\n  2S_q - \\frac1p + 1\n  &=  \\left( \\frac11 + \\frac12 + \\dots + \\frac{1}{p-1} \\right)\n  + \\left( \\frac{1}{p+1} + \\frac{1}{p+2} + \\dots + \\frac{1}{q+2} \\right)\n  - \\left( \\frac11 + \\frac 12 + \\dots + \\frac{1}{\\frac{q+1}{3}} \\right) \\\\\n  &\\equiv  \\left( \\frac11 + \\frac12 + \\dots + \\frac{1}{p-1} \\right)\n  + \\left( \\frac11 + \\frac12 + \\dots + \\frac{1}{q-p+2} \\right)\n  - \\left( \\frac11 + \\frac 12 + \\dots + \\frac{1}{\\frac{q+1}{3}} \\right) \\\\\n  &= \\frac11 + \\frac12+ \\dots + \\frac{1}{p-1} \\\\\n  &\\equiv 0 \\pmod p.\n\\end{align*}\n\nSo $\\frac1p - 2S_q \\equiv 1 \\pmod p$ which is the desired.\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 2010}
{"id": "usamo-2010-q6", "question": "There are $68$ ordered pairs (not necessarily distinct)\nof nonzero integers on a blackboard.\nIt's known that for no integer $k$ does both $(k,k)$ and $(-k,-k)$ appear.\nA student erases some of the $136$ integers such that\nno two erased integers have sum zero, and scores one point\nfor each ordered pair with at least one erased integer.\nWhat is the maximum possible score the student can guarantee?", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1860794}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nThere are $68$ ordered pairs (not necessarily distinct)\nof nonzero integers on a blackboard.\nIt's known that for no integer $k$ does both $(k,k)$ and $(-k,-k)$ appear.\nA student erases some of the $136$ integers such that\nno two erased integers have sum zero, and scores one point\nfor each ordered pair with at least one erased integer.\nWhat is the maximum possible score the student can guarantee?\n\\end{mdframed}\nThe answer is $43$.\n\nThe structure of this problem is better understood as follows:\nwe construct a multigraph whose vertices are the entries,\nand the edges are the $68$ ordered pairs on the blackboard.\nTo be precise, construct a multigraph $G$ with vertices\n$a_1$, $b_1$, \\dots, $a_n$, $b_n$,\nwith $a_i = -b_i$ for each $i$.\nThe ordered pairs then correspond to $68$ edges in $G$,\nwith self-loops allowed (WLOG) only for vertices $a_i$.\nThe student may then choose one of $\\{a_i, b_i\\}$ for each $i$\nand wishes to maximize the number of edges adjacent\nto the set of chosen vertices.\n\n\\begin{center}\n\\begin{asy}\nsize(5cm);\npair a1 = (-1,6);\npair b1 = (1,6);\npair a2 = (-1,4);\npair b2 = (1,4);\npair a3 = (-1,2);\npair b3 = (1,2);\npair a4 = (-1,0);\npair b4 = (1,0);\n\ndraw(a1--a2, red);\ndraw(a1--b3, red);\ndraw(a3--b2, red);\ndraw(b1..(0.7,4)..b3, red);\ndraw(circle(a2+0.24*dir(0), 0.24), heavycyan);\ndraw(circle(a2+0.28*dir(0), 0.28), heavycyan);\ndraw(circle(a3+0.25*dir(0), 0.25), heavycyan);\ndraw(a4--b3, red);\ndraw(a4..(0,0.7)..b3, red);\ndraw(a4--b4, red);\n\ndot(\"$3$\", a1, dir(180));\ndot(\"$7$\", a2, dir(180));\ndot(\"$8$\", a3, dir(180));\ndot(\"$2$\", a4, dir(180));\ndot(\"$-3$\", b1, dir(0));\ndot(\"$-7$\", b2, dir(0));\ndot(\"$-8$\", b3, dir(0));\ndot(\"$-2$\", b4, dir(0));\n\\end{asy}\n\\end{center}\n\nFirst we use the probabilistic method to show $N \\ge 43$.\nWe select the real number $p = \\frac{\\sqrt5-1}{2} \\approx 0.618$\nsatisfying $p = 1-p^2$.\nFor each $i$ we then select $a_i$ with probability $p$\nand $b_i$ with probability $1-p$.\nThen\n\\begin{itemize}\n  \\ii Every self-loop $(a_i, a_i)$ is chosen with probability $p$.\n  \\ii Any edge $(b_i, b_j)$ is chosen with probability $1-p^2$.\n\\end{itemize}\nAll other edges are selected with probability at least $p$,\nso in expectation we have $68p \\approx 42.024$ edges scored.\nHence $N \\ge 43$.\n\n(Properly speaking, to prove that $68p > 42$ without decimal approximation, note that\n\\[ 68p > 42 \\iff -34 + 34\\sqrt5 > 42 \\iff 34 \\sqrt 5 > 76 \\iff 17^2 \\cdot 5 > 38^2 \\]\nwhich is true since $17^2 \\cdot 5 = 1445$ and $38^2 = 1444$.)\n\nFor a construction showing $43$ is optimal, we let $n = 8$,\nand put five self-loops on each $a_i$,\nwhile taking a single $K_8$ on the $b_i$'s.\nThe score achieved for selecting $m$ of the $a_i$'s\nand $8-m$ of the $b_i$'s is\n\\[ 5m + \\left( \\binom82-\\binom m2 \\right) \\le 43 \\]\nwith equality when either $m=5$ and $m=6$.\n\n\\begin{remark*}\n  [Colin Tang]\n  Here is one possible motivation for\n  finding the construction.\n  In equality case we probably want\n  all the edges to either be $a_i$ loops or $b_i b_j$ edges.\n  Now if $b_i$ and $b_j$ are not joined by an edge,\n  one can ``merge them together'',\n  also combining the corresponding $a_i$'s,\n  to get another multigraph with $68$ edges\n  whose optimal score is at most the original ones.\n  So by using this smoothing algorithm,\n  we can reduce to a situation where the $b_i$ and $b_j$\n  are all connected to each other.\n\n  It's not unnatural to assume it's a clique then,\n  at which point fiddling with parameters gives the construction.\n  Also, there is a construction for $\\left\\lceil 2/3 n \\right\\rceil$\n  which is not too difficult to find,\n  and applying this smoothing operation to this construction\n  could suggest a clique of at least $8$ vertices too.\n\\end{remark*}\n\n\\begin{remark*}\n  [David Lee]\n  One could consider changing the probability $p(n)$\n  to be a function of the number $n$ of non-loops\n  (hence there are $68-n$ loops);\n  we would then have\n  \\[ \\mathbb E[\\text{points}]\n    \\ge (68-n)p(n) + n(1-p(n)^2). \\]\n  The optimal value of $p(n)$ is then\n  \\[\n    p(n) = \\begin{cases}\n      \\frac{68-n}{2n} = \\frac{34}{n} - \\half & n \\ge 23 \\\\\n      1 & n < 22.\n    \\end{cases}\n  \\]\n  For $n > 23$ we then have\n  \\begin{align*}\n    E(n) = & (68-n)\\left( \\frac{34}{n}-\\half \\right)\n  + n\\left( 1-\\left( \\frac{34}{n}-\\half \\right)^2 \\right) \\\\\n    &= \\frac{5n}{4} + \\frac{34^2}{n} - 34\n  \\end{align*}\n  which has its worst case at around $5n^2 = 68^2$,\n  so at $n=30$ and $n=31$.\n  Indeed, one can find\n  \\begin{align*}\n    E(30) &= 42.033 \\\\\n    E(31) &= 42.040.\n  \\end{align*}\n  This gives another way to get the lower bound $43$,\n  and gives a hint about approximately how many non-loops\n  one would want in order to achieve such a bound.\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "USAMO", "year": 2010}
{"id": "usamo-2008-q1", "question": "Prove that for each positive integer $n$,\nthere are pairwise relatively prime integers $k_0$, \\dots, $k_n$,\nall strictly greater than $1$, such that\n$k_0k_1 \\dots k_n - 1$ is the product of two consecutive integers.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1116186}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nProve that for each positive integer $n$,\nthere are pairwise relatively prime integers $k_0$, \\dots, $k_n$,\nall strictly greater than $1$, such that\n$k_0k_1 \\dots k_n - 1$ is the product of two consecutive integers.\n\\end{mdframed}\nIn other words, if we let\n\\[ P(x) = x(x+1) + 1 \\]\nthen we would like there to be infinitely many primes\ndividing some $P(t)$ for some integer $t$.\n\nIn fact, this result is true in much greater generality.\nWe first state:\n\\begin{theorem}\n  [Schur's theorem]\n  If $P(x) \\in \\ZZ[x]$ is nonconstant and $P(0) = 1$,\n  then there are infinitely many primes\n  which divide $P(t)$ for some integer $t$.\n\\end{theorem}\n\\begin{proof}\n  If $P(0) = 0$, this is clear.\n  So assume $P(0) = c \\neq 0$.\n\n  Let $S$ be any finite set of prime numbers.\n  Consider then the value\n  \\[ P\\left(k \\prod_{p \\in S} p\\right) \\]\n  for some integer $k$.\n  It is $1 \\pmod p$ for each prime $p$,\n  and if $k$ is large enough it should not be equal to $1$\n  (because $P$ is not constant).\n  Therefore, it has a prime divisor not in $S$.\n\\end{proof}\n\\begin{remark*}\n  In fact the result holds without the assumption $P(0) \\neq 1$.\n  The proof requires only small modifications,\n  and a good exercise would be to write down a similar\n  proof that works first for $P(0) = 20$,\n  and then for any $P(0) \\neq 0$.\n  (The $P(0) = 0$ case is vacuous,\n  since then $P(x)$ is divisible by $x$.)\n\\end{remark*}\n\nTo finish the proof, let $p_1$, \\dots, $p_n$ be primes\nand $x_i$ be integers such that\n\\begin{align*}\n  P(x_1) &\\equiv 0 \\pmod{p_1} \\\\\n  P(x_2) &\\equiv 0 \\pmod{p_2} \\\\\n  &\\vdotswithin\\equiv \\\\\n  P(x_n) &\\equiv 0 \\pmod{p_n}\n\\end{align*}\nas promised by Schur's theorem.\nThen, by Chinese remainder theorem,\nwe can find $x$ such that $x \\equiv x_i \\pmod{p_i}$\nfor each $i$, whence $P(x)$ has at least $n$ prime factor.\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 2008}
{"id": "usamo-2008-q2", "question": "Let $ABC$ be an acute, scalene triangle,\nand let $M$, $N$, and $P$ be the midpoints of\n$\\ol{BC}$, $\\ol{CA}$, and $\\ol{AB}$, respectively.\nLet the perpendicular bisectors of $\\ol{AB}$ and $\\ol{AC}$\nintersect ray $AM$ in points $D$ and $E$ respectively,\nand let lines $BD$ and $CE$ intersect in point $F$, inside triangle $ABC$.\nProve that points $A$, $N$, $F$, and $P$ all lie on one circle.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1116181}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be an acute, scalene triangle,\nand let $M$, $N$, and $P$ be the midpoints of\n$\\ol{BC}$, $\\ol{CA}$, and $\\ol{AB}$, respectively.\nLet the perpendicular bisectors of $\\ol{AB}$ and $\\ol{AC}$\nintersect ray $AM$ in points $D$ and $E$ respectively,\nand let lines $BD$ and $CE$ intersect in point $F$, inside triangle $ABC$.\nProve that points $A$, $N$, $F$, and $P$ all lie on one circle.\n\\end{mdframed}\nWe present four solutions.\n\n\\paragraph{Barycentric solution.}\nFirst, we find the coordinates of $D$.\nAs $D$ lies on $\\ol{AM}$, we know $D=(t:1:1)$ for some $t$.\nNow by perpendicular bisector formula, we find\n\\[ 0 = b^2(t-1) + (a^2-c^2) \\implies t = \\frac{c^2+b^2-a^2}{b^2}. \\]\nThus we obtain \\[ D = \\left( 2S_A : c^2 : c^2 \\right). \\]\nAnalogously $E = (2S_A : b^2 : b^2)$,\nand it follows that \\[ F = \\left( 2S_A : b^2 : c^2 \\right). \\]\n\nThe sum of the coordinates of $F$ is\n\\[ (b^2+c^2-a^2)+b^2+c^2=  2b^2+2c^2-a^2. \\]\nHence the reflection of $A$ over $F$ is simply\n\\[ 2F-A = \\left( 2(b^2+c^2-a^2)-(2b^2+2c^2-a^2) : 2b^2 : 2c^2 \\right)\n  = \\left(-a^2 : 2b^2 : 2c^2 \\right). \\]\nIt is evident that $F'$ lies on $(ABC) : -a^2yz - b^2zx - c^2xy = 0$,\nand we are done.\n\n\\paragraph{Synthetic solution (harmonic).}\nHere is a synthetic solution.\nLet $X$ be the point so that $APXN$ is a cyclic harmonic quadrilateral.\nWe contend that $X = F$.\nTo see this it suffices to prove $B$, $X$, $D$ collinear\n(and hence $C$, $X$, $E$ collinear by symmetry).\n\n\\begin{center}\n\\begin{asy}\npair A = dir(130);\npair P = dir(210);\npair N = dir(330);\npair B = 2*P-A;\npair C = 2*N-A;\npair O = -A;\npair T = midpoint(P--N);\npair D = extension(A, T, P, O);\npair E = extension(A, T, N, O);\npair X = extension(B, D, E, C);\npair M = extension(A, T, B, C);\ndraw(N--T, heavygreen);\ndraw(T--P, lightblue);\ndraw(X--P, heavygreen);\n\ndraw(B--C--N, lightblue);\ndraw(P--O--N, lightblue);\ndraw(N--E, lightblue);\nfilldraw(unitcircle, opacity(0.1)+lightcyan, blue);\n\ndraw(D--X--C, red+dashed);\n\nfilldraw(A--B--X--cycle, opacity(0.1)+lightgreen, heavygreen);\nfilldraw(A--M--N--cycle, opacity(0.1)+lightgreen, heavygreen);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$P$\", P, dir(P));\ndot(\"$N$\", N, dir(10));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$O$\", O, dir(O));\ndot(\"$T$\", T, dir(45));\ndot(\"$D$\", D, dir(60));\ndot(\"$E$\", E, dir(240));\ndot(\"$X$\", X, dir(X));\ndot(\"$M$\", M, dir(M));\n\n/* TSQ Source:\n\nA = dir 130\nP = dir 210\nN = dir 330 R10\nB = 2*P-A\nC = 2*N-A\nO = -A\nT = midpoint P--N R45\nD = extension A T P O R60\nE = extension A T N O R240\nX = extension B D E C\nM = extension A T B C\nN--T heavygreen\nT--P lightblue\nX--P heavygreen\n\nB--C--N lightblue\nP--O--N lightblue\nN--E lightblue\nunitcircle 0.1 lightcyan / blue\n\nD--X--C red dashed\n\nA--B--X--cycle 0.1 lightgreen / heavygreen\nA--M--N--cycle 0.1 lightgreen / heavygreen\n\n*/\n\\end{asy}\n\\end{center}\n\nLet $T$ be the midpoint of $\\ol{PN}$,\nso $\\triangle APX \\sim \\triangle ATN$.\nSo $\\triangle ABX \\sim \\triangle AMN$, ergo\n\\[ \\dang XBA = \\dang NMA = \\dang BAM = \\dang BAD = \\dang DBA \\]\nas desired.\n\\paragraph{Angle chasing solution (Mason Fang).}\nObviously $ANOP$ is concyclic.\n\\begin{claim*}\n  Quadrilateral $BFOC$ is cyclic.\n\\end{claim*}\n\\begin{proof}\n  Write\n  \\begin{align*}\n  \\dang BFC = \\dang FBC+\\dang BCF\n  &=\\dang FBA +\\dang ABC+\\dang BCA+\\dang ACF\\\\\n  &=\\dang DBA +\\dang ABC+\\dang BCA+\\dang ACE\\\\\n  &=\\dang BAD +\\dang ABC+\\dang BCA+\\dang EAC\\\\\n  &=2\\angle BAC=\\angle BOC. \\qedhere\n  \\end{align*}\n\\end{proof}\nDefine $Q = \\ol{AA} \\cap \\ol{BC}$.\n\\begin{claim*}\n  Point $Q$ lies on $\\ol{FO}$.\n\\end{claim*}\n\\begin{proof}\n  Write\n  \\begin{align*}\n     \\dang BOQ = \\dang BOA+\\dang AOQ\n     &=2\\dang BCA+90^{\\dg}+\\dang AQO\\\\\n     &=2\\dang BCA+90^{\\dg}+\\dang AMO\\\\\n     &=2\\dang BCA+90^{\\dg}+\\dang AMC+90^{\\dg}\\\\\n     &=\\dang BCA+\\dang MAC =\\dang BCA+\\dang ACE \\\\\n     &=\\dang BCE =\\dang BOF. \\qedhere\n  \\end{align*}\n\\end{proof}\nAs $Q$ is the radical center of $(ANOP)$, $(ABC)$ and $(BFOC)$,\nthis implies the result.\n\\paragraph{Inversive solution (Kelin Zhu).}\nInvert about $A$ with radius $\\sqrt{bc}$\nfollowed by a reflection over the angle bisector of $\\angle A$,\nand denote the image of a point $X$ by $X'$.\nThe inverted problem now states the following:\n\n\\begin{quote}\n  In triangle $AP^{\\ast}N^{\\ast}$,\n  let $B^{\\ast}$, $C^{\\ast}$ be the midpoints of $AP^{\\ast}$, $AN^{\\ast}$\n  and $D^{\\ast}$, $E^{\\ast}$ be the intersection of the $A$ symmedian\n  with $(AP^{\\ast})$, $(AN^{\\ast})$, respectively.\n  $(AB^{\\ast}D^{\\ast})$, $(AC^{\\ast}E^{\\ast})$\n  intersect at a point $F^{\\ast}$; prove that it lies on $P^{\\ast}N^{\\ast}$.\n\\end{quote}\n\nI claim that, in fact, the midpoint of $P^{\\ast}N^{\\ast}$ is the desired intersection.\nRedefine that point as $F^{\\ast}$ and I will prove that\n$(AB^{\\ast}D^{\\ast})$, $(AC^{\\ast}E^{\\ast})$ pass through it.\n\nNote that\n\\[ \\angle AD^{\\ast}B^{\\ast}=\\angle D^{\\ast}AB^{\\ast}=\\angle F^{\\ast}AN^{\\ast}=\\angle AF^{\\ast}B^{\\ast}, \\]\nwhere the first equality is due to $B^{\\ast}$ being the circumcircle of $AD^{\\ast}P^{\\ast}$,\nthe second equality is due to the definition of the symmedian,\nand the third equality is due to the parallelogram $AB^{\\ast}F^{\\ast}C^{\\ast}$.\nA symmetric argument for $C$ finishes.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2008}
{"id": "usamo-2008-q3", "question": "Let $n$ be a positive integer.  Denote by $S_n$ the set of points $(x, y)$\nwith integer coordinates such that\n\\[ \\left\\lvert x\\right\\rvert + \\left\\lvert y + \\half \\right\\rvert < n. \\]\nA path is a sequence of distinct points\n$(x_1 , y_1), (x_2, y_2), \\dots, (x_\\ell, y_\\ell)$ in $S_n$\nsuch that, for $i = 2, \\dots, \\ell$,\nthe distance between $(x_i , y_i)$ and $(x_{i-1} , y_{i-1} )$ is $1$.\n\nProve that the points in $S_n$ cannot be partitioned into fewer than $n$ paths.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1116367}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n$ be a positive integer.  Denote by $S_n$ the set of points $(x, y)$\nwith integer coordinates such that\n\\[ \\left\\lvert x\\right\\rvert + \\left\\lvert y + \\half \\right\\rvert < n. \\]\nA path is a sequence of distinct points\n$(x_1 , y_1), (x_2, y_2), \\dots, (x_\\ell, y_\\ell)$ in $S_n$\nsuch that, for $i = 2, \\dots, \\ell$,\nthe distance between $(x_i , y_i)$ and $(x_{i-1} , y_{i-1} )$ is $1$.\n\nProve that the points in $S_n$ cannot be partitioned into fewer than $n$ paths.\n\\end{mdframed}\n\\paragraph{First solution (local).}\nWe proceed by induction on $n$.\nThe base case $n=1$ is clear, so suppose $n > 1$.\nLet $S$ denote the set of points\n\\[ S = \\left\\{ (x,y) : x + \\left\\lvert y+\\frac12 \\right\\rvert \\ge n - 2  \\right\\}. \\]\nAn example when $n=4$ is displayed below.\n\\begin{center}\n\\begin{asy}\nint n = 4;\nfor (int a=-4; a<=4; ++a) {\nfor (int b=-4; b<=4; ++b) {\nif (abs(a) + abs(b+0.5) < n) {\nif (a + abs(b+0.5) > n-2) dot( (a,b), red+4 );\nelse dot( (a,b), black+3 );\n}\n}\n}\ndraw((0,3)--(0,2)--(1,2)--(1,1)--(2,1)--(2,0)--(3,0)--(3,-1)--(2,-1)--(2,-2)--(1,-2)--(1,-3)--(0,-3)--(0,-4), red);\ndraw(CR((3,0), 0.3), deepgreen);\nlabel(\"$a$\", (3.3,0), dir(0), deepgreen);\n\\end{asy}\n\\end{center}\nFor any minimal partition $\\mathcal P$ of $S_n$,\nlet $P$ denote the path passing through the point $a = (n-1,0)$.\nThen the intersection of $P$ with $S$ consists of several disconnected paths;\nlet $N$ be the number of nodes in the component containing $a$, and\npick $\\mathcal P$ such that $N$ is maximal.\nWe claim that in this case $P = S$.\n\nAssume not.\nFirst, note $a = (n-1,0)$ must be connected to $b = (n-1, -1)$\n(otherwise join them to decrease the number of paths).\n\nNow, starting from $a = (n-1,0)$ walk along $P$ away from $b$\nuntil one of the following three conditions is met:\n\\begin{itemize}\n  \\ii We reach a point $v$ not in $S$.\n  Let $w$ be the point before $v$,\n  and $x$ the point in $S$ adjacent to $w$.\n  Then delete $vw$ and add $wx$.\n  This increases $N$ while leaving the number of edges unchanged:\n  so this case can't happen.\n\n  \\ii We reach an endpoint $v$ of $P$ (which may be $a$),\n  lying inside the set $S$, which is not the topmost point $(0,n-1)$.\n  Let $w$ be the next point of $S$.\n  Delete any edge touching $w$ and add edge $vw$.\n  This increases $N$ while leaving the number of edges unchanged:\n  so this case can't happen.\n\n  \\ii We reach the topmost point $(0,n-1)$.\n\\end{itemize}\nThus we see that $P$ must follow $S$ until reaching the topmost point $(0,n-1)$.\nSimilarly it must reach the bottom-most point $(0,-n)$.\nHence $P=S$.\n\nThe remainder of $S_n$ is just $S_{n-1}$,\nand hence this requires at least $n-1$ paths to\ncover by the inductive hypothesis.\nSo $S_n$ requires at least $n$ paths, as desired.\n\n%A bit easy for a \\#3, seeing that I got this during while trying to sleep on a train ride to visit my grandmother (and I normally suck at combo). This is more or less equivalent to MellowMelon's solution, but here's how I phrased it in my head.\n\n\\begin{remark*}\n  [Motivational comments from Evan]\n  Basically the idea is that I wanted to peel away the\n  right path $S$ highlighted in red in the figure, so that one could induct.\n  But the problem is that the red path might not actually exist,\n  e.g.\\ the set of paths might contain the mirror of $S$ instead.\n\n  Nonetheless, in those equality cases I found I could perturb some edges\n  (e.g.\\ change from $(-1,n-2)$--$(0,n-2)$ to $(0,n-2)$--$(1,n-2)$).\n  So the idea then was to do little changes and try to convert\n  the given partition into one where the red path $S$ exists,\n  (and then peel it away for induction)\n  without decreasing the total number of paths.\n\n  To make this work, you actually want the incisions to begin\n  ear the points $a$ and $b$,\n  because that's the point of $S$ that is most constrained\n  (e.g.\\ you get $a$--$b$ right away for free),\n  and assemble the path from there.\n  (If you try to do it from the top, it's much less clear what's happening.)\n  That's why the algorithm starts the mutations from around a.\n\\end{remark*}\n\n\\paragraph{Second solution (global).}\nHere is a much shorter official solution,\nwhich is much trickier to find, and ``global'' in nature.\n\nColor the upper half of the diagram with a blue/red checkerboard pattern\nsuch that the uppermost point $(n-1,0)$ is blue.\nReflect it over to the bottom, as shown.\n\\begin{center}\n\\begin{asy}\nbool even(int x) {\n  return (x % 2 ==  0\n  );\n}\nint n = 4;\nfor (int a=-4; a<=4; ++a) {\nfor (int b=-4; b<=4; ++b) {\nif (abs(a) + abs(b+0.5) < n) {\nif ( (b >= 0) && even(a+b+n+1)) dot( (a,b), blue+4 );\nelse if ( (b < 0) && even(a+b+n)) dot( (a,b), blue+4 );\nelse dot( (a,b), red+3 );\n}\n}\n}\n\\end{asy}\n\\end{center}\n\nAssume there are $m$ paths.\nCut in two any paths with two adjacent blue points;\nthis occurs only along the horizontal symmetry axis.\nThus:\n\\begin{itemize}\n  \\ii After cutting there are at most $m+n$ paths,\n  since at most $n$ cuts occur.\n  \\ii On the other hand,\n  there are $2n$ more blue points than red points.\n  Hence after cutting there must be at least $2n$ paths\n  (since each path alternates colors, except possibly for double-red pairs).\n\\end{itemize}\nSo $m+n \\ge 2n$, hence $m \\ge n$.\n\n\n\\begin{remark*}\n  This problem turned out to be known already.\n  It appears in this reference:\n  \\begin{quote}\n  Nikolai Beluhov, Nyakolko Zadachi po Shahmatna\n  Kombinatorika, \\emph{Matematika Plyus},\n  2006, issue 4, pages 61--64.\n  \\end{quote}\n  Section 1 of 2 was reprinted with revisions as\n  Nikolai Beluhov, Dolgii Put Korolya, \\emph{Kvant},\n  2010, issue 4, pages 39--41.\n  The reprint is available at\n  \\url{http://kvant.ras.ru/pdf/2010/2010-04.pdf}.\n\\end{remark*}\n\n\\begin{remark*}\n  [Nikolai Beluhov]\n  As pointed out in the reference above,\n  this problem arises naturally when we try to\n  estimate the greatest possible length of a closed king tour\n  on the chessboard of size $n \\times n$ with $n$ even,\n  a question posed by Igor Akulich in Progulki\n  Korolya, \\emph{Kvant}, 2000, issue 3, pages 47--48.\n  Each one of the two references above contains a proof\n  that the answer is $n + \\sqrt{2}(n^2 - n)$.\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Combinatorics", "source": "USAMO", "year": 2008}
{"id": "usamo-2008-q4", "question": "For which integers $n \\ge 3$ can one find a triangulation\nof regular $n$-gon consisting only of isosceles triangles?", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1116177}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFor which integers $n \\ge 3$ can one find a triangulation\nof regular $n$-gon consisting only of isosceles triangles?\n\\end{mdframed}\nThe answer is $n$ of the form $2^a(2^b+1)$\nwhere $a$ and $b$ are nonnegative integers not both zero.\n\nCall the polygon $A_1 \\dots A_n$\nwith indices taken modulo $n$.\nWe refer to segments $A_1 A_2$, $A_2 A_3$, \\dots, $A_n A_1$\nas \\emph{short sides}.\nEach of these must be in the triangulation.\nNote that\n\\begin{itemize}\n  \\ii when $n$ is even,\n  the isosceles triangles triangle using a short side $A_1 A_2$\n  are $\\triangle A_n A_1 A_2$ and $\\triangle A_1 A_2 A_3$ only,\n  which we call \\emph{small}.\n  \\ii when $n$ is odd, in addition to the small triangles,\n  we have $\\triangle A_{\\half(n+3)} A_1 A_2$,\n  which we call \\emph{big}.\n\\end{itemize}\n\nThis leads to the following two claims.\n\\begin{claim*}\n  If $n > 4$ is even, then $n$ works iff $n/2$ does.\n\\end{claim*}\n\\begin{proof}\n  All short sides must be part of a small triangle;\n  after drawing these in, we obtain an $n/2$-gon.\n  \\begin{center}\n  \\begin{asy}\n    size(3cm);\n    draw(unitcircle, dotted);\n    picture p;\n    dot(p, dir(0));\n    dot(p, dir(30));\n    dot(p, dir(60));\n    fill(p, dir(0)--dir(30)--dir(60)--cycle, opacity(0.1)+lightred);\n    draw(p, dir(0)--dir(30)--dir(60), blue);\n    draw(p, dir(0)--dir(60), red);\n    for (int i=0; i<6; ++i) {\n      add(rotate(60*i)*p);\n    }\n  \\end{asy}\n  \\end{center}\n  Thus the sides of $\\mathcal P$ must pair off,\n  and when we finish drawing we have an $n/2$-gon.\n\\end{proof}\nSince $n = 4$ works, this implies all powers of $2$ work\nand it remains to study the case when $n$ is odd.\n\n\\begin{claim*}\n  If $n > 1$ is odd, then $n$ works if and only if $n = 2^b+1$\n  for some positive integer $b$.\n\\end{claim*}\n\\begin{proof}\n  We cannot have all short sides part of small triangles\n  for parity reasons, so some side, must be part of a big triangle.\n  Since big triangles contain the center $O$,\n  there can be at most one big triangle too.\n\n  Then we get $\\half(n-1)$ small triangles,\n  pairing up the remaining sides.\n  Now repeating the argument with the triangles on each half\n  shows that the number $n-1$ must be a power of $2$, as needed.\n\\end{proof}\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2008}
{"id": "usamo-2008-q5", "question": "Three nonnegative real numbers $r_1$, $r_2$, $r_3$ are written on a blackboard.\nThese numbers have the property\nthat there exist integers $a_1$, $a_2$, $a_3$, not all zero,\nsatisfying $a_1r_1 + a_2r_2 + a_3r_3 = 0$.\nWe are permitted to perform the following operation:\nfind two numbers $x$, $y$ on the blackboard with $x \\le y$,\nthen erase $y$ and write $y - x$ in its place.\nProve that after a finite number of such operations,\nwe can end up with at least one $0$ on the blackboard.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1116189}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nThree nonnegative real numbers $r_1$, $r_2$, $r_3$ are written on a blackboard.\nThese numbers have the property\nthat there exist integers $a_1$, $a_2$, $a_3$, not all zero,\nsatisfying $a_1r_1 + a_2r_2 + a_3r_3 = 0$.\nWe are permitted to perform the following operation:\nfind two numbers $x$, $y$ on the blackboard with $x \\le y$,\nthen erase $y$ and write $y - x$ in its place.\nProve that after a finite number of such operations,\nwe can end up with at least one $0$ on the blackboard.\n\\end{mdframed}\nWe first show we can decrease the quantity\n$\\left\\lvert a_1 \\right\\rvert + \\left\\lvert a_2 \\right\\rvert + \\left\\lvert a_3 \\right\\rvert$\nas long as $0 \\notin \\left\\{ a_1,a_2,a_3 \\right\\}$.\nAssume $a_1 > 0$ and $r_1 > r_2 > r_3$\nwithout loss of generality and consider two cases.\n\n\\begin{itemize}\n  \\ii Suppose $a_2 > 0$ or $a_3 > 0$; these cases are identical.\n  (One cannot have both $a_2 > 0$ and $a_3 > 0$.)\n  If $a_2 > 0$ then $a_3 < 0$ and get\n  \\[ 0 = a_1r_1 + a_2r_2 + a_3r_3 > a_1r_3 + a_3r_3 \\implies a_1 + a_3 < 0 \\]\n  so $\\left\\lvert a_1 + a_3 \\right\\rvert < \\left\\lvert a_3 \\right\\rvert$,\n  and hence we perform $(r_1,r_2,r_3) \\mapsto (r_1-r_3,r_2,r_3)$.\n\n  \\ii Both $a_2 < 0$ and $a_3 < 0$.\n  Assume for contradiction that $\\left\\lvert a_1+a_2 \\right\\rvert \\ge -a_2$\n  and $\\left\\lvert a_1+a_3 \\right\\rvert \\ge -a_3$ both hold\n  (if either fails then we use $(r_1,r_2,r_3) \\mapsto (r_1-r_2,r_2,r_3)$\n  and $(r_1,r_2,r_3) \\mapsto (r_1-r_3,r_2,r_3)$, respectively).\n  Clearly $a_1+a_2$ and $a_1+a_3$ are both positive in this case,\n  so we get $a_1 + 2a_2$ and $a_1 + 2a_3 \\ge 0$; adding gives $a_1+a_2+a_3 \\ge 0$.\n  But\n  \\begin{align*}\n    0 &= a_1r_1 + a_2r_2 + a_3r_3 \\\\\n    &> a_1r_2 + a_2r_2 + a_3r_2 \\\\\n    &= r_2(a_1+a_2+a_3)  \\\\\n    \\implies 0 &< a_1+a_2+a_3.\n  \\end{align*}\n\\end{itemize}\n\nSince this covers all cases, we see that we can always decrease\n$\\left\\lvert a_1 \\right\\rvert + \\left\\lvert a_2 \\right\\rvert + \\left\\lvert a_3 \\right\\rvert$\nwhenever $0 \\notin \\left\\{ a_1,a_2,a_3 \\right\\}$.\nBecause the $a_i$ are integers this cannot occur indefinitely,\nso eventually one of the $a_i$'s is zero.\nAt this point we can just apply the Euclidean Algorithm, so we're done.\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 2008}
{"id": "usamo-2008-q6", "question": "At a certain mathematical conference,\nevery pair of mathematicians are either friends or strangers.\nAt mealtime, every participant eats in one of two large dining rooms.\nEach mathematician insists upon eating in a room which\ncontains an even number of his or her friends.\nProve that the number of ways that the mathematicians\nmay be split between the two rooms is a power of two\n(i.e.\\ is of the form $2^k$ for some positive integer $k$).", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1116182}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nAt a certain mathematical conference,\nevery pair of mathematicians are either friends or strangers.\nAt mealtime, every participant eats in one of two large dining rooms.\nEach mathematician insists upon eating in a room which\ncontains an even number of his or her friends.\nProve that the number of ways that the mathematicians\nmay be split between the two rooms is a power of two\n(i.e.\\ is of the form $2^k$ for some positive integer $k$).\n\\end{mdframed}\nTake the obvious graph interpretation\nwhere we are trying to $2$-color a graph.\nLet $A$ be the adjacency matrix of the graph over $\\FF_2$,\nexcept the diagonal of $A$ has $\\deg v \\pmod 2$ instead of zero.\nThen let $\\vec d$ be the main diagonal.\nSplittings then correspond to $A \\vec v = \\vec d$.\nIt's then immediate that the number of ways is either zero\nor a power of two, since if it is nonempty it is a coset of $\\ker A$.\n\nThus we only need to show that:\n\\begin{claim*}\n  At least one coloring exists.\n\\end{claim*}\n\\begin{proof}\nIf not, consider a minimal counterexample $G$.\nClearly there is at least one odd vertex $v$.\nConsider the graph with vertex set $G-v$,\nwhere all pairs of neighbors of $v$ have their edges complemented.\nBy minimality, we have a good coloring here.\nOne can check that this extends to a good coloring on $G$\nby simply coloring $v$ with the color matching an even number of its neighbors.\nThis breaks minimality of $G$, and hence all graphs $G$ have a coloring.\n\\end{proof}\n\nIt's also possible to use linear algebra.\nWe prove the following lemma:\n\\begin{lemma*}[grobber]\nLet $V$ be a finite dimensional vector space,\n$T \\colon V \\to V$ and $w \\in V$.\nThen $w$ is in the image of $T$ if and only if\nthere are no $\\xi \\in V^\\vee$ for which $\\xi(w) \\neq 0$\nand yet $\\xi \\circ T = 0$.\n\\end{lemma*}\n\n\\begin{proof}\nClearly if $T(v) = w$, then no $\\xi$ exists.\nConversely, assume $w$ is not in the image of $T$.\nThen the image of $T$ is linearly independent from $w$.\nTake a basis $e_1$, \\dots, $e_m$ for the image of $T$, add $w$,\nand then extend it to a basis for all of $V$.\nThen have $\\xi$ kill all $e_i$ but not $w$.\n\\end{proof}\n\n\\begin{corollary*}\n  In a symmetric matrix $A$ mod $2$,\n  there exists a vector $v$ such that $Av$ is a copy of the diagonal of $A$.\n\\end{corollary*}\n\\begin{proof}\n  Let $\\xi$ be such that $\\xi \\circ T = 0$.\n  Look at $\\xi$ as a column vector $w^\\top$, and let $d$ be the diagonal.\n  Then \\[ 0 = w^\\top \\cdot T \\cdot w = \\xi(d) \\]\n  because this extracts the sum of coefficients submatrix of $T$,\n  and all the symmetric entries cancel off.\n  Thus no $\\xi$ as in the previous lemma exists.\n\\end{proof}\nThis corollary gives the desired proof.\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "USAMO", "year": 2008}
{"id": "usamo-2015-q1", "question": "Solve in integers the equation\n\\[ x^2+xy+y^2 = \\left(\\frac{x+y}{3}+1\\right)^3. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p4769940}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nSolve in integers the equation\n\\[ x^2+xy+y^2 = \\left(\\frac{x+y}{3}+1\\right)^3. \\]\n\\end{mdframed}\nWe do the trick of setting $a=x+y$ and $b=x-y$.\nThis rewrites the equation as\n\\[ \\frac14\\left( (a+b)^2+(a+b)(a-b)+(a-b)^2 \\right) = \\left( \\frac a3 + 1 \\right)^3 \\]\nwhere $a,b \\in \\ZZ$ have the same parity.\nThis becomes\n\\[ 3a^2+b^2 = 4\\left( \\frac a3 + 1 \\right)^3 \\]\nwhich is enough to imply $3 \\mid a$, so let $a = 3c$.\nMiraculously, this becomes \\[ b^2 = (c-2)^2 (4c+1). \\]\n\nSo a solution must have $4c+1=m^2$, with $m$ odd.\nThis gives\n\\[ x = \\frac 18 \\left( 3 (m^2-1) \\pm (m^3-9m)  \\right)\n  \\quad\\text{and}\\quad\n  y = \\frac 18 \\left( 3 (m^2-1) \\mp (m^3-9m) \\right).  \\]\nFor mod $8$ reasons,\nthis always generates a valid integer solution,\nso this is the complete curve of solutions.\nActually, putting $m=2n+1$ gives the much nicer curve\n\\[ \\boxed{x = n^3+3n^2-1 \\quad\\text{and}\\quad y = -n^3+3n+1} \\]\nand permutations.\n\nFor $n=0,1,2,3$ this gives the first few solutions\nare $(-1,1)$, $(3,3)$, $(19,-1)$, $(53, -17)$, (and permutations).\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 2015}
{"id": "usamo-2015-q2", "question": "Quadrilateral $APBQ$ is inscribed in circle $\\omega$ with\n$\\angle P = \\angle Q = 90^{\\circ}$ and $AP = AQ < BP$.\nLet $X$ be a variable point on segment $\\ol{PQ}$.\nLine $AX$ meets $\\omega$ again at $S$ (other than $A$).\nPoint $T$ lies on arc $AQB$ of $\\omega$ such that $\\ol{XT}$\nis perpendicular to $\\ol{AX}$.\nLet $M$ denote the midpoint of chord $\\ol{ST}$.\n\nAs $X$ varies on segment $\\ol{PQ}$, show that $M$ moves along a circle.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p4769957}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nQuadrilateral $APBQ$ is inscribed in circle $\\omega$ with\n$\\angle P = \\angle Q = 90^{\\circ}$ and $AP = AQ < BP$.\nLet $X$ be a variable point on segment $\\ol{PQ}$.\nLine $AX$ meets $\\omega$ again at $S$ (other than $A$).\nPoint $T$ lies on arc $AQB$ of $\\omega$ such that $\\ol{XT}$\nis perpendicular to $\\ol{AX}$.\nLet $M$ denote the midpoint of chord $\\ol{ST}$.\n\nAs $X$ varies on segment $\\ol{PQ}$, show that $M$ moves along a circle.\n\\end{mdframed}\nWe present three solutions,\none by complex numbers, two more synthetic.\n(A fourth solution using median formulas is also possible.)\nMost solutions will prove that the center of the fixed circle\nis the midpoint of $\\ol{AO}$\n(with $O$ the center of $\\omega$);\nthis can be recovered empirically by letting\n\\begin{itemize}\n  \\ii $X$ approach $P$ (giving the midpoint of $\\ol{BP}$)\n  \\ii $X$ approach $Q$ (giving the point $Q$), and\n  \\ii $X$ at the midpoint of $\\ol{PQ}$ (giving the midpoint of $\\ol{BQ}$)\n\\end{itemize}\nwhich determines the circle;\nthis circle then passes through $P$ by symmetry\nand we can find the center by taking the intersection\nof two perpendicular bisectors (which two?).\n\n\\paragraph{Complex solution (Evan Chen).}\nToss on the complex unit circle with $a = -1$, $b=1$, $z = -\\tfrac12$.\nLet $s$ and $t$ be on the unit circle. We claim $Z$ is the center.\n\nIt follows from standard formulas that\n\\[ x = \\frac 12 \\left( s + t - 1 + s/t \\right) \\]\nthus\n\\[ 4\\operatorname{Re} x + 2\n  = 2\\left( x + \\frac 1x \\right) + 2\n  = s + t + \\frac 1s + \\frac 1t + \\frac st + \\frac ts \\]\nwhich depends only on $P$ and $Q$, and not on $X$.\nThus\n\\[ 4\\left\\lvert z-\\frac{s+t}{2} \\right\\rvert^2\n  = \\left\\lvert s+t+1 \\right\\rvert^2 = 3 + (4\\operatorname{Re}x+2) \\]\ndoes not depend on $X$, done.\n\n\\paragraph{Homothety solution (Alex Whatley).}\nLet $G$, $N$, $O$ denote the centroid, nine-point center,\nand circumcenter of triangle $AST$, respectively.\nLet $Y$ denote the midpoint of $\\ol{AS}$.\nThen the three points $X$, $Y$, $M$\nlie on the nine-point circle of triangle $AST$,\nwhich is centered at $N$ and has radius $\\frac 12 AO$.\n\n\\begin{center}\n\\begin{asy}\nsize(9cm);\n\npair A = dir(90);\npair B = dir(-90);\npair S = dir(-50);\npair T = dir(170);\npair O = midpoint(A--B);\npair X = foot(T, A, S);\npair E = dir(0);\n\npair P = IP(unitcircle, X--(X-2*E));\npair Q = IP(unitcircle, X--(X+2*E));\n\nfilldraw(unitcircle, opacity(0.2)+mediumcyan, mediumblue);\n\npair M = midpoint(S--T);\npair G = centroid(A, S, T);\npair N = 3/2*G;\n\nfilldraw(A--P--B--Q--cycle, opacity(0.1)+lightblue, mediumblue);\ndraw(A--B, mediumblue+dotted);\ndraw(P--Q, mediumblue+dotted);\n\nfilldraw(A--S--T--cycle, opacity(0.4)+mediumgreen, heavygreen);\nfilldraw(CP(N, M), opacity(0.6)+lightred, red);\n\ndraw(T--X, heavygreen);\ndraw(A--M, heavygreen);\npair Y = midpoint(A--S);\n\ndraw(O--N, red);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$S$\", S, dir(S));\ndot(\"$T$\", T, dir(T));\ndot(\"$O$\", O, dir(-45));\ndot(\"$X$\", X, dir(45));\ndot(\"$P$\", P, dir(P));\ndot(\"$Q$\", Q, dir(Q));\ndot(\"$M$\", M, dir(M));\ndot(\"$G$\", G, dir(30));\ndot(\"$N$\", N, dir(N));\ndot(\"$Y$\", Y, dir(Y));\n\n/* Source generated by TSQ\n\n!size(9cm);\n\nA = dir 90\nB = dir -90\nS = dir -50\nT = dir 170\nO = midpoint A--B R-45\nX = foot T A S R45\nE := dir 0\n\nP = IP unitcircle X--(X-2*E)\nQ = IP unitcircle X--(X+2*E)\n\nunitcircle 0.2 mediumcyan / mediumblue\n\nM = midpoint S--T\nG = centroid A S T R30\nN = 3/2*G\n\nA--P--B--Q--cycle 0.1 lightblue / mediumblue\nA--B mediumblue dotted\nP--Q mediumblue dotted\n\nA--S--T--cycle 0.4 mediumgreen / heavygreen\nCP N M 0.6 lightred / red\n\nT--X heavygreen\nA--M heavygreen\nY = midpoint A--S\n\nO--N red\n\n*/\n\\end{asy}\n\\end{center}\n\nLet $R$ denote the radius of $\\omega$.\nNote that the nine-point circle of $\\triangle AST$\nhas radius equal to $\\half R$, and hence is independent of $S$ and $T$.\nThen the power of $A$ with respect to the nine-point circle equals\n\\[ AN^2 - \\left( \\half R \\right)^2 = AX \\cdot AY\n  = \\frac 12 AX \\cdot AS = \\frac 12 AQ^2 \\]\nand hence\n\\[ AN^2 = \\left( \\half R \\right)^2 + \\frac 12 AQ^2 \\]\nwhich does not depend on the choice of $X$.\nSo $N$ moves along a circle centered at $A$.\n\nSince the points $O$, $G$, $N$ are collinear on the Euler line of $\\triangle AST$\nwith \\[ GO = \\frac 23 NO \\] it follows by homothety\nthat $G$ moves along a circle as well,\nwhose center is situated one-third of the way from $A$ to $O$.\nFinally, since $A$, $G$, $M$ are collinear with \\[ AM = \\frac 32 AG \\]\nit follows that $M$ moves along a circle\ncentered at the midpoint of $\\ol{AO}$.\n\n\\paragraph{Power of a point solution (Zuming Feng, official solution).}\nWe complete the picture by letting $\\triangle KYX$ be the orthic\ntriangle of $\\triangle AST$;\nin that case line $XY$ meets the $\\omega$ again at $P$ and $Q$.\n\n\\begin{center}\n\\begin{asy}\nsize(9cm);\n\npair A = dir(125);\npair B = -A;\npair S = dir(210);\npair T = dir(330);\npair O = midpoint(A--B);\npair X = foot(T, A, S);\npair E = dir(0);\n\nfilldraw(unitcircle, opacity(0.2)+mediumcyan, mediumblue);\npair M = midpoint(S--T);\n\nfilldraw(A--S--T--cycle, opacity(0.4)+mediumgreen, heavygreen);\n\ndraw(T--X, heavygreen);\ndraw(A--M, heavygreen);\n\npair Y = foot(S, A, T);\npair K = foot(A, S, T);\nfilldraw(circumcircle(X, Y, M), opacity(0.1)+yellow, red);\ndraw(S--Y, heavygreen);\ndraw(A--K, heavygreen);\n\npair P = IP(unitcircle, X--(3*Y-2*X));\npair Q = IP(unitcircle, Y--(3*X-2*Y));\n\npair V = extension(P, Q, S, T);\ndraw(P--Q, blue);\ndraw(A--B, blue);\ndraw(Q--V, blue);\ndraw(V--S, heavygreen);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$S$\", S, dir(S));\ndot(\"$T$\", T, dir(T));\ndot(\"$O$\", O, dir(45));\ndot(\"$X$\", X, dir(135));\ndot(\"$M$\", M, dir(M));\ndot(\"$Y$\", Y, dir(70));\ndot(\"$K$\", K, dir(K));\ndot(\"$P$\", P, dir(P));\ndot(\"$Q$\", Q, dir(150));\ndot(\"$V$\", V, dir(V));\n\n/* TSQ Source:\n\n!size(9cm);\n\nA = dir 125\nB = -A\nS = dir 210\nT = dir 330\nO = midpoint A--B R45\nX = foot T A S R135\nE := dir 0\n\nunitcircle 0.2 mediumcyan / mediumblue\nM = midpoint S--T\n\nA--S--T--cycle 0.4 mediumgreen / heavygreen\n\nT--X heavygreen\nA--M heavygreen\n\nY = foot S A T R70\nK = foot A S T\ncircumcircle X Y M 0.1 yellow / red\nS--Y heavygreen\nA--K heavygreen\n\nP = IP unitcircle X--(3*Y-2*X)\nQ = IP unitcircle Y--(3*X-2*Y) R150\n\nV = extension P Q S T\nP--Q blue\nA--B blue\nQ--V blue\nV--S heavygreen\n\n*/\n\\end{asy}\n\\end{center}\n\nThe main claim is:\n\\begin{claim*}\n  Quadrilateral $PQKM$ is cyclic.\n\\end{claim*}\n\\begin{proof}\n  To see this, we use power of a point: let $V = \\ol{QXYP} \\cap \\ol{SKMT}$.\n  One approach is that since $(VK;ST) = -1$\n  we have $VQ \\cdot VP = VS \\cdot VT = VK \\cdot VM$.\n  A longer approach is more elementary:\n  \\[ VQ \\cdot VP = VS \\cdot VT = VX \\cdot VY = VK \\cdot VM \\]\n  using the nine-point circle, and the circle with diameter $\\ol{ST}$.\n\\end{proof}\nBut the circumcenter of $PQKM$,\nis the midpoint of $\\ol{AO}$,\nsince it lies on the perpendicular bisectors of $\\ol{KM}$ and $\\ol{PQ}$.\nSo it is fixed, the end.\n\\pagebreak", "category": "Geometry", "source": "USAMO", "year": 2015}
{"id": "usamo-2015-q3", "question": "Let $S = \\left\\{ 1,2,\\dots,n \\right\\}$, where $n \\ge 1$.\nEach of the $2^n$ subsets of $S$ is to be colored red or blue.\n(The subset itself is assigned a color and not its individual elements.)\nFor any set $T \\subseteq S$,\nwe then write $f(T)$ for the number of subsets of $T$ that are blue.\n\nDetermine the number of colorings that satisfy the following condition:\nfor any subsets $T_1$ and $T_2$ of $S$,\n\\[ f(T_1)f(T_2) = f(T_1 \\cup T_2)f(T_1 \\cap T_2). \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p4769949}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $S = \\left\\{ 1,2,\\dots,n \\right\\}$, where $n \\ge 1$.\nEach of the $2^n$ subsets of $S$ is to be colored red or blue.\n(The subset itself is assigned a color and not its individual elements.)\nFor any set $T \\subseteq S$,\nwe then write $f(T)$ for the number of subsets of $T$ that are blue.\n\nDetermine the number of colorings that satisfy the following condition:\nfor any subsets $T_1$ and $T_2$ of $S$,\n\\[ f(T_1)f(T_2) = f(T_1 \\cup T_2)f(T_1 \\cap T_2). \\]\n\\end{mdframed}\nFor an $n$-coloring $\\mathcal C$ (by which we mean a coloring of\nthe subsets of $\\{1,\\dots,n\\}$),\ndefine the \\textbf{support} of $\\mathcal C$ as\n\\[ \\opname{supp}(\\mathcal C) =\n  \\left\\{ T \\mid f(T) \\neq 0 \\right\\}. \\]\nCall a coloring \\textbf{nontrivial}\nif $\\opname{supp}(\\mathcal C) \\neq \\varnothing$ (equivalently, the coloring is not all red).\nIn that case, notice that\n\\begin{itemize}\n  \\ii the support is\n  \\emph{closed under unions and intersections}:\n  since if $f(T_1) f(T_2) \\neq 0$ then necessarily\n  both $f(T_1 \\cap T_2)$ and $f(T_1 \\cup T_2)$ are nonzero; and\n  \\ii the support is obviously \\emph{upwards closed}.\n\\end{itemize}\nThus, the support must take the form\n\\[ \\opname{supp}(\\mathcal C)\n  = [X,S]\n  \\overset{\\text{def}}{=} \\left\\{ T \\mid X \\subseteq T \\subseteq S \\right\\} \\]\nfor some set $X$\n(for example by letting $X$ be the minimal (by size) element of the support).\n\nSay $\\mathcal C$ has \\textbf{full support}\nif $X = \\varnothing$ (equivalently, $\\varnothing$ is blue).\n\n\\begin{lemma*}\nFor a given $n$ and $B \\subseteq \\{1,\\dots,n\\}$,\nthere is exactly one $n$-coloring with full support\nin which the singletons colored blue are exactly those in $B$.\nTherefore there are exactly $2^n$ $n$-colorings with full support.\n\\end{lemma*}\n\\begin{proof}\nTo see there is at least one coloring, color only the subsets of $B$ blue.\nIn that case \\[ f(T) = 2^{\\left\\lvert T \\cap B \\right\\rvert} \\]\nwhich satisfies the condition by Inclusion-Exclusion.\nTo see this extension is unique,\nnote that $f(\\{b\\})$ is determined for each $b$ and we can then determine $f(T)$\ninductively on $\\left\\lvert T \\right\\rvert$;\nhence there is \\emph{at most} one way to complete a coloring of the singletons,\nwhich completes the proof.\n\\end{proof}\n\nFor a general nontrivial $n$-coloring $\\mathcal C$,\nnote that if $\\opname{supp}(\\mathcal C) = [X,S]$,\nthen we can think of it as an\n$(n-\\left\\lvert X \\right\\rvert)$-coloring with full support.\nFor $\\left\\lvert X \\right\\rvert = k$, there are $\\binom nk$ possible choices of $X \\subseteq S$.\nAdding back in the trivial coloring, the final answer is\n\\[ 1 + \\sum_{k=0}^n \\binom nk 2^k = \\boxed{1 + 3^n}. \\]\n\n\\begin{remark*}\n  To be more explicit,\n  the possible nontrivial colorings are exactly described\n  by specifying two sets $X$ and $Y$ with $X \\subseteq Y$,\n  and coloring blue only the sets $T$\n  with $X \\subseteq T \\subseteq Y$.\n\n  In particular, one deduces that in a working coloring,\n  $f(T)$ is always either zero or a power of two.\n  If one manages to notice this while working on the problem,\n  it is quite helpful for motivating the solution,\n  as it leads one to suspect that the working colorings\n  have good structure.\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Combinatorics", "source": "USAMO", "year": 2015}
{"id": "usamo-2015-q4", "question": "Steve is piling $m\\geq 1$ indistinguishable stones\non the squares of an $n\\times n$ grid.\nEach square can have an arbitrarily high pile of stones.\nAfter he finished piling his stones in some manner,\nhe can then perform \\emph{stone moves}, defined as follows.\nConsider any four grid squares, which are corners of a rectangle,\ni.e.\\ in positions $(i, k)$, $(i, l)$, $(j, k)$, $(j, l)$\nfor some $1\\leq i, j, k, l\\leq n$, such that $i<j$ and $k<l$.\nA stone move consists of either removing one stone from each of\n$(i, k)$ and $(j, l)$ and moving them to $(i, l)$ and $(j, k)$ respectively,\nor removing one stone from each of $(i, l)$ and $(j, k)$\nand moving them to $(i, k)$ and $(j, l)$ respectively.\n\nTwo ways of piling the stones are equivalent if they can be obtained\nfrom one another by a sequence of stone moves.\nHow many different non-equivalent ways can Steve pile the stones on the grid?", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p4774079}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nSteve is piling $m\\geq 1$ indistinguishable stones\non the squares of an $n\\times n$ grid.\nEach square can have an arbitrarily high pile of stones.\nAfter he finished piling his stones in some manner,\nhe can then perform \\emph{stone moves}, defined as follows.\nConsider any four grid squares, which are corners of a rectangle,\ni.e.\\ in positions $(i, k)$, $(i, l)$, $(j, k)$, $(j, l)$\nfor some $1\\leq i, j, k, l\\leq n$, such that $i<j$ and $k<l$.\nA stone move consists of either removing one stone from each of\n$(i, k)$ and $(j, l)$ and moving them to $(i, l)$ and $(j, k)$ respectively,\nor removing one stone from each of $(i, l)$ and $(j, k)$\nand moving them to $(i, k)$ and $(j, l)$ respectively.\n\nTwo ways of piling the stones are equivalent if they can be obtained\nfrom one another by a sequence of stone moves.\nHow many different non-equivalent ways can Steve pile the stones on the grid?\n\\end{mdframed}\nThe answer is $\\binom{m+n-1}{n-1}^2$.\nThe main observation is that the ordered sequence of column counts\n(i.e.\\ the number of stones in the first, second, etc.\\ column)\nis invariant under stone moves, as does the analogous sequence of row counts.\n\n\\paragraph{Definitions.}\nCall these numbers $(c_1, c_2, \\dots, c_n)$\nand $(r_1, r_2, \\dots, r_n)$ respectively,\nwith $\\sum c_i = \\sum r_i = m$.\nWe say that the sequence $(c_1, \\dots, c_n, r_1, \\dots, r_n)$\nis the \\emph{signature} of the configuration.\nThese are the $2m$ blue and red numbers shown in the example below\n(in this example we have $m=8$ and $n=3$).\n\\begin{center}\n\\begin{asy}\n  unitsize(1.5cm);\n  for (int i=0; i<=3; ++i) {\n    draw( (0,i)--(3,i), gray );\n    draw( (i,0)--(i,3), gray );\n  }\n  label(\"$c_1=\\boxed{5}$\", (0.5,3), dir(90), blue);\n  label(\"$c_2=\\boxed{2}$\", (1.5,3), dir(90), blue);\n  label(\"$c_3=\\boxed{1}$\", (2.5,3), dir(90), blue);\n\n  label(\"$r_1=\\boxed{3}$\", (0,2.5), dir(180), red);\n  label(\"$r_2=\\boxed{3}$\", (0,1.5), dir(180), red);\n  label(\"$r_3=\\boxed{2}$\", (0,0.5), dir(180), red);\n\n  real r = 0.1;\n  filldraw(circle((0.3,2.7), r), gray, black);\n  filldraw(circle((0.6,2.4), r), gray, black);\n  filldraw(circle((1.4,2.3), r), gray, black);\n  filldraw(circle((0.6,1.7), r), gray, black);\n  filldraw(circle((0.4,1.4), r), gray, black);\n  filldraw(circle((0.7,0.5), r), gray, black);\n  filldraw(circle((2.4,1.6), r), gray, black);\n  filldraw(circle((1.6,0.4), r), gray, black);\n  label(\"Signature: $(5,2,1;3,3,2)$\", (1.5,0), dir(-90));\n\\end{asy}\n\\end{center}\nBy stars-and-bars, the number of possible values $(c_1, \\dots, c_n)$\nis $\\binom{m+n-1}{n-1}$.\nThe same is true for $(r_1, \\dots, r_n)$.\nSo if we're just counting \\emph{signatures},\nthe total number of possible signatures is $\\binom{m+n-1}{n-1}^2$.\n\n\\paragraph{Outline and setup.}\nWe are far from done.\nTo show that the number of non-equivalent ways is also this number,\nwe need to show that signatures correspond to pilings.\nIn other words, we need to prove:\n\\begin{enumerate}\n  \\ii Check that signatures are invariant around moves\n  (trivial; we did this already);\n  \\ii Check conversely that two configurations\n  are equivalent if they have the same signatures\n  (the hard part of the problem); and\n  \\ii Show that each signature is realized by at least\n  one configuration (not immediate, but pretty easy).\n\\end{enumerate}\n\nMost procedures to the second step are algorithmic in nature,\nbut Ankan Bhattacharya gives the following far cleaner approach.\nRather than having a grid of stones,\nwe simply consider the multiset of ordered pairs $(x,y)$\ncorresponding to the stones.\nThen:\n\\begin{itemize}\n  \\ii a stone move corresponds to switching two $y$-coordinates\n  in two different pairs.\n  \\ii we \\emph{redefine} the signature to be the multiset $(X,Y)$\n  of $x$ and $y$ coordinates which appear.\n  Explicitly, $X$ is the multiset that contains $c_i$ copies\n  of the number $i$ for each $i$.\n\\end{itemize}\nFor example, consider the earlier example which had\n\\begin{itemize}\n  \\ii Two stones each at $(1,1)$, $(1,2)$.\n  \\ii One stone each at $(1,3)$, $(2,1)$, $(2,3)$, $(3,2)$.\n\\end{itemize}\nIts signature can then be reinterpreted as\n\\[\n  (5,2,1; 3,3,2)\n  \\longleftrightarrow\n  \\begin{cases}\n    X = \\{1,1,1,1,1,2,2,3\\} \\\\\n    Y = \\{1,1,1,2,2,2,3,3\\}.\n  \\end{cases}\n\\]\nIn that sense, the entire grid is quite misleading!\n\n\\paragraph{Proof that two configurations with the same signature are equivalent.}\nThe second part is completed just because\ntranspositions generate any permutation.\nTo be explicit, given two sets of stones,\nwe can permute the labels so that the first set is\n$(x_1, y_1)$, \\dots, $(x_m, y_m)$ and\nthe second set of stones is\n$(x_1, y_1')$, \\dots, $(x_m, y_m')$.\nThen we just induce the correct permutation on $(y_i)$ to get $(y_i')$.\n\n\\paragraph{Proof that any signature has at least one configuration.}\nSort the elements of $X$ and $Y$ arbitrarily (say, in non-decreasing order).\nPut a stone whose $x$-coordinate is the $i$th element of $X$,\nand whose $y$-coordinate is the $i$th element of $Y$,\nfor each $i = 1, 2, \\dots, m$.\nThen this gives a stone placement of $m$ stones with signature $(X,Y)$.\n\nFor example, if\n\\begin{align*}\n  X &= \\{1,1,1,1,1,2,2,3\\} \\\\\n  Y &= \\{1,1,1,2,2,2,3,3\\}\n\\end{align*}\nthen placing stones at\n$(1,1)$, $(1,1)$, $(1,1)$, $(1,2)$, $(1,2)$, $(2,2)$, $(2,3)$, $(3,3)$\ngives a valid piling with this signature.\n\\pagebreak", "category": "Combinatorics", "source": "USAMO", "year": 2015}
{"id": "usamo-2015-q5", "question": "Let $a$, $b$, $c$, $d$, $e$ be distinct positive integers\nsuch that $a^4+b^4=c^4+d^4=e^5$.\nShow that $ac+bd$ is a composite number.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p4774020}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a$, $b$, $c$, $d$, $e$ be distinct positive integers\nsuch that $a^4+b^4=c^4+d^4=e^5$.\nShow that $ac+bd$ is a composite number.\n\\end{mdframed}\nAssume to the contrary that $p = ac+bd$, so that\n\\begin{align*}\n  ac &\\equiv -bd \\pmod p \\\\\n  \\implies a^4c^4 &\\equiv b^4d^4 \\pmod p \\\\\n  \\implies a^4 (e^5 - d^4) &\\equiv (e^5 - a^4) d^4 \\pmod p \\\\\n  \\implies a^4 e^5 &\\equiv d^4 e^5 \\pmod p \\\\\n  \\implies e^5(a^4-d^4) &\\equiv 0 \\pmod p\n\\end{align*}\nand hence \\[ p \\mid e^5(a-d)(a+d)(a^2+d^2). \\]\n\n\\begin{claim*}\n  We should have $p > e$.\n\\end{claim*}\n\\begin{proof}\n  We have $e^5 = a^4 + b^4 \\le a^5 + b^5 < (ac+bd)^5 = p^5$.\n\\end{proof}\nThus the above equation implies $p \\le \\max(a-d, a+d, a^2+d^2) = a^2+d^2$.\nSimilarly, $p \\le b^2+c^2$.\nSo \\[ ac+bd = p \\le \\min \\left\\{ a^2+d^2, b^2+c^2 \\right\\} \\]\nor by subtraction\n\\[ 0 \\le \\min \\left\\{ a(a-c) + d(d-b),\n  b(b-d) + c(c-a) \\right\\}. \\]\nBut since $a^4+b^4 = c^4+d^4$ the numbers $a-c$ and $d-b$\nshould have the same sign, and so this is an obvious contradiction.\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 2015}
{"id": "usamo-2015-q6", "question": "Fix $0 < \\lambda < 1$, and let $A$ be a multiset of positive integers.\nLet $A_n = \\{a\\in A: a\\leq n\\}$.\nAssume that for every $n \\in \\NN$, the multiset $A_n$ contains at most $n\\lambda$ numbers.\nShow that there are infinitely many $n\\in\\NN$ for\nwhich the sum of the elements in $A_n$ is at most $\\frac{n(n+1)}{2}\\lambda$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p4774023}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFix $0 < \\lambda < 1$, and let $A$ be a multiset of positive integers.\nLet $A_n = \\{a\\in A: a\\leq n\\}$.\nAssume that for every $n \\in \\NN$, the multiset $A_n$ contains at most $n\\lambda$ numbers.\nShow that there are infinitely many $n\\in\\NN$ for\nwhich the sum of the elements in $A_n$ is at most $\\frac{n(n+1)}{2}\\lambda$.\n\\end{mdframed}\nFor brevity, $\\#S$ denotes $|S|$.\nLet $x_n = n\\lambda - \\#A_n \\ge 0$.\nWe now proceed by contradiction by assuming\nthe conclusion fails for $n$ large enough; that is,\n\\begin{align*}\n  \\frac{n(n+1)}{2}\\lambda\n  &< \\sum_{a \\in A_n} a \\\\\n  &= 1(\\#A_1-\\#A_0)\n  + 2(\\#A_2 - \\#A_1)\n  + \\dots + n(\\#A_n - \\#A_{n-1}) \\\\\n  &= n \\# A_n - (\\# A_1 + \\dots + \\# A_{n-1}) \\\\\n  &= n(n \\lambda - x_n) - \\left[ (\\lambda - x_1)\n    + (2\\lambda - x_2) + \\dots + ((n-1)\\lambda - x_{n-1}) \\right] \\\\\n  &= \\frac{n(n+1)}{2} \\lambda - n x_n\n  + (x_1 + \\dots + x_{n-1}).\n\\end{align*}\nThis means that for all sufficiently large $n$, say $n \\ge N_0$, we have\n\\[ x_{n} < \\frac{x_1 + \\dots + x_{n-1}}{n}\n  \\qquad \\forall n \\ge N_0. \\]\nIn particular, each $x_n$ is the less\nthan the average of all preceding terms.\nIntuitively this means $x_n$ should become close to each other,\nsince they are also nonnegative.\n\nHowever, we have a second condition we haven't used yet:\nthe ``integer'' condition implies\n\\[\n  \\left\\lvert x_{n+1} - x_n \\right\\rvert\n  = \\left\\lvert \\lambda - \\#\\{n \\in A \\} \\right\\rvert\n  > \\eps\n\\]\nfor some fixed $\\eps > 0$,\nnamely $\\eps = \\min \\left\\{ \\lambda, 1 - \\lambda \\right\\}$.\nUsing the fact that consecutive terms differ by some fixed $\\eps$,\nwe will derive a contradiction.\n\nIf we let $M$ be the average of $x_1$, \\dots, $x_{N_0}$,\nthen we ought to have\n\\[ x_n < M \\qquad \\forall n > N_0. \\]\nHence for $n > N_0$ we have $x_n + x_{n+1} < 2M - \\eps$,\nand so for large enough $n$ the average\nmust drop to just above $M - \\half \\eps$.\nThus for some large $N_1 > N_0$, we will have\n\\[ x_n < M - \\frac13 \\eps \\qquad \\forall n > N_1. \\]\nIf we repeat this argument then with a large $N_2 > N_1$, we obtain\n\\[ x_n < M - \\frac23 \\eps \\qquad \\forall n > N_2 \\]\nand so on and so forth.\nThis is a clear contradiction.\n\n\\begin{remark*}\nNote that if $A = \\{2,2,3,4,5,\\dots\\}$ and $\\lambda = 1$ then contradiction.\nSo the condition that $0 < \\lambda < 1$ cannot be dropped,\nand (by scaling) neither can the condition that $A \\subseteq \\ZZ$.\n\\end{remark*}\n\n\\begin{remark*}\n  [Suggested by Zhao Ting-wei]\n  Despite the relation\n  \\[ x_{n} < \\frac{x_1 + \\dots + x_{n-1}}{n}\n    \\qquad \\forall n \\ge N_0 \\]\n  implying that $x_n$ is bounded,\n  it does not alone imply that $x_n$ converges, not even to some nonzero value.\n  Zhao Ting-Wei showed me that one can have a sequence which is zero\n  ``every so often'' yet where the average is nonzero.\n\n  A counterexample is given explicitly by\n  \\[\n    x_n\n    = \\begin{cases}\n      1000 & n = 1 \\\\\n      0 & n \\text{ is a power of $10$} \\\\\n      1 + \\frac 1n & \\text{otherwise}\n    \\end{cases}\n  \\]\n  which does not have a limit.\n  For completeness, let's check this ---\n  let $H_n$ denote the $n$'th harmonic number, and compute\n  \\begin{align*}\n    \\sum_1^{n-1} x_n\n    &= 1000 + (n-1) + H_{n-1} - \\sum_{k=1}^{\\left\\lfloor \\log_{10} n \\right\\rfloor} \\left( 1 + \\frac{1}{10^k} \\right) \\\\\n    &> n + 999 + H_{n-1} - \\log_{10} n - \\left( 1 + \\frac{1}{10} + \\dots \\right) \\\\\n    &> n + 997 + H_{n-1} - \\log_{10} n > n + 1\n  \\end{align*}\n  so $1 + \\frac 1n < \\frac 1n \\sum_1^{n-1} x_n$ as needed.\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "USAMO", "year": 2015}
{"id": "tstst-2018-q1", "question": "As usual, let $\\ZZ[x]$ denote the set of single-variable\npolynomials in $x$ with integer coefficients.\nFind all functions $\\theta \\colon \\ZZ[x] \\to \\ZZ$\nsuch that for any polynomials $p,q \\in \\ZZ[x]$,\n\\begin{itemize}\n  \\ii $\\theta(p+1) = \\theta(p)+1$, and\n  \\ii if $\\theta(p) \\neq 0$\n  then $\\theta(p)$ divides $\\theta(p \\cdot q)$.\n\\end{itemize}", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10570981}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nAs usual, let $\\ZZ[x]$ denote the set of single-variable\npolynomials in $x$ with integer coefficients.\nFind all functions $\\theta \\colon \\ZZ[x] \\to \\ZZ$\nsuch that for any polynomials $p,q \\in \\ZZ[x]$,\n\\begin{itemize}\n  \\ii $\\theta(p+1) = \\theta(p)+1$, and\n  \\ii if $\\theta(p) \\neq 0$\n  then $\\theta(p)$ divides $\\theta(p \\cdot q)$.\n\\end{itemize}\n\\end{mdframed}\nThe answer is $\\theta : p \\mapsto p(c)$, for each choice of $c \\in \\ZZ$.\nObviously these work, so we prove these are the only ones.\nIn what follows, $x \\in \\ZZ[x]$ is the identity polynomial,\nand $c = \\theta(x)$.\n\n\\paragraph{First solution (Merlijn Staps).}\nConsider an integer $n \\neq c$.\nBecause $x-n \\mid p(x)-p(n)$, we have\n\\[ \\theta(x-n) \\mid \\theta(p(x)-p(n))\n  \\implies c - n \\mid \\theta(p(x)) - p(n).\n\\]\nOn the other hand, $c - n \\mid p(c) - p(n)$.\nCombining the previous two gives $c - n \\mid \\theta(p(x)) - p(c)$,\nand by letting $n$ large we conclude\n$\\theta(p(x)) - p(c) = 0$, so $\\theta(p(x)) = p(c)$.\n\n\\paragraph{Second solution.}\nFirst, we settle the case $\\deg p = 0$.\nIn that case, from the second property,\n$\\theta(m) = m + \\theta(0)$ for every integer $m \\in \\ZZ$\n(viewed as a constant polynomial).\nThus $m + \\theta(0) \\mid 2m + \\theta(0)$,\nhence $m + \\theta(0) \\mid -\\theta(0)$,\nso $\\theta(0) = 0$ by taking $m$ large.\nThus $\\theta(m) = m$ for $m \\in \\ZZ$.\n\nNext, we address the case of $\\deg p = 1$.\nWe know $\\theta(x+b) = c+b$ for $b \\in \\ZZ$.\nNow for each particular $a \\in \\ZZ$,\nwe have\n\\[ c+k \\mid \\theta(x+k) \\mid \\theta(ax+ak) = \\theta(ax) + ak\n  \\implies c+k \\mid \\theta(ax) - ac. \\]\nfor any $k \\neq -c$.\nSince this is true for large enough $k$,\nwe conclude $\\theta(ax) = ac$.\nThus $\\theta(ax+b) = ac+b$.\n\nWe now proceed by induction on $\\deg p$.\nFix a polynomial $p$ and assume it's true\nfor all $p$ of smaller degree.\nChoose a large integer $n$ (to be determined later)\nfor which $p(n) \\neq p(c)$.\nWe then have\n\\[ \\frac{p(c)-p(n)}{c-n}\n  = \\theta\\left( \\frac{p-p(n)}{x-n} \\right)\n  \\mid \\theta\\left( p-p(n) \\right)\n  = \\theta(p) - p(n). \\]\nSubtracting off $c-n$ times the left-hand side gives\n\\[ \\frac{p(c)-p(n)}{c-n}\n  \\mid \\theta(p) - p(c). \\]\nThe left-hand side can be made arbitrarily large\nby letting $n \\to \\infty$, since $\\deg p \\ge 2$.\nThus $\\theta(p) = p(c)$, concluding the proof.\n\n\\paragraph{Authorship comments.}\nI will tell you a story about the creation of this problem.\nYang Liu and I were looking over the drafts of December and\nJanuary TST in October 2017,\nand both of us had the impression that the test was too difficult.\nThis sparked a non-serious suggestion that we should try to\ncome up with a problem \\emph{now} that would be easy enough to use.\nWhile we ended up just joking about changing the TST,\nwe did get this problem out of it.\n\nOur idea was to come up with a functional equation that\nwas different from the usual fare:\nat first we tried $\\ZZ[x] \\to \\ZZ[x]$,\nbut then I suggested the idea of using $\\ZZ[x] \\to \\ZZ$,\nwith the answer being the ``evaluation'' map.\nWell, what properties does that satisfy?\nOne answer was $a-b \\mid p(a)-p(b)$;\nthis didn't immediately lead to anything,\nbut eventually we hit on the form of the problem above off this idea.\nAt first we didn't require $\\theta(p) \\neq 0$ in the bullet,\nbut without the condition the problem was too easy,\nsince $0$ divides only itself;\nand so the condition was added and we got the functional equation.\n\nI proposed the problem to USAMO 2018, but it was rejected\n(unsurprisingly; I think the problem may be\ntoo abstract for novice contestants).\nInstead it was used for TSTST, which I thought fit better.\n\\pagebreak", "category": "Algebra", "source": "TSTST", "year": 2018}
{"id": "tstst-2018-q2", "question": "In the nation of Onewaynia,\ncertain pairs of cities are connected by one-way roads.\nEvery road connects exactly two cities\n(roads are allowed to cross each other, e.g., via bridges),\nand each pair of cities has at most one road between them.\nMoreover, every city has exactly two roads leaving it and\nexactly two roads entering it.\n\nWe wish to close half the roads of Onewaynia in such a way that\nevery city has exactly one road leaving it and exactly one road entering it.\nShow that the number of ways to do so is a power of $2$ greater than $1$\n(i.e.\\ of the form $2^n$ for some integer $n \\ge 1$).", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10570985}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nIn the nation of Onewaynia,\ncertain pairs of cities are connected by one-way roads.\nEvery road connects exactly two cities\n(roads are allowed to cross each other, e.g., via bridges),\nand each pair of cities has at most one road between them.\nMoreover, every city has exactly two roads leaving it and\nexactly two roads entering it.\n\nWe wish to close half the roads of Onewaynia in such a way that\nevery city has exactly one road leaving it and exactly one road entering it.\nShow that the number of ways to do so is a power of $2$ greater than $1$\n(i.e.\\ of the form $2^n$ for some integer $n \\ge 1$).\n\\end{mdframed}\nIn the language of graph theory, we have a simple digraph $G$\nwhich is 2-regular and we seek the\nnumber of sub-digraphs which are $1$-regular.\nWe now present two solution paths.\n\n\\paragraph{First solution, combinatorial.}\nWe construct a simple undirected bipartite graph $\\Gamma$ as follows:\n\\begin{itemize}\n  \\ii the vertex set consists of two copies of $V(G)$,\n  say $V_{\\text{out}}$ and $V_{\\text{in}}$; and\n  \\ii for $v \\in V_{\\text{out}}$ and $w \\in V_{\\text{in}}$\n  we have an undirected edge $vw \\in E(\\Gamma)$\n  if and only if the directed edge $v \\to w$ is in $G$.\n\\end{itemize}\nMoreover, the desired sub-digraphs of $H$ correspond exactly\nto perfect matchings of $\\Gamma$.\n\nHowever the graph $\\Gamma$ is $2$-regular\nand hence consists of several disjoint (simple) cycles of even length.\nIf there are $n$ such cycles, the number of perfect matchings\nis $2^n$, as desired.\n\n\\begin{remark*}\n  The construction of $\\Gamma$ is not as magical as it may first seem.\n\n  Suppose we pick a road $v_1 \\to v_2$ to use.\n  Then, the other road $v_3 \\to v_2$ is certainly \\emph{not} used;\n  hence some other road $v_3 \\to v_4$ must be used, etc.\n  We thus get a cycle of forced decisions until\n  we eventually return to the vertex $v_1$.\n\n  These cycles in the original graph $G$\n  (where the arrows alternate directions)\n  correspond to the cycles we found in $\\Gamma$.\n  It's merely that phrasing the solution in terms of $\\Gamma$\n  makes it cleaner in a linguistic sense,\n  but not really in a mathematical sense.\n\\end{remark*}\n\n\\paragraph{Second solution by linear algebra over $\\FF_2$ (Brian Lawrence).}\nThis is actually not that different from the first solution.\nFor each edge $e$, we create an indicator variable $x_e$.\nWe then require for each vertex $v$ that:\n\\begin{itemize}\n  \\ii If $e_1$ and $e_2$ are the two edges leaving $v$,\n  then we require $x_{e_1} + x_{e_2} \\equiv 1 \\pmod 2$.\n  \\ii If $e_3$ and $e_4$ are the two edges entering $v$,\n  then we require $x_{e_3} + x_{e_4} \\equiv 1 \\pmod 2$.\n\\end{itemize}\nWe thus get a large system of equations.\nMoreover, the solutions come in natural pairs $\\vec x$ and $\\vec x + \\vec 1$\nand therefore the number of solutions is either zero, or a power of two.\nSo we just have to prove there is at least one solution.\n\nFor linear algebra reasons, there can only be zero solutions\nif some nontrivial linear combination of the equations gives the sum $0 \\equiv 1$.\nSo suppose we added up some subset $S$ of the equations\nfor which every variable appeared on the left-hand side an even number of times.\nThen every variable that did appear appeared exactly twice;\nand accordingly we see that the edges corresponding to these variables\nform one or more even cycles as in the previous solution.\nOf course, this means $|S|$ is even, so we really have $0 \\equiv 0 \\pmod 2$ as needed.\n\n\\begin{remark*}\n  The author's original proposal contained a second part\n  asking to show that it was not always possible\n  for the resulting $H$ to be connected,\n  even if $G$ was strongly connected.\n  This problem is related to IMO Shortlist 2002 C6,\n  which gives an example of a strongly connected graph\n  which does have a full directed Hamiltonian cycle.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "TSTST", "year": 2018}
{"id": "tstst-2018-q3", "question": "Let $ABC$ be an acute triangle with incenter $I$, circumcenter $O$, and circumcircle $\\Gamma$.\nLet $M$ be the midpoint of $\\ol{AB}$.\nRay $AI$ meets $\\ol{BC}$ at $D$.\nDenote by $\\omega$ and $\\gamma$ the circumcircles of $\\triangle BIC$ and $\\triangle BAD$, respectively.\nLine $MO$ meets $\\omega$ at $X$ and $Y$, while line $CO$ meets $\\omega$ at $C$ and $Q$.\nAssume that $Q$ lies inside $\\triangle ABC$ and $\\angle AQM = \\angle ACB$.\n\nConsider the tangents to $\\omega$ at $X$ and $Y$ and the tangents to $\\gamma$ at $A$ and $D$.\nGiven that $\\angle BAC \\neq 60\\dg$, prove that these four lines are concurrent on $\\Gamma$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10570988}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be an acute triangle with incenter $I$, circumcenter $O$, and circumcircle $\\Gamma$.\nLet $M$ be the midpoint of $\\ol{AB}$.\nRay $AI$ meets $\\ol{BC}$ at $D$.\nDenote by $\\omega$ and $\\gamma$ the circumcircles of $\\triangle BIC$ and $\\triangle BAD$, respectively.\nLine $MO$ meets $\\omega$ at $X$ and $Y$, while line $CO$ meets $\\omega$ at $C$ and $Q$.\nAssume that $Q$ lies inside $\\triangle ABC$ and $\\angle AQM = \\angle ACB$.\n\nConsider the tangents to $\\omega$ at $X$ and $Y$ and the tangents to $\\gamma$ at $A$ and $D$.\nGiven that $\\angle BAC \\neq 60\\dg$, prove that these four lines are concurrent on $\\Gamma$.\n\\end{mdframed}\nHenceforth assume $\\angle A \\neq 60\\dg$; we prove the concurrence.\nLet $L$ denote the center of $\\omega$, which is the midpoint of minor arc $BC$.\n\n\\begin{claim*}\n  Let $K$ be the point on $\\omega$ such that\n  $\\ol{KL} \\parallel \\ol{AB}$ and $\\ol{KC} \\parallel \\ol{AL}$.\n  Then $\\ol{KA}$ is tangent to $\\gamma$, and we may put\n  \\[ x = KA = LB = LC = LX = LY = KX = KY. \\]\n\\end{claim*}\n\\begin{proof}\n  By construction, $KA = LB = LC$.\n  Also, $\\ol{MO}$ is the perpendicular bisector of $\\ol{KL}$\n  (since the chords $\\ol{KL}$, $\\ol{AB}$ of $\\omega$ are parallel)\n  and so $KXLY$ is a rhombus as well.\n\n  Moreover, $\\ol{KA}$ is tangent to $\\gamma$ as well since\n  \\[ \\dang KAD = \\dang KAL = \\dang KAC + \\dang CAL\n    = \\dang KBC + \\dang ABK = \\dang ABC. \\qedhere \\]\n\\end{proof}\n\n\\begin{center}\n\\begin{asy}\nsize(9cm);\npair L = dir(270);\npair B = dir(196);\npair C = L*L/B;\nreal r = 2**0.5 * abs(C-L);\n\npair A = IP(unitcircle, CR(C, r));\nfilldraw(unitcircle, opacity(0.1)+lightcyan, lightblue);\ndraw(A--B--C--cycle, lightblue);\n\npair M = midpoint(A--B);\npair N = midpoint(A--C);\npair O = origin;\npair E = extension(M, O, B, C);\npair K = 2*E-L;\npair X = IP(M--O, CP(L, B));\npair Y = 2*E-X;\n\nfilldraw(CP(L, X), opacity(0.1)+lightgreen, heavygreen);\n\nclip(box((-1.4,-1.4),(1.4,1.4)));\npair D = extension(A, L, B, C);\nfilldraw(X--L--Y--K--cycle, opacity(0.15)+lightred, red+0.8);\n\ndraw(A--K, red+dashed);\ndraw(B--L, red+dashed);\ndraw(K--D, red+dashed);\ndraw(C--L, red+dashed);\n\ndraw(A--L, heavycyan);\ndraw(K--C, heavycyan);\npair Q = foot(A, C, O);\ndraw(A--Q--C, orange);\ndraw(N--L, orange);\ndraw(M--Y, purple);\ndraw(K--L, purple);\n\ndot(\"$L$\", L, dir(L));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$A$\", A, dir(A));\ndot(\"$M$\", M, dir(M));\ndot(\"$N$\", N, dir(N));\ndot(\"$O$\", O, dir(45));\ndot(\"$E$\", E, dir(270));\ndot(\"$K$\", K, dir(K));\ndot(\"$X$\", X, dir(100));\ndot(\"$Y$\", Y, dir(Y));\ndot(\"$D$\", D, dir(315));\ndot(\"$Q$\", Q, dir(Q));\n\n/* TSQ Source:\n\n!size(9cm);\nL = dir 270\nB = dir 196\nC = L*L/B\n!real r = 2**0.5 * abs(C-L);\n\nA = IP unitcircle CR C r\nunitcircle 0.1 lightcyan / lightblue\nA--B--C--cycle lightblue\n\nM = midpoint A--B\nN = midpoint A--C\nO = origin R45\nE = extension M O B C R270\nK = 2*E-L\nX = IP M--O CP L B R100\nY = 2*E-X\n\nCP L X 0.1 lightgreen / heavygreen\n\n!clip(box((-1.4,-1.4),(1.4,1.4)));\nD = extension A L B C R315\nX--L--Y--K--cycle 0.15 lightred / red+0.8\n\nA--K red dashed\nB--L red dashed\nK--D red dashed\nC--L red dashed\n\nA--L heavycyan\nK--C heavycyan\nQ = foot A C O\nA--Q--C orange\nN--L orange\nM--Y purple\nK--L purple\n\n*/\n\\end{asy}\n\\end{center}\n\nUp to now we have not used the existence of $Q$; we henceforth do so.\n\nNote that $Q \\neq O$, since $\\angle A \\neq 60\\dg \\implies O \\notin \\omega$.\nMoreover, we have $\\angle AOM = \\angle ACB$ too.\nSince $O$ and $Q$ both lie inside $\\triangle ABC$,\nthis implies that $A$, $M$, $O$, $Q$ are concyclic.\nAs $Q \\neq O$ we conclude $\\angle CQA = 90\\dg$.\n\nThe main claim is now:\n\\begin{claim*}\n  Assuming $Q$ exists, the rhombus $LXKY$ is a square.\n  In particular, $\\ol{KX}$ and $\\ol{KY}$ are tangent to $\\omega$.\n\\end{claim*}\n\n\\begin{proof}\n  [First proof of Claim, communicated by Milan Haiman]\n  Observe that $\\triangle QLC \\sim \\triangle LOC$\n  since both triangles are isosceles and share a base angle.\n  Hence, $CL^2 = CO \\cdot CQ$.\n\n  Let $N$ be the midpoint of $\\ol{AC}$, which lies on $(AMOQ)$.\n  Then,\n  \\[ x^2 = CL^2 = CO \\cdot CQ = CN \\cdot CA = \\half CA^2 = \\half LK^2 \\]\n  where we have also used the fact $AQON$ is cyclic.\n  Thus $LK = \\sqrt2 x$ and so the rhombus $LXKY$ is actually a square.\n\\end{proof}\n\n\\begin{proof}\n  [Second proof of Claim, Evan Chen]\n  Observe that $Q$ lies on the circle with diameter $\\ol{AC}$, centered at $N$, say.\n  This means that $O$ lies on the radical axis of $\\omega$ and $(N)$,\n  hence $\\ol{NL} \\perp \\ol{CO}$ implying\n  \\begin{align*}\n    NO^2 + CL^2 &= NC^2 + LO^2\n    = NC^2 + OC^2 = NC^2 + NO^2 + NC^2 \\\\\n    \\implies x^2 &= 2NC^2 \\\\\n    \\implies x &= \\sqrt 2 NC = \\frac{1}{\\sqrt2} AC = \\frac{1}{\\sqrt2} LK.\n  \\end{align*}\n  So $LXKY$ is a rhombus with $LK = \\sqrt2 x$.\n  Hence it is a square.\n\\end{proof}\n\n\\begin{proof}\n  [Third proof of Claim]\n  A solution by trig is also possible.\n  As in the previous claims, it suffices to show that $AC = \\sqrt 2 x$.\n\n  First, we compute the length $CQ$ in two ways; by angle chasing one can show\n  $\\angle CBQ = 180\\dg - (\\angle BQC + \\angle QCB) = \\half \\angle A$,\n  and so\n  \\begin{align*}\n    AC \\sin B = CQ &= \\frac{BC}{\\sin(90\\dg+\\half\\angle A)} \\cdot \\sin\\half\\angle A \\\\\n    \\iff \\sin^2 B &= \\frac{\\sin A \\cdot \\sin \\half \\angle A}{\\cos \\half \\angle A} \\\\\n    \\iff \\sin^2 B &= 2\\sin^2 \\half \\angle A \\\\\n    \\iff \\sin B &= \\sqrt 2 \\sin \\half \\angle A \\\\\n    \\iff 2R \\sin B &= \\sqrt 2 \\left(2R \\sin \\half \\angle A\\right) \\\\\n    \\iff AC &= \\sqrt 2 x\n  \\end{align*}\n  as desired (we have here used the fact $\\triangle ABC$ is acute to take square roots).\n\n  It is interesting to note that $\\sin^2 B = 2 \\sin^2 \\half \\angle A$\n  can be rewritten as \\[ \\cos A = \\cos^2 B \\]\n  since $\\cos^2 B = 1 - \\sin^2 B = 1 - 2 \\sin^2 \\half \\angle A = \\cos A$;\n  this is the condition for the existence of the point $Q$.\n\\end{proof}\n\nWe finish by proving that\n\\[ KD = KA \\]\nand hence line $\\ol{KD}$ is tangent to $\\gamma$.\nLet $E = \\ol{BC} \\cap \\ol{KL}$.\nThen\n\\[ LE \\cdot LK = LC^2 = LX^2 = \\half LK^2 \\]\nand so $E$ is the midpoint of $\\ol{LK}$.\nThus $\\ol{MXOY}$, $\\ol{BC}$, $\\ol{KL}$ are concurrent at $E$.\nAs $\\ol{DL} \\parallel \\ol{KC}$, we find that $DLCK$ is a parallelogram,\nso $KD = CL = KA$ as well.\nThus $\\ol{KD}$ and $\\ol{KA}$ are tangent to $\\gamma$.\n\n\\begin{remark*}\n  The condition $\\angle A \\neq 60\\dg$ cannot be dropped, since if $Q = O$ the problem is not true.\n\n  On the other hand, nearly all solutions begin by observing $Q \\neq O$ and then obtaining $\\angle AQO = 90\\dg$.\n  This gives a way to construct the diagram by hand with ruler and compass.\n  One draws an arbitrary chord $\\ol{BC}$ of a circle $\\omega$ centered at $L$,\n  and constructs $O$ as the circumcenter of $\\triangle BLC$ (hence obtaining $\\Gamma$).\n  Then $Q$ is defined as the intersection of ray $CO$ with $\\omega$,\n  and $A$ is defined by taking the perpendicular line through $Q$ on the circle $\\Gamma$.\n  In this way we can draw a triangle $ABC$ satisfying the problem conditions.\n\\end{remark*}\n\n\\paragraph{Authorship comments.}\nIn the notation of the present points,\nthe question originally sent to me by Yannick Yao read:\n\\begin{quote}\n  Circles $(L)$ and $(O)$ are drawn,\n  meeting at $B$ and $C$, with $L$ on $(O)$.\n  Ray $CO$ meets $(L)$ at $Q$,\n  and $A$ is on $(O)$ such that $\\angle CQA = 90\\dg$.\n  The angle bisector of $\\angle AOB$ meets $(L)$ at $X$ and $Y$.\n  Show that $\\angle XLY = 90\\dg$.\n\\end{quote}\nNotice the points $M$ and $K$ are absent from the problem.\nI am told this was found as part of the computer game ``Euclidea''.\nUsing this as the starting point,\nI constructed the TSTST problem by recognizing the significance\nof that special point $K$, which became the center of attention.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Geometry", "source": "TSTST", "year": 2018}
{"id": "tstst-2018-q4", "question": "For an integer $n > 0$,\ndenote by $\\mathcal F(n)$ the set of integers $m > 0$ for which\nthe polynomial $p(x) = x^2 + mx + n$ has an integer root.\n\\begin{enumerate}\n\\item [(a)] Let $S$ denote the set of integers $n > 0$\n  for which $\\mathcal F(n)$ contains two consecutive integers.\n  Show that $S$ is infinite but\n  \\[ \\sum_{n \\in S} \\frac 1n \\le 1. \\]\n\\item [(b)] Prove that there are infinitely many positive integers $n$\n  such that $\\mathcal F(n)$ contains three consecutive integers.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10570991}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFor an integer $n > 0$,\ndenote by $\\mathcal F(n)$ the set of integers $m > 0$ for which\nthe polynomial $p(x) = x^2 + mx + n$ has an integer root.\n\\begin{enumerate}\n\\item [(a)] Let $S$ denote the set of integers $n > 0$\n  for which $\\mathcal F(n)$ contains two consecutive integers.\n  Show that $S$ is infinite but\n  \\[ \\sum_{n \\in S} \\frac 1n \\le 1. \\]\n\\item [(b)] Prove that there are infinitely many positive integers $n$\n  such that $\\mathcal F(n)$ contains three consecutive integers.\n\\end{enumerate}\n\\end{mdframed}\nWe prove the following.\n\\begin{claim*}\n  The set $S$ is given explicitly by\n  $S = \\{ x(x+1)y(y+1) \\mid x,y > 0 \\}$.\n\\end{claim*}\n\\begin{proof}\n  Note that $m, m+1 \\in \\mathcal F(n)$ if and only if\n  there exist integers $q > p \\ge 0$ such that\n  \\begin{align*}\n    m^2 - 4n &= p^2 \\\\\n    (m+1)^2 - 4n &= q^2.\n  \\end{align*}\n  Subtraction gives $2m+1 = q^2-p^2$, so $p$ and $q$ are different parities.\n  We can thus let $q-p = 2x+1$, $q+p = 2y+1$, where $y \\ge x \\ge 0$ are integers.\n  It follows that\n  \\begin{align*}\n    4n &= m^2 - p^2 \\\\\n    &= \\left( \\frac{q^2-p^2-1}{2} \\right)^2 - p^2\n    = \\left( \\frac{q^2-p^2-1}{2} - p \\right) \\left( \\frac{q^2-p^2-1}{2} + p \\right) \\\\\n    &= \\frac{q^2-(p^2+2p+1)}{2} \\cdot \\frac{q^2-(p^2-2p+1)}{2} \\\\\n    &= \\frac14 (q-p-1)(q-p+1)(q+p-1)(q+p+1)\n    = \\frac14 (2x)(2x+2)(2y)(2y+2) \\\\\n    \\implies n &= x(x+1)y(y+1).\n  \\end{align*}\n  Since $n > 0$ we require $x,y > 0$.\n  Conversely, if $n = x(x+1)y(y+1)$ for positive $x$ and $y$ then\n  $m = \\sqrt{p^2+4n} = \\sqrt{(y-x)^2+4n} = 2xy+x+y = x(y+1) + (x+1)y$\n  and $m+1 = 2xy+x+y+1 = xy + (x+1)(y+1)$.\n  Thus we conclude the main claim.\n\\end{proof}\nFrom this, part (a) follows as\n\\[ \\sum_{n \\in S} n\\inv\n  \\le\n  \\left( \\sum_{x \\ge 1} \\frac{1}{x(x+1)} \\right)\n  \\left( \\sum_{y \\ge 1} \\frac{1}{y(y+1)} \\right)\n  = 1 \\cdot 1 = 1.\n\\]\n\nAs for (b), retain the notation in the proof of the claim.\nNow $m+2 \\in S$ if and only if\n$(m+2)^2 - 4n$ is a square, say $r^2$.\nWriting in terms of $p$ and $q$ as parameters we find\n\\begin{align*}\n  r^2 &= (m+2)^2 - 4n = m^2-4n + 4m + 4 = p^2 + 2 + 2(2m+1) \\\\\n  &= p^2 + 2(q^2-p^2) + 2 = 2q^2 - p^2 + 2 \\\\\n  \\iff 2q^2 + 2 &= p^2 + r^2 \\qquad (\\dagger)\n\\end{align*}\nwith $q > p$ of different parity\nand $n = \\frac{1}{16} (q-p-1)(q-p+1)(q+p-1)(q+p+1)$.\n\nNote that (by taking modulo $8$) we have $q \\not\\equiv p \\equiv r \\pmod 2$,\nand so there are no parity issues\nand we will always assume $p < q < r$ in $(\\dagger)$.\nNow, for every $q$, the equation $(\\dagger)$\nhas a canonical solution $(p,r) = (q-1, q+1)$, but this leaves $n = 0$.\nThus we want to show for infinitely many $q$\nthere is a third way to write $2q^2+2$ as a sum of squares,\nwhich will give the desired $p$.\n\nTo do this, choose large integers $q$ such that $q^2+1$\nis divisible by at least three distinct $1\\bmod4$ primes.\nSince each such prime can be written\nas a sum of two squares, using Lagrange identity,\nwe can deduce that $2q^2+2$ can be written as a sum of\ntwo squares in at least three different ways, as desired.\n\n\\begin{remark*}\n  We can see that $n=144$ is the smallest integer\n  such that $\\mathcal F(n)$ contains three consecutive integers\n  and $n=15120$ is the smallest integer such that $\\mathcal F(n)$\n  contains four consecutive integers.\n  It would be interesting to determine whether\n  the number of consecutive elements in $\\mathcal F(n)$\n  can be arbitrarily large or is bounded.\n\\end{remark*}\n\\pagebreak", "category": "Number Theory", "source": "TSTST", "year": 2018}
{"id": "tstst-2018-q5", "question": "Let $ABC$ be an acute triangle with circumcircle $\\omega$,\nand let $H$ be the foot of the altitude from $A$ to $\\ol{BC}$.\nLet $P$ and $Q$ be the points on $\\omega$ with $PA = PH$ and $QA = QH$.\nThe tangent to $\\omega$ at $P$ intersects lines $AC$ and $AB$\nat $E_1$ and $F_1$ respectively; the tangent to $\\omega$ at $Q$\nintersects lines $AC$ and $AB$ at $E_2$ and $F_2$ respectively.\nShow that the circumcircles of $\\triangle AE_1F_1$ and $\\triangle AE_2F_2$\nare congruent, and the line through their centers\nis parallel to the tangent to $\\omega$ at $A$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10571000}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be an acute triangle with circumcircle $\\omega$,\nand let $H$ be the foot of the altitude from $A$ to $\\ol{BC}$.\nLet $P$ and $Q$ be the points on $\\omega$ with $PA = PH$ and $QA = QH$.\nThe tangent to $\\omega$ at $P$ intersects lines $AC$ and $AB$\nat $E_1$ and $F_1$ respectively; the tangent to $\\omega$ at $Q$\nintersects lines $AC$ and $AB$ at $E_2$ and $F_2$ respectively.\nShow that the circumcircles of $\\triangle AE_1F_1$ and $\\triangle AE_2F_2$\nare congruent, and the line through their centers\nis parallel to the tangent to $\\omega$ at $A$.\n\\end{mdframed}\nLet $O$ be the center of $\\omega$,\nand let $M = \\ol{PQ} \\cap \\ol{AB}$ and $N = \\ol{PQ} \\cap \\ol{AC}$\nbe the midpoints of $\\ol{AB}$ and $\\ol{AC}$ respectively.\nRefer to the diagram below.\n\n\\begin{center}\n\\begin{asy}\nsize(9cm);\npair A, B, C, O, M, N, P, Q, E1, F1, E2, F2, O1, O2;\nA = dir(105); B = dir(190); C = dir(350);\n//A = dir(160); B = dir(250); C = dir(290);\nO = origin;\nM = (A + B)/2; N = (A + C)/2;\nP = point(unitcircle, intersections(unitcircle, M, N)[1]);\nQ = point(unitcircle, intersections(unitcircle, M, N)[0]);\nE1 = extension(A, C, P, rotate(90, P) * origin);\nF1 = extension(A, B, P, rotate(90, P) * origin);\nE2 = extension(A, C, Q, rotate(90, Q) * origin);\nF2 = extension(A, B, Q, rotate(90, Q) * origin);\nO1 = circumcenter(A, E1, F1);\nO2 = circumcenter(A, E2, F2);\nfill(O--P--E1--cycle^^O--Q--E2--cycle, lightblue + opacity(0.5));\nfill(O--P--F1--cycle^^O--Q--F2--cycle, lightred + opacity(0.5));\ndraw(A--E1^^A--F2^^B--F1^^C--E2, gray(0.5));\ndraw(O--P^^O--Q^^O--M^^O--N, gray(0.5));\ndraw(E1--F1^^E2--F2);\ndraw(arc(O1, F1, E1)^^arc(O2, F2, E2), dashed);\ndraw(unitcircle);\ndraw(A--B--C--cycle);\ndraw(P--Q);\n\ndot(\"$A$\", A, dir(60));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$O$\", O, dir(200));\ndot(\"$M$\", M, dir(120));\ndot(\"$N$\", N, dir(60));\ndot(\"$P$\", P, dir(P));\ndot(\"$Q$\", Q, dir(Q));\ndot(\"$E_1$\", E1, dir(P));\ndot(\"$F_1$\", F1, dir(P));\ndot(\"$E_2$\", E2, dir(Q));\ndot(\"$F_2$\", F2, dir(Q));\n\\end{asy}\n\\end{center}\n\nThe main idea is to prove two key claims involving $O$,\nwhich imply the result:\n\\begin{enumerate}[(i)]\n  \\ii quadrilaterals $AOE_1F_1$ and $AOE_2F_2$ are cyclic\n  (giving the radical axis is $\\ol{AO}$),\n  \\ii $\\triangle OE_1F_1 \\cong \\triangle OE_2F_2$\n  (giving the congruence of the circles).\n\\end{enumerate}\nWe first note that (i) and (ii) are equivalent.\nIndeed, because $OP = OQ$, (ii)\nis equivalent to just the similarity $\\triangle OE_1F_1 \\sim \\triangle OE_2F_2$,\nand then by the spiral similarity lemma\n(or even just angle chasing) we have (i) $\\iff$ (ii).\n\nWe now present five proofs, two of (i) and three of (ii).\nThus, we are essentially presenting five different solutions.\n%Thus the line through the centers mentioned in the problem\n%is the perpendicular bisector of $\\ol{AO}$.\n%We provide two solutions below.\n\n\\paragraph{Proof of (i) by angle chasing.}\nNote that\n\\[ \\dang F_2E_2O = \\dang QE_2O = \\dang QNO = \\dang MNO\n  = \\dang MAO = \\dang F_2AO \\]\nand hence $E_2OAF_2$ is cyclic.\nSimilarly, $E_1OAF_1$ is cyclic.\n\n\\paragraph{Proof of (i) by Simson lines.}\nSince $P$, $M$, $N$ are collinear,\nwe see that $\\ol{PMN}$ is the Simson line of $O$\nwith respect to $\\triangle AE_1F_1$.\n\n\\paragraph{Proof of (ii) by butterfly theorem.}\nBy using the \\textbf{Butterfly Theorem}\non the three chords $\\ol{AC}$, $\\ol{PQ}$, $\\ol{PQ}$ concurring at the midpoint $N$\nof $\\ol{AC}$, it follows that $E_1N = NE_2$\n(since $E_1 = \\ol{PP} \\cap \\ol{AC}$, $E_2 = \\ol{QQ} \\cap \\ol{AC}$).\nThus \\[ E_1P = \\sqrt{E_1A \\cdot E_1C} = \\sqrt{E_2A \\cdot E_2C} = E_2P. \\]\nBut also $OP = OQ$ and hence\n$\\triangle OPE_1 \\cong \\triangle OQE_2$.\nSimilarly for the other pair.\n\n\\paragraph{Proof of (ii) by projective geometry.}\nLet $T = \\ol{PP} \\cap \\ol{QQ}$.\nLet $S$ be on $\\ol{PQ}$ with $\\ol{ST} \\parallel \\ol{AC}$;\nthen $\\ol{TS} \\perp \\ol{ON}$,\nand it follows $\\ol{ST}$ is the polar of $N$\n(it passes through $T$ by La Hire).\n\nNow, \\[ -1 = (PQ;NS) \\overset{T}{=} (E_1E_2;N\\infty) \\]\nwith $\\infty = \\ol{AC} \\cap \\ol{ST}$ the point at infinity.\nHence $E_1 N = N E_2$ and we can proceed as in the previous solution.\n\n%Note that $\\angle E_1PO = \\angle E_1NO = 90^{\\circ}$; hence $O \\in \\odot(E_1PN)$. Similarly $O \\in \\odot(E_2QN)$; by the spiral similarity lemma, $\\triangle OPE_1 \\stackrel{+}{\\sim} \\triangle OQE_2$. Since $OP = OQ$, $\\triangle OPE_1 \\stackrel{+}{\\cong} \\triangle OQE_2$. Similarly $\\triangle OPF_1 \\stackrel{+}{\\cong} \\triangle OQF_2$, so $\\triangle OE_1F_1 \\stackrel{+}{\\cong} \\triangle OE_2F_2$.\n%\n%By the converse of the spiral similarity lemma, $O$ lies on $\\odot(AE_1F_1)$ and $\\odot(AE_2F_2)$. Since $\\triangle OE_1F_1 \\cong \\triangle OE_2F_2$, the circumcircles are congruent. The circumcircles share common chord $\\ol{AO}$; thus the line joining their centers is parallel to the tangent to $\\omega$ at $A$.\n\n\\begin{remark*}\nThe assumption that $\\triangle ABC$ is acute is not necessary; it is only present to ensure that $P$ lies on segment $E_1F_1$ and $Q$ lies on segment $E_2F_2$, which may be helpful for contestants. The argument presented above is valid in all configurations. When one of $\\angle B$ and $\\angle C$ is a right angle, some of the points $E_1$, $F_1$, $E_2$, $F_2$ lie at infinity; when one of them is obtuse, both $P$ and $Q$ lie outside segments $E_1F_1$ and $E_2F_2$ respectively.\n\\end{remark*}\n\n\\paragraph{Proof of (ii) by complex numbers.}\nWe will give using complex numbers on $\\triangle ABC$\na proof that $|E_1P| = |E_2Q|$.\n\nWe place $APBCQ$ on the unit circle.\nSince $\\ol{PQ} \\parallel \\ol{BC}$, we have $pq = bc$.\nAlso, the midpoint of $\\ol{AB}$ lies on $\\ol{PQ}$, so\n\\begin{align*}\n  p+q\n  &= \\frac{a+b}{2} + \\ol{\\left( \\frac{a+b}{2} \\right)} \\cdot pq \\\\\n  &= \\frac{a+b}{2} + \\frac{a+b}{2ab} \\cdot bc \\\\\n  &= \\frac{a(a+b)}{2a} + \\frac{c(a+b)}{2a} \\\\\n  &= \\frac{(a+b)(a+c)}{2a}.\n\\end{align*}\nNow,\n\\begin{align*}\n  p-e_1 &= p - \\frac{pp(a+c)-ac(p+p)}{pp-ac} \\\\\n  &= \\frac{p(p^2-p(a+c)+ac)}{pp-ac} = \\frac{(p-a)(p-c)}{p^2-ac}. \\\\\n  |PE_1|^2 &= (p-e_1) \\cdot \\ol{p-e_1} =\n  \\frac{(p-a)(p-c)}{p^2-ac} \\cdot\n  \\frac{(\\frac1p-\\frac1a)(\\frac1p-\\frac1c)}{\\frac{1}{p^2}-\\frac{1}{ac}} \\\\\n  &= -\\frac{(p-a)^2(p-c)^2}{(p^2-ac)^2}. \\\\\n  \\intertext{Similarly,}\n  |QE_2|^2 &= -\\frac{(q-a)^2(q-c)^2}{(q^2-ac)^2}.\n\\end{align*}\nBut actually, we claim that\n\\[ \\frac{(p-a)(p-c)}{p^2-ac} = \\frac{(q-a)(q-c)}{q^2-ac}. \\]\nOne calculates\n\\[ (p-a)(p-c)(q^2-ac)\n  = p^2q^2 - pq^2a - pq^2c + q^2ac\n  - p^2ac + pa^2c + pac^2 - (ac)^2 \\]\nThus $(p-a)(p-c)(q^2-ac) - (q-a)(q-c)(p^2-ac)$\nis equal to\n\\begin{align*}\n  -(a+c)(pq) &(q-p) + (q^2-p^2)ac - (p^2-q^2)ac + ac(a+c)(p-q) \\\\\n  &= (p-q)\n  \\left[ (a+c)pq - 2(p+q)ac + ac(a+c) \\right] \\\\\n  &= (p-q)\n  \\left[ (a+c)bc - 2 \\cdot \\frac{(a+b)(a+c)}{2a} \\cdot ac + ac(a+c) \\right] \\\\\n  &= (p-q)(a+c) \\left[ bc - c(a+b) + ac \\right] = 0.\n\\end{align*}\nThis proves $|E_1P| = |E_2Q|$.\nTogether with the similar $|F_1P| = |F_2Q|$, we have proved (ii).\n\n\\paragraph{Authorship comments.}\nAnkan provides an extensive\ndialogue at \\url{https://aops.com/community/c6h1664170p10571644}\nof how he came up with this problem,\nwhich at first was intended just to be an AMC-level question\nabout an equilateral triangle.\nHere, we provide just the change-log of the versions of this problem.\n\\begin{enumerate}\n  \\ii[0.] (\\emph{Original version}) Let $ABC$ be an equilateral triangle with side 2 inscribed in circle $\\omega$, and let $P$ be a point on small arc $AB$ of its circumcircle. The tangent line to $\\omega$ at $P$ intersects lines $AC$ and $AB$ at $E$ and $F$. If $PE = PF$, find $EF$.\n  (Answer: $4$.)\n  \\ii (\\emph{Generalize to isosceles triangle}) Let $ABC$ be an isosceles triangle with $AB = AC$, and let $M$ be the midpoint of $\\ol{BC}$. Let $P$ be a point on the circumcircle with $PA = PM$. The tangent to the circumcircle at $P$ intersects lines $AC$ and $AB$ at $E$ and $F$, respectively. Show that $PE = PF$.\n  \\ii (\\emph{Block coordinate bashes}) Let $ABC$ be an isosceles triangle with $AB = AC$ and circumcircle $\\omega$, and let $M$ be the midpoint of $\\ol{BC}$. Let $P$ be a point on $\\omega$ with $PA = PM$. The tangent to $\\omega$ at $P$ intersects lines $AC$ and $AB$ at $E$ and $F$, respectively. Show that the circumcircle of $\\triangle AEF$ passes through the center of $\\omega$.\n  \\ii (\\emph{Delete isosceles condition}) Let $ABC$ be a triangle with circumcircle $\\omega$, and let $H$ be the foot of the altitude from $A$ to $\\ol{BC}$. Let $P$ be a point on $\\omega$ with $PA = PH$. The tangent to $\\omega$ at $P$ intersects lines $AC$ and $AB$ at $E$ and $F$, respectively. Show that the circumcircle of $\\triangle AEF$ passes through the center of $\\omega$.\n  \\ii (\\emph{Add in both tangents}) Let $ABC$ be an acute triangle with circumcircle $\\omega$, and let $H$ be the foot of the altitude from $A$ to $\\ol{BC}$. Let $P$ and $Q$ be the points on $\\omega$ with $PA = PH$ and $QA = QH$. The tangent to $\\omega$ at $P$ intersects lines $AC$ and $AB$ at $E_1$ and $F_1$ respectively; the tangent to $\\omega$ at $Q$ intersects lines $AC$ and $AB$ at $E_2$ and $F_2$ respectively. Show that $E_1F_1 = E_2F_2$.\n  \\ii (\\emph{Merge v3 and v4}) Let $ABC$ be an acute triangle with circumcircle $\\omega$, and let $H$ be the foot of the altitude from $A$ to $\\ol{BC}$. Let $P$ and $Q$ be the points on $\\omega$ with $PA = PH$ and $QA = QH$. The tangent to $\\omega$ at $P$ intersects lines $AC$ and $AB$ at $E_1$ and $F_1$ respectively; the tangent to $\\omega$ at $Q$ intersects lines $AC$ and $AB$ at $E_2$ and $F_2$ respectively. Show that the circumcircles of $\\triangle AE_1F_1$ and $\\triangle AE_2F_2$ are congruent, and the line through their centers is parallel to the tangent to $\\omega$ at $A$.\n\\end{enumerate}\nThe problem bears Evan's name only because he suggested the changes v2 and v5.\n\\pagebreak", "category": "Geometry", "source": "TSTST", "year": 2018}
{"id": "tstst-2018-q6", "question": "Let $S = \\left\\{ 1, \\dots, 100 \\right\\}$,\nand for every positive integer $n$ define\n\\[\n  T_n = \\left\\{ (a_1, \\dots, a_n) \\in S^n\n    \\mid a_1 + \\dots + a_n \\equiv 0 \\pmod{100} \\right\\}.\n\\]\nDetermine which $n$ have the following property:\nif we color any $75$ elements of $S$ red,\nthen at least half of the $n$-tuples in $T_n$\nhave an even number of coordinates with red elements.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10570994}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $S = \\left\\{ 1, \\dots, 100 \\right\\}$,\nand for every positive integer $n$ define\n\\[\n  T_n = \\left\\{ (a_1, \\dots, a_n) \\in S^n\n    \\mid a_1 + \\dots + a_n \\equiv 0 \\pmod{100} \\right\\}.\n\\]\nDetermine which $n$ have the following property:\nif we color any $75$ elements of $S$ red,\nthen at least half of the $n$-tuples in $T_n$\nhave an even number of coordinates with red elements.\n\\end{mdframed}\nWe claim this holds exactly for $n$ even.\n\n\\paragraph{First solution by generating functions.}\nDefine\n\\[\n  R(x) = \\sum_{s \\text{ red}} x^s, \\qquad\n  B(x) = \\sum_{s \\text{ blue}} x^s.\n\\]\n(Here ``blue'' means ``not-red'', as always.)\nThen, the number of tuples in $T_n$ with exactly\n$k$ red coordinates is exactly equal to\n\\[ \\binom nk \\cdot \\frac 1{100} \\sum_{\\omega} R(\\omega)^k B(\\omega)^{n-k} \\]\nwhere the sum is over all $100$th roots of unity.\nSo, we conclude the number of tuples in $T_n$\nwith an even (resp odd) number of red elements is exactly\n\\begin{align*}\n  X &= \\frac1{100} \\sum_{\\omega} \\sum_{k \\text{ even}}\n    \\binom nk R(\\omega)^k B(\\omega)^{n-k} \\\\\n  Y &= \\frac1{100} \\sum_{\\omega} \\sum_{k \\text{ odd}}\n    \\binom nk R(\\omega)^k B(\\omega)^{n-k} \\\\\n  \\implies X-Y &= \\frac 1{100} \\sum_{\\omega}\n    \\left( B(\\omega)-R(\\omega) \\right)^n \\\\\n  &= \\frac 1{100} \\left[\n     \\left( B(1)-R(1) \\right)^n\n     + \\sum_{\\omega \\neq 1} (2B(\\omega))^n \\right] \\\\\n  &= \\frac 1{100} \\left[ \\left( B(1)-R(1) \\right)^n - (2B(1))^n\n    + 2^n \\sum_{\\omega} B(\\omega)^n \\right] \\\\\n  &= \\frac 1{100} \\left[ \\left( B(1)-R(1) \\right)^n - (2B(1))^n \\right]\n    + 2^n Z \\\\\n  &= \\frac 1{100} \\left[ \\left( -50 \\right)^n - 50^n \\right] + 2^n Z.\n\\end{align*}\nwhere\n\\[ Z \\coloneq \\frac 1{100} \\sum_{\\omega} B(\\omega)^n \\ge 0 \\]\ncounts the number of tuples in $T_n$ which are all blue.\nHere we have used the fact that $B(\\omega)+R(\\omega)=0$\nfor $\\omega \\neq 1$.\n\nWe wish to show $X-Y \\ge 0$ holds for $n$ even,\nbut may fail when $n$ is odd.\nThis follows from two remarks:\n\\begin{itemize}\n  \\item If $n$ is even, then $X-Y = 2^n Z \\ge 0$.\n  \\item If $n$ is odd,\n  then if we choose the coloring for which\n  $s$ is red if and only if $s \\not\\equiv 2 \\pmod 4$;\n  we thus get $Z = 0$.\n  Then $X-Y = -\\frac 2{100} \\cdot 50^n < 0$.\n\\end{itemize}\n\n\\paragraph{Second solution by strengthened induction and random coloring.}\nWe again prove that $n$ even work.\nLet us define\n\\[\n  T_n(a) = \\left\\{ (a_1, \\dots, a_n) \\in S^n\n    \\mid a_1 + \\dots + a_n \\equiv a \\pmod{100} \\right\\}.\n\\]\nAlso, call an $n$-tuple good if it has an even number of red elements.\nWe claim that $T_n(a)$ also has at least 50\\% good tuples, by induction.\n\nThis follows by induction on $n \\ge 2$.\nIndeed, the base case $n = 2$ can be checked by hand,\nsince $T_2(a) = \\{ (x, a-x) \\mid x \\in S \\}$.\nWith the stronger claim, one can check the case $n=2$ manually\nand proceed by induction to go from $n-2$ to $n$, noting that\n\\[ T_{n}(a) =\n  \\bigsqcup_{b+c=a} T_{n-2}(b) \\oplus T_2(c) \\]\nwhere $\\oplus$ denotes concatenation of tuples, applied set-wise.\nThe concatenation of an $(n-2)$-tuple and $2$-tuple is good\nif and only if both or neither are good.\nThus for each $b$ and $c$,\nif the proportion of $T_{n-2}(b)$ which is good is $p \\ge \\half$\nand the proportion of $T_2(c)$ which is good is $q \\ge \\half$,\nthen the proportion of $T_{n-2}(b) \\oplus T_2(c)$ which is good\nis $pq + (1-p)(1-q) \\ge \\half$, as desired.\nSince each term in the union has at least half the tuples good,\nall of $T_n(a)$ has at least half the tuples good, as desired.\n\nIt remains to fail all odd $n$.\nWe proceed by a suggestion of Yang Liu and Ankan Bhattacharya\nby showing that if we pick the $75$ elements \\emph{randomly},\nthen any particular tuple in $S^n$ has strictly less than 50\\% chance of being good.\nThis will imply (by linearity of expectation)\nthat $T_n$ (or indeed any subset of $S^n$) will, for some coloring,\nhave less than half good tuples.\n\nLet $(a_1, \\dots, a_n)$ be such an $n$-tuple.\nIf any element appears in the tuple more than once,\nkeep \\emph{discarding pairs} of that element until there are zero or one;\nthis has no effect on the good-ness of the tuple.\nIf we do this, we obtain an $m$-tuple $(b_1, \\dots, b_m)$\nwith no duplicated elements where $m \\equiv n \\equiv 1 \\pmod 2$.\nNow, the probability that any element is red is $\\frac34$,\nso the probability of being good is\n\\begin{align*}\n  \\sum_{k \\text{ even}}^m \\binom{m}{k} \\left( \\frac 34 \\right)^k\n  \\left( -\\frac 14 \\right)^{m-k}\n  &= \\half\\left[ \\left( \\frac34 + \\frac 14 \\right)^m\n    - \\left( \\frac 34 - \\frac 14 \\right)^m \\right] \\\\\n  &= \\half \\left[ 1 - \\left( \\frac12 \\right)^m \\right] < \\half.\n\\end{align*}\n\n\\begin{remark*}\n  [Adam Hesterberg]\n  Here is yet another proof that $n$ even works.\n  Group elements of $T_n$ into equivalence classes\n  according to the $n/2$ sums of pairs of consecutive elements\n  (first and second, third and fourth, \\dots).\n  For each such pair sum, there are at least as many monochrome pairs\n  with that sum as nonmonochrome ones, since every nonmonochrome pair uses one of the 25 non-reds.\n  The monochromaticity of the pairs is independent.\n\n  If $p_i \\le \\frac12$ is the probability that the $i$th pair is nonmonochrome,\n  then the probability that $k$ pairs are nonmonochrome\n  is the coefficient of $x^k$ in $f(x) = \\prod_i(xp_i+(1-p_i))$.\n  Then the probability that evenly many pairs are nonmonochrome\n  (and hence that evenly many coordinates are red)\n  is the sum of the coefficients of even powers of $x$ in $f$,\n  which is $(f(1) + f(-1))/2 = (1 + \\prod_i(1-2p_i))/2 \\ge \\frac12$,\n  as desired.\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 3}", "category": "Combinatorics", "source": "TSTST", "year": 2018}
{"id": "tstst-2018-q7", "question": "Let $n$ be a positive integer.\nA frog starts on the number line at $0$.\nSuppose it makes a finite sequence of hops, subject to two conditions:\n\\begin{itemize}\n  \\ii The frog visits only points in $\\{1, 2, \\dots, 2^n-1\\}$,\n  each at most once.\n  \\ii The length of each hop is in $\\{2^0, 2^1, 2^2, \\dots\\}$.\n  (The hops may be either direction, left or right.)\n\\end{itemize}\nLet $S$ be the sum of the (positive) lengths of all hops in the sequence.\nWhat is the maximum possible value of $S$?", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10570996}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n$ be a positive integer.\nA frog starts on the number line at $0$.\nSuppose it makes a finite sequence of hops, subject to two conditions:\n\\begin{itemize}\n  \\ii The frog visits only points in $\\{1, 2, \\dots, 2^n-1\\}$,\n  each at most once.\n  \\ii The length of each hop is in $\\{2^0, 2^1, 2^2, \\dots\\}$.\n  (The hops may be either direction, left or right.)\n\\end{itemize}\nLet $S$ be the sum of the (positive) lengths of all hops in the sequence.\nWhat is the maximum possible value of $S$?\n\\end{mdframed}\nWe claim the answer is $\\frac{4^n - 1}{3}$.\n\nWe first prove the bound.\nFirst notice that the hop sizes\nare in $\\{2^0, 2^1, \\dots, 2^{n - 1}\\}$,\nsince the frog must stay within bounds the whole time.\nLet $a_i$ be the number of hops of size $2^i$ the frog makes, for $0\\le i\\le n - 1$.\n\\begin{claim*}\n  For any $k = 1, \\dots, n$ we have\n  \\[ a_{n-1} + \\dots + a_{n-k} \\le 2^n - 2^{n-k}. \\]\n\\end{claim*}\n\\begin{proof}\n  Let $m = n-k$ and look modulo $2^m$.\n  Call a jump \\emph{small} if its length is at most $2^{m-1}$,\n  and \\emph{large} if it is at least $2^m$;\n  the former changes the residue class of the frog modulo $2^m$\n  while the latter does not.\n\n  Within each fixed residue modulo $2^m$,\n  the frog can make at most $\\frac{2^n}{2^m} - 1$ large jumps.\n  So the total number of large jumps is at most\n  $2^m \\left( \\frac{2^n}{2^m} - 1 \\right) = 2^n - 2^m$.\n\\end{proof}\n(As an example, when $n = 3$ this means there are at most\nfour hops of length $4$,\nat most six hops of length $2$ or $4$,\nand at most seven hops total.\nOf course, if we want to max the length of the hops,\nwe see that we want $a_2 = 4$, $a_1 = 2$, $a_0 = 1$,\nand in general equality is achieved when $a_m = 2^m$ for any $m$.)\n\nNow, the total distance the frog travels is\n\\[ S = a_0 + 2a_1 + 4a_2 + \\dots + 2^{n-1} a_{n-1}. \\]\nWe rewrite using the so-called ``summation by parts'':\n\\begin{alignat*}{7}\n  S &{}={}& a_0 &{}+{}& a_1 &{}+{}& a_2 &{}+{}& a_3 &{}+{}& \\dots &{}+{}& a_{n-1} \\\\\n  &{}+{}& && a_1 &{}+{}& a_2 &{}+{}& a_3 &{}+{}& \\dots &{}+{}& a_{n-1} \\\\\n  &{}+{}& && && 2a_2 &{}+{}& 2a_3 &{}+{}& \\dots &{}+{}& 2a_{n-1} \\\\\n  &{}+{}& && && && 4a_3 &{}+{}& \\dots &{}+{}& 4a_{n-1} \\\\\n  &\\vdotswithin+& && && && && \\ddots && \\vdotswithin{a_{n-1}} \\\\\n  &{}+{}& && && && && && 2^{n-2}a_{n-1}. \\\\\n\\end{alignat*}\nHence\n\\begin{align*}\n  S &\\le (2^n-2^0) + (2^n-2^1) + 2(2^n-2^2) + \\dots + 2^{n-2}(2^n-2^{n-1}) \\\\\n  &= \\frac{4^n-1}{3}.\n\\end{align*}\n\nIt remains to show that equality can hold.\nThere are many such constructions but most are inductive.\nHere is one approach.\nWe will construct two family of paths such that\nthere are $2^k$ hops of size $2^k$, for every $0\\le k\\le n - 1$,\nand we visit each of $\\{0, \\dots, 2^n - 1\\}$ once,\nstarting on $0$ and ending on $x$,\nfor the two values $x\\in\\{1, 2^n - 1\\}$.\n\nThe base case $n = 1$ is clear.\nTo take a path from $0$ to $2^{n+1}-1$.\n\\begin{itemize}\n  \\ii Take a path on $\\{0, 2, 4, \\dots, 2^{n+1} - 2\\}$\n  starting from $0$ and ending on $2$ (by inductive hypothesis).\n  \\ii Take a path on $\\{1, 3, 5, \\dots, 2^{n+1} - 1\\}$\n  starting from $1$ and ending on $2^{n+1}-1$ (by inductive hypothesis).\n  \\ii Link them together by adding a single jump $2 \\to 1$.\n\\end{itemize}\nThe other case is similar, but we route $0 \\to (2^{n+1}-2) \\to (2^{n+1}-1) \\to 1$ instead.\n(This can also be visualized as hopping along a hypercube of binary strings;\neach inductive step takes two copies of the hypercube\nand links them together by a single edge.)\n\n\\begin{remark*}\n  [Ashwin Sah]\n  The problem can also be altered to ask for the minimum value of the sum of the reciprocals of the hop sizes, where further we stipulate that the frog must hit every point precisely once (to avoid triviality). With a nearly identical proof that also exploits the added condition $a_0 + \\dotsb + a_{n - 1} = 2^n - 1$, the answer is $n$. This yields a nicer form for the generalization. The natural generalization changes the above problem by replacing $2^k$ with $a_k$ where $a_k \\mid a_{k + 1}$, so that the interval covered by hops is of size $a_n$ and the hop sizes are restricted to the $a_i$, where $a_0 = 1$. In this case, similar bounding yields\n\\[\\sum_{i = 1}^{2^n - 1}\\frac{1}{b_k}\\ge\\sum_{i = 0}^{n - 1}\\left(\\frac{a_{k + 1}}{a_k} - 1\\right).\\]\nBounds for the total distance traveled happen in the same way as the solution above, and equality for both can be constructed in an analogous fashion.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "TSTST", "year": 2018}
{"id": "tstst-2018-q8", "question": "For which positive integers $b > 2$ do there exist\ninfinitely many positive integers $n$ such that $n^2$ divides $b^n+1$?", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10570998}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFor which positive integers $b > 2$ do there exist\ninfinitely many positive integers $n$ such that $n^2$ divides $b^n+1$?\n\\end{mdframed}\nThis problem is sort of the union of IMO 1990/3 and IMO 2000/5.\n\nThe answer is any $b$ such that $b+1$ is not a power of $2$.\nIn the forwards direction, we first prove more carefully the\nfollowing claim.\n\n\\begin{claim*}\n  If $b+1$ is a power of $2$,\n  then the only $n$ which is valid is $n = 1$.\n\\end{claim*}\n\\begin{proof}\n  Assume $n > 1$ and let $p$ be the smallest prime dividing $n$.\n  We cannot have $p=2$, since then $4 \\mid b^n+1 \\equiv 2 \\pmod 4$.\n  Thus, \\[ b^{2n} \\equiv 1 \\pmod p \\]\n  so the order of $b \\pmod p$ divides $\\gcd(2n,p-1) = 2$.\n  Hence $p \\mid b^2-1 = (b-1)(b+1)$.\n\n  But since $b+1$ was a power of $2$,\n  this forces $p \\mid b-1$.\n  Then $0 \\equiv b^n + 1 \\equiv 2 \\pmod p$, contradiction.\n\\end{proof}\n\nOn the other hand, suppose that $b+1$ is not a power of $2$\n(and that $b > 2$).\nWe will inductively construct an infinite sequence\nof distinct primes $p_0$, $p_1$, \\dots,\nsuch that the following two properties hold for each $k \\ge 0$:\n\\begin{itemize}\n  \\ii $p_0^2 \\dots p_{k-1}^2 p_k \\mid b^{p_0 \\dots p_{k-1}} + 1$,\n  \\ii and hence $p_0^2 \\dots p_{k-1}^2 p_k^2 \\mid b^{p_0 \\dots p_{k-1} p_k} + 1$\n  by exponent lifting lemma.\n\\end{itemize}\nThis will solve the problem.\n\nInitially, let $p_0$ be any odd prime dividing $b+1$.\nFor the inductive step, we contend there exists an\n\\emph{odd} prime $q \\notin \\{p_0, \\dots, p_k\\}$\nsuch that $q \\mid b^{p_0 \\dots p_k} + 1$.\nIndeed, this follows immediately by Zsigmondy theorem\nsince $p_0 \\dots p_k$ divides $b^{p_0 \\dots p_{k-1}} + 1$.\nSince $(b^{p_0 \\dots p_k})^q \\equiv b^{p_0 \\dots p_k} \\pmod q$,\nit follows we can then take $p_{k+1} = q$.\nThis finishes the induction.\n\nTo avoid the use of Zsigmondy,\none can instead argue as follows:\nlet $p = p_k$ for brevity, and let $c = b^{p_0 \\dots p_{k-1}}$.\nThen $\\frac{c^p+1}{c+1} = c^{p-1} - c^{p-2} + \\dots + 1$\nhas GCD exactly $p$ with $c+1$.\nMoreover, this quotient is always odd.\nThus as long as $c^p + 1 > p \\cdot (c+1)$,\nthere will be some new prime dividing $c^p+1$ but not $c+1$.\nThis is true unless $p = 3$ and $c = 2$,\nbut we assumed $b > 2$ so this case does not appear.\n\n\\begin{remark*}\n  [On new primes]\n  In going from $n^2 \\mid b^{n}+1$ to $(nq)^2 \\mid b^{nq} + 1$,\n  one does not necessarily need to pick a $q$ such that\n  $q \\nmid n$, as long as $\\nu_q(n^2) < \\nu_q(b^n+1)$.\n  In other words it suffices to just\n  check that $\\frac{b^n+1}{n^2}$ is not a power of $2$ in this process.\n\n  However, this calculation is a little more involved with this approach.\n  One proceeds by noting that $n$ is odd,\n  hence $\\nu_2(b^n+1) = \\nu_2(b+1)$,\n  and thus $\\frac{b^n+1}{n^2} = 2^{\\nu_2(b+1)} \\le b+1$,\n  which is a little harder to bound than the analogous\n  $c^p+1 > p \\cdot (c+1)$ from the previous solution.\n\\end{remark*}\n\n\\paragraph{Authorship comments.}\nI came up with this problem by simply\nmixing together the main ideas of IMO 1990/3 and IMO 2000/5,\nlate one night after a class.\nOn the other hand, I do not consider it very original;\nit is an extremely ``routine'' number theory problem\nfor experienced contestants, using highly standard methods.\nThus it may not be that interesting,\nbut is a good discriminator of understanding of fundamentals.\n\nIMO 1990/3 shows that if $b=2$,\nthen the only $n$ which work are $n=1$ and $n=3$.\nThus $b = 2$ is a special case\nand for this reason the problem explicitly requires $b > 2$.\n\nAn alternate formulation of the problem is worth mentioning.\nOriginally, the problem statement asked whether there existed\n$n$ with at least $3$ (or $2018$, etc.) prime divisors,\nthus preventing the approach in which one takes\na prime $q$ dividing $\\frac{b^n+1}{n^2}$.\nAnkan Bhattacharya suggested changing it to ``infinitely many $n$'',\nwhich is more natural.\n\nThese formulations are actually not so different though.\nExplicitly, suppose $k^2 \\mid b^{k}+1$ and $p \\mid b^k+1$.\nConsider any $k \\mid n$ with $n^2 \\mid b^n+1$,\nand let $p$ be an odd prime dividing $b^k+1$.\nThen $2\\nu_p(n) \\le \\nu_p(b^n+1) = \\nu_p(n/k) + \\nu_p(b^k+1)$\nand thus\n\\[ \\nu_p(n/k) \\le \\nu_p\\left( \\frac{b^k+1}{k^2} \\right). \\]\nEffectively, this means we can only add each prime a certain number of times.\n\\pagebreak", "category": "Number Theory", "source": "TSTST", "year": 2018}
{"id": "tstst-2018-q9", "question": "Show that there is an absolute constant $c < 1$\nwith the following property:\nwhenever $\\mathcal P$ is a polygon with area $1$ in the plane,\none can translate it by a distance of $\\frac{1}{100}$ in some direction\nto obtain a polygon $\\mathcal Q$, for which\nthe intersection of the interiors of $\\mathcal P$ and $\\mathcal Q$\nhas total area at most $c$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p10571003}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nShow that there is an absolute constant $c < 1$\nwith the following property:\nwhenever $\\mathcal P$ is a polygon with area $1$ in the plane,\none can translate it by a distance of $\\frac{1}{100}$ in some direction\nto obtain a polygon $\\mathcal Q$, for which\nthe intersection of the interiors of $\\mathcal P$ and $\\mathcal Q$\nhas total area at most $c$.\n\\end{mdframed}\nThe following solution is due to Brian Lawrence.\nWe will prove the result with the generality\nof any measurable set $\\mathcal{P}$ (rather than a polygon).\nFor a vector $v$ in the plane,\nwrite $\\mathcal{P} + v$ for the translate of $\\mathcal{P}$ by $v$.\n\nSuppose $\\mathcal{P}$ is a polygon of area $1$,\nand $\\eps > 0$ is a constant,\nsuch that for any translate $\\mathcal{Q} = \\mathcal{P} + v$,\nwhere $v$ has length exactly $\\frac{1}{100}$,\nthe intersection of $\\mathcal{P}$ and $\\mathcal{Q}$ has area at least $1 - \\eps$.\nThe problem asks us to prove a lower bound on $\\eps$.\n\n\\begin{lemma*}\n  Fix a sequence of $n$ vectors\n  $v_1$, $v_2$, \\dots, $v_n$, each of length $\\frac{1}{100}$.\n  A grasshopper starts at a random point $x$ of $\\mathcal{P}$,\n  and makes $n$ jumps to $x + v_1 + \\dots + v_n$.\n  Then it remains in $\\mathcal{P}$ with probability at least $1 - n\\eps$.\n\\end{lemma*}\n\n\\begin{proof}\n  In order for the grasshopper to leave $\\mathcal{P}$ at step $i$,\n  the grasshopper's position before step $i$\n  must be inside the difference set $\\mathcal{P} \\backslash (\\mathcal{P} - v_i)$.\n  Since this difference set has area at most $\\eps$,\n  the probability the grasshopper leaves $\\mathcal{P}$\n  at step $i$ is at most $\\eps$.\n  Summing over the $n$ steps,\n  the probability that the grasshopper\n  ever manages to leave $\\mathcal{P}$ is at most $n \\eps$.\n\\end{proof}\n\n\\begin{corollary*}\n  Fix a vector $w$ of length at most $8$.\n  A grasshopper starts at a random point $x$ of $\\mathcal{P}$,\n  and jumps to $x + w$.\n  Then it remains in $\\mathcal{P}$ with probability at least $1 - 800 \\eps$.\n\\end{corollary*}\n\\begin{proof}\n  Apply the previous lemma with $800$ jumps.\n  Any vector $w$ of length at most $8$\n  can be written as $w = v_1 + v_2 + \\dotsb + v_{800}$,\n  where each $v_i$ has length exactly $\\frac{1}{100}$.\n\\end{proof}\n\nNow consider the process where we select a random\nstarting point $x \\in \\mathcal P$ for our grasshopper,\n\\emph{and} a random vector $w$ of length at most $8$\n(sampled uniformly from the closed disk of radius $8$).\nLet $q$ denote the probability of staying inside $\\mathcal P$\nwe will bound $q$ from above and below.\n\n\\begin{itemize}\n\\ii On the one hand, suppose we pick $w$ first.\nBy the previous corollary, $q \\ge 1 - 800\\eps$\n(irrespective of the chosen $w$).\n\n\\ii On the other hand, suppose we pick $x$ first.\nThen the possible landing points $x + w$ are uniformly\ndistributed over a closed disk of radius $8$,\nwhich has area $64\\pi$.\nThe probability of landing in $\\mathcal P$\nis certainly at most $\\frac{[\\mathcal P]}{64\\pi}$.\n\\end{itemize}\n\nConsequently, we deduce\n\\[ 1 - 800\\eps \\le q \\le \\frac{[\\mathcal P]}{64\\pi}\n  \\implies \\eps > \\frac{1 - \\frac{[\\mathcal P]}{64\\pi}}{800}\n  > 0.001\n\\]\nas desired.\n\n\\begin{remark*}\n  The choice of $800$ jumps is only for concreteness;\n  any constant $n$ for which $\\pi(n/100)^2 > 1$ works.\n  I think $n = 98$ gives the best bound following this approach.\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Geometry", "source": "TSTST", "year": 2018}
{"id": "putnam-1998-a1", "question": "A right circular cone has base of radius 1 and height 3.  A\ncube is inscribed in the cone so that one face of the cube is\ncontained in the base of the cone.  What is the side-length of\nthe cube?", "solution": "Consider the plane containing both the axis of the cone and two opposite\nvertices of the cube's bottom face.  The cross section of the cone and\nthe cube in this plane consists of a rectangle of sides $s$ and\n$s\\sqrt{2}$ inscribed in an isosceles triangle of base $2$ and height\n$3$, where $s$ is the side-length of the cube.  (The $s\\sqrt{2}$ side\nof the rectangle lies on the base of the triangle.)  Similar triangles\nyield $s/3 = (1-s\\sqrt{2}/2)/1$, or $s = (9\\sqrt{2} - 6)/7.$", "category": "Geometry", "source": "PUTNAM", "year": 1998}
{"id": "putnam-1998-a2", "question": "Let $s$ be any arc of the unit circle lying entirely in the first\nquadrant.  Let $A$ be the area of the region lying below $s$ and\nabove the $x$-axis and let $B$ be the area of the region lying to the\nright of the $y$-axis and to the left of $s$.  Prove that $A+B$ depends\nonly on the arc length, and not on the position, of $s$.", "solution": "First solution:\nto fix notation, let $A$ be the area\nof region $DEFG$, and $B$ be the area of $DEIH$; further\nlet $C$ denote the area of sector $ODE$, which only depends on the\narc length of $s$.  If $[XYZ]$ denotes the area of triangle\n$[XYZ]$, then we have\n$A = C + [OEG] - [ODF]$ and $B = C + [ODH] - [OEI]$.  But\nclearly $[OEG] = [OEI]$ and $[ODF] = [ODH]$, and so\n$A + B = 2C$.\n\n\\begin{center}\n\\begin{tikzpicture}\n\\draw (0,0) circle (2);\n\\draw (0,2) -- (0,0) -- (2,0);\n\\draw (1.732,0) -- (1.732,1) -- (0,1);\n\\draw (.7,0) -- (.7,1.873) -- (0,1.873);\n\\draw (1.732,1) -- (0,0) -- (.7,1.873);\n\\draw (0,0) node[anchor=north east] {$O$};\n\\draw (.7,0) node[anchor=north] {$F$};\n\\draw (1.732,0) node[anchor=north] {$G$};\n\\draw (1.732,1) node[anchor=south west] {$E$};\n\\draw (.7,1.873) node[anchor=south west] {$D$};\n\\draw (0,1) node[anchor=east] {$I$};\n\\draw (0,1.7) node[anchor=east] {$H$};\n\\end{tikzpicture}\n\\end{center}\n\nSecond solution: We may parametrize a point in $s$ by any of\n$x$, $y$, or $\\theta = \\tan^{-1} (y/x)$.  Then $A$ and $B$ are\njust the integrals of $y\\,dx$ and $x\\,dy$ over the appropriate\nintervals; thus $A+B$ is the integral of $x\\,dy - y\\,dx$\n(minus because the limits of integration are reversed).\nBut $d\\theta = x\\,dy - y\\,dx$, and so $A+B = \\Delta \\theta$\nis precisely the radian measure of $s$. (Of course, one can perfectly well\ndo this problem by computing the two integrals\nseparately. But what's the fun in that?)", "category": "Geometry", "source": "PUTNAM", "year": 1998}
{"id": "putnam-1998-a3", "question": "Let $f$ be a real function on the real line with continuous third\nderivative.  Prove that there exists a point $a$ such that\n\\[f(a)\\cdot f'(a) \\cdot f''(a) \\cdot f'''(a)\\geq 0 .\\]", "solution": "If at least one of $f(a)$, $f'(a)$, $f''(a)$, or $f'''(a)$ vanishes\nat some point $a$, then we are done.  Hence we may assume each of\n$f(x)$, $f'(x)$, $f''(x)$, and $f'''(x)$ is either strictly positive\nor strictly negative on the real line.  By replacing $f(x)$ by $-f(x)$\nif necessary, we may assume $f''(x)>0$; by replacing $f(x)$\nby $f(-x)$ if necessary, we may assume $f'''(x)>0$.  (Notice that these\nsubstitutions do not change the sign of $f(x) f'(x) f''(x) f'''(x)$.)\nNow $f''(x)>0$ implies that $f'(x)$ is increasing, and $f'''(x)>0$\nimplies that $f'(x)$ is convex, so that $f'(x+a)>f'(x)+a f''(x)$\nfor all $x$ and $a$.  By\nletting $a$ increase in the latter inequality, we see that $f'(x+a)$\nmust be positive for sufficiently large $a$; it follows that\n$f'(x)>0$\nfor all $x$.  Similarly, $f'(x)>0$ and $f''(x)>0$ imply\nthat $f(x)>0$ for all $x$.  Therefore $f(x) f'(x) f''(x) f'''(x)>0$ for\nall $x$, and we are done.", "category": "Algebra", "source": "PUTNAM", "year": 1998}
{"id": "putnam-1998-a4", "question": "Let $A_1=0$ and $A_2=1$.  For $n>2$, the number $A_n$ is defined by\nconcatenating the decimal expansions of $A_{n-1}$ and $A_{n-2}$ from\nleft to right.  For example $A_3=A_2 A_1=10$, $A_4=A_3 A_2 = 101$,\n$A_5=A_4 A_3 = 10110$, and so forth.  Determine all $n$ such that\n$11$ divides $A_n$.", "solution": "The number of digits in the decimal expansion of $A_n$ is the\nFibonacci number $F_n$, where $F_1=1$, $F_2=1$, and $F_n=F_{n-1}\n+F_{n-2}$ for $n>2$.  It follows that the sequence $\\{A_n\\}$, modulo 11,\nsatisfies the recursion $A_n=(-1)^{F_{n-2}}A_{n-1} + A_{n-2}$.\n(Notice that the recursion for $A_n$ depends only on the value of\n$F_{n-2}$ modulo 2.)  Using these recursions, we find that\n$A_7 \\equiv 0$ and $A_8 \\equiv 1$ modulo 11, and that\n$F_7 \\equiv 1$ and $F_8 \\equiv 1$ modulo 2.\nIt follows that $A_n \\equiv A_{n+6}$ (mod 11) for all $n\\geq 1$.\nWe find that among\n$A_1,A_2,A_3,A_4,A_5$, and $A_6$, only $A_1$ vanishes modulo 11.\nThus 11 divides $A_n$ if and only if $n=6k+1$ for some\nnonnegative integer $k$.", "category": "Number Theory", "source": "PUTNAM", "year": 1998}
{"id": "putnam-1998-a5", "question": "Let $\\mathcal F$ be a finite collection of open discs in $\\mathbb R^2$\nwhose union contains a set $E\\subseteq \\mathbb R^2$.  Show that there\nis a pairwise disjoint subcollection $D_1,\\ldots, D_n$ in $\\mathcal F$\nsuch that\n\\[E\\subseteq \\cup_{j=1}^n 3D_j.\\]\nHere, if $D$ is the disc of radius $r$ and center $P$, then $3D$ is the\ndisc of radius $3r$ and center $P$.", "solution": "Define the sequence $D_i$ by the following greedy algorithm:\nlet $D_1$ be the disc of largest radius (breaking ties arbitrarily),\nlet $D_2$ be the disc of largest radius not meeting $D_1$, let\n$D_3$ be the disc of largest radius not meeting $D_1$ or $D_2$,\nand so on, up to some final disc $D_n$.\nTo see that $E \\subseteq \\cup_{j=1}^n 3D_j$, consider\na point in $E$; if it lies in one of the $D_i$, we are done. Otherwise,\nit lies in a disc $D$ of radius $r$, which meets one of the $D_i$ having\nradius $s \\geq r$ (this is the only reason a disc can be skipped in\nour algorithm). Thus\nthe centers lie at a distance $t < s+r$, and so every point at distance\nless than $r$ from the center of $D$ lies at distance at most\n$r + t < 3s$ from the center of the corresponding $D_i$.", "category": "Geometry", "source": "PUTNAM", "year": 1998}
{"id": "putnam-1998-a6", "question": "Let $A, B, C$ denote distinct points with integer coordinates in $\\mathbb\nR^2$.  Prove that if\n\\[(|AB|+|BC|)^2<8\\cdot [ABC]+1\\]\nthen $A, B, C$ are three vertices of a square.  Here $|XY|$ is the length\nof segment $XY$ and $[ABC]$ is the area of triangle $ABC$.", "solution": "Recall the inequalities $|AB|^2 + |BC|^2 \\geq 2|AB||BC|$ (AM-GM)\nand $|AB||BC| \\geq 2[ABC]$ (Law of Sines). Also recall that the area of\na triangle with integer coordinates is half an integer\n(if its vertices lie at $(0,0), (p,q), (r,s)$, the area is\n$|ps-qr|/2$), and that if $A$ and $B$ have integer coordinates, then\n$|AB|^2$\nis an integer (Pythagoras). Now observe that\n\\begin{align*}\n8[ABC] &\\leq |AB|^2+|BC|^2 + 4[ABC] \\\\\n&\\leq |AB|^2 + |BC|^2 + 2|AB| |BC| \\\\\n&< 8[ABC]+1,\n\\end{align*}\nand that the first and second expressions are both integers.\nWe conclude that\n$8[ABC] = |AB|^2+ |BC|^2+4[ABC]$, and so $|AB|^2+|BC|^2 =\n2|AB| |BC|\n= 4[ABC]$; that is, $B$ is a right angle and $AB=BC$, as desired.", "category": "Geometry", "source": "PUTNAM", "year": 1998}
{"id": "putnam-1998-b1", "question": "Find the minimum value of\n\\[\\frac{(x+1/x)^6-(x^6+1/x^6)-2}{(x+1/x)^3+(x^3+1/x^3)}\\]\nfor $x>0$.", "solution": "Notice that\n\\begin{gather*}\n\\frac{(x+1/x)^6-(x^6+1/x^6)-2}{(x+1/x)^3+(x^3+1/x^3)} = \\\\\n(x+1/x)^3-(x^3+1/x^3)=3(x+1/x)\n\\end{gather*}\n(difference of squares).  The latter is easily seen\n(e.g., by AM-GM) to have minimum value 6\n(achieved at $x=1$).", "category": "Algebra", "source": "PUTNAM", "year": 1998}
{"id": "putnam-1998-b2", "question": "Given a point $(a,b)$ with $0<b<a$, determine the minimum perimeter of a\ntriangle with one vertex at $(a,b)$, one on the $x$-axis, and one on the\nline $y=x$.  You may assume that a triangle of minimum perimeter exists.", "solution": "Consider a triangle as described by the problem; label its\nvertices $A,B,C$ so that $A = (a,b)$, $B$ lies on the $x$-axis,\nand $C$ lies on the line $y=x$.  Further let $D = (a,-b)$ be the\nreflection of $A$ in the $x$-axis, and let $E = (b,a)$ be\nthe reflection of $A$ in the line $y=x$.  Then $AB=DB$\nand $AC=CE$, and so the perimeter of $ABC$ is\n$DB+BC+CE \\geq DE = \\sqrt{(a-b)^2 + (a+b)^2}\n= \\sqrt{2a^2+2b^2}$.  It is clear that this lower bound can\nbe achieved; just set $B$ (resp. $C$) to be the\nintersection between the segment $DE$ and the $x$-axis (resp.\nline $x=y$); thus the minimum perimeter is in fact\n$\\sqrt{2a^2+2b^2}$.", "category": "Geometry", "source": "PUTNAM", "year": 1998}
{"id": "putnam-1998-b3", "question": "let $H$ be the unit hemisphere $\\{(x,y,z):x^2+y^2+z^2=1,z\\geq 0\\}$, $C$\nthe unit circle $\\{(x,y,0):x^2+y^2=1\\}$, and $P$ the regular pentagon\ninscribed in $C$.  Determine the surface area of that portion of $H$ lying\nover the planar region inside $P$, and write your answer in the form\n$A \\sin\\alpha + B \\cos\\beta$, where $A,B,\\alpha,\\beta$ are real numbers.", "solution": "We use the well-known result that the surface area of the\n``sphere cap'' $\\{(x,y,z)\\,|\\,x^2+y^2+z^2=1,\\,z\\geq z_0\\}$ is\nsimply $2\\pi(1-z_0)$.  (This result is easily verified using\ncalculus; we omit the derivation here.)  Now the desired surface\narea is just $2\\pi$ minus the surface areas of five identical\nhalves of sphere caps; these caps, up to isometry, correspond\nto $z_0$ being the distance from the center of the pentagon\nto any of its sides, i.e., $z_0 = \\cos \\frac{\\pi}{5}$.  Thus\nthe desired area is\n$2\\pi - \\frac{5}{2} \\left(2\\pi (1-\\cos\\frac{\\pi}{5})\\right)\n= 5\\pi\\cos\\frac{\\pi}{5} - 3\\pi$ (i.e., $B=\\pi/2$).", "category": "Geometry", "source": "PUTNAM", "year": 1998}
{"id": "putnam-1998-b4", "question": "Find necessary and sufficient conditions on positive integers $m$ and $n$\nso that\n\\[\\sum_{i=0}^{mn-1} (-1)^{\\lfloor i/m \\rfloor +\\lfloor i/n\\rfloor}=0.\\]", "solution": "For convenience, define $f_{m,n}(i) = \\lfloor \\frac{i}{m} \\rfloor +\n\\lfloor \\frac{i}{n} \\rfloor$, so that the given sum is\n$S(m,n) = \\sum_{i=0}^{mn-1} (-1)^{f_{m,n}(i)}$.\nIf $m$ and $n$ are both odd, then $S(m,n)$ is the sum of\nan odd number of $\\pm 1$'s, and thus cannot be zero.  Now consider\nthe case where $m$ and $n$ have opposite parity.  Note that\n$\\lfloor \\frac{i}{m} \\rfloor + \\lfloor k - \\frac{i+1}{m} \\rfloor\n= k-1$ for all integers $i,k,m$.  Thus\n$\\lfloor \\frac{i}{m} \\rfloor + \\lfloor \\frac{mn-i-1}{m} \\rfloor\n= n-1$ and $\\lfloor \\frac{i}{n} \\rfloor + \\lfloor \\frac{mn-i-1}{n}\n\\rfloor = m-1$; this implies that $f_{m,n}(i) + f_{m,n}(mn-i-1) =\nm+n-2$ is odd, and so $(-1)^{f_{m,n}(i)} =\n-(-1)^{f_{m,n}(mn-i-1)}$ for\nall $i$.  It follows that $S(m,n) = 0$ if $m$ and\n$n$ have opposite parity.\n\nNow suppose that $m=2k$ and $n=2l$ are both even.\nThen $\\lfloor \\frac{2j}{2m} \\rfloor = \\lfloor \\frac{2j+1}{2m} \\rfloor$\nfor all $j$, so $S$ can be computed as twice the sum over only even\nindices:\n\\[\nS(2k, 2l) = 2 \\sum_{i=0}^{2kl-1} (-1)^{f_{k,l}(i)}\n= S(k,l)(1 + (-1)^{k+l}).\n\\]\nThus $S(2k,2l)$ vanishes if and only if $S(k,l)$ vanishes (if $1 +\n(-1)^{k+l} = 0$, then $k$ and $l$ have opposite parity and so\n$S(k,l)$ also vanishes).\n\nPiecing our various cases together, we easily deduce that\n$S(m,n) = 0$ if and only if the highest powers of 2 dividing\n$m$ and $n$ are different.", "category": "Number Theory", "source": "PUTNAM", "year": 1998}
{"id": "putnam-1998-b5", "question": "Let $N$ be the positive integer with 1998 decimal digits, all of them 1;\nthat is,\n\\[N=1111\\cdots 11.\\]\nFind the thousandth digit after the decimal point of $\\sqrt N$.", "solution": "Write $N=(10^{1998}-1)/9$.  Then\n\\begin{align*}\n\\sqrt{N} &=\\frac{10^{999}}{3}\\sqrt{1-10^{-1998}} \\\\\n&=\\frac{10^{999}}{3}\n(1-\\frac{1}{2}10^{-1998} + r),\n\\end{align*}\nwhere $r<10^{-2000}$.  Now the digits after the decimal point of\n$10^{999}/3$ are given by $.3333\\ldots$, while\nthe digits after the decimal point\nof $\\frac{1}{6}10^{-999}$ are given by $.00000\\ldots 1666666\\ldots$.\nIt follows that the first 1000 digits of $\\sqrt N$ are given\nby $.33333\\ldots 3331$;  in particular, the thousandth digit is $1$.", "category": "Number Theory", "source": "PUTNAM", "year": 1998}
{"id": "putnam-1998-b6", "question": "Prove that, for any integers $a, b, c$, there exists a positive integer\n$n$ such that $\\sqrt{n^3+an^2+bn+c}$ is not an integer.\n\n\\end{itemize}\n\n\\end{document}", "solution": "First solution: Write $p(n) = n^3 + an^2 + bn + c$. Note that $p(n)$\nand $p(n+2)$ have the same parity, and recall that any perfect square\nis congruent to 0 or 1 (mod 4). Thus if $p(n)$ and $p(n+2)$ are perfect\nsquares, they are congruent mod 4. But $p(n+2) - p(n) \\equiv 2n^2 + 2b$\n(mod 4), which is not divisible by 4 if $n$ and $b$ have opposite parity.\n%\n% and likewise for $p(n+1)$ and $p(n+3)$.\n%But the ``third difference'' of $p$ is $p(n) -\n%3p(n+1) + 3p(n+2) - p(n+3) = 6$ (easy calculation), so that $p(n) +\n%p(n+1) - p(n+2) - p(n+3) \\equiv 2$ (mod 4). Thus not all of $p(n), p(n+1),\n%p(n+2), p(n+3)$ can be perfect squares.\n%(n+2)^3 + a(n+2)^2 + b(n+2) + c\n%n^3 + an^2 + bn + c\n%== 2n^2 + 2b\n\nSecond solution:\nWe prove more generally that for any polynomial $P(z)$ with integer\ncoefficients which is not a perfect square, there exists a positive\ninteger $n$ such that $P(n)$ is not a perfect square. Of course it\nsuffices to assume $P(z)$ has no repeated factors, which is to say $P(z)$\nand its derivative $P'(z)$ are relatively prime.\n\nIn particular, if we carry out the Euclidean algorithm on $P(z)$ and $P'(z)$\nwithout dividing, we get an integer $D$ (the discriminant of $P$) such that\nthe greatest common divisor of $P(n)$ and $P'(n)$ divides $D$ for any $n$.\nNow there exist infinitely many primes $p$ such that $p$ divides $P(n)$ for\nsome $n$: if there were only finitely many, say, $p_1, \\dots, p_k$, then\nfor any $n$ divisible by $m = P(0) p_1 p_2 \\cdots p_k$, we have $P(n)\n\\equiv P(0) \\pmod{m}$, that is, $P(n)/P(0)$ is not divisible by $p_1,\n\\dots, p_k$, so must be $\\pm 1$, but then $P$ takes some value infinitely\nmany times, contradiction. In particular, we can choose some such $p$ not\ndividing $D$, and choose $n$ such that $p$ divides $P(n)$. Then $P(n+kp)\n\\equiv P(n) + kp P'(n) (\\mathrm{mod}\\,p)$\n(write out the Taylor series of the left side);\nin particular, since $p$ does not divide $P'(n)$, we can find some $k$\nsuch that $P(n+kp)$ is divisible by $p$ but not by $p^2$, and so\nis not a perfect square.\n\nThird solution: (from David Rusin, David Savitt, and Richard Stanley\nindependently)\nAssume that $n^{3}+an^{2}+bn+c$ is a square for all $n>0$.\nFor sufficiently large $n$,\n\\begin{align*}\n(n^{3/2} + \\frac{1}{2} an^{1/2} - 1)^{2} &< n^{3} + an^{2}+bn+c \\\\\n&<  (n^{3/2}+ \\frac{1}{2} an^{1/2}+1)^{2};\n\\end{align*}\nthus if $n$ is a large even perfect square, we have $n^{3}+an^{2}+bn+c =\n(n^{3/2} + \\frac{1}{2} an^{1/2})^{2}$. We conclude this is an\nequality of polynomials, but the right-hand side\nis not a perfect square for $n$ an even non-square, contradiction.\n(The reader might try generalizing this approach to arbitrary polynomials.\nA related argument, due to Greg Kuperberg: write $\\sqrt{n^3+an^2+bn+c}$\nas $n^{3/2}$ times a power series in $1/n$ and take two finite differences\nto get an expression which tends to 0 as $n \\to \\infty$, contradiction.)\n\nNote: in case $n^3 + an^2 + bn + c$ has no repeated factors, it is a\nsquare for only finitely many $n$, by a theorem of Siegel; work of Baker gives\nan explicit (but large) bound on such $n$. (I don't know whether the graders\nwill accept this as a solution, though.)\n\n\\end{itemize}\n\n\\end{document}", "category": "Number Theory", "source": "PUTNAM", "year": 1998}
{"id": "imo-2009-q1", "question": "Let $n, k \\ge 2$ be positive integers and let $a_1$, $a_2$, $a_3$, \\dots, $a_k$\nbe distinct integers in the set $\\left\\{ 1,2,\\dots,n \\right\\}$\nsuch that $n$ divides $a_i(a_{i+1} - 1)$ for $i = 1,2,\\dots,k-1$.\nProve that $n$ does not divide $a_k(a_1 - 1)$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1561571}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n, k \\ge 2$ be positive integers and let $a_1$, $a_2$, $a_3$, \\dots, $a_k$\nbe distinct integers in the set $\\left\\{ 1,2,\\dots,n \\right\\}$\nsuch that $n$ divides $a_i(a_{i+1} - 1)$ for $i = 1,2,\\dots,k-1$.\nProve that $n$ does not divide $a_k(a_1 - 1)$.\n\\end{mdframed}\nWe proceed indirectly and assume that\n\\[ a_i (a_{i+1}-1) \\equiv 0 \\pmod n \\]\nfor $i = 1, \\dots, k$ (indices taken modulo $k$).\nWe claim that this implies all the $a_i$ are equal modulo $n$.\n\nLet $q = p^e$ be any prime power dividing $n$.\nThen, $a_1 (a_2 - 1) \\equiv 0 \\pmod q$, so $p$ divides either $a_1$ or $a_2-1$.\n\\begin{itemize}\n  \\ii If $p \\mid a_1$, then $p \\nmid a_1 - 1$. Then\n  \\[ a_k (a_1-1) \\equiv 0 \\pmod q \\implies a_k \\equiv 0 \\pmod q. \\]\n  In particular, $p \\mid a_k$.\n  So repeating this argument,\n  we get $a_{k-1} \\equiv 0 \\pmod q$, $a_{k-2} \\equiv 0 \\pmod q$, and so on.\n\n  \\ii Similarly, if $p \\mid a_2 - 1$ then $p \\nmid a_2$, and\n  \\[ a_2 (a_3-1) \\equiv 0 \\pmod q \\implies a_3 \\equiv 1 \\pmod q.  \\]\n  In particular, $p \\mid a_3 - 1$.\n  So repeating this argument,\n  we get $a_4 \\equiv 0 \\pmod q$, $a_5 \\equiv 0 \\pmod q$, and so on.\n\\end{itemize}\nEither way, we find $a_i \\pmod q$ is constant (and either $0$ or $1$).\n\nSince $q$ was an arbitrary prime power dividing $n$,\nby Chinese remainder theorem we conclude that $a_i \\pmod n$ is constant as well.\nBut this contradicts the assumption of distinctness.\n\\pagebreak", "category": "Combinatorics", "source": "IMO", "year": 2009}
{"id": "imo-2009-q2", "question": "Let $ABC$ be a triangle with circumcenter $O$.\nThe points $P$ and $Q$ are interior points of the sides $CA$ and $AB$ respectively.\nLet $K$, $L$, $M$ be the midpoints of $\\ol{BP}$, $\\ol{CQ}$, $\\ol{PQ}$,\nrespectively, and let $\\Gamma$ be the circumcircle of $\\triangle KLM$.\nSuppose that $\\ol{PQ}$ is tangent to $\\Gamma$. Prove that $OP = OQ$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1561572}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle with circumcenter $O$.\nThe points $P$ and $Q$ are interior points of the sides $CA$ and $AB$ respectively.\nLet $K$, $L$, $M$ be the midpoints of $\\ol{BP}$, $\\ol{CQ}$, $\\ol{PQ}$,\nrespectively, and let $\\Gamma$ be the circumcircle of $\\triangle KLM$.\nSuppose that $\\ol{PQ}$ is tangent to $\\Gamma$. Prove that $OP = OQ$.\n\\end{mdframed}\nBy power of a point, we have $-AQ \\cdot QB = OQ^2 - R^2$\nand $-AP \\cdot PC = OP^2 - R^2$.\nTherefore, it suffices to show $AQ \\cdot QB = AP \\cdot PC$.\n\n\\begin{center}\n\\begin{asy}\npair A = dir(70);\npair B = dir(210);\npair C = dir(330);\n\npair P = 0.4*A+0.6*C;\npair Q = 0.25*B+0.75*A;\n\nfilldraw(A--B--C--cycle, opacity(0.2)+lightred, red);\npair M = midpoint(P--Q);\npair K = midpoint(P--B);\npair L = midpoint(Q--C);\n\nfilldraw(circumcircle(M, K, L), opacity(0.3)+lightcyan, blue);\ndraw(P--Q, heavygreen+1);\ndraw(B--P, heavygreen);\ndraw(C--Q, heavygreen);\n\nfilldraw(K--M--L--cycle, opacity(0.4)+cyan, heavycyan);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$P$\", P, dir(P));\ndot(\"$Q$\", Q, dir(120));\ndot(\"$M$\", M, dir(M));\ndot(\"$K$\", K, dir(K));\ndot(\"$L$\", L, dir(20));\n\n/* TSQ Source:\n\nA = dir 70\nB = dir 210\nC = dir 330\n\nP = 0.4*A+0.6*C\nQ = 0.25*B+0.75*A R120\n\nA--B--C--cycle 0.2 lightred / red\nM = midpoint P--Q\nK = midpoint P--B\nL = midpoint Q--C R20\n\ncircumcircle M K L 0.3 lightcyan / blue\nP--Q heavygreen+1\nB--P heavygreen\nC--Q heavygreen\n\nK--M--L--cycle 0.4 cyan / heavycyan\n\n*/\n\\end{asy}\n\\end{center}\n\nAs $\\ol{ML} \\parallel \\ol{AC}$ and $\\ol{MK} \\parallel \\ol{AB}$ we have that\n\\begin{align*}\n  \\dang APQ &= \\dang LMP = \\dang LKM \\\\\n  \\dang PQA &= \\dang KMQ = \\dang MLK\n\\end{align*}\nand consequently we have the (opposite orientation) similarity\n\\[ \\triangle APQ \\overset{-}{\\sim} \\triangle MKL. \\]\nTherefore\n\\[ \\frac{AQ}{AP} = \\frac{ML}{MK} = \\frac{2ML}{2MK} = \\frac{PC}{QB} \\]\nid est $AQ \\cdot QB = AP \\cdot PC$, which is what we wanted to prove.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2009}
{"id": "imo-2009-q3", "question": "Suppose that $s_1,s_2,s_3, \\dotsc$ is a strictly increasing sequence of\npositive integers such that the sub-sequences\n$s_{s_1}$, $s_{s_2}$, $s_{s_3}$, \\dots\nand $s_{s_1 + 1}$, $s_{s_2 + 1}$, $s_{s_3 + 1}$, \\dots\nare both arithmetic progressions.\nProve that the sequence $s_1$, $s_2$, $s_3$, \\dots\\ is itself an arithmetic progression.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1561573}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nSuppose that $s_1,s_2,s_3, \\dotsc$ is a strictly increasing sequence of\npositive integers such that the sub-sequences\n$s_{s_1}$, $s_{s_2}$, $s_{s_3}$, \\dots\nand $s_{s_1 + 1}$, $s_{s_2 + 1}$, $s_{s_3 + 1}$, \\dots\nare both arithmetic progressions.\nProve that the sequence $s_1$, $s_2$, $s_3$, \\dots\\ is itself an arithmetic progression.\n\\end{mdframed}\nWe present two solutions.\n\n\\paragraph{First solution (Alex Zhai).}\nLet $s(n) \\coloneq s_n$ and write\n\\begin{align*}\n  s(s(n)) &= Dn + A \\\\\n  s(s(n)+1) &= D'n + B.\n\\end{align*}\nIn light of the bounds $s(s(n)) \\le s(s(n)+1) \\le s(s(n+1))$\nwe right away recover $D = D'$ and $A \\le B$.\n\nLet $d_n = s(n+1)-s(n)$.\nNote that $\\sup d_n < \\infty$ since $d_n$ is bounded above by $A$.\n\nThen we let\n\\[ m \\coloneq \\min d_n, \\qquad M \\coloneq \\max d_n. \\]\nNow suppose $a$ achieves the maximum, meaning $s(a+1)-s(a) = M$.\nThen\n\\begin{align*}\n  \\underbrace{d_{s(s(a))} + \\dots + d_{s(s(a+1))-1}}_{D \\text{ terms}}\n  &= \\boxed{s(s(s(a+1))) - s(s(s(a)))} \\\\\n  &= (D \\cdot s(a+1) + A) - (D \\cdot s(a) + A) = DM.\n\\end{align*}\nNow $M$ was maximal hence $M = d_{s(s(a))} = \\dots = d_{s(s(a+1))-1}$.\nBut $d_{s(s(a))} = B-A$ is a constant.\nHence $M = B-A$.\nIn the same way $m = B-A$ as desired.\n\n\\paragraph{Second solution.}\nWe retain the notation $D$, $A$, $B$ above,\nas well as $m = \\min_n s(n+1)-s(n) \\ge B-A$.\nWe do the involution trick first as:\n\\[ D = \\boxed{s(s(s(n)+1)) - s(s(s(n)))} = s(Dn+B) - s(Dn+A) \\]\nand hence we recover $D \\ge m(B-A)$.\n\nThe edge case $D = B-A$ is easy since then $m=1$\nand $D = s(Dn+B)-s(Dn+A)$ forces $s$ to be a constant shift.\nSo henceforth assume $D > B-A$.\n\nThe idea is that right now the $B$ terms are ``too big'',\nso we want to use the involution trick in a way that makes as many\n``$A$ minus $B$'' shape expressions as possible.\nThis motivates considering $s(s(s(n+1))) - s(s(s(n)+1)+1) > 0$,\nsince the first expression will have all $A$'s\nand the second expression will have all $B$'s.\nCalculation gives:\n\\begin{align*}\n  s(D(n+1)+A) - s(Dn+B+1)\n  &= \\boxed{s(s(s(n+1))) - s(s(s(n)+1)+1)} \\\\\n  &= (Ds(n+1) + A) - (D(s(n)+1) + B) \\\\\n  &= D\\left( s(n+1)-s(n) \\right) + A-B-D.\n\\end{align*}\nThen by picking $n$ achieving the minimum $m$,\n\\[ \\underbrace{m(D+A-B-1)}_{>0} \\le s(s(s(n+1))) - s(s(s(n)+1)+1) \\le Dm + A-B-D \\]\nwhich becomes\n\\[ \\left( D-m(B-A) \\right) + \\left( (B-A)-m \\right) \\le 0. \\]\nSince both of these quantities were supposed to be nonnegative,\nwe conclude $m = B-A$ and $D = m^2$.\nNow the estimate $D = s(Dn+B) - s(Dn+A) \\ge m(B-A)$ is actually sharp,\nso it follows that $s(n)$ is arithmetic.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Number Theory", "source": "IMO", "year": 2009}
{"id": "imo-2009-q4", "question": "Let $ABC$ be a triangle with $AB = AC$.\nThe angle bisectors of $\\angle CAB$ and $\\angle ABC$\nmeet the sides $BC$ and $CA$ at $D$ and $E$, respectively.\nLet $K$ be the incenter of triangle $ADC$.\nSuppose that $\\angle BEK = 45^\\circ$.\nFind all possible values of $\\angle CAB$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1562847}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be a triangle with $AB = AC$.\nThe angle bisectors of $\\angle CAB$ and $\\angle ABC$\nmeet the sides $BC$ and $CA$ at $D$ and $E$, respectively.\nLet $K$ be the incenter of triangle $ADC$.\nSuppose that $\\angle BEK = 45^\\circ$.\nFind all possible values of $\\angle CAB$.\n\\end{mdframed}\nHere is the solution presented in my book \\emph{EGMO}.\n\nLet $I$ be the incenter of $ABC$,\nand set $\\angle DAC = 2x$ (so that $0\\dg < x < 45\\dg$).\nFrom $\\angle AIE = \\angle DIC$, it is easy to compute\n\\[\n  \\angle KIE = 90\\dg - 2x, \\;\n  \\angle ECI = 45\\dg -x, \\;\n  \\angle IEK = 45\\dg, \\;\n  \\angle KEC = 3x. \\]\nHaving chased all the angles we want, we need a relationship.\nWe can find it by considering the side ratio $\\frac{IK}{KC}$.\nUsing the angle bisector theorem,\nwe can express this in terms of triangle $IDC$;\nhowever we can also express it in terms of triangle $IEC$.\n\n\n\\begin{center}\n  \\begin{asy}\n    size(7cm);\n    pair A = Drawing(\"A\", (0,7), dir(90));\n    pair C = Drawing(\"C\", (3,0), dir(-45));\n    pair B = Drawing(\"B\", -C, dir(225));\n    draw(A--B--C--cycle);\n    pair I = incenter(A,B,C);\n    pair D = Drawing(\"D\", origin, dir(-90));\n    pair E = Drawing(\"E\", extension(B,I,A,C), dir(45));\n    pair K = Drawing(\"K\", incenter(A,D,C), dir(-30));\n    draw(A--D--K);\n    draw(B--E--K);\n    draw(incircle(A,D,C));\n    markangle(9.0,B,E,K);\n  \\end{asy}\n  \\quad\n  \\begin{asy}\n    pair A = Drawing(\"A\", (0,5), dir(90));\n    pair C = Drawing(\"C\", (3,0), dir(-45));\n    pair B = -C;\n    pair D = Drawing(\"D\", origin, dir(-90));\n    pair I = Drawing(\"I\", incenter(A,B,C), dir(180));\n    pair E = Drawing(\"E\", extension(B,I,A,C), dir(45));\n    pair K = Drawing(\"K\", incenter(A,D,C), 1.3*dir(-90));\n    draw(A--D--C--cycle);\n    draw(C--I--E--K);\n    draw(D--K);\n    MP(\"2x\", A, dir(K-A)*8);\n    MP(rotate(-35)*\"45^{\\circ}-x\", C+dir(130)*1.2);\n    MP(rotate(-10)*\"45^{\\circ}-x\", C+dir(155));\n    MP(\"45^{\\circ}\", E, dir(240)*6);\n    MP(\"3x\", E, dir(-80)*6);\n    markangle(9.0,D,I,C);\n    markangle(9.0,E,I,A);\n  \\end{asy}\n\\end{center}\n\nBy the law of sines, we obtain\n\\[ \\frac{IK}{KC} = \\frac%\n  {\\sin 45\\dg \\cdot \\frac{EK}{\\sin \\left( 90\\dg - 2x \\right)}}%\n  {\\sin \\left( 3x \\right) \\cdot \\frac{EK}{\\sin \\left( 45\\dg-x \\right)}}\n  = \\frac{\\sin 45\\dg \\sin \\left( 45\\dg - x \\right)}%\n  {\\sin \\left( 3x \\right) \\sin \\left( 90\\dg - 2x \\right)}. \\]\nAlso, by the angle bisector theorem on $\\triangle IDC$,\nwe have\n\\[ \\frac{IK}{KC} = \\frac{ID}{DC}\n  = \\frac{\\sin \\left( 45\\dg-x \\right)}{\\sin\\left( 45\\dg+x \\right)}. \\]\nEquating these and cancelling $\\sin \\left( 45\\dg-x \\right) \\neq 0$ gives\n\\[ \\sin 45\\dg \\sin \\left( 45\\dg + x \\right)\n  = \\sin 3x \\sin \\left( 90\\dg - 2x \\right). \\]\n\nApplying the product-sum formula\n(again, we are just trying to break down things as much as possible),\nthis just becomes\n\\[ \\cos\\left( x \\right) - \\cos \\left( 90\\dg + x \\right)\n  = \\cos \\left( 5x-90\\dg \\right) - \\cos \\left( 90\\dg+x \\right) \\]\nor $\\cos x = \\cos \\left( 5x-90\\dg \\right)$.\n\nAt this point we are basically done;\nthe rest is making sure we do not miss any solutions\nand write up the completion nicely.\nOne nice way to do this is by using product-sum in reverse as\n\\[ 0 = \\cos \\left( 5x-90\\dg \\right) - \\cos x\n  = 2 \\sin \\left( 3x - 45\\dg \\right) \\sin \\left( 2x-45\\dg \\right). \\]\nThis way we merely consider the two cases\n\\[ \\sin \\left( 3x-45\\dg \\right) = 0 \\text{ and }\n  \\sin \\left( 2x - 45\\dg \\right) = 0. \\]\nNotice that $\\sin\\theta = 0$ if and only $\\theta$\nis an integer multiple of $180\\dg$.\nUsing the bound $0\\dg < x < 45\\dg$,\nit is easy to see that that the permissible values of $x$\nare $x = 15\\dg$ and $x = \\frac{45}{2}\\dg$.\nAs $\\angle A = 4x$, this corresponds to $\\angle A = 60\\dg$\nand $\\angle A = 90\\dg$, which can be seen to work.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2009}
{"id": "imo-2009-q5", "question": "Find all functions $f \\colon \\ZZ_{>0} \\to \\ZZ_{>0}$\nsuch that for positive integers $a$ and $b$, the numbers\n\\[ a, \\qquad f(b), \\qquad f(b+f(a)-1) \\]\nare the sides of a non-degenerate triangle.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1562848}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all functions $f \\colon \\ZZ_{>0} \\to \\ZZ_{>0}$\nsuch that for positive integers $a$ and $b$, the numbers\n\\[ a, \\qquad f(b), \\qquad f(b+f(a)-1) \\]\nare the sides of a non-degenerate triangle.\n\\end{mdframed}\nThe only function is the identity function (which works).\nWe prove it is the only one.\n\nLet $P(a,b)$ denote the given statement.\n\n\\begin{claim*}\n  We have $f(1) = 1$, and $f(f(n)) = n$.\n  (In particular $f$ is a bijection.)\n\\end{claim*}\n\\begin{proof}\n  Note that \\[ P(1,b) \\implies f(b) = f(b+f(1)-1). \\]\n  Otherwise, the function $f$ is periodic modulo $N = f(1)-1 \\ge 1$.\n  This is impossible since we can fix $b$ and let $a$ be arbitrarily\n  large in some residue class modulo $N$.\n\n  Hence $f(1)=1$, so taking $P(n,1)$ gives $f(f(n)) = n$.\n\\end{proof}\n\n\\begin{claim*}\n  Let $\\delta = f(2)-1 > 0$.\n  Then for every $n$,\n  \\[ f(n+1) = f(n) + \\delta\n    \\quad\\text{ or }\\quad f(n-1) = f(n) + \\delta \\]\n\\end{claim*}\n\\begin{proof}\n  Use\n  \\[ P(2, f(n)) \\implies n-2 < f( f(n) + \\delta ) < n+2. \\]\n  Let $y = f(f(n)+\\delta)$, hence $n-2 < y < n+2$\n  and $f(y) = f(n)+\\delta$.\n  But, remark that if $y = n$, we get $\\delta = 0$, contradiction.\n  So $y \\in \\{n+1, n-1\\}$ and that is all.\n\\end{proof}\n\nWe now show $f$ is an arithmetic progression\nwith common difference $+\\delta$.\nIndeed we already know $f(1) = 1$ and $f(2) = 1+\\delta$.\nNow suppose $f(1)=1$, \\dots, $f(n) = 1 + (n-1)\\delta$.\nThen by induction for any $n \\ge 2$,\nthe second case can't hold,\nso we have $f(n+1) = f(n)+\\delta$, as desired.\n\nCombined with $f(f(n)) = n$, we recover that $f$ is the identity.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2009}
{"id": "imo-2009-q6", "question": "Let $a_1$, $a_2$, \\dots, $a_n$ be distinct positive integers and\nlet $M$ be a set of $n-1$ positive integers not containing $s = a_1 + \\dots + a_n$.\nA grasshopper is to jump along the real axis, starting at the point $0$ and\nmaking $n$ jumps to the right with lengths $a_1$, $a_2$, \\dots, $a_n$ in some order.\nProve that the order can be chosen in such a way that\nthe grasshopper never lands on any point in $M$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p1562840}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a_1$, $a_2$, \\dots, $a_n$ be distinct positive integers and\nlet $M$ be a set of $n-1$ positive integers not containing $s = a_1 + \\dots + a_n$.\nA grasshopper is to jump along the real axis, starting at the point $0$ and\nmaking $n$ jumps to the right with lengths $a_1$, $a_2$, \\dots, $a_n$ in some order.\nProve that the order can be chosen in such a way that\nthe grasshopper never lands on any point in $M$.\n\\end{mdframed}\nThe proof is by induction on $n$.\nAssume $a_1 < \\dots < a_n$ and call each element of $M$ a \\emph{mine}.\nLet $x = s - a_n$.\nWe consider four cases, based on whether $x$ has a mine\nand whether there is a mine past $x$.\n\\begin{itemize}\n  \\ii If $x$ has no mine, and there is a mine past $x$,\n  then at most $n-2$ mines in $[0, x]$ and so we use induction to reach $x$,\n  then leap from $x$ to $s$ and win.\n\n  \\ii If $x$ has no mine but there is also no mine to the right of $x$,\n  then let $m$ be the maximal mine.\n  By induction hypothesis on $M \\setminus \\{m\\}$, there is a path to $x$\n  using $\\{a_1, \\dots, a_{n-1}\\}$ which avoids mines except possibly $m$.\n  If the path hits the mine $m$ on the hop of length $a_k$,\n  we then swap that hop with $a_n$, and finish.\n\n  \\ii If $x$ has a mine, but there are no mines to the right of $x$,\n  we can repeat the previous case with $m = x$.\n\n  \\ii Now suppose $x$ has a mine, \\emph{and} there is a mine past $x$.\n  There should exist an integer $1 \\le i \\le n-1$\n  such that $s-a_i$ and $y = s-a_i-a_n$ both have no mine.\n  By induction hypothesis, we can then reach $y$ in $n-2$ steps\n  (as there are two mines to the right of $y$); then $y \\to s-a_i \\to s$ finishes.\n\\end{itemize}\n\n\\begin{remark*}\n  It seems much of the difficulty of the problem is realizing induction will actually work.\n  Attempts at induction are, indeed, a total minefield (ha!),\n  and given the position P6 of the problem, it is expected that many contestants\n  will abandon induction after some cursory attempts fail.\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "IMO", "year": 2009}
{"id": "putnam-1997-a1", "question": "A rectangle, $HOMF$, has sides $HO=11$ and $OM=5$.  A triangle\n$ABC$ has $H$ as the intersection of the altitudes, $O$ the center of\nthe circumscribed circle, $M$ the midpoint of $BC$, and $F$ the foot of the\naltitude from $A$.  What is the length of $BC$?", "solution": "The centroid $G$ of the triangle is collinear with $H$ and $O$\n(Euler line), and the centroid lies two-thirds of the way from $A$ to\n$M$. Therefore $H$ is also two-thirds of the way from $A$ to $F$, so\n$AF = 15$. Since the triangles $BFH$ and $AFC$ are similar (they're\nright triangles and\n\\[\n\\angle HBC = \\pi/2 - \\angle C = \\angle CAF),\n\\]\nwe have\n\\[\nBF/FH = AF/FC\n\\]\nor\n\\[\nBF \\cdot FC = FH \\cdot AF = 75.\n\\]\nNow\n\\[\nBC^2 = (BF + FC)^2 = (BF - FC)^2 + 4 BF \\cdot FC,\n\\]\nbut\n\\[\nBF - FC = BM+MF-(MC-MF) = 2MF = 22,\n\\]\nso\n\\[\nBC = \\sqrt{22^2 + 4 \\cdot 75} = \\sqrt{784} = 28.\n\\]", "category": "Geometry", "source": "PUTNAM", "year": 1997}
{"id": "putnam-1997-a2", "question": "Players $1,2,3,\\ldots,n$ are seated around a table, and each has\na single penny.  Player 1 passes a penny to player 2, who then passes\ntwo pennies to player 3.  Player 3 then passes one penny to Player 4,\nwho passes two pennies to Player 5, and so on, players alternately\npassing one penny or two to the next player who still has some\npennies.  A player who runs out of pennies drops out of the game and\nleaves the table.  Find an infinite set of numbers $n$ for which some\nplayer ends up with all $n$ pennies.", "solution": "We show more precisely that the game terminates with one player\nholding all of the pennies if and only if $n = 2^m + 1$ or $n = 2^m +\n2$ for some $m$. First suppose we are in the following situation for\nsome $k \\geq 2$. (Note: for us, a ``move'' consists of two turns,\nstarting with a one-penny pass.)\n\\begin{itemize}", "category": "Combinatorics", "source": "PUTNAM", "year": 1997}
{"id": "putnam-1997-a3", "question": "Evaluate\n\\begin{gather*}\n\\int_0^\\infty \\left(x-\\frac{x^3}{2}+\\frac{x^5}{2\\cdot\n4}-\\frac{x^7}{2\\cdot 4\\cdot 6}+\\cdots\\right) \\\\\n\\left(1+\\frac{x^2}{2^2}+\n\\frac{x^4}{2^2\\cdot 4^2}+\\frac{x^6}{2^2\\cdot 4^2 \\cdot 6^2}+\\cdots\\right)\\,dx.\n\\end{gather*}", "solution": "Note that the series on the left is simply $x \\exp (-x^2/2)$.  By\nintegration by parts,\n\\[\n\\int_0^\\infty x^{2n+1} e^{-x^2/2} dx =\n2n \\int_0^\\infty x^{2n-1} e^{-x^2/2} dx\n\\]\nand so by induction,\n\\[\n\\int_0^\\infty x^{2n+1} e^{-x^2/2} dx =\n2 \\times 4 \\times \\cdots \\times 2n.\n\\]\nThus the desired\nintegral is simply\n\\[\n\\sum_{n=0}^\\infty \\frac{1}{2^n n!} = \\sqrt{e}.\n\\]", "category": "Algebra", "source": "PUTNAM", "year": 1997}
{"id": "putnam-1997-a4", "question": "Let $G$ be a group with identity $e$ and $\\phi:G\\rightarrow G$\na function such that\n\\[\\phi(g_1)\\phi(g_2)\\phi(g_3)=\\phi(h_1)\\phi(h_2)\\phi(h_3)\\]\nwhenever $g_1g_2g_3=e=h_1h_2h_3$.  Prove that there exists an element\n$a\\in G$ such that $\\psi(x)=a\\phi(x)$ is a homomorphism (i.e.\n$\\psi(xy)=\\psi(x)\\psi(y)$ for all $x,y\\in G$).", "solution": "In order to have $\\psi(x) = a \\phi(x)$ for all $x$, we must in\nparticular have this for $x = e$, and so we take $a = \\phi(e)^{-1}$.\nWe first note that\n\\[\n\\phi(g) \\phi(e) \\phi(g^{-1}) = \\phi(e) \\phi(g) \\phi(g^{-1})\n\\]\nand so $\\phi(g)$ commutes with $\\phi(e)$ for all $g$. Next, we note that\n\\[\n\\phi(x) \\phi(y) \\phi(y^{-1}x^{-1}) = \\phi(e) \\phi(xy) \\phi(y^{-1}x^{-1})\n\\]\nand using the commutativity of $\\phi(e)$, we deduce\n\\[\n\\phi(e)^{-1} \\phi(x) \\phi(e)^{-1} \\phi(y) = \\phi(e)^{-1} \\phi(xy)\n\\]\nor $\\psi(xy) = \\psi(x) \\psi(y)$, as desired.", "category": "Algebra", "source": "PUTNAM", "year": 1997}
{"id": "putnam-1997-a5", "question": "Let $N_n$ denote the number of ordered $n$-tuples of positive\nintegers $(a_1,a_2,\\ldots,a_n)$ such that $1/a_1 + 1/a_2 +\\ldots +\n1/a_n=1$.  Determine whether $N_{10}$ is even or odd.", "solution": "We may discard any solutions for which $a_1 \\neq a_2$, since those come in\npairs; so assume $a_1 = a_2$.  Similarly, we may assume that $a_3 = a_4$,\n$a_5 = a_6$, $a_7 = a_8$, $a_9=a_{10}$.  Thus we get the equation\n\\[\n2/a_1 + 2/a_3 + 2/a_5 + 2/a_7 + 2/a_9 = 1.\n\\]\nAgain, we may assume $a_1 = a_3$ and $a_5 = a_7$, so we get $4/a_1 + 4/a_5\n+ 2/a_9 = 1$; and $a_1 = a_5$, so $8/a_1 + 2/a_9 = 1$.  This implies that\n$(a_1-8)(a_9-2) = 16$, which by counting has 5 solutions.  Thus $N_{10}$\nis odd.", "category": "Combinatorics", "source": "PUTNAM", "year": 1997}
{"id": "putnam-1997-a6", "question": "For a positive integer $n$ and any real number $c$, define\n$x_k$ recursively by $x_0=0$, $x_1=1$, and for $k\\geq 0$,\n\\[x_{k+2}=\\frac{cx_{k+1}-(n-k)x_k}{k+1}.\\]\nFix $n$ and then take $c$ to be the largest value for which $x_{n+1}=0$.\nFind $x_k$ in terms of $n$ and $k$, $1\\leq k\\leq n$.", "solution": "Clearly $x_{n+1}$ is a polynomial in $c$ of degree $n$,\nso it suffices to identify $n$ values of $c$ for which $x_{n+1} =\n0$. We claim these are $c = n-1-2r$ for $r=0,1,\\dots, n-1$; in this\ncase, $x_k$ is the coefficient of $t^{k-1}$ in the polynomial\n$f(t) = (1-t)^r (1+t)^{n-1-r}$. This can be verified by noticing that\n$f$ satisfies the differential equation\n\\[\n\\frac{f'(t)}{f(t)} = \\frac{n-1-r}{1+t} - \\frac{r}{1-t}\n\\]\n(by logarithmic differentiation) or equivalently,\n\\begin{align*}\n(1-t^2) f'(t) &= f(t) [(n-1-r)(1-t) - r(1+t)] \\\\\n&= f(t) [(n-1-2r)  - (n-1)t]\n\\end{align*}\nand then taking the coefficient of $t^{k}$ on both sides:\n\\begin{gather*}\n(k+1) x_{k+2} - (k-1) x_k = \\\\\n(n-1-2r) x_{k+1} - (n-1) x_{k}.\n\\end{gather*}\nIn particular, the largest such $c$ is $n-1$, and $x_k =\n\\binom{n-1}{k-1}$ for $k= 1, 2, \\dots, n$.\n\nGreg Kuperberg has suggested an alternate approach to show directly\nthat $c=n-1$ is the largest root, without computing the others. Note\nthat the condition $x_{n+1} = 0$ states that $(x_1, \\dots, x_n)$ is an\neigenvector of the matrix\n\\[\nA_{ij} = \\left\\{ \\begin{array}{cc} i & j = i + 1 \\\\ n-j & j=i-1 \\\\\n0&\\mbox{otherwise} \\end{array} \\right.\n\\]\nwith eigenvalue $c$. By the Perron-Frobenius theorem, $A$ has a unique\neigenvector with positive entries, whose eigenvalue has modulus\ngreater than or equal to that of any other eigenvalue, which proves\nthe claim.", "category": "Algebra", "source": "PUTNAM", "year": 1997}
{"id": "putnam-1997-b1", "question": "Let $\\{x\\}$ denote the distance between the real number $x$ and the\nnearest integer.  For each positive integer $n$, evaluate\n\\[F_n=\\sum_{m=1}^{6n-1} \\min(\\{\\frac{m}{6n}\\},\\{\\frac{m}{3n}\\}).\\]\n(Here $\\min(a,b)$ denotes the minimum of $a$ and $b$.)", "solution": "It is trivial to check that $\\frac{m}{6n}=\\{\\frac{m}{6n}\\}\\leq\n\\{\\frac{m}{3n}\\}$ for $1\\leq m\\leq 2n$, that\n$1-\\frac{m}{3n}=\\{\\frac{m}{3n}\\}\\leq \\{\\frac{m}{6n}\\}$ for $2n\\leq\nm\\leq 3n$, that $\\frac{m}{3n}-1=\\{\\frac{m}{3n}\\}\\leq \\{\\frac{m}{6n}\\}$\nfor $3n\\leq m\\leq 4n$, and that $1-\\frac{m}{6n}=\\{\\frac{m}{6n}\\}\\leq\n\\{\\frac{m}{3n}\\}$ for $4n\\leq m\\leq 6n$.  Therefore the desired sum is\n\\begin{gather*}\n\\sum_{m=1}^{2n-1} \\frac{m}{6n}\n +\\sum_{m=2n}^{3n-1} \\left(1-\\frac{m}{3n} \\right) \\\\\n +\\sum_{m=3n}^{4n-1} \\left(\\frac{m}{3n}-1 \\right) + \\sum_{m=4n}^{6n-1} \\left(\n1-\\frac{m}{6n} \\right)\n=n.\n\\end{gather*}", "category": "Number Theory", "source": "PUTNAM", "year": 1997}
{"id": "putnam-1997-b2", "question": "Let $f$ be a twice-differentiable real-valued function satisfying\n\\[f(x)+f''(x)=-xg(x)f'(x),\\]\nwhere $g(x)\\geq 0$ for all real $x$.  Prove that $|f(x)|$ is bounded.", "solution": "It suffices to show that $|f(x)|$ is bounded for $x \\geq 0$, since $f(-x)$\nsatisfies the same equation as $f(x)$.  But then\n\\begin{align*}\n\\frac{d}{dx}\\left(\n(f(x))^2 + (f'(x))^2 \\right) &= 2f'(x)(f(x)+f''(x)) \\\\\n&= -2xg(x)(f'(x))^2 \\leq 0,\n\\end{align*}\nso that $(f(x))^2 \\leq (f(0))^2 + (f'(0))^2$ for $x\\geq 0$.", "category": "Algebra", "source": "PUTNAM", "year": 1997}
{"id": "putnam-1997-b3", "question": "For each positive integer $n$, write the sum $\\sum_{m=1}^n\n1/m$ in the form $p_n/q_n$, where $p_n$ and $q_n$ are relatively prime\npositive integers.  Determine all $n$ such that 5 does not divide $q_n$.", "solution": "The only such $n$ are the numbers 1--4, 20--24, 100--104, and\n120--124.  For the proof let\n\\[H_n=\\sum_{m=1}^n \\frac{1}{m}\\]\nand introduce the auxiliary function\n\\[I_n=\\sum_{1\\leq m\\leq n, (m,5)=1} \\frac{1}{m}.\\]\nIt is immediate (e.g., by induction) that\n$I_n\\equiv 1,-1,1,0,0$ (mod $5$) for $n\\equiv  1,2,3,4,5$ (mod 5)\nrespectively, and moreover, we have the equality\n\\[\\label{(*)}\nH_n= \\sum_{m=0}^k \\frac{1}{5^m} I_{\\lfloor n/5^m \\rfloor},\\]\nwhere $k=k(n)$ denotes the largest integer such that $5^k\\leq n$.\nWe wish to determine those $n$ such that the above sum has nonnegative\n5--valuation.  (By the 5--valuation of a number $a$ we mean\nthe largest integer $v$ such that $a/5^v$ is an integer.)\n\nIf $\\lfloor n/5^k \\rfloor\\leq 3$, then the last term in the above sum\nhas 5--valuation $-k$, since $I_1$, $I_2$, $I_3$ each have valuation\n0; on the other hand, all other terms must have 5--valuation strictly\nlarger than $-k$.  It follows that $H_n$ has 5--valuation exactly\n$-k$; in particular, $H_n$ has nonnegative 5--valuation in this case\nif and only if $k=0$, i.e., $n=1$, 2, or 3.\n\nSuppose now that $\\lfloor n/5^k \\rfloor=4$.  Then we must also have\n$20\\leq \\lfloor n/5^{k-1}\\rfloor \\leq 24$.  The former condition\nimplies that the last term of the above sum is $I_4/5^k=1/(12\\cdot\n5^{k-2})$, which has 5--valuation $-(k-2)$.\n\nIt is clear that $I_{20}\\equiv I_{24}\\equiv 0$ (mod 25); hence if $\\lfloor\nn/5^{k-1}\\rfloor$ equals 20 or 24, then the second--to--last term of the\nabove sum (if it exists) has valuation at least $-(k-3)$.  The\nthird--to--last term (if it exists) is of the form $I_r/5^{k-2}$, so that\nthe sum of the last term and the third to last term takes the form\n$(I_r+1/12)/5^{k-2}$.  Since $I_r$ can be congruent only to 0,1, or -1\n(mod 5), and $1/12\\equiv 3$ (mod 5), we conclude that the sum of the\nlast term and third--to--last term has valuation $-(k-2)$, while all other\nterms have valuation strictly higher.  Hence $H_n$ has nonnegative\n5--valuation in this case only when $k\\leq 2$, leading to the values\n$n=4$ (arising from $k=0$), 20,24 (arising from $k=1$ and $\\lfloor\nn/5^{k-1}\\rfloor = 20$ and 24 resp.), 101, 102, 103, and 104 (arising\nfrom $k=2$, $\\lfloor n/5^{k-1}\\rfloor = 20$) and 120, 121, 122, 123,\nand 124 (arising from $k=2$, $\\lfloor n/5^{k-1}\\rfloor=24$).\n\nFinally, suppose $\\lfloor n/5^k \\rfloor=4$ and $\\lfloor n/5^{k-1}\n\\rfloor=21$, 22, or 23.  Then as before, the first condition\nimplies that the last term of the sum in (*) has valuation $-(k-2)$,\nwhile the second condition implies that the second--to--last term in the\nsame sum has valuation $-(k-1)$.  Hence all terms in the sum (*) have\n5--valuation strictly higher than $-(k-1)$, except for the\nsecond--to--last term, and therefore $H_n$ has 5--valuation $-(k-1)$ in\nthis case.  In particular, $H_n$ is integral (mod 5) in this case if and\nonly if  $k\\leq 1$, which gives the additional values $n=21$, 22, and 23.", "category": "Number Theory", "source": "PUTNAM", "year": 1997}
{"id": "putnam-1997-b4", "question": "Let $a_{m,n}$ denote the coefficient of $x^n$ in the expansion of\n$(1+x+x^2)^m$.  Prove that for all [integers] $k\\geq 0$,\n\\[0\\leq \\sum_{i=0}^{\\lfloor \\frac{2k}{3}\\rfloor} (-1)^i a_{k-i,i}\\leq\n1.\\]", "solution": "Let $s_k = \\sum_i (-1)^{i} a_{k-1,i}$ be the given sum (note that\n$a_{k-1,i}$ is nonzero precisely for $i = 0, \\dots, \\lfloor\n\\frac{2k}{3} \\rfloor)$. Since\n\\[\na_{m+1,n} = a_{m,n} + a_{m,n-1} + a_{m,n-2},\n\\]\nwe have\n\\begin{align*}\ns_k - s_{k-1} + s_{k+2}\n&= \\sum_i (-1)^i (a_{n-i,i} + a_{n-i,i+1} + a_{n-i,i+2}) \\\\\n&= \\sum_i (-1)^i a_{n-i+1,i+2} = s_{k+3}.\n\\end{align*}\nBy computing $s_0 = 1, s_1 = 1, s_2 = 0$, we may easily verify by\ninduction that $s_{4j} = s_{4j+1} = 1$ and $s_{4j+2} = s_{4j+3} = 0$\nfor all $j \\geq 0$. (Alternate solution suggested by John Rickert:\nwrite $S(x,y) = \\sum_{i=0}^\\infty (y+xy^2+x^2y^3)^i$, and note\nnote that $s_k$ is the coefficient of $y^k$ in $S(-1,y) = (1+y)/(1-y^4)$.)", "category": "Combinatorics", "source": "PUTNAM", "year": 1997}
{"id": "putnam-1997-b5", "question": "Prove that for $n\\geq 2$,\n\\[\n\\overbrace{2^{2^{\\cdots^{2}}}}^{\\mbox{$n$ terms}} \\equiv\n\\overbrace{2^{2^{\\cdots^{2}}}}^{\\mbox{$n-1$ terms}} \\quad \\pmod{n}.\n\\]", "solution": "Define the sequence $x_1 = 2$, $x_n = 2^{x_{n-1}}$ for $n > 1$. It\nsuffices to show that for every $n$, $x_m \\equiv x_{m+1} \\equiv \\cdots\n\\pmod n$ for some $m < n$. We do this by induction on $n$, with $n=2$\nbeing obvious.\n\nWrite $n = 2^a b$, where $b$ is odd. It suffices to show that $x_m\n\\equiv \\cdots$ modulo $2^a$ and modulo $b$, for some $m < n$. For the\nformer, we only need $x_{n-1} \\geq a$, but clearly\n$x_{n-1} \\geq n$ by induction on $n$. For the latter, note that\n$x_m \\equiv x_{m+1} \\equiv \\cdots\n\\pmod b$ as long as $x_{m-1} \\equiv x_m \\equiv \\cdots \\pmod{\\phi(b)}$,\nwhere $\\phi(n)$ is the Euler totient function. By hypothesis, this\noccurs for some $m < \\phi(b) + 1 \\leq n$. (Thanks to Anoop Kulkarni\nfor catching a lethal typo in an earlier version.)", "category": "Number Theory", "source": "PUTNAM", "year": 1997}
{"id": "putnam-1997-b6", "question": "The dissection of the 3--4--5 triangle shown below (into four\ncongruent right triangles similar to the original)\nhas diameter $5/2$.\nFind the least diameter of a dissection of this triangle into four parts.\n(The diameter of a dissection is the least upper bound of the distances\nbetween pairs of points belonging to the same part.)\n\n\\end{itemize}\n\n\\end{document}", "solution": "The answer is $25/13$.  Place the triangle on the cartesian plane so\nthat its vertices are at $C=(0,0), A=(0,3), B=(4,0)$.  Define also the points \n$D=(20/13,24/13),$ and $E=(27/13,0)$. We then compute that\n\\begin{align*}\n\\frac{25}{13} &= AD=BE=DE\\\\\n\\frac{27}{13} &= BC - CE = BE < BC \\\\\n\\frac{39}{13} &= AC < \\sqrt{AC^2 + CE^2} = AE \\\\\n\\frac{40}{13} &= AB - AD = BD < AB\n\\end{align*}\nand that $AD < CD$. In any dissection of the triangle into four parts, some two of $A,B,C,D,E$ must belong to the same part, forcing the least diameter to be at least $25/13$.\n\nWe now exhibit a dissection with least diameter $25/13$. (Some\nvariations of this dissection are possible.) Put $F = (15/13, 19/13)$,\n$G = (15/13, 0)$, $H = (0, 19/13)$, $J = (32/15, 15/13)$,\nand divide $ABC$ into the convex polygonal regions $ADFH$, $BEJ$, $CGFH$,\n$DFGEJ$. \nTo check that this dissection has least diameter $25/13$, it suffices (by the following remark) to check that the distances\n\\begin{gather*}\nAD, AF, AH, BE, BJ, DE, CF, CG, CH, \\\\\nDF, DG, DH, DJ, EF, EG, EJ, FG, FH, FJ, GJ\n\\end{gather*}\nare all at most $25/13$. This can be checked by a long numerical calculation, which we omit in favor of some shortcuts: note that $ADFH$ and $BEJ$ are contained in\ncircular sectors centered at $A$ and $B$, respectively, of radius\n$25/13$ and angle less than $\\pi/3$, while $CGFH$ is a rectangle with diameter $CF < 25/13$.\n\n\\noindent\n\\textbf{Remark.} The preceding argument uses implicitly the fact that for $P$ a simple closed polygon in the plane, if we let $S$ denote the set of points on or within $P$, then  the maximum distance between two points of $S$ occurs between some pair of vertices of $P$.\nThis is an immediate consequence of the compactness of $S$ (which guarantees the existence of a maximum) and the convexity of the function taking $(x,y) \\in S \\times S$ to the squared distance between $x$ and $y$ (which is obvious in terms of Cartesian coordinates).\n\n\\end{itemize}\n\\end{document}", "category": "Geometry", "source": "PUTNAM", "year": 1997}
{"id": "putnam-1996-a1", "question": "Find the least number $A$ such that for any two squares of combined\narea 1, a rectangle of area $A$ exists such that the two squares can\nbe packed in the rectangle (without interior overlap). You may assume\nthat the sides of the squares are parallel to the sides of the\nrectangle.", "solution": "If $x$ and $y$ are the sides of two squares with combined area 1, then\n$x^2 + y^2 = 1$. Suppose without loss of generality that $x \\geq y$.\nThen the shorter side of a rectangle containing both squares without\noverlap must be at least $x$, and the longer side must be at least\n$x+y$. Hence the desired value of $A$ is the maximum of $x(x+y)$.\n\nTo find this maximum, we let $x = \\cos \\theta, y = \\sin \\theta$ with\n$\\theta \\in [0, \\pi/4]$. Then we are to maximize\n\\begin{align*}\n\\cos^2 \\theta + \\sin \\theta \\cos \\theta\n&= \\frac 12 (1 + \\cos 2\\theta + \\sin 2\\theta) \\\\\n&= \\frac 12 + \\frac{\\sqrt{2}}{2} \\cos (2\\theta - \\pi/4) \\\\\n&\\leq \\frac{1 + \\sqrt{2}}{2},\n\\end{align*}\nwith equality for $\\theta = \\pi/8$. Hence this value is the desired\nvalue of $A$.", "category": "Geometry", "source": "PUTNAM", "year": 1996}
{"id": "putnam-1996-a2", "question": "Let $C_1$ and $C_2$ be circles whose centers are 10 units apart, and\nwhose radii are 1 and 3. Find, with proof, the locus of all points $M$\nfor which there exists points $X$ on $C_1$ and $Y$ on $C_2$ such that\n$M$ is the midpoint of the line segment $XY$.", "solution": "Let $O_1$ and $O_2$ be the centers of $C_1$ and $C_2$, respectively.\n(We are assuming $C_1$ has radius 1 and $C_2$ has radius 3.)\nThen the\ndesired locus is an annulus centered at the midpoint of $O_1O_2$, with\ninner radius 1 and outer radius 2.\n\nFor a fixed point $Q$ on $C_2$, the locus of the midpoints of the\nsegments $PQ$ for $P$ lying on $C_1$ is the image of $C_1$ under a\nhomothety centered at $Q$ of radius $1/2$, which is a circle of radius\n$1/2$. As $Q$ varies, the center of this smaller circle traces out a\ncircle $C_3$ of radius $3/2$ (again by homothety). By considering the two\npositions of $Q$ on the line of centers of the circles, one sees that\n$C_3$ is centered at the midpoint of $O_1O_2$, and the locus is now\nclearly the specified annulus.", "category": "Geometry", "source": "PUTNAM", "year": 1996}
{"id": "putnam-1996-a3", "question": "Suppose that each of 20 students has made a choice of anywhere from 0\nto 6 courses from a total of 6 courses offered. Prove or disprove:\nthere are 5 students and 2 courses such that all 5 have chosen both\ncourses or all 5 have chosen neither course.", "solution": "The claim is false. There are $\\binom{6}{3} = 20$ ways to choose 3 of the\n6 courses; have each student choose a different set of 3 courses. Then\neach pair of courses is chosen by 4 students (corresponding to the\nfour ways to complete this pair to a set of 3 courses) and is not\nchosen by 4 students (corresponding to the 3-element subsets of the\nremaining 4 courses).\n\nNote: Assuming that no two students choose the same courses,\nthe above counterexample is unique (up to permuting students).\nThis may be seen as follows: Given a group of students, suppose that\nfor any pair of courses (among the six) there are at most 4 students\ntaking both, and at most 4 taking neither.  Then there are at most\n$120=(4+4)\\binom{6}{2}$ pairs $(s,p)$, where $s$ is a student, and $p$\nis a set of two courses of which $s$ is taking either both or none.\nOn the other hand, if a student $s$ is taking $k$ courses, then he/she\noccurs in $f(k)=\\binom{k}{2}+\\binom{6-k}{2}$ such pairs $(s,p)$.  As\n$f(k)$ is minimized for $k=3$, it follows that every student occurs in\nat least $6=\\binom{3}{2}+\\binom{3}{2}$ such pairs $(s,p)$.  Hence\nthere can be at most $120/6=20$ students, with equality only if each\nstudent takes 3 courses, and for each set of two courses, there are\nexactly 4 students who take both and exactly 4 who take neither.\nSince there are only 4 ways to complete a given pair of courses to a\nset of 3, and only 4 ways to choose 3 courses not containing the given\npair, the only way for there to be 20 students (under our hypotheses)\nis if all sets of 3 courses are in fact taken.  This is the desired conclusion.\n\nHowever, Robin Chapman has pointed out that the solution is not unique\nin the problem as stated, because a given selection of courses may be\nmade by more than one student. One alternate solution is to identify\nthe 6 courses with pairs of antipodal vertices of an icosahedron, and\nhave each student pick a different face and choose the three vertices\ntouching that face. In this example, each of 10 selections is made by\na pair of students.", "category": "Combinatorics", "source": "PUTNAM", "year": 1996}
{"id": "putnam-1996-a4", "question": "Let $S$ be the set of ordered triples $(a, b, c)$ of distinct elements\nof a finite set $A$. Suppose that\n\\begin{enumerate}", "solution": "In fact, we will show that such a function $g$ exists with the\nproperty that $(a,b,c) \\in S$ if and only if $g(d) < g(e) < g(f)$ for\nsome cyclic permutation $(d,e,f)$ of $(a,b,c)$. We proceed by\ninduction on the number of elements in $A$. If $A =\n\\{a,b,c\\}$ and $(a,b,c) \\in S$, then choose $g$ with $g(a) < g(b) <\ng(c)$, otherwise choose $g$ with $g(a) > g(b) > g(c)$.\n\nNow let $z$ be an element of $A$ and $B = A - \\{z\\}$.\nLet $a_{1}, \\dots, a_{n}$ be the elements of $B$ labeled such that\n$g(a_{1}) < g(a_{2}) < \\cdots < g(a_{n})$. We claim that there exists\na unique $i \\in \\{1, \\dots, n\\}$ such that $(a_{i}, z, a_{i+1})\n\\in S$, where hereafter $a_{n+k} = a_{k}$.\n\nWe show existence first. Suppose no such $i$ exists; then for all\n$i,k \\in \\{1, \\dots, n\\}$, we have $(a_{i+k}, z, a_{i}) \\notin S$.\nThis holds by property 1 for $k=1$ and by induction on $k$ in\ngeneral, noting that\n\\begin{align*}\n(a_{i+k+1}, z, a_{i+k}), &(a_{i+k}, z, a_{i})  \\in S \\\\\n&\\Rightarrow (a_{i+k}, a_{i+k+1}, z), (z, a_{i}, a_{i+k}) \\in S \\\\\n&\\Rightarrow (a_{i+k+1},z,a_{i}) \\in S.\n\\end{align*}\nApplying this when $k=n$, we get $(a_{i-1}, z, a_{i}) \\in S$,\ncontradicting the fact that $(a_{i}, z, a_{i-1}) \\in S$. Hence\nexistence follows.\n\nNow we show uniqueness. Suppose $(a_{i}, z, a_{i+1}) \\in S$; then for\nany $j \\neq i-1, i, i+1$, we have $(a_{i}, a_{i+1}, a_{j}), (a_{j},\na_{j+1}, a_{i}) \\in S$ by the\nassumption on $G$. Therefore\n\\begin{align*}\n(a_{i}, z, a_{i+1}), (a_{i+1}, a_{j}, a_{i}) \\in S\n&\\Rightarrow (a_{j}, a_{i}, z) \\in S \\\\\n(a_{i}, z, a_{j}), (a_{j}, a_{j+1}, a_{i}) \\in S\n&\\Rightarrow (z, a_{j}, a_{j+1}),\n\\end{align*}\nso $(a_{j}, z, a_{j+1}) \\notin S$. The case $j =i+1$ is ruled out by\n\\[\n(a_{i}, z, a_{i+1}), (a_{i+1}, a_{i+2}, a_{i}) \\in S \\Rightarrow (z,\na_{i+1}, a_{i+2}) \\in S\n\\]\nand the case $j=i-1$ is similar.\n\nFinally, we put $g(z)$ in $(g(a_{n}), + \\infty)$ if $i = n$, and\n$(g(a_{i}), g(a_{i+1}))$ otherwise; an analysis similar to that above\nshows that $g$ has the desired property.", "category": "Combinatorics", "source": "PUTNAM", "year": 1996}
{"id": "putnam-1996-a5", "question": "If $p$ is a prime number greater than 3 and $k = \\lfloor 2p/3\n\\rfloor$, prove that the sum\n\\[\n\\binom p1 + \\binom p2 + \\cdots + \\binom pk\n\\]\nof binomial coefficients is divisible by $p^2$.", "solution": "(due to Lenny Ng)\nFor $1 \\leq n \\leq p-1$, $p$ divides $\\binom pn$ and\n\\begin{align*}\n\\frac{1}{p} \\binom pn &= \\frac{1}{n} \\frac{p-1}{1} \\frac{p-2}{2} \\cdots\n\\frac{p-n+1}{n-1} \\\\\n&\\equiv \\frac{(-1)^{n-1}}{n} \\mymod{p},\n\\end{align*}\nwhere the congruence $x \\equiv y \\mymod{p}$ means that $x-y$ is a\nrational number whose numerator, in reduced form, is divisible by $p$.\nHence it suffices to show that\n\\[\n\\sum_{n=1}^k \\frac{(-1)^{n-1}}{n} \\equiv 0 \\mymod{p}.\n\\]\nWe distinguish two cases based on $p \\mymod{6}$. First suppose $p =\n6r+1$, so that $k = 4r$. Then\n\\begin{align*}\n\\sum_{n=1}^{4r} \\frac{(-1)^{n-1}}{n}\n&= \\sum_{n=1}^{4r} \\frac{1}{n} - 2 \\sum_{n=1}^{2r} \\frac{1}{2n} \\\\\n&= \\sum_{n=1}^{2r} \\left( \\frac{1}{n} - \\frac{1}{n} \\right)\n+ \\sum_{n=2r+1}^{3r} \\left( \\frac{1}{n} + \\frac{1}{6r+1-n} \\right) \\\\\n&= \\sum_{n=2r+1}^{3r} \\frac{p}{n(p-n)} \\equiv 0 \\mymod{p},\n\\end{align*}\nsince $p = 6r+1$.\n\nNow suppose $p = 6r+5$, so that $k = 4r + 3$. A similar argument gives\n\\begin{align*}\n\\sum_{n=1}^{4r+3}\\ \\frac{(-1)^{n-1}}{n}\n&= \\sum_{n=1}^{4r+3} \\frac{1}{n} + 2 \\sum_{n=1}^{2r+1} \\frac{1}{2n} \\\\\n&= \\sum_{n=1}^{2r+1} \\left( \\frac{1}{n} - \\frac{1}{n} \\right)\n+ \\sum_{n=2r+2}^{3r+2} \\left( \\frac{1}{n} + \\frac{1}{6r+5-n} \\right) \\\\\n&= \\sum_{n=2r+2}^{3r+2} \\frac{p}{n(p-n)} \\equiv 0 \\mymod{p}.\n\\end{align*}", "category": "Number Theory", "source": "PUTNAM", "year": 1996}
{"id": "putnam-1996-a6", "question": "Let $c>0$ be a constant. Give a complete description, with proof, of\nthe set of all continuous functions $f: R \\to R$ such that $f(x) =\nf(x^2+c)$ for all $x \\in R$. Note that $R$ denotes the set of real numbers.", "solution": "We first consider the case $c \\leq 1/4$; we shall show in this case\n$f$ must be constant. The relation\n\\[\nf(x) = f(x^2 + c) = f((-x)^2 + c) = f(-x)\n\\]\nproves that $f$ is an even function. Let $r_1 \\leq r_2$ be the roots of\n$x^2 + c - x$, both of which are real. If $x > r_{2}$, define $x_{0} =\nx$ and $x_{n+1} = \\sqrt{x_{n} - c}$ for each positive integer $x$. By\ninduction on $n$, $r_{2} < x_{n+1} < x_{n}$ for all $n$, so the\nsequence $\\{x_{n}\\}$ tends to a limit $L$ which is a root of $x^{2} +\nc = x$ not less than $r_{2}$. Of course this means $L = r_{2}$.\nSince $f(x) = f(x_{n})$ for all $n$ and $x_{n} \\to r_{2}$, we\nconclude $f(x) = f(r_{2})$, so $f$ is constant on $x \\geq r_{2}$.\n\nIf $r_{1} < x < r_{2}$ and $x_{n}$ is defined as before, then by\ninduction, $x_{n} < x_{n+1} < r_{2}$. Note that the\nsequence can be defined because $r_{1} > c$; the latter follows by\nnoting that the polynomial $x^{2} - x + c$ is positive at $x = c$ and\nhas its minimum at $1/2 > c$, so both roots are greater than $c$. In\nany case, we deduce that $f(x)$ is also constant on $r_{1} \\leq x \\leq\nr_{2}$.\n\nFinally, suppose $x < r_{1}$. Now define $x_{0} = x, x_{n+1} =\nx_{n}^{2} + c$. Given that $x_{n} < r_{1}$, we have $x_{n+1} >\nx_{n}$. Thus if we had $x_{n} < r_{1}$ for all $n$, by the same argument as\nin the first case we deduce $x_{n} \\to r_{1}$ and so $f(x) =\nf(r_{1})$. Actually, this doesn't happen; eventually we have $x_{n} >\nr_{1}$, in which case $f(x) = f(x_{n}) = f(r_{1})$ by what we have\nalready shown. We conclude that $f$ is a constant function. (Thanks\nto Marshall Buck for catching an inaccuracy in a previous version of\nthis solution.)\n\nNow suppose $c > 1/4$. Then the sequence $x_n$ defined by $x_0 = 0$\nand $x_{n+1} = x_n^2 + c$ is strictly increasing and has no limit\npoint. Thus if we define $f$ on $[x_0, x_1]$ as any continuous\nfunction with equal values on the endpoints, and extend the definition\nfrom $[x_n, x_{n+1}]$ to $[x_{n+1}, x_{n+2}]$ by the relation $f(x) =\nf(x^2 + c)$, and extend the definition further to $x < 0$ by the\nrelation $f(x) = f(-x)$, the resulting function has the desired\nproperty. Moreover, any function with that property clearly has this form.", "category": "Algebra", "source": "PUTNAM", "year": 1996}
{"id": "putnam-1996-b1", "question": "Define a \\textbf{selfish} set to be a set which has its own\ncardinality (number of elements) as an element. Find, with proof, the\nnumber of subsets of $\\{1, 2, \\ldots, n\\}$ which are \\textit{minimal}\nselfish sets, that is, selfish sets none of whose proper subsets is selfish.", "solution": "Let $[n]$ denote the set $\\{1,2,\\ldots,n\\}$, and let $f_n$ denote the\nnumber of minimal selfish subsets of $[n]$.  Then the number of\nminimal selfish subsets of $[n]$ not containing $n$ is equal to\n$f_{n-1}$.  On the other hand, for any minimal selfish subset of $[n]$\ncontaining $n$, by subtracting 1 from each element, and then taking\naway the element $n-1$ from the set, we obtain a minimal selfish\nsubset of $[n-2]$ (since $1$ and $n$ cannot both occur in a selfish\nset).  Conversely, any minimal selfish subset of $[n-2]$ gives rise to\na minimal selfish subset of $[n]$ containing $n$ by the inverse\nprocedure.  Hence the number of minimal selfish subsets of $[n]$\ncontaining $n$ is $f_{n-2}$.  Thus we obtain $f_n=f_{n-1}+f_{n-2}$.\nSince $f_1=f_2=1$, we have $f_n=F_n$, where $F_n$ denotes the $n$th\nterm of the Fibonacci sequence.", "category": "Combinatorics", "source": "PUTNAM", "year": 1996}
{"id": "putnam-1996-b2", "question": "Show that for every positive integer $n$,\n\\[\n\\left( \\frac{2n-1}{e} \\right)^{\\frac{2n-1}{2}} < 1 \\cdot 3 \\cdot 5\n\\cdots (2n-1) < \\left( \\frac{2n+1}{e} \\right)^{\\frac{2n+1}{2}}.\n\\]", "solution": "By estimating the area under the graph of $\\ln x$ using upper and\nlower rectangles of width 2, we get\n\\begin{align*}\n\\int_1^{2n-1} \\ln x\\,dx &\\leq 2(\\ln(3) + \\cdots + \\ln(2n-1)) \\\\\n&\\leq \\int_3^{2n+1} \\ln x\\,dx.\n\\end{align*}\nSince $\\int \\ln x\\,dx = x \\ln x - x + C$, we have, upon exponentiating\nand taking square roots,\n%\\begin{align*}\n%\\left( \\frac{2n-1}{e} \\right)^{\\frac{2n-1}{2}}\n%< (2n-1)^{\\frac{2n-1}{2}} e^{-n+1}\n%&\\leq 1 \\cdot 3 \\cdots (2n-1) \\\\\n%&\\leq (2n+1)^{\\frac{2n+1}{2}} \\frac{e^{-n+1}}{3^{3/2}}\n%< \\left( \\frac{2n+1}{e} \\right)^{\\frac{2n+1}{2}},\n%\\end{align*}\n\\begin{align*}\n\\left( \\frac{2n-1}{e} \\right)^{\\frac{2n-1}{2}}\n&< (2n-1)^{\\frac{2n-1}{2}} e^{-n+1} \\\\\n& \\leq 1 \\cdot 3 \\cdots (2n-1) \\\\\n& \\leq (2n+1)^{\\frac{2n+1}{2}} \\frac{e^{-n+1}}{3^{3/2}} \\\\\n& < \\left( \\frac{2n+1}{e} \\right)^{\\frac{2n+1}{2}},\n\\end{align*}\nusing the fact that $1 < e < 3$.", "category": "Number Theory", "source": "PUTNAM", "year": 1996}
{"id": "putnam-1996-b3", "question": "Given that $\\{x_1, x_2, \\ldots, x_n\\} = \\{1, 2, \\ldots, n\\}$, find,\nwith proof, the largest possible value, as a function of $n$ (with $n\n\\geq 2$), of\n\\[\nx_1x_2 + x_2x_3 + \\cdots + x_{n-1}x_n + x_nx_1.\n\\]", "solution": "View $x_1, \\dots, x_n$ as an arrangement of the numbers $1, 2, \\dots,\nn$ on a circle.\nWe prove that the optimal arrangement is\n\\[\n\\dots, n-4, n-2, n, n-1, n-3, \\dots\n\\]\nTo show this, note that if\n$a, b$ is a pair of adjacent numbers and $c,d$ is another pair (read\nin the same order around the circle) with $a < d$ and $b > c$, then\nthe segment from $b$ to $c$ can be reversed, increasing the sum by\n\\[\nac + bd - ab - cd = (d-a)(b-c) > 0.\n\\]\nNow relabel the numbers so they appear in order as follows:\n\\[\n\\dots, a_{n-4}, a_{n-2}, a_n = n, a_{n-1}, a_{n-3}, \\dots\n\\]\nwhere without loss of generality we assume $a_{n-1} > a_{n-2}$. By\nconsidering the pairs $a_{n-2}, a_n$ and $a_{n-1}, a_{n-3}$ and using\nthe trivial fact $a_n > a_{n-1}$, we deduce $a_{n-2} > a_{n-3}$. We\nthen compare the pairs $a_{n-4}, a_{n-2}$ and $a_{n-1}, a_{n-3}$, and\nusing that $a_{n-1} > a_{n-2}$, we deduce $a_{n-3} > a_{n-4}$.\nContinuing in this\nfashion, we prove that $a_n > a_{n-1} > \\dots > a_1$ and\nso $a_k = k$ for $k = 1, 2, \\dots, n$, i.e.\\ that the optimal\narrangement is as claimed. In particular, the maximum value of the sum\nis\n\\begin{multline*}\n1 \\cdot 2 + (n-1)\\cdot n + 1 \\cdot 3 + 2 \\cdot 4 + \\cdots + (n-2)\\cdot n \\\\\n\\begin{aligned}\n&= 2 + n^2 - n + (1^2 - 1) + \\cdots + [(n-1)^2 - 1] \\\\\n&= n^2 - n + 2 - (n-1) + \\frac{(n-1)n(2n-1)}{6} \\\\\n&= \\frac{2n^3 + 3n^2 - 11n + 18}{6}.\n\\end{aligned}\n\\end{multline*}\n\nAlternate solution: We prove by induction that the value given above\nis an upper bound; it is clearly a lower bound because of the\narrangement given above. Assume this is the case for $n-1$. The optimal\narrangement for $n$ is obtained from some arrangement for $n-1$ by\ninserting $n$ between some pair $x, y$ of adjacent terms. This\noperation increases the sum by $nx + ny - xy = n^2 - (n-x)(n-y)$,\nwhich is an increasing function of both $x$ and $y$. In particular,\nthis difference is maximal when $x$ and $y$ equal $n-1$ and $n-2$.\nFortunately, this yields precisely the difference between the claimed\nupper bound for $n$ and the assumed upper bound for $n-1$, completing\nthe induction.", "category": "Combinatorics", "source": "PUTNAM", "year": 1996}
{"id": "putnam-1996-b4", "question": "For any square matrix $A$, we can define $\\sin A$ by the usual power\nseries:\n\\[\n\\sin A = \\sum_{n=0}^\\infty \\frac{(-1)^n}{(2n+1)!} A^{2n+1}.\n\\]\nProve or disprove: there exists a $2 \\times 2$ matrix $A$ with real\nentries such that\n\\[\n\\sin A = \\left( \\begin{array}{cc} 1 & 1996 \\\\ 0 & 1 \\end{array} \\right).\n\\]", "solution": "Suppose such a matrix $A$ exists.  If the eigenvalues of $A$ (over\nthe complex numbers) are distinct, then there exists a complex\nmatrix $C$ such that $B=CAC^{-1}$ is diagonal.  Consequently,\n$\\sin B$ is diagonal.  But then $\\sin A=C^{-1}(\\sin B)C$ must\nbe diagonalizable, a contradiction.  Hence the eigenvalues of $A$\nare the same, and $A$ has a conjugate $B=CAC^{-1}$ over\nthe complex numbers of the form\n\\[\n\\left(\n\\begin{array}{cc}\nx & y\\\\\n0 & x\n\\end{array}\n\\right).\n\\]\nA direct computation shows that\n\\[\n\\sin B = \\left(\n\\begin{array}{cc}\n\\sin x & y\\cdot \\cos x\\\\\n0 & \\sin x\n\\end{array}\n\\right).\n\\]\nSince $\\sin A$ and $\\sin B$ are conjugate, their eigenvalues\nmust be the same, and so we must have $\\sin x=1$.  This implies\n$\\cos x=0$, so that $\\sin B$ is the identity matrix, as must be $\\sin\nA$, a contradiction.\nThus $A$ cannot exist.\n\nAlternate solution (due to Craig Helfgott and Alex Popa):\nDefine both $\\sin A$ and $\\cos A$ by the usual power series.\nSince $A$ commutes with itself, the power series identity\n\\[\n\\sin^2 A+\\cos^2 A = I\n\\]\nholds.  But if $\\sin A$ is the given matrix, then by the\nabove identity, $\\cos^2 A$ must equal\n$\\left(\n\\begin{array}{cc}\n0 & -2\\cdot 1996\\\\\n0 & 0\n\\end{array}\n\\right)$\nwhich is a nilpotent matrix.  Thus $\\cos A$ is also nilpotent.\nHowever, the square of any $2\\times 2$ nilpotent matrix must be zero\n(e.g., by the Cayley-Hamilton theorem).  This is a contradiction.", "category": "Algebra", "source": "PUTNAM", "year": 1996}
{"id": "putnam-1996-b5", "question": "Given a finite string $S$ of symbols $X$ and $O$, we write $\\Delta(S)$\nfor the number of $X$'s in $S$ minus the number of $O$'s. For example,\n$\\Delta(XOOXOOX) = -1$. We call a string $S$ \\textbf{balanced} if every\nsubstring $T$ of (consecutive symbols of) $S$ has $-2 \\leq \\Delta(T)\n\\leq 2$. Thus, $XOOXOOX$ is not balanced, since it contains the\nsubstring $OOXOO$. Find, with proof, the number of balanced strings of\nlength $n$.", "solution": "Consider a $1 \\times n$ checkerboard, in which we write an $n$-letter\nstring, one letter per square. If the string is balanced, we can cover\neach pair of adjacent squares containing the same letter with a $1\n\\times 2$ domino, and these will not overlap (because no three in a\nrow can be the same). Moreover, any domino is separated from the next\nby an even number of squares, since they must cover opposite letters,\nand the sequence must alternate in between.\n\nConversely, any arrangement of dominoes where adjacent dominoes are\nseparated by an even number of squares corresponds to a unique\nbalanced string, once we choose whether the string starts with $X$ or\n$O$. In other words, the number of balanced strings is twice the\nnumber of acceptable domino arrangements.\n\nWe count these arrangements by numbering the squares $0,1,\\dots,n-1$\nand distinguishing whether the dominoes start on even or odd numbers.\nOnce this is decided, one simply chooses whether or not to put a\ndomino in each eligible position. Thus\nwe have $2^{\\lfloor n/2 \\rfloor}$ arrangements in the first case and $2^{\\lfloor\n(n-1)/2 \\rfloor}$ in the second, but note that the case of no dominoes has\nbeen counted twice. Hence the number of balanced strings is\n\\[\n2^{\\lfloor (n+2)/2 \\rfloor} + 2^{\\lfloor (n+1)/2 \\rfloor} - 2.\n\\]", "category": "Combinatorics", "source": "PUTNAM", "year": 1996}
{"id": "putnam-1996-b6", "question": "Let $(a_1, b_1), (a_2, b_2), \\ldots, (a_n, b_n)$ be the vertices of a\nconvex polygon which contains the origin in its interior. Prove that\nthere exist positive real numbers $x$ and $y$ such that\n\\begin{gather*}\n(a_1, b_1)x^{a_1} y^{b_1} + (a_2, b_2)x^{a_2}y^{b_2} + \\cdots \\\\\n+ (a_n, b_n)x^{a_n}y^{b_n} = (0,0).\n\\end{gather*}\n\\end{itemize}\n\n\\end{document}", "solution": "We will prove the claim assuming only that the convex hull of the\npoints $(a_{i}, b_{i})$ contains the origin in its interior. (Thanks\nto Marshall Buck for pointing out that the last three words are\nnecessary in the previous sentence!) Let $u = \\log x, v = \\log\ny$ so that the left-hand side of the given equation is\n\\begin{multline}\n(a_1, b_1) \\exp(a_1 u + b_1 v) + (a_2, b_2) \\exp(a_2 u + b_2 v) + \\\\\n\\cdots + (a_n, b_n) \\exp(a_n u + b_n v).\n\\end{multline}\nNow note that (1) is the gradient of the function\n\\begin{gather*}\nf(u,v) = exp(a_1 u + b_1 v) +\nexp(a_2 u + b_2 v) + \\\\\n\\cdots + exp(a_n u + b_n v),\n\\end{gather*}\nand so it suffices to show $f$ has a critical point. We will in fact\nshow $f$ has a global minimum.\n\nClearly we have\n\\[\nf(u,v) \\geq \\exp\\left( \\max_i (a_i u + b_i v) \\right).\n\\]\nNote that this maximum is positive for $(u,v) \\neq (0,0)$:  if we had\n$a_i u + b_i v < 0$ for all $i$, then the subset $ur + vs < 0$ of the\n$rs$-plane would be a half-plane containing all of the points $(a_i,\nb_i)$, whose convex hull would then not contain the origin, a\ncontradiction.\n\nThe function $\\max_{i} (a_{i}u + b_{i}v)$ is clearly\ncontinuous on the unit circle $u^{2} + v^{2} = 1$, which is compact.\nHence it has a global minimum $M > 0$, and so for all $u,v$,\n\\[\n\\max_{i} (a_{i} u + b_{i} v) \\geq M \\sqrt{u^{2} + v^{2}}.\n\\]\nIn particular, $f \\geq n+1$ on the disk of radius $\\sqrt{(n+1)/M}$.\nSince $f(0,0) = n$, the infimum of $f$ is the same over the entire\n$uv$-plane as over this disk, which again is compact.\nHence $f$ attains its infimal value at some point in the disk,\nwhich is the desired global minimum.\n\nNoam Elkies has suggested an alternate solution as follows: for $r >\n0$, draw the loop traced by (1) as $(u,v)$ travels\ncounterclockwise around the circle $u^2 + v^2 = r^2$. For $r=0$, this\nof course has winding number 0 about any point, but for $r$ large, one\ncan show this loop has winding number 1 about the origin, so somewhere in\nbetween the loop must pass through the origin. (Proving this latter\nfact is a little tricky.)\n\n\\end{itemize}\n\\end{document}", "category": "Geometry", "source": "PUTNAM", "year": 1996}
{"id": "imo-2005-q1", "question": "Six points are chosen on the sides of an equilateral triangle $ABC$:\n$A_1$, $A_2$ on $BC$, $B_1$, $B_2$ on $CA$ and $C_1$, $C_2$ on $AB$,\nsuch that they are the vertices of a\nconvex hexagon $A_1A_2B_1B_2C_1C_2$ with equal side lengths.\nProve that the lines $A_1B_2$, $B_1C_2$ and $C_1A_2$ are concurrent.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p281571}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nSix points are chosen on the sides of an equilateral triangle $ABC$:\n$A_1$, $A_2$ on $BC$, $B_1$, $B_2$ on $CA$ and $C_1$, $C_2$ on $AB$,\nsuch that they are the vertices of a\nconvex hexagon $A_1A_2B_1B_2C_1C_2$ with equal side lengths.\nProve that the lines $A_1B_2$, $B_1C_2$ and $C_1A_2$ are concurrent.\n\\end{mdframed}\nThe six sides of the hexagon, when oriented, comprise\nsix vectors with vanishing sum.\nHowever note that \\[ \\overrightarrow{A_1A_2}\n+ \\overrightarrow{B_1B_2}\n+ \\overrightarrow{C_1C_2} = 0. \\]\nThus\n\\[ \\overrightarrow{A_2B_1} + \\overrightarrow{B_2C_1} +\n\\overrightarrow{C_2A_1} = 0 \\]\nand since three unit vectors with vanishing sum\nmust be rotations of each other by $120\\dg$,\nit follows they must also form an equilateral triangle.\n\n\\begin{center}\n\\begin{asy}\npair A_1 = origin;\npair A_2 = A_1+dir(0);\npair B_1 = A_2+dir(37);\npair B_2 = B_1+dir(120);\npair C_1 = B_2+dir(157);\npair C_2 = C_1+dir(240);\n\npair A = extension(B_1, B_2, C_1, C_2);\npair B = extension(C_1, C_2, A_1, A_2);\npair C = extension(A_1, A_2, B_1, B_2);\n\nfilldraw(A--B--C--cycle, opacity(0.1)+lightcyan, lightblue);\n\ndraw(A_1--A_2, red+1, EndArrow(TeXHead), Margins);\ndraw(B_1--B_2, red+1, EndArrow(TeXHead), Margins);\ndraw(C_1--C_2, red+1, EndArrow(TeXHead), Margins);\ndraw(A_2--B_1, blue+1, EndArrow(TeXHead), Margins);\ndraw(B_2--C_1, blue+1, EndArrow(TeXHead), Margins);\ndraw(C_2--A_1, blue+1, EndArrow(TeXHead), Margins);\n\nfilldraw(A_1--B_1--C_1--cycle, opacity(0.1)+lightgreen, heavygreen);\ndraw(A_1--B_2, dotted+heavycyan);\ndraw(B_1--C_2, dotted+heavycyan);\ndraw(C_1--A_2, dotted+heavycyan);\n\ndot(\"$A_1$\", A_1, dir(270));\ndot(\"$A_2$\", A_2, dir(270));\ndot(\"$B_1$\", B_1, dir(30));\ndot(\"$B_2$\", B_2, dir(30));\ndot(\"$C_1$\", C_1, dir(150));\ndot(\"$C_2$\", C_2, dir(150));\ndot(\"$A$\", A, dir(90));\ndot(\"$B$\", B, dir(210));\ndot(\"$C$\", C, dir(330));\n\n/* TSQ Source:\n\nA_1 = origin R270\nA_2 = A_1+dir(0) R270\nB_1 = A_2+dir(37) R30\nB_2 = B_1+dir(120) R30\nC_1 = B_2+dir(157) R150\nC_2 = C_1+dir(240) R150\n\nA = extension B_1 B_2 C_1 C_2 R90\nB = extension C_1 C_2 A_1 A_2 R210\nC = extension A_1 A_2 B_1 B_2 R330\n\nA--B--C--cycle 0.1 lightcyan / lightblue\n\n!draw(A_1--A_2, red+1, EndArrow(TeXHead), Margins);\n!draw(B_1--B_2, red+1, EndArrow(TeXHead), Margins);\n!draw(C_1--C_2, red+1, EndArrow(TeXHead), Margins);\n!draw(A_2--B_1, blue+1, EndArrow(TeXHead), Margins);\n!draw(B_2--C_1, blue+1, EndArrow(TeXHead), Margins);\n!draw(C_2--A_1, blue+1, EndArrow(TeXHead), Margins);\n\nA_1--B_1--C_1--cycle 0.1 lightgreen / heavygreen\nA_1--B_2 dotted heavycyan\nB_1--C_2 dotted heavycyan\nC_1--A_2 dotted heavycyan\n\n*/\n\\end{asy}\n\\end{center}\n\nConsequently, triangles $A_1A_2B_1$, $B_1B_2C_1$, $C_1C_2A_1$\nare congruent, as $\\angle A_2 = \\angle B_2 = \\angle C_2$.\nSo triangle $A_1 B_1 C_1$ is equilateral and the\ndiagonals are concurrent at the center.\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2005}
{"id": "imo-2005-q2", "question": "Let $a_1$, $a_2$, \\dots\\ be a sequence of integers\nwith infinitely many positive and negative terms.\nSuppose that for every positive integer $n$\nthe numbers $a_1$, $a_2$, \\dots, $a_n$\nleave $n$ different remainders upon division by $n$.\nProve that every integer occurs exactly once in the sequence.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p281572}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $a_1$, $a_2$, \\dots\\ be a sequence of integers\nwith infinitely many positive and negative terms.\nSuppose that for every positive integer $n$\nthe numbers $a_1$, $a_2$, \\dots, $a_n$\nleave $n$ different remainders upon division by $n$.\nProve that every integer occurs exactly once in the sequence.\n\\end{mdframed}\nObviously every integer appears at most once\n(otherwise take $n$ much larger).\nSo we will prove every integer appears at least once.\n\n\\begin{claim*}\n  For any $i < j$ we have $\\left\\lvert a_i-a_j \\right\\rvert < j$.\n\\end{claim*}\n\\begin{proof}\n  Otherwise, let $n = \\left\\lvert a_i-a_j \\right\\rvert \\neq 0$.\n  Then $i,j \\in [1,n]$ and $a_i \\equiv a_j \\pmod n$,\n  contradiction.\n\\end{proof}\n\n\\begin{claim*}\n  For any $n$, the set $\\{a_1, \\dots, a_n\\}$\n  is of the form $\\{k+1, \\dots, k+n\\}$ for some integer $k$.\n\\end{claim*}\n\\begin{proof}\n  By induction, with the base case $n=1$ being vacuous.\n  For the inductive step,\n  suppose $\\{a_1, \\dots, a_n\\} = \\{k+1, \\dots, k+n\\}$ are determined.\n  Then\n  \\[ a_{n+1} \\equiv k \\pmod{n+1}. \\]\n  Moreover by the earlier claim we have\n  \\[ \\left\\lvert a_{n+1}-a_1 \\right\\rvert < n+1. \\]\n  From this we deduce $a_{n+1} \\in \\{k, k+n+1\\}$ as desired.\n\\end{proof}\n\nThis gives us actually a complete description\nof all possible sequences satisfying the hypothesis:\nchoose any value of $a_1$ to start.\nThen, for the $n$th term,\nthe set $S = \\{a_1, \\dots, a_{n-1}\\}$\nis (in some order) a set of $n-1$ consecutive integers.\nWe then let $a_n = \\max S + 1$ or $a_n = \\min S - 1$.\nA picture of six possible starting terms is shown below.\n\n\\begin{center}\n\\begin{asy}\nsize(6cm);\ndefaultpen(fontsize(9pt));\nint[] a = {0, 6, 5, 7, 4, 3, 8};\nfor (int i=1; i<=9; ++i) {\n  draw((0,i)--(7.2,i), gray+dotted);\n}\nfor (int i=1; i<=7; ++i) {\n  draw((i,0)--(i,9.2), gray+dotted);\n  if (i <= 5) draw((i,a[i])--(i+1,a[i+1]), red+dashed);\n  if (i <= 6) dot(\"$\"+(string) a[i] + \"$\", (i, a[i]), dir(15), red);\n  if (i <= 6) label(\"$a_{\" + (string) i + \"}$\", (i, 0), dir(-90));\n}\ndraw( (-0.2,0)--(7.2,0), black );\ndraw( (0,-0.2)--(0,9.2), black );\n\\end{asy}\n\\end{center}\n\n\nFinally, we observe that the condition that\nthe sequence has infinitely many positive and negative terms\n(which we have not used until now)\nimplies it is unbounded above and below.\nThus it must contain every integer.\n\\pagebreak", "category": "Number Theory", "source": "IMO", "year": 2005}
{"id": "imo-2005-q3", "question": "Let $x,y,z > 0$ satisfy $xyz\\geq 1$. Prove that\n\\[ \\frac { x^5-x^2 }{x^5+y^2+z^2}\n  + \\frac {y^5-y^2}{x^2+y^5+z^2}\n  + \\frac {z^5-z^2}{x^2+y^2+z^5} \\geq 0. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p281573}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $x,y,z > 0$ satisfy $xyz\\geq 1$. Prove that\n\\[ \\frac { x^5-x^2 }{x^5+y^2+z^2}\n  + \\frac {y^5-y^2}{x^2+y^5+z^2}\n  + \\frac {z^5-z^2}{x^2+y^2+z^5} \\geq 0. \\]\n\\end{mdframed}\nNegating both sides and adding $3$ eliminates the minus signs:\n\\[ \\sum_{\\text{cyc}} \\frac{1}{x^5+y^2+z^2}\n  \\le \\frac{3}{x^2+y^2+z^2}. \\]\nThus we only need to consider the case $xyz = 1$.\n\nDirect expansion and Muirhead works now!\nAs advertised, once we show it suffices to analyze if $xyz=1$\nthe inequality becomes more economically written as\n\\[ S = \\sum_{\\text{cyc}} x^2(x^2-yz)(y^4+x^3z+xz^3)(z^4+x^3y+xy^3)\n  \\overset{?}{\\ge} 0. \\]\nSo, clearing all the denominators gives\n\\begin{align*}\n  S &= \\sum_{\\text{cyc}} x^2(x^2-yz)\n  \\left[ y^4z^4 + x^3y^5 + xy^7 + x^3z^5 + x^6yz + x^4y^3z\n    + xz^7 + x^4yz^3 + x^2y^3z^3 \\right] \\\\\n  &= \\sum_{\\text{cyc}}\n  \\left[ x^4y^4z^4 + x^7y^5 + x^5y^7 + x^7z^5 + x^{10}yz + x^8y^3z\n    + x^5z^7 + x^8yz^3 + x^6y^3z^3 \\right] \\\\\n  &- \\sum_{\\text{cyc}}\n  \\left[ x^2y^5z^5 + x^5y^6z + x^3y^8z + x^5yz^6 + x^8y^2z^2 + x^6y^4z^2\n    + x^3yz^8 + x^6y^2z^4 + x^4y^4z^4 \\right] \\\\\n  &= \\sum_{\\text{cyc}}\n  \\left[ x^7y^5 + x^5y^7 + x^7z^5 + x^{10}yz\n    + x^5z^7 + x^6y^3z^3 \\right] \\\\\n  &- \\sum_{\\text{cyc}}\n  \\left[ x^2y^5z^5 + x^5y^6z + x^5yz^6 + x^8y^2z^2 + x^6y^4z^2\n    + x^6y^2z^4 \\right]\n\\end{align*}\nIn other words we need to show\n\\[\n  \\sum_{\\text{sym}} \\left( 2x^7y^5\n  +\\half x^{10}yz + \\half x^6y^3z^3 \\right)\n  \\ge\n  \\sum_{\\text{sym}} \\left( \\half x^8 y^2 z^2\n  + \\half x^5 y^5 z^2 + x^6 y^4 z^2 + x^6 y^5 z \\right).\n\\]\nwhich follows by summing\n\\begin{align*}\n  \\sum_{\\text{sym}} \\frac{x^{10} yz + x^6 y^3 z^3}{2}\n    &\\ge \\sum_{\\text{sym}} x^8 y^2 z^2 \\\\\n  \\half \\sum_{\\text{sym}} x^8 y^2 z^2\n    &\\ge \\half \\sum_{\\text{sym}} x^6 y^4 z^2 \\\\\n  \\half \\sum_{\\text{sym}} x^7y^5\n    &\\ge \\half \\sum_{\\text{sym}} x^5 y^5 z^2 \\\\\n  \\half \\sum_{\\text{sym}} x^7y^5\n    &\\ge \\half \\sum_{\\text{sym}} x^6 y^4 z^2 \\\\\n  \\sum_{\\text{sym}} x^7y^5\n    &\\ge \\sum_{\\text{sym}} x^6 y^5 z.\n\\end{align*}\nThe first line here comes from AM-GM,\nthe rest come from Muirhead.\n\\begin{remark*}\nMore elegant approach is to use Cauchy in the form\n\\[ \\frac{1}{x^5+y^2+z^2} \\le \\frac{x\\inv+y^2+z^2}{(x^2+y^2+z^2)^2}. \\]\n\\end{remark*}\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Algebra", "source": "IMO", "year": 2005}
{"id": "imo-2005-q4", "question": "Determine all positive integers relatively\nprime to all the terms of the infinite sequence\n\\[ a_n = 2^n+3^n+6^n-1, \\quad n \\ge 1. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p282138}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nDetermine all positive integers relatively\nprime to all the terms of the infinite sequence\n\\[ a_n = 2^n+3^n+6^n-1, \\quad n \\ge 1. \\]\n\\end{mdframed}\nThe answer is $1$ only (which works).\n\nIt suffices to show there are no primes.\nFor the primes $p=2$ and $p=3$, take $a_2=48$.\nFor any prime $p \\ge 5$ notice that\n\\begin{align*}\n  a_{p-2} &= 2^{p-2} + 3^{p-2} + 6^{p-2} - 1 \\\\\n  &\\equiv \\frac 12 + \\frac 13 + \\frac 16 - 1 \\pmod p \\\\\n  &\\equiv 0 \\pmod p\n\\end{align*}\nso no other larger prime works.\n\\pagebreak", "category": "Number Theory", "source": "IMO", "year": 2005}
{"id": "imo-2005-q5", "question": "Let $ABCD$ be a fixed convex quadrilateral\nwith $BC=DA$ and $\\ol{BC} \\nparallel \\ol{DA}$.\nLet two variable points $E$ and $F$ lie on the\nsides $BC$ and $DA$, respectively, and satisfy $BE=DF$.\nThe lines $AC$ and $BD$ meet at $P$,\nthe lines $BD$ and $EF$ meet at $Q$,\nthe lines $EF$ and $AC$ meet at $R$.\nProve that the circumcircles of the triangles $PQR$,\nas $E$ and $F$ vary, have a common point other than $P$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p282140}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABCD$ be a fixed convex quadrilateral\nwith $BC=DA$ and $\\ol{BC} \\nparallel \\ol{DA}$.\nLet two variable points $E$ and $F$ lie on the\nsides $BC$ and $DA$, respectively, and satisfy $BE=DF$.\nThe lines $AC$ and $BD$ meet at $P$,\nthe lines $BD$ and $EF$ meet at $Q$,\nthe lines $EF$ and $AC$ meet at $R$.\nProve that the circumcircles of the triangles $PQR$,\nas $E$ and $F$ vary, have a common point other than $P$.\n\\end{mdframed}\nLet $M$ be the Miquel point of complete quadrilateral $ADBC$;\nin other words, let $M$ be the second intersection point\nof the circumcircles of $\\triangle APD$ and $\\triangle BPC$.\n(A good diagram should betray this secret;\nall the points are given in the picture.)\nThis makes lots of sense since we know $E$ and $F$\nwill be sent to each other under the spiral similarity too.\n\n\\begin{center}\n\\begin{asy}\nsize(10cm);\npair A = dir(120);\npair D = dir(210);\npair C = dir(330);\npair B = dir(80);\nfilldraw(A--D--B--C--cycle, opacity(0.2)+lightcyan, blue+1.2);\n\npair E = 0.8*B+0.2*C;\npair F = 0.8*D+0.2*A;\n\npair P = extension(A, C, B, D);\npair Q = extension(E, F, B, D);\npair R = extension(E, F, A, C);\n\ndraw(E--F, lightblue);\n\npair M = (A*B-C*D)/(A+B-C-D);\n\nfilldraw(circumcircle(P, Q, R), opacity(0.2)+yellow, red);\ndraw(circumcircle(A, P, D), lightblue);\ndraw(circumcircle(B, P, C), lightblue);\nfilldraw(circumcircle(F, A, R), opacity(0.1)+lightgreen, dotted+heavygreen);\nfilldraw(circumcircle(F, D, Q), opacity(0.1)+lightgreen, dotted+heavygreen);\nfilldraw(circumcircle(E, B, Q), opacity(0.1)+lightgreen, dotted+heavygreen);\nfilldraw(circumcircle(E, C, R), opacity(0.1)+lightgreen, dotted+heavygreen);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$D$\", D, dir(240));\ndot(\"$C$\", C, dir(C));\ndot(\"$B$\", B, dir(B));\ndot(\"$E$\", E, dir(E));\ndot(\"$F$\", F, dir(F));\ndot(\"$P$\", P, 1.8*dir(95));\ndot(\"$Q$\", Q, dir(Q));\ndot(\"$R$\", R, dir(R));\ndot(\"$M$\", M, 1.4*dir(-30));\n\n/* TSQ Source:\n\n!size(10cm);\nA = dir 120\nD = dir 210 R240\nC = dir 330\nB = dir 80\nA--D--B--C--cycle 0.2 lightcyan / blue+1.2\n\nE = 0.8*B+0.2*C\nF = 0.8*D+0.2*A\n\nP = extension A C B D 1.8R95\nQ = extension E F B D\nR = extension E F A C\n\nE--F lightblue\n\nM = (A*B-C*D)/(A+B-C-D) 1.4R-30\n\ncircumcircle P Q R 0.2 yellow / red\ncircumcircle A P D lightblue\ncircumcircle B P C lightblue\ncircumcircle F A R 0.1 lightgreen / dotted heavygreen\ncircumcircle F D Q 0.1 lightgreen / dotted heavygreen\ncircumcircle E B Q 0.1 lightgreen / dotted heavygreen\ncircumcircle E C R 0.1 lightgreen / dotted heavygreen\n\n*/\n\\end{asy}\n\\end{center}\n\nThus $M$ is the Miquel point of complete quadrilateral $FACE$.\nAs $R = \\ol{FE} \\cap \\ol{AC}$ we deduce $FARM$ is a cyclic quadrilateral\n(among many others, but we'll only need one).\n\nNow look at complete quadrilateral $AFQP$.\nSince $M$ lies on $(DFQ)$ and $(RAF)$,\nit follows that $M$ is in fact the Miquel point of $AFQP$ as well.\nSo $M$ lies on $(PQR)$.\n\nThus $M$ is the fixed point that we wanted.\n\n\\begin{remark*}\n  Naturally, the congruent length\n  condition can be relaxed to $DF/DA = BE/BC$.\n\\end{remark*}\n\\pagebreak", "category": "Geometry", "source": "IMO", "year": 2005}
{"id": "imo-2005-q6", "question": "In a mathematical competition $6$ problems were posed to the contestants.\nEach pair of problems was solved by more than $\\frac{2}{5}$ of the contestants.\nNobody solved all 6 problems.\nShow that there were at least $2$ contestants\nwho each solved exactly $5$ problems.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p282141}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nIn a mathematical competition $6$ problems were posed to the contestants.\nEach pair of problems was solved by more than $\\frac{2}{5}$ of the contestants.\nNobody solved all 6 problems.\nShow that there were at least $2$ contestants\nwho each solved exactly $5$ problems.\n\\end{mdframed}\nAssume not and at most one contestant solved five problems.\nBy adding in solves,\nwe can assume WLOG that one contestant solved problems one through five,\nand every other contestant solved four of the six problems.\n\nWe split the remaining contestants based on whether they solved P6.\nLet $a_i$ denote the number of contestants who solved\n$\\{1,2,\\dots,5\\} \\setminus \\{i\\}$ (and missed P6).\nLet $b_{ij}$ denote the number of contestants who solved\n$\\{1,2,\\dots,5,6\\} \\setminus \\{i,j\\}$, for $1 \\le i < j \\le 5$\n(thus in particular they solved P6).\nThus\n\\[ n = 1 + \\sum_{1 \\le i \\le 5} a_i + \\sum_{1 \\le i < j \\le 5} b_{ij} \\]\ndenotes the total number of contestants.\n\nConsidering contestants who solved P1/P6 we have\n\\[ t_1 \\coloneq b_{23} + b_{24} + b_{25} + b_{34} + b_{35} + b_{45} \\ge \\frac25n + \\frac15 \\]\nand we similarly define $t_2$, $t_3$, $t_4$, $t_5$.\n(We have written $\\frac25n+\\frac15$ since we know\nthe left-hand side is an integer strictly larger than $\\frac25n$.)\nAlso, by considering contestants who solved P1/P2 we have\n\\[ t_{12} = 1 + a_{3} + a_{4} + a_{5} + b_{34} + b_{35} + b_{45}\n  \\ge \\frac25n + \\frac15 \\]\nand we similarly define $t_{ij}$ for $1 \\le i < j \\le 5$.\n\n\\begin{claim*}\n  The number $\\frac{2n+1}{5}$ is equal to some integer $k$,\n  fourteen of the $t$'s are equal to $k$,\n  and the last one is equal to $k+1$.\n\\end{claim*}\n\\begin{proof}\nFirst, summing all fifteen equations gives\n  \\begin{align*}\n    6n+4 = 10 + 6(n-1) &= 10\n      + \\sum_{1 \\le i \\le 5} 6a_i + \\sum_{1 \\le i < j \\le 5} 6b_{ij} \\\\\n      &= \\sum_{1 \\le i \\le 5} t_i + \\sum_{1 \\le i < j \\le 5} t_{ij}.\n  \\end{align*}\n  Thus the sum of the $15$ $t$'s is $6n+4$.\n  But since all the $t$'s are integers at least\n  $\\frac{2n+1}{5} = \\frac{6n+3}{15}$, the conclusion follows.\n\\end{proof}\n\nHowever, we will also manipulate the equations to get the following.\n\\begin{claim*}\n  We have\n  \\[ t_{45} \\equiv 1 + t_1 + t_2 + t_3 + t_{12} + t_{23} + t_{31} \\pmod 3. \\]\n\\end{claim*}\n\\begin{proof}\n  This follows directly by computing the coefficient of the $a$'s and $b$'s.\n  We will nonetheless write out a derivation of this equation, to\n  motivate it, but the proof stands without it.\n\n  Let $B = \\sum_{1 \\le i < j \\le 5} b_{ij}$ be the sum of all $b$'s.\n  First, note that\n  \\begin{align*}\n    t_1 + t_2 &= B + b_{34} + b_{45} + b_{35} - b_{12} \\\\\n    &= B + \\left( t_{12}-1-a_3-a_4-a_5 \\right) - b_{12} \\\\\n    \\implies b_{12} &= B - (t_1 + t_2) + t_{12} - 1 - (a_3+a_4+a_5).\n  \\end{align*}\n  This means we have more or less solved for each $b_{ij}$\n  in terms of only $t$ and $a$ variables.\n  Now\n  \\begin{align*}\n    t_{45} &= 1 + a_1 + a_2 + a_3 + b_{12} + b_{23} + b_{31} \\\\\n    &= 1 + a_1 + a_2 + a_3 \\\\\n      &+ [B - (t_1 + t_2) + t_{12} - 1 - (a_3+a_4+a_5)] \\\\\n      &+ [B - (t_2 + t_3) + t_{23} - 1 - (a_1+a_4+a_5)] \\\\\n      &+ [B - (t_3 + t_1) + t_{13} - 1 - (a_2+a_4+a_5)] \\\\\n    &\\equiv 1 + t_1 + t_2 + t_3 + t_{12} + t_{23} + t_{31} \\pmod 3\n  \\end{align*}\n  as desired.\n\\end{proof}\n\nHowever, we now show the two claims are incompatible\n(and this is easy, many ways to do this).\nThere are two cases.\n\\begin{itemize}\n  \\ii Say $t_5 = k+1$ and the others are $k$.\n  Then the equation for $t_{45}$ gives that $k \\equiv 6k+1 \\pmod 3$.\n  But now the equation for $t_{12}$ give $k \\equiv 6k \\pmod 3$.\n  \\ii Say $t_{45} = k+1$ and the others are $k$.\n  Then the equation for $t_{45}$ gives that $k+1 \\equiv 6k \\pmod 3$.\n  But now the equation for $t_{12}$ give $k \\equiv 6k+1 \\pmod 3$.\n\\end{itemize}\n\n\n\\begin{remark*}\n  It is significantly easier to prove that there\n  is at least one contestant who solved five problems.\n  One can see it by dropping the $+10$ in the proof of the claim,\n  and arrives at a contradiction.\n  In this situation it is not even necessary to set up\n  the many $a$ and $b$ variables;\n  just note that the expected number of contestants\n  solving any particular pair of problems is\n  $\\frac{\\binom42n}{\\binom62} = \\frac25n$.\n\n  The fact that $\\frac{2n+1}{5}$\n  should be an integer also follows quickly,\n  since if not one can improve the bound to $\\frac{2n+2}{5}$\n  and quickly run into a contradiction.\n  Again one can get here without setting up $a$ and $b$.\n\n  The main difficulty seems to be the precision required\n  in order to nail down the second $5$-problem solve.\n\\end{remark*}\n\n\\begin{remark*}\n  The second claim may look miraculous,\n  but the proof shows that it is not too unnatural\n  to consider $t_1 + t_2 - t_{12}$ to isolate $b_{12}$\n  in terms of $a$'s and $t$'s.\n  The main trick is: why mod $3$?\n\n  The reason is that if one looks closely, for a\n  fixed $k$ we have a system of $15$ equations in $15$ variables.\n  Unless the determinant $D$ of that system happens to be zero,\n  this means there will be a rational solution in $a$ and $b$,\n  whose denominators are bounded by $D$.\n  However if $p \\mid D$ then we may conceivably run into mod $p$\n  issues.\n\n  This motivates the choice $p = 3$,\n  since it is easy to see the determinant is divisible by $3$,\n  since constant shifts of $\\vec a$ and $\\vec b$ are also solutions mod $3$.\n  (The choice $p = 2$ is a possible guess as well for this reason,\n  but the problem seems to have better $3$-symmetry.)\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Combinatorics", "source": "IMO", "year": 2005}
{"id": "putnam-2014-a1", "question": "Prove that every nonzero coefficient of the Taylor series of\n\\[\n(1 - x + x^2)e^x\n\\]\nabout $x=0$ is a rational number whose numerator (in lowest terms) is either $1$ or a prime number.", "solution": "The coefficient of $x^n$ in the Taylor series of $(1-x+x^2)e^x$ for \n$n=0,1,2$ is $1,0,\\frac{1}{2}$, respectively. For $n\\geq 3$, the coefficient of \n$x^n$ is\n\\begin{align*}\n\\frac{1}{n!} - \\frac{1}{(n-1)!} + \\frac{1}{(n-2)!}\n&= \\frac{1-n+n(n-1)}{n!} \\\\\n&= \\frac{n-1}{n(n-2)!}.\n\\end{align*}\nIf $n-1$ is prime, then the lowest-terms numerator is clearly either 1 or the prime $n-1$ (and in fact the latter, since $n-1$ is relatively prime to $n$ and to $(n-2)!$).\n If $n-1$ is composite,\neither it can be written as $ab$ for some $a \\neq b$, in which case both $a$ and $b$ appear separately in $(n-2)!$ and so the numerator is $1$,\nor $n-1 = p^2$ for some prime $p$, in which case $p$ appears in $(n-2)!$\nand so the numerator is either 1 or $p$. (In the latter case, the numerator is actually 1 unless $p=2$, as in all other cases both $p$ and $2p$ appear in $(n-2)!$.)", "category": "Number Theory", "source": "PUTNAM", "year": 2014}
{"id": "putnam-2014-a2", "question": "Let $A$ be the $n \\times n$ matrix whose entry in the $i$-th row and $j$-th column is\n\\[\n\\frac{1}{\\min(i,j)}\n\\]\nfor $1 \\leq i,j \\leq n$. Compute $\\det(A)$.", "solution": "Let $v_1,\\ldots,v_n$ denote the rows of $A$. The determinant is \nunchanged if we replace $v_n$ by $v_n-v_{n-1}$, and then $v_{n-1}$ by \n$v_{n-1}-v_{n-2}$, and so forth, eventually replacing $v_k$ by \n$v_k-v_{k-1}$ for $k\\geq 2$. Since $v_{k-1}$ and $v_k$ agree in their \nfirst $k-1$ entries, and the $k$-th entry of $v_k-v_{k-1}$ is \n$\\frac{1}{k} - \\frac{1}{k-1}$, the result of these row operations is an upper triangular \nmatrix with diagonal entries $1,\\frac{1}{2}-1,\\frac{1}{3}-\\frac{1}{2},\\ldots,\\frac{1}{n}-\\frac{1}{n-1}$. The \ndeterminant is then\n\\begin{align*}\n\\prod_{k=2}^n \\left( \\frac{1}{k} - \\frac{1}{k-1}\\right) &= \\prod_{k=2}^n \\left(\\frac{-1}{k(k-1)} \\right) \\\\\n&= \n\\frac{(-1)^{n-1}}{(n-1)!n!}.\n\\end{align*}\nNote that a similar calculation can be made whenever $A$ has the form $A_{ij} = \\min\\{a_i, a_j\\}$ for any monotone sequence $a_1,\\dots,a_n$. Note also that the standard Gaussian elimination algorithm leads to the same upper triangular matrix, but the nonstandard order of operations used here makes the computations somewhat easier.\n\n\\noindent\n\\textbf{Remark:}\nThe inverse of $A$ can be identified explicitly: for $n \\geq 2$, it is the matrix $B$ given by\n\\[\nB_{ij} = \\begin{cases} -1 & i=j=1 \\\\\n-2i^2 & 1 < i=j< n \\\\\n-(n-1)n & i=j=n \\\\\nij & |i-j|=1 \\\\\n0 & \\mbox{otherwise.} \\end{cases}\n\\]\nFor example, for $n=5$,\n\\[\nB = \\begin{pmatrix}\n-1 & 2 & 0 & 0 & 0 \\\\\n2 & -8 & 6 & 0 & 0 \\\\\n0 & 6 & -18 & 12 & 0 \\\\\n0 & 0 & 12 & -32 & 20 \\\\\n0 & 0 & 0 & 20 & -20\n\\end{pmatrix}.\n\\]\nLet $C$ denote the matrix obtained from $B$ by replacing the bottom-right entry with $-2n^2$ (for consistency with the rest of the diagonal).\nExpanding in minors along the bottom row produces a second-order recursion for $\\det(C)$ solving to $\\det(C) = (-1)^n (n!)^2$; a similar expansion then yields $\\det(B) = (-1)^{n-1} n! (n-1)!$.\n\n\\noindent\n\\textbf{Remark:}\nThis problem and solution are due to one of us (Kedlaya). The statement appears in the comments on sequence A010790 (i.e., the sequence $(n-1)! n!$)\nin the On-Line Encyclopedia of Integer Sequences (\\url{http://oeis.org}),\nattributed to Benoit Cloitre in 2002.", "category": "Algebra", "source": "PUTNAM", "year": 2014}
{"id": "putnam-2014-a3", "question": "Let $a_0 = 5/2$ and $a_k = a_{k-1}^2 - 2$ for $k \\geq 1$. Compute\n\\[\n\\prod_{k=0}^\\infty \\left(1 - \\frac{1}{a_k} \\right)\n\\]\nin closed form.", "solution": "\\textbf{First solution:}\nUsing the identity\n\\[\n(x + x^{-1})^2 - 2 = x^2 + x^{-2},\n\\]\nwe may check by induction on $k$ that $a_k = 2^{2^k} + 2^{-2^k}$; in particular, the product is absolutely convergent.\nUsing the identities\n\\begin{align*}\n\\frac{x^2 + 1 + x^{-2}}{x + 1 + x^{-1}} &= x  - 1 + x^{-1}, \\\\\n\\frac{x^2 - x^{-2}}{x - x^{-1}} &= x + x^{-1},\n\\end{align*}\nwe may telescope the product to obtain\n\\begin{align*}\n\\prod_{k=0}^\\infty \\left( 1 - \\frac{1}{a_k} \\right)\n&= \\prod_{k=0}^\\infty \\frac{2^{2^k} - 1 + 2^{-2^k}}{2^{2^k} + 2^{-2^k}} \\\\\n&= \\prod_{k=0}^\\infty \\frac{2^{2^{k+1}} + 1 + 2^{-2^{k+1}}}{2^{2^k} + 1 + 2^{-2^k}} \\cdot\n \\frac{2^{2^k} - 2^{-2^k}}{2^{2^{k+1}} - 2^{2^{-k-1}}} \\\\\n&= \\frac{2^{2^0} - 2^{-2^0}}{2^{2^0}+1 + 2^{-2^0}} = \\frac{3}{7}.\n\\end{align*}\n\n\\textbf{Second solution:}\n(by Catalin Zara)\nIn this solution, we do not use the explicit formula for $a_k$.\nWe instead note first that the $a_k$ form an increasing sequence which cannot approach a finite limit (since the equation $L = L^2 - 2$ has no real solution $L>2$), and is thus \nunbounded. Using the identity\n\\[\na_{k+1} + 1 = (a_k - 1)(a_k + 1),\n\\]\none checks by induction on $n$ that\n\\[\n\\prod_{k=0}^n \\left( 1 - \\frac{1}{a_k} \\right)\n= \\frac{2}{7} \\frac{a_{n+1} + 1}{a_0 a_1 \\cdots a_n}.\n\\]\nUsing the identity\n\\[\na_{n+2}^2 - 4 = a_{n+1}^4 - 4 a_{n+1}^2,\n\\]\none also checks by induction on $n$ that\n\\[\na_0 a_1 \\cdots a_n = \\frac{2}{3} \\sqrt{a_{n+1}^2 - 4}.\n\\]\nHence\n\\[\n\\prod_{k=0}^n \\left( 1 - \\frac{1}{a_k} \\right)\n= \\frac{3}{7} \\frac{a_{n+1} + 1}{\\sqrt{a_{n+1}^2 - 4}}\n\\]\ntends to $\\frac{3}{7}$ as $a_{n+1}$ tends to infinity, hence as $n$ tends to infinity.", "category": "Number Theory", "source": "PUTNAM", "year": 2014}
{"id": "putnam-2014-a4", "question": "Suppose $X$ is a random variable that takes on only nonnegative integer values,\nwith $E\\left[ X \\right] = 1$, $E\\left[ X^2 \\right] = 2$, and $E \\left[ X^3 \\right] = 5$.\n(Here $E\\left[ y \\right]$ denotes the expectation of the random variable $Y$.)\nDetermine the smallest possible value of the probability of the event $X=0$.", "solution": "The answer is $\\frac{1}{3}$.\n\n\\textbf{First solution:}\nLet $a_n = P(X=n)$; we want the minimum value for $a_0$. If we write \n$S_k = \\sum_{n=1}^\\infty n^k a_n$, then the given expectation values \nimply that $S_1 = 1$, $S_2 = 2$, $S_3 = 5$. Now\ndefine $f(n) = 11n-6n^2+n^3$, and note that $f(0) = 0$, $f(1)=f(2)=f(3)=6$, and \n$f(n)>6$ for $n\\geq 4$; thus\n$4 = 11S_1-6S_2+S_3 = \\sum_{n=1}^\\infty f(n)a_n \\geq 6 \\sum_{n=1}^{\\infty} a_n$. \nSince $\\sum_{n=0}^\\infty a_n = 1$, it \nfollows that $a_0 \\geq \\frac{1}{3}$. Equality is achieved \nwhen $a_0=\\frac{1}{3}$, $a_1=\\frac{1}{2}$, $a_3=\\frac{1}{6}$, and $a_n = 0$ for all other $n$, \nand so the answer is $\\frac{1}{3}$.\n\n\\textbf{Second solution:}\n(by Tony Qiao)\nDefine the \\emph{probability generating function} of $P$ as the power series\n\\[\nG(z) = \\sum_{n=0}^\\infty P(x = n) z^n.\n\\]\nWe compute that $G(1) = G'(1) = G''(1) = G'''(1) = 1$. By Taylor's theorem with remainder,\nfor any $x \\in [0,1]$, there exists $c \\in [x,1]$ such that\n\\[\nG(x) = 1 + (x-1) + \\frac{(x-1)^2}{2!} + \\frac{(x-1)^3}{3!} + \\frac{G''''(c)}{4!} (x-1)^4.\n\\]\nIn particular, $G(0) = \\frac{1}{3} + \\frac{1}{24} G''''(c)$ for some $c \\in [0,1]$.\nHowever, since $G$ has nonnegative coefficients and $c \\geq 0$, we must have $G''''(c) \\geq 0$,\nand so $G(0) \\geq \\frac{1}{3}$. As in the first solution, we see that this bound is best possible.", "category": "Algebra", "source": "PUTNAM", "year": 2014}
{"id": "putnam-2014-a5", "question": "Let\n\\[\nP_n(x) = 1 + 2 x  + 3 x^2 + \\cdots + n x^{n-1}.\n\\]\nProve that the polynomials $P_j(x)$\nand $P_k(x)$ are relatively prime\nfor all positive integers $j$ and $k$ with $j \\neq k$.", "solution": "\\textbf{First solution:}\nSuppose to the contrary that there exist positive integers $i \\neq j$ and a complex number $z$ such that $P_i(z) = P_j(z) = 0$. Note that $z$ cannot be a nonnegative real number or else $P_i(z), P_j(z) > 0$; we may put $w = z^{-1} \\neq 0,1$. For $n \\in \\{i+1,j+1\\}$ we compute that\n\\[\nw^n = n w - n + 1,\n\\qquad \\overline{w}^n =  n \\overline{w} - n + 1;\n\\]\nnote crucially that these equations also hold for $n \\in \\{0,1\\}$.\nTherefore, the function $f: [0, +\\infty) \\to \\RR$ given by\n\\[\nf(t) = \\left| w \\right|^{2t} - t^2 \\left| w \\right|^2 + 2t(t-1)\\mathrm{Re}(w) - (t-1)^2\n\\]\nsatisfies $f(t) = 0$ for $t \\in \\{0,1,i+1,j+1\\}$. On the other hand, for all $t \\geq 0$ we have\n\\[\nf'''(t) = (2 \\log \\left| w \\right|)^3 \\left| w \\right|^{2t} > 0,\n\\]\nso by Rolle's theorem, the equation $f^{(3-k)}(t) = 0$ has at most $k$ distinct solutions for $k=0,1,2,3$. This yields the desired contradiction.\n\n\\noindent\n\\textbf{Remark:}\nBy similar reasoning, an equation of the form $e^{x} = P(x)$ in which $P$ is a real polynomial of degree $d$ has at most $d+1$ real solutions. This turns out to be closely related to a concept in mathematical logic known as \\emph{o-minimality}, which in turn has deep consequences for the solution of Diophantine equations.\n\n\\noindent\n\\textbf{Second solution:}\n\\setcounter{lemma}{0}\n(by Noam Elkies)\nWe recall a result commonly known as the \\emph{Enestr\\\"om-Kakeya theorem}.\n\\begin{lemma}\nLet \n\\[\nf(x) = a_0 + a_1 x + \\cdots + a_n x^n\n\\]\nbe a polynomial with real coefficients such that $0 < a_0 \\leq a_1 \\leq \\cdots \\leq a_n$.\nThen every root $z \\in \\CC$ of $f$ satisfies $|z| \\leq 1$.\n\\end{lemma}\n\\begin{proof}\nIf $f(z) = 0$, then we may rearrange the equality $0 = f(z)(z-1)$ to obtain\n\\[\na_n z^{n+1} = (a_n - a_{n-1}) z^n + \\cdots + (a_1 - a_0)z + a_0.\n\\]\nBut if $|z| > 1$, then \n\\[\n|a_n z^{n+1}| \\leq (|a_n - a_{n-1}| + \\cdots + |a_1 - a_0|) |z|^{n}\n\\leq |a_n z^{n}|,\n\\]\ncontradiction.\n\\end{proof}\n\\begin{cor}\nLet \n\\[\nf(x) = a_0 + a_1 x + \\cdots + a_n x^n\n\\]\nbe a polynomial with positive real coefficients. Then every root $z \\in \\CC$ of $f$ satisfies $r \\leq |z| \\leq R$ for\n\\begin{align*}\nr &= \\min\\{a_0/a_1, \\dots, a_{n-1}/a_n\\} \\\\\nR &= \\max\\{a_0/a_1, \\dots, a_{n-1}/a_n\\}.\n\\end{align*}\n\\end{cor}\n\\begin{proof}\nThe bound $|z| \\leq R$ follows by applying the lemma to the polynomial $f(x/R)$.\nThe bound $|z| \\geq r$ follows by applying the lemma to the reverse of the polynomial $f(x/r)$.\n\\end{proof}\nSuppose now that $P_i(z) = P_j(z) = 0$ for some $z \\in \\CC$ and some integers $i < j$. \nWe clearly cannot have $j = i+1$, as then $P_i(0) \\neq 0$ and so $P_j(z) - P_i(z) = (i+1) z^i \\neq 0$; we thus have $j-i \\geq 2$.\nBy applying Corollary~2 to $P_i(x)$, we see that $|z| \\leq 1 - \\frac{1}{i}$. On the other hand, by applying Corollary~2 to $(P_j(x) - P_i(x))/x^{i-1}$, we see that $|z| \\geq 1 - \\frac{1}{i+2}$, contradiction.\n\n\\noindent\n\\textbf{Remark:} Elkies also reports that this problem is his submission, dating back to 2005 and arising from work of Joe Harris.\nIt dates back further to Example 3.7 in: Hajime Kaji,\nOn the tangentially degenerate curves,\n\\textit{J. London Math. Soc. (2)} \\textbf{33} (1986), 430--440, in which the second solution is given.\n\n\\noindent\n\\textbf{Remark:}\nElkies points out a mild generalization which may be treated using the first solution but not the second: for integers $a<b<c<d$ and $z \\in \\CC$\nwhich is neither zero nor a root of unity, the matrix\n\\[\n\\begin{pmatrix}\n1 & 1 & 1 & 1 \\\\\na & b & c & d \\\\\nz^a & z^b & z^c & z^d\n\\end{pmatrix}\n\\]\nhas rank 3 (the problem at hand being the case $a=0, b=1, c=i+1, d=j+1$).\n\n\\noindent\n\\textbf{Remark:}\nIt seems likely that the individual polynomials $P_k(x)$ are all irreducible, but this appears difficult to prove.\n\n\\noindent\n\\textbf{Third solution:}\n(by David Feldman)\nNote that\n\\[\nP_n(x)(1-x) = 1 + x + \\cdots + x^{n-1} - nx^n.\n\\]\nIf $|z| \\geq 1$, then\n\\[\nn|z|^n \\geq |z|^{n-1} + \\cdots + 1 \\geq |z^{n-1} + \\cdots + 1|,\n\\]\nwith the first equality occurring only if $|z| = 1$ and the second equality occurring only if $z$ is a positive real number. Hence the equation $P_n(z)(1-z) = 0$ has no solutions  with $|z| \\geq 1$ other than the trivial solution $z=1$. Since\n\\[\nP_n(x)(1-x)^2 = 1 - (n+1) x^n + nx^{n+1},\n\\]\nit now suffices to check that the curves\n\\[\nC_n = \\{ z \\in \\CC: 0 < |z| < 1, \\left| z \\right|^n \\left| n+1 - zn \\right| = 1 \\}\n\\]\nare pairwise disjoint as $n$ varies over positive integers.\n\nWrite $z = u+iv$; we may assume without loss of generality that $v \\geq 0$.\nDefine the function\n\\[\nE_z(n) = n \\log |z| + \\log |n+1-zn|.\n\\]\nOne computes that for $n \\in \\RR$, $E_z''(n) < 0$ if and only if\n\\[\n\\frac{u-v-1}{(1-u)^2 + v^2} < n <\n\\frac{u+v-1}{(1-u)^2 + v^2}.\n\\]\nIn addition, $E_z(0) = 0$ and \n\\[\nE_z'(0) = \\frac{1}{2} \\log (u^2+v^2) + (1-u) \\geq \\log (u) + 1 - u \\geq 0\n\\]\nsince $\\log(u)$ is concave. From this, it follows that the equation $E_z(n) = 0$\ncan have at most one solution with $n>0$.\n\n\\noindent\n\\textbf{Remark:}\nThe reader may notice a strong similarity between this solution and the first solution. The primary difference is we compute that $E'_z(0) \\geq 0$ instead of discovering that $E_z(-1) = 0$.\n\n\\noindent\n\\textbf{Remark:}\nIt is also possible to solve this problem using a $p$-adic valuation on the field of algebraic numbers in place of the complex absolute value; however, this leads to a substantially more complicated solution. In lieu of including such a solution here,\nwe refer to the approach described by Victor Wang \nhere: \\url{http://www.artofproblemsolving.com/Forum/viewtopic.php?f=80&t=616731}.", "category": "Algebra", "source": "PUTNAM", "year": 2014}
{"id": "putnam-2014-a6", "question": "Let $n$ be a positive integer. What is the largest $k$ for which there exist $n \\times n$ matrices $M_1, \\dots, M_k$ and $N_1, \\dots, N_k$ with real entries such that for all $i$ and $j$, the matrix product $M_i N_j$ has a zero entry somewhere on its diagonal if and only if $i \\neq j$?", "solution": "The largest such $k$ is $n^n$. We first show that this value can be achieved by an explicit construction.\nLet $e_1,\\dots,e_n$ be the standard basis of $\\RR^n$.\nFor $i_1,\\dots,i_n \\in \\{1,\\dots,n\\}$, let $M_{i_1,\\dots,i_n}$ be the matrix with row vectors $e_{i_1},\\dots,e_{i_n}$, and let $N_{i_1,\\dots,i_n}$ be the transpose of $M_{i_1,\\dots,i_n}$. Then $M_{i_1,\\dots,i_n} N_{j_1,\\dots,j_n}$ has $k$-th diagonal entry $e_{i_k} \\cdot e_{j_k}$, proving the claim.\n\nWe next show that for any families of matrices $M_i, N_j$ as described, we must have $k \\leq n^n$.\nLet $V$ be the \\emph{$n$-fold tensor product} of $\\RR^n$, i.e., the vector space with  orthonormal basis\n$e_{i_1} \\otimes \\cdots \\otimes e_{i_n}$ for $i_1,\\dots,i_n \\in \\{1,\\dots,n\\}$.\nLet $m_i$ be the tensor product of the rows of $M_i$; that is,\n\\[\nm_i = \\sum_{i_1,\\dots,i_n=1}^n (M_i)_{1,i_1} \\cdots (M_i)_{n,i_n} e_{i_1} \\otimes \\cdots \\otimes e_{i_n}.\n\\]\nSimilarly, let $n_j$ be the tensor product of the columns of $N_j$. One computes easily that $m_i \\cdot n_j$ equals the product of the diagonal entries of $M_i N_j$,\nand so vanishes if and only if $i \\neq j$. For any $c_i \\in \\RR$ such that $\\sum_i c_i m_i = 0$, for each $j$ we have \n\\[\n0 = \\left(\\sum_i c_i m_i\\right) \\cdot n_j = \\sum_i c_i (m_i \\cdot n_j) = c_j.\n\\]\nTherefore the vectors $m_1,\\dots,m_k$ in $V$ are linearly independent, implying $k \\leq n^n$ as desired.\n\n\\noindent\n\\textbf{Remark:}\nNoam Elkies points out that similar argument may be made in the case that the $M_i$ are $m \\times n$ matrices and the $N_j$ are $n \\times m$ matrices.", "category": "Combinatorics", "source": "PUTNAM", "year": 2014}
{"id": "putnam-2014-b1", "question": "A \\emph{base $10$ over-expansion} of a positive integer $N$ is an expression of the form\n\\[\nN = d_k 10^k + d_{k-1} 10^{k-1} + \\cdots + d_0 10^0\n\\]\nwith $d_k \\neq 0$ and $d_i \\in \\{0,1,2,\\dots,10\\}$ for all $i$.\nFor instance, the integer $N = 10$ has two base 10 over-expansions: $10 = 10 \\cdot 10^0$\nand the usual base 10 expansion $10 = 1 \\cdot 10^1 + 0 \\cdot 10^0$.\nWhich positive integers have a unique base 10 over-expansion?", "solution": "These are the integers with no $0$'s in their usual base $10$ expansion. If the usual base $10$ expansion of $N$ is $d_k 10^k + \\cdots + d_0 10^0$ and one of the digits is $0$, then there exists an $i \\leq k-1$ such that $d_i = 0$ and $d_{i+1} > 0$; then we can replace $d_{i+1} 10^{i+1} + (0) 10^i$ by $(d_{i+1}-1) 10^{i+1} + (10) 10^i$ to obtain a second base $10$ over-expansion.\n\nWe claim conversely that if $N$ has no $0$'s in its usual base $10$ expansion, then this standard form is the unique base $10$ over-expansion for $N$. This holds by induction on the number of digits of $N$: if $1\\leq N\\leq 9$, then the result is clear. Otherwise, any base $10$ over-expansion $N = d_k 10^k + \\cdots + d_1 10 + d_0 10^0$ must have $d_0 \\equiv N \\pmod{10}$, which uniquely determines $d_0$ since $N$ is not a multiple of $10$; then $(N-d_0)/10$ inherits the base $10$ over-expansion $d_k 10^{k-1} + \\cdots + d_1 10^0$, which must be unique by the induction hypothesis.\n\n\\noindent\n\\textbf{Remark:}\nKarl Mahlburg suggests an alternate proof of uniqueness (due to Shawn Williams):\nwrite the usual expansion $N = d_k 10^k + \\cdots + d_0 10^0$ and suppose $d_i \\neq 0$ for all $i$. Let $M = c_l 10^l + \\cdots + c_0 10^0$ be an over-expansion with at least one 10. To have $M = N$, we must have $l \\leq k$; we may pad the expansion of $M$ with zeroes to force $l=k$. Now define $e_i = c_i - d_i$; since $1 \\leq d_i \\leq 9$ and $0 \\leq c_i \\leq 10$,\nwe have $0 \\leq |e_i| \\leq 9$. Moreover, there exists at least one index $i$ with $e_i \\neq 0$, since any index for which $c_i = 10$ has this property. But if $i$ is the largest such index, we have \n\\begin{align*}\n10^i &\\leq \\left| e_i 10^i \\right| = \\left| -\\sum_{j=0}^{i-1} e_i 10^i \\right| \\\\\n&\\leq \\sum_{j=0}^{i-1} \\left| e_i| 10^i \\right| \\leq 9 \\cdot 10^{i-1} + \\cdots + 9 \\cdot 10^0,\n\\end{align*}\na contradiction.", "category": "Number Theory", "source": "PUTNAM", "year": 2014}
{"id": "putnam-2014-b2", "question": "Suppose that $f$ is a function on the interval $[1,3]$ such that $-1 \\leq f(x) \\leq 1$ for all $x$ and $\\int_1^3 f(x)\\,dx = 0$. How large can $\\int_1^3 \\frac{f(x)}{x}\\,dx$ be?\n\n\\,", "solution": "In all solutions, we assume that the function $f$ is integrable.\n\n\\textbf{First solution:}\nLet $g(x)$ be $1$ for $1\\leq x\\leq 2$ and $-1$ for $2<x\\leq 3$, and \ndefine $h(x)=g(x)-f(x)$. Then $\\int_1^3 h(x)\\,dx = 0$ and $h(x) \\geq 0$ \nfor $1\\leq x\\leq 2$, $h(x) \\leq 0$ for $2<x\\leq 3$. Now\n\\begin{align*}\n\\int_1^3 \\frac{h(x)}{x}\\,dx & = \\int_1^2 \\frac{|h(x)|}{x}\\,dx - \\int_2^3 \n\\frac{|h(x)|}{x}\\,dx\\\\\n&\\geq \\int_1^2 \\frac{|h(x)|}{2}\\,dx - \\int_2^3 \\frac{|h(x)|}{2}\\,dx = 0,\n\\end{align*}\nand thus $\\int_1^3 \\frac{f(x)}{x}\\,dx \\leq \\int_1^3 \\frac{g(x)}{x}\\,dx = \n2\\log 2-\\log 3 = \\log \\frac{4}{3}$. Since $g(x)$ achieves the upper bound, the answer is \n$\\log \\frac{4}{3}$.\n\n\\noindent\n\\textbf{Reformulation:}\n(by Karl Mahlburg and Karthik Adimurthi) \nSince $f$ is integrable, it can be expressed in terms of the Hadamard basis\n\\begin{align*}\nH_0(x) &= \\begin{cases} 1 & x \\in [1,2) \\\\\n-1 & x \\in [2,3] \\\\\n0 & x \\notin [1,3] \\end{cases} \\\\\nH_{n+1}(x) &= H_n( 2(x-1) + 1) + H_n( 2(x-2) + 1).\n\\end{align*}\nMore precisely, we have $f(x) = \\sum_n c_n H_n(x)$ for some $c_n$ \nwith $|c_0| + |c_1| + |\\cdots| \\leq 1$. Let $g_n = \\int_1^3 (H_n(x) / x)\\,dx$; \nit is easy to show that the $g_n$ are strictly decreasing in $n$. \nThus \\[\n\\int_1^3 (f(x) / x) dx = c_0 g_0 +\nc_1 g_1 + \\cdots \\leq 1 \\cdot g_0 = \\log \\frac{4}{3}.\n\\] \n\n\\noindent\n\\textbf{Second solution:}\n(Art of Problem Solving, user \\verb+libra_gold+)\nDefine the function $F(x) = \\int_1^x f(t)\\,dt$ for $1 \\leq x \\leq 3$; then $F(1) = F(3) = 0$ and $F(x) \\leq \\min\\{x-1,3-x\\}$. Using integration by parts, we obtain\n\\begin{align*}\n\\int_1^3 \\frac{f(x)}{x}\\,dx &= \\int_1^3 \\frac{F(x)}{x^2}\\,dx \\\\\n&\\leq \\int_1^2 \\frac{x-1}{x^2}\\,dx + \\int_2^3 \\frac{3-x}{x^2}\\,dx \\\\\n&= \\log \\frac{4}{3}.\n\\end{align*}\n(Some minor adjustment is needed to make this completely rigorous, e.g., approximating $f$ uniformly by continuous functions.)", "category": "Algebra", "source": "PUTNAM", "year": 2014}
{"id": "putnam-2014-b3", "question": "Let $A$ be an $m \\times n$ matrix with rational entries.\nSuppose that there are at least $m+n$ distinct prime numbers among the absolute values of the entries of $A$. Show that the rank of $A$ is at least 2.", "solution": "\\textbf{First solution:}\nAssume by way of contradiction that $A$ has rank at most 1;\nin this case, we can find rational numbers $a_1,\\dots,a_m$, $b_1,\\dots,b_n$ such that\n$A_{ij} = a_i b_j$ for all $i,j$. By deleting rows or columns, we may reduce to the case where the $a_i$'s and $b_j$'s are all nonzero.\n\nRecall that any nonzero rational number $q$ has a unique prime factorization\n\\[\nq = \\pm 2^{c_1} 3^{c_2} 5^{c_3} \\cdots\n\\]\nwith exponents in $\\ZZ$. Set\n\\[\nc(q) = (c_1, c_2, c_3, \\dots).\n\\]\nNote that $|a_i b_j|$ is prime if and only if $c(a_i) + c(b_j)$ has one entry equal to 1 and all others equal to 0. The condition that $m+n$ distinct primes appear in the matrix implies that the vector space \n\\[\n\\left\\{ \\sum_i x_i c(a_i) + \\sum_j y_i c(b_j) : x_i, y_j \\in \\RR, \\sum_i x_i = \\sum_j y_j \\right\\} \n\\]\ncontains a linearly independent set of size $m+n$. But that space evidently has dimension at most $m+n-1$, contradiction.\n\n\\textbf{Second solution:}\nIn this solution, we use standard terminology of graph theory, considering only simple undirected graphs (with no self-loops or multiple edges).\nWe first recall the quick induction proof that that a graph on $k$ vertices\n with no cycles contains at most $k-1$ edges: for $k=1$, the claim is trivially true because there can be no edges.\nFor $k>1$, choose any vertex $v$ and let $d$ be its degree. Removing the vertex $v$ and the edges incident to it leaves a disjoint union of $d$ different graphs, each having no cycles. If the numbers of vertices in these graphs are $k_1,\\dots,k_d$, by induction the total number of edges in the original graph is at most $(k_1 - 1) + \\cdots + (k_d - 1) + d = k - 1$.\n\nReturning to the original problem, suppose that $A$ has rank at most 1.\nDraw a bipartite graph whose vertices correspond to the rows and columns of $A$, with an edge joining a particular row and column if the entry where they intersect has prime absolute value. By the previous paragraph, this graph must contain a cycle. Since the graph is bipartite, this cycle must be of length $2k$ for some integer $k \\geq 2$ (we cannot have $k=1$ because the graph has no repeated edges). Without loss of generality, we may assume that the cycle consists of row 1, column 1, row 2, column 2, and so on. There must then exist distinct prime numbers $p_1, \\dots, p_{2k}$ such that\n\\[\n\\left| A_{11} \\right| = p_1, \\left| A_{21} \\right| = p_2, \\dots,\n\\left| A_{kk} \\right| = p_{2k-1}, \\left| A_{1k} \\right| = p_{2k}.\n\\]\nHowever, since $A$ has rank 1, the $2 \\times 2$ minor $A_{11} A_{ij} - A_{i1} A_{1j}$ must vanish for all $i,j$. If we put $r_i = \\left|A_{i1} \\right|$ and $c_j = \\left| A_{ij}/A_{11} \\right|$, we have\n\\begin{align*}\np_1 \\cdots p_{2k} &= (r_1 c_1)(r_2 c_1) \\cdots (r_k c_k) (r_1 c_k) \\\\\n&= (r_1 c_1 \\cdots r_k c_k)^2,\n\\end{align*}\nwhich contradicts the existence of unique prime factorizations for positive rational numbers: the prime $p_1$ occurs with exponent 1 on the left, but with some even exponent on the right. This contradiction completes the proof.", "category": "Algebra", "source": "PUTNAM", "year": 2014}
{"id": "putnam-2014-b4", "question": "Show that for each positive integer $n$, all the roots of the polynomial\n\\[\n\\sum_{k=0}^n 2^{k(n-k)} x^k\n\\]\nare real numbers.", "solution": "Define the polynomial $f_n(x) = \\sum_{k=0}^n 2^{k(n-k)} x^k$.\nSince\n\\[\nf_1(x) = 1+x, f_2(x) = 1 + 2x + x^2 = (1+x)^2,\n\\]\nthe claim holds for for $n=1,2$. For $n \\geq 3$, we show that the quantities\n\\[\nf_n(-2^{-n}), f_n(-2^{-n+2}), \\dots, f_n(-2^n)\n\\]\nalternate in sign; by the intermediate value theorem, this will imply that $f_n$ has a root in each of the $n$ intervals $(- 2^{-n}, - 2^{-n+2}), \\dots, (- 2^{n-2}, -2^n)$,\nforcing $f_n$ to have as many distinct real roots as its degree.\n\nFor $j \\in \\{0,\\dots,n\\}$, group the terms of $f_n(x)$ as\n\\begin{align*}\n&\\cdots \\\\\n&+ 2^{(j-5)(n-j+5)} x^{j-5} + 2^{(j-4)(n-j+4)} x^{j-4} \\\\\n&+ 2^{(j-3)(n-j+3)} x^{j-3} + 2^{(j-2)(n-j+2)} x^{j-2} \\\\\n&+ 2^{(j-1)(n-j+1)} x^{j-1} + 2^{j(n-j)} x^j + 2^{(j+1)(n-j-1)} x^{j+1} \\\\\n&+  2^{(j+2)(n-j-2)} x^{j+2} + 2^{(j+3)(n-j-3)} x^{j+3} \\\\\n&+2^{(j+4)(n-j-4)} x^{j+4} + 2^{(j+5)(n-j-5)} x^{j+5} \\\\\n& \\cdots.\n\\end{align*}\n\nDepending on the parity of $j$ and of $n-j$, there may be a single monomial left on each end. When evaluating at $x =- 2^{-n+2j}$,\nthe trinomial evaluates to $0$. In the binomials preceding the trinomial, the right-hand term dominates, so each of these binomials contributes with the sign of $x^{j-2k}$, which is $(-1)^j$. In the binomials following the trinomial, the left-hand term dominates, so again the contribution has sign $(-1)^j$.\n\nAny monomials which are left over on the ends also contribute with sign $(-1)^j$. Since $n \\geq 3$, there exists at least one contribution other than the trinomial, so $f_n(- 2^{-n+2j})$ has overall sign $(-1)^j$, proving the claimed alternation.\n\n\\noindent\n\\textbf{Remark:} Karl Mahlburg suggests an alternate interpretation of the preceding algebra: write $2^{-j^2} f_n(2^{-n+2j})$ as\n\\begin{align*}\n&2^{-j^2} - 2^{-(j-1)^2} + \\cdots + (-1)^{j-1} 2^{-1} + (-1)^j 2^{-1}\\\\\n+ &(-1)^j 2^{-1} + (-1)^{j+1} 2^{-1} + (-1)^{j+2} 2^{-2} + \\cdots,\n\\end{align*}\nwhere the two central terms $(-1)^j 2^{-1}$ arise from splitting the term arising from $x^j$. Then each row is an alternating series whose sum carries the sign of $(-1)^j$ unless it has only two terms. Since $n \\geq 3$, one of the two sums is forced to be nonzero.\n\n\\noindent\n\\textbf{Remark:} One of us (Kedlaya) received this problem and solution from David Speyer in 2009 and submitted it to the problem committee.", "category": "Algebra", "source": "PUTNAM", "year": 2014}
{"id": "putnam-2014-b5", "question": "In the 75th annual Putnam Games, participants compete at mathematical games.\nPatniss and Keeta play a game in which they take turns choosing an element \nfrom the group of invertible $n \\times n$ matrices with entries in the field\n$\\mathbb{Z}/p \\mathbb{Z}$ of integers modulo $p$, where $n$ is a fixed positive integer and $p$ is a fixed prime number. The rules of the game are:\n\\begin{enumerate}", "solution": "We show that Patniss wins if $p=2$ and Keeta wins if $p>2$ (for all $n$).\nWe first analyze the analogous game played using an arbitrary finite group $G$.\nRecall that for any subset $S$ of $G$, the set of elements $g \\in G$ which commute with all elements of $S$ forms a subgroup $Z(S)$ of $G$, called the \\emph{centralizer} (or \\emph{commutant}) of $S$. \nAt any given point in the game, the set $S$ of previously chosen elements is contained in $Z(S)$. Initially $S = \\emptyset$ and $Z(S) = G$;\nafter each turn, $S$ is increased by one element and $Z(S)$ is replaced by a subgroup.\nIn particular, if the order of $Z(S)$ is odd at some point, it remains odd thereafter;\nconversely, if $S$ contains an element of even order, then the order of $Z(S)$ remains even thereafter. Therefore, any element $g \\in G$ for which $Z(\\{g\\})$ has odd order is a winning first move for Patniss, while any other first move by Patniss loses if Keeta responds with some $h \\in Z(\\{g\\})$ of even order (e.g., an element of a 2-Sylow subgroup of $Z(\\{g\\})$). In both cases, the win is guaranteed no matter what moves follow.\n\nNow let $G$ be the group of invertible $n \\times n$ matrices with entries in $\\ZZ/p\\ZZ$.\nIf $p>2$, then $Z(S)$ will always contain the scalar matrix $-1$ of order 2, so the win for Keeta is guaranteed. (An explicit winning strategy is to answer any move $g$ with the move $-g$.)\n\nIf $p=2$, we establish the existence of $g \\in G$ such that $Z(\\{g\\})$ has odd order\nusing the existence of an irreducible polynomial $P(x)$ of degree $n$ over $\\ZZ/p\\ZZ$ (see remark). We construct an $n \\times n$ matrix over $\\ZZ/p\\ZZ$ with characteristic polynomial $P(x)$ by taking the \\emph{companion matrix} of $P(x)$: write $P(x) = x^n + P_{n-1} x^{n-1} + \\cdots + P_0$ and set\n\\[\ng = \\begin{pmatrix}\n0 & 0 & \\cdots & 0 & -P_0 \\\\\n1 & 0 & \\cdots & 0 & -P_1 \\\\\n0 & 1 & \\cdots & 0 & -P_2 \\\\\n\\vdots & \\vdots & \\ddots & \\vdots & \\vdots \\\\\n0 & 0 & \\cdots & 1 & -P_{n-1}\n\\end{pmatrix}.\n\\]\nIn particular, $\\det(g) = (-1)^n P_0 \\neq 0$, so $g \\in G$.\nOver an algebraic closure of $\\ZZ/p \\ZZ$, $g$ becomes diagonalizable with distinct eigenvalues, so any matrix commuting with $g$ must also be diagonalizable, and hence of odd order. In particular, $Z(\\{g\\})$ is of odd order, so Patniss has a winning strategy.\n\n\\noindent\n\\textbf{Remark:}\nIt can be shown that in the case $p=2$, the only elements $g \\in G$ for which $Z(\\{g\\})$ has odd order are those for which $g$ has distinct eigenvalues: in any other case, $Z(\\{g\\})$ contains a subgroup isomorphic to the group of $k \\times k$ invertible matrices over $\\ZZ/2\\ZZ$ for some $k>1$, and this group has order $(2^k-1)(2^k-2) \\cdots(2^k - 2^{k-1})$.\n\n\\noindent\n\\textbf{Remark:}\nWe sketch two ways to verify the existence of an irreducible polynomial of degree $n$ over $\\ZZ/p\\ZZ$ for any positive integer $n$ and any prime number $p$. One is to use M\\\"obius inversion to count the number of irreducible polynomials of degree $n$ over $\\ZZ/p\\ZZ$ and then give a positive lower bound for this count. The other is to first establish the existence of a finite field $\\FF$ of cardinality $p^n$, e.g., as the set of roots of the polynomial $x^{p^n}-1$ inside a splitting field, and then take the minimal polynomial of a nonzero element of $\\FF$ over $\\ZZ/p\\ZZ$ which is a primitive $(p^n-1)$-st root of unity in $\\FF$ (which exist because the multiplicative group of $\\FF$ contains at most one cyclic subgroup of any given order). One might be tempted to apply the primitive element theorem for $\\FF$ over $\\ZZ/p\\ZZ$, but in fact one of the preceding techniques is needed in order to verify this result for finite fields, as the standard argument that ``most'' elements of the upper field are primitive breaks down for finite fields.\n\nOne may also describe the preceding analysis in terms of an identification of $\\FF$ as a $\\ZZ/p\\ZZ$-vector space with the space of column vectors of length $n$. Under such an identification, if we take $g$ to be an element of $\\FF - \\{0\\}$ generating this group, then any element of $Z(\\{g\\})$ commutes with all of $\\FF- \\{0\\}$ and hence must define an $\\FF$-linear endomorphism of $\\FF$. Any such endomorphism is itself multiplication by an element of $\\FF$, so $Z(\\{g\\})$ is identified with the multiplicative group of $\\FF$, whose order is the odd number $2^n-1$.", "category": "Algebra", "source": "PUTNAM", "year": 2014}
{"id": "putnam-2014-b6", "question": "Let $f: [0,1] \\to \\mathbb{R}$ be a function for which there exists a constant $K>0$\nsuch that $\\left| f(x) - f(y) \\right| \\leq K \\left| x - y \\right|$ for all $x,y \\in [0,1]$.\nSuppose also that for each rational number $r \\in [0,1]$, there exist integers $a$ and $b$\nsuch that $f(r) = a + br$. Prove that there exist finitely many intervals $I_1, \\dots, I_n$\nsuch that $f$ is a linear function on each $I_i$ and $[0,1] = \\bigcup_{i=1}^n I_i$. \n\n\\end{itemize}\n\n\\end{document}", "solution": "Let us say that a linear function $g$ on an interval is \\emph{integral} if it has the form\n$g(x) = a + bx$ for some $a,b \\in \\ZZ$, and that a piecewise linear function is \\emph{integral} if on every interval where it is linear, it is also integral.\n\nFor each positive integer $n$, define the $n$-th \\emph{Farey sequence} $F_n$ as the sequence of rational numbers in $[0,1]$ with denominators at most $n$.\nIt is easily shown by induction on $n$ that any two consecutive elements $\\frac{r}{s}, \\frac{r'}{s'}$ of $F_n$, written in lowest terms, satisfy $\\gcd(s,s') = 1$, $s+s' > n$, and $r's - r s' = 1$. Namely, this is obvious for $n=1$ because $F_1 = \\frac{0}{1}, \\frac{1}{1}$. To deduce the claim for $F_n$ from the claim for $F_{n-1}$, let $\\frac{r}{s}, \\frac{r'}{s'}$ be consecutive elements of $F_{n-1}$. If $s+s' = n$, then for $m = r+r'$ we have $\\frac{r}{s} < \\frac{m}{n} < \\frac{r'}{s'}$ and the pairs $\\frac{r}{s},\\frac{m}{n}$ and $\\frac{m}{n}, \\frac{r'}{s'}$ \nsatisfy the desired conditions. Conversely, if $s+s' > n$, then we cannot have $\\frac{r}{s} < \\frac{m}{n} < \\frac{r'}{s'}$ for $a \\in \\ZZ$, as this yields the contradiction\n\\[\nn =(ms - nr)s' + (r'n - ms') \\geq s+s' > n;\n\\]\nhence $\\frac{r}{s}, \\frac{r'}{s'}$ remain consecutive in $F_n$. \n\nLet $f_n: [0,1] \\to \\RR$ be the piecewise linear function which agrees with $f$ at each element of $F_n$ and is linear between any two consecutive elements of $F_n$.\nBetween any two consecutive elements $\\frac{r}{s}, \\frac{r'}{s'}$ of $F_n$,\n$f_n$ coincides with some linear function $a+bx$. Since $s f(\\frac{r}{s}), s' f(\\frac{r'}{s'}) \\in \\ZZ$, we deduce first that\n\\[\nb = ss' (f(\\frac{r'}{s'}) - f(\\frac{r}{s}))\n\\]\nis an integer of absolute value at most $K$,\nand second that both $as = s f(\\frac{r}{s}) - br$ and $as' = s' f(\\frac{r'}{s'}) - br'$ are integral. It follows that $f_n$ is integral.\n\nWe now check that if $n > 2K$, then $f_n = f_{n-1}$. \nFor this, it suffices to check that for any consecutive elements $\\frac{r}{s}, \\frac{m}{n}, \\frac{r'}{s'}$ in $F_n$, the linear function $a_0 + b_0 x$ matching $f_{n-1}$ from $\\frac{r}{s}$ to $\\frac{r'}{s'}$ has the property that $f(\\frac{m}{n}) = a_0 + b_0 \\frac{m}{n}$. Define the integer $t = nf(\\frac{m}{n}) - a_0 n - b_0 m$. \nWe then compute that the slope of $f_n$ from $\\frac{r}{s}$ to $\\frac{m}{n}$ is $b_0+st$,\nwhile the slope of $f_n$ from $\\frac{m}{n}$ to $\\frac{r'}{s'}$ is at most $b_0 -s't$.\nIn order to have $\\left| b_0 + s t\\right|, \\left| b_0 - s' t\\right| \\leq K$, we must have\n$(s+s') \\left| t \\right| \\leq 2K$; since $s+s' = n > 2K$, this is only possible if $t=0$.\nHence $f_n = f_{n-1}$, as claimed.\n\nIt follows that for any $n > 2K$, we must have $f_n = f_{n+1} = \\cdots$. Since the condition on $f$ and $K$ implies that $f$ is continuous, we must also have $f_n = f$, completing the proof.\n\n\\noindent\n\\textbf{Remark:}\nThe condition on $f$ and $K$ is called \\emph{Lipschitz continuity}.\n\n\\noindent\n\\textbf{Remark:}\nAn alternate approach is to prove that for each $x  \\in [0,1)$, there exists $\\epsilon  \\in (0, 1-x)$ such that the restriction of $f$ to $[x, x+\\epsilon)$ is linear;\none may then deduce the claim using the compactness of $[0,1]$. In this approach, the role of the Farey sequence may also be played by the convergents of the continued fraction of $x$ (at least in the case where $x$ is irrational).\n\n\\noindent\n\\textbf{Remark:} This problem and solution are due to one of us (Kedlaya). Some related results can be proved with the Lipschitz continuity condition replaced by suitable convexity conditions.\n See for example: Kiran S. Kedlaya and Philip Tynan,\nDetecting integral polyhedral functions, \\textit{Confluentes Mathematici}\n\\textbf{1} (2009), 87--109.\nSuch results arise in the theory of $p$-adic differential equations; see for example:\nKiran S. Kedlaya and Liang Xiao, Differential modules on $p$-adic polyannuli, \\textit{J. Inst. Math. Jusssieu} \\textbf{9} (2010), 155--201 (errata, \\textit{ibid.}, 669--671).\n\n\\end{itemize}\n\\end{document}", "category": "Geometry", "source": "PUTNAM", "year": 2014}
{"id": "putnam-2011-a1", "question": "Define a \\textit{growing spiral} in the plane to be a sequence\nof points with integer coordinates $P_0 = (0,0), P_1, \\dots, P_n$ such\nthat $n \\geq 2$ and:\n\\begin{itemize}", "solution": "We claim that the set of points with $0\\leq x\\leq 2011$ and $0\\leq\ny\\leq 2011$ that cannot be the last point of a growing spiral are as follows:\n$(0,y)$ for $0\\leq y\\leq 2011$; $(x,0)$ and $(x,1)$ for $1\\leq x\\leq 2011$;\n$(x,2)$ for $2\\leq x\\leq 2011$; and $(x,3)$ for $3\\leq x\\leq 2011$. This\ngives a total of\n\\[\n2012 + 2011 + 2011 + 2010 + 2009 = 10053\n\\]\nexcluded points.\n\nThe complement of this set is the set of $(x,y)$ with $0<x<y$, along with\n$(x,y)$ with $x \\geq y \\geq 4$. Clearly the former set is achievable as\n$P_2$ in a growing spiral, while a point $(x,y)$ in the latter set is $P_6$\nin a growing spiral with successive lengths $1$, $2$, $3$, $x+1$, $x+2$,\nand $x+y-1$.\n\nWe now need to rule out the other cases. Write $x_1<y_1<x_2<y_2<\\ldots$\nfor the lengths of the line segments in the spiral in order, so that $P_1 =\n(x_1,0)$, $P_2 = (x_1,y_1)$, $P_3 = (x_1-x_2,y_1)$, and so forth. Any point\nbeyond $P_0$ has $x$-coordinate of the form $x_1-x_2+\\cdots+(-1)^{n-1}\nx_n$ for $n\\geq 1$; if $n$ is odd, we can write this as $x_1 + (-x_2+x_3)\n+ \\cdots + (-x_{n-1}+x_n) > 0$, while if $n$ is even, we can write this as\n$(x_1-x_2) + \\cdots + (x_{n-1}-x_n) < 0$. Thus no point beyond $P_0$ can have\n$x$-coordinate $0$, and we have ruled out $(0,y)$ for $0\\leq y\\leq 2011$.\n\nNext we claim that any point beyond $P_3$ must have $y$-coordinate either\nnegative or $\\geq 4$. Indeed, each such point has $y$-coordinate of the\nform $y_1-y_2+\\cdots+(-1)^{n-1} y_n$ for $n \\geq 2$, which we can write\nas $(y_1-y_2) + \\cdots + (y_{n-1}-y_n) < 0$ if $n$ is even, and\n\\[\ny_1 +(-y_2+y_3) + \\cdots + (-y_{n-1}+y_n) \\geq y_1 + 2 \\geq 4\n\\]\nif $n \\geq 3$\nis odd. Thus to rule out the rest of the forbidden points, it suffices to\ncheck that they cannot be $P_2$ or $P_3$ for any growing spiral. But none\nof them can be $P_3 = (x_1-x_2,y_1)$ since $x_1-x_2<0$, and none of them\ncan be $P_2 = (x_1,y_1)$ since they all have $y$-coordinate at most equal\nto their $x$-coordinate.", "category": "Geometry", "source": "PUTNAM", "year": 2011}
{"id": "putnam-2011-a2", "question": "Let $a_1,a_2,\\dots$ and $b_1,b_2,\\dots$ be sequences of positive\nreal numbers such that $a_1 = b_1 = 1$ and $b_n = b_{n-1} a_n - 2$ for\n$n=2,3,\\dots$. Assume that the sequence $(b_j)$ is bounded. Prove that\n\\[\nS = \\sum_{n=1}^\\infty \\frac{1}{a_1...a_n}\n\\]\nconverges, and evaluate $S$.", "solution": "For $m\\geq 1$, write\n\\[\nS_m = \\frac{3}{2}\\left(1 - \\frac{b_1\\cdots b_m}{(b_1+2)\\cdots(b_m+2)}\\right).\n \\]\nThen $S_1 = 1 = 1/a_1$ and a quick calculation yields\n\\[\nS_m-S_{m-1} = \\frac{b_1\\cdots b_{m-1}}{(b_2+2)\\cdots(b_m+2)} = \\frac{1}{a_1\\cdots a_m}\n\\]\nfor $m\\geq 2$, since $a_j = (b_j+2)/b_{j-1}$ for $j \\geq 2$. It follows\nthat $S_m = \\sum_{n=1}^m 1/(a_1\\cdots a_n)$.\n\nNow if $(b_j)$ is bounded above by $B$, then $\\frac{b_j}{b_j+2}\n\\leq \\frac{B}{B+2}$ for all $j$, and so $3/2 > S_m \\geq\n3/2(1-(\\frac{B}{B+2})^m)$. Since $\\frac{B}{B+2} < 1$, it follows that the\nsequence $(S_m)$ converges to $S = 3/2$.", "category": "Number Theory", "source": "PUTNAM", "year": 2011}
{"id": "putnam-2011-a3", "question": "Find a real number $c$ and a positive number $L$ for which\n\\[\n\\lim_{r\\to\\infty} \\frac{r^c \\int_0^{\\pi/2} x^r \\sin x \\,dx}{\\int_0^{\\pi/2} x^r \\cos x \\,dx} = L.\n\\]", "solution": "We claim that $(c,L) = (-1,2/\\pi)$ works.\nWrite $f(r) = \\int_0^{\\pi/2} x^r\\sin x\\,dx$. Then\n\\[\nf(r)  < \\int_0^{\\pi/2} x^r\\,dx = \\frac{(\\pi/2)^{r+1}}{r+1}\n\\]\nwhile since $\\sin x \\geq 2x/\\pi$ for $x \\leq \\pi/2$,\n\\[\nf(r) > \\int_0^{\\pi/2} \\frac{2x^{r+1}}{\\pi} \\,dx = \\frac{(\\pi/2)^{r+1}}{r+2}.\n\\]\nIt follows that\n\\[\n\\lim_{r\\to\\infty} r \\left(\\frac{2}{\\pi}\\right)^{r+1} f(r) = 1,\n\\]\nwhence\n\\[\n\\lim_{r\\to\\infty} \\frac{f(r)}{f(r+1)} = \\lim_{r\\to\\infty}\n\\frac{r(2/\\pi)^{r+1}f(r)}{(r+1)(2/\\pi)^{r+2}f(r+1)} \\cdot\n\\frac{2(r+1)}{\\pi r} = \\frac{2}{\\pi}.\n\\]\n\nNow by integration by parts, we have\n\\[\n\\int_0^{\\pi/2} x^r\\cos x\\,dx = \\frac{1}{r+1} \\int_0^{\\pi/2} x^{r+1} \\sin x\\,dx\n    = \\frac{f(r+1)}{r+1}.\n\\]\nThus setting $c = -1$ in the given limit yields\n\\[\n\\lim_{r\\to\\infty} \\frac{(r+1)f(r)}{r f(r+1)} =\n\\frac{2}{\\pi},\n\\]\nas desired.", "category": "Algebra", "source": "PUTNAM", "year": 2011}
{"id": "putnam-2011-a4", "question": "For which positive integers $n$ is there an $n \\times n$ matrix\nwith integer entries such that every dot product of a row with itself is\neven, while every dot product of two different rows is odd?", "solution": "The answer is $n$ odd. Let $I$ denote the $n\\times n$ identity\nmatrix, and let $A$ denote the $n\\times n$ matrix all of whose entries\nare $1$. If $n$ is odd, then the matrix $A-I$ satisfies the conditions of\nthe problem: the dot product of any row with itself is $n-1$, and the dot\nproduct of any two distinct rows is $n-2$.\n\nConversely, suppose $n$ is even, and suppose that the matrix $M$ satisfied\nthe conditions of the problem. Consider all matrices and vectors mod\n$2$. Since the dot product of a row with itself is equal mod $2$ to the\nsum of the entries of the row, we have $M v = 0$ where $v$ is the vector\n$(1,1,\\ldots,1)$, and so $M$ is singular. On the other hand, $M M^T =\nA-I$; since\n\\[\n(A-I)^2 = A^2-2A+I = (n-2)A+I = I,\n\\]\nwe have $(\\det M)^2 = \\det(A-I) = 1$ and $\\det M = 1$, contradicting the\nfact that $M$ is singular.", "category": "Algebra", "source": "PUTNAM", "year": 2011}
{"id": "putnam-2011-a5", "question": "Let $F : \\RR^2 \\to \\RR$ and $g : \\RR \\to \\RR$ be twice\ncontinuously differentiable functions with the following properties:\n\\begin{itemize}", "solution": "(by Abhinav Kumar) Define $G : \\RR \\to \\RR$ by $G(x) = \\int_0^x\ng(t)\\,dt$. By assumption, $G$ is a strictly increasing, thrice continuously\ndifferentiable function. It is also bounded: for $x>1$, we have\n\\[\n0 < G(x)-G(1) = \\int_1^x g(t)\\,dt \\leq \\int_1^x dt/t^2 = 1,\n\\]\nand similarly, for $x<-1$, we have $0 > G(x)-G(-1) \\geq -1$.\nIt follows that the image of $G$ is some open interval $(A,B)$\nand that $G^{-1}: (A,B) \\to \\RR$ is also thrice continuously differentiable.\n\nDefine $H: (A,B) \\times (A,B) \\to \\RR$ by $H(x,y) = F(G^{-1}(x), G^{-1}(y))$;\nit is twice continuously differentiable since $F$ and $G^{-1}$ are.\nBy our assumptions about $F$,\n\\begin{multline*}\n\\frac{\\partial H}{\\partial x} + \\frac{\\partial H}{\\partial y} =\n    \\frac{\\partial F}{\\partial x}(G^{-1}(x), G^{-1}(y))\n    \\cdot \\frac{1}{g(G^{-1}(x))}\\\\\n    + \\frac{\\partial F}{\\partial y}(G^{-1}(x), G^{-1}(y))\n    \\cdot \\frac{1}{g(G^{-1}(y))} = 0.\n\\end{multline*}\nTherefore $H$ is constant along any line parallel to the vector $(1,1)$,\nor equivalently, $H(x,y)$ depends only on $x-y$. We may thus write $H(x,y) =\nh(x-y)$ for some function $h$ on $(-(B-A), B-A)$, and we then have $F(x,y)\n= h(G(x) - G(y))$.  Since $F(u,u) = 0$, we have $h(0) = 0$. Also, $h$\nis twice continuously differentiable (since it can be written as $h(x)\n= H((A+B+x)/2,(A+B-x)/2)$), so $|h'|$ is bounded on the closed interval $[-(B-A)/2,\n(B-A)/2]$, say by $M$.\n\nGiven $x_1,\\dots,x_{n+1} \\in \\RR$ for some $n \\geq 2$, the numbers\n$G(x_1),\\dots,G(x_{n+1})$ all belong to $(A,B)$, so we can choose indices\n$i$ and $j$ so that $|G(x_i) - G(x_j)| \\leq (B-A)/n \\leq (B-A)/2$.  By the\nmean value theorem,\n\n\\[\n|F(x_i, x_j)| = |h(G(x_i) - G(x_j))| \\leq M \\frac{B-A}{n},\n\\]\nso the claim holds with $C = M(B-A)$.", "category": "Geometry", "source": "PUTNAM", "year": 2011}
{"id": "putnam-2011-a6", "question": "Let $G$ be an abelian group with $n$ elements, and let\n\\[ \\{g_1=e,g_2,\\dots,g_k\\} \\subsetneqq G \\]\nbe a (not necessarily minimal) set of distinct generators of $G$. A special\ndie, which randomly selects one of the elements $g_1,g_2,...,g_k$ with equal\nprobability, is rolled $m$ times and the selected elements are multiplied\nto produce an element $g \\in G$.  Prove that there exists a real number\n$b \\in (0,1)$ such that\n\n\\[ \\lim_{m\\to\\infty} \\frac{1}{b^{2m}} \\sum_{x\\in G} \\left(\\mathrm{Prob}(g=x)\n    - \\frac{1}{n}\\right)^2 \\]\nis positive and finite.", "solution": "Choose some ordering $h_1,\\dots, h_n$ of the elements of $G$ with $h_1 = e$.\nDefine an $n \\times n$ matrix $M$\nby settting $M_{ij} = 1/k$ if $h_j = h_i g$ for some $g \\in \\{g_1,\\dots,g_k\\}$ and $M_{ij} = 0$ otherwise.\nLet $v$ denote the column vector $(1,0,\\dots,0)$. The probability\nthat the product of $m$ random elements of $\\{g_1,\\dots,g_k\\}$\nequals $h_i$ can then be interpreted as the $i$-th component of the vector\n$M^m v$.\n\nLet $\\hat{G}$ denote the dual group of $G$, i.e., the group of complex-valued characters of $G$.\nLet $\\hat{e} \\in \\hat{G}$ denote the trivial character.\nFor each $\\chi \\in \\hat{G}$, the vector $v_\\chi = (\\chi(h_i))_{i=1}^n$ is an eigenvector of $M$\nwith eigenvalue $\\lambda_\\chi = (\\chi(g_1) + \\cdots + \\chi(g_k))/k$.\nIn particular, $v_{\\hat{e}}$ is the all-ones vector and $\\lambda_{\\hat{e}} = 1$.\nPut\n\\[\nb = \\max\\{|\\lambda_\\chi|: \\chi \\in \\hat{G} - \\{\\hat{e}\\}\\};\n\\]\nwe show that $b \\in (0,1)$ as follows.\nFirst suppose $b=0$; then\n\\[\n1 = \\sum_{\\chi \\in \\hat{G}} \\lambda_\\chi\n= \\frac{1}{k} \\sum_{i=1}^k \\sum_{\\chi \\in \\hat{G}} \\chi(g_i) = \\frac{n}{k}\n\\]\nbecause $\\sum_{\\chi \\in \\hat(G)} \\chi(g_i)$ equals $n$ for $i=1$ and $0$ otherwise.\nHowever, this contradicts the hypothesis that $\\{g_1, \\dots, g_k\\}$ is not all of $G$.\nHence $b > 0$. Next suppose $b=1$, and choose $\\chi \\in \\hat{G} - \\{\\hat{e}\\}$ with $|\\lambda_\\chi| = 1$.\nSince each of\n$\\chi(g_1), \\dots, \\chi(g_k)$ is a complex number of norm 1, the triangle inequality forces them all to be equal.\nSince $\\chi(g_1) = \\chi(e) = 1$, $\\chi$ must map each of $g_1,\\dots, g_k$ to 1, but this is impossible because\n$\\chi$ is a nontrivial character and $g_1,\\dots,g_k$ form a set of generators of $G$.\nThis contradiction yields $b < 1$.\n\nSince $v = \\frac{1}{n} \\sum_{\\chi \\in \\hat{G}} v_\\chi$\nand $M v_\\chi = \\lambda_\\chi v_\\chi$, we have\n\\[\nM^m v - \\frac{1}{n} v_{\\hat{e}}\n= \\frac{1}{n} \\sum_{\\chi \\in \\hat{G} - \\{\\hat{e}\\}} \\lambda_\\chi^m v_\\chi.\n\\]\nSince the vectors $v_\\chi$ are pairwise orthogonal,\nthe limit we are interested in can be written as\n\\[\n\\lim_{m \\to \\infty} \\frac{1}{b^{2m}} (M^m v - \\frac{1}{n} v_{\\hat{e}}) \\cdot (M^m v - \\frac{1}{n} v_{\\hat{e}}).\n\\]\nand then rewritten as\n\\[\n\\lim_{m \\to \\infty} \\frac{1}{b^{2m}} \\sum_{\\chi \\in \\hat{G} - \\{\\hat{e}\\}} |\\lambda_\\chi|^{2m}\n= \\#\\{\\chi \\in \\hat{G}: |\\lambda_\\chi| = b\\}.\n\\]\nBy construction, this last quantity is nonzero and finite.\n\n\n\\textbf{Remark.}\nIt is easy to see that the result fails if we do not assume $g_1 = e$: take $G = \\ZZ/2\\ZZ$,\n$n=1$, and $g_1 = 1$.\n\n\\textbf{Remark.}\nHarm Derksen points out that a similar argument applies even if $G$ is not assumed to be abelian,\nprovided that the operator $g_1 + \\cdots + g_k$ in the group algebra $\\ZZ[G]$ is \\emph{normal},\ni.e., it commutes with the operator $g_1^{-1} + \\cdots + g_k^{-1}$.\nThis includes the cases where the set $\\{g_1,\\dots,g_k\\}$ is closed under taking inverses\nand where it is a union of conjugacy classes (which in turn includes the case of $G$ abelian).\n\n\\textbf{Remark}.\nThe matrix $M$ used above has nonnegative entries with row sums equal to 1 (i.e., it corresponds to a Markov chain), and there exists a positive integer $m$ such that $M^m$ has positive entries. For any such matrix,\nthe Perron-Frobenius theorem implies that\nthe sequence of vectors $M^m v$ converges to a limit $w$, and there exists $b \\in [0,1)$\nsuch that\n\\[\n\\limsup_{m \\to \\infty} \\frac{1}{b^{2m}} \\sum_{i=1}^n ((M^m v - w)_i)^2\n\\]\nis nonzero and finite. (The intended interpretation in case $b=0$ is that $M^m v = w$ for all large $m$.)\nHowever, the limit need not exist in general.", "category": "Algebra", "source": "PUTNAM", "year": 2011}
{"id": "putnam-2011-b1", "question": "Let $h$ and $k$ be positive integers. Prove that for every\n$\\epsilon > 0$, there are positive integers $m$ and $n$ such that\n\\[ \\epsilon < |h \\sqrt{m} - k \\sqrt{n}| < 2\\epsilon.  \\]", "solution": "Since the rational numbers are dense in the reals, we can find positive integers $a,b$\nsuch that\n\\[\n\\frac{3\\epsilon}{hk} < \\frac{b}{a}\n< \\frac{4\\epsilon}{hk}.\n\\]\nBy multiplying $a$ and $b$ by a suitably large positive integer, we can also ensure that $3a^2 > b$. We then have\n\\[\n\\frac{\\epsilon}{hk} < \\frac{b}{3a} < \\frac{b}{\\sqrt{a^2+b} + a} = \\sqrt{a^2+b} - a\n\\]\nand\n\\[\n\\sqrt{a^2+b} - a = \\frac{b}{\\sqrt{a^2+b} + a} \\leq \\frac{b}{2a} < 2 \\frac{\\epsilon}{hk}.\n\\]\nWe may then take $m = k^2 (a^2+b), n = h^2 a^2$.", "category": "Number Theory", "source": "PUTNAM", "year": 2011}
{"id": "putnam-2011-b2", "question": "Let $S$ be the set of all ordered triples $(p,q,r)$ of prime\nnumbers for which at least one rational number $x$ satisfies $px^2 + qx +\nr =0$. Which primes appear in seven or more elements of $S$?", "solution": "Only the primes 2 and 5 appear seven or more times.\nThe fact that these primes appear is demonstrated by the examples\n\\[\n(2,5,2), (2, 5, 3),  (2, 7, 5), (2, 11, 5)\n\\]\nand their reversals.\n\nIt remains to show that if either $\\ell=3$ or $\\ell$ is a prime greater than 5, then $\\ell$ occurs at most six times\nas an element of a triple in $S$.\nNote that $(p,q,r) \\in S$ if and only if\n$q^2 - 4pr = a^2$ for some integer $a$; in particular, since $4pr \\geq 16$, this forces $q \\geq 5$.\nIn particular, $q$ is odd, as then is $a$, and so $q^2 \\equiv a^2 \\equiv 1 \\pmod{8}$;\nconsequently, one of $p,r$ must equal 2. If $r=2$, then $8p = q^2-a^2 = (q+a)(q-a)$; since both factors\nare of the same sign and their sum is the positive number $2q$, both factors are positive.\nSince they are also both even, we have $q+a \\in \\{2, 4, 2p, 4p\\}$ and so\n$q \\in \\{2p+1, p+2\\}$. Similarly, if $p=2$, then $q \\in \\{2r+1, r+2\\}$.\nConsequently, $\\ell$ occurs at most twice as many times as there are prime numbers in the list\n\\[\n2\\ell+1, \\ell+2, \\frac{\\ell-1}{2}, \\ell-2.\n\\]\nFor $\\ell = 3$,$\\ell-2= 1$ is not prime.\nFor $\\ell \\geq 7$, the numbers $\\ell-2, \\ell, \\ell+2$ cannot all be prime,\nsince one of them is always a nontrivial multiple of 3.\n\n\\textbf{Remark.}\nThe above argument shows that the cases listed for 5 are the only ones that can occur. By contrast,\nthere are infinitely many cases where 2 occurs if either the twin prime conjecture holds or there are\ninfinitely many Sophie Germain primes (both of which are expected to be true).", "category": "Number Theory", "source": "PUTNAM", "year": 2011}
{"id": "putnam-2011-b3", "question": "Let $f$ and $g$ be (real-valued) functions defined on an open\ninterval containing $0$, with $g$ nonzero and continuous at $0$.  If $fg$\nand $f/g$ are differentiable at $0$, must $f$ be differentiable at 0?", "solution": "Yes, it follows that $f$ is differentiable.\n\n\\noindent\n\\textbf{First solution.}\nNote first that at $0$, $f/g$ and $g$ are both continuous, as then is their product $f$.\nIf $f(0) \\neq 0$, then in some neighborhood of $0$, $f$ is either always positive or always\nnegative. We can thus choose $\\epsilon \\in \\{\\pm 1\\}$ so that\n$\\epsilon f$ is the composition of the differentiable function\n$(fg)\\cdot (f/g)$ with the square root function. By the chain rule, $f$ is differentiable at $0$.\n\nIf $f(0) = 0$, then $(f/g)(0) = 0$, so we have\n\\[\n(f/g)'(0) = \\lim_{x \\to 0}\n\\frac{f(x)}{x g(x)}.\n\\]\nSince $g$ is continuous at 0, we may multiply limits to deduce that $\\lim_{x \\to 0} f(x)/x$ exists.\n\n\\noindent\n\\textbf{Second solution.}\nChoose a neighborhood $N$ of $0$ on which $g(x) \\neq 0$.\nDefine the following functions on $N \\setminus \\{0\\}$:\n$h_1(x) = \\frac{f(x)g(x)-f(0)g(0)}{x}$;\n$h_2(x) = \\frac{f(x)g(0)-f(0)g(x)}{xg(0)g(x)}$;\n$h_3(x) = g(0)g(x)$;\n$h_4(x) = \\frac{1}{g(x)+g(0)}$. Then\nby assumption, $h_1,h_2,h_3,h_4$ all have limits as $x \\to 0$. On the\nother hand,\n\\[\n\\frac{f(x)-f(0)}{x} = (h_1(x)+h_2(x)h_3(x))h_4(x),\n\\]\nand it follows that $\\lim_{x\\to 0} \\frac{f(x)-f(0)}{x}$ exists, as desired.", "category": "Algebra", "source": "PUTNAM", "year": 2011}
{"id": "putnam-2011-b4", "question": "In a tournament, 2011 players meet 2011 times to play a\nmultiplayer game. Every game is played by all 2011 players together and\nends with each of the players either winning or losing. The standings\nare kept in two $2011 \\times 2011$ matrices, $T = (T_{hk})$ and $W =\n(W_{hk})$. Initially, $T=W=0$. After every game, for every $(h,k)$ (including\nfor $h=k$), if players $h$ and $k$ tied (that is, both won or both lost),\nthe entry $T_{hk}$ is increased by 1, while if player $h$ won and player $k$\nlost, the entry $W_{hk}$ is increased by 1 and $W_{kh}$ is decreased by 1.\n\nProve that at the end of the tournament, $\\det(T+iW)$ is a non-negative\ninteger divisible by $2^{2010}$.", "solution": "Number the games $1,\\ldots,2011$, and let $A = (a_{jk})$ be the $2011 \\times 2011$ matrix whose $jk$ entry is $1$ if player $k$ wins game $j$ and $i = \\sqrt{-1}$ if player $k$ loses game $j$. Then $\\overline{a_{hj}}a_{jk}$ is $1$ if players $h$ and $k$ tie in game $j$; $i$ if player $h$ wins and player $k$ loses in game $j$; and $-i$ if $h$ loses and $k$ wins. It follows that $T + i W = \\overline{A}^T A$.\n\nNow the determinant of $A$ is unchanged if we subtract the first row of $A$ from each of the other rows, producing a matrix whose rows, besides the first one, are $(1-i)$ times a row of integers. Thus we can write $\\det A = (1-i)^{2010}(a+bi)$ for some integers $a,b$. But then\n$\\det(T+iW) = \\det(\\overline{A}^T A) = 2^{2010}(a^2+b^2)$ is a nonnegative integer multiple of $2^{2010}$, as desired.", "category": "Algebra", "source": "PUTNAM", "year": 2011}
{"id": "putnam-2011-b5", "question": "Let $a_1, a_2, \\dots$ be real numbers. Suppose that there is\na constant $A$ such that for all $n$,\n\\[\n\\int_{-\\infty}^\\infty \\left( \\sum_{i=1}^n \\frac{1}{1 + (x-a_i)^2} \\right)^2\\,dx \\leq An.\n\\]\nProve there is a constant $B>0$ such that for all $n$,\n\\[\n\\sum_{i,j=1}^n (1 + (a_i - a_j)^2) \\geq Bn^3.\n\\]", "solution": "Define the function\n\\[\nf(y) =\n\\int_{-\\infty}^\\infty \\frac{dx}{(1+x^2)(1+(x+y)^2)}.\n\\]\nFor $y \\geq 0$, in the range $-1 \\leq x \\leq 0$,\nwe have\n\\begin{align*}\n(1+x^2)(1+(x+y)^2) &\\leq (1+1)(1+(1+y)^2) = 2y^2+4y+4 \\\\\n&\\leq 2y^2+4+2(y^2+1) \\leq 6+6y^2.\n\\end{align*}\nWe thus have the lower bound\n\\[\nf(y) \\geq \\frac{1}{6(1+y^2)};\n\\]\nthe same bound is valid for $y \\leq 0$ because $f(y) = f(-y)$.\n\nThe original hypothesis can be written as\n\\[\n\\sum_{i,j=1}^n f(a_i - a_j) \\leq An\n\\]\nand thus\nimplies that\n\\[\n\\sum_{i,j=1}^n \\frac{1}{1 + (a_i-a_j)^2} \\leq 6An.\n\\]\nBy the Cauchy-Schwarz inequality, this implies\n\\[\n\\sum_{i,j=1}^n (1 + (a_i-a_j)^2) \\geq Bn^3\n\\]\nfor $B = 1/(6A)$.\n\n\\textbf{Remark.}\nOne can also compute explicitly (using partial fractions, Fourier transforms, or contour integration)\nthat $f(y) = \\frac{2\\pi}{4 + y^2}$.\n\n\\textbf{Remark.}\nPraveen Venkataramana points out that the lower bound can be improved to $Bn^4$\nas follows. For each $z \\in \\ZZ$, put $Q_{z,n} = \\{i\\in \\{1,\\dots,n\\}: a_i \\in [z, z+1)\\}$ and $q_{z,n} = \\#Q_{z,n}$. Then\n$\\sum_z q_{z,n} = n$ and\n\\[\n6An \\geq \\sum_{i,j=1}^n \\frac{1}{1 + (a_i-a_j)^2} \\geq \\sum_{z \\in \\ZZ} \\frac{1}{2} q_{z,n}^2.\n\\]\nIf exactly $k$ of the $q_{z,n}$ are nonzero, then $\\sum_{z \\in \\ZZ} q_{z,n}^2 \\geq n^2/k$ by Jensen's inequality\n(or various other methods), so we must have $k \\geq n/(6A)$. Then\n\\begin{align*}\n\\sum_{i,j=1}^n (1 + (a_i-a_j)^2) &\\geq\nn^2 + \\sum_{i,j=1}^k \\max\\{0, (|i-j|-1)^2\\} \\\\\n&\\geq\nn^2 + \\frac{k^4}{6}-\\frac{2k^3}{3}+\\frac{5k^2}{6}-\\frac{k}{3}.\n\\end{align*}\nThis is bounded below by $Bn^4$ for some $B>0$.\n\nIn the opposite direction, one can weaken the initial upper bound to $An^{4/3}$ and still\nderive a lower bound of $Bn^3$. The argument is similar.", "category": "Geometry", "source": "PUTNAM", "year": 2011}
{"id": "putnam-2011-b6", "question": "Let $p$ be an odd prime. Show that for at least $(p+1)/2$ values of $n$ in $\\{0,1,2,\\dots,p-1\\}$,\n\\[\n\\sum_{k=0}^{p-1} k! n^k \\qquad \\mbox{is not divisible by $p$.}\n\\]\n\n\\end{itemize}\n\n\\end{document}", "solution": "In order to interpret the problem statement, one must choose a convention for the value of $0^0$; we will take\nit to equal 1. (If one takes $0^0$ to be 0, then the problem fails for $p=3$.)\n\n\\textbf{First solution.}\nBy Wilson's theorem,\n\\[\nk! (p-1-k)! \\equiv (-1)^{k} (p-1)! \\equiv (-1)^{k+1} \\pmod{p},\n\\]\nso we have a congruence of Laurent polynomials\n\\begin{align*}\n\\sum_{k=0}^{p-1} k! x^k &\\equiv \\sum_{k=0}^{p-1} \\frac{(-1)^{k+1} x^k}{(p-1-k)!} \\pmod{p} \\\\\n&\\equiv -x^{p-1} \\sum_{k=0}^{p-1} \\frac{(-x)^{-k}}{k!} \\pmod{p}.\n\\end{align*}\nReplacing $x$ with $-1/x$, we reduce the original problem to showing that the polynomial\n\\[\ng(x) = \\sum_{k=0}^{p-1} \\frac{x^k}{k!}\n\\]\nover $\\FF_p$ has at most $(p-1)/2$ nonzero roots in $\\FF_p$. To see this, write\n\\[\nh(x) = x^p - x + g(x)\n\\]\nand note that by Wilson's theorem again,\n\\[\nh'(x) = 1 + \\sum_{k=1}^{p-1} \\frac{x^{k-1}}{(k-1)!} = x^{p-1} - 1 + g(x).\n\\]\nIf $z \\in \\FF_p$ is such that $g(z) = 0$, then $z \\neq 0$ because $g(0) = 1$.\nTherefore, $z^{p-1} = 1$, so $h(z) = h'(z) = 0$ and so $z$ is at least a double root of $h$.\nSince $h$ is a polynomial of degree $p$, there can be at most $(p-1)/2$ zeroes of $g$ in $\\FF_p$, as desired.\n\n\\noindent\n\\textbf{Second solution.} (By Noam Elkies)\nDefine the polynomial $f$ over $\\FF_p$ by\n\\[\nf(x) = \\sum_{k=0}^{p-1} k! x^k.\n\\]\nPut $t = (p-1)/2$; the problem statement is that $f$\nhas at most $t$ roots modulo $p$.\nSuppose the contrary; since $f(0) = 1$,\nthis means that $f(x)$ is nonzero for at most $t-1$ values of $x \\in \\FF_p^*$.\nDenote these values by $x_1,\\dots,x_m$, where by assumption $m < t$, and define the polynomial\n$Q$ over $\\FF_p$ by\n\\[\nQ(x) =\n\\prod_{k=1}^m (x - x_m) = \\sum_{k=0}^{t-1} Q_k x^k.\n\\]\nThen we can write\n\\[\nf(x) = \\frac{P(x)}{Q(x)} (1-x^{p-1})\n\\]\nwhere $P(x)$ is some polynomial of degree at most $m$.\nThis means that the power series expansions of $f(x)$ and $P(x)/Q(x)$ coincide modulo $x^{p-1}$,\nso the coefficients of $x^t, \\dots, x^{2t-1}$ in $f(x) Q(x)$ vanish.\nIn other words, the product of the square matrix\n\\[\nA = ((i+j+1)!)_{i,j=0}^{t-1}\n\\]\nwith the nonzero column vector $(Q_{t-1}, \\dots, Q_0)$ is zero.\nHowever, by the following lemma, $\\det(A)$ is nonzero modulo $p$, a contradiction.\n\n\\begin{lemma}\nFor any nonnegative integer $m$ and any integer $n$,\n\\[\n\\det((i+j+n)!)_{i,j=0}^m = \\prod_{k=0}^m k! (k+n)!.\n\\]\n\\end{lemma}\n\\begin{proof}\nDefine the $(m+1) \\times (m+1)$ matrix $A_{m,n}$ by $(A_{m,n})_{i,j} = \\binom{i+j+n}{i}$;\nthe desired result is then that $\\det(A_{m,n}) = 1$. Note that\n\\[\n(A_{m,n-1})_{ij} = \\begin{cases}\n(A_{m,n})_{ij} & i=0 \\\\\n(A_{m,n})_{ij} - (A_{m,n})_{(i-1)j} & i > 0;\n\\end{cases}\n\\]\nthat is, $A_{m,n-1}$ can be obtained from $A_{m,n}$ by elementary row operations.\nTherefore, $\\det(A_{m,n}) = \\det(A_{m,n-1})$, so $\\det(A_{m,n})$ depends only on $m$.\nThe claim now follows by observing that $A_{0,0}$ is the $1 \\times 1$ matrix with entry 1\nand that $A_{m,-1}$ has the block representation $\\begin{pmatrix} 1 & * \\\\ 0 & A_{m-1,0} \\end{pmatrix}$.\n\\end{proof}\n\n\\noindent\n\\textbf{Remark.}\nElkies has given a more detailed discussion of the origins of this solution in the theory of orthogonal\npolynomials; see \\texttt{http://mathoverflow.net/questions/82648}.\n\n\n\\end{itemize}\n\\end{document}", "category": "Number Theory", "source": "PUTNAM", "year": 2011}
{"id": "usamo-2006-q1", "question": "Let $p$ be a prime number and let $s$ be an integer with $0 < s < p$.\nProve that there exist integers $m$ and $n$ with $0 < m < n < p$ and\n\\[ \\left \\{\\frac{sm}{p} \\right\\} < \\left \\{\\frac{sn}{p} \\right \\} < \\frac{s}{p}  \\]\nif and only if $s$ is not a divisor of $p-1$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p490569}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $p$ be a prime number and let $s$ be an integer with $0 < s < p$.\nProve that there exist integers $m$ and $n$ with $0 < m < n < p$ and\n\\[ \\left \\{\\frac{sm}{p} \\right\\} < \\left \\{\\frac{sn}{p} \\right \\} < \\frac{s}{p}  \\]\nif and only if $s$ is not a divisor of $p-1$.\n\\end{mdframed}\nIt's equivalent to $ms \\bmod p < ns \\bmod p < s$,\nwhere $x \\bmod p$ means the remainder when $x$ is divided by $p$,\nby slight abuse of notation.\nWe will assume $s \\ge 2$ for simplicity,\nsince the case $s = 1$ is clear.\n\nFor any $x \\in \\{1, 2, \\dots, s-1\\}$\nwe define $f(x)$ to be the unique number in $\\{1, \\dots, p-1\\}$\nsuch that $s \\cdot f(x) \\bmod p = x$.\nThen, $m$ and $n$ fail to exist exactly when\n\\[ f(s-1) < f(s-2) < \\dots < f(1). \\]\n\nWe give the following explicit description of $f$:\nchoose $t \\equiv -s^{-1} \\pmod p$, $0 < t < p$.\nThen $f(x) = 1 + (s-x) \\cdot t \\bmod p$.\nSo our displayed inequality is equivalent to\n\\[ (1+t) \\bmod p < (1+2t) \\bmod p < (1+3t) \\bmod p\n  < \\dots < (1+(s-1)t) \\bmod p. \\]\nThis just means that the sequence $1+kt$\nnever ``wraps around'' modulo $p$\nas we take $k=1,2,\\dots,s-1$.\n\nSince we assumed $s \\neq 1$, we have $0 < 1+t < p$.\nNow since $1+kt$ never wraps around as $k=1,2,\\dots,s-1$,\nand increases in increments of $t$,\nit follows that $1+kt < p$ for all $k = 1, 2, \\dots, s-1$.\nFinally, as $1+st \\equiv 0 \\pmod p$ we get $1+st=p$.\n\nIn summary, $m$, $n$ fail to exist\nprecisely when $1 + st = p$.\nThat is of course equivalent to $s \\mid p-1$.\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 2006}
{"id": "usamo-2006-q2", "question": "Let $k > 0$ be a fixed integer.\nCompute the minimum integer $N$ (in terms of $k$) for which\nthere exists a set of $2k+1$ distinct positive integers\nthat has sum greater than $N$,\nbut for which every subset of size $k$ has sum at most $N/2$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p490581}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $k > 0$ be a fixed integer.\nCompute the minimum integer $N$ (in terms of $k$) for which\nthere exists a set of $2k+1$ distinct positive integers\nthat has sum greater than $N$,\nbut for which every subset of size $k$ has sum at most $N/2$.\n\\end{mdframed}\nThe answer is $N = k(2k^2+3k+3)$ given by\n\\[ S = \\left\\{ k^2+1, k^2+2, \\dots, k^2+2k+1 \\right\\}. \\]\n\nTo show this is best possible,\nlet the set be $S = \\{ a_0 <  a_1 < \\dots < a_{2k} \\}$\nso that the hypothesis becomes\n\\begin{align*}\n  N + 1 &\\le a_0 + a_1 + \\dots + a_{2k} \\\\\n  N/2 &\\ge a_{k+1} + \\dots + a_{2k}.\n\\end{align*}\nSubtracting twice the latter from the former gives\n\\begin{align*}\n  a_0 &\\ge 1 + (a_{k+1}-a_1) + (a_{k+2}-a_2) + \\dots\n  + (a_{2k} - a_k) \\\\\n  &\\ge 1 + \\underbrace{k + k + \\dots + k}_{k \\text{ terms}} = 1 + k^2.\n\\end{align*}\nNow, we have\n\\begin{align*}\n  N/2 &\\ge a_{k+1} + \\dots + a_{2k} \\\\\n  &\\ge (a_0 + (k+1)) + (a_0 + (k+2)) + \\dots + (a_0 + 2k) \\\\\n  &= k \\cdot a_0 + \\left( (k+1) + \\dots + 2k \\right) \\\\\n  &\\ge k(k^2+1) + k \\cdot \\frac{3k+1}{2}\n\\end{align*}\nso $N \\ge k(2k^2+3k+3)$.\n\n\\begin{remark*}\n  The exact value of $N$ is therefore very superficial.\n  From playing with these concrete examples\n  we find out we are essentially\n  just trying to find an increasing set $S$ obeying\n  \\[ a_0 + a_1 + \\dots + a_k > a_{k+1} + \\dots + a_{2k} \\qquad (\\star) \\]\n  and indeed given a sequence satisfying these properties\n  one simply sets $N = 2(a_{k+1} + \\dots + a_{2k})$.\n  Therefore we can focus almost entirely on $a_i$ and not $N$.\n\\end{remark*}\n\n\\begin{remark*}\n  It is relatively straightforward to figure out what is going on\n  based on the small cases.\n  For example, one can work out by hand that\n  \\begin{itemize}\n    \\ii $\\{2,3,4\\}$ is optimal for $k=1$\n    \\ii $\\{5,6,7,8,9\\}$ is optimal for $k=2$,\n    \\ii $\\{10,11,12,13,14,15,16\\}$ is optimal for $k=3$.\n  \\end{itemize}\n  In all the examples,\n  the $a_i$ are an arithmetic progression of difference $1$,\n  so that $a_j - a_i \\ge j-i$ is a sharp for all $i<j$,\n  and thus this estimate may be used freely without loss of sharpness;\n  applying it in $(\\star)$ gives a lower bound on $a_0$\n  which is then good enough to get a lower bound on $N$\n  matching the equality cases we found empirically.\n\\end{remark*}\n\\pagebreak", "category": "Combinatorics", "source": "USAMO", "year": 2006}
{"id": "usamo-2006-q3", "question": "For integral $m$, let $p(m)$ be the greatest prime divisor of $m$.\nBy convention, we set $p(\\pm 1) = 1$ and $p(0) = \\infty$.\nFind all polynomials $f$ with integer coefficients\nsuch that the sequence\n\\[ \\{ p(f(n^2)) - 2n \\}_{n \\geq 0}  \\]\nis bounded above.\n(In particular, this requires $f(n^2) \\neq 0$ for $n \\ge 0$.)", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p490625}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFor integral $m$, let $p(m)$ be the greatest prime divisor of $m$.\nBy convention, we set $p(\\pm 1) = 1$ and $p(0) = \\infty$.\nFind all polynomials $f$ with integer coefficients\nsuch that the sequence\n\\[ \\{ p(f(n^2)) - 2n \\}_{n \\geq 0}  \\]\nis bounded above.\n(In particular, this requires $f(n^2) \\neq 0$ for $n \\ge 0$.)\n\\end{mdframed}\nIf $f$ is the (possibly empty)\nproduct of linear factors of the form $4n-a^2$,\nthen it satisfies the condition.\nWe will prove no other polynomials work.\nIn what follows, assume $f$ is irreducible and nonconstant.\n\nIt suffices to show for every positive integer $c$,\nthere exists a prime $p$ and a nonnegative integer $n$\nsuch that $n \\le \\tfrac{p-1}{2} - c$ and $p$ divides $f(n^2)$.\n\nFirstly, recall there are infinitely many odd primes $p$,\nwith $p>c$, such that $p$ divides some $f(n^2)$, by Schur's Theorem.\nLooking mod such a $p$ we can find $n$ between $0$\nand $\\tfrac{p-1}{2}$ (since $n^2 \\equiv (-n)^2 \\pmod p$).\nWe claim that only finitely many $p$ from this set can fail now.\nFor if a $p$ fails, then its $n$ must be between\n$\\tfrac{p-1}{2} - c$ and $\\tfrac{p-1}{2}$.\nThat means for some $0 \\le k \\le c$ we have\n\\[ 0 \\equiv f\\left( \\left(\\frac{p-1}{2}-k\\right)^2 \\right)\n  \\equiv f\\left( \\left( k + \\frac12 \\right)^2 \\right) \\pmod{p}. \\]\nThere are only finitely many $p$ dividing\n\\[ \\prod_{k=1}^c f\\left( \\left( k+\\frac12 \\right)^2 \\right) \\]\nunless one of the terms in the product is zero;\nthis means that $4n-(2k+1)^2$ divides $f(n)$.\nThis establishes the claim and finishes the problem.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Number Theory", "source": "USAMO", "year": 2006}
{"id": "usamo-2006-q4", "question": "Find all positive integers $n$ for which there exist an integer $k \\ge 2$\nand positive rational numbers $a_1$, \\dots, $a_k$ satisfying\n$a_1 + a_2 + \\dots + a_k = a_1 a_2 \\dots a_k = n$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p490647}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFind all positive integers $n$ for which there exist an integer $k \\ge 2$\nand positive rational numbers $a_1$, \\dots, $a_k$ satisfying\n$a_1 + a_2 + \\dots + a_k = a_1 a_2 \\dots a_k = n$.\n\\end{mdframed}\nThe answer is all $n$ other than $1,2,3,5$.\n\n\\begin{claim*}\n  The only solution with $n \\le 5$ is $n = 4$.\n\\end{claim*}\n\\begin{proof}\n  The case $n=4$ works since $2+2 = 2\\cdot2=4$. So assume $n > 4$.\n\n  We now contend that $k > 2$.\n  Indeed, if $a_1 + a_2 = a_1 a_2 = n$ then\n  $(a_1-a_2)^2 = (a_1+a_2)^2 - 4a_1a_2 = n^2-4n = (n-2)^2 - 4$\n  is a rational integer square, hence a perfect square.\n  This happens only when $n = 4$.\n\n  Now by AM-GM,\n  \\[ \\frac nk = \\frac{a_1 + \\dots + a_k}{k}\n    \\ge \\sqrt[k]{a_1 \\dots a_k} = n^{1/k} \\]\n  and so $n \\ge k^{\\frac{1}{1 - 1/k}} = k^{\\frac{k}{k-1}}$.\n  This last quantity is always greater than $5$, since\n  \\begin{align*}\n    3^{3/2} &= 3\\sqrt3 > 5 \\\\\n    4^{4/3} &= 4\\sqrt[3]{4} > 5 \\\\\n    k^{\\frac{k}{k-1}} &> k \\ge 5 \\qquad \\forall k \\ge 5.\n  \\end{align*}\n  This finishes the proof.\n\\end{proof}\n\nNow, in general:\n\\begin{itemize}\n  \\ii If $n \\ge 6$ is even, we may take\n  $(a_1, \\dots, a_{n/2}) = (n/2, 2, 1, \\dots, 1)$.\n  \\ii If $n \\ge 9$ is odd, we may take\n  $(a_1, \\dots, a_{(n-3)/2}) = (n/2, 1/2, 4, 1, \\dots, 1)$.\n  \\ii A special case $n = 7$: one example is $(4/3, 7/6, 9/2)$.\n  (Another is $(7/6, 4/3, 3/2, 3)$.)\n\\end{itemize}\n\n\\begin{remark*}\n  The main hurdle in the problem is the $n=7$ case.\n  One good reason to believe a construction exists is that\n  it seems quite difficult to prove that $n=7$ fails.\n\\end{remark*}\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 2006}
{"id": "usamo-2006-q5", "question": "A mathematical frog jumps along the number line.\nThe frog starts at $1$, and jumps according to the following rule:\nif the frog is at integer $n$,\nthen it can jump either to $n+1$ or to $n + 2^{m_n+1}$\nwhere $2^{m_n}$ is the largest power of $2$ that is a factor of $n$.\nShow that if $k \\ge 2$ is a positive integer\nand $i$ is a nonnegative integer,\nthen the minimum number of jumps needed to reach $2^ik$\nis greater than the minimum number of jumps needed to reach $2^i$.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p490682}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nA mathematical frog jumps along the number line.\nThe frog starts at $1$, and jumps according to the following rule:\nif the frog is at integer $n$,\nthen it can jump either to $n+1$ or to $n + 2^{m_n+1}$\nwhere $2^{m_n}$ is the largest power of $2$ that is a factor of $n$.\nShow that if $k \\ge 2$ is a positive integer\nand $i$ is a nonnegative integer,\nthen the minimum number of jumps needed to reach $2^ik$\nis greater than the minimum number of jumps needed to reach $2^i$.\n\\end{mdframed}\nWe will think about the problem in terms of\nfinite sequences of jumps $(s_1, s_2, \\dots, s_\\ell)$,\nwhich we draw as\n\\[ 1 = x_0\n  \\taking{s_1} x_1\n  \\taking{s_2} x_2\n  \\taking{s_3} \\dots\n  \\taking{s_\\ell} x_\\ell \\]\nwhere $s_k = x_k - x_{k-1}$ is the length of some hop.\nWe say the sequence is \\emph{valid} if it has the\nproperty required by the problem:\nfor each $k$, either $s_k = 1$ or $s_k = 2^{m_{x_{k-1}}+1}$.\n\nAn example is shown below.\n\n\\begin{lemma*}\n  Let $(s_1, \\dots, s_\\ell)$ be a sequence of jumps.\n  Suppose we delete pick an index $k$ and exponent $e > 0$,\n  and delete any jumps after the $k$th one\n  which are divisible by $2^e$.\n  The resulting sequence is still valid.\n\\end{lemma*}\n\\begin{proof}\n  We only have to look after the $k$th jump.\n  The launching points of the remaining jumps after the $k$th\n  one are now shifted by multiples of $2^e$\n  due to the deletions;\n  so given a jump $x \\taking{s} x+s$\n  we end up with a jump $x' \\taking{s} x'+s$\n  where $x-x'$ is a multiple of $2^e$.\n\n  But since $s < 2^e$, we have $\\nu_2(x') < e$\n  and hence $\\nu_2(x) = \\nu_2(x')$ so the jump is valid.\n\\end{proof}\n\n\\begin{center}\n\\begin{asy}\nunitsize(0.6cm);\ndefaultpen(fontsize(8pt));\nfor (int i=1; i<=24; ++i) {\n  if (i!=8) label(\"$\"+(string)i+\"$\", (i,0));\n}\nlabel(\"$\\boxed{8}$\", (8,0));\n\nvoid arr(int i, int j, pen p, real eps) {\n  pair M = ((i+j)/2, eps*(j-i)**0.5/2);\n  draw((i,0)..M..(j,0), p, EndArrow(TeXHead), Margin(2,2));\n  label(\"$\"+(string)(j-i)+\"$\", M, eps*dir(90), p);\n}\n\narr( 1,  3, red, 1);\narr( 3,  4, red, -1);\narr( 4, 12, blue+dashed, 1);\narr(12, 13, red, -1);\narr(13, 14, red, 1);\narr(14, 18, blue+dashed, -1);\narr(18, 19, red, 1);\narr(19, 21, blue+dashed, -1);\narr(21, 23, blue+dashed, 1);\narr(23, 24, red, -1);\n\nadd(shift(-8, 3)*CC());\n\nfor (int i=1; i<=8; ++i) {\n  if (i!=8) label(\"$\"+(string)i+\"$\", (i,0));\n}\nlabel(\"$\\boxed{8}$\", (8,0));\n\narr( 1,  3, red, 1);\narr( 3,  4, red, -1);\narr( 4,  5, red, -1);\narr( 5,  6, red, 1);\narr( 6,  7, red, 1);\narr( 7,  8, red, -1);\n\\end{asy}\n\\end{center}\n\n\nNow let's consider a valid path to $2^i k$ with $\\ell$ steps, say\n\\[ 1 = x_0\n  \\taking{s_1} x_1\n  \\taking{s_2} x_2\n  \\taking{s_3} \\dots\n  \\taking{s_\\ell} x_\\ell = 2^i \\cdot k \\]\nwhere $s_i = x_i - x_{i-1}$ is the distance jumped.\n\nWe delete jumps in the following way:\nstarting from the largest $e$ and going downwards until $e=0$,\nwe delete all the jumps of length $2^e$\nwhich end at a point exceeding the target $2^i$.\n\nBy the lemma, at each stage, the path remains valid.\nWe claim more:\n\\begin{claim*}\n  Let $e \\ge 0$.\n  After the jumps of length greater than $2^e$ are deleted,\n  the resulting end-point is at least $2^i$,\n  and divisible by $2^{\\min(i,e)}$.\n\\end{claim*}\n\\begin{proof}\n  By downwards induction.\n  Consider any step where \\emph{some} jump is deleted.\n  Then, the end-point must be strictly greater than $x = 2^i - 2^e$\n  (i.e.\\ we must be within $2^e$ of the target $2^i$).\n\n  It is also divisible by $2^{\\min(i,e)}$ by induction hypothesis,\n  since we are changing the end-point by multiples of $2^e$.\n  And the smallest multiple of $2^{\\min(i,e)}$ exceeding $x$ is $2^i$.\n\\end{proof}\nOn the other hand by construction when the process ends\nthe reduced path ends at a point at most $2^i$,\nso it is $2^i$ as desired.\n\nTherefore we have taken a path to $2^i k$\nand reduced it to one to $2^i$ by deleting some jumps.\nThis proves the result.\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 2006}
{"id": "usamo-2006-q6", "question": "Let $ABCD$ be a quadrilateral,\nand let $E$ and $F$ be points on sides $AD$ and $BC$,\nrespectively, such that $\\frac{AE}{ED} = \\frac{BF}{FC}$.\nRay $FE$ meets rays $BA$ and $CD$ at $S$ and $T$, respectively.\nProve that the circumcircles of triangles $SAE$, $SBF$, $TCF$, and $TDE$\npass through a common point.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p490691}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABCD$ be a quadrilateral,\nand let $E$ and $F$ be points on sides $AD$ and $BC$,\nrespectively, such that $\\frac{AE}{ED} = \\frac{BF}{FC}$.\nRay $FE$ meets rays $BA$ and $CD$ at $S$ and $T$, respectively.\nProve that the circumcircles of triangles $SAE$, $SBF$, $TCF$, and $TDE$\npass through a common point.\n\\end{mdframed}\n\\begin{center}\n  \\begin{asy}\n    size(8cm);\n    defaultpen(fontsize(9pt));\n    pair A = (-1,3);\n    pair B = (-3,-2);\n    pair C = (6,-2);\n    pair D = (3,5);\n\n    pair M = (A*C-B*D)/(A+C-B-D);\n\n    pair E = 0.7*A+0.3*D;\n    pair F = 0.7*B+0.3*C;\n    pair S = extension(E, F, A, B);\n    pair T = extension(C, D, E, F);\n\n    draw(T--F);\n    draw(A--B--C--D--cycle);\n    draw(A--S);\n    draw(T--D);\n\n    draw(circumcircle(S, A, E), dotted+blue);\n    draw(circumcircle(S, B, F), dotted+blue);\n    draw(circumcircle(T, C, F), dotted+blue);\n    draw(circumcircle(T, D, E), dotted+blue);\n\n    pair P = extension(A, B, C, D);\n    pair Q = extension(A, D, B, C);\n    draw(A--Q--B, dashed);\n    draw(S--P, dashed);\n\n    draw(circumcircle(P, A, D), dotted+red);\n    draw(circumcircle(P, B, C), dotted+red);\n    draw(circumcircle(Q, A, B), dotted+red);\n    draw(circumcircle(Q, C, D), dotted+red);\n\n    dot(\"$A$\", A, dir(A));\n    dot(\"$B$\", B, dir(B));\n    dot(\"$C$\", C, dir(C));\n    dot(\"$D$\", D, dir(D));\n    dot(\"$M$\", M, dir(M));\n    dot(\"$E$\", E, dir(E));\n    dot(\"$F$\", F, dir(F));\n    dot(\"$S$\", S, dir(135));\n    dot(\"$T$\", T, dir(T));\n    dot(\"$P$\", P, dir(P));\n    dot(\"$Q$\", Q, dir(Q));\n\n    /* Source generated by TSQ */\n  \\end{asy}\n\\end{center}\n\nLet $M$ be the Miquel point of $ABCD$.\nThen $M$ is the center of a spiral similarity taking $AD$ to $BC$.\nThe condition guarantees that it also takes $E$ to $F$.\nHence, we see that $M$ is the center of a spiral similarity taking $\\ol{AB}$ to $\\ol{EF}$,\nand consequently the circumcircles of $QAB$, $QEF$, $SAE$, $SBF$ concur at point $M$.\n\nIn other words, the Miquel point of $ABCD$ is also the Miquel point of $ABFE$.\nSimilarly, $M$ is also the Miquel point of $EDCF$, so all four circles concur at $M$.\n\\pagebreak\n\n\n\\end{document}", "category": "Geometry", "source": "USAMO", "year": 2006}
{"id": "usamo-2005-q1", "question": "Determine all composite positive integers $n$ for which\nit is possible to arrange all divisors of $n$ that are greater than $1$\nin a circle so that no two adjacent divisors are relatively prime.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p213007}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nDetermine all composite positive integers $n$ for which\nit is possible to arrange all divisors of $n$ that are greater than $1$\nin a circle so that no two adjacent divisors are relatively prime.\n\\end{mdframed}\nThe only bad ones are $n = pq$, products of two distinct primes.\nClearly they can't be so arranged, so we show all others work.\n\\begin{itemize}\n\\ii If $n$ is a power of a prime, the result is obvious; any arrangement works.\n\n\\ii If $n = p_1^{e_1} \\dots p_k^{e_k}$ for some $k \\ge 3$,\nthen first situate $p_1p_2$, $p_2p_3$, \\dots, $p_kp_1$ on the circle.\nThen we can arbitrarily place any multiples of $p_i$\nbetween $p_{i-1} p_i$ and $p_i p_{i+1}$.\nThis finishes this case.\n\n\\ii Finally suppose $n = p^a q^b$.\nIf $a > 1$, say, we can repeat the argument by first placing\n$pq$ and $p^2q$ and then placing multiples of $p$ in one arc\nand multiples of $q$ in the other arc.\nOn the other hand the case $a=b=1$ is seen to be impossible.\n\\end{itemize}\n\\pagebreak", "category": "Number Theory", "source": "USAMO", "year": 2005}
{"id": "usamo-2005-q2", "question": "Prove that the system of equations\n\\begin{align*}\n  x^6 + x^3 + x^3y + y &= 147^{157} \\\\\n  x^3 + x^3y + y^2 + y + z^9 &= 157^{147}\n\\end{align*}\nhas no integer solutions.", "solution": "", "category": "Algebra", "source": "USAMO", "year": 2005}
{"id": "usamo-2005-q3", "question": "Let $ABC$ be an acute-angled triangle,\nand let $P$ and $Q$ be two points on side $BC$.\nConstruct a point $C_1$\nin such a way that the convex quadrilateral\n$APBC_1$ is cyclic,\n$\\ol{QC_1} \\parallel \\ol{CA}$,\nand $C_1$ and $Q$ lie on opposite sides of line $AB$.\nConstruct a point $B_1$ in such a way that the\nconvex quadrilateral $APCB_1$ is cyclic,\n$\\ol{QB_1} \\parallel \\ol{BA}$,\nand $B_1$ and $Q$ lie on opposite sides of line $AC$.\nProve that the points $B_1$, $C_1$, $P$, and $Q$ lie on a circle.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p213011}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $ABC$ be an acute-angled triangle,\nand let $P$ and $Q$ be two points on side $BC$.\nConstruct a point $C_1$\nin such a way that the convex quadrilateral\n$APBC_1$ is cyclic,\n$\\ol{QC_1} \\parallel \\ol{CA}$,\nand $C_1$ and $Q$ lie on opposite sides of line $AB$.\nConstruct a point $B_1$ in such a way that the\nconvex quadrilateral $APCB_1$ is cyclic,\n$\\ol{QB_1} \\parallel \\ol{BA}$,\nand $B_1$ and $Q$ lie on opposite sides of line $AC$.\nProve that the points $B_1$, $C_1$, $P$, and $Q$ lie on a circle.\n\\end{mdframed}\nIt is enough to prove that $A$, $B_1$, and $C_1$ are collinear,\nsince then $\\dang C_1QP = \\dang ACP = \\dang AB_1P = \\dang C_1B_1P$.\n\n\\begin{center}\n\\begin{asy}\npair A = dir(110);\npair B = dir(210);\npair C = dir(330);\npair P = 0.7*C+0.3*B;\ndraw(A--B--C--cycle);\n\npair O_1 = circumcenter(A, P, C);\npair B_1 = 2*O_1-C;\npair Q = extension(B, C, B_1, B_1+B-A);\npair C_1 = extension(A, B_1, Q, Q+C-A);\n\ndraw(circumcircle(A, B, P));\ndraw(circumcircle(A, C, P));\n\ndraw(C_1--Q--B_1);\ndraw(B_1--C_1, dotted);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$P$\", P, dir(P));\ndot(\"$B_1$\", B_1, dir(B_1));\ndot(\"$Q$\", Q, dir(Q));\ndot(\"$C_1$\", C_1, dir(C_1));\n\n/* Source generated by TSQ */\n\\end{asy}\n\\end{center}\n\n\\paragraph{First solution.}\nLet $T$ be the second intersection of $\\ol{AC_1}$\nwith $(APC)$.\nThen readily $\\triangle PC_1T \\sim \\triangle ABC$.\nConsequently, $\\ol{QC_1} \\parallel \\ol{AC}$ implies $TC_1QP$ cyclic.\nFinally, $\\ol{TQ} \\parallel \\ol{AB}$ now\nfollows from the cyclic condition,\nso $T = B_1$ as desired.\n\n\\paragraph{Second solution.}\nOne may also use barycentric coordinates.\nLet $P = (0,m,n)$ and $Q = (0,r,s)$ with $m+n=r+s=1$.  Once again, \\[ (APB) : -a^2yz-b^2zx-c^2xy + (x+y+z)(a^2m \\cdot z) = 0.\n\\] Set $C_1 = (s-z, r, z)$, where $C_1Q \\parallel AC$ follows by $(s-z) + r + z = 1$.  We solve for this $z$.\n\\begin{align*}\n0 &= -a^2rz + (s-z)(-b^2z-c^2r) + a^2mz \\\\\n&= b^2z^2 + (-sb^2+rc^2)z - a^2rz + a^2mz - c^2rs \\\\\n&= b^2z^2 + (-sb^2+rc^2+a^2(m-r))z - c^2rs \\\\\n\\implies 0 &= rb^2 \\left( \\frac{z}{r} \\right)^2 + (-sb^2+rc^2 + a^2(m-r)) \\left(\\frac{z}{r}\\right) - c^2s.\n\\end{align*}\nSo the quotient of the $z$ and $y$ coordinates of $C_1$ satisfies this quadratic.  Similarly, if $B_1 = (r-y, y, s)$ we obtain that\n\\[\n0 = sc^2 \\left( \\frac{y}{s} \\right)^2 + (-rc^2 + sb^2 + a^2(n-s)) \\left(\\frac{y}{s}\\right) - b^2r\n\\]\nSince these two quadratics are the same when one is written backwards (and negated), it follows that their roots are reciprocals.  But the roots of the quadratics represent $\\tfrac{z}{y}$ and $\\tfrac{y}{z}$ for the points $C_1$ and $B_1$, respectively.  This implies (with some configuration blah) that the points $B_1$ and $C_1$ are collinear with $A=(1,0,0)$ (in some line of the form $\\tfrac{y}{z} = k$), as desired.\n\\pagebreak\n\n\\section{Solutions to Day 2}", "category": "Geometry", "source": "USAMO", "year": 2005}
{"id": "usamo-2005-q4", "question": "Legs $L_1$, $L_2$, $L_3$, $L_4$ of a square table each have length $n$,\nwhere $n$ is a positive integer.\nFor how many ordered $4$-tuples $(k_1, k_2, k_3, k_4)$ of nonnegative integers\ncan we cut a piece of length $k_i$ from the end of leg $L_i$\nand still have a stable table?\n\n(The table is \\emph{stable} if it can be placed\nso that all four of the leg ends touch the floor.\nNote that a cut leg of length $0$ is permitted.)", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p213012}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLegs $L_1$, $L_2$, $L_3$, $L_4$ of a square table each have length $n$,\nwhere $n$ is a positive integer.\nFor how many ordered $4$-tuples $(k_1, k_2, k_3, k_4)$ of nonnegative integers\ncan we cut a piece of length $k_i$ from the end of leg $L_i$\nand still have a stable table?\n\n(The table is \\emph{stable} if it can be placed\nso that all four of the leg ends touch the floor.\nNote that a cut leg of length $0$ is permitted.)\n\\end{mdframed}\nFlip the table upside-down so that that the table's surface\nrests on the floor.\nThen, we see that we want the truncated legs\nto have endpoints $A$, $B$, $C$, $D$ which are coplanar (say).\n\\begin{claim*}\n  This occurs if and only if $ABCD$ is a parallelogram.\n\\end{claim*}\n\\begin{proof}\n  Obviously $ABCD$ being a parallelogram is sufficient.\n  Conversely, if they are coplanar,\n  we let $D'$ be such that $ABCD'$ is a parallelogram.\n  Then $D'$ also lies in the same plane as $ABCD$,\n  but is situated directly above $D$\n  (since the table was a square).\n  This implies $D' = D$, as needed.\n\\end{proof}\nIn still other words, we are counting the number of solutions to\n\\[ (n-k_1) + (n-k_3) = (n-k_2) + (n-k_4)\n  \\iff k_1 + k_3 = k_2 + k_4. \\]\nDefine\n\\[ a_r = \\# \\{(a,b) \\mid a+b=r, \\; 0 \\le a,b \\le n \\} \\]\nso that the number of solutions to $k_1 + k_3 = k_2 + k_4 = r$\nis just given by $a_r^2$.\nWe now just compute\n\\begin{align*}\n  \\sum_{r=0}^{2n} a_r^2 &= 1^2 + 2^2 + \\dots + n^2 + (n+1)^2 + n^2 + \\dots + 1^2 \\\\\n  &= \\frac{1}{3}(n+1)(2n^2 + 4n + 3).\n\\end{align*}\n\\pagebreak", "category": "Combinatorics", "source": "USAMO", "year": 2005}
{"id": "usamo-2005-q5", "question": "Let $n > 1$ be an integer.\nSuppose $2n$ points are given in the plane, no three of which are collinear.\nSuppose $n$ of the given $2n$ points are colored blue and the other $n$ colored red.\nA line in the plane is called a \\emph{balancing line}\nif it passes through one blue and one red point\nand, for each side of the line, the number of blue points on that\nside is equal to the number of red points on the same side.\nProve that there exist at least two balancing lines.", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p213018}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nLet $n > 1$ be an integer.\nSuppose $2n$ points are given in the plane, no three of which are collinear.\nSuppose $n$ of the given $2n$ points are colored blue and the other $n$ colored red.\nA line in the plane is called a \\emph{balancing line}\nif it passes through one blue and one red point\nand, for each side of the line, the number of blue points on that\nside is equal to the number of red points on the same side.\nProve that there exist at least two balancing lines.\n\\end{mdframed}\nConsider the convex hull $\\mathcal H$ of the polygon. There are two cases.\n\n\\paragraph{Easy case: the convex hull has both colors.}\nIf the convex hull $\\mathcal H$ is not all the same color,\nthere exist two edges of $\\mathcal H$ (at least) which have differently colored endpoints.\nThe extensions of those sides form balancing lines;\nindeed given any such line $\\ell$ one side of $\\ell$ has no points,\nthe other has $n-1$ red and $n-1$ blue points.\n\n\\paragraph{Harder case: the convex hull is all one color.}\nNow assume $\\mathcal H$ is all blue (WLOG).\nWe will prove there are at least $|\\mathcal H|$ balancing lines in the following way.\n\\begin{claim*}\nFor any vertex $B$ of $\\mathcal H$ there is a balancing line through it.\n\\end{claim*}\n\\begin{proof}\nAssume $A$, $B$, $C$ are three consecutive\nblue vertices of $\\mathcal H$.\nImagine starting with line $\\ell$ passing through $B$ and $A$,\nthen rotating it through $B$ until it coincides with line $BC$,\nthrough the polygon.\n\n\\begin{center}\n\\begin{asy}\nsize(5cm);\nfilldraw(dir(90)--dir(210)--dir(330)--cycle,\n  rgb(1,1,0.9), blue);\nlabel(scale(2)*\"$\\mathcal H$\", midpoint(dir(90)--dir(330)), dir(30), blue);\ndot(\"$B$\", dir(90), dir(130), blue);\ndot(\"$A$\", dir(210), dir(210), blue);\ndot(\"$C$\", dir(330), dir(330), blue);\ndot( (0.2,-0.4), red);\ndot( (-0.1, 0.3), red);\ndot( (0.4, 0.1), red);\ndot( (-0.5, -0.1), red);\ndot( (0.3, -0.2), blue);\ndraw(dir(90)--dir(234), dashed, EndArrow);\nlabel(\"$\\ell$\", dir(234), dir(234));\n\\end{asy}\n\\end{center}\n\nDuring this process, we consider the set of points on the same side of $\\ell$ as $C$,\nand let $x$ be the number of such red points minus the number of such blue points.\nNote that:\n\\begin{itemize}\n  \\ii Every time $\\ell$ touches a blue point, $x$ increases by $1$.\n  \\ii Every time $\\ell$ touches a red point, $x$ decreases by $1$.\n  \\ii Initially, $x = +1$.\n  \\ii Just before reaching the end we have $x = -1$.\n\\end{itemize}\nSo at the moment where $x$ first equals zero, we have found our balancing line.\n\\end{proof}\n\\pagebreak", "category": "Combinatorics", "source": "USAMO", "year": 2005}
{"id": "usamo-2005-q6", "question": "For a positive integer $m$,\nlet $s(m)$ denote the sum of the decimal digits of $m$.\nA set $S$ positive integers is \\emph{$k$-stable}\nif $s(\\sum_{x \\in X} x) = k$ for any nonempty subset $X \\subseteq S$.\n\nFor each integer $n \\ge 2$ let $f(n)$ be the minimal $k$\nfor which there exists a $k$-stable set with $n$ integers.\nProve that there are constants $0 < C_1 < C_2$ with\n\\[ C_1 \\log_{10} n \\le f(n) \\le C_2 \\log_{10} n. \\]", "solution": "\\textsl{Available online at \\url{https://aops.com/community/p213014}.}\n\\begin{mdframed}[style=mdpurplebox,frametitle={Problem statement}]\nFor a positive integer $m$,\nlet $s(m)$ denote the sum of the decimal digits of $m$.\nA set $S$ positive integers is \\emph{$k$-stable}\nif $s(\\sum_{x \\in X} x) = k$ for any nonempty subset $X \\subseteq S$.\n\nFor each integer $n \\ge 2$ let $f(n)$ be the minimal $k$\nfor which there exists a $k$-stable set with $n$ integers.\nProve that there are constants $0 < C_1 < C_2$ with\n\\[ C_1 \\log_{10} n \\le f(n) \\le C_2 \\log_{10} n. \\]\n\\end{mdframed}\n\\paragraph{Construction showing $f(n) \\le 9 \\left\\lceil \\log_{10} \\binom{n+1}{2} \\right\\rceil$.}\nLet $n \\ge 1$ and $e \\ge 1$ be integers satisfying $1 + 2 + \\dots + n < 10^e$.\nConsider the set\n\\[ S = \\left\\{ 10^e-1, \\; 2(10^e-1), \\; \\dots, \\; n(10^e-1) \\right\\}. \\]\nFor example, if $n = 6$ and $e = 3$,\nwe have $S = \\{999, 1998, 2997, 3996, 4995, 5994\\}$.\n\nThe set $S$ here is easily seen to be $9e$-stable.\nThus $f(n) \\le 9 \\left\\lceil \\log_{10} \\binom{n+1}{2} \\right\\rceil$,\nproving one direction.\n\n\\begin{remark*}\n  I think the problem is actually more natural\n  with a multiset $S$ rather than a vanilla set,\n  in which case $S = \\{10^e-1, 10^e-1, \\dots, 10^e-1\\}$ works fine,\n  and is easier to think of.\n\n  In some sense the actual construction is obtained\n  by starting with this one,\n  and then pushing together the terms together\n  in order to get the terms to be distinct,\n  hence the $1+2+\\dots+n$ appearance.\n\\end{remark*}\n\n\\paragraph{Proof that $f(n) \\ge \\log_{12} n$.}\nWe are going to prove the following, which obviously sufficient.\n\\begin{claim*}\n  Let $k$ be a positive integer.\n  In any (multi)set $S$ of more than $12^k$ integers,\n  there exists a subset whose sum of decimal digits exceeds $k$.\n\\end{claim*}\n\\begin{proof}\n  Imagine writing entries of $S$ on a blackboard,\n  while keeping a running sum $\\Sigma$ initially set to zero.\n  For $i = 1, 2, \\dots$ we will have a process such that\n  at the end of the $i$th step all entries on the board\n  are divisible by $10^i$.\n  It goes as follows:\n  \\begin{itemize}\n    \\ii If the $i$th digit from the right of $\\Sigma$ is nonzero,\n    then arbitrarily partition the numbers on the board\n    into groups of $10$, erasing any leftover numbers.\n    Within each group of $10$, we can find\n    a nonempty subset with sum $0 \\bmod{10^i}$;\n    we then erase each group and replace it with that sum.\n\n    \\ii If the $i$th digit from the right of $\\Sigma$ is zero,\n    but some entry on the board is not divisible by $10^i$,\n    then we erase that entry and add it to $\\Sigma$.\n    Then we do the grouping as in the previous step.\n\n    \\ii If the $i$th digit from the right of $\\Sigma$ is zero,\n    and all entries on the board are divisible by $10^i$,\n    we do nothing and move on to the next step.\n  \\end{itemize}\n  This process ends when no numbers remain on the blackboard.\n  The first and second cases occur at least $k+1$ times\n  (the number of entries decreases by a factor of at most $12$ each step),\n  and each time $\\Sigma$ gets some nonzero digit,\n  which is never changed at later steps.\n  Therefore $\\Sigma$ has sum of digits at least $k+1$ as needed.\n\\end{proof}\n\n\\begin{remark*}\n  The official solutions contain a slicker proof:\n  it turns out that any multiple of $10^e-1$ has\n  sum of decimal digits at least $9e$.\n  However, if one does not know this lemma it seems\n  nontrivial to imagine coming up with it.\n\\end{remark*}\n\\pagebreak\n\n\n\\end{document}", "category": "Number Theory", "source": "USAMO", "year": 2005}
{"id": "imo-shortlist-2013-a1", "question": "A1. Let \\(n\\) be a positive integer and let \\(a_{1}, \\ldots, a_{n-1}\\) be arbitrary real numbers. Define the sequences \\(u_{0}, \\ldots, u_{n}\\) and \\(v_{0}, \\ldots, v_{n}\\) inductively by \\(u_{0}=u_{1}=v_{0}=v_{1}=1\\), and\n\n\\[\nu_{k+1}=u_{k}+a_{k} u_{k-1}, \\quad v_{k+1}=v_{k}+a_{n-k} v_{k-1} \\quad \\text { for } k=1, \\ldots, n-1\n\\]\n\nProve that \\(u_{n}=v_{n}\\).\n(France)", "category": "Algebra", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-a2", "question": "A2. Prove that in any set of 2000 distinct real numbers there exist two pairs \\(a>b\\) and \\(c>d\\) with \\(a \\neq c\\) or \\(b \\neq d\\), such that\n\n\\[\n\\left|\\frac{a-b}{c-d}-1\\right|<\\frac{1}{100000}\n\\]\n\n(Lithuania)", "category": "Algebra", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-a3", "question": "A3. Let \\(\\mathbb{Q}_{>0}\\) be the set of positive rational numbers. Let \\(f: \\mathbb{Q}_{>0} \\rightarrow \\mathbb{R}\\) be a function satisfying the conditions\n\n\\[\nf(x) f(y) \\geqslant f(x y) \\quad \\text { and } \\quad f(x+y) \\geqslant f(x)+f(y)\n\\]\n\nfor all \\(x, y \\in \\mathbb{Q}_{>0}\\). Given that \\(f(a)=a\\) for some rational \\(a>1\\), prove that \\(f(x)=x\\) for all \\(x \\in \\mathbb{Q}_{>0}\\).\n(Bulgaria)", "category": "Algebra", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-a4", "question": "A4. Let \\(n\\) be a positive integer, and consider a sequence \\(a_{1}, a_{2}, \\ldots, a_{n}\\) of positive integers. Extend it periodically to an infinite sequence \\(a_{1}, a_{2}, \\ldots\\) by defining \\(a_{n+i}=a_{i}\\) for all \\(i \\geqslant 1\\). If\n\n\\[\na_{1} \\leqslant a_{2} \\leqslant \\cdots \\leqslant a_{n} \\leqslant a_{1}+n\n\\]\n\nand\n\n\\[\na_{a_{i}} \\leqslant n+i-1 \\quad \\text { for } i=1,2, \\ldots, n\n\\]\n\nprove that\n\n\\[\na_{1}+\\cdots+a_{n} \\leqslant n^{2}\n\\]\n\n(Germany)", "category": "Algebra", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-a5", "question": "A5. Let \\(\\mathbb{Z}_{\\geqslant 0}\\) be the set of all nonnegative integers. Find all the functions \\(f: \\mathbb{Z}_{\\geqslant 0} \\rightarrow \\mathbb{Z}_{\\geqslant 0}\\) satisfying the relation\n\n\\[\nf(f(f(n)))=f(n+1)+1\n\\]\n\nfor all \\(n \\in \\mathbb{Z}_{\\geqslant 0}\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-a6", "question": "A6. Let \\(m \\neq 0\\) be an integer. Find all polynomials \\(P(x)\\) with real coefficients such that\n\n\\[\n\\left(x^{3}-m x^{2}+1\\right) P(x+1)+\\left(x^{3}+m x^{2}+1\\right) P(x-1)=2\\left(x^{3}-m x+1\\right) P(x)\n\\]\n\nfor all real numbers \\(x\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-c1", "question": "C1. Let \\(n\\) be a positive integer. Find the smallest integer \\(k\\) with the following property: Given any real numbers \\(a_{1}, \\ldots, a_{d}\\) such that \\(a_{1}+a_{2}+\\cdots+a_{d}=n\\) and \\(0 \\leqslant a_{i} \\leqslant 1\\) for \\(i=1,2, \\ldots, d\\), it is possible to partition these numbers into \\(k\\) groups (some of which may be empty) such that the sum of the numbers in each group is at most 1 .\n(Poland)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-c2", "question": "C2. In the plane, 2013 red points and 2014 blue points are marked so that no three of the marked points are collinear. One needs to draw \\(k\\) lines not passing through the marked points and dividing the plane into several regions. The goal is to do it in such a way that no region contains points of both colors.\n\nFind the minimal value of \\(k\\) such that the goal is attainable for every possible configuration of 4027 points.\n(Australia)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-c3", "question": "C3. A crazy physicist discovered a new kind of particle which he called an imon, after some of them mysteriously appeared in his lab. Some pairs of imons in the lab can be entangled, and each imon can participate in many entanglement relations. The physicist has found a way to perform the following two kinds of operations with these particles, one operation at a time.\n(i) If some imon is entangled with an odd number of other imons in the lab, then the physicist can destroy it.\n(ii) At any moment, he may double the whole family of imons in his lab by creating a copy \\(I^{\\prime}\\) of each imon \\(I\\). During this procedure, the two copies \\(I^{\\prime}\\) and \\(J^{\\prime}\\) become entangled if and only if the original imons \\(I\\) and \\(J\\) are entangled, and each copy \\(I^{\\prime}\\) becomes entangled with its original imon \\(I\\); no other entanglements occur or disappear at this moment.\n\nProve that the physicist may apply a sequence of such operations resulting in a family of imons, no two of which are entangled.\n(Japan)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-c4", "question": "C4. Let \\(n\\) be a positive integer, and let \\(A\\) be a subset of \\(\\{1, \\ldots, n\\}\\). An \\(A\\)-partition of \\(n\\) into \\(k\\) parts is a representation of \\(n\\) as a sum \\(n=a_{1}+\\cdots+a_{k}\\), where the parts \\(a_{1}, \\ldots, a_{k}\\) belong to \\(A\\) and are not necessarily distinct. The number of different parts in such a partition is the number of (distinct) elements in the set \\(\\left\\{a_{1}, a_{2}, \\ldots, a_{k}\\right\\}\\).\n\nWe say that an \\(A\\)-partition of \\(n\\) into \\(k\\) parts is optimal if there is no \\(A\\)-partition of \\(n\\) into \\(r\\) parts with \\(r<k\\). Prove that any optimal \\(A\\)-partition of \\(n\\) contains at most \\(\\sqrt[3]{6 n}\\) different parts.\n(Germany)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-c5", "question": "C5. Let \\(r\\) be a positive integer, and let \\(a_{0}, a_{1}, \\ldots\\) be an infinite sequence of real numbers. Assume that for all nonnegative integers \\(m\\) and \\(s\\) there exists a positive integer \\(n \\in[m+1, m+r]\\) such that\n\n\\[\na_{m}+a_{m+1}+\\cdots+a_{m+s}=a_{n}+a_{n+1}+\\cdots+a_{n+s}\n\\]\n\nProve that the sequence is periodic, i. e. there exists some \\(p \\geqslant 1\\) such that \\(a_{n+p}=a_{n}\\) for all \\(n \\geqslant 0\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-c6", "question": "C6. In some country several pairs of cities are connected by direct two-way flights. It is possible to go from any city to any other by a sequence of flights. The distance between two cities is defined to be the least possible number of flights required to go from one of them to the other. It is known that for any city there are at most 100 cities at distance exactly three from it. Prove that there is no city such that more than 2550 other cities have distance exactly four from it.\n(Russia)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-c7", "question": "C7. Let \\(n \\geqslant 2\\) be an integer. Consider all circular arrangements of the numbers \\(0,1, \\ldots, n\\); the \\(n+1\\) rotations of an arrangement are considered to be equal. A circular arrangement is called beautiful if, for any four distinct numbers \\(0 \\leqslant a, b, c, d \\leqslant n\\) with \\(a+c=b+d\\), the chord joining numbers \\(a\\) and \\(c\\) does not intersect the chord joining numbers \\(b\\) and \\(d\\).\n\nLet \\(M\\) be the number of beautiful arrangements of \\(0,1, \\ldots, n\\). Let \\(N\\) be the number of pairs \\((x, y)\\) of positive integers such that \\(x+y \\leqslant n\\) and \\(\\operatorname{gcd}(x, y)=1\\). Prove that\n\n\\[\nM=N+1\n\\]", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-c8", "question": "C8. Players \\(A\\) and \\(B\\) play a paintful game on the real line. Player \\(A\\) has a pot of paint with four units of black ink. A quantity \\(p\\) of this ink suffices to blacken a (closed) real interval of length \\(p\\). In every round, player \\(A\\) picks some positive integer \\(m\\) and provides \\(1 / 2^{m}\\) units of ink from the pot. Player \\(B\\) then picks an integer \\(k\\) and blackens the interval from \\(k / 2^{m}\\) to \\((k+1) / 2^{m}\\) (some parts of this interval may have been blackened before). The goal of player \\(A\\) is to reach a situation where the pot is empty and the interval \\([0,1]\\) is not completely blackened.\n\nDecide whether there exists a strategy for player \\(A\\) to win in a finite number of moves.\n(Austria)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-g1", "question": "G1. Let \\(A B C\\) be an acute-angled triangle with orthocenter \\(H\\), and let \\(W\\) be a point on side \\(B C\\). Denote by \\(M\\) and \\(N\\) the feet of the altitudes from \\(B\\) and \\(C\\), respectively. Denote by \\(\\omega_{1}\\) the circumcircle of \\(B W N\\), and let \\(X\\) be the point on \\(\\omega_{1}\\) which is diametrically opposite to \\(W\\). Analogously, denote by \\(\\omega_{2}\\) the circumcircle of \\(C W M\\), and let \\(Y\\) be the point on \\(\\omega_{2}\\) which is diametrically opposite to \\(W\\). Prove that \\(X, Y\\) and \\(H\\) are collinear.\n(Thaliand)", "category": "Geometry", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-g2", "question": "G2. Let \\(\\omega\\) be the circumcircle of a triangle \\(A B C\\). Denote by \\(M\\) and \\(N\\) the midpoints of the sides \\(A B\\) and \\(A C\\), respectively, and denote by \\(T\\) the midpoint of the \\(\\operatorname{arc} B C\\) of \\(\\omega\\) not containing \\(A\\). The circumcircles of the triangles \\(A M T\\) and \\(A N T\\) intersect the perpendicular bisectors of \\(A C\\) and \\(A B\\) at points \\(X\\) and \\(Y\\), respectively; assume that \\(X\\) and \\(Y\\) lie inside the triangle \\(A B C\\). The lines \\(M N\\) and \\(X Y\\) intersect at \\(K\\). Prove that \\(K A=K T\\).\n(Iran)", "category": "Geometry", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-g3", "question": "G3. In a triangle \\(A B C\\), let \\(D\\) and \\(E\\) be the feet of the angle bisectors of angles \\(A\\) and \\(B\\), respectively. A rhombus is inscribed into the quadrilateral \\(A E D B\\) (all vertices of the rhombus lie on different sides of \\(A E D B\\) ). Let \\(\\varphi\\) be the non-obtuse angle of the rhombus. Prove that \\(\\varphi \\leqslant \\max \\{\\angle B A C, \\angle A B C\\}\\).\n(Serbia)", "category": "Geometry", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-g4", "question": "G4. Let \\(A B C\\) be a triangle with \\(\\angle B>\\angle C\\). Let \\(P\\) and \\(Q\\) be two different points on line \\(A C\\) such that \\(\\angle P B A=\\angle Q B A=\\angle A C B\\) and \\(A\\) is located between \\(P\\) and \\(C\\). Suppose that there exists an interior point \\(D\\) of segment \\(B Q\\) for which \\(P D=P B\\). Let the ray \\(A D\\) intersect the circle \\(A B C\\) at \\(R \\neq A\\). Prove that \\(Q B=Q R\\).\n(Georgia)", "category": "Geometry", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-g5", "question": "G5. Let \\(A B C D E F\\) be a convex hexagon with \\(A B=D E, B C=E F, C D=F A\\), and \\(\\angle A-\\angle D=\\angle C-\\angle F=\\angle E-\\angle B\\). Prove that the diagonals \\(A D, B E\\), and \\(C F\\) are concurrent.\n(Ukraine)", "category": "Geometry", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-g6", "question": "G6. Let the excircle of the triangle \\(A B C\\) lying opposite to \\(A\\) touch its side \\(B C\\) at the point \\(A_{1}\\). Define the points \\(B_{1}\\) and \\(C_{1}\\) analogously. Suppose that the circumcentre of the triangle \\(A_{1} B_{1} C_{1}\\) lies on the circumcircle of the triangle \\(A B C\\). Prove that the triangle \\(A B C\\) is right-angled.\n(Russia)", "category": "Geometry", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-n1", "question": "N1. Let \\(\\mathbb{Z}_{>0}\\) be the set of positive integers. Find all functions \\(f: \\mathbb{Z}_{>0} \\rightarrow \\mathbb{Z}_{>0}\\) such that\n\n\\[\nm^{2}+f(n) \\mid m f(m)+n\n\\]\n\nfor all positive integers \\(m\\) and \\(n\\).\n(Malaysia)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-n2", "question": "N2. Prove that for any pair of positive integers \\(k\\) and \\(n\\) there exist \\(k\\) positive integers \\(m_{1}, m_{2}, \\ldots, m_{k}\\) such that\n\n\\[\n1+\\frac{2^{k}-1}{n}=\\left(1+\\frac{1}{m_{1}}\\right)\\left(1+\\frac{1}{m_{2}}\\right) \\cdots\\left(1+\\frac{1}{m_{k}}\\right) .\n\\]\n\n(Japan)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-n3", "question": "N3. Prove that there exist infinitely many positive integers \\(n\\) such that the largest prime divisor of \\(n^{4}+n^{2}+1\\) is equal to the largest prime divisor of \\((n+1)^{4}+(n+1)^{2}+1\\).\n(Belgium)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-n4", "question": "N4. Determine whether there exists an infinite sequence of nonzero digits \\(a_{1}, a_{2}, a_{3}, \\ldots\\) and a positive integer \\(N\\) such that for every integer \\(k>N\\), the number \\(\\overline{a_{k} a_{k-1} \\ldots a_{1}}\\) is a perfect square.\n(Iran)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-n5", "question": "N5. Fix an integer \\(k \\geqslant 2\\). Two players, called Ana and Banana, play the following game of numbers: Initially, some integer \\(n \\geqslant k\\) gets written on the blackboard. Then they take moves in turn, with Ana beginning. A player making a move erases the number \\(m\\) just written on the blackboard and replaces it by some number \\(m^{\\prime}\\) with \\(k \\leqslant m^{\\prime}<m\\) that is coprime to \\(m\\). The first player who cannot move anymore loses.\n\nAn integer \\(n \\geqslant k\\) is called good if Banana has a winning strategy when the initial number is \\(n\\), and bad otherwise.\n\nConsider two integers \\(n, n^{\\prime} \\geqslant k\\) with the property that each prime number \\(p \\leqslant k\\) divides \\(n\\) if and only if it divides \\(n^{\\prime}\\). Prove that either both \\(n\\) and \\(n^{\\prime}\\) are good or both are bad.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-n6", "question": "N6. Determine all functions \\(f: \\mathbb{Q} \\longrightarrow \\mathbb{Z}\\) satisfying\n\n\\[\nf\\left(\\frac{f(x)+a}{b}\\right)=f\\left(\\frac{x+a}{b}\\right)\n\\]\n\nfor all \\(x \\in \\mathbb{Q}, a \\in \\mathbb{Z}\\), and \\(b \\in \\mathbb{Z}_{>0}\\). (Here, \\(\\mathbb{Z}_{>0}\\) denotes the set of positive integers.)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-n7", "question": "N7. Let \\(\\nu\\) be an irrational positive number, and let \\(m\\) be a positive integer. A pair \\((a, b)\\) of positive integers is called good if\n\n\\[\na\\lceil b \\nu\\rceil-b\\lfloor a \\nu\\rfloor=m .\n\\]\n\nA good pair \\((a, b)\\) is called excellent if neither of the pairs \\((a-b, b)\\) and \\((a, b-a)\\) is good. (As usual, by \\(\\lfloor x\\rfloor\\) and \\(\\lceil x\\rceil\\) we denote the integer numbers such that \\(x-1<\\lfloor x\\rfloor \\leqslant x\\) and \\(x \\leqslant\\lceil x\\rceil<x+1\\).) Prove that the number of excellent pairs is equal to the sum of the positive divisors of \\(m\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2013, "solution": ""}
{"id": "imo-shortlist-2013-a1", "question": "A1. Let \\(n\\) be a positive integer and let \\(a_{1}, \\ldots, a_{n-1}\\) be arbitrary real numbers. Define the sequences \\(u_{0}, \\ldots, u_{n}\\) and \\(v_{0}, \\ldots, v_{n}\\) inductively by \\(u_{0}=u_{1}=v_{0}=v_{1}=1\\), and\n\n\\[\nu_{k+1}=u_{k}+a_{k} u_{k-1}, \\quad v_{k+1}=v_{k}+a_{n-k} v_{k-1} \\quad \\text { for } k=1, \\ldots, n-1 .\n\\]\n\nProve that \\(u_{n}=v_{n}\\).\n(France)", "category": "Algebra", "source": "IMO Shortlist", "year": 2013, "solution": "We prove by induction on \\(k\\) that\n\n\\[\nu_{k}=\\sum_{\\substack{0<i_{1}<\\ldots<i_{t}<k, i_{j+1}-i_{j} \\geqslant 2}} a_{i_{1}} \\ldots a_{i_{t}}\n\\]\n\nNote that we have one trivial summand equal to 1 (which corresponds to \\(t=0\\) and the empty sequence, whose product is 1 ).\n\nFor \\(k=0,1\\) the sum on the right-hand side only contains the empty product, so (1) holds due to \\(u_{0}=u_{1}=1\\). For \\(k \\geqslant 1\\), assuming the result is true for \\(0,1, \\ldots, k\\), we have\n\n\\[\n\\begin{aligned}\nu_{k+1} & =\\sum_{\\substack{0<i_{1}<\\ldots<i_{t}<k, i_{j+1}-i_{j} \\geqslant 2}} a_{i_{1}} \\ldots a_{i_{t}}+\\sum_{\\substack{0<i_{1}<\\ldots<i_{t}<k-1, i_{j+1}-i_{j} \\geqslant 2}} a_{i_{1}} \\ldots a_{i_{t}} \\cdot a_{k} \n& =\\sum_{\\substack{0<i_{1}<\\ldots<i_{t}<k+1, i_{j+1}-i_{j} \\geqslant 2, k \\notin\\left\\{i_{1}, \\ldots, i_{t}\\right\\}}} a_{i_{1}} \\ldots a_{i_{t}}+\\sum_{\\substack{0<i_{1}<\\ldots<i_{t}<k+1, i_{j+1}-i_{j} \\geqslant 2, k \\in\\left\\{i_{1}, \\ldots, i_{t}\\right\\}}} a_{i_{1}} \\ldots a_{i_{t}} \n& =\\sum_{\\substack{0<i_{1}<\\ldots<i_{t}<k+1, i_{j+1}-i_{j} \\geqslant 2}} a_{i_{1}} \\ldots a_{i_{t}},\n\n\\]\n\nas required.\nApplying (1) to the sequence \\(b_{1}, \\ldots, b_{n}\\) given by \\(b_{k}=a_{n-k}\\) for \\(1 \\leqslant k \\leqslant n\\), we get\n\n\\[\nv_{k}=\\sum_{\\substack{0<i_{1} \\ldots<i_{t}<k, i_{j+1}-i_{j} \\geqslant 2}} b_{i_{1}} \\ldots b_{i_{t}}=\\sum_{\\substack{n>i_{1}>\\ldots>i_{t}>n-k, i_{j}-i_{j+1} \\geqslant 2}} a_{i_{1}} \\ldots a_{i_{t}} .\n\\]\n\nFor \\(k=n\\) the expressions (1) and (2) coincide, so indeed \\(u_{n}=v_{n}\\).\nSolution 2. Define recursively a sequence of multivariate polynomials by\n\n\\[\nP_{0}=P_{1}=1, \\quad P_{k+1}\\left(x_{1}, \\ldots, x_{k}\\right)=P_{k}\\left(x_{1}, \\ldots, x_{k-1}\\right)+x_{k} P_{k-1}\\left(x_{1}, \\ldots, x_{k-2}\\right),\n\\]\n\nso \\(P_{n}\\) is a polynomial in \\(n-1\\) variables for each \\(n \\geqslant 1\\). Two easy inductive arguments show that\n\n\\[\nu_{n}=P_{n}\\left(a_{1}, \\ldots, a_{n-1}\\right), \\quad v_{n}=P_{n}\\left(a_{n-1}, \\ldots, a_{1}\\right)\n\\]\n\nso we need to prove \\(P_{n}\\left(x_{1}, \\ldots, x_{n-1}\\right)=P_{n}\\left(x_{n-1}, \\ldots, x_{1}\\right)\\) for every positive integer \\(n\\). The cases \\(n=1,2\\) are trivial, and the cases \\(n=3,4\\) follow from \\(P_{3}(x, y)=1+x+y\\) and \\(P_{4}(x, y, z)=\\) \\(1+x+y+z+x z\\).\n\nNow we proceed by induction, assuming that \\(n \\geqslant 5\\) and the claim hold for all smaller cases. Using \\(F(a, b)\\) as an abbreviation for \\(P_{|a-b|+1}\\left(x_{a}, \\ldots, x_{b}\\right)\\) (where the indices \\(a, \\ldots, b\\) can be either in increasing or decreasing order),\n\n\\[\n\\begin{aligned}\nF(n, 1) & =F(n, 2)+x_{1} F(n, 3)=F(2, n)+x_{1} F(3, n) \n& =\\left(F(2, n-1)+x_{n} F(2, n-2)\\right)+x_{1}\\left(F(3, n-1)+x_{n} F(3, n-2)\\right) \n& =\\left(F(n-1,2)+x_{1} F(n-1,3)\\right)+x_{n}\\left(F(n-2,2)+x_{1} F(n-2,3)\\right) \n& =F(n-1,1)+x_{n} F(n-2,1)=F(1, n-1)+x_{n} F(1, n-2) \n& =F(1, n),\n\n\\]\n\nas we wished to show.\nSolution 3. Using matrix notation, we can rewrite the recurrence relation as\n\n\\[\n\\binom{u_{k+1}}{u_{k+1}-u_{k}}=\\binom{u_{k}+a_{k} u_{k-1}}{a_{k} u_{k-1}}=\\left(\\begin{array}{cc}\n1+a_{k} & -a_{k} \na_{k} & -a_{k}\n\\right)\\binom{u_{k}}{u_{k}-u_{k-1}}\n\\]\n\nfor \\(1 \\leqslant k \\leqslant n-1\\), and similarly\n\n\\[\n\\left(v_{k+1} ; v_{k}-v_{k+1}\\right)=\\left(v_{k}+a_{n-k} v_{k-1} ;-a_{n-k} v_{k-1}\\right)=\\left(v_{k} ; v_{k-1}-v_{k}\\right)\\left(\\begin{array}{cc}\n1+a_{n-k} & -a_{n-k} \na_{n-k} & -a_{n-k}\n\\right)\n\\]\n\nfor \\(1 \\leqslant k \\leqslant n-1\\). Hence, introducing the \\(2 \\times 2\\) matrices \\(A_{k}=\\left(\\begin{array}{cc}1+a_{k} & -a_{k} \\\\ a_{k} & -a_{k}\\right)\\) we have\n\n\\[\n\\binom{u_{k+1}}{u_{k+1}-u_{k}}=A_{k}\\binom{u_{k}}{u_{k}-u_{k-1}} \\quad \\text { and } \\quad\\left(v_{k+1} ; v_{k}-v_{k+1}\\right)=\\left(v_{k} ; v_{k-1}-v_{k}\\right) A_{n-k}\n\\]\n\nfor \\(1 \\leqslant k \\leqslant n-1\\). Since \\(\\binom{u_{1}}{u_{1}-u_{0}}=\\binom{1}{0}\\) and \\(\\left(v_{1} ; v_{0}-v_{1}\\right)=(1 ; 0)\\), we get\n\n\\[\n\\binom{u_{n}}{u_{n}-u_{n-1}}=A_{n-1} A_{n-2} \\cdots A_{1} \\cdot\\binom{1}{0} \\quad \\text { and } \\quad\\left(v_{n} ; v_{n-1}-v_{n}\\right)=(1 ; 0) \\cdot A_{n-1} A_{n-2} \\cdots A_{1}\n\\]\n\nIt follows that\n\n\\[\n\\left(u_{n}\\right)=(1 ; 0)\\binom{u_{n}}{u_{n}-u_{n-1}}=(1 ; 0) \\cdot A_{n-1} A_{n-2} \\cdots A_{1} \\cdot\\binom{1}{0}=\\left(v_{n} ; v_{n-1}-v_{n}\\right)\\binom{1}{0}=\\left(v_{n}\\right)\n\\]\n\nComment 1. These sequences are related to the Fibonacci sequence; when \\(a_{1}=\\cdots=a_{n-1}=1\\), we have \\(u_{k}=v_{k}=F_{k+1}\\), the ( \\(k+1\\) )st Fibonacci number. Also, for every positive integer \\(k\\), the polynomial \\(P_{k}\\left(x_{1}, \\ldots, x_{k-1}\\right)\\) from Solution 2 is the sum of \\(F_{k+1}\\) monomials.\n\nComment 2. One may notice that the condition is equivalent to\n\n\\[\n\\frac{u_{k+1}}{u_{k}}=1+\\frac{a_{k}}{1+\\frac{a_{k-1}}{1+\\ldots+\\frac{a_{2}}{1+a_{1}}}} \\quad \\text { and } \\quad \\frac{v_{k+1}}{v_{k}}=1+\\frac{a_{n-k}}{1+\\frac{a_{n-k+1}}{1+\\ldots+\\frac{a_{n-2}}{1+a_{n-1}}}}\n\\]\n\nso the problem claims that the corresponding continued fractions for \\(u_{n} / u_{n-1}\\) and \\(v_{n} / v_{n-1}\\) have the same numerator.\n\nComment 3. An alternative variant of the problem is the following.\nLet \\(n\\) be a positive integer and let \\(a_{1}, \\ldots, a_{n-1}\\) be arbitrary real numbers. Define the sequences \\(u_{0}, \\ldots, u_{n}\\) and \\(v_{0}, \\ldots, v_{n}\\) inductively by \\(u_{0}=v_{0}=0, u_{1}=v_{1}=1\\), and\n\n\\[\nu_{k+1}=a_{k} u_{k}+u_{k-1}, \\quad v_{k+1}=a_{n-k} v_{k}+v_{k-1} \\quad \\text { for } k=1, \\ldots, n-1 .\n\\]\n\nProve that \\(u_{n}=v_{n}\\).\nAll three solutions above can be reformulated to prove this statement; one may prove\n\n\\[\nu_{n}=v_{n}=\\sum_{\\substack{0=i_{0}<i_{1}<\\ldots<i_{t}=n, i_{j+1}-i_{j} \\text { is odd }}} a_{i_{1}} \\ldots a_{i_{t-1}} \\quad \\text { for } n>0\n\\]\n\nor observe that\n\n\\[\n\\binom{u_{k+1}}{u_{k}}=\\left(\\begin{array}{cc}\na_{k} & 1 \n1 & 0\n\\right)\\binom{u_{k}}{u_{k-1}} \\quad \\text { and } \\quad\\left(v_{k+1} ; v_{k}\\right)=\\left(v_{k} ; v_{k-1}\\right)\\left(\\begin{array}{cc}\na_{k} & 1 \n1 & 0\n\\right) .\n\\]\n\nHere we have\n\n\\[\n\\frac{u_{k+1}}{u_{k}}=a_{k}+\\frac{1}{a_{k-1}+\\frac{1}{a_{k-2}+\\ldots+\\frac{1}{a_{1}}}}=\\left[a_{k} ; a_{k-1}, \\ldots, a_{1}\\right]\n\\]\n\nand\n\n\\[\n\\frac{v_{k+1}}{v_{k}}=a_{n-k}+\\frac{1}{a_{n-k+1}+\\frac{1}{a_{n-k+2}+\\ldots+\\frac{1}{a_{n-1}}}}=\\left[a_{n-k} ; a_{n-k+1}, \\ldots, a_{n-1}\\right]\n\\]\n\nso this alternative statement is equivalent to the known fact that the continued fractions \\(\\left[a_{n-1} ; a_{n-2}, \\ldots, a_{1}\\right]\\) and \\(\\left[a_{1} ; a_{2}, \\ldots, a_{n-1}\\right]\\) have the same numerator."}
{"id": "imo-shortlist-2013-a2", "question": "A2. Prove that in any set of 2000 distinct real numbers there exist two pairs \\(a>b\\) and \\(c>d\\) with \\(a \\neq c\\) or \\(b \\neq d\\), such that\n\n\\[\n\\left|\\frac{a-b}{c-d}-1\\right|<\\frac{1}{100000}\n\\]\n\n(Lithuania)", "category": "Algebra", "source": "IMO Shortlist", "year": 2013, "solution": "For any set \\(S\\) of \\(n=2000\\) distinct real numbers, let \\(D_{1} \\leqslant D_{2} \\leqslant \\cdots \\leqslant D_{m}\\) be the distances between them, displayed with their multiplicities. Here \\(m=n(n-1) / 2\\). By rescaling the numbers, we may assume that the smallest distance \\(D_{1}\\) between two elements of \\(S\\) is \\(D_{1}=1\\). Let \\(D_{1}=1=y-x\\) for \\(x, y \\in S\\). Evidently \\(D_{m}=v-u\\) is the difference between the largest element \\(v\\) and the smallest element \\(u\\) of \\(S\\).\n\nIf \\(D_{i+1} / D_{i}<1+10^{-5}\\) for some \\(i=1,2, \\ldots, m-1\\) then the required inequality holds, because \\(0 \\leqslant D_{i+1} / D_{i}-1<10^{-5}\\). Otherwise, the reverse inequality\n\n\\[\n\\frac{D_{i+1}}{D_{i}} \\geqslant 1+\\frac{1}{10^{5}}\n\\]\n\nholds for each \\(i=1,2, \\ldots, m-1\\), and therefore\n\n\\[\nv-u=D_{m}=\\frac{D_{m}}{D_{1}}=\\frac{D_{m}}{D_{m-1}} \\cdots \\frac{D_{3}}{D_{2}} \\cdot \\frac{D_{2}}{D_{1}} \\geqslant\\left(1+\\frac{1}{10^{5}}\\right)^{m-1}\n\\]\n\nFrom \\(m-1=n(n-1) / 2-1=1000 \\cdot 1999-1>19 \\cdot 10^{5}\\), together with the fact that for all \\(n \\geqslant 1\\), \\(\\left(1+\\frac{1}{n}\\right)^{n} \\geqslant 1+\\binom{n}{1} \\cdot \\frac{1}{n}=2\\), we get\n\n\\[\n\\left(1+\\frac{1}{10^{5}}\\right)^{19 \\cdot 10^{5}}=\\left(\\left(1+\\frac{1}{10^{5}}\\right)^{10^{5}}\\right)^{19} \\geqslant 2^{19}=2^{9} \\cdot 2^{10}>500 \\cdot 1000>2 \\cdot 10^{5}\n\\]\n\nand so \\(v-u=D_{m}>2 \\cdot 10^{5}\\).\nSince the distance of \\(x\\) to at least one of the numbers \\(u, v\\) is at least \\((u-v) / 2>10^{5}\\), we have\n\n\\[\n|x-z|>10^{5}\n\\]\n\nfor some \\(z \\in\\{u, v\\}\\). Since \\(y-x=1\\), we have either \\(z>y>x\\) (if \\(z=v\\) ) or \\(y>x>z\\) (if \\(z=u\\) ). If \\(z>y>x\\), selecting \\(a=z, b=y, c=z\\) and \\(d=x\\) (so that \\(b \\neq d\\) ), we obtain\n\n\\[\n\\left|\\frac{a-b}{c-d}-1\\right|=\\left|\\frac{z-y}{z-x}-1\\right|=\\left|\\frac{x-y}{z-x}\\right|=\\frac{1}{z-x}<10^{-5}\n\\]\n\nOtherwise, if \\(y>x>z\\), we may choose \\(a=y, b=z, c=x\\) and \\(d=z\\) (so that \\(a \\neq c\\) ), and obtain\n\n\\[\n\\left|\\frac{a-b}{c-d}-1\\right|=\\left|\\frac{y-z}{x-z}-1\\right|=\\left|\\frac{y-x}{x-z}\\right|=\\frac{1}{x-z}<10^{-5}\n\\]\n\nThe desired result follows.\nComment. As the solution shows, the numbers 2000 and \\(\\frac{1}{100000}\\) appearing in the statement of the problem may be replaced by any \\(n \\in \\mathbb{Z}_{>0}\\) and \\(\\delta>0\\) satisfying\n\n\\[\n\\delta(1+\\delta)^{n(n-1) / 2-1}>2\n\\]"}
{"id": "imo-shortlist-2013-a3", "question": "A3. Let \\(\\mathbb{Q}_{>0}\\) be the set of positive rational numbers. Let \\(f: \\mathbb{Q}_{>0} \\rightarrow \\mathbb{R}\\) be a function satisfying the conditions\n\n\\[\n\\begin{aligned}\n& f(x) f(y) \\geqslant f(x y) \n& f(x+y) \\geqslant f(x)+f(y)\n\n\\]\n\nfor all \\(x, y \\in \\mathbb{Q}_{>0}\\). Given that \\(f(a)=a\\) for some rational \\(a>1\\), prove that \\(f(x)=x\\) for all \\(x \\in \\mathbb{Q}_{>0}\\).\n(Bulgaria)", "category": "Algebra", "source": "IMO Shortlist", "year": 2013, "solution": "Denote by \\(\\mathbb{Z}_{>0}\\) the set of positive integers.\nPlugging \\(x=1, y=a\\) into (1) we get \\(f(1) \\geqslant 1\\). Next, by an easy induction on \\(n\\) we get from (2) that\n\n\\[\nf(n x) \\geqslant n f(x) \\quad \\text { for all } n \\in \\mathbb{Z}_{>0} \\text { and } x \\in \\mathbb{Q}_{>0}\n\\]\n\nIn particular, we have\n\n\\[\nf(n) \\geqslant n f(1) \\geqslant n \\quad \\text { for all } n \\in \\mathbb{Z}_{>0}\n\\]\n\nFrom (1) again we have \\(f(m / n) f(n) \\geqslant f(m)\\), so \\(f(q)>0\\) for all \\(q \\in \\mathbb{Q}_{>0}\\).\nNow, (2) implies that \\(f\\) is strictly increasing; this fact together with (4) yields\n\n\\[\nf(x) \\geqslant f(\\lfloor x\\rfloor) \\geqslant\\lfloor x\\rfloor>x-1 \\quad \\text { for all } x \\geqslant 1\n\\]\n\nBy an easy induction we get from (1) that \\(f(x)^{n} \\geqslant f\\left(x^{n}\\right)\\), so\n\n\\[\nf(x)^{n} \\geqslant f\\left(x^{n}\\right)>x^{n}-1 \\quad \\Longrightarrow \\quad f(x) \\geqslant \\sqrt[n]{x^{n}-1} \\quad \\text { for all } x>1 \\text { and } n \\in \\mathbb{Z}_{>0}\n\\]\n\nThis yields\n\n\\[\nf(x) \\geqslant x \\quad \\text { for every } x>1\n\\]\n\n(Indeed, if \\(x>y>1\\) then \\(x^{n}-y^{n}=(x-y)\\left(x^{n-1}+x^{n-2} y+\\cdots+y^{n}\\right)>n(x-y)\\), so for a large \\(n\\) we have \\(x^{n}-1>y^{n}\\) and thus \\(f(x)>y\\).)\n\nNow, (1) and (5) give \\(a^{n}=f(a)^{n} \\geqslant f\\left(a^{n}\\right) \\geqslant a^{n}\\), so \\(f\\left(a^{n}\\right)=a^{n}\\). Now, for \\(x>1\\) let us choose \\(n \\in \\mathbb{Z}_{>0}\\) such that \\(a^{n}-x>1\\). Then by (2) and (5) we get\n\n\\[\na^{n}=f\\left(a^{n}\\right) \\geqslant f(x)+f\\left(a^{n}-x\\right) \\geqslant x+\\left(a^{n}-x\\right)=a^{n}\n\\]\n\nand therefore \\(f(x)=x\\) for \\(x>1\\). Finally, for every \\(x \\in \\mathbb{Q}_{>0}\\) and every \\(n \\in \\mathbb{Z}_{>0}\\), from (1) and (3) we get\n\n\\[\nn f(x)=f(n) f(x) \\geqslant f(n x) \\geqslant n f(x)\n\\]\n\nwhich gives \\(f(n x)=n f(x)\\). Therefore \\(f(m / n)=f(m) / n=m / n\\) for all \\(m, n \\in \\mathbb{Z}_{>0}\\).\nComment. The condition \\(f(a)=a>1\\) is essential. Indeed, for \\(b \\geqslant 1\\) the function \\(f(x)=b x^{2}\\) satisfies (1) and (2) for all \\(x, y \\in \\mathbb{Q}_{>0}\\), and it has a unique fixed point \\(1 / b \\leqslant 1\\)."}
{"id": "imo-shortlist-2013-a4", "question": "A4. Let \\(n\\) be a positive integer, and consider a sequence \\(a_{1}, a_{2}, \\ldots, a_{n}\\) of positive integers. Extend it periodically to an infinite sequence \\(a_{1}, a_{2}, \\ldots\\) by defining \\(a_{n+i}=a_{i}\\) for all \\(i \\geqslant 1\\). If\n\n\\[\na_{1} \\leqslant a_{2} \\leqslant \\cdots \\leqslant a_{n} \\leqslant a_{1}+n\n\\]\n\nand\n\n\\[\na_{a_{i}} \\leqslant n+i-1 \\quad \\text { for } i=1,2, \\ldots, n\n\\]\n\nprove that\n\n\\[\na_{1}+\\cdots+a_{n} \\leqslant n^{2}\n\\]", "category": "Algebra", "source": "IMO Shortlist", "year": 2013, "solution": "First, we claim that\n\n\\[\na_{i} \\leqslant n+i-1 \\quad \\text { for } i=1,2, \\ldots, n\n\\]\n\nAssume contrariwise that \\(i\\) is the smallest counterexample. From \\(a_{n} \\geqslant a_{n-1} \\geqslant \\cdots \\geqslant a_{i} \\geqslant n+i\\) and \\(a_{a_{i}} \\leqslant n+i-1\\), taking into account the periodicity of our sequence, it follows that\n\n\\[\na_{i} \\text { cannot be congruent to } i, i+1, \\ldots, n-1 \\text {, or } n \\quad(\\bmod n) \\text {. }\n\\]\n\nThus our assumption that \\(a_{i} \\geqslant n+i\\) implies the stronger statement that \\(a_{i} \\geqslant 2 n+1\\), which by \\(a_{1}+n \\geqslant a_{n} \\geqslant a_{i}\\) gives \\(a_{1} \\geqslant n+1\\). The minimality of \\(i\\) then yields \\(i=1\\), and (4) becomes contradictory. This establishes our first claim.\n\nIn particular we now know that \\(a_{1} \\leqslant n\\). If \\(a_{n} \\leqslant n\\), then \\(a_{1} \\leqslant \\cdots \\leqslant \\cdots a_{n} \\leqslant n\\) and the desired inequality holds trivially. Otherwise, consider the number \\(t\\) with \\(1 \\leqslant t \\leqslant n-1\\) such that\n\n\\[\na_{1} \\leqslant a_{2} \\leqslant \\ldots \\leqslant a_{t} \\leqslant n<a_{t+1} \\leqslant \\ldots \\leqslant a_{n}\n\\]\n\nSince \\(1 \\leqslant a_{1} \\leqslant n\\) and \\(a_{a_{1}} \\leqslant n\\) by (2), we have \\(a_{1} \\leqslant t\\) and hence \\(a_{n} \\leqslant n+t\\). Therefore if for each positive integer \\(i\\) we let \\(b_{i}\\) be the number of indices \\(j \\in\\{t+1, \\ldots, n\\}\\) satisfying \\(a_{j} \\geqslant n+i\\), we have\n\n\\[\nb_{1} \\geqslant b_{2} \\geqslant \\ldots \\geqslant b_{t} \\geqslant b_{t+1}=0\n\\]\n\nNext we claim that \\(a_{i}+b_{i} \\leqslant n\\) for \\(1 \\leqslant i \\leqslant t\\). Indeed, by \\(n+i-1 \\geqslant a_{a_{i}}\\) and \\(a_{i} \\leqslant n\\), each \\(j\\) with \\(a_{j} \\geqslant n+i\\) (thus \\(a_{j}>a_{a_{i}}\\) ) belongs to \\(\\left\\{a_{i}+1, \\ldots, n\\right\\}\\), and for this reason \\(b_{i} \\leqslant n-a_{i}\\).\n\nIt follows from the definition of the \\(b_{i} \\mathrm{~s}\\) and (5) that\n\n\\[\na_{t+1}+\\ldots+a_{n} \\leqslant n(n-t)+b_{1}+\\ldots+b_{t}\n\\]\n\nAdding \\(a_{1}+\\ldots+a_{t}\\) to both sides and using that \\(a_{i}+b_{i} \\leqslant n\\) for \\(1 \\leqslant i \\leqslant t\\), we get\n\n\\[\na_{1}+a_{2}+\\cdots+a_{n} \\leqslant n(n-t)+n t=n^{2}\n\\]\n\nas we wished to prove.\n\nSolution 2. In the first quadrant of an infinite grid, consider the increasing \"staircase\" obtained by shading in dark the bottom \\(a_{i}\\) cells of the \\(i\\) th column for \\(1 \\leqslant i \\leqslant n\\). We will prove that there are at most \\(n^{2}\\) dark cells.\n\nTo do it, consider the \\(n \\times n\\) square \\(S\\) in the first quadrant with a vertex at the origin. Also consider the \\(n \\times n\\) square directly to the left of \\(S\\). Starting from its lower left corner, shade in light the leftmost \\(a_{j}\\) cells of the \\(j\\) th row for \\(1 \\leqslant j \\leqslant n\\). Equivalently, the light shading is obtained by reflecting the dark shading across the line \\(x=y\\) and translating it \\(n\\) units to the left. The figure below illustrates this construction for the sequence \\(6,6,6,7,7,7,8,12,12,14\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-14}\n\nWe claim that there is no cell in \\(S\\) which is both dark and light. Assume, contrariwise, that there is such a cell in column \\(i\\). Consider the highest dark cell in column \\(i\\) which is inside \\(S\\). Since it is above a light cell and inside \\(S\\), it must be light as well. There are two cases:\n\nCase 1. \\(a_{i} \\leqslant n\\)\nIf \\(a_{i} \\leqslant n\\) then this dark and light cell is \\(\\left(i, a_{i}\\right)\\), as highlighted in the figure. However, this is the \\((n+i)\\)-th cell in row \\(a_{i}\\), and we only shaded \\(a_{a_{i}}<n+i\\) light cells in that row, a contradiction.\n\nCase 2. \\(a_{i} \\geqslant n+1\\)\nIf \\(a_{i} \\geqslant n+1\\), this dark and light cell is ( \\(i, n\\) ). This is the ( \\(n+i\\) )-th cell in row \\(n\\) and we shaded \\(a_{n} \\leqslant a_{1}+n\\) light cells in this row, so we must have \\(i \\leqslant a_{1}\\). But \\(a_{1} \\leqslant a_{a_{1}} \\leqslant n\\) by (1) and (2), so \\(i \\leqslant a_{1}\\) implies \\(a_{i} \\leqslant a_{a_{1}} \\leqslant n\\), contradicting our assumption.\n\nWe conclude that there are no cells in \\(S\\) which are both dark and light. It follows that the number of shaded cells in \\(S\\) is at most \\(n^{2}\\).\n\nFinally, observe that if we had a light cell to the right of \\(S\\), then by symmetry we would have a dark cell above \\(S\\), and then the cell ( \\(n, n\\) ) would be dark and light. It follows that the number of light cells in \\(S\\) equals the number of dark cells outside of \\(S\\), and therefore the number of shaded cells in \\(S\\) equals \\(a_{1}+\\cdots+a_{n}\\). The desired result follows.\n\nSolution 3. As in Solution 1, we first establish that \\(a_{i} \\leqslant n+i-1\\) for \\(1 \\leqslant i \\leqslant n\\). Now define \\(c_{i}=\\max \\left(a_{i}, i\\right)\\) for \\(1 \\leqslant i \\leqslant n\\) and extend the sequence \\(c_{1}, c_{2}, \\ldots\\) periodically modulo \\(n\\). We claim that this sequence also satisfies the conditions of the problem.\n\nFor \\(1 \\leqslant i<j \\leqslant n\\) we have \\(a_{i} \\leqslant a_{j}\\) and \\(i<j\\), so \\(c_{i} \\leqslant c_{j}\\). Also \\(a_{n} \\leqslant a_{1}+n\\) and \\(n<1+n\\) imply \\(c_{n} \\leqslant c_{1}+n\\). Finally, the definitions imply that \\(c_{c_{i}} \\in\\left\\{a_{a_{i}}, a_{i}, a_{i}-n, i\\right\\}\\) so \\(c_{c_{i}} \\leqslant n+i-1\\) by (2) and (3). This establishes (1) and (2) for \\(c_{1}, c_{2}, \\ldots\\).\n\nOur new sequence has the additional property that\n\n\\[\nc_{i} \\geqslant i \\quad \\text { for } i=1,2, \\ldots, n,\n\\]\n\nwhich allows us to construct the following visualization: Consider \\(n\\) equally spaced points on a circle, sequentially labelled \\(1,2, \\ldots, n(\\bmod n)\\), so point \\(k\\) is also labelled \\(n+k\\). We draw arrows from vertex \\(i\\) to vertices \\(i+1, \\ldots, c_{i}\\) for \\(1 \\leqslant i \\leqslant n\\), keeping in mind that \\(c_{i} \\geqslant i\\) by (6). Since \\(c_{i} \\leqslant n+i-1\\) by (3), no arrow will be drawn twice, and there is no arrow from a vertex to itself. The total number of arrows is\n\n\\[\n\\text { number of arrows }=\\sum_{i=1}^{n}\\left(c_{i}-i\\right)=\\sum_{i=1}^{n} c_{i}-\\binom{n+1}{2}\n\\]\n\nNow we show that we never draw both arrows \\(i \\rightarrow j\\) and \\(j \\rightarrow i\\) for \\(1 \\leqslant i<j \\leqslant n\\). Assume contrariwise. This means, respectively, that\n\n\\[\ni<j \\leqslant c_{i} \\quad \\text { and } \\quad j<n+i \\leqslant c_{j}\n\\]\n\nWe have \\(n+i \\leqslant c_{j} \\leqslant c_{1}+n\\) by (1), so \\(i \\leqslant c_{1}\\). Since \\(c_{1} \\leqslant n\\) by (3), this implies that \\(c_{i} \\leqslant c_{c_{1}} \\leqslant n\\) using (1) and (3). But then, using (1) again, \\(j \\leqslant c_{i} \\leqslant n\\) implies \\(c_{j} \\leqslant c_{c_{i}}\\), which combined with \\(n+i \\leqslant c_{j}\\) gives us that \\(n+i \\leqslant c_{c_{i}}\\). This contradicts (2).\n\nThis means that the number of arrows is at most \\(\\binom{n}{2}\\), which implies that\n\n\\[\n\\sum_{i=1}^{n} c_{i} \\leqslant\\binom{ n}{2}+\\binom{n+1}{2}=n^{2}\n\\]\n\nRecalling that \\(a_{i} \\leqslant c_{i}\\) for \\(1 \\leqslant i \\leqslant n\\), the desired inequality follows.\nComment 1. We sketch an alternative proof by induction. Begin by verifying the initial case \\(n=1\\) and the simple cases when \\(a_{1}=1, a_{1}=n\\), or \\(a_{n} \\leqslant n\\). Then, as in Solution 1, consider the index \\(t\\) such that \\(a_{1} \\leqslant \\cdots \\leqslant a_{t} \\leqslant n<a_{t+1} \\leqslant \\cdots \\leqslant a_{n}\\). Observe again that \\(a_{1} \\leqslant t\\). Define the sequence \\(d_{1}, \\ldots, d_{n-1}\\) by\n\n\\[\nd_{i}= \\begin{cases}a_{i+1}-1 & \\text { if } i \\leqslant t-1 \\\\ a_{i+1}-2 & \\text { if } i \\geqslant t\n\\]\n\nand extend it periodically modulo \\(n-1\\). One may verify that this sequence also satisfies the hypotheses of the problem. The induction hypothesis then gives \\(d_{1}+\\cdots+d_{n-1} \\leqslant(n-1)^{2}\\), which implies that\n\n\\[\n\\sum_{i=1}^{n} a_{i}=a_{1}+\\sum_{i=2}^{t}\\left(d_{i-1}+1\\right)+\\sum_{i=t+1}^{n}\\left(d_{i-1}+2\\right) \\leqslant t+(t-1)+2(n-t)+(n-1)^{2}=n^{2}\n\\]\n\nComment 2. One unusual feature of this problem is that there are many different sequences for which equality holds. The discovery of such optimal sequences is not difficult, and it is useful in guiding the steps of a proof.\n\nIn fact, Solution 2 gives a complete description of the optimal sequences. Start with any lattice path \\(P\\) from the lower left to the upper right corner of the \\(n \\times n\\) square \\(S\\) using only steps up and right, such that the total number of steps along the left and top edges of \\(S\\) is at least \\(n\\). Shade the cells of \\(S\\) below \\(P\\) dark, and the cells of \\(S\\) above \\(P\\) light. Now reflect the light shape across the line \\(x=y\\) and shift it up \\(n\\) units, and shade it dark. As Solution 2 shows, the dark region will then correspond to an optimal sequence, and every optimal sequence arises in this way."}
{"id": "imo-shortlist-2013-a5", "question": "A5. Let \\(\\mathbb{Z}_{\\geqslant 0}\\) be the set of all nonnegative integers. Find all the functions \\(f: \\mathbb{Z}_{\\geqslant 0} \\rightarrow \\mathbb{Z}_{\\geqslant 0}\\) satisfying the relation\n\n\\[\nf(f(f(n)))=f(n+1)+1\n\\]\n\nfor all \\(n \\in \\mathbb{Z}_{\\geqslant 0}\\).\n(Serbia)\nAnswer. There are two such functions: \\(f(n)=n+1\\) for all \\(n \\in \\mathbb{Z}_{\\geqslant 0}\\), and\n\n\\[\nf(n)=\\left\\{\\begin{array}{ll}\nn+1, & n \\equiv 0(\\bmod 4) \\text { or } n \\equiv 2(\\bmod 4), \nn+5, & n \\equiv 1(\\bmod 4), \nn-3, & n \\equiv 3(\\bmod 4)\n \\quad \\text { for all } n \\in \\mathbb{Z}_{\\geqslant 0}\\right.\n\\]\n\nThroughout all the", "category": "Algebra", "source": "IMO Shortlist", "year": 2013, "solution": "s, we write \\(h^{k}(x)\\) to abbreviate the \\(k\\) th iteration of function \\(h\\), so \\(h^{0}\\) is the identity function, and \\(h^{k}(x)=\\underbrace{h(\\ldots h(x) \\ldots))}_{k \\text { times }}\\) for \\(k \\geqslant 1\\).\nSolution 1. To start, we get from (*) that\n\n\\[\nf^{4}(n)=f\\left(f^{3}(n)\\right)=f(f(n+1)+1) \\quad \\text { and } \\quad f^{4}(n+1)=f^{3}(f(n+1))=f(f(n+1)+1)+1,\n\\]\n\nthus\n\n\\[\nf^{4}(n)+1=f^{4}(n+1)\n\\]\n\nI. Let us denote by \\(R_{i}\\) the range of \\(f^{i}\\); note that \\(R_{0}=\\mathbb{Z}_{\\geqslant 0}\\) since \\(f^{0}\\) is the identity function. Obviously, \\(R_{0} \\supseteq R_{1} \\supseteq \\ldots\\). Next, from (2) we get that if \\(a \\in R_{4}\\) then also \\(a+1 \\in R_{4}\\). This implies that \\(\\mathbb{Z}_{\\geqslant 0} \\backslash R_{4}\\) - and hence \\(\\mathbb{Z}_{\\geqslant 0} \\backslash R_{1}\\) - is finite. In particular, \\(R_{1}\\) is unbounded.\n\nAssume that \\(f(m)=f(n)\\) for some distinct \\(m\\) and \\(n\\). Then from (\\textit{) we obtain \\(f(m+1)=\\) \\(f(n+1)\\); by an easy induction we then get that \\(f(m+c)=f(n+c)\\) for every \\(c \\geqslant 0\\). So the function \\(f(k)\\) is periodic with period \\(|m-n|\\) for \\(k \\geqslant m\\), and thus \\(R_{1}\\) should be bounded, which is false. So, \\(f\\) is injective.\nII. Denote now \\(S_{i}=R_{i-1} \\backslash R_{i}\\); all these sets are finite for \\(i \\leqslant 4\\). On the other hand, by the injectivity we have \\(n \\in S_{i} \\Longleftrightarrow f(n) \\in S_{i+1}\\). By the injectivity again, \\(f\\) implements a bijection between \\(S_{i}\\) and \\(S_{i+1}\\), thus \\(\\left|S_{1}\\right|=\\left|S_{2}\\right|=\\ldots\\); denote this common cardinality by \\(k\\). If \\(0 \\in R_{3}\\) then \\(0=f(f(f(n)))\\) for some \\(n\\), thus from (}) we get \\(f(n+1)=-1\\) which is impossible. Therefore \\(0 \\in R_{0} \\backslash R_{3}=S_{1} \\cup S_{2} \\cup S_{3}\\), thus \\(k \\geqslant 1\\).\n\nNext, let us describe the elements \\(b\\) of \\(R_{0} \\backslash R_{3}=S_{1} \\cup S_{2} \\cup S_{3}\\). We claim that each such element satisfies at least one of three conditions \\((i) b=0,(i i) b=f(0)+1\\), and \\((i i i) b-1 \\in S_{1}\\). Otherwise \\(b-1 \\in \\mathbb{Z}_{\\geqslant 0}\\), and there exists some \\(n>0\\) such that \\(f(n)=b-1\\); but then \\(f^{3}(n-1)=f(n)+1=b\\), so \\(b \\in R_{3}\\).\n\nThis yields\n\n\\[\n3 k=\\left|S_{1} \\cup S_{2} \\cup S_{3}\\right| \\leqslant 1+1+\\left|S_{1}\\right|=k+2\n\\]\n\nor \\(k \\leqslant 1\\). Therefore \\(k=1\\), and the inequality above comes to equality. So we have \\(S_{1}=\\{a\\}\\), \\(S_{2}=\\{f(a)\\}\\), and \\(S_{3}=\\left\\{f^{2}(a)\\right\\}\\) for some \\(a \\in \\mathbb{Z}_{\\geqslant 0}\\), and each one of the three options (i), (ii), and (iii) should be realized exactly once, which means that\n\n\\[\n\\left\\{a, f(a), f^{2}(a)\\right\\}=\\{0, a+1, f(0)+1\\}\n\\]\n\nIII. From (3), we get \\(a+1 \\in\\left\\{f(a), f^{2}(a)\\right\\}\\) (the case \\(a+1=a\\) is impossible). If \\(a+1=f^{2}(a)\\) then we have \\(f(a+1)=f^{3}(a)=f(a+1)+1\\) which is absurd. Therefore\n\n\\[\nf(a)=a+1\n\\]\n\nNext, again from (3) we have \\(0 \\in\\left\\{a, f^{2}(a)\\right\\}\\). Let us consider these two cases separately.\nCase 1. Assume that \\(a=0\\), then \\(f(0)=f(a)=a+1=1\\). Also from (3) we get \\(f(1)=f^{2}(a)=\\) \\(f(0)+1=2\\). Now, let us show that \\(f(n)=n+1\\) by induction on \\(n\\); the base cases \\(n \\leqslant 1\\) are established. Next, if \\(n \\geqslant 2\\) then the induction hypothesis implies\n\n\\[\nn+1=f(n-1)+1=f^{3}(n-2)=f^{2}(n-1)=f(n)\n\\]\n\nestablishing the step. In this case we have obtained the first of two answers; checking that is satisfies (*) is straightforward.\nCase 2. Assume now that \\(f^{2}(a)=0\\); then by (3) we get \\(a=f(0)+1\\). By (4) we get \\(f(a+1)=\\) \\(f^{2}(a)=0\\), then \\(f(0)=f^{3}(a)=f(a+1)+1=1\\), hence \\(a=f(0)+1=2\\) and \\(f(2)=3\\) by (4). To summarize,\n\n\\[\nf(0)=1, \\quad f(2)=3, \\quad f(3)=0\n\\]\n\nNow let us prove by induction on \\(m\\) that (1) holds for all \\(n=4 k, 4 k+2,4 k+3\\) with \\(k \\leqslant m\\) and for all \\(n=4 k+1\\) with \\(k<m\\). The base case \\(m=0\\) is established above. For the step, assume that \\(m \\geqslant 1\\). From (*) we get \\(f^{3}(4 m-3)=f(4 m-2)+1=4 m\\). Next, by (2) we have\n\n\\[\nf(4 m)=f^{4}(4 m-3)=f^{4}(4 m-4)+1=f^{3}(4 m-3)+1=4 m+1\n\\]\n\nThen by the induction hypothesis together with (*) we successively obtain\n\n\\[\n\\begin{aligned}\n& f(4 m-3)=f^{3}(4 m-1)=f(4 m)+1=4 m+2 \n& f(4 m+2)=f^{3}(4 m-4)=f(4 m-3)+1=4 m+3 \n& f(4 m+3)=f^{3}(4 m-3)=f(4 m-2)+1=4 m\n\n\\]\n\nthus finishing the induction step.\nFinally, it is straightforward to check that the constructed function works:\n\n\\[\n\\begin{aligned}\nf^{3}(4 k) & =4 k+7=f(4 k+1)+1, & & f^{3}(4 k+1)=4 k+4=f(4 k+2)+1 \nf^{3}(4 k+2) & =4 k+1=f(4 k+3)+1, & & f^{3}(4 k+3)=4 k+6=f(4 k+4)+1\n\n\\]\n\nSolution 2. I. For convenience, let us introduce the function \\(g(n)=f(n)+1\\). Substituting \\(f(n)\\) instead of \\(n\\) into (*) we obtain\n\n\\[\nf^{4}(n)=f(f(n)+1)+1, \\quad \\text { or } \\quad f^{4}(n)=g^{2}(n)\n\\]\n\nApplying \\(f\\) to both parts of (*) and using (5) we get\n\n\\[\nf^{4}(n)+1=f(f(n+1)+1)+1=f^{4}(n+1)\n\\]\n\nThus, if \\(g^{2}(0)=f^{4}(0)=c\\) then an easy induction on \\(n\\) shows that\n\n\\[\ng^{2}(n)=f^{4}(n)=n+c, \\quad n \\in \\mathbb{Z}_{\\geqslant 0}\n\\]\n\nThis relation implies that both \\(f\\) and \\(g\\) are injective: if, say, \\(f(m)=f(n)\\) then \\(m+c=\\) \\(f^{4}(m)=f^{4}(n)=n+c\\). Next, since \\(g(n) \\geqslant 1\\) for every \\(n\\), we have \\(c=g^{2}(0) \\geqslant 1\\). Thus from (7) again we obtain \\(f(n) \\neq n\\) and \\(g(n) \\neq n\\) for all \\(n \\in \\mathbb{Z}_{\\geqslant 0}\\).\nII. Next, application of \\(f\\) and \\(g\\) to (7) yields\n\n\\[\nf(n+c)=f^{5}(n)=f^{4}(f(n))=f(n)+c \\quad \\text { and } \\quad g(n+c)=g^{3}(n)=g(n)+c\n\\]\n\nIn particular, this means that if \\(m \\equiv n(\\bmod c)\\) then \\(f(m) \\equiv f(n)(\\bmod c)\\). Conversely, if \\(f(m) \\equiv f(n)(\\bmod c)\\) then we get \\(m+c=f^{4}(m) \\equiv f^{4}(n)=n+c(\\bmod c)\\). Thus,\n\n\\[\nm \\equiv n \\quad(\\bmod c) \\Longleftrightarrow f(m) \\equiv f(n) \\quad(\\bmod c) \\Longleftrightarrow g(m) \\equiv g(n) \\quad(\\bmod c) .\n\\]\n\nNow, let us introduce the function \\(\\delta(n)=f(n)-n=g(n)-n-1\\). Set\n\n\\[\nS=\\sum_{n=0}^{c-1} \\delta(n)\n\\]\n\nUsing (8), we get that for every complete residue system \\(n_{1}, \\ldots, n_{c}\\) modulo \\(c\\) we also have\n\n\\[\nS=\\sum_{i=1}^{c} \\delta\\left(n_{i}\\right)\n\\]\n\nBy (9), we get that \\(\\left\\{f^{k}(n): n=0, \\ldots, c-1\\right\\}\\) and \\(\\left\\{g^{k}(n): n=0, \\ldots, c-1\\right\\}\\) are complete residue systems modulo \\(c\\) for all \\(k\\). Thus we have\n\n\\[\nc^{2}=\\sum_{n=0}^{c-1}\\left(f^{4}(n)-n\\right)=\\sum_{k=0}^{3} \\sum_{n=0}^{c-1}\\left(f^{k+1}(n)-f^{k}(n)\\right)=\\sum_{k=0}^{3} \\sum_{n=0}^{c-1} \\delta\\left(f^{k}(n)\\right)=4 S\n\\]\n\nand similarly\n\n\\[\nc^{2}=\\sum_{n=0}^{c-1}\\left(g^{2}(n)-n\\right)=\\sum_{k=0}^{1} \\sum_{n=0}^{c-1}\\left(g^{k+1}(n)-g^{k}(n)\\right)=\\sum_{k=0}^{1} \\sum_{n=0}^{c-1}\\left(\\delta\\left(g^{k}(n)\\right)+1\\right)=2 S+2 c\n\\]\n\nTherefore \\(c^{2}=4 S=2 \\cdot 2 S=2\\left(c^{2}-2 c\\right)\\), or \\(c^{2}=4 c\\). Since \\(c \\neq 0\\), we get \\(c=4\\). Thus, in view of (8) it is sufficient to determine the values of \\(f\\) on the numbers \\(0,1,2,3\\).\nIII. Let \\(d=g(0) \\geqslant 1\\). Then \\(g(d)=g^{2}(0)=0+c=4\\). Now, if \\(d \\geqslant 4\\), then we would have \\(g(d-4)=g(d)-4=0\\) which is impossible. Thus \\(d \\in\\{1,2,3\\}\\). If \\(d=1\\) then we have \\(f(0)=g(0)-1=0\\) which is impossible since \\(f(n) \\neq n\\) for all \\(n\\). If \\(d=3\\) then \\(g(3)=g^{2}(0)=4\\) and hence \\(f(3)=3\\) which is also impossible. Thus \\(g(0)=2\\) and hence \\(g(2)=g^{2}(0)=4\\).\n\nNext, if \\(g(1)=1+4 k\\) for some integer \\(k\\), then \\(5=g^{2}(1)=g(1+4 k)=g(1)+4 k=1+8 k\\) which is impossible. Thus, since \\(\\{g(n): n=0,1,2,3\\}\\) is a complete residue system modulo 4 , we get \\(g(1)=3+4 k\\) and hence \\(g(3)=g^{2}(1)-4 k=5-4 k\\), leading to \\(k=0\\) or \\(k=1\\). So, we obtain iether\n\n\\[\nf(0)=1, f(1)=2, f(2)=3, f(3)=4, \\quad \\text { or } \\quad f(0)=1, f(1)=6, f(2)=3, f(3)=0\n\\]\n\nthus arriving to the two functions listed in the answer.\nFinally, one can check that these two function work as in Solution 1. One may simplify the checking by noticing that (8) allows us to reduce it to \\(n=0,1,2,3\\)."}
{"id": "imo-shortlist-2013-a6", "question": "A6. Let \\(m \\neq 0\\) be an integer. Find all polynomials \\(P(x)\\) with real coefficients such that\n\n\\[\n\\left(x^{3}-m x^{2}+1\\right) P(x+1)+\\left(x^{3}+m x^{2}+1\\right) P(x-1)=2\\left(x^{3}-m x+1\\right) P(x)\n\\]\n\nfor all real numbers \\(x\\).\n(Serbia)\nAnswer. \\(P(x)=t x\\) for any real number \\(t\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2013, "solution": "Let \\(P(x)=a_{n} x^{n}+\\cdots+a_{0} x^{0}\\) with \\(a_{n} \\neq 0\\). Comparing the coefficients of \\(x^{n+1}\\) on both sides gives \\(a_{n}(n-2 m)(n-1)=0\\), so \\(n=1\\) or \\(n=2 m\\).\n\nIf \\(n=1\\), one easily verifies that \\(P(x)=x\\) is a solution, while \\(P(x)=1\\) is not. Since the given condition is linear in \\(P\\), this means that the linear solutions are precisely \\(P(x)=t x\\) for \\(t \\in \\mathbb{R}\\).\n\nNow assume that \\(n=2 m\\). The polynomial \\(x P(x+1)-(x+1) P(x)=(n-1) a_{n} x^{n}+\\cdots\\) has degree \\(n\\), and therefore it has at least one (possibly complex) root \\(r\\). If \\(r \\notin\\{0,-1\\}\\), define \\(k=P(r) / r=P(r+1) /(r+1)\\). If \\(r=0\\), let \\(k=P(1)\\). If \\(r=-1\\), let \\(k=-P(-1)\\). We now consider the polynomial \\(S(x)=P(x)-k x\\). It also satisfies (1) because \\(P(x)\\) and \\(k x\\) satisfy it. Additionally, it has the useful property that \\(r\\) and \\(r+1\\) are roots.\n\nLet \\(A(x)=x^{3}-m x^{2}+1\\) and \\(B(x)=x^{3}+m x^{2}+1\\). Plugging in \\(x=s\\) into (1) implies that:\nIf \\(s-1\\) and \\(s\\) are roots of \\(S\\) and \\(s\\) is not a root of \\(A\\), then \\(s+1\\) is a root of \\(S\\).\nIf \\(s\\) and \\(s+1\\) are roots of \\(S\\) and \\(s\\) is not a root of \\(B\\), then \\(s-1\\) is a root of \\(S\\).\nLet \\(a \\geqslant 0\\) and \\(b \\geqslant 1\\) be such that \\(r-a, r-a+1, \\ldots, r, r+1, \\ldots, r+b-1, r+b\\) are roots of \\(S\\), while \\(r-a-1\\) and \\(r+b+1\\) are not. The two statements above imply that \\(r-a\\) is a root of \\(B\\) and \\(r+b\\) is a root of \\(A\\).\n\nSince \\(r-a\\) is a root of \\(B(x)\\) and of \\(A(x+a+b)\\), it is also a root of their greatest common divisor \\(C(x)\\) as integer polynomials. If \\(C(x)\\) was a non-trivial divisor of \\(B(x)\\), then \\(B\\) would have a rational root \\(\\alpha\\). Since the first and last coefficients of \\(B\\) are \\(1, \\alpha\\) can only be 1 or -1 ; but \\(B(-1)=m>0\\) and \\(B(1)=m+2>0\\) since \\(n=2 m\\).\n\nTherefore \\(B(x)=A(x+a+b)\\). Writing \\(c=a+b \\geqslant 1\\) we compute\n\n\\[\n0=A(x+c)-B(x)=(3 c-2 m) x^{2}+c(3 c-2 m) x+c^{2}(c-m)\n\\]\n\nThen we must have \\(3 c-2 m=c-m=0\\), which gives \\(m=0\\), a contradiction. We conclude that \\(f(x)=t x\\) is the only solution.\n\nSolution 2. Multiplying (1) by \\(x\\), we rewrite it as\n\n\\[\nx\\left(x^{3}-m x^{2}+1\\right) P(x+1)+x\\left(x^{3}+m x^{2}+1\\right) P(x-1)=[(x+1)+(x-1)]\\left(x^{3}-m x+1\\right) P(x) .\n\\]\n\nAfter regrouping, it becomes\n\n\\[\n\\left(x^{3}-m x^{2}+1\\right) Q(x)=\\left(x^{3}+m x^{2}+1\\right) Q(x-1),\n\\]\n\nwhere \\(Q(x)=x P(x+1)-(x+1) P(x)\\). If \\(\\operatorname{deg} P \\geqslant 2\\) then \\(\\operatorname{deg} Q=\\operatorname{deg} P\\), so \\(Q(x)\\) has a finite multiset of complex roots, which we denote \\(R_{Q}\\). Each root is taken with its multiplicity. Then the multiset of complex roots of \\(Q(x-1)\\) is \\(R_{Q}+1=\\left\\{z+1: z \\in R_{Q}\\right\\}\\).\n\nLet \\(\\left\\{x_{1}, x_{2}, x_{3}\\right\\}\\) and \\(\\left\\{y_{1}, y_{2}, y_{3}\\right\\}\\) be the multisets of roots of the polynomials \\(A(x)=x^{3}-m x^{2}+1\\) and \\(B(x)=x^{3}+m x^{2}+1\\), respectively. From (2) we get the equality of multisets\n\n\\[\n\\left\\{x_{1}, x_{2}, x_{3}\\right\\} \\cup R_{Q}=\\left\\{y_{1}, y_{2}, y_{3}\\right\\} \\cup\\left(R_{Q}+1\\right)\n\\]\n\nFor every \\(r \\in R_{Q}\\), since \\(r+1\\) is in the set of the right hand side, we must have \\(r+1 \\in R_{Q}\\) or \\(r+1=x_{i}\\) for some \\(i\\). Similarly, since \\(r\\) is in the set of the left hand side, either \\(r-1 \\in R_{Q}\\) or \\(r=y_{i}\\) for some \\(i\\). This implies that, possibly after relabelling \\(y_{1}, y_{2}, y_{3}\\), all the roots of (2) may be partitioned into three chains of the form \\(\\left\\{y_{i}, y_{i}+1, \\ldots, y_{i}+k_{i}=x_{i}\\right\\}\\) for \\(i=1,2,3\\) and some integers \\(k_{1}, k_{2}, k_{3} \\geqslant 0\\).\n\nNow we analyze the roots of the polynomial \\(A_{a}(x)=x^{3}+a x^{2}+1\\). Using calculus or elementary methods, we find that the local extrema of \\(A_{a}(x)\\) occur at \\(x=0\\) and \\(x=-2 a / 3\\); their values are \\(A_{a}(0)=1>0\\) and \\(A_{a}(-2 a / 3)=1+4 a^{3} / 27\\), which is positive for integers \\(a \\geqslant-1\\) and negative for integers \\(a \\leqslant-2\\). So when \\(a \\in \\mathbb{Z}, A_{a}\\) has three real roots if \\(a \\leqslant-2\\) and one if \\(a \\geqslant-1\\).\n\nNow, since \\(y_{i}-x_{i} \\in \\mathbb{Z}\\) for \\(i=1,2,3\\), the cubics \\(A_{m}\\) and \\(A_{-m}\\) must have the same number of real roots. The previous analysis then implies that \\(m=1\\) or \\(m=-1\\). Therefore the real root \\(\\alpha\\) of \\(A_{1}(x)=x^{3}+x^{2}+1\\) and the real root \\(\\beta\\) of \\(A_{-1}(x)=x^{3}-x^{2}+1\\) must differ by an integer. But this is impossible, because \\(A_{1}\\left(-\\frac{3}{2}\\right)=-\\frac{1}{8}\\) and \\(A_{1}(-1)=1\\) so \\(-1.5<\\alpha<-1\\), while \\(A_{-1}(-1)=-1\\) and \\(A_{-1}\\left(-\\frac{1}{2}\\right)=\\frac{5}{8}\\), so \\(-1<\\beta<-0.5\\).\n\nIt follows that \\(\\operatorname{deg} P \\leqslant 1\\). Then, as shown in Solution 1, we conclude that the solutions are \\(P(x)=t x\\) for all real numbers \\(t\\)."}
{"id": "imo-shortlist-2013-c1", "question": "C1. Let \\(n\\) be a positive integer. Find the smallest integer \\(k\\) with the following property: Given any real numbers \\(a_{1}, \\ldots, a_{d}\\) such that \\(a_{1}+a_{2}+\\cdots+a_{d}=n\\) and \\(0 \\leqslant a_{i} \\leqslant 1\\) for \\(i=1,2, \\ldots, d\\), it is possible to partition these numbers into \\(k\\) groups (some of which may be empty) such that the sum of the numbers in each group is at most 1 .\n(Poland)\nAnswer. \\(k=2 n-1\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2013, "solution": "If \\(d=2 n-1\\) and \\(a_{1}=\\cdots=a_{2 n-1}=n /(2 n-1)\\), then each group in such a partition can contain at most one number, since \\(2 n /(2 n-1)>1\\). Therefore \\(k \\geqslant 2 n-1\\). It remains to show that a suitable partition into \\(2 n-1\\) groups always exists.\n\nWe proceed by induction on \\(d\\). For \\(d \\leqslant 2 n-1\\) the result is trivial. If \\(d \\geqslant 2 n\\), then since\n\n\\[\n\\left(a_{1}+a_{2}\\right)+\\ldots+\\left(a_{2 n-1}+a_{2 n}\\right) \\leqslant n\n\\]\n\nwe may find two numbers \\(a_{i}, a_{i+1}\\) such that \\(a_{i}+a_{i+1} \\leqslant 1\\). We \"merge\" these two numbers into one new number \\(a_{i}+a_{i+1}\\). By the induction hypothesis, a suitable partition exists for the \\(d-1\\) numbers \\(a_{1}, \\ldots, a_{i-1}, a_{i}+a_{i+1}, a_{i+2}, \\ldots, a_{d}\\). This induces a suitable partition for \\(a_{1}, \\ldots, a_{d}\\).\n\nSolution 2. We will show that it is even possible to split the sequence \\(a_{1}, \\ldots, a_{d}\\) into \\(2 n-1\\) contiguous groups so that the sum of the numbers in each groups does not exceed 1. Consider a segment \\(S\\) of length \\(n\\), and partition it into segments \\(S_{1}, \\ldots, S_{d}\\) of lengths \\(a_{1}, \\ldots, a_{d}\\), respectively, as shown below. Consider a second partition of \\(S\\) into \\(n\\) equal parts by \\(n-1\\) \"empty dots\".\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-21}\n\nAssume that the \\(n-1\\) empty dots are in segments \\(S_{i_{1}}, \\ldots, S_{i_{n-1}}\\). (If a dot is on the boundary of two segments, we choose the right segment). These \\(n-1\\) segments are distinct because they have length at most 1 . Consider the partition:\n\n\\[\n\\left\\{a_{1}, \\ldots, a_{i_{1}-1}\\right\\},\\left\\{a_{i_{1}}\\right\\},\\left\\{a_{i_{1}+1}, \\ldots, a_{i_{2}-1}\\right\\},\\left\\{a_{i_{2}}\\right\\}, \\ldots\\left\\{a_{i_{n-1}}\\right\\},\\left\\{a_{i_{n-1}+1}, \\ldots, a_{d}\\right\\}\n\\]\n\nIn the example above, this partition is \\(\\left\\{a_{1}, a_{2}\\right\\},\\left\\{a_{3}\\right\\},\\left\\{a_{4}, a_{5}\\right\\},\\left\\{a_{6}\\right\\}, \\varnothing,\\left\\{a_{7}\\right\\},\\left\\{a_{8}, a_{9}, a_{10}\\right\\}\\). We claim that in this partition, the sum of the numbers in this group is at most 1.\n\nFor the sets \\(\\left\\{a_{i_{t}}\\right\\}\\) this is obvious since \\(a_{i_{t}} \\leqslant 1\\). For the sets \\(\\left\\{a_{i_{t}}+1, \\ldots, a_{i_{t+1}-1}\\right\\}\\) this follows from the fact that the corresponding segments lie between two neighboring empty dots, or between an endpoint of \\(S\\) and its nearest empty dot. Therefore the sum of their lengths cannot exceed 1.\n\nSolution 3. First put all numbers greater than \\(\\frac{1}{2}\\) in their own groups. Then, form the remaining groups as follows: For each group, add new \\(a_{i}\\) s one at a time until their sum exceeds \\(\\frac{1}{2}\\). Since the last summand is at most \\(\\frac{1}{2}\\), this group has sum at most 1 . Continue this procedure until we have used all the \\(a_{i}\\) s. Notice that the last group may have sum less than \\(\\frac{1}{2}\\). If the sum of the numbers in the last two groups is less than or equal to 1 , we merge them into one group. In the end we are left with \\(m\\) groups. If \\(m=1\\) we are done. Otherwise the first \\(m-2\\) have sums greater than \\(\\frac{1}{2}\\) and the last two have total sum greater than 1 . Therefore \\(n>(m-2) / 2+1\\) so \\(m \\leqslant 2 n-1\\) as desired.\n\nComment 1. The original proposal asked for the minimal value of \\(k\\) when \\(n=2\\).\nComment 2. More generally, one may ask the same question for real numbers between 0 and 1 whose sum is a real number \\(r\\). In this case the smallest value of \\(k\\) is \\(k=\\lceil 2 r\\rceil-1\\), as Solution 3 shows.\n\nSolutions 1 and 2 lead to the slightly weaker bound \\(k \\leqslant 2\\lceil r\\rceil-1\\). This is actually the optimal bound for partitions into consecutive groups, which are the ones contemplated in these two solutions. To see this, assume that \\(r\\) is not an integer and let \\(c=(r+1-\\lceil r\\rceil) /(1+\\lceil r\\rceil)\\). One easily checks that \\(0<c<\\frac{1}{2}\\) and \\(\\lceil r\\rceil(2 c)+(\\lceil r\\rceil-1)(1-c)=r\\), so the sequence\n\n\\[\n2 c, 1-c, 2 c, 1-c, \\ldots, 1-c, 2 c\n\\]\n\nof \\(2\\lceil r\\rceil-1\\) numbers satisfies the given conditions. For this sequence, the only suitable partition into consecutive groups is the trivial partition, which requires \\(2\\lceil r\\rceil-1\\) groups."}
{"id": "imo-shortlist-2013-c2", "question": "C2. In the plane, 2013 red points and 2014 blue points are marked so that no three of the marked points are collinear. One needs to draw \\(k\\) lines not passing through the marked points and dividing the plane into several regions. The goal is to do it in such a way that no region contains points of both colors.\n\nFind the minimal value of \\(k\\) such that the goal is attainable for every possible configuration of 4027 points.\n(Australia)\nAnswer. \\(k=2013\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2013, "solution": "Firstly, let us present an example showing that \\(k \\geqslant 2013\\). Mark 2013 red and 2013 blue points on some circle alternately, and mark one more blue point somewhere in the plane. The circle is thus split into 4026 arcs, each arc having endpoints of different colors. Thus, if the goal is reached, then each arc should intersect some of the drawn lines. Since any line contains at most two points of the circle, one needs at least \\(4026 / 2=2013\\) lines.\n\nIt remains to prove that one can reach the goal using 2013 lines. First of all, let us mention that for every two points \\(A\\) and \\(B\\) having the same color, one can draw two lines separating these points from all other ones. Namely, it suffices to take two lines parallel to \\(A B\\) and lying on different sides of \\(A B\\) sufficiently close to it: the only two points between these lines will be \\(A\\) and \\(B\\).\n\nNow, let \\(P\\) be the convex hull of all marked points. Two cases are possible.\nCase 1. Assume that \\(P\\) has a red vertex \\(A\\). Then one may draw a line separating \\(A\\) from all the other points, pair up the other 2012 red points into 1006 pairs, and separate each pair from the other points by two lines. Thus, 2013 lines will be used.\nCase 2. Assume now that all the vertices of \\(P\\) are blue. Consider any two consecutive vertices of \\(P\\), say \\(A\\) and \\(B\\). One may separate these two points from the others by a line parallel to \\(A B\\). Then, as in the previous case, one pairs up all the other 2012 blue points into 1006 pairs, and separates each pair from the other points by two lines. Again, 2013 lines will be used.\n\nComment 1. Instead of considering the convex hull, one may simply take a line containing two marked points \\(A\\) and \\(B\\) such that all the other marked points are on one side of this line. If one of \\(A\\) and \\(B\\) is red, then one may act as in Case 1; otherwise both are blue, and one may act as in Case 2.\nSolution 2. Let us present a different proof of the fact that \\(k=2013\\) suffices. In fact, we will prove a more general statement:\n\nIf \\(n\\) points in the plane, no three of which are collinear, are colored in red and blue arbitrarily, then it suffices to draw \\(\\lfloor n / 2\\rfloor\\) lines to reach the goal.\n\nWe proceed by induction on \\(n\\). If \\(n \\leqslant 2\\) then the statement is obvious. Now assume that \\(n \\geqslant 3\\), and consider a line \\(\\ell\\) containing two marked points \\(A\\) and \\(B\\) such that all the other marked points are on one side of \\(\\ell\\); for instance, any line containing a side of the convex hull works.\n\nRemove for a moment the points \\(A\\) and \\(B\\). By the induction hypothesis, for the remaining configuration it suffices to draw \\(\\lfloor n / 2\\rfloor-1\\) lines to reach the goal. Now return the points \\(A\\) and \\(B\\) back. Three cases are possible.\nCase 1. If \\(A\\) and \\(B\\) have the same color, then one may draw a line parallel to \\(\\ell\\) and separating \\(A\\) and \\(B\\) from the other points. Obviously, the obtained configuration of \\(\\lfloor n / 2\\rfloor\\) lines works.\nCase 2. If \\(A\\) and \\(B\\) have different colors, but they are separated by some drawn line, then again the same line parallel to \\(\\ell\\) works.\n\nCase 3. Finally, assume that \\(A\\) and \\(B\\) have different colors and lie in one of the regions defined by the drawn lines. By the induction assumption, this region contains no other points of one of the colors - without loss of generality, the only blue point it contains is \\(A\\). Then it suffices to draw a line separating \\(A\\) from all other points.\n\nThus the step of the induction is proved.\n\nComment 2. One may ask a more general question, replacing the numbers 2013 and 2014 by any positive integers \\(m\\) and \\(n\\), say with \\(m \\leqslant n\\). Denote the answer for this problem by \\(f(m, n)\\).\n\nOne may show along the lines of Solution 1 that \\(m \\leqslant f(m, n) \\leqslant m+1\\); moreover, if \\(m\\) is even then \\(f(m, n)=m\\). On the other hand, for every odd \\(m\\) there exists an \\(N\\) such that \\(f(m, n)=m\\) for all \\(m \\leqslant n \\leqslant N\\), and \\(f(m, n)=m+1\\) for all \\(n>N\\)."}
{"id": "imo-shortlist-2013-c3", "question": "C3. A crazy physicist discovered a new kind of particle which he called an imon, after some of them mysteriously appeared in his lab. Some pairs of imons in the lab can be entangled, and each imon can participate in many entanglement relations. The physicist has found a way to perform the following two kinds of operations with these particles, one operation at a time.\n(i) If some imon is entangled with an odd number of other imons in the lab, then the physicist can destroy it.\n(ii) At any moment, he may double the whole family of imons in his lab by creating a copy \\(I^{\\prime}\\) of each imon \\(I\\). During this procedure, the two copies \\(I^{\\prime}\\) and \\(J^{\\prime}\\) become entangled if and only if the original imons \\(I\\) and \\(J\\) are entangled, and each copy \\(I^{\\prime}\\) becomes entangled with its original imon \\(I\\); no other entanglements occur or disappear at this moment.\n\nProve that the physicist may apply a sequence of such operations resulting in a family of imons, no two of which are entangled.\n(Japan)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2013, "solution": "Let us consider a graph with the imons as vertices, and two imons being connected if and only if they are entangled. Recall that a proper coloring of a graph \\(G\\) is a coloring of its vertices in several colors so that every two connected vertices have different colors.\nLemma. Assume that a graph \\(G\\) admits a proper coloring in \\(n\\) colors \\((n>1)\\). Then one may perform a sequence of operations resulting in a graph which admits a proper coloring in \\(n-1\\) colors.\nProof. Let us apply repeatedly operation ( \\(i\\) ) to any appropriate vertices while it is possible. Since the number of vertices decreases, this process finally results in a graph where all the degrees are even. Surely this graph also admits a proper coloring in \\(n\\) colors \\(1, \\ldots, n\\); let us fix this coloring.\n\nNow apply the operation (ii) to this graph. A proper coloring of the resulting graph in \\(n\\) colors still exists: one may preserve the colors of the original vertices and color the vertex \\(I^{\\prime}\\) in a color \\(k+1(\\bmod n)\\) if the vertex \\(I\\) has color \\(k\\). Then two connected original vertices still have different colors, and so do their two connected copies. On the other hand, the vertices \\(I\\) and \\(I^{\\prime}\\) have different colors since \\(n>1\\).\n\nAll the degrees of the vertices in the resulting graph are odd, so one may apply operation \\((i)\\) to delete consecutively all the vertices of color \\(n\\) one by one; no two of them are connected by an edge, so their degrees do not change during the process. Thus, we obtain a graph admitting a proper coloring in \\(n-1\\) colors, as required. The lemma is proved.\n\nNow, assume that a graph \\(G\\) has \\(n\\) vertices; then it admits a proper coloring in \\(n\\) colors. Applying repeatedly the lemma we finally obtain a graph admitting a proper coloring in one color, that is - a graph with no edges, as required.\n\nSolution 2. Again, we will use the graph language.\nI. We start with the following observation.\n\nLemma. Assume that a graph \\(G\\) contains an isolated vertex \\(A\\), and a graph \\(G^{\\circ}\\) is obtained from \\(G\\) by deleting this vertex. Then, if one can apply a sequence of operations which makes a graph with no edges from \\(G^{\\circ}\\), then such a sequence also exists for \\(G\\).\nProof. Consider any operation applicable to \\(G^{\\circ}\\) resulting in a graph \\(G_{1}^{\\circ}\\); then there exists a sequence of operations applicable to \\(G\\) and resulting in a graph \\(G_{1}\\) differing from \\(G_{1}^{\\circ}\\) by an addition of an isolated vertex \\(A\\). Indeed, if this operation is of type \\((i)\\), then one may simply repeat it in \\(G\\).\n\nOtherwise, the operation is of type ( \\(i i\\) ), and one may apply it to \\(G\\) and then delete the vertex \\(A^{\\prime}\\) (it will have degree 1).\n\nThus one may change the process for \\(G^{\\circ}\\) into a corresponding process for \\(G\\) step by step.\nIn view of this lemma, if at some moment a graph contains some isolated vertex, then we may simply delete it; let us call this operation (iii).\nII. Let \\(V=\\left\\{A_{1}^{0}, \\ldots, A_{n}^{0}\\right\\}\\) be the vertices of the initial graph. Let us describe which graphs can appear during our operations. Assume that operation ( \\(i i\\) ) was applied \\(m\\) times. If these were the only operations applied, then the resulting graph \\(G_{n}^{m}\\) has the set of vertices which can be enumerated as\n\n\\[\nV_{n}^{m}=\\left\\{A_{i}^{j}: 1 \\leqslant i \\leqslant n, 0 \\leqslant j \\leqslant 2^{m}-1\\right\\},\n\\]\n\nwhere \\(A_{i}^{0}\\) is the common \"ancestor\" of all the vertices \\(A_{i}^{j}\\), and the binary expansion of \\(j\\) (adjoined with some zeroes at the left to have \\(m\\) digits) \"keeps the history\" of this vertex: the \\(d\\) th digit from the right is 0 if at the \\(d\\) th doubling the ancestor of \\(A_{i}^{j}\\) was in the original part, and this digit is 1 if it was in the copy.\n\nNext, the two vertices \\(A_{i}^{j}\\) and \\(A_{k}^{\\ell}\\) in \\(G_{n}^{m}\\) are connected with an edge exactly if either (1) \\(j=\\ell\\) and there was an edge between \\(A_{i}^{0}\\) and \\(A_{k}^{0}\\) (so these vertices appeared at the same application of operation ( \\(i i\\) )); or (2) \\(i=k\\) and the binary expansions of \\(j\\) and \\(\\ell\\) differ in exactly one digit (so their ancestors became connected as a copy and the original vertex at some application of (ii)).\n\nNow, if some operations \\((i)\\) were applied during the process, then simply some vertices in \\(G_{n}^{m}\\) disappeared. So, in any case the resulting graph is some induced subgraph of \\(G_{n}^{m}\\).\nIII. Finally, we will show that from each (not necessarily induced) subgraph of \\(G_{n}^{m}\\) one can obtain a graph with no vertices by applying operations (i), (ii) and (iii). We proceed by induction on \\(n\\); the base case \\(n=0\\) is trivial.\n\nFor the induction step, let us show how to apply several operations so as to obtain a graph containing no vertices of the form \\(A_{n}^{j}\\) for \\(j \\in \\mathbb{Z}\\). We will do this in three steps.\nStep 1. We apply repeatedly operation ( \\(i\\) ) to any appropriate vertices while it is possible. In the resulting graph, all vertices have even degrees.\nStep 2. Apply operation (ii) obtaining a subgraph of \\(G_{n}^{m+1}\\) with all degrees being odd. In this graph, we delete one by one all the vertices \\(A_{n}^{j}\\) where the sum of the binary digits of \\(j\\) is even; it is possible since there are no edges between such vertices, so all their degrees remain odd. After that, we delete all isolated vertices.\nStep 3. Finally, consider any remaining vertex \\(A_{n}^{j}\\) (then the sum of digits of \\(j\\) is odd). If its degree is odd, then we simply delete it. Otherwise, since \\(A_{n}^{j}\\) is not isolated, we consider any vertex adjacent to it. It has the form \\(A_{k}^{j}\\) for some \\(k<n\\) (otherwise it would have the form \\(A_{n}^{\\ell}\\), where \\(\\ell\\) has an even digit sum; but any such vertex has already been deleted at Step 2). No neighbor of \\(A_{k}^{j}\\) was deleted at Steps 2 and 3, so it has an odd degree. Then we successively delete \\(A_{k}^{j}\\) and \\(A_{n}^{j}\\).\n\nNotice that this deletion does not affect the applicability of this step to other vertices, since no two vertices \\(A_{i}^{j}\\) and \\(A_{k}^{\\ell}\\) for different \\(j, \\ell\\) with odd digit sum are connected with an edge. Thus we will delete all the remaining vertices of the form \\(A_{n}^{j}\\), obtaining a subgraph of \\(G_{n-1}^{m+1}\\). The application of the induction hypothesis finishes the proof.\n\nComment. In fact, the graph \\(G_{n}^{m}\\) is a Cartesian product of \\(G\\) and the graph of an \\(m\\)-dimensional hypercube."}
{"id": "imo-shortlist-2013-c4", "question": "C4. Let \\(n\\) be a positive integer, and let \\(A\\) be a subset of \\(\\{1, \\ldots, n\\}\\). An \\(A\\)-partition of \\(n\\) into \\(k\\) parts is a representation of \\(n\\) as a sum \\(n=a_{1}+\\cdots+a_{k}\\), where the parts \\(a_{1}, \\ldots, a_{k}\\) belong to \\(A\\) and are not necessarily distinct. The number of different parts in such a partition is the number of (distinct) elements in the set \\(\\left\\{a_{1}, a_{2}, \\ldots, a_{k}\\right\\}\\).\n\nWe say that an \\(A\\)-partition of \\(n\\) into \\(k\\) parts is optimal if there is no \\(A\\)-partition of \\(n\\) into \\(r\\) parts with \\(r<k\\). Prove that any optimal \\(A\\)-partition of \\(n\\) contains at most \\(\\sqrt[3]{6 n}\\) different parts.\n(Germany)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2013, "solution": "If there are no \\(A\\)-partitions of \\(n\\), the result is vacuously true. Otherwise, let \\(k_{\\text {min }}\\) be the minimum number of parts in an \\(A\\)-partition of \\(n\\), and let \\(n=a_{1}+\\cdots+a_{k_{\\min }}\\) be an optimal partition. Denote by \\(s\\) the number of different parts in this partition, so we can write \\(S=\\left\\{a_{1}, \\ldots, a_{k_{\\min }}\\right\\}=\\left\\{b_{1}, \\ldots, b_{s}\\right\\}\\) for some pairwise different numbers \\(b_{1}<\\cdots<b_{s}\\) in \\(A\\).\n\nIf \\(s>\\sqrt[3]{6 n}\\), we will prove that there exist subsets \\(X\\) and \\(Y\\) of \\(S\\) such that \\(|X|<|Y|\\) and \\(\\sum_{x \\in X} x=\\sum_{y \\in Y} y\\). Then, deleting the elements of \\(Y\\) from our partition and adding the elements of \\(X\\) to it, we obtain an \\(A\\)-partition of \\(n\\) into less than \\(k_{\\text {min }}\\) parts, which is the desired contradiction.\n\nFor each positive integer \\(k \\leqslant s\\), we consider the \\(k\\)-element subset\n\n\\[\nS_{1,0}^{k}:=\\left\\{b_{1}, \\ldots, b_{k}\\right\\}\n\\]\n\nas well as the following \\(k\\)-element subsets \\(S_{i, j}^{k}\\) of \\(S\\) :\n\n\\[\nS_{i, j}^{k}:=\\left\\{b_{1}, \\ldots, b_{k-i}, b_{k-i+j+1}, b_{s-i+2}, \\ldots, b_{s}\\right\\}, \\quad i=1, \\ldots, k, \\quad j=1, \\ldots, s-k\n\\]\n\nPictorially, if we represent the elements of \\(S\\) by a sequence of dots in increasing order, and represent a subset of \\(S\\) by shading in the appropriate dots, we have:\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-27}\n\nDenote by \\(\\Sigma_{i, j}^{k}\\) the sum of elements in \\(S_{i, j}^{k}\\). Clearly, \\(\\Sigma_{1,0}^{k}\\) is the minimum sum of a \\(k\\)-element subset of \\(S\\). Next, for all appropriate indices \\(i\\) and \\(j\\) we have\n\n\\[\n\\Sigma_{i, j}^{k}=\\Sigma_{i, j+1}^{k}+b_{k-i+j+1}-b_{k-i+j+2}<\\Sigma_{i, j+1}^{k} \\quad \\text { and } \\quad \\Sigma_{i, s-k}^{k}=\\Sigma_{i+1,1}^{k}+b_{k-i}-b_{k-i+1}<\\Sigma_{i+1,1}^{k}\n\\]\n\nTherefore\n\n\\[\n1 \\leqslant \\Sigma_{1,0}^{k}<\\Sigma_{1,1}^{k}<\\Sigma_{1,2}^{k}<\\cdots<\\Sigma_{1, s-k}^{k}<\\Sigma_{2,1}^{k}<\\cdots<\\Sigma_{2, s-k}^{k}<\\Sigma_{3,1}^{k}<\\cdots<\\Sigma_{k, s-k}^{k} \\leqslant n .\n\\]\n\nTo see this in the picture, we start with the \\(k\\) leftmost points marked. At each step, we look for the rightmost point which can move to the right, and move it one unit to the right. We continue until the \\(k\\) rightmost points are marked. As we do this, the corresponding sums clearly increase.\n\nFor each \\(k\\) we have found \\(k(s-k)+1\\) different integers of the form \\(\\Sigma_{i, j}^{k}\\) between 1 and \\(n\\). As we vary \\(k\\), the total number of integers we are considering is\n\n\\[\n\\sum_{k=1}^{s}(k(s-k)+1)=s \\cdot \\frac{s(s+1)}{2}-\\frac{s(s+1)(2 s+1)}{6}+s=\\frac{s\\left(s^{2}+5\\right)}{6}>\\frac{s^{3}}{6}>n .\n\\]\n\nSince they are between 1 and \\(n\\), at least two of these integers are equal. Consequently, there exist \\(1 \\leqslant k<k^{\\prime} \\leqslant s\\) and \\(X=S_{i, j}^{k}\\) as well as \\(Y=S_{i^{\\prime}, j^{\\prime}}^{k^{\\prime}}\\) such that\n\n\\[\n\\sum_{x \\in X} x=\\sum_{y \\in Y} y, \\quad \\text { but } \\quad|X|=k<k^{\\prime}=|Y|,\n\\]\n\nas required. The result follows.\n\nSolution 2. Assume, to the contrary, that the statement is false, and choose the minimum number \\(n\\) for which it fails. So there exists a set \\(A \\subseteq\\{1, \\ldots, n\\}\\) together with an optimal \\(A\\) partition \\(n=a_{1}+\\cdots+a_{k_{\\min }}\\) of \\(n\\) refuting our statement, where, of course, \\(k_{\\min }\\) is the minimum number of parts in an \\(A\\)-partition of \\(n\\). Again, we define \\(S=\\left\\{a_{1}, \\ldots, a_{k_{\\text {min }}}\\right\\}=\\left\\{b_{1}, \\ldots, b_{s}\\right\\}\\) with \\(b_{1}<\\cdots<b_{s}\\); by our assumption we have \\(s>\\sqrt[3]{6 n}>1\\). Without loss of generality we assume that \\(a_{k_{\\text {min }}}=b_{s}\\). Let us distinguish two cases.\nCase 1. \\(b_{s} \\geqslant \\frac{s(s-1)}{2}+1\\).\nConsider the partition \\(n-b_{s}=a_{1}+\\cdots+a_{k_{\\min }-1}\\), which is clearly a minimum \\(A\\)-partition of \\(n-b_{s}\\) with at least \\(s-1 \\geqslant 1\\) different parts. Now, from \\(n<\\frac{s^{3}}{6}\\) we obtain\n\n\\[\nn-b_{s} \\leqslant n-\\frac{s(s-1)}{2}-1<\\frac{s^{3}}{6}-\\frac{s(s-1)}{2}-1<\\frac{(s-1)^{3}}{6}\n\\]\n\nso \\(s-1>\\sqrt[3]{6\\left(n-b_{s}\\right)}\\), which contradicts the choice of \\(n\\).\nCase 2. \\(b_{s} \\leqslant \\frac{s(s-1)}{2}\\).\nSet \\(b_{0}=0, \\Sigma_{0,0}=0\\), and \\(\\Sigma_{i, j}=b_{1}+\\cdots+b_{i-1}+b_{j}\\) for \\(1 \\leqslant i \\leqslant j<s\\). There are \\(\\frac{s(s-1)}{2}+1>b_{s}\\) such sums; so at least two of them, say \\(\\Sigma_{i, j}\\) and \\(\\Sigma_{i^{\\prime}, j^{\\prime}}\\), are congruent modulo \\(b_{s}\\) (where \\((i, j) \\neq\\left(i^{\\prime}, j^{\\prime}\\right)\\) ). This means that \\(\\Sigma_{i, j}-\\Sigma_{i^{\\prime}, j^{\\prime}}=r b_{s}\\) for some integer \\(r\\). Notice that for \\(i \\leqslant j<k<s\\) we have\n\n\\[\n0<\\Sigma_{i, k}-\\Sigma_{i, j}=b_{k}-b_{j}<b_{s}\n\\]\n\nso the indices \\(i\\) and \\(i^{\\prime}\\) are distinct, and we may assume that \\(i>i^{\\prime}\\). Next, we observe that \\(\\Sigma_{i, j}-\\Sigma_{i^{\\prime}, j^{\\prime}}=\\left(b_{i^{\\prime}}-b_{j^{\\prime}}\\right)+b_{j}+b_{i^{\\prime}+1}+\\cdots+b_{i-1}\\) and \\(b_{i^{\\prime}} \\leqslant b_{j^{\\prime}}\\) imply\n\n\\[\n-b_{s}<-b_{j^{\\prime}}<\\Sigma_{i, j}-\\Sigma_{i^{\\prime}, j^{\\prime}}<\\left(i-i^{\\prime}\\right) b_{s}\n\\]\n\nso \\(0 \\leqslant r \\leqslant i-i^{\\prime}-1\\).\nThus, we may remove the \\(i\\) terms of \\(\\Sigma_{i, j}\\) in our \\(A\\)-partition, and replace them by the \\(i^{\\prime}\\) terms of \\(\\Sigma_{i^{\\prime}, j^{\\prime}}\\) and \\(r\\) terms equal to \\(b_{s}\\), for a total of \\(r+i^{\\prime}<i\\) terms. The result is an \\(A\\)-partition of \\(n\\) into a smaller number of parts, a contradiction.\n\nComment. The original proposal also contained a second part, showing that the estimate appearing in the problem has the correct order of magnitude:\nFor every positive integer \\(n\\), there exist a set \\(A\\) and an optimal \\(A\\)-partition of \\(n\\) that contains \\(\\lfloor\\sqrt[3]{2 n}\\rfloor\\) different parts.\n\nThe Problem Selection Committee removed this statement from the problem, since it seems to be less suitable for the competiton; but for completeness we provide an outline of its proof here.\n\nLet \\(k=\\lfloor\\sqrt[3]{2 n}\\rfloor-1\\). The statement is trivial for \\(n<4\\), so we assume \\(n \\geqslant 4\\) and hence \\(k \\geqslant 1\\). Let \\(h=\\left\\lfloor\\frac{n-1}{k}\\right\\rfloor\\). Notice that \\(h \\geqslant \\frac{n}{k}-1\\).\n\nNow let \\(A=\\{1, \\ldots, h\\}\\), and set \\(a_{1}=h, a_{2}=h-1, \\ldots, a_{k}=h-k+1\\), and \\(a_{k+1}=n-\\left(a_{1}+\\cdots+a_{k}\\right)\\). It is not difficult to prove that \\(a_{k}>a_{k+1} \\geqslant 1\\), which shows that\n\n\\[\nn=a_{1}+\\ldots+a_{k+1}\n\\]\n\nis an \\(A\\)-partition of \\(n\\) into \\(k+1\\) different parts. Since \\(k h<n\\), any \\(A\\)-partition of \\(n\\) has at least \\(k+1\\) parts. Therefore our \\(A\\)-partition is optimal, and it has \\(\\lfloor\\sqrt[3]{2 n}\\rfloor\\) distinct parts, as desired."}
{"id": "imo-shortlist-2013-c5", "question": "C5. Let \\(r\\) be a positive integer, and let \\(a_{0}, a_{1}, \\ldots\\) be an infinite sequence of real numbers. Assume that for all nonnegative integers \\(m\\) and \\(s\\) there exists a positive integer \\(n \\in[m+1, m+r]\\) such that\n\n\\[\na_{m}+a_{m+1}+\\cdots+a_{m+s}=a_{n}+a_{n+1}+\\cdots+a_{n+s}\n\\]\n\nProve that the sequence is periodic, i. e. there exists some \\(p \\geqslant 1\\) such that \\(a_{n+p}=a_{n}\\) for all \\(n \\geqslant 0\\).\n(India)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2013, "solution": "For every indices \\(m \\leqslant n\\) we will denote \\(S(m, n)=a_{m}+a_{m+1}+\\cdots+a_{n-1}\\); thus \\(S(n, n)=0\\). Let us start with the following lemma.\nLemma. Let \\(b_{0}, b_{1}, \\ldots\\) be an infinite sequence. Assume that for every nonnegative integer \\(m\\) there exists a nonnegative integer \\(n \\in[m+1, m+r]\\) such that \\(b_{m}=b_{n}\\). Then for every indices \\(k \\leqslant \\ell\\) there exists an index \\(t \\in[\\ell, \\ell+r-1]\\) such that \\(b_{t}=b_{k}\\). Moreover, there are at most \\(r\\) distinct numbers among the terms of ( \\(b_{i}\\) ).\nProof. To prove the first claim, let us notice that there exists an infinite sequence of indices \\(k_{1}=k, k_{2}, k_{3}, \\ldots\\) such that \\(b_{k_{1}}=b_{k_{2}}=\\cdots=b_{k}\\) and \\(k_{i}<k_{i+1} \\leqslant k_{i}+r\\) for all \\(i \\geqslant 1\\). This sequence is unbounded from above, thus it hits each segment of the form \\([\\ell, \\ell+r-1]\\) with \\(\\ell \\geqslant k\\), as required.\n\nTo prove the second claim, assume, to the contrary, that there exist \\(r+1\\) distinct numbers \\(b_{i_{1}}, \\ldots, b_{i_{r+1}}\\). Let us apply the first claim to \\(k=i_{1}, \\ldots, i_{r+1}\\) and \\(\\ell=\\max \\left\\{i_{1}, \\ldots, i_{r+1}\\right\\}\\); we obtain that for every \\(j \\in\\{1, \\ldots, r+1\\}\\) there exists \\(t_{j} \\in[s, s+r-1]\\) such that \\(b_{t_{j}}=b_{i_{j}}\\). Thus the segment [ \\(s, s+r-1\\) ] should contain \\(r+1\\) distinct integers, which is absurd.\n\nSetting \\(s=0\\) in the problem condition, we see that the sequence \\(\\left(a_{i}\\right)\\) satisfies the condition of the lemma, thus it attains at most \\(r\\) distinct values. Denote by \\(A_{i}\\) the ordered \\(r\\)-tuple \\(\\left(a_{i}, \\ldots, a_{i+r-1}\\right)\\); then among \\(A_{i}\\) 's there are at most \\(r^{r}\\) distinct tuples, so for every \\(k \\geqslant 0\\) two of the tuples \\(A_{k}, A_{k+1}, \\ldots, A_{k+r^{r}}\\) are identical. This means that there exists a positive integer \\(p \\leqslant r^{r}\\) such that the equality \\(A_{d}=A_{d+p}\\) holds infinitely many times. Let \\(D\\) be the set of indices \\(d\\) satisfying this relation.\n\nNow we claim that \\(D\\) coincides with the set of all nonnegative integers. Since \\(D\\) is unbounded, it suffices to show that \\(d \\in D\\) whenever \\(d+1 \\in D\\). For that, denote \\(b_{k}=S(k, p+k)\\). The sequence \\(b_{0}, b_{1}, \\ldots\\) satisfies the lemma conditions, so there exists an index \\(t \\in[d+1, d+r]\\) such that \\(S(t, t+p)=S(d, d+p)\\). This last relation rewrites as \\(S(d, t)=S(d+p, t+p)\\). Since \\(A_{d+1}=A_{d+p+1}\\), we have \\(S(d+1, t)=S(d+p+1, t+p)\\), therefore we obtain\n\n\\[\na_{d}=S(d, t)-S(d+1, t)=S(d+p, t+p)-S(d+p+1, t+p)=a_{d+p}\n\\]\n\nand thus \\(A_{d}=A_{d+p}\\), as required.\nFinally, we get \\(A_{d}=A_{d+p}\\) for all \\(d\\), so in particular \\(a_{d}=a_{d+p}\\) for all \\(d\\), QED.\n\nComment 1. In the present proof, the upper bound for the minimal period length is \\(r^{r}\\). This bound is not sharp; for instance, one may improve it to \\((r-1)^{r}\\) for \\(r \\geqslant 3\\)..\n\nOn the other hand, this minimal length may happen to be greater than \\(r\\). For instance, it is easy to check that the sequence with period \\((3,-3,3,-3,3,-1,-1,-1)\\) satisfies the problem condition for \\(r=7\\).\n\nComment 2. The conclusion remains true even if the problem condition only holds for every \\(s \\geqslant N\\) for some positive integer \\(N\\). To show that, one can act as follows. Firstly, the sums of the form \\(S(i, i+N)\\) attain at most \\(r\\) values, as well as the sums of the form \\(S(i, i+N+1)\\). Thus the terms \\(a_{i}=S(i, i+N+1)-\\) \\(S(i+1, i+N+1)\\) attain at most \\(r^{2}\\) distinct values. Then, among the tuples \\(A_{k}, A_{k+N}, \\ldots, A_{k+r^{2 r} N}\\) two\nare identical, so for some \\(p \\leqslant r^{2 r}\\) the set \\(D=\\left\\{d: A_{d}=A_{d+N p}\\right\\}\\) is infinite. The further arguments apply almost literally, with \\(p\\) being replaced by \\(N p\\).\n\nAfter having proved that such a sequence is also necessarily periodic, one may reduce the bound for the minimal period length to \\(r^{r}\\) - essentially by verifying that the sequence satisfies the original version of the condition."}
{"id": "imo-shortlist-2013-c6", "question": "C6. In some country several pairs of cities are connected by direct two-way flights. It is possible to go from any city to any other by a sequence of flights. The distance between two cities is defined to be the least possible number of flights required to go from one of them to the other. It is known that for any city there are at most 100 cities at distance exactly three from it. Prove that there is no city such that more than 2550 other cities have distance exactly four from it.\n(Russia)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2013, "solution": "Let us denote by \\(d(a, b)\\) the distance between the cities \\(a\\) and \\(b\\), and by\n\n\\[\nS_{i}(a)=\\{c: d(a, c)=i\\}\n\\]\n\nthe set of cities at distance exactly \\(i\\) from city \\(a\\).\nAssume that for some city \\(x\\) the set \\(D=S_{4}(x)\\) has size at least 2551 . Let \\(A=S_{1}(x)\\). A subset \\(A^{\\prime}\\) of \\(A\\) is said to be substantial, if every city in \\(D\\) can be reached from \\(x\\) with four flights while passing through some member of \\(A^{\\prime}\\); in other terms, every city in \\(D\\) has distance 3 from some member of \\(A^{\\prime}\\), or \\(D \\subseteq \\bigcup_{a \\in A^{\\prime}} S_{3}(a)\\). For instance, \\(A\\) itself is substantial. Now let us fix some substantial subset \\(A^{*}\\) of \\(A\\) having the minimal cardinality \\(m=\\left|A^{*}\\right|\\).\n\nSince\n\n\\[\nm(101-m) \\leqslant 50 \\cdot 51=2550\n\\]\n\nthere has to be a city \\(a \\in A^{*}\\) such that \\(\\left|S_{3}(a) \\cap D\\right| \\geqslant 102-m\\). As \\(\\left|S_{3}(a)\\right| \\leqslant 100\\), we obtain that \\(S_{3}(a)\\) may contain at most \\(100-(102-m)=m-2\\) cities \\(c\\) with \\(d(c, x) \\leqslant 3\\). Let us denote by \\(T=\\left\\{c \\in S_{3}(a): d(x, c) \\leqslant 3\\right\\}\\) the set of all such cities, so \\(|T| \\leqslant m-2\\). Now, to get a contradiction, we will construct \\(m-1\\) distinct elements in \\(T\\), corresponding to \\(m-1\\) elements of the set \\(A_{a}=A^{*} \\backslash\\{a\\}\\).\n\nFirstly, due to the minimality of \\(A^{*}\\), for each \\(y \\in A_{a}\\) there exists some city \\(d_{y} \\in D\\) which can only be reached with four flights from \\(x\\) by passing through \\(y\\). So, there is a way to get from \\(x\\) to \\(d_{y}\\) along \\(x-y-b_{y}-c_{y}-d_{y}\\) for some cities \\(b_{y}\\) and \\(c_{y}\\); notice that \\(d\\left(x, b_{y}\\right)=2\\) and \\(d\\left(x, c_{y}\\right)=3\\) since this path has the minimal possible length.\n\nNow we claim that all \\(2(m-1)\\) cities of the form \\(b_{y}, c_{y}\\) with \\(y \\in A_{a}\\) are distinct. Indeed, no \\(b_{y}\\) may coincide with any \\(c_{z}\\) since their distances from \\(x\\) are different. On the other hand, if one had \\(b_{y}=b_{z}\\) for \\(y \\neq z\\), then there would exist a path of length 4 from \\(x\\) to \\(d_{z}\\) via \\(y\\), namely \\(x-y-b_{z}-c_{z}-d_{z}\\); this is impossible by the choice of \\(d_{z}\\). Similarly, \\(c_{y} \\neq c_{z}\\) for \\(y \\neq z\\).\n\nSo, it suffices to prove that for every \\(y \\in A_{a}\\), one of the cities \\(b_{y}\\) and \\(c_{y}\\) has distance 3 from \\(a\\) (and thus belongs to \\(T\\) ). For that, notice that \\(d(a, y) \\leqslant 2\\) due to the path \\(a-x-y\\), while \\(d\\left(a, d_{y}\\right) \\geqslant d\\left(x, d_{y}\\right)-d(x, a)=3\\). Moreover, \\(d\\left(a, d_{y}\\right) \\neq 3\\) by the choice of \\(d_{y}\\); thus \\(d\\left(a, d_{y}\\right)>3\\). Finally, in the sequence \\(d(a, y), d\\left(a, b_{y}\\right), d\\left(a, c_{y}\\right), d\\left(a, d_{y}\\right)\\) the neighboring terms differ by at most 1 , the first term is less than 3 , and the last one is greater than 3 ; thus there exists one which is equal to 3 , as required.\n\nComment 1. The upper bound 2550 is sharp. This can be seen by means of various examples; one of them is the \"Roman Empire\": it has one capital, called \"Rome\", that is connected to 51 semicapitals by internally disjoint paths of length 3. Moreover, each of these semicapitals is connected to 50 rural cities by direct flights.\n\nComment 2. Observe that, under the conditions of the problem, there exists no bound for the size of \\(S_{1}(x)\\) or \\(S_{2}(x)\\).\n\nComment 3. The numbers 100 and 2550 appearing in the statement of the problem may be replaced by \\(n\\) and \\(\\left\\lfloor\\frac{(n+1)^{2}}{4}\\right\\rfloor\\) for any positive integer \\(n\\). Still more generally, one can also replace the pair (3, 4) of distances under consideration by any pair \\((r, s)\\) of positive integers satisfying \\(r<s \\leqslant \\frac{3}{2} r\\).\n\nTo adapt the above proof to this situation, one takes \\(A=S_{s-r}(x)\\) and defines the concept of substantiality as before. Then one takes \\(A^{*}\\) to be a minimal substantial subset of \\(A\\), and for each \\(y \\in A^{*}\\) one fixes an element \\(d_{y} \\in S_{s}(x)\\) which is only reachable from \\(x\\) by a path of length \\(s\\) by passing through \\(y\\). As before, it suffices to show that for distinct \\(a, y \\in A^{*}\\) and a path \\(y=y_{0}-y_{1}-\\ldots-y_{r}=d_{y}\\), at least one of the cities \\(y_{0}, \\ldots, y_{r-1}\\) has distance \\(r\\) from \\(a\\). This can be done as above; the relation \\(s \\leqslant \\frac{3}{2} r\\) is used here to show that \\(d\\left(a, y_{0}\\right) \\leqslant r\\).\n\nMoreover, the estimate \\(\\left\\lfloor\\frac{(n+1)^{2}}{4}\\right\\rfloor\\) is also sharp for every positive integer \\(n\\) and every positive integers \\(r, s\\) with \\(r<s \\leqslant \\frac{3}{2} r\\). This may be shown by an example similar to that in the previous comment."}
{"id": "imo-shortlist-2013-c7", "question": "C7. Let \\(n \\geqslant 2\\) be an integer. Consider all circular arrangements of the numbers \\(0,1, \\ldots, n\\); the \\(n+1\\) rotations of an arrangement are considered to be equal. A circular arrangement is called beautiful if, for any four distinct numbers \\(0 \\leqslant a, b, c, d \\leqslant n\\) with \\(a+c=b+d\\), the chord joining numbers \\(a\\) and \\(c\\) does not intersect the chord joining numbers \\(b\\) and \\(d\\).\n\nLet \\(M\\) be the number of beautiful arrangements of \\(0,1, \\ldots, n\\). Let \\(N\\) be the number of pairs \\((x, y)\\) of positive integers such that \\(x+y \\leqslant n\\) and \\(\\operatorname{gcd}(x, y)=1\\). Prove that\n\n\\[\nM=N+1\n\\]", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2013, "solution": "Given a circular arrangement of \\([0, n]=\\{0,1, \\ldots, n\\}\\), we define a \\(k\\)-chord to be a (possibly degenerate) chord whose (possibly equal) endpoints add up to \\(k\\). We say that three chords of a circle are aligned if one of them separates the other two. Say that \\(m \\geqslant 3\\) chords are aligned if any three of them are aligned. For instance, in Figure 1, \\(A, B\\), and \\(C\\) are aligned, while \\(B, C\\), and \\(D\\) are not.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-33}\n\nFigure 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-33(1)}\n\nFigure 2\n\nClaim. In a beautiful arrangement, the \\(k\\)-chords are aligned for any integer \\(k\\).\nProof. We proceed by induction. For \\(n \\leqslant 3\\) the statement is trivial. Now let \\(n \\geqslant 4\\), and proceed by contradiction. Consider a beautiful arrangement \\(S\\) where the three \\(k\\)-chords \\(A, B, C\\) are not aligned. If \\(n\\) is not among the endpoints of \\(A, B\\), and \\(C\\), then by deleting \\(n\\) from \\(S\\) we obtain a beautiful arrangement \\(S \\backslash\\{n\\}\\) of \\([0, n-1]\\), where \\(A, B\\), and \\(C\\) are aligned by the induction hypothesis. Similarly, if 0 is not among these endpoints, then deleting 0 and decreasing all the numbers by 1 gives a beautiful arrangement \\(S \\backslash\\{0\\}\\) where \\(A, B\\), and \\(C\\) are aligned. Therefore both 0 and \\(n\\) are among the endpoints of these segments. If \\(x\\) and \\(y\\) are their respective partners, we have \\(n \\geqslant 0+x=k=n+y \\geqslant n\\). Thus 0 and \\(n\\) are the endpoints of one of the chords; say it is \\(C\\).\n\nLet \\(D\\) be the chord formed by the numbers \\(u\\) and \\(v\\) which are adjacent to 0 and \\(n\\) and on the same side of \\(C\\) as \\(A\\) and \\(B\\), as shown in Figure 2. Set \\(t=u+v\\). If we had \\(t=n\\), the \\(n\\)-chords \\(A\\), \\(B\\), and \\(D\\) would not be aligned in the beautiful arrangement \\(S \\backslash\\{0, n\\}\\), contradicting the induction hypothesis. If \\(t<n\\), then the \\(t\\)-chord from 0 to \\(t\\) cannot intersect \\(D\\), so the chord \\(C\\) separates \\(t\\) and \\(D\\). The chord \\(E\\) from \\(t\\) to \\(n-t\\) does not intersect \\(C\\), so \\(t\\) and \\(n-t\\) are on the same side of \\(C\\). But then the chords \\(A, B\\), and \\(E\\) are not aligned in \\(S \\backslash\\{0, n\\}\\), a contradiction. Finally, the case \\(t>n\\) is equivalent to the case \\(t<n\\) via the beauty-preserving relabelling \\(x \\mapsto n-x\\) for \\(0 \\leqslant x \\leqslant n\\), which sends \\(t\\)-chords to ( \\(2 n-t\\) )-chords. This proves the Claim.\n\nHaving established the Claim, we prove the desired result by induction. The case \\(n=2\\) is trivial. Now assume that \\(n \\geqslant 3\\). Let \\(S\\) be a beautiful arrangement of \\([0, n]\\) and delete \\(n\\) to obtain\nthe beautiful arrangement \\(T\\) of \\([0, n-1]\\). The \\(n\\)-chords of \\(T\\) are aligned, and they contain every point except 0. Say \\(T\\) is of Type 1 if 0 lies between two of these \\(n\\)-chords, and it is of Type 2 otherwise; i.e., if 0 is aligned with these \\(n\\)-chords. We will show that each Type 1 arrangement of \\([0, n-1]\\) arises from a unique arrangement of \\([0, n]\\), and each Type 2 arrangement of \\([0, n-1]\\) arises from exactly two beautiful arrangements of \\([0, n]\\).\n\nIf \\(T\\) is of Type 1 , let 0 lie between chords \\(A\\) and \\(B\\). Since the chord from 0 to \\(n\\) must be aligned with \\(A\\) and \\(B\\) in \\(S, n\\) must be on the other arc between \\(A\\) and \\(B\\). Therefore \\(S\\) can be recovered uniquely from \\(T\\). In the other direction, if \\(T\\) is of Type 1 and we insert \\(n\\) as above, then we claim the resulting arrangement \\(S\\) is beautiful. For \\(0<k<n\\), the \\(k\\)-chords of \\(S\\) are also \\(k\\)-chords of \\(T\\), so they are aligned. Finally, for \\(n<k<2 n\\), notice that the \\(n\\)-chords of \\(S\\) are parallel by construction, so there is an antisymmetry axis \\(\\ell\\) such that \\(x\\) is symmetric to \\(n-x\\) with respect to \\(\\ell\\) for all \\(x\\). If we had two \\(k\\)-chords which intersect, then their reflections across \\(\\ell\\) would be two ( \\(2 n-k\\) )-chords which intersect, where \\(0<2 n-k<n\\), a contradiction.\n\nIf \\(T\\) is of Type 2, there are two possible positions for \\(n\\) in \\(S\\), on either side of 0 . As above, we check that both positions lead to beautiful arrangements of \\([0, n]\\).\n\nHence if we let \\(M_{n}\\) be the number of beautiful arrangements of \\([0, n]\\), and let \\(L_{n}\\) be the number of beautiful arrangements of \\([0, n-1]\\) of Type 2, we have\n\n\\[\nM_{n}=\\left(M_{n-1}-L_{n-1}\\right)+2 L_{n-1}=M_{n-1}+L_{n-1}\n\\]\n\nIt then remains to show that \\(L_{n-1}\\) is the number of pairs ( \\(x, y\\) ) of positive integers with \\(x+y=n\\) and \\(\\operatorname{gcd}(x, y)=1\\). Since \\(n \\geqslant 3\\), this number equals \\(\\varphi(n)=\\#\\{x: 1 \\leqslant x \\leqslant n, \\operatorname{gcd}(x, n)=1\\}\\).\n\nTo prove this, consider a Type 2 beautiful arrangement of \\([0, n-1]\\). Label the positions \\(0, \\ldots, n-1(\\bmod n)\\) clockwise around the circle, so that number 0 is in position 0 . Let \\(f(i)\\) be the number in position \\(i\\); note that \\(f\\) is a permutation of \\([0, n-1]\\). Let \\(a\\) be the position such that \\(f(a)=n-1\\).\n\nSince the \\(n\\)-chords are aligned with 0 , and every point is in an \\(n\\)-chord, these chords are all parallel and\n\n\\[\nf(i)+f(-i)=n \\quad \\text { for all } i\n\\]\n\nSimilarly, since the \\((n-1)\\)-chords are aligned and every point is in an \\((n-1)\\)-chord, these chords are also parallel and\n\n\\[\nf(i)+f(a-i)=n-1 \\quad \\text { for all } i\n\\]\n\nTherefore \\(f(a-i)=f(-i)-1\\) for all \\(i\\); and since \\(f(0)=0\\), we get\n\n\\[\nf(-a k)=k \\quad \\text { for all } k\n\\]\n\nRecall that this is an equality modulo \\(n\\). Since \\(f\\) is a permutation, we must have \\((a, n)=1\\). Hence \\(L_{n-1} \\leqslant \\varphi(n)\\).\n\nTo prove equality, it remains to observe that the labeling (1) is beautiful. To see this, consider four numbers \\(w, x, y, z\\) on the circle with \\(w+y=x+z\\). Their positions around the circle satisfy \\((-a w)+(-a y)=(-a x)+(-a z)\\), which means that the chord from \\(w\\) to \\(y\\) and the chord from \\(x\\) to \\(z\\) are parallel. Thus (1) is beautiful, and by construction it has Type 2. The desired result follows.\n\nSolution 2. Notice that there are exactly \\(N\\) irreducible fractions \\(f_{1}<\\cdots<f_{N}\\) in \\((0,1)\\) whose denominator is at most \\(n\\), since the pair ( \\(x, y\\) ) with \\(x+y \\leqslant n\\) and ( \\(x, y\\) ) \\(=1\\) corresponds to the fraction \\(x /(x+y)\\). Write \\(f_{i}=\\frac{a_{i}}{b_{i}}\\) for \\(1 \\leqslant i \\leqslant N\\).\n\nWe begin by constructing \\(N+1\\) beautiful arrangements. Take any \\(\\alpha \\in(0,1)\\) which is not one of the above \\(N\\) fractions. Consider a circle of perimeter 1 . Successively mark points \\(0,1,2, \\ldots, n\\) where 0 is arbitrary, and the clockwise distance from \\(i\\) to \\(i+1\\) is \\(\\alpha\\). The point \\(k\\) will be at clockwise distance \\(\\{k \\alpha\\}\\) from 0 , where \\(\\{r\\}\\) denotes the fractional part of \\(r\\). Call such a circular arrangement cyclic and denote it by \\(A(\\alpha)\\). If the clockwise order of the points is the same in \\(A\\left(\\alpha_{1}\\right)\\) and \\(A\\left(\\alpha_{2}\\right)\\), we regard them as the same circular arrangement. Figure 3 shows the cyclic arrangement \\(A(3 / 5+\\epsilon)\\) of \\([0,13]\\) where \\(\\epsilon>0\\) is very small.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-35}\n\nFigure 3\nIf \\(0 \\leqslant a, b, c, d \\leqslant n\\) satisfy \\(a+c=b+d\\), then \\(a \\alpha+c \\alpha=b \\alpha+d \\alpha\\), so the chord from \\(a\\) to \\(c\\) is parallel to the chord from \\(b\\) to \\(d\\) in \\(A(\\alpha)\\). Hence in a cyclic arrangement all \\(k\\)-chords are parallel. In particular every cyclic arrangement is beautiful.\n\nNext we show that there are exactly \\(N+1\\) distinct cyclic arrangements. To see this, let us see how \\(A(\\alpha)\\) changes as we increase \\(\\alpha\\) from 0 to 1 . The order of points \\(p\\) and \\(q\\) changes precisely when we cross a value \\(\\alpha=f\\) such that \\(\\{p f\\}=\\{q f\\}\\); this can only happen if \\(f\\) is one of the \\(N\\) fractions \\(f_{1}, \\ldots, f_{N}\\). Therefore there are at most \\(N+1\\) different cyclic arrangements.\n\nTo show they are all distinct, recall that \\(f_{i}=a_{i} / b_{i}\\) and let \\(\\epsilon>0\\) be a very small number. In the arrangement \\(A\\left(f_{i}+\\epsilon\\right)\\), point \\(k\\) lands at \\(\\frac{k a_{i}\\left(\\bmod b_{i}\\right)}{b_{i}}+k \\epsilon\\). Therefore the points are grouped into \\(b_{i}\\) clusters next to the points \\(0, \\frac{1}{b_{i}}, \\ldots, \\frac{b_{i}-1}{b_{i}}\\) of the circle. The cluster following \\(\\frac{k}{b_{i}}\\) contains the numbers congruent to \\(k a_{i}^{-1}\\) modulo \\(b_{i}\\), listed clockwise in increasing order. It follows that the first number after 0 in \\(A\\left(f_{i}+\\epsilon\\right)\\) is \\(b_{i}\\), and the first number after 0 which is less than \\(b_{i}\\) is \\(a_{i}^{-1}\\left(\\bmod b_{i}\\right)\\), which uniquely determines \\(a_{i}\\). In this way we can recover \\(f_{i}\\) from the cyclic arrangement. Note also that \\(A\\left(f_{i}+\\epsilon\\right)\\) is not the trivial arrangement where we list \\(0,1, \\ldots, n\\) in order clockwise. It follows that the \\(N+1\\) cyclic arrangements \\(A(\\epsilon), A\\left(f_{1}+\\epsilon\\right), \\ldots, A\\left(f_{N}+\\epsilon\\right)\\) are distinct.\n\nLet us record an observation which will be useful later:\n\n\\[\n\\text { if } f_{i}<\\alpha<f_{i+1} \\text { then } 0 \\text { is immediately after } b_{i+1} \\text { and before } b_{i} \\text { in } A(\\alpha) \\text {. }\n\\]\n\nIndeed, we already observed that \\(b_{i}\\) is the first number after 0 in \\(A\\left(f_{i}+\\epsilon\\right)=A(\\alpha)\\). Similarly we see that \\(b_{i+1}\\) is the last number before 0 in \\(A\\left(f_{i+1}-\\epsilon\\right)=A(\\alpha)\\).\n\nFinally, we show that any beautiful arrangement of \\([0, n]\\) is cyclic by induction on \\(n\\). For \\(n \\leqslant 2\\) the result is clear. Now assume that all beautiful arrangements of \\([0, n-1]\\) are cyclic, and consider a beautiful arrangement \\(A\\) of \\([0, n]\\). The subarrangement \\(A_{n-1}=A \\backslash\\{n\\}\\) of \\([0, n-1]\\) obtained by deleting \\(n\\) is cyclic; say \\(A_{n-1}=A_{n-1}(\\alpha)\\).\n\nLet \\(\\alpha\\) be between the consecutive fractions \\(\\frac{p_{1}}{q_{1}}<\\frac{p_{2}}{q_{2}}\\) among the irreducible fractions of denominator at most \\(n-1\\). There is at most one fraction \\(\\frac{i}{n}\\) in ( \\(\\frac{p_{1}}{q_{1}}, \\frac{p_{2}}{q_{2}}\\) ), since \\(\\frac{i}{n}<\\frac{i}{n-1} \\leqslant \\frac{i+1}{n}\\) for \\(0<i \\leqslant n-1\\).\n\nCase 1. There is no fraction with denominator \\(n\\) between \\(\\frac{p_{1}}{q_{1}}\\) and \\(\\frac{p_{2}}{q_{2}}\\).\nIn this case the only cyclic arrangement extending \\(A_{n-1}(\\alpha)\\) is \\(A_{n}(\\alpha)\\). We know that \\(A\\) and \\(A_{n}(\\alpha)\\) can only differ in the position of \\(n\\). Assume \\(n\\) is immediately after \\(x\\) and before \\(y\\) in \\(A_{n}(\\alpha)\\). Since the neighbors of 0 are \\(q_{1}\\) and \\(q_{2}\\) by (2), we have \\(x, y \\geqslant 1\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-36}\n\nFigure 4\nIn \\(A_{n}(\\alpha)\\) the chord from \\(n-1\\) to \\(x\\) is parallel and adjacent to the chord from \\(n\\) to \\(x-1\\), so \\(n-1\\) is between \\(x-1\\) and \\(x\\) in clockwise order, as shown in Figure 4. Similarly, \\(n-1\\) is between \\(y\\) and \\(y-1\\). Therefore \\(x, y, x-1, n-1\\), and \\(y-1\\) occur in this order in \\(A_{n}(\\alpha)\\) and hence in \\(A\\) (possibly with \\(y=x-1\\) or \\(x=y-1\\) ).\n\nNow, \\(A\\) may only differ from \\(A_{n}(\\alpha)\\) in the location of \\(n\\). In \\(A\\), since the chord from \\(n-1\\) to \\(x\\) and the chord from \\(n\\) to \\(x-1\\) do not intersect, \\(n\\) is between \\(x\\) and \\(n-1\\). Similarly, \\(n\\) is between \\(n-1\\) and \\(y\\). Then \\(n\\) must be between \\(x\\) and \\(y\\) and \\(A=A_{n}(\\alpha)\\). Therefore \\(A\\) is cyclic as desired.\nCase 2. There is exactly one \\(i\\) with \\(\\frac{p_{1}}{q_{1}}<\\frac{i}{n}<\\frac{p_{2}}{q_{2}}\\).\nIn this case there exist two cyclic arrangements \\(A_{n}\\left(\\alpha_{1}\\right)\\) and \\(A_{n}\\left(\\alpha_{2}\\right)\\) of the numbers \\(0, \\ldots, n\\) extending \\(A_{n-1}(\\alpha)\\), where \\(\\frac{p_{1}}{q_{1}}<\\alpha_{1}<\\frac{i}{n}\\) and \\(\\frac{i}{n}<\\alpha_{2}<\\frac{p_{2}}{q_{2}}\\). In \\(A_{n-1}(\\alpha), 0\\) is the only number between \\(q_{2}\\) and \\(q_{1}\\) by (2). For the same reason, \\(n\\) is between \\(q_{2}\\) and 0 in \\(A_{n}\\left(\\alpha_{1}\\right)\\), and between 0 and \\(q_{1}\\) in \\(A_{n}\\left(\\alpha_{2}\\right)\\).\n\nLetting \\(x=q_{2}\\) and \\(y=q_{1}\\), the argument of Case 1 tells us that \\(n\\) must be between \\(x\\) and \\(y\\) in \\(A\\). Therefore \\(A\\) must equal \\(A_{n}\\left(\\alpha_{1}\\right)\\) or \\(A_{n}\\left(\\alpha_{2}\\right)\\), and therefore it is cyclic.\n\nThis concludes the proof that every beautiful arrangement is cyclic. It follows that there are exactly \\(N+1\\) beautiful arrangements of \\([0, n]\\) as we wished to show."}
{"id": "imo-shortlist-2013-c8", "question": "C8. Players \\(A\\) and \\(B\\) play a paintful game on the real line. Player \\(A\\) has a pot of paint with four units of black ink. A quantity \\(p\\) of this ink suffices to blacken a (closed) real interval of length \\(p\\). In every round, player \\(A\\) picks some positive integer \\(m\\) and provides \\(1 / 2^{m}\\) units of ink from the pot. Player \\(B\\) then picks an integer \\(k\\) and blackens the interval from \\(k / 2^{m}\\) to \\((k+1) / 2^{m}\\) (some parts of this interval may have been blackened before). The goal of player \\(A\\) is to reach a situation where the pot is empty and the interval \\([0,1]\\) is not completely blackened.\n\nDecide whether there exists a strategy for player \\(A\\) to win in a finite number of moves.\n(Austria)\nAnswer. No. Such a strategy for player \\(A\\) does not exist.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2013, "solution": "We will present a strategy for player \\(B\\) that guarantees that the interval \\([0,1]\\) is completely blackened, once the paint pot has become empty.\n\nAt the beginning of round \\(r\\), let \\(x_{r}\\) denote the largest real number for which the interval between 0 and \\(x_{r}\\) has already been blackened; for completeness we define \\(x_{1}=0\\). Let \\(m\\) be the integer picked by player \\(A\\) in this round; we define an integer \\(y_{r}\\) by\n\n\\[\n\\frac{y_{r}}{2^{m}} \\leqslant x_{r}<\\frac{y_{r}+1}{2^{m}}\n\\]\n\nNote that \\(I_{0}^{r}=\\left[y_{r} / 2^{m},\\left(y_{r}+1\\right) / 2^{m}\\right]\\) is the leftmost interval that may be painted in round \\(r\\) and that still contains some uncolored point.\n\nPlayer \\(B\\) now looks at the next interval \\(I_{1}^{r}=\\left[\\left(y_{r}+1\\right) / 2^{m},\\left(y_{r}+2\\right) / 2^{m}\\right]\\). If \\(I_{1}^{r}\\) still contains an uncolored point, then player \\(B\\) blackens the interval \\(I_{1}^{r}\\); otherwise he blackens the interval \\(I_{0}^{r}\\). We make the convention that, at the beginning of the game, the interval \\([1,2]\\) is already blackened; thus, if \\(y_{r}+1=2^{m}\\), then \\(B\\) blackens \\(I_{0}^{r}\\).\n\nOur aim is to estimate the amount of ink used after each round. Firstly, we will prove by induction that, if before \\(r\\) th round the segment \\([0,1]\\) is not completely colored, then, before this move,\n(i) the amount of ink used for the segment \\(\\left[0, x_{r}\\right]\\) is at most \\(3 x_{r}\\); and\n(ii) for every \\(m, B\\) has blackened at most one interval of length \\(1 / 2^{m}\\) to the right of \\(x_{r}\\).\n\nObviously, these conditions are satisfied for \\(r=0\\). Now assume that they were satisfied before the \\(r\\) th move, and consider the situation after this move; let \\(m\\) be the number \\(A\\) has picked at this move.\n\nIf \\(B\\) has blackened the interval \\(I_{1}^{r}\\) at this move, then \\(x_{r+1}=x_{r}\\), and \\((i)\\) holds by the induction hypothesis. Next, had \\(B\\) blackened before the \\(r\\) th move any interval of length \\(1 / 2^{m}\\) to the right of \\(x_{r}\\), this interval would necessarily coincide with \\(I_{1}^{r}\\). By our strategy, this cannot happen. So, condition (ii) also remains valid.\n\nAssume now that \\(B\\) has blackened the interval \\(I_{0}^{r}\\) at the \\(r\\) th move, but the interval \\([0,1]\\) still contains uncolored parts (which means that \\(I_{1}^{r}\\) is contained in \\([0,1]\\) ). Then condition ( \\(i i\\) ) clearly remains true, and we need to check ( \\(i\\) ) only. In our case, the intervals \\(I_{0}^{r}\\) and \\(I_{1}^{r}\\) are completely colored after the \\(r\\) th move, so \\(x_{r+1}\\) either reaches the right endpoint of \\(I_{1}\\) or moves even further to the right. So, \\(x_{r+1}=x_{r}+\\alpha\\) for some \\(\\alpha>1 / 2^{m}\\).\n\nNext, any interval blackened by \\(B\\) before the \\(r\\) th move which intersects ( \\(x_{r}, x_{r+1}\\) ) should be contained in \\(\\left[x_{r}, x_{r+1}\\right]\\); by ( \\(i i\\) ), all such intervals have different lengths not exceeding \\(1 / 2^{m}\\), so the total amount of ink used for them is less than \\(2 / 2^{m}\\). Thus, the amount of ink used for the segment \\(\\left[0, x_{r+1}\\right]\\) does not exceed the sum of \\(2 / 2^{m}, 3 x_{r}\\) (used for \\(\\left[0, x_{r}\\right]\\) ), and \\(1 / 2^{m}\\) used for the\nsegment \\(I_{0}^{r}\\). In total it gives at most \\(3\\left(x_{r}+1 / 2^{m}\\right)<3\\left(x_{r}+\\alpha\\right)=3 x_{r+1}\\). Thus condition \\((i)\\) is also verified in this case. The claim is proved.\n\nFinally, we can perform the desired estimation. Consider any situation in the game, say after the \\((r-1)\\) st move; assume that the segment \\([0,1]\\) is not completely black. By \\((i i)\\), in the segment \\(\\left[x_{r}, 1\\right]\\) player \\(B\\) has colored several segments of different lengths; all these lengths are negative powers of 2 not exceeding \\(1-x_{r}\\); thus the total amount of ink used for this interval is at most \\(2\\left(1-x_{r}\\right)\\). Using \\((i)\\), we obtain that the total amount of ink used is at most \\(3 x_{r}+2\\left(1-x_{r}\\right)<3\\). Thus the pot is not empty, and therefore \\(A\\) never wins.\n\nComment 1. Notice that this strategy works even if the pot contains initially only 3 units of ink.\nComment 2. There exist other strategies for \\(B\\) allowing him to prevent emptying the pot before the whole interval is colored. On the other hand, let us mention some idea which does not work.\n\nPlayer \\(B\\) could try a strategy in which the set of blackened points in each round is an interval of the type \\([0, x]\\). Such a strategy cannot work (even if there is more ink available). Indeed, under the assumption that \\(B\\) uses such a strategy, let us prove by induction on \\(s\\) the following statement:\n\nFor any positive integer \\(s\\), player \\(A\\) has a strategy picking only positive integers \\(m \\leqslant s\\) in which, if player \\(B\\) ever paints a point \\(x \\geqslant 1-1 / 2^{s}\\) then after some move, exactly the interval \\(\\left[0,1-1 / 2^{s}\\right]\\) is blackened, and the amount of ink used up to this moment is at least \\(s / 2\\).\n\nFor the base case \\(s=1\\), player \\(A\\) just picks \\(m=1\\) in the first round. If for some positive integer \\(k\\) player \\(A\\) has such a strategy, for \\(s+1\\) he can first rescale his strategy to the interval \\([0,1 / 2]\\) (sending in each round half of the amount of ink he would give by the original strategy). Thus, after some round, the interval \\(\\left[0,1 / 2-1 / 2^{s+1}\\right]\\) becomes blackened, and the amount of ink used is at least \\(s / 4\\). Now player \\(A\\) picks \\(m=1 / 2\\), and player \\(B\\) spends \\(1 / 2\\) unit of ink to blacken the interval \\([0,1 / 2]\\). After that, player \\(A\\) again rescales his strategy to the interval \\([1 / 2,1]\\), and player \\(B\\) spends at least \\(s / 4\\) units of ink to blacken the interval \\(\\left[1 / 2,1-1 / 2^{s+1}\\right]\\), so he spends in total at least \\(s / 4+1 / 2+s / 4=(s+1) / 2\\) units of ink.\n\nComment 3. In order to avoid finiteness issues, the statement could be replaced by the following one:\nPlayers \\(A\\) and \\(B\\) play a paintful game on the real numbers. Player \\(A\\) has a paint pot with four units of black ink. A quantity \\(p\\) of this ink suffices to blacken a (closed) real interval of length \\(p\\). In the beginning of the game, player \\(A\\) chooses (and announces) a positive integer \\(N\\). In every round, player \\(A\\) picks some positive integer \\(m \\leqslant N\\) and provides \\(1 / 2^{m}\\) units of ink from the pot. The player \\(B\\) picks an integer \\(k\\) and blackens the interval from \\(k / 2^{m}\\) to \\((k+1) / 2^{m}\\) (some parts of this interval may happen to be blackened before). The goal of player \\(A\\) is to reach a situation where the pot is empty and the interval \\([0,1]\\) is not completely blackened.\nDecide whether there exists a strategy for player \\(A\\) to win.\nHowever, the Problem Selection Committee believes that this version may turn out to be harder than the original one."}
{"id": "imo-shortlist-2013-g1", "question": "G1. Let \\(A B C\\) be an acute-angled triangle with orthocenter \\(H\\), and let \\(W\\) be a point on side \\(B C\\). Denote by \\(M\\) and \\(N\\) the feet of the altitudes from \\(B\\) and \\(C\\), respectively. Denote by \\(\\omega_{1}\\) the circumcircle of \\(B W N\\), and let \\(X\\) be the point on \\(\\omega_{1}\\) which is diametrically opposite to \\(W\\). Analogously, denote by \\(\\omega_{2}\\) the circumcircle of \\(C W M\\), and let \\(Y\\) be the point on \\(\\omega_{2}\\) which is diametrically opposite to \\(W\\). Prove that \\(X, Y\\) and \\(H\\) are collinear.\n(Thaliand)", "category": "Geometry", "source": "IMO Shortlist", "year": 2013, "solution": "Let \\(L\\) be the foot of the altitude from \\(A\\), and let \\(Z\\) be the second intersection point of circles \\(\\omega_{1}\\) and \\(\\omega_{2}\\), other than \\(W\\). We show that \\(X, Y, Z\\) and \\(H\\) lie on the same line.\n\nDue to \\(\\angle B N C=\\angle B M C=90^{\\circ}\\), the points \\(B, C, N\\) and \\(M\\) are concyclic; denote their circle by \\(\\omega_{3}\\). Observe that the line \\(W Z\\) is the radical axis of \\(\\omega_{1}\\) and \\(\\omega_{2}\\); similarly, \\(B N\\) is the radical axis of \\(\\omega_{1}\\) and \\(\\omega_{3}\\), and \\(C M\\) is the radical axis of \\(\\omega_{2}\\) and \\(\\omega_{3}\\). Hence \\(A=B N \\cap C M\\) is the radical center of the three circles, and therefore \\(W Z\\) passes through \\(A\\).\n\nSince \\(W X\\) and \\(W Y\\) are diameters in \\(\\omega_{1}\\) and \\(\\omega_{2}\\), respectively, we have \\(\\angle W Z X=\\angle W Z Y=90^{\\circ}\\), so the points \\(X\\) and \\(Y\\) lie on the line through \\(Z\\), perpendicular to \\(W Z\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-39}\n\nThe quadrilateral \\(B L H N\\) is cyclic, because it has two opposite right angles. From the power of \\(A\\) with respect to the circles \\(\\omega_{1}\\) and \\(B L H N\\) we find \\(A L \\cdot A H=A B \\cdot A N=A W \\cdot A Z\\). If \\(H\\) lies on the line \\(A W\\) then this implies \\(H=Z\\) immediately. Otherwise, by \\(\\frac{A Z}{A H}=\\frac{A L}{A W}\\) the triangles \\(A H Z\\) and \\(A W L\\) are similar. Then \\(\\angle H Z A=\\angle W L A=90^{\\circ}\\), so the point \\(H\\) also lies on the line \\(X Y Z\\).\n\nComment. The original proposal also included a second statement:\nLet \\(P\\) be the point on \\(\\omega_{1}\\) such that \\(W P\\) is parallel to \\(C N\\), and let \\(Q\\) be the point on \\(\\omega_{2}\\) such that \\(W Q\\) is parallel to \\(B M\\). Prove that \\(P, Q\\) and \\(H\\) are collinear if and only if \\(B W=C W\\) or \\(A W \\perp B C\\).\n\nThe Problem Selection Committee considered the first part more suitable for the competition."}
{"id": "imo-shortlist-2013-g2", "question": "G2. Let \\(\\omega\\) be the circumcircle of a triangle \\(A B C\\). Denote by \\(M\\) and \\(N\\) the midpoints of the sides \\(A B\\) and \\(A C\\), respectively, and denote by \\(T\\) the midpoint of the \\(\\operatorname{arc} B C\\) of \\(\\omega\\) not containing \\(A\\). The circumcircles of the triangles \\(A M T\\) and \\(A N T\\) intersect the perpendicular bisectors of \\(A C\\) and \\(A B\\) at points \\(X\\) and \\(Y\\), respectively; assume that \\(X\\) and \\(Y\\) lie inside the triangle \\(A B C\\). The lines \\(M N\\) and \\(X Y\\) intersect at \\(K\\). Prove that \\(K A=K T\\).\n(Iran)", "category": "Geometry", "source": "IMO Shortlist", "year": 2013, "solution": "Let \\(O\\) be the center of \\(\\omega\\), thus \\(O=M Y \\cap N X\\). Let \\(\\ell\\) be the perpendicular bisector of \\(A T\\) (it also passes through \\(O\\) ). Denote by \\(r\\) the operation of reflection about \\(\\ell\\). Since \\(A T\\) is the angle bisector of \\(\\angle B A C\\), the line \\(r(A B)\\) is parallel to \\(A C\\). Since \\(O M \\perp A B\\) and \\(O N \\perp A C\\), this means that the line \\(r(O M)\\) is parallel to the line \\(O N\\) and passes through \\(O\\), so \\(r(O M)=O N\\). Finally, the circumcircle \\(\\gamma\\) of the triangle \\(A M T\\) is symmetric about \\(\\ell\\), so \\(r(\\gamma)=\\gamma\\). Thus the point \\(M\\) maps to the common point of \\(O N\\) with the arc \\(A M T\\) of \\(\\gamma\\) - that is, \\(r(M)=X\\).\n\nSimilarly, \\(r(N)=Y\\). Thus, we get \\(r(M N)=X Y\\), and the common point \\(K\\) of \\(M N\\) and \\(X Y\\) lies on \\(\\ell\\). This means exactly that \\(K A=K T\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-40}\n\nSolution 2. Let \\(L\\) be the second common point of the line \\(A C\\) with the circumcircle \\(\\gamma\\) of the triangle \\(A M T\\). From the cyclic quadrilaterals \\(A B T C\\) and \\(A M T L\\) we get \\(\\angle B T C=180^{\\circ}-\\) \\(\\angle B A C=\\angle M T L\\), which implies \\(\\angle B T M=\\angle C T L\\). Since \\(A T\\) is an angle bisector in these quadrilaterals, we have \\(B T=T C\\) and \\(M T=T L\\). Thus the triangles \\(B T M\\) and \\(C T L\\) are congruent, so \\(C L=B M=A M\\).\n\nLet \\(X^{\\prime}\\) be the common point of the line \\(N X\\) with the external bisector of \\(\\angle B A C\\); notice that it lies outside the triangle \\(A B C\\). Then we have \\(\\angle T A X^{\\prime}=90^{\\circ}\\) and \\(X^{\\prime} A=X^{\\prime} C\\), so we get \\(\\angle X^{\\prime} A M=90^{\\circ}+\\angle B A C / 2=180^{\\circ}-\\angle X^{\\prime} A C=180^{\\circ}-\\angle X^{\\prime} C A=\\angle X^{\\prime} C L\\). Thus the triangles \\(X^{\\prime} A M\\) and \\(X^{\\prime} C L\\) are congruent, and therefore\n\n\\[\n\\angle M X^{\\prime} L=\\angle A X^{\\prime} C+\\left(\\angle C X^{\\prime} L-\\angle A X^{\\prime} M\\right)=\\angle A X^{\\prime} C=180^{\\circ}-2 \\angle X^{\\prime} A C=\\angle B A C=\\angle M A L .\n\\]\n\nThis means that \\(X^{\\prime}\\) lies on \\(\\gamma\\).\nThus we have \\(\\angle T X N=\\angle T X X^{\\prime}=\\angle T A X^{\\prime}=90^{\\circ}\\), so \\(T X \\| A C\\). Then \\(\\angle X T A=\\angle T A C=\\) \\(\\angle T A M\\), so the cyclic quadrilateral MATX is an isosceles trapezoid. Similarly, NATY is an isosceles trapezoid, so again the lines \\(M N\\) and \\(X Y\\) are the reflections of each other about the perpendicular bisector of \\(A T\\). Thus \\(K\\) belongs to this perpendicular bisector.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-41}\n\nComment. There are several different ways of showing that the points \\(X\\) and \\(M\\) are symmetrical with respect to \\(\\ell\\). For instance, one can show that the quadrilaterals \\(A M O N\\) and \\(T X O Y\\) are congruent. We chose Solution 1 as a simple way of doing it. On the other hand, Solution 2 shows some other interesting properties of the configuration.\n\nLet us define \\(Y^{\\prime}\\), analogously to \\(X^{\\prime}\\), as the common point of \\(M Y\\) and the external bisector of \\(\\angle B A C\\). One may easily see that in general the lines \\(M N\\) and \\(X^{\\prime} Y^{\\prime}\\) (which is the external bisector of \\(\\angle B A C\\) ) do not intersect on the perpendicular bisector of \\(A T\\). Thus, any solution should involve some argument using the choice of the intersection points \\(X\\) and \\(Y\\)."}
{"id": "imo-shortlist-2013-g3", "question": "G3. In a triangle \\(A B C\\), let \\(D\\) and \\(E\\) be the feet of the angle bisectors of angles \\(A\\) and \\(B\\), respectively. A rhombus is inscribed into the quadrilateral \\(A E D B\\) (all vertices of the rhombus lie on different sides of \\(A E D B\\) ). Let \\(\\varphi\\) be the non-obtuse angle of the rhombus. Prove that \\(\\varphi \\leqslant \\max \\{\\angle B A C, \\angle A B C\\}\\).\n(Serbia)", "category": "Geometry", "source": "IMO Shortlist", "year": 2013, "solution": "Let \\(K, L, M\\), and \\(N\\) be the vertices of the rhombus lying on the sides \\(A E, E D, D B\\), and \\(B A\\), respectively. Denote by \\(d(X, Y Z)\\) the distance from a point \\(X\\) to a line \\(Y Z\\). Since \\(D\\) and \\(E\\) are the feet of the bisectors, we have \\(d(D, A B)=d(D, A C), d(E, A B)=d(E, B C)\\), and \\(d(D, B C)=d(E, A C)=0\\), which implies\n\n\\[\nd(D, A C)+d(D, B C)=d(D, A B) \\quad \\text { and } \\quad d(E, A C)+d(E, B C)=d(E, A B)\n\\]\n\nSince \\(L\\) lies on the segment \\(D E\\) and the relation \\(d(X, A C)+d(X, B C)=d(X, A B)\\) is linear in \\(X\\) inside the triangle, these two relations imply\n\n\\[\nd(L, A C)+d(L, B C)=d(L, A B)\n\\]\n\nDenote the angles as in the figure below, and denote \\(a=K L\\). Then we have \\(d(L, A C)=a \\sin \\mu\\) and \\(d(L, B C)=a \\sin \\nu\\). Since \\(K L M N\\) is a parallelogram lying on one side of \\(A B\\), we get\n\n\\[\nd(L, A B)=d(L, A B)+d(N, A B)=d(K, A B)+d(M, A B)=a(\\sin \\delta+\\sin \\varepsilon)\n\\]\n\nThus the condition (1) reads\n\n\\[\n\\sin \\mu+\\sin \\nu=\\sin \\delta+\\sin \\varepsilon\n\\]\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2025_05_30_f5ba16bf9d53675b385ag-42}\n\n\nIf one of the angles \\(\\alpha\\) and \\(\\beta\\) is non-acute, then the desired inequality is trivial. So we assume that \\(\\alpha, \\beta<\\pi / 2\\). It suffices to show then that \\(\\psi=\\angle N K L \\leqslant \\max \\{\\alpha, \\beta\\}\\).\n\nAssume, to the contrary, that \\(\\psi>\\max \\{\\alpha, \\beta\\}\\). Since \\(\\mu+\\psi=\\angle C K N=\\alpha+\\delta\\), by our assumption we obtain \\(\\mu=(\\alpha-\\psi)+\\delta<\\delta\\). Similarly, \\(\\nu<\\varepsilon\\). Next, since \\(K N \\| M L\\), we have \\(\\beta=\\delta+\\nu\\), so \\(\\delta<\\beta<\\pi / 2\\). Similarly, \\(\\varepsilon<\\pi / 2\\). Finally, by \\(\\mu<\\delta<\\pi / 2\\) and \\(\\nu<\\varepsilon<\\pi / 2\\), we obtain\n\n\\[\n\\sin \\mu<\\sin \\delta \\quad \\text { and } \\quad \\sin \\nu<\\sin \\varepsilon\n\\]\n\nThis contradicts (2).\nComment. One can see that the equality is achieved if \\(\\alpha=\\beta\\) for every rhombus inscribed into the quadrilateral \\(A E D B\\)."}
{"id": "imo-shortlist-2013-g4", "question": "G4. Let \\(A B C\\) be a triangle with \\(\\angle B>\\angle C\\). Let \\(P\\) and \\(Q\\) be two different points on line \\(A C\\) such that \\(\\angle P B A=\\angle Q B A=\\angle A C B\\) and \\(A\\) is located between \\(P\\) and \\(C\\). Suppose that there exists an interior point \\(D\\) of segment \\(B Q\\) for which \\(P D=P B\\). Let the ray \\(A D\\) intersect the circle \\(A B C\\) at \\(R \\neq A\\). Prove that \\(Q B=Q R\\).\n(Georgia)", "category": "Geometry", "source": "IMO Shortlist", "year": 2013, "solution": "Denote by \\(\\omega\\) the circumcircle of the triangle \\(A B C\\), and let \\(\\angle A C B=\\gamma\\). Note that the condition \\(\\gamma<\\angle C B A\\) implies \\(\\gamma<90^{\\circ}\\). Since \\(\\angle P B A=\\gamma\\), the line \\(P B\\) is tangent to \\(\\omega\\), so \\(P A \\cdot P C=P B^{2}=P D^{2}\\). By \\(\\frac{P A}{P D}=\\frac{P D}{P C}\\) the triangles \\(P A D\\) and \\(P D C\\) are similar, and \\(\\angle A D P=\\angle D C P\\).\n\nNext, since \\(\\angle A B Q=\\angle A C B\\), the triangles \\(A B C\\) and \\(A Q B\\) are also similar. Then \\(\\angle A Q B=\\) \\(\\angle A B C=\\angle A R C\\), which means that the points \\(D, R, C\\), and \\(Q\\) are concyclic. Therefore \\(\\angle D R Q=\\) \\(\\angle D C Q=\\angle A D P\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-43}\n\nFigure 1\nNow from \\(\\angle A R B=\\angle A C B=\\gamma\\) and \\(\\angle P D B=\\angle P B D=2 \\gamma\\) we get\n\n\\[\n\\angle Q B R=\\angle A D B-\\angle A R B=\\angle A D P+\\angle P D B-\\angle A R B=\\angle D R Q+\\gamma=\\angle Q R B,\n\\]\n\nso the triangle \\(Q R B\\) is isosceles, which yields \\(Q B=Q R\\).\nSolution 2. Again, denote by \\(\\omega\\) the circumcircle of the triangle \\(A B C\\). Denote \\(\\angle A C B=\\gamma\\). Since \\(\\angle P B A=\\gamma\\), the line \\(P B\\) is tangent to \\(\\omega\\).\n\nLet \\(E\\) be the second intersection point of \\(B Q\\) with \\(\\omega\\). If \\(V^{\\prime}\\) is any point on the ray \\(C E\\) beyond \\(E\\), then \\(\\angle B E V^{\\prime}=180^{\\circ}-\\angle B E C=180^{\\circ}-\\angle B A C=\\angle P A B\\); together with \\(\\angle A B Q=\\) \\(\\angle P B A\\) this shows firstly, that the rays \\(B A\\) and \\(C E\\) intersect at some point \\(V\\), and secondly that the triangle \\(V E B\\) is similar to the triangle \\(P A B\\). Thus we have \\(\\angle B V E=\\angle B P A\\). Next, \\(\\angle A E V=\\angle B E V-\\gamma=\\angle P A B-\\angle A B Q=\\angle A Q B\\); so the triangles \\(P B Q\\) and \\(V A E\\) are also similar.\n\nLet \\(P H\\) be an altitude in the isosceles triangle \\(P B D\\); then \\(B H=H D\\). Let \\(G\\) be the intersection point of \\(P H\\) and \\(A B\\). By the symmetry with respect to \\(P H\\), we have \\(\\angle B D G=\\angle D B G=\\gamma=\\) \\(\\angle B E A\\); thus \\(D G \\| A E\\) and hence \\(\\frac{B G}{G A}=\\frac{B D}{D E}\\). Thus the points \\(G\\) and \\(D\\) correspond to each other in the similar triangles \\(P A B\\) and \\(V E B\\), so \\(\\angle D V B=\\angle G P B=90^{\\circ}-\\angle P B Q=90^{\\circ}-\\angle V A E\\). Thus \\(V D \\perp A E\\).\n\nLet \\(T\\) be the common point of \\(V D\\) and \\(A E\\), and let \\(D S\\) be an altitude in the triangle \\(B D R\\). The points \\(S\\) and \\(T\\) are the feet of corresponding altitudes in the similar triangles \\(A D E\\) and \\(B D R\\), so \\(\\frac{B S}{S R}=\\frac{A T}{T E}\\). On the other hand, the points \\(T\\) and \\(H\\) are feet of corresponding altitudes in the similar triangles \\(V A E\\) and \\(P B Q\\), so \\(\\frac{A T}{T E}=\\frac{B H}{H Q}\\). Thus \\(\\frac{B S}{S R}=\\frac{A T}{T E}=\\frac{B H}{H Q}\\), and the triangles \\(B H S\\) and \\(B Q R\\) are similar.\n\nFinally, \\(S H\\) is a median in the right-angled triangle \\(S B D\\); so \\(B H=H S\\), and hence \\(B Q=Q R\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-44}\n\nFigure 2\n\nSolution 3. Denote by \\(\\omega\\) and \\(O\\) the circumcircle of the triangle \\(A B C\\) and its center, respectively. From the condition \\(\\angle P B A=\\angle B C A\\) we know that \\(B P\\) is tangent to \\(\\omega\\).\n\nLet \\(E\\) be the second point of intersection of \\(\\omega\\) and \\(B D\\). Due to the isosceles triangle \\(B D P\\), the tangent of \\(\\omega\\) at \\(E\\) is parallel to \\(D P\\) and consequently it intersects \\(B P\\) at some point \\(L\\). Of course, \\(P D \\| L E\\). Let \\(M\\) be the midpoint of \\(B E\\), and let \\(H\\) be the midpoint of \\(B R\\). Notice that \\(\\angle A E B=\\angle A C B=\\angle A B Q=\\angle A B E\\), so \\(A\\) lies on the perpendicular bisector of \\(B E\\); thus the points \\(L, A, M\\), and \\(O\\) are collinear. Let \\(\\omega_{1}\\) be the circle with diameter \\(B O\\). Let \\(Q^{\\prime}=H O \\cap B E\\); since \\(H O\\) is the perpendicular bisector of \\(B R\\), the statement of the problem is equivalent to \\(Q^{\\prime}=Q\\).\n\nConsider the following sequence of projections (see Fig. 3).\n\n\\begin{enumerate}\n  \\item Project the line \\(B E\\) to the line \\(L B\\) through the center \\(A\\). (This maps \\(Q\\) to \\(P\\).)\n  \\item Project the line \\(L B\\) to \\(B E\\) in parallel direction with \\(L E\\). ( \\(P \\mapsto D\\).)\n  \\item Project the line \\(B E\\) to the circle \\(\\omega\\) through its point \\(A\\). ( \\(D \\mapsto R\\).)\n  \\item Scale \\(\\omega\\) by the ratio \\(\\frac{1}{2}\\) from the point \\(B\\) to the circle \\(\\omega_{1}\\). ( \\(R \\mapsto H\\).)\n  \\item Project \\(\\omega_{1}\\) to the line \\(B E\\) through its point \\(O\\). ( \\(H \\mapsto Q^{\\prime}\\).)\n\n\nWe prove that the composition of these transforms, which maps the line \\(B E\\) to itself, is the identity. To achieve this, it suffices to show three fixed points. An obvious fixed point is \\(B\\) which is fixed by all the transformations above. Another fixed point is \\(M\\), its path being \\(M \\mapsto L \\mapsto\\) \\(E \\mapsto E \\mapsto M \\mapsto M\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-45(1)}\n\nFigure 3\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-45(2)}\n\nFigure 4\n\nIn order to show a third fixed point, draw a line parallel with \\(L E\\) through \\(A\\); let that line intersect \\(B E, L B\\) and \\(\\omega\\) at \\(X, Y\\) and \\(Z \\neq A\\), respectively (see Fig. 4). We show that \\(X\\) is a fixed point. The images of \\(X\\) at the first three transformations are \\(X \\mapsto Y \\mapsto X \\mapsto Z\\). From \\(\\angle X B Z=\\angle E A Z=\\angle A E L=\\angle L B A=\\angle B Z X\\) we can see that the triangle \\(X B Z\\) is isosceles. Let \\(U\\) be the midpoint of \\(B Z\\); then the last two transformations do \\(Z \\mapsto U \\mapsto X\\), and the point \\(X\\) is fixed.\n\nComment. Verifying that the point \\(E\\) is fixed seems more natural at first, but it appears to be less straightforward. Here we outline a possible proof.\n\nLet the images of \\(E\\) at the first three transforms above be \\(F, G\\) and \\(I\\). After comparing the angles depicted in Fig. 5 (noticing that the quadrilateral \\(A F B G\\) is cyclic) we can observe that the tangent \\(L E\\) of \\(\\omega\\) is parallel to \\(B I\\). Then, similarly to the above reasons, the point \\(E\\) is also fixed.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-45}\n\nFigure 5"}
{"id": "imo-shortlist-2013-g5", "question": "G5. Let \\(A B C D E F\\) be a convex hexagon with \\(A B=D E, B C=E F, C D=F A\\), and \\(\\angle A-\\angle D=\\angle C-\\angle F=\\angle E-\\angle B\\). Prove that the diagonals \\(A D, B E\\), and \\(C F\\) are concurrent.\n(Ukraine)\nIn all three", "category": "Geometry", "source": "IMO Shortlist", "year": 2013, "solution": "s, we denote \\(\\theta=\\angle A-\\angle D=\\angle C-\\angle F=\\angle E-\\angle B\\) and assume without loss of generality that \\(\\theta \\geqslant 0\\).\n\nSolution 1. Let \\(x=A B=D E, y=C D=F A, z=E F=B C\\). Consider the points \\(P, Q\\), and \\(R\\) such that the quadrilaterals \\(C D E P, E F A Q\\), and \\(A B C R\\) are parallelograms. We compute\n\n\\[\n\\begin{aligned}\n\\angle P E Q & =\\angle F E Q+\\angle D E P-\\angle E=\\left(180^{\\circ}-\\angle F\\right)+\\left(180^{\\circ}-\\angle D\\right)-\\angle E \n& =360^{\\circ}-\\angle D-\\angle E-\\angle F=\\frac{1}{2}(\\angle A+\\angle B+\\angle C-\\angle D-\\angle E-\\angle F)=\\theta / 2\n\n\\]\n\nSimilarly, \\(\\angle Q A R=\\angle R C P=\\theta / 2\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-46}\n\nIf \\(\\theta=0\\), since \\(\\triangle R C P\\) is isosceles, \\(R=P\\). Therefore \\(A B\\|R C=P C\\| E D\\), so \\(A B D E\\) is a parallelogram. Similarly, \\(B C E F\\) and \\(C D F A\\) are parallelograms. It follows that \\(A D, B E\\) and \\(C F\\) meet at their common midpoint.\n\nNow assume \\(\\theta>0\\). Since \\(\\triangle P E Q, \\triangle Q A R\\), and \\(\\triangle R C P\\) are isosceles and have the same angle at the apex, we have \\(\\triangle P E Q \\sim \\triangle Q A R \\sim \\triangle R C P\\) with ratios of similarity \\(y: z: x\\). Thus\n\n\\[\n\\triangle P Q R \\text { is similar to the triangle with sidelengths } y, z, \\text { and } x .\n\\]\n\nNext, notice that\n\n\\[\n\\frac{R Q}{Q P}=\\frac{z}{y}=\\frac{R A}{A F}\n\\]\n\nand, using directed angles between rays,\n\n\\[\n\\begin{aligned}\n\\Varangle(R Q, Q P) & =\\Varangle(R Q, Q E)+\\Varangle(Q E, Q P) \n& =\\Varangle(R Q, Q E)+\\npreceq(R A, R Q)=\\npreceq(R A, Q E)=\\npreceq(R A, A F) .\n\n\\]\n\nThus \\(\\triangle P Q R \\sim \\triangle F A R\\). Since \\(F A=y\\) and \\(A R=z\\), (1) then implies that \\(F R=x\\). Similarly \\(F P=x\\). Therefore \\(C R F P\\) is a rhombus.\n\nWe conclude that \\(C F\\) is the perpendicular bisector of \\(P R\\). Similarly, \\(B E\\) is the perpendicular bisector of \\(P Q\\) and \\(A D\\) is the perpendicular bisector of \\(Q R\\). It follows that \\(A D, B E\\), and \\(C F\\) are concurrent at the circumcenter of \\(P Q R\\).\n\nSolution 2. Let \\(X=C D \\cap E F, Y=E F \\cap A B, Z=A B \\cap C D, X^{\\prime}=F A \\cap B C, Y^{\\prime}=\\) \\(B C \\cap D E\\), and \\(Z^{\\prime}=D E \\cap F A\\). From \\(\\angle A+\\angle B+\\angle C=360^{\\circ}+\\theta / 2\\) we get \\(\\angle A+\\angle B>180^{\\circ}\\) and \\(\\angle B+\\angle C>180^{\\circ}\\), so \\(Z\\) and \\(X^{\\prime}\\) are respectively on the opposite sides of \\(B C\\) and \\(A B\\) from the hexagon. Similar conclusions hold for \\(X, Y, Y^{\\prime}\\), and \\(Z^{\\prime}\\). Then\n\n\\[\n\\angle Y Z X=\\angle B+\\angle C-180^{\\circ}=\\angle E+\\angle F-180^{\\circ}=\\angle Y^{\\prime} Z^{\\prime} X^{\\prime},\n\\]\n\nand similarly \\(\\angle Z X Y=\\angle Z^{\\prime} X^{\\prime} Y^{\\prime}\\) and \\(\\angle X Y Z=\\angle X^{\\prime} Y^{\\prime} Z^{\\prime}\\), so \\(\\triangle X Y Z \\sim \\triangle X^{\\prime} Y^{\\prime} Z^{\\prime}\\). Thus there is a rotation \\(R\\) which sends \\(\\triangle X Y Z\\) to a triangle with sides parallel to \\(\\triangle X^{\\prime} Y^{\\prime} Z^{\\prime}\\). Since \\(A B=D E\\) we have \\(R(\\overrightarrow{A B})=\\overrightarrow{D E}\\). Similarly, \\(R(\\overrightarrow{C D})=\\overrightarrow{F A}\\) and \\(R(\\overrightarrow{E F})=\\overrightarrow{B C}\\). Therefore\n\n\\[\n\\overrightarrow{0}=\\overrightarrow{A B}+\\overrightarrow{B C}+\\overrightarrow{C D}+\\overrightarrow{D E}+\\overrightarrow{E F}+\\overrightarrow{F A}=(\\overrightarrow{A B}+\\overrightarrow{C D}+\\overrightarrow{E F})+R(\\overrightarrow{A B}+\\overrightarrow{C D}+\\overrightarrow{E F})\n\\]\n\nIf \\(R\\) is a rotation by \\(180^{\\circ}\\), then any two opposite sides of our hexagon are equal and parallel, so the three diagonals meet at their common midpoint. Otherwise, we must have\n\n\\[\n\\overrightarrow{A B}+\\overrightarrow{C D}+\\overrightarrow{E F}=\\overrightarrow{0}\n\\]\n\nor else we would have two vectors with different directions whose sum is \\(\\overrightarrow{0}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-47}\n\nThis allows us to consider a triangle \\(L M N\\) with \\(\\overrightarrow{L M}=\\overrightarrow{E F}, \\overrightarrow{M N}=\\overrightarrow{A B}\\), and \\(\\overrightarrow{N L}=\\overrightarrow{C D}\\). Let \\(O\\) be the circumcenter of \\(\\triangle L M N\\) and consider the points \\(O_{1}, O_{2}, O_{3}\\) such that \\(\\triangle A O_{1} B, \\triangle C O_{2} D\\), and \\(\\triangle E O_{3} F\\) are translations of \\(\\triangle M O N, \\triangle N O L\\), and \\(\\triangle L O M\\), respectively. Since \\(F O_{3}\\) and \\(A O_{1}\\) are translations of \\(M O\\), quadrilateral \\(A F O_{3} O_{1}\\) is a parallelogram and \\(O_{3} O_{1}=F A=C D=N L\\). Similarly, \\(O_{1} O_{2}=L M\\) and \\(O_{2} O_{3}=M N\\). Therefore \\(\\triangle O_{1} O_{2} O_{3} \\cong \\triangle L M N\\). Moreover, by means of the rotation \\(R\\) one may check that these triangles have the same orientation.\n\nLet \\(T\\) be the circumcenter of \\(\\triangle O_{1} O_{2} O_{3}\\). We claim that \\(A D, B E\\), and \\(C F\\) meet at \\(T\\). Let us show that \\(C, T\\), and \\(F\\) are collinear. Notice that \\(C O_{2}=O_{2} T=T O_{3}=O_{3} F\\) since they are all equal to the circumradius of \\(\\triangle L M N\\). Therefore \\(\\triangle T O_{3} F\\) and \\(\\triangle C O_{2} T\\) are isosceles. Using directed angles between rays again, we get\n\n\\[\n\\Varangle\\left(T F, T O_{3}\\right)=\\Varangle\\left(F O_{3}, F T\\right) \\quad \\text { and } \\quad \\npreceq\\left(T O_{2}, T C\\right)=\\Varangle\\left(C T, C O_{2}\\right) .\n\\]\n\nAlso, \\(T\\) and \\(O\\) are the circumcenters of the congruent triangles \\(\\triangle O_{1} O_{2} O_{3}\\) and \\(\\triangle L M N\\) so we have \\(\\npreceq\\left(T O_{3}, T O_{2}\\right)=\\Varangle(O N, O M)\\). Since \\(C O_{2}\\) and \\(F O_{3}\\) are translations of \\(N O\\) and \\(M O\\) respectively, this implies\n\n\\[\n\\Varangle\\left(T O_{3}, T O_{2}\\right)=\\Varangle\\left(C O_{2}, F O_{3}\\right) .\n\\]\n\nAdding the three equations in (2) and (3) gives\n\n\\[\n\\Varangle(T F, T C)=\\Varangle(C T, F T)=-\\npreceq(T F, T C)\n\\]\n\nwhich implies that \\(T\\) is on \\(C F\\). Analogous arguments show that it is on \\(A D\\) and \\(B E\\) also. The desired result follows.\n\nSolution 3. Place the hexagon on the complex plane, with \\(A\\) at the origin and vertices labelled clockwise. Now \\(A, B, C, D, E, F\\) represent the corresponding complex numbers. Also consider the complex numbers \\(a, b, c, a^{\\prime}, b^{\\prime}, c^{\\prime}\\) given by \\(B-A=a, D-C=b, F-E=c, E-D=a^{\\prime}\\), \\(A-F=b^{\\prime}\\), and \\(C-B=c^{\\prime}\\). Let \\(k=|a| /|b|\\). From \\(a / b^{\\prime}=-k e^{i \\angle A}\\) and \\(a^{\\prime} / b=-k e^{i \\angle D}\\) we get that \\(\\left(a^{\\prime} / a\\right)\\left(b^{\\prime} / b\\right)=e^{-i \\theta}\\) and similarly \\(\\left(b^{\\prime} / b\\right)\\left(c^{\\prime} / c\\right)=e^{-i \\theta}\\) and \\(\\left(c^{\\prime} / c\\right)\\left(a^{\\prime} / a\\right)=e^{-i \\theta}\\). It follows that \\(a^{\\prime}=a r\\), \\(b^{\\prime}=b r\\), and \\(c^{\\prime}=c r\\) for a complex number \\(r\\) with \\(|r|=1\\), as shown below.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-48}\n\nWe have\n\n\\[\n0=a+c r+b+a r+c+b r=(a+b+c)(1+r)\n\\]\n\nIf \\(r=-1\\), then the hexagon is centrally symmetric and its diagonals intersect at its center of symmetry. Otherwise\n\n\\[\na+b+c=0\n\\]\n\nTherefore\n\n\\[\nA=0, \\quad B=a, \\quad C=a+c r, \\quad D=c(r-1), \\quad E=-b r-c, \\quad F=-b r .\n\\]\n\nNow consider a point \\(W\\) on \\(A D\\) given by the complex number \\(c(r-1) \\lambda\\), where \\(\\lambda\\) is a real number with \\(0<\\lambda<1\\). Since \\(D \\neq A\\), we have \\(r \\neq 1\\), so we can define \\(s=1 /(r-1)\\). From \\(r \\bar{r}=|r|^{2}=1\\) we get\n\n\\[\n1+s=\\frac{r}{r-1}=\\frac{r}{r-r \\bar{r}}=\\frac{1}{1-\\bar{r}}=-\\bar{s}\n\\]\n\nNow,\n\n\\[\n\\begin{aligned}\nW \\text { is on } B E & \\Longleftrightarrow c(r-1) \\lambda-a\\|a-(-b r-c)=b(r-1) \\Longleftrightarrow c \\lambda-a s\\| b \n& \\Longleftrightarrow-a \\lambda-b \\lambda-a s\\|b \\Longleftrightarrow a(\\lambda+s)\\| b .\n\n\\]\n\nOne easily checks that \\(r \\neq \\pm 1\\) implies that \\(\\lambda+s \\neq 0\\) since \\(s\\) is not real. On the other hand,\n\n\\[\n\\begin{aligned}\nW \\text { on } C F & \\Longleftrightarrow c(r-1) \\lambda+b r\\|-b r-(a+c r)=a(r-1) \\Longleftrightarrow c \\lambda+b(1+s)\\| a \n& \\Longleftrightarrow-a \\lambda-b \\lambda-b \\bar{s}\\|a \\Longleftrightarrow b(\\lambda+\\bar{s})\\| a \\Longleftrightarrow b \\| a(\\lambda+s)\n\n\\]\n\nwhere in the last step we use that \\((\\lambda+s)(\\lambda+\\bar{s})=|\\lambda+s|^{2} \\in \\mathbb{R}_{>0}\\). We conclude that \\(A D \\cap B E=\\) \\(C F \\cap B E\\), and the desired result follows."}
{"id": "imo-shortlist-2013-g6", "question": "G6. Let the excircle of the triangle \\(A B C\\) lying opposite to \\(A\\) touch its side \\(B C\\) at the point \\(A_{1}\\). Define the points \\(B_{1}\\) and \\(C_{1}\\) analogously. Suppose that the circumcentre of the triangle \\(A_{1} B_{1} C_{1}\\) lies on the circumcircle of the triangle \\(A B C\\). Prove that the triangle \\(A B C\\) is right-angled.\n(Russia)", "category": "Geometry", "source": "IMO Shortlist", "year": 2013, "solution": "Denote the circumcircles of the triangles \\(A B C\\) and \\(A_{1} B_{1} C_{1}\\) by \\(\\Omega\\) and \\(\\Gamma\\), respectively. Denote the midpoint of the arc \\(C B\\) of \\(\\Omega\\) containing \\(A\\) by \\(A_{0}\\), and define \\(B_{0}\\) as well as \\(C_{0}\\) analogously. By our hypothesis the centre \\(Q\\) of \\(\\Gamma\\) lies on \\(\\Omega\\).\nLemma. One has \\(A_{0} B_{1}=A_{0} C_{1}\\). Moreover, the points \\(A, A_{0}, B_{1}\\), and \\(C_{1}\\) are concyclic. Finally, the points \\(A\\) and \\(A_{0}\\) lie on the same side of \\(B_{1} C_{1}\\). Similar statements hold for \\(B\\) and \\(C\\).\nProof. Let us consider the case \\(A=A_{0}\\) first. Then the triangle \\(A B C\\) is isosceles at \\(A\\), which implies \\(A B_{1}=A C_{1}\\) while the remaining assertions of the Lemma are obvious. So let us suppose \\(A \\neq A_{0}\\) from now on.\n\nBy the definition of \\(A_{0}\\), we have \\(A_{0} B=A_{0} C\\). It is also well known and easy to show that \\(B C_{1}=\\) \\(C B_{1}\\). Next, we have \\(\\angle C_{1} B A_{0}=\\angle A B A_{0}=\\angle A C A_{0}=\\angle B_{1} C A_{0}\\). Hence the triangles \\(A_{0} B C_{1}\\) and \\(A_{0} C B_{1}\\) are congruent. This implies \\(A_{0} C_{1}=A_{0} B_{1}\\), establishing the first part of the Lemma. It also follows that \\(\\angle A_{0} C_{1} A=\\angle A_{0} B_{1} A\\), as these are exterior angles at the corresponding vertices \\(C_{1}\\) and \\(B_{1}\\) of the congruent triangles \\(A_{0} B C_{1}\\) and \\(A_{0} C B_{1}\\). For that reason the points \\(A, A_{0}, B_{1}\\), and \\(C_{1}\\) are indeed the vertices of some cyclic quadrilateral two opposite sides of which are \\(A A_{0}\\) and \\(B_{1} C_{1}\\).\n\nNow we turn to the solution. Evidently the points \\(A_{1}, B_{1}\\), and \\(C_{1}\\) lie interior to some semicircle arc of \\(\\Gamma\\), so the triangle \\(A_{1} B_{1} C_{1}\\) is obtuse-angled. Without loss of generality, we will assume that its angle at \\(B_{1}\\) is obtuse. Thus \\(Q\\) and \\(B_{1}\\) lie on different sides of \\(A_{1} C_{1}\\); obviously, the same holds for the points \\(B\\) and \\(B_{1}\\). So, the points \\(Q\\) and \\(B\\) are on the same side of \\(A_{1} C_{1}\\).\n\nNotice that the perpendicular bisector of \\(A_{1} C_{1}\\) intersects \\(\\Omega\\) at two points lying on different sides of \\(A_{1} C_{1}\\). By the first statement from the Lemma, both points \\(B_{0}\\) and \\(Q\\) are among these points of intersection; since they share the same side of \\(A_{1} C_{1}\\), they coincide (see Figure 1).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-49}\n\nFigure 1\n\nNow, by the first part of the Lemma again, the lines \\(Q A_{0}\\) and \\(Q C_{0}\\) are the perpendicular bisectors of \\(B_{1} C_{1}\\) and \\(A_{1} B_{1}\\), respectively. Thus\n\n\\[\n\\angle C_{1} B_{0} A_{1}=\\angle C_{1} B_{0} B_{1}+\\angle B_{1} B_{0} A_{1}=2 \\angle A_{0} B_{0} B_{1}+2 \\angle B_{1} B_{0} C_{0}=2 \\angle A_{0} B_{0} C_{0}=180^{\\circ}-\\angle A B C,\n\\]\n\nrecalling that \\(A_{0}\\) and \\(C_{0}\\) are the midpoints of the arcs \\(C B\\) and \\(B A\\), respectively.\nOn the other hand, by the second part of the Lemma we have\n\n\\[\n\\angle C_{1} B_{0} A_{1}=\\angle C_{1} B A_{1}=\\angle A B C .\n\\]\n\nFrom the last two equalities, we get \\(\\angle A B C=90^{\\circ}\\), whereby the problem is solved.\nSolution 2. Let \\(Q\\) again denote the centre of the circumcircle of the triangle \\(A_{1} B_{1} C_{1}\\), that lies on the circumcircle \\(\\Omega\\) of the triangle \\(A B C\\). We first consider the case where \\(Q\\) coincides with one of the vertices of \\(A B C\\), say \\(Q=B\\). Then \\(B C_{1}=B A_{1}\\) and consequently the triangle \\(A B C\\) is isosceles at \\(B\\). Moreover we have \\(B C_{1}=B_{1} C\\) in any triangle, and hence \\(B B_{1}=B C_{1}=B_{1} C\\); similarly, \\(B B_{1}=B_{1} A\\). It follows that \\(B_{1}\\) is the centre of \\(\\Omega\\) and that the triangle \\(A B C\\) has a right angle at \\(B\\).\n\nSo from now on we may suppose \\(Q \\notin\\{A, B, C\\}\\). We start with the following well known fact. Lemma. Let \\(X Y Z\\) and \\(X^{\\prime} Y^{\\prime} Z^{\\prime}\\) be two triangles with \\(X Y=X^{\\prime} Y^{\\prime}\\) and \\(Y Z=Y^{\\prime} Z^{\\prime}\\).\n(i) If \\(X Z \\neq X^{\\prime} Z^{\\prime}\\) and \\(\\angle Y Z X=\\angle Y^{\\prime} Z^{\\prime} X^{\\prime}\\), then \\(\\angle Z X Y+\\angle Z^{\\prime} X^{\\prime} Y^{\\prime}=180^{\\circ}\\).\n(ii) If \\(\\angle Y Z X+\\angle X^{\\prime} Z^{\\prime} Y^{\\prime}=180^{\\circ}\\), then \\(\\angle Z X Y=\\angle Y^{\\prime} X^{\\prime} Z^{\\prime}\\).\n\nProof. For both parts, we may move the triangle \\(X Y Z\\) through the plane until \\(Y=Y^{\\prime}\\) and \\(Z=Z^{\\prime}\\). Possibly after reflecting one of the two triangles about \\(Y Z\\), we may also suppose that \\(X\\) and \\(X^{\\prime}\\) lie on the same side of \\(Y Z\\) if we are in case \\((i)\\) and on different sides if we are in case \\((i i)\\). In both cases, the points \\(X, Z\\), and \\(X^{\\prime}\\) are collinear due to the angle condition (see Fig. 2). Moreover we have \\(X \\neq X^{\\prime}\\), because in case ( \\(i\\) ) we assumed \\(X Z \\neq X^{\\prime} Z^{\\prime}\\) and in case ( \\(i i\\) ) these points even lie on different sides of \\(Y Z\\). Thus the triangle \\(X X^{\\prime} Y\\) is isosceles at \\(Y\\). The claim now follows by considering the equal angles at its base.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-50(1)}\n\nFigure 2(i)\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-50}\n\nFigure 2(ii)\n\nRelabeling the vertices of the triangle \\(A B C\\) if necessary we may suppose that \\(Q\\) lies in the interior of the arc \\(A B\\) of \\(\\Omega\\) not containing \\(C\\). We will sometimes use tacitly that the six triangles \\(Q B A_{1}, Q A_{1} C, Q C B_{1}, Q B_{1} A, Q C_{1} A\\), and \\(Q B C_{1}\\) have the same orientation.\n\nAs \\(Q\\) cannot be the circumcentre of the triangle \\(A B C\\), it is impossible that \\(Q A=Q B=Q C\\) and thus we may also suppose that \\(Q C \\neq Q B\\). Now the above Lemma (i) is applicable to the triangles \\(Q B_{1} C\\) and \\(Q C_{1} B\\), since \\(Q B_{1}=Q C_{1}\\) and \\(B_{1} C=C_{1} B\\), while \\(\\angle B_{1} C Q=\\angle C_{1} B Q\\) holds as both angles appear over the same side of the chord \\(Q A\\) in \\(\\Omega\\) (see Fig. 3). So we get\n\n\\[\n\\angle C Q B_{1}+\\angle B Q C_{1}=180^{\\circ} .\n\\]\n\nWe claim that \\(Q C=Q A\\). To see this, let us assume for the sake of a contradiction that \\(Q C \\neq Q A\\). Then arguing similarly as before but now with the triangles \\(Q A_{1} C\\) and \\(Q C_{1} A\\) we get\n\n\\[\n\\angle A_{1} Q C+\\angle C_{1} Q A=180^{\\circ} .\n\\]\n\nAdding this equation to (1), we get \\(\\angle A_{1} Q B_{1}+\\angle B Q A=360^{\\circ}\\), which is absurd as both summands lie in the interval \\(\\left(0^{\\circ}, 180^{\\circ}\\right)\\).\n\nThis proves \\(Q C=Q A\\); so the triangles \\(Q A_{1} C\\) and \\(Q C_{1} A\\) are congruent their sides being equal, which in turn yields\n\n\\[\n\\angle A_{1} Q C=\\angle C_{1} Q A\n\\]\n\nFinally our Lemma ( \\(i i\\) ) is applicable to the triangles \\(Q A_{1} B\\) and \\(Q B_{1} A\\). Indeed we have \\(Q A_{1}=Q B_{1}\\) and \\(A_{1} B=B_{1} A\\) as usual, and the angle condition \\(\\angle A_{1} B Q+\\angle Q A B_{1}=180^{\\circ}\\) holds as \\(A\\) and \\(B\\) lie on different sides of the chord \\(Q C\\) in \\(\\Omega\\). Consequently we have\n\n\\[\n\\angle B Q A_{1}=\\angle B_{1} Q A\n\\]\n\nFrom (1) and (3) we get\n\n\\[\n\\left(\\angle B_{1} Q C+\\angle B_{1} Q A\\right)+\\left(\\angle C_{1} Q B-\\angle B Q A_{1}\\right)=180^{\\circ}\n\\]\n\ni.e. \\(\\angle C Q A+\\angle A_{1} Q C_{1}=180^{\\circ}\\). In light of (2) this may be rewritten as \\(2 \\angle C Q A=180^{\\circ}\\) and as \\(Q\\) lies on \\(\\Omega\\) this implies that the triangle \\(A B C\\) has a right angle at \\(B\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-51}\n\nFigure 3\n\nComment 1. One may also check that \\(Q\\) is in the interior of \\(\\Omega\\) if and only if the triangle \\(A B C\\) is acute-angled.\n\nComment 2. The original proposal asked to prove the converse statement as well: if the triangle \\(A B C\\) is right-angled, then the point \\(Q\\) lies on its circumcircle. The Problem Selection Committee thinks that the above simplified version is more suitable for the competition."}
{"id": "imo-shortlist-2013-n1", "question": "N1. Let \\(\\mathbb{Z}_{>0}\\) be the set of positive integers. Find all functions \\(f: \\mathbb{Z}_{>0} \\rightarrow \\mathbb{Z}_{>0}\\) such that\n\n\\[\nm^{2}+f(n) \\mid m f(m)+n\n\\]\n\nfor all positive integers \\(m\\) and \\(n\\).\n(Malaysia)\nAnswer. \\(f(n)=n\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2013, "solution": "Setting \\(m=n=2\\) tells us that \\(4+f(2) \\mid 2 f(2)+2\\). Since \\(2 f(2)+2<2(4+f(2))\\), we must have \\(2 f(2)+2=4+f(2)\\), so \\(f(2)=2\\). Plugging in \\(m=2\\) then tells us that \\(4+f(n) \\mid 4+n\\), which implies that \\(f(n) \\leqslant n\\) for all \\(n\\).\n\nSetting \\(m=n\\) gives \\(n^{2}+f(n) \\mid n f(n)+n\\), so \\(n f(n)+n \\geqslant n^{2}+f(n)\\) which we rewrite as \\((n-1)(f(n)-n) \\geqslant 0\\). Therefore \\(f(n) \\geqslant n\\) for all \\(n \\geqslant 2\\). This is trivially true for \\(n=1\\) also.\n\nIt follows that \\(f(n)=n\\) for all \\(n\\). This function obviously satisfies the desired property.\nSolution 2. Setting \\(m=f(n)\\) we get \\(f(n)(f(n)+1) \\mid f(n) f(f(n))+n\\). This implies that \\(f(n) \\mid n\\) for all \\(n\\).\n\nNow let \\(m\\) be any positive integer, and let \\(p>2 m^{2}\\) be a prime number. Note that \\(p>m f(m)\\) also. Plugging in \\(n=p-m f(m)\\) we learn that \\(m^{2}+f(n)\\) divides \\(p\\). Since \\(m^{2}+f(n)\\) cannot equal 1, it must equal \\(p\\). Therefore \\(p-m^{2}=f(n) \\mid n=p-m f(m)\\). But \\(p-m f(m)<p<2\\left(p-m^{2}\\right)\\), so we must have \\(p-m f(m)=p-m^{2}\\), i.e., \\(f(m)=m\\).\n\nSolution 3. Plugging \\(m=1\\) we obtain \\(1+f(n) \\leqslant f(1)+n\\), so \\(f(n) \\leqslant n+c\\) for the constant \\(c=\\) \\(f(1)-1\\). Assume that \\(f(n) \\neq n\\) for some fixed \\(n\\). When \\(m\\) is large enough (e.g. \\(m \\geqslant \\max (n, c+1)\\) ) we have\n\n\\[\nm f(m)+n \\leqslant m(m+c)+n \\leqslant 2 m^{2}<2\\left(m^{2}+f(n)\\right),\n\\]\n\nso we must have \\(m f(m)+n=m^{2}+f(n)\\). This implies that\n\n\\[\n0 \\neq f(n)-n=m(f(m)-m)\n\\]\n\nwhich is impossible for \\(m>|f(n)-n|\\). It follows that \\(f\\) is the identity function."}
{"id": "imo-shortlist-2013-n2", "question": "N2. Prove that for any pair of positive integers \\(k\\) and \\(n\\) there exist \\(k\\) positive integers \\(m_{1}, m_{2}, \\ldots, m_{k}\\) such that\n\n\\[\n1+\\frac{2^{k}-1}{n}=\\left(1+\\frac{1}{m_{1}}\\right)\\left(1+\\frac{1}{m_{2}}\\right) \\cdots\\left(1+\\frac{1}{m_{k}}\\right)\n\\]\n\n(Japan)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2013, "solution": "We proceed by induction on \\(k\\). For \\(k=1\\) the statement is trivial. Assuming we have proved it for \\(k=j-1\\), we now prove it for \\(k=j\\).\n\nCase 1. \\(n=2 t-1\\) for some positive integer \\(t\\).\nObserve that\n\n\\[\n1+\\frac{2^{j}-1}{2 t-1}=\\frac{2\\left(t+2^{j-1}-1\\right)}{2 t} \\cdot \\frac{2 t}{2 t-1}=\\left(1+\\frac{2^{j-1}-1}{t}\\right)\\left(1+\\frac{1}{2 t-1}\\right)\n\\]\n\nBy the induction hypothesis we can find \\(m_{1}, \\ldots, m_{j-1}\\) such that\n\n\\[\n1+\\frac{2^{j-1}-1}{t}=\\left(1+\\frac{1}{m_{1}}\\right)\\left(1+\\frac{1}{m_{2}}\\right) \\cdots\\left(1+\\frac{1}{m_{j-1}}\\right)\n\\]\n\nso setting \\(m_{j}=2 t-1\\) gives the desired expression.\nCase 2. \\(n=2 t\\) for some positive integer \\(t\\).\nNow we have\n\n\\[\n1+\\frac{2^{j}-1}{2 t}=\\frac{2 t+2^{j}-1}{2 t+2^{j}-2} \\cdot \\frac{2 t+2^{j}-2}{2 t}=\\left(1+\\frac{1}{2 t+2^{j}-2}\\right)\\left(1+\\frac{2^{j-1}-1}{t}\\right)\n\\]\n\nnoting that \\(2 t+2^{j}-2>0\\). Again, we use that\n\n\\[\n1+\\frac{2^{j-1}-1}{t}=\\left(1+\\frac{1}{m_{1}}\\right)\\left(1+\\frac{1}{m_{2}}\\right) \\cdots\\left(1+\\frac{1}{m_{j-1}}\\right)\n\\]\n\nSetting \\(m_{j}=2 t+2^{j}-2\\) then gives the desired expression.\nSolution 2. Consider the base 2 expansions of the residues of \\(n-1\\) and \\(-n\\) modulo \\(2^{k}\\) :\n\n\\[\n\\begin{aligned}\nn-1 & \\equiv 2^{a_{1}}+2^{a_{2}}+\\cdots+2^{a_{r}}\\left(\\bmod 2^{k}\\right) \n-n & \\equiv 2^{b_{1}}+2^{b_{2}}+\\cdots+2^{b_{s}}\\left(\\bmod 2^{k}\\right)\n \\quad \\begin{aligned}\n& \\text { where } 0 \\leqslant a_{1}<a_{2}<\\ldots<a_{r} \\leqslant k-1 \n& \\text { where } 0 \\leqslant b_{1}<b_{2}<\\ldots<b_{s} \\leqslant k-1\n\n\\]\n\nSince \\(-1 \\equiv 2^{0}+2^{1}+\\cdots+2^{k-1}\\left(\\bmod 2^{k}\\right)\\), we have \\(\\left\\{a_{1}, \\ldots, a_{r}\\right\\} \\cup\\left\\{b_{1} \\ldots, b_{s}\\right\\}=\\{0,1, \\ldots, k-1\\}\\) and \\(r+s=k\\). Write\n\n\\[\n\\begin{aligned}\n& S_{p}=2^{a_{p}}+2^{a_{p+1}}+\\cdots+2^{a_{r}} \\quad \\text { for } 1 \\leqslant p \\leqslant r, \n& T_{q}=2^{b_{1}}+2^{b_{2}}+\\cdots+2^{b_{q}} \\quad \\text { for } 1 \\leqslant q \\leqslant s .\n\n\\]\n\nAlso set \\(S_{r+1}=T_{0}=0\\). Notice that \\(S_{1}+T_{s}=2^{k}-1\\) and \\(n+T_{s} \\equiv 0\\left(\\bmod 2^{k}\\right)\\). We have\n\n\\[\n\\begin{aligned}\n1+\\frac{2^{k}-1}{n} & =\\frac{n+S_{1}+T_{s}}{n}=\\frac{n+S_{1}+T_{s}}{n+T_{s}} \\cdot \\frac{n+T_{s}}{n} \n& =\\prod_{p=1}^{r} \\frac{n+S_{p}+T_{s}}{n+S_{p+1}+T_{s}} \\cdot \\prod_{q=1}^{s} \\frac{n+T_{q}}{n+T_{q-1}} \n& =\\prod_{p=1}^{r}\\left(1+\\frac{2^{a_{p}}}{n+S_{p+1}+T_{s}}\\right) \\cdot \\prod_{q=1}^{s}\\left(1+\\frac{2^{b_{q}}}{n+T_{q-1}}\\right)\n\n\\]\n\nso if we define\n\n\\[\nm_{p}=\\frac{n+S_{p+1}+T_{s}}{2^{a_{p}}} \\quad \\text { for } 1 \\leqslant p \\leqslant r \\quad \\text { and } \\quad m_{r+q}=\\frac{n+T_{q-1}}{2^{b_{q}}} \\quad \\text { for } 1 \\leqslant q \\leqslant s\n\\]\n\nthe desired equality holds. It remains to check that every \\(m_{i}\\) is an integer. For \\(1 \\leqslant p \\leqslant r\\) we have\n\n\\[\nn+S_{p+1}+T_{s} \\equiv n+T_{s} \\equiv 0 \\quad\\left(\\bmod 2^{a_{p}}\\right)\n\\]\n\nand for \\(1 \\leqslant q \\leqslant r\\) we have\n\n\\[\nn+T_{q-1} \\equiv n+T_{s} \\equiv 0 \\quad\\left(\\bmod 2^{b_{q}}\\right)\n\\]\n\nThe desired result follows."}
{"id": "imo-shortlist-2013-n3", "question": "N3. Prove that there exist infinitely many positive integers \\(n\\) such that the largest prime divisor of \\(n^{4}+n^{2}+1\\) is equal to the largest prime divisor of \\((n+1)^{4}+(n+1)^{2}+1\\).\n(Belgium)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2013, "solution": "Let \\(p_{n}\\) be the largest prime divisor of \\(n^{4}+n^{2}+1\\) and let \\(q_{n}\\) be the largest prime divisor of \\(n^{2}+n+1\\). Then \\(p_{n}=q_{n}{ }^{2}\\), and from\n\n\\[\nn^{4}+n^{2}+1=\\left(n^{2}+1\\right)^{2}-n^{2}=\\left(n^{2}-n+1\\right)\\left(n^{2}+n+1\\right)=\\left((n-1)^{2}+(n-1)+1\\right)\\left(n^{2}+n+1\\right)\n\\]\n\nit follows that \\(p_{n}=\\max \\left\\{q_{n}, q_{n-1}\\right\\}\\) for \\(n \\geqslant 2\\). Keeping in mind that \\(n^{2}-n+1\\) is odd, we have\n\n\\[\n\\operatorname{gcd}\\left(n^{2}+n+1, n^{2}-n+1\\right)=\\operatorname{gcd}\\left(2 n, n^{2}-n+1\\right)=\\operatorname{gcd}\\left(n, n^{2}-n+1\\right)=1\n\\]\n\nTherefore \\(q_{n} \\neq q_{n-1}\\).\nTo prove the result, it suffices to show that the set\n\n\\[\nS=\\left\\{n \\in \\mathbb{Z}_{\\geqslant 2} \\mid q_{n}>q_{n-1} \\text { and } q_{n}>q_{n+1}\\right\\}\n\\]\n\nis infinite, since for each \\(n \\in S\\) one has\n\n\\[\np_{n}=\\max \\left\\{q_{n}, q_{n-1}\\right\\}=q_{n}=\\max \\left\\{q_{n}, q_{n+1}\\right\\}=p_{n+1}\n\\]\n\nSuppose on the contrary that \\(S\\) is finite. Since \\(q_{2}=7<13=q_{3}\\) and \\(q_{3}=13>7=q_{4}\\), the set \\(S\\) is non-empty. Since it is finite, we can consider its largest element, say \\(m\\).\n\nNote that it is impossible that \\(q_{m}>q_{m+1}>q_{m+2}>\\ldots\\) because all these numbers are positive integers, so there exists a \\(k \\geqslant m\\) such that \\(q_{k}<q_{k+1}\\) (recall that \\(q_{k} \\neq q_{k+1}\\) ). Next observe that it is impossible to have \\(q_{k}<q_{k+1}<q_{k+2}<\\ldots\\), because \\(q_{(k+1)^{2}}=p_{k+1}=\\max \\left\\{q_{k}, q_{k+1}\\right\\}=q_{k+1}\\), so let us take the smallest \\(\\ell \\geqslant k+1\\) such that \\(q_{\\ell}>q_{\\ell+1}\\). By the minimality of \\(\\ell\\) we have \\(q_{\\ell-1}<q_{\\ell}\\), so \\(\\ell \\in S\\). Since \\(\\ell \\geqslant k+1>k \\geqslant m\\), this contradicts the maximality of \\(m\\), and hence \\(S\\) is indeed infinite.\n\nComment. Once the factorization of \\(n^{4}+n^{2}+1\\) is found and the set \\(S\\) is introduced, the problem is mainly about ruling out the case that\n\n\\[\nq_{k}<q_{k+1}<q_{k+2}<\\ldots\n\\]\n\nmight hold for some \\(k \\in \\mathbb{Z}_{>0}\\). In the above solution, this is done by observing \\(q_{(k+1)^{2}}=\\max \\left(q_{k}, q_{k+1}\\right)\\). Alternatively one may notice that (1) implies that \\(q_{j+2}-q_{j} \\geqslant 6\\) for \\(j \\geqslant k+1\\), since every prime greater than 3 is congruent to -1 or 1 modulo 6 . Then there is some integer \\(C \\geqslant 0\\) such that \\(q_{n} \\geqslant 3 n-C\\) for all \\(n \\geqslant k\\).\n\nNow let the integer \\(t\\) be sufficiently large (e.g. \\(t=\\max \\{k+1, C+3\\}\\) ) and set \\(p=q_{t-1} \\geqslant 2 t\\). Then \\(p \\mid(t-1)^{2}+(t-1)+1\\) implies that \\(p \\mid(p-t)^{2}+(p-t)+1\\), so \\(p\\) and \\(q_{p-t}\\) are prime divisors of \\((p-t)^{2}+(p-t)+1\\). But \\(p-t>t-1 \\geqslant k\\), so \\(q_{p-t}>q_{t-1}=p\\) and \\(p \\cdot q_{p-t}>p^{2}>(p-t)^{2}+(p-t)+1\\), a contradiction."}
{"id": "imo-shortlist-2013-n4", "question": "N4. Determine whether there exists an infinite sequence of nonzero digits \\(a_{1}, a_{2}, a_{3}, \\ldots\\) and a positive integer \\(N\\) such that for every integer \\(k>N\\), the number \\(\\overline{a_{k} a_{k-1} \\ldots a_{1}}\\) is a perfect square.\n(Iran)\nAnswer. No.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2013, "solution": "Assume that \\(a_{1}, a_{2}, a_{3}, \\ldots\\) is such a sequence. For each positive integer \\(k\\), let \\(y_{k}=\\) \\(\\overline{a_{k} a_{k-1} \\ldots a_{1}}\\). By the assumption, for each \\(k>N\\) there exists a positive integer \\(x_{k}\\) such that \\(y_{k}=x_{k}^{2}\\).\nI. For every \\(n\\), let \\(5^{\\gamma_{n}}\\) be the greatest power of 5 dividing \\(x_{n}\\). Let us show first that \\(2 \\gamma_{n} \\geqslant n\\) for every positive integer \\(n>N\\).\n\nAssume, to the contrary, that there exists a positive integer \\(n>N\\) such that \\(2 \\gamma_{n}<n\\), which yields\n\n\\[\ny_{n+1}=\\overline{a_{n+1} a_{n} \\ldots a_{1}}=10^{n} a_{n+1}+\\overline{a_{n} a_{n-1} \\ldots a_{1}}=10^{n} a_{n+1}+y_{n}=5^{2 \\gamma_{n}}\\left(2^{n} 5^{n-2 \\gamma_{n}} a_{n+1}+\\frac{y_{n}}{5^{2 \\gamma_{n}}}\\right)\n\\]\n\nSince \\(5 \\nmid y_{n} / 5^{2 \\gamma_{n}}\\), we obtain \\(\\gamma_{n+1}=\\gamma_{n}<n<n+1\\). By the same arguments we obtain that \\(\\gamma_{n}=\\gamma_{n+1}=\\gamma_{n+2}=\\ldots\\). Denote this common value by \\(\\gamma\\).\n\nNow, for each \\(k \\geqslant n\\) we have\n\n\\[\n\\left(x_{k+1}-x_{k}\\right)\\left(x_{k+1}+x_{k}\\right)=x_{k+1}^{2}-x_{k}^{2}=y_{k+1}-y_{k}=a_{k+1} \\cdot 10^{k}\n\\]\n\nOne of the numbers \\(x_{k+1}-x_{k}\\) and \\(x_{k+1}+x_{k}\\) is not divisible by \\(5^{\\gamma+1}\\) since otherwise one would have \\(5^{\\gamma+1} \\mid\\left(\\left(x_{k+1}-x_{k}\\right)+\\left(x_{k+1}+x_{k}\\right)\\right)=2 x_{k+1}\\). On the other hand, we have \\(5^{k} \\mid\\left(x_{k+1}-x_{k}\\right)\\left(x_{k+1}+x_{k}\\right)\\), so \\(5^{k-\\gamma}\\) divides one of these two factors. Thus we get\n\n\\[\n5^{k-\\gamma} \\leqslant \\max \\left\\{x_{k+1}-x_{k}, x_{k+1}+x_{k}\\right\\}<2 x_{k+1}=2 \\sqrt{y_{k+1}}<2 \\cdot 10^{(k+1) / 2}\n\\]\n\nwhich implies \\(5^{2 k}<4 \\cdot 5^{2 \\gamma} \\cdot 10^{k+1}\\), or \\((5 / 2)^{k}<40 \\cdot 5^{2 \\gamma}\\). The last inequality is clearly false for sufficiently large values of \\(k\\). This contradiction shows that \\(2 \\gamma_{n} \\geqslant n\\) for all \\(n>N\\).\nII. Consider now any integer \\(k>\\max \\{N / 2,2\\}\\). Since \\(2 \\gamma_{2 k+1} \\geqslant 2 k+1\\) and \\(2 \\gamma_{2 k+2} \\geqslant 2 k+2\\), we have \\(\\gamma_{2 k+1} \\geqslant k+1\\) and \\(\\gamma_{2 k+2} \\geqslant k+1\\). So, from \\(y_{2 k+2}=a_{2 k+2} \\cdot 10^{2 k+1}+y_{2 k+1}\\) we obtain \\(5^{2 k+2} \\mid y_{2 k+2}-y_{2 k+1}=a_{2 k+2} \\cdot 10^{2 k+1}\\) and thus \\(5 \\mid a_{2 k+2}\\), which implies \\(a_{2 k+2}=5\\). Therefore,\n\n\\[\n\\left(x_{2 k+2}-x_{2 k+1}\\right)\\left(x_{2 k+2}+x_{2 k+1}\\right)=x_{2 k+2}^{2}-x_{2 k+1}^{2}=y_{2 k+2}-y_{2 k+1}=5 \\cdot 10^{2 k+1}=2^{2 k+1} \\cdot 5^{2 k+2}\n\\]\n\nSetting \\(A_{k}=x_{2 k+2} / 5^{k+1}\\) and \\(B_{k}=x_{2 k+1} / 5^{k+1}\\), which are integers, we obtain\n\n\\[\n\\left(A_{k}-B_{k}\\right)\\left(A_{k}+B_{k}\\right)=2^{2 k+1}\n\\]\n\nBoth \\(A_{k}\\) and \\(B_{k}\\) are odd, since otherwise \\(y_{2 k+2}\\) or \\(y_{2 k+1}\\) would be a multiple of 10 which is false by \\(a_{1} \\neq 0\\); so one of the numbers \\(A_{k}-B_{k}\\) and \\(A_{k}+B_{k}\\) is not divisible by 4 . Therefore (1) yields \\(A_{k}-B_{k}=2\\) and \\(A_{k}+B_{k}=2^{2 k}\\), hence \\(A_{k}=2^{2 k-1}+1\\) and thus\n\n\\[\nx_{2 k+2}=5^{k+1} A_{k}=10^{k+1} \\cdot 2^{k-2}+5^{k+1}>10^{k+1}\n\\]\n\nsince \\(k \\geqslant 2\\). This implies that \\(y_{2 k+2}>10^{2 k+2}\\) which contradicts the fact that \\(y_{2 k+2}\\) contains \\(2 k+2\\) digits. The desired result follows.\n\nSolution 2. Again, we assume that a sequence \\(a_{1}, a_{2}, a_{3}, \\ldots\\) satisfies the problem conditions, introduce the numbers \\(x_{k}\\) and \\(y_{k}\\) as in the previous solution, and notice that\n\n\\[\ny_{k+1}-y_{k}=\\left(x_{k+1}-x_{k}\\right)\\left(x_{k+1}+x_{k}\\right)=10^{k} a_{k+1}\n\\]\n\nfor all \\(k>N\\). Consider any such \\(k\\). Since \\(a_{1} \\neq 0\\), the numbers \\(x_{k}\\) and \\(x_{k+1}\\) are not multiples of 10 , and therefore the numbers \\(p_{k}=x_{k+1}-x_{k}\\) and \\(q_{k}=x_{k+1}+x_{k}\\) cannot be simultaneously multiples of 20 , and hence one of them is not divisible either by 4 or by 5 . In view of (2), this means that the other one is divisible by either \\(5^{k}\\) or by \\(2^{k-1}\\). Notice also that \\(p_{k}\\) and \\(q_{k}\\) have the same parity, so both are even.\n\nOn the other hand, we have \\(x_{k+1}^{2}=x_{k}^{2}+10^{k} a_{k+1} \\geqslant x_{k}^{2}+10^{k}>2 x_{k}^{2}\\), so \\(x_{k+1} / x_{k}>\\sqrt{2}\\), which implies that\n\n\\[\n1<\\frac{q_{k}}{p_{k}}=1+\\frac{2}{x_{k+1} / x_{k}-1}<1+\\frac{2}{\\sqrt{2}-1}<6\n\\]\n\nThus, if one of the numbers \\(p_{k}\\) and \\(q_{k}\\) is divisible by \\(5^{k}\\), then we have\n\n\\[\n10^{k+1}>10^{k} a_{k+1}=p_{k} q_{k} \\geqslant \\frac{\\left(5^{k}\\right)^{2}}{6}\n\\]\n\nand hence \\((5 / 2)^{k}<60\\) which is false for sufficiently large \\(k\\). So, assuming that \\(k\\) is large, we get that \\(2^{k-1}\\) divides one of the numbers \\(p_{k}\\) and \\(q_{k}\\). Hence\n\\(\\left\\{p_{k}, q_{k}\\right\\}=\\left\\{2^{k-1} \\cdot 5^{r_{k}} b_{k}, 2 \\cdot 5^{k-r_{k}} c_{k}\\right\\} \\quad\\) with nonnegative integers \\(b_{k}, c_{k}, r_{k}\\) such that \\(b_{k} c_{k}=a_{k+1}\\).\nMoreover, from (3) we get\n\n\\[\n6>\\frac{2^{k-1} \\cdot 5^{r_{k}} b_{k}}{2 \\cdot 5^{k-r_{k}} c_{k}} \\geqslant \\frac{1}{36} \\cdot\\left(\\frac{2}{5}\\right)^{k} \\cdot 5^{2 r_{k}} \\quad \\text { and } \\quad 6>\\frac{2 \\cdot 5^{k-r_{k}} c_{k}}{2^{k-1} \\cdot 5^{r_{k}} b_{k}} \\geqslant \\frac{4}{9} \\cdot\\left(\\frac{5}{2}\\right)^{k} \\cdot 5^{-2 r_{k}}\n\\]\n\nso\n\n\\[\n\\alpha k+c_{1}<r_{k}<\\alpha k+c_{2} \\quad \\text { for } \\alpha=\\frac{1}{2} \\log _{5}\\left(\\frac{5}{2}\\right)<1 \\text { and some constants } c_{2}>c_{1}\n\\]\n\nConsequently, for \\(C=c_{2}-c_{1}+1-\\alpha>0\\) we have\n\n\\[\n(k+1)-r_{k+1} \\leqslant k-r_{k}+C\n\\]\n\nNext, we will use the following easy lemma.\nLemma. Let \\(s\\) be a positive integer. Then \\(5^{s+2^{s}} \\equiv 5^{s}\\left(\\bmod 10^{s}\\right)\\).\nProof. Euler's theorem gives \\(5^{2^{s}} \\equiv 1\\left(\\bmod 2^{s}\\right)\\), so \\(5^{s+2^{s}}-5^{s}=5^{s}\\left(5^{2^{s}}-1\\right)\\) is divisible by \\(2^{s}\\) and \\(5^{s}\\).\nNow, for every large \\(k\\) we have\n\n\\[\nx_{k+1}=\\frac{p_{k}+q_{k}}{2}=5^{r_{k}} \\cdot 2^{k-2} b_{k}+5^{k-r_{k}} c_{k} \\equiv 5^{k-r_{k}} c_{k} \\quad\\left(\\bmod 10^{r_{k}}\\right)\n\\]\n\nsince \\(r_{k} \\leqslant k-2\\) by (4); hence \\(y_{k+1} \\equiv 5^{2\\left(k-r_{k}\\right)} c_{k}^{2}\\left(\\bmod 10^{r_{k}}\\right)\\). Let us consider some large integer \\(s\\), and choose the minimal \\(k\\) such that \\(2\\left(k-r_{k}\\right) \\geqslant s+2^{s}\\); it exists by (4). Set \\(d=2\\left(k-r_{k}\\right)-\\left(s+2^{s}\\right)\\). By (4) we have \\(2^{s}<2\\left(k-r_{k}\\right)<\\left(\\frac{2}{\\alpha}-2\\right) r_{k}-\\frac{2 c_{1}}{\\alpha}\\); if \\(s\\) is large this implies \\(r_{k}>s\\), so (6) also holds modulo \\(10^{s}\\). Then (6) and the lemma give\n\n\\[\ny_{k+1} \\equiv 5^{2\\left(k-r_{k}\\right)} c_{k}^{2}=5^{s+2^{s}} \\cdot 5^{d} c_{k}^{2} \\equiv 5^{s} \\cdot 5^{d} c_{k}^{2} \\quad\\left(\\bmod 10^{s}\\right)\n\\]\n\nBy (5) and the minimality of \\(k\\) we have \\(d \\leqslant 2 C\\), so \\(5^{d} c_{k}^{2} \\leqslant 5^{2 C} \\cdot 81=D\\). Using \\(5^{4}<10^{3}\\) we obtain\n\n\\[\n5^{s} \\cdot 5^{d} c_{k}^{2}<10^{3 s / 4} D<10^{s-1}\n\\]\n\nfor sufficiently large \\(s\\). This, together with (7), shows that the \\(s\\) th digit from the right in \\(y_{k+1}\\), which is \\(a_{s}\\), is zero. This contradicts the problem condition."}
{"id": "imo-shortlist-2013-n5", "question": "N5. Fix an integer \\(k \\geqslant 2\\). Two players, called Ana and Banana, play the following game of numbers: Initially, some integer \\(n \\geqslant k\\) gets written on the blackboard. Then they take moves in turn, with Ana beginning. A player making a move erases the number \\(m\\) just written on the blackboard and replaces it by some number \\(m^{\\prime}\\) with \\(k \\leqslant m^{\\prime}<m\\) that is coprime to \\(m\\). The first player who cannot move anymore loses.\n\nAn integer \\(n \\geqslant k\\) is called good if Banana has a winning strategy when the initial number is \\(n\\), and bad otherwise.\n\nConsider two integers \\(n, n^{\\prime} \\geqslant k\\) with the property that each prime number \\(p \\leqslant k\\) divides \\(n\\) if and only if it divides \\(n^{\\prime}\\). Prove that either both \\(n\\) and \\(n^{\\prime}\\) are good or both are bad.\n(Italy)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2013, "solution": "Let us first observe that the number appearing on the blackboard decreases after every move; so the game necessarily ends after at most \\(n\\) steps, and consequently there always has to be some player possessing a winning strategy. So if some \\(n \\geqslant k\\) is bad, then Ana has a winning strategy in the game with starting number \\(n\\).\n\nMore precisely, if \\(n \\geqslant k\\) is such that there is a good integer \\(m\\) with \\(n>m \\geqslant k\\) and \\(\\operatorname{gcd}(m, n)=1\\), then \\(n\\) itself is bad, for Ana has the following winning strategy in the game with initial number \\(n\\) : She proceeds by first playing \\(m\\) and then using Banana's strategy for the game with starting number \\(m\\).\n\nOtherwise, if some integer \\(n \\geqslant k\\) has the property that every integer \\(m\\) with \\(n>m \\geqslant k\\) and \\(\\operatorname{gcd}(m, n)=1\\) is bad, then \\(n\\) is good. Indeed, if Ana can make a first move at all in the game with initial number \\(n\\), then she leaves it in a position where the first player has a winning strategy, so that Banana can defeat her.\n\nIn particular, this implies that any two good numbers have a non-trivial common divisor. Also, \\(k\\) itself is good.\n\nFor brevity, we say that \\(n \\longrightarrow x\\) is a move if \\(n\\) and \\(x\\) are two coprime integers with \\(n>x \\geqslant k\\).\nClaim 1. If \\(n\\) is good and \\(n^{\\prime}\\) is a multiple of \\(n\\), then \\(n^{\\prime}\\) is also good.\nProof. If \\(n^{\\prime}\\) were bad, there would have to be some move \\(n^{\\prime} \\longrightarrow x\\), where \\(x\\) is good. As \\(n^{\\prime}\\) is a multiple of \\(n\\) this implies that the two good numbers \\(n\\) and \\(x\\) are coprime, which is absurd.\n\nClaim 2. If \\(r\\) and \\(s\\) denote two positive integers for which \\(r s \\geqslant k\\) is bad, then \\(r^{2} s\\) is also bad.\nProof. Since \\(r s\\) is bad, there is a move \\(r s \\longrightarrow x\\) for some good \\(x\\). Evidently \\(x\\) is coprime to \\(r^{2} s\\) as well, and hence the move \\(r^{2} s \\longrightarrow x\\) shows that \\(r^{2} s\\) is indeed bad.\n\nClaim 3. If \\(p>k\\) is prime and \\(n \\geqslant k\\) is bad, then \\(n p\\) is also bad.\nProof. Otherwise we choose a counterexample with \\(n\\) being as small as possible. In particular, \\(n p\\) is good. Since \\(n\\) is bad, there is a move \\(n \\longrightarrow x\\) for some good \\(x\\). Now \\(n p \\longrightarrow x\\) cannot be a valid move, which tells us that \\(x\\) has to be divisible by \\(p\\). So we can write \\(x=p^{r} y\\), where \\(r\\) and \\(y\\) denote some positive integers, the latter of which is not divisible by \\(p\\).\n\nNote that \\(y=1\\) is impossible, for then we would have \\(x=p^{r}\\) and the move \\(x \\longrightarrow k\\) would establish that \\(x\\) is bad. In view of this, there is a least power \\(y^{\\alpha}\\) of \\(y\\) that is at least as large as \\(k\\). Since the numbers \\(n p\\) and \\(y^{\\alpha}\\) are coprime and the former is good, the latter has to be bad. Moreover, the minimality of \\(\\alpha\\) implies \\(y^{\\alpha}<k y<p y=\\frac{x}{p^{r-1}}<\\frac{n}{p^{r-1}}\\). So \\(p^{r-1} \\cdot y^{\\alpha}<n\\) and consequently all the numbers \\(y^{\\alpha}, p y^{\\alpha}, \\ldots, p^{r} \\cdot y^{\\alpha}=p\\left(p^{r-1} \\cdot y^{\\alpha}\\right)\\) are bad due to the minimal choice of \\(n\\). But now by Claim 1 the divisor \\(x\\) of \\(p^{r} \\cdot y^{\\alpha}\\) cannot be good, whereby we have reached a contradiction that proves Claim 3.\n\nWe now deduce the statement of the problem from these three claims. To this end, we call two integers \\(a, b \\geqslant k\\) similar if they are divisible by the same prime numbers not exceeding \\(k\\). We are to prove that if \\(a\\) and \\(b\\) are similar, then either both of them are good or both are bad. As in this case the product \\(a b\\) is similar to both \\(a\\) and \\(b\\), it suffices to show the following: if \\(c \\geqslant k\\) is similar to some of its multiples \\(d\\), then either both \\(c\\) and \\(d\\) are good or both are bad.\n\nAssuming that this is not true in general, we choose a counterexample ( \\(c_{0}, d_{0}\\) ) with \\(d_{0}\\) being as small as possible. By Claim \\(1, c_{0}\\) is bad whilst \\(d_{0}\\) is good. Plainly \\(d_{0}\\) is strictly greater than \\(c_{0}\\) and hence the quotient \\(\\frac{d_{0}}{c_{0}}\\) has some prime factor \\(p\\). Clearly \\(p\\) divides \\(d_{0}\\). If \\(p \\leqslant k\\), then \\(p\\) divides \\(c_{0}\\) as well due to the similarity, and hence \\(d_{0}\\) is actually divisible by \\(p^{2}\\). So \\(\\frac{d_{0}}{p}\\) is good by the contrapositive of Claim 2. Since \\(c_{0} \\left\\lvert\\, \\frac{d_{0}}{p}\\right.\\), the pair ( \\(c_{0}, \\frac{d_{0}}{p}\\) ) contradicts the supposed minimality of \\(d_{0}\\). This proves \\(p>k\\), but now we get the same contradiction using Claim 3 instead of Claim 2. Thereby the problem is solved.\n\nSolution 2. We use the same analysis of the game of numbers as in the first five paragraphs of the first solution. Let us call a prime number \\(p\\) small in case \\(p \\leqslant k\\) and big otherwise. We again call two integers similar if their sets of small prime factors coincide.\n\nClaim 4. For each integer \\(b \\geqslant k\\) having some small prime factor, there exists an integer \\(x\\) similar to it with \\(b \\geqslant x \\geqslant k\\) and having no big prime factors.\nProof. Unless \\(b\\) has a big prime factor we may simply choose \\(x=b\\). Now let \\(p\\) and \\(q\\) denote a small and a big prime factor of \\(b\\), respectively. Let \\(a\\) be the product of all small prime factors of \\(b\\). Further define \\(n\\) to be the least non-negative integer for which the number \\(x=p^{n} a\\) is at least as large as \\(k\\). It suffices to show that \\(b>x\\). This is clear in case \\(n=0\\), so let us assume \\(n>0\\) from now on. Then we have \\(x<p k\\) due to the minimality of \\(n, p \\leqslant a\\) because \\(p\\) divides \\(a\\) by construction, and \\(k<q\\). Therefore \\(x<a q\\) and, as the right hand side is a product of distinct prime factors of \\(b\\), this implies indeed \\(x<b\\).\n\nLet us now assume that there is a pair ( \\(a, b\\) ) of similar numbers such that \\(a\\) is bad and \\(b\\) is good. Take such a pair with \\(\\max (a, b)\\) being as small as possible. Since \\(a\\) is bad, there exists a move \\(a \\longrightarrow r\\) for some good \\(r\\). Since the numbers \\(k\\) and \\(r\\) are both good, they have a common prime factor, which necessarily has to be small. Thus Claim 4 is applicable to \\(r\\), which yields an integer \\(r^{\\prime}\\) similar to \\(r\\) containing small prime factors only and satisfying \\(r \\geqslant r^{\\prime} \\geqslant k\\). Since \\(\\max \\left(r, r^{\\prime}\\right)=r<a \\leqslant \\max (a, b)\\) the number \\(r^{\\prime}\\) is also good. Now let \\(p\\) denote a common prime factor of the good numbers \\(r^{\\prime}\\) and \\(b\\). By our construction of \\(r^{\\prime}\\), this prime is small and due to the similarities it consequently divides \\(a\\) and \\(r\\), contrary to \\(a \\longrightarrow r\\) being a move. Thereby the problem is solved.\n\nComment 1. Having reached Claim 4 of Solution 2, there are various other ways to proceed. For instance, one may directly obtain the following fact, which seems to be interesting in its own right:\n\nClaim 5. Any two good numbers have a common small prime factor.\nProof. Otherwise there exists a pair \\(\\left(b, b^{\\prime}\\right)\\) of good numbers with \\(b^{\\prime} \\geqslant b \\geqslant k\\) all of whose common prime factors are big. Choose such a pair with \\(b^{\\prime}\\) being as small as possible. Since \\(b\\) and \\(k\\) are both good, there has to be a common prime factor \\(p\\) of \\(b\\) and \\(k\\). Evidently \\(p\\) is small and thus it cannot divide \\(b^{\\prime}\\), which in turn tells us \\(b^{\\prime}>b\\). Applying Claim 4 to \\(b\\) we get an integer \\(x\\) with \\(b \\geqslant x \\geqslant k\\) that is similar to \\(b\\) and has no big prime divisors at all. By our assumption, \\(b^{\\prime}\\) and \\(x\\) are coprime, and as \\(b^{\\prime}\\) is good this implies that \\(x\\) is bad. Consequently there has to be some move \\(x \\longrightarrow b^{*}\\) such that \\(b^{*}\\) is good. But now all the small prime factors of \\(b\\) also appear in \\(x\\) and thus they cannot divide \\(b^{*}\\). Therefore the pair \\(\\left(b^{*}, b\\right)\\) contradicts the supposed minimality of \\(b^{\\prime}\\).\n\nFrom that point, it is easy to complete the solution: assume that there are two similar integers \\(a\\) and \\(b\\) such that \\(a\\) is bad and \\(b\\) is good. Since \\(a\\) is bad, there is a move \\(a \\longrightarrow b^{\\prime}\\) for some good \\(b^{\\prime}\\). By Claim 5, there is a small prime \\(p\\) dividing \\(b\\) and \\(b^{\\prime}\\). Due to the similarity of \\(a\\) and \\(b\\), the prime \\(p\\) has to divide \\(a\\) as well, but this contradicts the fact that \\(a \\longrightarrow b^{\\prime}\\) is a valid move. Thereby the problem is solved.\n\nComment 2. There are infinitely many good numbers, e.g. all multiples of \\(k\\). The increasing sequence \\(b_{0}, b_{1}, \\ldots\\), of all good numbers may be constructed recursively as follows:\n\n\\begin{itemize}\n  \\item Start with \\(b_{0}=k\\).\n  \\item If \\(b_{n}\\) has just been defined for some \\(n \\geqslant 0\\), then \\(b_{n+1}\\) is the smallest number \\(b>b_{n}\\) that is coprime to none of \\(b_{0}, \\ldots, b_{n}\\).\n\n\nThis construction can be used to determine the set of good numbers for any specific \\(k\\) as explained in the next comment. It is already clear that if \\(k=p^{\\alpha}\\) is a prime power, then a number \\(b \\geqslant k\\) is good if and only if it is divisible by \\(p\\).\n\nComment 3. Let \\(P>1\\) denote the product of all small prime numbers. Then any two integers \\(a, b \\geqslant k\\) that are congruent modulo \\(P\\) are similar. Thus the infinite word \\(W_{k}=\\left(X_{k}, X_{k+1}, \\ldots\\right)\\) defined by\n\n\\[\nX_{i}= \\begin{cases}A & \\text { if } i \\text { is bad } \\\\ B & \\text { if } i \\text { is good }\n\\]\n\nfor all \\(i \\geqslant k\\) is periodic and the length of its period divides \\(P\\). As the prime power example shows, the true period can sometimes be much smaller than \\(P\\). On the other hand, there are cases where the period is rather large; e.g., if \\(k=15\\), the sequence of good numbers begins with \\(15,18,20,24,30,36,40,42,45\\) and the period of \\(W_{15}\\) is 30 .\n\nComment 4. The original proposal contained two questions about the game of numbers, namely (a) to show that if two numbers have the same prime factors then either both are good or both are bad, and (b) to show that the word \\(W_{k}\\) introduced in the previous comment is indeed periodic. The Problem Selection Committee thinks that the above version of the problem is somewhat easier, even though it demands to prove a stronger result."}
{"id": "imo-shortlist-2013-n6", "question": "N6. Determine all functions \\(f: \\mathbb{Q} \\longrightarrow \\mathbb{Z}\\) satisfying\n\n\\[\nf\\left(\\frac{f(x)+a}{b}\\right)=f\\left(\\frac{x+a}{b}\\right)\n\\]\n\nfor all \\(x \\in \\mathbb{Q}, a \\in \\mathbb{Z}\\), and \\(b \\in \\mathbb{Z}_{>0}\\). (Here, \\(\\mathbb{Z}_{>0}\\) denotes the set of positive integers.)\n(Israel)\nAnswer. There are three kinds of such functions, which are: all constant functions, the floor function, and the ceiling function.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2013, "solution": "I. We start by verifying that these functions do indeed satisfy (1). This is clear for all constant functions. Now consider any triple \\((x, a, b) \\in \\mathbb{Q} \\times \\mathbb{Z} \\times \\mathbb{Z}_{>0}\\) and set\n\n\\[\nq=\\left\\lfloor\\frac{x+a}{b}\\right\\rfloor\n\\]\n\nThis means that \\(q\\) is an integer and \\(b q \\leqslant x+a<b(q+1)\\). It follows that \\(b q \\leqslant\\lfloor x\\rfloor+a<b(q+1)\\) holds as well, and thus we have\n\n\\[\n\\left\\lfloor\\frac{\\lfloor x\\rfloor+a}{b}\\right\\rfloor=\\left\\lfloor\\frac{x+a}{b}\\right\\rfloor\n\\]\n\nmeaning that the floor function does indeed satisfy (1). One can check similarly that the ceiling function has the same property.\nII. Let us now suppose conversely that the function \\(f: \\mathbb{Q} \\longrightarrow \\mathbb{Z}\\) satisfies (1) for all \\((x, a, b) \\in\\) \\(\\mathbb{Q} \\times \\mathbb{Z} \\times \\mathbb{Z}_{>0}\\). According to the behaviour of the restriction of \\(f\\) to the integers we distinguish two cases.\n\nCase 1: There is some \\(m \\in \\mathbb{Z}\\) such that \\(f(m) \\neq m\\).\nWrite \\(f(m)=C\\) and let \\(\\eta \\in\\{-1,+1\\}\\) and \\(b\\) denote the sign and absolute value of \\(f(m)-m\\), respectively. Given any integer \\(r\\), we may plug the triple ( \\(m, r b-C, b\\) ) into (1), thus getting \\(f(r)=f(r-\\eta)\\). Starting with \\(m\\) and using induction in both directions, we deduce from this that the equation \\(f(r)=C\\) holds for all integers \\(r\\). Now any rational number \\(y\\) can be written in the form \\(y=\\frac{p}{q}\\) with \\((p, q) \\in \\mathbb{Z} \\times \\mathbb{Z}_{>0}\\), and substituting \\((C-p, p-C, q)\\) into \\((1)\\) we get \\(f(y)=f(0)=C\\). Thus \\(f\\) is the constant function whose value is always \\(C\\).\n\nCase 2: One has \\(f(m)=m\\) for all integers \\(m\\).\nNote that now the special case \\(b=1\\) of (1) takes a particularly simple form, namely\n\n\\[\nf(x)+a=f(x+a) \\quad \\text { for all }(x, a) \\in \\mathbb{Q} \\times \\mathbb{Z}\n\\]\n\nDefining \\(f\\left(\\frac{1}{2}\\right)=\\omega\\) we proceed in three steps.\nStep A. We show that \\(\\omega \\in\\{0,1\\}\\).\nIf \\(\\omega \\leqslant 0\\), we may plug \\(\\left(\\frac{1}{2},-\\omega, 1-2 \\omega\\right)\\) into (1), obtaining \\(0=f(0)=f\\left(\\frac{1}{2}\\right)=\\omega\\). In the contrary case \\(\\omega \\geqslant 1\\) we argue similarly using the triple \\(\\left(\\frac{1}{2}, \\omega-1,2 \\omega-1\\right)\\).\n\nStep B. We show that \\(f(x)=\\omega\\) for all rational numbers \\(x\\) with \\(0<x<1\\).\nAssume that this fails and pick some rational number \\(\\frac{a}{b} \\in(0,1)\\) with minimal \\(b\\) such that \\(f\\left(\\frac{a}{b}\\right) \\neq \\omega\\). Obviously, \\(\\operatorname{gcd}(a, b)=1\\) and \\(b \\geqslant 2\\). If \\(b\\) is even, then \\(a\\) has to be odd and we can substitute \\(\\left(\\frac{1}{2}, \\frac{a-1}{2}, \\frac{b}{2}\\right)\\) into (1), which yields\n\n\\[\nf\\left(\\frac{\\omega+(a-1) / 2}{b / 2}\\right)=f\\left(\\frac{a}{b}\\right) \\neq \\omega\n\\]\n\nRecall that \\(0 \\leqslant(a-1) / 2<b / 2\\). Thus, in both cases \\(\\omega=0\\) and \\(\\omega=1\\), the left-hand part of (3) equals \\(\\omega\\) either by the minimality of \\(b\\), or by \\(f(\\omega)=\\omega\\). A contradiction.\n\nThus \\(b\\) has to be odd, so \\(b=2 k+1\\) for some \\(k \\geqslant 1\\). Applying (1) to \\(\\left(\\frac{1}{2}, k, b\\right)\\) we get\n\n\\[\nf\\left(\\frac{\\omega+k}{b}\\right)=f\\left(\\frac{1}{2}\\right)=\\omega\n\\]\n\nSince \\(a\\) and \\(b\\) are coprime, there exist integers \\(r \\in\\{1,2, \\ldots, b\\}\\) and \\(m\\) such that \\(r a-m b=k+\\omega\\). Note that we actually have \\(1 \\leqslant r<b\\), since the right hand side is not a multiple of \\(b\\). If \\(m\\) is negative, then we have \\(r a-m b>b \\geqslant k+\\omega\\), which is absurd. Similarly, \\(m \\geqslant r\\) leads to \\(r a-m b<b r-b r=0\\), which is likewise impossible; so we must have \\(0 \\leqslant m \\leqslant r-1\\).\n\nWe finally substitute \\(\\left(\\frac{k+\\omega}{b}, m, r\\right)\\) into (1) and use (4) to learn\n\n\\[\nf\\left(\\frac{\\omega+m}{r}\\right)=f\\left(\\frac{a}{b}\\right) \\neq \\omega\n\\]\n\nBut as above one may see that the left hand side has to equal \\(\\omega\\) due to the minimality of \\(b\\). This contradiction concludes our step B.\n\nStep \\(C\\). Now notice that if \\(\\omega=0\\), then \\(f(x)=\\lfloor x\\rfloor\\) holds for all rational \\(x\\) with \\(0 \\leqslant x<1\\) and hence by (2) this even holds for all rational numbers \\(x\\). Similarly, if \\(\\omega=1\\), then \\(f(x)=\\lceil x\\rceil\\) holds for all \\(x \\in \\mathbb{Q}\\). Thereby the problem is solved.\n\nComment 1. An alternative treatment of Steps B and C from the second case, due to the proposer, proceeds as follows. Let square brackets indicate the floor function in case \\(\\omega=0\\) and the ceiling function if \\(\\omega=1\\). We are to prove that \\(f(x)=[x]\\) holds for all \\(x \\in \\mathbb{Q}\\), and because of Step A and (2) we already know this in case \\(2 x \\in \\mathbb{Z}\\). Applying (1) to ( \\(2 x, 0,2\\) ) we get\n\n\\[\nf(x)=f\\left(\\frac{f(2 x)}{2}\\right)\n\\]\n\nand by the previous observation this yields\n\n\\[\nf(x)=\\left[\\frac{f(2 x)}{2}\\right] \\quad \\text { for all } x \\in \\mathbb{Q}\n\\]\n\nAn easy induction now shows\n\n\\[\nf(x)=\\left[\\frac{f\\left(2^{n} x\\right)}{2^{n}}\\right] \\quad \\text { for all }(x, n) \\in \\mathbb{Q} \\times \\mathbb{Z}_{>0}\n\\]\n\nNow suppose first that \\(x\\) is not an integer but can be written in the form \\(\\frac{p}{q}\\) with \\(p \\in \\mathbb{Z}\\) and \\(q \\in \\mathbb{Z}_{>0}\\) both being odd. Let \\(d\\) denote the multiplicative order of 2 modulo \\(q\\) and let \\(m\\) be any large integer. Plugging \\(n=d m\\) into (6) and using (2) we get\n\n\\[\nf(x)=\\left[\\frac{f\\left(2^{d m} x\\right)}{2^{d m}}\\right]=\\left[\\frac{f(x)+\\left(2^{d m}-1\\right) x}{2^{d m}}\\right]=\\left[x+\\frac{f(x)-x}{2^{d m}}\\right]\n\\]\n\nSince \\(x\\) is not an integer, the square bracket function is continuous at \\(x\\); hence as \\(m\\) tends to infinity the above fomula gives \\(f(x)=[x]\\). To complete the argument we just need to observe that if some \\(y \\in \\mathbb{Q}\\) satisfies \\(f(y)=[y]\\), then (5) yields \\(f\\left(\\frac{y}{2}\\right)=f\\left(\\frac{[y]}{2}\\right)=\\left[\\frac{[y]}{2}\\right]=\\left[\\frac{y}{2}\\right]\\).\n\nSolution 2. Here we just give another argument for the second case of the above solution. Again we use equation (2). It follows that the set \\(S\\) of all zeros of \\(f\\) contains for each \\(x \\in \\mathbb{Q}\\) exactly one term from the infinite sequence \\(\\ldots, x-2, x-1, x, x+1, x+2, \\ldots\\).\n\nNext we claim that\n\n\\[\n\\text { if }(p, q) \\in \\mathbb{Z} \\times \\mathbb{Z}_{>0} \\text { and } \\frac{p}{q} \\in S, \\text { then } \\frac{p}{q+1} \\in S \\text { holds as well. }\n\\]\n\nTo see this we just plug \\(\\left(\\frac{p}{q}, p, q+1\\right)\\) into (1), thus getting \\(f\\left(\\frac{p}{q+1}\\right)=f\\left(\\frac{p}{q}\\right)=0\\).\nFrom this we get that\n\n\\[\n\\text { if } x, y \\in \\mathbb{Q}, x>y>0, \\text { and } x \\in S, \\text { then } y \\in S .\n\\]\n\nIndeed, if we write \\(x=\\frac{p}{q}\\) and \\(y=\\frac{r}{s}\\) with \\(p, q, r, s \\in \\mathbb{Z}_{>0}\\), then \\(p s>q r\\) and (7) tells us\n\n\\[\n0=f\\left(\\frac{p}{q}\\right)=f\\left(\\frac{p r}{q r}\\right)=f\\left(\\frac{p r}{q r+1}\\right)=\\ldots=f\\left(\\frac{p r}{p s}\\right)=f\\left(\\frac{r}{s}\\right)\n\\]\n\nEssentially the same argument also establishes that\n\n\\[\n\\text { if } x, y \\in \\mathbb{Q}, x<y<0, \\text { and } x \\in S, \\text { then } y \\in S .\n\\]\n\nFrom (8) and (9) we get \\(0 \\in S \\subseteq(-1,+1)\\) and hence the real number \\(\\alpha=\\sup (S)\\) exists and satisfies \\(0 \\leqslant \\alpha \\leqslant 1\\).\n\nLet us assume that we actually had \\(0<\\alpha<1\\). Note that \\(f(x)=0\\) if \\(x \\in(0, \\alpha) \\cap \\mathbb{Q}\\) by (8), and \\(f(x)=1\\) if \\(x \\in(\\alpha, 1) \\cap \\mathbb{Q}\\) by (9) and (2). Let \\(K\\) denote the unique positive integer satisfying \\(K \\alpha<1 \\leqslant(K+1) \\alpha\\). The first of these two inequalities entails \\(\\alpha<\\frac{1+\\alpha}{K+1}\\), and thus there is a rational number \\(x \\in\\left(\\alpha, \\frac{1+\\alpha}{K+1}\\right)\\). Setting \\(y=(K+1) x-1\\) and substituting ( \\(y, 1, K+1\\) ) into (1) we learn\n\n\\[\nf\\left(\\frac{f(y)+1}{K+1}\\right)=f\\left(\\frac{y+1}{K+1}\\right)=f(x)\n\\]\n\nSince \\(\\alpha<x<1\\) and \\(0<y<\\alpha\\), this simplifies to\n\n\\[\nf\\left(\\frac{1}{K+1}\\right)=1\n\\]\n\nBut, as \\(0<\\frac{1}{K+1} \\leqslant \\alpha\\), this is only possible if \\(\\alpha=\\frac{1}{K+1}\\) and \\(f(\\alpha)=1\\). From this, however, we get the contradiction\n\n\\[\n0=f\\left(\\frac{1}{(K+1)^{2}}\\right)=f\\left(\\frac{\\alpha+0}{K+1}\\right)=f\\left(\\frac{f(\\alpha)+0}{K+1}\\right)=f(\\alpha)=1 .\n\\]\n\nThus our assumption \\(0<\\alpha<1\\) has turned out to be wrong and it follows that \\(\\alpha \\in\\{0,1\\}\\). If \\(\\alpha=0\\), then we have \\(S \\subseteq(-1,0]\\), whence \\(S=(-1,0] \\cap \\mathbb{Q}\\), which in turn yields \\(f(x)=\\lceil x\\rceil\\) for all \\(x \\in \\mathbb{Q}\\) due to (2). Similarly, \\(\\alpha=1\\) entails \\(S=[0,1) \\cap \\mathbb{Q}\\) and \\(f(x)=\\lfloor x\\rfloor\\) for all \\(x \\in \\mathbb{Q}\\). Thereby the solution is complete.\n\nComment 2. It seems that all solutions to this problems involve some case distinction separating the constant solutions from the unbounded ones, though the \"descriptions\" of the cases may be different depending on the work that has been done at the beginning of the solution. For instance, these two cases can also be \" \\(f\\) is periodic on the integers\" and \" \\(f\\) is not periodic on the integers\". The case leading to the unbounded solutions appears to be the harder one.\n\nIn most approaches, the cases leading to the two functions \\(x \\longmapsto\\lfloor x\\rfloor\\) and \\(x \\longmapsto\\lceil x\\rceil\\) can easily be treated parallelly, but sometimes it may be useful to know that there is some symmetry in the problem interchanging these two functions. Namely, if a function \\(f: \\mathbb{Q} \\longrightarrow \\mathbb{Z}\\) satisfies (1), then so does the function \\(g: \\mathbb{Q} \\longrightarrow \\mathbb{Z}\\) defined by \\(g(x)=-f(-x)\\) for all \\(x \\in \\mathbb{Q}\\). For that reason, we could have restricted our attention to the case \\(\\omega=0\\) in the first solution and, once \\(\\alpha \\in\\{0,1\\}\\) had been obtained, to the case \\(\\alpha=0\\) in the second solution."}
{"id": "imo-shortlist-2013-n7", "question": "N7. Let \\(\\nu\\) be an irrational positive number, and let \\(m\\) be a positive integer. A pair \\((a, b)\\) of positive integers is called good if\n\n\\[\na\\lceil b \\nu\\rceil-b\\lfloor a \\nu\\rfloor=m\n\\]\n\nA good pair \\((a, b)\\) is called excellent if neither of the pairs \\((a-b, b)\\) and \\((a, b-a)\\) is good. (As usual, by \\(\\lfloor x\\rfloor\\) and \\(\\lceil x\\rceil\\) we denote the integer numbers such that \\(x-1<\\lfloor x\\rfloor \\leqslant x\\) and \\(x \\leqslant\\lceil x\\rceil<x+1\\).)\n\nProve that the number of excellent pairs is equal to the sum of the positive divisors of \\(m\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2013, "solution": "For positive integers \\(a\\) and \\(b\\), let us denote\n\n\\[\nf(a, b)=a\\lceil b \\nu\\rceil-b\\lfloor a \\nu\\rfloor\n\\]\n\nWe will deal with various values of \\(m\\); thus it is convenient to say that a pair ( \\(a, b\\) ) is \\(m\\)-good or \\(m\\)-excellent if the corresponding conditions are satisfied.\n\nTo start, let us investigate how the values \\(f(a+b, b)\\) and \\(f(a, b+a)\\) are related to \\(f(a, b)\\). If \\(\\{a \\nu\\}+\\{b \\nu\\}<1\\), then we have \\(\\lfloor(a+b) \\nu\\rfloor=\\lfloor a \\nu\\rfloor+\\lfloor b \\nu\\rfloor\\) and \\(\\lceil(a+b) \\nu\\rceil=\\lceil a \\nu\\rceil+\\lceil b \\nu\\rceil-1\\), so\n\n\\[\nf(a+b, b)=(a+b)\\lceil b \\nu\\rceil-b(\\lfloor a \\nu\\rfloor+\\lfloor b \\nu\\rfloor)=f(a, b)+b(\\lceil b \\nu\\rceil-\\lfloor b \\nu\\rfloor)=f(a, b)+b\n\\]\n\nand\n\n\\[\nf(a, b+a)=a(\\lceil b \\nu\\rceil+\\lceil a \\nu\\rceil-1)-(b+a)\\lfloor a \\nu\\rfloor=f(a, b)+a(\\lceil a \\nu\\rceil-1-\\lfloor a \\nu\\rfloor)=f(a, b)\n\\]\n\nSimilarly, if \\(\\{a \\nu\\}+\\{b \\nu\\} \\geqslant 1\\) then one obtains\n\n\\[\nf(a+b, b)=f(a, b) \\quad \\text { and } \\quad f(a, b+a)=f(a, b)+a\n\\]\n\nSo, in both cases one of the numbers \\(f(a+b, a)\\) and \\(f(a, b+a)\\) is equal to \\(f(a, b)\\) while the other is greater than \\(f(a, b)\\) by one of \\(a\\) and \\(b\\). Thus, exactly one of the pairs \\((a+b, b)\\) and \\((a, b+a)\\) is excellent (for an appropriate value of \\(m\\) ).\n\nNow let us say that the pairs \\((a+b, b)\\) and \\((a, b+a)\\) are the children of the pair \\((a, b)\\), while this pair is their parent. Next, if a pair \\((c, d)\\) can be obtained from \\((a, b)\\) by several passings from a parent to a child, we will say that \\((c, d)\\) is a descendant of \\((a, b)\\), while \\((a, b)\\) is an ancestor of \\((c, d)\\) (a pair is neither an ancestor nor a descendant of itself). Thus each pair ( \\(a, b\\) ) has two children, it has a unique parent if \\(a \\neq b\\), and no parents otherwise. Therefore, each pair of distinct positive integers has a unique ancestor of the form ( \\(a, a\\) ); our aim is now to find how many \\(m\\)-excellent descendants each such pair has.\n\nNotice now that if a pair \\((a, b)\\) is \\(m\\)-excellent then \\(\\min \\{a, b\\} \\leqslant m\\). Indeed, if \\(a=b\\) then \\(f(a, a)=a=m\\), so the statement is valid. Otherwise, the pair \\((a, b)\\) is a child of some pair \\(\\left(a^{\\prime}, b^{\\prime}\\right)\\). If \\(b=b^{\\prime}\\) and \\(a=a^{\\prime}+b^{\\prime}\\), then we should have \\(m=f(a, b)=f\\left(a^{\\prime}, b^{\\prime}\\right)+b^{\\prime}\\), so \\(b=b^{\\prime}=m-f\\left(a^{\\prime}, b^{\\prime}\\right)<m\\). Similarly, if \\(a=a^{\\prime}\\) and \\(b=b^{\\prime}+a^{\\prime}\\) then \\(a<m\\).\n\nLet us consider the set \\(S_{m}\\) of all pairs \\((a, b)\\) such that \\(f(a, b) \\leqslant m\\) and \\(\\min \\{a, b\\} \\leqslant m\\). Then all the ancestors of the elements in \\(S_{m}\\) are again in \\(S_{m}\\), and each element in \\(S_{m}\\) either is of the form ( \\(a, a\\) ) with \\(a \\leqslant m\\), or has a unique ancestor of this form. From the arguments above we see that all \\(m\\)-excellent pairs lie in \\(S_{m}\\).\n\nWe claim now that the set \\(S_{m}\\) is finite. Indeed, assume, for instance, that it contains infinitely many pairs \\((c, d)\\) with \\(d>2 m\\). Such a pair is necessarily a child of \\((c, d-c)\\), and thus a descendant of some pair ( \\(c, d^{\\prime}\\) ) with \\(m<d^{\\prime} \\leqslant 2 m\\). Therefore, one of the pairs ( \\(a, b\\) ) \\(\\in S_{m}\\) with \\(m<b \\leqslant 2 m\\)\nhas infinitely many descendants in \\(S_{m}\\), and all these descendants have the form ( \\(a, b+k a\\) ) with \\(k\\) a positive integer. Since \\(f(a, b+k a)\\) does not decrease as \\(k\\) grows, it becomes constant for \\(k \\geqslant k_{0}\\), where \\(k_{0}\\) is some positive integer. This means that \\(\\{a \\nu\\}+\\{(b+k a) \\nu\\}<1\\) for all \\(k \\geqslant k_{0}\\). But this yields \\(1>\\{(b+k a) \\nu\\}=\\left\\{\\left(b+k_{0} a\\right) \\nu\\right\\}+\\left(k-k_{0}\\right)\\{a \\nu\\}\\) for all \\(k>k_{0}\\), which is absurd.\n\nSimilarly, one can prove that \\(S_{m}\\) contains finitely many pairs ( \\(c, d\\) ) with \\(c>2 m\\), thus finitely many elements at all.\n\nWe are now prepared for proving the following crucial lemma.\nLemma. Consider any pair \\((a, b)\\) with \\(f(a, b) \\neq m\\). Then the number \\(g(a, b)\\) of its \\(m\\)-excellent descendants is equal to the number \\(h(a, b)\\) of ways to represent the number \\(t=m-f(a, b)\\) as \\(t=k a+\\ell b\\) with \\(k\\) and \\(\\ell\\) being some nonnegative integers.\nProof. We proceed by induction on the number \\(N\\) of descendants of ( \\(a, b\\) ) in \\(S_{m}\\). If \\(N=0\\) then clearly \\(g(a, b)=0\\). Assume that \\(h(a, b)>0\\); without loss of generality, we have \\(a \\leqslant b\\). Then, clearly, \\(m-f(a, b) \\geqslant a\\), so \\(f(a, b+a) \\leqslant f(a, b)+a \\leqslant m\\) and \\(a \\leqslant m\\), hence \\((a, b+a) \\in S_{m}\\) which is impossible. Thus in the base case we have \\(g(a, b)=h(a, b)=0\\), as desired.\n\nNow let \\(N>0\\). Assume that \\(f(a+b, b)=f(a, b)+b\\) and \\(f(a, b+a)=f(a, b)\\) (the other case is similar). If \\(f(a, b)+b \\neq m\\), then by the induction hypothesis we have\n\n\\[\ng(a, b)=g(a+b, b)+g(a, b+a)=h(a+b, b)+h(a, b+a)\n\\]\n\nNotice that both pairs \\((a+b, b)\\) and \\((a, b+a)\\) are descendants of \\((a, b)\\) and thus each of them has strictly less descendants in \\(S_{m}\\) than ( \\(a, b\\) ) does.\n\nNext, each one of the \\(h(a+b, b)\\) representations of \\(m-f(a+b, b)=m-b-f(a, b)\\) as the sum \\(k^{\\prime}(a+b)+\\ell^{\\prime} b\\) provides the representation \\(m-f(a, b)=k a+\\ell b\\) with \\(k=k^{\\prime}<k^{\\prime}+\\ell^{\\prime}+1=\\ell\\). Similarly, each one of the \\(h(a, b+a)\\) representations of \\(m-f(a, b+a)=m-f(a, b)\\) as the sum \\(k^{\\prime} a+\\ell^{\\prime}(b+a)\\) provides the representation \\(m-f(a, b)=k a+\\ell b\\) with \\(k=k^{\\prime}+\\ell^{\\prime} \\geqslant \\ell^{\\prime}=\\ell\\). This correspondence is obviously bijective, so\n\n\\[\nh(a, b)=h(a+b, b)+h(a, b+a)=g(a, b),\n\\]\n\nas required.\nFinally, if \\(f(a, b)+b=m\\) then \\((a+b, b)\\) is \\(m\\)-excellent, so \\(g(a, b)=1+g(a, b+a)=1+h(a, b+a)\\) by the induction hypothesis. On the other hand, the number \\(m-f(a, b)=b\\) has a representation \\(0 \\cdot a+1 \\cdot b\\) and sometimes one more representation as \\(k a+0 \\cdot b\\); this last representation exists simultaneously with the representation \\(m-f(a, b+a)=k a+0 \\cdot(b+a)\\), so \\(h(a, b)=1+h(a, b+a)\\) as well. Thus in this case the step is also proved.\n\nNow it is easy to finish the solution. There exists a unique \\(m\\)-excellent pair of the form \\((a, a)\\), and each other \\(m\\)-excellent pair \\((a, b)\\) has a unique ancestor of the form \\((x, x)\\) with \\(x<m\\). By the lemma, for every \\(x<m\\) the number of its \\(m\\)-excellent descendants is \\(h(x, x)\\), which is the number of ways to represent \\(m-f(x, x)=m-x\\) as \\(k x+\\ell x\\) (with nonnegative integer \\(k\\) and \\(\\ell\\) ). This number is 0 if \\(x \\nmid m\\), and \\(m / x\\) otherwise. So the total number of excellent pairs is\n\n\\[\n1+\\sum_{x \\mid m, x<m} \\frac{m}{x}=1+\\sum_{d \\mid m, d>1} d=\\sum_{d \\mid m} d,\n\\]\n\nas required.\n\nComment. Let us present a sketch of an outline of a different solution. The plan is to check that the number of excellent pairs does not depend on the (irrational) number \\(\\nu\\), and to find this number for some appropriate value of \\(\\nu\\). For that, we first introduce some geometrical language. We deal only with the excellent pairs \\((a, b)\\) with \\(a \\neq b\\).\n\nPart I. Given an irrational positive \\(\\nu\\), for every positive integer \\(n\\) we introduce two integral points \\(F_{\\nu}(n)=\\) \\((n,\\lfloor n \\nu\\rfloor)\\) and \\(C_{\\nu}(n)=(n,\\lceil n \\nu\\rceil)\\) on the coordinate plane \\(O x y\\). Then (*) reads as \\(\\left[O F_{\\nu}(a) C_{\\nu}(b)\\right]=m / 2\\); here \\([\\cdot]\\) stands for the signed area. Next, we rewrite in these terms the condition on a pair \\((a, b)\\) to be excellent. Let \\(\\ell_{\\nu}, \\ell_{\\nu}^{+}\\), and \\(\\ell_{\\nu}^{-}\\)be the lines determined by the equations \\(y=\\nu x, y=\\nu x+1\\), and \\(y=\\nu x-1\\), respectively.\n\\(a\\) ). Firstly, we deal with all excellent pairs ( \\(a, b\\) ) with \\(a<b\\). Given some value of \\(a\\), all the points \\(C\\) such that \\(\\left[O F_{\\nu}(a) C\\right]=m / 2\\) lie on some line \\(f_{\\nu}(a)\\); if there exist any good pairs ( \\(a, b\\) ) at all, this line has to contain at least one integral point, which happens exactly when \\(\\operatorname{gcd}(a,\\lfloor a \\nu\\rfloor) \\mid m\\).\n\nLet \\(P_{\\nu}(a)\\) be the point of intersection of \\(\\ell_{\\nu}^{+}\\)and \\(f_{\\nu}(a)\\), and let \\(p_{\\nu}(a)\\) be its abscissa; notice that \\(p_{\\nu}(a)\\) is irrational if it is nonzero. Now, if ( \\(a, b\\) ) is good, then the point \\(C_{\\nu}(b)\\) lies on \\(f_{\\nu}(a)\\), which means that the point of \\(f_{\\nu}(a)\\) with abscissa \\(b\\) lies between \\(\\ell_{\\nu}\\) and \\(\\ell_{\\nu}^{+}\\)and is integral. If in addition the pair \\((a, b-a)\\) is not good, then the point of \\(f_{\\nu}(a)\\) with abscissa \\(b-a\\) lies above \\(\\ell_{\\nu}^{+}\\)(see Fig. 1). Thus, the pair \\((a, b)\\) with \\(b>a\\) is excellent exactly when \\(p_{\\nu}(a)\\) lies between \\(b-a\\) and \\(b\\), and the point of \\(f_{\\nu}(a)\\) with abscissa \\(b\\) is integral (which means that this point is \\(C_{\\nu}(b)\\) ).\n\nNotice now that, if \\(p_{\\nu}(a)>a\\), then the number of excellent pairs of the form ( \\(a, b\\) ) (with \\(b>a\\) ) is \\(\\operatorname{gcd}(a,\\lfloor a \\nu\\rfloor)\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-67}\n\nFigure 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_f5ba16bf9d53675b385ag-67(1)}\n\nFigure 2\n\\(b)\\). Analogously, considering the pairs ( \\(a, b\\) ) with \\(a>b\\), we fix the value of \\(b\\), introduce the line \\(c_{\\nu}(b)\\) containing all the points \\(F\\) with \\(\\left[O F C_{\\nu}(b)\\right]=m / 2\\), assume that this line contains an integral point (which means \\(\\operatorname{gcd}(b,[b \\nu]) \\mid m\\) ), and denote the common point of \\(c_{\\nu}(b)\\) and \\(\\ell_{\\nu}^{-}\\)by \\(Q_{\\nu}(b)\\), its abscissa being \\(q_{\\nu}(b)\\). Similarly to the previous case, we obtain that the pair ( \\(a, b\\) ) is excellent exactly when \\(q_{\\nu}(a)\\) lies between \\(a-b\\) and \\(a\\), and the point of \\(c_{\\nu}(b)\\) with abscissa \\(a\\) is integral (see Fig. 2). Again, if \\(q_{\\nu}(b)>b\\), then the number of excellent pairs of the form ( \\(a, b\\) ) (with \\(a>b\\) ) is \\(\\operatorname{gcd}(b,\\lceil b \\nu\\rceil)\\).\nPart II, sketchy. Having obtained such a description, one may check how the number of excellent pairs changes as \\(\\nu\\) grows. (Having done that, one may find this number for one appropriate value of \\(\\nu\\); for instance, it is relatively easy to make this calculation for \\(\\nu \\in\\left(1,1+\\frac{1}{m}\\right)\\).)\n\nConsider, for the initial value of \\(\\nu\\), some excellent pair \\((a, t)\\) with \\(a>t\\). As \\(\\nu\\) grows, this pair eventually stops being excellent; this happens when the point \\(Q_{\\nu}(t)\\) passes through \\(F_{\\nu}(a)\\). At the same moment, the pair ( \\(a+t, t\\) ) becomes excellent instead.\n\nThis process halts when the point \\(Q_{\\nu}(t)\\) eventually disappears, i.e. when \\(\\nu\\) passes through the ratio of the coordinates of the point \\(T=C_{\\nu}(t)\\). Hence, the point \\(T\\) afterwards is regarded as \\(F_{\\nu}(t)\\). Thus, all the old excellent pairs of the form ( \\(a, t\\) ) with \\(a>t\\) disappear; on the other hand, the same number of excellent pairs with the first element being \\(t\\) just appear.\n\nSimilarly, if some pair \\((t, b)\\) with \\(t<b\\) is initially \\(\\nu\\)-excellent, then at some moment it stops being excellent when \\(P_{\\nu}(t)\\) passes through \\(C_{\\nu}(b)\\); at the same moment, the pair \\((t, b-t)\\) becomes excellent. This process eventually stops when \\(b-t<t\\). At this moment, again the second element of the pair becomes fixed, and the first one starts to increase.\n\nThese ideas can be made precise enough to show that the number of excellent pairs remains unchanged, as required.\n\nWe should warn the reader that the rigorous elaboration of Part II is technically quite involved, mostly by the reason that the set of moments when the collection of excellent pairs changes is infinite. Especially much care should be applied to the limit points of this set, which are exactly the points when the line \\(\\ell_{\\nu}\\) passes through some point of the form \\(C_{\\nu}(b)\\).\n\nThe same ideas may be explained in an algebraic language instead of a geometrical one; the same technicalities remain in this way as well."}
{"id": "imo-shortlist-2017-a1", "question": "A1. Let \\(a_{1}, a_{2}, \\ldots, a_{n}, k\\), and \\(M\\) be positive integers such that\n\n\\[\n\\frac{1}{a_{1}}+\\frac{1}{a_{2}}+\\cdots+\\frac{1}{a_{n}}=k \\quad \\text { and } \\quad a_{1} a_{2} \\ldots a_{n}=M .\n\\]\n\nIf \\(M>1\\), prove that the polynomial\n\n\\[\nP(x)=M(x+1)^{k}-\\left(x+a_{1}\\right)\\left(x+a_{2}\\right) \\cdots\\left(x+a_{n}\\right)\n\\]\n\nhas no positive roots.\n(Trinidad and Tobago)", "category": "Algebra", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-a2", "question": "A2. Let \\(q\\) be a real number. Gugu has a napkin with ten distinct real numbers written on it, and he writes the following three lines of real numbers on the blackboard:\n\n\\begin{itemize}\n  \\item In the first line, Gugu writes down every number of the form \\(a-b\\), where \\(a\\) and \\(b\\) are two (not necessarily distinct) numbers on his napkin.\n  \\item In the second line, Gugu writes down every number of the form \\(q a b\\), where \\(a\\) and \\(b\\) are two (not necessarily distinct) numbers from the first line.\n  \\item In the third line, Gugu writes down every number of the form \\(a^{2}+b^{2}-c^{2}-d^{2}\\), where \\(a, b, c, d\\) are four (not necessarily distinct) numbers from the first line.\n\n\nDetermine all values of \\(q\\) such that, regardless of the numbers on Gugu's napkin, every number in the second line is also a number in the third line.\n(Austria)", "category": "Algebra", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-a3", "question": "A3. Let \\(S\\) be a finite set, and let \\(\\mathcal{A}\\) be the set of all functions from \\(S\\) to \\(S\\). Let \\(f\\) be an element of \\(\\mathcal{A}\\), and let \\(T=f(S)\\) be the image of \\(S\\) under \\(f\\). Suppose that \\(f \\circ g \\circ f \\neq g \\circ f \\circ g\\) for every \\(g\\) in \\(\\mathcal{A}\\) with \\(g \\neq f\\). Show that \\(f(T)=T\\).\n(India)", "category": "Algebra", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-a4", "question": "A4. A sequence of real numbers \\(a_{1}, a_{2}, \\ldots\\) satisfies the relation\n\n\\[\na_{n}=-\\max _{i+j=n}\\left(a_{i}+a_{j}\\right) \\quad \\text { for all } n>2017\n\\]\n\nProve that this sequence is bounded, i.e., there is a constant \\(M\\) such that \\(\\left|a_{n}\\right| \\leqslant M\\) for all positive integers \\(n\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-a5", "question": "A5. An integer \\(n \\geqslant 3\\) is given. We call an \\(n\\)-tuple of real numbers \\(\\left(x_{1}, x_{2}, \\ldots, x_{n}\\right)\\) Shiny if for each permutation \\(y_{1}, y_{2}, \\ldots, y_{n}\\) of these numbers we have\n\n\\[\n\\sum_{i=1}^{n-1} y_{i} y_{i+1}=y_{1} y_{2}+y_{2} y_{3}+y_{3} y_{4}+\\cdots+y_{n-1} y_{n} \\geqslant-1\n\\]\n\nFind the largest constant \\(K=K(n)\\) such that\n\n\\[\n\\sum_{1 \\leqslant i<j \\leqslant n} x_{i} x_{j} \\geqslant K\n\\]\n\nholds for every Shiny \\(n\\)-tuple \\(\\left(x_{1}, x_{2}, \\ldots, x_{n}\\right)\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-a6", "question": "A6. Find all functions \\(f: \\mathbb{R} \\rightarrow \\mathbb{R}\\) such that\n\n\\[\nf(f(x) f(y))+f(x+y)=f(x y)\n\\]\n\nfor all \\(x, y \\in \\mathbb{R}\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-a7", "question": "A7. Let \\(a_{0}, a_{1}, a_{2}, \\ldots\\) be a sequence of integers and \\(b_{0}, b_{1}, b_{2}, \\ldots\\) be a sequence of positive integers such that \\(a_{0}=0, a_{1}=1\\), and\n\n\\[\na_{n+1}=\\left\\{\\begin{array}{ll}\na_{n} b_{n}+a_{n-1}, & \\text { if } b_{n-1}=1 \na_{n} b_{n}-a_{n-1}, & \\text { if } b_{n-1}>1\n \\quad \\text { for } n=1,2, \\ldots\\right.\n\\]\n\nProve that at least one of the two numbers \\(a_{2017}\\) and \\(a_{2018}\\) must be greater than or equal to 2017 .\n(Australia)", "category": "Algebra", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-a8", "question": "A8. Assume that a function \\(f: \\mathbb{R} \\rightarrow \\mathbb{R}\\) satisfies the following condition:\nFor every \\(x, y \\in \\mathbb{R}\\) such that \\((f(x)+y)(f(y)+x)>0\\), we have \\(f(x)+y=f(y)+x\\).\nProve that \\(f(x)+y \\leqslant f(y)+x\\) whenever \\(x>y\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-c1", "question": "C1. A rectangle \\(\\mathcal{R}\\) with odd integer side lengths is divided into small rectangles with integer side lengths. Prove that there is at least one among the small rectangles whose distances from the four sides of \\(\\mathcal{R}\\) are either all odd or all even.\n(Singapore)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-c2", "question": "C2. Let \\(n\\) be a positive integer. Define a chameleon to be any sequence of \\(3 n\\) letters, with exactly \\(n\\) occurrences of each of the letters \\(a, b\\), and \\(c\\). Define a swap to be the transposition of two adjacent letters in a chameleon. Prove that for any chameleon \\(X\\), there exists a chameleon \\(Y\\) such that \\(X\\) cannot be changed to \\(Y\\) using fewer than \\(3 n^{2} / 2\\) swaps.\n(Australia)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-c3", "question": "C3. Sir Alex plays the following game on a row of 9 cells. Initially, all cells are empty. In each move, Sir Alex is allowed to perform exactly one of the following two operations:\n(1) Choose any number of the form \\(2^{j}\\), where \\(j\\) is a non-negative integer, and put it into an empty cell.\n(2) Choose two (not necessarily adjacent) cells with the same number in them; denote that number by \\(2^{j}\\). Replace the number in one of the cells with \\(2^{j+1}\\) and erase the number in the other cell.\n\nAt the end of the game, one cell contains the number \\(2^{n}\\), where \\(n\\) is a given positive integer, while the other cells are empty. Determine the maximum number of moves that Sir Alex could have made, in terms of \\(n\\).\n(Thailand)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-c4", "question": "C4. Let \\(N \\geqslant 2\\) be an integer. \\(N(N+1)\\) soccer players, no two of the same height, stand in a row in some order. Coach Ralph wants to remove \\(N(N-1)\\) people from this row so that in the remaining row of \\(2 N\\) players, no one stands between the two tallest ones, no one stands between the third and the fourth tallest ones, . . . and finally no one stands between the two shortest ones. Show that this is always possible.\n(Russia)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-c5", "question": "C5. A hunter and an invisible rabbit play a game in the Euclidean plane. The hunter's starting point \\(H_{0}\\) coincides with the rabbit's starting point \\(R_{0}\\). In the \\(n^{\\text {th }}\\) round of the game ( \\(n \\geqslant 1\\) ), the following happens.\n(1) First the invisible rabbit moves secretly and unobserved from its current point \\(R_{n-1}\\) to some new point \\(R_{n}\\) with \\(R_{n-1} R_{n}=1\\).\n(2) The hunter has a tracking device (e.g. dog) that returns an approximate position \\(R_{n}^{\\prime}\\) of the rabbit, so that \\(R_{n} R_{n}^{\\prime} \\leqslant 1\\).\n(3) The hunter then visibly moves from point \\(H_{n-1}\\) to a new point \\(H_{n}\\) with \\(H_{n-1} H_{n}=1\\).\n\nIs there a strategy for the hunter that guarantees that after \\(10^{9}\\) such rounds the distance between the hunter and the rabbit is below 100 ?", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-c6", "question": "C6. Let \\(n>1\\) be an integer. An \\(n \\times n \\times n\\) cube is composed of \\(n^{3}\\) unit cubes. Each unit cube is painted with one color. For each \\(n \\times n \\times 1\\) box consisting of \\(n^{2}\\) unit cubes (of any of the three possible orientations), we consider the set of the colors present in that box (each color is listed only once). This way, we get \\(3 n\\) sets of colors, split into three groups according to the orientation. It happens that for every set in any group, the same set appears in both of the other groups. Determine, in terms of \\(n\\), the maximal possible number of colors that are present.\n(Russia)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-c7", "question": "C7. For any finite sets \\(X\\) and \\(Y\\) of positive integers, denote by \\(f_{X}(k)\\) the \\(k^{\\text {th }}\\) smallest positive integer not in \\(X\\), and let\n\n\\[\nX * Y=X \\cup\\left\\{f_{X}(y): y \\in Y\\right\\} .\n\\]\n\nLet \\(A\\) be a set of \\(a>0\\) positive integers, and let \\(B\\) be a set of \\(b>0\\) positive integers. Prove that if \\(A * B=B * A\\), then\n\n\\[\n\\underbrace{A *(A * \\cdots *(A *(A * A)) \\ldots)}_{A \\text { appears } b \\text { times }}=\\underbrace{B *(B * \\cdots *(B *(B * B)) \\ldots)}_{B \\text { appears } a \\text { times }} .\n\\]", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-c8", "question": "C8. Let \\(n\\) be a given positive integer. In the Cartesian plane, each lattice point with nonnegative coordinates initially contains a butterfly, and there are no other butterflies. The neighborhood of a lattice point \\(c\\) consists of all lattice points within the axis-aligned \\((2 n+1) \\times(2 n+1)\\) square centered at \\(c\\), apart from \\(c\\) itself. We call a butterfly lonely, crowded, or comfortable, depending on whether the number of butterflies in its neighborhood \\(N\\) is respectively less than, greater than, or equal to half of the number of lattice points in \\(N\\).\n\nEvery minute, all lonely butterflies fly away simultaneously. This process goes on for as long as there are any lonely butterflies. Assuming that the process eventually stops, determine the number of comfortable butterflies at the final state.\n(Bulgaria)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-g1", "question": "G1. Let \\(A B C D E\\) be a convex pentagon such that \\(A B=B C=C D, \\angle E A B=\\angle B C D\\), and \\(\\angle E D C=\\angle C B A\\). Prove that the perpendicular line from \\(E\\) to \\(B C\\) and the line segments \\(A C\\) and \\(B D\\) are concurrent.\n(Italy)", "category": "Geometry", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-g2", "question": "G2. Let \\(R\\) and \\(S\\) be distinct points on circle \\(\\Omega\\), and let \\(t\\) denote the tangent line to \\(\\Omega\\) at \\(R\\). Point \\(R^{\\prime}\\) is the reflection of \\(R\\) with respect to \\(S\\). A point \\(I\\) is chosen on the smaller arc \\(R S\\) of \\(\\Omega\\) so that the circumcircle \\(\\Gamma\\) of triangle \\(I S R^{\\prime}\\) intersects \\(t\\) at two different points. Denote by \\(A\\) the common point of \\(\\Gamma\\) and \\(t\\) that is closest to \\(R\\). Line \\(A I\\) meets \\(\\Omega\\) again at \\(J\\). Show that \\(J R^{\\prime}\\) is tangent to \\(\\Gamma\\).\n(Luxembourg)", "category": "Geometry", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-g3", "question": "G3. Let \\(O\\) be the circumcenter of an acute scalene triangle \\(A B C\\). Line \\(O A\\) intersects the altitudes of \\(A B C\\) through \\(B\\) and \\(C\\) at \\(P\\) and \\(Q\\), respectively. The altitudes meet at \\(H\\). Prove that the circumcenter of triangle \\(P Q H\\) lies on a median of triangle \\(A B C\\).\n(Ukraine)", "category": "Geometry", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-g4", "question": "G4. In triangle \\(A B C\\), let \\(\\omega\\) be the excircle opposite \\(A\\). Let \\(D, E\\), and \\(F\\) be the points where \\(\\omega\\) is tangent to lines \\(B C, C A\\), and \\(A B\\), respectively. The circle \\(A E F\\) intersects line \\(B C\\) at \\(P\\) and \\(Q\\). Let \\(M\\) be the midpoint of \\(A D\\). Prove that the circle \\(M P Q\\) is tangent to \\(\\omega\\).\n(Denmark)", "category": "Geometry", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-g5", "question": "G5. Let \\(A B C C_{1} B_{1} A_{1}\\) be a convex hexagon such that \\(A B=B C\\), and suppose that the line segments \\(A A_{1}, B B_{1}\\), and \\(C C_{1}\\) have the same perpendicular bisector. Let the diagonals \\(A C_{1}\\) and \\(A_{1} C\\) meet at \\(D\\), and denote by \\(\\omega\\) the circle \\(A B C\\). Let \\(\\omega\\) intersect the circle \\(A_{1} B C_{1}\\) again at \\(E \\neq B\\). Prove that the lines \\(B B_{1}\\) and \\(D E\\) intersect on \\(\\omega\\).\n(Ukraine)", "category": "Geometry", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-g6", "question": "G6. Let \\(n \\geqslant 3\\) be an integer. Two regular \\(n\\)-gons \\(\\mathcal{A}\\) and \\(\\mathcal{B}\\) are given in the plane. Prove that the vertices of \\(\\mathcal{A}\\) that lie inside \\(\\mathcal{B}\\) or on its boundary are consecutive.\n(That is, prove that there exists a line separating those vertices of \\(\\mathcal{A}\\) that lie inside \\(\\mathcal{B}\\) or on its boundary from the other vertices of \\(\\mathcal{A}\\).)\n(Czech Republic)", "category": "Geometry", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-g7", "question": "G7. A convex quadrilateral \\(A B C D\\) has an inscribed circle with center \\(I\\). Let \\(I_{a}, I_{b}, I_{c}\\), and \\(I_{d}\\) be the incenters of the triangles \\(D A B, A B C, B C D\\), and \\(C D A\\), respectively. Suppose that the common external tangents of the circles \\(A I_{b} I_{d}\\) and \\(C I_{b} I_{d}\\) meet at \\(X\\), and the common external tangents of the circles \\(B I_{a} I_{c}\\) and \\(D I_{a} I_{c}\\) meet at \\(Y\\). Prove that \\(\\angle X I Y=90^{\\circ}\\).\n(Kazakhstan)", "category": "Geometry", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-g8", "question": "G8. There are 2017 mutually external circles drawn on a blackboard, such that no two are tangent and no three share a common tangent. A tangent segment is a line segment that is a common tangent to two circles, starting at one tangent point and ending at the other one. Luciano is drawing tangent segments on the blackboard, one at a time, so that no tangent segment intersects any other circles or previously drawn tangent segments. Luciano keeps drawing tangent segments until no more can be drawn. Find all possible numbers of tangent segments when he stops drawing.\n\nThis page is intentionally left blank", "category": "Geometry", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-n1", "question": "N1. The sequence \\(a_{0}, a_{1}, a_{2}, \\ldots\\) of positive integers satisfies\n\n\\[\na_{n+1}=\\left\\{\\begin{array}{ll}\n\\sqrt{a_{n}}, & \\text { if } \\sqrt{a_{n}} \\text { is an integer } \na_{n}+3, & \\text { otherwise }\n \\quad \\text { for every } n \\geqslant 0\\right.\n\\]\n\nDetermine all values of \\(a_{0}>1\\) for which there is at least one number \\(a\\) such that \\(a_{n}=a\\) for infinitely many values of \\(n\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-n2", "question": "N2. Let \\(p \\geqslant 2\\) be a prime number. Eduardo and Fernando play the following game making moves alternately: in each move, the current player chooses an index \\(i\\) in the set \\(\\{0,1, \\ldots, p-1\\}\\) that was not chosen before by either of the two players and then chooses an element \\(a_{i}\\) of the set \\(\\{0,1,2,3,4,5,6,7,8,9\\}\\). Eduardo has the first move. The game ends after all the indices \\(i \\in\\{0,1, \\ldots, p-1\\}\\) have been chosen. Then the following number is computed:\n\n\\[\nM=a_{0}+10 \\cdot a_{1}+\\cdots+10^{p-1} \\cdot a_{p-1}=\\sum_{j=0}^{p-1} a_{j} \\cdot 10^{j}\n\\]\n\nThe goal of Eduardo is to make the number \\(M\\) divisible by \\(p\\), and the goal of Fernando is to prevent this.\n\nProve that Eduardo has a winning strategy.\n(Morocco)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-n3", "question": "N3. Determine all integers \\(n \\geqslant 2\\) with the following property: for any integers \\(a_{1}, a_{2}, \\ldots, a_{n}\\) whose sum is not divisible by \\(n\\), there exists an index \\(1 \\leqslant i \\leqslant n\\) such that none of the numbers\n\n\\[\na_{i}, a_{i}+a_{i+1}, \\ldots, a_{i}+a_{i+1}+\\cdots+a_{i+n-1}\n\\]\n\nis divisible by \\(n\\). (We let \\(a_{i}=a_{i-n}\\) when \\(i>n\\).)\n(Thailand)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-n4", "question": "N4. Call a rational number short if it has finitely many digits in its decimal expansion. For a positive integer \\(m\\), we say that a positive integer \\(t\\) is \\(m\\)-tastic if there exists a number \\(c \\in\\{1,2,3, \\ldots, 2017\\}\\) such that \\(\\frac{10^{t}-1}{c \\cdot m}\\) is short, and such that \\(\\frac{10^{k}-1}{c \\cdot m}\\) is not short for any \\(1 \\leqslant k<t\\). Let \\(S(m)\\) be the set of \\(m\\)-tastic numbers. Consider \\(S(m)\\) for \\(m=1,2, \\ldots\\). What is the maximum number of elements in \\(S(m)\\) ?\n(Turkey)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-n5", "question": "N5. Find all pairs \\((p, q)\\) of prime numbers with \\(p>q\\) for which the number\n\n\\[\n\\frac{(p+q)^{p+q}(p-q)^{p-q}-1}{(p+q)^{p-q}(p-q)^{p+q}-1}\n\\]\n\nis an integer.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-n6", "question": "N6. Find the smallest positive integer \\(n\\), or show that no such \\(n\\) exists, with the following property: there are infinitely many distinct \\(n\\)-tuples of positive rational numbers ( \\(a_{1}, a_{2}, \\ldots, a_{n}\\) ) such that both\n\n\\[\na_{1}+a_{2}+\\cdots+a_{n} \\quad \\text { and } \\quad \\frac{1}{a_{1}}+\\frac{1}{a_{2}}+\\cdots+\\frac{1}{a_{n}}\n\\]\n\nare integers.\n(Singapore)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-n7", "question": "N7. Say that an ordered pair \\((x, y)\\) of integers is an irreducible lattice point if \\(x\\) and \\(y\\) are relatively prime. For any finite set \\(S\\) of irreducible lattice points, show that there is a homogenous polynomial in two variables, \\(f(x, y)\\), with integer coefficients, of degree at least 1 , such that \\(f(x, y)=1\\) for each \\((x, y)\\) in the set \\(S\\).\n\nNote: A homogenous polynomial of degree \\(n\\) is any nonzero polynomial of the form\n\n\\[\nf(x, y)=a_{0} x^{n}+a_{1} x^{n-1} y+a_{2} x^{n-2} y^{2}+\\cdots+a_{n-1} x y^{n-1}+a_{n} y^{n} .\n\\]", "category": "Number Theory", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-n8", "question": "N8. Let \\(p\\) be an odd prime number and \\(\\mathbb{Z}_{>0}\\) be the set of positive integers. Suppose that a function \\(f: \\mathbb{Z}_{>0} \\times \\mathbb{Z}_{>0} \\rightarrow\\{0,1\\}\\) satisfies the following properties:\n\n\\begin{itemize}\n  \\item \\(f(1,1)=0\\);\n  \\item \\(f(a, b)+f(b, a)=1\\) for any pair of relatively prime positive integers \\((a, b)\\) not both equal to 1 ;\n  \\item \\(f(a+b, b)=f(a, b)\\) for any pair of relatively prime positive integers \\((a, b)\\).\n\n\nProve that\n\n\\[\n\\sum_{n=1}^{p-1} f\\left(n^{2}, p\\right) \\geqslant \\sqrt{2 p}-2 .\n\\]", "category": "Number Theory", "source": "IMO Shortlist", "year": 2017, "solution": ""}
{"id": "imo-shortlist-2017-a1", "question": "A1. Let \\(a_{1}, a_{2}, \\ldots, a_{n}, k\\), and \\(M\\) be positive integers such that\n\n\\[\n\\frac{1}{a_{1}}+\\frac{1}{a_{2}}+\\cdots+\\frac{1}{a_{n}}=k \\quad \\text { and } \\quad a_{1} a_{2} \\ldots a_{n}=M .\n\\]\n\nIf \\(M>1\\), prove that the polynomial\n\n\\[\nP(x)=M(x+1)^{k}-\\left(x+a_{1}\\right)\\left(x+a_{2}\\right) \\cdots\\left(x+a_{n}\\right)\n\\]\n\nhas no positive roots.\n(Trinidad and Tobago)", "category": "Algebra", "source": "IMO Shortlist", "year": 2017, "solution": "We first prove that, for \\(x>0\\),\n\n\\[\na_{i}(x+1)^{1 / a_{i}} \\leqslant x+a_{i}\n\\]\n\nwith equality if and only if \\(a_{i}=1\\). It is clear that equality occurs if \\(a_{i}=1\\).\nIf \\(a_{i}>1\\), the AM-GM inequality applied to a single copy of \\(x+1\\) and \\(a_{i}-1\\) copies of 1 yields\n\n\\[\n\\frac{(x+1)+\\overbrace{1+1+\\cdots+1}^{a_{i}-1 \\text { ones }}}{a_{i}} \\geqslant \\sqrt[a_{i}]{(x+1) \\cdot 1^{a_{i}-1}} \\Longrightarrow a_{i}(x+1)^{1 / a_{i}} \\leqslant x+a_{i}\n\\]\n\nSince \\(x+1>1\\), the inequality is strict for \\(a_{i}>1\\).\nMultiplying the inequalities (1) for \\(i=1,2, \\ldots, n\\) yields\n\n\\[\n\\prod_{i=1}^{n} a_{i}(x+1)^{1 / a_{i}} \\leqslant \\prod_{i=1}^{n}\\left(x+a_{i}\\right) \\Longleftrightarrow M(x+1)^{\\sum_{i=1}^{n} 1 / a_{i}}-\\prod_{i=1}^{n}\\left(x+a_{i}\\right) \\leqslant 0 \\Longleftrightarrow P(x) \\leqslant 0\n\\]\n\nwith equality iff \\(a_{i}=1\\) for all \\(i \\in\\{1,2, \\ldots, n\\}\\). But this implies \\(M=1\\), which is not possible. Hence \\(P(x)<0\\) for all \\(x \\in \\mathbb{R}^{+}\\), and \\(P\\) has no positive roots.\n\nComment 1. Inequality (1) can be obtained in several ways. For instance, we may also use the binomial theorem: since \\(a_{i} \\geqslant 1\\),\n\n\\[\n\\left(1+\\frac{x}{a_{i}}\\right)^{a_{i}}=\\sum_{j=0}^{a_{i}}\\binom{a_{i}}{j}\\left(\\frac{x}{a_{i}}\\right)^{j} \\geqslant\\binom{ a_{i}}{0}+\\binom{a_{i}}{1} \\cdot \\frac{x}{a_{i}}=1+x .\n\\]\n\nBoth proofs of (1) mimic proofs to Bernoulli's inequality for a positive integer exponent \\(a_{i}\\); we can use this inequality directly:\n\n\\[\n\\left(1+\\frac{x}{a_{i}}\\right)^{a_{i}} \\geqslant 1+a_{i} \\cdot \\frac{x}{a_{i}}=1+x\n\\]\n\nand so\n\n\\[\nx+a_{i}=a_{i}\\left(1+\\frac{x}{a_{i}}\\right) \\geqslant a_{i}(1+x)^{1 / a_{i}}\n\\]\n\nor its (reversed) formulation, with exponent \\(1 / a_{i} \\leqslant 1\\) :\n\n\\[\n(1+x)^{1 / a_{i}} \\leqslant 1+\\frac{1}{a_{i}} \\cdot x=\\frac{x+a_{i}}{a_{i}} \\Longrightarrow a_{i}(1+x)^{1 / a_{i}} \\leqslant x+a_{i}\n\\]\n\nSolution 2. We will prove that, in fact, all coefficients of the polynomial \\(P(x)\\) are non-positive, and at least one of them is negative, which implies that \\(P(x)<0\\) for \\(x>0\\).\n\nIndeed, since \\(a_{j} \\geqslant 1\\) for all \\(j\\) and \\(a_{j}>1\\) for some \\(j\\) (since \\(a_{1} a_{2} \\ldots a_{n}=M>1\\) ), we have \\(k=\\frac{1}{a_{1}}+\\frac{1}{a_{2}}+\\cdots+\\frac{1}{a_{n}}<n\\), so the coefficient of \\(x^{n}\\) in \\(P(x)\\) is \\(-1<0\\). Moreover, the coefficient of \\(x^{r}\\) in \\(P(x)\\) is negative for \\(k<r \\leqslant n=\\operatorname{deg}(P)\\).\n\nFor \\(0 \\leqslant r \\leqslant k\\), the coefficient of \\(x^{r}\\) in \\(P(x)\\) is\n\n\\[\nM \\cdot\\binom{k}{r}-\\sum_{1 \\leqslant i_{1}<i_{2}<\\cdots<i_{n-r} \\leqslant n} a_{i_{1}} a_{i_{2}} \\cdots a_{i_{n-r}}=a_{1} a_{2} \\cdots a_{n} \\cdot\\binom{k}{r}-\\sum_{1 \\leqslant i_{1}<i_{2}<\\cdots<i_{n-r} \\leqslant n} a_{i_{1}} a_{i_{2}} \\cdots a_{i_{n-r}},\n\\]\n\nwhich is non-positive iff\n\n\\[\n\\binom{k}{r} \\leqslant \\sum_{1 \\leqslant j_{1}<j_{2}<\\cdots<j_{r} \\leqslant n} \\frac{1}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}}} .\n\\]\n\nWe will prove (2) by induction on \\(r\\). For \\(r=0\\) it is an equality because the constant term of \\(P(x)\\) is \\(P(0)=0\\), and if \\(r=1\\), (2) becomes \\(k=\\sum_{i=1}^{n} \\frac{1}{a_{i}}\\). For \\(r>1\\), if (2) is true for a given \\(r<k\\), we have\n\n\\[\n\\binom{k}{r+1}=\\frac{k-r}{r+1} \\cdot\\binom{k}{r} \\leqslant \\frac{k-r}{r+1} \\cdot \\sum_{1 \\leqslant j_{1}<j_{2}<\\cdots<j_{r} \\leqslant n} \\frac{1}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}}},\n\\]\n\nand it suffices to prove that\n\n\\[\n\\frac{k-r}{r+1} \\cdot \\sum_{1 \\leqslant j_{1}<j_{2}<\\cdots<j_{r} \\leqslant n} \\frac{1}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}}} \\leqslant \\sum_{1 \\leqslant j_{1}<\\cdots<j_{r}<j_{r+1} \\leqslant n} \\frac{1}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}} a_{j_{r+1}}},\n\\]\n\nwhich is equivalent to\n\n\\[\n\\left(\\frac{1}{a_{1}}+\\frac{1}{a_{2}}+\\cdots+\\frac{1}{a_{n}}-r\\right) \\sum_{1 \\leqslant j_{1}<j_{2}<\\cdots<j_{r} \\leqslant n} \\frac{1}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}}} \\leqslant(r+1) \\sum_{1 \\leqslant j_{1}<\\cdots<j_{r}<j_{r+1} \\leqslant n} \\frac{1}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}} a_{j_{r+1}}} .\n\\]\n\nSince there are \\(r+1\\) ways to choose a fraction \\(\\frac{1}{a_{j_{i}}}\\) from \\(\\frac{1}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}} a_{j_{r+1}}}\\) to factor out, every term \\(\\frac{1}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}} a_{j_{r+1}}}\\) in the right hand side appears exactly \\(r+1\\) times in the product\n\n\\[\n\\left(\\frac{1}{a_{1}}+\\frac{1}{a_{2}}+\\cdots+\\frac{1}{a_{n}}\\right) \\sum_{1 \\leqslant j_{1}<j_{2}<\\cdots<j_{r} \\leqslant n} \\frac{1}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}}} .\n\\]\n\nHence all terms in the right hand side cancel out.\nThe remaining terms in the left hand side can be grouped in sums of the type\n\n\\[\n\\begin{aligned}\n\\frac{1}{a_{j_{1}}^{2} a_{j_{2}} \\cdots a_{j_{r}}}+\\frac{1}{a_{j_{1}} a_{j_{2}}^{2} \\cdots a_{j_{r}}}+\\cdots+\\frac{1}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}}^{2}} & -\\frac{r}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}}} \n& =\\frac{1}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}}}\\left(\\frac{1}{a_{j_{1}}}+\\frac{1}{a_{j_{2}}}+\\cdots+\\frac{1}{a_{j_{r}}}-r\\right),\n\n\\]\n\nwhich are all non-positive because \\(a_{i} \\geqslant 1 \\Longrightarrow \\frac{1}{a_{i}} \\leqslant 1, i=1,2, \\ldots, n\\).\n\nComment 2. The result is valid for any real numbers \\(a_{i}, i=1,2, \\ldots, n\\) with \\(a_{i} \\geqslant 1\\) and product \\(M\\) greater than 1. A variation of Solution 1, namely using weighted AM-GM (or the Bernoulli inequality for real exponents), actually proves that \\(P(x)<0\\) for \\(x>-1\\) and \\(x \\neq 0\\)."}
{"id": "imo-shortlist-2017-a2", "question": "A2. Let \\(q\\) be a real number. Gugu has a napkin with ten distinct real numbers written on it, and he writes the following three lines of real numbers on the blackboard:\n\n\\begin{itemize}\n  \\item In the first line, Gugu writes down every number of the form \\(a-b\\), where \\(a\\) and \\(b\\) are two (not necessarily distinct) numbers on his napkin.\n  \\item In the second line, Gugu writes down every number of the form qab, where \\(a\\) and \\(b\\) are two (not necessarily distinct) numbers from the first line.\n  \\item In the third line, Gugu writes down every number of the form \\(a^{2}+b^{2}-c^{2}-d^{2}\\), where \\(a, b, c, d\\) are four (not necessarily distinct) numbers from the first line.\n\n\nDetermine all values of \\(q\\) such that, regardless of the numbers on Gugu's napkin, every number in the second line is also a number in the third line.\n(Austria)\nAnswer: -2,0,2.", "category": "Algebra", "source": "IMO Shortlist", "year": 2017, "solution": "Call a number \\(q\\) good if every number in the second line appears in the third line unconditionally. We first show that the numbers 0 and \\(\\pm 2\\) are good. The third line necessarily contains 0 , so 0 is good. For any two numbers \\(a, b\\) in the first line, write \\(a=x-y\\) and \\(b=u-v\\), where \\(x, y, u, v\\) are (not necessarily distinct) numbers on the napkin. We may now write\n\n\\[\n2 a b=2(x-y)(u-v)=(x-v)^{2}+(y-u)^{2}-(x-u)^{2}-(y-v)^{2}\n\\]\n\nwhich shows that 2 is good. By negating both sides of the above equation, we also see that -2 is good.\n\nWe now show that \\(-2,0\\), and 2 are the only good numbers. Assume for sake of contradiction that \\(q\\) is a good number, where \\(q \\notin\\{-2,0,2\\}\\). We now consider some particular choices of numbers on Gugu's napkin to arrive at a contradiction.\n\nAssume that the napkin contains the integers \\(1,2, \\ldots, 10\\). Then, the first line contains the integers \\(-9,-8, \\ldots, 9\\). The second line then contains \\(q\\) and \\(81 q\\), so the third line must also contain both of them. But the third line only contains integers, so \\(q\\) must be an integer. Furthermore, the third line contains no number greater than \\(162=9^{2}+9^{2}-0^{2}-0^{2}\\) or less than -162 , so we must have \\(-162 \\leqslant 81 q \\leqslant 162\\). This shows that the only possibilities for \\(q\\) are \\(\\pm 1\\).\n\nNow assume that \\(q= \\pm 1\\). Let the napkin contain \\(0,1,4,8,12,16,20,24,28,32\\). The first line contains \\(\\pm 1\\) and \\(\\pm 4\\), so the second line contains \\(\\pm 4\\). However, for every number \\(a\\) in the first line, \\(a \\not \\equiv 2(\\bmod 4)\\), so we may conclude that \\(a^{2} \\equiv 0,1(\\bmod 8)\\). Consequently, every number in the third line must be congruent to \\(-2,-1,0,1,2\\) ( \\(\\bmod 8\\) ) ; in particular, \\(\\pm 4\\) cannot be in the third line, which is a contradiction.\n\nSolution 2. Let \\(q\\) be a good number, as defined in the first solution, and define the polynomial \\(P\\left(x_{1}, \\ldots, x_{10}\\right)\\) as\n\n\\[\n\\prod_{i<j}\\left(x_{i}-x_{j}\\right) \\prod_{a_{i} \\in S}\\left(q\\left(x_{1}-x_{2}\\right)\\left(x_{3}-x_{4}\\right)-\\left(a_{1}-a_{2}\\right)^{2}-\\left(a_{3}-a_{4}\\right)^{2}+\\left(a_{5}-a_{6}\\right)^{2}+\\left(a_{7}-a_{8}\\right)^{2}\\right)\n\\]\n\nwhere \\(S=\\left\\{x_{1}, \\ldots, x_{10}\\right\\}\\).\nWe claim that \\(P\\left(x_{1}, \\ldots, x_{10}\\right)=0\\) for every choice of real numbers \\(\\left(x_{1}, \\ldots, x_{10}\\right)\\). If any two of the \\(x_{i}\\) are equal, then \\(P\\left(x_{1}, \\ldots, x_{10}\\right)=0\\) trivially. If no two are equal, assume that Gugu has those ten numbers \\(x_{1}, \\ldots, x_{10}\\) on his napkin. Then, the number \\(q\\left(x_{1}-x_{2}\\right)\\left(x_{3}-x_{4}\\right)\\) is in the second line, so we must have some \\(a_{1}, \\ldots, a_{8}\\) so that\n\n\\[\nq\\left(x_{1}-x_{2}\\right)\\left(x_{3}-x_{4}\\right)-\\left(a_{1}-a_{2}\\right)^{2}-\\left(a_{3}-a_{4}\\right)^{2}+\\left(a_{5}-a_{6}\\right)^{2}+\\left(a_{7}-a_{8}\\right)^{2}=0\n\\]\n\nand hence \\(P\\left(x_{1}, \\ldots, x_{10}\\right)=0\\).\nSince every polynomial that evaluates to zero everywhere is the zero polynomial, and the product of two nonzero polynomials is necessarily nonzero, we may define \\(F\\) such that\n\n\\[\nF\\left(x_{1}, \\ldots, x_{10}\\right) \\equiv q\\left(x_{1}-x_{2}\\right)\\left(x_{3}-x_{4}\\right)-\\left(a_{1}-a_{2}\\right)^{2}-\\left(a_{3}-a_{4}\\right)^{2}+\\left(a_{5}-a_{6}\\right)^{2}+\\left(a_{7}-a_{8}\\right)^{2} \\equiv 0\n\\]\n\nfor some particular choice \\(a_{i} \\in S\\).\nEach of the sets \\(\\left\\{a_{1}, a_{2}\\right\\},\\left\\{a_{3}, a_{4}\\right\\},\\left\\{a_{5}, a_{6}\\right\\}\\), and \\(\\left\\{a_{7}, a_{8}\\right\\}\\) is equal to at most one of the four sets \\(\\left\\{x_{1}, x_{3}\\right\\},\\left\\{x_{2}, x_{3}\\right\\},\\left\\{x_{1}, x_{4}\\right\\}\\), and \\(\\left\\{x_{2}, x_{4}\\right\\}\\). Thus, without loss of generality, we may assume that at most one of the sets \\(\\left\\{a_{1}, a_{2}\\right\\},\\left\\{a_{3}, a_{4}\\right\\},\\left\\{a_{5}, a_{6}\\right\\}\\), and \\(\\left\\{a_{7}, a_{8}\\right\\}\\) is equal to \\(\\left\\{x_{1}, x_{3}\\right\\}\\). Let \\(u_{1}, u_{3}, u_{5}, u_{7}\\) be the indicator functions for this equality of sets: that is, \\(u_{i}=1\\) if and only if \\(\\left\\{a_{i}, a_{i+1}\\right\\}=\\left\\{x_{1}, x_{3}\\right\\}\\). By assumption, at least three of the \\(u_{i}\\) are equal to 0 .\n\nWe now compute the coefficient of \\(x_{1} x_{3}\\) in \\(F\\). It is equal to \\(q+2\\left(u_{1}+u_{3}-u_{5}-u_{7}\\right)=0\\), and since at least three of the \\(u_{i}\\) are zero, we must have that \\(q \\in\\{-2,0,2\\}\\), as desired."}
{"id": "imo-shortlist-2017-a3", "question": "A3. Let \\(S\\) be a finite set, and let \\(\\mathcal{A}\\) be the set of all functions from \\(S\\) to \\(S\\). Let \\(f\\) be an element of \\(\\mathcal{A}\\), and let \\(T=f(S)\\) be the image of \\(S\\) under \\(f\\). Suppose that \\(f \\circ g \\circ f \\neq g \\circ f \\circ g\\) for every \\(g\\) in \\(\\mathcal{A}\\) with \\(g \\neq f\\). Show that \\(f(T)=T\\).\n(India)", "category": "Algebra", "source": "IMO Shortlist", "year": 2017, "solution": "For \\(n \\geqslant 1\\), denote the \\(n\\)-th composition of \\(f\\) with itself by\n\n\\[\nf^{n} \\stackrel{\\text { def }}{=} \\underbrace{f \\circ f \\circ \\cdots \\circ f}_{n \\text { times }}\n\\]\n\nBy hypothesis, if \\(g \\in \\mathcal{A}\\) satisfies \\(f \\circ g \\circ f=g \\circ f \\circ g\\), then \\(g=f\\). A natural idea is to try to plug in \\(g=f^{n}\\) for some \\(n\\) in the expression \\(f \\circ g \\circ f=g \\circ f \\circ g\\) in order to get \\(f^{n}=f\\), which solves the problem:\nClaim. If there exists \\(n \\geqslant 3\\) such that \\(f^{n+2}=f^{2 n+1}\\), then the restriction \\(f: T \\rightarrow T\\) of \\(f\\) to \\(T\\) is a bijection.\nProof. Indeed, by hypothesis, \\(f^{n+2}=f^{2 n+1} \\Longleftrightarrow f \\circ f^{n} \\circ f=f^{n} \\circ f \\circ f^{n} \\Longrightarrow f^{n}=f\\). Since \\(n-2 \\geqslant 1\\), the image of \\(f^{n-2}\\) is contained in \\(T=f(S)\\), hence \\(f^{n-2}\\) restricts to a function \\(f^{n-2}: T \\rightarrow T\\). This is the inverse of \\(f: T \\rightarrow T\\). In fact, given \\(t \\in T\\), say \\(t=f(s)\\) with \\(s \\in S\\), we have\n\n\\[\nt=f(s)=f^{n}(s)=f^{n-2}(f(t))=f\\left(f^{n-2}(t)\\right), \\quad \\text { i.e., } \\quad f^{n-2} \\circ f=f \\circ f^{n-2}=\\operatorname{id} \\text { on } T\n\\]\n\n(here id stands for the identity function). Hence, the restriction \\(f: T \\rightarrow T\\) of \\(f\\) to \\(T\\) is bijective with inverse given by \\(f^{n-2}: T \\rightarrow T\\).\n\nIt remains to show that \\(n\\) as in the claim exists. For that, define\n\n\\[\nS_{m} \\stackrel{\\text { def }}{=} f^{m}(S) \\quad\\left(S_{m} \\text { is image of } f^{m}\\right)\n\\]\n\nClearly the image of \\(f^{m+1}\\) is contained in the image of \\(f^{m}\\), i.e., there is a descending chain of subsets of \\(S\\)\n\n\\[\nS \\supseteq S_{1} \\supseteq S_{2} \\supseteq S_{3} \\supseteq S_{4} \\supseteq \\cdots,\n\\]\n\nwhich must eventually stabilise since \\(S\\) is finite, i.e., there is a \\(k \\geqslant 1\\) such that\n\n\\[\nS_{k}=S_{k+1}=S_{k+2}=S_{k+3}=\\cdots \\stackrel{\\text { def }}{=} S_{\\infty}\n\\]\n\nHence \\(f\\) restricts to a surjective function \\(f: S_{\\infty} \\rightarrow S_{\\infty}\\), which is also bijective since \\(S_{\\infty} \\subseteq S\\) is finite. To sum up, \\(f: S_{\\infty} \\rightarrow S_{\\infty}\\) is a permutation of the elements of the finite set \\(S_{\\infty}\\), hence there exists an integer \\(r \\geqslant 1\\) such that \\(f^{r}=\\mathrm{id}\\) on \\(S_{\\infty}\\) (for example, we may choose \\(r=\\left|S_{\\infty}\\right|!\\) ). In other words,\n\n\\[\nf^{m+r}=f^{m} \\text { on } S \\text { for all } m \\geqslant k .\n\\]\n\nClearly, (*) also implies that \\(f^{m+t r}=f^{m}\\) for all integers \\(t \\geqslant 1\\) and \\(m \\geqslant k\\). So, to find \\(n\\) as in the claim and finish the problem, it is enough to choose \\(m\\) and \\(t\\) in order to ensure that there exists \\(n \\geqslant 3\\) satisfying\n\n\\[\n\\left\\{\\begin{array} { l } \n{ 2 n + 1 = m + t r } \n{ n + 2 = m }\n \\Longleftrightarrow \\left\\{\\begin{array}{l}\nm=3+t r \nn=m-2\n\\right.\\right.\n\\]\n\nThis can be clearly done by choosing \\(m\\) large enough with \\(m \\equiv 3(\\bmod r)\\). For instance, we may take \\(n=2 k r+1\\), so that\n\n\\[\nf^{n+2}=f^{2 k r+3}=f^{4 k r+3}=f^{2 n+1}\n\\]\n\nwhere the middle equality follows by (*) since \\(2 k r+3 \\geqslant k\\)."}
{"id": "imo-shortlist-2017-a4", "question": "A4. A sequence of real numbers \\(a_{1}, a_{2}, \\ldots\\) satisfies the relation\n\n\\[\na_{n}=-\\max _{i+j=n}\\left(a_{i}+a_{j}\\right) \\quad \\text { for all } n>2017 .\n\\]\n\nProve that this sequence is bounded, i.e., there is a constant \\(M\\) such that \\(\\left|a_{n}\\right| \\leqslant M\\) for all positive integers \\(n\\).\n(Russia)", "category": "Algebra", "source": "IMO Shortlist", "year": 2017, "solution": "Set \\(D=2017\\). Denote\n\n\\[\nM_{n}=\\max _{k<n} a_{k} \\quad \\text { and } \\quad m_{n}=-\\min _{k<n} a_{k}=\\max _{k<n}\\left(-a_{k}\\right) .\n\\]\n\nClearly, the sequences \\(\\left(m_{n}\\right)\\) and \\(\\left(M_{n}\\right)\\) are nondecreasing. We need to prove that both are bounded.\n\nConsider an arbitrary \\(n>D\\); our first aim is to bound \\(a_{n}\\) in terms of \\(m_{n}\\) and \\(M_{n}\\).\n(i) There exist indices \\(p\\) and \\(q\\) such that \\(a_{n}=-\\left(a_{p}+a_{q}\\right)\\) and \\(p+q=n\\). Since \\(a_{p}, a_{q} \\leqslant M_{n}\\), we have \\(a_{n} \\geqslant-2 M_{n}\\).\n(ii) On the other hand, choose an index \\(k<n\\) such that \\(a_{k}=M_{n}\\). Then, we have\n\n\\[\na_{n}=-\\max _{\\ell<n}\\left(a_{n-\\ell}+a_{\\ell}\\right) \\leqslant-\\left(a_{n-k}+a_{k}\\right)=-a_{n-k}-M_{n} \\leqslant m_{n}-M_{n} .\n\\]\n\nSummarizing (i) and (ii), we get\n\n\\[\n-2 M_{n} \\leqslant a_{n} \\leqslant m_{n}-M_{n},\n\\]\n\nwhence\n\n\\[\nm_{n} \\leqslant m_{n+1} \\leqslant \\max \\left\\{m_{n}, 2 M_{n}\\right\\} \\quad \\text { and } \\quad M_{n} \\leqslant M_{n+1} \\leqslant \\max \\left\\{M_{n}, m_{n}-M_{n}\\right\\}\n\\]\n\nNow, say that an index \\(n>D\\) is lucky if \\(m_{n} \\leqslant 2 M_{n}\\). Two cases are possible.\nCase 1. Assume that there exists a lucky index \\(n\\). In this case, (1) yields \\(m_{n+1} \\leqslant 2 M_{n}\\) and \\(M_{n} \\leqslant M_{n+1} \\leqslant M_{n}\\). Therefore, \\(M_{n+1}=M_{n}\\) and \\(m_{n+1} \\leqslant 2 M_{n}=2 M_{n+1}\\). So, the index \\(n+1\\) is also lucky, and \\(M_{n+1}=M_{n}\\). Applying the same arguments repeatedly, we obtain that all indices \\(k>n\\) are lucky (i.e., \\(m_{k} \\leqslant 2 M_{k}\\) for all these indices), and \\(M_{k}=M_{n}\\) for all such indices. Thus, all of the \\(m_{k}\\) and \\(M_{k}\\) are bounded by \\(2 M_{n}\\).\nCase 2. Assume now that there is no lucky index, i.e., \\(2 M_{n}<m_{n}\\) for all \\(n>D\\). Then (1) shows that for all \\(n>D\\) we have \\(m_{n} \\leqslant m_{n+1} \\leqslant m_{n}\\), so \\(m_{n}=m_{D+1}\\) for all \\(n>D\\). Since \\(M_{n}<m_{n} / 2\\) for all such indices, all of the \\(m_{n}\\) and \\(M_{n}\\) are bounded by \\(m_{D+1}\\).\n\nThus, in both cases the sequences \\(\\left(m_{n}\\right)\\) and \\(\\left(M_{n}\\right)\\) are bounded, as desired.\nSolution 2. As in the previous solution, let \\(D=2017\\). If the sequence is bounded above, say, by \\(Q\\), then we have that \\(a_{n} \\geqslant \\min \\left\\{a_{1}, \\ldots, a_{D},-2 Q\\right\\}\\) for all \\(n\\), so the sequence is bounded. Assume for sake of contradiction that the sequence is not bounded above. Let \\(\\ell=\\min \\left\\{a_{1}, \\ldots, a_{D}\\right\\}\\), and \\(L=\\max \\left\\{a_{1}, \\ldots, a_{D}\\right\\}\\). Call an index \\(n\\) good if the following criteria hold:\n\n\\[\na_{n}>a_{i} \\text { for each } i<n, \\quad a_{n}>-2 \\ell, \\quad \\text { and } \\quad n>D\n\\]\n\nWe first show that there must be some good index \\(n\\). By assumption, we may take an index \\(N\\) such that \\(a_{N}>\\max \\{L,-2 \\ell\\}\\). Choose \\(n\\) minimally such that \\(a_{n}=\\max \\left\\{a_{1}, a_{2}, \\ldots, a_{N}\\right\\}\\). Now, the first condition in (2) is satisfied because of the minimality of \\(n\\), and the second and third conditions are satisfied because \\(a_{n} \\geqslant a_{N}>L,-2 \\ell\\), and \\(L \\geqslant a_{i}\\) for every \\(i\\) such that \\(1 \\leqslant i \\leqslant D\\).\n\nLet \\(n\\) be a good index. We derive a contradiction. We have that\n\n\\[\na_{n}+a_{u}+a_{v} \\leqslant 0\n\\]\n\nwhenever \\(u+v=n\\).\nWe define the index \\(u\\) to maximize \\(a_{u}\\) over \\(1 \\leqslant u \\leqslant n-1\\), and let \\(v=n-u\\). Then, we note that \\(a_{u} \\geqslant a_{v}\\) by the maximality of \\(a_{u}\\).\n\nAssume first that \\(v \\leqslant D\\). Then, we have that\n\n\\[\na_{N}+2 \\ell \\leqslant 0\n\\]\n\nbecause \\(a_{u} \\geqslant a_{v} \\geqslant \\ell\\). But this contradicts our assumption that \\(a_{n}>-2 \\ell\\) in the second criteria of (2).\n\nNow assume that \\(v>D\\). Then, there exist some indices \\(w_{1}, w_{2}\\) summing up to \\(v\\) such that\n\n\\[\na_{v}+a_{w_{1}}+a_{w_{2}}=0\n\\]\n\nBut combining this with (3), we have\n\n\\[\na_{n}+a_{u} \\leqslant a_{w_{1}}+a_{w_{2}}\n\\]\n\nBecause \\(a_{n}>a_{u}\\), we have that \\(\\max \\left\\{a_{w_{1}}, a_{w_{2}}\\right\\}>a_{u}\\). But since each of the \\(w_{i}\\) is less than \\(v\\), this contradicts the maximality of \\(a_{u}\\).\n\nComment 1. We present two harder versions of this problem below.\nVersion 1. Let \\(a_{1}, a_{2}, \\ldots\\) be a sequence of numbers that satisfies the relation\n\n\\[\na_{n}=-\\max _{i+j+k=n}\\left(a_{i}+a_{j}+a_{k}\\right) \\quad \\text { for all } n>2017\n\\]\n\nThen, this sequence is bounded.\nProof. Set \\(D=2017\\). Denote\n\n\\[\nM_{n}=\\max _{k<n} a_{k} \\quad \\text { and } \\quad m_{n}=-\\min _{k<n} a_{k}=\\max _{k<n}\\left(-a_{k}\\right) .\n\\]\n\nClearly, the sequences \\(\\left(m_{n}\\right)\\) and \\(\\left(M_{n}\\right)\\) are nondecreasing. We need to prove that both are bounded.\nConsider an arbitrary \\(n>2 D\\); our first aim is to bound \\(a_{n}\\) in terms of \\(m_{i}\\) and \\(M_{i}\\). Set \\(k=\\lfloor n / 2\\rfloor\\).\n(i) Choose indices \\(p, q\\), and \\(r\\) such that \\(a_{n}=-\\left(a_{p}+a_{q}+a_{r}\\right)\\) and \\(p+q+r=n\\). Without loss of generality, \\(p \\geqslant q \\geqslant r\\).\n\nAssume that \\(p \\geqslant k+1(>D)\\); then \\(p>q+r\\). Hence\n\n\\[\n-a_{p}=\\max _{i_{1}+i_{2}+i_{3}=p}\\left(a_{i_{1}}+a_{i_{2}}+a_{i_{3}}\\right) \\geqslant a_{q}+a_{r}+a_{p-q-r}\n\\]\n\nand therefore \\(a_{n}=-\\left(a_{p}+a_{q}+a_{r}\\right) \\geqslant\\left(a_{q}+a_{r}+a_{p-q-r}\\right)-a_{q}-a_{r}=a_{p-q-r} \\geqslant-m_{n}\\).\nOtherwise, we have \\(k \\geqslant p \\geqslant q \\geqslant r\\). Since \\(n<3 k\\), we have \\(r<k\\). Then \\(a_{p}, a_{q} \\leqslant M_{k+1}\\) and \\(a_{r} \\leqslant M_{k}\\), whence \\(a_{n} \\geqslant-2 M_{k+1}-M_{k}\\).\n\nThus, in any case \\(a_{n} \\geqslant-\\max \\left\\{m_{n}, 2 M_{k+1}+M_{k}\\right\\}\\).\n(ii) On the other hand, choose \\(p \\leqslant k\\) and \\(q \\leqslant k-1\\) such that \\(a_{p}=M_{k+1}\\) and \\(a_{q}=M_{k}\\). Then \\(p+q<n\\), so \\(a_{n} \\leqslant-\\left(a_{p}+a_{q}+a_{n-p-q}\\right)=-a_{n-p-q}-M_{k+1}-M_{k} \\leqslant m_{n}-M_{k+1}-M_{k}\\).\n\nTo summarize,\n\n\\[\n-\\max \\left\\{m_{n}, 2 M_{k+1}+M_{k}\\right\\} \\leqslant a_{n} \\leqslant m_{n}-M_{k+1}-M_{k},\n\\]\n\nwhence\n\n\\[\nm_{n} \\leqslant m_{n+1} \\leqslant \\max \\left\\{m_{n}, 2 M_{k+1}+M_{k}\\right\\} \\quad \\text { and } \\quad M_{n} \\leqslant M_{n+1} \\leqslant \\max \\left\\{M_{n}, m_{n}-M_{k+1}-M_{k}\\right\\}\n\\]\n\nNow, say that an index \\(n>2 D\\) is lucky if \\(m_{n} \\leqslant 2 M_{\\lfloor n / 2\\rfloor+1}+M_{\\lfloor n / 2\\rfloor}\\). Two cases are possible.\nCase 1. Assume that there exists a lucky index \\(n\\); set \\(k=\\lfloor n / 2\\rfloor\\). In this case, (4) yields \\(m_{n+1} \\leqslant\\) \\(2 M_{k+1}+M_{k}\\) and \\(M_{n} \\leqslant M_{n+1} \\leqslant M_{n}\\) (the last relation holds, since \\(m_{n}-M_{k+1}-M_{k} \\leqslant\\left(2 M_{k+1}+\\right.\\) \\(\\left.\\left.M_{k}\\right)-M_{k+1}-M_{k}=M_{k+1} \\leqslant M_{n}\\right)\\). Therefore, \\(M_{n+1}=M_{n}\\) and \\(m_{n+1} \\leqslant 2 M_{k+1}+M_{k}\\); the last relation shows that the index \\(n+1\\) is also lucky.\n\nThus, all indices \\(N>n\\) are lucky, and \\(M_{N}=M_{n} \\geqslant m_{N} / 3\\), whence all the \\(m_{N}\\) and \\(M_{N}\\) are bounded by \\(3 M_{n}\\).\nCase 2. Conversely, assume that there is no lucky index, i.e., \\(2 M_{\\lfloor n / 2\\rfloor+1}+M_{\\lfloor n / 2\\rfloor}<m_{n}\\) for all \\(n>2 D\\). Then (4) shows that for all \\(n>2 D\\) we have \\(m_{n} \\leqslant m_{n+1} \\leqslant m_{n}\\), i.e., \\(m_{N}=m_{2 D+1}\\) for all \\(N>2 D\\). Since \\(M_{N}<m_{2 N+1} / 3\\) for all such indices, all the \\(m_{N}\\) and \\(M_{N}\\) are bounded by \\(m_{2 D+1}\\).\n\nThus, in both cases the sequences \\(\\left(m_{n}\\right)\\) and \\(\\left(M_{n}\\right)\\) are bounded, as desired.\nVersion 2. Let \\(a_{1}, a_{2}, \\ldots\\) be a sequence of numbers that satisfies the relation\n\n\\[\na_{n}=-\\max _{i_{1}+\\cdots+i_{k}=n}\\left(a_{i_{1}}+\\cdots+a_{i_{k}}\\right) \\quad \\text { for all } n>2017 .\n\\]\n\nThen, this sequence is bounded.\nProof. As in the solutions above, let \\(D=2017\\). If the sequence is bounded above, say, by \\(Q\\), then we have that \\(a_{n} \\geqslant \\min \\left\\{a_{1}, \\ldots, a_{D},-k Q\\right\\}\\) for all \\(n\\), so the sequence is bounded. Assume for sake of contradiction that the sequence is not bounded above. Let \\(\\ell=\\min \\left\\{a_{1}, \\ldots, a_{D}\\right\\}\\), and \\(L=\\max \\left\\{a_{1}, \\ldots, a_{D}\\right\\}\\). Call an index \\(n\\) good if the following criteria hold:\n\n\\[\na_{n}>a_{i} \\text { for each } i<n, \\quad a_{n}>-k \\ell, \\quad \\text { and } \\quad n>D\n\\]\n\nWe first show that there must be some good index \\(n\\). By assumption, we may take an index \\(N\\) such that \\(a_{N}>\\max \\{L,-k \\ell\\}\\). Choose \\(n\\) minimally such that \\(a_{n}=\\max \\left\\{a_{1}, a_{2}, \\ldots, a_{N}\\right\\}\\). Now, the first condition is satisfied because of the minimality of \\(n\\), and the second and third conditions are satisfied because \\(a_{n} \\geqslant a_{N}>L,-k \\ell\\), and \\(L \\geqslant a_{i}\\) for every \\(i\\) such that \\(1 \\leqslant i \\leqslant D\\).\n\nLet \\(n\\) be a good index. We derive a contradiction. We have that\n\n\\[\na_{n}+a_{v_{1}}+\\cdots+a_{v_{k}} \\leqslant 0\n\\]\n\nwhenever \\(v_{1}+\\cdots+v_{k}=n\\).\nWe define the sequence of indices \\(v_{1}, \\ldots, v_{k-1}\\) to greedily maximize \\(a_{v_{1}}\\), then \\(a_{v_{2}}\\), and so forth, selecting only from indices such that the equation \\(v_{1}+\\cdots+v_{k}=n\\) can be satisfied by positive integers \\(v_{1}, \\ldots, v_{k}\\). More formally, we define them inductively so that the following criteria are satisfied by the \\(v_{i}\\) :\n\n\\begin{enumerate}\n  \\item \\(1 \\leqslant v_{i} \\leqslant n-(k-i)-\\left(v_{1}+\\cdots+v_{i-1}\\right)\\).\n  \\item \\(a_{v_{i}}\\) is maximal among all choices of \\(v_{i}\\) from the first criteria.\n\n\nFirst of all, we note that for each \\(i\\), the first criteria is always satisfiable by some \\(v_{i}\\), because we are guaranteed that\n\n\\[\nv_{i-1} \\leqslant n-(k-(i-1))-\\left(v_{1}+\\cdots+v_{i-2}\\right)\n\\]\n\nwhich implies\n\n\\[\n1 \\leqslant n-(k-i)-\\left(v_{1}+\\cdots+v_{i-1}\\right)\n\\]\n\nSecondly, the sum \\(v_{1}+\\cdots+v_{k-1}\\) is at most \\(n-1\\). Define \\(v_{k}=n-\\left(v_{1}+\\cdots+v_{k-1}\\right)\\). Then, (6) is satisfied by the \\(v_{i}\\). We also note that \\(a_{v_{i}} \\geqslant a_{v_{j}}\\) for all \\(i<j\\); otherwise, in the definition of \\(v_{i}\\), we could have selected \\(v_{j}\\) instead.\n\nAssume first that \\(v_{k} \\leqslant D\\). Then, from (6), we have that\n\n\\[\na_{n}+k \\ell \\leqslant 0\n\\]\n\nby using that \\(a_{v_{1}} \\geqslant \\cdots \\geqslant a_{v_{k}} \\geqslant \\ell\\). But this contradicts our assumption that \\(a_{n}>-k \\ell\\) in the second criteria of (5).\n\nNow assume that \\(v_{k}>D\\), and then we must have some indices \\(w_{1}, \\ldots, w_{k}\\) summing up to \\(v_{k}\\) such that\n\n\\[\na_{v_{k}}+a_{w_{1}}+\\cdots+a_{w_{k}}=0\n\\]\n\nBut combining this with (6), we have\n\n\\[\na_{n}+a_{v_{1}}+\\cdots+a_{v_{k-1}} \\leqslant a_{w_{1}}+\\cdots+a_{w_{k}}\n\\]\n\nBecause \\(a_{n}>a_{v_{1}} \\geqslant \\cdots \\geqslant a_{v_{k-1}}\\), we have that \\(\\max \\left\\{a_{w_{1}}, \\ldots, a_{w_{k}}\\right\\}>a_{v_{k-1}}\\). But since each of the \\(w_{i}\\) is less than \\(v_{k}\\), in the definition of the \\(v_{k-1}\\) we could have chosen one of the \\(w_{i}\\) instead, which is a contradiction.\n\nComment 2. It seems that each sequence satisfying the condition in Version 2 is eventually periodic, at least when its terms are integers.\n\nHowever, up to this moment, the Problem Selection Committee is not aware of a proof for this fact (even in the case \\(k=2\\) )."}
{"id": "imo-shortlist-2017-a5", "question": "A5. An integer \\(n \\geqslant 3\\) is given. We call an \\(n\\)-tuple of real numbers \\(\\left(x_{1}, x_{2}, \\ldots, x_{n}\\right)\\) Shiny if for each permutation \\(y_{1}, y_{2}, \\ldots, y_{n}\\) of these numbers we have\n\n\\[\n\\sum_{i=1}^{n-1} y_{i} y_{i+1}=y_{1} y_{2}+y_{2} y_{3}+y_{3} y_{4}+\\cdots+y_{n-1} y_{n} \\geqslant-1\n\\]\n\nFind the largest constant \\(K=K(n)\\) such that\n\n\\[\n\\sum_{1 \\leqslant i<j \\leqslant n} x_{i} x_{j} \\geqslant K\n\\]\n\nholds for every Shiny \\(n\\)-tuple \\(\\left(x_{1}, x_{2}, \\ldots, x_{n}\\right)\\).\n\nAnswer: \\(K=-(n-1) / 2\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2017, "solution": "First of all, we show that we may not take a larger constant \\(K\\). Let \\(t\\) be a positive number, and take \\(x_{2}=x_{3}=\\cdots=t\\) and \\(x_{1}=-1 /(2 t)\\). Then, every product \\(x_{i} x_{j}(i \\neq j)\\) is equal to either \\(t^{2}\\) or \\(-1 / 2\\). Hence, for every permutation \\(y_{i}\\) of the \\(x_{i}\\), we have\n\n\\[\ny_{1} y_{2}+\\cdots+y_{n-1} y_{n} \\geqslant(n-3) t^{2}-1 \\geqslant-1\n\\]\n\nThis justifies that the \\(n\\)-tuple \\(\\left(x_{1}, \\ldots, x_{n}\\right)\\) is Shiny. Now, we have\n\n\\[\n\\sum_{i<j} x_{i} x_{j}=-\\frac{n-1}{2}+\\frac{(n-1)(n-2)}{2} t^{2}\n\\]\n\nThus, as \\(t\\) approaches 0 from above, \\(\\sum_{i<j} x_{i} x_{j}\\) gets arbitrarily close to \\(-(n-1) / 2\\). This shows that we may not take \\(K\\) any larger than \\(-(n-1) / 2\\). It remains to show that \\(\\sum_{i<j} x_{i} x_{j} \\geqslant\\) \\(-(n-1) / 2\\) for any Shiny choice of the \\(x_{i}\\).\n\nFrom now onward, assume that \\(\\left(x_{1}, \\ldots, x_{n}\\right)\\) is a Shiny \\(n\\)-tuple. Let the \\(z_{i}(1 \\leqslant i \\leqslant n)\\) be some permutation of the \\(x_{i}\\) to be chosen later. The indices for \\(z_{i}\\) will always be taken modulo \\(n\\). We will first split up the sum \\(\\sum_{i<j} x_{i} x_{j}=\\sum_{i<j} z_{i} z_{j}\\) into \\(\\lfloor(n-1) / 2\\rfloor\\) expressions, each of the form \\(y_{1} y_{2}+\\cdots+y_{n-1} y_{n}\\) for some permutation \\(y_{i}\\) of the \\(z_{i}\\), and some leftover terms. More specifically, write\n\n\\[\n\\sum_{i<j} z_{i} z_{j}=\\sum_{q=0}^{n-1} \\sum_{\\substack{i+j \\equiv q(\\bmod n) \\\\ i \\neq j}} z_{i} z_{j}=\\sum_{p=1}^{\\left\\lfloor\\frac{n-1}{2}\\right\\rfloor} \\sum_{\\substack{i+j \\equiv 2 p-1,2 p(\\bmod n) \\\\ i \\neq j(\\bmod n)}} z_{i} z_{j}+L\n\\]\n\nwhere \\(L=z_{1} z_{-1}+z_{2} z_{-2}+\\cdots+z_{(n-1) / 2} z_{-(n-1) / 2}\\) if \\(n\\) is odd, and \\(L=z_{1} z_{-1}+z_{1} z_{-2}+z_{2} z_{-2}+\\) \\(\\cdots+z_{(n-2) / 2} z_{-n / 2}\\) if \\(n\\) is even. We note that for each \\(p=1,2, \\ldots,\\lfloor(n-1) / 2\\rfloor\\), there is some permutation \\(y_{i}\\) of the \\(z_{i}\\) such that\n\n\\[\n\\sum_{\\substack{i+j \\equiv 2 p-1,2 p(\\bmod n) \\\\ i \\neq j(\\bmod n)}} z_{i} z_{j}=\\sum_{k=1}^{n-1} y_{k} y_{k+1}\n\\]\n\nbecause we may choose \\(y_{2 i-1}=z_{i+p-1}\\) for \\(1 \\leqslant i \\leqslant(n+1) / 2\\) and \\(y_{2 i}=z_{p-i}\\) for \\(1 \\leqslant i \\leqslant n / 2\\).\nWe show (1) graphically for \\(n=6,7\\) in the diagrams below. The edges of the graphs each represent a product \\(z_{i} z_{j}\\), and the dashed and dotted series of lines represents the sum of the edges, which is of the form \\(y_{1} y_{2}+\\cdots+y_{n-1} y_{n}\\) for some permutation \\(y_{i}\\) of the \\(z_{i}\\) precisely when the series of lines is a Hamiltonian path. The filled edges represent the summands of \\(L\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c0af87966e053f440e8cg-24}\n\nNow, because the \\(z_{i}\\) are Shiny, we have that (1) yields the following bound:\n\n\\[\n\\sum_{i<j} z_{i} z_{j} \\geqslant-\\left\\lfloor\\frac{n-1}{2}\\right\\rfloor+L .\n\\]\n\nIt remains to show that, for each \\(n\\), there exists some permutation \\(z_{i}\\) of the \\(x_{i}\\) such that \\(L \\geqslant 0\\) when \\(n\\) is odd, and \\(L \\geqslant-1 / 2\\) when \\(n\\) is even. We now split into cases based on the parity of \\(n\\) and provide constructions of the permutations \\(z_{i}\\).\n\nSince we have not made any assumptions yet about the \\(x_{i}\\), we may now assume without loss of generality that\n\n\\[\nx_{1} \\leqslant x_{2} \\leqslant \\cdots \\leqslant x_{k} \\leqslant 0 \\leqslant x_{k+1} \\leqslant \\cdots \\leqslant x_{n} .\n\\]"}
{"id": "imo-shortlist-2017-c1", "question": "C1. A rectangle \\(\\mathcal{R}\\) with odd integer side lengths is divided into small rectangles with integer side lengths. Prove that there is at least one among the small rectangles whose distances from the four sides of \\(\\mathcal{R}\\) are either all odd or all even.\n(Singapore)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2017, "solution": "Let the width and height of \\(\\mathcal{R}\\) be odd numbers \\(a\\) and \\(b\\). Divide \\(\\mathcal{R}\\) into \\(a b\\) unit squares and color them green and yellow in a checkered pattern. Since the side lengths of \\(a\\) and \\(b\\) are odd, the corner squares of \\(\\mathcal{R}\\) will all have the same color, say green.\n\nCall a rectangle (either \\(\\mathcal{R}\\) or a small rectangle) green if its corners are all green; call it yellow if the corners are all yellow, and call it mixed if it has both green and yellow corners. In particular, \\(\\mathcal{R}\\) is a green rectangle.\n\nWe will use the following trivial observations.\n\n\\begin{itemize}\n  \\item Every mixed rectangle contains the same number of green and yellow squares;\n  \\item Every green rectangle contains one more green square than yellow square;\n  \\item Every yellow rectangle contains one more yellow square than green square.\n\n\nThe rectangle \\(\\mathcal{R}\\) is green, so it contains more green unit squares than yellow unit squares. Therefore, among the small rectangles, at least one is green. Let \\(\\mathcal{S}\\) be such a small green rectangle, and let its distances from the sides of \\(\\mathcal{R}\\) be \\(x, y, u\\) and \\(v\\), as shown in the picture. The top-left corner of \\(\\mathcal{R}\\) and the top-left corner of \\(\\mathcal{S}\\) have the same color, which happen if and only if \\(x\\) and \\(u\\) have the same parity. Similarly, the other three green corners of \\(\\mathcal{S}\\) indicate that \\(x\\) and \\(v\\) have the same parity, \\(y\\) and \\(u\\) have the same parity, i.e. \\(x, y, u\\) and \\(v\\) are all odd or all even.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c0af87966e053f440e8cg-36}"}
{"id": "imo-shortlist-2017-c2", "question": "C2. Let \\(n\\) be a positive integer. Define a chameleon to be any sequence of \\(3 n\\) letters, with exactly \\(n\\) occurrences of each of the letters \\(a, b\\), and \\(c\\). Define a swap to be the transposition of two adjacent letters in a chameleon. Prove that for any chameleon \\(X\\), there exists a chameleon \\(Y\\) such that \\(X\\) cannot be changed to \\(Y\\) using fewer than \\(3 n^{2} / 2\\) swaps.\n(Australia)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2017, "solution": "To start, notice that the swap of two identical letters does not change a chameleon, so we may assume there are no such swaps.\n\nFor any two chameleons \\(X\\) and \\(Y\\), define their distance \\(d(X, Y)\\) to be the minimal number of swaps needed to transform \\(X\\) into \\(Y\\) (or vice versa). Clearly, \\(d(X, Y)+d(Y, Z) \\geqslant d(X, Z)\\) for any three chameleons \\(X, Y\\), and \\(Z\\).\nLemma. Consider two chameleons\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c0af87966e053f440e8cg-37}\n\nThen \\(d(P, Q) \\geqslant 3 n^{2}\\).\nProof. For any chameleon \\(X\\) and any pair of distinct letters \\(u, v \\in\\{a, b, c\\}\\), we define \\(f_{u, v}(X)\\) to be the number of pairs of positions in \\(X\\) such that the left one is occupied by \\(u\\), and the right one is occupied by \\(v\\). Define \\(f(X)=f_{a, b}(X)+f_{a, c}(X)+f_{b, c}(X)\\). Notice that \\(f_{a, b}(P)=f_{a, c}(P)=f_{b, c}(P)=n^{2}\\) and \\(f_{a, b}(Q)=f_{a, c}(Q)=f_{b, c}(Q)=0\\), so \\(f(P)=3 n^{2}\\) and \\(f(Q)=0\\).\n\nNow consider some swap changing a chameleon \\(X\\) to \\(X^{\\prime}\\); say, the letters \\(a\\) and \\(b\\) are swapped. Then \\(f_{a, b}(X)\\) and \\(f_{a, b}\\left(X^{\\prime}\\right)\\) differ by exactly 1 , while \\(f_{a, c}(X)=f_{a, c}\\left(X^{\\prime}\\right)\\) and \\(f_{b, c}(X)=f_{b, c}\\left(X^{\\prime}\\right)\\). This yields \\(\\left|f(X)-f\\left(X^{\\prime}\\right)\\right|=1\\), i.e., on any swap the value of \\(f\\) changes by 1 . Hence \\(d(X, Y) \\geqslant\\) \\(|f(X)-f(Y)|\\) for any two chameleons \\(X\\) and \\(Y\\). In particular, \\(d(P, Q) \\geqslant|f(P)-f(Q)|=3 n^{2}\\), as desired.\n\nBack to the problem, take any chameleon \\(X\\) and notice that \\(d(X, P)+d(X, Q) \\geqslant d(P, Q) \\geqslant\\) \\(3 n^{2}\\) by the lemma. Consequently, \\(\\max \\{d(X, P), d(X, Q)\\} \\geqslant \\frac{3 n^{2}}{2}\\), which establishes the problem statement.\n\nComment 1. The problem may be reformulated in a graph language. Construct a graph \\(G\\) with the chameleons as vertices, two vertices being connected with an edge if and only if these chameleons differ by a single swap. Then \\(d(X, Y)\\) is the usual distance between the vertices \\(X\\) and \\(Y\\) in this graph. Recall that the radius of a connected graph \\(G\\) is defined as\n\n\\[\nr(G)=\\min _{v \\in V} \\max _{u \\in V} d(u, v)\n\\]\n\nSo we need to prove that the radius of the constructed graph is at least \\(3 n^{2} / 2\\).\nIt is well-known that the radius of any connected graph is at least the half of its diameter (which is simply \\(\\max _{u, v \\in V} d(u, v)\\) ). Exactly this fact has been used above in order to finish the solution.\n\nSolution 2. We use the notion of distance from Solution 1, but provide a different lower bound for it.\n\nIn any chameleon \\(X\\), we enumerate the positions in it from left to right by \\(1,2, \\ldots, 3 n\\). Define \\(s_{c}(X)\\) as the sum of positions occupied by \\(c\\). The value of \\(s_{c}\\) changes by at most 1 on each swap, but this fact alone does not suffice to solve the problem; so we need an improvement.\n\nFor every chameleon \\(X\\), denote by \\(X_{\\bar{c}}\\) the sequence obtained from \\(X\\) by removing all \\(n\\) letters \\(c\\). Enumerate the positions in \\(X_{\\bar{c}}\\) from left to right by \\(1,2, \\ldots, 2 n\\), and define \\(s_{\\bar{c}, b}(X)\\) as the sum of positions in \\(X_{\\bar{c}}\\) occupied by \\(b\\). (In other words, here we consider the positions of the \\(b\\) 's relatively to the \\(a\\) 's only.) Finally, denote\n\n\\[\nd^{\\prime}(X, Y):=\\left|s_{c}(X)-s_{c}(Y)\\right|+\\left|s_{\\bar{c}, b}(X)-s_{\\bar{c}, b}(Y)\\right| .\n\\]\n\nNow consider any swap changing a chameleon \\(X\\) to \\(X^{\\prime}\\). If no letter \\(c\\) is involved into this swap, then \\(s_{c}(X)=s_{c}\\left(X^{\\prime}\\right)\\); on the other hand, exactly one letter \\(b\\) changes its position in \\(X_{\\bar{c}}\\), so \\(\\left|s_{\\bar{c}, b}(X)-s_{\\bar{c}, b}\\left(X^{\\prime}\\right)\\right|=1\\). If a letter \\(c\\) is involved into a swap, then \\(X_{\\bar{c}}=X_{\\bar{c}}^{\\prime}\\), so \\(s_{\\bar{c}, b}(X)=s_{\\bar{c}, b}\\left(X^{\\prime}\\right)\\) and \\(\\left|s_{c}(X)-s_{c}\\left(X^{\\prime}\\right)\\right|=1\\). Thus, in all cases we have \\(d^{\\prime}\\left(X, X^{\\prime}\\right)=1\\).\n\nAs in the previous solution, this means that \\(d(X, Y) \\geqslant d^{\\prime}(X, Y)\\) for any two chameleons \\(X\\) and \\(Y\\). Now, for any chameleon \\(X\\) we will indicate a chameleon \\(Y\\) with \\(d^{\\prime}(X, Y) \\geqslant 3 n^{2} / 2\\), thus finishing the solution.\n\nThe function \\(s_{c}\\) attains all integer values from \\(1+\\cdots+n=\\frac{n(n+1)}{2}\\) to \\((2 n+1)+\\cdots+3 n=\\) \\(2 n^{2}+\\frac{n(n+1)}{2}\\). If \\(s_{c}(X) \\leqslant n^{2}+\\frac{n(n+1)}{2}\\), then we put the letter \\(c\\) into the last \\(n\\) positions in \\(Y\\); otherwise we put the letter \\(c\\) into the first \\(n\\) positions in \\(Y\\). In either case we already have \\(\\left|s_{c}(X)-s_{c}(Y)\\right| \\geqslant n^{2}\\).\n\nSimilarly, \\(s_{\\bar{c}, b}\\) ranges from \\(\\frac{n(n+1)}{2}\\) to \\(n^{2}+\\frac{n(n+1)}{2}\\). So, if \\(s_{\\bar{c}, b}(X) \\leqslant \\frac{n^{2}}{2}+\\frac{n(n+1)}{2}\\), then we put the letter \\(b\\) into the last \\(n\\) positions in \\(Y\\) which are still free; otherwise, we put the letter \\(b\\) into the first \\(n\\) such positions. The remaining positions are occupied by \\(a\\). In any case, we have \\(\\left|s_{\\bar{c}, b}(X)-s_{\\bar{c}, b}(Y)\\right| \\geqslant \\frac{n^{2}}{2}\\), thus \\(d^{\\prime}(X, Y) \\geqslant n^{2}+\\frac{n^{2}}{2}=\\frac{3 n^{2}}{2}\\), as desired.\n\nComment 2. The two solutions above used two lower bounds \\(|f(X)-f(Y)|\\) and \\(d^{\\prime}(X, Y)\\) for the number \\(d(X, Y)\\). One may see that these bounds are closely related to each other, as\n\n\\[\nf_{a, c}(X)+f_{b, c}(X)=s_{c}(X)-\\frac{n(n+1)}{2} \\quad \\text { and } \\quad f_{a, b}(X)=s_{\\bar{c}, b}(X)-\\frac{n(n+1)}{2} .\n\\]\n\nOne can see that, e.g., the bound \\(d^{\\prime}(X, Y)\\) could as well be used in the proof of the lemma in Solution 1.\nLet us describe here an even sharper bound which also can be used in different versions of the solutions above.\n\nIn each chameleon \\(X\\), enumerate the occurrences of \\(a\\) from the left to the right as \\(a_{1}, a_{2}, \\ldots, a_{n}\\). Since we got rid of swaps of identical letters, the relative order of these letters remains the same during the swaps. Perform the same operation with the other letters, obtaining new letters \\(b_{1}, \\ldots, b_{n}\\) and \\(c_{1}, \\ldots, c_{n}\\). Denote by \\(A\\) the set of the \\(3 n\\) obtained letters.\n\nSince all \\(3 n\\) letters became different, for any chameleon \\(X\\) and any \\(s \\in A\\) we may define the position \\(N_{s}(X)\\) of \\(s\\) in \\(X\\) (thus \\(1 \\leqslant N_{s}(X) \\leqslant 3 n\\) ). Now, for any two chameleons \\(X\\) and \\(Y\\) we say that a pair of letters ( \\(s, t\\) ) \\(\\in A \\times A\\) is an ( \\(X, Y\\) )-inversion if \\(N_{s}(X)<N_{t}(X)\\) but \\(N_{s}(Y)>N_{t}(Y)\\), and define \\(d^{*}(X, Y)\\) to be the number of ( \\(X, Y\\) )-inversions. Then for any two chameleons \\(Y\\) and \\(Y^{\\prime}\\) differing by a single swap, we have \\(\\left|d^{*}(X, Y)-d^{*}\\left(X, Y^{\\prime}\\right)\\right|=1\\). Since \\(d^{*}(X, X)=0\\), this yields \\(d(X, Y) \\geqslant d^{*}(X, Y)\\) for any pair of chameleons \\(X\\) and \\(Y\\). The bound \\(d^{*}\\) may also be used in both Solution 1 and Solution 2.\n\nComment 3. In fact, one may prove that the distance \\(d^{*}\\) defined in the previous comment coincides with \\(d\\). Indeed, if \\(X \\neq Y\\), then there exist an ( \\(X, Y\\) )-inversion ( \\(s, t\\) ). One can show that such \\(s\\) and \\(t\\) may be chosen to occupy consecutive positions in \\(Y\\). Clearly, \\(s\\) and \\(t\\) correspond to different letters among \\(\\{a, b, c\\}\\). So, swapping them in \\(Y\\) we get another chameleon \\(Y^{\\prime}\\) with \\(d^{*}\\left(X, Y^{\\prime}\\right)=d^{*}(X, Y)-1\\). Proceeding in this manner, we may change \\(Y\\) to \\(X\\) in \\(d^{*}(X, Y)\\) steps.\n\nUsing this fact, one can show that the estimate in the problem statement is sharp for all \\(n \\geqslant 2\\). (For \\(n=1\\) it is not sharp, since any permutation of three letters can be changed to an opposite one in no less than three swaps.) We outline the proof below.\n\nFor any \\(k \\geqslant 0\\), define\n\n\\[\nX_{2 k}=\\underbrace{a b c a b c \\ldots a b c}_{3 k \\text { letters }} \\underbrace{c b a c b a \\ldots c b a}_{3 k \\text { letters }} \\text { and } X_{2 k+3}=\\underbrace{a b c a b c \\ldots a b c}_{3 k \\text { letters }} a b c b c a c a b \\underbrace{c b a c b a \\ldots c b a}_{3 k \\text { letters }} .\n\\]\n\nWe claim that for every \\(n \\geqslant 2\\) and every chameleon \\(Y\\), we have \\(d^{*}\\left(X_{n}, Y\\right) \\leqslant\\left\\lceil 3 n^{2} / 2\\right\\rceil\\). This will mean that for every \\(n \\geqslant 2\\) the number \\(3 n^{2} / 2\\) in the problem statement cannot be changed by any number larger than \\(\\left\\lceil 3 n^{2} / 2\\right\\rceil\\).\n\nFor any distinct letters \\(u, v \\in\\{a, b, c\\}\\) and any two chameleons \\(X\\) and \\(Y\\), we define \\(d_{u, v}^{*}(X, Y)\\) as the number of ( \\(X, Y\\) )-inversions ( \\(s, t\\) ) such that \\(s\\) and \\(t\\) are instances of \\(u\\) and \\(v\\) (in any of the two possible orders). Then \\(d^{*}(X, Y)=d_{a, b}^{*}(X, Y)+d_{b, c}^{*}(X, Y)+d_{c, a}^{*}(X, Y)\\).\n\nWe start with the case when \\(n=2 k\\) is even; denote \\(X=X_{2 k}\\). We show that \\(d_{a, b}^{*}(X, Y) \\leqslant 2 k^{2}\\) for any chameleon \\(Y\\); this yields the required estimate. Proceed by the induction on \\(k\\) with the trivial base case \\(k=0\\). To perform the induction step, notice that \\(d_{a, b}^{*}(X, Y)\\) is indeed the minimal number of swaps needed to change \\(Y_{\\bar{c}}\\) into \\(X_{\\bar{c}}\\). One may show that moving \\(a_{1}\\) and \\(a_{2 k}\\) in \\(Y\\) onto the first and the last positions in \\(Y\\), respectively, takes at most \\(2 k\\) swaps, and that subsequent moving \\(b_{1}\\) and \\(b_{2 k}\\) onto the second and the second last positions takes at most \\(2 k-2\\) swaps. After performing that, one may delete these letters from both \\(X_{\\bar{c}}\\) and \\(Y_{\\bar{c}}\\) and apply the induction hypothesis; so \\(X_{\\bar{c}}\\) can be obtained from \\(Y_{\\bar{c}}\\) using at most \\(2(k-1)^{2}+2 k+(2 k-2)=2 k^{2}\\) swaps, as required.\n\nIf \\(n=2 k+3\\) is odd, the proof is similar but more technically involved. Namely, we claim that \\(d_{a, b}^{*}\\left(X_{2 k+3}, Y\\right) \\leqslant 2 k^{2}+6 k+5\\) for any chameleon \\(Y\\), and that the equality is achieved only if \\(Y_{\\bar{c}}=\\) \\(b b \\ldots b a a \\ldots a\\). The proof proceeds by a similar induction, with some care taken of the base case, as well as of extracting the equality case. Similar estimates hold for \\(d_{b, c}^{*}\\) and \\(d_{c, a}^{*}\\). Summing three such estimates, we obtain\n\n\\[\nd^{*}\\left(X_{2 k+3}, Y\\right) \\leqslant 3\\left(2 k^{2}+6 k+5\\right)=\\left\\lceil\\frac{3 n^{2}}{2}\\right\\rceil+1\n\\]\n\nwhich is by 1 more than we need. But the equality could be achieved only if \\(Y_{\\bar{c}}=b b \\ldots b a a \\ldots a\\) and, similarly, \\(Y_{\\bar{b}}=a a \\ldots a c c \\ldots c\\) and \\(Y_{\\bar{a}}=c c \\ldots c b b \\ldots b\\). Since these three equalities cannot hold simultaneously, the proof is finished."}
{"id": "imo-shortlist-2017-c3", "question": "C3. Sir Alex plays the following game on a row of 9 cells. Initially, all cells are empty. In each move, Sir Alex is allowed to perform exactly one of the following two operations:\n(1) Choose any number of the form \\(2^{j}\\), where \\(j\\) is a non-negative integer, and put it into an empty cell.\n(2) Choose two (not necessarily adjacent) cells with the same number in them; denote that number by \\(2^{j}\\). Replace the number in one of the cells with \\(2^{j+1}\\) and erase the number in the other cell.\n\nAt the end of the game, one cell contains the number \\(2^{n}\\), where \\(n\\) is a given positive integer, while the other cells are empty. Determine the maximum number of moves that Sir Alex could have made, in terms of \\(n\\).\n(Thailand)\nAnswer: \\(2 \\sum_{j=0}^{8}\\binom{n}{j}-1\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2017, "solution": "We will solve a more general problem, replacing the row of 9 cells with a row of \\(k\\) cells, where \\(k\\) is a positive integer. Denote by \\(m(n, k)\\) the maximum possible number of moves Sir Alex can make starting with a row of \\(k\\) empty cells, and ending with one cell containing the number \\(2^{n}\\) and all the other \\(k-1\\) cells empty. Call an operation of type (1) an insertion, and an operation of type (2) a merge.\n\nOnly one move is possible when \\(k=1\\), so we have \\(m(n, 1)=1\\). From now on we consider \\(k \\geqslant 2\\), and we may assume Sir Alex's last move was a merge. Then, just before the last move, there were exactly two cells with the number \\(2^{n-1}\\), and the other \\(k-2\\) cells were empty.\n\nPaint one of those numbers \\(2^{n-1}\\) blue, and the other one red. Now trace back Sir Alex's moves, always painting the numbers blue or red following this rule: if \\(a\\) and \\(b\\) merge into \\(c\\), paint \\(a\\) and \\(b\\) with the same color as \\(c\\). Notice that in this backward process new numbers are produced only by reversing merges, since reversing an insertion simply means deleting one of the numbers. Therefore, all numbers appearing in the whole process will receive one of the two colors.\n\nSir Alex's first move is an insertion. Without loss of generality, assume this first number inserted is blue. Then, from this point on, until the last move, there is always at least one cell with a blue number.\n\nBesides the last move, there is no move involving a blue and a red number, since all merges involves numbers with the same color, and insertions involve only one number. Call an insertion of a blue number or merge of two blue numbers a blue move, and define a red move analogously.\n\nThe whole sequence of blue moves could be repeated on another row of \\(k\\) cells to produce one cell with the number \\(2^{n-1}\\) and all the others empty, so there are at most \\(m(n-1, k)\\) blue moves.\n\nNow we look at the red moves. Since every time we perform a red move there is at least one cell occupied with a blue number, the whole sequence of red moves could be repeated on a row of \\(k-1\\) cells to produce one cell with the number \\(2^{n-1}\\) and all the others empty, so there are at most \\(m(n-1, k-1)\\) red moves. This proves that\n\n\\[\nm(n, k) \\leqslant m(n-1, k)+m(n-1, k-1)+1\n\\]\n\nOn the other hand, we can start with an empty row of \\(k\\) cells and perform \\(m(n-1, k)\\) moves to produce one cell with the number \\(2^{n-1}\\) and all the others empty, and after that perform \\(m(n-1, k-1)\\) moves on those \\(k-1\\) empty cells to produce the number \\(2^{n-1}\\) in one of them, leaving \\(k-2\\) empty. With one more merge we get one cell with \\(2^{n}\\) and the others empty, proving that\n\n\\[\nm(n, k) \\geqslant m(n-1, k)+m(n-1, k-1)+1\n\\]\n\nIt follows that\n\n\\[\nm(n, k)=m(n-1, k)+m(n-1, k-1)+1,\n\\]\n\nfor \\(n \\geqslant 1\\) and \\(k \\geqslant 2\\).\nIf \\(k=1\\) or \\(n=0\\), we must insert \\(2^{n}\\) on our first move and immediately get the final configuration, so \\(m(0, k)=1\\) and \\(m(n, 1)=1\\), for \\(n \\geqslant 0\\) and \\(k \\geqslant 1\\). These initial values, together with the recurrence relation (1), determine \\(m(n, k)\\) uniquely.\n\nFinally, we show that\n\n\\[\nm(n, k)=2 \\sum_{j=0}^{k-1}\\binom{n}{j}-1,\n\\]\n\nfor all integers \\(n \\geqslant 0\\) and \\(k \\geqslant 1\\).\nWe use induction on \\(n\\). Since \\(m(0, k)=1\\) for \\(k \\geqslant 1\\), (2) is true for the base case. We make the induction hypothesis that (2) is true for some fixed positive integer \\(n\\) and all \\(k \\geqslant 1\\). We have \\(m(n+1,1)=1=2\\binom{n+1}{0}-1\\), and for \\(k \\geqslant 2\\) the recurrence relation (1) and the induction hypothesis give us\n\n\\[\n\\begin{aligned}\n& m(n+1, k)=m(n, k)+m(n, k-1)+1=2 \\sum_{j=0}^{k-1}\\binom{n}{j}-1+2 \\sum_{j=0}^{k-2}\\binom{n}{j}-1+1 \n& \\quad=2 \\sum_{j=0}^{k-1}\\binom{n}{j}+2 \\sum_{j=0}^{k-1}\\binom{n}{j-1}-1=2 \\sum_{j=0}^{k-1}\\left(\\binom{n}{j}+\\binom{n}{j-1}\\right)-1=2 \\sum_{j=0}^{k-1}\\binom{n+1}{j}-1,\n\n\\]\n\nwhich completes the proof.\n\nComment 1. After deducing the recurrence relation (1), it may be convenient to homogenize the recurrence relation by defining \\(h(n, k)=m(n, k)+1\\). We get the new relation\n\n\\[\nh(n, k)=h(n-1, k)+h(n-1, k),\n\\]\n\nfor \\(n \\geqslant 1\\) and \\(k \\geqslant 2\\), with initial values \\(h(0, k)=h(n, 1)=2\\), for \\(n \\geqslant 0\\) and \\(k \\geqslant 1\\).\nThis may help one to guess the answer, and also with other approaches like the one we develop next.\n\nComment 2. We can use a generating function to find the answer without guessing. We work with the homogenized recurrence relation (3). Define \\(h(n, 0)=0\\) so that (3) is valid for \\(k=1\\) as well. Now we set up the generating function \\(f(x, y)=\\sum_{n, k \\geqslant 0} h(n, k) x^{n} y^{k}\\). Multiplying the recurrence relation (3) by \\(x^{n} y^{k}\\) and summing over \\(n, k \\geqslant 1\\), we get\n\n\\[\n\\sum_{n, k \\geqslant 1} h(n, k) x^{n} y^{k}=x \\sum_{n, k \\geqslant 1} h(n-1, k) x^{n-1} y^{k}+x y \\sum_{n, k \\geqslant 1} h(n-1, k-1) x^{n-1} y^{k-1} .\n\\]\n\nCompleting the missing terms leads to the following equation on \\(f(x, y)\\) :\n\n\\[\nf(x, y)-\\sum_{n \\geqslant 0} h(n, 0) x^{n}-\\sum_{k \\geqslant 1} h(0, k) y^{k}=x f(x, y)-x \\sum_{n \\geqslant 0} h(n, 0) x^{n}+x y f(x, y) .\n\\]\n\nSubstituting the initial values, we obtain\n\n\\[\nf(x, y)=\\frac{2 y}{1-y} \\cdot \\frac{1}{1-x(1+y)} .\n\\]\n\nDeveloping as a power series, we get\n\n\\[\nf(x, y)=2 \\sum_{j \\geqslant 1} y^{j} \\cdot \\sum_{n \\geqslant 0}(1+y)^{n} x^{n}\n\\]\n\nThe coefficient of \\(x^{n}\\) in this power series is\n\n\\[\n2 \\sum_{j \\geqslant 1} y^{j} \\cdot(1+y)^{n}=2 \\sum_{j \\geqslant 1} y^{j} \\cdot \\sum_{i \\geqslant 0}\\binom{n}{i} y^{i}\n\\]\n\nand extracting the coefficient of \\(y^{k}\\) in this last expression we finally obtain the value for \\(h(n, k)\\),\n\n\\[\nh(n, k)=2 \\sum_{j=0}^{k-1}\\binom{n}{j}\n\\]\n\nThis proves that\n\n\\[\nm(n, k)=2 \\sum_{j=0}^{k-1}\\binom{n}{j}-1\n\\]\n\nThe generating function approach also works if applied to the non-homogeneous recurrence relation (1), but the computations are less straightforward.\n\nSolution 2. Define merges and insertions as in Solution 1. After each move made by Sir Alex we compute the number \\(N\\) of empty cells, and the sum \\(S\\) of all the numbers written in the cells. Insertions always increase \\(S\\) by some power of 2 , and increase \\(N\\) exactly by 1 . Merges do not change \\(S\\) and decrease \\(N\\) exactly by 1 . Since the initial value of \\(N\\) is 0 and its final value is 1 , the total number of insertions exceeds that of merges by exactly one. So, to maximize the number of moves, we need to maximize the number of insertions.\n\nWe will need the following lemma.\nLemma. If the binary representation of a positive integer \\(A\\) has \\(d\\) nonzero digits, then \\(A\\) cannot be represented as a sum of fewer than \\(d\\) powers of 2 . Moreover, any representation of \\(A\\) as a sum of \\(d\\) powers of 2 must coincide with its binary representation.\nProof. Let \\(s\\) be the minimum number of summands in all possible representations of \\(A\\) as sum of powers of 2 . Suppose there is such a representation with \\(s\\) summands, where two of the summands are equal to each other. Then, replacing those two summands with the result of their sum, we obtain a representation with fewer than \\(s\\) summands, which is a contradiction. We deduce that in any representation with \\(s\\) summands, the summands are all distinct, so any such representation must coincide with the unique binary representation of \\(A\\), and \\(s=d\\).\n\nNow we split the solution into a sequence of claims.\nClaim 1. After every move, the number \\(S\\) is the sum of at most \\(k-1\\) distinct powers of 2 .\nProof. If \\(S\\) is the sum of \\(k\\) (or more) distinct powers of 2 , the Lemma implies that the \\(k\\) cells are filled with these numbers. This is a contradiction since no more merges or insertions can be made.\n\nLet \\(A(n, k-1)\\) denote the set of all positive integers not exceeding \\(2^{n}\\) with at most \\(k-1\\) nonzero digits in its base 2 representation. Since every insertion increases the value of \\(S\\), by Claim 1, the total number of insertions is at most \\(|A(n, k-1)|\\). We proceed to prove that it is possible to achieve this number of insertions.\nClaim 2. Let \\(A(n, k-1)=\\left\\{a_{1}, a_{2}, \\ldots, a_{m}\\right\\}\\), with \\(a_{1}<a_{2}<\\cdots<a_{m}\\). If after some of Sir Alex's moves the value of \\(S\\) is \\(a_{j}\\), with \\(j \\in\\{1,2, \\ldots, m-1\\}\\), then there is a sequence of moves after which the value of \\(S\\) is exactly \\(a_{j+1}\\).\nProof. Suppose \\(S=a_{j}\\). Performing all possible merges, we eventually get different powers of 2 in all nonempty cells. After that, by Claim 1 there will be at least one empty cell, in which we want to insert \\(a_{j+1}-a_{j}\\). It remains to show that \\(a_{j+1}-a_{j}\\) is a power of 2 .\n\nFor this purpose, we notice that if \\(a_{j}\\) has less than \\(k-1\\) nonzero digits in base 2 then \\(a_{j+1}=a_{j}+1\\). Otherwise, we have \\(a_{j}=2^{b_{k-1}}+\\cdots+2^{b_{2}}+2^{b_{1}}\\) with \\(b_{1}<b_{2}<\\cdots<b_{k-1}\\). Then, adding any number less than \\(2^{b_{1}}\\) to \\(a_{j}\\) will result in a number with more than \\(k-1\\) nonzero\nbinary digits. On the other hand, \\(a_{j}+2^{b_{1}}\\) is a sum of \\(k\\) powers of 2 , not all distinct, so by the Lemma it will be a sum of less then \\(k\\) distinct powers of 2 . This means that \\(a_{j+1}-a_{j}=2^{b_{1}}\\), completing the proof.\n\nClaims 1 and 2 prove that the maximum number of insertions is \\(|A(n, k-1)|\\). We now compute this number.\nClaim 3. \\(|A(n, k-1)|=\\sum_{j=0}^{k-1}\\binom{n}{j}\\).\nProof. The number \\(2^{n}\\) is the only element of \\(A(n, k-1)\\) with \\(n+1\\) binary digits. Any other element has at most \\(n\\) binary digits, at least one and at most \\(k-1\\) of them are nonzero (so they are ones). For each \\(j \\in\\{1,2, \\ldots, k-1\\}\\), there are \\(\\binom{n}{j}\\) such elements with exactly \\(j\\) binary digits equal to one. We conclude that \\(|A(n, k-1)|=1+\\sum_{j=1}^{k-1}\\binom{n}{j}=\\sum_{j=0}^{k-1}\\binom{n}{j}\\).\n\nRecalling that the number of insertions exceeds that of merges by exactly 1 , we deduce that the maximum number of moves is \\(2 \\sum_{j=0}^{k-1}\\binom{n}{j}-1\\)."}
{"id": "imo-shortlist-2017-c4", "question": "C4. Let \\(N \\geqslant 2\\) be an integer. \\(N(N+1)\\) soccer players, no two of the same height, stand in a row in some order. Coach Ralph wants to remove \\(N(N-1)\\) people from this row so that in the remaining row of \\(2 N\\) players, no one stands between the two tallest ones, no one stands between the third and the fourth tallest ones, . . . and finally no one stands between the two shortest ones. Show that this is always possible.\n(Russia)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2017, "solution": "Split the row into \\(N\\) blocks with \\(N+1\\) consecutive people each. We will show how to remove \\(N-1\\) people from each block in order to satisfy the coach's wish.\n\nFirst, construct a \\((N+1) \\times N\\) matrix where \\(x_{i, j}\\) is the height of the \\(i^{\\text {th }}\\) tallest person of the \\(j^{\\text {th }}\\) block-in other words, each column lists the heights within a single block, sorted in decreasing order from top to bottom.\n\nWe will reorder this matrix by repeatedly swapping whole columns. First, by column permutation, make sure that \\(x_{2,1}=\\max \\left\\{x_{2, i}: i=1,2, \\ldots, N\\right\\}\\) (the first column contains the largest height of the second row). With the first column fixed, permute the other ones so that \\(x_{3,2}=\\max \\left\\{x_{3, i}: i=2, \\ldots, N\\right\\}\\) (the second column contains the tallest person of the third row, first column excluded). In short, at step \\(k(k=1,2, \\ldots, N-1)\\), we permute the columns from \\(k\\) to \\(N\\) so that \\(x_{k+1, k}=\\max \\left\\{x_{i, k}: i=k, k+1, \\ldots, N\\right\\}\\), and end up with an array like this:\n\n\\begin{center}\n\\begin{tabular}{|l|l|l|l|l|l|}\n\\hline\n\\(\\boldsymbol{x}_{\\mathbf{1}, \\mathbf{1}}\\) & \\(x_{1,2}\\) & \\(x_{1,3}\\) & \\(\\cdots\\) & \\(x_{1, N-1}\\) & \\(x_{1, N}\\) \n\\hline\nV & V & V &  & V & V \n\\hline\n\\(\\boldsymbol{x}_{\\mathbf{2 , 1}}\\) & > & \\(x_{2,3}\\) & \\(\\cdots\\) & \\(x_{2, N-1}\\) & \\(x_{2, N}\\) \n\\hline\nV & V & V &  & V & V \n\\hline\n\\(x_{3,1}\\) & \\(\\boldsymbol{x}_{\\mathbf{3 , 2}}\\) & > & \\(\\cdots\\) & \\(x_{3, N-1}\\) & \\(x_{3, N}\\) \n\\hline\nV & V & V &  & V & V \n\\hline\n\\(\\vdots\\) & \\(\\vdots\\) & \\(\\vdots\\) & \\(\\ddots\\) & \\(\\vdots\\) & \\(\\vdots\\) \n\\hline\nV & V & V &  & V & V \n\\hline\n\\(x_{N, 1}\\) & \\(x_{N, 2}\\) & \\(x_{N, 3}\\) & \\(\\cdots\\) & \\(\\boldsymbol{x}_{\\boldsymbol{N}, \\boldsymbol{N - 1}}>\\) & \\(\\boldsymbol{x}_{\\boldsymbol{N}, \\boldsymbol{N}}\\) \n\\hline\nV & V & V &  & V & V \n\\hline\n\\(x_{N+1,1}\\) & \\(x_{N+1,2}\\) & \\(x_{N+1,3}\\) & \\(\\cdots\\) & \\(x_{N+1, N-1}\\) & \\(\\boldsymbol{x}_{\\boldsymbol{N + 1 , N}}\\) \n\\hline\n\n\n\nNow we make the bold choice: from the original row of people, remove everyone but those with heights\n\n\\[\nx_{1,1}>x_{2,1}>x_{2,2}>x_{3,2}>\\cdots>x_{N, N-1}>x_{N, N}>x_{N+1, N}\n\\]\n\nOf course this height order (*) is not necessarily their spatial order in the new row. We now need to convince ourselves that each pair ( \\(x_{k, k} ; x_{k+1, k}\\) ) remains spatially together in this new row. But \\(x_{k, k}\\) and \\(x_{k+1, k}\\) belong to the same column/block of consecutive \\(N+1\\) people; the only people that could possibly stand between them were also in this block, and they are all gone.\n\nSolution 2. Split the people into \\(N\\) groups by height: group \\(G_{1}\\) has the \\(N+1\\) tallest ones, group \\(G_{2}\\) has the next \\(N+1\\) tallest, and so on, up to group \\(G_{N}\\) with the \\(N+1\\) shortest people.\n\nNow scan the original row from left to right, stopping as soon as you have scanned two people (consecutively or not) from the same group, say, \\(G_{i}\\). Since we have \\(N\\) groups, this must happen before or at the \\((N+1)^{\\text {th }}\\) person of the row. Choose this pair of people, removing all the other people from the same group \\(G_{i}\\) and also all people that have been scanned so far. The only people that could separate this pair's heights were in group \\(G_{i}\\) (and they are gone); the only people that could separate this pair's positions were already scanned (and they are gone too).\n\nWe are now left with \\(N-1\\) groups (all except \\(G_{i}\\) ). Since each of them lost at most one person, each one has at least \\(N\\) unscanned people left in the row. Repeat the scanning process from left to right, choosing the next two people from the same group, removing this group and\neveryone scanned up to that point. Once again we end up with two people who are next to each other in the remaining row and whose heights cannot be separated by anyone else who remains (since the rest of their group is gone). After picking these 2 pairs, we still have \\(N-2\\) groups with at least \\(N-1\\) people each.\n\nIf we repeat the scanning process a total of \\(N\\) times, it is easy to check that we will end up with 2 people from each group, for a total of \\(2 N\\) people remaining. The height order is guaranteed by the grouping, and the scanning construction from left to right guarantees that each pair from a group stand next to each other in the final row. We are done.\n\nSolution 3. This is essentially the same as solution 1, but presented inductively. The essence of the argument is the following lemma.\nLemma. Assume that we have \\(N\\) disjoint groups of at least \\(N+1\\) people in each, all people have distinct heights. Then one can choose two people from each group so that among the chosen people, the two tallest ones are in one group, the third and the fourth tallest ones are in one group, ..., and the two shortest ones are in one group.\nProof. Induction on \\(N \\geqslant 1\\); for \\(N=1\\), the statement is trivial.\nConsider now \\(N\\) groups \\(G_{1}, \\ldots, G_{N}\\) with at least \\(N+1\\) people in each for \\(N \\geqslant 2\\). Enumerate the people by \\(1,2, \\ldots, N(N+1)\\) according to their height, say, from tallest to shortest. Find the least \\(s\\) such that two people among \\(1,2, \\ldots, s\\) are in one group (without loss of generality, say this group is \\(G_{N}\\) ). By the minimality of \\(s\\), the two mentioned people in \\(G_{N}\\) are \\(s\\) and some \\(i<s\\).\n\nNow we choose people \\(i\\) and \\(s\\) in \\(G_{N}\\), forget about this group, and remove the people \\(1,2, \\ldots, s\\) from \\(G_{1}, \\ldots, G_{N-1}\\). Due to minimality of \\(s\\) again, each of the obtained groups \\(G_{1}^{\\prime}, \\ldots, G_{N-1}^{\\prime}\\) contains at least \\(N\\) people. By the induction hypothesis, one can choose a pair of people from each of \\(G_{1}^{\\prime}, \\ldots, G_{N-1}^{\\prime}\\) so as to satisfy the required conditions. Since all these people have numbers greater than \\(s\\), addition of the pair \\((s, i)\\) from \\(G_{N}\\) does not violate these requirements.\n\nTo solve the problem, it suffices now to split the row into \\(N\\) contiguous groups with \\(N+1\\) people in each and apply the Lemma to those groups.\n\nComment 1. One can identify each person with a pair of indices \\((p, h)(p, h \\in\\{1,2, \\ldots, N(N+1)\\})\\) so that the \\(p^{\\text {th }}\\) person in the row (say, from left to right) is the \\(h^{\\text {th }}\\) tallest person in the group. Say that ( \\(a, b\\) ) separates ( \\(x_{1}, y_{1}\\) ) and ( \\(x_{2}, y_{2}\\) ) whenever \\(a\\) is strictly between \\(x_{1}\\) and \\(y_{1}\\), or \\(b\\) is strictly between \\(x_{2}\\) and \\(y_{2}\\). So the coach wants to pick \\(2 N\\) people \\(\\left(p_{i}, h_{i}\\right)(i=1,2, \\ldots, 2 N)\\) such that no chosen person separates ( \\(p_{1}, h_{1}\\) ) from ( \\(p_{2}, h_{2}\\) ), no chosen person separates ( \\(p_{3}, h_{3}\\) ) and ( \\(p_{4}, h_{4}\\) ), and so on. This formulation reveals a duality between positions and heights. In that sense, solutions 1 and 2 are dual of each other.\n\nComment 2. The number \\(N(N+1)\\) is sharp for \\(N=2\\) and \\(N=3\\), due to arrangements \\(1,5,3,4,2\\) and \\(1,10,6,4,3,9,5,8,7,2,11\\)."}
{"id": "imo-shortlist-2017-c5", "question": "C5. A hunter and an invisible rabbit play a game in the Euclidean plane. The hunter's starting point \\(H_{0}\\) coincides with the rabbit's starting point \\(R_{0}\\). In the \\(n^{\\text {th }}\\) round of the game ( \\(n \\geqslant 1\\) ), the following happens.\n(1) First the invisible rabbit moves secretly and unobserved from its current point \\(R_{n-1}\\) to some new point \\(R_{n}\\) with \\(R_{n-1} R_{n}=1\\).\n(2) The hunter has a tracking device (e.g. dog) that returns an approximate position \\(R_{n}^{\\prime}\\) of the rabbit, so that \\(R_{n} R_{n}^{\\prime} \\leqslant 1\\).\n(3) The hunter then visibly moves from point \\(H_{n-1}\\) to a new point \\(H_{n}\\) with \\(H_{n-1} H_{n}=1\\).\n\nIs there a strategy for the hunter that guarantees that after \\(10^{9}\\) such rounds the distance between the hunter and the rabbit is below 100 ?\n(Austria)\nAnswer: There is no such strategy for the hunter. The rabbit \"wins\".", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2017, "solution": "If the answer were \"yes\", the hunter would have a strategy that would \"work\", no matter how the rabbit moved or where the radar pings \\(R_{n}^{\\prime}\\) appeared. We will show the opposite: with bad luck from the radar pings, there is no strategy for the hunter that guarantees that the distance stays below 100 in \\(10^{9}\\) rounds.\n\nSo, let \\(d_{n}\\) be the distance between the hunter and the rabbit after \\(n\\) rounds. Of course, if \\(d_{n} \\geqslant 100\\) for any \\(n<10^{9}\\), the rabbit has won - it just needs to move straight away from the hunter, and the distance will be kept at or above 100 thereon.\n\nWe will now show that, while \\(d_{n}<100\\), whatever given strategy the hunter follows, the rabbit has a way of increasing \\(d_{n}^{2}\\) by at least \\(\\frac{1}{2}\\) every 200 rounds (as long as the radar pings are lucky enough for the rabbit). This way, \\(d_{n}^{2}\\) will reach \\(10^{4}\\) in less than \\(2 \\cdot 10^{4} \\cdot 200=4 \\cdot 10^{6}<10^{9}\\) rounds, and the rabbit wins.\n\nSuppose the hunter is at \\(H_{n}\\) and the rabbit is at \\(R_{n}\\). Suppose even that the rabbit reveals its position at this moment to the hunter (this allows us to ignore all information from previous radar pings). Let \\(r\\) be the line \\(H_{n} R_{n}\\), and \\(Y_{1}\\) and \\(Y_{2}\\) be points which are 1 unit away from \\(r\\) and 200 units away from \\(R_{n}\\), as in the figure below.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c0af87966e053f440e8cg-46}\n\nThe rabbit's plan is simply to choose one of the points \\(Y_{1}\\) or \\(Y_{2}\\) and hop 200 rounds straight towards it. Since all hops stay within 1 distance unit from \\(r\\), it is possible that all radar pings stay on \\(r\\). In particular, in this case, the hunter has no way of knowing whether the rabbit chose \\(Y_{1}\\) or \\(Y_{2}\\).\n\nLooking at such pings, what is the hunter going to do? If the hunter's strategy tells him to go 200 rounds straight to the right, he ends up at point \\(H^{\\prime}\\) in the figure. Note that the hunter does not have a better alternative! Indeed, after these 200 rounds he will always end up at a point to the left of \\(H^{\\prime}\\). If his strategy took him to a point above \\(r\\), he would end up even further from \\(Y_{2}\\); and if his strategy took him below \\(r\\), he would end up even further from \\(Y_{1}\\). In other words, no matter what strategy the hunter follows, he can never be sure his distance to the rabbit will be less than \\(y \\stackrel{\\text { def }}{=} H^{\\prime} Y_{1}=H^{\\prime} Y_{2}\\) after these 200 rounds.\n\nTo estimate \\(y^{2}\\), we take \\(Z\\) as the midpoint of segment \\(Y_{1} Y_{2}\\), we take \\(R^{\\prime}\\) as a point 200 units to the right of \\(R_{n}\\) and we define \\(\\varepsilon=Z R^{\\prime}\\) (note that \\(H^{\\prime} R^{\\prime}=d_{n}\\) ). Then\n\n\\[\ny^{2}=1+\\left(H^{\\prime} Z\\right)^{2}=1+\\left(d_{n}-\\varepsilon\\right)^{2}\n\\]\n\nwhere\n\n\\[\n\\varepsilon=200-R_{n} Z=200-\\sqrt{200^{2}-1}=\\frac{1}{200+\\sqrt{200^{2}-1}}>\\frac{1}{400}\n\\]\n\nIn particular, \\(\\varepsilon^{2}+1=400 \\varepsilon\\), so\n\n\\[\ny^{2}=d_{n}^{2}-2 \\varepsilon d_{n}+\\varepsilon^{2}+1=d_{n}^{2}+\\varepsilon\\left(400-2 d_{n}\\right)\n\\]\n\nSince \\(\\varepsilon>\\frac{1}{400}\\) and we assumed \\(d_{n}<100\\), this shows that \\(y^{2}>d_{n}^{2}+\\frac{1}{2}\\). So, as we claimed, with this list of radar pings, no matter what the hunter does, the rabbit might achieve \\(d_{n+200}^{2}>d_{n}^{2}+\\frac{1}{2}\\). The wabbit wins.\n\nComment 1. Many different versions of the solution above can be found by replacing 200 with some other number \\(N\\) for the number of hops the rabbit takes between reveals. If this is done, we have:\n\n\\[\n\\varepsilon=N-\\sqrt{N^{2}-1}>\\frac{1}{N+\\sqrt{N^{2}-1}}>\\frac{1}{2 N}\n\\]\n\nand\n\n\\[\n\\varepsilon^{2}+1=2 N \\varepsilon\n\\]\n\nso, as long as \\(N>d_{n}\\), we would find\n\n\\[\ny^{2}=d_{n}^{2}+\\varepsilon\\left(2 N-2 d_{n}\\right)>d_{n}^{2}+\\frac{N-d_{n}}{N}\n\\]\n\nFor example, taking \\(N=101\\) is already enough-the squared distance increases by at least \\(\\frac{1}{101}\\) every 101 rounds, and \\(101^{2} \\cdot 10^{4}=1.0201 \\cdot 10^{8}<10^{9}\\) rounds are enough for the rabbit. If the statement is made sharper, some such versions might not work any longer.\n\nComment 2. The original statement asked whether the distance could be kept under \\(10^{10}\\) in \\(10^{100}\\) rounds."}
{"id": "imo-shortlist-2017-c6", "question": "C6. Let \\(n>1\\) be an integer. An \\(n \\times n \\times n\\) cube is composed of \\(n^{3}\\) unit cubes. Each unit cube is painted with one color. For each \\(n \\times n \\times 1\\) box consisting of \\(n^{2}\\) unit cubes (of any of the three possible orientations), we consider the set of the colors present in that box (each color is listed only once). This way, we get \\(3 n\\) sets of colors, split into three groups according to the orientation. It happens that for every set in any group, the same set appears in both of the other groups. Determine, in terms of \\(n\\), the maximal possible number of colors that are present.\n(Russia)\nAnswer: The maximal number is \\(\\frac{n(n+1)(2 n+1)}{6}\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2017, "solution": "Call a \\(n \\times n \\times 1\\) box an \\(x\\)-box, a \\(y\\)-box, or a \\(z\\)-box, according to the direction of its short side. Let \\(C\\) be the number of colors in a valid configuration. We start with the upper bound for \\(C\\).\n\nLet \\(\\mathcal{C}_{1}, \\mathcal{C}_{2}\\), and \\(\\mathcal{C}_{3}\\) be the sets of colors which appear in the big cube exactly once, exactly twice, and at least thrice, respectively. Let \\(M_{i}\\) be the set of unit cubes whose colors are in \\(\\mathcal{C}_{i}\\), and denote \\(n_{i}=\\left|M_{i}\\right|\\).\n\nConsider any \\(x\\)-box \\(X\\), and let \\(Y\\) and \\(Z\\) be a \\(y\\) - and a \\(z\\)-box containing the same set of colors as \\(X\\) does.\nClaim. \\(4\\left|X \\cap M_{1}\\right|+\\left|X \\cap M_{2}\\right| \\leqslant 3 n+1\\).\nProof. We distinguish two cases.\nCase 1: \\(X \\cap M_{1} \\neq \\varnothing\\).\nA cube from \\(X \\cap M_{1}\\) should appear in all three boxes \\(X, Y\\), and \\(Z\\), so it should lie in \\(X \\cap Y \\cap Z\\). Thus \\(X \\cap M_{1}=X \\cap Y \\cap Z\\) and \\(\\left|X \\cap M_{1}\\right|=1\\).\n\nConsider now the cubes in \\(X \\cap M_{2}\\). There are at most 2(n-1) of them lying in \\(X \\cap Y\\) or \\(X \\cap Z\\) (because the cube from \\(X \\cap Y \\cap Z\\) is in \\(M_{1}\\) ). Let \\(a\\) be some other cube from \\(X \\cap M_{2}\\). Recall that there is just one other cube \\(a^{\\prime}\\) sharing a color with \\(a\\). But both \\(Y\\) and \\(Z\\) should contain such cube, so \\(a^{\\prime} \\in Y \\cap Z\\) (but \\(a^{\\prime} \\notin X \\cap Y \\cap Z\\) ). The map \\(a \\mapsto a^{\\prime}\\) is clearly injective, so the number of cubes \\(a\\) we are interested in does not exceed \\(|(Y \\cap Z) \\backslash X|=n-1\\). Thus \\(\\left|X \\cap M_{2}\\right| \\leqslant 2(n-1)+(n-1)=3(n-1)\\), and hence \\(4\\left|X \\cap M_{1}\\right|+\\left|X \\cap M_{2}\\right| \\leqslant 4+3(n-1)=3 n+1\\).\nCase 2: \\(X \\cap M_{1}=\\varnothing\\).\nIn this case, the same argument applies with several changes. Indeed, \\(X \\cap M_{2}\\) contains at most \\(2 n-1\\) cubes from \\(X \\cap Y\\) or \\(X \\cap Z\\). Any other cube \\(a\\) in \\(X \\cap M_{2}\\) corresponds to some \\(a^{\\prime} \\in Y \\cap Z\\) (possibly with \\(a^{\\prime} \\in X\\) ), so there are at most \\(n\\) of them. All this results in \\(\\left|X \\cap M_{2}\\right| \\leqslant(2 n-1)+n=3 n-1\\), which is even better than we need (by the assumptions of our case).\n\nSumming up the inequalities from the Claim over all \\(x\\)-boxes \\(X\\), we obtain\n\n\\[\n4 n_{1}+n_{2} \\leqslant n(3 n+1)\n\\]\n\nObviously, we also have \\(n_{1}+n_{2}+n_{3}=n^{3}\\).\nNow we are prepared to estimate \\(C\\). Due to the definition of the \\(M_{i}\\), we have \\(n_{i} \\geqslant i\\left|\\mathcal{C}_{i}\\right|\\), so\n\n\\[\nC \\leqslant n_{1}+\\frac{n_{2}}{2}+\\frac{n_{3}}{3}=\\frac{n_{1}+n_{2}+n_{3}}{3}+\\frac{4 n_{1}+n_{2}}{6} \\leqslant \\frac{n^{3}}{3}+\\frac{3 n^{2}+n}{6}=\\frac{n(n+1)(2 n+1)}{6}\n\\]\n\nIt remains to present an example of an appropriate coloring in the above-mentioned number of colors. For each color, we present the set of all cubes of this color. These sets are:\n\n\\begin{enumerate}\n  \\item \\(n\\) singletons of the form \\(S_{i}=\\{(i, i, i)\\}\\) (with \\(1 \\leqslant i \\leqslant n\\) );\n  \\item 3( \\(\\begin{aligned} & n \\\\ & 2\\) ) doubletons of the forms \\(D_{i, j}^{1}=\\{(i, j, j),(j, i, i)\\}, D_{i, j}^{2}=\\{(j, i, j),(i, j, i)\\}\\), and \\(D_{i, j}^{3}=\\) \\(\\{(j, j, i),(i, i, j)\\}\\) (with \\(1 \\leqslant i<j \\leqslant n\\) );\n  \\item \\(2\\binom{n}{3}\\) triplets of the form \\(T_{i, j, k}=\\{(i, j, k),(j, k, i),(k, i, j)\\}\\) (with \\(1 \\leqslant i<j<k \\leqslant n\\) or \\(1 \\leqslant i<k<j \\leqslant n\\) ).\n\n\nOne may easily see that the \\(i^{\\text {th }}\\) boxes of each orientation contain the same set of colors, and that\n\n\\[\nn+\\frac{3 n(n-1)}{2}+\\frac{n(n-1)(n-2)}{3}=\\frac{n(n+1)(2 n+1)}{6}\n\\]\n\ncolors are used, as required.\nSolution 2. We will approach a new version of the original problem. In this new version, each cube may have a color, or be invisible (not both). Now we make sets of colors for each \\(n \\times n \\times 1\\) box as before (where \"invisible\" is not considered a color) and group them by orientation, also as before. Finally, we require that, for every non-empty set in any group, the same set must appear in the other 2 groups. What is the maximum number of colors present with these new requirements?\n\nLet us call strange a big \\(n \\times n \\times n\\) cube whose painting scheme satisfies the new requirements, and let \\(D\\) be the number of colors in a strange cube. Note that any cube that satisfies the original requirements is also strange, so \\(\\max (D)\\) is an upper bound for the original answer.\nClaim. \\(D \\leqslant \\frac{n(n+1)(2 n+1)}{6}\\).\nProof. The proof is by induction on \\(n\\). If \\(n=1\\), we must paint the cube with at most 1 color.\nNow, pick a \\(n \\times n \\times n\\) strange cube \\(A\\), where \\(n \\geqslant 2\\). If \\(A\\) is completely invisible, \\(D=0\\) and we are done. Otherwise, pick a non-empty set of colors \\(\\mathcal{S}\\) which corresponds to, say, the boxes \\(X, Y\\) and \\(Z\\) of different orientations.\n\nNow find all cubes in \\(A\\) whose colors are in \\(\\mathcal{S}\\) and make them invisible. Since \\(X, Y\\) and \\(Z\\) are now completely invisible, we can throw them away and focus on the remaining \\((n-1) \\times(n-1) \\times(n-1)\\) cube \\(B\\). The sets of colors in all the groups for \\(B\\) are the same as the sets for \\(A\\), removing exactly the colors in \\(\\mathcal{S}\\), and no others! Therefore, every nonempty set that appears in one group for \\(B\\) still shows up in all possible orientations (it is possible that an empty set of colors in \\(B\\) only matched \\(X, Y\\) or \\(Z\\) before these were thrown away, but remember we do not require empty sets to match anyway). In summary, \\(B\\) is also strange.\n\nBy the induction hypothesis, we may assume that \\(B\\) has at most \\(\\frac{(n-1) n(2 n-1)}{6}\\) colors. Since there were at most \\(n^{2}\\) different colors in \\(\\mathcal{S}\\), we have that \\(A\\) has at most \\(\\frac{(n-1) n(2 n-1)}{6}+n^{2}=\\) \\(\\frac{n(n+1)(2 n+1)}{6}\\) colors.\n\nFinally, the construction in the previous solution shows a painting scheme (with no invisible cubes) that reaches this maximum, so we are done."}
{"id": "imo-shortlist-2017-c7", "question": "C7. For any finite sets \\(X\\) and \\(Y\\) of positive integers, denote by \\(f_{X}(k)\\) the \\(k^{\\text {th }}\\) smallest positive integer not in \\(X\\), and let\n\n\\[\nX * Y=X \\cup\\left\\{f_{X}(y): y \\in Y\\right\\}\n\\]\n\nLet \\(A\\) be a set of \\(a>0\\) positive integers, and let \\(B\\) be a set of \\(b>0\\) positive integers. Prove that if \\(A * B=B * A\\), then\n\n\\[\n\\underbrace{A *(A * \\cdots *(A *(A * A)) \\ldots)}_{A \\text { appears } b \\text { times }}=\\underbrace{B *(B * \\cdots *(B *(B * B)) \\ldots)}_{B \\text { appears } a \\text { times }}\n\\]", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2017, "solution": "For any function \\(g: \\mathbb{Z}_{>0} \\rightarrow \\mathbb{Z}_{>0}\\) and any subset \\(X \\subset \\mathbb{Z}_{>0}\\), we define \\(g(X)=\\) \\(\\{g(x): x \\in X\\}\\). We have that the image of \\(f_{X}\\) is \\(f_{X}\\left(\\mathbb{Z}_{>0}\\right)=\\mathbb{Z}_{>0} \\backslash X\\). We now show a general lemma about the operation *, with the goal of showing that * is associative.\nLemma 1. Let \\(X\\) and \\(Y\\) be finite sets of positive integers. The functions \\(f_{X * Y}\\) and \\(f_{X} \\circ f_{Y}\\) are equal.\nProof. We have\n\\(f_{X * Y}\\left(\\mathbb{Z}_{>0}\\right)=\\mathbb{Z}_{>0} \\backslash(X * Y)=\\left(\\mathbb{Z}_{>0} \\backslash X\\right) \\backslash f_{X}(Y)=f_{X}\\left(\\mathbb{Z}_{>0}\\right) \\backslash f_{X}(Y)=f_{X}\\left(\\mathbb{Z}_{>0} \\backslash Y\\right)=f_{X}\\left(f_{Y}\\left(\\mathbb{Z}_{>0}\\right)\\right)\\).\nThus, the functions \\(f_{X * Y}\\) and \\(f_{X} \\circ f_{Y}\\) are strictly increasing functions with the same range. Because a strictly function is uniquely defined by its range, we have \\(f_{X * Y}=f_{X} \\circ f_{Y}\\).\n\nLemma 1 implies that * is associative, in the sense that \\((A * B) * C=A *(B * C)\\) for any finite sets \\(A, B\\), and \\(C\\) of positive integers. We prove the associativity by noting\n\n\\[\n\\begin{gathered}\n\\mathbb{Z}_{>0} \\backslash((A * B) * C)=f_{(A * B) * C}\\left(\\mathbb{Z}_{>0}\\right)=f_{A * B}\\left(f_{C}\\left(\\mathbb{Z}_{>0}\\right)\\right)=f_{A}\\left(f_{B}\\left(f_{C}\\left(\\mathbb{Z}_{>0}\\right)\\right)\\right) \n=f_{A}\\left(f_{B * C}\\left(\\mathbb{Z}_{>0}\\right)=f_{A *(B * C)}\\left(\\mathbb{Z}_{>0}\\right)=\\mathbb{Z}_{>0} \\backslash(A *(B * C))\\right.\n\n\\]\n\nIn light of the associativity of *, we may drop the parentheses when we write expressions like \\(A *(B * C)\\). We also introduce the notation\n\n\\[\nX^{* k}=\\underbrace{X *(X * \\cdots *(X *(X * X)) \\ldots)}_{X \\text { appears } k \\text { times }}\n\\]\n\nOur goal is then to show that \\(A * B=B * A\\) implies \\(A^{* b}=B^{* a}\\). We will do so via the following general lemma.\nLemma 2. Suppose that \\(X\\) and \\(Y\\) are finite sets of positive integers satisfying \\(X * Y=Y * X\\) and \\(|X|=|Y|\\). Then, we must have \\(X=Y\\).\nProof. Assume that \\(X\\) and \\(Y\\) are not equal. Let \\(s\\) be the largest number in exactly one of \\(X\\) and \\(Y\\). Without loss of generality, say that \\(s \\in X \\backslash Y\\). The number \\(f_{X}(s)\\) counts the \\(s^{\\text {th }}\\) number not in \\(X\\), which implies that\n\n\\[\nf_{X}(s)=s+\\left|X \\cap\\left\\{1,2, \\ldots, f_{X}(s)\\right\\}\\right|\n\\]\n\nSince \\(f_{X}(s) \\geqslant s\\), we have that\n\n\\[\n\\left\\{f_{X}(s)+1, f_{X}(s)+2, \\ldots\\right\\} \\cap X=\\left\\{f_{X}(s)+1, f_{X}(s)+2, \\ldots\\right\\} \\cap Y\n\\]\n\nwhich, together with the assumption that \\(|X|=|Y|\\), gives\n\n\\[\n\\left|X \\cap\\left\\{1,2, \\ldots, f_{X}(s)\\right\\}\\right|=\\left|Y \\cap\\left\\{1,2, \\ldots, f_{X}(s)\\right\\}\\right| .\n\\]\n\nNow consider the equation\n\n\\[\nt-|Y \\cap\\{1,2, \\ldots, t\\}|=s .\n\\]\n\nThis equation is satisfied only when \\(t \\in\\left[f_{Y}(s), f_{Y}(s+1)\\right)\\), because the left hand side counts the number of elements up to \\(t\\) that are not in \\(Y\\). We have that the value \\(t=f_{X}(s)\\) satisfies the above equation because of (1) and (2). Furthermore, since \\(f_{X}(s) \\notin X\\) and \\(f_{X}(s) \\geqslant s\\), we have that \\(f_{X}(s) \\notin Y\\) due to the maximality of \\(s\\). Thus, by the above discussion, we must have \\(f_{X}(s)=f_{Y}(s)\\).\n\nFinally, we arrive at a contradiction. The value \\(f_{X}(s)\\) is neither in \\(X\\) nor in \\(f_{X}(Y)\\), because \\(s\\) is not in \\(Y\\) by assumption. Thus, \\(f_{X}(s) \\notin X * Y\\). However, since \\(s \\in X\\), we have \\(f_{Y}(s) \\in Y * X\\), a contradiction.\n\nWe are now ready to finish the proof. Note first of all that \\(\\left|A^{* b}\\right|=a b=\\left|B^{* a}\\right|\\). Moreover, since \\(A * B=B * A\\), and \\(*\\) is associative, it follows that \\(A^{* b} * B^{* a}=B^{* a} * A^{* b}\\). Thus, by Lemma 2, we have \\(A^{* b}=B^{* a}\\), as desired.\n\nComment 1. Taking \\(A=X^{* k}\\) and \\(B=X^{* l}\\) generates many non-trivial examples where \\(A * B=B * A\\). There are also other examples not of this form. For example, if \\(A=\\{1,2,4\\}\\) and \\(B=\\{1,3\\}\\), then \\(A * B=\\{1,2,3,4,6\\}=B * A\\).\nSolution 2. We will use Lemma 1 from Solution 1. Additionally, let \\(X^{* k}\\) be defined as in Solution 1. If \\(X\\) and \\(Y\\) are finite sets, then\n\n\\[\nf_{X}=f_{Y} \\Longleftrightarrow f_{X}\\left(\\mathbb{Z}_{>0}\\right)=f_{Y}\\left(\\mathbb{Z}_{>0}\\right) \\Longleftrightarrow\\left(\\mathbb{Z}_{>0} \\backslash X\\right)=\\left(\\mathbb{Z}_{>0} \\backslash Y\\right) \\Longleftrightarrow X=Y,\n\\]\n\nwhere the first equivalence is because \\(f_{X}\\) and \\(f_{Y}\\) are strictly increasing functions, and the second equivalence is because \\(f_{X}\\left(\\mathbb{Z}_{>0}\\right)=\\mathbb{Z}_{>0} \\backslash X\\) and \\(f_{Y}\\left(\\mathbb{Z}_{>0}\\right)=\\mathbb{Z}_{>0} \\backslash Y\\).\n\nDenote \\(g=f_{A}\\) and \\(h=f_{B}\\). The given relation \\(A * B=B * A\\) is equivalent to \\(f_{A * B}=f_{B * A}\\) because of (3), and by Lemma 1 of the first solution, this is equivalent to \\(g \\circ h=h \\circ g\\). Similarly, the required relation \\(A^{* b}=B^{* a}\\) is equivalent to \\(g^{b}=h^{a}\\). We will show that\n\n\\[\ng^{b}(n)=h^{a}(n)\n\\]\n\nfor all \\(n \\in \\mathbb{Z}_{>0}\\), which suffices to solve the problem.\nTo start, we claim that (4) holds for all sufficiently large \\(n\\). Indeed, let \\(p\\) and \\(q\\) be the maximal elements of \\(A\\) and \\(B\\), respectively; we may assume that \\(p \\geqslant q\\). Then, for every \\(n \\geqslant p\\) we have \\(g(n)=n+a\\) and \\(h(n)=n+b\\), whence \\(g^{b}(n)=n+a b=h^{a}(n)\\), as was claimed.\n\nIn view of this claim, if (4) is not identically true, then there exists a maximal \\(s\\) with \\(g^{b}(s) \\neq\\) \\(h^{a}(s)\\). Without loss of generality, we may assume that \\(g(s) \\neq s\\), for if we had \\(g(s)=h(s)=s\\), then \\(s\\) would satisfy (4). As \\(g\\) is increasing, we then have \\(g(s)>s\\), so (4) holds for \\(n=g(s)\\). But then we have\n\n\\[\ng\\left(g^{b}(s)\\right)=g^{b+1}(s)=g^{b}(n)=h^{a}(n)=h^{a}(g(s))=g\\left(h^{a}(s)\\right),\n\\]\n\nwhere the last equality holds in view of \\(g \\circ h=h \\circ g\\). By the injectivity of \\(g\\), the above equality yields \\(g^{b}(s)=h^{a}(s)\\), which contradicts the choice of \\(s\\). Thus, we have proved that (4) is identically true on \\(\\mathbb{Z}_{>0}\\), as desired.\n\nComment 2. We present another proof of Lemma 2 of the first solution.\nLet \\(x=|X|=|Y|\\). Say that \\(u\\) is the smallest number in \\(X\\) and \\(v\\) is the smallest number in \\(Y\\); assume without loss of generality that \\(u \\leqslant v\\).\n\nLet \\(T\\) be any finite set of positive integers, and define \\(t=|T|\\). Enumerate the elements of \\(X\\) as \\(x_{1}<x_{2}<\\cdots<x_{n}\\). Define \\(S_{m}=f_{\\left(T * X^{*(m-1)}\\right)}(X)\\), and enumerate its elements \\(s_{m, 1}<s_{m, 2}<\\cdots<\\) \\(s_{m, n}\\). Note that the \\(S_{m}\\) are pairwise disjoint; indeed, if we have \\(m<m^{\\prime}\\), then\n\n\\[\nS_{m} \\subset T * X^{* m} \\subset T * X^{*\\left(m^{\\prime}-1\\right)} \\quad \\text { and } \\quad S_{m^{\\prime}}=\\left(T * X^{* m^{\\prime}}\\right) \\backslash\\left(T * X^{*\\left(m^{\\prime}-1\\right)}\\right)\n\\]\n\nWe claim the following statement, which essentially says that the \\(S_{m}\\) are eventually linear translates of each other:\n\nClaim. For every \\(i\\), there exists some \\(m_{i}\\) and \\(c_{i}\\) such that for all \\(m>m_{i}\\), we have that \\(s_{m, i}=t+m n-c_{i}\\). Furthermore, the \\(c_{i}\\) do not depend on the choice of \\(T\\).\n\nFirst, we show that this claim implies Lemma 2. We may choose \\(T=X\\) and \\(T=Y\\). Then, there is some \\(m^{\\prime}\\) such that for all \\(m \\geqslant m^{\\prime}\\), we have\n\n\\[\nf_{X^{* m}}(X)=f_{\\left(Y * X^{*(m-1)}\\right)}(X)\n\\]\n\nBecause \\(u\\) is the minimum element of \\(X, v\\) is the minimum element of \\(Y\\), and \\(u \\leqslant v\\), we have that\n\n\\[\n\\left(\\bigcup_{m=m^{\\prime}}^{\\infty} f_{X * m}(X)\\right) \\cup X^{* m^{\\prime}}=\\left(\\bigcup_{m=m^{\\prime}}^{\\infty} f_{\\left(Y * X^{*(m-1)}\\right)}(X)\\right) \\cup\\left(Y * X^{*\\left(m^{\\prime}-1\\right)}\\right)=\\{u, u+1, \\ldots\\}\n\\]\n\nand in both the first and second expressions, the unions are of pairwise distinct sets. By (5), we obtain \\(X^{* m^{\\prime}}=Y * X^{*\\left(m^{\\prime}-1\\right)}\\). Now, because \\(X\\) and \\(Y\\) commute, we get \\(X^{* m^{\\prime}}=X^{*\\left(m^{\\prime}-1\\right)} * Y\\), and so \\(X=Y\\).\n\nWe now prove the claim.\nProof of the claim. We induct downwards on \\(i\\), first proving the statement for \\(i=n\\), and so on.\nAssume that \\(m\\) is chosen so that all elements of \\(S_{m}\\) are greater than all elements of \\(T\\) (which is possible because \\(T\\) is finite). For \\(i=n\\), we have that \\(s_{m, n}>s_{k, n}\\) for every \\(k<m\\). Thus, all \\((m-1) n\\) numbers of the form \\(s_{k, u}\\) for \\(k<m\\) and \\(1 \\leqslant u \\leqslant n\\) are less than \\(s_{m, n}\\). We then have that \\(s_{m, n}\\) is the \\(\\left((m-1) n+x_{n}\\right)^{\\text {th }}\\) number not in \\(T\\), which is equal to \\(t+(m-1) n+x_{n}\\). So we may choose \\(c_{n}=x_{n}-n\\), which does not depend on \\(T\\), which proves the base case for the induction.\n\nFor \\(i<n\\), we have again that all elements \\(s_{m, j}\\) for \\(j<i\\) and \\(s_{p, i}\\) for \\(p<m\\) are less than \\(s_{m, i}\\), so \\(s_{m, i}\\) is the \\(\\left((m-1) i+x_{i}\\right)^{\\text {th }}\\) element not in \\(T\\) or of the form \\(s_{p, j}\\) for \\(j>i\\) and \\(p<m\\). But by the inductive hypothesis, each of the sequences \\(s_{p, j}\\) is eventually periodic with period \\(n\\), and thus the sequence \\(s_{m, i}\\) such must be as well. Since each of the sequences \\(s_{p, j}-t\\) with \\(j>i\\) eventually do not depend on \\(T\\), the sequence \\(s_{m, i}-t\\) eventually does not depend on \\(T\\) either, so the inductive step is complete. This proves the claim and thus Lemma 2."}
{"id": "imo-shortlist-2017-c8", "question": "C8. Let \\(n\\) be a given positive integer. In the Cartesian plane, each lattice point with nonnegative coordinates initially contains a butterfly, and there are no other butterflies. The neighborhood of a lattice point \\(c\\) consists of all lattice points within the axis-aligned \\((2 n+1) \\times\\) \\((2 n+1)\\) square centered at \\(c\\), apart from \\(c\\) itself. We call a butterfly lonely, crowded, or comfortable, depending on whether the number of butterflies in its neighborhood \\(N\\) is respectively less than, greater than, or equal to half of the number of lattice points in \\(N\\).\n\nEvery minute, all lonely butterflies fly away simultaneously. This process goes on for as long as there are any lonely butterflies. Assuming that the process eventually stops, determine the number of comfortable butterflies at the final state.\n(Bulgaria)\nAnswer: \\(n^{2}+1\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2017, "solution": "We always identify a butterfly with the lattice point it is situated at. For two points \\(p\\) and \\(q\\), we write \\(p \\geqslant q\\) if each coordinate of \\(p\\) is at least the corresponding coordinate of \\(q\\). Let \\(O\\) be the origin, and let \\(\\mathcal{Q}\\) be the set of initially occupied points, i.e., of all lattice points with nonnegative coordinates. Let \\(\\mathcal{R}_{\\mathrm{H}}=\\{(x, 0): x \\geqslant 0\\}\\) and \\(\\mathcal{R}_{\\mathrm{V}}=\\{(0, y): y \\geqslant 0\\}\\) be the sets of the lattice points lying on the horizontal and vertical boundary rays of \\(\\mathcal{Q}\\). Denote by \\(N(a)\\) the neighborhood of a lattice point \\(a\\).\n\n\\begin{enumerate}\n  \\item Initial observations. We call a set of lattice points up-right closed if its points stay in the set after being shifted by any lattice vector \\((i, j)\\) with \\(i, j \\geqslant 0\\). Whenever the butterflies form a up-right closed set \\(\\mathcal{S}\\), we have \\(|N(p) \\cap \\mathcal{S}| \\geqslant|N(q) \\cap \\mathcal{S}|\\) for any two points \\(p, q \\in \\mathcal{S}\\) with \\(p \\geqslant q\\). So, since \\(\\mathcal{Q}\\) is up-right closed, the set of butterflies at any moment also preserves this property. We assume all forthcoming sets of lattice points to be up-right closed.\n\n\nWhen speaking of some set \\(\\mathcal{S}\\) of lattice points, we call its points lonely, comfortable, or crowded with respect to this set (i.e., as if the butterflies were exactly at all points of \\(\\mathcal{S}\\) ). We call a set \\(\\mathcal{S} \\subset \\mathcal{Q}\\) stable if it contains no lonely points. In what follows, we are interested only in those stable sets whose complements in \\(\\mathcal{Q}\\) are finite, because one can easily see that only a finite number of butterflies can fly away on each minute.\n\nIf the initial set \\(\\mathcal{Q}\\) of butterflies contains some stable set \\(\\mathcal{S}\\), then, clearly no butterfly of this set will fly away. On the other hand, the set \\(\\mathcal{F}\\) of all butterflies in the end of the process is stable. This means that \\(\\mathcal{F}\\) is the largest (with respect to inclusion) stable set within \\(\\mathcal{Q}\\), and we are about to describe this set.\n2. A description of a final set. The following notion will be useful. Let \\(\\mathcal{U}=\\left\\{\\vec{u}_{1}, \\vec{u}_{2}, \\ldots, \\vec{u}_{d}\\right\\}\\) be a set of \\(d\\) pairwise non-parallel lattice vectors, each having a positive \\(x\\) - and a negative \\(y\\)-coordinate. Assume that they are numbered in increasing order according to slope. We now define a \\(\\mathcal{U}\\)-curve to be the broken line \\(p_{0} p_{1} \\ldots p_{d}\\) such that \\(p_{0} \\in \\mathcal{R}_{\\mathrm{V}}, p_{d} \\in \\mathcal{R}_{\\mathrm{H}}\\), and \\(\\overrightarrow{p_{i-1} p_{i}}=\\vec{u}_{i}\\) for all \\(i=1,2, \\ldots, m\\) (see the Figure below to the left).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c0af87966e053f440e8cg-53}\n\nNow, let \\(\\mathcal{K}_{n}=\\{(i, j): 1 \\leqslant i \\leqslant n,-n \\leqslant j \\leqslant-1\\}\\). Consider all the rays emerging at \\(O\\) and passing through a point from \\(\\mathcal{K}_{n}\\); number them as \\(r_{1}, \\ldots, r_{m}\\) in increasing order according to slope. Let \\(A_{i}\\) be the farthest from \\(O\\) lattice point in \\(r_{i} \\cap \\mathcal{K}_{n}\\), set \\(k_{i}=\\left|r_{i} \\cap \\mathcal{K}_{n}\\right|\\), let \\(\\vec{v}_{i}=\\overrightarrow{O A_{i}}\\), and finally denote \\(\\mathcal{V}=\\left\\{\\vec{v}_{i}: 1 \\leqslant i \\leqslant m\\right\\}\\); see the Figure above to the right. We will concentrate on the \\(\\mathcal{V}\\)-curve \\(d_{0} d_{1} \\ldots d_{m}\\); let \\(\\mathcal{D}\\) be the set of all lattice points \\(p\\) such that \\(p \\geqslant p^{\\prime}\\) for some (not necessarily lattice) point \\(p^{\\prime}\\) on the \\(\\mathcal{V}\\)-curve. In fact, we will show that \\(\\mathcal{D}=\\mathcal{F}\\).\n\nClearly, the \\(\\mathcal{V}\\)-curve is symmetric in the line \\(y=x\\). Denote by \\(D\\) the convex hull of \\(\\mathcal{D}\\).\n3. We prove that the set \\(\\mathcal{D}\\) contains all stable sets. Let \\(\\mathcal{S} \\subset \\mathcal{Q}\\) be a stable set (recall that it is assumed to be up-right closed and to have a finite complement in \\(\\mathcal{Q}\\) ). Denote by \\(S\\) its convex hull; clearly, the vertices of \\(S\\) are lattice points. The boundary of \\(S\\) consists of two rays (horizontal and vertical ones) along with some \\(\\mathcal{V}_{*}\\)-curve for some set of lattice vectors \\(\\mathcal{V}_{*}\\).\nClaim 1. For every \\(\\vec{v}_{i} \\in \\mathcal{V}\\), there is a \\(\\vec{v}_{i}^{*} \\in \\mathcal{V}_{*}\\) co-directed with \\(\\vec{v}\\) with \\(\\left|\\vec{v}_{i}^{*}\\right| \\geqslant|\\vec{v}|\\).\nProof. Let \\(\\ell\\) be the supporting line of \\(S\\) parallel to \\(\\vec{v}_{i}\\) (i.e., \\(\\ell\\) contains some point of \\(S\\), and the set \\(S\\) lies on one side of \\(\\ell\\) ). Take any point \\(b \\in \\ell \\cap \\mathcal{S}\\) and consider \\(N(b)\\). The line \\(\\ell\\) splits the set \\(N(b) \\backslash \\ell\\) into two congruent parts, one having an empty intersection with \\(\\mathcal{S}\\). Hence, in order for \\(b\\) not to be lonely, at least half of the set \\(\\ell \\cap N(b)\\) (which contains \\(2 k_{i}\\) points) should lie in \\(S\\). Thus, the boundary of \\(S\\) contains a segment \\(\\ell \\cap S\\) with at least \\(k_{i}+1\\) lattice points (including \\(b\\) ) on it; this segment corresponds to the required vector \\(\\vec{v}_{i}^{*} \\in \\mathcal{V}_{*}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c0af87966e053f440e8cg-54}\n\nClaim 2. Each stable set \\(\\mathcal{S} \\subseteq \\mathcal{Q}\\) lies in \\(\\mathcal{D}\\).\nProof. To show this, it suffices to prove that the \\(\\mathcal{V}_{*}\\)-curve lies in \\(D\\), i.e., that all its vertices do so. Let \\(p^{\\prime}\\) be an arbitrary vertex of the \\(\\mathcal{V}_{*}\\)-curve; \\(p^{\\prime}\\) partitions this curve into two parts, \\(\\mathcal{X}\\) (being down-right of \\(p\\) ) and \\(\\mathcal{Y}\\) (being up-left of \\(p\\) ). The set \\(\\mathcal{V}\\) is split now into two parts: \\(\\mathcal{V}_{\\mathcal{X}}\\) consisting of those \\(\\vec{v}_{i} \\in \\mathcal{V}\\) for which \\(\\vec{v}_{i}^{*}\\) corresponds to a segment in \\(\\mathcal{X}\\), and a similar part \\(\\mathcal{V}_{\\mathcal{Y}}\\). Notice that the \\(\\mathcal{V}\\)-curve consists of several segments corresponding to \\(\\mathcal{V}_{\\mathcal{X}}\\), followed by those corresponding to \\(\\mathcal{V}_{\\mathcal{Y}}\\). Hence there is a vertex \\(p\\) of the \\(\\mathcal{V}\\)-curve separating \\(\\mathcal{V}_{\\mathcal{X}}\\) from \\(\\mathcal{V}_{\\mathcal{Y}}\\). Claim 1 now yields that \\(p^{\\prime} \\geqslant p\\), so \\(p^{\\prime} \\in \\mathcal{D}\\), as required.\n\nClaim 2 implies that the final set \\(\\mathcal{F}\\) is contained in \\(\\mathcal{D}\\).\n4. \\(\\mathcal{D}\\) is stable, and its comfortable points are known. Recall the definitions of \\(r_{i}\\); let \\(r_{i}^{\\prime}\\) be the ray complementary to \\(r_{i}\\). By our definitions, the set \\(N(O)\\) contains no points between the rays \\(r_{i}\\) and \\(r_{i+1}\\), as well as between \\(r_{i}^{\\prime}\\) and \\(r_{i+1}^{\\prime}\\).\nClaim 3. In the set \\(\\mathcal{D}\\), all lattice points of the \\(\\mathcal{V}\\)-curve are comfortable.\nProof. Let \\(p\\) be any lattice point of the \\(\\mathcal{V}\\)-curve, belonging to some segment \\(d_{i} d_{i+1}\\). Draw the line \\(\\ell\\) containing this segment. Then \\(\\ell \\cap \\mathcal{D}\\) contains exactly \\(k_{i}+1\\) lattice points, all of which lie in \\(N(p)\\) except for \\(p\\). Thus, exactly half of the points in \\(N(p) \\cap \\ell\\) lie in \\(\\mathcal{D}\\). It remains to show that all points of \\(N(p)\\) above \\(\\ell\\) lie in \\(\\mathcal{D}\\) (recall that all the points below \\(\\ell\\) lack this property).\n\nNotice that each vector in \\(\\mathcal{V}\\) has one coordinate greater than \\(n / 2\\); thus the neighborhood of \\(p\\) contains parts of at most two segments of the \\(\\mathcal{V}\\)-curve succeeding \\(d_{i} d_{i+1}\\), as well as at most two of those preceding it.\n\nThe angles formed by these consecutive segments are obtained from those formed by \\(r_{j}\\) and \\(r_{j-1}^{\\prime}\\) (with \\(i-1 \\leqslant j \\leqslant i+2\\) ) by shifts; see the Figure below. All the points in \\(N(p)\\) above \\(\\ell\\) which could lie outside \\(\\mathcal{D}\\) lie in shifted angles between \\(r_{j}, r_{j+1}\\) or \\(r_{j}^{\\prime}, r_{j-1}^{\\prime}\\). But those angles, restricted to \\(N(p)\\), have no lattice points due to the above remark. The claim is proved.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c0af87966e053f440e8cg-55(1)}\n\nProof of Claim 3\n\nClaim 4. All the points of \\(\\mathcal{D}\\) which are not on the boundary of \\(D\\) are crowded.\nProof. Let \\(p \\in \\mathcal{D}\\) be such a point. If it is to the up-right of some point \\(p^{\\prime}\\) on the curve, then the claim is easy: the shift of \\(N\\left(p^{\\prime}\\right) \\cap \\mathcal{D}\\) by \\(\\overrightarrow{p^{\\prime} p}\\) is still in \\(\\mathcal{D}\\), and \\(N(p)\\) contains at least one more point of \\(\\mathcal{D}\\) - either below or to the left of \\(p\\). So, we may assume that \\(p\\) lies in a right triangle constructed on some hypothenuse \\(d_{i} d_{i+1}\\). Notice here that \\(d_{i}, d_{i+1} \\in N(p)\\).\n\nDraw a line \\(\\ell \\| d_{i} d_{i+1}\\) through \\(p\\), and draw a vertical line \\(h\\) through \\(d_{i}\\); see Figure below. Let \\(\\mathcal{D}_{\\mathrm{L}}\\) and \\(\\mathcal{D}_{\\mathrm{R}}\\) be the parts of \\(\\mathcal{D}\\) lying to the left and to the right of \\(h\\), respectively (points of \\(\\mathcal{D} \\cap h\\) lie in both parts).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c0af87966e053f440e8cg-55}\n\nProof of Claim 4\nNotice that the vectors \\(\\overrightarrow{d_{i} p}, \\overrightarrow{d_{i+1} d_{i+2}}, \\overrightarrow{d_{i} d_{i+1}}, \\overrightarrow{d_{i-1} d_{i}}\\), and \\(\\overrightarrow{p d_{i+1}}\\) are arranged in non-increasing order by slope. This means that \\(\\mathcal{D}_{\\mathrm{L}}\\) shifted by \\(\\overrightarrow{d_{i} p}\\) still lies in \\(\\mathcal{D}\\), as well as \\(\\mathcal{D}_{\\mathrm{R}}\\) shifted by \\(\\overrightarrow{d_{i+1} p}\\). As we have seen in the proof of Claim 3, these two shifts cover all points of \\(N(p)\\) above \\(\\ell\\), along with those on \\(\\ell\\) to the left of \\(p\\). Since \\(N(p)\\) contains also \\(d_{i}\\) and \\(d_{i+1}\\), the point \\(p\\) is crowded.\n\nThus, we have proved that \\(\\mathcal{D}=\\mathcal{F}\\), and have shown that the lattice points on the \\(\\mathcal{V}\\)-curve are exactly the comfortable points of \\(\\mathcal{D}\\). It remains to find their number.\n\nRecall the definition of \\(\\mathcal{K}_{n}\\) (see Figure on the first page of the solution). Each segment \\(d_{i} d_{i+1}\\) contains \\(k_{i}\\) lattice points different from \\(d_{i}\\). Taken over all \\(i\\), these points exhaust all the lattice points in the \\(\\mathcal{V}\\)-curve, except for \\(d_{1}\\), and thus the number of lattice points on the \\(\\mathcal{V}\\)-curve is \\(1+\\sum_{i=1}^{m} k_{i}\\). On the other hand, \\(\\sum_{i=1}^{m} k_{i}\\) is just the number of points in \\(\\mathcal{K}_{n}\\), so it equals \\(n^{2}\\). Hence the answer to the problem is \\(n^{2}+1\\).\n\nComment 1. The assumption that the process eventually stops is unnecessary for the problem, as one can see that, in fact, the process stops for every \\(n \\geqslant 1\\). Indeed, the proof of Claims 3 and 4 do not rely essentially on this assumption, and they together yield that the set \\(\\mathcal{D}\\) is stable. So, only butterflies that are not in \\(\\mathcal{D}\\) may fly away, and this takes only a finite time.\n\nThis assumption has been inserted into the problem statement in order to avoid several technical details regarding finiteness issues. It may also simplify several other arguments.\n\nComment 2. The description of the final set \\(\\mathcal{F}(=\\mathcal{D})\\) seems to be crucial for the solution; the Problem Selection Committee is not aware of any solution that completely avoids such a description.\n\nOn the other hand, after the set \\(\\mathcal{D}\\) has been defined, the further steps may be performed in several ways. For example, in order to prove that all butterflies outside \\(\\mathcal{D}\\) will fly away, one may argue as follows. (Here we will also make use of the assumption that the process eventually stops.)\n\nFirst of all, notice that the process can be modified in the following manner: Each minute, exactly one of the lonely butterflies flies away, until there are no more lonely butterflies. The modified process necessarily stops at the same state as the initial one. Indeed, one may observe, as in solution above, that the (unique) largest stable set is still the final set for the modified process.\n\nThus, in order to prove our claim, it suffices to indicate an order in which the butterflies should fly away in the new process; if we are able to exhaust the whole set \\(\\mathcal{Q} \\backslash \\mathcal{D}\\), we are done.\n\nLet \\(\\mathcal{C}_{0}=d_{0} d_{1} \\ldots d_{m}\\) be the \\(\\mathcal{V}\\)-curve. Take its copy \\(\\mathcal{C}\\) and shift it downwards so that \\(d_{0}\\) comes to some point below the origin \\(O\\). Now we start moving \\(\\mathcal{C}\\) upwards continuously, until it comes back to its initial position \\(\\mathcal{C}_{0}\\). At each moment when \\(\\mathcal{C}\\) meets some lattice points, we convince all the butterflies at those points to fly away in a certain order. We will now show that we always have enough arguments for butterflies to do so, which will finish our argument for the claim..\n\nLet \\(\\mathcal{C}^{\\prime}=d_{0}^{\\prime} d_{1}^{\\prime} \\ldots d_{m}^{\\prime}\\) be a position of \\(\\mathcal{C}\\) when it meets some butterflies. We assume that all butterflies under this current position of \\(\\mathcal{C}\\) were already convinced enough and flied away. Consider the lowest butterfly \\(b\\) on \\(\\mathcal{C}^{\\prime}\\). Let \\(d_{i}^{\\prime} d_{i+1}^{\\prime}\\) be the segment it lies on; we choose \\(i\\) so that \\(b \\neq d_{i+1}^{\\prime}\\) (this is possible because \\(\\mathcal{C}\\) as not yet reached \\(\\mathcal{C}_{0}\\) ).\n\nDraw a line \\(\\ell\\) containing the segment \\(d_{i}^{\\prime} d_{i+1}^{\\prime}\\). Then all the butterflies in \\(N(b)\\) are situated on or above \\(\\ell\\); moreover, those on \\(\\ell\\) all lie on the segment \\(d_{i} d_{i+1}\\). But this segment now contains at most \\(k_{i}\\) butterflies (including \\(b\\) ), since otherwise some butterfly had to occupy \\(d_{i+1}^{\\prime}\\) which is impossible by the choice of \\(b\\). Thus, \\(b\\) is lonely and hence may be convinced to fly away.\n\nAfter \\(b\\) has flied away, we switch to the lowest of the remaining butterflies on \\(\\mathcal{C}^{\\prime}\\), and so on.\nClaims 3 and 4 also allow some different proofs which are not presented here.\n\nThis page is intentionally left blank"}
{"id": "imo-shortlist-2017-g1", "question": "G1. Let \\(A B C D E\\) be a convex pentagon such that \\(A B=B C=C D, \\angle E A B=\\angle B C D\\), and \\(\\angle E D C=\\angle C B A\\). Prove that the perpendicular line from \\(E\\) to \\(B C\\) and the line segments \\(A C\\) and \\(B D\\) are concurrent.\n(Italy)", "category": "Geometry", "source": "IMO Shortlist", "year": 2017, "solution": "Throughout the solution, we refer to \\(\\angle A, \\angle B, \\angle C, \\angle D\\), and \\(\\angle E\\) as internal angles of the pentagon \\(A B C D E\\). Let the perpendicular bisectors of \\(A C\\) and \\(B D\\), which pass respectively through \\(B\\) and \\(C\\), meet at point \\(I\\). Then \\(B D \\perp C I\\) and, similarly, \\(A C \\perp B I\\). Hence \\(A C\\) and \\(B D\\) meet at the orthocenter \\(H\\) of the triangle \\(B I C\\), and \\(I H \\perp B C\\). It remains to prove that \\(E\\) lies on the line \\(I H\\) or, equivalently, \\(E I \\perp B C\\).\n\nLines \\(I B\\) and \\(I C\\) bisect \\(\\angle B\\) and \\(\\angle C\\), respectively. Since \\(I A=I C, I B=I D\\), and \\(A B=\\) \\(B C=C D\\), the triangles \\(I A B, I C B\\) and \\(I C D\\) are congruent. Hence \\(\\angle I A B=\\angle I C B=\\) \\(\\angle C / 2=\\angle A / 2\\), so the line \\(I A\\) bisects \\(\\angle A\\). Similarly, the line \\(I D\\) bisects \\(\\angle D\\). Finally, the line \\(I E\\) bisects \\(\\angle E\\) because \\(I\\) lies on all the other four internal bisectors of the angles of the pentagon.\n\nThe sum of the internal angles in a pentagon is \\(540^{\\circ}\\), so\n\n\\[\n\\angle E=540^{\\circ}-2 \\angle A+2 \\angle B .\n\\]\n\nIn quadrilateral \\(A B I E\\),\n\n\\[\n\\begin{aligned}\n\\angle B I E & =360^{\\circ}-\\angle E A B-\\angle A B I-\\angle A E I=360^{\\circ}-\\angle A-\\frac{1}{2} \\angle B-\\frac{1}{2} \\angle E \n& =360^{\\circ}-\\angle A-\\frac{1}{2} \\angle B-\\left(270^{\\circ}-\\angle A-\\angle B\\right) \n& =90^{\\circ}+\\frac{1}{2} \\angle B=90^{\\circ}+\\angle I B C,\n\n\\]\n\nwhich means that \\(E I \\perp B C\\), completing the proof.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c0af87966e053f440e8cg-58}\n\nSolution 2. We present another proof of the fact that \\(E\\) lies on line \\(I H\\). Since all five internal bisectors of \\(A B C D E\\) meet at \\(I\\), this pentagon has an inscribed circle with center \\(I\\). Let this circle touch side \\(B C\\) at \\(T\\).\n\nApplying Brianchon's theorem to the (degenerate) hexagon \\(A B T C D E\\) we conclude that \\(A C, B D\\) and \\(E T\\) are concurrent, so point \\(E\\) also lies on line \\(I H T\\), completing the proof.\n\nSolution 3. We present yet another proof that \\(E I \\perp B C\\). In pentagon \\(A B C D E, \\angle E<\\) \\(180^{\\circ} \\Longleftrightarrow \\angle A+\\angle B+\\angle C+\\angle D>360^{\\circ}\\). Then \\(\\angle A+\\angle B=\\angle C+\\angle D>180^{\\circ}\\), so rays \\(E A\\) and \\(C B\\) meet at a point \\(P\\), and rays \\(B C\\) and \\(E D\\) meet at a point \\(Q\\). Now,\n\n\\[\n\\angle P B A=180^{\\circ}-\\angle B=180^{\\circ}-\\angle D=\\angle Q D C\n\\]\n\nand, similarly, \\(\\angle P A B=\\angle Q C D\\). Since \\(A B=C D\\), the triangles \\(P A B\\) and \\(Q C D\\) are congruent with the same orientation. Moreover, \\(P Q E\\) is isosceles with \\(E P=E Q\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c0af87966e053f440e8cg-59}\n\nIn Solution 1 we have proved that triangles \\(I A B\\) and \\(I C D\\) are also congruent with the same orientation. Then we conclude that quadrilaterals \\(P B I A\\) and \\(Q D I C\\) are congruent, which implies \\(I P=I Q\\). Then \\(E I\\) is the perpendicular bisector of \\(P Q\\) and, therefore, \\(E I \\perp\\) \\(P Q \\Longleftrightarrow E I \\perp B C\\).\n\nComment. Even though all three solutions used the point \\(I\\), there are solutions that do not need it. We present an outline of such a solution: if \\(J\\) is the incenter of \\(\\triangle Q C D\\) (with \\(P\\) and \\(Q\\) as defined in Solution 3), then a simple angle chasing shows that triangles \\(C J D\\) and \\(B H C\\) are congruent. Then if \\(S\\) is the projection of \\(J\\) onto side \\(C D\\) and \\(T\\) is the orthogonal projection of \\(H\\) onto side \\(B C\\), one can verify that\n\n\\[\nQ T=Q C+C T=Q C+D S=Q C+\\frac{C D+D Q-Q C}{2}=\\frac{P B+B C+Q C}{2}=\\frac{P Q}{2},\n\\]\n\nso \\(T\\) is the midpoint of \\(P Q\\), and \\(E, H\\) and \\(T\\) all lie on the perpendicular bisector of \\(P Q\\)."}
{"id": "imo-shortlist-2017-g2", "question": "G2. Let \\(R\\) and \\(S\\) be distinct points on circle \\(\\Omega\\), and let \\(t\\) denote the tangent line to \\(\\Omega\\) at \\(R\\). Point \\(R^{\\prime}\\) is the reflection of \\(R\\) with respect to \\(S\\). A point \\(I\\) is chosen on the smaller arc \\(R S\\) of \\(\\Omega\\) so that the circumcircle \\(\\Gamma\\) of triangle \\(I S R^{\\prime}\\) intersects \\(t\\) at two different points. Denote by \\(A\\) the common point of \\(\\Gamma\\) and \\(t\\) that is closest to \\(R\\). Line \\(A I\\) meets \\(\\Omega\\) again at \\(J\\). Show that \\(J R^{\\prime}\\) is tangent to \\(\\Gamma\\).\n(Luxembourg)", "category": "Geometry", "source": "IMO Shortlist", "year": 2017, "solution": "In the circles \\(\\Omega\\) and \\(\\Gamma\\) we have \\(\\angle J R S=\\angle J I S=\\angle A R^{\\prime} S\\). On the other hand, since \\(R A\\) is tangent to \\(\\Omega\\), we get \\(\\angle S J R=\\angle S R A\\). So the triangles \\(A R R^{\\prime}\\) and \\(S J R\\) are similar, and\n\n\\[\n\\frac{R^{\\prime} R}{R J}=\\frac{A R^{\\prime}}{S R}=\\frac{A R^{\\prime}}{S R^{\\prime}} .\n\\]\n\nThe last relation, together with \\(\\angle A R^{\\prime} S=\\angle J R R^{\\prime}\\), yields \\(\\triangle A S R^{\\prime} \\sim \\triangle R^{\\prime} J R\\), hence \\(\\angle S A R^{\\prime}=\\angle R R^{\\prime} J\\). It follows that \\(J R^{\\prime}\\) is tangent to \\(\\Gamma\\) at \\(R^{\\prime}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c0af87966e053f440e8cg-60}\n\nSolution 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c0af87966e053f440e8cg-60(1)}\n\nSolution 2\n\nSolution 2. As in Solution 1, we notice that \\(\\angle J R S=\\angle J I S=\\angle A R^{\\prime} S\\), so we have \\(R J \\| A R^{\\prime}\\).\nLet \\(A^{\\prime}\\) be the reflection of \\(A\\) about \\(S\\); then \\(A R A^{\\prime} R^{\\prime}\\) is a parallelogram with center \\(S\\), and hence the point \\(J\\) lies on the line \\(R A^{\\prime}\\).\n\nFrom \\(\\angle S R^{\\prime} A^{\\prime}=\\angle S R A=\\angle S J R\\) we get that the points \\(S, J, A^{\\prime}, R^{\\prime}\\) are concyclic. This proves that \\(\\angle S R^{\\prime} J=\\angle S A^{\\prime} J=\\angle S A^{\\prime} R=\\angle S A R^{\\prime}\\), so \\(J R^{\\prime}\\) is tangent to \\(\\Gamma\\) at \\(R^{\\prime}\\)."}
{"id": "imo-shortlist-2017-g3", "question": "G3. Let \\(O\\) be the circumcenter of an acute scalene triangle \\(A B C\\). Line \\(O A\\) intersects the altitudes of \\(A B C\\) through \\(B\\) and \\(C\\) at \\(P\\) and \\(Q\\), respectively. The altitudes meet at \\(H\\). Prove that the circumcenter of triangle \\(P Q H\\) lies on a median of triangle \\(A B C\\).\n(Ukraine)", "category": "Geometry", "source": "IMO Shortlist", "year": 2017, "solution": "Suppose, without loss of generality, that \\(A B<A C\\). We have \\(\\angle P Q H=90^{\\circ}-\\) \\(\\angle Q A B=90^{\\circ}-\\angle O A B=\\frac{1}{2} \\angle A O B=\\angle A C B\\), and similarly \\(\\angle Q P H=\\angle A B C\\). Thus triangles \\(A B C\\) and \\(H P Q\\) are similar. Let \\(\\Omega\\) and \\(\\omega\\) be the circumcircles of \\(A B C\\) and \\(H P Q\\), respectively. Since \\(\\angle A H P=90^{\\circ}-\\angle H A C=\\angle A C B=\\angle H Q P\\), line \\(A H\\) is tangent to \\(\\omega\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c0af87966e053f440e8cg-61}\n\nLet \\(T\\) be the center of \\(\\omega\\) and let lines \\(A T\\) and \\(B C\\) meet at \\(M\\). We will take advantage of the similarity between \\(A B C\\) and \\(H P Q\\) and the fact that \\(A H\\) is tangent to \\(\\omega\\) at \\(H\\), with \\(A\\) on line \\(P Q\\). Consider the corresponding tangent \\(A S\\) to \\(\\Omega\\), with \\(S \\in B C\\). Then \\(S\\) and \\(A\\) correspond to each other in \\(\\triangle A B C \\sim \\triangle H P Q\\), and therefore \\(\\angle O S M=\\angle O A T=\\angle O A M\\). Hence quadrilateral \\(S A O M\\) is cyclic, and since the tangent line \\(A S\\) is perpendicular to \\(A O\\), \\(\\angle O M S=180^{\\circ}-\\angle O A S=90^{\\circ}\\). This means that \\(M\\) is the orthogonal projection of \\(O\\) onto \\(B C\\), which is its midpoint. So \\(T\\) lies on median \\(A M\\) of triangle \\(A B C\\)."}
{"id": "imo-shortlist-2017-g4", "question": "G4. In triangle \\(A B C\\), let \\(\\omega\\) be the excircle opposite \\(A\\). Let \\(D, E\\), and \\(F\\) be the points where \\(\\omega\\) is tangent to lines \\(B C, C A\\), and \\(A B\\), respectively. The circle \\(A E F\\) intersects line \\(B C\\) at \\(P\\) and \\(Q\\). Let \\(M\\) be the midpoint of \\(A D\\). Prove that the circle \\(M P Q\\) is tangent to \\(\\omega\\).\n(Denmark)", "category": "Geometry", "source": "IMO Shortlist", "year": 2017, "solution": "Denote by \\(\\Omega\\) the circle \\(A E F P Q\\), and denote by \\(\\gamma\\) the circle \\(P Q M\\). Let the line \\(A D\\) meet \\(\\omega\\) again at \\(T \\neq D\\). We will show that \\(\\gamma\\) is tangent to \\(\\omega\\) at \\(T\\).\n\nWe first prove that points \\(P, Q, M, T\\) are concyclic. Let \\(A^{\\prime}\\) be the center of \\(\\omega\\). Since \\(A^{\\prime} E \\perp A E\\) and \\(A^{\\prime} F \\perp A F, A A^{\\prime}\\) is a diameter in \\(\\Omega\\). Let \\(N\\) be the midpoint of \\(D T\\); from \\(A^{\\prime} D=A^{\\prime} T\\) we can see that \\(\\angle A^{\\prime} N A=90^{\\circ}\\) and therefore \\(N\\) also lies on the circle \\(\\Omega\\). Now, from the power of \\(D\\) with respect to the circles \\(\\gamma\\) and \\(\\Omega\\) we get\n\n\\[\nD P \\cdot D Q=D A \\cdot D N=2 D M \\cdot \\frac{D T}{2}=D M \\cdot D T\n\\]\n\nso \\(P, Q, M, T\\) are concyclic.\nIf \\(E F \\| B C\\), then \\(A B C\\) is isosceles and the problem is now immediate by symmetry. Otherwise, let the tangent line to \\(\\omega\\) at \\(T\\) meet line \\(B C\\) at point \\(R\\). The tangent line segments \\(R D\\) and \\(R T\\) have the same length, so \\(A^{\\prime} R\\) is the perpendicular bisector of \\(D T\\); since \\(N D=N T\\), \\(N\\) lies on this perpendicular bisector.\n\nIn right triangle \\(A^{\\prime} R D, R D^{2}=R N \\cdot R A^{\\prime}=R P \\cdot R Q\\), in which the last equality was obtained from the power of \\(R\\) with respect to \\(\\Omega\\). Hence \\(R T^{2}=R P \\cdot R Q\\), which implies that \\(R T\\) is also tangent to \\(\\gamma\\). Because \\(R T\\) is a common tangent to \\(\\omega\\) and \\(\\gamma\\), these two circles are tangent at \\(T\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c0af87966e053f440e8cg-62}\n\nSolution 2. After proving that \\(P, Q, M, T\\) are concyclic, we finish the problem in a different fashion. We only consider the case in which \\(E F\\) and \\(B C\\) are not parallel. Let lines \\(P Q\\) and \\(E F\\) meet at point \\(R\\). Since \\(P Q\\) and \\(E F\\) are radical axes of \\(\\Omega, \\gamma\\) and \\(\\omega, \\gamma\\), respectively, \\(R\\) is the radical center of these three circles.\n\nWith respect to the circle \\(\\omega\\), the line \\(D R\\) is the polar of \\(D\\), and the line \\(E F\\) is the polar of \\(A\\). So the pole of line \\(A D T\\) is \\(D R \\cap E F=R\\), and therefore \\(R T\\) is tangent to \\(\\omega\\).\n\nFinally, since \\(T\\) belongs to \\(\\gamma\\) and \\(\\omega\\) and \\(R\\) is the radical center of \\(\\gamma, \\omega\\) and \\(\\Omega\\), line \\(R T\\) is the radical axis of \\(\\gamma\\) and \\(\\omega\\), and since it is tangent to \\(\\omega\\), it is also tangent to \\(\\gamma\\). Because \\(R T\\) is a common tangent to \\(\\omega\\) and \\(\\gamma\\), these two circles are tangent at \\(T\\).\n\nComment. In Solution 2 we defined the point \\(R\\) from Solution 1 in a different way.\n\nSolution 3. We give an alternative proof that the circles are tangent at the common point \\(T\\). Again, we start from the fact that \\(P, Q, M, T\\) are concyclic. Let point \\(O\\) be the midpoint of diameter \\(A A^{\\prime}\\). Then \\(M O\\) is the midline of triangle \\(A D A^{\\prime}\\), so \\(M O \\| A^{\\prime} D\\). Since \\(A^{\\prime} D \\perp P Q\\), \\(M O\\) is perpendicular to \\(P Q\\) as well.\n\nLooking at circle \\(\\Omega\\), which has center \\(O, M O \\perp P Q\\) implies that \\(M O\\) is the perpendicular bisector of the chord \\(P Q\\). Thus \\(M\\) is the midpoint of arc \\(\\overline{P Q}\\) from \\(\\gamma\\), and the tangent line \\(m\\) to \\(\\gamma\\) at \\(M\\) is parallel to \\(P Q\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c0af87966e053f440e8cg-63}\n\nConsider the homothety with center \\(T\\) and ratio \\(\\frac{T D}{T M}\\). It takes \\(D\\) to \\(M\\), and the line \\(P Q\\) to the line \\(m\\). Since the circle that is tangent to a line at a given point and that goes through another given point is unique, this homothety also takes \\(\\omega\\) (tangent to \\(P Q\\) and going through \\(T\\) ) to \\(\\gamma\\) (tangent to \\(m\\) and going through \\(T\\) ). We conclude that \\(\\omega\\) and \\(\\gamma\\) are tangent at \\(T\\)."}
{"id": "imo-shortlist-2017-g5", "question": "G5. Let \\(A B C C_{1} B_{1} A_{1}\\) be a convex hexagon such that \\(A B=B C\\), and suppose that the line segments \\(A A_{1}, B B_{1}\\), and \\(C C_{1}\\) have the same perpendicular bisector. Let the diagonals \\(A C_{1}\\) and \\(A_{1} C\\) meet at \\(D\\), and denote by \\(\\omega\\) the circle \\(A B C\\). Let \\(\\omega\\) intersect the circle \\(A_{1} B C_{1}\\) again at \\(E \\neq B\\). Prove that the lines \\(B B_{1}\\) and \\(D E\\) intersect on \\(\\omega\\).\n(Ukraine)", "category": "Geometry", "source": "IMO Shortlist", "year": 2017, "solution": "If \\(A A_{1}=C C_{1}\\), then the hexagon is symmetric about the line \\(B B_{1}\\); in particular the circles \\(A B C\\) and \\(A_{1} B C_{1}\\) are tangent to each other. So \\(A A_{1}\\) and \\(C C_{1}\\) must be different. Since the points \\(A\\) and \\(A_{1}\\) can be interchanged with \\(C\\) and \\(C_{1}\\), respectively, we may assume \\(A A_{1}<C C_{1}\\).\n\nLet \\(R\\) be the radical center of the circles \\(A E B C\\) and \\(A_{1} E B C_{1}\\), and the circumcircle of the symmetric trapezoid \\(A C C_{1} A_{1}\\); that is the common point of the pairwise radical axes \\(A C, A_{1} C_{1}\\), and \\(B E\\). By the symmetry of \\(A C\\) and \\(A_{1} C_{1}\\), the point \\(R\\) lies on the common perpendicular bisector of \\(A A_{1}\\) and \\(C C_{1}\\), which is the external bisector of \\(\\angle A D C\\).\n\nLet \\(F\\) be the second intersection of the line \\(D R\\) and the circle \\(A C D\\). From the power of \\(R\\) with respect to the circles \\(\\omega\\) and \\(A C F D\\) we have \\(R B \\cdot R E=R A \\cdot R C=R D \\cdot D F\\), so the points \\(B, E, D\\) and \\(F\\) are concyclic.\n\nThe line \\(R D F\\) is the external bisector of \\(\\angle A D C\\), so the point \\(F\\) bisects the arc \\(\\overline{C D A}\\). By \\(A B=B C\\), on circle \\(\\omega\\), the point \\(B\\) is the midpoint of arc \\(\\overline{A E C}\\); let \\(M\\) be the point diametrically opposite to \\(B\\), that is the midpoint of the opposite arc \\(\\overline{C A}\\) of \\(\\omega\\). Notice that the points \\(B, F\\) and \\(M\\) lie on the perpendicular bisector of \\(A C\\), so they are collinear.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c0af87966e053f440e8cg-64}\n\nFinally, let \\(X\\) be the second intersection point of \\(\\omega\\) and the line \\(D E\\). Since \\(B M\\) is a diameter in \\(\\omega\\), we have \\(\\angle B X M=90^{\\circ}\\). Moreover,\n\n\\[\n\\angle E X M=180^{\\circ}-\\angle M B E=180^{\\circ}-\\angle F B E=\\angle E D F,\n\\]\n\nso \\(M X\\) and \\(F D\\) are parallel. Since \\(B X\\) is perpendicular to \\(M X\\) and \\(B B_{1}\\) is perpendicular to \\(F D\\), this shows that \\(X\\) lies on line \\(B B_{1}\\).\n\nSolution 2. Define point \\(M\\) as the point opposite to \\(B\\) on circle \\(\\omega\\), and point \\(R\\) as the intersection of lines \\(A C, A_{1} C_{1}\\) and \\(B E\\), and show that \\(R\\) lies on the external bisector of \\(\\angle A D C\\), like in the first solution.\n\nSince \\(B\\) is the midpoint of the arc \\(\\overline{A E C}\\), the line \\(B E R\\) is the external bisector of \\(\\angle C E A\\). Now we show that the internal angle bisectors of \\(\\angle A D C\\) and \\(\\angle C E A\\) meet on the segment \\(A C\\). Let the angle bisector of \\(\\angle A D C\\) meet \\(A C\\) at \\(S\\), and let the angle bisector of \\(\\angle C E A\\), which is line \\(E M\\), meet \\(A C\\) at \\(S^{\\prime}\\). By applying the angle bisector theorem to both internal and external bisectors of \\(\\angle A D C\\) and \\(\\angle C E A\\),\n\n\\[\nA S: C S=A D: C D=A R: C R=A E: C E=A S^{\\prime}: C S^{\\prime},\n\\]\n\nso indeed \\(S=S^{\\prime}\\).\nBy \\(\\angle R D S=\\angle S E R=90^{\\circ}\\) the points \\(R, S, D\\) and \\(E\\) are concyclic.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c0af87966e053f440e8cg-65}\n\nNow let the lines \\(B B_{1}\\) and \\(D E\\) meet at point \\(X\\). Notice that \\(\\angle E X B=\\angle E D S\\) because both \\(B B_{1}\\) and \\(D S\\) are perpendicular to the line \\(D R\\), we have that \\(\\angle E D S=\\angle E R S\\) in circle \\(S R D E\\), and \\(\\angle E R S=\\angle E M B\\) because \\(S R \\perp B M\\) and \\(E R \\perp M E\\). Therefore, \\(\\angle E X B=\\angle E M B\\), so indeed, the point \\(X\\) lies on \\(\\omega\\)."}
{"id": "imo-shortlist-2017-g6", "question": "G6. Let \\(n \\geqslant 3\\) be an integer. Two regular \\(n\\)-gons \\(\\mathcal{A}\\) and \\(\\mathcal{B}\\) are given in the plane. Prove that the vertices of \\(\\mathcal{A}\\) that lie inside \\(\\mathcal{B}\\) or on its boundary are consecutive.\n(That is, prove that there exists a line separating those vertices of \\(\\mathcal{A}\\) that lie inside \\(\\mathcal{B}\\) or on its boundary from the other vertices of \\(\\mathcal{A}\\).)\n(Czech Republic)", "category": "Geometry", "source": "IMO Shortlist", "year": 2017, "solution": "In both solutions, by a polygon we always mean its interior together with its boundary.\n\nWe start with finding a regular \\(n\\)-gon \\(\\mathcal{C}\\) which \\((i)\\) is inscribed into \\(\\mathcal{B}\\) (that is, all vertices of \\(\\mathcal{C}\\) lie on the perimeter of \\(\\mathcal{B}\\) ); and (ii) is either a translation of \\(\\mathcal{A}\\), or a homothetic image of \\(\\mathcal{A}\\) with a positive factor.\n\nSuch a polygon may be constructed as follows. Let \\(O_{A}\\) and \\(O_{B}\\) be the centers of \\(\\mathcal{A}\\) and \\(\\mathcal{B}\\), respectively, and let \\(A\\) be an arbitrary vertex of \\(\\mathcal{A}\\). Let \\(\\overrightarrow{O_{B} C}\\) be the vector co-directional to \\(\\overrightarrow{O_{A} A}\\), with \\(C\\) lying on the perimeter of \\(\\mathcal{B}\\). The rotations of \\(C\\) around \\(O_{B}\\) by multiples of \\(2 \\pi / n\\) form the required polygon. Indeed, it is regular, inscribed into \\(\\mathcal{B}\\) (due to the rotational symmetry of \\(\\mathcal{B}\\) ), and finally the translation/homothety mapping \\(\\overrightarrow{O_{A} A}\\) to \\(\\overrightarrow{O_{B} C}\\) maps \\(\\mathcal{A}\\) to \\(\\mathcal{C}\\).\n\nNow we separate two cases.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c0af87966e053f440e8cg-66}\n\nCase 1: \\(\\mathcal{C}\\) is a translation of \\(\\mathcal{A}\\) by a vector \\(\\vec{v}\\).\nDenote by \\(t\\) the translation transform by vector \\(\\vec{v}\\). We need to prove that the vertices of \\(\\mathcal{C}\\) which stay in \\(\\mathcal{B}\\) under \\(t\\) are consecutive. To visualize the argument, we refer the plane to Cartesian coordinates so that the \\(x\\)-axis is co-directional with \\(\\vec{v}\\). This way, the notions of right/left and top/bottom are also introduced, according to the \\(x\\) - and \\(y\\)-coordinates, respectively.\n\nLet \\(B_{\\mathrm{T}}\\) and \\(B_{\\mathrm{B}}\\) be the top and the bottom vertices of \\(\\mathcal{B}\\) (if several vertices are extremal, we take the rightmost of them). They split the perimeter of \\(\\mathcal{B}\\) into the right part \\(\\mathcal{B}_{\\mathrm{R}}\\) and the left part \\(\\mathcal{B}_{\\mathrm{L}}\\) (the vertices \\(B_{\\mathrm{T}}\\) and \\(B_{\\mathrm{B}}\\) are assumed to lie in both parts); each part forms a connected subset of the perimeter of \\(\\mathcal{B}\\). So the vertices of \\(\\mathcal{C}\\) are also split into two parts \\(\\mathcal{C}_{\\mathrm{L}} \\subset \\mathcal{B}_{\\mathrm{L}}\\) and \\(\\mathcal{C}_{\\mathrm{R}} \\subset \\mathcal{B}_{\\mathrm{R}}\\), each of which consists of consecutive vertices.\n\nNow, all the points in \\(\\mathcal{B}_{\\mathrm{R}}\\) (and hence in \\(\\mathcal{C}_{\\mathrm{R}}\\) ) move out from \\(\\mathcal{B}\\) under \\(t\\), since they are the rightmost points of \\(\\mathcal{B}\\) on the corresponding horizontal lines. It remains to prove that the vertices of \\(\\mathcal{C}_{\\mathrm{L}}\\) which stay in \\(\\mathcal{B}\\) under \\(t\\) are consecutive.\n\nFor this purpose, let \\(C_{1}, C_{2}\\), and \\(C_{3}\\) be three vertices in \\(\\mathcal{C}_{\\mathrm{L}}\\) such that \\(C_{2}\\) is between \\(C_{1}\\) and \\(C_{3}\\), and \\(t\\left(C_{1}\\right)\\) and \\(t\\left(C_{3}\\right)\\) lie in \\(\\mathcal{B}\\); we need to prove that \\(t\\left(C_{2}\\right) \\in \\mathcal{B}\\) as well. Let \\(A_{i}=t\\left(C_{i}\\right)\\). The line through \\(C_{2}\\) parallel to \\(\\vec{v}\\) crosses the segment \\(C_{1} C_{3}\\) to the right of \\(C_{2}\\); this means that this line crosses \\(A_{1} A_{3}\\) to the right of \\(A_{2}\\), so \\(A_{2}\\) lies inside the triangle \\(A_{1} C_{2} A_{3}\\) which is contained in \\(\\mathcal{B}\\). This yields the desired result.\n\nCase 2: \\(\\mathcal{C}\\) is a homothetic image of \\(\\mathcal{A}\\) centered at \\(X\\) with factor \\(k>0\\).\n\nDenote by \\(h\\) the homothety mapping \\(\\mathcal{C}\\) to \\(\\mathcal{A}\\). We need now to prove that the vertices of \\(\\mathcal{C}\\) which stay in \\(\\mathcal{B}\\) after applying \\(h\\) are consecutive. If \\(X \\in \\mathcal{B}\\), the claim is easy. Indeed, if \\(k<1\\), then the vertices of \\(\\mathcal{A}\\) lie on the segments of the form \\(X C\\) ( \\(C\\) being a vertex of \\(\\mathcal{C}\\) ) which lie in \\(\\mathcal{B}\\). If \\(k>1\\), then the vertices of \\(\\mathcal{A}\\) lie on the extensions of such segments \\(X C\\) beyond \\(C\\), and almost all these extensions lie outside \\(\\mathcal{B}\\). The exceptions may occur only in case when \\(X\\) lies on the boundary of \\(\\mathcal{B}\\), and they may cause one or two vertices of \\(\\mathcal{A}\\) stay on the boundary of \\(\\mathcal{B}\\). But even in this case those vertices are still consecutive.\n\nSo, from now on we assume that \\(X \\notin \\mathcal{B}\\).\nNow, there are two vertices \\(B_{\\mathrm{T}}\\) and \\(\\mathcal{B}_{\\mathrm{B}}\\) of \\(\\mathcal{B}\\) such that \\(\\mathcal{B}\\) is contained in the angle \\(\\angle B_{\\mathrm{T}} X B_{\\mathrm{B}}\\); if there are several options, say, for \\(B_{\\mathrm{T}}\\), then we choose the farthest one from \\(X\\) if \\(k>1\\), and the nearest one if \\(k<1\\). For the visualization purposes, we refer the plane to Cartesian coordinates so that the \\(y\\)-axis is co-directional with \\(\\overrightarrow{B_{\\mathrm{B}} B_{\\mathrm{T}}}\\), and \\(X\\) lies to the left of the line \\(B_{\\mathrm{T}} B_{\\mathrm{B}}\\). Again, the perimeter of \\(\\mathcal{B}\\) is split by \\(B_{\\mathrm{T}}\\) and \\(B_{\\mathrm{B}}\\) into the right part \\(\\mathcal{B}_{\\mathrm{R}}\\) and the left part \\(\\mathcal{B}_{\\mathrm{L}}\\), and the set of vertices of \\(\\mathcal{C}\\) is split into two subsets \\(\\mathcal{C}_{\\mathrm{R}} \\subset \\mathcal{B}_{\\mathrm{R}}\\) and \\(\\mathcal{C}_{\\mathrm{L}} \\subset \\mathcal{B}_{\\mathrm{L}}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c0af87966e053f440e8cg-67}\n\nCase 2, \\(X\\) inside \\(\\mathcal{B}\\)\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c0af87966e053f440e8cg-67(1)}\n\nSubcase 2.1: \\(k>1\\)"}
{"id": "imo-shortlist-2017-n1", "question": "N1. The sequence \\(a_{0}, a_{1}, a_{2}, \\ldots\\) of positive integers satisfies\n\n\\[\na_{n+1}=\\left\\{\\begin{array}{ll}\n\\sqrt{a_{n}}, & \\text { if } \\sqrt{a_{n}} \\text { is an integer } \na_{n}+3, & \\text { otherwise }\n \\quad \\text { for every } n \\geqslant 0\\right.\n\\]\n\nDetermine all values of \\(a_{0}>1\\) for which there is at least one number \\(a\\) such that \\(a_{n}=a\\) for infinitely many values of \\(n\\).\n(South Africa)\nAnswer: All positive multiples of 3 .", "category": "Number Theory", "source": "IMO Shortlist", "year": 2017, "solution": "Since the value of \\(a_{n+1}\\) only depends on the value of \\(a_{n}\\), if \\(a_{n}=a_{m}\\) for two different indices \\(n\\) and \\(m\\), then the sequence is eventually periodic. So we look for the values of \\(a_{0}\\) for which the sequence is eventually periodic.\nClaim 1. If \\(a_{n} \\equiv-1(\\bmod 3)\\), then, for all \\(m>n, a_{m}\\) is not a perfect square. It follows that the sequence is eventually strictly increasing, so it is not eventually periodic.\nProof. A square cannot be congruent to -1 modulo 3 , so \\(a_{n} \\equiv-1(\\bmod 3)\\) implies that \\(a_{n}\\) is not a square, therefore \\(a_{n+1}=a_{n}+3>a_{n}\\). As a consequence, \\(a_{n+1} \\equiv a_{n} \\equiv-1(\\bmod 3)\\), so \\(a_{n+1}\\) is not a square either. By repeating the argument, we prove that, from \\(a_{n}\\) on, all terms of the sequence are not perfect squares and are greater than their predecessors, which completes the proof.\nClaim 2. If \\(a_{n} \\not \\equiv-1(\\bmod 3)\\) and \\(a_{n}>9\\) then there is an index \\(m>n\\) such that \\(a_{m}<a_{n}\\).\nProof. Let \\(t^{2}\\) be the largest perfect square which is less than \\(a_{n}\\). Since \\(a_{n}>9, t\\) is at least 3. The first square in the sequence \\(a_{n}, a_{n}+3, a_{n}+6, \\ldots\\) will be \\((t+1)^{2},(t+2)^{2}\\) or \\((t+3)^{2}\\), therefore there is an index \\(m>n\\) such that \\(a_{m} \\leqslant t+3<t^{2}<a_{n}\\), as claimed.\n\nClaim 3. If \\(a_{n} \\equiv 0(\\bmod 3)\\), then there is an index \\(m>n\\) such that \\(a_{m}=3\\).\nProof. First we notice that, by the definition of the sequence, a multiple of 3 is always followed by another multiple of 3 . If \\(a_{n} \\in\\{3,6,9\\}\\) the sequence will eventually follow the periodic pattern \\(3,6,9,3,6,9, \\ldots\\). If \\(a_{n}>9\\), let \\(j\\) be an index such that \\(a_{j}\\) is equal to the minimum value of the set \\(\\left\\{a_{n+1}, a_{n+2}, \\ldots\\right\\}\\). We must have \\(a_{j} \\leqslant 9\\), otherwise we could apply Claim 2 to \\(a_{j}\\) and get a contradiction on the minimality hypothesis. It follows that \\(a_{j} \\in\\{3,6,9\\}\\), and the proof is complete.\nClaim 4. If \\(a_{n} \\equiv 1(\\bmod 3)\\), then there is an index \\(m>n\\) such that \\(a_{m} \\equiv-1(\\bmod 3)\\).\nProof. In the sequence, 4 is always followed by \\(2 \\equiv-1(\\bmod 3)\\), so the claim is true for \\(a_{n}=4\\). If \\(a_{n}=7\\), the next terms will be \\(10,13,16,4,2, \\ldots\\) and the claim is also true. For \\(a_{n} \\geqslant 10\\), we again take an index \\(j>n\\) such that \\(a_{j}\\) is equal to the minimum value of the set \\(\\left\\{a_{n+1}, a_{n+2}, \\ldots\\right\\}\\), which by the definition of the sequence consists of non-multiples of 3 . Suppose \\(a_{j} \\equiv 1(\\bmod 3)\\). Then we must have \\(a_{j} \\leqslant 9\\) by Claim 2 and the minimality of \\(a_{j}\\). It follows that \\(a_{j} \\in\\{4,7\\}\\), so \\(a_{m}=2<a_{j}\\) for some \\(m>j\\), contradicting the minimality of \\(a_{j}\\). Therefore, we must have \\(a_{j} \\equiv-1(\\bmod 3)\\).\n\nIt follows from the previous claims that if \\(a_{0}\\) is a multiple of 3 the sequence will eventually reach the periodic pattern \\(3,6,9,3,6,9, \\ldots\\); if \\(a_{0} \\equiv-1(\\bmod 3)\\) the sequence will be strictly increasing; and if \\(a_{0} \\equiv 1(\\bmod 3)\\) the sequence will be eventually strictly increasing.\n\nSo the sequence will be eventually periodic if, and only if, \\(a_{0}\\) is a multiple of 3 ."}
{"id": "imo-shortlist-2017-n2", "question": "N2. Let \\(p \\geqslant 2\\) be a prime number. Eduardo and Fernando play the following game making moves alternately: in each move, the current player chooses an index \\(i\\) in the set \\(\\{0,1, \\ldots, p-1\\}\\) that was not chosen before by either of the two players and then chooses an element \\(a_{i}\\) of the set \\(\\{0,1,2,3,4,5,6,7,8,9\\}\\). Eduardo has the first move. The game ends after all the indices \\(i \\in\\{0,1, \\ldots, p-1\\}\\) have been chosen. Then the following number is computed:\n\n\\[\nM=a_{0}+10 \\cdot a_{1}+\\cdots+10^{p-1} \\cdot a_{p-1}=\\sum_{j=0}^{p-1} a_{j} \\cdot 10^{j}\n\\]\n\nThe goal of Eduardo is to make the number \\(M\\) divisible by \\(p\\), and the goal of Fernando is to prevent this.\n\nProve that Eduardo has a winning strategy.\n(Morocco)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2017, "solution": "We say that a player makes the move \\(\\left(i, a_{i}\\right)\\) if he chooses the index \\(i\\) and then the element \\(a_{i}\\) of the set \\(\\{0,1,2,3,4,5,6,7,8,9\\}\\) in this move.\n\nIf \\(p=2\\) or \\(p=5\\) then Eduardo chooses \\(i=0\\) and \\(a_{0}=0\\) in the first move, and wins, since, independently of the next moves, \\(M\\) will be a multiple of 10 .\n\nNow assume that the prime number \\(p\\) does not belong to \\(\\{2,5\\}\\). Eduardo chooses \\(i=p-1\\) and \\(a_{p-1}=0\\) in the first move. By Fermat's Little Theorem, \\(\\left(10^{(p-1) / 2}\\right)^{2}=10^{p-1} \\equiv 1(\\bmod p)\\), so \\(p \\mid\\left(10^{(p-1) / 2}\\right)^{2}-1=\\left(10^{(p-1) / 2}+1\\right)\\left(10^{(p-1) / 2}-1\\right)\\). Since \\(p\\) is prime, either \\(p \\mid 10^{(p-1) / 2}+1\\) or \\(p \\mid 10^{(p-1) / 2}-1\\). Thus we have two cases:\nCase a: \\(10^{(p-1) / 2} \\equiv-1(\\bmod p)\\)\nIn this case, for each move \\(\\left(i, a_{i}\\right)\\) of Fernando, Eduardo immediately makes the move \\(\\left(j, a_{j}\\right)=\\) \\(\\left(i+\\frac{p-1}{2}, a_{i}\\right)\\), if \\(0 \\leqslant i \\leqslant \\frac{p-3}{2}\\), or \\(\\left(j, a_{j}\\right)=\\left(i-\\frac{p-1}{2}, a_{i}\\right)\\), if \\(\\frac{p-1}{2} \\leqslant i \\leqslant p-2\\). We will have \\(10^{j} \\equiv-10^{i}\\) \\((\\bmod p)\\), and so \\(a_{j} \\cdot 10^{j}=a_{i} \\cdot 10^{j} \\equiv-a_{i} \\cdot 10^{i}(\\bmod p)\\). Notice that this move by Eduardo is always possible. Indeed, immediately before a move by Fernando, for any set of the type \\(\\{r, r+(p-1) / 2\\}\\) with \\(0 \\leqslant r \\leqslant(p-3) / 2\\), either no element of this set was chosen as an index by the players in the previous moves or else both elements of this set were chosen as indices by the players in the previous moves. Therefore, after each of his moves, Eduardo always makes the sum of the numbers \\(a_{k} \\cdot 10^{k}\\) corresponding to the already chosen pairs ( \\(k, a_{k}\\) ) divisible by \\(p\\), and thus wins the game.\nCase b: \\(10^{(p-1) / 2} \\equiv 1(\\bmod p)\\)\nIn this case, for each move \\(\\left(i, a_{i}\\right)\\) of Fernando, Eduardo immediately makes the move \\(\\left(j, a_{j}\\right)=\\) \\(\\left(i+\\frac{p-1}{2}, 9-a_{i}\\right)\\), if \\(0 \\leqslant i \\leqslant \\frac{p-3}{2}\\), or \\(\\left(j, a_{j}\\right)=\\left(i-\\frac{p-1}{2}, 9-a_{i}\\right)\\), if \\(\\frac{p-1}{2} \\leqslant i \\leqslant p-2\\). The same argument as above shows that Eduardo can always make such move. We will have \\(10^{j} \\equiv 10^{i}\\) \\((\\bmod p)\\), and so \\(a_{j} \\cdot 10^{j}+a_{i} \\cdot 10^{i} \\equiv\\left(a_{i}+a_{j}\\right) \\cdot 10^{i}=9 \\cdot 10^{i}(\\bmod p)\\). Therefore, at the end of the game, the sum of all terms \\(a_{k} \\cdot 10^{k}\\) will be congruent to\n\n\\[\n\\sum_{i=0}^{\\frac{p-3}{2}} 9 \\cdot 10^{i}=10^{(p-1) / 2}-1 \\equiv 0 \\quad(\\bmod p)\n\\]\n\nand Eduardo wins the game."}
{"id": "imo-shortlist-2017-n3", "question": "N3. Determine all integers \\(n \\geqslant 2\\) with the following property: for any integers \\(a_{1}, a_{2}, \\ldots, a_{n}\\) whose sum is not divisible by \\(n\\), there exists an index \\(1 \\leqslant i \\leqslant n\\) such that none of the numbers\n\n\\[\na_{i}, a_{i}+a_{i+1}, \\ldots, a_{i}+a_{i+1}+\\cdots+a_{i+n-1}\n\\]\n\nis divisible by \\(n\\). (We let \\(a_{i}=a_{i-n}\\) when \\(i>n\\).)\n(Thailand)\nAnswer: These integers are exactly the prime numbers.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2017, "solution": "Let us first show that, if \\(n=a b\\), with \\(a, b \\geqslant 2\\) integers, then the property in the statement of the problem does not hold. Indeed, in this case, let \\(a_{k}=a\\) for \\(1 \\leqslant k \\leqslant n-1\\) and \\(a_{n}=0\\). The sum \\(a_{1}+a_{2}+\\cdots+a_{n}=a \\cdot(n-1)\\) is not divisible by \\(n\\). Let \\(i\\) with \\(1 \\leqslant i \\leqslant n\\) be an arbitrary index. Taking \\(j=b\\) if \\(1 \\leqslant i \\leqslant n-b\\), and \\(j=b+1\\) if \\(n-b<i \\leqslant n\\), we have\n\n\\[\na_{i}+a_{i+1}+\\cdots+a_{i+j-1}=a \\cdot b=n \\equiv 0 \\quad(\\bmod n)\n\\]\n\nIt follows that the given example is indeed a counterexample to the property of the statement.\nNow let \\(n\\) be a prime number. Suppose by contradiction that the property in the statement of the problem does not hold. Then there are integers \\(a_{1}, a_{2}, \\ldots, a_{n}\\) whose sum is not divisible by \\(n\\) such that for each \\(i, 1 \\leqslant i \\leqslant n\\), there is \\(j, 1 \\leqslant j \\leqslant n\\), for which the number \\(a_{i}+a_{i+1}+\\) \\(\\cdots+a_{i+j-1}\\) is divisible by \\(n\\). Notice that, in any such case, we should have \\(1 \\leqslant j \\leqslant n-1\\), since \\(a_{1}+a_{2}+\\cdots+a_{n}\\) is not divisible by \\(n\\). So we may construct recursively a finite sequence of integers \\(0=i_{0}<i_{1}<i_{2}<\\cdots<i_{n}\\) with \\(i_{s+1}-i_{s} \\leqslant n-1\\) for \\(0 \\leqslant s \\leqslant n-1\\) such that, for \\(0 \\leqslant s \\leqslant n-1\\),\n\n\\[\na_{i_{s}+1}+a_{i_{s}+2}+\\cdots+a_{i_{s+1}} \\equiv 0 \\quad(\\bmod n)\n\\]\n\n(where we take indices modulo \\(n\\) ). Indeed, for \\(0 \\leqslant s<n\\), we apply the previous observation to \\(i=i_{s}+1\\) in order to define \\(i_{s+1}=i_{s}+j\\).\n\nIn the sequence of \\(n+1\\) indices \\(i_{0}, i_{1}, i_{2}, \\ldots, i_{n}\\), by the pigeonhole principle, we have two distinct elements which are congruent modulo \\(n\\). So there are indices \\(r, s\\) with \\(0 \\leqslant r<s \\leqslant n\\) such that \\(i_{s} \\equiv i_{r}(\\bmod n)\\) and\n\n\\[\na_{i_{r}+1}+a_{i_{r}+2}+\\cdots+a_{i_{s}}=\\sum_{j=r}^{s-1}\\left(a_{i_{j}+1}+a_{i_{j}+2}+\\cdots+a_{i_{j+1}}\\right) \\equiv 0 \\quad(\\bmod n)\n\\]\n\nSince \\(i_{s} \\equiv i_{r}(\\bmod n)\\), we have \\(i_{s}-i_{r}=k \\cdot n\\) for some positive integer \\(k\\), and, since \\(i_{j+1}-i_{j} \\leqslant\\) \\(n-1\\) for \\(0 \\leqslant j \\leqslant n-1\\), we have \\(i_{s}-i_{r} \\leqslant(n-1) \\cdot n\\), so \\(k \\leqslant n-1\\). But in this case\n\n\\[\na_{i_{r}+1}+a_{i_{r}+2}+\\cdots+a_{i_{s}}=k \\cdot\\left(a_{1}+a_{2}+\\cdots+a_{n}\\right)\n\\]\n\ncannot be a multiple of \\(n\\), since \\(n\\) is prime and neither \\(k\\) nor \\(a_{1}+a_{2}+\\cdots+a_{n}\\) is a multiple of \\(n\\). A contradiction."}
{"id": "imo-shortlist-2017-n4", "question": "N4. Call a rational number short if it has finitely many digits in its decimal expansion. For a positive integer \\(m\\), we say that a positive integer \\(t\\) is \\(m\\)-tastic if there exists a number \\(c \\in\\{1,2,3, \\ldots, 2017\\}\\) such that \\(\\frac{10^{t}-1}{c \\cdot m}\\) is short, and such that \\(\\frac{10^{k}-1}{c \\cdot m}\\) is not short for any \\(1 \\leqslant k<t\\). Let \\(S(m)\\) be the set of \\(m\\)-tastic numbers. Consider \\(S(m)\\) for \\(m=1,2, \\ldots\\). What is the maximum number of elements in \\(S(m)\\) ?\n(Turkey)\nAnswer: 807.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2017, "solution": "First notice that \\(x \\in \\mathbb{Q}\\) is short if and only if there are exponents \\(a, b \\geqslant 0\\) such that \\(2^{a} \\cdot 5^{b} \\cdot x \\in \\mathbb{Z}\\). In fact, if \\(x\\) is short, then \\(x=\\frac{n}{10^{k}}\\) for some \\(k\\) and we can take \\(a=b=k\\); on the other hand, if \\(2^{a} \\cdot 5^{b} \\cdot x=q \\in \\mathbb{Z}\\) then \\(x=\\frac{2^{b} \\cdot 5^{a} q}{10^{a+b}}\\), so \\(x\\) is short.\n\nIf \\(m=2^{a} \\cdot 5^{b} \\cdot s\\), with \\(\\operatorname{gcd}(s, 10)=1\\), then \\(\\frac{10^{t}-1}{m}\\) is short if and only if \\(s\\) divides \\(10^{t}-1\\). So we may (and will) suppose without loss of generality that \\(\\operatorname{gcd}(m, 10)=1\\). Define\n\n\\[\nC=\\{1 \\leqslant c \\leqslant 2017: \\operatorname{gcd}(c, 10)=1\\}\n\\]\n\nThe \\(m\\)-tastic numbers are then precisely the smallest exponents \\(t>0\\) such that \\(10^{t} \\equiv 1\\) \\((\\bmod \\mathrm{cm})\\) for some integer \\(c \\in C\\), that is, the set of orders of 10 modulo cm . In other words,\n\n\\[\nS(m)=\\left\\{\\operatorname{ord}_{c m}(10): c \\in C\\right\\}\n\\]\n\nSince there are \\(4 \\cdot 201+3=807\\) numbers \\(c\\) with \\(1 \\leqslant c \\leqslant 2017\\) and \\(\\operatorname{gcd}(c, 10)=1\\), namely those such that \\(c \\equiv 1,3,7,9(\\bmod 10)\\),\n\n\\[\n|S(m)| \\leqslant|C|=807\n\\]\n\nNow we find \\(m\\) such that \\(|S(m)|=807\\). Let\n\n\\[\nP=\\{1<p \\leqslant 2017: p \\text { is prime, } p \\neq 2,5\\}\n\\]\n\nand choose a positive integer \\(\\alpha\\) such that every \\(p \\in P\\) divides \\(10^{\\alpha}-1\\) (e.g. \\(\\alpha=\\varphi(T), T\\) being the product of all primes in \\(P\\) ), and let \\(m=10^{\\alpha}-1\\).\nClaim. For every \\(c \\in C\\), we have\n\n\\[\n\\operatorname{ord}_{c m}(10)=c \\alpha\n\\]\n\nAs an immediate consequence, this implies \\(|S(m)|=|C|=807\\), finishing the problem. Proof. Obviously \\(\\operatorname{ord}_{m}(10)=\\alpha\\). Let \\(t=\\operatorname{ord}_{c m}(10)\\). Then\n\n\\[\nc m\\left|10^{t}-1 \\quad \\Longrightarrow \\quad m\\right| 10^{t}-1 \\quad \\Longrightarrow \\quad \\alpha \\mid t .\n\\]\n\nHence \\(t=k \\alpha\\) for some \\(k \\in \\mathbb{Z}_{>0}\\). We will show that \\(k=c\\).\nDenote by \\(\\nu_{p}(n)\\) the number of prime factors \\(p\\) in \\(n\\), that is, the maximum exponent \\(\\beta\\) for which \\(p^{\\beta} \\mid n\\). For every \\(\\ell \\geqslant 1\\) and \\(p \\in P\\), the Lifting the Exponent Lemma provides\n\n\\[\n\\nu_{p}\\left(10^{\\ell \\alpha}-1\\right)=\\nu_{p}\\left(\\left(10^{\\alpha}\\right)^{\\ell}-1\\right)=\\nu_{p}\\left(10^{\\alpha}-1\\right)+\\nu_{p}(\\ell)=\\nu_{p}(m)+\\nu_{p}(\\ell)\n\\]\n\nSO\n\n\\[\n\\begin{aligned}\nc m \\mid 10^{k \\alpha}-1 & \\Longleftrightarrow \\forall p \\in P ; \\nu_{p}(c m) \\leqslant \\nu_{p}\\left(10^{k \\alpha}-1\\right) \n& \\Longleftrightarrow \\forall p \\in P ; \\nu_{p}(m)+\\nu_{p}(c) \\leqslant \\nu_{p}(m)+\\nu_{p}(k) \n& \\Longleftrightarrow \\forall p \\in P ; \\nu_{p}(c) \\leqslant \\nu_{p}(k) \n& \\Longleftrightarrow c \\mid k\n\n\\]\n\nThe first such \\(k\\) is \\(k=c\\), so \\(\\operatorname{ord}_{c m}(10)=c \\alpha\\).\n\nComment. The Lifting the Exponent Lemma states that, for any odd prime \\(p\\), any integers \\(a, b\\) coprime with \\(p\\) such that \\(p \\mid a-b\\), and any positive integer exponent \\(n\\),\n\n\\[\n\\nu_{p}\\left(a^{n}-b^{n}\\right)=\\nu_{p}(a-b)+\\nu_{p}(n)\n\\]\n\nand, for \\(p=2\\),\n\n\\[\n\\nu_{2}\\left(a^{n}-b^{n}\\right)=\\nu_{2}\\left(a^{2}-b^{2}\\right)+\\nu_{p}(n)-1\n\\]\n\nBoth claims can be proved by induction on \\(n\\)."}
{"id": "imo-shortlist-2017-n5", "question": "N5. Find all pairs \\((p, q)\\) of prime numbers with \\(p>q\\) for which the number\n\n\\[\n\\frac{(p+q)^{p+q}(p-q)^{p-q}-1}{(p+q)^{p-q}(p-q)^{p+q}-1}\n\\]\n\nis an integer.\n(Japan)\nAnswer: The only such pair is \\((3,2)\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2017, "solution": "Let \\(M=(p+q)^{p-q}(p-q)^{p+q}-1\\), which is relatively prime with both \\(p+q\\) and \\(p-q\\). Denote by \\((p-q)^{-1}\\) the multiplicative inverse of \\((p-q)\\) modulo \\(M\\).\n\nBy eliminating the term -1 in the numerator,\n\n\\[\n\\begin{aligned}\n(p+q)^{p+q}(p-q)^{p-q}-1 & \\equiv(p+q)^{p-q}(p-q)^{p+q}-1 \\quad(\\bmod M) \n(p+q)^{2 q} & \\equiv(p-q)^{2 q} \\quad(\\bmod M) \n\\left((p+q) \\cdot(p-q)^{-1}\\right)^{2 q} & \\equiv 1 \\quad(\\bmod M)\n\n\\]\n\nCase 1: \\(q \\geqslant 5\\).\nConsider an arbitrary prime divisor \\(r\\) of \\(M\\). Notice that \\(M\\) is odd, so \\(r \\geqslant 3\\). By (2), the multiplicative order of \\(\\left((p+q) \\cdot(p-q)^{-1}\\right)\\) modulo \\(r\\) is a divisor of the exponent \\(2 q\\) in (2), so it can be \\(1,2, q\\) or \\(2 q\\).\n\nBy Fermat's theorem, the order divides \\(r-1\\). So, if the order is \\(q\\) or \\(2 q\\) then \\(r \\equiv 1(\\bmod q)\\). If the order is 1 or 2 then \\(r \\mid(p+q)^{2}-(p-q)^{2}=4 p q\\), so \\(r=p\\) or \\(r=q\\). The case \\(r=p\\) is not possible, because, by applying Fermat's theorem,\n\\(M=(p+q)^{p-q}(p-q)^{p+q}-1 \\equiv q^{p-q}(-q)^{p+q}-1=\\left(q^{2}\\right)^{p}-1 \\equiv q^{2}-1=(q+1)(q-1) \\quad(\\bmod p)\\)\nand the last factors \\(q-1\\) and \\(q+1\\) are less than \\(p\\) and thus \\(p \\nmid M\\). Hence, all prime divisors of \\(M\\) are either \\(q\\) or of the form \\(k q+1\\); it follows that all positive divisors of \\(M\\) are congruent to 0 or 1 modulo \\(q\\).\n\nNow notice that\n\n\\[\nM=\\left((p+q)^{\\frac{p-q}{2}}(p-q)^{\\frac{p+q}{2}}-1\\right)\\left((p+q)^{\\frac{p-q}{2}}(p-q)^{\\frac{p+q}{2}}+1\\right)\n\\]\n\nis the product of two consecutive positive odd numbers; both should be congruent to 0 or 1 modulo \\(q\\). But this is impossible by the assumption \\(q \\geqslant 5\\). So, there is no solution in Case 1 .\nCase 2: \\(q=2\\).\nBy (1), we have \\(M \\mid(p+q)^{2 q}-(p-q)^{2 q}=(p+2)^{4}-(p-2)^{4}\\), so\n\n\\[\n\\begin{gathered}\n(p+2)^{p-2}(p-2)^{p+2}-1=M \\leqslant(p+2)^{4}-(p-2)^{4} \\leqslant(p+2)^{4}-1 \n(p+2)^{p-6}(p-2)^{p+2} \\leqslant 1\n\n\\]\n\nIf \\(p \\geqslant 7\\) then the left-hand side is obviously greater than 1 . For \\(p=5\\) we have \\((p+2)^{p-6}(p-2)^{p+2}=7^{-1} \\cdot 3^{7}\\) which is also too large.\n\nThere remains only one candidate, \\(p=3\\), which provides a solution:\n\n\\[\n\\frac{(p+q)^{p+q}(p-q)^{p-q}-1}{(p+q)^{p-q}(p-q)^{p+q}-1}=\\frac{5^{5} \\cdot 1^{1}-1}{5^{1} \\cdot 1^{5}-1}=\\frac{3124}{4}=781\n\\]\n\nSo in Case 2 the only solution is \\((p, q)=(3,2)\\).\n\nCase 3: \\(q=3\\).\nSimilarly to Case 2, we have\n\n\\[\nM \\left\\lvert\\,(p+q)^{2 q}-(p-q)^{2 q}=64 \\cdot\\left(\\left(\\frac{p+3}{2}\\right)^{6}-\\left(\\frac{p-3}{2}\\right)^{6}\\right) .\\right.\n\\]\n\nSince \\(M\\) is odd, we conclude that\n\n\\[\nM \\left\\lvert\\,\\left(\\frac{p+3}{2}\\right)^{6}-\\left(\\frac{p-3}{2}\\right)^{6}\\right.\n\\]\n\nand\n\n\\[\n\\begin{gathered}\n(p+3)^{p-3}(p-3)^{p+3}-1=M \\leqslant\\left(\\frac{p+3}{2}\\right)^{6}-\\left(\\frac{p-3}{2}\\right)^{6} \\leqslant\\left(\\frac{p+3}{2}\\right)^{6}-1, \n64(p+3)^{p-9}(p-3)^{p+3} \\leqslant 1 .\n\n\\]\n\nIf \\(p \\geqslant 11\\) then the left-hand side is obviously greater than 1 . If \\(p=7\\) then the left-hand side is \\(64 \\cdot 10^{-2} \\cdot 4^{10}>1\\). If \\(p=5\\) then the left-hand side is \\(64 \\cdot 8^{-4} \\cdot 2^{8}=2^{2}>1\\). Therefore, there is no solution in Case 3."}
{"id": "imo-shortlist-2017-n6", "question": "N6. Find the smallest positive integer \\(n\\), or show that no such \\(n\\) exists, with the following property: there are infinitely many distinct \\(n\\)-tuples of positive rational numbers ( \\(a_{1}, a_{2}, \\ldots, a_{n}\\) ) such that both\n\n\\[\na_{1}+a_{2}+\\cdots+a_{n} \\quad \\text { and } \\quad \\frac{1}{a_{1}}+\\frac{1}{a_{2}}+\\cdots+\\frac{1}{a_{n}}\n\\]\n\nare integers.\n(Singapore)\nAnswer: \\(n=3\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2017, "solution": "For \\(n=1, a_{1} \\in \\mathbb{Z}_{>0}\\) and \\(\\frac{1}{a_{1}} \\in \\mathbb{Z}_{>0}\\) if and only if \\(a_{1}=1\\). Next we show that\n(i) There are finitely many \\((x, y) \\in \\mathbb{Q}_{>0}^{2}\\) satisfying \\(x+y \\in \\mathbb{Z}\\) and \\(\\frac{1}{x}+\\frac{1}{y} \\in \\mathbb{Z}\\)\n\nWrite \\(x=\\frac{a}{b}\\) and \\(y=\\frac{c}{d}\\) with \\(a, b, c, d \\in \\mathbb{Z}_{>0}\\) and \\(\\operatorname{gcd}(a, b)=\\operatorname{gcd}(c, d)=1\\). Then \\(x+y \\in \\mathbb{Z}\\) and \\(\\frac{1}{x}+\\frac{1}{y} \\in \\mathbb{Z}\\) is equivalent to the two divisibility conditions\n\n\\[\nb d \\mid a d+b c(1) \\quad \\text { and } \\quad a c \\mid a d+b c\n\\]\n\nCondition (1) implies that \\(d|a d+b c \\Longleftrightarrow d| b c \\Longleftrightarrow d \\mid b\\) since \\(\\operatorname{gcd}(c, d)=1\\). Still from (1) we get \\(b|a d+b c \\Longleftrightarrow b| a d \\Longleftrightarrow b \\mid d\\) since \\(\\operatorname{gcd}(a, b)=1\\). From \\(b \\mid d\\) and \\(d \\mid b\\) we have \\(b=d\\).\nAn analogous reasoning with condition (2) shows that \\(a=c\\). Hence \\(x=\\frac{a}{b}=\\frac{c}{d}=y\\), i.e., the problem amounts to finding all \\(x \\in \\mathbb{Q}_{>0}\\) such that \\(2 x \\in \\mathbb{Z}_{>0}\\) and \\(\\frac{2}{x} \\in \\mathbb{Z}_{>0}\\). Letting \\(n=2 x \\in \\mathbb{Z}_{>0}\\), we have that \\(\\frac{2}{x} \\in \\mathbb{Z}_{>0} \\Longleftrightarrow \\frac{4}{n} \\in \\mathbb{Z}_{>0} \\Longleftrightarrow n=1,2\\) or 4 , and there are finitely many solutions, namely \\((x, y)=\\left(\\frac{1}{2}, \\frac{1}{2}\\right),(1,1)\\) or \\((2,2)\\).\n(ii) There are infinitely many triples \\((x, y, z) \\in \\mathbb{Q}_{>0}^{2}\\) such that \\(x+y+z \\in \\mathbb{Z}\\) and \\(\\frac{1}{x}+\\frac{1}{y}+\\frac{1}{z} \\in \\mathbb{Z}\\). We will look for triples such that \\(x+y+z=1\\), so we may write them in the form\n\n\\[\n(x, y, z)=\\left(\\frac{a}{a+b+c}, \\frac{b}{a+b+c}, \\frac{c}{a+b+c}\\right) \\quad \\text { with } a, b, c \\in \\mathbb{Z}_{>0}\n\\]\n\nWe want these to satisfy\n\n\\[\n\\frac{1}{x}+\\frac{1}{y}+\\frac{1}{z}=\\frac{a+b+c}{a}+\\frac{a+b+c}{b}+\\frac{a+b+c}{c} \\in \\mathbb{Z} \\Longleftrightarrow \\frac{b+c}{a}+\\frac{a+c}{b}+\\frac{a+b}{c} \\in \\mathbb{Z}\n\\]\n\nFixing \\(a=1\\), it suffices to find infinitely many pairs \\((b, c) \\in \\mathbb{Z}_{>0}^{2}\\) such that\n\n\\[\n\\frac{1}{b}+\\frac{1}{c}+\\frac{c}{b}+\\frac{b}{c}=3 \\Longleftrightarrow b^{2}+c^{2}-3 b c+b+c=0\n\\]\n\nTo show that equation (\\textit{) has infinitely many solutions, we use Vieta jumping (also known as root flipping): starting with \\(b=2, c=3\\), the following algorithm generates infinitely many solutions. Let \\(c \\geqslant b\\), and view (}) as a quadratic equation in \\(b\\) for \\(c\\) fixed:\n\n\\[\nb^{2}-(3 c-1) \\cdot b+\\left(c^{2}+c\\right)=0\n\\]\n\nThen there exists another root \\(b_{0} \\in \\mathbb{Z}\\) of (**) which satisfies \\(b+b_{0}=3 c-1\\) and \\(b \\cdot b_{0}=c^{2}+c\\). Since \\(c \\geqslant b\\) by assumption,\n\n\\[\nb_{0}=\\frac{c^{2}+c}{b} \\geqslant \\frac{c^{2}+c}{c}>c\n\\]\n\nHence from the solution \\((b, c)\\) we obtain another one \\(\\left(c, b_{0}\\right)\\) with \\(b_{0}>c\\), and we can then \"jump\" again, this time with \\(c\\) as the \"variable\" in the quadratic (*). This algorithm will generate an infinite sequence of distinct solutions, whose first terms are\n\\((2,3),(3,6),(6,14),(14,35),(35,90),(90,234),(234,611),(611,1598),(1598,4182), \\ldots\\)\n\nComment. Although not needed for solving this problem, we may also explicitly solve the recursion given by the Vieta jumping. Define the sequence \\(\\left(x_{n}\\right)\\) as follows:\n\n\\[\nx_{0}=2, \\quad x_{1}=3 \\quad \\text { and } \\quad x_{n+2}=3 x_{n+1}-x_{n}-1 \\text { for } n \\geqslant 0\n\\]\n\nThen the triple\n\n\\[\n(x, y, z)=\\left(\\frac{1}{1+x_{n}+x_{n+1}}, \\frac{x_{n}}{1+x_{n}+x_{n+1}}, \\frac{x_{n+1}}{1+x_{n}+x_{n+1}}\\right)\n\\]\n\nsatisfies the problem conditions for all \\(n \\in \\mathbb{N}\\). It is easy to show that \\(x_{n}=F_{2 n+1}+1\\), where \\(F_{n}\\) denotes the \\(n\\)-th term of the Fibonacci sequence ( \\(F_{0}=0, F_{1}=1\\), and \\(F_{n+2}=F_{n+1}+F_{n}\\) for \\(n \\geqslant 0\\) ).\nSolution 2. Call the \\(n\\)-tuples \\(\\left(a_{1}, a_{2}, \\ldots, a_{n}\\right) \\in \\mathbb{Q}_{>0}^{n}\\) satisfying the conditions of the problem statement good, and those for which\n\n\\[\nf\\left(a_{1}, \\ldots, a_{n}\\right) \\stackrel{\\text { def }}{=}\\left(a_{1}+a_{2}+\\cdots+a_{n}\\right)\\left(\\frac{1}{a_{1}}+\\frac{1}{a_{2}}+\\cdots+\\frac{1}{a_{n}}\\right)\n\\]\n\nis an integer pretty. Then good \\(n\\)-tuples are pretty, and if \\(\\left(b_{1}, \\ldots, b_{n}\\right)\\) is pretty then\n\n\\[\n\\left(\\frac{b_{1}}{b_{1}+b_{2}+\\cdots+b_{n}}, \\frac{b_{2}}{b_{1}+b_{2}+\\cdots+b_{n}}, \\cdots, \\frac{b_{n}}{b_{1}+b_{2}+\\cdots+b_{n}}\\right)\n\\]\n\nis good since the sum of its components is 1 , and the sum of the reciprocals of its components equals \\(f\\left(b_{1}, \\ldots, b_{n}\\right)\\). We declare pretty \\(n\\)-tuples proportional to each other equivalent since they are precisely those which give rise to the same good \\(n\\)-tuple. Clearly, each such equivalence class contains exactly one \\(n\\)-tuple of positive integers having no common prime divisors. Call such \\(n\\)-tuple a primitive pretty tuple. Our task is to find infinitely many primitive pretty \\(n\\)-tuples.\n\nFor \\(n=1\\), there is clearly a single primitive 1 -tuple. For \\(n=2\\), we have \\(f(a, b)=\\frac{(a+b)^{2}}{a b}\\), which can be integral (for coprime \\(a, b \\in \\mathbb{Z}_{>0}\\) ) only if \\(a=b=1\\) (see for instance (i) in the first solution).\n\nNow we construct infinitely many primitive pretty triples for \\(n=3\\). Fix \\(b, c, k \\in \\mathbb{Z}_{>0}\\); we will try to find sufficient conditions for the existence of an \\(a \\in \\mathbb{Q}_{>0}\\) such that \\(f(a, b, c)=k\\). Write \\(\\sigma=b+c, \\tau=b c\\). From \\(f(a, b, c)=k\\), we have that \\(a\\) should satisfy the quadratic equation\n\n\\[\na^{2} \\cdot \\sigma+a \\cdot\\left(\\sigma^{2}-(k-1) \\tau\\right)+\\sigma \\tau=0\n\\]\n\nwhose discriminant is\n\n\\[\n\\Delta=\\left(\\sigma^{2}-(k-1) \\tau\\right)^{2}-4 \\sigma^{2} \\tau=\\left((k+1) \\tau-\\sigma^{2}\\right)^{2}-4 k \\tau^{2}\n\\]\n\nWe need it to be a square of an integer, say, \\(\\Delta=M^{2}\\) for some \\(M \\in \\mathbb{Z}\\), i.e., we want\n\n\\[\n\\left((k+1) \\tau-\\sigma^{2}\\right)^{2}-M^{2}=2 k \\cdot 2 \\tau^{2}\n\\]\n\nso that it suffices to set\n\n\\[\n(k+1) \\tau-\\sigma^{2}=\\tau^{2}+k, \\quad M=\\tau^{2}-k\n\\]\n\nThe first relation reads \\(\\sigma^{2}=(\\tau-1)(k-\\tau)\\), so if \\(b\\) and \\(c\\) satisfy\n\n\\[\n\\tau-1 \\mid \\sigma^{2} \\quad \\text { i.e. } \\quad b c-1 \\mid(b+c)^{2}\n\\]\n\nthen \\(k=\\frac{\\sigma^{2}}{\\tau-1}+\\tau\\) will be integral, and we find rational solutions to (1), namely\n\n\\[\na=\\frac{\\sigma}{\\tau-1}=\\frac{b+c}{b c-1} \\quad \\text { or } \\quad a=\\frac{\\tau^{2}-\\tau}{\\sigma}=\\frac{b c \\cdot(b c-1)}{b+c}\n\\]\n\nWe can now find infinitely many pairs ( \\(b, c\\) ) satisfying (2) by Vieta jumping. For example, if we impose\n\n\\[\n(b+c)^{2}=5 \\cdot(b c-1)\n\\]\n\nthen all pairs \\((b, c)=\\left(v_{i}, v_{i+1}\\right)\\) satisfy the above condition, where\n\n\\[\nv_{1}=2, v_{2}=3, \\quad v_{i+2}=3 v_{i+1}-v_{i} \\quad \\text { for } i \\geqslant 0\n\\]\n\nFor \\((b, c)=\\left(v_{i}, v_{i+1}\\right)\\), one of the solutions to (1) will be \\(a=(b+c) /(b c-1)=5 /(b+c)=\\) \\(5 /\\left(v_{i}+v_{i+1}\\right)\\). Then the pretty triple \\((a, b, c)\\) will be equivalent to the integral pretty triple\n\n\\[\n\\left(5, v_{i}\\left(v_{i}+v_{i+1}\\right), v_{i+1}\\left(v_{i}+v_{i+1}\\right)\\right)\n\\]\n\nAfter possibly dividing by 5 , we obtain infinitely many primitive pretty triples, as required.\n\nComment. There are many other infinite series of \\((b, c)=\\left(v_{i}, v_{i+1}\\right)\\) with \\(b c-1 \\mid(b+c)^{2}\\). Some of them are:\n\n\\[\n\\begin{array}{llll}\nv_{1}=1, & v_{2}=3, & v_{i+1}=6 v_{i}-v_{i-1}, & \\left(v_{i}+v_{i+1}\\right)^{2}=8 \\cdot\\left(v_{i} v_{i+1}-1\\right) ; \nv_{1}=1, & v_{2}=2, & v_{i+1}=7 v_{i}-v_{i-1}, & \\left(v_{i}+v_{i+1}\\right)^{2}=9 \\cdot\\left(v_{i} v_{i+1}-1\\right) ; \nv_{1}=1, & v_{2}=5, & v_{i+1}=7 v_{i}-v_{i-1}, & \\left(v_{i}+v_{i+1}\\right)^{2}=9 \\cdot\\left(v_{i} v_{i+1}-1\\right)\n\n\\]\n\n(the last two are in fact one sequence prolonged in two possible directions)."}
{"id": "imo-shortlist-2017-n7", "question": "N7. Say that an ordered pair \\((x, y)\\) of integers is an irreducible lattice point if \\(x\\) and \\(y\\) are relatively prime. For any finite set \\(S\\) of irreducible lattice points, show that there is a homogenous polynomial in two variables, \\(f(x, y)\\), with integer coefficients, of degree at least 1 , such that \\(f(x, y)=1\\) for each \\((x, y)\\) in the set \\(S\\).\n\nNote: A homogenous polynomial of degree \\(n\\) is any nonzero polynomial of the form\n\n\\[\nf(x, y)=a_{0} x^{n}+a_{1} x^{n-1} y+a_{2} x^{n-2} y^{2}+\\cdots+a_{n-1} x y^{n-1}+a_{n} y^{n} .\n\\]", "category": "Number Theory", "source": "IMO Shortlist", "year": 2017, "solution": "First of all, we note that finding a homogenous polynomial \\(f(x, y)\\) such that \\(f(x, y)= \\pm 1\\) is enough, because we then have \\(f^{2}(x, y)=1\\). Label the irreducible lattice points \\(\\left(x_{1}, y_{1}\\right)\\) through \\(\\left(x_{n}, y_{n}\\right)\\). If any two of these lattice points \\(\\left(x_{i}, y_{i}\\right)\\) and \\(\\left(x_{j}, y_{j}\\right)\\) lie on the same line through the origin, then \\(\\left(x_{j}, y_{j}\\right)=\\left(-x_{i},-y_{i}\\right)\\) because both of the points are irreducible. We then have \\(f\\left(x_{j}, y_{j}\\right)= \\pm f\\left(x_{i}, y_{i}\\right)\\) whenever \\(f\\) is homogenous, so we can assume that no two of the lattice points are collinear with the origin by ignoring the extra lattice points.\n\nConsider the homogenous polynomials \\(\\ell_{i}(x, y)=y_{i} x-x_{i} y\\) and define\n\n\\[\ng_{i}(x, y)=\\prod_{j \\neq i} \\ell_{j}(x, y) .\n\\]\n\nThen \\(\\ell_{i}\\left(x_{j}, y_{j}\\right)=0\\) if and only if \\(j=i\\), because there is only one lattice point on each line through the origin. Thus, \\(g_{i}\\left(x_{j}, y_{j}\\right)=0\\) for all \\(j \\neq i\\). Define \\(a_{i}=g_{i}\\left(x_{i}, y_{i}\\right)\\), and note that \\(a_{i} \\neq 0\\).\n\nNote that \\(g_{i}(x, y)\\) is a degree \\(n-1\\) polynomial with the following two properties:\n\n\\begin{enumerate}\n  \\item \\(g_{i}\\left(x_{j}, y_{j}\\right)=0\\) if \\(j \\neq i\\).\n  \\item \\(g_{i}\\left(x_{i}, y_{i}\\right)=a_{i}\\).\n\n\nFor any \\(N \\geqslant n-1\\), there also exists a polynomial of degree \\(N\\) with the same two properties. Specifically, let \\(I_{i}(x, y)\\) be a degree 1 homogenous polynomial such that \\(I_{i}\\left(x_{i}, y_{i}\\right)=1\\), which exists since \\(\\left(x_{i}, y_{i}\\right)\\) is irreducible. Then \\(I_{i}(x, y)^{N-(n-1)} g_{i}(x, y)\\) satisfies both of the above properties and has degree \\(N\\).\n\nWe may now reduce the problem to the following claim:\nClaim: For each positive integer \\(a\\), there is a homogenous polynomial \\(f_{a}(x, y)\\), with integer coefficients, of degree at least 1 , such that \\(f_{a}(x, y) \\equiv 1(\\bmod a)\\) for all relatively prime \\((x, y)\\).\n\nTo see that this claim solves the problem, take \\(a\\) to be the least common multiple of the numbers \\(a_{i}(1 \\leqslant i \\leqslant n)\\). Take \\(f_{a}\\) given by the claim, choose some power \\(f_{a}(x, y)^{k}\\) that has degree at least \\(n-1\\), and subtract appropriate multiples of the \\(g_{i}\\) constructed above to obtain the desired polynomial.\n\nWe prove the claim by factoring \\(a\\). First, if \\(a\\) is a power of a prime ( \\(a=p^{k}\\) ), then we may choose either:\n\n\\begin{itemize}\n  \\item \\(f_{a}(x, y)=\\left(x^{p-1}+y^{p-1}\\right)^{\\phi(a)}\\) if \\(p\\) is odd;\n  \\item \\(f_{a}(x, y)=\\left(x^{2}+x y+y^{2}\\right)^{\\phi(a)}\\) if \\(p=2\\).\n\n\nNow suppose \\(a\\) is any positive integer, and let \\(a=q_{1} q_{2} \\cdots q_{k}\\), where the \\(q_{i}\\) are prime powers, pairwise relatively prime. Let \\(f_{q_{i}}\\) be the polynomials just constructed, and let \\(F_{q_{i}}\\) be powers of these that all have the same degree. Note that\n\n\\[\n\\frac{a}{q_{i}} F_{q_{i}}(x, y) \\equiv \\frac{a}{q_{i}} \\quad(\\bmod a)\n\\]\n\nfor any relatively prime \\(x, y\\). By Bzout's lemma, there is an integer linear combination of the \\(\\frac{a}{q_{i}}\\) that equals 1 . Thus, there is a linear combination of the \\(F_{q_{i}}\\) such that \\(F_{q_{i}}(x, y) \\equiv 1\\) \\((\\bmod a)\\) for any relatively prime \\((x, y)\\); and this polynomial is homogenous because all the \\(F_{q_{i}}\\) have the same degree.\n\nSolution 2. As in the previous solution, label the irreducible lattice points \\(\\left(x_{1}, y_{1}\\right), \\ldots,\\left(x_{n}, y_{n}\\right)\\) and assume without loss of generality that no two of the points are collinear with the origin. We induct on \\(n\\) to construct a homogenous polynomial \\(f(x, y)\\) such that \\(f\\left(x_{i}, y_{i}\\right)=1\\) for all \\(1 \\leqslant i \\leqslant n\\).\n\nIf \\(n=1\\) : Since \\(x_{1}\\) and \\(y_{1}\\) are relatively prime, there exist some integers \\(c, d\\) such that \\(c x_{1}+d y_{1}=1\\). Then \\(f(x, y)=c x+d y\\) is suitable.\n\nIf \\(n \\geqslant 2\\) : By the induction hypothesis we already have a homogeneous polynomial \\(g(x, y)\\) with \\(g\\left(x_{1}, y_{1}\\right)=\\ldots=g\\left(x_{n-1}, y_{n-1}\\right)=1\\). Let \\(j=\\operatorname{deg} g\\),\n\n\\[\ng_{n}(x, y)=\\prod_{k=1}^{n-1}\\left(y_{k} x-x_{k} y\\right)\n\\]\n\nand \\(a_{n}=g_{n}\\left(x_{n}, y_{n}\\right)\\). By assumption, \\(a_{n} \\neq 0\\). Take some integers \\(c, d\\) such that \\(c x_{n}+d y_{n}=1\\). We will construct \\(f(x, y)\\) in the form\n\n\\[\nf(x, y)=g(x, y)^{K}-C \\cdot g_{n}(x, y) \\cdot(c x+d y)^{L}\n\\]\n\nwhere \\(K\\) and \\(L\\) are some positive integers and \\(C\\) is some integer. We assume that \\(L=K j-n+1\\) so that \\(f\\) is homogenous.\n\nDue to \\(g\\left(x_{1}, y_{1}\\right)=\\ldots=g\\left(x_{n-1}, y_{n-1}\\right)=1\\) and \\(g_{n}\\left(x_{1}, y_{1}\\right)=\\ldots=g_{n}\\left(x_{n-1}, y_{n-1}\\right)=0\\), the property \\(f\\left(x_{1}, y_{1}\\right)=\\ldots=f\\left(x_{n-1}, y_{n-1}\\right)=1\\) is automatically satisfied with any choice of \\(K, L\\), and \\(C\\).\n\nFurthermore,\n\n\\[\nf\\left(x_{n}, y_{n}\\right)=g\\left(x_{n}, y_{n}\\right)^{K}-C \\cdot g_{n}\\left(x_{n}, y_{n}\\right) \\cdot\\left(c x_{n}+d y_{n}\\right)^{L}=g\\left(x_{n}, y_{n}\\right)^{K}-C a_{n}\n\\]\n\nIf we have an exponent \\(K\\) such that \\(g\\left(x_{n}, y_{n}\\right)^{K} \\equiv 1\\left(\\bmod a_{n}\\right)\\), then we may choose \\(C\\) such that \\(f\\left(x_{n}, y_{n}\\right)=1\\). We now choose such a \\(K\\).\n\nConsider an arbitrary prime divisor \\(p\\) of \\(a_{n}\\). By\n\n\\[\np \\mid a_{n}=g_{n}\\left(x_{n}, y_{n}\\right)=\\prod_{k=1}^{n-1}\\left(y_{k} x_{n}-x_{k} y_{n}\\right)\n\\]\n\nthere is some \\(1 \\leqslant k<n\\) such that \\(x_{k} y_{n} \\equiv x_{n} y_{k}(\\bmod p)\\). We first show that \\(x_{k} x_{n}\\) or \\(y_{k} y_{n}\\) is relatively prime with \\(p\\). This is trivial in the case \\(x_{k} y_{n} \\equiv x_{n} y_{k} \\not \\equiv 0(\\bmod p)\\). In the other case, we have \\(x_{k} y_{n} \\equiv x_{n} y_{k} \\equiv 0(\\bmod p)\\), If, say \\(p \\mid x_{k}\\), then \\(p \\nmid y_{k}\\) because ( \\(x_{k}, y_{k}\\) ) is irreducible, so \\(p \\mid x_{n}\\); then \\(p \\nmid y_{n}\\) because ( \\(x_{k}, y_{k}\\) ) is irreducible. In summary, \\(p \\mid x_{k}\\) implies \\(p \\nmid y_{k} y_{n}\\). Similarly, \\(p \\mid y_{n}\\) implies \\(p \\nmid x_{k} x_{n}\\).\n\nBy the homogeneity of \\(g\\) we have the congruences\n\n\\[\nx_{k}^{d} \\cdot g\\left(x_{n}, y_{n}\\right)=g\\left(x_{k} x_{n}, x_{k} y_{n}\\right) \\equiv g\\left(x_{k} x_{n}, y_{k} x_{n}\\right)=x_{n}^{d} \\cdot g\\left(x_{k}, y_{k}\\right)=x_{n}^{d} \\quad(\\bmod p)\n\\]\n\nand\n\n\\[\ny_{k}^{d} \\cdot g\\left(x_{n}, y_{n}\\right)=g\\left(y_{k} x_{n}, y_{k} y_{n}\\right) \\equiv g\\left(x_{k} y_{n}, y_{k} y_{n}\\right)=y_{n}^{d} \\cdot g\\left(x_{k}, y_{k}\\right)=y_{n}^{d} \\quad(\\bmod p)\n\\]\n\nIf \\(p \\nmid x_{k} x_{n}\\), then take the \\((p-1)^{s t}\\) power of (1.1); otherwise take the \\((p-1)^{s t}\\) power of (1.2); by Fermat's theorem, in both cases we get\n\n\\[\ng\\left(x_{n}, y_{n}\\right)^{p-1} \\equiv 1 \\quad(\\bmod p)\n\\]\n\nIf \\(p^{\\alpha} \\mid m\\), then we have\n\n\\[\ng\\left(x_{n}, y_{n}\\right)^{p^{\\alpha-1}(p-1)} \\equiv 1 \\quad\\left(\\bmod p^{\\alpha}\\right)\n\\]\n\nwhich implies that the exponent \\(K=n \\cdot \\varphi\\left(a_{n}\\right)\\), which is a multiple of all \\(p^{\\alpha-1}(p-1)\\), is a suitable choice. (The factor \\(n\\) is added only so that \\(K \\geqslant n\\) and so \\(L>0\\).)\n\nComment. It is possible to show that there is no constant \\(C\\) for which, given any two irreducible lattice points, there is some homogenous polynomial \\(f\\) of degree at most \\(C\\) with integer coefficients that takes the value 1 on the two points. Indeed, if one of the points is \\((1,0)\\) and the other is \\((a, b)\\), the polynomial \\(f(x, y)=a_{0} x^{n}+a_{1} x^{n-1} y+\\cdots+a_{n} y^{n}\\) should satisfy \\(a_{0}=1\\), and so \\(a^{n} \\equiv 1(\\bmod b)\\). If \\(a=3\\) and \\(b=2^{k}\\) with \\(k \\geqslant 3\\), then \\(n \\geqslant 2^{k-2}\\). If we choose \\(2^{k-2}>C\\), this gives a contradiction."}
{"id": "imo-shortlist-2017-n8", "question": "N8. Let \\(p\\) be an odd prime number and \\(\\mathbb{Z}_{>0}\\) be the set of positive integers. Suppose that a function \\(f: \\mathbb{Z}_{>0} \\times \\mathbb{Z}_{>0} \\rightarrow\\{0,1\\}\\) satisfies the following properties:\n\n\\begin{itemize}\n  \\item \\(f(1,1)=0\\);\n  \\item \\(f(a, b)+f(b, a)=1\\) for any pair of relatively prime positive integers \\((a, b)\\) not both equal to 1 ;\n  \\item \\(f(a+b, b)=f(a, b)\\) for any pair of relatively prime positive integers \\((a, b)\\).\n\n\nProve that\n\n\\[\n\\sum_{n=1}^{p-1} f\\left(n^{2}, p\\right) \\geqslant \\sqrt{2 p}-2\n\\]\n\n(Italy)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2017, "solution": "Denote by \\(\\mathbb{A}\\) the set of all pairs of coprime positive integers. Notice that for every \\((a, b) \\in \\mathbb{A}\\) there exists a pair \\((u, v) \\in \\mathbb{Z}^{2}\\) with \\(u a+v b=1\\). Moreover, if \\(\\left(u_{0}, v_{0}\\right)\\) is one such pair, then all such pairs are of the form \\((u, v)=\\left(u_{0}+k b, v_{0}-k a\\right)\\), where \\(k \\in \\mathbb{Z}\\). So there exists a unique such pair \\((u, v)\\) with \\(-b / 2<u \\leqslant b / 2\\); we denote this pair by \\((u, v)=g(a, b)\\).\nLemma. Let \\((a, b) \\in \\mathbb{A}\\) and \\((u, v)=g(a, b)\\). Then \\(f(a, b)=1 \\Longleftrightarrow u>0\\).\nProof. We induct on \\(a+b\\). The base case is \\(a+b=2\\). In this case, we have that \\(a=b=1\\), \\(g(a, b)=g(1,1)=(0,1)\\) and \\(f(1,1)=0\\), so the claim holds.\n\nAssume now that \\(a+b>2\\), and so \\(a \\neq b\\), since \\(a\\) and \\(b\\) are coprime. Two cases are possible.\nCase 1: \\(a>b\\).\nNotice that \\(g(a-b, b)=(u, v+u)\\), since \\(u(a-b)+(v+u) b=1\\) and \\(u \\in(-b / 2, b / 2]\\). Thus \\(f(a, b)=1 \\Longleftrightarrow f(a-b, b)=1 \\Longleftrightarrow u>0\\) by the induction hypothesis.\nCase 2: \\(a<b\\). (Then, clearly, \\(b \\geqslant 2\\).)\nNow we estimate \\(v\\). Since \\(v b=1-u a\\), we have\n\n\\[\n1+\\frac{a b}{2}>v b \\geqslant 1-\\frac{a b}{2}, \\quad \\text { so } \\quad \\frac{1+a}{2} \\geqslant \\frac{1}{b}+\\frac{a}{2}>v \\geqslant \\frac{1}{b}-\\frac{a}{2}>-\\frac{a}{2} .\n\\]\n\nThus \\(1+a>2 v>-a\\), so \\(a \\geqslant 2 v>-a\\), hence \\(a / 2 \\geqslant v>-a / 2\\), and thus \\(g(b, a)=(v, u)\\).\nObserve that \\(f(a, b)=1 \\Longleftrightarrow f(b, a)=0 \\Longleftrightarrow f(b-a, a)=0\\). We know from Case 1 that \\(g(b-a, a)=(v, u+v)\\). We have \\(f(b-a, a)=0 \\Longleftrightarrow v \\leqslant 0\\) by the inductive hypothesis. Then, since \\(b>a \\geqslant 1\\) and \\(u a+v b=1\\), we have \\(v \\leqslant 0 \\Longleftrightarrow u>0\\), and we are done.\n\nThe Lemma proves that, for all \\((a, b) \\in \\mathbb{A}, f(a, b)=1\\) if and only if the inverse of \\(a\\) modulo \\(b\\), taken in \\(\\{1,2, \\ldots, b-1\\}\\), is at most \\(b / 2\\). Then, for any odd prime \\(p\\) and integer \\(n\\) such that \\(n \\neq 0(\\bmod p), f\\left(n^{2}, p\\right)=1\\) iff the inverse of \\(n^{2} \\bmod p\\) is less than \\(p / 2\\). Since \\(\\left\\{n^{2} \\bmod p: 1 \\leqslant n \\leqslant p-1\\right\\}=\\left\\{n^{-2} \\bmod p: 1 \\leqslant n \\leqslant p-1\\right\\}\\), including multiplicities (two for each quadratic residue in each set), we conclude that the desired sum is twice the number of quadratic residues that are less than \\(p / 2\\), i.e.,\n\n\\[\n\\left.\\sum_{n=1}^{p-1} f\\left(n^{2}, p\\right)=2 \\left\\lvert\\,\\left\\{k: 1 \\leqslant k \\leqslant \\frac{p-1}{2} \\text { and } k^{2} \\bmod p<\\frac{p}{2}\\right\\}\\right. \\right\\rvert\\, .\n\\]\n\nSince the number of perfect squares in the interval \\([1, p / 2)\\) is \\(\\lfloor\\sqrt{p / 2}\\rfloor>\\sqrt{p / 2}-1\\), we conclude that\n\n\\[\n\\sum_{n=1}^{p-1} f\\left(n^{2}, p\\right)>2\\left(\\sqrt{\\frac{p}{2}}-1\\right)=\\sqrt{2 p}-2\n\\]\n\nSolution 2. We provide a different proof for the Lemma. For this purpose, we use continued fractions to find \\(g(a, b)=(u, v)\\) explicitly.\n\nThe function \\(f\\) is completely determined on \\(\\mathbb{A}\\) by the following\nClaim. Represent \\(a / b\\) as a continued fraction; that is, let \\(a_{0}\\) be an integer and \\(a_{1}, \\ldots, a_{k}\\) be positive integers such that \\(a_{k} \\geqslant 2\\) and\n\n\\[\n\\frac{a}{b}=a_{0}+\\frac{1}{a_{1}+\\frac{1}{a_{2}+\\frac{1}{\\cdots+\\frac{1}{a_{k}}}}}=\\left[a_{0} ; a_{1}, a_{2}, \\ldots, a_{k}\\right] .\n\\]\n\nThen \\(f(a, b)=0 \\Longleftrightarrow k\\) is even.\nProof. We induct on \\(b\\). If \\(b=1\\), then \\(a / b=[a]\\) and \\(k=0\\). Then, for \\(a \\geqslant 1\\), an easy induction shows that \\(f(a, 1)=f(1,1)=0\\).\n\nNow consider the case \\(b>1\\). Perform the Euclidean division \\(a=q b+r\\), with \\(0 \\leqslant r<b\\). We have \\(r \\neq 0\\) because \\(\\operatorname{gcd}(a, b)=1\\). Hence\n\n\\[\nf(a, b)=f(r, b)=1-f(b, r), \\quad \\frac{a}{b}=\\left[q ; a_{1}, \\ldots, a_{k}\\right], \\quad \\text { and } \\quad \\frac{b}{r}=\\left[a_{1} ; a_{2}, \\ldots, a_{k}\\right]\n\\]\n\nThen the number of terms in the continued fraction representations of \\(a / b\\) and \\(b / r\\) differ by one. Since \\(r<b\\), the inductive hypothesis yields\n\n\\[\nf(b, r)=0 \\Longleftrightarrow k-1 \\text { is even, }\n\\]\n\nand thus\n\n\\[\nf(a, b)=0 \\Longleftrightarrow f(b, r)=1 \\Longleftrightarrow k-1 \\text { is odd } \\Longleftrightarrow k \\text { is even. }\n\\]\n\nNow we use the following well-known properties of continued fractions to prove the Lemma:\nLet \\(p_{i}\\) and \\(q_{i}\\) be coprime positive integers with \\(\\left[a_{0} ; a_{1}, a_{2}, \\ldots, a_{i}\\right]=p_{i} / q_{i}\\), with the notation borrowed from the Claim. In particular, \\(a / b=\\left[a_{0} ; a_{1}, a_{2}, \\ldots, a_{k}\\right]=p_{k} / q_{k}\\). Assume that \\(k>0\\) and define \\(q_{-1}=0\\) if necessary. Then\n\n\\begin{itemize}\n  \\item \\(q_{k}=a_{k} q_{k-1}+q_{k-2}\\), and\n  \\item \\(a q_{k-1}-b p_{k-1}=p_{k} q_{k-1}-q_{k} p_{k-1}=(-1)^{k-1}\\).\n\n\nAssume that \\(k>0\\). Then \\(a_{k} \\geqslant 2\\), and\n\n\\[\nb=q_{k}=a_{k} q_{k-1}+q_{k-2} \\geqslant a_{k} q_{k-1} \\geqslant 2 q_{k-1} \\Longrightarrow q_{k-1} \\leqslant \\frac{b}{2},\n\\]\n\nwith strict inequality for \\(k>1\\), and\n\n\\[\n(-1)^{k-1} q_{k-1} a+(-1)^{k} p_{k-1} b=1\n\\]\n\nNow we finish the proof of the Lemma. It is immediate for \\(k=0\\). If \\(k=1\\), then \\((-1)^{k-1}=1\\), so\n\n\\[\n-b / 2<0 \\leqslant(-1)^{k-1} q_{k-1} \\leqslant b / 2 .\n\\]\n\nIf \\(k>1\\), we have \\(q_{k-1}<b / 2\\), so\n\n\\[\n-b / 2<(-1)^{k-1} q_{k-1}<b / 2 .\n\\]\n\nThus, for any \\(k>0\\), we find that \\(g(a, b)=\\left((-1)^{k-1} q_{k-1},(-1)^{k} p_{k-1}\\right)\\), and so\n\n\\[\nf(a, b)=1 \\Longleftrightarrow k \\text { is odd } \\Longleftrightarrow u=(-1)^{k-1} q_{k-1}>0\n\\]\n\nComment 1. The Lemma can also be established by observing that \\(f\\) is uniquely defined on \\(\\mathbb{A}\\), defining \\(f_{1}(a, b)=1\\) if \\(u>0\\) in \\(g(a, b)=(u, v)\\) and \\(f_{1}(a, b)=0\\) otherwise, and verifying that \\(f_{1}\\) satisfies all the conditions from the statement.\n\nIt seems that the main difficulty of the problem is in conjecturing the Lemma.\nComment 2. The case \\(p \\equiv 1(\\bmod 4)\\) is, in fact, easier than the original problem. We have, in general, for \\(1 \\leqslant a \\leqslant p-1\\),\n\\(f(a, p)=1-f(p, a)=1-f(p-a, a)=f(a, p-a)=f(a+(p-a), p-a)=f(p, p-a)=1-f(p-a, p)\\).\nIf \\(p \\equiv 1(\\bmod 4)\\), then \\(a\\) is a quadratic residue modulo \\(p\\) if and only if \\(p-a\\) is a quadratic residue modulo \\(p\\). Therefore, denoting by \\(r_{k}\\) (with \\(1 \\leqslant r_{k} \\leqslant p-1\\) ) the remainder of the division of \\(k^{2}\\) by \\(p\\), we get\n\n\\[\n\\sum_{n=1}^{p-1} f\\left(n^{2}, p\\right)=\\sum_{n=1}^{p-1} f\\left(r_{n}, p\\right)=\\frac{1}{2} \\sum_{n=1}^{p-1}\\left(f\\left(r_{n}, p\\right)+f\\left(p-r_{n}, p\\right)\\right)=\\frac{p-1}{2}\n\\]\n\nComment 3. The estimate for the sum \\(\\sum_{n=1}^{p} f\\left(n^{2}, p\\right)\\) can be improved by refining the final argument in Solution 1. In fact, one can prove that\n\n\\[\n\\sum_{n=1}^{p-1} f\\left(n^{2}, p\\right) \\geqslant \\frac{p-1}{16}\n\\]\n\nBy counting the number of perfect squares in the intervals \\([k p,(k+1 / 2) p)\\), we find that\n\n\\[\n\\sum_{n=1}^{p-1} f\\left(n^{2}, p\\right)=\\sum_{k=0}^{p-1}\\left(\\left\\lfloor\\sqrt{\\left(k+\\frac{1}{2}\\right) p}\\right\\rfloor-\\lfloor\\sqrt{k p}\\rfloor\\right)\n\\]\n\nEach summand of (2) is non-negative. We now estimate the number of positive summands. Suppose that a summand is zero, i.e.,\n\n\\[\n\\left\\lfloor\\sqrt{\\left(k+\\frac{1}{2}\\right) p}\\right\\rfloor=\\lfloor\\sqrt{k p}\\rfloor=: q\n\\]\n\nThen both of the numbers \\(k p\\) and \\(k p+p / 2\\) lie within the interval \\(\\left[q^{2},(q+1)^{2}\\right)\\). Hence\n\n\\[\n\\frac{p}{2}<(q+1)^{2}-q^{2}\n\\]\n\nwhich implies\n\n\\[\nq \\geqslant \\frac{p-1}{4}\n\\]\n\nSince \\(q \\leqslant \\sqrt{k p}\\), if the \\(k^{\\text {th }}\\) summand of (2) is zero, then\n\n\\[\nk \\geqslant \\frac{q^{2}}{p} \\geqslant \\frac{(p-1)^{2}}{16 p}>\\frac{p-2}{16} \\Longrightarrow k \\geqslant \\frac{p-1}{16}\n\\]\n\nSo at least the first \\(\\left\\lceil\\frac{p-1}{16}\\right\\rceil\\) summands (from \\(k=0\\) to \\(k=\\left\\lceil\\frac{p-1}{16}\\right\\rceil-1\\) ) are positive, and the result follows.\n\nComment 4. The bound can be further improved by using different methods. In fact, we prove that\n\n\\[\n\\sum_{n=1}^{p-1} f\\left(n^{2}, p\\right) \\geqslant \\frac{p-3}{4}\n\\]\n\nTo that end, we use the Legendre symbol\n\n\\[\n\\left(\\frac{a}{p}\\right)= \\begin{cases}0 & \\text { if } p \\mid a \\\\ 1 & \\text { if } a \\text { is a nonzero quadratic residue } \\bmod p \\\\ -1 & \\text { otherwise }\n\\]\n\nWe start with the following Claim, which tells us that there are not too many consecutive quadratic residues or consecutive quadratic non-residues.\n\nClaim. \\(\\sum_{n=1}^{p-1}\\left(\\frac{n}{p}\\right)\\left(\\frac{n+1}{p}\\right)=-1\\).\nProof. We have \\(\\left(\\frac{n}{p}\\right)\\left(\\frac{n+1}{p}\\right)=\\left(\\frac{n(n+1)}{p}\\right)\\). For \\(1 \\leqslant n \\leqslant p-1\\), we get that \\(n(n+1) \\equiv n^{2}\\left(1+n^{-1}\\right)(\\bmod p)\\), hence \\(\\left(\\frac{n(n+1)}{p}\\right)=\\left(\\frac{1+n^{-1}}{p}\\right)\\). Since \\(\\left\\{1+n^{-1} \\bmod p: 1 \\leqslant n \\leqslant p-1\\right\\}=\\{0,2,3, \\ldots, p-1 \\bmod p\\}\\), we find\n\n\\[\n\\sum_{n=1}^{p-1}\\left(\\frac{n}{p}\\right)\\left(\\frac{n+1}{p}\\right)=\\sum_{n=1}^{p-1}\\left(\\frac{1+n^{-1}}{p}\\right)=\\sum_{n=1}^{p-1}\\left(\\frac{n}{p}\\right)-1=-1,\n\\]\n\nbecause \\(\\sum_{n=1}^{p}\\left(\\frac{n}{p}\\right)=0\\).\nObserve that (1) becomes\n\n\\[\n\\sum_{n=1}^{p-1} f\\left(n^{2}, p\\right)=2|S|, \\quad S=\\left\\{r: 1 \\leqslant r \\leqslant \\frac{p-1}{2} \\text { and }\\left(\\frac{r}{p}\\right)=1\\right\\}\n\\]\n\nWe connect \\(S\\) with the sum from the claim by pairing quadratic residues and quadratic non-residues. To that end, define\n\n\\[\n\\begin{aligned}\nS^{\\prime} & =\\left\\{r: 1 \\leqslant r \\leqslant \\frac{p-1}{2} \\text { and }\\left(\\frac{r}{p}\\right)=-1\\right\\} \nT & =\\left\\{r: \\frac{p+1}{2} \\leqslant r \\leqslant p-1 \\text { and }\\left(\\frac{r}{p}\\right)=1\\right\\} \nT^{\\prime} & =\\left\\{r: \\frac{p+1}{2} \\leqslant r \\leqslant p-1 \\text { and }\\left(\\frac{r}{p}\\right)=-1\\right\\}\n\n\\]\n\nSince there are exactly \\((p-1) / 2\\) nonzero quadratic residues modulo \\(p,|S|+|T|=(p-1) / 2\\). Also we obviously have \\(|T|+\\left|T^{\\prime}\\right|=(p-1) / 2\\). Then \\(|S|=\\left|T^{\\prime}\\right|\\).\n\nFor the sake of brevity, define \\(t=|S|=\\left|T^{\\prime}\\right|\\). If \\(\\left(\\frac{n}{p}\\right)\\left(\\frac{n+1}{p}\\right)=-1\\), then exactly of one the numbers \\(\\left(\\frac{n}{p}\\right)\\) and \\(\\left(\\frac{n+1}{p}\\right)\\) is equal to 1 , so\n\n\\[\n\\left\\lvert\\,\\left\\{n: 1 \\leqslant n \\leqslant \\frac{p-3}{2} \\text { and }\\left(\\frac{n}{p}\\right)\\left(\\frac{n+1}{p}\\right)=-1\\right\\}|\\leqslant|S|+|S-1|=2 t\\right.\n\\]\n\nOn the other hand, if \\(\\left(\\frac{n}{p}\\right)\\left(\\frac{n+1}{p}\\right)=-1\\), then exactly one of \\(\\left(\\frac{n}{p}\\right)\\) and \\(\\left(\\frac{n+1}{p}\\right)\\) is equal to -1 , and\n\n\\[\n\\left\\lvert\\,\\left\\{n: \\frac{p+1}{2} \\leqslant n \\leqslant p-2 \\text { and }\\left(\\frac{n}{p}\\right)\\left(\\frac{n+1}{p}\\right)=-1\\right\\}\\left|\\leqslant\\left|T^{\\prime}\\right|+\\left|T^{\\prime}-1\\right|=2 t .\\right.\\right.\n\\]\n\nThus, taking into account that the middle term \\(\\left(\\frac{(p-1) / 2}{p}\\right)\\left(\\frac{(p+1) / 2}{p}\\right)\\) may happen to be -1 ,\n\n\\[\n\\left.\\left\\lvert\\,\\left\\{n: 1 \\leqslant n \\leqslant p-2 \\text { and }\\left(\\frac{n}{p}\\right)\\left(\\frac{n+1}{p}\\right)=-1\\right\\}\\right. \\right\\rvert\\, \\leqslant 4 t+1\n\\]\n\nThis implies that\n\n\\[\n\\left.\\left\\lvert\\,\\left\\{n: 1 \\leqslant n \\leqslant p-2 \\text { and }\\left(\\frac{n}{p}\\right)\\left(\\frac{n+1}{p}\\right)=1\\right\\}\\right. \\right\\rvert\\, \\geqslant(p-2)-(4 t+1)=p-4 t-3\n\\]\n\nand so\n\n\\[\n-1=\\sum_{n=1}^{p-1}\\left(\\frac{n}{p}\\right)\\left(\\frac{n+1}{p}\\right) \\geqslant p-4 t-3-(4 t+1)=p-8 t-4\n\\]\n\nwhich implies \\(8 t \\geqslant p-3\\), and thus\n\n\\[\n\\sum_{n=1}^{p-1} f\\left(n^{2}, p\\right)=2 t \\geqslant \\frac{p-3}{4}\n\\]\n\nComment 5. It is possible to prove that\n\n\\[\n\\sum_{n=1}^{p-1} f\\left(n^{2}, p\\right) \\geqslant \\frac{p-1}{2}\n\\]\n\nThe case \\(p \\equiv 1(\\bmod 4)\\) was already mentioned, and it is the equality case. If \\(p \\equiv 3(\\bmod 4)\\), then, by a theorem of Dirichlet, we have\n\n\\[\n\\left.\\left\\lvert\\,\\left\\{r: 1 \\leqslant r \\leqslant \\frac{p-1}{2} \\text { and }\\left(\\frac{r}{p}\\right)=1\\right\\}\\right. \\right\\rvert\\,>\\frac{p-1}{4}\n\\]\n\nwhich implies the result.\nSee \\href{https://en.wikipedia.org/wiki/Quadratic_residue#Dirichlet.27s_formulas}{https://en.wikipedia.org/wiki/Quadratic\\_residue\\#Dirichlet.27s\\_formulas} for the full statement of the theorem. It seems that no elementary proof of it is known; a proof using complex analysis is available, for instance, in Chapter 7 of the book Quadratic Residues and Non-Residues: Selected Topics, by Steve Wright, available in \\href{https://arxiv.org/abs/1408.0235}{https://arxiv.org/abs/1408.0235}."}
{"id": "imo-shortlist-2006-a1", "question": "A1. A sequence of real numbers \\(a_{0}, a_{1}, a_{2}, \\ldots\\) is defined by the formula\n\n\\[\na_{i+1}=\\left\\lfloor a_{i}\\right\\rfloor \\cdot\\left\\langle a_{i}\\right\\rangle \\quad \\text { for } \\quad i \\geq 0\n\\]\n\nhere \\(a_{0}\\) is an arbitrary real number, \\(\\left\\lfloor a_{i}\\right\\rfloor\\) denotes the greatest integer not exceeding \\(a_{i}\\), and \\(\\left\\langle a_{i}\\right\\rangle=a_{i}-\\left\\lfloor a_{i}\\right\\rfloor\\). Prove that \\(a_{i}=a_{i+2}\\) for \\(i\\) sufficiently large.", "category": "Algebra", "source": "IMO Shortlist", "year": 2006, "solution": "First note that if \\(a_{0} \\geq 0\\), then all \\(a_{i} \\geq 0\\). For \\(a_{i} \\geq 1\\) we have (in view of \\(\\left\\langle a_{i}\\right\\rangle<1\\) and \\(\\left\\lfloor a_{i}\\right\\rfloor>0\\) )\n\n\\[\n\\left\\lfloor a_{i+1}\\right\\rfloor \\leq a_{i+1}=\\left\\lfloor a_{i}\\right\\rfloor \\cdot\\left\\langle a_{i}\\right\\rangle<\\left\\lfloor a_{i}\\right\\rfloor ;\n\\]\n\nthe sequence \\(\\left\\lfloor a_{i}\\right\\rfloor\\) is strictly decreasing as long as its terms are in \\([1, \\infty)\\). Eventually there appears a number from the interval \\([0,1)\\) and all subsequent terms are 0 .\n\nNow pass to the more interesting situation where \\(a_{0}<0\\); then all \\(a_{i} \\leq 0\\). Suppose the sequence never hits 0 . Then we have \\(\\left\\lfloor a_{i}\\right\\rfloor \\leq-1\\) for all \\(i\\), and so\n\n\\[\n1+\\left\\lfloor a_{i+1}\\right\\rfloor>a_{i+1}=\\left\\lfloor a_{i}\\right\\rfloor \\cdot\\left\\langle a_{i}\\right\\rangle>\\left\\lfloor a_{i}\\right\\rfloor ;\n\\]\n\nthis means that the sequence \\(\\left\\lfloor a_{i}\\right\\rfloor\\) is nondecreasing. And since all its terms are integers from \\((-\\infty,-1]\\), this sequence must be constant from some term on:\n\n\\[\n\\left\\lfloor a_{i}\\right\\rfloor=c \\quad \\text { for } \\quad i \\geq i_{0} ; \\quad c \\text { a negative integer. }\n\\]\n\nThe defining formula becomes\n\n\\[\na_{i+1}=c \\cdot\\left\\langle a_{i}\\right\\rangle=c\\left(a_{i}-c\\right)=c a_{i}-c^{2}\n\\]\n\nConsider the sequence\n\n\\[\nb_{i}=a_{i}-\\frac{c^{2}}{c-1}\n\\]\n\nIt satisfies the recursion rule\n\n\\[\nb_{i+1}=a_{i+1}-\\frac{c^{2}}{c-1}=c a_{i}-c^{2}-\\frac{c^{2}}{c-1}=c b_{i}\n\\]\n\nimplying\n\n\\[\nb_{i}=c^{i-i_{0}} b_{i_{0}} \\quad \\text { for } \\quad i \\geq i_{0}\n\\]\n\nSince all the numbers \\(a_{i}\\) (for \\(i \\geq i_{0}\\) ) lie in \\([c, c+1)\\), the sequence \\(\\left(b_{i}\\right)\\) is bounded. The equation (2) can be satisfied only if either \\(b_{i_{0}}=0\\) or \\(|c|=1\\), i.e., \\(c=-1\\).\n\nIn the first case, \\(b_{i}=0\\) for all \\(i \\geq i_{0}\\), so that\n\n\\[\na_{i}=\\frac{c^{2}}{c-1} \\quad \\text { for } \\quad i \\geq i_{0}\n\\]\n\nIn the second case, \\(c=-1\\), equations (1) and (2) say that\n\n\\[\na_{i}=-\\frac{1}{2}+(-1)^{i-i_{0}} b_{i_{0}}= \\begin{cases}a_{i_{0}} & \\text { for } i=i_{0}, i_{0}+2, i_{0}+4, \\ldots \\\\ 1-a_{i_{0}} & \\text { for } i=i_{0}+1, i_{0}+3, i_{0}+5, \\ldots\n\\]\n\nSummarising, we see that (from some point on) the sequence \\(\\left(a_{i}\\right)\\) either is constant or takes alternately two values from the interval \\((-1,0)\\). The result follows.\nComment. There is nothing mysterious in introducing the sequence \\(\\left(b_{i}\\right)\\). The sequence \\(\\left(a_{i}\\right)\\) arises by iterating the function \\(x \\mapsto c x-c^{2}\\) whose unique fixed point is \\(c^{2} /(c-1)\\)."}
{"id": "imo-shortlist-2006-a2", "question": "A2. The sequence of real numbers \\(a_{0}, a_{1}, a_{2}, \\ldots\\) is defined recursively by\n\n\\[\na_{0}=-1, \\quad \\sum_{k=0}^{n} \\frac{a_{n-k}}{k+1}=0 \\quad \\text { for } \\quad n \\geq 1\n\\]\n\nShow that \\(a_{n}>0\\) for \\(n \\geq 1\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2006, "solution": "The proof goes by induction. For \\(n=1\\) the formula yields \\(a_{1}=1 / 2\\). Take \\(n \\geq 1\\), assume \\(a_{1}, \\ldots, a_{n}>0\\) and write the recurrence formula for \\(n\\) and \\(n+1\\), respectively as\n\n\\[\n\\sum_{k=0}^{n} \\frac{a_{k}}{n-k+1}=0 \\quad \\text { and } \\quad \\sum_{k=0}^{n+1} \\frac{a_{k}}{n-k+2}=0\n\\]\n\nSubtraction yields\n\n\\[\n\\begin{aligned}\n0=(n+2) \\sum_{k=0}^{n+1} & \\frac{a_{k}}{n-k+2}-(n+1) \\sum_{k=0}^{n} \\frac{a_{k}}{n-k+1} \n= & (n+2) a_{n+1}+\\sum_{k=0}^{n}\\left(\\frac{n+2}{n-k+2}-\\frac{n+1}{n-k+1}\\right) a_{k}\n\n\\]\n\nThe coefficient of \\(a_{0}\\) vanishes, so\n\n\\[\na_{n+1}=\\frac{1}{n+2} \\sum_{k=1}^{n}\\left(\\frac{n+1}{n-k+1}-\\frac{n+2}{n-k+2}\\right) a_{k}=\\frac{1}{n+2} \\sum_{k=1}^{n} \\frac{k}{(n-k+1)(n-k+2)} a_{k}\n\\]\n\nThe coefficients of \\(a_{1}, \\ldots, a_{n}\\) are all positive. Therefore, \\(a_{1}, \\ldots, a_{n}>0\\) implies \\(a_{n+1}>0\\).\nComment. Students familiar with the technique of generating functions will immediately recognise \\(\\sum a_{n} x^{n}\\) as the power series expansion of \\(x / \\ln (1-x)\\) (with value -1 at 0 ). But this can be a trap; attempts along these lines lead to unpleasant differential equations and integrals hard to handle. Using only tools from real analysis (e.g. computing the coefficients from the derivatives) seems very difficult.\n\nOn the other hand, the coefficients can be approached applying complex contour integrals and some other techniques from complex analysis and an attractive formula can be obtained for the coefficients:\n\n\\[\na_{n}=\\int_{1}^{\\infty} \\frac{\\mathrm{d} x}{x^{n}\\left(\\pi^{2}+\\log ^{2}(x-1)\\right)} \\quad(n \\geq 1)\n\\]\n\nwhich is evidently positive."}
{"id": "imo-shortlist-2006-a3", "question": "A3. The sequence \\(c_{0}, c_{1}, \\ldots, c_{n}, \\ldots\\) is defined by \\(c_{0}=1, c_{1}=0\\) and \\(c_{n+2}=c_{n+1}+c_{n}\\) for \\(n \\geq 0\\). Consider the set \\(S\\) of ordered pairs ( \\(x, y\\) ) for which there is a finite set \\(J\\) of positive integers such that \\(x=\\sum_{j \\in J} c_{j}, y=\\sum_{j \\in J} c_{j-1}\\). Prove that there exist real numbers \\(\\alpha, \\beta\\) and \\(m, M\\) with the following property: An ordered pair of nonnegative integers \\((x, y)\\) satisfies the inequality\n\n\\[\nm<\\alpha x+\\beta y<M\n\\]\n\nif and only if \\((x, y) \\in S\\).\nN. B. A sum over the elements of the empty set is assumed to be 0 .", "category": "Algebra", "source": "IMO Shortlist", "year": 2006, "solution": "Let \\(\\varphi=(1+\\sqrt{5}) / 2\\) and \\(\\psi=(1-\\sqrt{5}) / 2\\) be the roots of the quadratic equation \\(t^{2}-t-1=0\\). So \\(\\varphi \\psi=-1, \\varphi+\\psi=1\\) and \\(1+\\psi=\\psi^{2}\\). An easy induction shows that the general term \\(c_{n}\\) of the given sequence satisfies\n\n\\[\nc_{n}=\\frac{\\varphi^{n-1}-\\psi^{n-1}}{\\varphi-\\psi} \\quad \\text { for } n \\geq 0\n\\]\n\nSuppose that the numbers \\(\\alpha\\) and \\(\\beta\\) have the stated property, for appropriately chosen \\(m\\) and \\(M\\). Since \\(\\left(c_{n}, c_{n-1}\\right) \\in S\\) for each \\(n\\), the expression\n\\(\\alpha c_{n}+\\beta c_{n-1}=\\frac{\\alpha}{\\sqrt{5}}\\left(\\varphi^{n-1}-\\psi^{n-1}\\right)+\\frac{\\beta}{\\sqrt{5}}\\left(\\varphi^{n-2}-\\psi^{n-2}\\right)=\\frac{1}{\\sqrt{5}}\\left[(\\alpha \\varphi+\\beta) \\varphi^{n-2}-(\\alpha \\psi+\\beta) \\psi^{n-2}\\right]\\)\nis bounded as \\(n\\) grows to infinity. Because \\(\\varphi>1\\) and \\(-1<\\psi<0\\), this implies \\(\\alpha \\varphi+\\beta=0\\).\nTo satisfy \\(\\alpha \\varphi+\\beta=0\\), one can set for instance \\(\\alpha=\\psi, \\beta=1\\). We now find the required \\(m\\) and \\(M\\) for this choice of \\(\\alpha\\) and \\(\\beta\\).\n\nNote first that the above displayed equation gives \\(c_{n} \\psi+c_{n-1}=\\psi^{n-1}, n \\geq 1\\). In the sequel, we denote the pairs in \\(S\\) by ( \\(a_{J}, b_{J}\\) ), where \\(J\\) is a finite subset of the set \\(\\mathbb{N}\\) of positive integers and \\(a_{J}=\\sum_{j \\in J} c_{j}, b_{J}=\\sum_{j \\in J} c_{j-1}\\). Since \\(\\psi a_{J}+b_{J}=\\sum_{j \\in J}\\left(c_{j} \\psi+c_{j-1}\\right)\\), we obtain\n\n\\[\n\\psi a_{J}+b_{J}=\\sum_{j \\in J} \\psi^{j-1} \\quad \\text { for each }\\left(a_{J}, b_{J}\\right) \\in S\n\\]\n\nOn the other hand, in view of \\(-1<\\psi<0\\),\n\n\\[\n-1=\\frac{\\psi}{1-\\psi^{2}}=\\sum_{j=0}^{\\infty} \\psi^{2 j+1}<\\sum_{j \\in J} \\psi^{j-1}<\\sum_{j=0}^{\\infty} \\psi^{2 j}=\\frac{1}{1-\\psi^{2}}=1-\\psi=\\varphi\n\\]\n\nTherefore, according to (1),\n\n\\[\n-1<\\psi a_{J}+b_{J}<\\varphi \\quad \\text { for each }\\left(a_{J}, b_{J}\\right) \\in S\n\\]\n\nThus \\(m=-1\\) and \\(M=\\varphi\\) is an appropriate choice.\nConversely, we prove that if an ordered pair of nonnegative integers \\((x, y)\\) satisfies the inequality \\(-1<\\psi x+y<\\varphi\\) then \\((x, y) \\in S\\).\n\nLemma. Let \\(x, y\\) be nonnegative integers such that \\(-1<\\psi x+y<\\varphi\\). Then there exists a subset \\(J\\) of \\(\\mathbb{N}\\) such that\n\n\\[\n\\psi x+y=\\sum_{j \\in J} \\psi^{j-1}\n\\]\n\nProof. For \\(x=y=0\\) it suffices to choose the empty subset of \\(\\mathbb{N}\\) as \\(J\\), so let at least one of \\(x, y\\) be nonzero. There exist representations of \\(\\psi x+y\\) of the form\n\n\\[\n\\psi x+y=\\psi^{i_{1}}+\\cdots+\\psi^{i_{k}}\n\\]\n\nwhere \\(i_{1} \\leq \\cdots \\leq i_{k}\\) is a sequence of nonnegative integers, not necessarily distinct. For instance, we can take \\(x\\) summands \\(\\psi^{1}=\\psi\\) and \\(y\\) summands \\(\\psi^{0}=1\\). Consider all such representations of minimum length \\(k\\) and focus on the ones for which \\(i_{1}\\) has the minimum possible value \\(j_{1}\\). Among them, consider the representations where \\(i_{2}\\) has the minimum possible value \\(j_{2}\\). Upon choosing \\(j_{3}, \\ldots, j_{k}\\) analogously, we obtain a sequence \\(j_{1} \\leq \\cdots \\leq j_{k}\\) which clearly satisfies \\(\\psi x+y=\\sum_{r=1}^{k} \\psi^{j_{r}}\\). To prove the lemma, it suffices to show that \\(j_{1}, \\ldots, j_{k}\\) are pairwise distinct.\n\nSuppose on the contrary that \\(j_{r}=j_{r+1}\\) for some \\(r=1, \\ldots, k-1\\). Let us consider the case \\(j_{r} \\geq 2\\) first. Observing that \\(2 \\psi^{2}=1+\\psi^{3}\\), we replace \\(j_{r}\\) and \\(j_{r+1}\\) by \\(j_{r}-2\\) and \\(j_{r}+1\\), respectively. Since\n\n\\[\n\\psi^{j_{r}}+\\psi^{j_{r+1}}=2 \\psi^{j_{r}}=\\psi^{j_{r}-2}\\left(1+\\psi^{3}\\right)=\\psi^{j_{r}-2}+\\psi^{j_{r}+1}\n\\]\n\nthe new sequence also represents \\(\\psi x+y\\) as needed, and the value of \\(i_{r}\\) in it contradicts the minimum choice of \\(j_{r}\\).\n\nLet \\(j_{r}=j_{r+1}=0\\). Then the sum \\(\\psi x+y=\\sum_{r=1}^{k} \\psi^{j_{r}}\\) contains at least two summands equal to \\(\\psi^{0}=1\\). On the other hand \\(j_{s} \\neq 1\\) for all \\(s\\), because the equality \\(1+\\psi=\\psi^{2}\\) implies that a representation of minimum length cannot contain consecutive \\(i_{r}\\) 's. It follows that\n\n\\[\n\\psi x+y=\\sum_{r=1}^{k} \\psi^{j_{r}}>2+\\psi^{3}+\\psi^{5}+\\psi^{7}+\\cdots=2-\\psi^{2}=\\varphi\n\\]\n\ncontradicting the condition of the lemma.\nLet \\(j_{r}=j_{r+1}=1\\); then \\(\\sum_{r=1}^{k} \\psi^{j_{r}}\\) contains at least two summands equal to \\(\\psi^{1}=\\psi\\). Like in the case \\(j_{r}=j_{r+1}=0\\), we also infer that \\(j_{s} \\neq 0\\) and \\(j_{s} \\neq 2\\) for all \\(s\\). Therefore\n\n\\[\n\\psi x+y=\\sum_{r=1}^{k} \\psi^{j_{r}}<2 \\psi+\\psi^{4}+\\psi^{6}+\\psi^{8}+\\cdots=2 \\psi-\\psi^{3}=-1\n\\]\n\nwhich is a contradiction again. The conclusion follows.\nNow let the ordered pair \\((x, y)\\) satisfy \\(-1<\\psi x+y<\\varphi\\); hence the lemma applies to \\((x, y)\\). Let \\(J \\subset \\mathbb{N}\\) be such that (2) holds. Comparing (1) and (2), we conclude that \\(\\psi x+y=\\psi a_{J}+b_{J}\\). Now, \\(x, y, a_{J}\\) and \\(b_{J}\\) are integers, and \\(\\psi\\) is irrational. So the last equality implies \\(x=a_{J}\\) and \\(y=b_{J}\\). This shows that the numbers \\(\\alpha=\\psi, \\beta=1, m=-1, M=\\varphi\\) meet the requirements.\nComment. We present another way to prove the lemma, constructing the set \\(J\\) inductively. For \\(x=y=0\\), choose \\(J=\\emptyset\\). We induct on \\(n=3 x+2 y\\). Suppose that an appropriate set \\(J\\) exists when \\(3 x+2 y<n\\). Now assume \\(3 x+2 y=n>0\\). The current set \\(J\\) should be\n\n\\[\n\\text { either } \\quad 1 \\leq j_{1}<j_{2}<\\cdots<j_{k} \\quad \\text { or } \\quad j_{1}=0,1 \\leq j_{2}<\\cdots<j_{k}\n\\]\n\nThese sets fulfil the condition if\n\n\\[\n\\frac{\\psi x+y}{\\psi}=\\psi^{i_{1}-1}+\\cdots+\\psi^{i_{k}-1} \\quad \\text { or } \\quad \\frac{\\psi x+y-1}{\\psi}=\\psi^{i_{2}-1}+\\cdots+\\psi^{i_{k}-1}\n\\]\n\nrespectively; therefore it suffices to find an appropriate set for \\(\\frac{\\psi x+y}{\\psi}\\) or \\(\\frac{\\psi x+y-1}{\\psi}\\), respectively.\nConsider \\(\\frac{\\psi x+y}{\\psi}\\). Knowing that\n\n\\[\n\\frac{\\psi x+y}{\\psi}=x+(\\psi-1) y=\\psi y+(x-y)\n\\]\n\nlet \\(x^{\\prime}=y, y^{\\prime}=x-y\\) and test the induction hypothesis on these numbers. We require \\(\\frac{\\psi x+y}{\\psi} \\in(-1, \\varphi)\\) which is equivalent to\n\n\\[\n\\psi x+y \\in(\\varphi \\cdot \\psi,(-1) \\cdot \\psi)=(-1,-\\psi)\n\\]\n\nRelation (3) implies \\(y^{\\prime}=x-y \\geq-\\psi x-y>\\psi>-1\\); therefore \\(x^{\\prime}, y^{\\prime} \\geq 0\\). Moreover, we have \\(3 x^{\\prime}+2 y^{\\prime}=2 x+y \\leq \\frac{2}{3} n\\); therefore, if (3) holds then the induction applies: the numbers \\(x^{\\prime}, y^{\\prime}\\) are represented in the form as needed, hence \\(x, y\\) also.\n\nNow consider \\(\\frac{\\psi x+y-1}{\\psi}\\). Since\n\n\\[\n\\frac{\\psi x+y-1}{\\psi}=x+(\\psi-1)(y-1)=\\psi(y-1)+(x-y+1)\n\\]\n\nwe set \\(x^{\\prime}=y-1\\) and \\(y^{\\prime}=x-y+1\\). Again we require that \\(\\frac{\\psi x+y-1}{\\psi} \\in(-1, \\varphi)\\), i.e.\n\n\\[\n\\psi x+y \\in(\\varphi \\cdot \\psi+1,(-1) \\cdot \\psi+1)=(0, \\varphi)\n\\]\n\nIf (4) holds then \\(y-1 \\geq \\psi x+y-1>-1\\) and \\(x-y+1 \\geq-\\psi x-y+1>-\\varphi+1>-1\\), therefore \\(x^{\\prime}, y^{\\prime} \\geq 0\\). Moreover, \\(3 x^{\\prime}+2 y^{\\prime}=2 x+y-1<\\frac{2}{3} n\\) and the induction works.\n\nFinally, \\((-1,-\\psi) \\cup(0, \\varphi)=(-1, \\varphi)\\) so at least one of (3) and (4) holds and the induction step is justified."}
{"id": "imo-shortlist-2006-a4", "question": "A4. Prove the inequality\n\n\\[\n\\sum_{i<j} \\frac{a_{i} a_{j}}{a_{i}+a_{j}} \\leq \\frac{n}{2\\left(a_{1}+a_{2}+\\cdots+a_{n}\\right)} \\sum_{i<j} a_{i} a_{j}\n\\]\n\nfor positive real numbers \\(a_{1}, a_{2}, \\ldots, a_{n}\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2006, "solution": "Let \\(S=\\sum_{i} a_{i}\\). Denote by \\(L\\) and \\(R\\) the expressions on the left and right hand side of the proposed inequality. We transform \\(L\\) and \\(R\\) using the identity\n\n\\[\n\\sum_{i<j}\\left(a_{i}+a_{j}\\right)=(n-1) \\sum_{i} a_{i}\n\\]\n\nAnd thus:\n\n\\[\nL=\\sum_{i<j} \\frac{a_{i} a_{j}}{a_{i}+a_{j}}=\\sum_{i<j} \\frac{1}{4}\\left(a_{i}+a_{j}-\\frac{\\left(a_{i}-a_{j}\\right)^{2}}{a_{i}+a_{j}}\\right)=\\frac{n-1}{4} \\cdot S-\\frac{1}{4} \\sum_{i<j} \\frac{\\left(a_{i}-a_{j}\\right)^{2}}{a_{i}+a_{j}} .\n\\]\n\nTo represent \\(R\\) we express the sum \\(\\sum_{i<j} a_{i} a_{j}\\) in two ways; in the second transformation identity (1) will be applied to the squares of the numbers \\(a_{i}\\) :\n\n\\[\n\\begin{gathered}\n\\sum_{i<j} a_{i} a_{j}=\\frac{1}{2}\\left(S^{2}-\\sum_{i} a_{i}^{2}\\right) \n\\sum_{i<j} a_{i} a_{j}=\\frac{1}{2} \\sum_{i<j}\\left(a_{i}^{2}+a_{j}^{2}-\\left(a_{i}-a_{j}\\right)^{2}\\right)=\\frac{n-1}{2} \\cdot \\sum_{i} a_{i}^{2}-\\frac{1}{2} \\sum_{i<j}\\left(a_{i}-a_{j}\\right)^{2} .\n\n\\]\n\nMultiplying the first of these equalities by \\(n-1\\) and adding the second one we obtain\n\n\\[\nn \\sum_{i<j} a_{i} a_{j}=\\frac{n-1}{2} \\cdot S^{2}-\\frac{1}{2} \\sum_{i<j}\\left(a_{i}-a_{j}\\right)^{2} .\n\\]\n\nHence\n\n\\[\nR=\\frac{n}{2 S} \\sum_{i<j} a_{i} a_{j}=\\frac{n-1}{4} \\cdot S-\\frac{1}{4} \\sum_{i<j} \\frac{\\left(a_{i}-a_{j}\\right)^{2}}{S} .\n\\]\n\nNow compare (2) and (3). Since \\(S \\geq a_{i}+a_{j}\\) for any \\(i<j\\), the claim \\(L \\geq R\\) results.\n\nSolution 2. Let \\(S=a_{1}+a_{2}+\\cdots+a_{n}\\). For any \\(i \\neq j\\),\n\n\\[\n4 \\frac{a_{i} a_{j}}{a_{i}+a_{j}}=a_{i}+a_{j}-\\frac{\\left(a_{i}-a_{j}\\right)^{2}}{a_{i}+a_{j}} \\leq a_{i}+a_{j}-\\frac{\\left(a_{i}-a_{j}\\right)^{2}}{a_{1}+a_{2}+\\cdots+a_{n}}=\\frac{\\sum_{k \\neq i} a_{i} a_{k}+\\sum_{k \\neq j} a_{j} a_{k}+2 a_{i} a_{j}}{S} .\n\\]\n\nThe statement is obtained by summing up these inequalities for all pairs \\(i, j\\) :\n\n\\[\n\\begin{gathered}\n\\sum_{i<j} \\frac{a_{i} a_{j}}{a_{i}+a_{j}}=\\frac{1}{2} \\sum_{i} \\sum_{j \\neq i} \\frac{a_{i} a_{j}}{a_{i}+a_{j}} \\leq \\frac{1}{8 S} \\sum_{i} \\sum_{j \\neq i}\\left(\\sum_{k \\neq i} a_{i} a_{k}+\\sum_{k \\neq j} a_{j} a_{k}+2 a_{i} a_{j}\\right) \n=\\frac{1}{8 S}\\left(\\sum_{k} \\sum_{i \\neq k} \\sum_{j \\neq i} a_{i} a_{k}+\\sum_{k} \\sum_{j \\neq k} \\sum_{i \\neq j} a_{j} a_{k}+\\sum_{i} \\sum_{j \\neq i} 2 a_{i} a_{j}\\right) \n=\\frac{1}{8 S}\\left(\\sum_{k} \\sum_{i \\neq k}(n-1) a_{i} a_{k}+\\sum_{k} \\sum_{j \\neq k}(n-1) a_{j} a_{k}+\\sum_{i} \\sum_{j \\neq i} 2 a_{i} a_{j}\\right) \n=\\frac{n}{4 S} \\sum_{i} \\sum_{j \\neq i} a_{i} a_{j}=\\frac{n}{2 S} \\sum_{i<j} a_{i} a_{j} .\n\n\\]\n\nComment. Here is an outline of another possible approach. Examine the function \\(R-L\\) subject to constraints \\(\\sum_{i} a_{i}=S, \\sum_{i<j} a_{i} a_{j}=U\\) for fixed constants \\(S, U>0\\) (which can jointly occur as values of these symmetric forms). Suppose that among the numbers \\(a_{i}\\) there are some three, say \\(a_{k}, a_{l}, a_{m}\\) such that \\(a_{k}<a_{l} \\leq a_{m}\\). Then it is possible to decrease the value of \\(R-L\\) by perturbing this triple so that in the new triple \\(a_{k}^{\\prime}, a_{l}^{\\prime}, a_{m}^{\\prime}\\) one has \\(a_{k}^{\\prime}=a_{l}^{\\prime} \\leq a_{m}^{\\prime}\\), without touching the remaining \\(a_{i} \\mathrm{~s}\\) and without changing the values of \\(S\\) and \\(U\\); this requires some skill in algebraic manipulations. It follows that the constrained minimum can be only attained for \\(n-1\\) of the \\(a_{i}\\) s equal and a single one possibly greater. In this case, \\(R-L \\geq 0\\) holds almost trivially."}
{"id": "imo-shortlist-2006-a5", "question": "A5. Let \\(a, b, c\\) be the sides of a triangle. Prove that\n\n\\[\n\\frac{\\sqrt{b+c-a}}{\\sqrt{b}+\\sqrt{c}-\\sqrt{a}}+\\frac{\\sqrt{c+a-b}}{\\sqrt{c}+\\sqrt{a}-\\sqrt{b}}+\\frac{\\sqrt{a+b-c}}{\\sqrt{a}+\\sqrt{b}-\\sqrt{c}} \\leq 3 .\n\\]", "category": "Algebra", "source": "IMO Shortlist", "year": 2006, "solution": "Note first that the denominators are all positive, e.g. \\(\\sqrt{a}+\\sqrt{b}>\\sqrt{a+b}>\\sqrt{c}\\).\nLet \\(x=\\sqrt{b}+\\sqrt{c}-\\sqrt{a}, y=\\sqrt{c}+\\sqrt{a}-\\sqrt{b}\\) and \\(z=\\sqrt{a}+\\sqrt{b}-\\sqrt{c}\\). Then\n\n\\[\nb+c-a=\\left(\\frac{z+x}{2}\\right)^{2}+\\left(\\frac{x+y}{2}\\right)^{2}-\\left(\\frac{y+z}{2}\\right)^{2}=\\frac{x^{2}+x y+x z-y z}{2}=x^{2}-\\frac{1}{2}(x-y)(x-z)\n\\]\n\nand\n\n\\[\n\\frac{\\sqrt{b+c-a}}{\\sqrt{b}+\\sqrt{c}-\\sqrt{a}}=\\sqrt{1-\\frac{(x-y)(x-z)}{2 x^{2}}} \\leq 1-\\frac{(x-y)(x-z)}{4 x^{2}}\n\\]\n\napplying \\(\\sqrt{1+2 u} \\leq 1+u\\) in the last step. Similarly we obtain\n\n\\[\n\\frac{\\sqrt{c+a-b}}{\\sqrt{c}+\\sqrt{a}-\\sqrt{b}} \\leq 1-\\frac{(z-x)(z-y)}{4 z^{2}} \\quad \\text { and } \\quad \\frac{\\sqrt{a+b-c}}{\\sqrt{a}+\\sqrt{b}-\\sqrt{c}} \\leq 1-\\frac{(y-z)(y-x)}{4 y^{2}} .\n\\]\n\nSubstituting these quantities into the statement, it is sufficient to prove that\n\n\\[\n\\frac{(x-y)(x-z)}{x^{2}}+\\frac{(y-z)(y-x)}{y^{2}}+\\frac{(z-x)(z-y)}{z^{2}} \\geq 0\n\\]\n\nBy symmetry we can assume \\(x \\leq y \\leq z\\). Then\n\n\\[\n\\begin{gathered}\n\\frac{(x-y)(x-z)}{x^{2}}=\\frac{(y-x)(z-x)}{x^{2}} \\geq \\frac{(y-x)(z-y)}{y^{2}}=-\\frac{(y-z)(y-x)}{y^{2}} \n\\frac{(z-x)(z-y)}{z^{2}} \\geq 0\n\n\\]\n\nand (1) follows.\nComment 1. Inequality (1) is a special case of the well-known inequality\n\n\\[\nx^{t}(x-y)(x-z)+y^{t}(y-z)(y-x)+z^{t}(z-x)(z-y) \\geq 0\n\\]\n\nwhich holds for all positive numbers \\(x, y, z\\) and real \\(t\\); in our case \\(t=-2\\). Case \\(t>0\\) is called Schur's inequality. More generally, if \\(x \\leq y \\leq z\\) are real numbers and \\(p, q, r\\) are nonnegative numbers such that \\(q \\leq p\\) or \\(q \\leq r\\) then\n\n\\[\np(x-y)(x-z)+q(y-z)(y-x)+r(z-x)(z-y) \\geq 0\n\\]\n\nComment 2. One might also start using Cauchy-Schwarz' inequality (or the root mean square vs. arithmetic mean inequality) to the effect that\n\n\\[\n\\left(\\sum \\frac{\\sqrt{b+c-a}}{\\sqrt{b}+\\sqrt{c}-\\sqrt{a}}\\right)^{2} \\leq 3 \\cdot \\sum \\frac{b+c-a}{(\\sqrt{b}+\\sqrt{c}-\\sqrt{a})^{2}},\n\\]\n\nin cyclic sum notation. There are several ways to prove that the right-hand side of (2) never exceeds 9 (and this is just what we need). One of them is to introduce new variables \\(x, y, z\\), as in Solution 1, which upon some manipulation brings the problem again to inequality (1).\n\nAlternatively, the claim that right-hand side of (2) is not greater than 9 can be expressed in terms of the symmetric forms \\(\\sigma_{1}=\\sum x, \\sigma_{2}=\\sum x y, \\sigma_{3}=x y z\\) equivalently as\n\n\\[\n4 \\sigma_{1} \\sigma_{2} \\sigma_{3} \\leq \\sigma_{2}^{3}+9 \\sigma_{3}^{2}\n\\]\n\nwhich is a known inequality. A yet different method to deal with the right-hand expression in (2) is to consider \\(\\sqrt{a}, \\sqrt{b}, \\sqrt{c}\\) as sides of a triangle. Through standard trigonometric formulas the problem comes down to showing that\n\n\\[\np^{2} \\leq 4 R^{2}+4 R r+3 r^{2}\n\\]\n\n\\(p, R\\) and \\(r\\) standing for the semiperimeter, the circumradius and the inradius of that triangle. Again, (4) is another known inequality. Note that the inequalities (1), (3), (4) are equivalent statements about the same mathematical situation.\n\nSolution 2. Due to the symmetry of variables, it can be assumed that \\(a \\geq b \\geq c\\). We claim that\n\n\\[\n\\frac{\\sqrt{a+b-c}}{\\sqrt{a}+\\sqrt{b}-\\sqrt{c}} \\leq 1 \\quad \\text { and } \\quad \\frac{\\sqrt{b+c-a}}{\\sqrt{b}+\\sqrt{c}-\\sqrt{a}}+\\frac{\\sqrt{c+a-b}}{\\sqrt{c}+\\sqrt{a}-\\sqrt{b}} \\leq 2\n\\]\n\nThe first inequality follows from\n\n\\[\n\\sqrt{a+b-c}-\\sqrt{a}=\\frac{(a+b-c)-a}{\\sqrt{a+b-c}+\\sqrt{a}} \\leq \\frac{b-c}{\\sqrt{b}+\\sqrt{c}}=\\sqrt{b}-\\sqrt{c}\n\\]\n\nFor proving the second inequality, let \\(p=\\sqrt{a}+\\sqrt{b}\\) and \\(q=\\sqrt{a}-\\sqrt{b}\\). Then \\(a-b=p q\\) and the inequality becomes\n\n\\[\n\\frac{\\sqrt{c-p q}}{\\sqrt{c}-q}+\\frac{\\sqrt{c+p q}}{\\sqrt{c}+q} \\leq 2 .\n\\]\n\nFrom \\(a \\geq b \\geq c\\) we have \\(p \\geq 2 \\sqrt{c}\\). Applying the Cauchy-Schwarz inequality,\n\n\\[\n\\begin{aligned}\n& \\left(\\frac{\\sqrt{c-p q}}{\\sqrt{c}-q}+\\frac{\\sqrt{c+p q}}{\\sqrt{c}+q}\\right)^{2} \\leq\\left(\\frac{c-p q}{\\sqrt{c}-q}+\\frac{c+p q}{\\sqrt{c}+q}\\right)\\left(\\frac{1}{\\sqrt{c}-q}+\\frac{1}{\\sqrt{c}+q}\\right) \n& \\quad=\\frac{2\\left(c \\sqrt{c}-p q^{2}\\right)}{c-q^{2}} \\cdot \\frac{2 \\sqrt{c}}{c-q^{2}}=4 \\cdot \\frac{c^{2}-\\sqrt{c} p q^{2}}{\\left(c-q^{2}\\right)^{2}} \\leq 4 \\cdot \\frac{c^{2}-2 c q^{2}}{\\left(c-q^{2}\\right)^{2}} \\leq 4\n\n\\]"}
{"id": "imo-shortlist-2006-a6", "question": "A6. Determine the smallest number \\(M\\) such that the inequality\n\n\\[\n\\left|a b\\left(a^{2}-b^{2}\\right)+b c\\left(b^{2}-c^{2}\\right)+c a\\left(c^{2}-a^{2}\\right)\\right| \\leq M\\left(a^{2}+b^{2}+c^{2}\\right)^{2}\n\\]\n\nholds for all real numbers \\(a, b, c\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2006, "solution": "We first consider the cubic polynomial\n\n\\[\nP(t)=t b\\left(t^{2}-b^{2}\\right)+b c\\left(b^{2}-c^{2}\\right)+c t\\left(c^{2}-t^{2}\\right)\n\\]\n\nIt is easy to check that \\(P(b)=P(c)=P(-b-c)=0\\), and therefore\n\n\\[\nP(t)=(b-c)(t-b)(t-c)(t+b+c)\n\\]\n\nsince the cubic coefficient is \\(b-c\\). The left-hand side of the proposed inequality can therefore be written in the form\n\n\\[\n\\left|a b\\left(a^{2}-b^{2}\\right)+b c\\left(b^{2}-c^{2}\\right)+c a\\left(c^{2}-a^{2}\\right)\\right|=|P(a)|=|(b-c)(a-b)(a-c)(a+b+c)| .\n\\]\n\nThe problem comes down to finding the smallest number \\(M\\) that satisfies the inequality\n\n\\[\n|(b-c)(a-b)(a-c)(a+b+c)| \\leq M \\cdot\\left(a^{2}+b^{2}+c^{2}\\right)^{2}\n\\]\n\nNote that this expression is symmetric, and we can therefore assume \\(a \\leq b \\leq c\\) without loss of generality. With this assumption,\n\n\\[\n|(a-b)(b-c)|=(b-a)(c-b) \\leq\\left(\\frac{(b-a)+(c-b)}{2}\\right)^{2}=\\frac{(c-a)^{2}}{4}\n\\]\n\nwith equality if and only if \\(b-a=c-b\\), i.e. \\(2 b=a+c\\). Also\n\n\\[\n\\left(\\frac{(c-b)+(b-a)}{2}\\right)^{2} \\leq \\frac{(c-b)^{2}+(b-a)^{2}}{2}\n\\]\n\nor equivalently,\n\n\\[\n3(c-a)^{2} \\leq 2 \\cdot\\left[(b-a)^{2}+(c-b)^{2}+(c-a)^{2}\\right]\n\\]\n\nagain with equality only for \\(2 b=a+c\\). From (2) and (3) we get\n\n\\[\n\\begin{aligned}\n& |(b-c)(a-b)(a-c)(a+b+c)| \n\\leq & \\frac{1}{4} \\cdot\\left|(c-a)^{3}(a+b+c)\\right| \n= & \\frac{1}{4} \\cdot \\sqrt{(c-a)^{6}(a+b+c)^{2}} \n\\leq & \\frac{1}{4} \\cdot \\sqrt{\\left(\\frac{2 \\cdot\\left[(b-a)^{2}+(c-b)^{2}+(c-a)^{2}\\right]}{3}\\right)^{3} \\cdot(a+b+c)^{2}} \n= & \\frac{\\sqrt{2}}{2} \\cdot\\left(\\sqrt[4]{\\left(\\frac{(b-a)^{2}+(c-b)^{2}+(c-a)^{2}}{3}\\right)^{3} \\cdot(a+b+c)^{2}}\\right)^{2}\n\n\\]\n\nBy the weighted AM-GM inequality this estimate continues as follows:\n\n\\[\n\\begin{aligned}\n& |(b-c)(a-b)(a-c)(a+b+c)| \n\\leq & \\frac{\\sqrt{2}}{2} \\cdot\\left(\\frac{(b-a)^{2}+(c-b)^{2}+(c-a)^{2}+(a+b+c)^{2}}{4}\\right)^{2} \n= & \\frac{9 \\sqrt{2}}{32} \\cdot\\left(a^{2}+b^{2}+c^{2}\\right)^{2}\n\n\\]\n\nWe see that the inequality (1) is satisfied for \\(M=\\frac{9}{32} \\sqrt{2}\\), with equality if and only if \\(2 b=a+c\\) and\n\n\\[\n\\frac{(b-a)^{2}+(c-b)^{2}+(c-a)^{2}}{3}=(a+b+c)^{2} .\n\\]\n\nPlugging \\(b=(a+c) / 2\\) into the last equation, we bring it to the equivalent form\n\n\\[\n2(c-a)^{2}=9(a+c)^{2}\n\\]\n\nThe conditions for equality can now be restated as\n\n\\[\n2 b=a+c \\quad \\text { and } \\quad(c-a)^{2}=18 b^{2} .\n\\]\n\nSetting \\(b=1\\) yields \\(a=1-\\frac{3}{2} \\sqrt{2}\\) and \\(c=1+\\frac{3}{2} \\sqrt{2}\\). We see that \\(M=\\frac{9}{32} \\sqrt{2}\\) is indeed the smallest constant satisfying the inequality, with equality for any triple ( \\(a, b, c\\) ) proportional to ( \\(1-\\frac{3}{2} \\sqrt{2}, 1,1+\\frac{3}{2} \\sqrt{2}\\) ), up to permutation.\nComment. With the notation \\(x=b-a, y=c-b, z=a-c, s=a+b+c\\) and \\(r^{2}=a^{2}+b^{2}+c^{2}\\), the inequality (1) becomes just \\(|s x y z| \\leq M r^{4}\\) (with suitable constraints on \\(s\\) and \\(r\\) ). The original asymmetric inequality turns into a standard symmetric one; from this point on the solution can be completed in many ways. One can e.g. use the fact that, for fixed values of \\(\\sum x\\) and \\(\\sum x^{2}\\), the product \\(x y z\\) is a maximum/minimum only if some of \\(x, y, z\\) are equal, thus reducing one degree of freedom, etc.\n\nAs observed by the proposer, a specific attraction of the problem is that the maximum is attained at a point ( \\(a, b, c\\) ) with all coordinates distinct."}
{"id": "imo-shortlist-2006-c1", "question": "C1. We have \\(n \\geq 2\\) lamps \\(L_{1}, \\ldots, L_{n}\\) in a row, each of them being either on or off. Every second we simultaneously modify the state of each lamp as follows:\n\n\\begin{itemize}\n  \\item if the lamp \\(L_{i}\\) and its neighbours (only one neighbour for \\(i=1\\) or \\(i=n\\), two neighbours for other \\(i)\\) are in the same state, then \\(L_{i}\\) is switched off;\n  \\item otherwise, \\(L_{i}\\) is switched on.\n\n\nInitially all the lamps are off except the leftmost one which is on.\n(a) Prove that there are infinitely many integers \\(n\\) for which all the lamps will eventually be off.\n(b) Prove that there are infinitely many integers \\(n\\) for which the lamps will never be all off.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2006, "solution": "(a) Experiments with small \\(n\\) lead to the guess that every \\(n\\) of the form \\(2^{k}\\) should be good. This is indeed the case, and more precisely: let \\(A_{k}\\) be the \\(2^{k} \\times 2^{k}\\) matrix whose rows represent the evolution of the system, with entries 0,1 (for off and on respectively). The top row shows the initial state \\([1,0,0, \\ldots, 0]\\); the bottom row shows the state after \\(2^{k}-1\\) steps. The claim is that:\n\n\\[\n\\text { The bottom row of } A_{k} \\text { is }[1,1,1, \\ldots, 1] \\text {. }\n\\]\n\nThis will of course suffice because one more move then produces \\([0,0,0, \\ldots, 0]\\), as required.\nThe proof is by induction on \\(k\\). The base \\(k=1\\) is obvious. Assume the claim to be true for a \\(k \\geq 1\\) and write the matrix \\(A_{k+1}\\) in the block form \\(\\left(\\begin{array}{cc}A_{k} & O_{k} \\\\ B_{k} & C_{k}\\right)\\) with four \\(2^{k} \\times 2^{k}\\) matrices. After \\(m\\) steps, the last 1 in a row is at position \\(m+1\\). Therefore \\(O_{k}\\) is the zero matrix. According to the induction hypothesis, the bottom row of \\(\\left[A_{k} O_{k}\\right]\\) is \\([1, \\ldots, 1,0, \\ldots, 0]\\), with \\(2^{k}\\) ones and \\(2^{k}\\) zeros. The next row is thus\n\n\\[\n[\\underbrace{0, \\ldots, 0}_{2^{k}-1}, 1,1, \\underbrace{0, \\ldots, 0}_{2^{k}-1}]\n\\]\n\nIt is symmetric about its midpoint, and this symmetry is preserved in all subsequent rows because the procedure described in the problem statement is left/right symmetric. Thus \\(B_{k}\\) is the mirror image of \\(C_{k}\\). In particular, the rightmost column of \\(B_{k}\\) is identical with the leftmost column of \\(C_{k}\\).\n\nImagine the matrix \\(C_{k}\\) in isolation from the rest of \\(A_{k+1}\\). Suppose it is subject to evolution as defined in the problem: the first (leftmost) term in a row depends only on the two first terms in the preceding row, according as they are equal or not. Now embed \\(C_{k}\\) again in \\(A_{k}\\). The 'leftmost' terms in the rows of \\(C_{k}\\) now have neighbours on their left side-but these neighbours are their exact copies. Consequently the actual evolution within \\(C_{k}\\) is the same, whether or not \\(C_{k}\\) is considered as a piece of \\(A_{k+1}\\) or in isolation. And since the top row of \\(C_{k}\\) is \\([1,0, \\ldots, 0]\\), it follows that \\(C_{k}\\) is identical with \\(A_{k}\\).\n\nThe bottom row of \\(A_{k}\\) is \\([1,1, \\ldots, 1]\\); the same is the bottom row of \\(C_{k}\\), hence also of \\(B_{k}\\), which mirrors \\(C_{k}\\). So the bottom row of \\(A_{k+1}\\) consists of ones only and the induction is complete.\n(b) There are many ways to produce an infinite sequence of those \\(n\\) for which the state \\([0,0, \\ldots, 0]\\) will never be achieved. As an example, consider \\(n=2^{k}+1\\) (for \\(k \\geq 1\\) ). The evolution of the system can be represented by a matrix \\(\\mathcal{A}\\) of width \\(2^{k}+1\\) with infinitely many rows. The top \\(2^{k}\\) rows form the matrix \\(A_{k}\\) discussed above, with one column of zeros attached at its right.\n\nIn the next row we then have the vector \\([0,0, \\ldots, 0,1,1]\\). But this is just the second row of \\(\\mathcal{A}\\) reversed. Subsequent rows will be mirror copies of the foregoing ones, starting from the second one. So the configuration \\([1,1,0, \\ldots, 0,0]\\), i.e. the second row of \\(\\mathcal{A}\\), will reappear. Further rows will periodically repeat this pattern and there will be no row of zeros."}
{"id": "imo-shortlist-2006-c2", "question": "C2. A diagonal of a regular 2006-gon is called odd if its endpoints divide the boundary into two parts, each composed of an odd number of sides. Sides are also regarded as odd diagonals.\n\nSuppose the 2006-gon has been dissected into triangles by 2003 nonintersecting diagonals. Find the maximum possible number of isosceles triangles with two odd sides.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2006, "solution": "Call an isosceles triangle odd if it has two odd sides. Suppose we are given a dissection as in the problem statement. A triangle in the dissection which is odd and isosceles will be called iso-odd for brevity.\nLemma. Let \\(A B\\) be one of dissecting diagonals and let \\(\\mathcal{L}\\) be the shorter part of the boundary of the 2006-gon with endpoints \\(A, B\\). Suppose that \\(\\mathcal{L}\\) consists of \\(n\\) segments. Then the number of iso-odd triangles with vertices on \\(\\mathcal{L}\\) does not exceed \\(n / 2\\).\nProof. This is obvious for \\(n=2\\). Take \\(n\\) with \\(2<n \\leq 1003\\) and assume the claim to be true for every \\(\\mathcal{L}\\) of length less than \\(n\\). Let now \\(\\mathcal{L}\\) (endpoints \\(A, B\\) ) consist of \\(n\\) segments. Let \\(P Q\\) be the longest diagonal which is a side of an iso-odd triangle \\(P Q S\\) with all vertices on \\(\\mathcal{L}\\) (if there is no such triangle, there is nothing to prove). Every triangle whose vertices lie on \\(\\mathcal{L}\\) is obtuse or right-angled; thus \\(S\\) is the summit of \\(P Q S\\). We may assume that the five points \\(A, P, S, Q, B\\) lie on \\(\\mathcal{L}\\) in this order and partition \\(\\mathcal{L}\\) into four pieces \\(\\mathcal{L}_{A P}, \\mathcal{L}_{P S}, \\mathcal{L}_{S Q}, \\mathcal{L}_{Q B}\\) (the outer ones possibly reducing to a point).\n\nBy the definition of \\(P Q\\), an iso-odd triangle cannot have vertices on both \\(\\mathcal{L}_{A P}\\) and \\(\\mathcal{L}_{Q B}\\). Therefore every iso-odd triangle within \\(\\mathcal{L}\\) has all its vertices on just one of the four pieces. Applying to each of these pieces the induction hypothesis and adding the four inequalities we get that the number of iso-odd triangles within \\(\\mathcal{L}\\) other than \\(P Q S\\) does not exceed \\(n / 2\\). And since each of \\(\\mathcal{L}_{P S}, \\mathcal{L}_{S Q}\\) consists of an odd number of sides, the inequalities for these two pieces are actually strict, leaving a \\(1 / 2+1 / 2\\) in excess. Hence the triangle \\(P S Q\\) is also covered by the estimate \\(n / 2\\). This concludes the induction step and proves the lemma.\n\nThe remaining part of the solution in fact repeats the argument from the above proof. Consider the longest dissecting diagonal \\(X Y\\). Let \\(\\mathcal{L}_{X Y}\\) be the shorter of the two parts of the boundary with endpoints \\(X, Y\\) and let \\(X Y Z\\) be the triangle in the dissection with vertex \\(Z\\) not on \\(\\mathcal{L}_{X Y}\\). Notice that \\(X Y Z\\) is acute or right-angled, otherwise one of the segments \\(X Z, Y Z\\) would be longer than \\(X Y\\). Denoting by \\(\\mathcal{L}_{X Z}, \\mathcal{L}_{Y Z}\\) the two pieces defined by \\(Z\\) and applying the lemma to each of \\(\\mathcal{L}_{X Y}, \\mathcal{L}_{X Z}, \\mathcal{L}_{Y Z}\\) we infer that there are no more than \\(2006 / 2\\) iso-odd triangles in all, unless \\(X Y Z\\) is one of them. But in that case \\(X Z\\) and \\(Y Z\\) are odd diagonals and the corresponding inequalities are strict. This shows that also in this case the total number of iso-odd triangles in the dissection, including \\(X Y Z\\), is not greater than 1003 .\n\nThis bound can be achieved. For this to happen, it just suffices to select a vertex of the 2006-gon and draw a broken line joining every second vertex, starting from the selected one. Since 2006 is even, the line closes. This already gives us the required 1003 iso-odd triangles. Then we can complete the triangulation in an arbitrary fashion.\n\nSolution 2. Let the terms odd triangle and iso-odd triangle have the same meaning as in the first solution.\n\nLet \\(A B C\\) be an iso-odd triangle, with \\(A B\\) and \\(B C\\) odd sides. This means that there are an odd number of sides of the 2006-gon between \\(A\\) and \\(B\\) and also between \\(B\\) and \\(C\\). We say that these sides belong to the iso-odd triangle \\(A B C\\).\n\nAt least one side in each of these groups does not belong to any other iso-odd triangle. This is so because any odd triangle whose vertices are among the points between \\(A\\) and \\(B\\) has two sides of equal length and therefore has an even number of sides belonging to it in total. Eliminating all sides belonging to any other iso-odd triangle in this area must therefore leave one side that belongs to no other iso-odd triangle. Let us assign these two sides (one in each group) to the triangle \\(A B C\\).\n\nTo each iso-odd triangle we have thus assigned a pair of sides, with no two triangles sharing an assigned side. It follows that at most 1003 iso-odd triangles can appear in the dissection.\n\nThis value can be attained, as shows the example from the first solution."}
{"id": "imo-shortlist-2006-c3", "question": "C3. Let \\(S\\) be a finite set of points in the plane such that no three of them are on a line. For each convex polygon \\(P\\) whose vertices are in \\(S\\), let \\(a(P)\\) be the number of vertices of \\(P\\), and let \\(b(P)\\) be the number of points of \\(S\\) which are outside \\(P\\). Prove that for every real number \\(x\\)\n\n\\[\n\\sum_{P} x^{a(P)}(1-x)^{b(P)}=1\n\\]\n\nwhere the sum is taken over all convex polygons with vertices in \\(S\\).\nNB. A line segment, a point and the empty set are considered as convex polygons of 2,1 and 0 vertices, respectively.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2006, "solution": "For each convex polygon \\(P\\) whose vertices are in \\(S\\), let \\(c(P)\\) be the number of points of \\(S\\) which are inside \\(P\\), so that \\(a(P)+b(P)+c(P)=n\\), the total number of points in \\(S\\). Denoting \\(1-x\\) by \\(y\\),\n\n\\[\n\\sum_{P} x^{a(P)} y^{b(P)}=\\sum_{P} x^{a(P)} y^{b(P)}(x+y)^{c(P)}=\\sum_{P} \\sum_{i=0}^{c(P)}\\binom{c(P)}{i} x^{a(P)+i} y^{b(P)+c(P)-i}\n\\]\n\nView this expression as a homogeneous polynomial of degree \\(n\\) in two independent variables \\(x, y\\). In the expanded form, it is the sum of terms \\(x^{r} y^{n-r}(0 \\leq r \\leq n)\\) multiplied by some nonnegative integer coefficients.\n\nFor a fixed \\(r\\), the coefficient of \\(x^{r} y^{n-r}\\) represents the number of ways of choosing a convex polygon \\(P\\) and then choosing some of the points of \\(S\\) inside \\(P\\) so that the number of vertices of \\(P\\) and the number of chosen points inside \\(P\\) jointly add up to \\(r\\).\n\nThis corresponds to just choosing an \\(r\\)-element subset of \\(S\\). The correspondence is bijective because every set \\(T\\) of points from \\(S\\) splits in exactly one way into the union of two disjoint subsets, of which the first is the set of vertices of a convex polygon - namely, the convex hull of \\(T\\) - and the second consists of some points inside that polygon.\n\nSo the coefficient of \\(x^{r} y^{n-r}\\) equals \\(\\binom{n}{r}\\). The desired result follows:\n\n\\[\n\\sum_{P} x^{a(P)} y^{b(P)}=\\sum_{r=0}^{n}\\binom{n}{r} x^{r} y^{n-r}=(x+y)^{n}=1\n\\]\n\nSolution 2. Apply induction on the number \\(n\\) of points. The case \\(n=0\\) is trivial. Let \\(n>0\\) and assume the statement for less than \\(n\\) points. Take a set \\(S\\) of \\(n\\) points.\n\nLet \\(C\\) be the set of vertices of the convex hull of \\(S\\), let \\(m=|C|\\).\nLet \\(X \\subset C\\) be an arbitrary nonempty set. For any convex polygon \\(P\\) with vertices in the set \\(S \\backslash X\\), we have \\(b(P)\\) points of \\(S\\) outside \\(P\\). Excluding the points of \\(X\\) - all outside \\(P\\) - the set \\(S \\backslash X\\) contains exactly \\(b(P)-|X|\\) of them. Writing \\(1-x=y\\), by the induction hypothesis\n\n\\[\n\\sum_{P \\subset S \\backslash X} x^{a(P)} y^{b(P)-|X|}=1\n\\]\n\n(where \\(P \\subset S \\backslash X\\) means that the vertices of \\(P\\) belong to the set \\(S \\backslash X\\) ). Therefore\n\n\\[\n\\sum_{P \\subset S \\backslash X} x^{a(P)} y^{b(P)}=y^{|X|} .\n\\]\n\nAll convex polygons appear at least once, except the convex hull \\(C\\) itself. The convex hull adds \\(x^{m}\\). We can use the inclusion-exclusion principle to compute the sum of the other terms:\n\n\\[\n\\begin{gathered}\n\\sum_{P \\neq C} x^{a(P)} y^{b(P)}=\\sum_{k=1}^{m}(-1)^{k-1} \\sum_{|X|=k} \\sum_{P \\subset S \\backslash X} x^{a(P)} y^{b(P)}=\\sum_{k=1}^{m}(-1)^{k-1} \\sum_{|X|=k} y^{k} \n=\\sum_{k=1}^{m}(-1)^{k-1}\\binom{m}{k} y^{k}=-\\left((1-y)^{m}-1\\right)=1-x^{m}\n\n\\]\n\nand then\n\n\\[\n\\sum_{P} x^{a(P)} y^{b(P)}=\\sum_{P=C}+\\sum_{P \\neq C}=x^{m}+\\left(1-x^{m}\\right)=1 .\n\\]"}
{"id": "imo-shortlist-2006-c4", "question": "C4. A cake has the form of an \\(n \\times n\\) square composed of \\(n^{2}\\) unit squares. Strawberries lie on some of the unit squares so that each row or column contains exactly one strawberry; call this arrangement \\(\\mathcal{A}\\).\n\nLet \\(\\mathcal{B}\\) be another such arrangement. Suppose that every grid rectangle with one vertex at the top left corner of the cake contains no fewer strawberries of arrangement \\(\\mathcal{B}\\) than of arrangement \\(\\mathcal{A}\\). Prove that arrangement \\(\\mathcal{B}\\) can be obtained from \\(\\mathcal{A}\\) by performing a number of switches, defined as follows:\n\nA switch consists in selecting a grid rectangle with only two strawberries, situated at its top right corner and bottom left corner, and moving these two strawberries to the other two corners of that rectangle.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2006, "solution": "We use capital letters to denote unit squares; \\(O\\) is the top left corner square. For any two squares \\(X\\) and \\(Y\\) let \\([X Y]\\) be the smallest grid rectangle containing these two squares. Strawberries lie on some squares in arrangement \\(\\mathcal{A}\\). Put a plum on each square of the target configuration \\(\\mathcal{B}\\). For a square \\(X\\) denote by \\(a(X)\\) and \\(b(X)\\) respectively the number of strawberries and the number of plums in \\([O X]\\). By hypothesis \\(a(X) \\leq b(X)\\) for each \\(X\\), with strict inequality for some \\(X\\) (otherwise the two arrangements coincide and there is nothing to prove).\n\nThe idea is to show that by a legitimate switch one can obtain an arrangement \\(\\mathcal{A}^{\\prime}\\) such that\n\n\\[\na(X) \\leq a^{\\prime}(X) \\leq b(X) \\quad \\text { for each } X ; \\quad \\sum_{X} a(X)<\\sum_{X} a^{\\prime}(X)\n\\]\n\n(with \\(a^{\\prime}(X)\\) defined analogously to \\(a(X)\\); the sums range over all unit squares \\(X\\) ). This will be enough because the same reasoning then applies to \\(\\mathcal{A}^{\\prime}\\), giving rise to a new arrangement \\(\\mathcal{A}^{\\prime \\prime}\\), and so on (induction). Since \\(\\sum a(X)<\\sum a^{\\prime}(X)<\\sum a^{\\prime \\prime}(X)<\\ldots\\) and all these sums do not exceed \\(\\sum b(X)\\), we eventually obtain a sum with all summands equal to the respective \\(b(X) \\mathrm{s}\\); all strawberries will meet with plums.\n\nConsider the uppermost row in which the plum and the strawberry lie on different squares \\(P\\) and \\(S\\) (respectively); clearly \\(P\\) must be situated left to \\(S\\). In the column passing through \\(P\\), let \\(T\\) be the top square and \\(B\\) the bottom square. The strawberry in that column lies below the plum (because there is no plum in that column above \\(P\\), and the positions of strawberries and plums coincide everywhere above the row of \\(P\\) ). Hence there is at least one strawberry in the region \\([B S]\\) below \\([P S]\\). Let \\(V\\) be the position of the uppermost strawberry in that region.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b870456914a15f8830dfg-25}\n\nDenote by \\(W\\) the square at the intersection of the row through \\(V\\) with the column through \\(S\\) and let \\(R\\) be the square vertex-adjacent to \\(W\\) up-left. We claim that\n\n\\[\na(X)<b(X) \\quad \\text { for all } \\quad X \\in[P R] .\n\\]\n\nThis is so because if \\(X \\in[P R]\\) then the portion of \\([O X]\\) left to column \\([T B]\\) contains at least as many plums as strawberries (the hypothesis of the problem); in the portion above the row through \\(P\\) and \\(S\\) we have perfect balance; and in the remaining portion, i.e. rectangle \\([P X]\\) we have a plum on square \\(P\\) and no strawberry at all.\n\nNow we are able to perform the required switch. Let \\(U\\) be the square at the intersection of the row through \\(P\\) with the column through \\(V\\) (some of \\(P, U, R\\) can coincide). We move strawberries from squares \\(S\\) and \\(V\\) to squares \\(U\\) and \\(W\\). Then\n\n\\[\na^{\\prime}(X)=a(X)+1 \\quad \\text { for } \\quad X \\in[U R] ; \\quad a^{\\prime}(X)=a(X) \\quad \\text { for other } X .\n\\]\n\nAnd since the rectangle \\([U R]\\) is contained in \\([P R]\\), we still have \\(a^{\\prime}(X) \\leq b(X)\\) for all \\(S\\), in view of (2); conditions (1) are satisfied and the proof is complete."}
{"id": "imo-shortlist-2006-c5", "question": "C5. An ( \\(n, k\\) )-tournament is a contest with \\(n\\) players held in \\(k\\) rounds such that:\n(i) Each player plays in each round, and every two players meet at most once.\n(ii) If player \\(A\\) meets player \\(B\\) in round \\(i\\), player \\(C\\) meets player \\(D\\) in round \\(i\\), and player \\(A\\) meets player \\(C\\) in round \\(j\\), then player \\(B\\) meets player \\(D\\) in round \\(j\\).\n\nDetermine all pairs ( \\(n, k\\) ) for which there exists an ( \\(n, k\\) )-tournament.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2006, "solution": "For each \\(k\\), denote by \\(t_{k}\\) the unique integer such that \\(2^{t_{k}-1}<k+1 \\leq 2^{t_{k}}\\). We show that an ( \\(n, k\\) )-tournament exists if and only if \\(2^{t_{k}}\\) divides \\(n\\).\n\nFirst we prove that if \\(n=2^{t}\\) for some \\(t\\) then there is an ( \\(n, k\\) )-tournament for all \\(k \\leq 2^{t}-1\\). Let \\(S\\) be the set of \\(0-1\\) sequences with length \\(t\\). We label the \\(2^{t}\\) players with the elements of \\(S\\) in an arbitrary fashion (which is possible as there are exactly \\(2^{t}\\) sequences in \\(S\\) ). Players are identified with their labels in the construction below. If \\(\\alpha, \\beta \\in S\\), let \\(\\alpha+\\beta \\in S\\) be the result of the modulo 2 term-by-term addition of \\(\\alpha\\) and \\(\\beta\\) (with rules \\(0+0=0,0+1=1+0=1\\), \\(1+1=0\\); there is no carryover). For each \\(i=1, \\ldots, 2^{t}-1\\) let \\(\\omega(i) \\in S\\) be the sequence of base 2 digits of \\(i\\), completed with leading zeros if necessary to achieve length \\(t\\).\n\nNow define a tournament with \\(n=2^{t}\\) players in \\(k \\leq 2^{t}-1\\) rounds as follows: For all \\(i=1, \\ldots, k\\), let player \\(\\alpha\\) meet player \\(\\alpha+\\omega(i)\\) in round \\(i\\). The tournament is well-defined as \\(\\alpha+\\omega(i) \\in S\\) and \\(\\alpha+\\omega(i)=\\beta+\\omega(i)\\) implies \\(\\alpha=\\beta\\); also \\([\\alpha+\\omega(i)]+\\omega(i)=\\alpha\\) for each \\(\\alpha \\in S\\) (meaning that player \\(\\alpha+\\omega(i)\\) meets player \\(\\alpha\\) in round \\(i\\), as needed). Each player plays in each round. Next, every two players meet at most once (exactly once if \\(k=2^{t}-1\\) ), since \\(\\omega(i) \\neq \\omega(j)\\) if \\(i \\neq j\\). Thus condition (i) holds true, and condition (ii) is also easy to check.\n\nLet player \\(\\alpha\\) meet player \\(\\beta\\) in round \\(i\\), player \\(\\gamma\\) meet player \\(\\delta\\) in round \\(i\\), and player \\(\\alpha\\) meet player \\(\\gamma\\) in round \\(j\\). Then \\(\\beta=\\alpha+\\omega(i), \\delta=\\gamma+\\omega(i)\\) and \\(\\gamma=\\alpha+\\omega(j)\\). By definition, \\(\\beta\\) will play in round \\(j\\) with\n\n\\[\n\\beta+\\omega(j)=[\\alpha+\\omega(i)]+\\omega(j)=[\\alpha+\\omega(j)]+\\omega(i)=\\gamma+\\omega(i)=\\delta,\n\\]\n\nas required by (ii).\nSo there exists an ( \\(n, k\\) )-tournament for pairs ( \\(n, k\\) ) such that \\(n=2^{t}\\) and \\(k \\leq 2^{t}-1\\). The same conclusion is straightforward for \\(n\\) of the form \\(n=2^{t} s\\) and \\(k \\leq 2^{t}-1\\). Indeed, consider \\(s\\) different \\(\\left(2^{t}, k\\right)\\)-tournaments \\(T_{1}, \\ldots, T_{s}\\), no two of them having players in common. Their union can be regarded as a ( \\(2^{t} s, k\\) )-tournament \\(T\\) where each round is the union of the respective rounds in \\(T_{1}, \\ldots, T_{s}\\).\n\nIn summary, the condition that \\(2^{t_{k}}\\) divides \\(n\\) is sufficient for an \\((n, k)\\)-tournament to exist. We prove that it is also necessary.\n\nConsider an arbitrary ( \\(n, k\\) )-tournament. Represent each player by a point and after each round, join by an edge every two players who played in this round. Thus to a round \\(i=1, \\ldots, k\\) there corresponds a graph \\(G_{i}\\). We say that player \\(Q\\) is an \\(i\\)-neighbour of player \\(P\\) if there is a path of edges in \\(G_{i}\\) from \\(P\\) to \\(Q\\); in other words, if there are players \\(P=X_{1}, X_{2}, \\ldots, X_{m}=Q\\) such that player \\(X_{j}\\) meets player \\(X_{j+1}\\) in one of the first \\(i\\) rounds, \\(j=1,2 \\ldots, m-1\\). The set of \\(i\\)-neighbours of a player will be called its \\(i\\)-component. Clearly two \\(i\\)-components are either disjoint or coincide.\n\nHence after each round \\(i\\) the set of players is partitioned into pairwise disjoint \\(i\\)-components. So, to achieve our goal, it suffices to show that all \\(k\\)-components have size divisible by \\(2^{t_{k}}\\).\n\nTo this end, let us see how the \\(i\\)-component \\(\\Gamma\\) of a player \\(A\\) changes after round \\(i+1\\). Suppose that \\(A\\) meets player \\(B\\) with \\(i\\)-component \\(\\Delta\\) in round \\(i+1\\) (components \\(\\Gamma\\) and \\(\\Delta\\) are not necessarily distinct). We claim that then in round \\(i+1\\) each player from \\(\\Gamma\\) meets a player from \\(\\Delta\\), and vice versa.\n\nIndeed, let \\(C\\) be any player in \\(\\Gamma\\), and let \\(C\\) meet \\(D\\) in round \\(i+1\\). Since \\(C\\) is an \\(i\\)-neighbour of \\(A\\), there is a sequence of players \\(A=X_{1}, X_{2}, \\ldots, X_{m}=C\\) such that \\(X_{j}\\) meets \\(X_{j+1}\\) in one of the first \\(i\\) rounds, \\(j=1,2 \\ldots, m-1\\). Let \\(X_{j}\\) meet \\(Y_{j}\\) in round \\(i+1\\), for \\(j=1,2 \\ldots, m\\); in particular \\(Y_{1}=B\\) and \\(Y_{m}=D\\). Players \\(Y_{j}\\) exists in view of condition (i). Suppose that \\(X_{j}\\) and \\(X_{j+1}\\) met in round \\(r\\), where \\(r \\leq i\\). Then condition (ii) implies that and \\(Y_{j}\\) and \\(Y_{j+1}\\) met in round \\(r\\), too. Hence \\(B=Y_{1}, Y_{2}, \\ldots, Y_{m}=D\\) is a path in \\(G_{i}\\) from \\(B\\) to \\(D\\). This is to say, \\(D\\) is in the \\(i\\)-component \\(\\Delta\\) of \\(B\\), as claimed. By symmetry, each player from \\(\\Delta\\) meets a player from \\(\\Gamma\\) in round \\(i+1\\). It follows in particular that \\(\\Gamma\\) and \\(\\Delta\\) have the same cardinality.\n\nIt is straightforward now that the \\((i+1)\\)-component of \\(A\\) is \\(\\Gamma \\cup \\Delta\\), the union of two sets with the same size. Since \\(\\Gamma\\) and \\(\\Delta\\) are either disjoint or coincide, we have either \\(|\\Gamma \\cup \\Delta|=2|\\Gamma|\\) or \\(|\\Gamma \\cup \\Delta|=|\\Gamma|\\); as usual, \\(|\\cdots|\\) denotes the cardinality of a finite set.\n\nLet \\(\\Gamma_{1}, \\ldots, \\Gamma_{k}\\) be the consecutive components of a given player \\(A\\). We obtained that either \\(\\left|\\Gamma_{i+1}\\right|=2\\left|\\Gamma_{i}\\right|\\) or \\(\\left|\\Gamma_{i+1}\\right|=\\left|\\Gamma_{i}\\right|\\) for \\(i=1, \\ldots, k-1\\). Because \\(\\left|\\Gamma_{1}\\right|=2\\), each \\(\\left|\\Gamma_{i}\\right|\\) is a power of 2 , \\(i=1, \\ldots, k-1\\). In particular \\(\\left|\\Gamma_{k}\\right|=2^{u}\\) for some \\(u\\).\n\nOn the other hand, player \\(A\\) has played with \\(k\\) different opponents by (i). All of them belong to \\(\\Gamma_{k}\\), therefore \\(\\left|\\Gamma_{k}\\right| \\geq k+1\\).\n\nThus \\(2^{u} \\geq k+1\\), and since \\(t_{k}\\) is the least integer satisfying \\(2^{t_{k}} \\geq k+1\\), we conclude that \\(u \\geq t_{k}\\). So the size of each \\(k\\)-component is divisible by \\(2^{t_{k}}\\), which completes the argument."}
{"id": "imo-shortlist-2006-c6", "question": "C6. A holey triangle is an upward equilateral triangle of side length \\(n\\) with \\(n\\) upward unit triangular holes cut out. A diamond is a \\(60^{\\circ}-120^{\\circ}\\) unit rhombus. Prove that a holey triangle \\(T\\) can be tiled with diamonds if and only if the following condition holds: Every upward equilateral triangle of side length \\(k\\) in \\(T\\) contains at most \\(k\\) holes, for \\(1 \\leq k \\leq n\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2006, "solution": "Let \\(T\\) be a holey triangle. The unit triangles in it will be called cells. We say simply \"triangle\" instead of \"upward equilateral triangle\" and \"size\" instead of \"side length.\"\n\nThe necessity will be proven first. Assume that a holey triangle \\(T\\) can be tiled with diamonds and consider such a tiling. Let \\(T^{\\prime}\\) be a triangle of size \\(k\\) in \\(T\\) containing \\(h\\) holes. Focus on the diamonds which cover (one or two) cells in \\(T^{\\prime}\\). Let them form a figure \\(R\\). The boundary of \\(T^{\\prime}\\) consists of upward cells, so \\(R\\) is a triangle of size \\(k\\) with \\(h\\) upward holes cut out and possibly some downward cells sticking out. Hence there are exactly \\(\\left(k^{2}+k\\right) / 2-h\\) upward cells in \\(R\\), and at least \\(\\left(k^{2}-k\\right) / 2\\) downward cells (not counting those sticking out). On the other hand each diamond covers one upward and one downward cell, which implies \\(\\left(k^{2}+k\\right) / 2-h \\geq\\left(k^{2}-k\\right) / 2\\). It follows that \\(h \\leq k\\), as needed.\n\nWe pass on to the sufficiency. For brevity, let us say that a set of holes in a given triangle \\(T\\) is spread out if every triangle of size \\(k\\) in \\(T\\) contains at most \\(k\\) holes. For any set \\(S\\) of spread out holes, a triangle of size \\(k\\) will be called full of \\(S\\) if it contains exactly \\(k\\) holes of \\(S\\). The proof is based on the following observation.\nLemma. Let \\(S\\) be a set of spread out holes in \\(T\\). Suppose that two triangles \\(T^{\\prime}\\) and \\(T^{\\prime \\prime}\\) are full of \\(S\\), and that they touch or intersect. Let \\(T^{\\prime}+T^{\\prime \\prime}\\) denote the smallest triangle in \\(T\\) containing them. Then \\(T^{\\prime}+T^{\\prime \\prime}\\) is also full of \\(S\\).\nProof. Let triangles \\(T^{\\prime}, T^{\\prime \\prime}, T^{\\prime} \\cap T^{\\prime \\prime}\\) and \\(T^{\\prime}+T^{\\prime \\prime}\\) have sizes \\(a, b, c\\) and \\(d\\), and let them contain \\(a, b, x\\) and \\(y\\) holes of \\(S\\), respectively. (Note that \\(T^{\\prime} \\cap T^{\\prime \\prime}\\) could be a point, in which case \\(c=0\\).) Since \\(S\\) is spread out, we have \\(x \\leq c\\) and \\(y \\leq d\\). The geometric configuration of triangles clearly satisfies \\(a+b=c+d\\). Furthermore, \\(a+b \\leq x+y\\), since \\(a+b\\) counts twice the holes in \\(T^{\\prime} \\cap T^{\\prime \\prime}\\). These conclusions imply \\(x=c\\) and \\(y=d\\), as we wished to show.\n\nNow let \\(T_{n}\\) be a holey triangle of size \\(n\\), and let the set \\(H\\) of its holes be spread out. We show by induction on \\(n\\) that \\(T_{n}\\) can be tiled with diamonds. The base \\(n=1\\) is trivial. Suppose that \\(n \\geq 2\\) and that the claim holds for holey triangles of size less than \\(n\\).\n\nDenote by \\(B\\) the bottom row of \\(T_{n}\\) and by \\(T^{\\prime}\\) the triangle formed by its top \\(n-1\\) rows. There is at least one hole in \\(B\\) as \\(T^{\\prime}\\) contains at most \\(n-1\\) holes. If this hole is only one, there is a unique way to tile \\(B\\) with diamonds. Also, \\(T^{\\prime}\\) contains exactly \\(n-1\\) holes, making it a holey triangle of size \\(n-1\\), and these holes are spread out. Hence it remains to apply the induction hypothesis.\n\nSo suppose that there are \\(m \\geq 2\\) holes in \\(B\\) and label them \\(a_{1}, \\ldots, a_{m}\\) from left to right. Let \\(\\ell\\) be the line separating \\(B\\) from \\(T^{\\prime}\\). For each \\(i=1, \\ldots, m-1\\), pick an upward cell \\(b_{i}\\) between \\(a_{i}\\) and \\(a_{i+1}\\), with base on \\(\\ell\\). Place a diamond to cover \\(b_{i}\\) and its lower neighbour, a downward cell in \\(B\\). The remaining part of \\(B\\) can be tiled uniquely with diamonds. Remove from \\(T_{n}\\) row \\(B\\) and the cells \\(b_{1}, \\ldots, b_{m-1}\\) to obtain a holey triangle \\(T_{n-1}\\) of size \\(n-1\\). The conclusion will follow by induction if the choice of \\(b_{1}, \\ldots, b_{m-1}\\) guarantees that the following condition is satisfied: If the holes \\(a_{1}, \\ldots, a_{m-1}\\) are replaced by \\(b_{1}, \\ldots, b_{m-1}\\) then the new set of holes is spread out again.\n\nWe show that such a choice is possible. The cells \\(b_{1}, \\ldots, b_{m-1}\\) can be defined one at a time in this order, making sure that the above condition holds at each step. Thus it suffices to prove that there is an appropriate choice for \\(b_{1}\\), and we set \\(a_{1}=u, a_{2}=v\\) for clarity.\n\nLet \\(\\Delta\\) be the triangle of maximum size which is full of \\(H\\), contains the top vertex of the hole \\(u\\), and has base on line \\(\\ell\\). Call \\(\\Delta\\) the associate of \\(u\\). Observe that \\(\\Delta\\) does not touch \\(v\\).\n\nIndeed, if \\(\\Delta\\) has size \\(r\\) then it contains \\(r\\) holes of \\(T_{n}\\). Extending its slanted sides downwards produces a triangle \\(\\Delta^{\\prime}\\) of size \\(r+1\\) containing at least one more hole, namely \\(u\\). Since there are at most \\(r+1\\) holes in \\(\\Delta^{\\prime}\\), it cannot contain \\(v\\). Consequently, \\(\\Delta\\) does not contain the top vertex of \\(v\\).\n\nLet \\(w\\) be the upward cell with base on \\(\\ell\\) which is to the right of \\(\\Delta\\) and shares a common vertex with it. The observation above shows that \\(w\\) is to the left of \\(v\\). Note that \\(w\\) is not a hole, or else \\(\\Delta\\) could be extended to a larger triangle full of \\(H\\).\n\nWe prove that if the hole \\(u\\) is replaced by \\(w\\) then the new set of holes is spread out again. To verify this, we only need to check that if a triangle \\(\\Gamma\\) in \\(T_{n}\\) contains \\(w\\) but not \\(u\\) then \\(\\Gamma\\) is not full of \\(H\\). Suppose to the contrary that \\(\\Gamma\\) is full of \\(H\\). Consider the minimum triangle \\(\\Gamma+\\Delta\\) containing \\(\\Gamma\\) and the associate \\(\\Delta\\) of \\(u\\). Clearly \\(\\Gamma+\\Delta\\) is larger than \\(\\Delta\\), because \\(\\Gamma\\) contains \\(w\\) but \\(\\Delta\\) does not. Next, \\(\\Gamma+\\Delta\\) is full of \\(H \\backslash\\{u\\}\\) by the lemma, since \\(\\Gamma\\) and \\(\\Delta\\) have a common point and neither of them contains \\(u\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b870456914a15f8830dfg-30}\n\nIf \\(\\Gamma\\) is above line \\(\\ell\\) then so is \\(\\Gamma+\\Delta\\), which contradicts the maximum choice of \\(\\Delta\\). If \\(\\Gamma\\) contains cells from row \\(B\\), observe that \\(\\Gamma+\\Delta\\) contains \\(u\\). Let \\(s\\) be the size of \\(\\Gamma+\\Delta\\). Being full of \\(H \\backslash\\{u\\}, \\Gamma+\\Delta\\) contains \\(s\\) holes other than \\(u\\). But it also contains \\(u\\), contradicting the assumption that \\(H\\) is spread out.\n\nThe claim follows, showing that \\(b_{1}=w\\) is an appropriate choice for \\(a_{1}=u\\) and \\(a_{2}=v\\). As explained above, this is enough to complete the induction."}
{"id": "imo-shortlist-2006-c7", "question": "C7. Consider a convex polyhedron without parallel edges and without an edge parallel to any face other than the two faces adjacent to it.\n\nCall a pair of points of the polyhedron antipodal if there exist two parallel planes passing through these points and such that the polyhedron is contained between these planes.\n\nLet \\(A\\) be the number of antipodal pairs of vertices, and let \\(B\\) be the number of antipodal pairs of midpoints of edges. Determine the difference \\(A-B\\) in terms of the numbers of vertices, edges and faces.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2006, "solution": "Denote the polyhedron by \\(\\Gamma\\); let its vertices, edges and faces be \\(V_{1}, V_{2}, \\ldots, V_{n}\\), \\(E_{1}, E_{2}, \\ldots, E_{m}\\) and \\(F_{1}, F_{2}, \\ldots, F_{\\ell}\\), respectively. Denote by \\(Q_{i}\\) the midpoint of edge \\(E_{i}\\).\n\nLet \\(S\\) be the unit sphere, the set of all unit vectors in three-dimensional space. Map the boundary elements of \\(\\Gamma\\) to some objects on \\(S\\) as follows.\n\nFor a face \\(F_{i}\\), let \\(S^{+}\\left(F_{i}\\right)\\) and \\(S^{-}\\left(F_{i}\\right)\\) be the unit normal vectors of face \\(F_{i}\\), pointing outwards from \\(\\Gamma\\) and inwards to \\(\\Gamma\\), respectively. These points are diametrically opposite.\n\nFor an edge \\(E_{j}\\), with neighbouring faces \\(F_{i_{1}}\\) and \\(F_{i_{2}}\\), take all support planes of \\(\\Gamma\\) (planes which have a common point with \\(\\Gamma\\) but do not intersect it) containing edge \\(E_{j}\\), and let \\(S^{+}\\left(E_{j}\\right)\\) be the set of their outward normal vectors. The set \\(S^{+}\\left(E_{j}\\right)\\) is an arc of a great circle on \\(S\\). Arc \\(S^{+}\\left(E_{j}\\right)\\) is perpendicular to edge \\(E_{j}\\) and it connects points \\(S^{+}\\left(F_{i_{1}}\\right)\\) and \\(S^{+}\\left(F_{i_{2}}\\right)\\).\n\nDefine also the set of inward normal vectors \\(S^{-}\\left(E_{i}\\right)\\) which is the reflection of \\(S^{+}\\left(E_{i}\\right)\\) across the origin.\n\nFor a vertex \\(V_{k}\\), which is the common endpoint of edges \\(E_{j_{1}}, \\ldots, E_{j_{h}}\\) and shared by faces \\(F_{i_{1}}, \\ldots, F_{i_{h}}\\), take all support planes of \\(\\Gamma\\) through point \\(V_{k}\\) and let \\(S^{+}\\left(V_{k}\\right)\\) be the set of their outward normal vectors. This is a region on \\(S\\), a spherical polygon with vertices \\(S^{+}\\left(F_{i_{1}}\\right), \\ldots, S^{+}\\left(F_{i_{h}}\\right)\\) bounded by arcs \\(S^{+}\\left(E_{j_{1}}\\right), \\ldots, S^{+}\\left(E_{j_{h}}\\right)\\). Let \\(S^{-}\\left(V_{k}\\right)\\) be the reflection of \\(S^{+}\\left(V_{k}\\right)\\), the set of inward normal vectors.\n\nNote that region \\(S^{+}\\left(V_{k}\\right)\\) is convex in the sense that it is the intersection of several half spheres.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b870456914a15f8830dfg-31}\n\nNow translate the conditions on \\(\\Gamma\\) to the language of these objects.\n(a) Polyhedron \\(\\Gamma\\) has no parallel edges - the great circles of arcs \\(S^{+}\\left(E_{i}\\right)\\) and \\(S^{-}\\left(E_{j}\\right)\\) are different for all \\(i \\neq j\\).\n(b) If an edge \\(E_{i}\\) does not belong to a face \\(F_{j}\\) then they are not parallel - the great circle which contains arcs \\(S^{+}\\left(E_{i}\\right)\\) and \\(S^{-}\\left(E_{i}\\right)\\) does not pass through points \\(S^{+}\\left(F_{j}\\right)\\) and \\(S^{-}\\left(F_{j}\\right)\\).\n(c) Polyhedron \\(\\Gamma\\) has no parallel faces - points \\(S^{+}\\left(F_{i}\\right)\\) and \\(S^{-}\\left(F_{j}\\right)\\) are pairwise distinct.\n\nThe regions \\(S^{+}\\left(V_{k}\\right)\\), arcs \\(S^{+}\\left(E_{j}\\right)\\) and points \\(S^{+}\\left(F_{i}\\right)\\) provide a decomposition of the surface of the sphere. Regions \\(S^{-}\\left(V_{k}\\right)\\), arcs \\(S^{-}\\left(E_{j}\\right)\\) and points \\(S^{-}\\left(F_{i}\\right)\\) provide the reflection of this decomposition. These decompositions are closely related to the problem.\nLemma 1. For any \\(1 \\leq i, j \\leq n\\), regions \\(S^{-}\\left(V_{i}\\right)\\) and \\(S^{+}\\left(V_{j}\\right)\\) overlap if and only if vertices \\(V_{i}\\) and \\(V_{j}\\) are antipodal.\n\nLemma 2. For any \\(1 \\leq i, j \\leq m, \\operatorname{arcs} S^{-}\\left(E_{i}\\right)\\) and \\(S^{+}\\left(E_{j}\\right)\\) intersect if and only if the midpoints \\(Q_{i}\\) and \\(Q_{j}\\) of edges \\(E_{i}\\) and \\(E_{j}\\) are antipodal.\nProof of lemma 1. First note that by properties (a,b,c) above, the two regions cannot share only a single point or an arc. They are either disjoint or they overlap.\n\nAssume that the two regions have a common interior point \\(u\\). Let \\(P_{1}\\) and \\(P_{2}\\) be two parallel support planes of \\(\\Gamma\\) through points \\(V_{i}\\) and \\(V_{j}\\), respectively, with normal vector \\(u\\). By the definition of regions \\(S^{-}\\left(V_{i}\\right)\\) and \\(S^{+}\\left(V_{j}\\right), u\\) is the inward normal vector of \\(P_{1}\\) and the outward normal vector of \\(P_{2}\\). Therefore polyhedron \\(\\Gamma\\) lies between the two planes; vertices \\(V_{i}\\) and \\(V_{j}\\) are antipodal.\n\nTo prove the opposite direction, assume that \\(V_{i}\\) and \\(V_{j}\\) are antipodal. Then there exist two parallel support planes \\(P_{1}\\) and \\(P_{2}\\) through \\(V_{i}\\) and \\(V_{j}\\), respectively, such that \\(\\Gamma\\) is between them. Let \\(u\\) be the inward normal vector of \\(P_{1}\\); then \\(u\\) is the outward normal vector of \\(P_{2}\\), therefore \\(u \\in S^{-}\\left(V_{i}\\right) \\cap S^{+}\\left(V_{j}\\right)\\). The two regions have a common point, so they overlap.\nProof of lemma 2. Again, by properties (a,b) above, the endpoints of arc \\(S^{-}\\left(E_{i}\\right)\\) cannot belong to \\(S^{+}\\left(E_{j}\\right)\\) and vice versa. The two arcs are either disjoint or intersecting.\n\nAssume that arcs \\(S^{-}\\left(E_{i}\\right)\\) and \\(S^{+}\\left(E_{j}\\right)\\) intersect at point \\(u\\). Let \\(P_{1}\\) and \\(P_{2}\\) be the two support planes through edges \\(E_{i}\\) and \\(E_{j}\\), respectively, with normal vector \\(u\\). By the definition of arcs \\(S^{-}\\left(E_{i}\\right)\\) and \\(S^{+}\\left(E_{j}\\right)\\), vector \\(u\\) points inwards from \\(P_{1}\\) and outwards from \\(P_{2}\\). Therefore \\(\\Gamma\\) is between the planes. Since planes \\(P_{1}\\) and \\(P_{2}\\) pass through \\(Q_{i}\\) and \\(Q_{j}\\), these points are antipodal.\n\nFor the opposite direction, assume that points \\(Q_{i}\\) and \\(Q_{j}\\) are antipodal. Let \\(P_{1}\\) and \\(P_{2}\\) be two support planes through these points, respectively. An edge cannot intersect a support plane, therefore \\(E_{i}\\) and \\(E_{j}\\) lie in the planes \\(P_{1}\\) and \\(P_{2}\\), respectively. Let \\(u\\) be the inward normal vector of \\(P_{1}\\), which is also the outward normal vector of \\(P_{2}\\). Then \\(u \\in S^{-}\\left(E_{i}\\right) \\cap S^{+}\\left(E_{j}\\right)\\). So the two arcs are not disjoint; they therefore intersect.\n\nNow create a new decomposition of sphere \\(S\\). Draw all \\(\\operatorname{arcs} S^{+}\\left(E_{i}\\right)\\) and \\(S^{-}\\left(E_{j}\\right)\\) on sphere \\(S\\) and put a knot at each point where two arcs meet. We have \\(\\ell\\) knots at points \\(S^{+}\\left(F_{i}\\right)\\) and another \\(\\ell\\) knots at points \\(S^{-}\\left(F_{i}\\right)\\), corresponding to the faces of \\(\\Gamma\\); by property (c) they are different. We also have some pairs \\(1 \\leq i, j \\leq m\\) where arcs \\(S^{-}\\left(E_{i}\\right)\\) and \\(S^{+}\\left(E_{j}\\right)\\) intersect. By Lemma 2, each antipodal pair ( \\(Q_{i}, Q_{j}\\) ) gives rise to two such intersections; hence, the number of all intersections is \\(2 B\\) and we have \\(2 \\ell+2 B\\) knots in all.\n\nEach intersection knot splits two arcs, increasing the number of arcs by 2 . Since we started with \\(2 m\\) arcs, corresponding the edges of \\(\\Gamma\\), the number of the resulting curve segments is \\(2 m+4 B\\).\n\nThe network of these curve segments divides the sphere into some \"new\" regions. Each new region is the intersection of some overlapping sets \\(S^{-}\\left(V_{i}\\right)\\) and \\(S^{+}\\left(V_{j}\\right)\\). Due to the convexity, the intersection of two overlapping regions is convex and thus contiguous. By Lemma 1, each pair of overlapping regions corresponds to an antipodal vertex pair and each antipodal vertex pair gives rise to two different overlaps, which are symmetric with respect to the origin. So the number of new regions is \\(2 A\\).\n\nThe result now follows from Euler's polyhedron theorem. We have \\(n+l=m+2\\) and\n\n\\[\n(2 \\ell+2 B)+2 A=(2 m+4 B)+2\n\\]\n\ntherefore\n\n\\[\nA-B=m-\\ell+1=n-1\n\\]\n\nTherefore \\(A-B\\) is by one less than the number of vertices of \\(\\Gamma\\).\n\nSolution 2. Use the same notations for the polyhedron and its vertices, edges and faces as in Solution 1. We regard points as vectors starting from the origin. Polyhedron \\(\\Gamma\\) is regarded as a closed convex set, including its interior. In some cases the edges and faces of \\(\\Gamma\\) are also regarded as sets of points. The symbol \\(\\partial\\) denotes the boundary of the certain set; e.g. \\(\\partial \\Gamma\\) is the surface of \\(\\Gamma\\).\n\nLet \\(\\Delta=\\Gamma-\\Gamma=\\{U-V: U, V \\in \\Gamma\\}\\) be the set of vectors between arbitrary points of \\(\\Gamma\\). Then \\(\\Delta\\), being the sum of two bounded convex sets, is also a bounded convex set and, by construction, it is also centrally symmetric with respect to the origin. We will prove that \\(\\Delta\\) is also a polyhedron and express the numbers of its faces, edges and vertices in terms \\(n, m, \\ell, A\\) and \\(B\\).\n\nLemma 1. For points \\(U, V \\in \\Gamma\\), point \\(W=U-V\\) is a boundary point of \\(\\Delta\\) if and only if \\(U\\) and \\(V\\) are antipodal. Moreover, for each boundary point \\(W \\in \\partial \\Delta\\) there exists exactly one pair of points \\(U, V \\in \\Gamma\\) such that \\(W=U-V\\).\nProof. Assume first that \\(U\\) and \\(V\\) are antipodal points of \\(\\Gamma\\). Let parallel support planes \\(P_{1}\\) and \\(P_{2}\\) pass through them such that \\(\\Gamma\\) is in between. Consider plane \\(P=P_{1}-U=\\) \\(P_{2}-V\\). This plane separates the interiors of \\(\\Gamma-U\\) and \\(\\Gamma-V\\). After reflecting one of the sets, e.g. \\(\\Gamma-V\\), the sets \\(\\Gamma-U\\) and \\(-\\Gamma+V\\) lie in the same half space bounded by \\(P\\). Then \\((\\Gamma-U)+(-\\Gamma+V)=\\Delta-W\\) lies in that half space, so \\(0 \\in P\\) is a boundary point of the set \\(\\Delta-W\\). Translating by \\(W\\) we obtain that \\(W\\) is a boundary point of \\(\\Delta\\).\n\nTo prove the opposite direction, let \\(W=U-V\\) be a boundary point of \\(\\Delta\\), and let \\(\\Psi=\\) \\((\\Gamma-U) \\cap(\\Gamma-V)\\). We claim that \\(\\Psi=\\{0\\}\\). Clearly \\(\\Psi\\) is a bounded convex set and \\(0 \\in \\Psi\\). For any two points \\(X, Y \\in \\Psi\\), we have \\(U+X, V+Y \\in \\Gamma\\) and \\(W+(X-Y)=(U+X)-(V+Y) \\in \\Delta\\). Since \\(W\\) is a boundary point of \\(\\Delta\\), the vector \\(X-Y\\) cannot have the same direction as \\(W\\). This implies that the interior of \\(\\Psi\\) is empty. Now suppose that \\(\\Psi\\) contains a line segment \\(S\\). Then \\(S+U\\) and \\(S+V\\) are subsets of some faces or edges of \\(\\Gamma\\) and these faces/edges are parallel to \\(S\\). In all cases, we find two faces, two edges, or a face and an edge which are parallel, contradicting the conditions of the problem. Therefore, \\(\\Psi=\\{0\\}\\) indeed.\n\nSince \\(\\Psi=(\\Gamma-U) \\cap(\\Gamma-V)\\) consists of a single point, the interiors of bodies \\(\\Gamma-U\\) and \\(\\Gamma-V\\) are disjoint and there exists a plane \\(P\\) which separates them. Let \\(u\\) be the normal vector of \\(P\\) pointing into that half space bounded by \\(P\\) which contains \\(\\Gamma-U\\). Consider the planes \\(P+U\\) and \\(P+V\\); they are support planes of \\(\\Gamma\\), passing through \\(U\\) and \\(V\\), respectively. From plane \\(P+U\\), the vector \\(u\\) points into that half space which contains \\(\\Gamma\\). From plane \\(P+V\\), vector \\(u\\) points into the opposite half space containing \\(\\Gamma\\). Therefore, we found two proper support through points \\(U\\) and \\(V\\) such that \\(\\Gamma\\) is in between.\n\nFor the uniqueness part, assume that there exist points \\(U_{1}, V_{1} \\in \\Gamma\\) such that \\(U_{1}-V_{1}=U-V\\). The points \\(U_{1}-U\\) and \\(V_{1}-V\\) lie in the sets \\(\\Gamma-U\\) and \\(\\Gamma-V\\) separated by \\(P\\). Since \\(U_{1}-U=V_{1}-V\\), this can happen only if both are in \\(P\\); but the only such point is 0 . Therefore, \\(U_{1}-V_{1}=U-V\\) implies \\(U_{1}=U\\) and \\(V_{1}=V\\). The lemma is complete.\n\nLemma 2. Let \\(U\\) and \\(V\\) be two antipodal points and assume that plane \\(P\\), passing through 0 , separates the interiors of \\(\\Gamma-U\\) and \\(\\Gamma-V\\). Let \\(\\Psi_{1}=(\\Gamma-U) \\cap P\\) and \\(\\Psi_{2}=(\\Gamma-V) \\cap P\\). Then \\(\\Delta \\cap(P+U-V)=\\Psi_{1}-\\Psi_{2}+U-V\\).\nProof. The sets \\(\\Gamma-U\\) and \\(-\\Gamma+V\\) lie in the same closed half space bounded by \\(P\\). Therefore, for any points \\(X \\in(\\Gamma-U)\\) and \\(Y \\in(-\\Gamma+V)\\), we have \\(X+Y \\in P\\) if and only if \\(X, Y \\in P\\). Then\n\\((\\Delta-(U-V)) \\cap P=((\\Gamma-U)+(-\\Gamma+V)) \\cap P=((\\Gamma-U) \\cap P)+((-\\Gamma+V) \\cap P)=\\Psi_{1}-\\Psi_{2}\\).\nNow a translation by ( \\(U-V\\) ) completes the lemma.\n\nNow classify the boundary points \\(W=U-V\\) of \\(\\Delta\\), according to the types of points \\(U\\) and \\(V\\). In all cases we choose a plane \\(P\\) through 0 which separates the interiors of \\(\\Gamma-U\\) and \\(\\Gamma-V\\). We will use the notation \\(\\Psi_{1}=(\\Gamma-U) \\cap P\\) and \\(\\Psi_{2}=(\\Gamma-V) \\cap P\\) as well.\n\nCase 1: Both \\(U\\) and \\(V\\) are vertices of \\(\\Gamma\\). Bodies \\(\\Gamma-U\\) and \\(\\Gamma-V\\) have a common vertex which is 0 . Choose plane \\(P\\) in such a way that \\(\\Psi_{1}=\\Psi_{2}=\\{0\\}\\). Then Lemma 2 yields \\(\\Delta \\cap(P+W)=\\{W\\}\\). Therefore \\(P+W\\) is a support plane of \\(\\Delta\\) such that they have only one common point so no line segment exists on \\(\\partial \\Delta\\) which would contain \\(W\\) in its interior.\n\nSince this case occurs for antipodal vertex pairs and each pair is counted twice, the number of such boundary points on \\(\\Delta\\) is \\(2 A\\).\n\nCase 2: Point \\(U\\) is an interior point of an edge \\(E_{i}\\) and \\(V\\) is a vertex of \\(\\Gamma\\). Choose plane \\(P\\) such that \\(\\Psi_{1}=E_{i}-U\\) and \\(\\Psi_{2}=\\{0\\}\\). By Lemma 2, \\(\\Delta \\cap(P+W)=E_{i}-V\\). Hence there exists a line segment in \\(\\partial \\Delta\\) which contains \\(W\\) in its interior, but there is no planar region in \\(\\partial \\Delta\\) with the same property.\n\nWe obtain a similar result if \\(V\\) belongs to an edge of \\(\\Gamma\\) and \\(U\\) is a vertex.\nCase 3: Points \\(U\\) and \\(V\\) are interior points of edges \\(E_{i}\\) and \\(E_{j}\\), respectively. Let \\(P\\) be the plane of \\(E_{i}-U\\) and \\(E_{j}-V\\). Then \\(\\Psi_{1}=E_{i}-U, \\Psi_{2}=E_{j}-V\\) and \\(\\Delta \\cap(P+W)=E_{i}-E_{j}\\). Therefore point \\(W\\) belongs to a parallelogram face on \\(\\partial \\Delta\\).\n\nThe centre of the parallelogram is \\(Q_{i}-Q_{j}\\), the vector between the midpoints. Therefore an edge pair ( \\(E_{i}, E_{j}\\) ) occurs if and only if \\(Q_{i}\\) and \\(Q_{j}\\) are antipodal which happens \\(2 B\\) times.\n\nCase 4: Point \\(U\\) lies in the interior of a face \\(F_{i}\\) and \\(V\\) is a vertex of \\(\\Gamma\\). The only choice for \\(P\\) is the plane of \\(F_{i}-U\\). Then we have \\(\\Psi_{1}=F_{i}-U, \\Psi_{2}=\\{0\\}\\) and \\(\\Delta \\cap(P+W)=F_{i}-V\\). This is a planar face of \\(\\partial \\Delta\\) which is congruent to \\(F_{i}\\).\n\nFor each face \\(F_{i}\\), the only possible vertex \\(V\\) is the farthest one from the plane of \\(F_{i}\\).\nIf \\(U\\) is a vertex and \\(V\\) belongs to face \\(F_{i}\\) then we obtain the same way that \\(W\\) belongs to a face \\(-F_{i}+U\\) which is also congruent to \\(F_{i}\\). Therefore, each face of \\(\\Gamma\\) has two copies on \\(\\partial \\Delta\\), a translated and a reflected copy.\n\nCase 5: Point \\(U\\) belongs to a face \\(F_{i}\\) of \\(\\Gamma\\) and point \\(V\\) belongs to an edge or a face \\(G\\). In this case objects \\(F_{i}\\) and \\(G\\) must be parallel which is not allowed.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b870456914a15f8830dfg-34}\n\nNow all points in \\(\\partial \\Delta\\) belong to some planar polygons (cases 3 and 4), finitely many line segments (case 2) and points (case 1). Therefore \\(\\Delta\\) is indeed a polyhedron. Now compute the numbers of its vertices, edges and faces.\n\nThe vertices are obtained in case 1, their number is \\(2 A\\).\nFaces are obtained in cases 3 and 4. Case 3 generates \\(2 B\\) parallelogram faces. Case 4 generates \\(2 \\ell\\) faces.\n\nWe compute the number of edges of \\(\\Delta\\) from the degrees (number of sides) of faces of \\(\\Gamma\\). Let \\(d_{i}\\) be the the degree of face \\(F_{i}\\). The sum of degrees is twice as much as the number of edges, so \\(d_{1}+d_{2}+\\ldots+d_{l}=2 m\\). The sum of degrees of faces of \\(\\Delta\\) is \\(2 B \\cdot 4+2\\left(d_{1}+d_{2}+\\cdots+d_{l}\\right)=8 B+4 m\\), so the number of edges on \\(\\Delta\\) is \\(4 B+2 m\\).\n\nApplying Euler's polyhedron theorem on \\(\\Gamma\\) and \\(\\Delta\\), we have \\(n+l=m+2\\) and \\(2 A+(2 B+2 \\ell)=\\) \\((4 B+2 m)+2\\). Then the conclusion follows:\n\n\\[\nA-B=m-\\ell+1=n-1 .\n\\]"}
{"id": "imo-shortlist-2006-g1", "question": "G1. Let \\(A B C\\) be a triangle with incentre \\(I\\). A point \\(P\\) in the interior of the triangle satisfies\n\n\\[\n\\angle P B A+\\angle P C A=\\angle P B C+\\angle P C B .\n\\]\n\nShow that \\(A P \\geq A I\\) and that equality holds if and only if \\(P\\) coincides with \\(I\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2006, "solution": "Let \\(\\angle A=\\alpha, \\angle B=\\beta, \\angle C=\\gamma\\). Since \\(\\angle P B A+\\angle P C A+\\angle P B C+\\angle P C B=\\beta+\\gamma\\), the condition from the problem statement is equivalent to \\(\\angle P B C+\\angle P C B=(\\beta+\\gamma) / 2\\), i. e. \\(\\angle B P C=90^{\\circ}+\\alpha / 2\\).\n\nOn the other hand \\(\\angle B I C=180^{\\circ}-(\\beta+\\gamma) / 2=90^{\\circ}+\\alpha / 2\\). Hence \\(\\angle B P C=\\angle B I C\\), and since \\(P\\) and \\(I\\) are on the same side of \\(B C\\), the points \\(B, C, I\\) and \\(P\\) are concyclic. In other words, \\(P\\) lies on the circumcircle \\(\\omega\\) of triangle \\(B C I\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b870456914a15f8830dfg-35}\n\nLet \\(\\Omega\\) be the circumcircle of triangle \\(A B C\\). It is a well-known fact that the centre of \\(\\omega\\) is the midpoint \\(M\\) of the arc \\(B C\\) of \\(\\Omega\\). This is also the point where the angle bisector \\(A I\\) intersects \\(\\Omega\\).\n\nFrom triangle \\(A P M\\) we have\n\n\\[\nA P+P M \\geq A M=A I+I M=A I+P M .\n\\]\n\nTherefore \\(A P \\geq A I\\). Equality holds if and only if \\(P\\) lies on the line segment \\(A I\\), which occurs if and only if \\(P=I\\)."}
{"id": "imo-shortlist-2006-g2", "question": "G2. Let \\(A B C D\\) be a trapezoid with parallel sides \\(A B>C D\\). Points \\(K\\) and \\(L\\) lie on the line segments \\(A B\\) and \\(C D\\), respectively, so that \\(A K / K B=D L / L C\\). Suppose that there are points \\(P\\) and \\(Q\\) on the line segment \\(K L\\) satisfying\n\n\\[\n\\angle A P B=\\angle B C D \\quad \\text { and } \\quad \\angle C Q D=\\angle A B C .\n\\]\n\nProve that the points \\(P, Q, B\\) and \\(C\\) are concyclic.", "category": "Geometry", "source": "IMO Shortlist", "year": 2006, "solution": "Because \\(A B \\| C D\\), the relation \\(A K / K B=D L / L C\\) readily implies that the lines \\(A D, B C\\) and \\(K L\\) have a common point \\(S\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b870456914a15f8830dfg-36}\n\nConsider the second intersection points \\(X\\) and \\(Y\\) of the line \\(S K\\) with the circles ( \\(A B P\\) ) and ( \\(C D Q\\) ), respectively. Since \\(A P B X\\) is a cyclic quadrilateral and \\(A B \\| C D\\), one has\n\n\\[\n\\angle A X B=180^{\\circ}-\\angle A P B=180^{\\circ}-\\angle B C D=\\angle A B C .\n\\]\n\nThis shows that \\(B C\\) is tangent to the circle ( \\(A B P\\) ) at \\(B\\). Likewise, \\(B C\\) is tangent to the circle (CDQ) at C. Therefore \\(S P \\cdot S X=S B^{2}\\) and \\(S Q \\cdot S Y=S C^{2}\\).\n\nLet \\(h\\) be the homothety with centre \\(S\\) and ratio \\(S C / S B\\). Since \\(h(B)=C\\), the above conclusion about tangency implies that \\(h\\) takes circle ( \\(A B P\\) ) to circle ( \\(C D Q\\) ). Also, \\(h\\) takes \\(A B\\) to \\(C D\\), and it easily follows that \\(h(P)=Y, h(X)=Q\\), yielding \\(S P / S Y=S B / S C=S X / S Q\\).\n\nEqualities \\(S P \\cdot S X=S B^{2}\\) and \\(S Q / S X=S C / S B\\) imply \\(S P \\cdot S Q=S B \\cdot S C\\), which is equivalent to \\(P, Q, B\\) and \\(C\\) being concyclic.\n\nSolution 2. The case where \\(P=Q\\) is trivial. Thus assume that \\(P\\) and \\(Q\\) are two distinct points. As in the first solution, notice that the lines \\(A D, B C\\) and \\(K L\\) concur at a point \\(S\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b870456914a15f8830dfg-37}\n\nLet the lines \\(A P\\) and \\(D Q\\) meet at \\(E\\), and let \\(B P\\) and \\(C Q\\) meet at \\(F\\). Then \\(\\angle E P F=\\angle B C D\\) and \\(\\angle F Q E=\\angle A B C\\) by the condition of the problem. Since the angles \\(B C D\\) and \\(A B C\\) add up to \\(180^{\\circ}\\), it follows that \\(P E Q F\\) is a cyclic quadrilateral.\n\nApplying Menelaus' theorem, first to triangle \\(A S P\\) and line \\(D Q\\) and then to triangle \\(B S P\\) and line \\(C Q\\), we have\n\n\\[\n\\frac{A D}{D S} \\cdot \\frac{S Q}{Q P} \\cdot \\frac{P E}{E A}=1 \\quad \\text { and } \\quad \\frac{B C}{C S} \\cdot \\frac{S Q}{Q P} \\cdot \\frac{P F}{F B}=1 .\n\\]\n\nThe first factors in these equations are equal, as \\(A B \\| C D\\). Thus the last factors are also equal, which implies that \\(E F\\) is parallel to \\(A B\\) and \\(C D\\). Using this and the cyclicity of \\(P E Q F\\), we obtain\n\n\\[\n\\angle B C D=\\angle B C F+\\angle F C D=\\angle B C Q+\\angle E F Q=\\angle B C Q+\\angle E P Q\n\\]\n\nOn the other hand,\n\n\\[\n\\angle B C D=\\angle A P B=\\angle E P F=\\angle E P Q+\\angle Q P F\n\\]\n\nand consequently \\(\\angle B C Q=\\angle Q P F\\). The latter angle either coincides with \\(\\angle Q P B\\) or is supplementary to \\(\\angle Q P B\\), depending on whether \\(Q\\) lies between \\(K\\) and \\(P\\) or not. In either case it follows that \\(P, Q, B\\) and \\(C\\) are concyclic."}
{"id": "imo-shortlist-2006-g3", "question": "G3. Let \\(A B C D E\\) be a convex pentagon such that\n\n\\[\n\\angle B A C=\\angle C A D=\\angle D A E \\quad \\text { and } \\quad \\angle A B C=\\angle A C D=\\angle A D E .\n\\]\n\nThe diagonals \\(B D\\) and \\(C E\\) meet at \\(P\\). Prove that the line \\(A P\\) bisects the side \\(C D\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2006, "solution": "Let the diagonals \\(A C\\) and \\(B D\\) meet at \\(Q\\), the diagonals \\(A D\\) and \\(C E\\) meet at \\(R\\), and let the ray \\(A P\\) meet the side \\(C D\\) at \\(M\\). We want to prove that \\(C M=M D\\) holds.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b870456914a15f8830dfg-38}\n\nThe idea is to show that \\(Q\\) and \\(R\\) divide \\(A C\\) and \\(A D\\) in the same ratio, or more precisely\n\n\\[\n\\frac{A Q}{Q C}=\\frac{A R}{R D}\n\\]\n\n(which is equivalent to \\(Q R \\| C D\\) ). The given angle equalities imply that the triangles \\(A B C\\), \\(A C D\\) and \\(A D E\\) are similar. We therefore have\n\n\\[\n\\frac{A B}{A C}=\\frac{A C}{A D}=\\frac{A D}{A E}\n\\]\n\nSince \\(\\angle B A D=\\angle B A C+\\angle C A D=\\angle C A D+\\angle D A E=\\angle C A E\\), it follows from \\(A B / A C=\\) \\(A D / A E\\) that the triangles \\(A B D\\) and \\(A C E\\) are also similar. Their angle bisectors in \\(A\\) are \\(A Q\\) and \\(A R\\), respectively, so that\n\n\\[\n\\frac{A B}{A C}=\\frac{A Q}{A R}\n\\]\n\nBecause \\(A B / A C=A C / A D\\), we obtain \\(A Q / A R=A C / A D\\), which is equivalent to (1). Now Ceva's theorem for the triangle \\(A C D\\) yields\n\n\\[\n\\frac{A Q}{Q C} \\cdot \\frac{C M}{M D} \\cdot \\frac{D R}{R A}=1\n\\]\n\nIn view of (1), this reduces to \\(C M=M D\\), which completes the proof.\nComment. Relation (1) immediately follows from the fact that quadrilaterals \\(A B C D\\) and \\(A C D E\\) are similar."}
{"id": "imo-shortlist-2006-g4", "question": "G4. A point \\(D\\) is chosen on the side \\(A C\\) of a triangle \\(A B C\\) with \\(\\angle C<\\angle A<90^{\\circ}\\) in such a way that \\(B D=B A\\). The incircle of \\(A B C\\) is tangent to \\(A B\\) and \\(A C\\) at points \\(K\\) and \\(L\\), respectively. Let \\(J\\) be the incentre of triangle \\(B C D\\). Prove that the line \\(K L\\) intersects the line segment \\(A J\\) at its midpoint.", "category": "Geometry", "source": "IMO Shortlist", "year": 2006, "solution": "Denote by \\(P\\) be the common point of \\(A J\\) and \\(K L\\). Let the parallel to \\(K L\\) through \\(J\\) meet \\(A C\\) at \\(M\\). Then \\(P\\) is the midpoint of \\(A J\\) if and only if \\(A M=2 \\cdot A L\\), which we are about to show.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b870456914a15f8830dfg-39}\n\nDenoting \\(\\angle B A C=2 \\alpha\\), the equalities \\(B A=B D\\) and \\(A K=A L\\) imply \\(\\angle A D B=2 \\alpha\\) and \\(\\angle A L K=90^{\\circ}-\\alpha\\). Since \\(D J\\) bisects \\(\\angle B D C\\), we obtain \\(\\angle C D J=\\frac{1}{2} \\cdot\\left(180^{\\circ}-\\angle A D B\\right)=90^{\\circ}-\\alpha\\). Also \\(\\angle D M J=\\angle A L K=90^{\\circ}-\\alpha\\) since \\(J M \\| K L\\). It follows that \\(J D=J M\\).\n\nLet the incircle of triangle \\(B C D\\) touch its side \\(C D\\) at \\(T\\). Then \\(J T \\perp C D\\), meaning that \\(J T\\) is the altitude to the base \\(D M\\) of the isosceles triangle \\(D M J\\). It now follows that \\(D T=M T\\), and we have\n\n\\[\nD M=2 \\cdot D T=B D+C D-B C .\n\\]\n\nTherefore\n\n\\[\n\\begin{aligned}\nA M & =A D+(B D+C D-B C) \n& =A D+A B+D C-B C \n& =A C+A B-B C \n& =2 \\cdot A L,\n\n\\]\n\nwhich completes the proof."}
{"id": "imo-shortlist-2006-g5", "question": "G5. In triangle \\(A B C\\), let \\(J\\) be the centre of the excircle tangent to side \\(B C\\) at \\(A_{1}\\) and to the extensions of sides \\(A C\\) and \\(A B\\) at \\(B_{1}\\) and \\(C_{1}\\), respectively. Suppose that the lines \\(A_{1} B_{1}\\) and \\(A B\\) are perpendicular and intersect at \\(D\\). Let \\(E\\) be the foot of the perpendicular from \\(C_{1}\\) to line \\(D J\\). Determine the angles \\(\\angle B E A_{1}\\) and \\(\\angle A E B_{1}\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2006, "solution": "Let \\(K\\) be the intersection point of lines \\(J C\\) and \\(A_{1} B_{1}\\). Obviously \\(J C \\perp A_{1} B_{1}\\) and since \\(A_{1} B_{1} \\perp A B\\), the lines \\(J K\\) and \\(C_{1} D\\) are parallel and equal. From the right triangle \\(B_{1} C J\\) we obtain \\(J C_{1}^{2}=J B_{1}^{2}=J C \\cdot J K=J C \\cdot C_{1} D\\) from which we infer that \\(D C_{1} / C_{1} J=C_{1} J / J C\\) and the right triangles \\(D C_{1} J\\) and \\(C_{1} J C\\) are similar. Hence \\(\\angle C_{1} D J=\\angle J C_{1} C\\), which implies that the lines \\(D J\\) and \\(C_{1} C\\) are perpendicular, i.e. the points \\(C_{1}, E, C\\) are collinear.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b870456914a15f8830dfg-40(1)}\n\nSince \\(\\angle C A_{1} J=\\angle C B_{1} J=\\angle C E J=90^{\\circ}\\), points \\(A_{1}, B_{1}\\) and \\(E\\) lie on the circle of diameter \\(C J\\). Then \\(\\angle D B A_{1}=\\angle A_{1} C J=\\angle D E A_{1}\\), which implies that quadrilateral \\(B E A_{1} D\\) is cyclic; therefore \\(\\angle A_{1} E B=90^{\\circ}\\).\n\nQuadrilateral \\(A D E B_{1}\\) is also cyclic because \\(\\angle E B_{1} A=\\angle E J C=\\angle E D C_{1}\\), therefore we obtain \\(\\angle A E B_{1}=\\angle A D B=90^{\\circ}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b870456914a15f8830dfg-40}\n\nSolution 2. Consider the circles \\(\\omega_{1}, \\omega_{2}\\) and \\(\\omega_{3}\\) of diameters \\(C_{1} D, A_{1} B\\) and \\(A B_{1}\\), respectively. Line segments \\(J C_{1}, J B_{1}\\) and \\(J A_{1}\\) are tangents to those circles and, due to the right angle at \\(D\\), \\(\\omega_{2}\\) and \\(\\omega_{3}\\) pass through point \\(D\\). Since \\(\\angle C_{1} E D\\) is a right angle, point \\(E\\) lies on circle \\(\\omega_{1}\\), therefore\n\n\\[\nJ C_{1}^{2}=J D \\cdot J E\n\\]\n\nSince \\(J A_{1}=J B_{1}=J C_{1}\\) are all radii of the excircle, we also have\n\n\\[\nJ A_{1}^{2}=J D \\cdot J E \\quad \\text { and } \\quad J B_{1}^{2}=J D \\cdot J E .\n\\]\n\nThese equalities show that \\(E\\) lies on circles \\(\\omega_{2}\\) and \\(\\omega_{3}\\) as well, so \\(\\angle B E A_{1}=\\angle A E B_{1}=90^{\\circ}\\).\nSolution 3. First note that \\(A_{1} B_{1}\\) is perpendicular to the external angle bisector \\(C J\\) of \\(\\angle B C A\\) and parallel to the internal angle bisector of that angle. Therefore, \\(A_{1} B_{1}\\) is perpendicular to \\(A B\\) if and only if triangle \\(A B C\\) is isosceles, \\(A C=B C\\). In that case the external bisector \\(C J\\) is parallel to \\(A B\\).\n\nTriangles \\(A B C\\) and \\(B_{1} A_{1} J\\) are similar, as their corresponding sides are perpendicular. In particular, we have \\(\\angle D A_{1} J=\\angle C_{1} B A_{1}\\); moreover, from cyclic deltoid \\(J A_{1} B C_{1}\\),\n\n\\[\n\\angle C_{1} A_{1} J=\\angle C_{1} B J=\\frac{1}{2} \\angle C_{1} B A_{1}=\\frac{1}{2} \\angle D A_{1} J\n\\]\n\nTherefore, \\(A_{1} C_{1}\\) bisects angle \\(\\angle D A_{1} J\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b870456914a15f8830dfg-41}\n\nIn triangle \\(B_{1} A_{1} J\\), line \\(J C_{1}\\) is the external bisector at vertex \\(J\\). The point \\(C_{1}\\) is the intersection of two external angle bisectors (at \\(A_{1}\\) and \\(J\\) ) so \\(C_{1}\\) is the centre of the excircle \\(\\omega\\), tangent to side \\(A_{1} J\\), and to the extension of \\(B_{1} A_{1}\\) at point \\(D\\).\n\nNow consider the similarity transform \\(\\varphi\\) which moves \\(B_{1}\\) to \\(A, A_{1}\\) to \\(B\\) and \\(J\\) to \\(C\\). This similarity can be decomposed into a rotation by \\(90^{\\circ}\\) around a certain point \\(O\\) and a homothety from the same centre. This similarity moves point \\(C_{1}\\) (the centre of excircle \\(\\omega\\) ) to \\(J\\) and moves \\(D\\) (the point of tangency) to \\(C_{1}\\).\n\nSince the rotation angle is \\(90^{\\circ}\\), we have \\(\\angle X O \\varphi(X)=90^{\\circ}\\) for an arbitrary point \\(X \\neq O\\). For \\(X=D\\) and \\(X=C_{1}\\) we obtain \\(\\angle D O C_{1}=\\angle C_{1} O J=90^{\\circ}\\). Therefore \\(O\\) lies on line segment \\(D J\\) and \\(C_{1} O\\) is perpendicular to \\(D J\\). This means that \\(O=E\\).\n\nFor \\(X=A_{1}\\) and \\(X=B_{1}\\) we obtain \\(\\angle A_{1} O B=\\angle B_{1} O A=90^{\\circ}\\), i.e.\n\n\\[\n\\angle B E A_{1}=\\angle A E B_{1}=90^{\\circ}\n\\]\n\nComment. Choosing \\(X=J\\), it also follows that \\(\\angle J E C=90^{\\circ}\\) which proves that lines \\(D J\\) and \\(C C_{1}\\) intersect at point \\(E\\). However, this is true more generally, without the assumption that \\(A_{1} B_{1}\\) and \\(A B\\) are perpendicular, because points \\(C\\) and \\(D\\) are conjugates with respect to the excircle. The last observation could replace the first paragraph of Solution 1."}
{"id": "imo-shortlist-2006-g6", "question": "G6. Circles \\(\\omega_{1}\\) and \\(\\omega_{2}\\) with centres \\(O_{1}\\) and \\(O_{2}\\) are externally tangent at point \\(D\\) and internally tangent to a circle \\(\\omega\\) at points \\(E\\) and \\(F\\), respectively. Line \\(t\\) is the common tangent of \\(\\omega_{1}\\) and \\(\\omega_{2}\\) at \\(D\\). Let \\(A B\\) be the diameter of \\(\\omega\\) perpendicular to \\(t\\), so that \\(A, E\\) and \\(O_{1}\\) are on the same side of \\(t\\). Prove that lines \\(A O_{1}, B O_{2}, E F\\) and \\(t\\) are concurrent.", "category": "Geometry", "source": "IMO Shortlist", "year": 2006, "solution": "Point \\(E\\) is the centre of a homothety \\(h\\) which takes circle \\(\\omega_{1}\\) to circle \\(\\omega\\). The radii \\(O_{1} D\\) and \\(O B\\) of these circles are parallel as both are perpendicular to line \\(t\\). Also, \\(O_{1} D\\) and \\(O B\\) are on the same side of line \\(E O\\), hence \\(h\\) takes \\(O_{1} D\\) to \\(O B\\). Consequently, points \\(E\\), \\(D\\) and \\(B\\) are collinear. Likewise, points \\(F, D\\) and \\(A\\) are collinear as well.\n\nLet lines \\(A E\\) and \\(B F\\) intersect at \\(C\\). Since \\(A F\\) and \\(B E\\) are altitudes in triangle \\(A B C\\), their common point \\(D\\) is the orthocentre of this triangle. So \\(C D\\) is perpendicular to \\(A B\\), implying that \\(C\\) lies on line \\(t\\). Note that triangle \\(A B C\\) is acute-angled. We mention the well-known fact that triangles \\(F E C\\) and \\(A B C\\) are similar in ratio \\(\\cos \\gamma\\), where \\(\\gamma=\\angle A C B\\). In addition, points \\(C, E, D\\) and \\(F\\) lie on the circle with diameter \\(C D\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b870456914a15f8830dfg-42}\n\nLet \\(P\\) be the common point of lines \\(E F\\) and \\(t\\). We are going to prove that \\(P\\) lies on line \\(A O_{1}\\). Denote by \\(N\\) the second common point of circle \\(\\omega_{1}\\) and \\(A C\\); this is the point of \\(\\omega_{1}\\) diametrically opposite to \\(D\\). By Menelaus' theorem for triangle \\(D C N\\), points \\(A, O_{1}\\) and \\(P\\) are collinear if and only if\n\n\\[\n\\frac{C A}{A N} \\cdot \\frac{N O_{1}}{O_{1} D} \\cdot \\frac{D P}{P C}=1\n\\]\n\nBecause \\(N O_{1}=O_{1} D\\), this reduces to \\(C A / A N=C P / P D\\). Let line \\(t\\) meet \\(A B\\) at \\(K\\). Then \\(C A / A N=C K / K D\\), so it suffices to show that\n\n\\[\n\\frac{C P}{P D}=\\frac{C K}{K D} .\n\\]\n\nTo verify (1), consider the circumcircle \\(\\Omega\\) of triangle \\(A B C\\). Draw its diameter \\(C U\\) through \\(C\\), and let \\(C U\\) meet \\(A B\\) at \\(V\\). Extend \\(C K\\) to meet \\(\\Omega\\) at \\(L\\). Since \\(A B\\) is parallel to \\(U L\\), we have \\(\\angle A C U=\\angle B C L\\). On the other hand \\(\\angle E F C=\\angle B A C, \\angle F E C=\\angle A B C\\) and \\(E F / A B=\\cos \\gamma\\), as stated above. So reflection in the bisector of \\(\\angle A C B\\) followed by a homothety with centre \\(C\\) and ratio \\(1 / \\cos \\gamma\\) takes triangle \\(F E C\\) to triangle \\(A B C\\). Consequently, this transformation takes \\(C D\\) to \\(C U\\), which implies \\(C P / P D=C V / V U\\). Next, we have \\(K L=K D\\), because \\(D\\)\nis the orthocentre of triangle \\(A B C\\). Hence \\(C K / K D=C K / K L\\). Finally, \\(C V / V U=C K / K L\\) because \\(A B\\) is parallel to \\(U L\\). Relation (1) follows, proving that \\(P\\) lies on line \\(A O_{1}\\). By symmetry, \\(P\\) also lies on line \\(A O_{2}\\) which completes the solution.\nSolution 2. We proceed as in the first solution to define a triangle \\(A B C\\) with orthocentre \\(D\\), in which \\(A F\\) and \\(B E\\) are altitudes.\n\nDenote by \\(M\\) the midpoint of \\(C D\\). The quadrilateral \\(C E D F\\) is inscribed in a circle with centre \\(M\\), hence \\(M C=M E=M D=M F\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b870456914a15f8830dfg-43}\n\nConsider triangles \\(A B C\\) and \\(O_{1} O_{2} M\\). Lines \\(O_{1} O_{2}\\) and \\(A B\\) are parallel, both of them being perpendicular to line \\(t\\). Next, \\(M O_{1}\\) is the line of centres of circles ( \\(C E F\\) ) and \\(\\omega_{1}\\) whose common chord is \\(D E\\). Hence \\(M O_{1}\\) bisects \\(\\angle D M E\\) which is the external angle at \\(M\\) in the isosceles triangle \\(C E M\\). It follows that \\(\\angle D M O_{1}=\\angle D C A\\), so that \\(M O_{1}\\) is parallel to \\(A C\\). Likewise, \\(M O_{2}\\) is parallel to \\(B C\\).\n\nThus the respective sides of triangles \\(A B C\\) and \\(O_{1} O_{2} M\\) are parallel; in addition, these triangles are not congruent. Hence there is a homothety taking \\(A B C\\) to \\(O_{1} O_{2} M\\). The lines \\(A O_{1}\\), \\(B O_{2}\\) and \\(C M=t\\) are concurrent at the centre \\(Q\\) of this homothety.\n\nFinally, apply Pappus' theorem to the triples of collinear points \\(A, O, B\\) and \\(O_{2}, D, O_{1}\\). The theorem implies that the points \\(A D \\cap O O_{2}=F, A O_{1} \\cap B O_{2}=Q\\) and \\(O O_{1} \\cap B D=E\\) are collinear. In other words, line \\(E F\\) passes through the common point \\(Q\\) of \\(A O_{1}, B O_{2}\\) and \\(t\\).\nComment. Relation (1) from Solution 1 expresses the well-known fact that points \\(P\\) and \\(K\\) are harmonic conjugates with respect to points \\(C\\) and \\(D\\). It is also easy to justify it by direct computation. Denoting \\(\\angle C A B=\\alpha, \\angle A B C=\\beta\\), it is straightforward to obtain \\(C P / P D=C K / K D=\\tan \\alpha \\tan \\beta\\)."}
{"id": "imo-shortlist-2006-g7", "question": "G7. In a triangle \\(A B C\\), let \\(M_{a}, M_{b}, M_{c}\\) be respectively the midpoints of the sides \\(B C, C A\\), \\(A B\\) and \\(T_{a}, T_{b}, T_{c}\\) be the midpoints of the arcs \\(B C, C A, A B\\) of the circumcircle of \\(A B C\\), not containing the opposite vertices. For \\(i \\in\\{a, b, c\\}\\), let \\(\\omega_{i}\\) be the circle with \\(M_{i} T_{i}\\) as diameter. Let \\(p_{i}\\) be the common external tangent to \\(\\omega_{j}, \\omega_{k}(\\{i, j, k\\}=\\{a, b, c\\})\\) such that \\(\\omega_{i}\\) lies on the opposite side of \\(p_{i}\\) than \\(\\omega_{j}, \\omega_{k}\\) do. Prove that the lines \\(p_{a}, p_{b}, p_{c}\\) form a triangle similar to \\(A B C\\) and find the ratio of similitude.", "category": "Geometry", "source": "IMO Shortlist", "year": 2006, "solution": "Let \\(T_{a} T_{b}\\) intersect circle \\(\\omega_{b}\\) at \\(T_{b}\\) and \\(U\\), and let \\(T_{a} T_{c}\\) intersect circle \\(\\omega_{c}\\) at \\(T_{c}\\) and \\(V\\). Further, let \\(U X\\) be the tangent to \\(\\omega_{b}\\) at \\(U\\), with \\(X\\) on \\(A C\\), and let \\(V Y\\) be the tangent to \\(\\omega_{c}\\) at \\(V\\), with \\(Y\\) on \\(A B\\). The homothety with centre \\(T_{b}\\) and ratio \\(T_{b} T_{a} / T_{b} U\\) maps the circle \\(\\omega_{b}\\) onto the circumcircle of \\(A B C\\) and the line \\(U X\\) onto the line tangent to the circumcircle at \\(T_{a}\\), which is parallel to \\(B C\\); thus \\(U X \\| B C\\). The same is true of \\(V Y\\), so that \\(U X\\|B C\\| V Y\\).\n\nLet \\(T_{a} T_{b}\\) cut \\(A C\\) at \\(P\\) and let \\(T_{a} T_{c}\\) cut \\(A B\\) at \\(Q\\). The point \\(X\\) lies on the hypotenuse \\(P M_{b}\\) of the right triangle \\(P U M_{b}\\) and is equidistant from \\(U\\) and \\(M_{b}\\). So \\(X\\) is the midpoint of \\(M_{b} P\\). Similarly \\(Y\\) is the midpoint of \\(M_{c} Q\\).\n\nDenote the incentre of triangle \\(A B C\\) as usual by \\(I\\). It is a known fact that \\(T_{a} I=T_{a} B\\) and \\(T_{c} I=T_{c} B\\). Therefore the points \\(B\\) and \\(I\\) are symmetric across \\(T_{a} T_{c}\\), and consequently \\(\\angle Q I B=\\angle Q B I=\\angle I B C\\). This implies that \\(B C\\) is parallel to the line \\(I Q\\), and likewise, to \\(I P\\). In other words, \\(P Q\\) is the line parallel to \\(B C\\) passing through \\(I\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b870456914a15f8830dfg-45}\n\nClearly \\(M_{b} M_{c} \\| B C\\). So \\(P M_{b} M_{c} Q\\) is a trapezoid and the segment \\(X Y\\) connects the midpoints of its nonparallel sides; hence \\(X Y \\| B C\\). This combined with the previously established relations \\(U X\\|B C\\| V Y\\) shows that all the four points \\(U, X, Y, V\\) lie on a line which is the common tangent to circles \\(\\omega_{b}, \\omega_{c}\\). Since it leaves these two circles on one side and the circle \\(\\omega_{a}\\) on the other, this line is just the line \\(p_{a}\\) from the problem statement.\n\nLine \\(p_{a}\\) runs midway between \\(I\\) and \\(M_{b} M_{c}\\). Analogous conclusions hold for the lines \\(p_{b}\\) and \\(p_{c}\\). So these three lines form a triangle homothetic from centre \\(I\\) to triangle \\(M_{a} M_{b} M_{c}\\) in ratio \\(1 / 2\\), hence similar to \\(A B C\\) in ratio \\(1 / 4\\)."}
{"id": "imo-shortlist-2006-g8", "question": "G8. Let \\(A B C D\\) be a convex quadrilateral. A circle passing through the points \\(A\\) and \\(D\\) and a circle passing through the points \\(B\\) and \\(C\\) are externally tangent at a point \\(P\\) inside the quadrilateral. Suppose that\n\n\\[\n\\angle P A B+\\angle P D C \\leq 90^{\\circ} \\quad \\text { and } \\quad \\angle P B A+\\angle P C D \\leq 90^{\\circ} .\n\\]\n\nProve that \\(A B+C D \\geq B C+A D\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2006, "solution": "We start with a preliminary observation. Let \\(T\\) be a point inside the quadrilateral \\(A B C D\\). Then:\n\n\\[\n\\begin{aligned}\n& \\text { Circles }(B C T) \\text { and }(D A T) \\text { are tangent at } T \n& \\text { if and only if } \\quad \\angle A D T+\\angle B C T=\\angle A T B .\n\n\\]\n\nIndeed, if the two circles touch each other then their common tangent at \\(T\\) intersects the segment \\(A B\\) at a point \\(Z\\), and so \\(\\angle A D T=\\angle A T Z, \\angle B C T=\\angle B T Z\\), by the tangent-chord theorem. Thus \\(\\angle A D T+\\angle B C T=\\angle A T Z+\\angle B T Z=\\angle A T B\\).\n\nAnd conversely, if \\(\\angle A D T+\\angle B C T=\\angle A T B\\) then one can draw from \\(T\\) a ray \\(T Z\\) with \\(Z\\) on \\(A B\\) so that \\(\\angle A D T=\\angle A T Z, \\angle B C T=\\angle B T Z\\). The first of these equalities implies that \\(T Z\\) is tangent to the circle ( \\(D A T\\) ); by the second equality, \\(T Z\\) is tangent to the circle ( \\(B C T\\) ), so the two circles are tangent at \\(T\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b870456914a15f8830dfg-46}\n\nSo the equivalence (1) is settled. It will be used later on. Now pass to the actual solution. Its key idea is to introduce the circumcircles of triangles \\(A B P\\) and \\(C D P\\) and to consider their second intersection \\(Q\\) (assume for the moment that they indeed meet at two distinct points \\(P\\) and \\(Q\\) ).\n\nSince the point \\(A\\) lies outside the circle ( \\(B C P\\) ), we have \\(\\angle B C P+\\angle B A P<180^{\\circ}\\). Therefore the point \\(C\\) lies outside the circle ( \\(A B P\\) ). Analogously, \\(D\\) also lies outside that circle. It follows that \\(P\\) and \\(Q\\) lie on the same \\(\\operatorname{arc} C D\\) of the circle \\((B C P)\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b870456914a15f8830dfg-46(1)}\n\nBy symmetry, \\(P\\) and \\(Q\\) lie on the same arc \\(A B\\) of the circle ( \\(A B P\\) ). Thus the point \\(Q\\) lies either inside the angle \\(B P C\\) or inside the angle \\(A P D\\). Without loss of generality assume that \\(Q\\) lies inside the angle \\(B P C\\). Then\n\n\\[\n\\angle A Q D=\\angle P Q A+\\angle P Q D=\\angle P B A+\\angle P C D \\leq 90^{\\circ}\n\\]\n\nby the condition of the problem.\nIn the cyclic quadrilaterals \\(A P Q B\\) and \\(D P Q C\\), the angles at vertices \\(A\\) and \\(D\\) are acute. So their angles at \\(Q\\) are obtuse. This implies that \\(Q\\) lies not only inside the angle \\(B P C\\) but in fact inside the triangle \\(B P C\\), hence also inside the quadrilateral \\(A B C D\\).\n\nNow an argument similar to that used in deriving (2) shows that\n\n\\[\n\\angle B Q C=\\angle P A B+\\angle P D C \\leq 90^{\\circ} .\n\\]\n\nMoreover, since \\(\\angle P C Q=\\angle P D Q\\), we get\n\n\\[\n\\angle A D Q+\\angle B C Q=\\angle A D P+\\angle P D Q+\\angle B C P-\\angle P C Q=\\angle A D P+\\angle B C P .\n\\]\n\nThe last sum is equal to \\(\\angle A P B\\), according to the observation (1) applied to \\(T=P\\). And because \\(\\angle A P B=\\angle A Q B\\), we obtain\n\n\\[\n\\angle A D Q+\\angle B C Q=\\angle A Q B\n\\]\n\nApplying now (1) to \\(T=Q\\) we conclude that the circles ( \\(B C Q\\) ) and ( \\(D A Q\\) ) are externally tangent at \\(Q\\). (We have assumed \\(P \\neq Q\\); but if \\(P=Q\\) then the last conclusion holds trivially.)\n\nFinally consider the halfdiscs with diameters \\(B C\\) and \\(D A\\) constructed inwardly to the quadrilateral \\(A B C D\\). They have centres at \\(M\\) and \\(N\\), the midpoints of \\(B C\\) and \\(D A\\) respectively. In view of (2) and (3), these two halfdiscs lie entirely inside the circles ( \\(B Q C\\) ) and ( \\(A Q D\\) ); and since these circles are tangent, the two halfdiscs cannot overlap. Hence \\(M N \\geq \\frac{1}{2} B C+\\frac{1}{2} D A\\).\n\nOn the other hand, since \\(\\overrightarrow{M N}=\\frac{1}{2}(\\overrightarrow{B A}+\\overrightarrow{C D})\\), we have \\(M N \\leq \\frac{1}{2}(A B+C D)\\). Thus indeed \\(A B+C D \\geq B C+D A\\), as claimed."}
{"id": "imo-shortlist-2006-g9", "question": "G9. Points \\(A_{1}, B_{1}, C_{1}\\) are chosen on the sides \\(B C, C A, A B\\) of a triangle \\(A B C\\), respectively. The circumcircles of triangles \\(A B_{1} C_{1}, B C_{1} A_{1}, C A_{1} B_{1}\\) intersect the circumcircle of triangle \\(A B C\\) again at points \\(A_{2}, B_{2}, C_{2}\\), respectively ( \\(A_{2} \\neq A, B_{2} \\neq B, C_{2} \\neq C\\) ). Points \\(A_{3}, B_{3}, C_{3}\\) are symmetric to \\(A_{1}, B_{1}, C_{1}\\) with respect to the midpoints of the sides \\(B C, C A, A B\\) respectively. Prove that the triangles \\(A_{2} B_{2} C_{2}\\) and \\(A_{3} B_{3} C_{3}\\) are similar.", "category": "Geometry", "source": "IMO Shortlist", "year": 2006, "solution": "We will work with oriented angles between lines. For two straight lines \\(\\ell, m\\) in the plane, \\(\\angle(\\ell, m)\\) denotes the angle of counterclockwise rotation which transforms line \\(\\ell\\) into a line parallel to \\(m\\) (the choice of the rotation centre is irrelevant). This is a signed quantity; values differing by a multiple of \\(\\pi\\) are identified, so that\n\n\\[\n\\angle(\\ell, m)=-\\angle(m, \\ell), \\quad \\angle(\\ell, m)+\\angle(m, n)=\\angle(\\ell, n) .\n\\]\n\nIf \\(\\ell\\) is the line through points \\(K, L\\) and \\(m\\) is the line through \\(M, N\\), one writes \\(\\angle(K L, M N)\\) for \\(\\angle(\\ell, m)\\); the characters \\(K, L\\) are freely interchangeable; and so are \\(M, N\\).\n\nThe counterpart of the classical theorem about cyclic quadrilaterals is the following: If \\(K, L, M, N\\) are four noncollinear points in the plane then\n\n\\[\nK, L, M, N \\text { are concyclic if and only if } \\angle(K M, L M)=\\angle(K N, L N) \\text {. }\n\\]\n\nPassing to the solution proper, we first show that the three circles \\(\\left(A B_{1} C_{1}\\right),\\left(B C_{1} A_{1}\\right)\\), ( \\(C A_{1} B_{1}\\) ) have a common point. So, let ( \\(A B_{1} C_{1}\\) ) and ( \\(B C_{1} A_{1}\\) ) intersect at the points \\(C_{1}\\) and \\(P\\). Then by (1)\n\n\\[\n\\begin{gathered}\n\\angle\\left(P A_{1}, C A_{1}\\right)=\\angle\\left(P A_{1}, B A_{1}\\right)=\\angle\\left(P C_{1}, B C_{1}\\right) \n=\\angle\\left(P C_{1}, A C_{1}\\right)=\\angle\\left(P B_{1}, A B_{1}\\right)=\\angle\\left(P B_{1}, C B_{1}\\right)\n\n\\]\n\nDenote this angle by \\(\\varphi\\).\nThe equality between the outer terms shows, again by (1), that the points \\(A_{1}, B_{1}, P, C\\) are concyclic. Thus \\(P\\) is the common point of the three mentioned circles.\n\nFrom now on the basic property (1) will be used without explicit reference. We have\n\n\\[\n\\varphi=\\angle\\left(P A_{1}, B C\\right)=\\angle\\left(P B_{1}, C A\\right)=\\angle\\left(P C_{1}, A B\\right) .\n\\]\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2025_05_30_b870456914a15f8830dfg-48}\n\n\nLet lines \\(A_{2} P, B_{2} P, C_{2} P\\) meet the circle ( \\(A B C\\) ) again at \\(A_{4}, B_{4}, C_{4}\\), respectively. As\n\n\\[\n\\angle\\left(A_{4} A_{2}, A A_{2}\\right)=\\angle\\left(P A_{2}, A A_{2}\\right)=\\angle\\left(P C_{1}, A C_{1}\\right)=\\angle\\left(P C_{1}, A B\\right)=\\varphi,\n\\]\n\nwe see that line \\(A_{2} A\\) is the image of line \\(A_{2} A_{4}\\) under rotation about \\(A_{2}\\) by the angle \\(\\varphi\\). Hence the point \\(A\\) is the image of \\(A_{4}\\) under rotation by \\(2 \\varphi\\) about \\(O\\), the centre of ( \\(A B C\\) ). The same rotation sends \\(B_{4}\\) to \\(B\\) and \\(C_{4}\\) to \\(C\\). Triangle \\(A B C\\) is the image of \\(A_{4} B_{4} C_{4}\\) in this map. Thus\n\n\\[\n\\angle\\left(A_{4} B_{4}, A B\\right)=\\angle\\left(B_{4} C_{4}, B C\\right)=\\angle\\left(C_{4} A_{4}, C A\\right)=2 \\varphi .\n\\]\n\nSince the rotation by \\(2 \\varphi\\) about \\(O\\) takes \\(B_{4}\\) to \\(B\\), we have \\(\\angle\\left(A B_{4}, A B\\right)=\\varphi\\). Hence by (2)\n\n\\[\n\\angle\\left(A B_{4}, P C_{1}\\right)=\\angle\\left(A B_{4}, A B\\right)+\\angle\\left(A B, P C_{1}\\right)=\\varphi+(-\\varphi)=0,\n\\]\n\nwhich means that \\(A B_{4} \\| P C_{1}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b870456914a15f8830dfg-49}\n\nLet \\(C_{5}\\) be the intersection of lines \\(P C_{1}\\) and \\(A_{4} B_{4}\\); define \\(A_{5}, B_{5}\\) analogously. So \\(A B_{4} \\| C_{1} C_{5}\\) and, by (3) and (2),\n\n\\[\n\\angle\\left(A_{4} B_{4}, P C_{1}\\right)=\\angle\\left(A_{4} B_{4}, A B\\right)+\\angle\\left(A B, P C_{1}\\right)=2 \\varphi+(-\\varphi)=\\varphi ;\n\\]\n\ni.e., \\(\\angle\\left(B_{4} C_{5}, C_{5} C_{1}\\right)=\\varphi\\). This combined with \\(\\angle\\left(C_{5} C_{1}, C_{1} A\\right)=\\angle\\left(P C_{1}, A B\\right)=\\varphi\\) (see (2)) proves that the quadrilateral \\(A B_{4} C_{5} C_{1}\\) is an isosceles trapezoid with \\(A C_{1}=B_{4} C_{5}\\).\n\nInterchanging the roles of \\(A\\) and \\(B\\) we infer that also \\(B C_{1}=A_{4} C_{5}\\). And since \\(A C_{1}+B C_{1}=\\) \\(A B=A_{4} B_{4}\\), it follows that the point \\(C_{5}\\) lies on the line segment \\(A_{4} B_{4}\\) and partitions it into segments \\(A_{4} C_{5}, B_{4} C_{5}\\) of lengths \\(B C_{1}\\left(=A C_{3}\\right)\\) and \\(A C_{1}\\left(=B C_{3}\\right)\\). In other words, the rotation which maps triangle \\(A_{4} B_{4} C_{4}\\) onto \\(A B C\\) carries \\(C_{5}\\) onto \\(C_{3}\\). Likewise, it sends \\(A_{5}\\) to \\(A_{3}\\) and \\(B_{5}\\) to \\(B_{3}\\). So the triangles \\(A_{3} B_{3} C_{3}\\) and \\(A_{5} B_{5} C_{5}\\) are congruent. It now suffices to show that the latter is similar to \\(A_{2} B_{2} C_{2}\\).\n\nLines \\(B_{4} C_{5}\\) and \\(P C_{5}\\) coincide respectively with \\(A_{4} B_{4}\\) and \\(P C_{1}\\). Thus by (4)\n\n\\[\n\\angle\\left(B_{4} C_{5}, P C_{5}\\right)=\\varphi\n\\]\n\nAnalogously (by cyclic shift) \\(\\varphi=\\angle\\left(C_{4} A_{5}, P A_{5}\\right)\\), which rewrites as\n\n\\[\n\\varphi=\\angle\\left(B_{4} A_{5}, P A_{5}\\right)\n\\]\n\nThese relations imply that the points \\(P, B_{4}, C_{5}, A_{5}\\) are concyclic. Analogously, \\(P, C_{4}, A_{5}, B_{5}\\) and \\(P, A_{4}, B_{5}, C_{5}\\) are concyclic quadruples. Therefore\n\n\\[\n\\angle\\left(A_{5} B_{5}, C_{5} B_{5}\\right)=\\angle\\left(A_{5} B_{5}, P B_{5}\\right)+\\angle\\left(P B_{5}, C_{5} B_{5}\\right)=\\angle\\left(A_{5} C_{4}, P C_{4}\\right)+\\angle\\left(P A_{4}, C_{5} A_{4}\\right)\n\\]\n\nOn the other hand, since the points \\(A_{2}, B_{2}, C_{2}, A_{4}, B_{4}, C_{4}\\) all lie on the circle ( \\(A B C\\) ), we have\n\n\\[\n\\angle\\left(A_{2} B_{2}, C_{2} B_{2}\\right)=\\angle\\left(A_{2} B_{2}, B_{4} B_{2}\\right)+\\angle\\left(B_{4} B_{2}, C_{2} B_{2}\\right)=\\angle\\left(A_{2} A_{4}, B_{4} A_{4}\\right)+\\angle\\left(B_{4} C_{4}, C_{2} C_{4}\\right) .\n\\]\n\nBut the lines \\(A_{2} A_{4}, B_{4} A_{4}, B_{4} C_{4}, C_{2} C_{4}\\) coincide respectively with \\(P A_{4}, C_{5} A_{4}, A_{5} C_{4}, P C_{4}\\). So the sums on the right-hand sides of (5) and (6) are equal, leading to equality between their left-hand sides: \\(\\angle\\left(A_{5} B_{5}, C_{5} B_{5}\\right)=\\angle\\left(A_{2} B_{2}, C_{2} B_{2}\\right)\\). Hence (by cyclic shift, once more) also \\(\\angle\\left(B_{5} C_{5}, A_{5} C_{5}\\right)=\\angle\\left(B_{2} C_{2}, A_{2} C_{2}\\right)\\) and \\(\\angle\\left(C_{5} A_{5}, B_{5} A_{5}\\right)=\\angle\\left(C_{2} A_{2}, B_{2} A_{2}\\right)\\). This means that the triangles \\(A_{5} B_{5} C_{5}\\) and \\(A_{2} B_{2} C_{2}\\) have their corresponding angles equal, and consequently they are similar.\n\nComment 1. This is the way in which the proof has been presented by the proposer. Trying to work it out in the language of classical geometry, so as to avoid oriented angles, one is led to difficulties due to the fact that the reasoning becomes heavily case-dependent. Disposition of relevant points can vary in many respects. Angles which are equal in one case become supplementary in another. Although it seems not hard to translate all formulas from the shapes they have in one situation to the one they have in another, the real trouble is to identify all cases possible and rigorously verify that the key conclusions retain validity in each case.\n\nThe use of oriented angles is a very efficient method to omit this trouble. It seems to be the most appropriate environment in which the solution can be elaborated.\nComment 2. Actually, the fact that the circles \\(\\left(A B_{1} C_{1}\\right),\\left(B C_{1} A_{1}\\right)\\) and \\(\\left(C A_{1} B_{1}\\right)\\) have a common point does not require a proof; it is known as Miquel's theorem."}
{"id": "imo-shortlist-2006-g10", "question": "G10. To each side \\(a\\) of a convex polygon we assign the maximum area of a triangle contained in the polygon and having \\(a\\) as one of its sides. Show that the sum of the areas assigned to all sides of the polygon is not less than twice the area of the polygon.", "category": "Geometry", "source": "IMO Shortlist", "year": 2006, "solution": ""}
{"id": "imo-shortlist-2006-n1", "question": "N1. Determine all pairs \\((x, y)\\) of integers satisfying the equation\n\n\\[\n1+2^{x}+2^{2 x+1}=y^{2}\n\\]", "category": "Number Theory", "source": "IMO Shortlist", "year": 2006, "solution": "If \\((x, y)\\) is a solution then obviously \\(x \\geq 0\\) and \\((x,-y)\\) is a solution too. For \\(x=0\\) we get the two solutions \\((0,2)\\) and \\((0,-2)\\).\n\nNow let \\((x, y)\\) be a solution with \\(x>0\\); without loss of generality confine attention to \\(y>0\\). The equation rewritten as\n\n\\[\n2^{x}\\left(1+2^{x+1}\\right)=(y-1)(y+1)\n\\]\n\nshows that the factors \\(y-1\\) and \\(y+1\\) are even, exactly one of them divisible by 4 . Hence \\(x \\geq 3\\) and one of these factors is divisible by \\(2^{x-1}\\) but not by \\(2^{x}\\). So\n\n\\[\ny=2^{x-1} m+\\epsilon, \\quad m \\text { odd }, \\quad \\epsilon= \\pm 1\n\\]\n\nPlugging this into the original equation we obtain\n\n\\[\n2^{x}\\left(1+2^{x+1}\\right)=\\left(2^{x-1} m+\\epsilon\\right)^{2}-1=2^{2 x-2} m^{2}+2^{x} m \\epsilon\n\\]\n\nor, equivalently\n\n\\[\n1+2^{x+1}=2^{x-2} m^{2}+m \\epsilon\n\\]\n\nTherefore\n\n\\[\n1-\\epsilon m=2^{x-2}\\left(m^{2}-8\\right)\n\\]\n\nFor \\(\\epsilon=1\\) this yields \\(m^{2}-8 \\leq 0\\), i.e., \\(m=1\\), which fails to satisfy (2).\nFor \\(\\epsilon=-1\\) equation (2) gives us\n\n\\[\n1+m=2^{x-2}\\left(m^{2}-8\\right) \\geq 2\\left(m^{2}-8\\right)\n\\]\n\nimplying \\(2 m^{2}-m-17 \\leq 0\\). Hence \\(m \\leq 3\\); on the other hand \\(m\\) cannot be 1 by (2). Because \\(m\\) is odd, we obtain \\(m=3\\), leading to \\(x=4\\). From (1) we get \\(y=23\\). These values indeed satisfy the given equation. Recall that then \\(y=-23\\) is also good. Thus we have the complete list of solutions \\((x, y):(0,2),(0,-2),(4,23),(4,-23)\\)."}
{"id": "imo-shortlist-2006-n2", "question": "N2. For \\(x \\in(0,1)\\) let \\(y \\in(0,1)\\) be the number whose \\(n\\)th digit after the decimal point is the \\(\\left(2^{n}\\right)\\) th digit after the decimal point of \\(x\\). Show that if \\(x\\) is rational then so is \\(y\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2006, "solution": "Since \\(x\\) is rational, its digits repeat periodically starting at some point. We wish to show that this is also true for the digits of \\(y\\), implying that \\(y\\) is rational.\n\nLet \\(d\\) be the length of the period of \\(x\\) and let \\(d=2^{u} \\cdot v\\), where \\(v\\) is odd. There is a positive integer \\(w\\) such that\n\n\\[\n2^{w} \\equiv 1 \\quad(\\bmod v)\n\\]\n\n(For instance, one can choose \\(w\\) to be \\(\\varphi(v)\\), the value of Euler's function at \\(v\\).) Therefore\n\n\\[\n2^{n+w}=2^{n} \\cdot 2^{w} \\equiv 2^{n} \\quad(\\bmod v)\n\\]\n\nfor each \\(n\\). Also, for \\(n \\geq u\\) we have\n\n\\[\n2^{n+w} \\equiv 2^{n} \\equiv 0 \\quad\\left(\\bmod 2^{u}\\right)\n\\]\n\nIt follows that, for all \\(n \\geq u\\), the relation\n\n\\[\n2^{n+w} \\equiv 2^{n} \\quad(\\bmod d)\n\\]\n\nholds. Thus, for \\(n\\) sufficiently large, the \\(2^{n+w}\\) th digit of \\(x\\) is in the same spot in the cycle of \\(x\\) as its \\(2^{n}\\) th digit, and so these digits are equal. Hence the \\((n+w)\\) th digit of \\(y\\) is equal to its \\(n\\)th digit. This means that the digits of \\(y\\) repeat periodically with period \\(w\\) from some point on, as required."}
{"id": "imo-shortlist-2006-n3", "question": "N3. The sequence \\(f(1), f(2), f(3), \\ldots\\) is defined by\n\n\\[\nf(n)=\\frac{1}{n}\\left(\\left\\lfloor\\frac{n}{1}\\right\\rfloor+\\left\\lfloor\\frac{n}{2}\\right\\rfloor+\\cdots+\\left\\lfloor\\frac{n}{n}\\right\\rfloor\\right),\n\\]\n\nwhere \\(\\lfloor x\\rfloor\\) denotes the integer part of \\(x\\).\n(a) Prove that \\(f(n+1)>f(n)\\) infinitely often.\n(b) Prove that \\(f(n+1)<f(n)\\) infinitely often.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2006, "solution": "Let \\(g(n)=n f(n)\\) for \\(n \\geq 1\\) and \\(g(0)=0\\). We note that, for \\(k=1, \\ldots, n\\),\n\n\\[\n\\left\\lfloor\\frac{n}{k}\\right\\rfloor-\\left\\lfloor\\frac{n-1}{k}\\right\\rfloor=0\n\\]\n\nif \\(k\\) is not a divisor of \\(n\\) and\n\n\\[\n\\left\\lfloor\\frac{n}{k}\\right\\rfloor-\\left\\lfloor\\frac{n-1}{k}\\right\\rfloor=1\n\\]\n\nif \\(k\\) divides \\(n\\). It therefore follows that if \\(d(n)\\) is the number of positive divisors of \\(n \\geq 1\\) then\n\n\\[\n\\begin{aligned}\ng(n) & =\\left\\lfloor\\frac{n}{1}\\right\\rfloor+\\left\\lfloor\\frac{n}{2}\\right\\rfloor+\\cdots+\\left\\lfloor\\frac{n}{n-1}\\right\\rfloor+\\left\\lfloor\\frac{n}{n}\\right\\rfloor \n& =\\left\\lfloor\\frac{n-1}{1}\\right\\rfloor+\\left\\lfloor\\frac{n-1}{2}\\right\\rfloor+\\cdots+\\left\\lfloor\\frac{n-1}{n-1}\\right\\rfloor+\\left\\lfloor\\frac{n-1}{n}\\right\\rfloor+d(n) \n& =g(n-1)+d(n) .\n\n\\]\n\nHence\n\n\\[\ng(n)=g(n-1)+d(n)=g(n-2)+d(n-1)+d(n)=\\cdots=d(1)+d(2)+\\cdots+d(n)\n\\]\n\nmeaning that\n\n\\[\nf(n)=\\frac{d(1)+d(2)+\\cdots+d(n)}{n}\n\\]\n\nIn other words, \\(f(n)\\) is equal to the arithmetic mean of \\(d(1), d(2), \\ldots, d(n)\\). In order to prove the claims, it is therefore sufficient to show that \\(d(n+1)>f(n)\\) and \\(d(n+1)<f(n)\\) both hold infinitely often.\n\nWe note that \\(d(1)=1\\). For \\(n>1, d(n) \\geq 2\\) holds, with equality if and only if \\(n\\) is prime. Since \\(f(6)=7 / 3>2\\), it follows that \\(f(n)>2\\) holds for all \\(n \\geq 6\\).\n\nSince there are infinitely many primes, \\(d(n+1)=2\\) holds for infinitely many values of \\(n\\), and for each such \\(n \\geq 6\\) we have \\(d(n+1)=2<f(n)\\). This proves claim (b).\n\nTo prove (a), notice that the sequence \\(d(1), d(2), d(3), \\ldots\\) is unbounded (e. g. \\(d\\left(2^{k}\\right)=k+1\\) for all \\(k\\) ). Hence \\(d(n+1)>\\max \\{d(1), d(2), \\ldots, d(n)\\}\\) for infinitely many \\(n\\). For all such \\(n\\), we have \\(d(n+1)>f(n)\\). This completes the solution."}
{"id": "imo-shortlist-2006-n4", "question": "N4. Let \\(P\\) be a polynomial of degree \\(n>1\\) with integer coefficients and let \\(k\\) be any positive integer. Consider the polynomial \\(Q(x)=P(P(\\ldots P(P(x)) \\ldots))\\), with \\(k\\) pairs of parentheses. Prove that \\(Q\\) has no more than \\(n\\) integer fixed points, i.e. integers satisfying the equation \\(Q(x)=x\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2006, "solution": "The claim is obvious if every integer fixed point of \\(Q\\) is a fixed point of \\(P\\) itself. For the sequel assume that this is not the case. Take any integer \\(x_{0}\\) such that \\(Q\\left(x_{0}\\right)=x_{0}\\), \\(P\\left(x_{0}\\right) \\neq x_{0}\\) and define inductively \\(x_{i+1}=P\\left(x_{i}\\right)\\) for \\(i=0,1,2, \\ldots\\); then \\(x_{k}=x_{0}\\).\n\nIt is evident that\n\n\\[\nP(u)-P(v) \\text { is divisible by } u-v \\text { for distinct integers } u, v .\n\\]\n\n(Indeed, if \\(P(x)=\\sum a_{i} x^{i}\\) then each \\(a_{i}\\left(u^{i}-v^{i}\\right)\\) is divisible by \\(u-v\\).) Therefore each term in the chain of (nonzero) differences\n\n\\[\nx_{0}-x_{1}, \\quad x_{1}-x_{2}, \\quad \\ldots, \\quad x_{k-1}-x_{k}, \\quad x_{k}-x_{k+1}\n\\]\n\nis a divisor of the next one; and since \\(x_{k}-x_{k+1}=x_{0}-x_{1}\\), all these differences have equal absolute values. For \\(x_{m}=\\min \\left(x_{1}, \\ldots, x_{k}\\right)\\) this means that \\(x_{m-1}-x_{m}=-\\left(x_{m}-x_{m+1}\\right)\\). Thus \\(x_{m-1}=x_{m+1}\\left(\\neq x_{m}\\right)\\). It follows that consecutive differences in the sequence (2) have opposite signs. Consequently, \\(x_{0}, x_{1}, x_{2}, \\ldots\\) is an alternating sequence of two distinct values. In other words, every integer fixed point of \\(Q\\) is a fixed point of the polynomial \\(P(P(x))\\). Our task is to prove that there are at most \\(n\\) such points.\n\nLet \\(a\\) be one of them so that \\(b=P(a) \\neq a\\) (we have assumed that such an \\(a\\) exists); then \\(a=P(b)\\). Take any other integer fixed point \\(\\alpha\\) of \\(P(P(x))\\) and let \\(P(\\alpha)=\\beta\\), so that \\(P(\\beta)=\\alpha\\); the numbers \\(\\alpha\\) and \\(\\beta\\) need not be distinct ( \\(\\alpha\\) can be a fixed point of \\(P\\) ), but each of \\(\\alpha, \\beta\\) is different from each of \\(a, b\\). Applying property (1) to the four pairs of integers \\((\\alpha, a),(\\beta, b)\\), \\((\\alpha, b),(\\beta, a)\\) we get that the numbers \\(\\alpha-a\\) and \\(\\beta-b\\) divide each other, and also \\(\\alpha-b\\) and \\(\\beta-a\\) divide each other. Consequently\n\n\\[\n\\alpha-b= \\pm(\\beta-a), \\quad \\alpha-a= \\pm(\\beta-b)\n\\]\n\nSuppose we have a plus in both instances: \\(\\alpha-b=\\beta-a\\) and \\(\\alpha-a=\\beta-b\\). Subtraction yields \\(a-b=b-a\\), a contradiction, as \\(a \\neq b\\). Therefore at least one equality in (3) holds with a minus sign. For each of them this means that \\(\\alpha+\\beta=a+b\\); equivalently \\(a+b-\\alpha-P(\\alpha)=0\\).\n\nDenote \\(a+b\\) by \\(C\\). We have shown that every integer fixed point of \\(Q\\) other that \\(a\\) and \\(b\\) is a root of the polynomial \\(F(x)=C-x-P(x)\\). This is of course true for \\(a\\) and \\(b\\) as well. And since \\(P\\) has degree \\(n>1\\), the polynomial \\(F\\) has the same degree, so it cannot have more than \\(n\\) roots. Hence the result.\n\nComment. The first part of the solution, showing that integer fixed points of any iterate of \\(P\\) are in fact fixed points of the second iterate \\(P \\circ P\\) is standard; moreover, this fact has already appeared in contests. We however do not consider this as a major drawback to the problem because the only tricky moment comes up only at the next stage of the reasoning - to apply the divisibility property (1) to points from distinct 2-orbits of \\(P\\). Yet maybe it would be more appropriate to state the problem in a version involving \\(k=2\\) only."}
{"id": "imo-shortlist-2006-n5", "question": "N5. Find all integer", "category": "Number Theory", "source": "IMO Shortlist", "year": 2006, "solution": "s of the equation\n\n\\[\n\\frac{x^{7}-1}{x-1}=y^{5}-1\n\\]\n\nSolution. The equation has no integer solutions. To show this, we first prove a lemma.\nLemma. If \\(x\\) is an integer and \\(p\\) is a prime divisor of \\(\\frac{x^{7}-1}{x-1}\\) then either \\(p \\equiv 1(\\bmod 7)\\) or \\(p=7\\). Proof. Both \\(x^{7}-1\\) and \\(x^{p-1}-1\\) are divisible by \\(p\\), by hypothesis and by Fermat's little theorem, respectively. Suppose that 7 does not divide \\(p-1\\). Then \\(\\operatorname{gcd}(p-1,7)=1\\), so there exist integers \\(k\\) and \\(m\\) such that \\(7 k+(p-1) m=1\\). We therefore have\n\n\\[\nx \\equiv x^{7 k+(p-1) m} \\equiv\\left(x^{7}\\right)^{k} \\cdot\\left(x^{p-1}\\right)^{m} \\equiv 1 \\quad(\\bmod p),\n\\]\n\nand so\n\n\\[\n\\frac{x^{7}-1}{x-1}=1+x+\\cdots+x^{6} \\equiv 7 \\quad(\\bmod p) .\n\\]\n\nIt follows that \\(p\\) divides 7 , hence \\(p=7\\) must hold if \\(p \\equiv 1(\\bmod 7)\\) does not, as stated.\nThe lemma shows that each positive divisor \\(d\\) of \\(\\frac{x^{7}-1}{x-1}\\) satisfies either \\(d \\equiv 0(\\bmod 7)\\) or \\(d \\equiv 1(\\bmod 7)\\).\n\nNow assume that \\((x, y)\\) is an integer solution of the original equation. Notice that \\(y-1>0\\), because \\(\\frac{x^{7}-1}{x-1}>0\\) for all \\(x \\neq 1\\). Since \\(y-1\\) divides \\(\\frac{x^{7}-1}{x-1}=y^{5}-1\\), we have \\(y \\equiv 1(\\bmod 7)\\) or \\(y \\equiv 2(\\bmod 7)\\) by the previous paragraph. In the first case, \\(1+y+y^{2}+y^{3}+y^{4} \\equiv 5(\\bmod 7)\\), and in the second \\(1+y+y^{2}+y^{3}+y^{4} \\equiv 3(\\bmod 7)\\). Both possibilities contradict the fact that the positive divisor \\(1+y+y^{2}+y^{3}+y^{4}\\) of \\(\\frac{x^{7}-1}{x-1}\\) is congruent to 0 or 1 modulo 7 . So the given equation has no integer solutions."}
{"id": "imo-shortlist-2006-n6", "question": "N6. Let \\(a>b>1\\) be relatively prime positive integers. Define the weight of an integer \\(c\\), denoted by \\(w(c)\\), to be the minimal possible value of \\(|x|+|y|\\) taken over all pairs of integers \\(x\\) and \\(y\\) such that\n\n\\[\na x+b y=c\n\\]\n\nAn integer \\(c\\) is called a local champion if \\(w(c) \\geq w(c \\pm a)\\) and \\(w(c) \\geq w(c \\pm b)\\).\nFind all local champions and determine their number.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2006, "solution": "Call the pair of integers \\((x, y)\\) a representation of \\(c\\) if \\(a x+b y=c\\) and \\(|x|+|y|\\) has the smallest possible value, i.e. \\(|x|+|y|=w(c)\\).\n\nWe characterise the local champions by the following three observations.\nLemma 1. If \\((x, y)\\) a representation of a local champion \\(c\\) then \\(x y<0\\).\nProof. Suppose indirectly that \\(x \\geq 0\\) and \\(y \\geq 0\\) and consider the values \\(w(c)\\) and \\(w(c+a)\\). All representations of the numbers \\(c\\) and \\(c+a\\) in the form \\(a u+b v\\) can be written as\n\n\\[\nc=a(x-k b)+b(y+k a), \\quad c+a=a(x+1-k b)+b(y+k a)\n\\]\n\nwhere \\(k\\) is an arbitrary integer.\nSince \\(|x|+|y|\\) is minimal, we have\n\n\\[\nx+y=|x|+|y| \\leq|x-k b|+|y+k a|\n\\]\n\nfor all \\(k\\). On the other hand, \\(w(c+a) \\leq w(c)\\), so there exists a \\(k\\) for which\n\n\\[\n|x+1-k b|+|y+k a| \\leq|x|+|y|=x+y\n\\]\n\nThen\n\n\\[\n(x+1-k b)+(y+k a) \\leq|x+1-k b|+|y+k a| \\leq x+y \\leq|x-k b|+|y+k a| .\n\\]\n\nComparing the first and the third expressions, we find \\(k(a-b)+1 \\leq 0\\) implying \\(k<0\\). Comparing the second and fourth expressions, we get \\(|x+1-k b| \\leq|x-k b|\\), therefore \\(k b>x\\); this is a contradiction.\n\nIf \\(x, y \\leq 0\\) then we can switch to \\(-c,-x\\) and \\(-y\\).\nFrom this point, write \\(c=a x-b y\\) instead of \\(c=a x+b y\\) and consider only those cases where \\(x\\) and \\(y\\) are nonzero and have the same sign. By Lemma 1, there is no loss of generality in doing so.\nLemma 2. Let \\(c=a x-b y\\) where \\(|x|+|y|\\) is minimal and \\(x, y\\) have the same sign. The number \\(c\\) is a local champion if and only if \\(|x|<b\\) and \\(|x|+|y|=\\left\\lfloor\\frac{a+b}{2}\\right\\rfloor\\).\nProof. Without loss of generality we may assume \\(x, y>0\\).\nThe numbers \\(c-a\\) and \\(c+b\\) can be written as\n\n\\[\nc-a=a(x-1)-b y \\quad \\text { and } \\quad c+b=a x-b(y-1)\n\\]\n\nand trivially \\(w(c-a) \\leq(x-1)+y<w(c)\\) and \\(w(c+b) \\leq x+(y-1)<w(c)\\) in all cases.\nNow assume that \\(c\\) is a local champion and consider \\(w(c+a)\\). Since \\(w(c+a) \\leq w(c)\\), there exists an integer \\(k\\) such that\n\n\\[\nc+a=a(x+1-k b)-b(y-k a) \\quad \\text { and } \\quad|x+1-k b|+|y-k a| \\leq x+y\n\\]\n\nThis inequality cannot hold if \\(k \\leq 0\\), therefore \\(k>0\\). We prove that we can choose \\(k=1\\).\n\nConsider the function \\(f(t)=|x+1-b t|+|y-a t|-(x+y)\\). This is a convex function and we have \\(f(0)=1\\) and \\(f(k) \\leq 0\\). By Jensen's inequality, \\(f(1) \\leq\\left(1-\\frac{1}{k}\\right) f(0)+\\frac{1}{k} f(k)<1\\). But \\(f(1)\\) is an integer. Therefore \\(f(1) \\leq 0\\) and\n\n\\[\n|x+1-b|+|y-a| \\leq x+y\n\\]\n\nKnowing \\(c=a(x-b)-b(y-a)\\), we also have\n\n\\[\nx+y \\leq|x-b|+|y-a| .\n\\]\n\nCombining the two inequalities yields \\(|x+1-b| \\leq|x-b|\\) which is equivalent to \\(x<b\\).\nConsidering \\(w(c-b)\\), we obtain similarly that \\(y<a\\).\nNow \\(|x-b|=b-x,|x+1-b|=b-x-1\\) and \\(|y-a|=a-y\\), therefore we have\n\n\\[\n\\begin{aligned}\n(b-x-1)+(a-y) & \\leq x+y \\leq(b-x)+(a-y) \n\\frac{a+b-1}{2} & \\leq x+y \\leq \\frac{a+b}{2}\n\n\\]\n\nHence \\(x+y=\\left\\lfloor\\frac{a+b}{2}\\right\\rfloor\\).\nTo prove the opposite direction, assume \\(0<x<b\\) and \\(x+y=\\left\\lfloor\\frac{a+b}{2}\\right\\rfloor\\). Since \\(a>b\\), we also have \\(0<y<a\\). Then\n\n\\[\nw(c+a) \\leq|x+1-b|+|y-a|=a+b-1-(x+y) \\leq x+y=w(c)\n\\]\n\nand\n\n\\[\nw(c-b) \\leq|x-b|+|y+1-a|=a+b-1-(x+y) \\leq x+y=w(c)\n\\]\n\ntherefore \\(c\\) is a local champion indeed.\nLemma 3. Let \\(c=a x-b y\\) and assume that \\(x\\) and \\(y\\) have the same sign, \\(|x|<b,|y|<a\\) and \\(|x|+|y|=\\left\\lfloor\\frac{a+b}{2}\\right\\rfloor\\). Then \\(w(c)=x+y\\).\nProof. By definition \\(w(c)=\\min \\{|x-k b|+|y-k a|: k \\in \\mathbb{Z}\\}\\). If \\(k \\leq 0\\) then obviously \\(|x-k b|+|y-k a| \\geq x+y\\). If \\(k \\geq 1\\) then\n\n\\[\n|x-k b|+|y-k a|=(k b-x)+(k a-y)=k(a+b)-(x+y) \\geq(2 k-1)(x+y) \\geq x+y .\n\\]\n\nTherefore \\(w(c)=x+y\\) indeed.\nLemmas 1, 2 and 3 together yield that the set of local champions is\n\n\\[\nC=\\left\\{ \\pm(a x-b y): 0<x<b, x+y=\\left\\lfloor\\frac{a+b}{2}\\right\\rfloor\\right\\} .\n\\]\n\nDenote by \\(C^{+}\\)and \\(C^{-}\\)the two sets generated by the expressions \\(+(a x-b y)\\) and \\(-(a x-b y)\\), respectively. It is easy to see that both sets are arithmetic progressions of length \\(b-1\\), with difference \\(a+b\\).\n\nIf \\(a\\) and \\(b\\) are odd, then \\(C^{+}=C^{-}\\), because \\(a(-x)-b(-y)=a(b-x)-b(a-y)\\) and \\(x+y=\\frac{a+b}{2}\\) is equivalent to \\((b-x)+(a-y)=\\frac{a+b}{2}\\). In this case there exist \\(b-1\\) local champions.\n\nIf \\(a\\) and \\(b\\) have opposite parities then the answer is different. For any \\(c_{1} \\in C^{+}\\)and \\(c_{2} \\in C^{-}\\),\n\n\\[\n2 c_{1} \\equiv-2 c_{2} \\equiv 2\\left(a \\frac{a+b-1}{2}-b \\cdot 0\\right) \\equiv-a \\quad(\\bmod a+b)\n\\]\n\nand\n\n\\[\n2 c_{1}-2 c_{2} \\equiv-2 a \\quad(\\bmod a+b)\n\\]\n\nThe number \\(a+b\\) is odd and relatively prime to \\(a\\), therefore the elements of \\(C^{+}\\)and \\(C^{-}\\)belong to two different residue classes modulo \\(a+b\\). Hence, the set \\(C\\) is the union of two disjoint arithmetic progressions and the number of all local champions is \\(2(b-1)\\).\n\nSo the number of local champions is \\(b-1\\) if both \\(a\\) and \\(b\\) are odd and \\(2(b-1)\\) otherwise.\n\nComment. The original question, as stated by the proposer, was:\n(a) Show that there exists only finitely many local champions;\n(b) Show that there exists at least one local champion."}
{"id": "imo-shortlist-2006-n7", "question": "N7. Prove that, for every positive integer \\(n\\), there exists an integer \\(m\\) such that \\(2^{m}+m\\) is divisible by \\(n\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2006, "solution": "We will prove by induction on \\(d\\) that, for every positive integer \\(N\\), there exist positive integers \\(b_{0}, b_{1}, \\ldots, b_{d-1}\\) such that, for each \\(i=0,1,2, \\ldots, d-1\\), we have \\(b_{i}>N\\) and\n\n\\[\n2^{b_{i}}+b_{i} \\equiv i \\quad(\\bmod d)\n\\]\n\nThis yields the claim for \\(m=b_{0}\\).\nThe base case \\(d=1\\) is trivial. Take an \\(a>1\\) and assume that the statement holds for all \\(d<a\\). Note that the remainders of \\(2^{i}\\) modulo \\(a\\) repeat periodically starting with some exponent \\(M\\). Let \\(k\\) be the length of the period; this means that \\(2^{M+k^{\\prime}} \\equiv 2^{M}(\\bmod a)\\) holds only for those \\(k^{\\prime}\\) which are multiples of \\(k\\). Note further that the period cannot contain all the \\(a\\) remainders, since 0 either is missing or is the only number in the period. Thus \\(k<a\\).\n\nLet \\(d=\\operatorname{gcd}(a, k)\\) and let \\(a^{\\prime}=a / d, k^{\\prime}=k / d\\). Since \\(0<k<a\\), we also have \\(0<d<a\\). By the induction hypothesis, there exist positive integers \\(b_{0}, b_{1}, \\ldots, b_{d-1}\\) such that \\(b_{i}>\\max \\left(2^{M}, N\\right)\\) and\n\n\\[\n2^{b_{i}}+b_{i} \\equiv i \\quad(\\bmod d) \\quad \\text { for } \\quad i=0,1,2, \\ldots, d-1\n\\]\n\nFor each \\(i=0,1, \\ldots, d-1\\) consider the sequence\n\n\\[\n2^{b_{i}}+b_{i}, \\quad 2^{b_{i}+k}+\\left(b_{i}+k\\right), \\ldots, \\quad 2^{b_{i}+\\left(a^{\\prime}-1\\right) k}+\\left(b_{i}+\\left(a^{\\prime}-1\\right) k\\right) .\n\\]\n\nModulo \\(a\\), these numbers are congruent to\n\n\\[\n2^{b_{i}}+b_{i}, 2^{b_{i}}+\\left(b_{i}+k\\right), \\ldots, 2^{b_{i}}+\\left(b_{i}+\\left(a^{\\prime}-1\\right) k\\right),\n\\]\n\nrespectively. The \\(d\\) sequences contain \\(a^{\\prime} d=a\\) numbers altogether. We shall now prove that no two of these numbers are congruent modulo \\(a\\).\n\nSuppose that\n\n\\[\n2^{b_{i}}+\\left(b_{i}+m k\\right) \\equiv 2^{b_{j}}+\\left(b_{j}+n k\\right) \\quad(\\bmod a)\n\\]\n\nfor some values of \\(i, j \\in\\{0,1, \\ldots, d-1\\}\\) and \\(m, n \\in\\left\\{0,1, \\ldots, a^{\\prime}-1\\right\\}\\). Since \\(d\\) is a divisor of \\(a\\), we also have\n\n\\[\n2^{b_{i}}+\\left(b_{i}+m k\\right) \\equiv 2^{b_{j}}+\\left(b_{j}+n k\\right) \\quad(\\bmod d)\n\\]\n\nBecause \\(d\\) is a divisor of \\(k\\) and in view of (1), we obtain \\(i \\equiv j(\\bmod d)\\). As \\(i, j \\in\\{0,1, \\ldots, d-1\\}\\), this just means that \\(i=j\\). Substituting this into (3) yields \\(m k \\equiv n k(\\bmod a)\\). Therefore \\(m k^{\\prime} \\equiv n k^{\\prime}\\left(\\bmod a^{\\prime}\\right) ;\\) and since \\(a^{\\prime}\\) and \\(k^{\\prime}\\) are coprime, we get \\(m \\equiv n\\left(\\bmod a^{\\prime}\\right)\\). Hence also \\(m=n\\).\n\nIt follows that the \\(a\\) numbers that make up the \\(d\\) sequences (2) satisfy all the requirements; they are certainly all greater than \\(N\\) because we chose each \\(b_{i}>\\max \\left(2^{M}, N\\right)\\). So the statement holds for \\(a\\), completing the induction."}
{"id": "imo-shortlist-2003-a1", "question": "A1. Let \\(a_{i j}, i=1,2,3 ; j=1,2,3\\) be real numbers such that \\(a_{i j}\\) is positive for \\(i=j\\) and negative for \\(i \\neq j\\).\n\nProve that there exist positive real numbers \\(c_{1}, c_{2}, c_{3}\\) such that the numbers\n\n\\[\na_{11} c_{1}+a_{12} c_{2}+a_{13} c_{3}, \\quad a_{21} c_{1}+a_{22} c_{2}+a_{23} c_{3}, \\quad a_{31} c_{1}+a_{32} c_{2}+a_{33} c_{3}\n\\]\n\nare all negative, all positive, or all zero.", "category": "Algebra", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-a2", "question": "A2. Find all nondecreasing functions \\(f: \\mathbb{R} \\longrightarrow \\mathbb{R}\\) such that\n(i) \\(f(0)=0, f(1)=1\\);\n(ii) \\(f(a)+f(b)=f(a) f(b)+f(a+b-a b)\\) for all real numbers \\(a, b\\) such that \\(a<1<b\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-a3", "question": "A3. Consider pairs of sequences of positive real numbers\n\n\\[\na_{1} \\geq a_{2} \\geq a_{3} \\geq \\cdots, \\quad b_{1} \\geq b_{2} \\geq b_{3} \\geq \\cdots\n\\]\n\nand the sums\n\n\\[\nA_{n}=a_{1}+\\cdots+a_{n}, \\quad B_{n}=b_{1}+\\cdots+b_{n} ; \\quad n=1,2, \\ldots\n\\]\n\nFor any pair define \\(c_{i}=\\min \\left\\{a_{i}, b_{i}\\right\\}\\) and \\(C_{n}=c_{1}+\\cdots+c_{n}, n=1,2, \\ldots\\).\n(1) Does there exist a pair \\(\\left(a_{i}\\right)_{i \\geq 1},\\left(b_{i}\\right)_{i \\geq 1}\\) such that the sequences \\(\\left(A_{n}\\right)_{n \\geq 1}\\) and \\(\\left(B_{n}\\right)_{n \\geq 1}\\) are unbounded while the sequence \\(\\left(C_{n}\\right)_{n \\geq 1}\\) is bounded?\n(2) Does the answer to question (1) change by assuming additionally that \\(b_{i}=1 / i, i=\\) \\(1,2, \\ldots\\) ?\n\nJustify your answer.", "category": "Algebra", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-a4", "question": "A4. Let \\(n\\) be a positive integer and let \\(x_{1} \\leq x_{2} \\leq \\cdots \\leq x_{n}\\) be real numbers.\n(1) Prove that\n\n\\[\n\\left(\\sum_{i, j=1}^{n}\\left|x_{i}-x_{j}\\right|\\right)^{2} \\leq \\frac{2\\left(n^{2}-1\\right)}{3} \\sum_{i, j=1}^{n}\\left(x_{i}-x_{j}\\right)^{2}\n\\]\n\n(2) Show that the equality holds if and only if \\(x_{1}, \\ldots, x_{n}\\) is an arithmetic sequence.", "category": "Algebra", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-a5", "question": "A5. Let \\(\\mathbb{R}^{+}\\)be the set of all positive real numbers. Find all functions \\(f: \\mathbb{R}^{+} \\longrightarrow \\mathbb{R}^{+}\\)that satisfy the following conditions:\n(i) \\(f(x y z)+f(x)+f(y)+f(z)=f(\\sqrt{x y}) f(\\sqrt{y z}) f(\\sqrt{z x})\\) for all \\(x, y, z \\in \\mathbb{R}^{+}\\);\n(ii) \\(f(x)<f(y)\\) for all \\(1 \\leq x<y\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-a6", "question": "A6. Let \\(n\\) be a positive integer and let \\(\\left(x_{1}, \\ldots, x_{n}\\right),\\left(y_{1}, \\ldots, y_{n}\\right)\\) be two sequences of positive real numbers. Suppose \\(\\left(z_{2}, \\ldots, z_{2 n}\\right)\\) is a sequence of positive real numbers such that\n\n\\[\nz_{i+j}^{2} \\geq x_{i} y_{j} \\quad \\text { for all } 1 \\leq i, j \\leq n .\n\\]\n\nLet \\(M=\\max \\left\\{z_{2}, \\ldots, z_{2 n}\\right\\}\\). Prove that\n\n\\[\n\\left(\\frac{M+z_{2}+\\cdots+z_{2 n}}{2 n}\\right)^{2} \\geq\\left(\\frac{x_{1}+\\cdots+x_{n}}{n}\\right)\\left(\\frac{y_{1}+\\cdots+y_{n}}{n}\\right) .\n\\]", "category": "Algebra", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-c1", "question": "C1. Let \\(A\\) be a 101-element subset of the set \\(S=\\{1,2, \\ldots, 1000000\\}\\). Prove that there exist numbers \\(t_{1}, t_{2}, \\ldots, t_{100}\\) in \\(S\\) such that the sets\n\n\\[\nA_{j}=\\left\\{x+t_{j} \\mid x \\in A\\right\\}, \\quad j=1,2, \\ldots, 100\n\\]\n\nare pairwise disjoint.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-c2", "question": "C2. Let \\(D_{1}, \\ldots, D_{n}\\) be closed discs in the plane. (A closed disc is the region limited by a circle, taken jointly with this circle.) Suppose that every point in the plane is contained in at most 2003 discs \\(D_{i}\\). Prove that there exists a disc \\(D_{k}\\) which intersects at most \\(7 \\cdot 2003-1\\) other discs \\(D_{i}\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-c3", "question": "C3. Let \\(n \\geq 5\\) be a given integer. Determine the greatest integer \\(k\\) for which there exists a polygon with \\(n\\) vertices (convex or not, with non-selfintersecting boundary) having \\(k\\) internal right angles.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-c4", "question": "C4. Let \\(x_{1}, \\ldots, x_{n}\\) and \\(y_{1}, \\ldots, y_{n}\\) be real numbers. Let \\(A=\\left(a_{i j}\\right)_{1 \\leq i, j \\leq n}\\) be the matrix with entries\n\n\\[\na_{i j}= \\begin{cases}1, & \\text { if } x_{i}+y_{j} \\geq 0 ; \\\\ 0, & \\text { if } x_{i}+y_{j}<0 .\n\\]\n\nSuppose that \\(B\\) is an \\(n \\times n\\) matrix with entries 0,1 such that the sum of the elements in each row and each column of \\(B\\) is equal to the corresponding sum for the matrix \\(A\\). Prove that \\(A=B\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-c5", "question": "C5. Every point with integer coordinates in the plane is the centre of a disc with radius 1/1000.\n(1) Prove that there exists an equilateral triangle whose vertices lie in different discs.\n(2) Prove that every equilateral triangle with vertices in different discs has side-length greater than 96.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-c6", "question": "C6. Let \\(f(k)\\) be the number of integers \\(n\\) that satisfy the following conditions:\n(i) \\(0 \\leq n<10^{k}\\), so \\(n\\) has exactly \\(k\\) digits (in decimal notation), with leading zeroes allowed;\n(ii) the digits of \\(n\\) can be permuted in such a way that they yield an integer divisible by 11.\n\nProve that \\(f(2 m)=10 f(2 m-1)\\) for every positive integer \\(m\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-g1", "question": "G1. Let \\(A B C D\\) be a cyclic quadrilateral. Let \\(P, Q, R\\) be the feet of the perpendiculars from \\(D\\) to the lines \\(B C, C A, A B\\), respectively. Show that \\(P Q=Q R\\) if and only if the bisectors of \\(\\angle A B C\\) and \\(\\angle A D C\\) are concurrent with \\(A C\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-g2", "question": "G2. Three distinct points \\(A, B, C\\) are fixed on a line in this order. Let \\(\\Gamma\\) be a circle passing through \\(A\\) and \\(C\\) whose centre does not lie on the line \\(A C\\). Denote by \\(P\\) the intersection of the tangents to \\(\\Gamma\\) at \\(A\\) and \\(C\\). Suppose \\(\\Gamma\\) meets the segment \\(P B\\) at \\(Q\\). Prove that the intersection of the bisector of \\(\\angle A Q C\\) and the line \\(A C\\) does not depend on the choice of \\(\\Gamma\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-g3", "question": "G3. Let \\(A B C\\) be a triangle and let \\(P\\) be a point in its interior. Denote by \\(D, E, F\\) the feet of the perpendiculars from \\(P\\) to the lines \\(B C, C A, A B\\), respectively. Suppose that\n\n\\[\nA P^{2}+P D^{2}=B P^{2}+P E^{2}=C P^{2}+P F^{2} .\n\\]\n\nDenote by \\(I_{A}, I_{B}, I_{C}\\) the excentres of the triangle \\(A B C\\). Prove that \\(P\\) is the circumcentre of the triangle \\(I_{A} I_{B} I_{C}\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-g4", "question": "G4. Let \\(\\Gamma_{1}, \\Gamma_{2}, \\Gamma_{3}, \\Gamma_{4}\\) be distinct circles such that \\(\\Gamma_{1}, \\Gamma_{3}\\) are externally tangent at \\(P\\), and \\(\\Gamma_{2}, \\Gamma_{4}\\) are externally tangent at the same point \\(P\\). Suppose that \\(\\Gamma_{1}\\) and \\(\\Gamma_{2} ; \\Gamma_{2}\\) and \\(\\Gamma_{3} ; \\Gamma_{3}\\) and \\(\\Gamma_{4} ; \\Gamma_{4}\\) and \\(\\Gamma_{1}\\) meet at \\(A, B, C, D\\), respectively, and that all these points are different from \\(P\\).\n\nProve that\n\n\\[\n\\frac{A B \\cdot B C}{A D \\cdot D C}=\\frac{P B^{2}}{P D^{2}} .\n\\]", "category": "Geometry", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-g5", "question": "G5. Let \\(A B C\\) be an isosceles triangle with \\(A C=B C\\), whose incentre is \\(I\\). Let \\(P\\) be a point on the circumcircle of the triangle \\(A I B\\) lying inside the triangle \\(A B C\\). The lines through \\(P\\) parallel to \\(C A\\) and \\(C B\\) meet \\(A B\\) at \\(D\\) and \\(E\\), respectively. The line through \\(P\\) parallel to \\(A B\\) meets \\(C A\\) and \\(C B\\) at \\(F\\) and \\(G\\), respectively. Prove that the lines \\(D F\\) and \\(E G\\) intersect on the circumcircle of the triangle \\(A B C\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-g6", "question": "G6. Each pair of opposite sides of a convex hexagon has the following property: the distance between their midpoints is equal to \\(\\sqrt{3} / 2\\) times the sum of their lengths.\n\nProve that all the angles of the hexagon are equal.", "category": "Geometry", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-g7", "question": "G7. Let \\(A B C\\) be a triangle with semiperimeter \\(s\\) and inradius \\(r\\). The semicircles with diameters \\(B C, C A, A B\\) are drawn on the outside of the triangle \\(A B C\\). The circle tangent to all three semicircles has radius \\(t\\). Prove that\n\n\\[\n\\frac{s}{2}<t \\leq \\frac{s}{2}+\\left(1-\\frac{\\sqrt{3}}{2}\\right) r\n\\]", "category": "Geometry", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-n1", "question": "N1. Let \\(m\\) be a fixed integer greater than 1 . The sequence \\(x_{0}, x_{1}, x_{2}, \\ldots\\) is defined as follows:\n\n\\[\nx_{i}= \\begin{cases}2^{i}, & \\text { if } 0 \\leq i \\leq m-1 ; \\\\ \\sum_{j=1}^{m} x_{i-j}, & \\text { if } i \\geq m .\n\\]\n\nFind the greatest \\(k\\) for which the sequence contains \\(k\\) consecutive terms divisible by \\(m\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-n2", "question": "N2. Each positive integer \\(a\\) undergoes the following procedure in order to obtain the number \\(d=d(a)\\) :\n(i) move the last digit of \\(a\\) to the first position to obtain the number \\(b\\);\n(ii) square \\(b\\) to obtain the number \\(c\\);\n(iii) move the first digit of \\(c\\) to the end to obtain the number \\(d\\).\n(All the numbers in the problem are considered to be represented in base 10.) For example, for \\(a=2003\\), we get \\(b=3200, c=10240000\\), and \\(d=02400001=2400001=d(2003)\\).\n\nFind all numbers \\(a\\) for which \\(d(a)=a^{2}\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-n3", "question": "N3. Determine all pairs of positive integers \\((a, b)\\) such that\n\n\\[\n\\frac{a^{2}}{2 a b^{2}-b^{3}+1}\n\\]\n\nis a positive integer.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-n4", "question": "N4. Let \\(b\\) be an integer greater than 5 . For each positive integer \\(n\\), consider the number\n\n\\[\nx_{n}=\\underbrace{11 \\cdots 1}_{n-1} \\underbrace{22 \\cdots 2}_{n} 5,\n\\]\n\nwritten in base \\(b\\).\nProve that the following condition holds if and only if \\(b=10\\) :\nthere exists a positive integer \\(M\\) such that for any integer \\(n\\) greater than \\(M\\), the number \\(x_{n}\\) is a perfect square.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-n5", "question": "N5. An integer \\(n\\) is said to be good if \\(|n|\\) is not the square of an integer. Determine all integers \\(m\\) with the following property:\n\\(m\\) can be represented, in infinitely many ways, as a sum of three distinct good integers whose product is the square of an odd integer.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-n6", "question": "N6. Let \\(p\\) be a prime number. Prove that there exists a prime number \\(q\\) such that for every integer \\(n\\), the number \\(n^{p}-p\\) is not divisible by \\(q\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-n7", "question": "N7. The sequence \\(a_{0}, a_{1}, a_{2}, \\ldots\\) is defined as follows:\n\n\\[\na_{0}=2, \\quad a_{k+1}=2 a_{k}^{2}-1 \\quad \\text { for } k \\geq 0\n\\]\n\nProve that if an odd prime \\(p\\) divides \\(a_{n}\\), then \\(2^{n+3}\\) divides \\(p^{2}-1\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-n8", "question": "N8. Let \\(p\\) be a prime number and let \\(A\\) be a set of positive integers that satisfies the following conditions:\n(i) the set of prime divisors of the elements in \\(A\\) consists of \\(p-1\\) elements;\n(ii) for any nonempty subset of \\(A\\), the product of its elements is not a perfect \\(p\\)-th power.\n\nWhat is the largest possible number of elements in \\(A\\) ?", "category": "Number Theory", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-a1", "question": "A1. Let \\(a_{i j}, i=1,2,3 ; j=1,2,3\\) be real numbers such that \\(a_{i j}\\) is positive for \\(i=j\\) and negative for \\(i \\neq j\\).\n\nProve that there exist positive real numbers \\(c_{1}, c_{2}, c_{3}\\) such that the numbers\n\n\\[\na_{11} c_{1}+a_{12} c_{2}+a_{13} c_{3}, \\quad a_{21} c_{1}+a_{22} c_{2}+a_{23} c_{3}, \\quad a_{31} c_{1}+a_{32} c_{2}+a_{33} c_{3}\n\\]\n\nare all negative, all positive, or all zero.", "category": "Algebra", "source": "IMO Shortlist", "year": 2003, "solution": "Set \\(O(0,0,0), P\\left(a_{11}, a_{21}, a_{31}\\right), Q\\left(a_{12}, a_{22}, a_{32}\\right), R\\left(a_{13}, a_{23}, a_{33}\\right)\\) in the three dimensional Euclidean space. It is enough to find a point in the interior of the triangle \\(P Q R\\) whose coordinates are all positive, all negative, or all zero.\n\nLet \\(O^{\\prime}, P^{\\prime}, Q^{\\prime}, R^{\\prime}\\) be the projections of \\(O, P, Q, R\\) onto the \\(x y\\)-plane. Recall that points \\(P^{\\prime}, Q^{\\prime}\\) and \\(R^{\\prime}\\) lie on the fourth, second and third quadrant respectively.\nCase 1: \\(O^{\\prime}\\) is in the exterior or on the boundary of the triangle \\(P^{\\prime} Q^{\\prime} R^{\\prime}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aaf07823334a8756bf0cg-21}\n\nDenote by \\(S^{\\prime}\\) the intersection of the segments \\(P^{\\prime} Q^{\\prime}\\) and \\(O^{\\prime} R^{\\prime}\\), and let \\(S\\) be the point on the segment \\(P Q\\) whose projection is \\(S^{\\prime}\\). Recall that the \\(z\\)-coordinate of the point \\(S\\) is negative, since the \\(z\\)-coordinate of the points \\(P^{\\prime}\\) and \\(Q^{\\prime}\\) are both negative. Thus any point in the interior of the segment \\(S R\\) sufficiently close to \\(S\\) has coordinates all of which are negative, and we are done.\nCase 2: \\(O^{\\prime}\\) is in the interior of the triangle \\(P^{\\prime} Q^{\\prime} R^{\\prime}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aaf07823334a8756bf0cg-21(1)}\n\nLet \\(T\\) be the point on the plane \\(P Q R\\) whose projection is \\(O^{\\prime}\\). If \\(T=O\\), we are done again. Suppose \\(T\\) has negative (resp. positive) \\(z\\)-coordinate. Let \\(U\\) be a point in the interior of the triangle \\(P Q R\\), sufficiently close to \\(T\\), whose \\(x\\)-coordinates and \\(y\\)-coordinates are both negative (resp. positive). Then the coordinates of \\(U\\) are all negative (resp. positive), and we are done."}
{"id": "imo-shortlist-2003-a2", "question": "A2. Find all nondecreasing functions \\(f: \\mathbb{R} \\longrightarrow \\mathbb{R}\\) such that\n(i) \\(f(0)=0, f(1)=1\\);\n(ii) \\(\\quad f(a)+f(b)=f(a) f(b)+f(a+b-a b)\\) for all real numbers \\(a, b\\) such that \\(a<1<b\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2003, "solution": "Let \\(g(x)=f(x+1)-1\\). Then \\(g\\) is nondecreasing, \\(g(0)=0, g(-1)=-1\\), and \\(g(-(a-1)(b-1))=-g(a-1) g(b-1)\\) for \\(a<1<b\\). Thus \\(g(-x y)=-g(x) g(y)\\) for \\(x<0<y\\), or \\(g(y z)=-g(y) g(-z)\\) for \\(y, z>0\\). Vice versa, if \\(g\\) satisfies those conditions, then \\(f\\) satisfies the given conditions.\n\nCase 1: If \\(g(1)=0\\), then \\(g(z)=0\\) for all \\(z>0\\). Now let \\(g: \\mathbb{R} \\longrightarrow \\mathbb{R}\\) be any nondecreasing function such that \\(g(-1)=-1\\) and \\(g(x)=0\\) for all \\(x \\geq 0\\). Then \\(g\\) satisfies the required conditions.\n\nCase 2: If \\(g(1)>0\\), putting \\(y=1\\) yields\n\n\\[\ng(-z)=-\\frac{g(z)}{g(1)}\n\\]\n\nfor all \\(z>0\\). Hence \\(g(y z)=g(y) g(z) / g(1)\\) for all \\(y, z>0\\). Let \\(h(x)=g(x) / g(1)\\). Then \\(h\\) is nondecreasing, \\(h(0)=0, h(1)=1\\), and \\(h(x y)=h(x) h(y)\\). It follows that \\(h\\left(x^{q}\\right)=h(x)^{q}\\) for any \\(x>0\\) and any rational number \\(q\\). Since \\(h\\) is nondecreasing, there exists a nonnegative number \\(k\\) such that \\(h(x)=x^{k}\\) for all \\(x>0\\). Putting \\(g(1)=c\\), we have \\(g(x)=c x^{k}\\) for all \\(x>0\\). Furthermore (*) implies \\(g(-x)=-x^{k}\\) for all \\(x>0\\). Now let \\(k \\geq 0, c>0\\) and\n\n\\[\ng(x)= \\begin{cases}c x^{k}, & \\text { if } x>0 \\\\ 0, & \\text { if } x=0 \\\\ -(-x)^{k}, & \\text { if } x<0\n\\]\n\nThen \\(g\\) is nondecreasing, \\(g(0)=0, g(-1)=-1\\), and \\(g(-x y)=-g(x) g(y)\\) for \\(x<0<y\\). Hence \\(g\\) satisfies the required conditions.\n\nWe obtain all solutions for \\(f\\) by the re-substitution \\(f(x)=g(x-1)+1\\). In Case 1, we have any nondecreasing function \\(f\\) satisfying\n\n\\[\nf(x)= \\begin{cases}1, & \\text { if } x \\geq 1 \\\\ 0, & \\text { if } x=0\n\\]\n\nIn Case 2, we obtain\n\n\\[\nf(x)= \\begin{cases}c(x-1)^{k}+1, & \\text { if } x>1 \\\\ 1, & \\text { if } x=1 \\\\ -(1-x)^{k}+1, & \\text { if } x<1\n\\]\n\nwhere \\(c>0\\) and \\(k \\geq 0\\)."}
{"id": "imo-shortlist-2003-a3", "question": "A3. Consider pairs of sequences of positive real numbers\n\n\\[\na_{1} \\geq a_{2} \\geq a_{3} \\geq \\cdots, \\quad b_{1} \\geq b_{2} \\geq b_{3} \\geq \\cdots\n\\]\n\nand the sums\n\n\\[\nA_{n}=a_{1}+\\cdots+a_{n}, \\quad B_{n}=b_{1}+\\cdots+b_{n} ; \\quad n=1,2, \\ldots\n\\]\n\nFor any pair define \\(c_{i}=\\min \\left\\{a_{i}, b_{i}\\right\\}\\) and \\(C_{n}=c_{1}+\\cdots+c_{n}, n=1,2, \\ldots\\).\n(1) Does there exist a pair \\(\\left(a_{i}\\right)_{i \\geq 1},\\left(b_{i}\\right)_{i \\geq 1}\\) such that the sequences \\(\\left(A_{n}\\right)_{n \\geq 1}\\) and \\(\\left(B_{n}\\right)_{n \\geq 1}\\) are unbounded while the sequence \\(\\left(C_{n}\\right)_{n \\geq 1}\\) is bounded?\n(2) Does the answer to question (1) change by assuming additionally that \\(b_{i}=1 / i, i=\\) \\(1,2, \\ldots\\) ?\n\nJustify your answer.", "category": "Algebra", "source": "IMO Shortlist", "year": 2003, "solution": "(1) Yes.\nLet \\(\\left(c_{i}\\right)\\) be an arbitrary sequence of positive numbers such that \\(c_{i} \\geq c_{i+1}\\) and \\(\\sum_{i=1}^{\\infty} c_{i}<\\infty\\). Let \\(\\left(k_{m}\\right)\\) be a sequence of integers satisfying \\(1=k_{1}<k_{2}<k_{3}<\\cdots\\) and \\(\\left(k_{m+1}-k_{m}\\right) c_{k_{m}} \\geq 1\\).\n\nNow we define the sequences \\(\\left(a_{i}\\right)\\) and \\(\\left(b_{i}\\right)\\) as follows. For \\(n\\) odd and \\(k_{n} \\leq i<k_{n+1}\\), define \\(a_{i}=c_{k_{n}}\\) and \\(b_{i}=c_{i}\\). Then we have \\(A_{k_{n+1}-1} \\geq A_{k_{n}-1}+1\\). For \\(n\\) even and \\(k_{n} \\leq i<k_{n+1}\\), define \\(a_{i}=c_{i}\\) and \\(b_{i}=c_{k_{n}}\\). Then we have \\(B_{k_{n+1-1}} \\geq B_{k_{n-1}}+1\\). Thus \\(\\left(A_{n}\\right)\\) and \\(\\left(B_{n}\\right)\\) are unbounded and \\(c_{i}=\\min \\left\\{a_{i}, b_{i}\\right\\}\\).\n(2) Yes.\n\nSuppose that there is such a pair.\nCase 1: \\(b_{i}=c_{i}\\) for only finitely many \\(i\\) 's.\nThere exists a sufficiently large \\(I\\) such that \\(c_{i}=a_{i}\\) for any \\(i \\geq I\\). Therefore\n\n\\[\n\\sum_{i \\geq I} c_{i}=\\sum_{i \\geq I} a_{i}=\\infty\n\\]\n\na contradiction.\nCase 2: \\(b_{i}=c_{i}\\) for infinitely many \\(i\\) 's.\nLet \\(\\left(k_{m}\\right)\\) be a sequence of integers satisfying \\(k_{m+1} \\geq 2 k_{m}\\) and \\(b_{k_{m}}=c_{k_{m}}\\). Then\n\n\\[\n\\sum_{k=k_{i}+1}^{k_{i+1}} c_{k} \\geq\\left(k_{i+1}-k_{i}\\right) \\frac{1}{k_{i+1}} \\geq \\frac{1}{2}\n\\]\n\nThus \\(\\sum_{i=1}^{\\infty} c_{i}=\\infty\\), a contradiction."}
{"id": "imo-shortlist-2003-a4", "question": "A4. Let \\(n\\) be a positive integer and let \\(x_{1} \\leq x_{2} \\leq \\cdots \\leq x_{n}\\) be real numbers.\n(1) Prove that\n\n\\[\n\\left(\\sum_{i, j=1}^{n}\\left|x_{i}-x_{j}\\right|\\right)^{2} \\leq \\frac{2\\left(n^{2}-1\\right)}{3} \\sum_{i, j=1}^{n}\\left(x_{i}-x_{j}\\right)^{2} .\n\\]\n\n(2) Show that the equality holds if and only if \\(x_{1}, \\ldots, x_{n}\\) is an arithmetic sequence.", "category": "Algebra", "source": "IMO Shortlist", "year": 2003, "solution": "(1) Since both sides of the inequality are invariant under any translation of all \\(x_{i}\\) 's, we may assume without loss of generality that \\(\\sum_{i=1}^{n} x_{i}=0\\).\n\nWe have\n\n\\[\n\\sum_{i, j=1}^{n}\\left|x_{i}-x_{j}\\right|=2 \\sum_{i<j}\\left(x_{j}-x_{i}\\right)=2 \\sum_{i=1}^{n}(2 i-n-1) x_{i}\n\\]\n\nBy the Cauchy-Schwarz inequality, we have\n\n\\[\n\\left(\\sum_{i, j=1}^{n}\\left|x_{i}-x_{j}\\right|\\right)^{2} \\leq 4 \\sum_{i=1}^{n}(2 i-n-1)^{2} \\sum_{i=1}^{n} x_{i}^{2}=4 \\cdot \\frac{n(n+1)(n-1)}{3} \\sum_{i=1}^{n} x_{i}^{2}\n\\]\n\nOn the other hand, we have\n\n\\[\n\\sum_{i, j=1}^{n}\\left(x_{i}-x_{j}\\right)^{2}=n \\sum_{i=1}^{n} x_{i}^{2}-\\sum_{i=1}^{n} x_{i} \\sum_{j=1}^{n} x_{j}+n \\sum_{j=1}^{n} x_{j}^{2}=2 n \\sum_{i=1}^{n} x_{i}^{2}\n\\]\n\nTherefore\n\n\\[\n\\left(\\sum_{i, j=1}^{n}\\left|x_{i}-x_{j}\\right|\\right)^{2} \\leq \\frac{2\\left(n^{2}-1\\right)}{3} \\sum_{i, j=1}^{n}\\left(x_{i}-x_{j}\\right)^{2}\n\\]\n\n(2) If the equality holds, then \\(x_{i}=k(2 i-n-1)\\) for some \\(k\\), which means that \\(x_{1}, \\ldots, x_{n}\\) is an arithmetic sequence.\n\nOn the other hand, suppose that \\(x_{1}, \\ldots, x_{2 n}\\) is an arithmetic sequence with common difference \\(d\\). Then we have\n\n\\[\nx_{i}=\\frac{d}{2}(2 i-n-1)+\\frac{x_{1}+x_{n}}{2} .\n\\]\n\nTranslate \\(x_{i}\\) 's by \\(-\\left(x_{1}+x_{n}\\right) / 2\\) to obtain \\(x_{i}=d(2 i-n-1) / 2\\) and \\(\\sum_{i=1}^{n} x_{i}=0\\), from which the equality follows."}
{"id": "imo-shortlist-2003-a5", "question": "A5. Let \\(\\mathbb{R}^{+}\\)be the set of all positive real numbers. Find all functions \\(f: \\mathbb{R}^{+} \\longrightarrow \\mathbb{R}^{+}\\)that satisfy the following conditions:\n(i) \\(f(x y z)+f(x)+f(y)+f(z)=f(\\sqrt{x y}) f(\\sqrt{y z}) f(\\sqrt{z x})\\) for all \\(x, y, z \\in \\mathbb{R}^{+}\\);\n(ii) \\(f(x)<f(y)\\) for all \\(1 \\leq x<y\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2003, "solution": "We claim that \\(f(x)=x^{\\lambda}+x^{-\\lambda}\\), where \\(\\lambda\\) is an arbitrary positive real number.\nLemma. There exists a unique function \\(g:[1, \\infty) \\longrightarrow[1, \\infty)\\) such that\n\n\\[\nf(x)=g(x)+\\frac{1}{g(x)}\n\\]\n\nProof. Put \\(x=y=z=1\\) in the given functional equation\n\n\\[\nf(x y z)+f(x)+f(y)+f(z)=f(\\sqrt{x y}) f(\\sqrt{y z}) f(\\sqrt{z x})\n\\]\n\nto obtain \\(4 f(1)=f(1)^{3}\\). Since \\(f(1)>0\\), we have \\(f(1)=2\\).\nDefine the function \\(A:[1, \\infty) \\longrightarrow[2, \\infty)\\) by \\(A(x)=x+1 / x\\). Since \\(f\\) is strictly increasing on \\([1, \\infty)\\) and \\(A\\) is bijective, the function \\(g\\) is uniquely determined.\n\nSince \\(A\\) is strictly increasing, we see that \\(g\\) is also strictly increasing. Since \\(f(1)=2\\), we have \\(g(1)=1\\).\n\nWe put \\((x, y, z)=(t, t, 1 / t),\\left(t^{2}, 1,1\\right)\\) to obtain \\(f(t)=f(1 / t)\\) and \\(f\\left(t^{2}\\right)=f(t)^{2}-2\\). Put \\((x, y, z)=(s / t, t / s, s t),\\left(s^{2}, 1 / s^{2}, t^{2}\\right)\\) to obtain\n\n\\[\nf(s t)+f\\left(\\frac{t}{s}\\right)=f(s) f(t) \\quad \\text { and } \\quad f(s t) f\\left(\\frac{t}{s}\\right)=f\\left(s^{2}\\right)+f\\left(t^{2}\\right)=f(s)^{2}+f(t)^{2}-4\n\\]\n\nLet \\(1 \\leq x \\leq y\\). We will show that \\(g(x y)=g(x) g(y)\\). We have\n\n\\[\n\\begin{aligned}\nf(x y)+f\\left(\\frac{y}{x}\\right) & =\\left(g(x)+\\frac{1}{g(x)}\\right)\\left(g(y)+\\frac{1}{g(y)}\\right) \n& =\\left(g(x) g(y)+\\frac{1}{g(x) g(y)}\\right)+\\left(\\frac{g(x)}{g(y)}+\\frac{g(y)}{g(x)}\\right)\n\n\\]\n\nand\n\n\\[\n\\begin{aligned}\nf(x y) f\\left(\\frac{y}{x}\\right) & =\\left(g(x)+\\frac{1}{g(x)}\\right)^{2}+\\left(g(y)+\\frac{1}{g(y)}\\right)^{2}-4 \n& =\\left(g(x) g(y)+\\frac{1}{g(x) g(y)}\\right)\\left(\\frac{g(x)}{g(y)}+\\frac{g(y)}{g(x)}\\right)\n\n\\]\n\nThus\n\n\\[\n\\left\\{f(x y), f\\left(\\frac{y}{x}\\right)\\right\\}=\\left\\{g(x) g(y)+\\frac{1}{g(x) g(y)}, \\frac{g(x)}{g(y)}+\\frac{g(y)}{g(x)}\\right\\}=\\left\\{A(g(x) g(y)), A\\left(\\frac{g(y)}{g(x)}\\right)\\right\\}\n\\]\n\nSince \\(f(x y)=A(g(x y))\\) and \\(A\\) is bijective, it follows that either \\(g(x y)=g(x) g(y)\\) or \\(g(x y)=g(y) / g(x)\\). Since \\(x y \\geq y\\) and \\(g\\) is increasing, we have \\(g(x y)=g(x) g(y)\\).\n\nFix a real number \\(\\varepsilon>1\\) and suppose that \\(g(\\varepsilon)=\\varepsilon^{\\lambda}\\). Since \\(g(\\varepsilon)>1\\), we have \\(\\lambda>0\\). Using the multiplicity of \\(g\\), we may easily see that \\(g\\left(\\varepsilon^{q}\\right)=\\varepsilon^{q \\lambda}\\) for all rationals \\(q \\in[0, \\infty)\\). Since \\(g\\) is strictly increasing, \\(g\\left(\\varepsilon^{t}\\right)=\\varepsilon^{t \\lambda}\\) for all \\(t \\in[0, \\infty)\\), that is, \\(g(x)=x^{\\lambda}\\) for all \\(x \\geq 1\\).\n\nFor all \\(x \\geq 1\\), we have \\(f(x)=x^{\\lambda}+x^{-\\lambda}\\). Recalling that \\(f(t)=f(1 / t)\\), we have \\(f(x)=\\) \\(x^{\\lambda}+x^{-\\lambda}\\) for \\(0<x<1\\) as well.\n\nNow we must check that for any \\(\\lambda>0\\), the function \\(f(x)=x^{\\lambda}+x^{-\\lambda}\\) satisfies the two given conditions. The condition (i) is satisfied because\n\n\\[\n\\begin{aligned}\nf(\\sqrt{x y}) f(\\sqrt{y z}) f(\\sqrt{z x}) & =\\left((x y)^{\\lambda / 2}+(x y)^{-\\lambda / 2}\\right)\\left((y z)^{\\lambda / 2}+(y z)^{-\\lambda / 2}\\right)\\left((z x)^{\\lambda / 2}+(z x)^{-\\lambda / 2}\\right) \n& =(x y z)^{\\lambda}+x^{\\lambda}+y^{\\lambda}+z^{\\lambda}+x^{-\\lambda}+y^{-\\lambda}+z^{-\\lambda}+(x y z)^{-\\lambda} \n& =f(x y z)+f(x)+f(y)+f(z)\n\n\\]\n\nThe condition (ii) is also satisfied because \\(1 \\leq x<y\\) implies\n\n\\[\nf(y)-f(x)=\\left(y^{\\lambda}-x^{\\lambda}\\right)\\left(1-\\frac{1}{(x y)^{\\lambda}}\\right)>0\n\\]\n\nSolution 2. We can a find positive real number \\(\\lambda\\) such that \\(f(e)=\\exp (\\lambda)+\\exp (-\\lambda)\\) since the function \\(B:[0, \\infty) \\longrightarrow[2, \\infty)\\) defined by \\(B(x)=\\exp (x)+\\exp (-x)\\) is bijective.\n\nSince \\(f(t)^{2}=f\\left(t^{2}\\right)+2\\) and \\(f(x)>0\\), we have\n\n\\[\nf\\left(\\exp \\left(\\frac{1}{2^{n}}\\right)\\right)=\\exp \\left(\\frac{\\lambda}{2^{n}}\\right)+\\exp \\left(-\\frac{\\lambda}{2^{n}}\\right)\n\\]\n\nfor all nonnegative integers \\(n\\).\nSince \\(f(s t)=f(s) f(t)-f(t / s)\\), we have\n\n\\[\nf\\left(\\exp \\left(\\frac{m+1}{2^{n}}\\right)\\right)=f\\left(\\exp \\left(\\frac{1}{2^{n}}\\right)\\right) f\\left(\\exp \\left(\\frac{m}{2^{n}}\\right)\\right)-f\\left(\\exp \\left(\\frac{m-1}{2^{n}}\\right)\\right)\n\\]\n\nfor all nonnegative integers \\(m\\) and \\(n\\).\nFrom \\((*)\\) and \\(f(1)=2\\), we obtain by induction that\n\n\\[\nf\\left(\\exp \\left(\\frac{m}{2^{n}}\\right)\\right)=\\exp \\left(\\frac{m \\lambda}{2^{n}}\\right)+\\exp \\left(-\\frac{m \\lambda}{2^{n}}\\right)\n\\]\n\nfor all nonnegative integers \\(m\\) and \\(n\\).\nSince \\(f\\) is increasing on \\([1, \\infty)\\), we have \\(f(x)=x^{\\lambda}+x^{-\\lambda}\\) for \\(x \\geq 1\\).\nWe can prove that \\(f(x)=x^{\\lambda}+x^{-\\lambda}\\) for \\(0<x<1\\) and that this function satisfies the given conditions in the same manner as in the first solution."}
{"id": "imo-shortlist-2003-a6", "question": "A6. Let \\(n\\) be a positive integer and let \\(\\left(x_{1}, \\ldots, x_{n}\\right),\\left(y_{1}, \\ldots, y_{n}\\right)\\) be two sequences of positive real numbers. Suppose \\(\\left(z_{2}, \\ldots, z_{2 n}\\right)\\) is a sequence of positive real numbers such that\n\n\\[\nz_{i+j}^{2} \\geq x_{i} y_{j} \\quad \\text { for all } 1 \\leq i, j \\leq n\n\\]\n\nLet \\(M=\\max \\left\\{z_{2}, \\ldots, z_{2 n}\\right\\}\\). Prove that\n\n\\[\n\\left(\\frac{M+z_{2}+\\cdots+z_{2 n}}{2 n}\\right)^{2} \\geq\\left(\\frac{x_{1}+\\cdots+x_{n}}{n}\\right)\\left(\\frac{y_{1}+\\cdots+y_{n}}{n}\\right)\n\\]", "category": "Algebra", "source": "IMO Shortlist", "year": 2003, "solution": "Let \\(X=\\max \\left\\{x_{1}, \\ldots, x_{n}\\right\\}\\) and \\(Y=\\max \\left\\{y_{1}, \\ldots, y_{n}\\right\\}\\). By replacing \\(x_{i}\\) by \\(x_{i}^{\\prime}=\\) \\(x_{i} / X, y_{i}\\) by \\(y_{i}^{\\prime}=y_{i} / Y\\), and \\(z_{i}\\) by \\(z_{i}^{\\prime}=z_{i} / \\sqrt{X Y}\\), we may assume that \\(X=Y=1\\). Now we will prove that\n\n\\[\nM+z_{2}+\\cdots+z_{2 n} \\geq x_{1}+\\cdots+x_{n}+y_{1}+\\cdots+y_{n}\n\\]\n\nso\n\n\\[\n\\frac{M+z_{2}+\\cdots+z_{2 n}}{2 n} \\geq \\frac{1}{2}\\left(\\frac{x_{1}+\\cdots+x_{n}}{n}+\\frac{y_{1}+\\cdots+y_{n}}{n}\\right)\n\\]\n\nwhich implies the desired result by the AM-GM inequality.\nTo prove (*), we will show that for any \\(r \\geq 0\\), the number of terms greater that \\(r\\) on the left hand side is at least the number of such terms on the right hand side. Then the \\(k\\) th largest term on the left hand side is greater than or equal to the \\(k\\) th largest term on the right hand side for each \\(k\\), proving \\((*)\\). If \\(r \\geq 1\\), then there are no terms greater than \\(r\\) on the right hand side. So suppose \\(r<1\\). Let \\(A=\\left\\{1 \\leq i \\leq n \\mid x_{i}>r\\right\\}, a=|A|\\), \\(B=\\left\\{1 \\leq i \\leq n \\mid y_{i}>r\\right\\}, b=|B|\\). Since \\(\\max \\left\\{x_{1}, \\ldots, x_{n}\\right\\}=\\max \\left\\{y_{1}, \\ldots, y_{n}\\right\\}=1\\), both \\(a\\) and \\(b\\) are at least 1 . Now \\(x_{i}>r\\) and \\(y_{j}>r\\) implies \\(z_{i+j} \\geq \\sqrt{x_{i} y_{j}}>r\\), so\n\n\\[\nC=\\left\\{2 \\leq i \\leq 2 n \\mid z_{i}>r\\right\\} \\supset A+B=\\{\\alpha+\\beta \\mid \\alpha \\in A, \\beta \\in B\\}\n\\]\n\nHowever, we know that \\(|A+B| \\geq|A|+|B|-1\\), because if \\(A=\\left\\{i_{1}, \\ldots, i_{a}\\right\\}, i_{1}<\\cdots<i_{a}\\) and \\(B=\\left\\{j_{1}, \\ldots, j_{b}\\right\\}, j_{1}<\\cdots<j_{b}\\), then the \\(a+b-1\\) numbers \\(i_{1}+j_{1}, i_{1}+j_{2}, \\ldots, i_{1}+j_{b}\\), \\(i_{2}+j_{b}, \\ldots, i_{a}+j_{b}\\) are all distinct and belong to \\(A+B\\). Hence \\(|C| \\geq a+b-1\\). In particular, \\(|C| \\geq 1\\) so \\(z_{k}>r\\) for some \\(k\\). Then \\(M>r\\), so the left hand side of (\\textit{) has at least \\(a+b\\) terms greater than \\(r\\). Since \\(a+b\\) is the number of terms greater than \\(r\\) on the right hand side, we have proved (})."}
{"id": "imo-shortlist-2003-c1", "question": "C1. Let \\(A\\) be a 101-element subset of the set \\(S=\\{1,2, \\ldots, 1000000\\}\\). Prove that there exist numbers \\(t_{1}, t_{2}, \\ldots, t_{100}\\) in \\(S\\) such that the sets\n\n\\[\nA_{j}=\\left\\{x+t_{j} \\mid x \\in A\\right\\}, \\quad j=1,2, \\ldots, 100\n\\]\n\nare pairwise disjoint.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2003, "solution": "Consider the set \\(D=\\{x-y \\mid x, y \\in A\\}\\). There are at most \\(101 \\times 100+1=\\) 10101 elements in \\(D\\). Two sets \\(A+t_{i}\\) and \\(A+t_{j}\\) have nonempty intersection if and only if \\(t_{i}-t_{j}\\) is in \\(D\\). So we need to choose the 100 elements in such a way that we do not use a difference from \\(D\\).\n\nNow select these elements by induction. Choose one element arbitrarily. Assume that \\(k\\) elements, \\(k \\leq 99\\), are already chosen. An element \\(x\\) that is already chosen prevents us from selecting any element from the set \\(x+D\\). Thus after \\(k\\) elements are chosen, at most \\(10101 k \\leq 999999\\) elements are forbidden. Hence we can select one more element.\n\nComment. The size \\(|S|=10^{6}\\) is unnecessarily large. The following statement is true:\nIf \\(A\\) is a \\(k\\)-element subset of \\(S=\\{1, \\ldots, n\\}\\) and \\(m\\) is a positive integer such that \\(\\left.n>(m-1)\\binom{k}{2}+1\\right)\\), then there exist \\(t_{1}, \\ldots, t_{m} \\in S\\) such that the sets \\(A_{j}=\\left\\{x+t_{j} \\mid x \\in A\\right\\}, j=1, \\ldots, m\\) are pairwise disjoint.\n\nSolution 2. We give a solution to the generalised version.\nConsider the set \\(B=\\{|x-y| \\mid x, y \\in A\\}\\). Clearly, \\(|B| \\leq\\binom{ k}{2}+1\\).\nIt suffices to prove that there exist \\(t_{1}, \\ldots, t_{m} \\in S\\) such that \\(\\left|t_{i}-t_{j}\\right| \\notin B\\) for every distinct \\(i\\) and \\(j\\). We will select \\(t_{1}, \\ldots, t_{m}\\) inductively.\n\nChoose 1 as \\(t_{1}\\), and consider the set \\(C_{1}=S \\backslash\\left(B+t_{1}\\right)\\). Then we have \\(\\left|C_{1}\\right| \\geq n-\\left(\\binom{k}{2}+1\\right)>\\) \\((m-2)\\left(\\binom{k}{2}+1\\right)\\).\n\nFor \\(1 \\leq i<m\\), suppose that \\(t_{1}, \\ldots, t_{i}\\) and \\(C_{i}\\) are already defined and that \\(\\left|C_{i}\\right|>\\) \\((m-i-1)\\left(\\binom{k}{2}+1\\right) \\geq 0\\). Choose the least element in \\(C_{i}\\) as \\(t_{i+1}\\) and consider the set \\(C_{i+1}=C_{i} \\backslash\\left(B+t_{i+1}\\right)\\). Then\n\n\\[\n\\left|C_{i+1}\\right| \\geq\\left|C_{i}\\right|-\\left(\\binom{k}{2}+1\\right)>(m-i-2)\\left(\\binom{k}{2}+1\\right) \\geq 0 .\n\\]\n\nClearly, \\(t_{1}, \\ldots, t_{m}\\) satisfy the desired condition."}
{"id": "imo-shortlist-2003-c2", "question": "C2. Let \\(D_{1}, \\ldots, D_{n}\\) be closed discs in the plane. (A closed disc is the region limited by a circle, taken jointly with this circle.) Suppose that every point in the plane is contained in at most 2003 discs \\(D_{i}\\). Prove that there exists a disc \\(D_{k}\\) which intersects at most \\(7 \\cdot 2003-1\\) other discs \\(D_{i}\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2003, "solution": "Pick a disc \\(S\\) with the smallest radius, say \\(s\\). Subdivide the plane into seven regions as in Figure 1, that is, subdivide the complement of \\(S\\) into six congruent regions \\(T_{1}\\), \\(\\ldots, T_{6}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aaf07823334a8756bf0cg-30}\n\nFigure 1\n\nSince \\(s\\) is the smallest radius, any disc different from \\(S\\) whose centre lies inside \\(S\\) contains the centre \\(O\\) of the disc \\(S\\). Therefore the number of such discs is less than or equal to 2002.\n\nWe will show that if a disc \\(D_{k}\\) has its centre inside \\(T_{i}\\) and intersects \\(S\\), then \\(D_{k}\\) contains \\(P_{i}\\), where \\(P_{i}\\) is the point such that \\(O P_{i}=\\sqrt{3} s\\) and \\(O P_{i}\\) bisects the angle formed by the two half-lines that bound \\(T_{i}\\).\n\nSubdivide \\(T_{i}\\) into \\(U_{i}\\) and \\(V_{i}\\) as in Figure 2.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aaf07823334a8756bf0cg-31}\n\nFigure 2\nThe region \\(U_{i}\\) is contained in the disc with radius \\(s\\) and centre \\(P_{i}\\). Thus, if the centre of \\(D_{k}\\) is inside \\(U_{i}\\), then \\(D_{k}\\) contains \\(P_{i}\\).\n\nSuppose that the centre of \\(D_{k}\\) is inside \\(V_{i}\\). Let \\(Q\\) be the centre of \\(D_{k}\\) and let \\(R\\) be the intersection of \\(O Q\\) and the boundary of \\(S\\). Since \\(D_{k}\\) intersects \\(S\\), the radius of \\(D_{k}\\) is greater than \\(Q R\\). Since \\(\\angle Q P_{i} R \\geq \\angle C P_{i} B=60^{\\circ}\\) and \\(\\angle P_{i} R O \\geq \\angle P_{i} B O=120^{\\circ}\\), we have \\(\\angle Q P_{i} R \\geq \\angle P_{i} R Q\\). Hence \\(Q R \\geq Q P_{i}\\) and so \\(D_{k}\\) contains \\(P_{i}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aaf07823334a8756bf0cg-31(1)}\n\nFigure 3\nFor \\(i=1, \\ldots, 6\\), the number of discs \\(D_{k}\\) having their centres inside \\(T_{i}\\) and intersecting \\(S\\) is less than or equal to 2003. Consequently, the number of discs \\(D_{k}\\) that intersect \\(S\\) is less than or equal to \\(2002+6 \\cdot 2003=7 \\cdot 2003-1\\)."}
{"id": "imo-shortlist-2003-c3", "question": "C3. Let \\(n \\geq 5\\) be a given integer. Determine the greatest integer \\(k\\) for which there exists a polygon with \\(n\\) vertices (convex or not, with non-selfintersecting boundary) having \\(k\\) internal right angles.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2003, "solution": "We will show that the greatest integer \\(k\\) satisfying the given condition is equal to 3 for \\(n=5\\), and \\(\\lfloor 2 n / 3\\rfloor+1\\) for \\(n \\geq 6\\).\n\nAssume that there exists an \\(n\\)-gon having \\(k\\) internal right angles. Since all other \\(n-k\\) angles are less than \\(360^{\\circ}\\), we have\n\n\\[\n(n-k) \\cdot 360^{\\circ}+k \\cdot 90^{\\circ}>(n-2) \\cdot 180^{\\circ}\n\\]\n\nor \\(k<(2 n+4) / 3\\). Since \\(k\\) and \\(n\\) are integers, we have \\(k \\leq\\lfloor 2 n / 3\\rfloor+1\\).\nIf \\(n=5\\), then \\(\\lfloor 2 n / 3\\rfloor+1=4\\). However, if a pentagon has 4 internal right angles, then the other angle is equal to \\(180^{\\circ}\\), which is not appropriate. Figure 1 gives the pentagon with 3 internal right angles, thus the greatest integer \\(k\\) is equal to 3 .\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aaf07823334a8756bf0cg-32}\n\nFigure 1\nWe will construct an \\(n\\)-gon having \\(\\lfloor 2 n / 3\\rfloor+1\\) internal right angles for each \\(n \\geq 6\\). Figure 2 gives the examples for \\(n=6,7,8\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aaf07823334a8756bf0cg-32(1)}\n\nFigure 2\nFor \\(n \\geq 9\\), we will construct examples inductively. Since all internal non-right angles in this construction are greater than \\(180^{\\circ}\\), we can cut off 'a triangle without a vertex' around a non-right angle in order to obtain three more vertices and two more internal right angles as in Figure 3.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aaf07823334a8756bf0cg-32(2)}\n\nFigure 3\n\nComment. Here we give two other ways to construct examples.\nOne way is to add 'a rectangle with a hat' near an internal non-right angle as in Figure 4.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aaf07823334a8756bf0cg-33(3)}\n\nFigure 4\nThe other way is 'the escaping construction.' First we draw right angles in spiral.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aaf07823334a8756bf0cg-33(5)}\n\nThen we 'escape' from the point \\(P\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aaf07823334a8756bf0cg-33(4)}\n\nThe followings are examples for \\(n=9,10,11\\). The angles around the black points are not right.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aaf07823334a8756bf0cg-33}\n\\(n=9\\)\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aaf07823334a8756bf0cg-33(2)}\n\\(n=10\\)\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aaf07823334a8756bf0cg-33(1)}\n\\(n=11\\)\n\nThe 'escaping lines' are not straight in these figures. However, in fact, we can make them straight when we draw sufficiently large figures."}
{"id": "imo-shortlist-2003-c4", "question": "C4. Let \\(x_{1}, \\ldots, x_{n}\\) and \\(y_{1}, \\ldots, y_{n}\\) be real numbers. Let \\(A=\\left(a_{i j}\\right)_{1 \\leq i, j \\leq n}\\) be the matrix with entries\n\n\\[\na_{i j}= \\begin{cases}1, & \\text { if } x_{i}+y_{j} \\geq 0 \\\\ 0, & \\text { if } x_{i}+y_{j}<0\n\\]\n\nSuppose that \\(B\\) is an \\(n \\times n\\) matrix with entries 0,1 such that the sum of the elements in each row and each column of \\(B\\) is equal to the corresponding sum for the matrix \\(A\\). Prove that \\(A=B\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2003, "solution": "Let \\(B=\\left(b_{i j}\\right)_{1 \\leq i, j \\leq n}\\). Define \\(S=\\sum_{1 \\leq i, j \\leq n}\\left(x_{i}+y_{j}\\right)\\left(a_{i j}-b_{i j}\\right)\\).\nOn one hand, we have\n\n\\[\nS=\\sum_{i=1}^{n} x_{i}\\left(\\sum_{j=1}^{n} a_{i j}-\\sum_{j=1}^{n} b_{i j}\\right)+\\sum_{j=1}^{n} y_{j}\\left(\\sum_{i=1}^{n} a_{i j}-\\sum_{i=1}^{n} b_{i j}\\right)=0 .\n\\]\n\nOn the other hand, if \\(x_{i}+y_{j} \\geq 0\\), then \\(a_{i j}=1\\), which implies \\(a_{i j}-b_{i j} \\geq 0\\); if \\(x_{i}+y_{j}<0\\), then \\(a_{i j}=0\\), which implies \\(a_{i j}-b_{i j} \\leq 0\\). Therefore \\(\\left(x_{i}+y_{j}\\right)\\left(a_{i j}-b_{i j}\\right) \\geq 0\\) for every \\(i\\) and \\(j\\).\n\nThus we have \\(\\left(x_{i}+y_{j}\\right)\\left(a_{i j}-b_{i j}\\right)=0\\) for every \\(i\\) and \\(j\\). In particular, if \\(a_{i j}=0\\), then \\(x_{i}+y_{j}<0\\) and so \\(a_{i j}-b_{i j}=0\\). This means that \\(a_{i j} \\geq b_{i j}\\) for every \\(i\\) and \\(j\\).\n\nSince the sum of the elements in each row of \\(B\\) is equal to the corresponding sum for \\(A\\), we have \\(a_{i j}=b_{i j}\\) for every \\(i\\) and \\(j\\).\n\nSolution 2. Let \\(B=\\left(b_{i j}\\right)_{1 \\leq i, j \\leq n}\\). Suppose that \\(A \\neq B\\), that is, there exists \\(\\left(i_{0}, j_{0}\\right)\\) such that \\(a_{i_{0} j_{0}} \\neq b_{i_{0} j_{0}}\\). We may assume without loss of generality that \\(a_{i_{0} j_{0}}=0\\) and \\(b_{i_{0} j_{0}}=1\\).\n\nSince the sum of the elements in the \\(i_{0}\\)-th row of \\(B\\) is equal to that in \\(A\\), there exists \\(j_{1}\\) such that \\(a_{i_{0} j_{1}}=1\\) and \\(b_{i_{0} j_{1}}=0\\). Similarly there exists \\(i_{1}\\) such that \\(a_{i_{1} j_{1}}=0\\) and \\(b_{i_{1} j_{1}}=1\\). Let us define \\(i_{k}\\) and \\(j_{k}\\) inductively in this way so that \\(a_{i_{k} j_{k}}=0, b_{i_{k} j_{k}}=1, a_{i_{k} j_{k+1}}=1\\), \\(b_{i_{k} j_{k+1}}=0\\).\n\nBecause the size of the matrix is finite, there exist \\(s\\) and \\(t\\) such that \\(s \\neq t\\) and \\(\\left(i_{s}, j_{s}\\right)=\\) \\(\\left(i_{t}, j_{t}\\right)\\).\n\nSince \\(a_{i_{k} j_{k}}=0\\) implies \\(x_{i_{k}}+y_{j_{k}}<0\\) by definition, we have \\(\\sum_{k=s}^{t-1}\\left(x_{i_{k}}+y_{j_{k}}\\right)<0\\). Similarly, since \\(a_{i_{k} j_{k+1}}=1\\) implies \\(x_{i_{k}}+y_{j_{k+1}} \\geq 0\\), we have \\(\\sum_{k=s}^{t-1}\\left(x_{i_{k}}+y_{j_{k+1}}\\right) \\geq 0\\). However, since \\(j_{s}=j_{t}\\), we have\n\n\\[\n\\sum_{k=s}^{t-1}\\left(x_{i_{k}}+y_{j_{k+1}}\\right)=\\sum_{k=s}^{t-1} x_{i_{k}}+\\sum_{k=s+1}^{t} y_{j_{k}}=\\sum_{k=s}^{t-1} x_{i_{k}}+\\sum_{k=s}^{t-1} y_{j_{k}}=\\sum_{k=s}^{t-1}\\left(x_{i_{k}}+y_{j_{k}}\\right) .\n\\]\n\nThis is a contradiction."}
{"id": "imo-shortlist-2003-c5", "question": "C5. Every point with integer coordinates in the plane is the centre of a disc with radius 1/1000.\n(1) Prove that there exists an equilateral triangle whose vertices lie in different discs.\n(2) Prove that every equilateral triangle with vertices in different discs has side-length greater than 96 .", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2003, "solution": "(1) Define \\(f: \\mathbb{Z} \\longrightarrow[0,1)\\) by \\(f(x)=x \\sqrt{3}-\\lfloor x \\sqrt{3}\\rfloor\\). By the pigeonhole principle, there exist distinct integers \\(x_{1}\\) and \\(x_{2}\\) such that \\(\\left|f\\left(x_{1}\\right)-f\\left(x_{2}\\right)\\right|<0.001\\). Put \\(a=\\left|x_{1}-x_{2}\\right|\\). Then the distance either between \\((a, a \\sqrt{3})\\) and \\((a,\\lfloor a \\sqrt{3}\\rfloor)\\) or between \\((a, a \\sqrt{3})\\) and \\((a,\\lfloor a \\sqrt{3}\\rfloor+1)\\) is less than 0.001. Therefore the points \\((0,0),(2 a, 0),(a, a \\sqrt{3})\\) lie in different discs and form an equilateral triangle.\n(2) Suppose that \\(P^{\\prime} Q^{\\prime} R^{\\prime}\\) is a triangle such that \\(P^{\\prime} Q^{\\prime}=Q^{\\prime} R^{\\prime}=R^{\\prime} P^{\\prime}=l \\leq 96\\) and \\(P^{\\prime}, Q^{\\prime}\\), \\(R^{\\prime}\\) lie in discs with centres \\(P, Q, R\\), respectively. Then\n\n\\[\nl-0.002 \\leq P Q, Q R, R P \\leq l+0.002\n\\]\n\nSince \\(P Q R\\) is not an equilateral triangle, we may assume that \\(P Q \\neq Q R\\). Therefore\n\n\\[\n\\begin{aligned}\n\\left|P Q^{2}-Q R^{2}\\right| & =(P Q+Q R)|P Q-Q R| \n& \\leq((l+0.002)+(l+0.002))((l+0.002)-(l-0.002)) \n& \\leq 2 \\cdot 96.002 \\cdot 0.004 \n& <1\n\n\\]\n\nHowever, \\(P Q^{2}-Q R^{2} \\in \\mathbb{Z}\\). This is a contradiction.\n\nSolution 2. We give another solution to (2).\n\nLemma. Suppose that \\(A B C\\) and \\(A^{\\prime} B^{\\prime} C^{\\prime}\\) are equilateral triangles and that \\(A, B, C\\) and \\(A^{\\prime}, B^{\\prime}, C^{\\prime}\\) lie anticlockwise. If \\(A A^{\\prime}, B B^{\\prime} \\leq r\\), then \\(C C^{\\prime} \\leq 2 r\\).\n\nProof. Let \\(\\alpha, \\beta, \\gamma ; \\alpha^{\\prime}, \\beta^{\\prime}, \\gamma^{\\prime}\\) be the complex numbers corresponding to \\(A, B, C ; A^{\\prime}, B^{\\prime}\\), \\(C^{\\prime}\\). Then\n\n\\[\n\\gamma=\\omega \\beta+(1-\\omega) \\alpha \\quad \\text { and } \\quad \\gamma^{\\prime}=\\omega \\beta^{\\prime}+(1-\\omega) \\alpha^{\\prime},\n\\]\n\nwhere \\(\\omega=(1+\\sqrt{3} i) / 2\\). Therefore\n\n\\[\n\\begin{aligned}\nC C^{\\prime} & =\\left|\\gamma-\\gamma^{\\prime}\\right|=\\left|\\omega\\left(\\beta-\\beta^{\\prime}\\right)+(1-\\omega)\\left(\\alpha-\\alpha^{\\prime}\\right)\\right| \n& \\leq|\\omega|\\left|\\beta-\\beta^{\\prime}\\right|+|1-\\omega|\\left|\\alpha-\\alpha^{\\prime}\\right|=B B^{\\prime}+A A^{\\prime} \n& \\leq 2 r .\n\n\\]\n\nSuppose that \\(P, Q, R\\) lie on discs with radius \\(r\\) and centres \\(P^{\\prime}, Q^{\\prime}, R^{\\prime}\\), respectively, and that \\(P Q R\\) is an equilateral triangle. Let \\(R^{\\prime \\prime}\\) be the point such that \\(P^{\\prime} Q^{\\prime} R^{\\prime \\prime}\\) is an equilateral triangle and \\(P^{\\prime}, Q^{\\prime}, R^{\\prime}\\) lie anticlockwise. It follows from the lemma that \\(R R^{\\prime \\prime} \\leq 2 r\\), and so \\(R^{\\prime} R^{\\prime \\prime} \\leq R R^{\\prime}+R R^{\\prime \\prime} \\leq r+2 r=3 r\\) by the triangle inequality.\n\nPut \\(\\overrightarrow{P^{\\prime} Q^{\\prime}}=\\binom{m}{n}\\) and \\(\\overrightarrow{P^{\\prime} R^{\\prime}}=\\binom{s}{t}\\), where \\(m, n, s, t\\) are integers. We may suppose that \\(m, n \\geq 0\\). Then we have\n\n\\[\n\\sqrt{\\left(\\frac{m-n \\sqrt{3}}{2}-s\\right)^{2}+\\left(\\frac{n+m \\sqrt{3}}{2}-t\\right)^{2}} \\leq 3 r .\n\\]\n\nSetting \\(a=2 t-n\\) and \\(b=m-2 s\\), we obtain\n\n\\[\n\\sqrt{(a-m \\sqrt{3})^{2}+(b-n \\sqrt{3})^{2}} \\leq 6 r\n\\]\n\nSince \\(|a-m \\sqrt{3}| \\geq 1 /|a+m \\sqrt{3}|,|b-n \\sqrt{3}| \\geq 1 /|b+n \\sqrt{3}|\\) and \\(|a| \\leq m \\sqrt{3}+6 r\\), \\(|b| \\leq n \\sqrt{3}+6 r\\), we have\n\n\\[\n\\sqrt{\\frac{1}{(2 m \\sqrt{3}+6 r)^{2}}+\\frac{1}{(2 n \\sqrt{3}+6 r)^{2}}} \\leq 6 r\n\\]\n\nSince \\(1 / x^{2}+1 / y^{2} \\geq 8 /(x+y)^{2}\\) for all positive real numbers \\(x\\) and \\(y\\), it follows that\n\n\\[\n\\frac{2 \\sqrt{2}}{2 \\sqrt{3}(m+n)+12 r} \\leq 6 r\n\\]\n\nAs \\(P^{\\prime} Q^{\\prime}=\\sqrt{m^{2}+n^{2}} \\geq(m+n) / \\sqrt{2}\\), we have\n\n\\[\n\\frac{2 \\sqrt{2}}{2 \\sqrt{6} P^{\\prime} Q^{\\prime}+12 r} \\leq 6 r\n\\]\n\nTherefore\n\n\\[\nP^{\\prime} Q^{\\prime} \\geq \\frac{1}{6 \\sqrt{3} r}-\\sqrt{6} r\n\\]\n\nFinally we obtain\n\n\\[\nP Q \\geq P^{\\prime} Q^{\\prime}-2 r \\geq \\frac{1}{6 \\sqrt{3} r}-\\sqrt{6} r-2 r\n\\]\n\nFor \\(r=1 / 1000\\), we have \\(P Q \\geq 96.22 \\cdots>96\\)."}
{"id": "imo-shortlist-2003-c6", "question": "C6. Let \\(f(k)\\) be the number of integers \\(n\\) that satisfy the following conditions:\n(i) \\(0 \\leq n<10^{k}\\), so \\(n\\) has exactly \\(k\\) digits (in decimal notation), with leading zeroes allowed;\n(ii) the digits of \\(n\\) can be permuted in such a way that they yield an integer divisible by 11.\n\nProve that \\(f(2 m)=10 f(2 m-1)\\) for every positive integer \\(m\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2003, "solution": "We use the notation \\(\\left[a_{k-1} a_{k-2} \\cdots a_{0}\\right]\\) to indicate the positive integer with digits \\(a_{k-1}, a_{k-2}, \\ldots, a_{0}\\).\n\nThe following fact is well-known:\n\n\\[\n\\left[a_{k-1} a_{k-2} \\cdots a_{0}\\right] \\equiv i \\quad(\\bmod 11) \\Longleftrightarrow \\sum_{l=0}^{k-1}(-1)^{l} a_{l} \\equiv i \\quad(\\bmod 11)\n\\]\n\nFix \\(m \\in \\mathbb{N}\\) and define the sets \\(A_{i}\\) and \\(B_{i}\\) as follows:\n\n\\begin{itemize}\n  \\item \\(A_{i}\\) is the set of all integers \\(n\\) with the following properties:\n(1) \\(0 \\leq n<10^{2 m}\\), i.e., \\(n\\) has \\(2 m\\) digits;\n(2) the right \\(2 m-1\\) digits of \\(n\\) can be permuted so that the resulting integer is congruent to \\(i\\) modulo 11 .\n  \\item \\(B_{i}\\) is the set of all integers \\(n\\) with the following properties:\n(1) \\(0 \\leq n<10^{2 m-1}\\), i.e., \\(n\\) has \\(2 m-1\\) digits;\n(2) the digits of \\(n\\) can be permuted so that the resulting integer is congruent to \\(i\\) modulo 11 .\n\n\nIt is clear that \\(f(2 m)=\\left|A_{0}\\right|\\) and \\(f(2 m-1)=\\left|B_{0}\\right|\\). Since \\(\\underbrace{99 \\cdots 9}_{2 m} \\equiv 0(\\bmod 11)\\), we have\n\n\\[\nn \\in A_{i} \\Longleftrightarrow \\underbrace{99 \\cdots 9}_{2 m}-n \\in A_{-i} .\n\\]\n\nHence\n\n\\[\n\\left|A_{i}\\right|=\\left|A_{-i}\\right| .\n\\]\n\nSince \\(\\underbrace{99 \\cdots 9}_{2 m-1} \\equiv 9(\\bmod 11)\\), we have\n\n\\[\nn \\in B_{i} \\Longleftrightarrow \\underbrace{99 \\cdots 9}_{2 m-1}-n \\in B_{9-i}\n\\]\n\nThus\n\n\\[\n\\left|B_{i}\\right|=\\left|B_{9-i}\\right|\n\\]\n\nFor any \\(2 m\\)-digit integer \\(n=\\left[j a_{2 m-2} \\cdots a_{0}\\right]\\), we have\n\n\\[\nn \\in A_{i} \\Longleftrightarrow\\left[a_{2 m-2} \\cdots a_{0}\\right] \\in B_{i-j}\n\\]\n\nHence\n\n\\[\n\\left|A_{i}\\right|=\\left|B_{i}\\right|+\\left|B_{i-1}\\right|+\\cdots+\\left|B_{i-9}\\right|\n\\]\n\nSince \\(B_{i}=B_{i+11}\\), this can be written as\n\n\\[\n\\left|A_{i}\\right|=\\sum_{k=0}^{10}\\left|B_{k}\\right|-\\left|B_{i+1}\\right|\n\\]\n\nhence\n\n\\[\n\\left|A_{i}\\right|=\\left|A_{j}\\right| \\Longleftrightarrow\\left|B_{i+1}\\right|=\\left|B_{j+1}\\right|\n\\]\n\nFrom (1), (2), and (4), we obtain \\(\\left|A_{i}\\right|=\\left|A_{0}\\right|\\) and \\(\\left|B_{i}\\right|=\\left|B_{0}\\right|\\). Substituting this into (3) yields \\(\\left|A_{0}\\right|=10\\left|B_{0}\\right|\\), and so \\(f(2 m)=10 f(2 m-1)\\).\n\nComment. This solution works for all even bases \\(b\\), and the result is \\(f(2 m)=b f(2 m-1)\\).\nSolution 2. We will use the notation in Solution 1. For a \\(2 m\\)-tuple ( \\(a_{0}, \\ldots, a_{2 m-1}\\) ) of integers, we consider the following property:\n\n\\[\n\\left(a_{0}, \\ldots, a_{2 m-1}\\right) \\text { can be permuted so that } \\sum_{l=0}^{2 m-1}(-1)^{l} a_{l} \\equiv 0 \\quad(\\bmod 11)\n\\]\n\nIt is easy to verify that\n\n\\[\n\\left(a_{0}, \\ldots, a_{2 m-1}\\right) \\text { satisfies }(*) \\Longleftrightarrow\\left(a_{0}+k, \\ldots, a_{2 m-1}+k\\right) \\text { satisfies }(*)\n\\]\n\nfor all integers \\(k\\), and that\n\n\\[\n\\left(a_{0}, \\ldots, a_{2 m-1}\\right) \\text { satisfies }(*) \\Longleftrightarrow\\left(k a_{0}, \\ldots, k a_{2 m-1}\\right) \\text { satisfies }(*)\n\\]\n\nfor all integers \\(k \\not \\equiv 0(\\bmod 11)\\).\nFor an integer \\(k\\), denote by \\(\\langle k\\rangle\\) the nonnegative integer less than 11 congruent to \\(k\\) modulo 11 .\n\nFor a fixed \\(j \\in\\{0,1, \\ldots, 9\\}\\), let \\(k\\) be the unique integer such that \\(k \\in\\{1,2, \\ldots, 10\\}\\) and \\((j+1) k \\equiv 1(\\bmod 11)\\).\n\nSuppose that \\(\\left[a_{2 m-1} \\cdots a_{1} j\\right] \\in A_{0}\\), that is, \\(\\left(a_{2 m-1}, \\ldots, a_{1}, j\\right)\\) satisfies (\\textit{). From (1) and (2), it follows that \\(\\left(\\left(a_{2 m-1}+1\\right) k-1, \\ldots,\\left(a_{1}+1\\right) k-1,0\\right)\\) also satisfies (}). Putting \\(b_{i}=\\) \\(\\left\\langle\\left(a_{i}+1\\right) k\\right\\rangle-1\\), we have \\(\\left[b_{2 m-1} \\cdots b_{1}\\right] \\in B_{0}\\).\n\nFor any \\(j \\in\\{0,1, \\ldots, 9\\}\\), we can reconstruct \\(\\left[a_{2 m-1} \\ldots a_{1} j\\right]\\) from \\(\\left[b_{2 m-1} \\cdots b_{1}\\right]\\). Hence we have \\(\\left|A_{0}\\right|=10\\left|B_{0}\\right|\\), and so \\(f(2 m)=10 f(2 m-1)\\)."}
{"id": "imo-shortlist-2003-g1", "question": "G1. Let \\(A B C D\\) be a cyclic quadrilateral. Let \\(P, Q, R\\) be the feet of the perpendiculars from \\(D\\) to the lines \\(B C, C A, A B\\), respectively. Show that \\(P Q=Q R\\) if and only if the bisectors of \\(\\angle A B C\\) and \\(\\angle A D C\\) are concurrent with \\(A C\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2003, "solution": ""}
{"id": "imo-shortlist-2003-n1", "question": "N1. Let \\(m\\) be a fixed integer greater than 1 . The sequence \\(x_{0}, x_{1}, x_{2}, \\ldots\\) is defined as follows:\n\n\\[\nx_{i}= \\begin{cases}2^{i}, & \\text { if } 0 \\leq i \\leq m-1 ; \\\\ \\sum_{j=1}^{m} x_{i-j}, & \\text { if } i \\geq m .\n\\]\n\nFind the greatest \\(k\\) for which the sequence contains \\(k\\) consecutive terms divisible by \\(m\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2003, "solution": "Let \\(r_{i}\\) be the remainder of \\(x_{i} \\bmod m\\). Then there are at most \\(m^{m}\\) types of \\(m\\) consecutive blocks in the sequence \\(\\left(r_{i}\\right)\\). So, by the pigeonhole principle, some type reappears. Since the definition formula works forward and backward, the sequence \\(\\left(r_{i}\\right)\\) is purely periodic.\n\nNow the definition formula backward \\(x_{i}=x_{i+m}-\\sum_{j=1}^{m-1} x_{i+j}\\) applied to the block \\(\\left(r_{0}, \\ldots, r_{m-1}\\right)\\) produces the \\(m\\)-consecutive block \\(\\underbrace{0, \\ldots, 0}_{m-1}, 1\\). Together with the pure periodicity, we see that \\(\\max k \\geq m-1\\).\n\nOn the other hand, if there are \\(m\\)-consecutive zeroes in \\(\\left(r_{i}\\right)\\), then the definition formula and the pure periodicity force \\(r_{i}=0\\) for any \\(i \\geq 0\\), a contradiction. Thus max \\(k=m-1\\)."}
{"id": "imo-shortlist-2003-n2", "question": "N2. Each positive integer \\(a\\) undergoes the following procedure in order to obtain the number \\(d=d(a)\\) :\n(i) move the last digit of \\(a\\) to the first position to obtain the number \\(b\\);\n(ii) square \\(b\\) to obtain the number \\(c\\);\n(iii) move the first digit of \\(c\\) to the end to obtain the number \\(d\\).\n(All the numbers in the problem are considered to be represented in base 10.) For example, for \\(a=2003\\), we get \\(b=3200, c=10240000\\), and \\(d=02400001=2400001=d(2003)\\).\n\nFind all numbers \\(a\\) for which \\(d(a)=a^{2}\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2003, "solution": "Let \\(a\\) be a positive integer for which the procedure yields \\(d=d(a)=a^{2}\\). Further assume that \\(a\\) has \\(n+1\\) digits, \\(n \\geq 0\\).\n\nLet \\(s\\) be the last digit of \\(a\\) and \\(f\\) the first digit of \\(c\\). Since \\((* \\cdots * s)^{2}=a^{2}=d=* \\cdots * f\\) and \\((s * \\cdots *)^{2}=b^{2}=c=f * \\cdots *\\), where the stars represent digits that are unimportant at the moment, \\(f\\) is both the last digit of the square of a number that ends in \\(s\\) and the first digit of the square of a number that starts in \\(s\\).\n\nThe square \\(a^{2}=d\\) must have either \\(2 n+1\\) or \\(2 n+2\\) digits. If \\(s=0\\), then \\(n \\neq 0, b\\) has \\(n\\) digits, its square \\(c\\) has at most \\(2 n\\) digits, and so does \\(d\\), a contradiction. Thus the last digit of \\(a\\) is not 0 .\n\nConsider now, for example, the case \\(s=4\\). Then \\(f\\) must be 6 , but this is impossible, since the squares of numbers that start in 4 can only start in 1 or 2 , which is easily seen from\n\n\\[\n160 \\cdots 0=(40 \\cdots 0)^{2} \\leq(4 * \\cdots *)^{2}<(50 \\cdots 0)^{2}=250 \\cdots 0 .\n\\]\n\nThus \\(s\\) cannot be 4 .\nThe following table gives all possibilities:\n\n\\begin{center}\n\\begin{tabular}{c|c|c|c|c|c|c|c|c|c}\n\\(s\\) & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 \n\\hline\n\\(f=\\) last digit of \\((\\cdots s)^{2}\\) & 1 & 4 & 9 & 6 & 5 & 6 & 9 & 4 & 1 \n\\(f=\\) first digit of \\((s \\cdots)^{2}\\) & \\(1,2,3\\) & \\(4,5,6,7,8\\) & 9,1 & 1,2 & 2,3 & 3,4 & \\(4,5,6\\) & \\(6,7,8\\) & 8,9 \nThus \\(s=1, s=2\\), or \\(s=3\\) and in each case \\(f=s^{2}\\). When \\(s\\) is 1 or 2 , the square \\(c=b^{2}\\) of the ( \\(n+1\\) )-digit number \\(b\\) which starts in \\(s\\) has \\(2 n+1\\) digits. Moreover, when \\(s=3\\), the square \\(c=b^{2}\\) either has \\(2 n+1\\) digits and starts in 9 or has \\(2 n+2\\) digits and starts in 1 . However the latter is impossible since \\(f=s^{2}=9\\). Thus \\(c\\) must have \\(2 n+1\\) digits.\n\nLet \\(a=10 x+s\\), where \\(x\\) is an \\(n\\)-digit number (in case \\(x=0\\) we set \\(n=0\\) ). Then\n\n\\[\n\\begin{aligned}\n& b=10^{n} s+x \n& c=10^{2 n} s^{2}+2 \\cdot 10^{n} s x+x^{2} \n& d=10\\left(c-10^{m-1} f\\right)+f=10^{2 n+1} s^{2}+20 \\cdot 10^{n} s x+10 x^{2}-10^{m} f+f\n\n\\]\n\nwhere \\(m\\) is the number of digits of \\(c\\). However, we already know that \\(m\\) must be \\(2 n+1\\) and \\(f=s^{2}\\), so\n\n\\[\nd=20 \\cdot 10^{n} s x+10 x^{2}+s^{2}\n\\]\n\nand the equality \\(a^{2}=d\\) yields\n\n\\[\nx=2 s \\cdot \\frac{10^{n}-1}{9},\n\\]\n\ni.e.,\n\n\\[\na=\\underbrace{6 \\cdots 6}_{n} 3 \\text { or } a=\\underbrace{4 \\cdots 4}_{n} 2 \\text { or } a=\\underbrace{2 \\cdots 2}_{n} 1 \\text {, }\n\\]\n\nfor \\(n \\geq 0\\). The first two possibilities must be rejected for \\(n \\geq 1\\), since \\(a^{2}=d\\) would have \\(2 n+2\\) digits, which means that \\(c\\) would have to have at least \\(2 n+2\\) digits, but we already know that \\(c\\) must have \\(2 n+1\\) digits. Thus the only remaining possibilities are\n\n\\[\na=3 \\quad \\text { or } \\quad a=2 \\quad \\text { or } \\quad a=\\underbrace{2 \\ldots 2}_{n} 1,\n\\]\n\nfor \\(n \\geq 0\\). It is easily seen that they all satisfy the requirements of the problem."}
{"id": "imo-shortlist-2003-n3", "question": "N3. Determine all pairs of positive integers \\((a, b)\\) such that\n\n\\[\n\\frac{a^{2}}{2 a b^{2}-b^{3}+1}\n\\]\n\nis a positive integer.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2003, "solution": "Let \\((a, b)\\) be a pair of positive integers satisfying the condition. Because \\(k=\\) \\(a^{2} /\\left(2 a b^{2}-b^{3}+1\\right)>0\\), we have \\(2 a b^{2}-b^{3}+1>0, a>b / 2-1 / 2 b^{2}\\), and hence \\(a \\geq b / 2\\). Using this, we infer from \\(k \\geq 1\\), or \\(a^{2} \\geq b^{2}(2 a-b)+1\\), that \\(a^{2}>b^{2}(2 a-b) \\geq 0\\). Hence\n\n\\[\na>b \\quad \\text { or } \\quad 2 a=b\n\\]\n\nNow consider the two solutions \\(a_{1}, a_{2}\\) to the equation\n\n\\[\na^{2}-2 k b^{2} a+k\\left(b^{3}-1\\right)=0\n\\]\n\nfor fixed positive integers \\(k\\) and \\(b\\), and assume that one of them is an integer. Then the other is also an integer because \\(a_{1}+a_{2}=2 k b^{2}\\). We may assume that \\(a_{1} \\geq a_{2}\\), and we have \\(a_{1} \\geq k b^{2}>0\\). Furthermore, since \\(a_{1} a_{2}=k\\left(b^{3}-1\\right)\\), we get\n\n\\[\n0 \\leq a_{2}=\\frac{k\\left(b^{3}-1\\right)}{a_{1}} \\leq \\frac{k\\left(b^{3}-1\\right)}{k b^{2}}<b\n\\]\n\nTogether with \\((*)\\), we conclude that \\(a_{2}=0\\) or \\(a_{2}=b / 2\\) (in the latter case \\(b\\) must be even).\nIf \\(a_{2}=0\\), then \\(b^{3}-1=0\\), and hence \\(a_{1}=2 k, b=1\\).\nIf \\(a_{2}=b / 2\\), then \\(k=b^{2} / 4\\) and \\(a_{1}=b^{4} / 2-b / 2\\).\nTherefore the only possibilities are\n\n\\[\n(a, b)=(2 l, 1) \\quad \\text { or } \\quad(l, 2 l) \\quad \\text { or } \\quad\\left(8 l^{4}-l, 2 l\\right)\n\\]\n\nfor some positive integer \\(l\\). All of these pairs satisfy the given condition.\nComment 1. An alternative way to see (*) is as follows: Fix \\(a \\geq 1\\) and consider the function \\(f_{a}(b)=2 a b^{2}-b^{3}+1\\). Then \\(f_{a}\\) is increasing on \\([0,4 a / 3]\\) and decreasing on \\([4 a / 3, \\infty)\\). We have\n\n\\[\n\\begin{aligned}\nf_{a}(a) & =a^{3}+1>a^{2} \nf_{a}(2 a-1) & =4 a^{2}-4 a+2>a^{2} \nf_{a}(2 a+1) & =-4 a^{2}-4 a<0\n\n\\]\n\nHence if \\(b \\geq a\\) and \\(a^{2} / f_{a}(b)\\) is a positive integer, then \\(b=2 a\\).\nIndeed, if \\(a \\leq b \\leq 4 a / 3\\), then \\(f_{a}(b) \\geq f_{a}(a)>a^{2}\\), and so \\(a^{2} / f_{a}(b)\\) is not an integer, a contradiction, and if \\(b>4 a / 3\\), then\n(i) if \\(b \\geq 2 a+1\\), then \\(f_{a}(b) \\leq f_{a}(2 a+1)<0\\), a contradiction;\n(ii) if \\(b \\leq 2 a-1\\), then \\(f_{a}(b) \\geq f_{a}(2 a-1)>a^{2}\\), and so \\(a^{2} / f_{a}(b)\\) is not an integer, a contradiction.\n\nComment 2. There are several alternative solutions to this problem. Here we sketch three of them.\n\n\\begin{enumerate}\n  \\item The discriminant \\(D\\) of the equation ( \\(\\sharp\\) ) is the square of some integer \\(d \\geq 0: D=\\) \\(\\left(2 b^{2} k-b\\right)^{2}+4 k-b^{2}=d^{2}\\). If \\(e=2 b^{2} k-b=d\\), we have \\(4 k=b^{2}\\) and \\(a=2 b^{2} k-b / 2, b / 2\\). Otherwise, the clear estimation \\(\\left|d^{2}-e^{2}\\right| \\geq 2 e-1\\) for \\(d \\neq e\\) implies \\(\\left|4 k-b^{2}\\right| \\geq 4 b^{2} k-2 b-1\\). If \\(4 k-b^{2}>0\\), this implies \\(b=1\\). The other case yields no solutions.\n  \\item Assume that \\(b \\neq 1\\) and let \\(s=\\operatorname{gcd}\\left(2 a, b^{3}-1\\right), 2 a=s u, b^{3}-1=s t^{\\prime}\\), and \\(2 a b^{2}-b^{3}+1=s t\\). Then \\(t+t^{\\prime}=u b^{2}\\) and \\(\\operatorname{gcd}(u, t)=1\\). Together with \\(s t \\mid a^{2}\\), we have \\(t \\mid s\\). Let \\(s=r t\\). Then the problem reduces to the following lemma:\n\n\nLemma. Let \\(b, r, t, t^{\\prime}, u\\) be positive integers satisfying \\(b^{3}-1=r t t^{\\prime}\\) and \\(t+t^{\\prime}=u b^{2}\\). Then \\(r=1\\). Furthermore, either one of \\(t\\) or \\(t^{\\prime}\\) or \\(u\\) is 1 .\n\nThe lemma is proved as follows. We have \\(b^{3}-1=r t\\left(u b^{2}-t\\right)=r t^{\\prime}\\left(u b^{2}-t^{\\prime}\\right)\\). Since \\(r t^{2} \\equiv r t^{\\prime 2} \\equiv 1\\left(\\bmod b^{2}\\right)\\), if \\(r t^{2} \\neq 1\\) and \\(r t^{\\prime 2} \\neq 1\\), then \\(t, t^{\\prime}>b / \\sqrt{r}\\). It is easy to see that\n\n\\[\nr \\frac{b}{\\sqrt{r}}\\left(u b^{2}-\\frac{b}{\\sqrt{r}}\\right) \\geq b^{3}-1\n\\]\n\nunless \\(r=u=1\\).\n3. With the same notation as in the previous solution, since \\(r t^{2} \\mid\\left(b^{3}-1\\right)^{2}\\), it suffices to prove the following lemma:\n\nLemma. Let \\(b \\geq 2\\). If a positive integer \\(x \\equiv 1\\left(\\bmod b^{2}\\right)\\) divides \\(\\left(b^{3}-1\\right)^{2}\\), then \\(x=1\\) or \\(x=\\left(b^{3}-1\\right)^{2}\\) or \\((b, x)=(4,49)\\) or \\((4,81)\\).\n\nTo prove this lemma, let \\(p, q\\) be positive integers with \\(p>q>0\\) satisfying \\(\\left(b^{3}-1\\right)^{2}=\\) \\(\\left(p b^{2}+1\\right)\\left(q b^{2}+1\\right)\\). Then\n\n\\[\nb^{4}=2 b+p+q+p q b^{2}\n\\]\n\nA natural observation leads us to multiply (1) by \\(q b^{2}-1\\). We get\n\n\\[\n\\left(q\\left(p q-b^{2}\\right)+1\\right) b^{4}=p-(q+2 b)\\left(q b^{2}-1\\right)\n\\]\n\nTogether with the simple estimation\n\n\\[\n-3<\\frac{p-(q+2 b)\\left(q b^{2}-1\\right)}{b^{4}}<1\n\\]\n\nthe conclusion of the lemma follows.\n\nComment 3. The problem was originally proposed in the following form:\nLet \\(a, b\\) be relatively prime positive integers. Suppose that \\(a^{2} /\\left(2 a b^{2}-b^{3}+1\\right)\\) is a positive integer greater than 1 . Prove that \\(b=1\\)."}
{"id": "imo-shortlist-2003-n4", "question": "N4. Let \\(b\\) be an integer greater than 5 . For each positive integer \\(n\\), consider the number\n\n\\[\nx_{n}=\\underbrace{11 \\cdots 1}_{n-1} \\underbrace{22 \\cdots 2}_{n} 5,\n\\]\n\nwritten in base \\(b\\).\nProve that the following condition holds if and only if \\(b=10\\) :\nthere exists a positive integer \\(M\\) such that for any integer \\(n\\) greater than \\(M\\), the number \\(x_{n}\\) is a perfect square.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2003, "solution": "For \\(b=6,7,8,9\\), the number 5 is congruent to no square numbers modulo \\(b\\), and hence \\(x_{n}\\) is not a square. For \\(b=10\\), we have \\(x_{n}=\\left(\\left(10^{n}+5\\right) / 3\\right)^{2}\\) for all \\(n\\). By algebraic calculation, it is easy to see that \\(x_{n}=\\left(b^{2 n}+b^{n+1}+3 b-5\\right) /(b-1)\\).\n\nConsider now the case \\(b \\geq 11\\) and put \\(y_{n}=(b-1) x_{n}\\). Assume that the condition in the problem is satisfied. Then it follows that \\(y_{n} y_{n+1}\\) is a perfect square for \\(n>M\\). Since \\(b^{2 n}+b^{n+1}+3 b-5<\\left(b^{n}+b / 2\\right)^{2}\\), we infer\n\n\\[\ny_{n} y_{n+1}<\\left(b^{n}+\\frac{b}{2}\\right)^{2}\\left(b^{n+1}+\\frac{b}{2}\\right)^{2}=\\left(b^{2 n+1}+\\frac{b^{n+1}(b+1)}{2}+\\frac{b^{2}}{4}\\right)^{2}\n\\]\n\nOn the other hand, we can prove by computation that\n\n\\[\ny_{n} y_{n+1}>\\left(b^{2 n+1}+\\frac{b^{n+1}(b+1)}{2}-b^{3}\\right)^{2}\n\\]\n\nFrom (1) and (2), we conclude that for all integers \\(n>M\\), there is an integer \\(a_{n}\\) such that\n\n\\[\ny_{n} y_{n+1}=\\left(b^{2 n+1}+\\frac{b^{n+1}(b+1)}{2}+a_{n}\\right)^{2} \\quad \\text { and } \\quad-b^{3}<a_{n}<\\frac{b^{2}}{4}\n\\]\n\nIt follows that \\(b^{n} \\mid\\left(a_{n}^{2}-(3 b-5)^{2}\\right)\\), and thus \\(a_{n}= \\pm(3 b-5)\\) for all sufficiently large \\(n\\). Substituting in (3), we obtain \\(a_{n}=3 b-5\\) and\n\n\\[\n8(3 b-5) b+b^{2}(b+1)^{2}=4 b^{3}+4(3 b-5)\\left(b^{2}+1\\right)\n\\]\n\nThe left hand side of the equation (4) is divisible by \\(b\\). The other side is a polynomial in \\(b\\) with integral coefficients and its constant term is -20 . Hence \\(b\\) must divide 20. Since \\(b \\geq 11\\), we conclude that \\(b=20\\), but then \\(x_{n} \\equiv 5(\\bmod 8)\\) and hence \\(x_{n}\\) is not a square.\n\nComment. Here is a shorter solution using a limit argument:\nAssume that \\(x_{n}\\) is a square for all \\(n>M\\), where \\(M\\) is a positive integer.\nFor \\(n>M\\), take \\(y_{n}=\\sqrt{x_{n}} \\in \\mathbb{N}\\). Clearly,\n\n\\[\n\\lim _{n \\rightarrow \\infty} \\frac{\\frac{b^{2 n}}{b-1}}{x_{n}}=1\n\\]\n\nHence\n\n\\[\n\\lim _{n \\rightarrow \\infty} \\frac{\\frac{b^{n}}{\\sqrt{b-1}}}{y_{n}}=1\n\\]\n\nOn the other hand,\n\n\\[\n\\left(b y_{n}+y_{n+1}\\right)\\left(b y_{n}-y_{n+1}\\right)=b^{2} x_{n}-x_{n+1}=b^{n+2}+3 b^{2}-2 b-5 .\n\\]\n\nThese equations imply\n\n\\[\n\\lim _{n \\rightarrow \\infty}\\left(b y_{n}-y_{n+1}\\right)=\\frac{b \\sqrt{b-1}}{2}\n\\]\n\nAs \\(b y_{n}-y_{n+1}\\) is an integer, there exists \\(N>M\\) such that \\(b y_{n}-y_{n+1}=b \\sqrt{b-1} / 2\\) for any \\(n>N\\). This means that \\(b-1\\) is a perfect square.\n\nIf \\(b\\) is odd, then \\(\\sqrt{b-1} / 2\\) is an integer and so \\(b\\) divides \\(b \\sqrt{b-1} / 2\\). Hence using (*), we obtain \\(b \\mid 5\\). This is a contradiction.\n\nIf \\(b\\) is even, then \\(b / 2\\) divides 5 . Hence \\(b=10\\).\nIn the case \\(b=10\\), we have \\(x_{n}=\\left(\\left(10^{n}+5\\right) / 3\\right)^{2}\\) for \\(n \\geq 1\\)."}
{"id": "imo-shortlist-2003-n5", "question": "N5. An integer \\(n\\) is said to be good if \\(|n|\\) is not the square of an integer. Determine all integers \\(m\\) with the following property:\n\\(m\\) can be represented, in infinitely many ways, as a sum of three distinct good integers whose product is the square of an odd integer.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2003, "solution": "Assume that \\(m\\) is expressed as \\(m=u+v+w\\) and \\(u v w\\) is an odd perfect square. Then \\(u, v, w\\) are odd and because \\(u v w \\equiv 1(\\bmod 4)\\), exactly two or none of them are congruent to 3 modulo 4 . In both cases, we have \\(m=u+v+w \\equiv 3(\\bmod 4)\\).\n\nConversely, we prove that \\(4 k+3\\) has the required property. To prove this, we look for representations of the form\n\n\\[\n4 k+3=x y+y z+z x .\n\\]\n\nIn any such representations, the product of the three summands is a perfect square. Setting \\(x=1+2 l\\) and \\(y=1-2 l\\), we have \\(z=2 l^{2}+2 k+1\\) from above. Then\n\n\\[\n\\begin{aligned}\n& x y=1-4 l^{2}=f(l) \n& y z=-4 l^{3}+2 l^{2}-(4 k+2) l+2 k+1=g(l) \n& z x=4 l^{3}+2 l^{2}+(4 k+2) l+2 k+1=h(l)\n\n\\]\n\nThe numbers \\(f(l), g(l), h(l)\\) are odd for each integer \\(l\\) and their product is a perfect square, as noted above. They are distinct, except for finitely many \\(l\\). It remains to note that \\(|g(l)|\\) and \\(|h(l)|\\) are not perfect squares for infinitely many \\(l\\) (note that \\(|f(l)|\\) is not a perfect square, unless \\(l=0\\) ).\n\nChoose distinct prime numbers \\(p, q\\) such that \\(p, q>4 k+3\\) and pick \\(l\\) such that\n\n\\[\n\\begin{array}{lll}\n1+2 l \\equiv 0 \\quad(\\bmod p), & 1+2 l \\not \\equiv 0 \\quad\\left(\\bmod p^{2}\\right), \n1-2 l \\equiv 0 \\quad(\\bmod q), & 1-2 l \\not \\equiv 0 \\quad\\left(\\bmod q^{2}\\right) .\n\n\\]\n\nWe can choose such \\(l\\) by the Chinese remainder theorem. Then \\(2 l^{2}+2 k+1\\) is not divisible by \\(p\\), because \\(p>4 k+3\\). Hence \\(|h(l)|\\) is not a perfect square. Similarly, \\(|g(l)|\\) is not a perfect square."}
{"id": "imo-shortlist-2003-n6", "question": "N6. Let \\(p\\) be a prime number. Prove that there exists a prime number \\(q\\) such that for every integer \\(n\\), the number \\(n^{p}-p\\) is not divisible by \\(q\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2003, "solution": "Since \\(\\left(p^{p}-1\\right) /(p-1)=1+p+p^{2}+\\cdots+p^{p-1} \\equiv p+1\\left(\\bmod p^{2}\\right)\\), we can get at least one prime divisor of \\(\\left(p^{p}-1\\right) /(p-1)\\) which is not congruent to 1 modulo \\(p^{2}\\). Denote such a prime divisor by \\(q\\). This \\(q\\) is what we wanted. The proof is as follows. Assume that there exists an integer \\(n\\) such that \\(n^{p} \\equiv p(\\bmod q)\\). Then we have \\(n^{p^{2}} \\equiv p^{p} \\equiv 1(\\bmod q)\\) by the definition of \\(q\\). On the other hand, from Fermat's little theorem, \\(n^{q-1} \\equiv 1(\\bmod q)\\), because \\(q\\) is a prime. Since \\(p^{2} \\nmid q-1\\), we have \\(\\left(p^{2}, q-1\\right) \\mid p\\), which leads to \\(n^{p} \\equiv 1(\\bmod q)\\). Hence we have \\(p \\equiv 1(\\bmod q)\\). However, this implies \\(1+p+\\cdots+p^{p-1} \\equiv p(\\bmod q)\\). From the definition of \\(q\\), this leads to \\(p \\equiv 0(\\bmod q)\\), a contradiction.\n\nComment 1. First, students will come up, perhaps, with the idea that \\(q\\) has to be of the form \\(p k+1\\). Then,\n\n\\[\n\\exists n \\quad n^{p} \\equiv p \\quad(\\bmod q) \\Longleftrightarrow p^{k} \\equiv 1 \\quad(\\bmod q),\n\\]\n\ni.e.,\n\n\\[\n\\forall n \\quad n^{p} \\not \\equiv p \\quad(\\bmod q) \\Longleftrightarrow p^{k} \\not \\equiv 1 \\quad(\\bmod q) .\n\\]\n\nSo, we have to find such \\(q\\). These observations will take you quite naturally to the idea of taking a prime divisor of \\(p^{p}-1\\). Therefore the idea of the solution is not so tricky or technical.\n\nComment 2. The prime \\(q\\) satisfies the required condition if and only if \\(q\\) remains a prime in \\(k=\\mathbb{Q}(\\sqrt[p]{p})\\). By applying Chebotarev's density theorem to the Galois closure of \\(k\\), we see that the set of such \\(q\\) has the density \\(1 / p\\). In particular, there are infinitely many \\(q\\) satisfying the required condition. This gives an alternative solution to the problem."}
{"id": "imo-shortlist-2003-n7", "question": "N7. The sequence \\(a_{0}, a_{1}, a_{2}, \\ldots\\) is defined as follows:\n\n\\[\na_{0}=2, \\quad a_{k+1}=2 a_{k}^{2}-1 \\quad \\text { for } k \\geq 0\n\\]\n\nProve that if an odd prime \\(p\\) divides \\(a_{n}\\), then \\(2^{n+3}\\) divides \\(p^{2}-1\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2003, "solution": "By induction, we show that\n\n\\[\na_{n}=\\frac{(2+\\sqrt{3})^{2^{n}}+(2-\\sqrt{3})^{2^{n}}}{2}\n\\]\n\nCase 1: \\(x^{2} \\equiv 3(\\bmod p)\\) has an integer solution\nLet \\(m\\) be an integer such that \\(m^{2} \\equiv 3(\\bmod p)\\). Then \\((2+m)^{2^{n}}+(2-m)^{2^{n}} \\equiv 0(\\bmod p)\\). Therefore \\((2+m)(2-m) \\equiv 1(\\bmod p)\\) shows that \\((2+m)^{2^{n+1}} \\equiv-1(\\bmod p)\\) and that \\(2+m\\) has the order \\(2^{n+2}\\) modulo \\(p\\). This implies \\(2^{n+2} \\mid(p-1)\\) and so \\(2^{n+3} \\mid\\left(p^{2}-1\\right)\\).\nCase 2: otherwise\nSimilarly, we see that there exist integers \\(a, b\\) satisfying \\((2+\\sqrt{3})^{2^{n+1}}=-1+p a+p b \\sqrt{3}\\). Furthermore, since \\(\\left((1+\\sqrt{3}) a_{n-1}\\right)^{2}=\\left(a_{n}+1\\right)(2+\\sqrt{3})\\), there exist integers \\(a^{\\prime}, b^{\\prime}\\) satisfying \\(\\left((1+\\sqrt{3}) a_{n-1}\\right)^{2^{n+2}}=-1+p a^{\\prime}+p b^{\\prime} \\sqrt{3}\\).\n\nLet us consider the set \\(S=\\{i+j \\sqrt{3} \\mid 0 \\leq i, j \\leq p-1,(i, j) \\neq(0,0)\\}\\). Let \\(I=\\{a+b \\sqrt{3} \\mid\\) \\(a \\equiv b \\equiv 0(\\bmod p)\\}\\). We claim that for each \\(i+j \\sqrt{3} \\in S\\), there exists an \\(i^{\\prime}+j^{\\prime} \\sqrt{3} \\in S\\) satisfying \\((i+j \\sqrt{3})\\left(i^{\\prime}+j^{\\prime} \\sqrt{3}\\right)-1 \\in I\\). In fact, since \\(i^{2}-3 j^{2} \\not \\equiv 0(\\bmod p)(\\) otherwise 3 is a square \\(\\bmod p\\) ), we can take an integer \\(k\\) satisfying \\(k\\left(i^{2}-3 j^{2}\\right)-1 \\in I\\). Then \\(i^{\\prime}+j^{\\prime} \\sqrt{3}\\) with \\(i^{\\prime}+j^{\\prime} \\sqrt{3}-k(i-j \\sqrt{3}) \\in I\\) will do. Now the claim together with the previous observation implies that the minimal \\(r\\) with \\(\\left((1+\\sqrt{3}) a_{n-1}\\right)^{r}-1 \\in I\\) is equal to \\(2^{n+3}\\). The claim also implies that a map \\(f: S \\longrightarrow S\\) satisfying \\((i+j \\sqrt{3})(1+\\sqrt{3}) a_{n-1}-f(i+j \\sqrt{3}) \\in I\\) for any \\(i+j \\sqrt{3} \\in S\\) exists and is bijective. Thus \\(\\prod_{x \\in S} x=\\prod_{x \\in S} f(x)\\), so\n\n\\[\n\\left(\\prod_{x \\in S} x\\right)\\left(\\left((1+\\sqrt{3}) a_{n-1}\\right)^{p^{2}-1}-1\\right) \\in I\n\\]\n\nAgain, by the claim, we have \\(\\left((1+\\sqrt{3}) a_{n-1}\\right)^{p^{2}-1}-1 \\in I\\). Hence \\(2^{n+3} \\mid\\left(p^{2}-1\\right)\\).\nComment 1. Not only Case 2 but also Case 1 can be treated by using \\((1+\\sqrt{3}) a_{n-1}\\). In fact, we need not divide into cases: in any case, the element \\((1+\\sqrt{3}) a_{n-1}=(1+\\sqrt{3}) / \\sqrt{2}\\) of the multiplicative group \\(\\mathbb{F}_{p^{2}}^{\\times}\\)of the finite field \\(\\mathbb{F}_{p^{2}}\\) having \\(p^{2}\\) elements has the order \\(2^{n+3}\\), which suffices (in Case 1, the number \\((1+\\sqrt{3}) a_{n-1}\\) even belongs to the subgroup \\(\\mathbb{F}_{p}^{\\times}\\)of \\(\\mathbb{F}_{p^{2}}^{\\times}\\), so \\(\\left.2^{n+3} \\mid(p-1)\\right)\\).\n\nComment 2. The numbers \\(a_{k}\\) are the numerators of the approximation to \\(\\sqrt{3}\\) obtained by using the Newton method with \\(f(x)=x^{2}-3, x_{0}=2\\). More precisely,\n\n\\[\nx_{k+1}=\\frac{x_{k}+\\frac{3}{x_{k}}}{2}, \\quad x_{k}=\\frac{a_{k}}{d_{k}}\n\\]\n\nwhere\n\n\\[\nd_{k}=\\frac{(2+\\sqrt{3})^{2^{k}}-(2-\\sqrt{3})^{2^{k}}}{2 \\sqrt{3}} .\n\\]\n\nComment 3. Define \\(f_{n}(x)\\) inductively by\n\n\\[\nf_{0}(x)=x, \\quad f_{k+1}(x)=f_{k}(x)^{2}-2 \\quad \\text { for } k \\geq 0 .\n\\]\n\nThen the condition \\(p \\mid a_{n}\\) can be read that the \\(\\bmod p\\) reduction of the minimal polynomial \\(f_{n}\\) of the algebraic integer \\(\\alpha=\\zeta_{2^{n+2}}+\\zeta_{2^{n+2}}^{-1}\\) over \\(\\mathbb{Q}\\) has the root \\(2 a_{0}\\) in \\(\\mathbb{F}_{p}\\), where \\(\\zeta_{2^{n+2}}\\) is a primitive \\(2^{n+2}\\)-th root of 1 . Thus the conclusion \\(\\left(p^{2}-1\\right) \\mid 2^{n+3}\\) of the problem is a part of the decomposition theorem in the class field theory applied to the abelian extension \\(\\mathbb{Q}(\\alpha)\\), which asserts that a prime \\(p\\) is completely decomposed in \\(\\mathbb{Q}(\\alpha)\\) (equivalently, \\(f_{n}\\) has a root \\(\\bmod p\\) ) if and only if the class of \\(p\\) in ( \\(\\left.\\mathbb{Z} / 2^{n+2} \\mathbb{Z}\\right)^{\\times}\\)belongs to its subgroup \\(\\{1,-1\\}\\). Thus the problem illustrates a result in the class field theory."}
{"id": "imo-shortlist-2003-n8", "question": "N8. Let \\(p\\) be a prime number and let \\(A\\) be a set of positive integers that satisfies the following conditions:\n(i) the set of prime divisors of the elements in \\(A\\) consists of \\(p-1\\) elements;\n(ii) for any nonempty subset of \\(A\\), the product of its elements is not a perfect \\(p\\)-th power.\n\nWhat is the largest possible number of elements in \\(A\\) ?", "category": "Number Theory", "source": "IMO Shortlist", "year": 2003, "solution": "The answer is \\((p-1)^{2}\\). For simplicity, let \\(r=p-1\\). Suppose that the prime numbers \\(p_{1}, \\ldots, p_{r}\\) are distinct. Define\n\n\\[\nB_{i}=\\left\\{p_{i}, p_{i}^{p+1}, p_{i}^{2 p+1}, \\ldots, p_{i}^{(r-1) p+1}\\right\\}\n\\]\n\nand let \\(B=\\bigcup_{i=1}^{r} B_{i}\\). Then \\(B\\) has \\(r^{2}\\) elements and clearly satisfies (i) and (ii).\nNow suppose that \\(|A| \\geq r^{2}+1\\) and that \\(A\\) satisfies (i) and (ii). We will show that a (nonempty) product of elements in \\(A\\) is a perfect \\(p\\)-th power. This will complete the proof.\n\nLet \\(p_{1}, \\ldots, p_{r}\\) be distinct prime numbers for which each \\(t \\in A\\) can be written as \\(t=\\) \\(p_{1}^{a_{1}} \\cdots p_{r}^{a_{r}}\\). Take \\(t_{1}, \\ldots, t_{r^{2}+1} \\in A\\), and for each \\(i\\), let \\(v_{i}=\\left(a_{i 1}, a_{i 2}, \\ldots, a_{i r}\\right)\\) denote the vector of exponents of prime divisors of \\(t_{i}\\). We would like to show that a (nonempty) sum of \\(v_{i}\\) is the zero vector modulo \\(p\\).\n\nWe shall show that the following system of congruence equations has a nonzero solution:\n\n\\[\n\\begin{aligned}\n& F_{1}=\\sum_{i=1}^{r^{2}+1} a_{i 1} x_{i}^{r} \\equiv 0 \\quad(\\bmod p) \n& F_{2}=\\sum_{i=1}^{r^{2}+1} a_{i 2} x_{i}^{r} \\equiv 0 \\quad(\\bmod p) \n& \\quad \\vdots \n& F_{r}=\\sum_{i=1}^{r^{2}+1} a_{i r} x_{i}^{r} \\equiv 0 \\quad(\\bmod p)\n\n\\]\n\nIf \\(\\left(x_{1}, \\ldots, x_{r^{2}+1}\\right)\\) is a nonzero solution to the above system, then, since \\(x_{i}^{r} \\equiv 0\\) or \\(1(\\bmod p)\\), a sum of vectors \\(v_{i}\\) is the zero vector modulo \\(p\\).\n\nIn order to find a nonzero solution to the above system, it is enough to show that the following congruence equation has a nonzero solution:\n\n\\[\nF=F_{1}^{r}+F_{2}^{r}+\\cdots+F_{r}^{r} \\equiv 0 \\quad(\\bmod p)\n\\]\n\nIn fact, because each \\(F_{i}^{r}\\) is 0 or 1 modulo \\(p\\), the nonzero solution to this equation (*) has to satisfy \\(F_{i}^{r} \\equiv 0\\) for \\(1 \\leq i \\leq r\\).\n\nWe will show that the number of the solutions to the equation \\((*)\\) is divisible by \\(p\\). Then since \\((0,0, \\ldots, 0)\\) is a trivial solution, there exists a nonzero solution to \\((*)\\) and we are done.\n\nWe claim that\n\n\\[\n\\sum F^{r}\\left(x_{1}, \\ldots, x_{r^{2}+1}\\right) \\equiv 0 \\quad(\\bmod p),\n\\]\n\nwhere the sum is over the set of all vectors \\(\\left(x_{1}, \\ldots, x_{r^{2}+1}\\right)\\) in the vector space \\(\\mathbb{F}_{p}^{r^{2}+1}\\) over the finite field \\(\\mathbb{F}_{p}\\). By Fermat's little theorem, this claim evidently implies that the number of solutions to the equation (*) is divisible by \\(p\\).\n\nWe prove the claim. In each monomial in \\(F^{r}\\), there are at most \\(r^{2}\\) variables, and therefore at least one of the variables is absent. Suppose that the monomial is of the form \\(b x_{i_{1}}^{\\alpha_{1}} x_{i_{2}}^{\\alpha_{2}} \\cdots x_{i_{k}}^{\\alpha_{k}}\\), where \\(1 \\leq k \\leq r^{2}\\). Then \\(\\sum b x_{i_{1}}^{\\alpha_{1}} x_{i_{2}}^{\\alpha_{2}} \\cdots x_{i_{k}}^{\\alpha_{k}}\\), where the sum is over the same set as above, is equal to \\(p^{r^{2}+1-k} \\sum_{x_{i_{1}}, \\ldots, x_{i_{k}}} b x_{i_{1}}^{\\alpha_{1}} x_{i_{2}}^{\\alpha_{2}} \\cdots x_{i_{k}}^{\\alpha_{k}}\\), which is divisible by \\(p\\). This proves the claim.\n\nComment. In general, if we replace \\(p-1\\) in (i) with any positive integer \\(d\\), the answer is \\((p-1) d\\). In fact, if \\(k>(p-1) d\\), then the constant term of the element \\(\\left(1-g_{1}\\right) \\cdots\\left(1-g_{k}\\right)\\) of the group algebra \\(\\mathbb{Q}_{p}\\left(\\zeta_{p}\\right)\\left[(\\mathbb{Z} / p \\mathbb{Z})^{d}\\right]\\) can be evaluated \\(p\\)-adically so we see that it is not equal to 1 . Here \\(g_{1}, \\ldots, g_{k} \\in(\\mathbb{Z} / p \\mathbb{Z})^{d}, \\mathbb{Q}_{p}\\) is the \\(p\\)-adic number field, and \\(\\zeta_{p}\\) is a primitive \\(p\\)-th root of 1 . This also gives an alternative solution to the problem."}
{"id": "imo-shortlist-2001-a1", "question": "A1. Let \\(T\\) denote the set of all ordered triples ( \\(p, q, r\\) ) of nonnegative integers. Find all functions \\(f: T \\rightarrow \\mathbb{R}\\) such that\n\n\\[\nf(p, q, r)= \\begin{cases}0 & \\text { if } p q r=0 \\\\ 1+\\frac{1}{6}\\{f(p+1, q-1, r)+f(p-1, q+1, r) & \\\\ +f(p-1, q, r+1)+f(p+1, q, r-1) & \\\\ +f(p, q+1, r-1)+f(p, q-1, r+1)\\} & \\text { otherwise }\n\\]", "category": "Algebra", "source": "IMO Shortlist", "year": 2001, "solution": "First, we will show that there is at most one function which satisfies the given conditions. Suppose that \\(f_{1}\\) and \\(f_{2}\\) are two such functions. Define \\(h=f_{1}-f_{2}\\). Then \\(h: T \\rightarrow \\mathbb{R}\\) satisfies\n\n\\[\nh(p, q, r)= \\begin{cases}0 & \\text { if } p q r=0 \\\\ \\frac{1}{6}\\{h(p+1, q-1, r)+h(p-1, q+1, r) & \\\\ +h(p-1, q, r+1)+h(p+1, q, r-1) & \\\\ +h(p, q+1, r-1)+h(p, q-1, r+1)\\} & \\text { otherwise }\n\\]\n\nObserve that the second condition states that \\(h(p, q, r)\\) is equal to the average of the values of \\(h\\) at the six points \\((p+1, q-1, r)\\), etc., which are the vertices of a regular hexagon with center at ( \\(p, q, r\\) ) lying in the plane \\(x+y+z=p+q+r\\). It suffices to show that \\(h=0\\) for all points in \\(T\\). Let \\(n\\) be a positive integer. Consider the subset \\(H\\)\nof the plane \\(x+y+z=n\\) that lies in the \"nonnegative\" octant \\(\\{(x, y, z): x, y, z \\geq 0\\}\\). Suppose \\(h\\) attains its maximum on \\(H \\cap T\\) at \\((p, q, r)\\). If \\(p q r=0\\) then the maximum value for \\(h\\) on \\(H \\cap T\\) is 0 . If pqr \\(\\neq 0\\), the averaging property of \\(h\\) implies that the values of \\(h\\) on the six points \\((p+1, q-1, r)\\), etc. are all equal to \\(h(p, q, r)\\). (The six points are all in \\(H\\) ). In particular, \\(h\\) also attains its maximum at ( \\(p+1, q-1, r\\) ). Repeating the argument (if necessary) using ( \\(p+1, q-1, r\\) ) as the center point,we see that\n\n\\[\nh(p, q, r)=h(p+1, q-1, r)=h(p+2, q-2, r) .\n\\]\n\nContinuing this process, we conclude that \\(h(p, q, r)=h(p+q, 0, r)=0\\). Thus the maximum value of \\(h\\) on \\(H \\cap T\\) is 0 . By applying the same argument to the function \\(-h=f_{2}-f_{1}\\), we see that the minimum value attained by \\(h\\) on \\(H \\cap T\\) is also 0 . Thus \\(h=0\\) for all points in \\(H \\cap T\\). Varying \\(n\\), we conclude that \\(h=0\\) on all points in \\(T\\). We will complete the solution by noting that \\(f: T \\rightarrow \\mathbb{R}\\) defined by\n\n\\[\nf(p, q, r)= \\begin{cases}0 & \\text { if } p q r=0 \\\\ \\frac{3 p q r}{p+q+r} & \\text { otherwise }\n\\]\n\nsatisfies both conditions of the problem, and is the unique solution.\nRemark 1. One can guess the solution function in the following way: For any function \\(f\\) defined on \\(T\\), define the function \\(A[f]\\) by\n\n\\[\nA[f](p, q, r)=\\frac{1}{6}(f(p+1, q-1, r)+\\cdots)\n\\]\n\nIt is easy to check that if \\(c\\) is a constant, then\n\n\\[\nA[c f]=c A[f] \\quad \\text { and } \\quad A[c+f]=c+A[f] .\n\\]\n\nAlso note that if \\(h\\) is defined by \\(h(p, q, r)=f(p, q, r) /(p+q+r)\\), then\n\n\\[\nA[h](p, q, r)=\\frac{A[f](p, q, r)}{p+q+r}\n\\]\n\nWe need to find a function \\(f\\) that satisfies the boundary conditions, as well as the second condition\n\n\\[\nf=A[f]+1\n\\]\n\nIt is natural to start by considering \\(g(p, q, r)=p q r\\), which satisfies the boundary conditions. We shall suitably modify this so that the second condition is also satisfied. Observe that\n\n\\[\nA[g](p, q, r)=\\frac{1}{6}(6 p q r-2(p+q+r))=g(p, q, r)-\\frac{p+q+r}{3}\n\\]\n\nThus there is an extra term involving \\(p+q+r\\). To take care of this, we divide \\(p q r\\) by \\(p+q+r\\) and consider the function \\(u(p, q, r)=p q r /(p+q+r)\\). We have\n\n\\[\nA[u](p, q, r)=\\frac{A[g](p, q, r)}{p+q+r}=u(p, q, r)-\\frac{1}{3}\n\\]\n\nThus\n\n\\[\nA[3 u]=3 u-1\n\\]\n\nand hence \\(3 p q r /(p+q+r)\\) satisfies the second condition.\nRemark 2. One can consider the two-dimensional version of this problem, where \\(f(p, q)=0\\) if \\(p q=0\\) and \\(f(p, q)=1+[f(p+1, q-1)+f(p-1, q+1)] / 2\\) otherwise. The unique solution is \\(f(p, q)=p q\\).\n\nProblem"}
{"id": "imo-shortlist-2001-a2", "question": "A2. Let \\(a_{0}, a_{1}, a_{2}, \\ldots\\) be an arbitrary infinite sequence of positive numbers. Show that the inequality \\(1+a_{n}>a_{n-1} \\sqrt[n]{2}\\) holds for infinitely many positive integers \\(n\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2001, "solution": "Let \\(c_{0}, c_{1}, c_{2}, c_{3}, \\ldots\\) be the sequence defined by \\(c_{0}=1\\) and\n\n\\[\nc_{n}=\\left(\\frac{a_{n-1}}{1+a_{n}}\\right) c_{n-1}, \\quad n \\geq 1\n\\]\n\nRewriting this as \\(c_{n}=a_{n-1} c_{n-1}-a_{n} c_{n}\\), we obtain the telescoping sum\n\n\\[\nc_{1}+c_{2}+\\cdots+c_{n}=a_{0}-a_{n} c_{n}\n\\]\n\nThe assertion of the problem is equivalent to: \\(c_{n} / c_{n-1}<2^{-1 / n}\\) for infinitely many \\(n\\). Assume to the contrary that there exists \\(N\\) such that the opposite inequality holds for all \\(n \\geq N\\). Then for \\(n>N\\),\n\n\\[\nc_{n} \\geq c_{N} \\cdot 2^{-\\left(\\frac{1}{N+1}+\\frac{1}{N+2}+\\cdots+\\frac{1}{n}\\right)}=C \\cdot 2^{-\\left(1+\\frac{1}{2}+\\cdots+\\frac{1}{n}\\right)}\n\\]\n\nwhere \\(C=c_{N} \\cdot 2^{1+\\frac{1}{2}+\\cdots+\\frac{1}{N}}\\) is a positive constant. If \\(2^{k-1} \\leq n<2^{k}\\), then\n\n\\[\n\\begin{aligned}\n1+\\frac{1}{2}+\\cdots+\\frac{1}{n} & \\leq 1+\\left(\\frac{1}{2}+\\frac{1}{3}\\right)+\\left(\\frac{1}{4}+\\cdots+\\frac{1}{7}\\right)+\\cdots+\\left(\\frac{1}{2^{k-1}}+\\cdots+\\frac{1}{2^{k}-1}\\right) \n& \\leq 1+1+1+\\cdots+1 \n& =k\n\n\\]\n\nso that\n\n\\[\nc_{n} \\geq C \\cdot 2^{-k} \\quad \\text { for } \\quad 2^{k-1} \\leq n<2^{k}\n\\]\n\nLet \\(r\\) be such that \\(2^{r-1} \\leq N<2^{r}\\), and let \\(m>r\\). Then\n\n\\[\n\\begin{aligned}\nc_{2^{r}}+c_{2^{r}+1}+\\cdots+c_{2^{m}-1}= & \\left(c_{2^{r}}+\\cdots+c_{2^{r+1}-1}\\right)+\\left(c_{2^{r+1}}+\\cdots+c_{2^{r+2}-1}\\right) \n& +\\cdots+\\left(c_{2^{m-1}}+\\cdots+c_{2^{m}-1}\\right) \n\\geq & C \\cdot\\left(2^{r} \\cdot 2^{-r-1}+2^{r+1} \\cdot 2^{-r-2}+\\cdots+2^{m-1} \\cdot 2^{-m}\\right) \n= & \\frac{C \\cdot(m-r)}{2}\n\n\\]\n\nshowing that the sum of the \\(c_{n}\\) can be made arbitrarily large. However, by \\((*)\\), this sum can never exceed \\(a_{0}\\). This contradiction shows that \\(c_{n} / c_{n-1}<2^{-1 / n}\\) for infinitely many \\(n\\), as desired.\n\nSolution 2. Arguing by contradiction, suppose there is \\(N\\) such that \\(1+a_{n} \\leq a_{n-1} 2^{1 / n}\\) for \\(n \\geq N\\). Multiply both sides by\n\n\\[\nb_{n}=2^{-\\left(1+\\frac{1}{2}+\\cdots+\\frac{1}{n}\\right)}\n\\]\n\nto get\n\n\\[\nb_{n}+A_{n} \\leq A_{n-1},\n\\]\n\nwhere \\(A_{n}=b_{n} a_{n}\\).\nThus we have\n\n\\[\n\\begin{aligned}\nb_{N} & \\leq A_{N-1}-A_{N} \nb_{N+1} & \\leq A_{N}-A_{N+1} \n\\vdots & \\vdots \nb_{n} & \\leq A_{n-1}-A_{n},\n\n\\]\n\nand thus\n\n\\[\n\\sum_{j=N}^{n} b_{j} \\leq A_{N-1}-A_{n} \\leq A_{N-1}\n\\]\n\nsince the \\(a_{j}\\) are positive.\nWe shall show, however, that\n\n\\[\n\\sum_{n \\geq N} b_{n}\n\\]\n\ndiverges. To see this, note that because \\(1 / x\\) is monotone decreasing, a simple comparison of areas yields\n\n\\[\n\\frac{1}{2}+\\frac{1}{3}+\\cdots+\\frac{1}{n}<\\int_{1}^{n} \\frac{d x}{x}=\\log n\n\\]\n\nfor any positive integer \\(n\\). Hence\n\n\\[\n1+\\frac{1}{2}+\\frac{1}{3}+\\cdots+\\frac{1}{n}<1+\\log n\n\\]\n\nand\n\n\\[\nb_{n}>2^{-1-\\log n}=\\frac{1}{2} n^{-\\log 2}>\\frac{1}{2 n}\n\\]\n\nBecause the harmonic series diverges (which can be proven by comparing areas as above, or with more elementary and well-known arguments), \\(\\sum_{n \\geq N} b_{n}\\) diverges as well.\n\nProblem"}
{"id": "imo-shortlist-2001-a3", "question": "A3. Let \\(x_{1}, x_{2}, \\ldots, x_{n}\\) be arbitrary real numbers. Prove the inequality\n\n\\[\n\\frac{x_{1}}{1+x_{1}^{2}}+\\frac{x_{2}}{1+x_{1}^{2}+x_{2}^{2}}+\\cdots+\\frac{x_{n}}{1+x_{1}^{2}+\\cdots+x_{n}^{2}}<\\sqrt{n} .\n\\]", "category": "Algebra", "source": "IMO Shortlist", "year": 2001, "solution": "By the Cauchy-Schwarz inequality,\n\n\\[\na_{1}+a_{2}+\\cdots+a_{n} \\leq \\sqrt{n} \\sqrt{a_{1}^{2}+a_{2}^{2}+\\cdots+a_{n}^{2}}\n\\]\n\nfor any real numbers \\(a_{1}, a_{2}, \\ldots, a_{n}\\). Taking \\(a_{k}=x_{k} /\\left(1+x_{1}^{2}+\\cdots+x_{k}^{2}\\right)\\) for \\(k=\\) \\(1,2, \\cdots, n\\), it suffices to prove that\n\n\\[\n\\left(\\frac{x_{1}}{1+x_{1}^{2}}\\right)^{2}+\\left(\\frac{x_{2}}{1+x_{1}^{2}+x_{2}^{2}}\\right)^{2}+\\cdots+\\left(\\frac{x_{n}}{1+x_{1}^{2}+\\cdots+x_{n}^{2}}\\right)^{2}<1 .\n\\]\n\nObserve that for \\(k \\geq 2\\),\n\n\\[\n\\begin{aligned}\n\\left(\\frac{x_{k}}{1+x_{1}^{2}+\\cdots+x_{k}^{2}}\\right)^{2} & =\\frac{x_{k}^{2}}{\\left(1+x_{1}^{2}+\\cdots+x_{k}^{2}\\right)^{2}} \n& \\leq \\frac{x_{k}^{2}}{\\left(1+x_{1}^{2}+\\cdots+x_{k-1}^{2}\\right)\\left(1+x_{1}^{2}+\\cdots+x_{k}^{2}\\right)} \n& =\\frac{1}{\\left(1+x_{1}^{2}+\\cdots+x_{k-1}^{2}\\right)}-\\frac{1}{\\left(1+x_{1}^{2}+\\cdots+x_{k}^{2}\\right)}\n\n\\]\n\nFor \\(k=1\\), similar reasoning yields the inequality\n\n\\[\n\\left(\\frac{x_{1}}{1+x_{1}^{2}}\\right)^{2} \\leq 1-\\frac{1}{1+x_{1}^{2}}\n\\]\n\nSumming these inequalities, the right-hand side telescopes to yield\n\n\\[\n\\sum_{k=1}^{n}\\left(\\frac{x_{k}}{1+x_{1}^{2}+\\cdots+x_{k}^{2}}\\right)^{2} \\leq 1-\\frac{1}{1+x_{1}^{2}+\\cdots+x_{n}^{2}}<1\n\\]\n\nSolution 2. Let\n\n\\[\na_{n}=\\sup \\left(\\frac{x_{1}}{1+x_{1}^{2}}+\\cdots+\\frac{x_{n}}{1+x_{1}^{2}+\\cdots+x_{n}^{2}}\\right)\n\\]\n\nand\n\n\\[\nb_{n}(r)=\\sup \\left(\\frac{x_{1}}{r^{2}+x_{1}^{2}}+\\cdots+\\frac{x_{n}}{r^{2}+x_{1}^{2}+\\cdots+x_{n}^{2}}\\right),\n\\]\n\nwhere the supremums are taken over all real \\(x_{1}, \\ldots, x_{n}\\). Replacing \\(x_{i}\\) by \\(r x_{i}\\) in the second formula shows that \\(b_{n}(r)=a_{n} / r\\) when \\(r>0\\). Hence splitting off all but the first term gives\n\n\\[\na_{n}=\\sup _{x_{1}}\\left(\\frac{x_{1}}{1+x_{1}^{2}}+\\frac{a_{n-1}}{\\sqrt{1+x_{1}^{2}}}\\right) .\n\\]\n\nThe result now follows by induction once one shows \\(a_{1}=1 / 2<1\\) and\n\n\\[\n\\frac{x}{1+x^{2}}+\\frac{\\sqrt{n}}{\\sqrt{1+x^{2}}}<\\sqrt{n+1}\n\\]\n\nThis latter inequality can be proven as follows: Without loss of generality, let \\(x\\) be positive (the inequality obviously holds for \\(x=0\\) and negative \\(x\\) ), and let \\(0<\\theta<\\pi / 2\\) such that \\(\\tan \\theta=x\\). Also choose \\(0<\\alpha<\\pi / 2\\) such that \\(\\tan \\alpha=\\sqrt{n}\\). Then\n\n\\[\n\\begin{aligned}\n\\frac{x}{1+x^{2}}+\\frac{\\sqrt{n}}{\\sqrt{1+x^{2}}} & =\\sin \\theta \\cos \\theta+\\sqrt{n} \\cos \\theta \n& <\\sin \\theta+\\sqrt{n} \\cos \\theta \n& =\\sqrt{n+1}\\left(\\frac{1}{\\sqrt{n+1}} \\sin \\theta+\\frac{\\sqrt{n}}{\\sqrt{n+1}} \\cos \\theta\\right) \n& =\\sqrt{n+1}(\\cos \\alpha \\sin \\theta+\\sin \\alpha \\cos \\theta) \n& =\\sqrt{n+1} \\sin (\\theta+\\alpha) \n& \\leq \\sqrt{n+1}\n\n\\]\n\nProblem"}
{"id": "imo-shortlist-2001-a4", "question": "A4. Find all functions \\(f: \\mathbb{R} \\rightarrow \\mathbb{R}\\), satisfying\n\n\\[\nf(x y)(f(x)-f(y))=(x-y) f(x) f(y)\n\\]\n\nfor all \\(x, y\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2001, "solution": "We wish to find all real-valued functions with real domain satisfying\n\n\\[\nf(x y)(f(x)-f(y))=(x-y) f(x) f(y)\n\\]\n\nfor all real \\(x, y\\). Substituting \\(y=1\\) into (1) yields\n\n\\[\nf(x)^{2}=x f(x) f(1)\n\\]\n\nIf \\(f(1)=0\\), then \\(f(x)=0\\) for all \\(x\\). This satisfies (1), yielding one solution. Suppose then, that \\(f(1)=C \\neq 0\\). Equation (2) implies that \\(f(0)=0\\). Now let \\(G\\) be a set of points \\(x\\) for which \\(f(x) \\neq 0\\). By (2),\n\n\\[\nf(x)=x f(1) \\quad \\text { for all } \\quad x \\in G\n\\]\n\nHence (1) can be satisfied only by functions satisfying\n\n\\[\nf(x)= \\begin{cases}C x & \\text { if } x \\in G \\\\ 0 & \\text { if } x \\notin G\n\\]\n\nWe must determine the structure of \\(G\\) so that the function defined by (3) satisfies (1) for all real \\(x, y\\). It is easy to check that if \\(x \\neq y\\) and both \\(x\\) and \\(y\\) are elements of \\(G\\), then the function defined by (3) satisfies (1) if and only if \\(x y \\in G\\). If neither \\(x\\) nor \\(y\\) are elements of \\(G\\) then (1) is satisfied. By symmetry, the only other case to look at is \\(x \\in G, y \\notin G\\). In this case, (1) implies that\n\n\\[\nf(x y) f(x)=0\n\\]\n\nwhich in turn implies that \\(f(x y)=0\\). Thus:\n\n\\[\n\\text { If } \\quad x \\in G, y \\notin G, \\quad \\text { then } \\quad x y \\notin G .\n\\]\n\nThis implies the following facts about \\(G\\) :\n(a) If \\(x \\in G\\), then \\(1 / x \\in G\\). This is true, for otherwise (4) forces \\(1 \\notin G\\), which is impossible (recall that we are assuming that \\(f(1) \\neq 0\\), so \\(1 \\in G\\) ).\n(b) If \\(x, y \\in G\\), then \\(x y \\in G\\). By (a) above, \\(1 / x \\in G\\), so if \\(x y \\notin G\\), then (4) implies that \\(y=(x y)(1 / x) \\notin G\\), a contradiction.\n(c) If \\(x, y \\in G\\), then \\(x / y \\in G\\). This follows easily from (a) and (b).\n\nConsequently, \\(G\\) is a set that contains 1 , does not contain 0 , and is closed under multiplication and division. It is easy to check that any such set will satisfy (a) above (since \\(1 \\in G\\) ) and (4): If \\(G\\) is closed under multiplication and division and \\(x \\in G, y \\notin G\\), then \\(x y \\notin G\\), for otherwise, \\(y=(x y) / x \\in G\\), a contradiction.\n\nTherefore, closure under multiplication and division completely characterizes \\(G\\), and we can finally write the full answer to the problem:\n\n\\[\nf(x)= \\begin{cases}C x & \\text { if } x \\in G \\\\ 0 & \\text { if } x \\notin G\n\\]\n\nwhere \\(C\\) is an arbitrary fixed real number, and \\(G\\) is any subset of \\(R\\) that is closed under multiplication and division (i.e., any subgroup of the nonzero real numbers under multiplication). Note that \\(C=0\\) yields the \"trivial\" solution derived earlier.\n\nProblem"}
{"id": "imo-shortlist-2001-a5", "question": "A5. Find all positive integers \\(a_{1}, a_{2}, \\ldots, a_{n}\\) such that\n\n\\[\n\\frac{99}{100}=\\frac{a_{0}}{a_{1}}+\\frac{a_{1}}{a_{2}}+\\cdots+\\frac{a_{n-1}}{a_{n}},\n\\]\n\nwhere \\(a_{0}=1\\) and \\(\\left(a_{k+1}-1\\right) a_{k-1} \\geq a_{k}^{2}\\left(a_{k}-1\\right)\\) for \\(k=1,2, \\ldots, n-1\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2001, "solution": "Let \\(a_{1}, a_{2}, \\ldots, a_{n}\\) be positive integers satisfying the conditions of the problem. Then \\(a_{k}>a_{k-1}\\), and hence \\(a_{k} \\geq 2\\) for \\(k=1,2, \\ldots, n-1\\). The inequality \\(\\left(a_{k+1}-1\\right) a_{k-1} \\geq a_{k}^{2}\\left(a_{k}-1\\right)\\) can be written in the form\n\n\\[\n\\frac{a_{k-1}}{a_{k}}+\\frac{a_{k}}{a_{k+1}-1} \\leq \\frac{a_{k-1}}{a_{k}-1}\n\\]\n\nSumming these inequalities for \\(k=i+1, i+2, \\ldots, n-1\\), together with the obvious inequality \\(a_{n-1} / a_{n}<a_{n-1} /\\left(a_{n}-1\\right)\\), we obtain\n\n\\[\n\\frac{a_{i}}{a_{i+1}}+\\frac{a_{i+1}}{a_{i+2}}+\\cdots+\\frac{a_{n-1}}{a_{n}}<\\frac{a_{i}}{a_{i+1}-1} .\n\\]\n\nWe now determine \\(a_{1}, a_{2}, \\ldots, a_{n}\\). Using the sum given in the problem statement and (*), with \\(i=0\\), we obtain\n\n\\[\n\\frac{1}{a_{1}} \\leq \\frac{99}{100}<\\frac{1}{a_{1}-1}\n\\]\n\nso \\(a_{1}=2\\). Using a similar approach with \\(i=1\\) we find\n\n\\[\n\\frac{1}{a_{2}} \\leq \\frac{1}{a_{1}}\\left(\\frac{99}{100}-\\frac{1}{a_{1}}\\right)<\\frac{1}{a_{2}-1}\n\\]\n\nand it follows that \\(a_{2}=5\\). Repeating this argument with \\(i=2\\) and then \\(i=3\\) we obtain\n\n\\[\n\\frac{1}{a_{3}} \\leq \\frac{1}{a_{2}}\\left(\\frac{99}{100}-\\frac{1}{a_{1}}-\\frac{a_{1}}{a_{2}}\\right)<\\frac{1}{a_{3}-1}\n\\]\n\nfrom which \\(a_{3}=56\\), and\n\n\\[\n\\frac{1}{a_{4}} \\leq \\frac{1}{a_{3}}\\left(\\frac{99}{100}-\\frac{1}{a_{1}}-\\frac{a_{1}}{a_{2}}-\\frac{a_{2}}{a_{3}}\\right)<\\frac{1}{a_{4}-1}\n\\]\n\nwhich implies that \\(a_{4}=25 \\cdot 56^{2}=78400\\). Continuing with the argument to determine \\(a_{5}\\) we find\n\n\\[\n\\frac{1}{a_{5}} \\leq \\frac{1}{a_{4}}\\left(\\frac{99}{100}-\\frac{1}{2}-\\frac{2}{5}-\\frac{5}{56}-\\frac{56}{25 \\cdot 56^{2}}\\right)=0\n\\]\n\nwhich is impossible. It is easy to verify that the positive integers \\(a_{1}=2, a_{2}=5\\), \\(a_{3}=56, a_{4}=25 \\cdot 56^{2}\\) satisfy the conditions of the problem. The preceding argument shows that the solution is unique.\n\nProblem"}
{"id": "imo-shortlist-2001-a6", "question": "A6. Prove that for all positive real numbers \\(a, b, c\\),\n\n\\[\n\\frac{a}{\\sqrt{a^{2}+8 b c}}+\\frac{b}{\\sqrt{b^{2}+8 c a}}+\\frac{c}{\\sqrt{c^{2}+8 a b}} \\geq 1\n\\]", "category": "Algebra", "source": "IMO Shortlist", "year": 2001, "solution": "First we shall prove that\n\n\\[\n\\frac{a}{\\sqrt{a^{2}+8 b c}} \\geq \\frac{a^{\\frac{4}{3}}}{a^{\\frac{4}{3}}+b^{\\frac{4}{3}}+c^{\\frac{4}{3}}}\n\\]\n\nor equivalently, that\n\n\\[\n\\left(a^{\\frac{4}{3}}+b^{\\frac{4}{3}}+c^{\\frac{4}{3}}\\right)^{2} \\geq a^{\\frac{2}{3}}\\left(a^{2}+8 b c\\right)\n\\]\n\nThe AM-GM inequality yields\n\n\\[\n\\begin{aligned}\n\\left(a^{\\frac{4}{3}}+b^{\\frac{4}{3}}+c^{\\frac{4}{3}}\\right)^{2}-\\left(a^{\\frac{4}{3}}\\right)^{2} & =\\left(b^{\\frac{4}{3}}+c^{\\frac{4}{3}}\\right)\\left(a^{\\frac{4}{3}}+a^{\\frac{4}{3}}+b^{\\frac{4}{3}}+c^{\\frac{4}{3}}\\right) \n& \\geq 2 b^{\\frac{2}{3}} c^{\\frac{2}{3}} \\cdot 4 a^{\\frac{2}{3}} b^{\\frac{1}{3}} c^{\\frac{1}{3}} \n& =8 a^{\\frac{2}{3}} b c\n\n\\]\n\nThus\n\n\\[\n\\begin{aligned}\n\\left(a^{\\frac{4}{3}}+b^{\\frac{4}{3}}+c^{\\frac{4}{3}}\\right)^{2} \\geq\\left(a^{\\frac{4}{3}}\\right)^{2}+8 a^{\\frac{2}{3}} b c & \n& =a^{\\frac{2}{3}}\\left(a^{2}+8 b c\\right)\n\n\\]\n\nso\n\n\\[\n\\frac{a}{\\sqrt{a^{2}+8 b c}} \\geq \\frac{a^{\\frac{4}{3}}}{a^{\\frac{4}{3}}+b^{\\frac{4}{3}}+c^{\\frac{4}{3}}}\n\\]\n\nSimilarly, we have\n\n\\[\n\\begin{aligned}\n& \\frac{b}{\\sqrt{b^{2}+8 c a}} \\geq \\frac{b^{\\frac{4}{3}}}{a^{\\frac{4}{3}}+b^{\\frac{4}{3}}+c^{\\frac{4}{3}}} \\quad \\text { and } \n& \\frac{c}{\\sqrt{c^{2}+8 a b}} \\geq \\frac{c^{\\frac{4}{3}}}{a^{\\frac{4}{3}}+b^{\\frac{4}{3}}+c^{\\frac{4}{3}}}\n\n\\]\n\nAdding these three inequalities yields\n\n\\[\n\\frac{a}{\\sqrt{a^{2}+8 b c}}+\\frac{b}{\\sqrt{b^{2}+8 c a}}+\\frac{c}{\\sqrt{c^{2}+8 a b}} \\geq 1\n\\]\n\nComment. The proposer conjectures that for any \\(a, b, c>0\\) and \\(\\lambda \\geq 0\\), the following inequality holds:\n\n\\[\n\\frac{a}{\\sqrt{a^{2}+\\lambda b c}}+\\frac{b}{\\sqrt{b^{2}+\\lambda c a}}+\\frac{c}{\\sqrt{c^{2}+\\lambda a b}} \\geq \\frac{3}{\\sqrt{1+\\lambda}}\n\\]"}
{"id": "imo-shortlist-2001-c1", "question": "C1. Let \\(A=\\left(a_{1}, a_{2}, \\ldots, a_{2001}\\right)\\) be a sequence of positive integers. Let \\(m\\) be the number of 3-element subsequences ( \\(a_{i}, a_{j}, a_{k}\\) ) with \\(1 \\leq i<j<k \\leq 2001\\), such that \\(a_{j}=a_{i}+1\\) and \\(a_{k}=a_{j}+1\\). Considering all such sequences \\(A\\), find the greatest value of \\(m\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2001, "solution": "Consider the following two operations on the sequence \\(A\\) :\n(1) If \\(a_{i}>a_{i+1}\\), transpose these terms to obtain the new sequence \\(\\left(a_{1}, a_{2}, \\ldots, a_{i+1}, a_{i}, \\ldots, a_{2001}\\right)\\).\n(2) If \\(a_{i+1}=a_{i}+1+d\\), where \\(d>0\\), increase \\(a_{1}, \\ldots, a_{i}\\) by \\(d\\) to obtain the new sequence \\(\\left(a_{1}+d, a_{2}+d, \\ldots, a_{i}+d, a_{i+1}, \\ldots, a_{2001}\\right)\\).\n\nIt is clear that performing operation (1) cannot reduce \\(m\\). By applying (1) repeatedly, the sequence can be rearranged to be nondecreasing. Thus we may assume that our sequence for which \\(m\\) is maximal is nondecreasing. Next, note that if \\(A\\) is nondecreasing, then performing operation (2) cannot reduce the value of \\(m\\). It follows that any \\(A\\) with maximum \\(m\\) is of the form\n\n\\[\n(\\underbrace{a, \\ldots, a}_{t_{1}}, \\underbrace{a+1, \\ldots, a+1}_{t_{2}}, \\ldots, \\underbrace{a+s-1, \\ldots, a+s-1}_{t_{s}})\n\\]\n\nwhere \\(t_{1}, \\ldots, t_{s}\\) are the number of terms in each subsequence, and \\(s \\geq 3\\). For such a sequence \\(A\\),\n\n\\[\nm=t_{1} t_{2} t_{3}+t_{2} t_{3} t_{4}+\\cdots+t_{s-2} t_{s-1} t_{s}\n\\]\n\nIt remains to find the best choice of \\(s\\) and the best partition of 2001 into positive integers \\(t_{1}, \\ldots, t_{s}\\).\n\nThe maximum value of \\(m\\) occurs when \\(s=3\\) or \\(s=4\\). If \\(s>4\\) then we may increase the value given by (*) by using a partition of 2001 into \\(s-1\\) parts, namely\n\n\\[\nt_{2}, t_{3},\\left(t_{1}+t_{4}\\right), \\ldots, t_{s}\n\\]\n\nNote that when \\(s=4\\) this modification does not change the value given by (*). Hence the maximum value \\(m\\) can be obtained with \\(s=3\\). In this case, \\(m=t_{1} t_{2} t_{3}\\) is largest when \\(t_{1}=t_{2}=t_{3}=2001 / 3=667\\). Thus the maximum value of \\(m\\) is \\(667^{3}\\). This maximum value is attained when \\(s=4\\) as well, in this case for sequences with \\(t_{1}=a, t_{2}=t_{3}=667\\), and \\(t_{4}=667-a\\), where \\(1 \\leq a \\leq 666\\).\n\nProblem"}
{"id": "imo-shortlist-2001-c2", "question": "C2. Let \\(n\\) be an odd integer greater than 1 and let \\(c_{1}, c_{2}, \\ldots, c_{n}\\) be integers. For each permutation \\(a=\\left(a_{1}, a_{2}, \\ldots, a_{n}\\right)\\) of \\(\\{1,2, \\ldots, n\\}\\), define \\(S(a)=\\sum_{i=1}^{n} c_{i} a_{i}\\). Prove that there exist permutations \\(a \\neq b\\) of \\(\\{1,2, \\ldots, n\\}\\) such that \\(n!\\) is a divisor of \\(S(a)-S(b)\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2001, "solution": "Let \\(\\sum S(a)\\) be the sum of \\(S(a)\\) over all \\(n!\\) permutations \\(a=\\left(a_{1}, a_{2}, \\ldots, a_{n}\\right)\\). We compute \\(\\sum S(a) \\bmod n!\\) two ways, one of which depends on the desired conclusion being false, and reach a contradiction when \\(n\\) is odd.\n\nFirst way. In \\(\\sum S(a), c_{1}\\) is multiplied by each \\(k \\in\\{1, \\ldots, n\\}\\) a total of \\((n-1)\\) ! times, once for each permutation of \\(\\{1, \\ldots, n\\}\\) in which \\(a_{1}=k\\). Thus the coefficient of \\(c_{1}\\) in \\(\\sum S(a)\\) is\n\n\\[\n(n-1)!(1+2+\\cdots+n)=(n+1)!/ 2\n\\]\n\nThe same is true for all \\(c_{i}\\), so\n\n\\[\n\\sum S(a)=\\frac{(n+1)!}{2} \\sum_{i=1}^{n} c_{i}\n\\]\n\nSecond way. If \\(n!\\) is not a divisor of \\(S(a)-S(b)\\) for any \\(a \\neq b\\), then each \\(S(a)\\) must have a different remainder mod \\(n!\\). Since there are \\(n!\\) permutations, these remainders must be precisely the numbers \\(0,1,2, \\ldots, n!-1\\). Thus\n\n\\[\n\\sum S(a) \\equiv \\frac{(n!-1) n!}{2} \\bmod n!.\n\\]\n\nCombining (1) and (2), we get\n\n\\[\n\\frac{(n+1)!}{2} \\sum_{i=1}^{n} c_{i} \\equiv \\frac{(n!-1) n!}{2} \\bmod n!.\n\\]\n\nNow, for \\(n\\) odd, the left side of (3) is congruent to 0 modulo \\(n!\\), while for \\(n>1\\) the right side is not congruent to \\(0(n!-1\\) is odd). For \\(n>1\\) and odd, we have a contradiction.\n\nProblem"}
{"id": "imo-shortlist-2001-c3", "question": "C3. Define a \\(k\\)-clique to be a set of \\(k\\) people such that every pair of them are acquainted with each other. At a certain party, every pair of 3-cliques has at least one person in common, and there are no 5 -cliques. Prove that there are two or fewer people at the party whose departure leaves no 3-clique remaining.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2001, "solution": "It is convenient to use the language of graph theory. Each person at the party is represented by a vertex, and there is an edge joining two vertices if the corresponding persons are acquainted. An \\(m\\)-clique then corresponds to a set of \\(m\\) vertices with each pair of vertices joined by an edge. In other words, the existence of such a clique means the given graph contains the complete graph \\(K_{m}\\) as a subgraph. In particular, a 3-clique corresponds to a triangle ( \\(K_{3}\\) ). We wish to prove that in any graph \\(G\\) in which any two triangles have at least one vertex in common and there is no \\(K_{5}\\), there exist two or fewer vertices whose removal eliminates all triangles.\n\nLet \\(G\\) be such a graph. The result is trivially true in case \\(G\\) has at most one triangle. Thus we have either (a) or (b) as shown below.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c6743ebd3edd647fb160g-28}\n\nSuppose (a) occurs, and let \\(T_{1}=\\{p, q, r\\}\\) and \\(T_{2}=\\{r, s, t\\}\\). If the deletion of \\(r\\) destroys all triangles, we are done. Otherwise there is a third triangle \\(T_{3}\\) that is not destroyed by the removal of \\(r\\), and this triangle must share a vertex with each of \\(T_{1}\\) and \\(T_{2}\\). It is plain that any such triangle leads to an occurrence of (b) with \\(x=r\\) and \\(u \\in T_{1}, v \\in T_{2}\\). Thus we are left to consider case (b). Suppose (b) occurs, and now let \\(T_{1}=\\{u, v, x\\}\\) and \\(T_{2}=\\{u, v, y\\}\\). If the deletion of \\(u\\) and \\(v\\) destroys all triangles, we are done. Otherwise, for some \\(z \\notin\\{u, v, x, y\\}\\) there must be a triangle \\(T_{3}=\\{x, y, z\\}\\). In particular, \\(x y\\) is an edge. Now \\(G\\) contains the following subgraph.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c6743ebd3edd647fb160g-29}\n(c)\n\nWe claim that the deletion of \\(x\\) and \\(y\\) destroys all triangles. Suppose not. Then there is a triangle \\(T\\) that is disjoint from \\(\\{x, y\\}\\). Since \\(T\\) shares a vertex with \\(\\{x, y, z\\}\\), \\(T\\) contains \\(z\\). Similarly, \\(T\\) contains \\(u\\) since it shares a vertex with \\(\\{x, y, u\\}\\) and \\(T\\) contains \\(v\\) since it shares a vertex with \\(\\{x, y, v\\}\\). Thus \\(T=\\{z, u, v\\}\\), but this is impossible since \\(G\\) contains no \\(K_{5}\\). Hence there are always two or fewer vertices whose removal destroys all triangles.\n\nProblem"}
{"id": "imo-shortlist-2001-c4", "question": "C4. A set of three nonnegative integers \\(\\{x, y, z\\}\\) with \\(x<y<z\\) is called historic if \\(\\{z-y, y-x\\}=\\{1776,2001\\}\\). Show that the set of all nonnegative integers can be written as the union of pairwise disjoint historic sets.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2001, "solution": "For convenience let \\(a=1776\\) and \\(b=2001\\). All that we will really use about \\(a\\) and \\(b\\) is that \\(0<a<b\\). Define\n\n\\[\n\\begin{aligned}\n& A=\\{0, a, a+b\\} \n& B=\\{0, b, a+b\\} .\n\n\\]\n\nNote that both \\(A\\) and \\(B\\) are historic, and that a set \\(X\\) is historic if and only if \\(X=x+A\\) or \\(X=x+B\\) for some nonnegative integer \\(x\\), where \\(x+S=\\{x+s \\mid s \\in S\\}\\).\n\nWe will show how to construct an infinite sequence \\(X_{0}, X_{1}, X_{2}, \\ldots\\) of disjoint historic sets with the property that if \\(k\\) is the smallest nonnegative integer not included among \\(X_{0}\\) through \\(X_{m}\\), then \\(k\\) belongs to \\(X_{m+1}\\). Thus the union of this infinite sequence includes every nonnegative integer.\n\nTake \\(X_{0}=A\\). Assuming that we have constructed \\(X_{0}\\) through \\(X_{m}\\), let \\(k\\) be the least element not occurring in their union, \\(U\\). Then take \\(X_{m+1}=k+A\\) if \\(k+a \\notin U\\) and \\(k+B\\) otherwise. That is, always take \\(k+A\\) first, if possible.\n\nWhy does this construction never fail? Suppose that we had carried it out to some point \\(m\\), and then failed. Note that the smallest elements of \\(X_{0}\\) through \\(X_{m}\\) are all less than \\(k\\) (since at each stage we added a set whose smallest element was the first missing from the union of the earlier ones). Therefore the element \\(k+a+b\\) is not in \\(U\\). So the failure must be due to the fact that \\(k+b\\) is covered by \\(U\\). How was \\(k+b\\) covered? For some \\(j \\leq m\\), it must have been the largest element of \\(X_{j}\\). Let \\(l\\) denote the least element in \\(X_{j}\\). Then \\(k+b=l+a+b\\), so \\(k=l+a\\). Since \\(k\\) is not covered, \\(X_{j}=l+B\\). But by the algorithm, we cannot choose \\(X_{j}=l+B\\) when \\(l+a\\) is not covered, a contradiction. This contradiction shows that the construction can never fail.\n\nProblem"}
{"id": "imo-shortlist-2001-c5", "question": "C5. Find all finite sequences \\(\\left(x_{0}, x_{1}, \\ldots, x_{n}\\right)\\) such that for every \\(j, 0 \\leq j \\leq\\) \\(n, x_{j}\\) equals the number of times \\(j\\) appears in the sequence.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2001, "solution": "Let \\(\\left(x_{0}, x_{1}, \\ldots, x_{n}\\right)\\) be any such sequence. Since each \\(x_{j}\\) is the number of times \\(j\\) appears, the terms of the sequence are nonnegative integers. Note that \\(x_{0}>0\\) since \\(x_{0}=0\\) is a contradiction. Let \\(m\\) denote the number of positive terms among \\(x_{1}, x_{2}, \\ldots, x_{n}\\). Since \\(x_{0}=p \\geq 1\\) implies \\(x_{p} \\geq 1\\), we see that \\(m \\geq 1\\). Observe that \\(\\sum_{i=1}^{n} x_{i}=m+1\\) since the sum on the left counts the total number of positive terms of the sequence, and \\(x_{0}>0\\). (Note. For every \\(j>0\\) that appears as some \\(x_{i}\\), the sequence is long enough to include a term \\(x_{j}\\) to count it, because the sequence contains \\(j\\) values of \\(i\\) and at least one other value, the value \\(j\\) itself if \\(i \\neq j\\) and the value 0 if \\(i=j\\).) Since the sum has exactly \\(m\\) positive terms, \\(m-1\\) of its terms equal 1 , one term equals 2 , and the remainder are 0 . Therefore only \\(x_{0}\\) can exceed 2 , so for \\(j>2\\) the possibility that \\(x_{j}>0\\) arises only in case \\(j=x_{0}\\). In particular, \\(m \\leq 3\\). Hence there are three cases to consider. In each case, bear in mind that \\(m-1\\) of the terms \\(x_{1}, x_{2}, \\ldots, x_{n}\\) equal 1 , one term equals 2 , and the the others are 0 .\n\nCase ( \\(i\\) ): \\(m=1\\). We have \\(x_{2}=2\\) since \\(x_{1}=2\\) is impossible. Thus \\(x_{0}=2\\) and the final sequence is \\((2,0,2,0)\\).\n\nCase ( \\(i i\\) ): \\(m=2\\). Either \\(x_{1}=2\\) or \\(x_{2}=2\\). The first possibility leads to ( \\(1,2,1,0\\) ) and the second one gives \\((2,1,2,0,0)\\).\n\nCase (iii): \\(m=3\\). In this case, \\(x_{p}>0\\) for some \\(p \\geq 3\\). By the last sentence before Case (i), \\(x_{0}=p\\) and \\(x_{p}=1\\). Then \\(x_{1}=1\\) is contradictory, so \\(x_{1}=2, x_{2}=1\\), and we have accounted for all of the positive terms of the sequence. The resulting sequence is \\((p, 2,1, \\underbrace{0, \\ldots, 0}_{p-3}, 1,0,0,0)\\).\n\nIn summary, there are three special solutions and one infinite family:\n\n\\[\n(2,0,2,0), \\quad(1,2,1,0), \\quad(2,1,2,0,0), \\quad(p, 2,1, \\underbrace{0, \\ldots, 0}_{p-3}, 1,0,0,0), \\quad p \\geq 3 .\n\\]\n\nNote. If one considers the null set to be a sequence, then it too is a solution.\n\nComment. An expanded version of the problem allows for infinite sequences, and such solutions exist. One simple construction starts with a finite solution \\(\\left(x_{0}, x_{1}, \\ldots, x_{n}\\right)\\), sets \\(x_{n+1}=n+1\\) and continues as shown:\n\n\\[\n(x_{0}, x_{1}, \\ldots, x_{n}, \\underbrace{n+1, n+1, \\ldots, n+1}_{x_{n+1}=n+1 \\text { terms }}, \\underbrace{n+2, n+2, \\ldots, n+2}_{x_{n+2} \\text { terms }}, \\ldots)\n\\]\n\nFor example, ( \\(1,2,1,0,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,8, \\ldots\\) ).\n\nProblem"}
{"id": "imo-shortlist-2001-c6", "question": "C6. For a positive integer \\(n\\) define a sequence of zeros and ones to be balanced if it contains \\(n\\) zeros and \\(n\\) ones. Two balanced sequences \\(a\\) and \\(b\\) are neighbors if you can move one of the \\(2 n\\) symbols of \\(a\\) to another position to form \\(b\\). For instance, when \\(n=4\\), the balanced sequences 01101001 and 00110101 are neighbors because the third (or fourth) zero in the first sequence can be moved to the first or second position to form the second sequence. Prove that there is a set \\(S\\) of at most \\(\\frac{1}{n+1}\\binom{2 n}{n}\\) balanced sequences such that every balanced sequence is equal to or is a neighbor of at least one sequence in \\(S\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2001, "solution": "For each balanced sequence \\(a=\\left(a_{1}, a_{2}, \\ldots, a_{2 n}\\right)\\) let \\(f(a)\\) be the sum of the positions of the 1's in \\(a\\). For example, \\(f(01101001)=2+3+5+8=18\\). Partition the \\(\\binom{2 n}{n}\\) balanced sequences into \\(n+1\\) classes according to the residue of \\(f(\\bmod n+1)\\), and let \\(S\\) be a class of minimum size. Then \\(|S| \\leq \\frac{1}{n+1}\\binom{2 n}{n}\\), and we claim that every balanced sequence is either a member of \\(S\\) or is a neighbor of at least one member of \\(S\\). Let \\(a=\\left(a_{1}, a_{2}, \\ldots, a_{2 n}\\right)\\) be a given balanced sequence. We consider two cases.\n\nCase ( \\(i\\) ): \\(a_{1}=1\\). The balanced sequence \\(b=\\left(b_{1}, b_{2}, \\ldots, b_{2 n}\\right.\\) ) obtained from \\(a\\) by moving the leftmost 1 just to the right of the \\(k\\) th 0 satisfies \\(f(b)=f(a)+k\\). (If \\(a_{m+1}\\) is the \\(k\\) th 0 of \\(a\\), then in going from \\(a\\) to \\(b\\), the leftmost 1 is moved up \\(m\\) places and \\(m-k\\) 1's are moved back one place each.) Thus we find \\(n\\) neighbors of \\(a\\) so that the values of \\(f\\) for \\(a\\) and these neighbors fill an interval of \\(n+1\\) consecutive integers. In particular, one of these \\(n+1\\) balanced sequences belongs to \\(S\\).\n\nCase (ii): \\(a_{1}=0\\). This case is similar. Movement of the initial 0 just to the right of the \\(k\\) th 1 yields a neighbor \\(b\\) satisfying \\(f(b)=f(a)-k\\).\n\nHence every balanced sequence is either equal to or is a neighbor of at least one member of \\(S\\).\n\nProblem"}
{"id": "imo-shortlist-2001-c7", "question": "C7. A pile of \\(n\\) pebbles is placed in a vertical column. This configuration is modified according to the following rules. A pebble can be moved if it is at the top of a column which contains at least two more pebbles than the column immediately to its right. (If there are no pebbles to the right, think of this as a column with 0 pebbles.) At each stage, choose a pebble from among those that can be moved (if there are any) and place it at the top of the column to its right. If no pebbles can be moved, the configuration is called a final configuration. For each \\(n\\), show that, no matter what choices are made at each stage, the final configuration obtained is unique. Describe that configuration in terms of \\(n\\).\n\nAlternative Version. A pile of 2001 pebbles is placed in a vertical column. This configuration is modified according to the following rules. A pebble can be moved if it is at the top of a column which contains at least two more pebbles than the column immediately to its right. (If there are no pebbles to the right, think of this as a column with 0 pebbles.) At each stage, choose a pebble from among those that can be moved (if there are any) and place it at the top of the column to its right. If no pebbles can be moved, the configuration is called a final configuration. Show that, no matter what choices are made at each stage, the final configuration obtained is unique. Describe that configuration as follows: Determine the number, \\(c\\), of nonempty columns, and for each \\(i=1,2, \\ldots, c\\), determine the number of pebbles \\(p_{i}\\) in column \\(i\\), where column 1 is the leftmost column, column 2 the next to the right, and so on.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2001, "solution": "of the First Version. At any stage, let \\(p_{i}\\) be the number of pebbles in column \\(i\\) for \\(i=1,2, \\ldots\\), where column 1 denotes the leftmost column. We will show that in the final configuration, for all \\(i\\) for which \\(p_{i}>0\\) we have \\(p_{i}=p_{i+1}+1\\), except that for at most one \\(i^{*}, p_{i^{*}}=p_{i^{*}+1}\\). Therefore, the configuration looks like the figure shown below, where there are \\(c\\) nonempty columns and there are from 1 to \\(c\\) pebbles in the last diagonal row of the triangular configuration. In particular, let \\(t_{k}=1+2+\\cdots+k=k(k+1) / 2\\) be the \\(k\\) th triangular number. Then \\(c\\) is the unique integer for which \\(t_{c-1}<n \\leq t_{c}\\). Let \\(s=n-t_{c-1}\\). Then there are \\(s\\) pebbles in the\nrightmost diagonal, and so the two columns with the same height are columns \\(c-s\\) and \\(c-s+1\\) (except if \\(s=c\\), in which case no nonempty columns have equal height).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c6743ebd3edd647fb160g-35}\n\nFinal Configuration for \\(n=12\\)\n\nAnother way to say this is\n\n\\[\np_{i}= \\begin{cases}c-i & \\text { if } i \\leq c-s \\\\ c-i+1 & \\text { if } i>c-s\n\\]\n\nTo prove this claim, we show that\n(a) At any stage of the process, \\(p_{1} \\geq p_{2} \\geq \\cdots\\)\n(b) At any stage, it is not possible for there to be \\(i<j\\) for which \\(p_{i}=p_{i+1}\\), \\(p_{j}=p_{j+1}>0\\), and \\(p_{i+1}-p_{j} \\leq j-i-1\\) (that is, the average decrease per column from column \\(i+1\\) to column \\(j\\) is 1 or less).\n(c) At any final configuration, \\(p_{i}-p_{i+1}=0\\) or 1 , with at most one \\(i\\) for which \\(p_{i}>0\\) and \\(p_{i}-p_{i+1}=0\\).\n\nIn the proofs of (a)-(c), we use the following terminology. Let a \\(k\\)-switch be the movement of one pebble from column \\(k\\) to column \\(k+1\\), and for any column \\(i\\) let a \\(d r o p\\) be the quantity \\(p_{i}-p_{i+1}\\).\n\nTo prove (a), suppose a sequence of valid moves resulted in \\(p_{i}<p_{i+1}\\) for the first time at some stage \\(j\\). Then the move leading to this stage must have been an \\(i\\)-switch, but it would be contrary to the condition that column \\(i\\) have at least 2 more pebbles than column \\(i+1\\), to allow switches.\n\nTo prove (b), if such a configuration were obtainable, there would be a minimum value of \\(j-i\\) over all such obtainable configurations, and we now show that there is no minimum. Suppose \\(p_{1}, p_{2}, \\ldots\\) was such a minimal configuration. It cannot be that \\(j=i+1\\), for what would columns \\(i, i+1, i+2\\) look like just before the move that made the heights equal? The move must have been a \\(k\\)-switch for \\(i-1 \\leq k \\leq i+2\\), but if so the configuration before the switch was impossible (not decreasing).\n\nNow suppose \\(j>i+1\\). Consider the first configuration \\(C\\) in the sequence for which columns \\(i, i+1, j, j+1\\) are at their final heights. Note that from \\(p_{i+1}\\) to \\(p_{j}\\) the columns decrease by exactly one each time in \\(C\\), because if there was a drop of 2 or more at some point, there would have to be another drop of 0 in this interval to obtain an average of 1 or less, and thus \\(j-i\\) is not minimal. The move leading to \\(C\\) was either an \\(i\\)-switch or a \\(j\\)-switch. If it was the former, at the previous stage columns \\(i+1\\) and \\(i+2\\) had the same height, violating the minimality of \\(j-i\\). A similar contradiction arises if the move was a \\(j\\)-switch.\n\nFinally, to prove (c), if any drop is 2 or more, the configuration isn't final. However, if all drops are 0 or 1 , and there were two drops of 0 between nonempty columns (say between \\(i\\) and \\(i+1\\) and between \\(j\\) and \\(j+1\\) ), then (b) would be violated. Thus a final configuration that satisfied (b) also satisfies (c).\n\nSolution of the Alternative Version. Same as above, except after display (1) insert:\n\nDirect calculation shows that \\(2001=t_{63}-15\\), so there are 63 nonempty columns and the final configuration is\n\n\\[\np_{i}= \\begin{cases}63-i & \\text { if } i \\leq 15 \\\\ 64-i & \\text { if } 16 \\leq i \\leq 63\n\\]\n\nSolution 2 of the First Version. At each stage, let \\(c\\) be the rightmost nonempty column. In conditions (a)-(c) in the previous solution, replace (b) by (b'), where\n(b') All configurations obtainable from the initial configuration satisfy\n\n\\[\np_{i}-p_{j} \\geq j-i-1 \\text { for all } i<j \\leq c+1\n\\]\n\n(The restriction to \\(j \\leq c+1\\), which causes certain complications, is necessary for (2) to be true.) Fact (c), and thus the answer, follows as easily from (b') as from (b). We prove ( \\(\\mathrm{b}^{\\prime}\\) ) by induction as follows.\n\nCondition (2) is immediate for the initial configuration: Since \\(c=1\\), the only case is \\(p_{1}-p_{2}=n>2-1-1\\). Now suppose some configuration \\(p_{1}, p_{2} \\ldots\\) with final nonempty column \\(c_{p}\\) satisfies (2), and a new configuration \\(q_{1}, q_{2} \\ldots\\) is obtained from it by a \\(k\\)-switch. Thus \\(q_{k}=p_{k}-1, q_{k+1}=p_{k+1}+1\\), and \\(q_{i}=p_{i}\\) for all other \\(i\\). Let the new configuration have \\(c_{q}\\) nonempty columns. Note that \\(c_{q}=c_{p}\\) unless \\(k=c_{p}-1\\).\n\nFor any \\(i<j \\leq c_{q}+1\\) we now show that \\(q_{i}-q_{j} \\geq j-i-1\\). The only cases to consider are those where \\(q_{i}-q_{j}<p_{i}-p_{j}\\), that is, those where \\(i=k\\) or \\(j=k+1\\); and those where \\(p_{i}-p_{j}\\) wasn't restricted, because \\(j\\) was greater than \\(c_{p}+1\\) (case 4 below). There are four such cases.\n\nCase 1. If \\((i, j)=(k, k+1)\\), then \\(q_{i}-q_{j} \\geq 0=j-i-1\\).\nCase 2. If \\(i=k\\) and \\(j>k+1\\), apply (2) to \\((i+1, j)\\) to obtain\n\n\\[\nq_{i}-q_{j} \\geq q_{i+1}-q_{j}=p_{i+1}-p_{j}+1 \\geq j-(i+1)-1+1=j-i-1\n\\]\n\nCase 3. If \\(j=k+1\\) and \\(i<k\\), then applying (2) to \\((i, j-1)\\),\n\n\\[\nq_{i}-q_{j} \\geq q_{i}-q_{j-1}=p_{i}-p_{j-1}+1 \\geq(j-1)-i-1+1=j-i-1\n\\]\n\nCase 4. We have \\(j=c_{p}+2=k+2, p_{k+1}=0\\) and \\(p_{k} \\geq 2\\). If \\(i=k\\) or \\(k+1\\), then \\(q_{i}-q_{j}=q_{i} \\geq 1 \\geq j-i-1\\). If \\(i<k\\), then\n\n\\[\nq_{i}-q_{j}=p_{i}-0 \\geq p_{i}-p_{k}+2 \\geq(i-k-1)+2=i-j-1\n\\]\n\nThis concludes the inductive step and ( \\(\\mathrm{b}^{\\prime}\\) ) is proved.\n\nProblem"}
{"id": "imo-shortlist-2001-c8", "question": "C8. Twenty-one girls and twenty-one boys took part in a mathematical competition. It turned out that\n(a) each contestant solved at most six problems, and\n(b) for each pair of a girl and a boy, there was at least one problem that was solved by both the girl and the boy.\n\nShow that there is a problem that was solved by at least three girls and at least three boys.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2001, "solution": "We introduce the following symbols: \\(G\\) is the set of girls at the competition and \\(B\\) is the set of boys, \\(P\\) is the set of problems, \\(P(g)\\) is the set of problems solved by \\(g \\in G\\), and \\(P(b)\\) is the set of problems solved by \\(b \\in B\\). Finally, \\(G(p)\\) is the set of girls that solve \\(p \\in P\\) and \\(B(p)\\) is the set of boys that solve \\(p\\). In terms of this notation, we have that for all \\(g \\in G\\) and \\(b \\in B\\),\n(a) \\(|P(g)| \\leq 6,|P(b)| \\leq 6\\),\n(b) \\(P(g) \\cap P(b) \\neq \\varnothing\\).\n\nWe wish to prove that some \\(p \\in P\\) satisfies \\(|G(p)| \\geq 3\\) and \\(|B(p)| \\geq 3\\). To do this, we shall assume the contrary and reach a contradiction by counting (two ways) all ordered triples ( \\(p, q, r\\) ) such that \\(p \\in P(g) \\cap P(b)\\). With \\(T=\\{(p, g, b): p \\in\\) \\(P(g) \\cap P(b)\\}\\), condition (b) yields\n\n\\[\n|T|=\\sum_{g \\in G} \\sum_{b \\in B}|P(g) \\cap P(b)| \\geq|G| \\cdot|B|=21^{2}\n\\]\n\nAssume that no \\(p \\in P\\) satisfies \\(|G(p)| \\geq 3\\) and \\(|B(p)| \\geq 3\\). We begin by noting that\n\n\\[\n\\sum_{p \\in P}|G(p)|=\\sum_{g \\in G}|P(g)| \\leq 6|G| \\quad \\text { and } \\quad \\sum_{p \\in P}|B(p)| \\leq 6|B| .\n\\]\n\n(Note. The equality in (2) is obtained by a standard double-counting technique: Let \\(\\chi(g, p)=1\\) if \\(g\\) solves \\(p\\) and \\(\\chi(g, p)=0\\) otherwise, and interchange the orders of\nsummation in \\(\\sum_{p \\in P} \\sum_{g \\in G} \\chi(g, p)\\).) Let\n\n\\[\n\\begin{aligned}\n& P_{+}=\\{p \\in P:|G(p)| \\geq 3\\} \n& P_{-}=\\{p \\in P:|G(p)| \\leq 2\\}\n\n\\]\n\nClaim. \\(\\sum_{p \\in P_{-}}|G(p)| \\geq|G| ;\\) thus \\(\\sum_{p \\in P_{+}}|G(p)| \\leq 5|G|\\). Also \\(\\sum_{p \\in P_{+}}|B(p)| \\geq|B| ;\\) thus \\(\\sum_{p \\in P_{-}}|B(b)| \\leq 5|B|\\).\n\nProof. Let \\(g \\in G\\) be arbitrary. By the Pigeonhole Principle, conditions (a) and (b) imply that \\(g\\) solves some problem \\(p\\) that is solved by at least \\(\\lceil 21 / 6\\rceil=4\\) boys. By assumption, \\(|B(p)| \\geq 4\\) implies that \\(p \\in P_{-}\\), so every girl solves at least one problem in \\(P_{-}\\). Thus\n\n\\[\n\\sum_{p \\in P_{-}}|G(p)| \\geq|G|\n\\]\n\nIn view of (2) and (3) we have\n\n\\[\n\\sum_{p \\in P_{+}}|G(p)|=\\sum_{p \\in P}|G(p)|-\\sum_{p \\in P_{-}}|G(p)| \\leq 5|G| .\n\\]\n\nAlso, each boy solves a problem that is solved by at least four girls, so each boy solves a problem \\(p \\in P_{+}\\). Thus \\(\\sum_{p \\in P_{+}}|B(p)| \\geq|B|\\), and the calculation proceeds as before using (2).\n\nUsing the claim just established, we find\n\n\\[\n\\begin{aligned}\n|T| & =\\sum_{p \\in P}|G(p)| \\cdot|B(p)| \n& =\\sum_{p \\in P_{+}}|G(p)| \\cdot|B(p)|+\\sum_{p \\in P_{-}}|G(p)| \\cdot|B(p)| \n& \\leq 2 \\sum_{p \\in P_{+}}|G(p)|+2 \\sum_{p \\in P_{-}}|B(p)| \n& \\leq 10|G|+10|B|=20 \\cdot 21\n\n\\]\n\nThis contradicts (1), so the proof is complete.\n\nSolution 2. Let us use some of the notation given in the first solution. Suppose that for every \\(p \\in P\\) either \\(|G(p)| \\leq 2\\) or \\(|B(p)| \\leq 2\\). For each \\(p \\in P\\), color \\(p\\) red if \\(|G(p)| \\leq 2\\) and otherwise color it black. In this way, if \\(p\\) is red then \\(|G(p)| \\leq 2\\) and if \\(p\\) is black then \\(|B(p)| \\leq 2\\). Consider a chessboard with 21 rows, each representing one of the girls, and 21 columns, each representing one of the boys. For each \\(g \\in G\\) and \\(b \\in B\\), color the square corresponding to \\((g, b)\\) as follows: pick \\(p \\in P(g) \\cap P(b)\\) and assign \\(p\\) 's color to that square. (By condition (b), there is always an available choice.) By the Pigeonhole Principle, one of the two colors is assigned to at least \\(\\lceil 441 / 2\\rceil=221\\) squares, and thus some row has at least \\(\\lceil 221 / 21\\rceil=11\\) black squares or some column has at least 11 red squares.\n\nSuppose the row corresponding to \\(g \\in G\\) has at least 11 black squares. Then for each of 11 squares, the black problem that was chosen in assigning the color was solved by at most 2 boys. Thus we account for at least \\(\\lceil 11 / 2\\rceil=6\\) distinct problems solved by \\(g\\). In view of condition (a), \\(g\\) solves only these problems. But then at most 12 boys solve a problem also solved by \\(g\\), in violation of condition (b).\n\nIn exactly the same way, a contradiction is reached if we suppose that some column has at least 11 red squares. Hence some \\(p \\in P\\) satisfies \\(|G(p)| \\geq 3\\) and \\(|B(p)| \\geq 3\\)."}
{"id": "imo-shortlist-2001-g1", "question": "G1. Let \\(A_{1}\\) be the center of the square inscribed in acute triangle \\(A B C\\) with two vertices of the square on side \\(B C\\). Thus one of the two remaining vertices of the square is on side \\(A B\\) and the other is on \\(A C\\). Points \\(B_{1}, C_{1}\\) are defined in a similar way for inscribed squares with two vertices on sides \\(A C\\) and \\(A B\\), respectively. Prove that lines \\(A A_{1}, B B_{1}, C C_{1}\\) are concurrent.", "category": "Geometry", "source": "IMO Shortlist", "year": 2001, "solution": "Let \\(\\alpha=\\angle C A B, \\beta=\\angle A B C\\), and \\(\\gamma=\\angle B C A\\) be the angles of triangle \\(A B C\\). Let the line through \\(A\\) and \\(A_{1}\\) meet side \\(B C\\) at \\(X\\). Similarly, let the line through \\(B\\) and \\(B_{1}\\) meet side \\(C A\\) at \\(Y\\), and the line through \\(C\\) and \\(C_{1}\\) meet side \\(A B\\) at \\(Z\\). By the converse of Ceva's Theorem, it suffices to prove that\n\n\\[\n\\frac{B X}{X C} \\frac{C Y}{Y A} \\frac{A Z}{Z B}=1\n\\]\n\nConsider first \\(B X / X C\\). Let the square with center \\(A_{1}\\) have side \\(s\\), vertices \\(P\\) and \\(Q\\) on sides \\(A B\\) and \\(A C\\), respectively, and vertices \\(S\\) and \\(T\\) on \\(B C\\) with \\(S\\) between \\(B\\) and \\(T\\). Since \\(A X\\) passes through the center of the square \\(Q P S T\\), if it cuts side \\(P Q\\) of the square into segments of length \\(u\\) and \\(v\\), then it cuts side \\(S T\\) into segments of length \\(v\\) and \\(u\\) as shown.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c6743ebd3edd647fb160g-42}\n\nWe then have\n\n\\[\n\\frac{B X}{X C}=\\frac{u}{v}=\\frac{B X+u}{X C+v}=\\frac{B T}{S C}=\\frac{B S+s}{T C+s}=\\frac{s \\cot \\beta+s}{s \\cot \\gamma+s}=\\frac{\\cot \\beta+1}{\\cot \\gamma+1} .\n\\]\n\nSimilarly,\n\n\\[\n\\frac{C Y}{Y A}=\\frac{\\cot \\gamma+1}{\\cot \\alpha+1} \\quad \\text { and } \\quad \\frac{A Z}{Z B}=\\frac{\\cot \\alpha+1}{\\cot \\beta+1} .\n\\]\n\nHence\n\n\\[\n\\frac{B X}{X C} \\frac{C Y}{Y A} \\frac{A Z}{Z B}=1,\n\\]\n\ncompleting the proof.\n\nProblem"}
{"id": "imo-shortlist-2001-g2", "question": "G2. In acute triangle \\(A B C\\) with circumcenter \\(O\\) and altitude \\(A P, \\angle C \\geq\\) \\(\\angle B+30^{\\circ}\\). Prove that \\(\\angle A+\\angle C O P<90^{\\circ}\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2001, "solution": "Let \\(\\alpha=\\angle C A B, \\beta=\\angle A B C, \\gamma=\\angle B C A\\), and \\(\\delta=\\angle C O P\\). Let \\(K\\) and \\(Q\\) be the reflections of \\(A\\) and \\(P\\), respectively, across the perpendicular bisector of \\(B C\\). Let \\(R\\) denote the circumradius of \\(\\triangle A B C\\). Then \\(O A=O B=O C=O K=R\\). Furthermore, we have \\(Q P=K A\\) because \\(K Q P A\\) is a rectangle. Now note that \\(\\angle A O K=\\angle A O B-\\angle K O B=\\angle A O B-\\angle A O C=2 \\gamma-2 \\beta \\geq 60^{\\circ}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c6743ebd3edd647fb160g-43}\n\nIt follows from this and from \\(O A=O K=R\\) that \\(K A \\geq R\\) and \\(Q P \\geq R\\). Therefore, using the Triangle Inequality, we have \\(O P+R=O Q+O C>Q C=Q P+P C \\geq\\) \\(R+P C\\). It follows that \\(O P>P C\\), and hence in \\(\\triangle C O P, \\angle P C O>\\delta\\). Now since \\(\\alpha=\\frac{1}{2} \\angle B O C=\\frac{1}{2}\\left(180^{\\circ}-2 \\angle P C O\\right)=90^{\\circ}-\\angle P C O\\), it indeed follows that \\(\\alpha+\\delta<90^{\\circ}\\).\n\nSolution 2. As in the previous solution, it is enough to show that \\(O P>P C\\). To this end, recall that by the (Extended) Law of Sines, \\(A B=2 R \\sin \\gamma\\) and \\(A C=2 R \\sin \\beta\\). Therefore, we have\n\n\\[\nB P-P C=A B \\cos \\beta-A C \\cos \\gamma=2 R(\\sin \\gamma \\cos \\beta-\\sin \\beta \\cos \\gamma)=2 R \\sin (\\gamma-\\beta)\n\\]\n\nIt follows from this and from\n\n\\[\n30^{\\circ} \\leq \\gamma-\\beta<\\gamma<90^{\\circ}\n\\]\n\nthat \\(B P-P C \\geq R\\). Therefore, we obtain that \\(R+O P=B O+O P>B P \\geq R+P C\\), from which \\(O P>O C\\), as desired.\n\nSolution 3. We first show that \\(R^{2}>C P \\cdot C B\\). To this end, since \\(C B=2 R \\sin \\alpha\\) and \\(C P=A C \\cos \\gamma=2 R \\sin \\beta \\cos \\gamma\\), it suffices to show that \\(\\frac{1}{4}>\\sin \\alpha \\sin \\beta \\cos \\gamma\\). We note that \\(1>\\sin \\alpha=\\sin (\\gamma+\\beta)=\\sin \\gamma \\cos \\beta+\\sin \\beta \\cos \\gamma\\) and \\(\\frac{1}{2} \\leq \\sin (\\gamma-\\beta)=\\) \\(\\sin \\gamma \\cos \\beta-\\sin \\beta \\cos \\gamma\\) since \\(30^{\\circ} \\leq \\gamma-\\beta<90^{\\circ}\\). It follows that \\(\\frac{1}{4}>\\sin \\beta \\cos \\gamma\\) and that \\(\\frac{1}{4}>\\sin \\alpha \\sin \\beta \\cos \\gamma\\).\n\nNow we choose a point \\(J\\) on \\(B C\\) so that \\(C J \\cdot C P=R^{2}\\). It follows from this and from \\(R^{2}>C P \\cdot C B\\) that \\(C J>C B\\), so that \\(\\angle O B C>\\angle O J C\\). Since \\(O C / C J=\\) \\(P C / C O\\) and \\(\\angle J C O=\\angle O C P\\), we have \\(\\triangle J C O \\cong \\triangle O C P\\) and \\(\\angle O J C=\\angle P O C=\\delta\\). It follows that \\(\\delta<\\angle O B C=90^{\\circ}-\\alpha\\) or \\(\\alpha+\\delta<90^{\\circ}\\).\n\nSolution 4. On the one hand, as in the third solution, we have \\(R^{2}>C P \\cdot C B\\). On the other hand, the power of \\(P\\) with respect to the circumcircle of \\(\\triangle A B C\\) is \\(B P \\cdot P C=R^{2}-O P^{2}\\). From these two equations we find that\n\n\\[\nO P^{2}=R^{2}-B P \\cdot P C>P C \\cdot C B-B P \\cdot P C=P C^{2},\n\\]\n\nfrom which \\(O P>P C\\). Therefore, as in the first solution, we conclude that \\(\\alpha+\\delta<\\) \\(90^{\\circ}\\).\n\nProblem"}
{"id": "imo-shortlist-2001-g3", "question": "G3. Let \\(A B C\\) be a triangle with centroid \\(G\\). Determine, with proof, the position of the point \\(P\\) in the plane of \\(A B C\\) such that \\(A P \\cdot A G+B P \\cdot B G+C P \\cdot C G\\) is a minimum, and express this minimum value in terms of the side lengths of \\(A B C\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2001, "solution": "As usual, let \\(a, b, c\\) denote the sides of the triangle facing the vertices \\(A, B, C\\), respectively. We will show that the desired minimum value of \\(A P \\cdot A G+\\) \\(B P \\cdot B G+C P \\cdot C G\\) is attained when \\(P\\) is the centroid \\(G\\), and that the minimum value is\n\n\\[\n\\begin{aligned}\nA G^{2}+B G^{2}+C G^{2} & =\\frac{1}{9}\\left\\{\\left(2 b^{2}+2 c^{2}-a^{2}\\right)+\\left(2 c^{2}+2 a^{2}-b^{2}\\right)+\\left(2 c^{2}+2 a^{2}-b^{2}\\right)\\right\\} \n& =\\frac{a^{2}+b^{2}+c^{2}}{3}\n\n\\]\n\nThe latter follows by using Stewart's Theorem to compute the lengths of the medians \\(A L, B M, C N\\), along with the relations \\(A G=\\frac{2}{3} A L, B G=\\frac{2}{3} B M, C G=\\frac{2}{3} C N\\).\n\nLet \\(\\mathcal{S}\\) be the circle passing through \\(B, G\\), and \\(C\\). The median \\(A L\\) meets \\(\\mathcal{S}\\) at \\(G\\) and \\(K\\). Let \\(\\theta, \\phi, \\chi\\) be the angle measures as shown.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c6743ebd3edd647fb160g-45}\n\nBy the Law of Sines, we find\n\n\\[\n\\frac{B G}{C G}=\\frac{\\sin \\varphi}{\\sin \\theta} \\quad \\text { and } \\quad \\frac{A G}{B G}=\\frac{\\sin \\chi}{\\sin \\varphi}\n\\]\n\nAlso \\(B K=2 R \\sin \\theta, C K=2 R \\sin \\varphi, B C=2 R \\sin \\chi\\), where \\(R\\) is the radius of \\(\\mathcal{S}\\). Hence\n\n\\[\n\\frac{C G}{B K}=\\frac{B G}{C K}=\\frac{A G}{B C}\n\\]\n\nLet \\(P\\) be any point in the plane of \\(A B C\\). By Ptolemy's Theorem,\n\n\\[\nP K \\cdot B C \\leq B P \\cdot C K+B K \\cdot C P\n\\]\n\nwith equality if and only if \\(P\\) lies on \\(\\mathcal{S}\\). In view of (*), we have\n\n\\[\nP K \\cdot A G \\leq B P \\cdot B G+C G \\cdot C P .\n\\]\n\nAddition of \\(A P \\cdot A G\\) to both sides gives\n\n\\[\n(A P+P K) \\cdot A G \\leq A P \\cdot A G+B P \\cdot B G+C P \\cdot C G .\n\\]\n\nSince \\(A K \\leq A P+A K\\) by the Triangle Inequality, we have\n\n\\[\nA K \\cdot A G \\leq A P \\cdot A G+B P \\cdot B G+C P \\cdot C G .\n\\]\n\nEquality holds if and only if \\(P\\) lies on the segment \\(A K\\) and \\(P\\) lies on \\(\\mathcal{S}\\) as well. Hence equality holds if and only if \\(P=G\\).\n\nProblem"}
{"id": "imo-shortlist-2001-g4", "question": "G4. Let \\(M\\) be a point in the interior of triangle \\(A B C\\). Let \\(A^{\\prime}\\) lie on \\(B C\\) with \\(M A^{\\prime}\\) perpendicular to \\(B C\\). Define \\(B^{\\prime}\\) on \\(C A\\) and \\(C^{\\prime}\\) on \\(A B\\) similarly. Define\n\n\\[\np(M)=\\frac{M A^{\\prime} \\cdot M B^{\\prime} \\cdot M C^{\\prime}}{M A \\cdot M B \\cdot M C}\n\\]\n\nDetermine, with proof, the location of \\(M\\) such that \\(p(M)\\) is maximal. Let \\(\\mu(A B C)\\) denote this maximum value. For which triangles \\(A B C\\) is the value of \\(\\mu(A B C)\\) maximal?", "category": "Geometry", "source": "IMO Shortlist", "year": 2001, "solution": "Let \\(\\alpha, \\beta, \\gamma\\) denote the angles \\(A, B, C\\) respectively. Also let\n\n\\[\n\\begin{aligned}\n\\alpha_{1} & =\\angle M A B, & & \\alpha_{2}=\\angle M A C, \n\\beta_{1} & =\\angle M B C, & & \\beta_{2}=\\angle M B A, \n\\gamma_{1} & =\\angle M C A, & & \\gamma_{2}=\\angle M C B .\n\n\\]\n\nWe have\n\n\\[\n\\frac{M B^{\\prime} \\cdot M C^{\\prime}}{(M A)^{2}}=\\sin \\alpha_{1} \\sin \\alpha_{2}, \\quad \\frac{M B^{\\prime} \\cdot M A^{\\prime}}{(M C)^{2}}=\\sin \\gamma_{1} \\sin \\gamma_{2}, \\quad \\frac{M A^{\\prime} \\cdot M C^{\\prime}}{(M B)^{2}}=\\sin \\beta_{1} \\sin \\beta_{2}\n\\]\n\nso that \\(p(M)^{2}=\\sin \\alpha_{1} \\sin \\alpha_{2} \\sin \\beta_{1} \\sin \\beta_{2} \\sin \\gamma_{1} \\sin \\gamma_{2}\\). Observe that\n\n\\[\n\\sin \\alpha_{1} \\sin \\alpha_{2}=\\frac{1}{2}\\left(\\cos \\left(\\alpha_{1}-\\alpha_{2}\\right)-\\cos \\left(\\alpha_{1}+\\alpha_{2}\\right)\\right) \\leq \\frac{1}{2}(1-\\cos \\alpha)=\\sin ^{2} \\frac{\\alpha}{2}\n\\]\n\nLikewise,\n\n\\[\n\\sin \\beta_{1} \\sin \\beta_{2} \\leq \\sin ^{2} \\frac{\\beta}{2} \\quad \\text { and } \\quad \\sin \\gamma_{1} \\sin \\gamma_{2} \\leq \\sin ^{2} \\frac{\\gamma}{2}\n\\]\n\nTherefore\n\n\\[\np(M) \\leq \\sin \\frac{\\alpha}{2} \\sin \\frac{\\beta}{2} \\sin \\frac{\\gamma}{2}\n\\]\n\nClearly, equality is achieved in (1) and (2) if and only if \\(\\alpha_{1}=\\alpha_{2}, \\beta_{1}=\\beta_{2}, \\gamma_{1}=\\gamma_{2}\\); in other words, \\(p(M)\\) achieves its maximum value when \\(M\\) is the center of the inscribed circle of triangle \\(A B C\\) and this maximum value is\n\n\\[\n\\mu(A B C)=\\sin \\frac{\\alpha}{2} \\sin \\frac{\\beta}{2} \\sin \\frac{\\gamma}{2}\n\\]\n\nIt is well known that this quantity is maximal when the triangle is equilateral. This can be proven in many ways; for example, using Jensen's inequality. A more elementary proof uses the first equality of (1) to deduce that if \\(x, y \\geq 0\\) and \\(x+y \\leq \\pi / 2\\) is fixed, the value of \\(\\sin x \\sin y\\) will increase as the difference \\(|x-y|\\) decreases. Thus, if \\(x+y+z=\\pi / 2\\), the value of \\(\\sin x \\sin y \\sin z\\) can be increased if any of the \\(x, y, z\\) are not equal to \\(\\pi / 6\\). (For example, if \\(x<\\pi / 6\\) and \\(z>\\pi / 6\\) and \\(x\\) is closer to \\(\\pi / 6\\) than \\(z\\) is, replace \\(x\\) by \\(x^{\\prime}=\\pi / 6\\) and \\(z\\) by \\(z^{\\prime}=z-\\pi / 6+x\\). The sum \\(x^{\\prime}+y+z^{\\prime}\\) remains unchanged, but the product \\(\\sin x^{\\prime} \\sin y \\sin z^{\\prime}\\) increases.)\n\nComment. The Jury may wish to consider an alternative version of this problem, which asks only the first of the two questions (i.e., only asks for the location of \\(M)\\). This would avoid a situation in which some students laboriously prove that \\(\\sin x \\sin y \\sin z\\) is maximized when \\(x=y=z\\), while others use Jensen's inequality, and still others merely state, as the proposer did, that the result is well known.\n\nProblem"}
{"id": "imo-shortlist-2001-g5", "question": "G5. Let \\(A B C\\) be an acute triangle. Let \\(D A C, E A B\\), and \\(F B C\\) be isosceles triangles exterior to \\(A B C\\), with \\(D A=D C, E A=E B\\), and \\(F B=F C\\), such that\n\n\\[\n\\angle A D C=2 \\angle B A C, \\quad \\angle B E A=2 \\angle A B C, \\quad \\angle C F B=2 \\angle A C B .\n\\]\n\nLet \\(D^{\\prime}\\) be the intersection of lines \\(D B\\) and \\(E F\\), let \\(E^{\\prime}\\) be the intersection of \\(E C\\) and \\(D F\\), and let \\(F^{\\prime}\\) be the intersection of \\(F A\\) and \\(D E\\). Find, with proof, the value of the sum\n\n\\[\n\\frac{D B}{D D^{\\prime}}+\\frac{E C}{E E^{\\prime}}+\\frac{F A}{F F^{\\prime}}\n\\]", "category": "Geometry", "source": "IMO Shortlist", "year": 2001, "solution": "Note that \\(\\angle A D C, \\angle B E A, \\angle C F B<\\pi\\) since \\(A B C\\) is an acute triangle. Also,\n\n\\[\n\\angle D A C=\\frac{\\pi}{2}-\\frac{1}{2} \\angle A D C=\\frac{\\pi}{2}-\\angle B A C\n\\]\n\nand\n\n\\[\n\\angle B A E=\\frac{\\pi}{2}-\\frac{1}{2} \\angle B E A=\\frac{\\pi}{2}-\\angle A B C .\n\\]\n\nHence\n\n\\[\n\\angle D A E=\\angle D A C+\\angle B A C+\\angle B A E=\\pi-\\angle A B C<\\pi .\n\\]\n\nLikewise,\n\n\\[\n\\angle E B F<\\pi \\quad \\text { and } \\quad \\angle F C D<\\pi .\n\\]\n\nThus the polygon \\(D A E B F C\\) is convex and\n\n\\[\n\\angle A D C+\\angle B E A+\\angle C F B=2(\\angle B A C+\\angle A B C+\\angle A C B)=2 \\pi .\n\\]\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2025_05_30_c6743ebd3edd647fb160g-50}\n\n\nLet \\(\\omega_{1}, \\omega_{2}, \\omega_{3}\\) be circles with centers at \\(D, E, F\\), respectively, and radii \\(D A, E B, F C\\), respectively. Using \\(\\angle A D C+\\angle B E A+\\angle C F B=2 \\pi\\), it is easy to see by the Inscribed Angle Theorem that these three circles are concurrent; let \\(O\\) be the common point. Then \\(O\\) is the reflection of \\(C\\) with respect to \\(D F\\). Likewise, \\(O\\) is also the reflection of \\(A\\) with respect to \\(D E\\) and the reflection of \\(B\\) with respect to \\(E F\\). Let \\([X Y Z]\\) denote the area of triangle \\(X Y Z\\). We have\n\n\\[\n\\frac{D B}{D D^{\\prime}}=\\frac{D D^{\\prime}+D^{\\prime} B}{D D^{\\prime}}=1+\\frac{D^{\\prime} B}{D D^{\\prime}}=1+\\frac{[E B F]}{[D E F]}=1+\\frac{[O E F]}{[D E F]} .\n\\]\n\nLikewise,\n\n\\[\n\\frac{E C}{E E^{\\prime}}=1+\\frac{[O D F]}{[D E F]} \\quad \\text { and } \\quad \\frac{F A}{F F^{\\prime}}=1+\\frac{[O D E]}{[D E F]} .\n\\]\n\nThus\n\n\\[\n\\frac{D B}{D D^{\\prime}}+\\frac{E C}{E E^{\\prime}}+\\frac{F A}{F F^{\\prime}}=3+\\frac{[O E F]+[O D F]+[O D E]}{[D E F]}=4 .\n\\]\n\nProblem"}
{"id": "imo-shortlist-2001-g6", "question": "G6. Let \\(A B C\\) be a triangle and \\(P\\) an exterior point in the plane of the triangle. Suppose \\(A P, B P, C P\\) meet the sides \\(B C, C A, A B\\) (or extensions thereof) in \\(D, E, F\\), respectively. Suppose further that the areas of triangles \\(P B D, P C E, P A F\\) are all equal. Prove that each of these areas is equal to the area of triangle \\(A B C\\) itself.", "category": "Geometry", "source": "IMO Shortlist", "year": 2001, "solution": "Let \\(D, E\\), and \\(F\\) divide the sides \\(B C, C A\\), and \\(A B\\) in the signed ratios \\(z / y, x / z\\), and \\(y / x\\), respectively. Since \\(A D, B E\\), and \\(C F\\) are concurrent (at \\(P\\) ), by Ceva's Theorem we may choose the ratios in this manner. Let us assume that \\([A B C]=1\\), where \\([U V W]\\) denotes the signed area of \\(\\triangle U V W\\). Note that for \\(P\\) to lie outside the triangle at least one of \\(x, y, z\\) must be positive and at least one must be negative. Also,\n\n\\[\n\\frac{[P B C]}{x}=\\frac{[P C A]}{y}=\\frac{[P A B]}{z}=\\frac{[A B C]}{x+y+z} .\n\\]\n\nNow\n\n\\[\n[P B D]=\\frac{[P B D]}{[P B C]} \\frac{[P B C]}{[A B C]}[A B C]=\\frac{z}{y+z} \\frac{x}{x+y+z}=\\frac{z x}{(y+z)(x+y+z)}\n\\]\n\nSimilarly,\n\n\\[\n[P C E]=\\frac{x y}{(z+x)(x+y+z)} \\quad \\text { and } \\quad[P A F]=\\frac{y z}{(x+y)(x+y+z)}\n\\]\n\nSince these three areas are equal, we have \\(y(y+z)=z(z+x)=x(x+y)\\). We may assume at this stage that \\(z=1\\). This yields\n\n\\[\ny(y+1)=1+x=x(x+y)\n\\]\n\nSo \\(x=y^{2}+y-1\\) from the first equation, and hence we have \\(\\left(y^{2}+y-1\\right)^{2}+\\left(y^{2}+y-1\\right) y=\\) \\(y^{2}+y\\). Simplification gives \\(y^{4}+3 y^{3}-y^{2}-4 y+1=0\\), which can be factored as\n\n\\[\n(y-1)\\left(y^{3}+4 y^{2}+3 y-1\\right)=0\n\\]\n\nIf \\(y=1\\), then we have \\(x=1\\), implying that \\(P\\) coincides with the centroid of \\(\\triangle A B C\\), contradicting the hypothesis that \\(P\\) lies outside the triangle.\n\nTherefore,\n\n\\[\ny^{3}+4 y^{2}+3 y-1=0 .\n\\]\n\nUsing this fact, it follows that\n\n\\[\n\\begin{aligned}\n& {[P B D]=\\frac{z x}{(y+z)(x+y+z)}=\\frac{x}{(1+y)(x+y+1)}} \n& \\quad=\\frac{y^{2}+y-1}{(y+1)\\left(y^{2}+2 y\\right)}=\\frac{y^{2}+y-1}{y^{3}+3 y^{2}+2 y}=\\frac{y^{2}+y-1}{-y^{2}-y+1}=-1 \n& {[P C E]=\\frac{x y}{(z+x)(x+y+z)}=\\frac{x y}{(x+1)(x+y+1)}} \n& \\quad=\\frac{\\left(y^{2}+y-1\\right) y}{\\left(y^{2}+y\\right)\\left(y^{2}+2 y\\right)}=\\frac{y^{2}+y-1}{y^{3}+3 y^{2}+2 y}=-1 \n& {[P A F]=\\frac{y z}{(x+y)(x+y+z)}=\\frac{y}{(x+y)(x+y+1)}} \n& \\quad=\\frac{y}{\\left(y^{2}+2 y-1\\right)\\left(y^{2}+2 y\\right)}=\\frac{1}{y^{3}+4 y^{2}+3 y-2}=\\frac{1}{-1}=-1\n\n\\]\n\nThese calculations also imply that not both \\(x\\) and \\(y\\) are positive. Hence \\(P\\) lies outside \\(\\triangle A B C\\). Moreover, \\([P B D]=[P C E]=[P A F]=-1=-[A B C]\\). Hence, the desired result. The negative sign only indicates that triangles \\(P B D, P C E\\), and \\(P A F\\) are oriented opposite to \\(\\triangle A B C\\).\n\nComment. Since the equation \\(y^{3}+4 y^{2}+3 y-1=0\\) can be solved to get three real roots in terms of \\(\\cos \\frac{2 \\pi}{7}, \\cos \\frac{4 \\pi}{7}\\), and \\(\\cos \\frac{6 \\pi}{7}\\), we see that there are three real positions of \\(P\\) lying outside \\(\\triangle A B C\\).\n\nSolution 2. Let \\(P\\) be a point outside \\(\\triangle A B C\\) as shown in the diagram, and let \\(D, E\\), and \\(F\\) be the points at which \\(P A, P B\\), and \\(P C\\) meet the sides \\(B C, C A\\), and \\(A B\\), respectively. Let \\([B P D]=[C P E]=[A P F]=x,[A B E]=u,[P A E]=v\\), and \\([B C E]=w\\), so that \\([B A D]=x-u-v\\). We wish to prove that \\(x=[A B C]=u+w\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c6743ebd3edd647fb160g-53}\n\nNow, each of the ratios, \\(B D / D C, C E / E A\\), and \\(A F / F B\\) can be computed in two ways, yielding the following equations:\n\n\\[\n\\begin{gathered}\n\\frac{x-u-v}{x-v+w}=\\frac{x}{2 x+w} \n\\frac{x}{v}=\\frac{w}{u} \n\\frac{x}{x+u+v}=\\frac{2 x+v}{2 x+u+v+w}\n\n\\]\n\nEquation (1) gives \\(\\frac{x}{2 x+w}=\\frac{u+v}{x+v}\\). Simplifying and substituting for \\(v\\) from (2), we obtain\n\n\\[\nx^{2}(w-u)=u w(3 x+w)\n\\]\n\nAgain, simplifying (3) and using (2), we get\n\n\\[\nx=\\frac{w\\left(w^{2}-u w-u^{2}\\right)}{u(2 w+u)}\n\\]\n\nEliminating \\(x\\) from the last two equations, we finally obtain\n\n\\[\n(w-u)(w+u)\\left(w^{3}-3 u w^{2}-4 u^{2} w-u^{3}\\right)=0\n\\]\n\nBut \\(w=u\\) gives \\(v=x\\) (from (2)). So (3) gives \\(\\frac{x}{2 x+u}=\\frac{3 x}{3 x+2 u}\\); i.e., \\(2 x+u=x+\\frac{2 u}{3}\\), which is false since the left side of this is larger than its right side. Clearly, we can also rule out \\(w+u=0\\). Hence, \\(w^{3}-3 u w^{2}-4 u^{2} w-u^{3}=0\\), yielding\n\n\\[\nw^{3}=u(3 w+u)(w+u)\n\\]\n\nFinally, we have\n\n\\[\n\\begin{aligned}\nx & =\\frac{w^{3}-u w^{2}-u^{2} w}{2 u w+u^{2}}=\\frac{u(3 w+u)(w+u)-u w(u+w)}{u(2 w+u)} \n& =\\frac{u(u+w)(2 w+u)}{u(2 w+u)}=u+w,\n\n\\]\n\nas desired.\n\nProblem"}
{"id": "imo-shortlist-2001-g7", "question": "G7. Let \\(O\\) be an interior point of acute triangle \\(A B C\\). Let \\(A_{1}\\) lie on \\(B C\\) with \\(O A_{1}\\) perpendicular to \\(B C\\). Define \\(B_{1}\\) on \\(C A\\) and \\(C_{1}\\) on \\(A B\\) similarly. Prove that \\(O\\) is the circumcenter of \\(A B C\\) if and only if the perimeter of \\(A_{1} B_{1} C_{1}\\) is not less than any one of the perimeters of \\(A B_{1} C_{1}, B C_{1} A_{1}\\), and \\(C A_{1} B_{1}\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2001, "solution": "If \\(O\\) is the circumcenter of \\(\\triangle A B C\\), then \\(A_{1}, B_{1}\\), and \\(C_{1}\\) are the midpoints of \\(B C, C A\\), and \\(A B\\), respectively, and hence \\(P_{A_{1} B_{1} C_{1}}=P_{A B_{1} C_{1}}=P_{B C_{1} A_{1}}=P_{C A_{1} B_{1}}\\), where \\(P_{X Y Z}\\) denotes the perimeter of \\(\\triangle X Y Z\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c6743ebd3edd647fb160g-55}\n\nConversely, suppose that \\(P_{A_{1} B_{1} C_{1}} \\geq P_{A B_{1} C_{1}}, P_{B C_{1} A_{1}}, P_{C A_{1} B_{1}}\\). Let\n\n\\[\n\\begin{array}{lll}\n\\angle C A B=\\alpha, & \\angle C A_{1} B_{1}=\\alpha_{1}, & \\angle B A_{1} C_{1}=\\alpha_{2}, \n\\angle A B C=\\beta, & \\angle A B_{1} C_{1}=\\beta_{1}, & \\angle C B_{1} A_{1}=\\beta_{2}, \n\\angle B C A=\\gamma, & \\angle B C_{1} A_{1}=\\gamma_{1}, & \\angle A C_{1} B_{1}=\\gamma_{2} .\n\n\\]\n\nLet \\(A_{2}\\) be the point of intersection of the lines through \\(B_{1}\\) and \\(C_{1}\\), which are parallel to \\(A B\\) and \\(A C\\), respectively, as shown in the figure above. Assume that \\(\\gamma_{1} \\geq \\alpha\\)\nand \\(\\beta_{2} \\geq \\alpha\\). If one of these inequalities is strict, then \\(A_{1}\\) is an interior point of \\(\\triangle B_{1} C_{1} A_{2}\\). Hence \\(P_{A_{1} B_{1} C_{1}}<P_{A_{2} B_{1} C_{1}}=P_{A B_{1} C_{1}}\\), which is a contradiction. If \\(\\gamma_{1}=\\alpha\\) and \\(\\beta_{2}=\\alpha\\), then \\(A_{1}=A_{2}\\) and therefore \\(B_{1} O \\perp A_{1} C_{1}\\) and \\(C_{1} O \\perp A_{1} B_{1}\\). Hence \\(O\\) is the orthocenter (intersection of the altitudes) of \\(\\triangle A_{1} B_{1} C_{1}\\), and thus \\(O A_{1} \\perp B_{1} C_{1}\\). Hence \\(B_{1} C_{1} \\| B C\\). This implies that \\(A_{1}, B_{1}\\), and \\(C_{1}\\) are the midpoints of \\(B C, C A\\), and \\(A B\\), respectively; i.e., triangles \\(A B_{1} C_{1}, A_{1} B_{1} C_{1}, A_{1} B_{1} C\\), and \\(A_{1} B C_{1}\\) are congruent. Hence, \\(O\\) is the circumcenter of \\(\\triangle A B C\\). Analogously, the same conclusion holds if \\(\\alpha_{1} \\geq \\beta\\) and \\(\\gamma_{2} \\geq \\beta\\), or \\(\\beta_{1} \\geq \\gamma\\) and \\(\\alpha_{2} \\geq \\gamma\\).\n\nSuppose now that none of these cases are satisfied; i.e., it is not true that\n\n\\[\n\\gamma_{1} \\geq \\alpha \\quad \\text { and } \\quad \\beta_{2} \\geq \\alpha,\n\\]\n\nor\n\n\\[\n\\alpha_{1} \\geq \\beta \\quad \\text { and } \\quad \\gamma_{2} \\geq \\beta,\n\\]\n\nor\n\n\\[\n\\beta_{1} \\geq \\gamma \\quad \\text { and } \\quad \\alpha_{2} \\geq \\gamma .\n\\]\n\nSuppose without loss of generality that \\(\\gamma_{1}<\\alpha\\). Then \\(\\alpha_{2}>\\gamma\\), since \\(\\gamma_{1}+\\alpha_{2}=\\pi-\\beta=\\) \\(\\alpha+\\gamma\\). Hence \\(\\beta_{1}<\\gamma\\), which implies that \\(\\gamma_{2}>\\beta\\). Hence \\(\\alpha_{1}<\\beta\\), implying that \\(\\beta_{2}>\\alpha\\). In conclusion,\n\n\\[\n\\gamma_{1}<\\alpha<\\beta_{2}, \\quad \\alpha_{1}<\\beta<\\gamma_{2}, \\quad \\text { and } \\quad \\beta_{1}<\\gamma<\\alpha_{2} .\n\\]\n\nSince \\(A C_{1} O B_{1}\\) and \\(A_{1} C B_{1} O\\) are cyclic, we have \\(\\angle A O B_{1}=\\gamma_{2}\\) and \\(\\angle C O B_{1}=\\alpha_{1}\\). Hence, \\(A O=O B_{1} / \\cos \\gamma_{2}>O B_{1} / \\cos \\alpha_{1}=C O\\). In the same way, the inequalities \\(\\gamma_{1}<\\beta_{2}\\) and \\(\\beta_{1}<\\alpha_{2}\\) imply that \\(C O>B O\\) and \\(B O>A O\\), a contradiction.\n\nComment. The same arguments show that \\(O\\) is the circumcenter of \\(\\triangle A B C\\) if and only if \\(P_{A_{1} B_{1} C_{1}} \\leq P_{A B_{1} C_{1}}, P_{B C_{1} A_{1}}, P_{C A_{1} B_{1}}\\).\n\nProblem"}
{"id": "imo-shortlist-2001-g8", "question": "G8. Let \\(A B C\\) be a triangle with \\(\\angle B A C=60^{\\circ}\\). Let \\(A P\\) bisect \\(\\angle B A C\\) and let \\(B Q\\) bisect \\(\\angle A B C\\), with \\(P\\) on \\(B C\\) and \\(Q\\) on \\(A C\\). If \\(A B+B P=A Q+Q B\\), what are the angles of the triangle?", "category": "Geometry", "source": "IMO Shortlist", "year": 2001, "solution": "Denote the angles of \\(A B C\\) by \\(\\alpha=60^{\\circ}, \\beta\\), and \\(\\gamma\\). Extend \\(A B\\) to \\(P^{\\prime}\\) so that \\(B P^{\\prime}=B P\\), and construct \\(P^{\\prime \\prime}\\) on \\(A Q\\) so that \\(A P^{\\prime \\prime}=A P^{\\prime}\\). Then \\(B P^{\\prime} P\\) is an isosceles triangle with base angle \\(\\beta / 2\\). Since \\(A Q+Q P^{\\prime \\prime}=A B+B P^{\\prime}=A B+B P=A Q+Q B\\), it follows that \\(Q P^{\\prime \\prime}=Q B\\). Since \\(A P^{\\prime} P^{\\prime \\prime}\\) is equilateral and \\(A P\\) bisects the angle at \\(A\\), we have \\(P P^{\\prime}=P P^{\\prime \\prime}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c6743ebd3edd647fb160g-57}\n\nClaim. Points \\(B, P, P^{\\prime \\prime}\\) are collinear, so \\(P^{\\prime \\prime}\\) coincides with \\(C\\).\n\nProof. Suppose to the contrary that \\(B P P^{\\prime \\prime}\\) is a nondegenerate triangle. We have that \\(\\angle P B Q=\\angle P P^{\\prime} B=\\angle P P^{\\prime \\prime} Q=\\beta / 2\\). Thus the diagram appears as below, or else with \\(P\\) is on the other side of \\(B P^{\\prime \\prime}\\). In either case, the assumption that \\(B P P^{\\prime \\prime}\\) is nondegenerate leads to \\(B P=P P^{\\prime \\prime}=P P^{\\prime}\\), thus to the conclusion that \\(B P P^{\\prime}\\) is equilateral, and finally to the absurdity \\(\\beta / 2=60^{\\circ}\\) so \\(\\alpha+\\beta=60^{\\circ}+120^{\\circ}=180^{\\circ}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c6743ebd3edd647fb160g-58}\n\nThus points \\(B, P, P^{\\prime \\prime}\\) are collinear, and \\(P^{\\prime \\prime}=C\\) as claimed.\n\nSince triangle \\(B C Q\\) is isosceles, we have \\(120^{\\circ}-\\beta=\\gamma=\\beta / 2\\), so \\(\\beta=80\\) and \\(\\gamma=40^{\\circ}\\).\nThus \\(A B C\\) is a 60-80-40 degree triangle."}
{"id": "imo-shortlist-2001-n1", "question": "N1. Prove that there is no positive integer \\(n\\) such that, for \\(k=1,2, \\ldots, 9\\), the leftmost digit (in decimal notation) of \\((n+k)\\) ! equals \\(k\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2001, "solution": "For each positive integer \\(m\\), define\n\n\\[\nN(m)=\\frac{m}{10^{d(m)-1}}\n\\]\n\nwhere \\(d(m)\\) is the number of digits in \\(m\\). Note that \\(1 \\leq N(m)<10\\). In addition, it is not hard to show that\n\n\\[\nN(l m) \\leq N(l) N(m)\n\\]\n\nfor positive integers \\(l\\) and \\(m\\).\nAssume now that \\(n\\) is a positive integer such that for \\(k=1,2, \\ldots, 9\\), the leftmost digit of \\((n+k)!\\) is \\(k\\). If \\(2 \\leq k \\leq 9\\), then \\((n+k)!=a \\times 10^{r}\\) for some nonnegative integer \\(r\\) and some real number \\(a\\) with \\(k<a<k+1\\), and \\((n+k-1)!=b \\times 10^{s}\\) where \\(k-1<b<k\\) and \\(s\\) is a nonnegative integer. We then have\n\n\\[\n1<N(n+k)=N\\left(\\frac{(n+k)!}{(n+k-1)!}\\right)=\\frac{a}{b}<\\frac{k+1}{k-1} \\leq 3\n\\]\n\nNow \\(N(m) \\geq N(m+1)\\) can only happen if \\(N(m) \\geq 9\\). Hence it follows from (2) that\n\n\\[\n1<N(n+2)<\\cdots<N(n+9) \\leq \\frac{5}{4}\n\\]\n\nUsing (1) we then have\n\n\\[\n\\begin{aligned}\n& N((n+2)!) \\leq N((n+1)!) N(n+2)<2 \\cdot \\frac{5}{4}, \n& N((n+3)!) \\leq N((n+2)!) N(n+3)<2\\left(\\frac{5}{4}\\right)^{2}, \n& N((n+4)!) \\leq N((n+3)!) N(n+4)<2\\left(\\frac{5}{4}\\right)^{3}<4,\n\n\\]\n\ncontradicting the assumption that \\((n+4)\\) ! has leftmost digit of 4 .\nTherefore there is no positive integer \\(n\\) such that for \\(k=1,2, \\ldots, 9\\), the leftmost digit of \\((n+k)!\\) is \\(k\\).\n\nProblem"}
{"id": "imo-shortlist-2001-n2", "question": "N2. Consider the system\n\n\\[\n\\begin{aligned}\nx+y & =z+u \n2 x y & =z u .\n\n\\]\n\nFind the greatest value of the real constant \\(m\\) such that \\(m \\leq x / y\\) for any positive integer", "category": "Number Theory", "source": "IMO Shortlist", "year": 2001, "solution": "\\((x, y, z, u)\\) of the system, with \\(x \\geq y\\).\n\nSolution 1. Squaring the first equation and then subtracting four times the second, we obtain\n\n\\[\nx^{2}-6 x y+y^{2}=(z-u)^{2}\n\\]\n\nfrom which\n\n\\[\n\\left(\\frac{x}{y}\\right)^{2}-6\\left(\\frac{x}{y}\\right)+1=\\left(\\frac{z-u}{y}\\right)^{2}\n\\]\n\nThe quadratic \\(\\omega^{2}-6 \\omega+1\\) takes the value 0 for \\(\\omega=3 \\pm 2 \\sqrt{2}\\), and is positive for \\(\\omega>3+2 \\sqrt{2}\\). Because \\(x / y \\geq 1\\) and the right side of (\\textit{) is a square, the left side of (}) is positive, and we must have \\(x / y>3+2 \\sqrt{2}\\). We now show that \\(x / y\\) can be made as close to \\(3+2 \\sqrt{2}\\) as we like, so the desired \\(m=3+2 \\sqrt{2}\\). We prove this by showing that the term \\(((z-u) / y)^{2}\\) in \\((*)\\) can be made as small as we like.\n\nTo this end, we first find a way to generate solutions of the system. If \\(p\\) is a prime divisor of \\(z\\) and \\(u\\), then \\(p\\) is a divisor of both \\(x\\) and \\(y\\). Thus we may assume, without loss of generality, that \\(z\\) and \\(u\\) are relatively prime. If we square both sides of the first equation, then subtract twice the second equation we have\n\n\\[\n(x-y)^{2}=z^{2}+u^{2}\n\\]\n\nThus ( \\(z, u, x-y\\) ) is a primitive Pythagorean triple, and we may assume that \\(u\\) is even. Hence there are relatively prime positive integers \\(a\\) and \\(b\\), one of them even and the other odd, such that\n\n\\[\nz=a^{2}-b^{2}, \\quad u=2 a b, \\quad \\text { and } \\quad x-y=a^{2}+b^{2} .\n\\]\n\nCombining these equations with \\(x+y=z+u\\), we find that\n\n\\[\nx=a^{2}+a b \\quad \\text { and } \\quad y=a b-b^{2} .\n\\]\n\nObserve that \\(z-u=a^{2}-b^{2}-2 a b=(a-b)^{2}-2 b^{2}\\). When \\(z-u=1\\), we get the Pell equation \\(1=(a-b)^{2}-2 b^{2}\\), which has solution \\(a-b=3, b=2\\). By well known facts, this equation has infinitely many positive integer solutions \\(a-b\\) and \\(b\\), and both of these quantities can be made arbitrarily large. It follows that \\(y=a b-b^{2}\\) can be made arbitrarily large. Hence the right side of (*) can be made as small as we like, and the corresponding value of \\(x / y\\) can be made as close to \\(3+2 \\sqrt{2}\\) as we like.\n\nNote. This solution can be shortened somewhat by using a different method for generating solutions. Note that if \\((t, y)\\) satisfies the Pell equation \\(t^{2}-2 y^{2}=1\\) and we set \\(x=3 y+2 t, z=2 y+t+1, u=2 y+t-1\\), then \\(x+y=4 y+2 t=z+u\\) and \\(2 x y=2(3 y+2 t) y=6 y^{2}+4 t y=(2 y+t)^{2}-1=z u\\). It follows as before that there are solutions with \\(x / y=3+2 t / y\\) as close to \\(3+2 \\sqrt{2}\\) as desired.\n\nSolution 2. As in the first solution, we find that \\((x-y)^{2}=u^{2}+z^{2}\\). Hence there is a right triangle with sides \\(a=u\\) and \\(b=z\\) and hypotenuse \\(c=x-y\\). Let \\(A B C\\) be such a triangle with \\(A B=c, A C=b\\), and \\(B C=a\\). Let \\(I\\) be the incenter of the triangle, let \\(r\\) be the inradius, and let \\(Z\\) be the point at which the incircle is tangent to \\(A B\\). Let \\(C T\\) be the bisector of angle \\(C\\), with \\(T\\) on \\(A B\\), let \\(C H\\) be the altitude to \\(A B\\), and let \\(C^{\\prime}\\) be the midpoint of \\(A B\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_c6743ebd3edd647fb160g-62}\n\nBecause triangle \\(A B C\\) is right, \\(r=I Z=s-c\\), where \\(s=(a+b+c) / 2\\) is the semiperimeter of the triangle. Thus, \\(a+b=2 r+c=2 r+x-y\\). Using this with \\(a+b=u+z=x+y\\) we obtain \\(y=r\\) and \\(x=s\\). We now prove that for any values of \\(a\\) and \\(b\\),\n\n\\[\n\\frac{x}{y}=\\frac{s}{r} \\geq(\\sqrt{2}+1)^{2}\n\\]\n\nTo show this, observe that \\(C C^{\\prime} \\geq C T \\geq C I+I Z\\), so\n\n\\[\n\\frac{s-r}{2}=\\frac{c}{2} \\geq(\\sqrt{2}+1) r\n\\]\n\nIt follows that\n\n\\[\n\\frac{s}{r} \\geq 2 \\sqrt{2}+3=(\\sqrt{2}+1)^{2}\n\\]\n\nwhich establishes (1). Equality holds only if the triangle is isosceles, but in that case the sides cannot all be of integral length. Thus the inequality in (1) is strict. On the other hand, \\(C H \\leq C I+I Z\\) so \\(2 r s / c \\leq(\\sqrt{2}+1) r\\). Hence\n\n\\[\n\\frac{x}{y}=\\frac{s}{r} \\leq(\\sqrt{2}+1)^{2}\\left(\\frac{c^{2}}{4 s r}\\right)\n\\]\n\nHowever,\n\n\\[\n\\frac{c^{2}}{4 s r}=\\frac{a^{2}+b^{2}}{2 a b}=1+\\frac{(a-b)^{2}}{2 a b}\n\\]\n\nBecause there are infinitely Pythagorean triples ( \\(a, b, c\\) ) with \\(a-b=1\\), it follows from (3) that \\(c^{2} /(4 r s)\\) can be made as close to 1 as we like. It then follows from (1) and (2) that the maximal value for \\(m\\) is \\(3+2 \\sqrt{2}\\).\n\nSolution 3 (Sketch). Solve the first equation for \\(u\\), substitute in the second, then divide by \\(y^{2}\\) to get\n\n\\[\n\\left(\\frac{z}{y}\\right)^{2}-\\left(\\frac{z}{y}\\right)\\left(\\frac{x}{y}\\right)-\\left(\\frac{z}{y}\\right)+2\\left(\\frac{x}{y}\\right)=0 .\n\\]\n\nLet \\(X=x / y\\) and \\(Z=z / y\\) to obtain\n\n\\[\nZ^{2}-Z X-Z+2 X=0\n\\]\n\nEquation (\\textit{) describes a hyperbola in the ( \\(X, Z\\) )-plane. The asymptotes of the hyperbola have slope 0 and 1 . One branch of the hyperbola lies in the half plane \\(X \\geq 1\\), the other in the half plane \\(X<1\\). Furthermore, the leftmost point on the branch in the half plane \\(X \\geq 1\\) has coordinates ( \\(3+2 \\sqrt{2}, 2+\\sqrt{2}\\) ). Thus, if ( \\(X, Z\\) ) is on the hyperbola and \\(X \\geq 1\\), then \\(X \\geq 3+2 \\sqrt{2}\\), and this bound cannot be improved. Because (}) has rational coefficients and the hyperbola described by (*) has a point with rational coordinates, it has infinitely many points with rational coordinates. In particular, let \\(r\\) be a rational number, \\(r \\neq 0\\) or 1 . Then the line with equation \\(y=r x\\) intersects the hyperbola described by \\((*)\\) in the points \\((0,0)\\) and \\(\\left(\\frac{r-2}{r^{2}-r}, \\frac{r^{2}-2 r}{r^{2}-r}\\right)\\). If \\(0<r<1\\), then the latter point is on the right branch of the hyperbola, so has (rational) \\(X\\) coordinate \\(\\frac{r-2}{r^{2}-r}>3+2 \\sqrt{2}\\). Furthermore, if \\(r\\) is close to\n\n\\[\n\\frac{2+\\sqrt{2}}{3+2 \\sqrt{2}}=2-\\sqrt{2}\n\\]\n\nthen this \\(X\\)-coordinate is close to \\(3+2 \\sqrt{2}\\). Finally, if \\(X\\) and \\(Z\\) are positive rationals satisfying \\((*)\\), then we can find integers \\(x, y\\), and \\(z\\) with \\(X=x / y\\) and \\(Z=z / y\\). It is easy to check that \\(x, y, z\\), and \\(u=x+y-z\\) are positive integers that satisfy the equations in the problem statement. Thus if \\(x, y, z\\) and \\(u\\) are positive integers that satisfy the equations in the statement, and \\(x \\geq y\\), then \\(x / y>3+2 \\sqrt{2}\\). Furthermore, this lower bound is best possible.\n\nProblem"}
{"id": "imo-shortlist-2001-n3", "question": "N3. Let \\(a_{1}=11^{11}, a_{2}=12^{12}, a_{3}=13^{13}\\), and\n\n\\[\na_{n}=\\left|a_{n-1}-a_{n-2}\\right|+\\left|a_{n-2}-a_{n-3}\\right|, \\quad n \\geq 4\n\\]\n\nDetermine \\(a_{14^{14}}\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2001, "solution": "For \\(n \\geq 2\\), define \\(s_{n}=\\left|a_{n}-a_{n-1}\\right|\\). Then for \\(n \\geq 5, a_{n}=s_{n-1}+s_{n-2}\\) and \\(a_{n-1}=s_{n-2}+s_{n-3}\\), and hence \\(s_{n}=\\left|s_{n-1}-s_{n-3}\\right|\\). Because \\(s_{n} \\geq 0\\), it follows that if \\(\\max \\left\\{s_{n}, s_{n+1}, s_{n+2}\\right\\} \\leq T\\), then \\(s_{m} \\leq T\\) for all \\(m \\geq n\\). In particular, the sequence \\(\\left(s_{n}\\right)\\) is bounded. We now prove the following claim.\n\nClaim. If \\(\\max \\left\\{s_{i}, s_{i+1}, s_{i+2}\\right\\}=T \\geq 2\\) for some \\(i\\), then \\(\\max \\left\\{s_{i+6}, s_{i+7}, s_{i+8}\\right\\} \\leq T-1\\).\nProof. If this were not the case, then \\(\\max \\left\\{s_{j}, s_{j+1}, s_{j+2}\\right\\}=T \\geq 2\\) for \\(j=i, i+1, i+\\) \\(2, \\ldots, i+6\\). We show by contradiction that this cannot happen. If the claim were false, then for \\(j=i, i+1\\), or \\(i+2\\) the sequence \\(s_{j}, s_{j+1}, s_{j+2}, \\ldots\\) would have the form\n\n\\[\nT, x, y, T-y, \\ldots,\n\\]\n\nwith \\(0 \\leq x, y \\leq T\\), and \\(\\max \\{x, y, T-y\\}=T\\). Hence either \\(x=T\\) or \\(y=T\\) or \\(y=0\\). We consider each case:\n(a) If \\(x=T\\), then the sequence has the form \\(T, T, y, T-y, y, \\ldots\\)\n\nBecause \\(\\max \\{y, T-y, y\\}=T\\) we must have \\(y=0\\) or \\(y=T\\).\n(b) If \\(y=0\\), then the sequence takes the form \\(T, x, 0, T, T-x, T-x, x, \\ldots\\)\n\nHence \\(\\max \\{x, T-x\\}=T\\), so \\(x=0\\) or \\(x=T\\).\n(c) If \\(y=T\\), then the sequence is \\(T, x, T, 0, x, T-x, \\ldots\\)\n\nWe then have \\(\\max \\{x, T-x\\}=T\\), so \\(x=0\\) or \\(x=T\\).\nIn each case we find that both \\(x\\) and \\(y\\) must be either 0 or \\(T\\). In particular, \\(T\\) must divide each of \\(s_{i}, s_{i+1}\\), and \\(s_{i+2}\\), which implies that \\(T\\) divides \\(s_{n}\\) for all \\(n \\geq 2\\). However, because \\(s_{2}=12^{12}-11^{11}\\) and \\(s_{4}=11^{11}\\) are relatively prime we have a contradiction. This establishes the claim.\n\nNow let \\(M=14^{14}\\) and \\(N=13^{13}\\). From the bound \\(\\max \\left\\{s_{2}, s_{3}, s_{4}\\right\\} \\leq N\\), we use the claim to deduce inductively that \\(\\max \\left\\{s_{6 N+2}, s_{6 N+3}, s_{6 N+4}\\right\\}=1\\). In particular \\(s_{n}=0\\) or 1 for \\(n \\geq 6 N+2\\). Hence \\(a_{n}=s_{n-1}+s_{n-2}\\) may only take on the values 0 , 1 , or 2 when \\(n \\geq M>6 N+4\\). In particular, \\(a_{M}=0,1\\), or 2 . Now the recursion for \\(a_{n}\\) implies that\n\n\\[\na_{n} \\equiv\\left(a_{n-1}-a_{n-2}\\right)+\\left(a_{n-2}-a_{n-3}\\right) \\equiv a_{n-1}-a_{n-3} \\quad(\\bmod 2)\n\\]\n\nFrom the initial values for \\(a_{1}, a_{2}\\), and \\(a_{3}\\) it can be easily shown that modulo 2 , the sequence \\(\\left(a_{n}\\right)\\) is periodic with period 7 , and that \\(a_{7}\\) is odd. Because \\(14^{14}\\) is a multiple of 7 , we conclude that \\(a_{M}=1\\).\n\nProblem"}
{"id": "imo-shortlist-2001-n4", "question": "N4. Let \\(p \\geq 5\\) be a prime number. Prove that there exists an integer \\(a\\) with \\(1 \\leq a \\leq p-2\\) such that neither \\(a^{p-1}-1\\) nor \\((a+1)^{p-1}-1\\) is divisible by \\(p^{2}\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2001, "solution": "Let \\(S=\\{1,2, \\ldots, p-1\\}\\) and let \\(A=\\left\\{a \\in S: a^{p-1} \\not \\equiv 1\\left(\\bmod p^{2}\\right)\\right\\}\\). We prove that \\(|A| \\geq(p-1) / 2\\), where \\(|A|\\) denotes the number of elements in \\(A\\). Indeed, if \\(1 \\leq a \\leq p-1\\), then the Binomial Theorem gives\n\n\\[\n(p-a)^{p-1}-a^{p-1} \\equiv-(p-1) a^{p-2} p \\not \\equiv 0 \\quad\\left(\\bmod p^{2}\\right)\n\\]\n\nThus at least one of \\(a\\) and \\(p-a\\) is in \\(A\\). In particular, \\(p-1 \\in A\\) because \\(1 \\notin A\\). Now let \\(p=2 k+1, k \\geq 2\\), and consider the \\(k-1\\) pairs of numbers \\(\\{(2,3),(4,5), \\ldots\\), \\((2 k-2,2 k-1)\\}\\). If there exists an \\(i, 1 \\leq i \\leq k-1\\), such that \\(2 i \\in A\\) and \\(2 i+1 \\in A\\), then the conditions of the problem are satisfied. If not, then at least one entry of each pair \\((2 i, 2 i+1), 1 \\leq i \\leq k-1\\), is in \\(A\\). Because \\(1 \\notin A\\) and \\(|A| \\geq(p-1) / 2=k\\), exactly one element of each such pair is in \\(A\\). Consider now the pair \\((2 k-2,2 k-1)\\).\n\nIf \\(2 k-1=p-2 \\in A\\) then we are done because \\(p-1 \\in A\\). (Note that this is the case if \\(p=5\\).) If \\(2 k-1=p-2 \\notin A\\), then \\(p-3=2 k-2 \\in A\\), so the conditions of the problem will be satisfied if we show that \\(2 k-3 \\in A\\). Suppose also that \\(2 k-3 \\notin A\\). Because \\(p-2 \\notin A\\) we have\n\n\\[\n1 \\equiv(p-2)^{p-1} \\equiv 2^{p-1}-(p-1) 2^{p-2} p \\equiv 2^{p-1}+p 2^{p-2} \\quad\\left(\\bmod p^{2}\\right)\n\\]\n\nSquaring the first and last expressions in (1), we obtain\n\n\\[\n4^{p-1}+p 2^{2 p-2} \\equiv 1 \\quad\\left(\\bmod p^{2}\\right)\n\\]\n\nAlso, because \\(2 k-3=p-4 \\notin A\\),\n\n\\[\n1 \\equiv(p-4)^{p-1} \\equiv 4^{p-1}-(p-1) 4^{p-2} p \\equiv 4^{p-1}+p 4^{p-2} \\quad\\left(\\bmod p^{2}\\right)\n\\]\n\nSubtracting the first and last expressions of (3) from (2), we obtain \\(3 p 4^{p-2} \\equiv 0\\) \\(\\left(\\bmod p^{2}\\right)\\), a contradiction. Thus, if \\(p \\geq 7\\) and \\(p-2 \\notin A\\), then \\(p-4 \\in A\\). In particular, if \\(p-3 \\in A\\), then \\(p-4\\) and \\(p-3\\) satisfy the conditions of the problem.\n\nProblem"}
{"id": "imo-shortlist-2001-n5", "question": "N5. Let \\(a>b>c>d\\) be positive integers and suppose\n\n\\[\na c+b d=(b+d+a-c)(b+d-a+c) .\n\\]\n\nProve that \\(a b+c d\\) is not prime.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2001, "solution": "Suppose to the contrary that \\(a b+c d\\) is prime. Note that\n\n\\[\na b+c d=(a+d) c+(b-c) a=m \\cdot \\operatorname{gcd}(a+d, b-c)\n\\]\n\nfor some positive integer \\(m\\). By assumption, either \\(m=1\\) or \\(\\operatorname{gcd}(a+d, b-c)=1\\). We consider these alternatives in turn.\n\nCase (i): \\(m=1\\). Then\n\n\\[\n\\begin{aligned}\n\\operatorname{gcd}(a+d, b-c) & =a b+c d>a b+c d-(a-b+c+d) \n& =(a+d)(c-1)+(b-c)(a+1) \n& \\geq \\operatorname{gcd}(a+d, b-c),\n\n\\]\n\nwhich is false.\nCase (ii): \\(\\operatorname{gcd}(a+d, b-c)=1\\). Substituting \\(a c+b d=(a+d) b-(b-c) a\\) for the left-hand side of \\(a c+b d=(b+d+a-c)(b+d-a+c)\\), we obtain\n\n\\[\n(a+d)(a-c-d)=(b-c)(b+c+d)\n\\]\n\nIn view of this, there exists a positive integer \\(k\\) such that\n\n\\[\n\\begin{aligned}\na-c-d & =k(b-c), \nb+c+d & =k(a+d) .\n\n\\]\n\nAdding these equations, we obtain \\(a+b=k(a+b-c+d)\\) and thus \\(k(c-d)=\\) \\((k-1)(a+b)\\). Recall that \\(a>b>c>d\\). If \\(k=1\\) then \\(c=d\\), a contradiction. If \\(k \\geq 2\\) then\n\n\\[\n2 \\geq \\frac{k}{k-1}=\\frac{a+b}{c-d}>2,\n\\]\n\na contradiction.\nSince a contradiction is reached in both (i) and (ii), \\(a b+c d\\) is not prime.\n\nSolution 2. The equality \\(a c+b d=(b+d+a-c)(b+d-a+c)\\) is equivalent to\n\n\\[\na^{2}-a c+c^{2}=b^{2}+b d+d^{2} .\n\\]\n\nLet \\(A B C D\\) be the quadrilateral with \\(A B=a, B C=d, C D=b, A D=c, \\angle B A D=\\) \\(60^{\\circ}\\), and \\(\\angle B C D=120^{\\circ}\\). Such a quadrilateral exists in view of (1) and the Law of Cosines; the common value in (1) is \\(B D^{2}\\). Let \\(\\angle A B C=\\alpha\\), so that \\(\\angle C D A=180^{\\circ}-\\alpha\\). Applying the Law of Cosines to triangles \\(A B C\\) and \\(A C D\\) gives\n\n\\[\na^{2}+d^{2}-2 a d \\cos \\alpha=A C^{2}=b^{2}+c^{2}+2 b c \\cos \\alpha .\n\\]\n\nHence \\(2 \\cos \\alpha=\\left(a^{2}+d^{2}-b^{2}-c^{2}\\right) /(a d+b c)\\), and\n\n\\[\nA C^{2}=a^{2}+d^{2}-a d \\frac{a^{2}+d^{2}-b^{2}-c^{2}}{a d+b c}=\\frac{(a b+c d)(a c+b d)}{a d+b c} .\n\\]\n\nBecause \\(A B C D\\) is cyclic, Ptolemy's Theorem gives\n\n\\[\n(A C \\cdot B D)^{2}=(a b+c d)^{2}\n\\]\n\nIt follows that\n\n\\[\n(a c+b d)\\left(a^{2}-a c+c^{2}\\right)=(a b+c d)(a d+b c) .\n\\]\n\n(Note. Also straightforward algebra can be used obtain (2) from (1).) Next observe that\n\n\\[\na b+c d>a c+b d>a d+b c .\n\\]\n\nThe first inequality follows from \\((a-d)(b-c)>0\\), and the second from \\((a-b)(c-d)>0\\).\nNow assume that \\(a b+c d\\) is prime. It then follows from (3) that \\(a b+c d\\) and \\(a c+b d\\) are relatively prime. Hence, from (2), it must be true that \\(a c+b d\\) divides \\(a d+b c\\). However, this is impossible by (3). Thus \\(a b+c d\\) must not be prime.\n\nNote. Examples of 4-tuples ( \\(a, b, c, d\\) ) that satisfy the given conditions are ( \\(21,18,14,1\\) ) and (65, 50, 34, 11).\n\nProblem"}
{"id": "imo-shortlist-2001-n6", "question": "N6. Is it possible to find 100 positive integers not exceeding 25,000, such that all pairwise sums of them are different?", "category": "Number Theory", "source": "IMO Shortlist", "year": 2001, "solution": "Yes. The desired result is an immediate consequence of the following fact.\nLemma. For any odd prime number \\(p\\) there exist \\(p\\) positive integers not exceeding \\(2 p^{2}\\) for which the pairwise sums of the integers are all different.\n\nProof. Consider the \\(p\\) numbers \\(f_{n}=2 p n+\\left(n^{2}\\right), n=0,1,2, \\ldots, p-1\\), where \\(\\left(a^{2}\\right)\\) denotes the remainder when \\(a^{2}\\) is divided by \\(p\\). Because \\(0 \\leq\\left(a^{2}\\right) \\leq p-1\\),\n\n\\[\n\\left\\lfloor\\frac{f_{m}+f_{n}}{2 p}\\right\\rfloor=m+n .\n\\]\n\nAssume that \\(f_{m}+f_{n}=f_{k}+f_{l}\\). From (*) it follows that \\(m+n=k+l\\) and hence that \\(\\left(m^{2}\\right)+\\left(n^{2}\\right)=\\left(k^{2}\\right)+\\left(l^{2}\\right)\\), that is, \\(m^{2}+n^{2} \\equiv k^{2}+l^{2}(\\bmod p)\\). The conditions\n\n\\[\nn+m \\equiv k+l \\quad(\\bmod p), \\quad n^{2}+m^{2} \\equiv k^{2}+l^{2} \\quad(\\bmod p),\n\\]\n\n\\(0 \\leq n, m, k, l \\leq p-1\\), imply that the pairs \\(\\{m, n\\}\\) and \\(\\{k, l\\}\\) are the same. Thus, if \\(\\{m, n\\} \\neq\\{k, l\\}\\), then \\(f_{n}+f_{m} \\neq f_{k}+f_{l}\\). This completes the proof of the lemma.\n\nApplying the lemma with \\(p=101\\), we obtain a set of 101 numbers not exceeding \\(2 \\cdot 101^{2}<25000\\), all of whose pairwise sums are different."}
{"id": "imo-shortlist-2014-a1", "question": "A1. Let \\(z_{0}<z_{1}<z_{2}<\\cdots\\) be an infinite sequence of positive integers. Prove that there exists a unique integer \\(n \\geqslant 1\\) such that\n\n\\[\nz_{n}<\\frac{z_{0}+z_{1}+\\cdots+z_{n}}{n} \\leqslant z_{n+1}\n\\]\n\n(Austria)", "category": "Algebra", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-a2", "question": "A2. Define the function \\(f:(0,1) \\rightarrow(0,1)\\) by\n\n\\[\nf(x)= \\begin{cases}x+\\frac{1}{2} & \\text { if } x<\\frac{1}{2} \\\\ x^{2} & \\text { if } x \\geqslant \\frac{1}{2}\n\\]\n\nLet \\(a\\) and \\(b\\) be two real numbers such that \\(0<a<b<1\\). We define the sequences \\(a_{n}\\) and \\(b_{n}\\) by \\(a_{0}=a, b_{0}=b\\), and \\(a_{n}=f\\left(a_{n-1}\\right), b_{n}=f\\left(b_{n-1}\\right)\\) for \\(n>0\\). Show that there exists a positive integer \\(n\\) such that\n\n\\[\n\\left(a_{n}-a_{n-1}\\right)\\left(b_{n}-b_{n-1}\\right)<0\n\\]\n\n(Denmark)", "category": "Algebra", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-a3", "question": "A3. For a sequence \\(x_{1}, x_{2}, \\ldots, x_{n}\\) of real numbers, we define its price as\n\n\\[\n\\max _{1 \\leqslant i \\leqslant n}\\left|x_{1}+\\cdots+x_{i}\\right| .\n\\]\n\nGiven \\(n\\) real numbers, Dave and George want to arrange them into a sequence with a low price. Diligent Dave checks all possible ways and finds the minimum possible price \\(D\\). Greedy George, on the other hand, chooses \\(x_{1}\\) such that \\(\\left|x_{1}\\right|\\) is as small as possible; among the remaining numbers, he chooses \\(x_{2}\\) such that \\(\\left|x_{1}+x_{2}\\right|\\) is as small as possible, and so on. Thus, in the \\(i^{\\text {th }}\\) step he chooses \\(x_{i}\\) among the remaining numbers so as to minimise the value of \\(\\left|x_{1}+x_{2}+\\cdots+x_{i}\\right|\\). In each step, if several numbers provide the same value, George chooses one at random. Finally he gets a sequence with price \\(G\\).\n\nFind the least possible constant \\(c\\) such that for every positive integer \\(n\\), for every collection of \\(n\\) real numbers, and for every possible sequence that George might obtain, the resulting values satisfy the inequality \\(G \\leqslant c D\\).\n(Georgia)", "category": "Algebra", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-a4", "question": "A4. Determine all functions \\(f: \\mathbb{Z} \\rightarrow \\mathbb{Z}\\) satisfying\n\n\\[\nf(f(m)+n)+f(m)=f(n)+f(3 m)+2014\n\\]\n\nfor all integers \\(m\\) and \\(n\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-a5", "question": "A5. Consider all polynomials \\(P(x)\\) with real coefficients that have the following property: for any two real numbers \\(x\\) and \\(y\\) one has\n\n\\[\n\\left|y^{2}-P(x)\\right| \\leqslant 2|x| \\quad \\text { if and only if } \\quad\\left|x^{2}-P(y)\\right| \\leqslant 2|y|\n\\]\n\nDetermine all possible values of \\(P(0)\\).\n(Belgium)", "category": "Algebra", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-a6", "question": "A6. Find all functions \\(f: \\mathbb{Z} \\rightarrow \\mathbb{Z}\\) such that\n\n\\[\nn^{2}+4 f(n)=f(f(n))^{2}\n\\]\n\nfor all \\(n \\in \\mathbb{Z}\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-c1", "question": "C1. Let \\(n\\) points be given inside a rectangle \\(R\\) such that no two of them lie on a line parallel to one of the sides of \\(R\\). The rectangle \\(R\\) is to be dissected into smaller rectangles with sides parallel to the sides of \\(R\\) in such a way that none of these rectangles contains any of the given points in its interior. Prove that we have to dissect \\(R\\) into at least \\(n+1\\) smaller rectangles.\n(Serbia)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-c2", "question": "C2. We have \\(2^{m}\\) sheets of paper, with the number 1 written on each of them. We perform the following operation. In every step we choose two distinct sheets; if the numbers on the two sheets are \\(a\\) and \\(b\\), then we erase these numbers and write the number \\(a+b\\) on both sheets. Prove that after \\(m 2^{m-1}\\) steps, the sum of the numbers on all the sheets is at least \\(4^{m}\\).\n(Iran)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-c3", "question": "C3. Let \\(n \\geqslant 2\\) be an integer. Consider an \\(n \\times n\\) chessboard divided into \\(n^{2}\\) unit squares. We call a configuration of \\(n\\) rooks on this board happy if every row and every column contains exactly one rook. Find the greatest positive integer \\(k\\) such that for every happy configuration of rooks, we can find a \\(k \\times k\\) square without a rook on any of its \\(k^{2}\\) unit squares.\n(Croatia)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-c4", "question": "C4. Construct a tetromino by attaching two \\(2 \\times 1\\) dominoes along their longer sides such that the midpoint of the longer side of one domino is a corner of the other domino. This construction yields two kinds of tetrominoes with opposite orientations. Let us call them Sand Z-tetrominoes, respectively.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-07}\n\nS-tetrominoes\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-07(1)}\n\nZ-tetrominoes\n\nAssume that a lattice polygon \\(P\\) can be tiled with S-tetrominoes. Prove than no matter how we tile \\(P\\) using only S - and Z -tetrominoes, we always use an even number of Z -tetrominoes.\n(Hungary)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-c5", "question": "C5. Consider \\(n \\geqslant 3\\) lines in the plane such that no two lines are parallel and no three have a common point. These lines divide the plane into polygonal regions; let \\(\\mathcal{F}\\) be the set of regions having finite area. Prove that it is possible to colour \\(\\lceil\\sqrt{n / 2}\\rceil\\) of the lines blue in such a way that no region in \\(\\mathcal{F}\\) has a completely blue boundary. (For a real number \\(x,\\lceil x\\rceil\\) denotes the least integer which is not smaller than \\(x\\).)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-c6", "question": "C6. We are given an infinite deck of cards, each with a real number on it. For every real number \\(x\\), there is exactly one card in the deck that has \\(x\\) written on it. Now two players draw disjoint sets \\(A\\) and \\(B\\) of 100 cards each from this deck. We would like to define a rule that declares one of them a winner. This rule should satisfy the following conditions:\n\n\\begin{enumerate}\n  \\item The winner only depends on the relative order of the 200 cards: if the cards are laid down in increasing order face down and we are told which card belongs to which player, but not what numbers are written on them, we can still decide the winner.\n  \\item If we write the elements of both sets in increasing order as \\(A=\\left\\{a_{1}, a_{2}, \\ldots, a_{100}\\right\\}\\) and \\(B=\\left\\{b_{1}, b_{2}, \\ldots, b_{100}\\right\\}\\), and \\(a_{i}>b_{i}\\) for all \\(i\\), then \\(A\\) beats \\(B\\).\n  \\item If three players draw three disjoint sets \\(A, B, C\\) from the deck, \\(A\\) beats \\(B\\) and \\(B\\) beats \\(C\\), then \\(A\\) also beats \\(C\\).\n\n\nHow many ways are there to define such a rule? Here, we consider two rules as different if there exist two sets \\(A\\) and \\(B\\) such that \\(A\\) beats \\(B\\) according to one rule, but \\(B\\) beats \\(A\\) according to the other.\n(Russia)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-c7", "question": "C7. Let \\(M\\) be a set of \\(n \\geqslant 4\\) points in the plane, no three of which are collinear. Initially these points are connected with \\(n\\) segments so that each point in \\(M\\) is the endpoint of exactly two segments. Then, at each step, one may choose two segments \\(A B\\) and \\(C D\\) sharing a common interior point and replace them by the segments \\(A C\\) and \\(B D\\) if none of them is present at this moment. Prove that it is impossible to perform \\(n^{3} / 4\\) or more such moves.\n(Russia)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-c8", "question": "C8. A card deck consists of 1024 cards. On each card, a set of distinct decimal digits is written in such a way that no two of these sets coincide (thus, one of the cards is empty). Two players alternately take cards from the deck, one card per turn. After the deck is empty, each player checks if he can throw out one of his cards so that each of the ten digits occurs on an even number of his remaining cards. If one player can do this but the other one cannot, the one who can is the winner; otherwise a draw is declared.\n\nDetermine all possible first moves of the first player after which he has a winning strategy.\n(Russia)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-c9", "question": "C9. There are \\(n\\) circles drawn on a piece of paper in such a way that any two circles intersect in two points, and no three circles pass through the same point. Turbo the snail slides along the circles in the following fashion. Initially he moves on one of the circles in clockwise direction. Turbo always keeps sliding along the current circle until he reaches an intersection with another circle. Then he continues his journey on this new circle and also changes the direction of moving, i.e. from clockwise to anticlockwise or vice versa.\n\nSuppose that Turbo's path entirely covers all circles. Prove that \\(n\\) must be odd.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-g1", "question": "G1. The points \\(P\\) and \\(Q\\) are chosen on the side \\(B C\\) of an acute-angled triangle \\(A B C\\) so that \\(\\angle P A B=\\angle A C B\\) and \\(\\angle Q A C=\\angle C B A\\). The points \\(M\\) and \\(N\\) are taken on the rays \\(A P\\) and \\(A Q\\), respectively, so that \\(A P=P M\\) and \\(A Q=Q N\\). Prove that the lines \\(B M\\) and \\(C N\\) intersect on the circumcircle of the triangle \\(A B C\\).\n(Georgia)", "category": "Geometry", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-g2", "question": "G2. Let \\(A B C\\) be a triangle. The points \\(K, L\\), and \\(M\\) lie on the segments \\(B C, C A\\), and \\(A B\\), respectively, such that the lines \\(A K, B L\\), and \\(C M\\) intersect in a common point. Prove that it is possible to choose two of the triangles \\(A L M, B M K\\), and \\(C K L\\) whose inradii sum up to at least the inradius of the triangle \\(A B C\\).\n(Estonia)", "category": "Geometry", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-g3", "question": "G3. Let \\(\\Omega\\) and \\(O\\) be the circumcircle and the circumcentre of an acute-angled triangle \\(A B C\\) with \\(A B>B C\\). The angle bisector of \\(\\angle A B C\\) intersects \\(\\Omega\\) at \\(M \\neq B\\). Let \\(\\Gamma\\) be the circle with diameter \\(B M\\). The angle bisectors of \\(\\angle A O B\\) and \\(\\angle B O C\\) intersect \\(\\Gamma\\) at points \\(P\\) and \\(Q\\), respectively. The point \\(R\\) is chosen on the line \\(P Q\\) so that \\(B R=M R\\). Prove that \\(B R \\| A C\\). (Here we always assume that an angle bisector is a ray.)\n(Russia)", "category": "Geometry", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-g4", "question": "G4. Consider a fixed circle \\(\\Gamma\\) with three fixed points \\(A, B\\), and \\(C\\) on it. Also, let us fix a real number \\(\\lambda \\in(0,1)\\). For a variable point \\(P \\notin\\{A, B, C\\}\\) on \\(\\Gamma\\), let \\(M\\) be the point on the segment \\(C P\\) such that \\(C M=\\lambda \\cdot C P\\). Let \\(Q\\) be the second point of intersection of the circumcircles of the triangles \\(A M P\\) and \\(B M C\\). Prove that as \\(P\\) varies, the point \\(Q\\) lies on a fixed circle.\n(United Kingdom)", "category": "Geometry", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-g5", "question": "G5. Let \\(A B C D\\) be a convex quadrilateral with \\(\\angle B=\\angle D=90^{\\circ}\\). Point \\(H\\) is the foot of the perpendicular from \\(A\\) to \\(B D\\). The points \\(S\\) and \\(T\\) are chosen on the sides \\(A B\\) and \\(A D\\), respectively, in such a way that \\(H\\) lies inside triangle \\(S C T\\) and\n\n\\[\n\\angle S H C-\\angle B S C=90^{\\circ}, \\quad \\angle T H C-\\angle D T C=90^{\\circ} .\n\\]\n\nProve that the circumcircle of triangle \\(S H T\\) is tangent to the line \\(B D\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-g6", "question": "G6. Let \\(A B C\\) be a fixed acute-angled triangle. Consider some points \\(E\\) and \\(F\\) lying on the sides \\(A C\\) and \\(A B\\), respectively, and let \\(M\\) be the midpoint of \\(E F\\). Let the perpendicular bisector of \\(E F\\) intersect the line \\(B C\\) at \\(K\\), and let the perpendicular bisector of \\(M K\\) intersect the lines \\(A C\\) and \\(A B\\) at \\(S\\) and \\(T\\), respectively. We call the pair ( \\(E, F\\) ) interesting, if the quadrilateral \\(K S A T\\) is cyclic.\n\nSuppose that the pairs ( \\(E_{1}, F_{1}\\) ) and ( \\(E_{2}, F_{2}\\) ) are interesting. Prove that\n\n\\[\n\\frac{E_{1} E_{2}}{A B}=\\frac{F_{1} F_{2}}{A C} .\n\\]", "category": "Geometry", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-g7", "question": "G7. Let \\(A B C\\) be a triangle with circumcircle \\(\\Omega\\) and incentre \\(I\\). Let the line passing through \\(I\\) and perpendicular to \\(C I\\) intersect the segment \\(B C\\) and the arc \\(B C\\) (not containing \\(A\\) ) of \\(\\Omega\\) at points \\(U\\) and \\(V\\), respectively. Let the line passing through \\(U\\) and parallel to \\(A I\\) intersect \\(A V\\) at \\(X\\), and let the line passing through \\(V\\) and parallel to \\(A I\\) intersect \\(A B\\) at \\(Y\\). Let \\(W\\) and \\(Z\\) be the midpoints of \\(A X\\) and \\(B C\\), respectively. Prove that if the points \\(I, X\\), and \\(Y\\) are collinear, then the points \\(I, W\\), and \\(Z\\) are also collinear.", "category": "Geometry", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-n1", "question": "N1. Let \\(n \\geqslant 2\\) be an integer, and let \\(A_{n}\\) be the set\n\n\\[\nA_{n}=\\left\\{2^{n}-2^{k} \\mid k \\in \\mathbb{Z}, \\quad 0 \\leqslant k<n\\right\\}\n\\]\n\nDetermine the largest positive integer that cannot be written as the sum of one or more (not necessarily distinct) elements of \\(A_{n}\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-n2", "question": "N2. Determine all pairs \\((x, y)\\) of positive integers such that\n\n\\[\n\\sqrt[3]{7 x^{2}-13 x y+7 y^{2}}=|x-y|+1\n\\]", "category": "Number Theory", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-n3", "question": "N3. A coin is called a Cape Town coin if its value is \\(1 / n\\) for some positive integer \\(n\\). Given a collection of Cape Town coins of total value at most \\(99+\\frac{1}{2}\\), prove that it is possible to split this collection into at most 100 groups each of total value at most 1.\n(Luxembourg)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-n4", "question": "N4. Let \\(n>1\\) be a given integer. Prove that infinitely many terms of the sequence \\(\\left(a_{k}\\right)_{k \\geqslant 1}\\), defined by\n\n\\[\na_{k}=\\left\\lfloor\\frac{n^{k}}{k}\\right\\rfloor\n\\]\n\nare odd. (For a real number \\(x,\\lfloor x\\rfloor\\) denotes the largest integer not exceeding \\(x\\).)\n(Hong Kong)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-n5", "question": "N5. Find all triples \\((p, x, y)\\) consisting of a prime number \\(p\\) and two positive integers \\(x\\) and \\(y\\) such that \\(x^{p-1}+y\\) and \\(x+y^{p-1}\\) are both powers of \\(p\\).\n(Belgium)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-n6", "question": "N6. Let \\(a_{1}<a_{2}<\\cdots<a_{n}\\) be pairwise coprime positive integers with \\(a_{1}\\) being prime and \\(a_{1} \\geqslant n+2\\). On the segment \\(I=\\left[0, a_{1} a_{2} \\cdots a_{n}\\right]\\) of the real line, mark all integers that are divisible by at least one of the numbers \\(a_{1}, \\ldots, a_{n}\\). These points split \\(I\\) into a number of smaller segments. Prove that the sum of the squares of the lengths of these segments is divisible by \\(a_{1}\\).\n(Serbia)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-n7", "question": "N7. Let \\(c \\geqslant 1\\) be an integer. Define a sequence of positive integers by \\(a_{1}=c\\) and\n\n\\[\na_{n+1}=a_{n}^{3}-4 c \\cdot a_{n}^{2}+5 c^{2} \\cdot a_{n}+c\n\\]\n\nfor all \\(n \\geqslant 1\\). Prove that for each integer \\(n \\geqslant 2\\) there exists a prime number \\(p\\) dividing \\(a_{n}\\) but none of the numbers \\(a_{1}, \\ldots, a_{n-1}\\).\n(Austria)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-n8", "question": "N8. For every real number \\(x\\), let \\(\\|x\\|\\) denote the distance between \\(x\\) and the nearest integer. Prove that for every pair \\((a, b)\\) of positive integers there exist an odd prime \\(p\\) and a positive integer \\(k\\) satisfying\n\n\\[\n\\left\\|\\frac{a}{p^{k}}\\right\\|+\\left\\|\\frac{b}{p^{k}}\\right\\|+\\left\\|\\frac{a+b}{p^{k}}\\right\\|=1\n\\]", "category": "Number Theory", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-a1", "question": "A1. Let \\(z_{0}<z_{1}<z_{2}<\\cdots\\) be an infinite sequence of positive integers. Prove that there exists a unique integer \\(n \\geqslant 1\\) such that\n\n\\[\nz_{n}<\\frac{z_{0}+z_{1}+\\cdots+z_{n}}{n} \\leqslant z_{n+1} .\n\\]", "category": "Algebra", "source": "IMO Shortlist", "year": 2014, "solution": "For \\(n=1,2, \\ldots\\) define\n\n\\[\nd_{n}=\\left(z_{0}+z_{1}+\\cdots+z_{n}\\right)-n z_{n} .\n\\]\n\nThe sign of \\(d_{n}\\) indicates whether the first inequality in (1) holds; i.e., it is satisfied if and only if \\(d_{n}>0\\).\n\nNotice that\n\n\\[\nn z_{n+1}-\\left(z_{0}+z_{1}+\\cdots+z_{n}\\right)=(n+1) z_{n+1}-\\left(z_{0}+z_{1}+\\cdots+z_{n}+z_{n+1}\\right)=-d_{n+1},\n\\]\n\nso the second inequality in (1) is equivalent to \\(d_{n+1} \\leqslant 0\\). Therefore, we have to prove that there is a unique index \\(n \\geqslant 1\\) that satisfies \\(d_{n}>0 \\geqslant d_{n+1}\\).\n\nBy its definition the sequence \\(d_{1}, d_{2}, \\ldots\\) consists of integers and we have\n\n\\[\nd_{1}=\\left(z_{0}+z_{1}\\right)-1 \\cdot z_{1}=z_{0}>0 .\n\\]\n\nFrom\n\\(d_{n+1}-d_{n}=\\left(\\left(z_{0}+\\cdots+z_{n}+z_{n+1}\\right)-(n+1) z_{n+1}\\right)-\\left(\\left(z_{0}+\\cdots+z_{n}\\right)-n z_{n}\\right)=n\\left(z_{n}-z_{n+1}\\right)<0\\) we can see that \\(d_{n+1}<d_{n}\\) and thus the sequence strictly decreases.\n\nHence, we have a decreasing sequence \\(d_{1}>d_{2}>\\ldots\\) of integers such that its first element \\(d_{1}\\) is positive. The sequence must drop below 0 at some point, and thus there is a unique index \\(n\\), that is the index of the last positive term, satisfying \\(d_{n}>0 \\geqslant d_{n+1}\\).\n\nComment. Omitting the assumption that \\(z_{1}, z_{2}, \\ldots\\) are integers allows the numbers \\(d_{n}\\) to be all positive. In such cases the desired \\(n\\) does not exist. This happens for example if \\(z_{n}=2-\\frac{1}{2^{n}}\\) for all integers \\(n \\geqslant 0\\)."}
{"id": "imo-shortlist-2014-a2", "question": "A2. Define the function \\(f:(0,1) \\rightarrow(0,1)\\) by\n\n\\[\nf(x)= \\begin{cases}x+\\frac{1}{2} & \\text { if } x<\\frac{1}{2} \\\\ x^{2} & \\text { if } x \\geqslant \\frac{1}{2}\n\\]\n\nLet \\(a\\) and \\(b\\) be two real numbers such that \\(0<a<b<1\\). We define the sequences \\(a_{n}\\) and \\(b_{n}\\) by \\(a_{0}=a, b_{0}=b\\), and \\(a_{n}=f\\left(a_{n-1}\\right), b_{n}=f\\left(b_{n-1}\\right)\\) for \\(n>0\\). Show that there exists a positive integer \\(n\\) such that\n\n\\[\n\\left(a_{n}-a_{n-1}\\right)\\left(b_{n}-b_{n-1}\\right)<0\n\\]\n\n(Denmark)", "category": "Algebra", "source": "IMO Shortlist", "year": 2014, "solution": "Note that\n\n\\[\nf(x)-x=\\frac{1}{2}>0\n\\]\n\nif \\(x<\\frac{1}{2}\\) and\n\n\\[\nf(x)-x=x^{2}-x<0\n\\]\n\nif \\(x \\geqslant \\frac{1}{2}\\). So if we consider \\((0,1)\\) as being divided into the two subintervals \\(I_{1}=\\left(0, \\frac{1}{2}\\right)\\) and \\(I_{2}=\\left[\\frac{1}{2}, 1\\right)\\), the inequality\n\n\\[\n\\left(a_{n}-a_{n-1}\\right)\\left(b_{n}-b_{n-1}\\right)=\\left(f\\left(a_{n-1}\\right)-a_{n-1}\\right)\\left(f\\left(b_{n-1}\\right)-b_{n-1}\\right)<0\n\\]\n\nholds if and only if \\(a_{n-1}\\) and \\(b_{n-1}\\) lie in distinct subintervals.\nLet us now assume, to the contrary, that \\(a_{k}\\) and \\(b_{k}\\) always lie in the same subinterval. Consider the distance \\(d_{k}=\\left|a_{k}-b_{k}\\right|\\). If both \\(a_{k}\\) and \\(b_{k}\\) lie in \\(I_{1}\\), then\n\n\\[\nd_{k+1}=\\left|a_{k+1}-b_{k+1}\\right|=\\left|a_{k}+\\frac{1}{2}-b_{k}-\\frac{1}{2}\\right|=d_{k}\n\\]\n\nIf, on the other hand, \\(a_{k}\\) and \\(b_{k}\\) both lie in \\(I_{2}\\), then \\(\\min \\left(a_{k}, b_{k}\\right) \\geqslant \\frac{1}{2}\\) and \\(\\max \\left(a_{k}, b_{k}\\right)=\\) \\(\\min \\left(a_{k}, b_{k}\\right)+d_{k} \\geqslant \\frac{1}{2}+d_{k}\\), which implies\n\\(d_{k+1}=\\left|a_{k+1}-b_{k+1}\\right|=\\left|a_{k}^{2}-b_{k}^{2}\\right|=\\left|\\left(a_{k}-b_{k}\\right)\\left(a_{k}+b_{k}\\right)\\right| \\geqslant\\left|a_{k}-b_{k}\\right|\\left(\\frac{1}{2}+\\frac{1}{2}+d_{k}\\right)=d_{k}\\left(1+d_{k}\\right) \\geqslant d_{k}\\).\nThis means that the difference \\(d_{k}\\) is non-decreasing, and in particular \\(d_{k} \\geqslant d_{0}>0\\) for all \\(k\\).\nWe can even say more. If \\(a_{k}\\) and \\(b_{k}\\) lie in \\(I_{2}\\), then\n\n\\[\nd_{k+2} \\geqslant d_{k+1} \\geqslant d_{k}\\left(1+d_{k}\\right) \\geqslant d_{k}\\left(1+d_{0}\\right)\n\\]\n\nIf \\(a_{k}\\) and \\(b_{k}\\) both lie in \\(I_{1}\\), then \\(a_{k+1}\\) and \\(b_{k+1}\\) both lie in \\(I_{2}\\), and so we have\n\n\\[\nd_{k+2} \\geqslant d_{k+1}\\left(1+d_{k+1}\\right) \\geqslant d_{k+1}\\left(1+d_{0}\\right)=d_{k}\\left(1+d_{0}\\right)\n\\]\n\nIn either case, \\(d_{k+2} \\geqslant d_{k}\\left(1+d_{0}\\right)\\), and inductively we get\n\n\\[\nd_{2 m} \\geqslant d_{0}\\left(1+d_{0}\\right)^{m}\n\\]\n\nFor sufficiently large \\(m\\), the right-hand side is greater than 1 , but since \\(a_{2 m}, b_{2 m}\\) both lie in \\((0,1)\\), we must have \\(d_{2 m}<1\\), a contradiction.\n\nThus there must be a positive integer \\(n\\) such that \\(a_{n-1}\\) and \\(b_{n-1}\\) do not lie in the same subinterval, which proves the desired statement."}
{"id": "imo-shortlist-2014-a3", "question": "A3. For a sequence \\(x_{1}, x_{2}, \\ldots, x_{n}\\) of real numbers, we define its price as\n\n\\[\n\\max _{1 \\leqslant i \\leqslant n}\\left|x_{1}+\\cdots+x_{i}\\right| .\n\\]\n\nGiven \\(n\\) real numbers, Dave and George want to arrange them into a sequence with a low price. Diligent Dave checks all possible ways and finds the minimum possible price \\(D\\). Greedy George, on the other hand, chooses \\(x_{1}\\) such that \\(\\left|x_{1}\\right|\\) is as small as possible; among the remaining numbers, he chooses \\(x_{2}\\) such that \\(\\left|x_{1}+x_{2}\\right|\\) is as small as possible, and so on. Thus, in the \\(i^{\\text {th }}\\) step he chooses \\(x_{i}\\) among the remaining numbers so as to minimise the value of \\(\\left|x_{1}+x_{2}+\\cdots+x_{i}\\right|\\). In each step, if several numbers provide the same value, George chooses one at random. Finally he gets a sequence with price \\(G\\).\n\nFind the least possible constant \\(c\\) such that for every positive integer \\(n\\), for every collection of \\(n\\) real numbers, and for every possible sequence that George might obtain, the resulting values satisfy the inequality \\(G \\leqslant c D\\).\n(Georgia)\nAnswer. \\(c=2\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2014, "solution": "If the initial numbers are \\(1,-1,2\\), and -2 , then Dave may arrange them as \\(1,-2,2,-1\\), while George may get the sequence \\(1,-1,2,-2\\), resulting in \\(D=1\\) and \\(G=2\\). So we obtain \\(c \\geqslant 2\\).\n\nTherefore, it remains to prove that \\(G \\leqslant 2 D\\). Let \\(x_{1}, x_{2}, \\ldots, x_{n}\\) be the numbers Dave and George have at their disposal. Assume that Dave and George arrange them into sequences \\(d_{1}, d_{2}, \\ldots, d_{n}\\) and \\(g_{1}, g_{2}, \\ldots, g_{n}\\), respectively. Put\n\n\\[\nM=\\max _{1 \\leqslant i \\leqslant n}\\left|x_{i}\\right|, \\quad S=\\left|x_{1}+\\cdots+x_{n}\\right|, \\quad \\text { and } \\quad N=\\max \\{M, S\\} .\n\\]\n\nWe claim that\n\n\\[\n\\begin{aligned}\n& D \\geqslant S \n& D \\geqslant \\frac{M}{2}, \\quad \\text { and } \n& G \\leqslant N=\\max \\{M, S\\}\n\n\\]\n\nThese inequalities yield the desired estimate, as \\(G \\leqslant \\max \\{M, S\\} \\leqslant \\max \\{M, 2 S\\} \\leqslant 2 D\\).\nThe inequality (1) is a direct consequence of the definition of the price.\nTo prove (2), consider an index \\(i\\) with \\(\\left|d_{i}\\right|=M\\). Then we have\n\n\\[\nM=\\left|d_{i}\\right|=\\left|\\left(d_{1}+\\cdots+d_{i}\\right)-\\left(d_{1}+\\cdots+d_{i-1}\\right)\\right| \\leqslant\\left|d_{1}+\\cdots+d_{i}\\right|+\\left|d_{1}+\\cdots+d_{i-1}\\right| \\leqslant 2 D,\n\\]\n\nas required.\nIt remains to establish (3). Put \\(h_{i}=g_{1}+g_{2}+\\cdots+g_{i}\\). We will prove by induction on \\(i\\) that \\(\\left|h_{i}\\right| \\leqslant N\\). The base case \\(i=1\\) holds, since \\(\\left|h_{1}\\right|=\\left|g_{1}\\right| \\leqslant M \\leqslant N\\). Notice also that \\(\\left|h_{n}\\right|=S \\leqslant N\\).\n\nFor the induction step, assume that \\(\\left|h_{i-1}\\right| \\leqslant N\\). We distinguish two cases.\nCase 1. Assume that no two of the numbers \\(g_{i}, g_{i+1}, \\ldots, g_{n}\\) have opposite signs.\nWithout loss of generality, we may assume that they are all nonnegative. Then one has \\(h_{i-1} \\leqslant h_{i} \\leqslant \\cdots \\leqslant h_{n}\\), thus\n\n\\[\n\\left|h_{i}\\right| \\leqslant \\max \\left\\{\\left|h_{i-1}\\right|,\\left|h_{n}\\right|\\right\\} \\leqslant N .\n\\]\n\nCase 2. Among the numbers \\(g_{i}, g_{i+1}, \\ldots, g_{n}\\) there are positive and negative ones.\n\nThen there exists some index \\(j \\geqslant i\\) such that \\(h_{i-1} g_{j} \\leqslant 0\\). By the definition of George's sequence we have\n\n\\[\n\\left|h_{i}\\right|=\\left|h_{i-1}+g_{i}\\right| \\leqslant\\left|h_{i-1}+g_{j}\\right| \\leqslant \\max \\left\\{\\left|h_{i-1}\\right|,\\left|g_{j}\\right|\\right\\} \\leqslant N .\n\\]\n\nThus, the induction step is established.\n\nComment 1. One can establish the weaker inequalities \\(D \\geqslant \\frac{M}{2}\\) and \\(G \\leqslant D+\\frac{M}{2}\\) from which the result also follows.\n\nComment 2. One may ask a more specific question to find the maximal suitable \\(c\\) if the number \\(n\\) is fixed. For \\(n=1\\) or 2, the answer is \\(c=1\\). For \\(n=3\\), the answer is \\(c=\\frac{3}{2}\\), and it is reached e.g., for the collection \\(1,2,-4\\). Finally, for \\(n \\geqslant 4\\) the answer is \\(c=2\\). In this case the arguments from the solution above apply, and the answer is reached e.g., for the same collection \\(1,-1,2,-2\\), augmented by several zeroes."}
{"id": "imo-shortlist-2014-a4", "question": "A4. Determine all functions \\(f: \\mathbb{Z} \\rightarrow \\mathbb{Z}\\) satisfying\n\n\\[\nf(f(m)+n)+f(m)=f(n)+f(3 m)+2014\n\\]\n\nfor all integers \\(m\\) and \\(n\\).\n(Netherlands)\nAnswer. There is only one such function, namely \\(n \\longmapsto 2 n+1007\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2014, "solution": "Let \\(f\\) be a function satisfying (1). Set \\(C=1007\\) and define the function \\(g: \\mathbb{Z} \\rightarrow \\mathbb{Z}\\) by \\(g(m)=f(3 m)-f(m)+2 C\\) for all \\(m \\in \\mathbb{Z}\\); in particular, \\(g(0)=2 C\\). Now (1) rewrites as\n\n\\[\nf(f(m)+n)=g(m)+f(n)\n\\]\n\nfor all \\(m, n \\in \\mathbb{Z}\\). By induction in both directions it follows that\n\n\\[\nf(t f(m)+n)=t g(m)+f(n)\n\\]\n\nholds for all \\(m, n, t \\in \\mathbb{Z}\\). Applying this, for any \\(r \\in \\mathbb{Z}\\), to the triples \\((r, 0, f(0))\\) and \\((0,0, f(r))\\) in place of ( \\(m, n, t\\) ) we obtain\n\n\\[\nf(0) g(r)=f(f(r) f(0))-f(0)=f(r) g(0)\n\\]\n\nNow if \\(f(0)\\) vanished, then \\(g(0)=2 C>0\\) would entail that \\(f\\) vanishes identically, contrary to (1). Thus \\(f(0) \\neq 0\\) and the previous equation yields \\(g(r)=\\alpha f(r)\\), where \\(\\alpha=\\frac{g(0)}{f(0)}\\) is some nonzero constant.\n\nSo the definition of \\(g\\) reveals \\(f(3 m)=(1+\\alpha) f(m)-2 C\\), i.e.,\n\n\\[\nf(3 m)-\\beta=(1+\\alpha)(f(m)-\\beta)\n\\]\n\nfor all \\(m \\in \\mathbb{Z}\\), where \\(\\beta=\\frac{2 C}{\\alpha}\\). By induction on \\(k\\) this implies\n\n\\[\nf\\left(3^{k} m\\right)-\\beta=(1+\\alpha)^{k}(f(m)-\\beta)\n\\]\n\nfor all integers \\(k \\geqslant 0\\) and \\(m\\).\nSince \\(3 \\nmid 2014\\), there exists by (1) some value \\(d=f(a)\\) attained by \\(f\\) that is not divisible by 3 . Now by (2) we have \\(f(n+t d)=f(n)+t g(a)=f(n)+\\alpha \\cdot t f(a)\\), i.e.,\n\n\\[\nf(n+t d)=f(n)+\\alpha \\cdot t d\n\\]\n\nfor all \\(n, t \\in \\mathbb{Z}\\).\nLet us fix any positive integer \\(k\\) with \\(d \\mid\\left(3^{k}-1\\right)\\), which is possible, since \\(\\operatorname{gcd}(3, d)=1\\). E.g., by the Euler-Fermat theorem, we may take \\(k=\\varphi(|d|)\\). Now for each \\(m \\in \\mathbb{Z}\\) we get\n\n\\[\nf\\left(3^{k} m\\right)=f(m)+\\alpha\\left(3^{k}-1\\right) m\n\\]\n\nfrom (5), which in view of (4) yields \\(\\left((1+\\alpha)^{k}-1\\right)(f(m)-\\beta)=\\alpha\\left(3^{k}-1\\right) m\\). Since \\(\\alpha \\neq 0\\), the right hand side does not vanish for \\(m \\neq 0\\), wherefore the first factor on the left hand side cannot vanish either. It follows that\n\n\\[\nf(m)=\\frac{\\alpha\\left(3^{k}-1\\right)}{(1+\\alpha)^{k}-1} \\cdot m+\\beta\n\\]\n\nSo \\(f\\) is a linear function, say \\(f(m)=A m+\\beta\\) for all \\(m \\in \\mathbb{Z}\\) with some constant \\(A \\in \\mathbb{Q}\\). Plugging this into (1) one obtains \\(\\left(A^{2}-2 A\\right) m+(A \\beta-2 C)=0\\) for all \\(m\\), which is equivalent to the conjunction of\n\n\\[\nA^{2}=2 A \\quad \\text { and } \\quad A \\beta=2 C\n\\]\n\nThe first equation is equivalent to \\(A \\in\\{0,2\\}\\), and as \\(C \\neq 0\\) the second one gives\n\n\\[\nA=2 \\quad \\text { and } \\quad \\beta=C\n\\]\n\nThis shows that \\(f\\) is indeed the function mentioned in the answer and as the numbers found in (7) do indeed satisfy the equations (6) this function is indeed as desired.\n\nComment 1. One may see that \\(\\alpha=2\\). A more pedestrian version of the above solution starts with a direct proof of this fact, that can be obtained by substituting some special values into (1), e.g., as follows.\n\nSet \\(D=f(0)\\). Plugging \\(m=0\\) into (1) and simplifying, we get\n\n\\[\nf(n+D)=f(n)+2 C\n\\]\n\nfor all \\(n \\in \\mathbb{Z}\\). In particular, for \\(n=0, D, 2 D\\) we obtain \\(f(D)=2 C+D, f(2 D)=f(D)+2 C=4 C+D\\), and \\(f(3 D)=f(2 D)+2 C=6 C+D\\). So substituting \\(m=D\\) and \\(n=r-D\\) into (1) and applying (8) with \\(n=r-D\\) afterwards we learn\n\n\\[\nf(r+2 C)+2 C+D=(f(r)-2 C)+(6 C+D)+2 C\n\\]\n\ni.e., \\(f(r+2 C)=f(r)+4 C\\). By induction in both directions it follows that\n\n\\[\nf(n+2 C t)=f(n)+4 C t\n\\]\n\nholds for all \\(n, t \\in \\mathbb{Z}\\).\nClaim. If \\(a\\) and \\(b\\) denote two integers with the property that \\(f(n+a)=f(n)+b\\) holds for all \\(n \\in \\mathbb{Z}\\), then \\(b=2 a\\).\nProof. Applying induction in both directions to the assumption we get \\(f(n+t a)=f(n)+t b\\) for all \\(n, t \\in \\mathbb{Z}\\). Plugging \\((n, t)=(0,2 C)\\) into this equation and \\((n, t)=(0, a)\\) into \\((9)\\) we get \\(f(2 a C)-f(0)=\\) \\(2 b C=4 a C\\), and, as \\(C \\neq 0\\), the claim follows.\n\nNow by (1), for any \\(m \\in \\mathbb{Z}\\), the numbers \\(a=f(m)\\) and \\(b=f(3 m)-f(m)+2 C\\) have the property mentioned in the claim, whence we have\n\n\\[\nf(3 m)-C=3(f(m)-C)\n\\]\n\nIn view of (3) this tells us indeed that \\(\\alpha=2\\).\nNow the solution may be completed as above, but due to our knowledge of \\(\\alpha=2\\) we get the desired formula \\(f(m)=2 m+C\\) directly without having the need to go through all linear functions. Now it just remains to check that this function does indeed satisfy (1).\n\nComment 2. It is natural to wonder what happens if one replaces the number 2014 appearing in the statement of the problem by some arbitrary integer \\(B\\).\n\nIf \\(B\\) is odd, there is no such function, as can be seen by using the same ideas as in the above solution.\n\nIf \\(B \\neq 0\\) is even, however, then the only such function is given by \\(n \\longmapsto 2 n+B / 2\\). In case \\(3 \\nmid B\\) this was essentially proved above, but for the general case one more idea seems to be necessary. Writing \\(B=3^{\\nu} \\cdot k\\) with some integers \\(\\nu\\) and \\(k\\) such that \\(3 \\nmid k\\) one can obtain \\(f(n)=2 n+B / 2\\) for all \\(n\\) that are divisible by \\(3^{\\nu}\\) in the same manner as usual; then one may use the formula \\(f(3 n)=3 f(n)-B\\) to establish the remaining cases.\n\nFinally, in case \\(B=0\\) there are more solutions than just the function \\(n \\longmapsto 2 n\\). It can be shown that all these other functions are periodic; to mention just one kind of example, for any even integers \\(r\\) and \\(s\\) the function\n\n\\[\nf(n)= \\begin{cases}r & \\text { if } n \\text { is even } \\\\ s & \\text { if } n \\text { is odd }\n\\]\n\nalso has the property under discussion."}
{"id": "imo-shortlist-2014-a5", "question": "A5. Consider all polynomials \\(P(x)\\) with real coefficients that have the following property: for any two real numbers \\(x\\) and \\(y\\) one has\n\n\\[\n\\left|y^{2}-P(x)\\right| \\leqslant 2|x| \\quad \\text { if and only if } \\quad\\left|x^{2}-P(y)\\right| \\leqslant 2|y|\n\\]\n\nDetermine all possible values of \\(P(0)\\).\n(Belgium)\nAnswer. The set of possible values of \\(P(0)\\) is \\((-\\infty, 0) \\cup\\{1\\}\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2014-c1", "question": "C1. Let \\(n\\) points be given inside a rectangle \\(R\\) such that no two of them lie on a line parallel to one of the sides of \\(R\\). The rectangle \\(R\\) is to be dissected into smaller rectangles with sides parallel to the sides of \\(R\\) in such a way that none of these rectangles contains any of the given points in its interior. Prove that we have to dissect \\(R\\) into at least \\(n+1\\) smaller rectangles.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2014, "solution": "Let \\(k\\) be the number of rectangles in the dissection. The set of all points that are corners of one of the rectangles can be divided into three disjoint subsets:\n\n\\begin{itemize}\n  \\item \\(A\\), which consists of the four corners of the original rectangle \\(R\\), each of which is the corner of exactly one of the smaller rectangles,\n  \\item \\(B\\), which contains points where exactly two of the rectangles have a common corner (T-junctions, see the figure below),\n  \\item \\(C\\), which contains points where four of the rectangles have a common corner (crossings, see the figure below).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-27}\n\n\nFigure 1: A T-junction and a crossing\n\nWe denote the number of points in \\(B\\) by \\(b\\) and the number of points in \\(C\\) by \\(c\\). Since each of the \\(k\\) rectangles has exactly four corners, we get\n\n\\[\n4 k=4+2 b+4 c .\n\\]\n\nIt follows that \\(2 b \\leqslant 4 k-4\\), so \\(b \\leqslant 2 k-2\\).\nEach of the \\(n\\) given points has to lie on a side of one of the smaller rectangles (but not of the original rectangle \\(R\\) ). If we extend this side as far as possible along borders between rectangles, we obtain a line segment whose ends are T-junctions. Note that every point in \\(B\\) can only be an endpoint of at most one such segment containing one of the given points, since it is stated that no two of them lie on a common line parallel to the sides of \\(R\\). This means that\n\n\\[\nb \\geqslant 2 n .\n\\]\n\nCombining our two inequalities for \\(b\\), we get\n\n\\[\n2 k-2 \\geqslant b \\geqslant 2 n,\n\\]\n\nthus \\(k \\geqslant n+1\\), which is what we wanted to prove.\n\nSolution 2. Let \\(k\\) denote the number of rectangles. In the following, we refer to the directions of the sides of \\(R\\) as 'horizontal' and 'vertical' respectively. Our goal is to prove the inequality \\(k \\geqslant n+1\\) for fixed \\(n\\). Equivalently, we can prove the inequality \\(n \\leqslant k-1\\) for each \\(k\\), which will be done by induction on \\(k\\). For \\(k=1\\), the statement is trivial.\n\nNow assume that \\(k>1\\). If none of the line segments that form the borders between the rectangles is horizontal, then we have \\(k-1\\) vertical segments dividing \\(R\\) into \\(k\\) rectangles. On each of them, there can only be one of the \\(n\\) points, so \\(n \\leqslant k-1\\), which is exactly what we want to prove.\n\nOtherwise, consider the lowest horizontal line \\(h\\) that contains one or more of these line segments. Let \\(R^{\\prime}\\) be the rectangle that results when everything that lies below \\(h\\) is removed from \\(R\\) (see the example in the figure below).\n\nThe rectangles that lie entirely below \\(h\\) form blocks of rectangles separated by vertical line segments. Suppose there are \\(r\\) blocks and \\(k_{i}\\) rectangles in the \\(i^{\\text {th }}\\) block. The left and right border of each block has to extend further upwards beyond \\(h\\). Thus we can move any points that lie on these borders upwards, so that they now lie inside \\(R^{\\prime}\\). This can be done without violating the conditions, one only needs to make sure that they do not get to lie on a common horizontal line with one of the other given points.\n\nAll other borders between rectangles in the \\(i^{\\text {th }}\\) block have to lie entirely below \\(h\\). There are \\(k_{i}-1\\) such line segments, each of which can contain at most one of the given points. Finally, there can be one point that lies on \\(h\\). All other points have to lie in \\(R^{\\prime}\\) (after moving some of them as explained in the previous paragraph).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-28}\n\nFigure 2: Illustration of the inductive argument\nWe see that \\(R^{\\prime}\\) is divided into \\(k-\\sum_{i=1}^{r} k_{i}\\) rectangles. Applying the induction hypothesis to \\(R^{\\prime}\\), we find that there are at most\n\n\\[\n\\left(k-\\sum_{i=1}^{r} k_{i}\\right)-1+\\sum_{i=1}^{r}\\left(k_{i}-1\\right)+1=k-r\n\\]\n\npoints. Since \\(r \\geqslant 1\\), this means that \\(n \\leqslant k-1\\), which completes our induction."}
{"id": "imo-shortlist-2014-c2", "question": "C2. We have \\(2^{m}\\) sheets of paper, with the number 1 written on each of them. We perform the following operation. In every step we choose two distinct sheets; if the numbers on the two sheets are \\(a\\) and \\(b\\), then we erase these numbers and write the number \\(a+b\\) on both sheets. Prove that after \\(m 2^{m-1}\\) steps, the sum of the numbers on all the sheets is at least \\(4^{m}\\).\n(Iran)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2014, "solution": "Let \\(P_{k}\\) be the product of the numbers on the sheets after \\(k\\) steps.\nSuppose that in the \\((k+1)^{\\text {th }}\\) step the numbers \\(a\\) and \\(b\\) are replaced by \\(a+b\\). In the product, the number \\(a b\\) is replaced by \\((a+b)^{2}\\), and the other factors do not change. Since \\((a+b)^{2} \\geqslant 4 a b\\), we see that \\(P_{k+1} \\geqslant 4 P_{k}\\). Starting with \\(P_{0}=1\\), a straightforward induction yields\n\n\\[\nP_{k} \\geqslant 4^{k}\n\\]\n\nfor all integers \\(k \\geqslant 0\\); in particular\n\n\\[\nP_{m \\cdot 2^{m-1}} \\geqslant 4^{m \\cdot 2^{m-1}}=\\left(2^{m}\\right)^{2^{m}}\n\\]\n\nso by the AM-GM inequality, the sum of the numbers written on the sheets after \\(m 2^{m-1}\\) steps is at least\n\n\\[\n2^{m} \\cdot \\sqrt[2^{m}]{P_{m \\cdot 2^{m-1}}} \\geqslant 2^{m} \\cdot 2^{m}=4^{m}\n\\]\n\nComment 1. It is possible to achieve the sum \\(4^{m}\\) in \\(m 2^{m-1}\\) steps. For example, starting from \\(2^{m}\\) equal numbers on the sheets, in \\(2^{m-1}\\) consecutive steps we can double all numbers. After \\(m\\) such doubling rounds we have the number \\(2^{m}\\) on every sheet.\n\nComment 2. There are several versions of the solution above. E.g., one may try to assign to each positive integer \\(n\\) a weight \\(w_{n}\\) in such a way that the sum of the weights of the numbers written on the sheets increases, say, by at least 2 in each step. For this purpose, one needs the inequality\n\n\\[\n2 w_{a+b} \\geqslant w_{a}+w_{b}+2\n\\]\n\nto be satisfied for all positive integers \\(a\\) and \\(b\\).\nStarting from \\(w_{1}=1\\) and trying to choose the weights as small as possible, one may find that these weights can be defined as follows: For every positive integer \\(n\\), one chooses \\(k\\) to be the maximal integer such that \\(n \\geqslant 2^{k}\\), and puts\n\n\\[\nw_{n}=k+\\frac{n}{2^{k}}=\\min _{d \\in \\mathbb{Z} \\geqslant 0}\\left(d+\\frac{n}{2^{d}}\\right) .\n\\]\n\nNow, in order to prove that these weights satisfy (1), one may take arbitrary positive integers \\(a\\) and \\(b\\), and choose an integer \\(d \\geqslant 0\\) such that \\(w_{a+b}=d+\\frac{a+b}{2^{d}}\\). Then one has\n\n\\[\n2 w_{a+b}=2 d+2 \\cdot \\frac{a+b}{2^{d}}=\\left((d-1)+\\frac{a}{2^{d-1}}\\right)+\\left((d-1)+\\frac{b}{2^{d-1}}\\right)+2 \\geqslant w_{a}+w_{b}+2 .\n\\]\n\nSince the initial sum of the weights was \\(2^{m}\\), after \\(m 2^{m-1}\\) steps the sum is at least \\((m+1) 2^{m}\\). To finish the solution, one may notice that by (2) for every positive integer \\(a\\) one has\n\n\\[\nw_{a} \\leqslant m+\\frac{a}{2^{m}}, \\quad \\text { i.e., } \\quad a \\geqslant 2^{m}\\left(-m+w_{a}\\right) .\n\\]\n\nSo the sum of the numbers \\(a_{1}, a_{2}, \\ldots, a_{2^{m}}\\) on the sheets can be estimated as\n\n\\[\n\\sum_{i=1}^{2^{m}} a_{i} \\geqslant \\sum_{i=1}^{2^{m}} 2^{m}\\left(-m+w_{a_{i}}\\right)=-m 2^{m} \\cdot 2^{m}+2^{m} \\sum_{i=1}^{2^{m}} w_{a_{i}} \\geqslant-m 4^{m}+(m+1) 4^{m}=4^{m}\n\\]\n\nas required.\nFor establishing the inequalities (1) and (3), one may also use the convexity argument, instead of the second definition of \\(w_{n}\\) in (2).\n\nOne may check that \\(\\log _{2} n \\leqslant w_{n} \\leqslant \\log _{2} n+1\\); thus, in some rough sense, this approach is obtained by \"taking the logarithm\" of the solution above.\n\nComment 3. An intuitive strategy to minimise the sum of numbers is that in every step we choose the two smallest numbers. We may call this the greedy strategy. In the following paragraphs we prove that the greedy strategy indeed provides the least possible sum of numbers.\n\nClaim. Starting from any sequence \\(x_{1}, \\ldots, x_{N}\\) of positive real numbers on \\(N\\) sheets, for any number \\(k\\) of steps, the greedy strategy achieves the lowest possible sum of numbers.\n\nProof. We apply induction on \\(k\\); for \\(k=1\\) the statement is obvious. Let \\(k \\geqslant 2\\), and assume that the claim is true for smaller values.\n\nEvery sequence of \\(k\\) steps can be encoded as \\(S=\\left(\\left(i_{1}, j_{1}\\right), \\ldots,\\left(i_{k}, j_{k}\\right)\\right)\\), where, for \\(r=1,2, \\ldots, k\\), the numbers \\(i_{r}\\) and \\(j_{r}\\) are the indices of the two sheets that are chosen in the \\(r^{\\text {th }}\\) step. The resulting final sum will be some linear combination of \\(x_{1}, \\ldots, x_{N}\\), say, \\(c_{1} x_{1}+\\cdots+c_{N} x_{N}\\) with positive integers \\(c_{1}, \\ldots, c_{N}\\) that depend on \\(S\\) only. Call the numbers \\(\\left(c_{1}, \\ldots, c_{N}\\right)\\) the characteristic vector of \\(S\\).\n\nChoose a sequence \\(S_{0}=\\left(\\left(i_{1}, j_{1}\\right), \\ldots,\\left(i_{k}, j_{k}\\right)\\right)\\) of steps that produces the minimal sum, starting from \\(x_{1}, \\ldots, x_{N}\\), and let \\(\\left(c_{1}, \\ldots, c_{N}\\right)\\) be the characteristic vector of \\(S\\). We may assume that the sheets are indexed in such an order that \\(c_{1} \\geqslant c_{2} \\geqslant \\cdots \\geqslant c_{N}\\). If the sheets (and the numbers) are permuted by a permutation \\(\\pi\\) of the indices \\((1,2, \\ldots, N)\\) and then the same steps are performed, we can obtain the sum \\(\\sum_{t=1}^{N} c_{t} x_{\\pi(t)}\\). By the rearrangement inequality, the smallest possible sum can be achieved when the numbers \\(\\left(x_{1}, \\ldots, x_{N}\\right)\\) are in non-decreasing order. So we can assume that also \\(x_{1} \\leqslant x_{2} \\leqslant \\cdots \\leqslant x_{N}\\).\n\nLet \\(\\ell\\) be the largest index with \\(c_{1}=\\cdots=c_{\\ell}\\), and let the \\(r^{\\text {th }}\\) step be the first step for which \\(c_{i_{r}}=c_{1}\\) or \\(c_{j_{r}}=c_{1}\\). The role of \\(i_{r}\\) and \\(j_{r}\\) is symmetrical, so we can assume \\(c_{i_{r}}=c_{1}\\) and thus \\(i_{r} \\leqslant \\ell\\). We show that \\(c_{j_{r}}=c_{1}\\) and \\(j_{r} \\leqslant \\ell\\) hold, too.\n\nBefore the \\(r^{\\text {th }}\\) step, on the \\(i_{r}{ }^{\\text {th }}\\) sheet we had the number \\(x_{i_{r}}\\). On the \\(j_{r}{ }^{\\text {th }}\\) sheet there was a linear combination that contains the number \\(x_{j_{r}}\\) with a positive integer coefficient, and possibly some other terms. In the \\(r^{\\text {th }}\\) step, the number \\(x_{i_{r}}\\) joins that linear combination. From this point, each sheet contains a linear combination of \\(x_{1}, \\ldots, x_{N}\\), with the coefficient of \\(x_{j_{r}}\\) being not smaller than the coefficient of \\(x_{i_{r}}\\). This is preserved to the end of the procedure, so we have \\(c_{j_{r}} \\geqslant c_{i_{r}}\\). But \\(c_{i_{r}}=c_{1}\\) is maximal among the coefficients, so we have \\(c_{j_{r}}=c_{i_{r}}=c_{1}\\) and thus \\(j_{r} \\leqslant \\ell\\).\n\nEither from \\(c_{j_{r}}=c_{i_{r}}=c_{1}\\) or from the arguments in the previous paragraph we can see that none of the \\(i_{r}{ }^{\\text {th }}\\) and the \\(j_{r}{ }^{\\text {th }}\\) sheets were used before step \\(r\\). Therefore, the final linear combination of the numbers does not change if the step \\(\\left(i_{r}, j_{r}\\right)\\) is performed first: the sequence of steps\n\n\\[\nS_{1}=\\left(\\left(i_{r}, j_{r}\\right),\\left(i_{1}, j_{1}\\right), \\ldots,\\left(i_{r-1}, j_{r-1}\\right),\\left(i_{r+1}, j_{r+1}\\right), \\ldots,\\left(i_{N}, j_{N}\\right)\\right)\n\\]\n\nalso produces the same minimal sum at the end. Therefore, we can replace \\(S_{0}\\) by \\(S_{1}\\) and we may assume that \\(r=1\\) and \\(c_{i_{1}}=c_{j_{1}}=c_{1}\\).\n\nAs \\(i_{1} \\neq j_{1}\\), we can see that \\(\\ell \\geqslant 2\\) and \\(c_{1}=c_{2}=c_{i_{1}}=c_{j_{1}}\\). Let \\(\\pi\\) be such a permutation of the indices \\((1,2, \\ldots, N)\\) that exchanges 1,2 with \\(i_{r}, j_{r}\\) and does not change the remaining indices. Let\n\n\\[\nS_{2}=\\left(\\left(\\pi\\left(i_{1}\\right), \\pi\\left(j_{1}\\right)\\right), \\ldots,\\left(\\pi\\left(i_{N}\\right), \\pi\\left(j_{N}\\right)\\right)\\right)\n\\]\n\nSince \\(c_{\\pi(i)}=c_{i}\\) for all indices \\(i\\), this sequence of steps produces the same, minimal sum. Moreover, in the first step we chose \\(x_{\\pi\\left(i_{1}\\right)}=x_{1}\\) and \\(x_{\\pi\\left(j_{1}\\right)}=x_{2}\\), the two smallest numbers.\n\nHence, it is possible to achieve the optimal sum if we follow the greedy strategy in the first step. By the induction hypothesis, following the greedy strategy in the remaining steps we achieve the optimal sum."}
{"id": "imo-shortlist-2014-c3", "question": "C3. Let \\(n \\geqslant 2\\) be an integer. Consider an \\(n \\times n\\) chessboard divided into \\(n^{2}\\) unit squares. We call a configuration of \\(n\\) rooks on this board happy if every row and every column contains exactly one rook. Find the greatest positive integer \\(k\\) such that for every happy configuration of rooks, we can find a \\(k \\times k\\) square without a rook on any of its \\(k^{2}\\) unit squares.\n(Croatia)\nAnswer. \\(\\lfloor\\sqrt{n-1}\\rfloor\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2014, "solution": "Let \\(\\ell\\) be a positive integer. We will show that (i) if \\(n>\\ell^{2}\\) then each happy configuration contains an empty \\(\\ell \\times \\ell\\) square, but (ii) if \\(n \\leqslant \\ell^{2}\\) then there exists a happy configuration not containing such a square. These two statements together yield the answer.\n(i). Assume that \\(n>\\ell^{2}\\). Consider any happy configuration. There exists a row \\(R\\) containing a rook in its leftmost square. Take \\(\\ell\\) consecutive rows with \\(R\\) being one of them. Their union \\(U\\) contains exactly \\(\\ell\\) rooks. Now remove the \\(n-\\ell^{2} \\geqslant 1\\) leftmost columns from \\(U\\) (thus at least one rook is also removed). The remaining part is an \\(\\ell^{2} \\times \\ell\\) rectangle, so it can be split into \\(\\ell\\) squares of size \\(\\ell \\times \\ell\\), and this part contains at most \\(\\ell-1\\) rooks. Thus one of these squares is empty.\n(ii). Now we assume that \\(n \\leqslant \\ell^{2}\\). Firstly, we will construct a happy configuration with no empty \\(\\ell \\times \\ell\\) square for the case \\(n=\\ell^{2}\\). After that we will modify it to work for smaller values of \\(n\\).\n\nLet us enumerate the rows from bottom to top as well as the columns from left to right by the numbers \\(0,1, \\ldots, \\ell^{2}-1\\). Every square will be denoted, as usual, by the pair ( \\(r, c\\) ) of its row and column numbers. Now we put the rooks on all squares of the form ( \\(i \\ell+j, j \\ell+i\\) ) with \\(i, j=0,1, \\ldots, \\ell-1\\) (the picture below represents this arrangement for \\(\\ell=3\\) ). Since each number from 0 to \\(\\ell^{2}-1\\) has a unique representation of the form \\(i \\ell+j(0 \\leqslant i, j \\leqslant \\ell-1)\\), each row and each column contains exactly one rook.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-31}\n\nNext, we show that each \\(\\ell \\times \\ell\\) square \\(A\\) on the board contains a rook. Consider such a square \\(A\\), and consider \\(\\ell\\) consecutive rows the union of which contains \\(A\\). Let the lowest of these rows have number \\(p l+q\\) with \\(0 \\leqslant p, q \\leqslant l-1\\) (notice that \\(p l+q \\leqslant \\ell^{2}-\\ell\\) ). Then the rooks in this union are placed in the columns with numbers \\(q \\ell+p,(q+1) \\ell+p, \\ldots,(\\ell-1) \\ell+p\\), \\(p+1, \\ell+(p+1), \\ldots,(q-1) \\ell+p+1\\), or, putting these numbers in increasing order,\n\n\\[\np+1, \\ell+(p+1), \\ldots,(q-1) \\ell+(p+1), q \\ell+p,(q+1) \\ell+p, \\ldots,(\\ell-1) \\ell+p .\n\\]\n\nOne readily checks that the first number in this list is at most \\(\\ell-1\\) (if \\(p=\\ell-1\\), then \\(q=0\\), and the first listed number is \\(q \\ell+p=\\ell-1\\) ), the last one is at least ( \\(\\ell-1) \\ell\\), and the difference between any two consecutive numbers is at most \\(\\ell\\). Thus, one of the \\(\\ell\\) consecutive columns intersecting \\(A\\) contains a number listed above, and the rook in this column is inside \\(A\\), as required. The construction for \\(n=\\ell^{2}\\) is established.\n\nIt remains to construct a happy configuration of rooks not containing an empty \\(\\ell \\times \\ell\\) square for \\(n<\\ell^{2}\\). In order to achieve this, take the construction for an \\(\\ell^{2} \\times \\ell^{2}\\) square described above and remove the \\(\\ell^{2}-n\\) bottom rows together with the \\(\\ell^{2}-n\\) rightmost columns. We will have a rook arrangement with no empty \\(\\ell \\times \\ell\\) square, but several rows and columns may happen to be empty. Clearly, the number of empty rows is equal to the number of empty columns, so one can find a bijection between them, and put a rook on any crossing of an empty row and an empty column corresponding to each other.\n\nComment. Part (i) allows several different proofs. E.g., in the last paragraph of the solution, it suffices to deal only with the case \\(n=\\ell^{2}+1\\). Notice now that among the four corner squares, at least one is empty. So the rooks in its row and in its column are distinct. Now, deleting this row and column we obtain an \\(\\ell^{2} \\times \\ell^{2}\\) square with \\(\\ell^{2}-1\\) rooks in it. This square can be partitioned into \\(\\ell^{2}\\) squares of size \\(\\ell \\times \\ell\\), so one of them is empty."}
{"id": "imo-shortlist-2014-c4", "question": "C4. Construct a tetromino by attaching two \\(2 \\times 1\\) dominoes along their longer sides such that the midpoint of the longer side of one domino is a corner of the other domino. This construction yields two kinds of tetrominoes with opposite orientations. Let us call them Sand Z-tetrominoes, respectively.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-33}\n\nS-tetrominoes\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-33(1)}\n\nZ-tetrominoes\n\nAssume that a lattice polygon \\(P\\) can be tiled with S-tetrominoes. Prove than no matter how we tile \\(P\\) using only S- and Z-tetrominoes, we always use an even number of Z-tetrominoes.\n(Hungary)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2014, "solution": "We may assume that polygon \\(P\\) is the union of some squares of an infinite chessboard. Colour the squares of the chessboard with two colours as the figure below illustrates.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-33(3)}\n\nObserve that no matter how we tile \\(P\\), any S-tetromino covers an even number of black squares, whereas any Z-tetromino covers an odd number of them. As \\(P\\) can be tiled exclusively by S-tetrominoes, it contains an even number of black squares. But if some S-tetrominoes and some Z-tetrominoes cover an even number of black squares, then the number of Z-tetrominoes must be even.\n\nComment. An alternative approach makes use of the following two colourings, which are perhaps somewhat more natural:\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-33(2)}\n\nLet \\(s_{1}\\) and \\(s_{2}\\) be the number of \\(S\\)-tetrominoes of the first and second type (as shown in the figure above) respectively that are used in a tiling of \\(P\\). Likewise, let \\(z_{1}\\) and \\(z_{2}\\) be the number of \\(Z\\)-tetrominoes of the first and second type respectively. The first colouring shows that \\(s_{1}+z_{2}\\) is invariant modulo 2 , the second colouring shows that \\(s_{1}+z_{1}\\) is invariant modulo 2. Adding these two conditions, we find that \\(z_{1}+z_{2}\\) is invariant modulo 2 , which is what we have to prove. Indeed, the sum of the two colourings (regarding white as 0 and black as 1 and adding modulo 2) is the colouring shown in the solution.\n\nSolution 2. Let us assign coordinates to the squares of the infinite chessboard in such a way that the squares of \\(P\\) have nonnegative coordinates only, and that the first coordinate increases as one moves to the right, while the second coordinate increases as one moves upwards. Write the integer \\(3^{i} \\cdot(-3)^{j}\\) into the square with coordinates \\((i, j)\\), as in the following figure:\n\n\\begin{center}\n\\begin{tabular}{|c|c|c|c|c|c}\n\\(\\vdots\\) &  &  &  &  &  \n\\hline\n81 & \\(\\vdots\\) &  &  &  &  \n\\hline\n-27 & -81 & \\(\\vdots\\) &  &  &  \n\\hline\n9 & 27 & 81 & \\(\\ldots\\) &  &  \n\\hline\n-3 & -9 & -27 & -81 & \\(\\ldots\\) &  \n\\hline\n1 & 3 & 9 & 27 & 81 & \\(\\ldots\\) \n\\hline\n\n\n\nThe sum of the numbers written into four squares that can be covered by an \\(S\\)-tetromino is either of the form\n\n\\[\n3^{i} \\cdot(-3)^{j} \\cdot\\left(1+3+3 \\cdot(-3)+3^{2} \\cdot(-3)\\right)=-32 \\cdot 3^{i} \\cdot(-3)^{j}\n\\]\n\n(for the first type of \\(S\\)-tetrominoes), or of the form\n\n\\[\n3^{i} \\cdot(-3)^{j} \\cdot\\left(3+3 \\cdot(-3)+(-3)+(-3)^{2}\\right)=0\n\\]\n\nand thus divisible by 32 . For this reason, the sum of the numbers written into the squares of \\(P\\), and thus also the sum of the numbers covered by \\(Z\\)-tetrominoes in the second covering, is likewise divisible by 32 . Now the sum of the entries of a \\(Z\\)-tetromino is either of the form\n\n\\[\n3^{i} \\cdot(-3)^{j} \\cdot\\left(3+3^{2}+(-3)+3 \\cdot(-3)\\right)=0\n\\]\n\n(for the first type of Z-tetrominoes), or of the form\n\n\\[\n3^{i} \\cdot(-3)^{j} \\cdot\\left(1+(-3)+3 \\cdot(-3)+3 \\cdot(-3)^{2}\\right)=16 \\cdot 3^{i} \\cdot(-3)^{j}\n\\]\n\ni.e., 16 times an odd number. Thus in order to obtain a total that is divisible by 32 , an even number of the latter kind of \\(Z\\)-tetrominoes needs to be used. Rotating everything by \\(90^{\\circ}\\), we find that the number of \\(Z\\)-tetrominoes of the first kind is even as well. So we have even proven slightly more than necessary.\n\nComment 1. In the second solution, 3 and -3 can be replaced by other combinations as well. For example, for any positive integer \\(a \\equiv 3(\\bmod 4)\\), we can write \\(a^{i} \\cdot(-a)^{j}\\) into the square with coordinates \\((i, j)\\) and apply the same argument.\n\nComment 2. As the second solution shows, we even have the stronger result that the parity of the number of each of the four types of tetrominoes in a tiling of \\(P\\) by S- and Z-tetrominoes is an invariant of \\(P\\). This also remains true if there is no tiling of \\(P\\) that uses only S-tetrominoes."}
{"id": "imo-shortlist-2014-c5", "question": "C5. Consider \\(n \\geqslant 3\\) lines in the plane such that no two lines are parallel and no three have a common point. These lines divide the plane into polygonal regions; let \\(\\mathcal{F}\\) be the set of regions having finite area. Prove that it is possible to colour \\(\\lceil\\sqrt{n / 2}\\rceil\\) of the lines blue in such a way that no region in \\(\\mathcal{F}\\) has a completely blue boundary. (For a real number \\(x,\\lceil x\\rceil\\) denotes the least integer which is not smaller than \\(x\\).)\n(Austria)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2014, "solution": "Let \\(L\\) be the given set of lines. Choose a maximal (by inclusion) subset \\(B \\subseteq L\\) such that when we colour the lines of \\(B\\) blue, no region in \\(\\mathcal{F}\\) has a completely blue boundary. Let \\(|B|=k\\). We claim that \\(k \\geqslant\\lceil\\sqrt{n / 2}\\rceil\\).\n\nLet us colour all the lines of \\(L \\backslash B\\) red. Call a point blue if it is the intersection of two blue lines. Then there are \\(\\binom{k}{2}\\) blue points.\n\nNow consider any red line \\(\\ell\\). By the maximality of \\(B\\), there exists at least one region \\(A \\in \\mathcal{F}\\) whose only red side lies on \\(\\ell\\). Since \\(A\\) has at least three sides, it must have at least one blue vertex. Let us take one such vertex and associate it to \\(\\ell\\).\n\nSince each blue point belongs to four regions (some of which may be unbounded), it is associated to at most four red lines. Thus the total number of red lines is at most \\(4\\binom{k}{2}\\). On the other hand, this number is \\(n-k\\), so\n\n\\[\nn-k \\leqslant 2 k(k-1), \\quad \\text { thus } \\quad n \\leqslant 2 k^{2}-k \\leqslant 2 k^{2},\n\\]\n\nand finally \\(k \\geqslant\\lceil\\sqrt{n / 2}\\rceil\\), which gives the desired result.\nComment 1. The constant factor in the estimate can be improved in different ways; we sketch two of them below. On the other hand, the Problem Selection Committee is not aware of any results showing that it is sometimes impossible to colour \\(k\\) lines satisfying the desired condition for \\(k \\gg \\sqrt{n}\\). In this situation we find it more suitable to keep the original formulation of the problem.\n\n\\begin{enumerate}\n  \\item Firstly, we show that in the proof above one has in fact \\(k=|B| \\geqslant\\lceil\\sqrt{2 n / 3}\\rceil\\).\n\n\nLet us make weighted associations as follows. Let a region \\(A\\) whose only red side lies on \\(\\ell\\) have \\(k\\) vertices, so that \\(k-2\\) of them are blue. We associate each of these blue vertices to \\(\\ell\\), and put the weight \\(\\frac{1}{k-2}\\) on each such association. So the sum of the weights of all the associations is exactly \\(n-k\\).\n\nNow, one may check that among the four regions adjacent to a blue vertex \\(v\\), at most two are triangles. This means that the sum of the weights of all associations involving \\(v\\) is at most \\(1+1+\\frac{1}{2}+\\frac{1}{2}=3\\). This leads to the estimate\n\n\\[\nn-k \\leqslant 3\\binom{k}{2}\n\\]\n\nor\n\n\\[\n2 n \\leqslant 3 k^{2}-k<3 k^{2}\n\\]\n\nwhich yields \\(k \\geqslant\\lceil\\sqrt{2 n / 3}\\rceil\\).\n2. Next, we even show that \\(k=|B| \\geqslant\\lceil\\sqrt{n}\\rceil\\). For this, we specify the process of associating points to red lines in one more different way.\n\nCall a point red if it lies on a red line as well as on a blue line. Consider any red line \\(\\ell\\), and take an arbitrary region \\(A \\in \\mathcal{F}\\) whose only red side lies on \\(\\ell\\). Let \\(r^{\\prime}, r, b_{1}, \\ldots, b_{k}\\) be its vertices in clockwise order with \\(r^{\\prime}, r \\in \\ell\\); then the points \\(r^{\\prime}, r\\) are red, while all the points \\(b_{1}, \\ldots, b_{k}\\) are blue. Let us associate to \\(\\ell\\) the red point \\(r\\) and the blue point \\(b_{1}\\). One may notice that to each pair of a red point \\(r\\) and a blue point \\(b\\), at most one red line can be associated, since there is at most one region \\(A\\) having \\(r\\) and \\(b\\) as two clockwise consecutive vertices.\n\nWe claim now that at most two red lines are associated to each blue point \\(b\\); this leads to the desired bound\n\n\\[\nn-k \\leqslant 2\\binom{k}{2} \\quad \\Longleftrightarrow \\quad n \\leqslant k^{2}\n\\]\n\nAssume, to the contrary, that three red lines \\(\\ell_{1}, \\ell_{2}\\), and \\(\\ell_{3}\\) are associated to the same blue point \\(b\\). Let \\(r_{1}, r_{2}\\), and \\(r_{3}\\) respectively be the red points associated to these lines; all these points are distinct. The point \\(b\\) defines four blue rays, and each point \\(r_{i}\\) is the red point closest to \\(b\\) on one of these rays. So we may assume that the points \\(r_{2}\\) and \\(r_{3}\\) lie on one blue line passing through \\(b\\), while \\(r_{1}\\) lies on the other one.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-36}\n\nNow consider the region \\(A\\) used to associate \\(r_{1}\\) and \\(b\\) with \\(\\ell_{1}\\). Three of its clockwise consecutive vertices are \\(r_{1}, b\\), and either \\(r_{2}\\) or \\(r_{3}\\) (say, \\(r_{2}\\) ). Since \\(A\\) has only one red side, it can only be the triangle \\(r_{1} b r_{2}\\); but then both \\(\\ell_{1}\\) and \\(\\ell_{2}\\) pass through \\(r_{2}\\), as well as some blue line. This is impossible by the problem assumptions.\n\nComment 2. The condition that the lines be non-parallel is essentially not used in the solution, nor in the previous comment; thus it may be omitted."}
{"id": "imo-shortlist-2014-c6", "question": "C6. We are given an infinite deck of cards, each with a real number on it. For every real number \\(x\\), there is exactly one card in the deck that has \\(x\\) written on it. Now two players draw disjoint sets \\(A\\) and \\(B\\) of 100 cards each from this deck. We would like to define a rule that declares one of them a winner. This rule should satisfy the following conditions:\n\n\\begin{enumerate}\n  \\item The winner only depends on the relative order of the 200 cards: if the cards are laid down in increasing order face down and we are told which card belongs to which player, but not what numbers are written on them, we can still decide the winner.\n  \\item If we write the elements of both sets in increasing order as \\(A=\\left\\{a_{1}, a_{2}, \\ldots, a_{100}\\right\\}\\) and \\(B=\\left\\{b_{1}, b_{2}, \\ldots, b_{100}\\right\\}\\), and \\(a_{i}>b_{i}\\) for all \\(i\\), then \\(A\\) beats \\(B\\).\n  \\item If three players draw three disjoint sets \\(A, B, C\\) from the deck, \\(A\\) beats \\(B\\) and \\(B\\) beats \\(C\\), then \\(A\\) also beats \\(C\\).\n\n\nHow many ways are there to define such a rule? Here, we consider two rules as different if there exist two sets \\(A\\) and \\(B\\) such that \\(A\\) beats \\(B\\) according to one rule, but \\(B\\) beats \\(A\\) according to the other.\n(Russia)\nAnswer. 100.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2014, "solution": "We prove a more general statement for sets of cardinality \\(n\\) (the problem being the special case \\(n=100\\), then the answer is \\(n\\) ). In the following, we write \\(A>B\\) or \\(B<A\\) for \" \\(A\\) beats \\(B\\) \".\n\nPart I. Let us first define \\(n\\) different rules that satisfy the conditions. To this end, fix an index \\(k \\in\\{1,2, \\ldots, n\\}\\). We write both \\(A\\) and \\(B\\) in increasing order as \\(A=\\left\\{a_{1}, a_{2}, \\ldots, a_{n}\\right\\}\\) and \\(B=\\left\\{b_{1}, b_{2}, \\ldots, b_{n}\\right\\}\\) and say that \\(A\\) beats \\(B\\) if and only if \\(a_{k}>b_{k}\\). This rule clearly satisfies all three conditions, and the rules corresponding to different \\(k\\) are all different. Thus there are at least \\(n\\) different rules.\n\nPart II. Now we have to prove that there is no other way to define such a rule. Suppose that our rule satisfies the conditions, and let \\(k \\in\\{1,2, \\ldots, n\\}\\) be minimal with the property that\n\n\\[\nA_{k}=\\{1,2, \\ldots, k, n+k+1, n+k+2, \\ldots, 2 n\\} \\prec B_{k}=\\{k+1, k+2, \\ldots, n+k\\} .\n\\]\n\nClearly, such a \\(k\\) exists, since this holds for \\(k=n\\) by assumption. Now consider two disjoint sets \\(X=\\left\\{x_{1}, x_{2}, \\ldots, x_{n}\\right\\}\\) and \\(Y=\\left\\{y_{1}, y_{2}, \\ldots, y_{n}\\right\\}\\), both in increasing order (i.e., \\(x_{1}<x_{2}<\\cdots<x_{n}\\) and \\(y_{1}<y_{2}<\\cdots<y_{n}\\) ). We claim that \\(X<Y\\) if (and only if - this follows automatically) \\(x_{k}<y_{k}\\).\n\nTo prove this statement, pick arbitrary real numbers \\(u_{i}, v_{i}, w_{i} \\notin X \\cup Y\\) such that\n\n\\[\nu_{1}<u_{2}<\\cdots<u_{k-1}<\\min \\left(x_{1}, y_{1}\\right), \\quad \\max \\left(x_{n}, y_{n}\\right)<v_{k+1}<v_{k+2}<\\cdots<v_{n}\n\\]\n\nand\n\n\\[\nx_{k}<v_{1}<v_{2}<\\cdots<v_{k}<w_{1}<w_{2}<\\cdots<w_{n}<u_{k}<u_{k+1}<\\cdots<u_{n}<y_{k}\n\\]\n\nand set\n\n\\[\nU=\\left\\{u_{1}, u_{2}, \\ldots, u_{n}\\right\\}, V=\\left\\{v_{1}, v_{2}, \\ldots, v_{n}\\right\\}, W=\\left\\{w_{1}, w_{2}, \\ldots, w_{n}\\right\\}\n\\]\n\nThen\n\n\\begin{itemize}\n  \\item \\(u_{i}<y_{i}\\) and \\(x_{i}<v_{i}\\) for all \\(i\\), so \\(U<Y\\) and \\(X<V\\) by the second condition.\n  \\item The elements of \\(U \\cup W\\) are ordered in the same way as those of \\(A_{k-1} \\cup B_{k-1}\\), and since \\(A_{k-1}>B_{k-1}\\) by our choice of \\(k\\), we also have \\(U>W\\) (if \\(k=1\\), this is trivial).\n  \\item The elements of \\(V \\cup W\\) are ordered in the same way as those of \\(A_{k} \\cup B_{k}\\), and since \\(A_{k}<B_{k}\\) by our choice of \\(k\\), we also have \\(V<W\\).\n\n\nIt follows that\n\n\\[\nX<V<W<U<Y\n\\]\n\nso \\(X<Y\\) by the third condition, which is what we wanted to prove.\nSolution 2. Another possible approach to Part II of this problem is induction on \\(n\\). For \\(n=1\\), there is trivially only one rule in view of the second condition.\n\nIn the following, we assume that our claim (namely, that there are no possible rules other than those given in Part I) holds for \\(n-1\\) in place of \\(n\\). We start with the following observation: Claim. At least one of the two relations\n\n\\[\n(\\{2\\} \\cup\\{2 i-1 \\mid 2 \\leqslant i \\leqslant n\\})<(\\{1\\} \\cup\\{2 i \\mid 2 \\leqslant i \\leqslant n\\})\n\\]\n\nand\n\n\\[\n(\\{2 i-1 \\mid 1 \\leqslant i \\leqslant n-1\\} \\cup\\{2 n\\})<(\\{2 i \\mid 1 \\leqslant i \\leqslant n-1\\} \\cup\\{2 n-1\\})\n\\]\n\nholds.\nProof. Suppose that the first relation does not hold. Since our rule may only depend on the relative order, we must also have\n\n\\[\n(\\{2\\} \\cup\\{3 i-2 \\mid 2 \\leqslant i \\leqslant n-1\\} \\cup\\{3 n-2\\})>(\\{1\\} \\cup\\{3 i-1 \\mid 2 \\leqslant i \\leqslant n-1\\} \\cup\\{3 n\\})\n\\]\n\nLikewise, if the second relation does not hold, then we must also have\n\n\\[\n(\\{1\\} \\cup\\{3 i-1 \\mid 2 \\leqslant i \\leqslant n-1\\} \\cup\\{3 n\\})>(\\{3\\} \\cup\\{3 i \\mid 2 \\leqslant i \\leqslant n-1\\} \\cup\\{3 n-1\\})\n\\]\n\nNow condition 3 implies that\n\n\\[\n(\\{2\\} \\cup\\{3 i-2 \\mid 2 \\leqslant i \\leqslant n-1\\} \\cup\\{3 n-2\\})>(\\{3\\} \\cup\\{3 i \\mid 2 \\leqslant i \\leqslant n-1\\} \\cup\\{3 n-1\\})\n\\]\n\nwhich contradicts the second condition.\nNow we distinguish two cases, depending on which of the two relations actually holds:\nFirst case: \\((\\{2\\} \\cup\\{2 i-1 \\mid 2 \\leqslant i \\leqslant n\\})<(\\{1\\} \\cup\\{2 i \\mid 2 \\leqslant i \\leqslant n\\})\\).\nLet \\(A=\\left\\{a_{1}, a_{2}, \\ldots, a_{n}\\right\\}\\) and \\(B=\\left\\{b_{1}, b_{2}, \\ldots, b_{n}\\right\\}\\) be two disjoint sets, both in increasing order. We claim that the winner can be decided only from the values of \\(a_{2}, \\ldots, a_{n}\\) and \\(b_{2}, \\ldots, b_{n}\\), while \\(a_{1}\\) and \\(b_{1}\\) are actually irrelevant. Suppose that this was not the case, and assume without loss of generality that \\(a_{2}<b_{2}\\). Then the relative order of \\(a_{1}, a_{2}, \\ldots, a_{n}, b_{2}, \\ldots, b_{n}\\) is fixed, and the position of \\(b_{1}\\) has to decide the winner. Suppose that for some value \\(b_{1}=x, B\\) wins, while for some other value \\(b_{1}=y, A\\) wins.\n\nWrite \\(B_{x}=\\left\\{x, b_{2}, \\ldots, b_{n}\\right\\}\\) and \\(B_{y}=\\left\\{y, b_{2}, \\ldots, b_{n}\\right\\}\\), and let \\(\\varepsilon>0\\) be smaller than half the distance between any two of the numbers in \\(B_{x} \\cup B_{y} \\cup A\\). For any set \\(M\\), let \\(M \\pm \\varepsilon\\) be the set obtained by adding/subtracting \\(\\varepsilon\\) to all elements of \\(M\\). By our choice of \\(\\varepsilon\\), the relative order of the elements of \\(\\left(B_{y}+\\varepsilon\\right) \\cup A\\) is still the same as for \\(B_{y} \\cup A\\), while the relative order of the elements of \\(\\left(B_{x}-\\varepsilon\\right) \\cup A\\) is still the same as for \\(B_{x} \\cup A\\). Thus \\(A \\prec B_{x}-\\varepsilon\\), but \\(A \\succ B_{y}+\\varepsilon\\). Moreover, if \\(y>x\\), then \\(B_{x}-\\varepsilon<B_{y}+\\varepsilon\\) by condition 2, while otherwise the relative order of\nthe elements in \\(\\left(B_{x}-\\varepsilon\\right) \\cup\\left(B_{y}+\\varepsilon\\right)\\) is the same as for the two sets \\(\\{2\\} \\cup\\{2 i-1 \\mid 2 \\leqslant i \\leqslant n\\}\\) and \\(\\{1\\} \\cup\\{2 i \\mid 2 \\leqslant i \\leqslant n\\}\\), so that \\(B_{x}-\\varepsilon<B_{y}+\\varepsilon\\). In either case, we obtain\n\n\\[\nA \\prec B_{x}-\\varepsilon \\prec B_{y}+\\varepsilon \\prec A\n\\]\n\nwhich contradicts condition 3.\nSo we know now that the winner does not depend on \\(a_{1}, b_{1}\\). Therefore, we can define a new rule \\(<^{*}\\) on sets of cardinality \\(n-1\\) by saying that \\(A<^{*} B\\) if and only if \\(A \\cup\\{a\\}<B \\cup\\{b\\}\\) for some \\(a, b\\) (or equivalently, all \\(a, b\\) ) such that \\(a<\\min A, b<\\min B\\) and \\(A \\cup\\{a\\}\\) and \\(B \\cup\\{b\\}\\) are disjoint. The rule \\(<^{*}\\) satisfies all conditions again, so by the induction hypothesis, there exists an index \\(i\\) such that \\(A<{ }^{*} B\\) if and only if the \\(i^{\\text {th }}\\) smallest element of \\(A\\) is less than the \\(i^{\\text {th }}\\) smallest element of \\(B\\). This implies that \\(C<D\\) if and only if the \\((i+1)^{\\text {th }}\\) smallest element of \\(C\\) is less than the \\((i+1)^{\\text {th }}\\) smallest element of \\(D\\), which completes our induction.\n\nSecond case: \\((\\{2 i-1 \\mid 1 \\leqslant i \\leqslant n-1\\} \\cup\\{2 n\\})<(\\{2 i \\mid 1 \\leqslant i \\leqslant n-1\\} \\cup\\{2 n-1\\})\\).\nSet \\(-A=\\{-a \\mid a \\in A\\}\\) for any \\(A \\subseteq \\mathbb{R}\\). For any two disjoint sets \\(A, B \\subseteq \\mathbb{R}\\) of cardinality \\(n\\), we write \\(A<^{\\circ} B\\) to mean \\((-B)<(-A)\\). It is easy to see that \\(<^{\\circ}\\) defines a rule to determine a winner that satisfies the three conditions of our problem as well as the relation of the first case. So it follows in the same way as in the first case that for some \\(i, A<^{\\circ} B\\) if and only if the \\(i^{\\text {th }}\\) smallest element of \\(A\\) is less than the \\(i^{\\text {th }}\\) smallest element of \\(B\\), which is equivalent to the condition that the \\(i^{\\text {th }}\\) largest element of \\(-A\\) is greater than the \\(i^{\\text {th }}\\) largest element of \\(-B\\). This proves that the original rule \\(<\\) also has the desired form.\n\nComment. The problem asks for all possible partial orders on the set of \\(n\\)-element subsets of \\(\\mathbb{R}\\) such that any two disjoint sets are comparable, the order relation only depends on the relative order of the elements, and \\(\\left\\{a_{1}, a_{2}, \\ldots, a_{n}\\right\\}<\\left\\{b_{1}, b_{2}, \\ldots, b_{n}\\right\\}\\) whenever \\(a_{i}<b_{i}\\) for all \\(i\\).\n\nAs the proposer points out, one may also ask for all total orders on all \\(n\\)-element subsets of \\(\\mathbb{R}\\) (dropping the condition of disjointness and requiring that \\(\\left\\{a_{1}, a_{2}, \\ldots, a_{n}\\right\\} \\leq\\left\\{b_{1}, b_{2}, \\ldots, b_{n}\\right\\}\\) whenever \\(a_{i} \\leqslant b_{i}\\) for all \\(i\\) ). It turns out that the number of possibilities in this case is \\(n!\\), and all possible total orders are obtained in the following way. Fix a permutation \\(\\sigma \\in S_{n}\\). Let \\(A=\\left\\{a_{1}, a_{2}, \\ldots, a_{n}\\right\\}\\) and \\(B=\\left\\{b_{1}, b_{2}, \\ldots, b_{n}\\right\\}\\) be two subsets of \\(\\mathbb{R}\\) with \\(a_{1}<a_{2}<\\cdots<a_{n}\\) and \\(b_{1}<b_{2}<\\cdots<b_{n}\\). Then we say that \\(A \\succ_{\\sigma} B\\) if and only if ( \\(a_{\\sigma(1)}, \\ldots, a_{\\sigma(n)}\\) ) is lexicographically greater than ( \\(b_{\\sigma(1)}, \\ldots, b_{\\sigma(n)}\\) ).\n\nIt seems, however, that this formulation adds rather more technicalities to the problem than additional ideas.\n\nThis page is intentionally left blank"}
{"id": "imo-shortlist-2014-c7", "question": "C7. Let \\(M\\) be a set of \\(n \\geqslant 4\\) points in the plane, no three of which are collinear. Initially these points are connected with \\(n\\) segments so that each point in \\(M\\) is the endpoint of exactly two segments. Then, at each step, one may choose two segments \\(A B\\) and \\(C D\\) sharing a common interior point and replace them by the segments \\(A C\\) and \\(B D\\) if none of them is present at this moment. Prove that it is impossible to perform \\(n^{3} / 4\\) or more such moves.\n(Russia)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2014, "solution": "A line is said to be red if it contains two points of \\(M\\). As no three points of \\(M\\) are collinear, each red line determines a unique pair of points of \\(M\\). Moreover, there are precisely \\(\\binom{n}{2}<\\frac{n^{2}}{2}\\) red lines. By the value of a segment we mean the number of red lines intersecting it in its interior, and the value of a set of segments is defined to be the sum of the values of its elements. We will prove that ( \\(i\\) ) the value of the initial set of segments is smaller than \\(n^{3} / 2\\) and that ( \\(i i\\) ) each step decreases the value of the set of segments present by at least 2 . Since such a value can never be negative, these two assertions imply the statement of the problem.\n\nTo show \\((i)\\) we just need to observe that each segment has a value that is smaller than \\(n^{2} / 2\\). Thus the combined value of the \\(n\\) initial segments is indeed below \\(n \\cdot n^{2} / 2=n^{3} / 2\\).\n\nIt remains to establish ( \\(i i\\) ). Suppose that at some moment we have two segments \\(A B\\) and \\(C D\\) sharing an interior point \\(S\\), and that at the next moment we have the two segments \\(A C\\) and \\(B D\\) instead. Let \\(X_{A B}\\) denote the set of red lines intersecting the segment \\(A B\\) in its interior and let the sets \\(X_{A C}, X_{B D}\\), and \\(X_{C D}\\) be defined similarly. We are to prove that \\(\\left|X_{A C}\\right|+\\left|X_{B D}\\right|+2 \\leqslant\\left|X_{A B}\\right|+\\left|X_{C D}\\right|\\).\n\nAs a first step in this direction, we claim that\n\n\\[\n\\left|X_{A C} \\cup X_{B D}\\right|+2 \\leqslant\\left|X_{A B} \\cup X_{C D}\\right| .\n\\]\n\nIndeed, if \\(g\\) is a red line intersecting, e.g. the segment \\(A C\\) in its interior, then it has to intersect the triangle \\(A C S\\) once again, either in the interior of its side \\(A S\\), or in the interior of its side \\(C S\\), or at \\(S\\), meaning that it belongs to \\(X_{A B}\\) or to \\(X_{C D}\\) (see Figure 1). Moreover, the red lines \\(A B\\) and \\(C D\\) contribute to \\(X_{A B} \\cup X_{C D}\\) but not to \\(X_{A C} \\cup X_{B D}\\). Thereby (1) is proved.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-41(1)}\n\nFigure 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-41(2)}\n\nFigure 2\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-41}\n\nFigure 3\n\nSimilarly but more easily one obtains\n\n\\[\n\\left|X_{A C} \\cap X_{B D}\\right| \\leqslant\\left|X_{A B} \\cap X_{C D}\\right| .\n\\]\n\nIndeed, a red line \\(h\\) appearing in \\(X_{A C} \\cap X_{B D}\\) belongs, for similar reasons as above, also to \\(X_{A B} \\cap X_{C D}\\). To make the argument precise, one may just distinguish the cases \\(S \\in h\\) (see Figure 2) and \\(S \\notin h\\) (see Figure 3). Thereby (2) is proved.\n\nAdding (1) and (2) we obtain the desired conclusion, thus completing the solution of this problem.\n\nComment 1. There is a problem belonging to the folklore, in the solution of which one may use the same kind of operation:\n\nGiven \\(n\\) red and \\(n\\) green points in the plane, prove that one may draw \\(n\\) nonintersecting segments each of which connects a red point with a green point.\n\nA standard approach to this problem consists in taking \\(n\\) arbitrary segments connecting the red points with the green points, and to perform the same operation as in the above proposal whenever an intersection occurs. Now each time one performs such a step, the total length of the segments that are present decreases due to the triangle inequality. So, as there are only finitely many possibilities for the set of segments present, the process must end at some stage.\n\nIn the above proposal, however, considering the sum of the Euclidean lengths of the segment that are present does not seem to help much, for even though it shows that the process must necessarily terminate after some finite number of steps, it does not seem to easily yield any upper bound on the number of these steps that grows polynomially with \\(n\\).\n\nOne may regard the concept of the value of a segment introduced in the above solution as an appropriately discretised version of Euclidean length suitable for obtaining such a bound.\n\nThe Problem Selection Committee still believes the problem to be sufficiently original for the competition.\n\nComment 2. There are some other essentially equivalent ways of presenting the same solution. E.g., put \\(M=\\left\\{A_{1}, A_{2}, \\ldots, A_{n}\\right\\}\\), denote the set of segments present at any moment by \\(\\left\\{e_{1}, e_{2}, \\ldots, e_{n}\\right\\}\\), and called a triple ( \\(i, j, k\\) ) of indices with \\(i \\neq j\\) intersecting, if the line \\(A_{i} A_{j}\\) intersects the segment \\(e_{k}\\). It may then be shown that the number \\(S\\) of intersecting triples satisfies \\(0 \\leqslant S<n^{3}\\) at the beginning and decreases by at least 4 in each step.\n\nComment 3. It is not difficult to construct an example where \\(c n^{2}\\) moves are possible (for some absolute constant \\(c>0\\) ). It would be interesting to say more about the gap between \\(c n^{2}\\) and \\(c n^{3}\\)."}
{"id": "imo-shortlist-2014-c8", "question": "C8. A card deck consists of 1024 cards. On each card, a set of distinct decimal digits is written in such a way that no two of these sets coincide (thus, one of the cards is empty). Two players alternately take cards from the deck, one card per turn. After the deck is empty, each player checks if he can throw out one of his cards so that each of the ten digits occurs on an even number of his remaining cards. If one player can do this but the other one cannot, the one who can is the winner; otherwise a draw is declared.\n\nDetermine all possible first moves of the first player after which he has a winning strategy.\n(Russia)\nAnswer. All the moves except for taking the empty card.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2014, "solution": "Let us identify each card with the set of digits written on it. For any collection of cards \\(C_{1}, C_{2}, \\ldots, C_{k}\\) denote by their sum the set \\(C_{1} \\triangle C_{2} \\triangle \\cdots \\triangle C_{k}\\) consisting of all elements belonging to an odd number of the \\(C_{i}\\) 's. Denote the first and the second player by \\(\\mathcal{F}\\) and \\(\\mathcal{S}\\), respectively.\n\nSince each digit is written on exactly 512 cards, the sum of all the cards is \\(\\varnothing\\). Therefore, at the end of the game the sum of all the cards of \\(\\mathcal{F}\\) will be the same as that of \\(\\mathcal{S}\\); denote this sum by \\(C\\). Then the player who took \\(C\\) can throw it out and get the desired situation, while the other one cannot. Thus, the player getting card \\(C\\) wins, and no draw is possible.\n\nNow, given a nonempty card \\(B\\), one can easily see that all the cards can be split into 512 pairs of the form ( \\(X, X \\triangle B\\) ) because ( \\(X \\triangle B\\) ) \\(\\triangle B=X\\). The following lemma shows a property of such a partition that is important for the solution.\nLemma. Let \\(B \\neq \\varnothing\\) be some card. Let us choose 512 cards so that exactly one card is chosen from every pair ( \\(X, X \\triangle B\\) ). Then the sum of all chosen cards is either \\(\\varnothing\\) or \\(B\\).\nProof. Let \\(b\\) be some element of \\(B\\). Enumerate the pairs; let \\(X_{i}\\) be the card not containing \\(b\\) in the \\(i^{\\text {th }}\\) pair, and let \\(Y_{i}\\) be the other card in this pair. Then the sets \\(X_{i}\\) are exactly all the sets not containing \\(b\\), therefore each digit \\(a \\neq b\\) is written on exactly 256 of these cards, so \\(X_{1} \\triangle X_{2} \\triangle \\cdots \\triangle X_{512}=\\varnothing\\). Now, if we replace some summands in this sum by the other elements from their pairs, we will simply add \\(B\\) several times to this sum, thus the sum will either remain unchanged or change by \\(B\\), as required.\n\nNow we consider two cases.\nCase 1. Assume that \\(\\mathcal{F}\\) takes the card \\(\\varnothing\\) on his first move. In this case, we present a winning strategy for \\(\\mathcal{S}\\).\n\nLet \\(\\mathcal{S}\\) take an arbitrary card \\(A\\). Assume that \\(\\mathcal{F}\\) takes card \\(B\\) after that; then \\(\\mathcal{S}\\) takes \\(A \\triangle B\\). Split all 1024 cards into 512 pairs of the form ( \\(X, X \\triangle B\\) ); we call two cards in one pair partners. Then the four cards taken so far form two pairs ( \\(\\varnothing, B\\) ) and ( \\(A, A \\triangle B\\) ) belonging to \\(\\mathcal{F}\\) and \\(\\mathcal{S}\\), respectively. On each of the subsequent moves, when \\(\\mathcal{F}\\) takes some card, \\(\\mathcal{S}\\) should take the partner of this card in response.\n\nConsider the situation at the end of the game. Let us for a moment replace card \\(A\\) belonging to \\(\\mathcal{S}\\) by \\(\\varnothing\\). Then he would have one card from each pair; by our lemma, the sum of all these cards would be either \\(\\varnothing\\) or \\(B\\). Now, replacing \\(\\varnothing\\) back by \\(A\\) we get that the actual sum of the cards of \\(\\mathcal{S}\\) is either \\(A\\) or \\(A \\triangle B\\), and he has both these cards. Thus \\(\\mathcal{S}\\) wins.\n\nCase 2. Now assume that \\(\\mathcal{F}\\) takes some card \\(A \\neq \\varnothing\\) on his first move. Let us present a winning strategy for \\(\\mathcal{F}\\) in this case.\n\nAssume that \\(\\mathcal{S}\\) takes some card \\(B \\neq \\varnothing\\) on his first move; then \\(\\mathcal{F}\\) takes \\(A \\triangle B\\). Again, let us split all the cards into pairs of the form ( \\(X, X \\triangle B\\) ); then the cards which have not been taken yet form several complete pairs and one extra element (card \\(\\varnothing\\) has not been taken while its partner \\(B\\) has). Now, on each of the subsequent moves, if \\(\\mathcal{S}\\) takes some element from a\ncomplete pair, then \\(\\mathcal{F}\\) takes its partner. If \\(\\mathcal{S}\\) takes the extra element, then \\(\\mathcal{F}\\) takes an arbitrary card \\(Y\\), and the partner of \\(Y\\) becomes the new extra element.\n\nThus, on his last move \\(\\mathcal{S}\\) is forced to take the extra element. After that player \\(\\mathcal{F}\\) has cards \\(A\\) and \\(A \\triangle B\\), player \\(\\mathcal{S}\\) has cards \\(B\\) and \\(\\varnothing\\), and \\(\\mathcal{F}\\) has exactly one element from every other pair. Thus the situation is the same as in the previous case with roles reversed, and \\(\\mathcal{F}\\) wins.\n\nFinally, if \\(\\mathcal{S}\\) takes \\(\\varnothing\\) on his first move then \\(\\mathcal{F}\\) denotes any card which has not been taken yet by \\(B\\) and takes \\(A \\triangle B\\). After that, the same strategy as above is applicable.\n\nComment 1. If one wants to avoid the unusual question about the first move, one may change the formulation as follows. (The difficulty of the problem would decrease somewhat.)\n\nA card deck consists of 1023 cards; on each card, a nonempty set of distinct decimal digits is written in such a way that no two of these sets coincide. Two players alternately take cards from the deck, one card per turn. When the deck is empty, each player checks if he can throw out one of his cards so that for each of the ten digits, he still holds an even number of cards with this digit. If one player can do this but the other one cannot, the one who can is the winner; otherwise a draw is declared.\n\nDetermine which of the players (if any) has a winning strategy.\nThe winner in this version is the first player. The analysis of the game from the first two paragraphs of the previous solution applies to this version as well, except for the case \\(C=\\varnothing\\) in which the result is a draw. Then the strategy for \\(\\mathcal{S}\\) in Case 1 works for \\(\\mathcal{F}\\) in this version: the sum of all his cards at the end is either \\(A\\) or \\(A \\triangle B\\), thus nonempty in both cases.\n\nComment 2. Notice that all the cards form a vector space over \\(\\mathbb{F}_{2}\\), with \\(\\triangle\\) the operation of addition. Due to the automorphisms of this space, all possibilities for \\(\\mathcal{F}\\) 's first move except \\(\\varnothing\\) are equivalent. The same holds for the response by \\(\\mathcal{S}\\) if \\(\\mathcal{F}\\) takes the card \\(\\varnothing\\) on his first move.\n\nComment 3. It is not that hard to show that in the initial game, \\(\\mathcal{F}\\) has a winning move, by the idea of \"strategy stealing\".\n\nNamely, assume that \\(\\mathcal{S}\\) has a winning strategy. Let us take two card decks and start two games, in which \\(\\mathcal{S}\\) will act by his strategy. In the first game, \\(\\mathcal{F}\\) takes an arbitrary card \\(A_{1}\\); assume that \\(\\mathcal{S}\\) takes some \\(B_{1}\\) in response. Then \\(\\mathcal{F}\\) takes the card \\(B_{1}\\) at the second game; let the response by \\(\\mathcal{S}\\) be \\(A_{2}\\). Then \\(\\mathcal{F}\\) takes \\(A_{2}\\) in the first game and gets a response \\(B_{2}\\), and so on.\n\nThis process stops at some moment when in the second game \\(\\mathcal{S}\\) takes \\(A_{i}=A_{1}\\). At this moment the players hold the same sets of cards in both games, but with roles reversed. Now, if some cards remain in the decks, \\(\\mathcal{F}\\) takes an arbitrary card from the first deck starting a similar cycle.\n\nAt the end of the game, player \\(\\mathcal{F}\\) 's cards in the first game are exactly player \\(\\mathcal{S}\\) 's cards in the second game, and vice versa. Thus in one of the games \\(\\mathcal{F}\\) will win, which is impossible by our assumption.\n\nOne may notice that the strategy in Case 2 is constructed exactly in this way from the strategy in Case 1. This is possible since every response by \\(\\mathcal{S}\\) wins if \\(\\mathcal{F}\\) takes the card \\(\\varnothing\\) on his first move."}
{"id": "imo-shortlist-2014-c9", "question": "C9. There are \\(n\\) circles drawn on a piece of paper in such a way that any two circles intersect in two points, and no three circles pass through the same point. Turbo the snail slides along the circles in the following fashion. Initially he moves on one of the circles in clockwise direction. Turbo always keeps sliding along the current circle until he reaches an intersection with another circle. Then he continues his journey on this new circle and also changes the direction of moving, i.e. from clockwise to anticlockwise or vice versa.\n\nSuppose that Turbo's path entirely covers all circles. Prove that \\(n\\) must be odd.\n(India)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2014, "solution": "Replace every cross (i.e. intersection of two circles) by two small circle arcs that indicate the direction in which the snail should leave the cross (see Figure 1.1). Notice that the placement of the small arcs does not depend on the direction of moving on the curves; no matter which direction the snail is moving on the circle arcs, he will follow the same curves (see Figure 1.2). In this way we have a set of curves, that are the possible paths of the snail. Call these curves snail orbits or just orbits. Every snail orbit is a simple closed curve that has no intersection with any other orbit.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-45}\n\nFigure 1.1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-45(1)}\n\nFigure 1.2\n\nWe prove the following, more general statement.\n(*) In any configuration of \\(n\\) circles such that no two of them are tangent, the number of snail orbits has the same parity as the number \\(n\\). (Note that it is not assumed that all circle pairs intersect.)\n\nThis immediately solves the problem.\nLet us introduce the following operation that will be called flipping a cross. At a cross, remove the two small arcs of the orbits, and replace them by the other two arcs. Hence, when the snail arrives at a flipped cross, he will continue on the other circle as before, but he will preserve the orientation in which he goes along the circle arcs (see Figure 2).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-45(2)}\n\nFigure 2\nConsider what happens to the number of orbits when a cross is flipped. Denote by \\(a, b, c\\), and \\(d\\) the four arcs that meet at the cross such that \\(a\\) and \\(b\\) belong to the same circle. Before the flipping \\(a\\) and \\(b\\) were connected to \\(c\\) and \\(d\\), respectively, and after the flipping \\(a\\) and \\(b\\) are connected to \\(d\\) and \\(c\\), respectively.\n\nThe orbits passing through the cross are closed curves, so each of the arcs \\(a, b, c\\), and \\(d\\) is connected to another one by orbits outside the cross. We distinguish three cases.\n\nCase 1: \\(a\\) is connected to \\(b\\) and \\(c\\) is connected to \\(d\\) by the orbits outside the cross (see Figure 3.1).\n\nWe show that this case is impossible. Remove the two small arcs at the cross, connect \\(a\\) to \\(b\\), and connect \\(c\\) to \\(d\\) at the cross. Let \\(\\gamma\\) be the new closed curve containing \\(a\\) and \\(b\\), and let \\(\\delta\\) be the new curve that connects \\(c\\) and \\(d\\). These two curves intersect at the cross. So one of \\(c\\) and \\(d\\) is inside \\(\\gamma\\) and the other one is outside \\(\\gamma\\). Then the two closed curves have to meet at least one more time, but this is a contradiction, since no orbit can intersect itself.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-46(2)}\n\nFigure 3.1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-46(4)}\n\nFigure 3.2\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-46(1)}\n\nFigure 3.3\n\nCase 2: \\(a\\) is connected to \\(c\\) and \\(b\\) is connected to \\(d\\) (see Figure 3.2).\nBefore the flipping \\(a\\) and \\(c\\) belong to one orbit and \\(b\\) and \\(d\\) belong to another orbit. Flipping the cross merges the two orbits into a single orbit. Hence, the number of orbits decreases by 1 .\n\nCase 3: \\(a\\) is connected to \\(d\\) and \\(b\\) is connected to \\(c\\) (see Figure 3.3).\nBefore the flipping the arcs \\(a, b, c\\), and \\(d\\) belong to a single orbit. Flipping the cross splits that orbit in two. The number of orbits increases by 1 .\n\nAs can be seen, every flipping decreases or increases the number of orbits by one, thus changes its parity.\n\nNow flip every cross, one by one. Since every pair of circles has 0 or 2 intersections, the number of crosses is even. Therefore, when all crosses have been flipped, the original parity of the number of orbits is restored. So it is sufficient to prove (*) for the new configuration, where all crosses are flipped. Of course also in this new configuration the (modified) orbits are simple closed curves not intersecting each other.\n\nOrient the orbits in such a way that the snail always moves anticlockwise along the circle arcs. Figure 4 shows the same circles as in Figure 1 after flipping all crosses and adding orientation. (Note that this orientation may be different from the orientation of the orbit as a planar curve; the orientation of every orbit may be negative as well as positive, like the middle orbit in Figure 4.) If the snail moves around an orbit, the total angle change in his moving direction, the total curvature, is either \\(+2 \\pi\\) or \\(-2 \\pi\\), depending on the orientation of the orbit. Let \\(P\\) and \\(N\\) be the number of orbits with positive and negative orientation, respectively. Then the total curvature of all orbits is \\((P-N) \\cdot 2 \\pi\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-46}\n\nFigure 4\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-46(3)}\n\nFigure 5\n\nDouble-count the total curvature of all orbits. Along every circle the total curvature is \\(2 \\pi\\). At every cross, the two turnings make two changes with some angles having the same absolute value but opposite signs, as depicted in Figure 5. So the changes in the direction at the crosses cancel out. Hence, the total curvature is \\(n \\cdot 2 \\pi\\).\n\nNow we have \\((P-N) \\cdot 2 \\pi=n \\cdot 2 \\pi\\), so \\(P-N=n\\). The number of (modified) orbits is \\(P+N\\), that has a same parity as \\(P-N=n\\).\n\nSolution 2. We present a different proof of (*).\nWe perform a sequence of small modification steps on the configuration of the circles in such a way that at the end they have no intersection at all (see Figure 6.1). We use two kinds of local changes to the structure of the orbits (see Figure 6.2):\n\n\\begin{itemize}\n  \\item Type-1 step: An arc of a circle is moved over an arc of another circle; such a step creates or removes two intersections.\n  \\item Type-2 step: An arc of a circle is moved through the intersection of two other circles.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-47(1)}\n\n\nFigure 6.1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-47}\n\nFigure 6.2\n\nWe assume that in every step only one circle is moved, and that this circle is moved over at most one arc or intersection point of other circles.\n\nWe will show that the parity of the number of orbits does not change in any step. As every circle becomes a separate orbit at the end of the procedure, this fact proves (*).\n\nConsider what happens to the number of orbits when a Type-1 step is performed. The two intersection points are created or removed in a small neighbourhood. Denote some points of the two circles where they enter or leave this neighbourhood by \\(a, b, c\\), and \\(d\\) in this order around the neighbourhood; let \\(a\\) and \\(b\\) belong to one circle and let \\(c\\) and \\(d\\) belong to the other circle. The two circle arcs may have the same or opposite orientations. Moreover, the four end-points of the two arcs are connected by the other parts of the orbits. This can happen in two ways without intersection: either \\(a\\) is connected to \\(d\\) and \\(b\\) is connected to \\(c\\), or \\(a\\) is connected to \\(b\\) and \\(c\\) is connected to \\(d\\). Altogether we have four cases, as shown in Figure 7.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-47(2)}\n\nFigure 7\nWe can see that the number of orbits is changed by -2 or +2 in the leftmost case when the arcs have the same orientation, \\(a\\) is connected to \\(d\\), and \\(b\\) is connected to \\(c\\). In the other three cases the number of orbits is not changed. Hence, Type-1 steps do not change the parity of the number of orbits.\n\nNow consider a Type-2 step. The three circles enclose a small, triangular region; by the step, this triangle is replaced by another triangle. Again, the modification of the orbits is done in some small neighbourhood; the structure does not change outside. Each side of the triangle shaped region can be convex or concave; the number of concave sides can be \\(0,1,2\\) or 3 , so there are 4 possible arrangements of the orbits inside the neighbourhood, as shown in Figure 8.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-48(1)}\n\nFigure 8\nDenote the points where the three circles enter or leave the neighbourhood by \\(a, b, c, d\\), \\(e\\), and \\(f\\) in this order around the neighbourhood. As can be seen in Figure 8, there are only two essentially different cases; either \\(a, c, e\\) are connected to \\(b, d, f\\), respectively, or \\(a, c, e\\) are connected to \\(f, b, d\\), respectively. The step either preserves the set of connections or switches to the other arrangement. Obviously, in the earlier case the number of orbits is not changed; therefore we have to consider only the latter case.\n\nThe points \\(a, b, c, d, e\\), and \\(f\\) are connected by the orbits outside, without intersection. If \\(a\\) was connected to \\(c\\), say, then this orbit would isolate \\(b\\), so this is impossible. Hence, each of \\(a, b, c, d, e\\) and \\(f\\) must be connected either to one of its neighbours or to the opposite point. If say \\(a\\) is connected to \\(d\\), then this orbit separates \\(b\\) and \\(c\\) from \\(e\\) and \\(f\\), therefore \\(b\\) must be connected to \\(c\\) and \\(e\\) must be connected to \\(f\\). Altogether there are only two cases and their reverses: either each point is connected to one of its neighbours or two opposite points are connected and the the remaining neigh boring pairs are connected to each other. See Figure 9.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-48}\n\nFigure 9\nWe can see that if only neighbouring points are connected, then the number of orbits is changed by +2 or -2 . If two opposite points are connected ( \\(a\\) and \\(d\\) in the figure), then the orbits are re-arranged, but their number is unchanged. Hence, Type-2 steps also preserve the parity. This completes the proof of (*).\n\nSolution 3. Like in the previous solutions, we do not need all circle pairs to intersect but we assume that the circles form a connected set. Denote by \\(\\mathcal{C}\\) and \\(\\mathcal{P}\\) the sets of circles and their intersection points, respectively.\n\nThe circles divide the plane into several simply connected, bounded regions and one unbounded region. Denote the set of these regions by \\(\\mathcal{R}\\). We say that an intersection point or a region is odd or even if it is contained inside an odd or even number of circles, respectively. Let \\(\\mathcal{P}_{\\text {odd }}\\) and \\(\\mathcal{R}_{\\text {odd }}\\) be the sets of odd intersection points and odd regions, respectively.\n\nClaim.\n\n\\[\n\\left|\\mathcal{R}_{\\text {odd }}\\right|-\\left|\\mathcal{P}_{\\text {odd }}\\right| \\equiv n \\quad(\\bmod 2)\n\\]\n\nProof. For each circle \\(c \\in \\mathcal{C}\\), denote by \\(R_{c}, P_{c}\\), and \\(X_{c}\\) the number of regions inside \\(c\\), the number of intersection points inside \\(c\\), and the number of circles intersecting \\(c\\), respectively. The circles divide each other into several arcs; denote by \\(A_{c}\\) the number of such arcs inside \\(c\\). By double counting the regions and intersection points inside the circles we get\n\n\\[\n\\left|\\mathcal{R}_{\\mathrm{odd}}\\right| \\equiv \\sum_{c \\in \\mathcal{C}} R_{c} \\quad(\\bmod 2) \\quad \\text { and } \\quad\\left|\\mathcal{P}_{\\mathrm{odd}}\\right| \\equiv \\sum_{c \\in \\mathcal{C}} P_{c} \\quad(\\bmod 2)\n\\]\n\nFor each circle \\(c\\), apply Euler's polyhedron theorem to the (simply connected) regions in \\(c\\). There are \\(2 X_{c}\\) intersection points on \\(c\\); they divide the circle into \\(2 X_{c}\\) arcs. The polyhedron theorem yields \\(\\left(R_{c}+1\\right)+\\left(P_{c}+2 X_{c}\\right)=\\left(A_{c}+2 X_{c}\\right)+2\\), considering the exterior of \\(c\\) as a single region. Therefore,\n\n\\[\nR_{c}+P_{c}=A_{c}+1 .\n\\]\n\nMoreover, we have four arcs starting from every interior points inside \\(c\\) and a single arc starting into the interior from each intersection point on the circle. By double-counting the end-points of the interior arcs we get \\(2 A_{c}=4 P_{c}+2 X_{c}\\), so\n\n\\[\nA_{c}=2 P_{c}+X_{c} .\n\\]\n\nThe relations (2) and (3) together yield\n\n\\[\nR_{c}-P_{c}=X_{c}+1 .\n\\]\n\nBy summing up (4) for all circles we obtain\n\n\\[\n\\sum_{c \\in \\mathcal{C}} R_{c}-\\sum_{c \\in \\mathcal{C}} P_{c}=\\sum_{c \\in \\mathcal{C}} X_{c}+|\\mathcal{C}|,\n\\]\n\nwhich yields\n\n\\[\n\\left|\\mathcal{R}_{\\text {odd }}\\right|-\\left|\\mathcal{P}_{\\text {odd }}\\right| \\equiv \\sum_{c \\in \\mathcal{C}} X_{c}+n \\quad(\\bmod 2) .\n\\]\n\nNotice that in \\(\\sum_{c \\in \\mathcal{C}} X_{c}\\) each intersecting circle pair is counted twice, i.e., for both circles in the pair, so\n\n\\[\n\\sum_{c \\in \\mathcal{C}} X_{c} \\equiv 0 \\quad(\\bmod 2),\n\\]\n\nwhich finishes the proof of the Claim.\nNow insert the same small arcs at the intersections as in the first solution, and suppose that there is a single snail orbit \\(b\\).\n\nFirst we show that the odd regions are inside the curve \\(b\\), while the even regions are outside. Take a region \\(r \\in \\mathcal{R}\\) and a point \\(x\\) in its interior, and draw a ray \\(y\\), starting from \\(x\\), that does not pass through any intersection point of the circles and is neither tangent to any of the circles. As is well-known, \\(x\\) is inside the curve \\(b\\) if and only if \\(y\\) intersects \\(b\\) an odd number of times (see Figure 10). Notice that if an arbitrary circle \\(c\\) contains \\(x\\) in its interior, then \\(c\\) intersects \\(y\\) at a single point; otherwise, if \\(x\\) is outside \\(c\\), then \\(c\\) has 2 or 0 intersections with \\(y\\). Therefore, \\(y\\) intersects \\(b\\) an odd number of times if and only if \\(x\\) is contained in an odd number of circles, so if and only if \\(r\\) is odd.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-49}\n\nFigure 10\nNow consider an intersection point \\(p\\) of two circles \\(c_{1}\\) and \\(c_{2}\\) and a small neighbourhood around \\(p\\). Suppose that \\(p\\) is contained inside \\(k\\) circles.\n\nWe have four regions that meet at \\(p\\). Let \\(r_{1}\\) be the region that lies outside both \\(c_{1}\\) and \\(c_{2}\\), let \\(r_{2}\\) be the region that lies inside both \\(c_{1}\\) and \\(c_{2}\\), and let \\(r_{3}\\) and \\(r_{4}\\) be the two remaining regions, each lying inside exactly one of \\(c_{1}\\) and \\(c_{2}\\). The region \\(r_{1}\\) is contained inside the same \\(k\\) circles as \\(p\\); the region \\(r_{2}\\) is contained also by \\(c_{1}\\) and \\(c_{2}\\), so by \\(k+2\\) circles in total; each of the regions \\(r_{3}\\) and \\(r_{4}\\) is contained inside \\(k+1\\) circles. After the small arcs have been inserted at \\(p\\), the regions \\(r_{1}\\) and \\(r_{2}\\) get connected, and the regions \\(r_{3}\\) and \\(r_{4}\\) remain separated at \\(p\\) (see Figure 11). If \\(p\\) is an odd point, then \\(r_{1}\\) and \\(r_{2}\\) are odd, so two odd regions are connected at \\(p\\). Otherwise, if \\(p\\) is even, then we have two even regions connected at \\(p\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-50}\n\nFigure 11\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-50(1)}\n\nFigure 12\n\nConsider the system of odd regions and their connections at the odd points as a graph. In this graph the odd regions are the vertices, and each odd point establishes an edge that connects two vertices (see Figure 12). As \\(b\\) is a single closed curve, this graph is connected and contains no cycle, so the graph is a tree. Then the number of vertices must be by one greater than the number of edges, so\n\n\\[\n\\left|\\mathcal{R}_{\\text {odd }}\\right|-\\left|\\mathcal{P}_{\\text {odd }}\\right|=1\n\\]\n\nThe relations (1) and (9) together prove that \\(n\\) must be odd.\nComment. For every odd \\(n\\) there exists at least one configuration of \\(n\\) circles with a single snail orbit. Figure 13 shows a possible configuration with 5 circles. In general, if a circle is rotated by \\(k \\cdot \\frac{360^{\\circ}}{n}\\) \\((k=1,2, \\ldots, n-1)\\) around an interior point other than the centre, the circle and its rotated copies together provide a single snail orbit.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-50(2)}\n\nFigure 13"}
{"id": "imo-shortlist-2014-g1", "question": "G1. The points \\(P\\) and \\(Q\\) are chosen on the side \\(B C\\) of an acute-angled triangle \\(A B C\\) so that \\(\\angle P A B=\\angle A C B\\) and \\(\\angle Q A C=\\angle C B A\\). The points \\(M\\) and \\(N\\) are taken on the rays \\(A P\\) and \\(A Q\\), respectively, so that \\(A P=P M\\) and \\(A Q=Q N\\). Prove that the lines \\(B M\\) and \\(C N\\) intersect on the circumcircle of the triangle \\(A B C\\).\n(Georgia)", "category": "Geometry", "source": "IMO Shortlist", "year": 2014, "solution": "Denote by \\(S\\) the intersection point of the lines \\(B M\\) and \\(C N\\). Let moreover \\(\\beta=\\angle Q A C=\\angle C B A\\) and \\(\\gamma=\\angle P A B=\\angle A C B\\). From these equalities it follows that the triangles \\(A B P\\) and \\(C A Q\\) are similar (see Figure 1). Therefore we obtain\n\n\\[\n\\frac{B P}{P M}=\\frac{B P}{P A}=\\frac{A Q}{Q C}=\\frac{N Q}{Q C} .\n\\]\n\nMoreover,\n\n\\[\n\\angle B P M=\\beta+\\gamma=\\angle C Q N .\n\\]\n\nHence the triangles \\(B P M\\) and \\(N Q C\\) are similar. This gives \\(\\angle B M P=\\angle N C Q\\), so the triangles \\(B P M\\) and \\(B S C\\) are also similar. Thus we get\n\n\\[\n\\angle C S B=\\angle B P M=\\beta+\\gamma=180^{\\circ}-\\angle B A C,\n\\]\n\nwhich completes the solution.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-51(1)}\n\nFigure 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-51}\n\nFigure 2\n\nSolution 2. As in the previous solution, denote by \\(S\\) the intersection point of the lines \\(B M\\) and \\(N C\\). Let moreover the circumcircle of the triangle \\(A B C\\) intersect the lines \\(A P\\) and \\(A Q\\) again at \\(K\\) and \\(L\\), respectively (see Figure 2).\n\nNote that \\(\\angle L B C=\\angle L A C=\\angle C B A\\) and similarly \\(\\angle K C B=\\angle K A B=\\angle B C A\\). It implies that the lines \\(B L\\) and \\(C K\\) meet at a point \\(X\\), being symmetric to the point \\(A\\) with respect to the line \\(B C\\). Since \\(A P=P M\\) and \\(A Q=Q N\\), it follows that \\(X\\) lies on the line \\(M N\\). Therefore, using Pascal's theorem for the hexagon \\(A L B S C K\\), we infer that \\(S\\) lies on the circumcircle of the triangle \\(A B C\\), which finishes the proof.\n\nComment. Both solutions can be modified to obtain a more general result, with the equalities\n\n\\[\nA P=P M \\quad \\text { and } \\quad A Q=Q N\n\\]\n\nreplaced by\n\n\\[\n\\frac{A P}{P M}=\\frac{Q N}{A Q} .\n\\]"}
{"id": "imo-shortlist-2014-g2", "question": "G2. Let \\(A B C\\) be a triangle. The points \\(K, L\\), and \\(M\\) lie on the segments \\(B C, C A\\), and \\(A B\\), respectively, such that the lines \\(A K, B L\\), and \\(C M\\) intersect in a common point. Prove that it is possible to choose two of the triangles \\(A L M, B M K\\), and \\(C K L\\) whose inradii sum up to at least the inradius of the triangle \\(A B C\\).\n(Estonia)", "category": "Geometry", "source": "IMO Shortlist", "year": 2014, "solution": "Denote\n\n\\[\na=\\frac{B K}{K C}, \\quad b=\\frac{C L}{L A}, \\quad c=\\frac{A M}{M B}\n\\]\n\nBy Ceva's theorem, \\(a b c=1\\), so we may, without loss of generality, assume that \\(a \\geqslant 1\\). Then at least one of the numbers \\(b\\) or \\(c\\) is not greater than 1 . Therefore at least one of the pairs \\((a, b)\\), \\((b, c)\\) has its first component not less than 1 and the second one not greater than 1 . Without loss of generality, assume that \\(1 \\leqslant a\\) and \\(b \\leqslant 1\\).\n\nTherefore, we obtain \\(b c \\leqslant 1\\) and \\(1 \\leqslant c a\\), or equivalently\n\n\\[\n\\frac{A M}{M B} \\leqslant \\frac{L A}{C L} \\quad \\text { and } \\quad \\frac{M B}{A M} \\leqslant \\frac{B K}{K C}\n\\]\n\nThe first inequality implies that the line passing through \\(M\\) and parallel to \\(B C\\) intersects the segment \\(A L\\) at a point \\(X\\) (see Figure 1). Therefore the inradius of the triangle \\(A L M\\) is not less than the inradius \\(r_{1}\\) of triangle \\(A M X\\).\n\nSimilarly, the line passing through \\(M\\) and parallel to \\(A C\\) intersects the segment \\(B K\\) at a point \\(Y\\), so the inradius of the triangle \\(B M K\\) is not less than the inradius \\(r_{2}\\) of the triangle \\(B M Y\\). Thus, to complete our solution, it is enough to show that \\(r_{1}+r_{2} \\geqslant r\\), where \\(r\\) is the inradius of the triangle \\(A B C\\). We prove that in fact \\(r_{1}+r_{2}=r\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-52}\n\nFigure 1\nSince \\(M X \\| B C\\), the dilation with centre \\(A\\) that takes \\(M\\) to \\(B\\) takes the incircle of the triangle \\(A M X\\) to the incircle of the triangle \\(A B C\\). Therefore\n\n\\[\n\\frac{r_{1}}{r}=\\frac{A M}{A B}, \\quad \\text { and similarly } \\quad \\frac{r_{2}}{r}=\\frac{M B}{A B} .\n\\]\n\nAdding these equalities gives \\(r_{1}+r_{2}=r\\), as required.\nComment. Alternatively, one can use Desargues' theorem instead of Ceva's theorem, as follows: The lines \\(A B, B C, C A\\) dissect the plane into seven regions. One of them is bounded, and amongst the other six, three are two-sided and three are three-sided. Now define the points \\(P=B C \\cap L M\\), \\(Q=C A \\cap M K\\), and \\(R=A B \\cap K L\\) (in the projective plane). By Desargues' theorem, the points \\(P\\), \\(Q, R\\) lie on a common line \\(\\ell\\). This line intersects only unbounded regions. If we now assume (without loss of generality) that \\(P, Q\\) and \\(R\\) lie on \\(\\ell\\) in that order, then one of the segments \\(P Q\\) or \\(Q R\\) lies inside a two-sided region. If, for example, this segment is \\(P Q\\), then the triangles \\(A L M\\) and \\(B M K\\) will satisfy the statement of the problem for the same reason."}
{"id": "imo-shortlist-2014-g3", "question": "G3. Let \\(\\Omega\\) and \\(O\\) be the circumcircle and the circumcentre of an acute-angled triangle \\(A B C\\) with \\(A B>B C\\). The angle bisector of \\(\\angle A B C\\) intersects \\(\\Omega\\) at \\(M \\neq B\\). Let \\(\\Gamma\\) be the circle with diameter \\(B M\\). The angle bisectors of \\(\\angle A O B\\) and \\(\\angle B O C\\) intersect \\(\\Gamma\\) at points \\(P\\) and \\(Q\\), respectively. The point \\(R\\) is chosen on the line \\(P Q\\) so that \\(B R=M R\\). Prove that \\(B R \\| A C\\). (Here we always assume that an angle bisector is a ray.)\n(Russia)", "category": "Geometry", "source": "IMO Shortlist", "year": 2014, "solution": "Let \\(K\\) be the midpoint of \\(B M\\), i.e., the centre of \\(\\Gamma\\). Notice that \\(A B \\neq B C\\) implies \\(K \\neq O\\). Clearly, the lines \\(O M\\) and \\(O K\\) are the perpendicular bisectors of \\(A C\\) and \\(B M\\), respectively. Therefore, \\(R\\) is the intersection point of \\(P Q\\) and \\(O K\\).\n\nLet \\(N\\) be the second point of intersection of \\(\\Gamma\\) with the line \\(O M\\). Since \\(B M\\) is a diameter of \\(\\Gamma\\), the lines \\(B N\\) and \\(A C\\) are both perpendicular to \\(O M\\). Hence \\(B N \\| A C\\), and it suffices to prove that \\(B N\\) passes through \\(R\\). Our plan for doing this is to interpret the lines \\(B N, O K\\), and \\(P Q\\) as the radical axes of three appropriate circles.\n\nLet \\(\\omega\\) be the circle with diameter \\(B O\\). Since \\(\\angle B N O=\\angle B K O=90^{\\circ}\\), the points \\(N\\) and \\(K\\) lie on \\(\\omega\\).\n\nNext we show that the points \\(O, K, P\\) and \\(Q\\) are concyclic. To this end, let \\(D\\) and \\(E\\) be the midpoints of \\(B C\\) and \\(A B\\), respectively. Clearly, \\(D\\) and \\(E\\) lie on the rays \\(O Q\\) and \\(O P\\), respectively. By our assumptions about the triangle \\(A B C\\), the points \\(B, E, O, K\\), and \\(D\\) lie in this order on \\(\\omega\\). It follows that \\(\\angle E O R=\\angle E B K=\\angle K B D=\\angle K O D\\), so the line \\(K O\\) externally bisects the angle \\(P O Q\\). Since the point \\(K\\) is the centre of \\(\\Gamma\\), it also lies on the perpendicular bisector of \\(P Q\\). So \\(K\\) coincides with the midpoint of the arc \\(P O Q\\) of the circumcircle \\(\\gamma\\) of triangle \\(P O Q\\).\n\nThus the lines \\(O K, B N\\), and \\(P Q\\) are pairwise radical axes of the circles \\(\\omega, \\gamma\\), and \\(\\Gamma\\). Hence they are concurrent at \\(R\\), as required.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-53}"}
{"id": "imo-shortlist-2014-g4", "question": "G4. Consider a fixed circle \\(\\Gamma\\) with three fixed points \\(A, B\\), and \\(C\\) on it. Also, let us fix a real number \\(\\lambda \\in(0,1)\\). For a variable point \\(P \\notin\\{A, B, C\\}\\) on \\(\\Gamma\\), let \\(M\\) be the point on the segment \\(C P\\) such that \\(C M=\\lambda \\cdot C P\\). Let \\(Q\\) be the second point of intersection of the circumcircles of the triangles \\(A M P\\) and \\(B M C\\). Prove that as \\(P\\) varies, the point \\(Q\\) lies on a fixed circle.\n(United Kingdom)", "category": "Geometry", "source": "IMO Shortlist", "year": 2014, "solution": "Throughout the solution, we denote by \\(\\npreceq(a, b)\\) the directed angle between the lines \\(a\\) and \\(b\\).\n\nLet \\(D\\) be the point on the segment \\(A B\\) such that \\(B D=\\lambda \\cdot B A\\). We will show that either \\(Q=D\\), or \\(\\Varangle(D Q, Q B)=\\Varangle(A B, B C)\\); this would mean that the point \\(Q\\) varies over the constant circle through \\(D\\) tangent to \\(B C\\) at \\(B\\), as required.\n\nDenote the circumcircles of the triangles \\(A M P\\) and \\(B M C\\) by \\(\\omega_{A}\\) and \\(\\omega_{B}\\), respectively. The lines \\(A P, B C\\), and \\(M Q\\) are pairwise radical axes of the circles \\(\\Gamma, \\omega_{A}\\), and \\(\\omega_{B}\\), thus either they are parallel, or they share a common point \\(X\\).\n\nAssume that these lines are parallel (see Figure 1). Then the segments \\(A P, Q M\\), and \\(B C\\) have a common perpendicular bisector; the reflection in this bisector maps the segment \\(C P\\) to \\(B A\\), and maps \\(M\\) to \\(Q\\). Therefore, in this case \\(Q\\) lies on \\(A B\\), and \\(B Q / A B=C M / C P=\\) \\(B D / A B\\); so we have \\(Q=D\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-54(1)}\n\nFigure 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-54}\n\nFigure 2\n\nNow assume that the lines \\(A P, Q M\\), and \\(B C\\) are concurrent at some point \\(X\\) (see Figure 2). Notice that the points \\(A, B, Q\\), and \\(X\\) lie on a common circle \\(\\Omega\\) by Miquel's theorem applied to the triangle \\(X P C\\). Let us denote by \\(Y\\) the symmetric image of \\(X\\) about the perpendicular bisector of \\(A B\\). Clearly, \\(Y\\) lies on \\(\\Omega\\), and the triangles \\(Y A B\\) and \\(\\triangle X B A\\) are congruent. Moreover, the triangle \\(X P C\\) is similar to the triangle \\(X B A\\), so it is also similar to the triangle \\(Y A B\\).\n\nNext, the points \\(D\\) and \\(M\\) correspond to each other in similar triangles \\(Y A B\\) and \\(X P C\\), since \\(B D / B A=C M / C P=\\lambda\\). Moreover, the triangles \\(Y A B\\) and \\(X P C\\) are equi-oriented, so \\(\\Varangle(M X, X P)=\\Varangle(D Y, Y A)\\). On the other hand, since the points \\(A, Q, X\\), and \\(Y\\) lie on \\(\\Omega\\), we have \\(\\Varangle(Q Y, Y A)=\\Varangle(M X, X P)\\). Therefore, \\(\\Varangle(Q Y, Y A)=\\Varangle(D Y, Y A)\\), so the points \\(Y, D\\), and \\(Q\\) are collinear.\n\nFinally, we have \\(\\Varangle(D Q, Q B)=\\Varangle(Y Q, Q B)=\\Varangle(Y A, A B)=\\Varangle(A B, B X)=\\Varangle(A B, B C)\\), as desired.\n\nComment. In the original proposal, \\(\\lambda\\) was supposed to be an arbitrary real number distinct from 0 and 1, and the point \\(M\\) was defined by \\(\\overrightarrow{C M}=\\lambda \\cdot \\overrightarrow{C P}\\). The Problem Selection Committee decided to add the restriction \\(\\lambda \\in(0,1)\\) in order to avoid a large case distinction.\n\nSolution 2. As in the previous solution, we introduce the radical centre \\(X=A P \\cap B C \\cap M Q\\) of the circles \\(\\omega_{A}, \\omega_{B}\\), and \\(\\Gamma\\). Next, we also notice that the points \\(A, Q, B\\), and \\(X\\) lie on a common circle \\(\\Omega\\).\n\nIf the point \\(P\\) lies on the arc \\(B A C\\) of \\(\\Gamma\\), then the point \\(X\\) is outside \\(\\Gamma\\), thus the point \\(Q\\) belongs to the ray \\(X M\\), and therefore the points \\(P, A\\), and \\(Q\\) lie on the same side of \\(B C\\). Otherwise, if \\(P\\) lies on the arc \\(B C\\) not containing \\(A\\), then \\(X\\) lies inside \\(\\Gamma\\), so \\(M\\) and \\(Q\\) lie on different sides of \\(B C\\); thus again \\(Q\\) and \\(A\\) lie on the same side of \\(B C\\). So, in each case the points \\(Q\\) and \\(A\\) lie on the same side of \\(B C\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-55}\n\nFigure 3\n\nNow we prove that the ratio\n\n\\[\n\\frac{Q B}{\\sin \\angle Q B C}=\\frac{Q B}{Q X} \\cdot \\frac{Q X}{\\sin \\angle Q B X}\n\\]\n\nis constant. Since the points \\(A, Q, B\\), and \\(X\\) are concyclic, we have\n\n\\[\n\\frac{Q X}{\\sin \\angle Q B X}=\\frac{A X}{\\sin \\angle A B C} .\n\\]\n\nNext, since the points \\(B, Q, M\\), and \\(C\\) are concyclic, the triangles \\(X B Q\\) and \\(X M C\\) are similar, so\n\n\\[\n\\frac{Q B}{Q X}=\\frac{C M}{C X}=\\lambda \\cdot \\frac{C P}{C X} .\n\\]\n\nAnalogously, the triangles \\(X C P\\) and \\(X A B\\) are also similar, so\n\n\\[\n\\frac{C P}{C X}=\\frac{A B}{A X} .\n\\]\n\nTherefore, we obtain\n\n\\[\n\\frac{Q B}{\\sin \\angle Q B C}=\\lambda \\cdot \\frac{A B}{A X} \\cdot \\frac{A X}{\\sin \\angle A B C}=\\lambda \\cdot \\frac{A B}{\\sin \\angle A B C},\n\\]\n\nso this ratio is indeed constant. Thus the circle passing through \\(Q\\) and tangent to \\(B C\\) at \\(B\\) is also constant, and \\(Q\\) varies over this fixed circle.\n\nComment. It is not hard to guess that the desired circle should be tangent to \\(B C\\) at \\(B\\). Indeed, the second paragraph of this solution shows that this circle lies on one side of \\(B C\\); on the other hand, in the limit case \\(P=B\\), the point \\(Q\\) also coincides with \\(B\\).\n\nSolution 3. Let us perform an inversion centred at \\(C\\). Denote by \\(X^{\\prime}\\) the image of a point \\(X\\) under this inversion.\n\nThe circle \\(\\Gamma\\) maps to the line \\(\\Gamma^{\\prime}\\) passing through the constant points \\(A^{\\prime}\\) and \\(B^{\\prime}\\), and containing the variable point \\(P^{\\prime}\\). By the problem condition, the point \\(M\\) varies over the circle \\(\\gamma\\) which is the homothetic image of \\(\\Gamma\\) with centre \\(C\\) and coefficient \\(\\lambda\\). Thus \\(M^{\\prime}\\) varies over the constant line \\(\\gamma^{\\prime} \\| A^{\\prime} B^{\\prime}\\) which is the homothetic image of \\(A^{\\prime} B^{\\prime}\\) with centre \\(C\\) and coefficient \\(1 / \\lambda\\), and \\(M=\\gamma^{\\prime} \\cap C P^{\\prime}\\). Next, the circumcircles \\(\\omega_{A}\\) and \\(\\omega_{B}\\) of the triangles \\(A M P\\) and \\(B M C\\) map to the circumcircle \\(\\omega_{A}^{\\prime}\\) of the triangle \\(A^{\\prime} M^{\\prime} P^{\\prime}\\) and to the line \\(B^{\\prime} M^{\\prime}\\), respectively; the point \\(Q\\) thus maps to the second point of intersection of \\(B^{\\prime} M^{\\prime}\\) with \\(\\omega_{A}^{\\prime}\\) (see Figure 4).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-56}\n\nFigure 4\n\nLet \\(J\\) be the (constant) common point of the lines \\(\\gamma^{\\prime}\\) and \\(C A^{\\prime}\\), and let \\(\\ell\\) be the (constant) line through \\(J\\) parallel to \\(C B^{\\prime}\\). Let \\(V\\) be the common point of the lines \\(\\ell\\) and \\(B^{\\prime} M^{\\prime}\\). Applying Pappus' theorem to the triples \\(\\left(C, J, A^{\\prime}\\right)\\) and \\(\\left(V, B^{\\prime}, M^{\\prime}\\right)\\) we get that the points \\(C B^{\\prime} \\cap J V\\), \\(J M^{\\prime} \\cap A^{\\prime} B^{\\prime}\\), and \\(C M^{\\prime} \\cap A^{\\prime} V\\) are collinear. The first two of these points are ideal, hence so is the third, which means that \\(C M^{\\prime} \\| A^{\\prime} V\\).\n\nNow we have \\(\\npreceq\\left(Q^{\\prime} A^{\\prime}, A^{\\prime} P^{\\prime}\\right)=\\npreceq\\left(Q^{\\prime} M^{\\prime}, M^{\\prime} P^{\\prime}\\right)=\\angle\\left(V M^{\\prime}, A^{\\prime} V\\right)\\), which means that the triangles \\(B^{\\prime} Q^{\\prime} A^{\\prime}\\) and \\(B^{\\prime} A^{\\prime} V\\) are similar, and \\(\\left(B^{\\prime} A^{\\prime}\\right)^{2}=B^{\\prime} Q^{\\prime} \\cdot B^{\\prime} V\\). Thus \\(Q^{\\prime}\\) is the image of \\(V\\) under the second (fixed) inversion with centre \\(B^{\\prime}\\) and radius \\(B^{\\prime} A^{\\prime}\\). Since \\(V\\) varies over the constant line \\(\\ell, Q^{\\prime}\\) varies over some constant circle \\(\\Theta\\). Thus, applying the first inversion back we get that \\(Q\\) also varies over some fixed circle.\n\nOne should notice that this last circle is not a line; otherwise \\(\\Theta\\) would contain \\(C\\), and thus \\(\\ell\\) would contain the image of \\(C\\) under the second inversion. This is impossible, since \\(C B^{\\prime} \\| \\ell\\)."}
{"id": "imo-shortlist-2014-g5", "question": "G5. Let \\(A B C D\\) be a convex quadrilateral with \\(\\angle B=\\angle D=90^{\\circ}\\). Point \\(H\\) is the foot of the perpendicular from \\(A\\) to \\(B D\\). The points \\(S\\) and \\(T\\) are chosen on the sides \\(A B\\) and \\(A D\\), respectively, in such a way that \\(H\\) lies inside triangle \\(S C T\\) and\n\n\\[\n\\angle S H C-\\angle B S C=90^{\\circ}, \\quad \\angle T H C-\\angle D T C=90^{\\circ} .\n\\]\n\nProve that the circumcircle of triangle \\(S H T\\) is tangent to the line \\(B D\\).\n(Iran)", "category": "Geometry", "source": "IMO Shortlist", "year": 2014, "solution": "Let the line passing through \\(C\\) and perpendicular to the line \\(S C\\) intersect the line \\(A B\\) at \\(Q\\) (see Figure 1). Then\n\n\\[\n\\angle S Q C=90^{\\circ}-\\angle B S C=180^{\\circ}-\\angle S H C,\n\\]\n\nwhich implies that the points \\(C, H, S\\), and \\(Q\\) lie on a common circle. Moreover, since \\(S Q\\) is a diameter of this circle, we infer that the circumcentre \\(K\\) of triangle \\(S H C\\) lies on the line \\(A B\\). Similarly, we prove that the circumcentre \\(L\\) of triangle \\(C H T\\) lies on the line \\(A D\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-57}\n\nFigure 1\nIn order to prove that the circumcircle of triangle \\(S H T\\) is tangent to \\(B D\\), it suffices to show that the perpendicular bisectors of \\(H S\\) and \\(H T\\) intersect on the line \\(A H\\). However, these two perpendicular bisectors coincide with the angle bisectors of angles \\(A K H\\) and \\(A L H\\). Therefore, in order to complete the solution, it is enough (by the bisector theorem) to show that\n\n\\[\n\\frac{A K}{K H}=\\frac{A L}{L H} .\n\\]\n\nWe present two proofs of this equality.\nFirst proof. Let the lines \\(K L\\) and \\(H C\\) intersect at \\(M\\) (see Figure 2). Since \\(K H=K C\\) and \\(L H=L C\\), the points \\(H\\) and \\(C\\) are symmetric to each other with respect to the line \\(K L\\). Therefore \\(M\\) is the midpoint of \\(H C\\). Denote by \\(O\\) the circumcentre of quadrilateral \\(A B C D\\). Then \\(O\\) is the midpoint of \\(A C\\). Therefore we have \\(O M \\| A H\\) and hence \\(O M \\perp B D\\). This together with the equality \\(O B=O D\\) implies that \\(O M\\) is the perpendicular bisector of \\(B D\\) and therefore \\(B M=D M\\).\n\nSince \\(C M \\perp K L\\), the points \\(B, C, M\\), and \\(K\\) lie on a common circle with diameter \\(K C\\). Similarly, the points \\(L, C, M\\), and \\(D\\) lie on a circle with diameter \\(L C\\). Thus, using the sine law, we obtain\n\n\\[\n\\frac{A K}{A L}=\\frac{\\sin \\angle A L K}{\\sin \\angle A K L}=\\frac{D M}{C L} \\cdot \\frac{C K}{B M}=\\frac{C K}{C L}=\\frac{K H}{L H},\n\\]\n\nwhich finishes the proof of (1).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-58(1)}\n\nFigure 2\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-58}\n\nFigure 3\n\nSecond proof. If the points \\(A, H\\), and \\(C\\) are collinear, then \\(A K=A L\\) and \\(K H=L H\\), so the equality (1) follows. Assume therefore that the points \\(A, H\\), and \\(C\\) do not lie in a line and consider the circle \\(\\omega\\) passing through them (see Figure 3). Since the quadrilateral \\(A B C D\\) is cyclic,\n\n\\[\n\\angle B A C=\\angle B D C=90^{\\circ}-\\angle A D H=\\angle H A D .\n\\]\n\nLet \\(N \\neq A\\) be the intersection point of the circle \\(\\omega\\) and the angle bisector of \\(\\angle C A H\\). Then \\(A N\\) is also the angle bisector of \\(\\angle B A D\\). Since \\(H\\) and \\(C\\) are symmetric to each other with respect to the line \\(K L\\) and \\(H N=N C\\), it follows that both \\(N\\) and the centre of \\(\\omega\\) lie on the line \\(K L\\). This means that the circle \\(\\omega\\) is an Apollonius circle of the points \\(K\\) and \\(L\\). This immediately yields (1).\n\nComment. Either proof can be used to obtain the following generalised result:\nLet \\(A B C D\\) be a convex quadrilateral and let \\(H\\) be a point in its interior with \\(\\angle B A C=\\angle D A H\\). The points \\(S\\) and \\(T\\) are chosen on the sides \\(A B\\) and \\(A D\\), respectively, in such a way that \\(H\\) lies inside triangle SCT and\n\n\\[\n\\angle S H C-\\angle B S C=90^{\\circ}, \\quad \\angle T H C-\\angle D T C=90^{\\circ} .\n\\]\n\nThen the circumcentre of triangle SHT lies on the line AH (and moreover the circumcentre of triangle \\(S C T\\) lies on \\(A C\\) )."}
{"id": "imo-shortlist-2014-g6", "question": "G6. Let \\(A B C\\) be a fixed acute-angled triangle. Consider some points \\(E\\) and \\(F\\) lying on the sides \\(A C\\) and \\(A B\\), respectively, and let \\(M\\) be the midpoint of \\(E F\\). Let the perpendicular bisector of \\(E F\\) intersect the line \\(B C\\) at \\(K\\), and let the perpendicular bisector of \\(M K\\) intersect the lines \\(A C\\) and \\(A B\\) at \\(S\\) and \\(T\\), respectively. We call the pair ( \\(E, F\\) ) interesting, if the quadrilateral KSAT is cyclic.\n\nSuppose that the pairs ( \\(E_{1}, F_{1}\\) ) and ( \\(E_{2}, F_{2}\\) ) are interesting. Prove that\n\n\\[\n\\frac{E_{1} E_{2}}{A B}=\\frac{F_{1} F_{2}}{A C} .\n\\]\n\n(Iran)", "category": "Geometry", "source": "IMO Shortlist", "year": 2014, "solution": "For any interesting pair ( \\(E, F\\) ), we will say that the corresponding triangle \\(E F K\\) is also interesting.\n\nLet \\(E F K\\) be an interesting triangle. Firstly, we prove that \\(\\angle K E F=\\angle K F E=\\angle A\\), which also means that the circumcircle \\(\\omega_{1}\\) of the triangle \\(A E F\\) is tangent to the lines \\(K E\\) and \\(K F\\).\n\nDenote by \\(\\omega\\) the circle passing through the points \\(K, S, A\\), and \\(T\\). Let the line \\(A M\\) intersect the line \\(S T\\) and the circle \\(\\omega\\) (for the second time) at \\(N\\) and \\(L\\), respectively (see Figure 1).\n\nSince \\(E F \\| T S\\) and \\(M\\) is the midpoint of \\(E F, N\\) is the midpoint of \\(S T\\). Moreover, since \\(K\\) and \\(M\\) are symmetric to each other with respect to the line \\(S T\\), we have \\(\\angle K N S=\\angle M N S=\\) \\(\\angle L N T\\). Thus the points \\(K\\) and \\(L\\) are symmetric to each other with respect to the perpendicular bisector of \\(S T\\). Therefore \\(K L \\| S T\\).\n\nLet \\(G\\) be the point symmetric to \\(K\\) with respect to \\(N\\). Then \\(G\\) lies on the line \\(E F\\), and we may assume that it lies on the ray \\(M F\\). One has\n\n\\[\n\\angle K G E=\\angle K N S=\\angle S N M=\\angle K L A=180^{\\circ}-\\angle K S A\n\\]\n\n(if \\(K=L\\), then the angle \\(K L A\\) is understood to be the angle between \\(A L\\) and the tangent to \\(\\omega\\) at \\(L\\) ). This means that the points \\(K, G, E\\), and \\(S\\) are concyclic. Now, since \\(K S G T\\) is a parallelogram, we obtain \\(\\angle K E F=\\angle K S G=180^{\\circ}-\\angle T K S=\\angle A\\). Since \\(K E=K F\\), we also have \\(\\angle K F E=\\angle K E F=\\angle A\\).\n\nAfter having proved this fact, one may finish the solution by different methods.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-59(1)}\n\nFigure 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-59}\n\nFigure 2\n\nFirst method. We have just proved that all interesting triangles are similar to each other. This allows us to use the following lemma.\n\nLemma. Let \\(A B C\\) be an arbitrary triangle. Choose two points \\(E_{1}\\) and \\(E_{2}\\) on the side \\(A C\\), two points \\(F_{1}\\) and \\(F_{2}\\) on the side \\(A B\\), and two points \\(K_{1}\\) and \\(K_{2}\\) on the side \\(B C\\), in a way that the triangles \\(E_{1} F_{1} K_{1}\\) and \\(E_{2} F_{2} K_{2}\\) are similar. Then the six circumcircles of the triangles \\(A E_{i} F_{i}\\), \\(B F_{i} K_{i}\\), and \\(C E_{i} K_{i}(i=1,2)\\) meet at a common point \\(Z\\). Moreover, \\(Z\\) is the centre of the spiral similarity that takes the triangle \\(E_{1} F_{1} K_{1}\\) to the triangle \\(E_{2} F_{2} K_{2}\\).\nProof. Firstly, notice that for each \\(i=1,2\\), the circumcircles of the triangles \\(A E_{i} F_{i}, B F_{i} K_{i}\\), and \\(C K_{i} E_{i}\\) have a common point \\(Z_{i}\\) by Miquel's theorem. Moreover, we have\n\\(\\npreceq\\left(Z_{i} F_{i}, Z_{i} E_{i}\\right)=\\npreceq(A B, C A), \\quad \\npreceq\\left(Z_{i} K_{i}, Z_{i} F_{i}\\right)=\\npreceq(B C, A B), \\quad \\npreceq\\left(Z_{i} E_{i}, Z_{i} K_{i}\\right)=\\npreceq(C A, B C)\\).\nThis yields that the points \\(Z_{1}\\) and \\(Z_{2}\\) correspond to each other in similar triangles \\(E_{1} F_{1} K_{1}\\) and \\(E_{2} F_{2} K_{2}\\). Thus, if they coincide, then this common point is indeed the desired centre of a spiral similarity.\n\nFinally, in order to show that \\(Z_{1}=Z_{2}\\), one may notice that \\(\\Varangle\\left(A B, A Z_{1}\\right)=\\Varangle\\left(E_{1} F_{1}, E_{1} Z_{1}\\right)=\\) \\(\\npreceq\\left(E_{2} F_{2}, E_{2} Z_{2}\\right)=\\npreceq\\left(A B, A Z_{2}\\right)\\) (see Figure 2). Similarly, one has \\(\\npreceq\\left(B C, B Z_{1}\\right)=\\npreceq\\left(B C, B Z_{2}\\right)\\) and \\(\\Varangle\\left(C A, C Z_{1}\\right)=\\Varangle\\left(C A, C Z_{2}\\right)\\). This yields \\(Z_{1}=Z_{2}\\).\n\nNow, let \\(P\\) and \\(Q\\) be the feet of the perpendiculars from \\(B\\) and \\(C\\) onto \\(A C\\) and \\(A B\\), respectively, and let \\(R\\) be the midpoint of \\(B C\\) (see Figure 3). Then \\(R\\) is the circumcentre of the cyclic quadrilateral \\(B C P Q\\). Thus we obtain \\(\\angle A P Q=\\angle B\\) and \\(\\angle R P C=\\angle C\\), which yields \\(\\angle Q P R=\\angle A\\). Similarly, we show that \\(\\angle P Q R=\\angle A\\). Thus, all interesting triangles are similar to the triangle \\(P Q R\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-60(1)}\n\nFigure 3\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-60}\n\nFigure 4\n\nDenote now by \\(Z\\) the common point of the circumcircles of \\(A P Q, B Q R\\), and \\(C P R\\). Let \\(E_{1} F_{1} K_{1}\\) and \\(E_{2} F_{2} K_{2}\\) be two interesting triangles. By the lemma, \\(Z\\) is the centre of any spiral similarity taking one of the triangles \\(E_{1} F_{1} K_{1}, E_{2} F_{2} K_{2}\\), and \\(P Q R\\) to some other of them. Therefore the triangles \\(Z E_{1} E_{2}\\) and \\(Z F_{1} F_{2}\\) are similar, as well as the triangles \\(Z E_{1} F_{1}\\) and \\(Z P Q\\). Hence\n\n\\[\n\\frac{E_{1} E_{2}}{F_{1} F_{2}}=\\frac{Z E_{1}}{Z F_{1}}=\\frac{Z P}{Z Q}\n\\]\n\nMoreover, the equalities \\(\\angle A Z Q=\\angle A P Q=\\angle A B C=180^{\\circ}-\\angle Q Z R\\) show that the point \\(Z\\) lies on the line \\(A R\\) (see Figure 4). Therefore the triangles \\(A Z P\\) and \\(A C R\\) are similar, as well as the triangles \\(A Z Q\\) and \\(A B R\\). This yields\n\n\\[\n\\frac{Z P}{Z Q}=\\frac{Z P}{R C} \\cdot \\frac{R B}{Z Q}=\\frac{A Z}{A C} \\cdot \\frac{A B}{A Z}=\\frac{A B}{A C}\n\\]\n\nwhich completes the solution.\n\nSecond method. Now we will start from the fact that \\(\\omega_{1}\\) is tangent to the lines \\(K E\\) and \\(K F\\) (see Figure 5). We prove that if ( \\(E, F\\) ) is an interesting pair, then\n\n\\[\n\\frac{A E}{A B}+\\frac{A F}{A C}=2 \\cos \\angle A .\n\\]\n\nLet \\(Y\\) be the intersection point of the segments \\(B E\\) and \\(C F\\). The points \\(B, K\\), and \\(C\\) are collinear, hence applying PASCAL's theorem to the degenerated hexagon AFFYEE, we infer that \\(Y\\) lies on the circle \\(\\omega_{1}\\).\n\nDenote by \\(Z\\) the second intersection point of the circumcircle of the triangle \\(B F Y\\) with the line \\(B C\\) (see Figure 6). By Miquel's theorem, the points \\(C, Z, Y\\), and \\(E\\) are concyclic. Therefore we obtain\n\n\\[\nB F \\cdot A B+C E \\cdot A C=B Y \\cdot B E+C Y \\cdot C F=B Z \\cdot B C+C Z \\cdot B C=B C^{2} .\n\\]\n\nOn the other hand, \\(B C^{2}=A B^{2}+A C^{2}-2 A B \\cdot A C \\cos \\angle A\\), by the cosine law. Hence\n\n\\[\n(A B-A F) \\cdot A B+(A C-A E) \\cdot A C=A B^{2}+A C^{2}-2 A B \\cdot A C \\cos \\angle A,\n\\]\n\nwhich simplifies to the desired equality (1).\nLet now ( \\(E_{1}, F_{1}\\) ) and ( \\(E_{2}, F_{2}\\) ) be two interesting pairs of points. Then we get\n\n\\[\n\\frac{A E_{1}}{A B}+\\frac{A F_{1}}{A C}=\\frac{A E_{2}}{A B}+\\frac{A F_{2}}{A C},\n\\]\n\nwhich gives the desired result.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-61(1)}\n\nFigure 5\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-61}\n\nFigure 6\n\nThird method. Again, we make use of the fact that all interesting triangles are similar (and equi-oriented). Let us put the picture onto a complex plane such that \\(A\\) is at the origin, and identify each point with the corresponding complex number.\n\nLet \\(E F K\\) be any interesting triangle. The equalities \\(\\angle K E F=\\angle K F E=\\angle A\\) yield that the ratio \\(\\nu=\\frac{K-E}{F-E}\\) is the same for all interesting triangles. This in turn means that the numbers \\(E\\), \\(F\\), and \\(K\\) satisfy the linear equation\n\n\\[\nK=\\mu E+\\nu F, \\quad \\text { where } \\quad \\mu=1-\\nu .\n\\]\n\nNow let us choose the points \\(X\\) and \\(Y\\) on the rays \\(A B\\) and \\(A C\\), respectively, so that \\(\\angle C X A=\\angle A Y B=\\angle A=\\angle K E F\\) (see Figure 7). Then each of the triangles \\(A X C\\) and \\(Y A B\\) is similar to any interesting triangle, which also means that\n\n\\[\nC=\\mu A+\\nu X=\\nu X \\quad \\text { and } \\quad B=\\mu Y+\\nu A=\\mu Y\n\\]\n\nMoreover, one has \\(X / Y=\\overline{C / B}\\).\nSince the points \\(E, F\\), and \\(K\\) lie on \\(A C, A B\\), and \\(B C\\), respectively, one gets\n\n\\[\nE=\\rho Y, \\quad F=\\sigma X, \\quad \\text { and } \\quad K=\\lambda B+(1-\\lambda) C\n\\]\n\nfor some real \\(\\rho, \\sigma\\), and \\(\\lambda\\). In view of (3), the equation (2) now reads \\(\\lambda B+(1-\\lambda) C=K=\\) \\(\\mu E+\\nu F=\\rho B+\\sigma C\\), or\n\n\\[\n(\\lambda-\\rho) B=(\\sigma+\\lambda-1) C\n\\]\n\nSince the nonzero complex numbers \\(B\\) and \\(C\\) have different arguments, the coefficients in the brackets vanish, so \\(\\rho=\\lambda\\) and \\(\\sigma=1-\\lambda\\). Therefore,\n\n\\[\n\\frac{E}{Y}+\\frac{F}{X}=\\rho+\\sigma=1\n\\]\n\nNow, if ( \\(E_{1}, F_{1}\\) ) and ( \\(E_{2}, F_{2}\\) ) are two distinct interesting pairs, one may apply (4) to both pairs. Subtracting, we get\n\n\\[\n\\frac{E_{1}-E_{2}}{Y}=\\frac{F_{2}-F_{1}}{X}, \\quad \\text { so } \\quad \\frac{E_{1}-E_{2}}{F_{2}-F_{1}}=\\frac{Y}{X}=\\frac{\\bar{B}}{\\bar{C}} .\n\\]\n\nTaking absolute values provides the required result.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-62}\n\nFigure 7\n\nComment 1. One may notice that the triangle \\(P Q R\\) is also interesting.\n\nComment 2. In order to prove that \\(\\angle K E F=\\angle K F E=\\angle A\\), one may also use the following well-known fact:\nLet \\(A E F\\) be a triangle with \\(A E \\neq A F\\), and let \\(K\\) be the common point of the symmedian taken from \\(A\\) and the perpendicular bisector of \\(E F\\). Then the lines \\(K E\\) and \\(K F\\) are tangent to the circumcircle \\(\\omega_{1}\\) of the triangle \\(A E F\\).\n\nIn this case, however, one needs to deal with the case \\(A E=A F\\) separately.\n\nSolution 2. Let \\((E, F)\\) be an interesting pair. This time we prove that\n\n\\[\n\\frac{A M}{A K}=\\cos \\angle A\n\\]\n\nAs in Solution 1, we introduce the circle \\(\\omega\\) passing through the points \\(K, S, A\\), and \\(T\\), together with the points \\(N\\) and \\(L\\) at which the line \\(A M\\) intersect the line \\(S T\\) and the circle \\(\\omega\\) for the second time, respectively. Let moreover \\(O\\) be the centre of \\(\\omega\\) (see Figures 8 and 9). As in Solution 1, we note that \\(N\\) is the midpoint of \\(S T\\) and show that \\(K L \\| S T\\), which implies \\(\\angle F A M=\\angle E A K\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-63(1)}\n\nFigure 8\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-63}\n\nFigure 9\n\nSuppose now that \\(K \\neq L\\) (see Figure 8). Then \\(K L \\| S T\\), and consequently the lines \\(K M\\) and \\(K L\\) are perpendicular. It implies that the lines \\(L O\\) and \\(K M\\) meet at a point \\(X\\) lying on the circle \\(\\omega\\). Since the lines \\(O N\\) and \\(X M\\) are both perpendicular to the line \\(S T\\), they are parallel to each other, and hence \\(\\angle L O N=\\angle L X K=\\angle M A K\\). On the other hand, \\(\\angle O L N=\\angle M K A\\), so we infer that triangles \\(N O L\\) and \\(M A K\\) are similar. This yields\n\n\\[\n\\frac{A M}{A K}=\\frac{O N}{O L}=\\frac{O N}{O T}=\\cos \\angle T O N=\\cos \\angle A .\n\\]\n\nIf, on the other hand, \\(K=L\\), then the points \\(A, M, N\\), and \\(K\\) lie on a common line, and this line is the perpendicular bisector of \\(S T\\) (see Figure 9). This implies that \\(A K\\) is a diameter of \\(\\omega\\), which yields \\(A M=2 O K-2 N K=2 O N\\). So also in this case we obtain\n\n\\[\n\\frac{A M}{A K}=\\frac{2 O N}{2 O T}=\\cos \\angle T O N=\\cos \\angle A .\n\\]\n\nThus (5) is proved.\nLet \\(P\\) and \\(Q\\) be the feet of the perpendiculars from \\(B\\) and \\(C\\) onto \\(A C\\) and \\(A B\\), respectively (see Figure 10). We claim that the point \\(M\\) lies on the line \\(P Q\\). Consider now the composition of the dilatation with factor \\(\\cos \\angle A\\) and centre \\(A\\), and the reflection with respect to the angle bisector of \\(\\angle B A C\\). This transformation is a similarity that takes \\(B, C\\), and \\(K\\) to \\(P, Q\\), and \\(M\\), respectively. Since \\(K\\) lies on the line \\(B C\\), the point \\(M\\) lies on the line \\(P Q\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-64}\n\nFigure 10\nSuppose that \\(E \\neq P\\). Then also \\(F \\neq Q\\), and by Menelaus' theorem, we obtain\n\n\\[\n\\frac{A Q}{F Q} \\cdot \\frac{F M}{E M} \\cdot \\frac{E P}{A P}=1\n\\]\n\nUsing the similarity of the triangles \\(A P Q\\) and \\(A B C\\), we infer that\n\n\\[\n\\frac{E P}{F Q}=\\frac{A P}{A Q}=\\frac{A B}{A C}, \\quad \\text { and hence } \\quad \\frac{E P}{A B}=\\frac{F Q}{A C} .\n\\]\n\nThe last equality holds obviously also in case \\(E=P\\), because then \\(F=Q\\). Moreover, since the line \\(P Q\\) intersects the segment \\(E F\\), we infer that the point \\(E\\) lies on the segment \\(A P\\) if and only if the point \\(F\\) lies outside of the segment \\(A Q\\).\n\nLet now ( \\(E_{1}, F_{1}\\) ) and ( \\(E_{2}, F_{2}\\) ) be two interesting pairs. Then we obtain\n\n\\[\n\\frac{E_{1} P}{A B}=\\frac{F_{1} Q}{A C} \\quad \\text { and } \\quad \\frac{E_{2} P}{A B}=\\frac{F_{2} Q}{A C}\n\\]\n\nIf \\(P\\) lies between the points \\(E_{1}\\) and \\(E_{2}\\), we add the equalities above, otherwise we subtract them. In any case we obtain\n\n\\[\n\\frac{E_{1} E_{2}}{A B}=\\frac{F_{1} F_{2}}{A C},\n\\]\n\nwhich completes the solution."}
{"id": "imo-shortlist-2014-g7", "question": "G7. Let \\(A B C\\) be a triangle with circumcircle \\(\\Omega\\) and incentre \\(I\\). Let the line passing through \\(I\\) and perpendicular to \\(C I\\) intersect the segment \\(B C\\) and the arc \\(B C\\) (not containing \\(A\\) ) of \\(\\Omega\\) at points \\(U\\) and \\(V\\), respectively. Let the line passing through \\(U\\) and parallel to \\(A I\\) intersect \\(A V\\) at \\(X\\), and let the line passing through \\(V\\) and parallel to \\(A I\\) intersect \\(A B\\) at \\(Y\\). Let \\(W\\) and \\(Z\\) be the midpoints of \\(A X\\) and \\(B C\\), respectively. Prove that if the points \\(I, X\\), and \\(Y\\) are collinear, then the points \\(I, W\\), and \\(Z\\) are also collinear.", "category": "Geometry", "source": "IMO Shortlist", "year": 2014, "solution": "We start with some general observations. Set \\(\\alpha=\\angle A / 2, \\beta=\\angle B / 2, \\gamma=\\angle C / 2\\). Then obviously \\(\\alpha+\\beta+\\gamma=90^{\\circ}\\). Since \\(\\angle U I C=90^{\\circ}\\), we obtain \\(\\angle I U C=\\alpha+\\beta\\). Therefore \\(\\angle B I V=\\angle I U C-\\angle I B C=\\alpha=\\angle B A I=\\angle B Y V\\), which implies that the points \\(B, Y, I\\), and \\(V\\) lie on a common circle (see Figure 1).\n\nAssume now that the points \\(I, X\\) and \\(Y\\) are collinear. We prove that \\(\\angle Y I A=90^{\\circ}\\).\nLet the line \\(X U\\) intersect \\(A B\\) at \\(N\\). Since the lines \\(A I, U X\\), and \\(V Y\\) are parallel, we get\n\n\\[\n\\frac{N X}{A I}=\\frac{Y N}{Y A}=\\frac{V U}{V I}=\\frac{X U}{A I},\n\\]\n\nimplying \\(N X=X U\\). Moreover, \\(\\angle B I U=\\alpha=\\angle B N U\\). This implies that the quadrilateral \\(B U I N\\) is cyclic, and since \\(B I\\) is the angle bisector of \\(\\angle U B N\\), we infer that \\(N I=U I\\). Thus in the isosceles triangle \\(N I U\\), the point \\(X\\) is the midpoint of the base \\(N U\\). This gives \\(\\angle I X N=90^{\\circ}\\), i.e., \\(\\angle Y I A=90^{\\circ}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-65}\n\nFigure 1\nLet \\(S\\) be the midpoint of the segment \\(V C\\). Let moreover \\(T\\) be the intersection point of the lines \\(A X\\) and \\(S I\\), and set \\(x=\\angle B A V=\\angle B C V\\). Since \\(\\angle C I A=90^{\\circ}+\\beta\\) and \\(S I=S C\\), we obtain\n\n\\[\n\\angle T I A=180^{\\circ}-\\angle A I S=90^{\\circ}-\\beta-\\angle C I S=90^{\\circ}-\\beta-\\gamma-x=\\alpha-x=\\angle T A I,\n\\]\n\nwhich implies that \\(T I=T A\\). Therefore, since \\(\\angle X I A=90^{\\circ}\\), the point \\(T\\) is the midpoint of \\(A X\\), i.e., \\(T=W\\).\n\nTo complete our solution, it remains to show that the intersection point of the lines IS and \\(B C\\) coincide with the midpoint of the segment \\(B C\\). But since \\(S\\) is the midpoint of the segment \\(V C\\), it suffices to show that the lines \\(B V\\) and \\(I S\\) are parallel.\n\nSince the quadrilateral \\(B Y I V\\) is cyclic, \\(\\angle V B I=\\angle V Y I=\\angle Y I A=90^{\\circ}\\). This implies that \\(B V\\) is the external angle bisector of the angle \\(A B C\\), which yields \\(\\angle V A C=\\angle V C A\\). Therefore \\(2 \\alpha-x=2 \\gamma+x\\), which gives \\(\\alpha=\\gamma+x\\). Hence \\(\\angle S C I=\\alpha\\), so \\(\\angle V S I=2 \\alpha\\).\n\nOn the other hand, \\(\\angle B V C=180^{\\circ}-\\angle B A C=180^{\\circ}-2 \\alpha\\), which implies that the lines \\(B V\\) and \\(I S\\) are parallel. This completes the solution.\n\nSolution 2. As in Solution 1, we first prove that the points \\(B, Y, I, V\\) lie on a common circle and \\(\\angle Y I A=90^{\\circ}\\). The remaining part of the solution is based on the following lemma, which holds true for any triangle \\(A B C\\), not necessarily with the property that \\(I, X, Y\\) are collinear. Lemma. Let \\(A B C\\) be the triangle inscribed in a circle \\(\\Gamma\\) and let \\(I\\) be its incentre. Assume that the line passing through \\(I\\) and perpendicular to the line \\(A I\\) intersects the side \\(A B\\) at the point \\(Y\\). Let the circumcircle of the triangle \\(B Y I\\) intersect the circle \\(\\Gamma\\) for the second time at \\(V\\), and let the excircle of the triangle \\(A B C\\) opposite to the vertex \\(A\\) be tangent to the side \\(B C\\) at \\(E\\). Then\n\n\\[\n\\angle B A V=\\angle C A E\n\\]\n\nProof. Let \\(\\rho\\) be the composition of the inversion with centre \\(A\\) and radius \\(\\sqrt{A B \\cdot A C}\\), and the symmetry with respect to \\(A I\\). Clearly, \\(\\rho\\) interchanges \\(B\\) and \\(C\\).\n\nLet \\(J\\) be the excentre of the triangle \\(A B C\\) opposite to \\(A\\) (see Figure 2). Then we have \\(\\angle J A C=\\angle B A I\\) and \\(\\angle J C A=90^{\\circ}+\\gamma=\\angle B I A\\), so the triangles \\(A C J\\) and \\(A I B\\) are similar, and therefore \\(A B \\cdot A C=A I \\cdot A J\\). This means that \\(\\rho\\) interchanges \\(I\\) and \\(J\\). Moreover, since \\(Y\\) lies on \\(A B\\) and \\(\\angle A I Y=90^{\\circ}\\), the point \\(Y^{\\prime}=\\rho(Y)\\) lies on \\(A C\\), and \\(\\angle J Y^{\\prime} A=90^{\\circ}\\). Thus \\(\\rho\\) maps the circumcircle \\(\\gamma\\) of the triangle \\(B Y I\\) to a circle \\(\\gamma^{\\prime}\\) with diameter \\(J C\\).\n\nFinally, since \\(V\\) lies on both \\(\\Gamma\\) and \\(\\gamma\\), the point \\(V^{\\prime}=\\rho(V)\\) lies on the line \\(\\rho(\\Gamma)=A B\\) as well as on \\(\\gamma^{\\prime}\\), which in turn means that \\(V^{\\prime}=E\\). This implies the desired result.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-66}\n\nFigure 2\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-66(1)}\n\nFigure 3\n\nNow we turn to the solution of the problem.\nAssume that the incircle \\(\\omega_{1}\\) of the triangle \\(A B C\\) is tangent to \\(B C\\) at \\(D\\), and let the excircle \\(\\omega_{2}\\) of the triangle \\(A B C\\) opposite to the vertex \\(A\\) touch the side \\(B C\\) at \\(E\\) (see Figure 3 ). The homothety with centre \\(A\\) that takes \\(\\omega_{2}\\) to \\(\\omega_{1}\\) takes the point \\(E\\) to some point \\(F\\), and the\ntangent to \\(\\omega_{1}\\) at \\(F\\) is parallel to \\(B C\\). Therefore \\(D F\\) is a diameter of \\(\\omega_{1}\\). Moreover, \\(Z\\) is the midpoint of \\(D E\\). This implies that the lines \\(I Z\\) and \\(F E\\) are parallel.\n\nLet \\(K=Y I \\cap A E\\). Since \\(\\angle Y I A=90^{\\circ}\\), the lemma yields that \\(I\\) is the midpoint of \\(X K\\). This implies that the segments \\(I W\\) and \\(A K\\) are parallel. Therefore, the points \\(W, I\\) and \\(Z\\) are collinear.\n\nComment 1. The properties \\(\\angle Y I A=90^{\\circ}\\) and \\(V A=V C\\) can be established in various ways. The main difficulty of the problem seems to find out how to use these properties in connection to the points \\(W\\) and \\(Z\\).\n\nIn Solution 2 this principal part is more or less covered by the lemma, for which we have presented a direct proof. On the other hand, this lemma appears to be a combination of two well-known facts; let us formulate them in terms of the lemma statement.\n\nLet the line \\(I Y\\) intersect \\(A C\\) at \\(P\\) (see Figure 4). The first fact states that the circumcircle \\(\\omega\\) of the triangle \\(V Y P\\) is tangent to the segments \\(A B\\) and \\(A C\\), as well as to the circle \\(\\Gamma\\). The second fact states that for such a circle, the angles \\(B A V\\) and \\(C A E\\) are equal.\n\nThe awareness of this lemma may help a lot in solving this problem; so the Jury might also consider a variation of the proposed problem, for which the lemma does not seem to be useful; see Comment 3.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-67}\n\nComment 2. The proposed problem stated the equivalence: the point \\(I\\) lies on the line \\(X Y\\) if and only if \\(I\\) lies on the line \\(W Z\\). Here we sketch the proof of the \"if\" part (see Figure 5).\nAs in Solution 2, let \\(B C\\) touch the circles \\(\\omega_{1}\\) and \\(\\omega_{2}\\) at \\(D\\) and \\(E\\), respectively. Since \\(I Z \\| A E\\) and \\(W\\) lies on \\(I Z\\), the line \\(D X\\) is also parallel to \\(A E\\). Therefore, the triangles \\(X U P\\) and \\(A I Q\\) are similar. Moreover, the line \\(D X\\) is symmetric to \\(A E\\) with respect to \\(I\\), so \\(I P=I Q\\), where \\(P=U V \\cap X D\\) and \\(Q=U V \\cap A E\\). Thus we obtain\n\n\\[\n\\frac{U V}{V I}=\\frac{U X}{I A}=\\frac{U P}{I Q}=\\frac{U P}{I P} .\n\\]\n\nSo the pairs \\(I U\\) and \\(P V\\) are harmonic conjugates, and since \\(\\angle U D I=90^{\\circ}\\), we get \\(\\angle V D B=\\angle B D X=\\) \\(\\angle B E A\\). Therefore the point \\(V^{\\prime}\\) symmetric to \\(V\\) with respect to the perpendicular bisector of \\(B C\\) lies on the line \\(A E\\). So we obtain \\(\\angle B A V=\\angle C A E\\).\n\nThe rest can be obtained by simply reversing the arguments in Solution 2. The points \\(B, V, I\\), and \\(Y\\) are concyclic. The lemma implies that \\(\\angle Y I A=90^{\\circ}\\). Moreover, the points \\(B, U, I\\), and \\(N\\), where \\(N=U X \\cap A B\\), lie on a common circle, so \\(I N=I U\\). Since \\(I Y \\perp U N\\), the point \\(X^{\\prime}=I Y \\cap U N\\) is the midpoint of \\(U N\\). But in the trapezoid \\(A Y V I\\), the line \\(X U\\) is parallel to the sides \\(A I\\) and \\(Y V\\), so \\(N X=U X^{\\prime}\\). This yields \\(X=X^{\\prime}\\).\nThe reasoning presented in Solution 1 can also be reversed, but it requires a lot of technicalities. Therefore the Problem Selection Committee proposes to consider only the \"only if\" part of the original proposal, which is still challenging enough.\n\nComment 3. The Jury might also consider the following variation of the proposed problem.\nLet \\(A B C\\) be a triangle with circumcircle \\(\\Omega\\) and incentre \\(I\\). Let the line through \\(I\\) perpendicular to \\(C I\\) intersect the segment \\(B C\\) and the arc \\(B C\\) (not containing \\(A\\) ) of \\(\\Omega\\) at \\(U\\) and \\(V\\), respectively. Let the line through \\(U\\) parallel to AI intersect AV at X. Prove that if the lines XI and AI are perpendicular, then the midpoint of the segment \\(A C\\) lies on the line XI (see Figure 6).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-68}\n\nFigure 6\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_9bb46cbb35375004ecb7g-68(1)}\n\nFigure 7\n\nSince the solution contains the arguments used above, we only sketch it.\nLet \\(N=X U \\cap A B\\) (see Figure 7). Then \\(\\angle B N U=\\angle B A I=\\angle B I U\\), so the points \\(B, U, I\\), and \\(N\\) lie on a common circle. Therefore \\(I U=I N\\), and since \\(I X \\perp N U\\), it follows that \\(N X=X U\\).\nNow set \\(Y=X I \\cap A B\\). The equality \\(N X=X U\\) implies that\n\n\\[\n\\frac{V X}{V A}=\\frac{X U}{A I}=\\frac{N X}{A I}=\\frac{Y X}{Y I}\n\\]\n\nand therefore \\(Y V \\| A I\\). Hence \\(\\angle B Y V=\\angle B A I=\\angle B I V\\), so the points \\(B, V, I, Y\\) are concyclic. Next we have \\(I Y \\perp Y V\\), so \\(\\angle I B V=90^{\\circ}\\). This implies that \\(B V\\) is the external angle bisector of the angle \\(A B C\\), which gives \\(\\angle V A C=\\angle V C A\\).\nSo in order to show that \\(M=X I \\cap A C\\) is the midpoint of \\(A C\\), it suffices to prove that \\(\\angle V M C=90^{\\circ}\\). But this follows immediately from the observation that the points \\(V, C, M\\), and \\(I\\) are concyclic, as \\(\\angle M I V=\\angle Y B V=180^{\\circ}-\\angle A C V\\) \nThe converse statement is also true, but its proof requires some technicalities as well."}
{"id": "imo-shortlist-2014-n1", "question": "N1. Let \\(n \\geqslant 2\\) be an integer, and let \\(A_{n}\\) be the set\n\n\\[\nA_{n}=\\left\\{2^{n}-2^{k} \\mid k \\in \\mathbb{Z}, 0 \\leqslant k<n\\right\\} .\n\\]\n\nDetermine the largest positive integer that cannot be written as the sum of one or more (not necessarily distinct) elements of \\(A_{n}\\).\n(Serbia)\nAnswer. \\((n-2) 2^{n}+1\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2014, "solution": ""}
{"id": "imo-shortlist-2007-a1", "question": "A1. Given a sequence \\(a_{1}, a_{2}, \\ldots, a_{n}\\) of real numbers. For each \\(i(1 \\leq i \\leq n)\\) define\n\n\\[\nd_{i}=\\max \\left\\{a_{j}: 1 \\leq j \\leq i\\right\\}-\\min \\left\\{a_{j}: i \\leq j \\leq n\\right\\}\n\\]\n\nand let\n\n\\[\nd=\\max \\left\\{d_{i}: 1 \\leq i \\leq n\\right\\}\n\\]\n\n(a) Prove that for arbitrary real numbers \\(x_{1} \\leq x_{2} \\leq \\ldots \\leq x_{n}\\),\n\n\\[\n\\max \\left\\{\\left|x_{i}-a_{i}\\right|: 1 \\leq i \\leq n\\right\\} \\geq \\frac{d}{2}\n\\]\n\n(b) Show that there exists a sequence \\(x_{1} \\leq x_{2} \\leq \\ldots \\leq x_{n}\\) of real numbers such that we have equality in (1).\n(New Zealand)", "category": "Algebra", "source": "IMO Shortlist", "year": 2007, "solution": "(a) Let \\(1 \\leq p \\leq q \\leq r \\leq n\\) be indices for which\n\n\\[\nd=d_{q}, \\quad a_{p}=\\max \\left\\{a_{j}: 1 \\leq j \\leq q\\right\\}, \\quad a_{r}=\\min \\left\\{a_{j}: q \\leq j \\leq n\\right\\}\n\\]\n\nand thus \\(d=a_{p}-a_{r}\\). (These indices are not necessarily unique.)\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-07}\n\nFor arbitrary real numbers \\(x_{1} \\leq x_{2} \\leq \\ldots \\leq x_{n}\\), consider just the two quantities \\(\\left|x_{p}-a_{p}\\right|\\) and \\(\\left|x_{r}-a_{r}\\right|\\). Since\n\n\\[\n\\left(a_{p}-x_{p}\\right)+\\left(x_{r}-a_{r}\\right)=\\left(a_{p}-a_{r}\\right)+\\left(x_{r}-x_{p}\\right) \\geq a_{p}-a_{r}=d\n\\]\n\nwe have either \\(a_{p}-x_{p} \\geq \\frac{d}{2}\\) or \\(x_{r}-a_{r} \\geq \\frac{d}{2}\\). Hence,\n\n\\[\n\\max \\left\\{\\left|x_{i}-a_{i}\\right|: 1 \\leq i \\leq n\\right\\} \\geq \\max \\left\\{\\left|x_{p}-a_{p}\\right|,\\left|x_{r}-a_{r}\\right|\\right\\} \\geq \\max \\left\\{a_{p}-x_{p}, x_{r}-a_{r}\\right\\} \\geq \\frac{d}{2}\n\\]\n\n(b) Define the sequence \\(\\left(x_{k}\\right)\\) as\n\n\\[\nx_{1}=a_{1}-\\frac{d}{2}, \\quad x_{k}=\\max \\left\\{x_{k-1}, a_{k}-\\frac{d}{2}\\right\\} \\quad \\text { for } 2 \\leq k \\leq n\n\\]\n\nWe show that we have equality in (1) for this sequence.\nBy the definition, sequence \\(\\left(x_{k}\\right)\\) is non-decreasing and \\(x_{k}-a_{k} \\geq-\\frac{d}{2}\\) for all \\(1 \\leq k \\leq n\\). Next we prove that\n\n\\[\nx_{k}-a_{k} \\leq \\frac{d}{2} \\quad \\text { for all } 1 \\leq k \\leq n\n\\]\n\nConsider an arbitrary index \\(1 \\leq k \\leq n\\). Let \\(\\ell \\leq k\\) be the smallest index such that \\(x_{k}=x_{\\ell}\\). We have either \\(\\ell=1\\), or \\(\\ell \\geq 2\\) and \\(x_{\\ell}>x_{\\ell-1}\\). In both cases,\n\n\\[\nx_{k}=x_{\\ell}=a_{\\ell}-\\frac{d}{2}\n\\]\n\nSince\n\n\\[\na_{\\ell}-a_{k} \\leq \\max \\left\\{a_{j}: 1 \\leq j \\leq k\\right\\}-\\min \\left\\{a_{j}: k \\leq j \\leq n\\right\\}=d_{k} \\leq d,\n\\]\n\nequality (3) implies\n\n\\[\nx_{k}-a_{k}=a_{\\ell}-a_{k}-\\frac{d}{2} \\leq d-\\frac{d}{2}=\\frac{d}{2}\n\\]\n\nWe obtained that \\(-\\frac{d}{2} \\leq x_{k}-a_{k} \\leq \\frac{d}{2}\\) for all \\(1 \\leq k \\leq n\\), so\n\n\\[\n\\max \\left\\{\\left|x_{i}-a_{i}\\right|: 1 \\leq i \\leq n\\right\\} \\leq \\frac{d}{2}\n\\]\n\nWe have equality because \\(\\left|x_{1}-a_{1}\\right|=\\frac{d}{2}\\).\nSolution 2. We present another construction of a sequence ( \\(x_{i}\\) ) for part (b).\nFor each \\(1 \\leq i \\leq n\\), let\n\n\\[\nM_{i}=\\max \\left\\{a_{j}: 1 \\leq j \\leq i\\right\\} \\quad \\text { and } \\quad m_{i}=\\min \\left\\{a_{j}: i \\leq j \\leq n\\right\\}\n\\]\n\nFor all \\(1 \\leq i<n\\), we have\n\n\\[\nM_{i}=\\max \\left\\{a_{1}, \\ldots, a_{i}\\right\\} \\leq \\max \\left\\{a_{1}, \\ldots, a_{i}, a_{i+1}\\right\\}=M_{i+1}\n\\]\n\nand\n\n\\[\nm_{i}=\\min \\left\\{a_{i}, a_{i+1}, \\ldots, a_{n}\\right\\} \\leq \\min \\left\\{a_{i+1}, \\ldots, a_{n}\\right\\}=m_{i+1}\n\\]\n\nTherefore sequences ( \\(M_{i}\\) ) and ( \\(m_{i}\\) ) are non-decreasing. Moreover, since \\(a_{i}\\) is listed in both definitions,\n\n\\[\nm_{i} \\leq a_{i} \\leq M_{i}\n\\]\n\nTo achieve equality in (1), set\n\n\\[\nx_{i}=\\frac{M_{i}+m_{i}}{2} .\n\\]\n\nSince sequences \\(\\left(M_{i}\\right)\\) and \\(\\left(m_{i}\\right)\\) are non-decreasing, this sequence is non-decreasing as well.\n\nFrom \\(d_{i}=M_{i}-m_{i}\\) we obtain that\n\n\\[\n-\\frac{d_{i}}{2}=\\frac{m_{i}-M_{i}}{2}=x_{i}-M_{i} \\leq x_{i}-a_{i} \\leq x_{i}-m_{i}=\\frac{M_{i}-m_{i}}{2}=\\frac{d_{i}}{2}\n\\]\n\nTherefore\n\n\\[\n\\max \\left\\{\\left|x_{i}-a_{i}\\right|: 1 \\leq i \\leq n\\right\\} \\leq \\max \\left\\{\\frac{d_{i}}{2}: 1 \\leq i \\leq n\\right\\}=\\frac{d}{2}\n\\]\n\nSince the opposite inequality has been proved in part (a), we must have equality."}
{"id": "imo-shortlist-2007-a2", "question": "A2. Consider those functions \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}\\) which satisfy the condition\n\n\\[\nf(m+n) \\geq f(m)+f(f(n))-1\n\\]\n\nfor all \\(m, n \\in \\mathbb{N}\\). Find all possible values of \\(f(2007)\\).\n( \\(\\mathbb{N}\\) denotes the set of all positive integers.)\n(Bulgaria)\nAnswer. 1, 2, ..., 2008.", "category": "Algebra", "source": "IMO Shortlist", "year": 2007, "solution": "Suppose that a function \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}\\) satisfies (1). For arbitrary positive integers \\(m>n\\), by (1) we have\n\n\\[\nf(m)=f(n+(m-n)) \\geq f(n)+f(f(m-n))-1 \\geq f(n)\n\\]\n\nso \\(f\\) is nondecreasing.\nFunction \\(f \\equiv 1\\) is an obvious solution. To find other solutions, assume that \\(f \\not \\equiv 1\\) and take the smallest \\(a \\in \\mathbb{N}\\) such that \\(f(a)>1\\). Then \\(f(b) \\geq f(a)>1\\) for all integer \\(b \\geq a\\).\n\nSuppose that \\(f(n)>n\\) for some \\(n \\in \\mathbb{N}\\). Then we have\n\n\\[\nf(f(n))=f((f(n)-n)+n) \\geq f(f(n)-n)+f(f(n))-1\n\\]\n\nso \\(f(f(n)-n) \\leq 1\\) and hence \\(f(n)-n<a\\). Then there exists a maximal value of the expression \\(f(n)-n\\); denote this value by \\(c\\), and let \\(f(k)-k=c \\geq 1\\). Applying the monotonicity together with (1), we get\n\n\\[\n\\begin{aligned}\n2 k+c \\geq f(2 k)=f(k+k) & \\geq f(k)+f(f(k))-1 \n& \\geq f(k)+f(k)-1=2(k+c)-1=2 k+(2 c-1)\n\n\\]\n\nhence \\(c \\leq 1\\) and \\(f(n) \\leq n+1\\) for all \\(n \\in \\mathbb{N}\\). In particular, \\(f(2007) \\leq 2008\\).\nNow we present a family of examples showing that all values from 1 to 2008 can be realized. Let\n\n\\[\nf_{j}(n)=\\max \\{1, n+j-2007\\} \\quad \\text { for } j=1,2, \\ldots, 2007 ; \\quad f_{2008}(n)= \\begin{cases}n, & 2007 \\nmid n \\\\ n+1, & 2007 \\mid n\n\\]\n\nWe show that these functions satisfy the condition (1) and clearly \\(f_{j}(2007)=j\\).\nTo check the condition (1) for the function \\(f_{j}(j \\leq 2007)\\), note first that \\(f_{j}\\) is nondecreasing and \\(f_{j}(n) \\leq n\\), hence \\(f_{j}\\left(f_{j}(n)\\right) \\leq f_{j}(n) \\leq n\\) for all \\(n \\in \\mathbb{N}\\). Now, if \\(f_{j}(m)=1\\), then the inequality (1) is clear since \\(f_{j}(m+n) \\geq f_{j}(n) \\geq f_{j}\\left(f_{j}(n)\\right)=f_{j}(m)+f_{j}\\left(f_{j}(n)\\right)-1\\). Otherwise,\n\n\\[\nf_{j}(m)+f_{j}\\left(f_{j}(n)\\right)-1 \\leq(m+j-2007)+n=(m+n)+j-2007=f_{j}(m+n)\n\\]\n\nIn the case \\(j=2008\\), clearly \\(n+1 \\geq f_{2008}(n) \\geq n\\) for all \\(n \\in \\mathbb{N}\\); moreover, \\(n+1 \\geq\\) \\(f_{2008}\\left(f_{2008}(n)\\right)\\) as well. Actually, the latter is trivial if \\(f_{2008}(n)=n\\); otherwise, \\(f_{2008}(n)=n+1\\), which implies \\(2007 \\nmid n+1\\) and hence \\(n+1=f_{2008}(n+1)=f_{2008}\\left(f_{2008}(n)\\right)\\).\n\nSo, if \\(2007 \\mid m+n\\), then\n\n\\[\nf_{2008}(m+n)=m+n+1=(m+1)+(n+1)-1 \\geq f_{2008}(m)+f_{2008}\\left(f_{2008}(n)\\right)-1\n\\]\n\nOtherwise, \\(2007 \\nmid m+n\\), hence \\(2007 \\nmid m\\) or \\(2007 \\nmid n\\). In the former case we have \\(f_{2008}(m)=m\\), while in the latter one \\(f_{2008}\\left(f_{2008}(n)\\right)=f_{2008}(n)=n\\), providing\n\n\\[\nf_{2008}(m)+f_{2008}\\left(f_{2008}(n)\\right)-1 \\leq(m+n+1)-1=f_{2008}(m+n)\n\\]\n\nComment. The examples above are not unique. The values \\(1,2, \\ldots, 2008\\) can be realized in several ways. Here we present other two constructions for \\(j \\leq 2007\\), without proof:\n\n\\[\ng_{j}(n)=\\left\\{\\begin{array}{ll}\n1, & n<2007 \nj, & n=2007 \nn, & n>2007\n \\quad h_{j}(n)=\\max \\left\\{1,\\left\\lfloor\\frac{j n}{2007}\\right\\rfloor\\right\\}\\right.\n\\]\n\nAlso the example for \\(j=2008\\) can be generalized. In particular, choosing a divisor \\(d>1\\) of 2007, one can set\n\n\\[\nf_{2008, d}(n)= \\begin{cases}n, & d \\nmid n \\\\ n+1, & d \\mid n\n\\]"}
{"id": "imo-shortlist-2007-a3", "question": "A3. Let \\(n\\) be a positive integer, and let \\(x\\) and \\(y\\) be positive real numbers such that \\(x^{n}+y^{n}=1\\). Prove that\n\n\\[\n\\left(\\sum_{k=1}^{n} \\frac{1+x^{2 k}}{1+x^{4 k}}\\right)\\left(\\sum_{k=1}^{n} \\frac{1+y^{2 k}}{1+y^{4 k}}\\right)<\\frac{1}{(1-x)(1-y)}\n\\]\n\n(Estonia)", "category": "Algebra", "source": "IMO Shortlist", "year": 2007, "solution": "For each real \\(t \\in(0,1)\\),\n\n\\[\n\\frac{1+t^{2}}{1+t^{4}}=\\frac{1}{t}-\\frac{(1-t)\\left(1-t^{3}\\right)}{t\\left(1+t^{4}\\right)}<\\frac{1}{t}\n\\]\n\nSubstituting \\(t=x^{k}\\) and \\(t=y^{k}\\),\n\n\\[\n0<\\sum_{k=1}^{n} \\frac{1+x^{2 k}}{1+x^{4 k}}<\\sum_{k=1}^{n} \\frac{1}{x^{k}}=\\frac{1-x^{n}}{x^{n}(1-x)} \\quad \\text { and } \\quad 0<\\sum_{k=1}^{n} \\frac{1+y^{2 k}}{1+y^{4 k}}<\\sum_{k=1}^{n} \\frac{1}{y^{k}}=\\frac{1-y^{n}}{y^{n}(1-y)}\n\\]\n\nSince \\(1-y^{n}=x^{n}\\) and \\(1-x^{n}=y^{n}\\),\n\n\\[\n\\frac{1-x^{n}}{x^{n}(1-x)}=\\frac{y^{n}}{x^{n}(1-x)}, \\quad \\frac{1-y^{n}}{y^{n}(1-y)}=\\frac{x^{n}}{y^{n}(1-y)}\n\\]\n\nand therefore\n\n\\[\n\\left(\\sum_{k=1}^{n} \\frac{1+x^{2 k}}{1+x^{4 k}}\\right)\\left(\\sum_{k=1}^{n} \\frac{1+y^{2 k}}{1+y^{4 k}}\\right)<\\frac{y^{n}}{x^{n}(1-x)} \\cdot \\frac{x^{n}}{y^{n}(1-y)}=\\frac{1}{(1-x)(1-y)}\n\\]\n\nSolution 2. We prove\n\n\\[\n\\left(\\sum_{k=1}^{n} \\frac{1+x^{2 k}}{1+x^{4 k}}\\right)\\left(\\sum_{k=1}^{n} \\frac{1+y^{2 k}}{1+y^{4 k}}\\right)<\\frac{\\left(\\frac{1+\\sqrt{2}}{2} \\ln 2\\right)^{2}}{(1-x)(1-y)}<\\frac{0.7001}{(1-x)(1-y)}\n\\]\n\nThe idea is to estimate each term on the left-hand side with the same constant. To find the upper bound for the expression \\(\\frac{1+x^{2 k}}{1+x^{4 k}}\\), consider the function \\(f(t)=\\frac{1+t}{1+t^{2}}\\) in interval \\((0,1)\\). Since\n\n\\[\nf^{\\prime}(t)=\\frac{1-2 t-t^{2}}{\\left(1+t^{2}\\right)^{2}}=\\frac{(\\sqrt{2}+1+t)(\\sqrt{2}-1-t)}{\\left(1+t^{2}\\right)^{2}}\n\\]\n\nthe function increases in interval \\((0, \\sqrt{2}-1]\\) and decreases in \\([\\sqrt{2}-1,1)\\). Therefore the maximum is at point \\(t_{0}=\\sqrt{2}-1\\) and\n\n\\[\nf(t)=\\frac{1+t}{1+t^{2}} \\leq f\\left(t_{0}\\right)=\\frac{1+\\sqrt{2}}{2}=\\alpha\n\\]\n\nApplying this to each term on the left-hand side of (1), we obtain\n\n\\[\n\\left(\\sum_{k=1}^{n} \\frac{1+x^{2 k}}{1+x^{4 k}}\\right)\\left(\\sum_{k=1}^{n} \\frac{1+y^{2 k}}{1+y^{4 k}}\\right) \\leq n \\alpha \\cdot n \\alpha=(n \\alpha)^{2} .\n\\]\n\nTo estimate \\((1-x)(1-y)\\) on the right-hand side, consider the function\n\n\\[\ng(t)=\\ln \\left(1-t^{1 / n}\\right)+\\ln \\left(1-(1-t)^{1 / n}\\right)\n\\]\n\nSubstituting \\(s\\) for \\(1-t\\), we have\n\n\\[\n-n g^{\\prime}(t)=\\frac{t^{1 / n-1}}{1-t^{1 / n}}-\\frac{s^{1 / n-1}}{1-s^{1 / n}}=\\frac{1}{s t}\\left(\\frac{(1-t) t^{1 / n}}{1-t^{1 / n}}-\\frac{(1-s) s^{1 / n}}{1-s^{1 / n}}\\right)=\\frac{h(t)-h(s)}{s t} .\n\\]\n\nThe function\n\n\\[\nh(t)=t^{1 / n} \\frac{1-t}{1-t^{1 / n}}=\\sum_{i=1}^{n} t^{i / n}\n\\]\n\nis obviously increasing for \\(t \\in(0,1)\\), hence for these values of \\(t\\) we have\n\n\\[\ng^{\\prime}(t)>0 \\Longleftrightarrow h(t)<h(s) \\Longleftrightarrow t<s=1-t \\Longleftrightarrow t<\\frac{1}{2}\n\\]\n\nThen, the maximum of \\(g(t)\\) in \\((0,1)\\) is attained at point \\(t_{1}=1 / 2\\) and therefore\n\n\\[\ng(t) \\leq g\\left(\\frac{1}{2}\\right)=2 \\ln \\left(1-2^{-1 / n}\\right), \\quad t \\in(0,1)\n\\]\n\nSubstituting \\(t=x^{n}\\), we have \\(1-t=y^{n},(1-x)(1-y)=\\exp g(t)\\) and hence\n\n\\[\n(1-x)(1-y)=\\exp g(t) \\leq\\left(1-2^{-1 / n}\\right)^{2}\n\\]\n\nCombining (2) and (3), we get\n\n\\[\n\\left(\\sum_{k=1}^{n} \\frac{1+x^{2 k}}{1+x^{4 k}}\\right)\\left(\\sum_{k=1}^{n} \\frac{1+y^{2 k}}{1+y^{4 k}}\\right) \\leq(\\alpha n)^{2} \\cdot 1 \\leq(\\alpha n)^{2} \\frac{\\left(1-2^{-1 / n}\\right)^{2}}{(1-x)(1-y)}=\\frac{\\left(\\alpha n\\left(1-2^{-1 / n}\\right)\\right)^{2}}{(1-x)(1-y)}\n\\]\n\nApplying the inequality \\(1-\\exp (-t)<t\\) for \\(t=\\frac{\\ln 2}{n}\\), we obtain\n\n\\[\n\\alpha n\\left(1-2^{-1 / n}\\right)=\\alpha n\\left(1-\\exp \\left(-\\frac{\\ln 2}{n}\\right)\\right)<\\alpha n \\cdot \\frac{\\ln 2}{n}=\\alpha \\ln 2=\\frac{1+\\sqrt{2}}{2} \\ln 2 .\n\\]\n\nHence,\n\n\\[\n\\left(\\sum_{k=1}^{n} \\frac{1+x^{2 k}}{1+x^{4 k}}\\right)\\left(\\sum_{k=1}^{n} \\frac{1+y^{2 k}}{1+y^{4 k}}\\right)<\\frac{\\left(\\frac{1+\\sqrt{2}}{2} \\ln 2\\right)^{2}}{(1-x)(1-y)}\n\\]\n\nComment. It is a natural idea to compare the sum \\(S_{n}(x)=\\sum_{k=1}^{n} \\frac{1+x^{2 k}}{1+x^{4 k}}\\) with the integral \\(I_{n}(x)=\\) \\(\\int_{0}^{n} \\frac{1+x^{2 t}}{1+x^{4 t}} \\mathrm{~d} t\\). Though computing the integral is quite standard, many difficulties arise. First, the integrand \\(\\frac{1+x^{2 k}}{1+x^{4 k}}\\) has an increasing segment and, depending on \\(x\\), it can have a decreasing segment as well. So comparing \\(S_{n}(x)\\) and \\(I_{n}(x)\\) is not completely obvious. We can add a term to fix the estimate, e.g. \\(S_{n} \\leq I_{n}+(\\alpha-1)\\), but then the final result will be weak for the small values of \\(n\\). Second, we have to minimize \\((1-x)(1-y) I_{n}(x) I_{n}(y)\\) which leads to very unpleasant computations.\n\nHowever, by computer search we found that the maximum of \\(I_{n}(x) I_{n}(y)\\) is at \\(x=y=2^{-1 / n}\\), as well as the maximum of \\(S_{n}(x) S_{n}(y)\\), and the latter is less. Hence, one can conjecture that the exact constant which can be put into the numerator on the right-hand side of (1) is\n\n\\[\n\\left(\\ln 2 \\cdot \\int_{0}^{1} \\frac{1+4^{-t}}{1+16^{-t}} \\mathrm{~d} t\\right)^{2}=\\frac{1}{4}\\left(\\frac{1}{2} \\ln \\frac{17}{2}+\\arctan 4-\\frac{\\pi}{4}\\right)^{2} \\approx 0.6484\n\\]"}
{"id": "imo-shortlist-2007-a4", "question": "A4. Find all functions \\(f: \\mathbb{R}^{+} \\rightarrow \\mathbb{R}^{+}\\)such that\n\n\\[\nf(x+f(y))=f(x+y)+f(y)\n\\]\n\nfor all \\(x, y \\in \\mathbb{R}^{+}\\). (Symbol \\(\\mathbb{R}^{+}\\)denotes the set of all positive real numbers.)\n(Thaliand)\nAnswer. \\(f(x)=2 x\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2007, "solution": "First we show that \\(f(y)>y\\) for all \\(y \\in \\mathbb{R}^{+}\\). Functional equation (1) yields \\(f(x+f(y))>f(x+y)\\) and hence \\(f(y) \\neq y\\) immediately. If \\(f(y)<y\\) for some \\(y\\), then setting \\(x=y-f(y)\\) we get\n\n\\[\nf(y)=f((y-f(y))+f(y))=f((y-f(y))+y)+f(y)>f(y),\n\\]\n\ncontradiction. Therefore \\(f(y)>y\\) for all \\(y \\in \\mathbb{R}^{+}\\).\nFor \\(x \\in \\mathbb{R}^{+}\\)define \\(g(x)=f(x)-x\\); then \\(f(x)=g(x)+x\\) and, as we have seen, \\(g(x)>0\\). Transforming (1) for function \\(g(x)\\) and setting \\(t=x+y\\),\n\n\\[\n\\begin{aligned}\nf(t+g(y)) & =f(t)+f(y) \ng(t+g(y))+t+g(y) & =(g(t)+t)+(g(y)+y)\n\n\\]\n\nand therefore\n\n\\[\ng(t+g(y))=g(t)+y \\quad \\text { for all } t>y>0\n\\]\n\nNext we prove that function \\(g(x)\\) is injective. Suppose that \\(g\\left(y_{1}\\right)=g\\left(y_{2}\\right)\\) for some numbers \\(y_{1}, y_{2} \\in \\mathbb{R}^{+}\\). Then by (2),\n\n\\[\ng(t)+y_{1}=g\\left(t+g\\left(y_{1}\\right)\\right)=g\\left(t+g\\left(y_{2}\\right)\\right)=g(t)+y_{2}\n\\]\n\nfor all \\(t>\\max \\left\\{y_{1}, y_{2}\\right\\}\\). Hence, \\(g\\left(y_{1}\\right)=g\\left(y_{2}\\right)\\) is possible only if \\(y_{1}=y_{2}\\).\nNow let \\(u, v\\) be arbitrary positive numbers and \\(t>u+v\\). Applying (2) three times,\n\n\\[\ng(t+g(u)+g(v))=g(t+g(u))+v=g(t)+u+v=g(t+g(u+v))\n\\]\n\nBy the injective property we conclude that \\(t+g(u)+g(v)=t+g(u+v)\\), hence\n\n\\[\ng(u)+g(v)=g(u+v)\n\\]\n\nSince function \\(g(v)\\) is positive, equation (3) also shows that \\(g\\) is an increasing function.\nFinally we prove that \\(g(x)=x\\). Combining (2) and (3), we obtain\n\n\\[\ng(t)+y=g(t+g(y))=g(t)+g(g(y))\n\\]\n\nand hence\n\n\\[\ng(g(y))=y\n\\]\n\nSuppose that there exists an \\(x \\in \\mathbb{R}^{+}\\)such that \\(g(x) \\neq x\\). By the monotonicity of \\(g\\), if \\(x>g(x)\\) then \\(g(x)>g(g(x))=x\\). Similarly, if \\(x<g(x)\\) then \\(g(x)<g(g(x))=x\\). Both cases lead to contradiction, so there exists no such \\(x\\).\n\nWe have proved that \\(g(x)=x\\) and therefore \\(f(x)=g(x)+x=2 x\\) for all \\(x \\in \\mathbb{R}^{+}\\). This function indeed satisfies the functional equation (1).\n\nComment. It is well-known that the additive property (3) together with \\(g(x) \\geq 0\\) (for \\(x>0\\) ) imply \\(g(x)=c x\\). So, after proving (3), it is sufficient to test functions \\(f(x)=(c+1) x\\).\nSolution 2. We prove that \\(f(y)>y\\) and introduce function \\(g(x)=f(x)-x>0\\) in the same way as in Solution 1.\n\nFor arbitrary \\(t>y>0\\), substitute \\(x=t-y\\) into (1) to obtain\n\n\\[\nf(t+g(y))=f(t)+f(y)\n\\]\n\nwhich, by induction, implies\n\n\\[\nf(t+n g(y))=f(t)+n f(y) \\quad \\text { for all } t>y>0, n \\in \\mathbb{N}\n\\]\n\nTake two arbitrary positive reals \\(y\\) and \\(z\\) and a third fixed number \\(t>\\max \\{y, z\\}\\). For each positive integer \\(k\\), let \\(\\ell_{k}=\\left\\lfloor k \\frac{g(y)}{g(z)}\\right\\rfloor\\). Then \\(t+k g(y)-\\ell_{k} g(z) \\geq t>z\\) and, applying (4) twice,\n\n\\[\n\\begin{aligned}\nf\\left(t+k g(y)-\\ell_{k} g(z)\\right)+\\ell_{k} f(z) & =f(t+k g(y))=f(t)+k f(y) \n0<\\frac{1}{k} f\\left(t+k g(y)-\\ell_{k} g(z)\\right) & =\\frac{f(t)}{k}+f(y)-\\frac{\\ell_{k}}{k} f(z)\n\n\\]\n\nAs \\(k \\rightarrow \\infty\\) we get\n\n\\[\n0 \\leq \\lim _{k \\rightarrow \\infty}\\left(\\frac{f(t)}{k}+f(y)-\\frac{\\ell_{k}}{k} f(z)\\right)=f(y)-\\frac{g(y)}{g(z)} f(z)=f(y)-\\frac{f(y)-y}{f(z)-z} f(z)\n\\]\n\nand therefore\n\n\\[\n\\frac{f(y)}{y} \\leq \\frac{f(z)}{z}\n\\]\n\nExchanging variables \\(y\\) and \\(z\\), we obtain the reverse inequality. Hence, \\(\\frac{f(y)}{y}=\\frac{f(z)}{z}\\) for arbitrary \\(y\\) and \\(z\\); so function \\(\\frac{f(x)}{x}\\) is constant, \\(f(x)=c x\\).\n\nSubstituting back into (1), we find that \\(f(x)=c x\\) is a solution if and only if \\(c=2\\). So the only solution for the problem is \\(f(x)=2 x\\)."}
{"id": "imo-shortlist-2007-a5", "question": "A5. Let \\(c>2\\), and let \\(a(1), a(2), \\ldots\\) be a sequence of nonnegative real numbers such that\n\n\\[\na(m+n) \\leq 2 a(m)+2 a(n) \\quad \\text { for all } m, n \\geq 1,\n\\]\n\nand\n\n\\[\na\\left(2^{k}\\right) \\leq \\frac{1}{(k+1)^{c}} \\quad \\text { for all } k \\geq 0\n\\]\n\nProve that the sequence \\(a(n)\\) is bounded.\n(Croatia)", "category": "Algebra", "source": "IMO Shortlist", "year": 2007, "solution": "For convenience, define \\(a(0)=0\\); then condition (1) persists for all pairs of nonnegative indices.\nLemma 1. For arbitrary nonnegative indices \\(n_{1}, \\ldots, n_{k}\\), we have\n\n\\[\na\\left(\\sum_{i=1}^{k} n_{i}\\right) \\leq \\sum_{i=1}^{k} 2^{i} a\\left(n_{i}\\right)\n\\]\n\nand\n\n\\[\na\\left(\\sum_{i=1}^{k} n_{i}\\right) \\leq 2 k \\sum_{i=1}^{k} a\\left(n_{i}\\right)\n\\]\n\nProof. Inequality (3) is proved by induction on \\(k\\). The base case \\(k=1\\) is trivial, while the induction step is provided by\n\\(a\\left(\\sum_{i=1}^{k+1} n_{i}\\right)=a\\left(n_{1}+\\sum_{i=2}^{k+1} n_{i}\\right) \\leq 2 a\\left(n_{1}\\right)+2 a\\left(\\sum_{i=1}^{k} n_{i+1}\\right) \\leq 2 a\\left(n_{1}\\right)+2 \\sum_{i=1}^{k} 2^{i} a\\left(n_{i+1}\\right)=\\sum_{i=1}^{k+1} 2^{i} a\\left(n_{i}\\right)\\).\nTo establish (4), first the inequality\n\n\\[\na\\left(\\sum_{i=1}^{2^{d}} n_{i}\\right) \\leq 2^{d} \\sum_{i=1}^{2^{d}} a\\left(n_{i}\\right)\n\\]\n\ncan be proved by an obvious induction on \\(d\\). Then, turning to (4), we find an integer \\(d\\) such that \\(2^{d-1}<k \\leq 2^{d}\\) to obtain\n\\(a\\left(\\sum_{i=1}^{k} n_{i}\\right)=a\\left(\\sum_{i=1}^{k} n_{i}+\\sum_{i=k+1}^{2^{d}} 0\\right) \\leq 2^{d}\\left(\\sum_{i=1}^{k} a\\left(n_{i}\\right)+\\sum_{i=k+1}^{2^{d}} a(0)\\right)=2^{d} \\sum_{i=1}^{k} a\\left(n_{i}\\right) \\leq 2 k \\sum_{i=1}^{k} a\\left(n_{i}\\right)\\).\nFix an increasing unbounded sequence \\(0=M_{0}<M_{1}<M_{2}<\\ldots\\) of real numbers; the exact values will be defined later. Let \\(n\\) be an arbitrary positive integer and write\n\n\\[\nn=\\sum_{i=0}^{d} \\varepsilon_{i} \\cdot 2^{i}, \\quad \\text { where } \\varepsilon_{i} \\in\\{0,1\\}\n\\]\n\nSet \\(\\varepsilon_{i}=0\\) for \\(i>d\\), and take some positive integer \\(f\\) such that \\(M_{f}>d\\). Applying (3), we get\n\n\\[\na(n)=a\\left(\\sum_{k=1}^{f} \\sum_{M_{k-1} \\leq i<M_{k}} \\varepsilon_{i} \\cdot 2^{i}\\right) \\leq \\sum_{k=1}^{f} 2^{k} a\\left(\\sum_{M_{k-1} \\leq i<M_{k}} \\varepsilon_{i} \\cdot 2^{i}\\right)\n\\]\n\nNote that there are less than \\(M_{k}-M_{k-1}+1\\) integers in interval \\(\\left[M_{k-1}, M_{k}\\right)\\); hence, using (4) we have\n\n\\[\n\\begin{aligned}\na(n) & \\leq \\sum_{k=1}^{f} 2^{k} \\cdot 2\\left(M_{k}-M_{k-1}+1\\right) \\sum_{M_{k-1} \\leq i<M_{k}} \\varepsilon_{i} \\cdot a\\left(2^{i}\\right) \n& \\leq \\sum_{k=1}^{f} 2^{k} \\cdot 2\\left(M_{k}-M_{k-1}+1\\right)^{2} \\max _{M_{k-1} \\leq i<M_{k}} a\\left(2^{i}\\right) \n& \\leq \\sum_{k=1}^{f} 2^{k+1}\\left(M_{k}+1\\right)^{2} \\cdot \\frac{1}{\\left(M_{k-1}+1\\right)^{c}}=\\sum_{k=1}^{f}\\left(\\frac{M_{k}+1}{M_{k-1}+1}\\right)^{2} \\frac{2^{k+1}}{\\left(M_{k-1}+1\\right)^{c-2}}\n\n\\]\n\nSetting \\(M_{k}=4^{k /(c-2)}-1\\), we obtain\n\n\\[\na(n) \\leq \\sum_{k=1}^{f} 4^{2 /(c-2)} \\frac{2^{k+1}}{\\left(4^{(k-1) /(c-2)}\\right)^{c-2}}=8 \\cdot 4^{2 /(c-2)} \\sum_{k=1}^{f}\\left(\\frac{1}{2}\\right)^{k}<8 \\cdot 4^{2 /(c-2)}\n\\]\n\nand the sequence \\(a(n)\\) is bounded."}
{"id": "imo-shortlist-2007-c1", "question": "C1. Let \\(n>1\\) be an integer. Find all sequences \\(a_{1}, a_{2}, \\ldots, a_{n^{2}+n}\\) satisfying the following conditions:\n(a) \\(a_{i} \\in\\{0,1\\}\\) for all \\(1 \\leq i \\leq n^{2}+n\\);\n(b) \\(a_{i+1}+a_{i+2}+\\ldots+a_{i+n}<a_{i+n+1}+a_{i+n+2}+\\ldots+a_{i+2 n}\\) for all \\(0 \\leq i \\leq n^{2}-n\\).\n(Serbia)\nAnswer. Such a sequence is unique. It can be defined as follows:\n\n\\[\na_{u+v n}=\\left\\{\\begin{array}{ll}\n0, & u+v \\leq n, \n1, & u+v \\geq n+1\n \\quad \\text { for all } 1 \\leq u \\leq n \\text { and } 0 \\leq v \\leq n\\right.\n\\]\n\nThe terms can be arranged into blocks of length \\(n\\) as\n\n\\[\n(\\underbrace{0 \\ldots 0}_{n})(\\underbrace{0 \\ldots 0}_{n-1} 1)(\\underbrace{0 \\ldots 0}_{n-2} 11) \\ldots(\\underbrace{0 \\ldots 0}_{n-v} \\underbrace{1 \\ldots 1}_{v}) \\ldots(0 \\underbrace{1 \\ldots 1}_{n-1})(\\underbrace{1 \\ldots 1}_{n}) .\n\\]", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2007, "solution": "Consider a sequence \\(\\left(a_{i}\\right)\\) satisfying the conditions. For arbitrary integers \\(0 \\leq\\) \\(k \\leq l \\leq n^{2}+n\\) denote \\(S(k, l]=a_{k+1}+\\cdots+a_{l}\\). (If \\(k=l\\) then \\(S(k, l]=0\\).) Then condition (b) can be rewritten as \\(S(i, i+n]<S(i+n, i+2 n]\\) for all \\(0 \\leq i \\leq n^{2}-n\\). Notice that for \\(0 \\leq k \\leq l \\leq m \\leq n^{2}+n\\) we have \\(S(k, m]=S(k, l]+S(l, m]\\).\n\nBy condition (b),\n\n\\[\n0 \\leq S(0, n]<S(n, 2 n]<\\cdots<S\\left(n^{2}, n^{2}+n\\right] \\leq n\n\\]\n\nWe have only \\(n+1\\) distinct integers in the interval \\([0, n]\\); hence,\n\n\\[\nS(v n,(v+1) n]=v \\quad \\text { for all } 0 \\leq v \\leq n\n\\]\n\nIn particular, \\(S(0, n]=0\\) and \\(S\\left(n^{2}, n^{2}+n\\right]=n\\), therefore\n\n\\[\n\\begin{aligned}\na_{1} & =a_{2}=\\ldots=a_{n}=0 \na_{n^{2}+1} & =a_{n^{2}+2}=\\ldots=a_{n^{2}+n}=1\n\n\\]\n\nSubdivide sequence ( \\(a_{i}\\) ) into \\(n+1\\) blocks, each consisting of \\(n\\) consecutive terms, and number them from 0 to \\(n\\). We show by induction on \\(v\\) that the \\(v\\) th blocks has the form\n\n\\[\n(\\underbrace{0 \\ldots 0}_{n-v} \\underbrace{1 \\ldots 1}_{v})\n\\]\n\nThe base case \\(v=0\\) is provided by (3).\n\nConsider the \\(v\\) th block for \\(v>0\\). By (2), it contains some \"ones\". Let the first \"one\" in this block be at the \\(u\\) th position (that is, \\(a_{u+v n}=1\\) ). By the induction hypothesis, the \\((v-1)\\) th and \\(v\\) th blocks of \\(\\left(a_{i}\\right)\\) have the form\n\n\\[\n\\left.\\begin{array}{c}\n\\sum=v \n(\\underbrace{0 \\ldots 0 \\ldots 0}_{n-v+1} \\underbrace{1 \\ldots 1}_{v-1})(\\underbrace{0 \\ldots 0}_{u-1} 1\n * \\ldots *\\right),\n\\]\n\nwhere each star can appear to be any binary digit. Observe that \\(u \\leq n-v+1\\), since the sum in this block is \\(v\\). Then, the fragment of length \\(n\\) bracketed above has exactly \\((v-1)+1\\) ones, i. e. \\(S(u+(v-1) n, u+v n]=v\\). Hence,\n\n\\[\nv=S(u+(v-1) n, u+v n]<S(u+v n, u+(v+1) n]<\\cdots<S\\left(u+(n-1) n, u+n^{2}\\right] \\leq n ;\n\\]\n\nwe have \\(n-v+1\\) distinct integers in the interval \\([v, n]\\), therefore \\(S(u+(t-1) n, u+t n]=t\\) for each \\(t=v, \\ldots, n\\).\n\nThus, the end of sequence \\(\\left(a_{i}\\right)\\) looks as following:\n(each bracketed fragment contains \\(n\\) terms). Computing in two ways the sum of all digits above, we obtain \\(n-u=v-1\\) and \\(u=n-v+1\\). Then, the first \\(n-v\\) terms in the \\(v\\) th block are zeroes, and the next \\(v\\) terms are ones, due to the sum of all terms in this block. The statement is proved.\n\nWe are left to check that the sequence obtained satisfies the condition. Notice that \\(a_{i} \\leq a_{i+n}\\) for all \\(1 \\leq i \\leq n^{2}\\). Moreover, if \\(1 \\leq u \\leq n\\) and \\(0 \\leq v \\leq n-1\\), then \\(a_{u+v n}<a_{u+v n+n}\\) exactly when \\(u+v=n\\). In this case we have \\(u+v n=n+v(n-1)\\).\n\nConsider now an arbitrary index \\(0 \\leq i \\leq n^{2}-n\\). Clearly, there exists an integer \\(v\\) such that \\(n+v(n-1) \\in[i+1, i+n]\\). Then, applying the above inequalities we obtain that condition (b) is valid.\n\nSolution 2. Similarly to Solution 1, we introduce the notation \\(S(k, l]\\) and obtain (2), (3), and (4) in the same way. The sum of all elements of the sequence can be computed as\n\n\\[\nS\\left(0, n^{2}+n\\right]=S(0, n]+S(n, 2 n]+\\ldots+S\\left(n^{2}, n^{2}+n\\right]=0+1+\\ldots+n\n\\]\n\nFor an arbitrary integer \\(0 \\leq u \\leq n\\), consider the numbers\n\n\\[\nS(u, u+n]<S(u+n, u+2 n]<\\ldots<S\\left(u+(n-1) n, u+n^{2}\\right]\n\\]\n\nThey are \\(n\\) distinct integers from the \\(n+1\\) possible values \\(0,1,2, \\ldots, n\\). Denote by \\(m\\) the \"missing\" value which is not listed. We determine \\(m\\) from \\(S\\left(0, n^{2}+n\\right]\\). Write this sum as\n\\(S\\left(0, n^{2}+n\\right]=S(0, u]+S(u, u+n]+S(u+n, u+2 n]+\\ldots+S\\left(u+(n-1) n, u+n^{2}\\right]+S\\left(u+n^{2}, n^{2}+n\\right]\\).\nSince \\(a_{1}=a_{2}=\\ldots=a_{u}=0\\) and \\(a_{u+n^{2}+1}=\\ldots=a_{n^{2}+n}=1\\), we have \\(S(0, u]=0\\) and \\(S\\left(u+n^{2}, n+n^{2}\\right]=n-u\\). Then\n\n\\[\n0+1+\\ldots+n=S\\left(0, n^{2}+n\\right]=0+((0+1+\\ldots+n)-m)+(n-u)\n\\]\n\nso \\(m=n-u\\).\nHence, the numbers listed in (5) are \\(0,1, \\ldots, n-u-1\\) and \\(n-u+1, \\ldots, n\\), respectively, therefore\n\n\\[\nS(u+v n, u+(v+1) n]=\\left\\{\\begin{array}{ll}\nv, & v \\leq n-u-1, \nv+1, & v \\geq n-u\n \\quad \\text { for all } 0 \\leq u \\leq n, 0 \\leq v \\leq n-1\\right.\n\\]\n\nConditions (6), together with (3), provide a system of linear equations in variables \\(a_{i}\\). Now we solve this system and show that the solution is unique and satisfies conditions (a) and (b).\n\nFirst, observe that any solution of the system (3), (6) satisfies the condition (b). By the construction, equations (6) immediately imply (5). On the other hand, all inequalities mentioned in condition (b) are included into the chain (5) for some value of \\(u\\).\n\nNext, note that the system (3), (6) is redundant. The numbers \\(S(k n,(k+1) n]\\), where \\(1 \\leq k \\leq n-1\\), appear twice in (6). For \\(u=0\\) and \\(v=k\\) we have \\(v \\leq n-u-1\\), and (6) gives \\(S(k n,(k+1) n]=v=k\\). For \\(u=n\\) and \\(v=k-1\\) we have \\(v \\geq n-u\\) and we obtain the same value, \\(S(k n,(k+1) n]=v+1=k\\). Therefore, deleting one equation from each redundant pair, we can make every sum \\(S(k, k+n]\\) appear exactly once on the left-hand side in (6).\n\nNow, from (3), (6), the sequence ( \\(a_{i}\\) ) can be reconstructed inductively by\n\\(a_{1}=a_{2}=\\ldots=a_{n-1}=0, \\quad a_{k+n}=S(k, k+n]-\\left(a_{k+1}+a_{k+2}+\\ldots+a_{k+n-1}\\right) \\quad\\left(0 \\leq k \\leq n^{2}\\right)\\),\ntaking the values of \\(S(k, k+n]\\) from (6). This means first that there exists at most one solution of our system. Conversely, the constructed sequence obviously satisfies all equations (3), (6) (the only missing equation is \\(a_{n}=0\\), which follows from \\(S(0, n]=0\\) ). Hence it satisfies condition (b), and we are left to check condition (a) only.\n\nFor arbitrary integers \\(1 \\leq u, t \\leq n\\) we get\n\n\\[\n\\begin{aligned}\na_{u+t n}-a_{u+(t-1) n} & =S(u+(t-1) n, u+t n]-S((u-1)+(t-1) n,(u-1)+t n] \n& = \\begin{cases}(t-1)-(t-1)=0, & t \\leq n-u \nt-(t-1)=1, & t=n-u+1 \nt-t=0, & t \\geq n-u+2\n\n\\]\n\nSince \\(a_{u}=0\\), we have\n\n\\[\na_{u+v n}=a_{u+v n}-a_{u}=\\sum_{t=1}^{v}\\left(a_{u+t n}-a_{u+(t-1) n}\\right)\n\\]\n\nfor all \\(1 \\leq u, v \\leq n\\). If \\(v<n-u+1\\) then all terms are 0 on the right-hand side. If \\(v \\geq n-u+1\\), then variable \\(t\\) attains the value \\(n-u+1\\) once. Hence,\n\n\\[\na_{u+v n}= \\begin{cases}0, & u+v \\leq n \\\\ 1, & u+v \\geq n+1\n\\]\n\naccording with (1). Note that the formula is valid for \\(v=0\\) as well.\nFinally, we presented the direct formula for \\(\\left(a_{i}\\right)\\), and we have proved that it satisfies condition (a). So, the solution is complete."}
{"id": "imo-shortlist-2007-c2", "question": "C2. A unit square is dissected into \\(n>1\\) rectangles such that their sides are parallel to the sides of the square. Any line, parallel to a side of the square and intersecting its interior, also intersects the interior of some rectangle. Prove that in this dissection, there exists a rectangle having no point on the boundary of the square.\n(Japan)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2007, "solution": "Call the directions of the sides of the square horizontal and vertical. A horizontal or vertical line, which intersects the interior of the square but does not intersect the interior of any rectangle, will be called a splitting line. A rectangle having no point on the boundary of the square will be called an interior rectangle.\n\nSuppose, to the contrary, that there exists a dissection of the square into more than one rectangle, such that no interior rectangle and no splitting line appear. Consider such a dissection with the least possible number of rectangles. Notice that this number of rectangles is greater than 2 , otherwise their common side provides a splitting line.\n\nIf there exist two rectangles having a common side, then we can replace them by their union (see Figure 1). The number of rectangles was greater than 2, so in a new dissection it is greater than 1. Clearly, in the new dissection, there is also no splitting line as well as no interior rectangle. This contradicts the choice of the original dissection.\n\nDenote the initial square by \\(A B C D\\), with \\(A\\) and \\(B\\) being respectively the lower left and lower right vertices. Consider those two rectangles \\(a\\) and \\(b\\) containing vertices \\(A\\) and \\(B\\), respectively. (Note that \\(a \\neq b\\), otherwise its top side provides a splitting line.) We can assume that the height of \\(a\\) is not greater than that of \\(b\\). Then consider the rectangle \\(c\\) neighboring to the lower right corner of \\(a\\) (it may happen that \\(c=b\\) ). By aforementioned, the heights of \\(a\\) and \\(c\\) are distinct. Then two cases are possible.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-28}\n\nFigure 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-28(2)}\n\nFigure 2\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-28(1)}\n\nFigure 3\n\nCase 1. The height of \\(c\\) is less than that of \\(a\\). Consider the rectangle \\(d\\) which is adjacent to both \\(a\\) and \\(c\\), i.e. the one containing the angle marked in Figure 2. This rectangle has no common point with \\(B C\\) (since \\(a\\) is not higher than \\(b\\) ), as well as no common point with \\(A B\\) or with \\(A D\\) (obviously). Then \\(d\\) has a common point with \\(C D\\), and its left side provides a splitting line. Contradiction.\n\nCase 2. The height of \\(c\\) is greater than that of \\(a\\). Analogously, consider the rectangle \\(d\\) containing the angle marked on Figure 3. It has no common point with \\(A D\\) (otherwise it has a common side with \\(a\\) ), as well as no common point with \\(A B\\) or with \\(B C\\) (obviously). Then \\(d\\) has a common point with \\(C D\\). Hence its right side provides a splitting line, and we get the contradiction again.\n\nSolution 2. Again, we suppose the contrary. Consider an arbitrary counterexample. Then we know that each rectangle is attached to at least one side of the square. Observe that a rectangle cannot be attached to two opposite sides, otherwise one of its sides lies on a splitting line.\n\nWe say that two rectangles are opposite if they are attached to opposite sides of \\(A B C D\\). We claim that there exist two opposite rectangles having a common point.\n\nConsider the union \\(L\\) of all rectangles attached to the left. Assume, to the contrary, that \\(L\\) has no common point with the rectangles attached to the right. Take a polygonal line \\(p\\) connecting the top and the bottom sides of the square and passing close from the right to the boundary of \\(L\\) (see Figure 4). Then all its points belong to the rectangles attached either to the top or to the bottom. Moreover, the upper end-point of \\(p\\) belongs to a rectangle attached to the top, and the lower one belongs to an other rectangle attached to the bottom. Hence, there is a point on \\(p\\) where some rectangles attached to the top and to the bottom meet each other. So, there always exists a pair of neighboring opposite rectangles.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-29(2)}\n\nFigure 4\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-29}\n\nFigure 5\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-29(1)}\n\nFigure 6\n\nNow, take two opposite neighboring rectangles \\(a\\) and \\(b\\). We can assume that \\(a\\) is attached to the left and \\(b\\) is attached to the right. Let \\(X\\) be their common point. If \\(X\\) belongs to their horizontal sides (in particular, \\(X\\) may appear to be a common vertex of \\(a\\) and \\(b\\) ), then these sides provide a splitting line (see Figure 5). Otherwise, \\(X\\) lies on the vertical sides. Let \\(\\ell\\) be the line containing these sides.\n\nSince \\(\\ell\\) is not a splitting line, it intersects the interior of some rectangle. Let \\(c\\) be such a rectangle, closest to \\(X\\); we can assume that \\(c\\) lies above \\(X\\). Let \\(Y\\) be the common point of \\(\\ell\\) and the bottom side of \\(c\\) (see Figure 6). Then \\(Y\\) is also a vertex of two rectangles lying below \\(c\\).\n\nSo, let \\(Y\\) be the upper-right and upper-left corners of the rectangles \\(a^{\\prime}\\) and \\(b^{\\prime}\\), respectively. Then \\(a^{\\prime}\\) and \\(b^{\\prime}\\) are situated not lower than \\(a\\) and \\(b\\), respectively (it may happen that \\(a=a^{\\prime}\\) or \\(\\left.b=b^{\\prime}\\right)\\). We claim that \\(a^{\\prime}\\) is attached to the left. If \\(a=a^{\\prime}\\) then of course it is. If \\(a \\neq a^{\\prime}\\) then \\(a^{\\prime}\\) is above \\(a\\), below \\(c\\) and to the left from \\(b^{\\prime}\\). Hence, it can be attached to the left only.\n\nAnalogously, \\(b^{\\prime}\\) is attached to the right. Now, the top sides of these two rectangles pass through \\(Y\\), hence they provide a splitting line again. This last contradiction completes the proof."}
{"id": "imo-shortlist-2007-c3", "question": "C3. Find all positive integers \\(n\\), for which the numbers in the set \\(S=\\{1,2, \\ldots, n\\}\\) can be colored red and blue, with the following condition being satisfied: the set \\(S \\times S \\times S\\) contains exactly 2007 ordered triples ( \\(x, y, z\\) ) such that (i) \\(x, y, z\\) are of the same color and (ii) \\(x+y+z\\) is divisible by \\(n\\).\n(Netherlands)\nAnswer. \\(n=69\\) and \\(n=84\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2007, "solution": "Suppose that the numbers \\(1,2, \\ldots, n\\) are colored red and blue. Denote by \\(R\\) and \\(B\\) the sets of red and blue numbers, respectively; let \\(|R|=r\\) and \\(|B|=b=n-r\\). Call a triple \\((x, y, z) \\in S \\times S \\times S\\) monochromatic if \\(x, y, z\\) have the same color, and bichromatic otherwise. Call a triple ( \\(x, y, z\\) ) divisible if \\(x+y+z\\) is divisible by \\(n\\). We claim that there are exactly \\(r^{2}-r b+b^{2}\\) divisible monochromatic triples.\n\nFor any pair \\((x, y) \\in S \\times S\\) there exists a unique \\(z_{x, y} \\in S\\) such that the triple \\(\\left(x, y, z_{x, y}\\right)\\) is divisible; so there are exactly \\(n^{2}\\) divisible triples. Furthermore, if a divisible triple ( \\(x, y, z\\) ) is bichromatic, then among \\(x, y, z\\) there are either one blue and two red numbers, or vice versa. In both cases, exactly one of the pairs \\((x, y),(y, z)\\) and \\((z, x)\\) belongs to the set \\(R \\times B\\). Assign such pair to the triple \\((x, y, z)\\).\n\nConversely, consider any pair \\((x, y) \\in R \\times B\\), and denote \\(z=z_{x, y}\\). Since \\(x \\neq y\\), the triples \\((x, y, z),(y, z, x)\\) and \\((z, x, y)\\) are distinct, and \\((x, y)\\) is assigned to each of them. On the other hand, if \\((x, y)\\) is assigned to some triple, then this triple is clearly one of those mentioned above. So each pair in \\(R \\times B\\) is assigned exactly three times.\n\nThus, the number of bichromatic divisible triples is three times the number of elements in \\(R \\times B\\), and the number of monochromatic ones is \\(n^{2}-3 r b=(r+b)^{2}-3 r b=r^{2}-r b+b^{2}\\), as claimed.\n\nSo, to find all values of \\(n\\) for which the desired coloring is possible, we have to find all \\(n\\), for which there exists a decomposition \\(n=r+b\\) with \\(r^{2}-r b+b^{2}=2007\\). Therefore, \\(9 \\mid r^{2}-r b+b^{2}=(r+b)^{2}-3 r b\\). From this it consequently follows that \\(3|r+b, 3| r b\\), and then \\(3|r, 3| b\\). Set \\(r=3 s, b=3 c\\). We can assume that \\(s \\geq c\\). We have \\(s^{2}-s c+c^{2}=223\\).\n\nFurthermore,\n\n\\[\n892=4\\left(s^{2}-s c+c^{2}\\right)=(2 c-s)^{2}+3 s^{2} \\geq 3 s^{2} \\geq 3 s^{2}-3 c(s-c)=3\\left(s^{2}-s c+c^{2}\\right)=669\n\\]\n\nso \\(297 \\geq s^{2} \\geq 223\\) and \\(17 \\geq s \\geq 15\\). If \\(s=15\\) then\n\n\\[\nc(15-c)=c(s-c)=s^{2}-\\left(s^{2}-s c+c^{2}\\right)=15^{2}-223=2\n\\]\n\nwhich is impossible for an integer \\(c\\). In a similar way, if \\(s=16\\) then \\(c(16-c)=33\\), which is also impossible. Finally, if \\(s=17\\) then \\(c(17-c)=66\\), and the solutions are \\(c=6\\) and \\(c=11\\). Hence, \\((r, b)=(51,18)\\) or \\((r, b)=(51,33)\\), and the possible values of \\(n\\) are \\(n=51+18=69\\) and \\(n=51+33=84\\).\n\nComment. After the formula for the number of monochromatic divisible triples is found, the solution can be finished in various ways. The one presented is aimed to decrease the number of considered cases."}
{"id": "imo-shortlist-2007-c4", "question": "C4. Let \\(A_{0}=\\left(a_{1}, \\ldots, a_{n}\\right)\\) be a finite sequence of real numbers. For each \\(k \\geq 0\\), from the sequence \\(A_{k}=\\left(x_{1}, \\ldots, x_{n}\\right)\\) we construct a new sequence \\(A_{k+1}\\) in the following way.\n\n\\begin{enumerate}\n  \\item We choose a partition \\(\\{1, \\ldots, n\\}=I \\cup J\\), where \\(I\\) and \\(J\\) are two disjoint sets, such that the expression\n\n\n\\[\n\\left|\\sum_{i \\in I} x_{i}-\\sum_{j \\in J} x_{j}\\right|\n\\]\n\nattains the smallest possible value. (We allow the sets \\(I\\) or \\(J\\) to be empty; in this case the corresponding sum is 0.) If there are several such partitions, one is chosen arbitrarily.\n2. We set \\(A_{k+1}=\\left(y_{1}, \\ldots, y_{n}\\right)\\), where \\(y_{i}=x_{i}+1\\) if \\(i \\in I\\), and \\(y_{i}=x_{i}-1\\) if \\(i \\in J\\).\n\nProve that for some \\(k\\), the sequence \\(A_{k}\\) contains an element \\(x\\) such that \\(|x| \\geq n / 2\\).\n(Iran)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2007, "solution": ""}
{"id": "imo-shortlist-2007-g1", "question": "G1. In triangle \\(A B C\\), the angle bisector at vertex \\(C\\) intersects the circumcircle and the perpendicular bisectors of sides \\(B C\\) and \\(C A\\) at points \\(R, P\\), and \\(Q\\), respectively. The midpoints of \\(B C\\) and \\(C A\\) are \\(S\\) and \\(T\\), respectively. Prove that triangles \\(R Q T\\) and \\(R P S\\) have the same area.\n(Czech Republic)", "category": "Geometry", "source": "IMO Shortlist", "year": 2007, "solution": "If \\(A C=B C\\) then triangle \\(A B C\\) is isosceles, triangles \\(R Q T\\) and \\(R P S\\) are symmetric about the bisector \\(C R\\) and the statement is trivial. If \\(A C \\neq B C\\) then it can be assumed without loss of generality that \\(A C<B C\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-39}\n\nDenote the circumcenter by \\(O\\). The right triangles \\(C T Q\\) and \\(C S P\\) have equal angles at vertex \\(C\\), so they are similar, \\(\\angle C P S=\\angle C Q T=\\angle O Q P\\) and\n\n\\[\n\\frac{Q T}{P S}=\\frac{C Q}{C P}\n\\]\n\nLet \\(\\ell\\) be the perpendicular bisector of chord \\(C R\\); of course, \\(\\ell\\) passes through the circumcenter \\(O\\). Due to the equal angles at \\(P\\) and \\(Q\\), triangle \\(O P Q\\) is isosceles with \\(O P=O Q\\). Then line \\(\\ell\\) is the axis of symmetry in this triangle as well. Therefore, points \\(P\\) and \\(Q\\) lie symmetrically on line segment \\(C R\\),\n\n\\[\nR P=C Q \\quad \\text { and } \\quad R Q=C P .\n\\]\n\nTriangles \\(R Q T\\) and \\(R P S\\) have equal angles at vertices \\(Q\\) and \\(P\\), respectively. Then\n\n\\[\n\\frac{\\operatorname{area}(R Q T)}{\\operatorname{area}(R P S)}=\\frac{\\frac{1}{2} \\cdot R Q \\cdot Q T \\cdot \\sin \\angle R Q T}{\\frac{1}{2} \\cdot R P \\cdot P S \\cdot \\sin \\angle R P S}=\\frac{R Q}{R P} \\cdot \\frac{Q T}{P S} .\n\\]\n\nSubstituting (1) and (2),\n\n\\[\n\\frac{\\operatorname{area}(R Q T)}{\\operatorname{area}(R P S)}=\\frac{R Q}{R P} \\cdot \\frac{Q T}{P S}=\\frac{C P}{C Q} \\cdot \\frac{C Q}{C P}=1 .\n\\]\n\nHence, \\(\\operatorname{area}(R Q T)=\\operatorname{area}(R S P)\\).\n\nSolution 2. Assume again \\(A C<B C\\). Denote the circumcenter by \\(O\\), and let \\(\\gamma\\) be the angle at \\(C\\). Similarly to the first solution, from right triangles \\(C T Q\\) and \\(C S P\\) we obtain that \\(\\angle O P Q=\\angle O Q P=90^{\\circ}-\\frac{\\gamma}{2}\\). Then triangle \\(O P Q\\) is isosceles, \\(O P=O Q\\) and moreover \\(\\angle P O Q=\\gamma\\).\n\nAs is well-known, point \\(R\\) is the midpoint of \\(\\operatorname{arc} A B\\) and \\(\\angle R O A=\\angle B O R=\\gamma\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-40}\n\nConsider the rotation around point \\(O\\) by angle \\(\\gamma\\). This transform moves \\(A\\) to \\(R, R\\) to \\(B\\) and \\(Q\\) to \\(P\\); hence triangles \\(R Q A\\) and \\(B P R\\) are congruent and they have the same area.\n\nTriangles \\(R Q T\\) and \\(R Q A\\) have \\(R Q\\) as a common side, so the ratio between their areas is\n\n\\[\n\\frac{\\operatorname{area}(R Q T)}{\\operatorname{area}(R Q A)}=\\frac{d(T, C R)}{d(A, C R)}=\\frac{C T}{C A}=\\frac{1}{2}\n\\]\n\n( \\(d(X, Y Z)\\) denotes the distance between point \\(X\\) and line \\(Y Z\\) ).\nIt can be obtained similarly that\n\n\\[\n\\frac{\\operatorname{area}(R P S)}{\\operatorname{area}(B P R)}=\\frac{C S}{C B}=\\frac{1}{2}\n\\]\n\nNow the proof can be completed as\n\n\\[\n\\operatorname{area}(R Q T)=\\frac{1}{2} \\operatorname{area}(R Q A)=\\frac{1}{2} \\operatorname{area}(B P R)=\\operatorname{area}(R P S)\n\\]"}
{"id": "imo-shortlist-2007-g2", "question": "G2. Given an isosceles triangle \\(A B C\\) with \\(A B=A C\\). The midpoint of side \\(B C\\) is denoted by \\(M\\). Let \\(X\\) be a variable point on the shorter arc \\(M A\\) of the circumcircle of triangle \\(A B M\\). Let \\(T\\) be the point in the angle domain \\(B M A\\), for which \\(\\angle T M X=90^{\\circ}\\) and \\(T X=B X\\). Prove that \\(\\angle M T B-\\angle C T M\\) does not depend on \\(X\\).\n(Canada)", "category": "Geometry", "source": "IMO Shortlist", "year": 2007, "solution": "Let \\(N\\) be the midpoint of segment \\(B T\\) (see Figure 1). Line \\(X N\\) is the axis of symmetry in the isosceles triangle \\(B X T\\), thus \\(\\angle T N X=90^{\\circ}\\) and \\(\\angle B X N=\\angle N X T\\). Moreover, in triangle \\(B C T\\), line \\(M N\\) is the midline parallel to \\(C T\\); hence \\(\\angle C T M=\\angle N M T\\).\n\nDue to the right angles at points \\(M\\) and \\(N\\), these points lie on the circle with diameter \\(X T\\). Therefore,\n\n\\[\n\\angle M T B=\\angle M T N=\\angle M X N \\quad \\text { and } \\quad \\angle C T M=\\angle N M T=\\angle N X T=\\angle B X N .\n\\]\n\nHence\n\n\\[\n\\angle M T B-\\angle C T M=\\angle M X N-\\angle B X N=\\angle M X B=\\angle M A B\n\\]\n\nwhich does not depend on \\(X\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-41}\n\nFigure 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-41(1)}\n\nFigure 2\n\nSolution 2. Let \\(S\\) be the reflection of point \\(T\\) over \\(M\\) (see Figure 2). Then \\(X M\\) is the perpendicular bisector of \\(T S\\), hence \\(X B=X T=X S\\), and \\(X\\) is the circumcenter of triangle \\(B S T\\). Moreover, \\(\\angle B S M=\\angle C T M\\) since they are symmetrical about \\(M\\). Then\n\n\\[\n\\angle M T B-\\angle C T M=\\angle S T B-\\angle B S T=\\frac{\\angle S X B-\\angle B X T}{2} .\n\\]\n\nObserve that \\(\\angle S X B=\\angle S X T-\\angle B X T=2 \\angle M X T-\\angle B X T\\), so\n\n\\[\n\\angle M T B-\\angle C T M=\\frac{2 \\angle M X T-2 \\angle B X T}{2}=\\angle M X B=\\angle M A B\n\\]\n\nwhich is constant."}
{"id": "imo-shortlist-2007-g3", "question": "G3. The diagonals of a trapezoid \\(A B C D\\) intersect at point \\(P\\). Point \\(Q\\) lies between the parallel lines \\(B C\\) and \\(A D\\) such that \\(\\angle A Q D=\\angle C Q B\\), and line \\(C D\\) separates points \\(P\\) and \\(Q\\). Prove that \\(\\angle B Q P=\\angle D A Q\\).\n(Ukraine)", "category": "Geometry", "source": "IMO Shortlist", "year": 2007, "solution": "Let \\(t=\\frac{A D}{B C}\\). Consider the homothety \\(h\\) with center \\(P\\) and scale \\(-t\\). Triangles PDA and \\(P B C\\) are similar with ratio \\(t\\), hence \\(h(B)=D\\) and \\(h(C)=A\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-42}\n\nLet \\(Q^{\\prime}=h(Q)\\) (see Figure 1). Then points \\(Q, P\\) and \\(Q^{\\prime}\\) are obviously collinear. Points \\(Q\\) and \\(P\\) lie on the same side of \\(A D\\), as well as on the same side of \\(B C\\); hence \\(Q^{\\prime}\\) and \\(P\\) are also on the same side of \\(h(B C)=A D\\), and therefore \\(Q\\) and \\(Q^{\\prime}\\) are on the same side of \\(A D\\). Moreover, points \\(Q\\) and \\(C\\) are on the same side of \\(B D\\), while \\(Q^{\\prime}\\) and \\(A\\) are on the opposite side (see Figure above).\n\nBy the homothety, \\(\\angle A Q^{\\prime} D=\\angle C Q B=\\angle A Q D\\), hence quadrilateral \\(A Q^{\\prime} Q D\\) is cyclic. Then\n\n\\[\n\\angle D A Q=\\angle D Q^{\\prime} Q=\\angle D Q^{\\prime} P=\\angle B Q P\n\\]\n\n(the latter equality is valid by the homothety again).\nComment. The statement of the problem is a limit case of the following result.\nIn an arbitrary quadrilateral \\(A B C D\\), let \\(P=A C \\cap B D, I=A D \\cap B C\\), and let \\(Q\\) be an arbitrary point which is not collinear with any two of points \\(A, B, C, D\\). Then \\(\\angle A Q D=\\angle C Q B\\) if and only if \\(\\angle B Q P=\\angle I Q A\\) (angles are oriented; see Figure below to the left).\n\nIn the special case of the trapezoid, \\(I\\) is an ideal point and \\(\\angle D A Q=\\angle I Q A=\\angle B Q P\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-42(1)}\n\nLet \\(a=Q A, b=Q B, c=Q C, d=Q D, i=Q I\\) and \\(p=Q P\\). Let line \\(Q A\\) intersect lines \\(B C\\) and \\(B D\\) at points \\(U\\) and \\(V\\), respectively. On lines \\(B C\\) and \\(B D\\) we have\n\n\\[\n(a b c i)=(U B C I) \\quad \\text { and } \\quad(b a d p)=(a b p d)=(V B P D)\n\\]\n\nProjecting from \\(A\\), we get\n\n\\[\n(a b c i)=(U B C I)=(V B P D)=(b a d p)\n\\]\n\nSuppose that \\(\\angle A Q D=\\angle C Q B\\). Let line \\(p^{\\prime}\\) be the reflection of line \\(i\\) about the bisector of angle \\(A Q B\\). Then by symmetry we have \\(\\left(b a d p^{\\prime}\\right)=(a b c i)=(b a d p)\\). Hence \\(p=p^{\\prime}\\), as desired.\n\nThe converse statement can be proved analogously."}
{"id": "imo-shortlist-2007-g4", "question": "G4. Consider five points \\(A, B, C, D, E\\) such that \\(A B C D\\) is a parallelogram and \\(B C E D\\) is a cyclic quadrilateral. Let \\(\\ell\\) be a line passing through \\(A\\), and let \\(\\ell\\) intersect segment \\(D C\\) and line \\(B C\\) at points \\(F\\) and \\(G\\), respectively. Suppose that \\(E F=E G=E C\\). Prove that \\(\\ell\\) is the bisector of angle \\(D A B\\).\n(Luxembourg)", "category": "Geometry", "source": "IMO Shortlist", "year": 2007, "solution": "If \\(C F=C G\\), then \\(\\angle F G C=\\angle G F C\\), hence \\(\\angle G A B=\\angle G F C=\\angle F G C=\\angle F A D\\), and \\(\\ell\\) is a bisector.\n\nAssume that \\(C F<G C\\). Let \\(E K\\) and \\(E L\\) be the altitudes in the isosceles triangles \\(E C F\\) and \\(E G C\\), respectively. Then in the right triangles \\(E K F\\) and \\(E L C\\) we have \\(E F=E C\\) and\n\n\\[\nK F=\\frac{C F}{2}<\\frac{G C}{2}=L C,\n\\]\n\nso\n\n\\[\nK E=\\sqrt{E F^{2}-K F^{2}}>\\sqrt{E C^{2}-L C^{2}}=L E .\n\\]\n\nSince quadrilateral \\(B C E D\\) is cyclic, we have \\(\\angle E D C=\\angle E B C\\), so the right triangles \\(B E L\\) and \\(D E K\\) are similar. Then \\(K E>L E\\) implies \\(D K>B L\\), and hence\n\n\\[\nD F=D K-K F>B L-L C=B C=A D\n\\]\n\nBut triangles \\(A D F\\) and \\(G C F\\) are similar, so we have \\(1>\\frac{A D}{D F}=\\frac{G C}{C F}\\); this contradicts our assumption.\n\nThe case \\(C F>G C\\) is completely similar. We consequently obtain the converse inequalities \\(K F>L C, K E<L E, D K<B L, D F<A D\\), hence \\(1<\\frac{A D}{D F}=\\frac{G C}{C F}\\); a contradiction.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-43}"}
{"id": "imo-shortlist-2007-g5", "question": "G5. Let \\(A B C\\) be a fixed triangle, and let \\(A_{1}, B_{1}, C_{1}\\) be the midpoints of sides \\(B C, C A, A B\\), respectively. Let \\(P\\) be a variable point on the circumcircle. Let lines \\(P A_{1}, P B_{1}, P C_{1}\\) meet the circumcircle again at \\(A^{\\prime}, B^{\\prime}, C^{\\prime}\\) respectively. Assume that the points \\(A, B, C, A^{\\prime}, B^{\\prime}, C^{\\prime}\\) are distinct, and lines \\(A A^{\\prime}, B B^{\\prime}, C C^{\\prime}\\) form a triangle. Prove that the area of this triangle does not depend on \\(P\\).\n(United Kingdom)", "category": "Geometry", "source": "IMO Shortlist", "year": 2007, "solution": "Let \\(A_{0}, B_{0}, C_{0}\\) be the points of intersection of the lines \\(A A^{\\prime}, B B^{\\prime}\\) and \\(C C^{\\prime}\\) (see Figure). We claim that area \\(\\left(A_{0} B_{0} C_{0}\\right)=\\frac{1}{2}\\) area \\((A B C)\\), hence it is constant.\n\nConsider the inscribed hexagon \\(A B C C^{\\prime} P A^{\\prime}\\). By Pascal's theorem, the points of intersection of its opposite sides (or of their extensions) are collinear. These points are \\(A B \\cap C^{\\prime} P=C_{1}\\), \\(B C \\cap P A^{\\prime}=A_{1}, C C^{\\prime} \\cap A^{\\prime} A=B_{0}\\). So point \\(B_{0}\\) lies on the midline \\(A_{1} C_{1}\\) of triangle \\(A B C\\). Analogously, points \\(A_{0}\\) and \\(C_{0}\\) lie on lines \\(B_{1} C_{1}\\) and \\(A_{1} B_{1}\\), respectively.\n\nLines \\(A C\\) and \\(A_{1} C_{1}\\) are parallel, so triangles \\(B_{0} C_{0} A_{1}\\) and \\(A C_{0} B_{1}\\) are similar; hence we have\n\n\\[\n\\frac{B_{0} C_{0}}{A C_{0}}=\\frac{A_{1} C_{0}}{B_{1} C_{0}} .\n\\]\n\nAnalogously, from \\(B C \\| B_{1} C_{1}\\) we obtain\n\n\\[\n\\frac{A_{1} C_{0}}{B_{1} C_{0}}=\\frac{B C_{0}}{A_{0} C_{0}} .\n\\]\n\nCombining these equalities, we get\n\n\\[\n\\frac{B_{0} C_{0}}{A C_{0}}=\\frac{B C_{0}}{A_{0} C_{0}},\n\\]\n\nor\n\n\\[\nA_{0} C_{0} \\cdot B_{0} C_{0}=A C_{0} \\cdot B C_{0}\n\\]\n\nHence we have\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-44}\n\n\\[\n\\operatorname{area}\\left(A_{0} B_{0} C_{0}\\right)=\\frac{1}{2} A_{0} C_{0} \\cdot B_{0} C_{0} \\sin \\angle A_{0} C_{0} B_{0}=\\frac{1}{2} A C_{0} \\cdot B C_{0} \\sin \\angle A C_{0} B=\\operatorname{area}\\left(A B C_{0}\\right) .\n\\]\n\nSince \\(C_{0}\\) lies on the midline, we have \\(d\\left(C_{0}, A B\\right)=\\frac{1}{2} d(C, A B)\\) (we denote by \\(d(X, Y Z)\\) the distance between point \\(X\\) and line \\(Y Z\\) ). Then we obtain\n\n\\[\n\\operatorname{area}\\left(A_{0} B_{0} C_{0}\\right)=\\operatorname{area}\\left(A B C_{0}\\right)=\\frac{1}{2} A B \\cdot d\\left(C_{0}, A B\\right)=\\frac{1}{4} A B \\cdot d(C, A B)=\\frac{1}{2} \\operatorname{area}(A B C)\n\\]\n\nSolution 2. Again, we prove that area \\(\\left(A_{0} B_{0} C_{0}\\right)=\\frac{1}{2} \\operatorname{area}(A B C)\\).\nWe can assume that \\(P\\) lies on arc \\(A C\\). Mark a point \\(L\\) on side \\(A C\\) such that \\(\\angle C B L=\\) \\(\\angle P B A\\); then \\(\\angle L B A=\\angle C B A-\\angle C B L=\\angle C B A-\\angle P B A=\\angle C B P\\). Note also that \\(\\angle B A L=\\angle B A C=\\angle B P C\\) and \\(\\angle L C B=\\angle A P B\\). Hence, triangles \\(B A L\\) and \\(B P C\\) are similar, and so are triangles \\(L C B\\) and \\(A P B\\).\n\nAnalogously, mark points \\(K\\) and \\(M\\) respectively on the extensions of sides \\(C B\\) and \\(A B\\) beyond point \\(B\\), such that \\(\\angle K A B=\\angle C A P\\) and \\(\\angle B C M=\\angle P C A\\). For analogous reasons, \\(\\angle K A C=\\angle B A P\\) and \\(\\angle A C M=\\angle P C B\\). Hence \\(\\triangle A B K \\sim \\triangle A P C \\sim \\triangle M B C, \\triangle A C K \\sim\\) \\(\\triangle A P B\\), and \\(\\triangle M A C \\sim \\triangle B P C\\). From these similarities, we have \\(\\angle C M B=\\angle K A B=\\angle C A P\\), while we have seen that \\(\\angle C A P=\\angle C B P=\\angle L B A\\). Hence, \\(A K\\|B L\\| C M\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-45}\n\nLet line \\(C C^{\\prime}\\) intersect \\(B L\\) at point \\(X\\). Note that \\(\\angle L C X=\\angle A C C^{\\prime}=\\angle A P C^{\\prime}=\\angle A P C_{1}\\), and \\(P C_{1}\\) is a median in triangle \\(A P B\\). Since triangles \\(A P B\\) and \\(L C B\\) are similar, \\(C X\\) is a median in triangle \\(L C B\\), and \\(X\\) is a midpoint of \\(B L\\). For the same reason, \\(A A^{\\prime}\\) passes through this midpoint, so \\(X=B_{0}\\). Analogously, \\(A_{0}\\) and \\(C_{0}\\) are the midpoints of \\(A K\\) and \\(C M\\).\n\nNow, from \\(A A_{0} \\| C C_{0}\\), we have\n\n\\[\n\\operatorname{area}\\left(A_{0} B_{0} C_{0}\\right)=\\operatorname{area}\\left(A C_{0} A_{0}\\right)-\\operatorname{area}\\left(A B_{0} A_{0}\\right)=\\operatorname{area}\\left(A C A_{0}\\right)-\\operatorname{area}\\left(A B_{0} A_{0}\\right)=\\operatorname{area}\\left(A C B_{0}\\right)\n\\]\n\nFinally,\n\n\\[\n\\operatorname{area}\\left(A_{0} B_{0} C_{0}\\right)=\\operatorname{area}\\left(A C B_{0}\\right)=\\frac{1}{2} B_{0} L \\cdot A C \\sin A L B_{0}=\\frac{1}{4} B L \\cdot A C \\sin A L B=\\frac{1}{2} \\operatorname{area}(A B C)\n\\]\n\nComment 1. The equality area \\(\\left(A_{0} B_{0} C_{0}\\right)=\\operatorname{area}\\left(A C B_{0}\\right)\\) in Solution 2 does not need to be proved since the following fact is frequently known.\n\nSuppose that the lines \\(K L\\) and \\(M N\\) are parallel, while the lines \\(K M\\) and \\(L N\\) intersect in a point \\(E\\). Then area \\((K E N)=\\operatorname{area}(M E L)\\).\nComment 2. It follows immediately from both solutions that \\(A A_{0}\\left\\|B B_{0}\\right\\| C C_{0}\\). These lines pass through an ideal point which is isogonally conjugate to \\(P\\). It is known that they are parallel to the Simson line of point \\(Q\\) which is opposite to \\(P\\) on the circumcircle.\nComment 3. If \\(A=A^{\\prime}\\), then one can define the line \\(A A^{\\prime}\\) to be the tangent to the circumcircle at point \\(A\\). Then the statement of the problem is also valid in this case."}
{"id": "imo-shortlist-2007-g6", "question": "G6. Determine the smallest positive real number \\(k\\) with the following property.\nLet \\(A B C D\\) be a convex quadrilateral, and let points \\(A_{1}, B_{1}, C_{1}\\) and \\(D_{1}\\) lie on sides \\(A B, B C\\), \\(C D\\) and \\(D A\\), respectively. Consider the areas of triangles \\(A A_{1} D_{1}, B B_{1} A_{1}, C C_{1} B_{1}\\), and \\(D D_{1} C_{1}\\); let \\(S\\) be the sum of the two smallest ones, and let \\(S_{1}\\) be the area of quadrilateral \\(A_{1} B_{1} C_{1} D_{1}\\). Then we always have \\(k S_{1} \\geq S\\).\n\nAnswer. \\(k=1\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2007, "solution": "Throughout the solution, triangles \\(A A_{1} D_{1}, B B_{1} A_{1}, C C_{1} B_{1}\\), and \\(D D_{1} C_{1}\\) will be referred to as border triangles. We will denote by \\([\\mathcal{R}]\\) the area of a region \\(\\mathcal{R}\\).\n\nFirst, we show that \\(k \\geq 1\\). Consider a triangle \\(A B C\\) with unit area; let \\(A_{1}, B_{1}, K\\) be the midpoints of its sides \\(A B, B C, A C\\), respectively. Choose a point \\(D\\) on the extension of \\(B K\\), close to \\(K\\). Take points \\(C_{1}\\) and \\(D_{1}\\) on sides \\(C D\\) and \\(D A\\) close to \\(D\\) (see Figure 1). We have \\(\\left[B B_{1} A_{1}\\right]=\\frac{1}{4}\\). Moreover, as \\(C_{1}, D_{1}, D \\rightarrow K\\), we get \\(\\left[A_{1} B_{1} C_{1} D_{1}\\right] \\rightarrow\\left[A_{1} B_{1} K\\right]=\\frac{1}{4}\\), \\(\\left[A A_{1} D_{1}\\right] \\rightarrow\\left[A A_{1} K\\right]=\\frac{1}{4},\\left[C C_{1} B_{1}\\right] \\rightarrow\\left[C K B_{1}\\right]=\\frac{1}{4}\\) and \\(\\left[D D_{1} C_{1}\\right] \\rightarrow 0\\). Hence, the sum of the two smallest areas of border triangles tends to \\(\\frac{1}{4}\\), as well as \\(\\left[A_{1} B_{1} C_{1} D_{1}\\right]\\); therefore, their ratio tends to 1 , and \\(k \\geq 1\\).\n\nWe are left to prove that \\(k=1\\) satisfies the desired property.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-46}\n\nFigure 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-46(1)}\n\nFigure 2\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-46(2)}\n\nFigure 3\n\nLemma. Let points \\(A_{1}, B_{1}, C_{1}\\) lie respectively on sides \\(B C, C A, A B\\) of a triangle \\(A B C\\). Then \\(\\left[A_{1} B_{1} C_{1}\\right] \\geq \\min \\left\\{\\left[A C_{1} B_{1}\\right],\\left[B A_{1} C_{1}\\right],\\left[C B_{1} A_{1}\\right]\\right\\}\\).\nProof. Let \\(A^{\\prime}, B^{\\prime}, C^{\\prime}\\) be the midpoints of sides \\(B C, C A\\) and \\(A B\\), respectively.\nSuppose that two of points \\(A_{1}, B_{1}, C_{1}\\) lie in one of triangles \\(A C^{\\prime} B^{\\prime}, B A^{\\prime} C^{\\prime}\\) and \\(C B^{\\prime} A^{\\prime}\\) (for convenience, let points \\(B_{1}\\) and \\(C_{1}\\) lie in triangle \\(A C^{\\prime} B^{\\prime}\\); see Figure 2). Let segments \\(B_{1} C_{1}\\) and \\(A A_{1}\\) intersect at point \\(X\\). Then \\(X\\) also lies in triangle \\(A C^{\\prime} B^{\\prime}\\). Hence \\(A_{1} X \\geq A X\\), and we have\n\n\\[\n\\frac{\\left[A_{1} B_{1} C_{1}\\right]}{\\left[A C_{1} B_{1}\\right]}=\\frac{\\frac{1}{2} A_{1} X \\cdot B_{1} C_{1} \\cdot \\sin \\angle A_{1} X C_{1}}{\\frac{1}{2} A X \\cdot B_{1} C_{1} \\cdot \\sin \\angle A X B_{1}}=\\frac{A_{1} X}{A X} \\geq 1,\n\\]\n\nas required.\nOtherwise, each one of triangles \\(A C^{\\prime} B^{\\prime}, B A^{\\prime} C^{\\prime}, C B^{\\prime} A^{\\prime}\\) contains exactly one of points \\(A_{1}\\), \\(B_{1}, C_{1}\\), and we can assume that \\(B A_{1}<B A^{\\prime}, C B_{1}<C B^{\\prime}, A C_{1}<A C^{\\prime}\\) (see Figure 3). Then lines \\(B_{1} A_{1}\\) and \\(A B\\) intersect at a point \\(Y\\) on the extension of \\(A B\\) beyond point \\(B\\), hence \\(\\frac{\\left[A_{1} B_{1} C_{1}\\right]}{\\left[A_{1} B_{1} C^{\\prime}\\right]}=\\frac{C_{1} Y}{C^{\\prime} Y}>1\\); also, lines \\(A_{1} C^{\\prime}\\) and \\(C A\\) intersect at a point \\(Z\\) on the extension of \\(C A\\) beyond point \\(A\\), hence \\(\\frac{\\left[A_{1} B_{1} C^{\\prime}\\right]}{\\left[A_{1} B^{\\prime} C^{\\prime}\\right]}=\\frac{B_{1} Z}{B^{\\prime} Z}>1\\). Finally, since \\(A_{1} A^{\\prime} \\| B^{\\prime} C^{\\prime}\\), we have \\(\\left[A_{1} B_{1} C_{1}\\right]>\\left[A_{1} B_{1} C^{\\prime}\\right]>\\left[A_{1} B^{\\prime} C^{\\prime}\\right]=\\left[A^{\\prime} B^{\\prime} C^{\\prime}\\right]=\\frac{1}{4}[A B C]\\).\n\nNow, from \\(\\left[A_{1} B_{1} C_{1}\\right]+\\left[A C_{1} B_{1}\\right]+\\left[B A_{1} C_{1}\\right]+\\left[C B_{1} A_{1}\\right]=[A B C]\\) we obtain that one of the remaining triangles \\(A C_{1} B_{1}, B A_{1} C_{1}, C B_{1} A_{1}\\) has an area less than \\(\\frac{1}{4}[A B C]\\), so it is less than \\(\\left[A_{1} B_{1} C_{1}\\right]\\).\n\nNow we return to the problem. We say that triangle \\(A_{1} B_{1} C_{1}\\) is small if \\(\\left[A_{1} B_{1} C_{1}\\right]\\) is less than each of \\(\\left[B B_{1} A_{1}\\right]\\) and \\(\\left[C C_{1} B_{1}\\right]\\); otherwise this triangle is big (the similar notion is introduced for triangles \\(B_{1} C_{1} D_{1}, C_{1} D_{1} A_{1}, D_{1} A_{1} B_{1}\\) ). If both triangles \\(A_{1} B_{1} C_{1}\\) and \\(C_{1} D_{1} A_{1}\\) are big, then \\(\\left[A_{1} B_{1} C_{1}\\right]\\) is not less than the area of some border triangle, and \\(\\left[C_{1} D_{1} A_{1}\\right]\\) is not less than the area of another one; hence, \\(S_{1}=\\left[A_{1} B_{1} C_{1}\\right]+\\left[C_{1} D_{1} A_{1}\\right] \\geq S\\). The same is valid for the pair of \\(B_{1} C_{1} D_{1}\\) and \\(D_{1} A_{1} B_{1}\\). So it is sufficient to prove that in one of these pairs both triangles are big.\n\nSuppose the contrary. Then there is a small triangle in each pair. Without loss of generality, assume that triangles \\(A_{1} B_{1} C_{1}\\) and \\(D_{1} A_{1} B_{1}\\) are small. We can assume also that \\(\\left[A_{1} B_{1} C_{1}\\right] \\leq\\) [ \\(D_{1} A_{1} B_{1}\\) ]. Note that in this case ray \\(D_{1} C_{1}\\) intersects line \\(B C\\).\n\nConsider two cases.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-47(1)}\n\nFigure 4\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-47}\n\nFigure 5\n\nCase 1. Ray \\(C_{1} D_{1}\\) intersects line \\(A B\\) at some point \\(K\\). Let ray \\(D_{1} C_{1}\\) intersect line \\(B C\\) at point \\(L\\) (see Figure 4). Then we have \\(\\left[A_{1} B_{1} C_{1}\\right]<\\left[C C_{1} B_{1}\\right]<\\left[L C_{1} B_{1}\\right],\\left[A_{1} B_{1} C_{1}\\right]<\\left[B B_{1} A_{1}\\right]\\) (both - since \\(\\left[A_{1} B_{1} C_{1}\\right]\\) is small), and \\(\\left[A_{1} B_{1} C_{1}\\right] \\leq\\left[D_{1} A_{1} B_{1}\\right]<\\left[A A_{1} D_{1}\\right]<\\left[K A_{1} D_{1}\\right]<\\left[K A_{1} C_{1}\\right]\\) (since triangle \\(D_{1} A_{1} B_{1}\\) is small). This contradicts the Lemma, applied for triangle \\(A_{1} B_{1} C_{1}\\) inside \\(L K B\\).\n\nCase 2. Ray \\(C_{1} D_{1}\\) does not intersect \\(A B\\). Then choose a \"sufficiently far\" point \\(K\\) on ray \\(B A\\) such that \\(\\left[K A_{1} C_{1}\\right]>\\left[A_{1} B_{1} C_{1}\\right]\\), and that ray \\(K C_{1}\\) intersects line \\(B C\\) at some point \\(L\\) (see Figure 5). Since ray \\(C_{1} D_{1}\\) does not intersect line \\(A B\\), the points \\(A\\) and \\(D_{1}\\) are on different sides of \\(K L\\); then \\(A\\) and \\(D\\) are also on different sides, and \\(C\\) is on the same side as \\(A\\) and \\(B\\). Then analogously we have \\(\\left[A_{1} B_{1} C_{1}\\right]<\\left[C C_{1} B_{1}\\right]<\\left[L_{1} B_{1}\\right]\\) and \\(\\left[A_{1} B_{1} C_{1}\\right]<\\left[B B_{1} A_{1}\\right]\\) since triangle \\(A_{1} B_{1} C_{1}\\) is small. This (together with \\(\\left[A_{1} B_{1} C_{1}\\right]<\\left[K A_{1} C_{1}\\right]\\) ) contradicts the Lemma again."}
{"id": "imo-shortlist-2007-g7", "question": "G7. Given an acute triangle \\(A B C\\) with angles \\(\\alpha, \\beta\\) and \\(\\gamma\\) at vertices \\(A, B\\) and \\(C\\), respectively, such that \\(\\beta>\\gamma\\). Point \\(I\\) is the incenter, and \\(R\\) is the circumradius. Point \\(D\\) is the foot of the altitude from vertex \\(A\\). Point \\(K\\) lies on line \\(A D\\) such that \\(A K=2 R\\), and \\(D\\) separates \\(A\\) and \\(K\\). Finally, lines \\(D I\\) and \\(K I\\) meet sides \\(A C\\) and \\(B C\\) at \\(E\\) and \\(F\\), respectively.\n\nProve that if \\(I E=I F\\) then \\(\\beta \\leq 3 \\gamma\\).\n(Iran)", "category": "Geometry", "source": "IMO Shortlist", "year": 2007, "solution": "We first prove that\n\n\\[\n\\angle K I D=\\frac{\\beta-\\gamma}{2}\n\\]\n\neven without the assumption that \\(I E=I F\\). Then we will show that the statement of the problem is a consequence of this fact.\n\nDenote the circumcenter by \\(O\\). On the circumcircle, let \\(P\\) be the point opposite to \\(A\\), and let the angle bisector \\(A I\\) intersect the circle again at \\(M\\). Since \\(A K=A P=2 R\\), triangle \\(A K P\\) is isosceles. It is known that \\(\\angle B A D=\\angle C A O\\), hence \\(\\angle D A I=\\angle B A I-\\angle B A D=\\angle C A I-\\) \\(\\angle C A O=\\angle O A I\\), and \\(A M\\) is the bisector line in triangle \\(A K P\\). Therefore, points \\(K\\) and \\(P\\) are symmetrical about \\(A M\\), and \\(\\angle A M K=\\angle A M P=90^{\\circ}\\). Thus, \\(M\\) is the midpoint of \\(K P\\), and \\(A M\\) is the perpendicular bisector of \\(K P\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-49}\n\nDenote the perpendicular feet of incenter \\(I\\) on lines \\(B C, A C\\), and \\(A D\\) by \\(A_{1}, B_{1}\\), and \\(T\\), respectively. Quadrilateral \\(D A_{1} I T\\) is a rectangle, hence \\(T D=I A_{1}=I B_{1}\\).\n\nDue to the right angles at \\(T\\) and \\(B_{1}\\), quadrilateral \\(A B_{1} I T\\) is cyclic. Hence \\(\\angle B_{1} T I=\\) \\(\\angle B_{1} A I=\\angle C A M=\\angle B A M=\\angle B P M\\) and \\(\\angle I B_{1} T=\\angle I A T=\\angle M A K=\\angle M A P=\\) \\(\\angle M B P\\). Therefore, triangles \\(B_{1} T I\\) and \\(B P M\\) are similar and \\(\\frac{I T}{I B_{1}}=\\frac{M P}{M B}\\).\n\nIt is well-known that \\(M B=M C=M I\\). Then right triangles \\(I T D\\) and \\(K M I\\) are also\nsimilar, because \\(\\frac{I T}{T D}=\\frac{I T}{I B_{1}}=\\frac{M P}{M B}=\\frac{K M}{M I}\\). Hence, \\(\\angle K I M=\\angle I D T=\\angle I D A\\), and\n\n\\[\n\\angle K I D=\\angle M I D-\\angle K I M=(\\angle I A D+\\angle I D A)-\\angle I D A=\\angle I A D\n\\]\n\nFinally, from the right triangle \\(A D B\\) we can compute\n\n\\[\n\\angle K I D=\\angle I A D=\\angle I A B-\\angle D A B=\\frac{\\alpha}{2}-\\left(90^{\\circ}-\\beta\\right)=\\frac{\\alpha}{2}-\\frac{\\alpha+\\beta+\\gamma}{2}+\\beta=\\frac{\\beta-\\gamma}{2} .\n\\]\n\nNow let us turn to the statement and suppose that \\(I E=I F\\). Since \\(I A_{1}=I B_{1}\\), the right triangles \\(I E B_{1}\\) and \\(I F A_{1}\\) are congruent and \\(\\angle I E B_{1}=\\angle I F A_{1}\\). Since \\(\\beta>\\gamma, A_{1}\\) lies in the interior of segment \\(C D\\) and \\(F\\) lies in the interior of \\(A_{1} D\\). Hence, \\(\\angle I F C\\) is acute. Then two cases are possible depending on the order of points \\(A, C, B_{1}\\) and \\(E\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-50}\n\nIf point \\(E\\) lies between \\(C\\) and \\(B_{1}\\) then \\(\\angle I F C=\\angle I E A\\), hence quadrilateral \\(C E I F\\) is cyclic and \\(\\angle F C E=180^{\\circ}-\\angle E I F=\\angle K I D\\). By (1), in this case we obtain \\(\\angle F C E=\\gamma=\\angle K I D=\\) \\(\\frac{\\beta-\\gamma}{2}\\) and \\(\\beta=3 \\gamma\\).\n\nOtherwise, if point \\(E\\) lies between \\(A\\) and \\(B_{1}\\), quadrilateral \\(C E I F\\) is a deltoid such that \\(\\angle I E C=\\angle I F C<90^{\\circ}\\). Then we have \\(\\angle F C E>180^{\\circ}-\\angle E I F=\\angle K I D\\). Therefore, \\(\\angle F C E=\\gamma>\\angle K I D=\\frac{\\beta-\\gamma}{2}\\) and \\(\\beta<3 \\gamma\\).\nComment 1. In the case when quadrilateral \\(C E I F\\) is a deltoid, one can prove the desired inequality without using (1). Actually, from \\(\\angle I E C=\\angle I F C<90^{\\circ}\\) it follows that \\(\\angle A D I=90^{\\circ}-\\angle E D C<\\) \\(\\angle A E D-\\angle E D C=\\gamma\\). Since the incircle lies inside triangle \\(A B C\\), we have \\(A D>2 r\\) (here \\(r\\) is the inradius), which implies \\(D T<T A\\) and \\(D I<A I\\); hence \\(\\frac{\\beta-\\gamma}{2}=\\angle I A D<\\angle A D I<\\gamma\\).\nSolution 2. We give a different proof for (1). Then the solution can be finished in the same way as above.\n\nDefine points \\(M\\) and \\(P\\) again; it can be proved in the same way that \\(A M\\) is the perpendicular bisector of \\(K P\\). Let \\(J\\) be the center of the excircle touching side \\(B C\\). It is well-known that points \\(B, C, I, J\\) lie on a circle with center \\(M\\); denote this circle by \\(\\omega_{1}\\).\n\nLet \\(B^{\\prime}\\) be the reflection of point \\(B\\) about the angle bisector \\(A M\\). By the symmetry, \\(B^{\\prime}\\) is the second intersection point of circle \\(\\omega_{1}\\) and line \\(A C\\). Triangles \\(P B A\\) and \\(K B^{\\prime} A\\) are symmetrical\nwith respect to line \\(A M\\), therefore \\(\\angle K B^{\\prime} A=\\angle P B A=90^{\\circ}\\). By the right angles at \\(D\\) and \\(B^{\\prime}\\), points \\(K, D, B^{\\prime}, C\\) are concyclic and\n\n\\[\nA D \\cdot A K=A B^{\\prime} \\cdot A C\n\\]\n\nFrom the cyclic quadrilateral \\(I J C B^{\\prime}\\) we obtain \\(A B^{\\prime} \\cdot A C=A I \\cdot A J\\) as well, therefore\n\n\\[\nA D \\cdot A K=A B^{\\prime} \\cdot A C=A I \\cdot A J\n\\]\n\nand points \\(I, J, K, D\\) are also concyclic. Denote circle \\(I D K J\\) by \\(\\omega_{2}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-51}\n\nLet \\(N\\) be the point on circle \\(\\omega_{2}\\) which is opposite to \\(K\\). Since \\(\\angle N D K=90^{\\circ}=\\angle C D K\\), point \\(N\\) lies on line \\(B C\\). Point \\(M\\), being the center of circle \\(\\omega_{1}\\), is the midpoint of segment \\(I J\\), and \\(K M\\) is perpendicular to \\(I J\\). Therefore, line \\(K M\\) is the perpendicular bisector of \\(I J\\) and hence it passes through \\(N\\).\n\nFrom the cyclic quadrilateral IDKN we obtain\n\n\\[\n\\angle K I D=\\angle K N D=90^{\\circ}-\\angle D K N=90^{\\circ}-\\angle A K M=\\angle M A K=\\frac{\\beta-\\gamma}{2}\n\\]\n\nComment 2. The main difficulty in the solution is finding (1). If someone can guess this fact, he or she can compute it in a relatively short way.\n\nOne possible way is finding and applying the relation \\(A I^{2}=2 R\\left(h_{a}-2 r\\right)\\), where \\(h_{a}=A D\\) is the length of the altitude. Using this fact, one can see that triangles \\(A K I\\) and \\(A I D^{\\prime}\\) are similar (here \\(D^{\\prime}\\) is the point symmetrical to \\(D\\) about \\(T\\) ). Hence, \\(\\angle M I K=\\angle D D^{\\prime} I=\\angle I D D^{\\prime}\\). The proof can be finished as in Solution 1."}
{"id": "imo-shortlist-2007-g8", "question": "G8. Point \\(P\\) lies on side \\(A B\\) of a convex quadrilateral \\(A B C D\\). Let \\(\\omega\\) be the incircle of triangle \\(C P D\\), and let \\(I\\) be its incenter. Suppose that \\(\\omega\\) is tangent to the incircles of triangles \\(A P D\\) and \\(B P C\\) at points \\(K\\) and \\(L\\), respectively. Let lines \\(A C\\) and \\(B D\\) meet at \\(E\\), and let lines \\(A K\\) and \\(B L\\) meet at \\(F\\). Prove that points \\(E, I\\), and \\(F\\) are collinear.\n(Poland)", "category": "Geometry", "source": "IMO Shortlist", "year": 2007, "solution": "Let \\(\\Omega\\) be the circle tangent to segment \\(A B\\) and to rays \\(A D\\) and \\(B C\\); let \\(J\\) be its center. We prove that points \\(E\\) and \\(F\\) lie on line \\(I J\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-52}\n\nDenote the incircles of triangles \\(A D P\\) and \\(B C P\\) by \\(\\omega_{A}\\) and \\(\\omega_{B}\\). Let \\(h_{1}\\) be the homothety with a negative scale taking \\(\\omega\\) to \\(\\Omega\\). Consider this homothety as the composition of two homotheties: one taking \\(\\omega\\) to \\(\\omega_{A}\\) (with a negative scale and center \\(K\\) ), and another one taking \\(\\omega_{A}\\) to \\(\\Omega\\) (with a positive scale and center \\(A\\) ). It is known that in such a case the three centers of homothety are collinear (this theorem is also referred to as the theorem on the three similitude centers). Hence, the center of \\(h_{1}\\) lies on line \\(A K\\). Analogously, it also lies on \\(B L\\), so this center is \\(F\\). Hence, \\(F\\) lies on the line of centers of \\(\\omega\\) and \\(\\Omega\\), i. e. on \\(I J\\) (if \\(I=J\\), then \\(F=I\\) as well, and the claim is obvious).\n\nConsider quadrilateral \\(A P C D\\) and mark the equal segments of tangents to \\(\\omega\\) and \\(\\omega_{A}\\) (see the figure below to the left). Since circles \\(\\omega\\) and \\(\\omega_{A}\\) have a common point of tangency with \\(P D\\), one can easily see that \\(A D+P C=A P+C D\\). So, quadrilateral \\(A P C D\\) is circumscribed; analogously, circumscribed is also quadrilateral \\(B C D P\\). Let \\(\\Omega_{A}\\) and \\(\\Omega_{B}\\) respectively be their incircles.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_aef3a5182623580877e3g-52(1)}\n\nConsider the homothety \\(h_{2}\\) with a positive scale taking \\(\\omega\\) to \\(\\Omega\\). Consider \\(h_{2}\\) as the composition of two homotheties: taking \\(\\omega\\) to \\(\\Omega_{A}\\) (with a positive scale and center \\(C\\) ), and taking \\(\\Omega_{A}\\) to \\(\\Omega\\) (with a positive scale and center \\(A\\) ), respectively. So the center of \\(h_{2}\\) lies on line \\(A C\\). By analogous reasons, it lies also on \\(B D\\), hence this center is \\(E\\). Thus, \\(E\\) also lies on the line of centers \\(I J\\), and the claim is proved.\n\nComment. In both main steps of the solution, there can be several different reasonings for the same claims. For instance, one can mostly use Desargues' theorem instead of the three homotheties theorem. Namely, if \\(I_{A}\\) and \\(I_{B}\\) are the centers of \\(\\omega_{A}\\) and \\(\\omega_{B}\\), then lines \\(I_{A} I_{B}, K L\\) and \\(A B\\) are concurrent (by the theorem on three similitude centers applied to \\(\\omega, \\omega_{A}\\) and \\(\\omega_{B}\\) ). Then Desargues' theorem, applied to triangles \\(A I_{A} K\\) and \\(B I_{B} L\\), yields that the points \\(J=A I_{A} \\cap B I_{B}, I=I_{A} K \\cap I_{B} L\\) and \\(F=A K \\cap B L\\) are collinear.\n\nFor the second step, let \\(J_{A}\\) and \\(J_{B}\\) be the centers of \\(\\Omega_{A}\\) and \\(\\Omega_{B}\\). Then lines \\(J_{A} J_{B}, A B\\) and \\(C D\\) are concurrent, since they appear to be the two common tangents and the line of centers of \\(\\Omega_{A}\\) and \\(\\Omega_{B}\\). Applying Desargues' theorem to triangles \\(A J_{A} C\\) and \\(B J_{B} D\\), we obtain that the points \\(J=A J_{A} \\cap B J_{B}\\), \\(I=C J_{A} \\cap D J_{B}\\) and \\(E=A C \\cap B D\\) are collinear."}
{"id": "imo-shortlist-2007-n1", "question": "N1. Find all pairs \\((k, n)\\) of positive integers for which \\(7^{k}-3^{n}\\) divides \\(k^{4}+n^{2}\\).\n(Austria)\nAnswer. (2, 4).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2007, "solution": "Suppose that a pair \\((k, n)\\) satisfies the condition of the problem. Since \\(7^{k}-3^{n}\\) is even, \\(k^{4}+n^{2}\\) is also even, hence \\(k\\) and \\(n\\) have the same parity. If \\(k\\) and \\(n\\) are odd, then \\(k^{4}+n^{2} \\equiv 1+1=2(\\bmod 4)\\), while \\(7^{k}-3^{n} \\equiv 7-3 \\equiv 0(\\bmod 4)\\), so \\(k^{4}+n^{2}\\) cannot be divisible by \\(7^{k}-3^{n}\\). Hence, both \\(k\\) and \\(n\\) must be even.\n\nWrite \\(k=2 a, n=2 b\\). Then \\(7^{k}-3^{n}=7^{2 a}-3^{2 b}=\\frac{7^{a}-3^{b}}{2} \\cdot 2\\left(7^{a}+3^{b}\\right)\\), and both factors are integers. So \\(2\\left(7^{a}+3^{b}\\right) \\mid 7^{k}-3^{n}\\) and \\(7^{k}-3^{n} \\mid k^{4}+n^{2}=2\\left(8 a^{4}+2 b^{2}\\right)\\), hence\n\n\\[\n7^{a}+3^{b} \\leq 8 a^{4}+2 b^{2}\n\\]\n\nWe prove by induction that \\(8 a^{4}<7^{a}\\) for \\(a \\geq 4,2 b^{2}<3^{b}\\) for \\(b \\geq 1\\) and \\(2 b^{2}+9 \\leq 3^{b}\\) for \\(b \\geq 3\\). In the initial cases \\(a=4, b=1, b=2\\) and \\(b=3\\) we have \\(8 \\cdot 4^{4}=2048<7^{4}=2401,2<3\\), \\(2 \\cdot 2^{2}=8<3^{2}=9\\) and \\(2 \\cdot 3^{2}+9=3^{3}=27\\), respectively.\n\nIf \\(8 a^{4}<7^{a}(a \\geq 4)\\) and \\(2 b^{2}+9 \\leq 3^{b}(b \\geq 3)\\), then\n\n\\[\n\\begin{aligned}\n8(a+1)^{4} & =8 a^{4}\\left(\\frac{a+1}{a}\\right)^{4}<7^{a}\\left(\\frac{5}{4}\\right)^{4}=7^{a} \\frac{625}{256}<7^{a+1} \\quad \\text { and } \n2(b+1)^{2}+9 & <\\left(2 b^{2}+9\\right)\\left(\\frac{b+1}{b}\\right)^{2} \\leq 3^{b}\\left(\\frac{4}{3}\\right)^{2}=3^{b} \\frac{16}{9}<3^{b+1}\n\n\\]\n\nas desired.\nFor \\(a \\geq 4\\) we obtain \\(7^{a}+3^{b}>8 a^{4}+2 b^{2}\\) and inequality (1) cannot hold. Hence \\(a \\leq 3\\), and three cases are possible.\n\nCase 1: \\(a=1\\). Then \\(k=2\\) and \\(8+2 b^{2} \\geq 7+3^{b}\\), thus \\(2 b^{2}+1 \\geq 3^{b}\\). This is possible only if \\(b \\leq 2\\). If \\(b=1\\) then \\(n=2\\) and \\(\\frac{k^{4}+n^{2}}{7^{k}-3^{n}}=\\frac{2^{4}+2^{2}}{7^{2}-3^{2}}=\\frac{1}{2}\\), which is not an integer. If \\(b=2\\) then \\(n=4\\) and \\(\\frac{k^{4}+n^{2}}{7^{k}-3^{n}}=\\frac{2^{4}+4^{2}}{7^{2}-3^{4}}=-1\\), so \\((k, n)=(2,4)\\) is a solution.\n\nCase 2: \\(a=2\\). Then \\(k=4\\) and \\(k^{4}+n^{2}=256+4 b^{2} \\geq\\left|7^{4}-3^{n}\\right|=\\left|49-3^{b}\\right| \\cdot\\left(49+3^{b}\\right)\\). The smallest value of the first factor is 22 , attained at \\(b=3\\), so \\(128+2 b^{2} \\geq 11\\left(49+3^{b}\\right)\\), which is impossible since \\(3^{b}>2 b^{2}\\).\n\nCase 3: \\(a=3\\). Then \\(k=6\\) and \\(k^{4}+n^{2}=1296+4 b^{2} \\geq\\left|7^{6}-3^{n}\\right|=\\left|343-3^{b}\\right| \\cdot\\left(343+3^{b}\\right)\\). Analogously, \\(\\left|343-3^{b}\\right| \\geq 100\\) and we have \\(324+b^{2} \\geq 25\\left(343+3^{b}\\right)\\), which is impossible again.\n\nWe find that there exists a unique solution \\((k, n)=(2,4)\\)."}
{"id": "imo-shortlist-2007-n2", "question": "N2. Let \\(b, n>1\\) be integers. Suppose that for each \\(k>1\\) there exists an integer \\(a_{k}\\) such that \\(b-a_{k}^{n}\\) is divisible by \\(k\\). Prove that \\(b=A^{n}\\) for some integer \\(A\\).\n(Canada)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2007, "solution": "Let the prime factorization of \\(b\\) be \\(b=p_{1}^{\\alpha_{1}} \\ldots p_{s}^{\\alpha_{s}}\\), where \\(p_{1}, \\ldots, p_{s}\\) are distinct primes. Our goal is to show that all exponents \\(\\alpha_{i}\\) are divisible by \\(n\\), then we can set \\(A=p_{1}^{\\alpha_{1} / n} \\ldots p_{s}^{\\alpha_{s} / n}\\).\n\nApply the condition for \\(k=b^{2}\\). The number \\(b-a_{k}^{n}\\) is divisible by \\(b^{2}\\) and hence, for each \\(1 \\leq i \\leq s\\), it is divisible by \\(p_{i}^{2 \\alpha_{i}}>p_{i}^{\\alpha_{i}}\\) as well. Therefore\n\n\\[\na_{k}^{n} \\equiv b \\equiv 0 \\quad\\left(\\bmod p_{i}^{\\alpha_{i}}\\right)\n\\]\n\nand\n\n\\[\na_{k}^{n} \\equiv b \\not \\equiv 0 \\quad\\left(\\bmod p_{i}^{\\alpha_{i}+1}\\right)\n\\]\n\nwhich implies that the largest power of \\(p_{i}\\) dividing \\(a_{k}^{n}\\) is \\(p_{i}^{\\alpha_{i}}\\). Since \\(a_{k}^{n}\\) is a complete \\(n\\)th power, this implies that \\(\\alpha_{i}\\) is divisible by \\(n\\).\nComment. If \\(n=8\\) and \\(b=16\\), then for each prime \\(p\\) there exists an integer \\(a_{p}\\) such that \\(b-a_{p}^{n}\\) is divisible by \\(p\\). Actually, the congruency \\(x^{8}-16 \\equiv 0(\\bmod p)\\) expands as\n\n\\[\n\\left(x^{2}-2\\right)\\left(x^{2}+2\\right)\\left(x^{2}-2 x+2\\right)\\left(x^{2}+2 x+2\\right) \\equiv 0 \\quad(\\bmod p)\n\\]\n\nHence, if -1 is a quadratic residue modulo \\(p\\), then congruency \\(x^{2}+2 x+2=(x+1)^{2}+1 \\equiv 0\\) has a solution. Otherwise, one of congruencies \\(x^{2} \\equiv 2\\) and \\(x^{2} \\equiv-2\\) has a solution.\n\nThus, the solution cannot work using only prime values of \\(k\\)."}
{"id": "imo-shortlist-2007-n3", "question": "N3. Let \\(X\\) be a set of 10000 integers, none of them is divisible by 47. Prove that there exists a 2007-element subset \\(Y\\) of \\(X\\) such that \\(a-b+c-d+e\\) is not divisible by 47 for any \\(a, b, c, d, e \\in Y\\).\n(Netherlands)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2007, "solution": "Call a set \\(M\\) of integers good if \\(47 \\nmid a-b+c-d+e\\) for any \\(a, b, c, d, e \\in M\\).\nConsider the set \\(J=\\{-9,-7,-5,-3,-1,1,3,5,7,9\\}\\). We claim that \\(J\\) is good. Actually, for any \\(a, b, c, d, e \\in J\\) the number \\(a-b+c-d+e\\) is odd and\n\n\\[\n-45=(-9)-9+(-9)-9+(-9) \\leq a-b+c-d+e \\leq 9-(-9)+9-(-9)+9=45 .\n\\]\n\nBut there is no odd number divisible by 47 between -45 and 45 .\nFor any \\(k=1, \\ldots, 46\\) consider the set\n\n\\[\nA_{k}=\\{x \\in X \\mid \\exists j \\in J: \\quad k x \\equiv j(\\bmod 47)\\} .\n\\]\n\nIf \\(A_{k}\\) is not good, then \\(47 \\mid a-b+c-d+e\\) for some \\(a, b, c, d, e \\in A_{k}\\), hence \\(47 \\mid k a-k b+\\) \\(k c-k d+k e\\). But set \\(J\\) contains numbers with the same residues modulo 47, so \\(J\\) also is not good. This is a contradiction; therefore each \\(A_{k}\\) is a good subset of \\(X\\).\n\nThen it suffices to prove that there exists a number \\(k\\) such that \\(\\left|A_{k}\\right| \\geq 2007\\). Note that each \\(x \\in X\\) is contained in exactly 10 sets \\(A_{k}\\). Then\n\n\\[\n\\sum_{k=1}^{46}\\left|A_{k}\\right|=10|X|=100000\n\\]\n\nhence for some value of \\(k\\) we have\n\n\\[\n\\left|A_{k}\\right| \\geq \\frac{100000}{46}>2173>2007\n\\]\n\nThis completes the proof.\nComment. For the solution, it is essential to find a good set consisting of 10 different residues. Actually, consider a set \\(X\\) containing almost uniform distribution of the nonzero residues (i.e. each residue occurs 217 or 218 times). Let \\(Y \\subset X\\) be a good subset containing 2007 elements. Then the set \\(K\\) of all residues appearing in \\(Y\\) contains not less than 10 residues, and obviously this set is good.\n\nOn the other hand, there is no good set \\(K\\) consisting of 11 different residues. The CauchyDavenport theorem claims that for any sets \\(A, B\\) of residues modulo a prime \\(p\\),\n\n\\[\n|A+B| \\geq \\min \\{p,|A|+|B|-1\\}\n\\]\n\nHence, if \\(|K| \\geq 11\\), then \\(|K+K| \\geq 21,|K+K+K| \\geq 31>47-|K+K|\\), hence \\(\\mid K+K+K+\\) \\((-K)+(-K) \\mid=47\\), and \\(0 \\equiv a+c+e-b-d(\\bmod 47)\\) for some \\(a, b, c, d, e \\in K\\).\n\nFrom the same reasoning, one can see that a good set \\(K\\) containing 10 residues should satisfy equalities \\(|K+K|=19=2|K|-1\\) and \\(|K+K+K|=28=|K+K|+|K|-1\\). It can be proved that in this case set \\(K\\) consists of 10 residues forming an arithmetic progression. As an easy consequence, one obtains that set \\(K\\) has the form \\(a J\\) for some nonzero residue \\(a\\)."}
{"id": "imo-shortlist-2007-n4", "question": "N4. For every integer \\(k \\geq 2\\), prove that \\(2^{3 k}\\) divides the number\n\n\\[\n\\binom{2^{k+1}}{2^{k}}-\\binom{2^{k}}{2^{k-1}}\n\\]\n\nbut \\(2^{3 k+1}\\) does not.\n(Poland)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2007, "solution": "We use the notation \\((2 n-1)!!=1 \\cdot 3 \\cdots(2 n-1)\\) and \\((2 n)!!=2 \\cdot 4 \\cdots(2 n)=2^{n} n\\) ! for any positive integer \\(n\\). Observe that \\((2 n)!=(2 n)!!(2 n-1)!!=2^{n} n!(2 n-1)!!\\).\n\nFor any positive integer \\(n\\) we have\n\n\\[\n\\begin{aligned}\n& \\binom{4 n}{2 n}=\\frac{(4 n)!}{(2 n)!^{2}}=\\frac{2^{2 n}(2 n)!(4 n-1)!!}{(2 n)!^{2}}=\\frac{2^{2 n}}{(2 n)!}(4 n-1)!! \n& \\binom{2 n}{n}=\\frac{1}{(2 n)!}\\left(\\frac{(2 n)!}{n!}\\right)^{2}=\\frac{1}{(2 n)!}\\left(2^{n}(2 n-1)!!\\right)^{2}=\\frac{2^{2 n}}{(2 n)!}(2 n-1)!!^{2}\n\n\\]\n\nThen expression (1) can be rewritten as follows:\n\n\\[\n\\begin{aligned}\n\\binom{2^{k+1}}{2^{k}} & -\\binom{2^{k}}{2^{k-1}}=\\frac{2^{2^{k}}}{\\left(2^{k}\\right)!}\\left(2^{k+1}-1\\right)!!-\\frac{2^{2^{k}}}{\\left(2^{k}\\right)!}\\left(2^{k}-1\\right)!!^{2} \n& =\\frac{2^{2^{k}}\\left(2^{k}-1\\right)!!}{\\left(2^{k}\\right)!} \\cdot\\left(\\left(2^{k}+1\\right)\\left(2^{k}+3\\right) \\ldots\\left(2^{k}+2^{k}-1\\right)-\\left(2^{k}-1\\right)\\left(2^{k}-3\\right) \\ldots\\left(2^{k}-2^{k}+1\\right)\\right)\n\n\\]\n\nWe compute the exponent of 2 in the prime decomposition of each factor (the first one is a rational number but not necessarily an integer; it is not important).\n\nFirst, we show by induction on \\(n\\) that the exponent of 2 in ( \\(2^{n}\\) )! is \\(2^{n}-1\\). The base case \\(n=1\\) is trivial. Suppose that \\(\\left(2^{n}\\right)!=2^{2^{n}-1}(2 d+1)\\) for some integer \\(d\\). Then we have\n\n\\[\n\\left(2^{n+1}\\right)!=2^{2^{n}}\\left(2^{n}\\right)!\\left(2^{n+1}-1\\right)!!=2^{2^{n}} 2^{2^{n}-1} \\cdot(2 d+1)\\left(2^{n+1}-1\\right)!!=2^{2^{n+1}-1} \\cdot(2 q+1)\n\\]\n\nfor some integer \\(q\\). This finishes the induction step.\nHence, the exponent of 2 in the first factor in (2) is \\(2^{k}-\\left(2^{k}-1\\right)=1\\).\nThe second factor in (2) can be considered as the value of the polynomial\n\n\\[\nP(x)=(x+1)(x+3) \\ldots\\left(x+2^{k}-1\\right)-(x-1)(x-3) \\ldots\\left(x-2^{k}+1\\right) .\n\\]\n\nat \\(x=2^{k}\\). Now we collect some information about \\(P(x)\\).\nObserve that \\(P(-x)=-P(x)\\), since \\(k \\geq 2\\). So \\(P(x)\\) is an odd function, and it has nonzero coefficients only at odd powers of \\(x\\). Hence \\(P(x)=x^{3} Q(x)+c x\\), where \\(Q(x)\\) is a polynomial with integer coefficients.\n\nCompute the exponent of 2 in \\(c\\). We have\n\n\\[\n\\begin{aligned}\nc & =2\\left(2^{k}-1\\right)!!\\sum_{i=1}^{2^{k-1}} \\frac{1}{2 i-1}=\\left(2^{k}-1\\right)!!\\sum_{i=1}^{2^{k-1}}\\left(\\frac{1}{2 i-1}+\\frac{1}{2^{k}-2 i+1}\\right) \n& =\\left(2^{k}-1\\right)!!\\sum_{i=1}^{2^{k-1}} \\frac{2^{k}}{(2 i-1)\\left(2^{k}-2 i+1\\right)}=2^{k} \\sum_{i=1}^{2^{k-1}} \\frac{\\left(2^{k}-1\\right)!!}{(2 i-1)\\left(2^{k}-2 i+1\\right)}=2^{k} S\n\n\\]\n\nFor any integer \\(i=1, \\ldots, 2^{k-1}\\), denote by \\(a_{2 i-1}\\) the residue inverse to \\(2 i-1\\) modulo \\(2^{k}\\). Clearly, when \\(2 i-1\\) runs through all odd residues, so does \\(a_{2 i-1}\\), hence\n\n\\[\n\\begin{aligned}\nS=\\sum_{i=1}^{2^{k-1}} \\frac{\\left(2^{k}-1\\right)!!}{(2 i-1)\\left(2^{k}-2 i+1\\right)} & \\equiv-\\sum_{i=1}^{2^{k-1}} \\frac{\\left(2^{k}-1\\right)!!}{(2 i-1)^{2}} \\equiv-\\sum_{i=1}^{2^{k-1}}\\left(2^{k}-1\\right)!!a_{2 i-1}^{2} \n& =-\\left(2^{k}-1\\right)!!\\sum_{i=1}^{2^{k-1}}(2 i-1)^{2}=-\\left(2^{k}-1\\right)!!\\frac{2^{k-1}\\left(2^{2 k}-1\\right)}{3} \\quad\\left(\\bmod 2^{k}\\right)\n\n\\]\n\nTherefore, the exponent of 2 in \\(S\\) is \\(k-1\\), so \\(c=2^{k} S=2^{2 k-1}(2 t+1)\\) for some integer \\(t\\).\nFinally we obtain that\n\n\\[\nP\\left(2^{k}\\right)=2^{3 k} Q\\left(2^{k}\\right)+2^{k} c=2^{3 k} Q\\left(2^{k}\\right)+2^{3 k-1}(2 t+1)\n\\]\n\nwhich is divisible exactly by \\(2^{3 k-1}\\). Thus, the exponent of 2 in (2) is \\(1+(3 k-1)=3 k\\).\nComment. The fact that (1) is divisible by \\(2^{2 k}\\) is known; but it does not help in solving this problem."}
{"id": "imo-shortlist-2007-n5", "question": "N5. Find all surjective functions \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}\\) such that for every \\(m, n \\in \\mathbb{N}\\) and every prime \\(p\\), the number \\(f(m+n)\\) is divisible by \\(p\\) if and only if \\(f(m)+f(n)\\) is divisible by \\(p\\).\n( \\(\\mathbb{N}\\) is the set of all positive integers.)\n(Iran)\nAnswer. \\(f(n)=n\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2007, "solution": "Suppose that function \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}\\) satisfies the problem conditions.\nLemma. For any prime \\(p\\) and any \\(x, y \\in \\mathbb{N}\\), we have \\(x \\equiv y(\\bmod p)\\) if and only if \\(f(x) \\equiv f(y)\\) \\((\\bmod p)\\). Moreover, \\(p \\mid f(x)\\) if and only if \\(p \\mid x\\).\nProof. Consider an arbitrary prime \\(p\\). Since \\(f\\) is surjective, there exists some \\(x \\in \\mathbb{N}\\) such that \\(p \\mid f(x)\\). Let\n\n\\[\nd=\\min \\{x \\in \\mathbb{N}: p \\mid f(x)\\}\n\\]\n\nBy induction on \\(k\\), we obtain that \\(p \\mid f(k d)\\) for all \\(k \\in \\mathbb{N}\\). The base is true since \\(p \\mid f(d)\\). Moreover, if \\(p \\mid f(k d)\\) and \\(p \\mid f(d)\\) then, by the problem condition, \\(p \\mid f(k d+d)=f((k+1) d)\\) as required.\n\nSuppose that there exists an \\(x \\in \\mathbb{N}\\) such that \\(d \\nmid x\\) but \\(p \\mid f(x)\\). Let\n\n\\[\ny=\\min \\{x \\in \\mathbb{N}: d \\nmid x, p \\mid f(x)\\} .\n\\]\n\nBy the choice of \\(d\\), we have \\(y>d\\), and \\(y-d\\) is a positive integer not divisible by \\(d\\). Then \\(p \\nmid f(y-d)\\), while \\(p \\mid f(d)\\) and \\(p \\mid f(d+(y-d))=f(y)\\). This contradicts the problem condition. Hence, there is no such \\(x\\), and\n\n\\[\np|f(x) \\Longleftrightarrow d| x .\n\\]\n\nTake arbitrary \\(x, y \\in \\mathbb{N}\\) such that \\(x \\equiv y(\\bmod d)\\). We have \\(p \\mid f(x+(2 x d-x))=f(2 x d)\\); moreover, since \\(d \\mid 2 x d+(y-x)=y+(2 x d-x)\\), we get \\(p \\mid f(y+(2 x d-x))\\). Then by the problem condition \\(p|f(x)+f(2 x d-x), p| f(y)+f(2 x d-x)\\), and hence \\(f(x) \\equiv-f(2 x d-x) \\equiv f(y)\\) \\((\\bmod p)\\).\n\nOn the other hand, assume that \\(f(x) \\equiv f(y)(\\bmod p)\\). Again we have \\(p \\mid f(x)+f(2 x d-x)\\) which by our assumption implies that \\(p \\mid f(x)+f(2 x d-x)+(f(y)-f(x))=f(y)+f(2 x d-x)\\). Hence by the problem condition \\(p \\mid f(y+(2 x d-x))\\). Using (1) we get \\(0 \\equiv y+(2 x d-x) \\equiv y-x\\) \\((\\bmod d)\\).\n\nThus, we have proved that\n\n\\[\nx \\equiv y \\quad(\\bmod d) \\Longleftrightarrow f(x) \\equiv f(y) \\quad(\\bmod p)\n\\]\n\nWe are left to show that \\(p=d\\) : in this case (1) and (2) provide the desired statements.\nThe numbers \\(1,2, \\ldots, d\\) have distinct residues modulo \\(d\\). By (2), numbers \\(f(1), f(2), \\ldots\\), \\(f(d)\\) have distinct residues modulo \\(p\\); hence there are at least \\(d\\) distinct residues, and \\(p \\geq d\\). On the other hand, by the surjectivity of \\(f\\), there exist \\(x_{1}, \\ldots, x_{p} \\in \\mathbb{N}\\) such that \\(f\\left(x_{i}\\right)=i\\) for any \\(i=1,2, \\ldots, p\\). By (2), all these \\(x_{i}\\) 's have distinct residues modulo \\(d\\). For the same reasons, \\(d \\geq p\\). Hence, \\(d=p\\).\n\nNow we prove that \\(f(n)=n\\) by induction on \\(n\\). If \\(n=1\\) then, by the Lemma, \\(p \\nmid f(1)\\) for any prime \\(p\\), so \\(f(1)=1\\), and the base is established. Suppose that \\(n>1\\) and denote \\(k=f(n)\\). Note that there exists a prime \\(q \\mid n\\), so by the Lemma \\(q \\mid k\\) and \\(k>1\\).\n\nIf \\(k>n\\) then \\(k-n+1>1\\), and there exists a prime \\(p \\mid k-n+1\\); we have \\(k \\equiv n-1\\) \\((\\bmod p)\\). By the induction hypothesis we have \\(f(n-1)=n-1 \\equiv k=f(n)(\\bmod p)\\). Now, by the Lemma we obtain \\(n-1 \\equiv n(\\bmod p)\\) which cannot be true.\n\nAnalogously, if \\(k<n\\), then \\(f(k-1)=k-1\\) by induction hypothesis. Moreover, \\(n-k+1>1\\), so there exists a prime \\(p \\mid n-k+1\\) and \\(n \\equiv k-1(\\bmod p)\\). By the Lemma again, \\(k=f(n) \\equiv\\) \\(f(k-1)=k-1(\\bmod p)\\), which is also false. The only remaining case is \\(k=n\\), so \\(f(n)=n\\).\n\nFinally, the function \\(f(n)=n\\) obviously satisfies the condition."}
{"id": "imo-shortlist-2007-n6", "question": "N6. Let \\(k\\) be a positive integer. Prove that the number \\(\\left(4 k^{2}-1\\right)^{2}\\) has a positive divisor of the form \\(8 k n-1\\) if and only if \\(k\\) is even.\n(United Kingdom)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2007, "solution": "The statement follows from the following fact.\nLemma. For arbitrary positive integers \\(x\\) and \\(y\\), the number \\(4 x y-1\\) divides \\(\\left(4 x^{2}-1\\right)^{2}\\) if and only if \\(x=y\\).\nProof. If \\(x=y\\) then \\(4 x y-1=4 x^{2}-1\\) obviously divides \\(\\left(4 x^{2}-1\\right)^{2}\\) so it is sufficient to consider the opposite direction.\n\nCall a pair \\((x, y)\\) of positive integers bad if \\(4 x y-1\\) divides \\(\\left(4 x^{2}-1\\right)^{2}\\) but \\(x \\neq y\\). In order to prove that bad pairs do not exist, we present two properties of them which provide an infinite descent.\nProperty (i). If ( \\(x, y\\) ) is a bad pair and \\(x<y\\) then there exists a positive integer \\(z<x\\) such that \\((x, z)\\) is also bad.\nLet \\(r=\\frac{\\left(4 x^{2}-1\\right)^{2}}{4 x y-1}\\). Then\n\n\\[\nr=-r \\cdot(-1) \\equiv-r(4 x y-1)=-\\left(4 x^{2}-1\\right)^{2} \\equiv-1 \\quad(\\bmod 4 x)\n\\]\n\nand \\(r=4 x z-1\\) with some positive integer \\(z\\). From \\(x<y\\) we obtain that\n\n\\[\n4 x z-1=\\frac{\\left(4 x^{2}-1\\right)^{2}}{4 x y-1}<4 x^{2}-1\n\\]\n\nand therefore \\(z<x\\). By the construction, the number \\(4 x z-1\\) is a divisor of \\(\\left(4 x^{2}-1\\right)^{2}\\) so \\((x, z)\\) is a bad pair.\nProperty (ii). If ( \\(x, y\\) ) is a bad pair then ( \\(y, x\\) ) is also bad.\nSince \\(1=1^{2} \\equiv(4 x y)^{2}(\\bmod 4 x y-1)\\), we have\n\n\\[\n\\left(4 y^{2}-1\\right)^{2} \\equiv\\left(4 y^{2}-(4 x y)^{2}\\right)^{2}=16 y^{4}\\left(4 x^{2}-1\\right)^{2} \\equiv 0 \\quad(\\bmod 4 x y-1)\n\\]\n\nHence, the number \\(4 x y-1\\) divides \\(\\left(4 y^{2}-1\\right)^{2}\\) as well.\nNow suppose that there exists at least one bad pair. Take a bad pair \\((x, y)\\) such that \\(2 x+y\\) attains its smallest possible value. If \\(x<y\\) then property (i) provides a bad pair ( \\(x, z\\) ) with \\(z<y\\) and thus \\(2 x+z<2 x+y\\). Otherwise, if \\(y<x\\), property (ii) yields that pair ( \\(y, x\\) ) is also bad while \\(2 y+x<2 x+y\\). Both cases contradict the assumption that \\(2 x+y\\) is minimal; the Lemma is proved.\n\nTo prove the problem statement, apply the Lemma for \\(x=k\\) and \\(y=2 n\\); the number \\(8 k n-1\\) divides \\(\\left(4 k^{2}-1\\right)^{2}\\) if and only if \\(k=2 n\\). Hence, there is no such \\(n\\) if \\(k\\) is odd and \\(n=k / 2\\) is the only solution if \\(k\\) is even.\nComment. The constant 4 in the Lemma can be replaced with an arbitrary integer greater than 1 : if \\(a>1\\) and \\(a x y-1\\) divides \\(\\left(a x^{2}-1\\right)^{2}\\) then \\(x=y\\)."}
{"id": "imo-shortlist-2007-n7", "question": "N7. For a prime \\(p\\) and a positive integer \\(n\\), denote by \\(\\nu_{p}(n)\\) the exponent of \\(p\\) in the prime factorization of \\(n!\\). Given a positive integer \\(d\\) and a finite set \\(\\left\\{p_{1}, \\ldots, p_{k}\\right\\}\\) of primes. Show that there are infinitely many positive integers \\(n\\) such that \\(d \\mid \\nu_{p_{i}}(n)\\) for all \\(1 \\leq i \\leq k\\).\n(India)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2007, "solution": "For arbitrary prime \\(p\\) and positive integer \\(n\\), denote by \\(\\operatorname{ord}_{p}(n)\\) the exponent of \\(p\\) in \\(n\\). Thus,\n\n\\[\n\\nu_{p}(n)=\\operatorname{ord}_{p}(n!)=\\sum_{i=1}^{n} \\operatorname{ord}_{p}(i)\n\\]\n\nLemma. Let \\(p\\) be a prime number, \\(q\\) be a positive integer, \\(k\\) and \\(r\\) be positive integers such that \\(p^{k}>r\\). Then \\(\\nu_{p}\\left(q p^{k}+r\\right)=\\nu_{p}\\left(q p^{k}\\right)+\\nu_{p}(r)\\).\nProof. We claim that \\(\\operatorname{ord}_{p}\\left(q p^{k}+i\\right)=\\operatorname{ord}_{p}(i)\\) for all \\(0<i<p^{k}\\). Actually, if \\(d=\\operatorname{ord}_{p}(i)\\) then \\(d<k\\), so \\(q p^{k}+i\\) is divisible by \\(p^{d}\\), but only the first term is divisible by \\(p^{d+1}\\); hence the sum is not.\n\nUsing this claim, we obtain\n\n\\[\n\\nu_{p}\\left(q p^{k}+r\\right)=\\sum_{i=1}^{q p^{k}} \\operatorname{ord}_{p}(i)+\\sum_{i=q p^{k}+1}^{q p^{k}+r} \\operatorname{ord}_{p}(i)=\\sum_{i=1}^{q p^{k}} \\operatorname{ord}_{p}(i)+\\sum_{i=1}^{r} \\operatorname{ord}_{p}(i)=\\nu_{p}\\left(q p^{k}\\right)+\\nu_{p}(r)\n\\]\n\nFor any integer \\(a\\), denote by \\(\\bar{a}\\) its residue modulo \\(d\\). The addition of residues will also be performed modulo \\(d\\), i. e. \\(\\bar{a}+\\bar{b}=\\overline{a+b}\\). For any positive integer \\(n\\), let \\(f(n)=\\left(f_{1}(n), \\ldots, f_{k}(n)\\right)\\), where \\(f_{i}(n)=\\overline{\\nu_{p_{i}}(n)}\\).\n\nDefine the sequence \\(n_{1}=1, n_{\\ell+1}=\\left(p_{1} p_{2} \\ldots p_{k}\\right)^{n_{\\ell}}\\). We claim that\n\n\\[\nf\\left(n_{\\ell_{1}}+n_{\\ell_{2}}+\\ldots+n_{\\ell_{m}}\\right)=f\\left(n_{\\ell_{1}}\\right)+f\\left(n_{\\ell_{2}}\\right)+\\ldots+f\\left(n_{\\ell_{m}}\\right)\n\\]\n\nfor any \\(\\ell_{1}<\\ell_{2}<\\ldots<\\ell_{m}\\). (The addition of \\(k\\)-tuples is componentwise.) The base case \\(m=1\\) is trivial.\n\nSuppose that \\(m>1\\). By the construction of the sequence, \\(p_{i}^{n_{\\ell_{1}}}\\) divides \\(n_{\\ell_{2}}+\\ldots+n_{\\ell_{m}}\\); clearly, \\(p_{i}^{n_{\\ell_{1}}}>n_{\\ell_{1}}\\) for all \\(1 \\leq i \\leq k\\). Therefore the Lemma can be applied for \\(p=p_{i}, k=r=n_{\\ell_{1}}\\) and \\(q p^{k}=n_{\\ell_{2}}+\\ldots+n_{\\ell_{m}}\\) to obtain\n\n\\[\nf_{i}\\left(n_{\\ell_{1}}+n_{\\ell_{2}}+\\ldots+n_{\\ell_{m}}\\right)=f_{i}\\left(n_{\\ell_{1}}\\right)+f_{i}\\left(n_{\\ell_{2}}+\\ldots+n_{\\ell_{m}}\\right) \\quad \\text { for all } 1 \\leq i \\leq k,\n\\]\n\nand hence\n\n\\[\nf\\left(n_{\\ell_{1}}+n_{\\ell_{2}}+\\ldots+n_{\\ell_{m}}\\right)=f\\left(n_{\\ell_{1}}\\right)+f\\left(n_{\\ell_{2}}+\\ldots+n_{\\ell_{m}}\\right)=f\\left(n_{\\ell_{1}}\\right)+f\\left(n_{\\ell_{2}}\\right)+\\ldots+f\\left(n_{\\ell_{m}}\\right)\n\\]\n\nby the induction hypothesis.\nNow consider the values \\(f\\left(n_{1}\\right), f\\left(n_{2}\\right), \\ldots\\). There exist finitely many possible values of \\(f\\). Hence, there exists an infinite sequence of indices \\(\\ell_{1}<\\ell_{2}<\\ldots\\) such that \\(f\\left(n_{\\ell_{1}}\\right)=f\\left(n_{\\ell_{2}}\\right)=\\ldots\\). and thus\n\n\\[\nf\\left(n_{\\ell_{m+1}}+n_{\\ell_{m+2}}+\\ldots+n_{\\ell_{m+d}}\\right)=f\\left(n_{\\ell_{m+1}}\\right)+\\ldots+f\\left(n_{\\ell_{m+d}}\\right)=d \\cdot f\\left(n_{\\ell_{1}}\\right)=(\\overline{0}, \\ldots, \\overline{0})\n\\]\n\nfor all \\(m\\). We have found infinitely many suitable numbers.\n\nSolution 2. We use the same Lemma and definition of the function \\(f\\).\nLet \\(S=\\{f(n): n \\in \\mathbb{N}\\}\\). Obviously, set \\(S\\) is finite. For every \\(s \\in S\\) choose the minimal \\(n_{s}\\) such that \\(f\\left(n_{s}\\right)=s\\). Denote \\(N=\\max _{s \\in S} n_{s}\\). Moreover, let \\(g\\) be an integer such that \\(p_{i}^{g}>N\\) for each \\(i=1,2, \\ldots, k\\). Let \\(P=\\left(p_{1} p_{2} \\ldots p_{k}\\right)^{g}\\).\n\nWe claim that\n\n\\[\n\\{f(n) \\mid n \\in[m P, m P+N]\\}=S\n\\]\n\nfor every positive integer \\(m\\). In particular, since \\((\\overline{0}, \\ldots, \\overline{0})=f(1) \\in S\\), it follows that for an arbitrary \\(m\\) there exists \\(n \\in[m P, m P+N]\\) such that \\(f(n)=(\\overline{0}, \\ldots, \\overline{0})\\). So there are infinitely many suitable numbers.\n\nTo prove (1), let \\(a_{i}=f_{i}(m P)\\). Consider all numbers of the form \\(n_{m, s}=m P+n_{s}\\) with \\(s=\\left(s_{1}, \\ldots, s_{k}\\right) \\in S\\) (clearly, all \\(n_{m, s}\\) belong to \\([m P, m P+N]\\) ). Since \\(n_{s} \\leq N<p_{i}^{g}\\) and \\(p_{i}^{g} \\mid m P\\), we can apply the Lemma for the values \\(p=p_{i}, r=n_{s}, k=g, q p^{k}=m P\\) to obtain\n\n\\[\nf_{i}\\left(n_{m, s}\\right)=f_{i}(m P)+f_{i}\\left(n_{s}\\right)=a_{i}+s_{i}\n\\]\n\nhence for distinct \\(s, t \\in S\\) we have \\(f\\left(n_{m, s}\\right) \\neq f\\left(n_{m, t}\\right)\\).\nThus, the function \\(f\\) attains at least \\(|S|\\) distinct values in \\([m P, m P+N]\\). Since all these values belong to \\(S, f\\) should attain all possible values in \\([m P, m P+N]\\).\nComment. Both solutions can be extended to prove the following statements.\nClaim 1. For any \\(K\\) there exist infinitely many \\(n\\) divisible by \\(K\\), such that \\(d \\mid \\nu_{p_{i}}(n)\\) for each \\(i\\).\nClaim 2. For any \\(s \\in S\\), there exist infinitely many \\(n \\in \\mathbb{N}\\) such that \\(f(n)=s\\)."}
{"id": "imo-shortlist-2010-a1", "question": "A1. Determine all functions \\(f: \\mathbb{R} \\rightarrow \\mathbb{R}\\) such that the equality\n\n\\[\nf([x] y)=f(x)[f(y)]\n\\]\n\nholds for all \\(x, y \\in \\mathbb{R}\\). Here, by \\([x]\\) we denote the greatest integer not exceeding \\(x\\).\n(France)\nAnswer. \\(f(x)=\\) const \\(=C\\), where \\(C=0\\) or \\(1 \\leq C<2\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2010, "solution": "First, setting \\(x=0\\) in (1) we get\n\n\\[\nf(0)=f(0)[f(y)]\n\\]\n\nfor all \\(y \\in \\mathbb{R}\\). Now, two cases are possible.\nCase 1. Assume that \\(f(0) \\neq 0\\). Then from (2) we conclude that \\([f(y)]=1\\) for all \\(y \\in \\mathbb{R}\\). Therefore, equation (1) becomes \\(f([x] y)=f(x)\\), and substituting \\(y=0\\) we have \\(f(x)=f(0)=C \\neq 0\\). Finally, from \\([f(y)]=1=[C]\\) we obtain that \\(1 \\leq C<2\\).\n\nCase 2. Now we have \\(f(0)=0\\). Here we consider two subcases.\nSubcase 2a. Suppose that there exists \\(0<\\alpha<1\\) such that \\(f(\\alpha) \\neq 0\\). Then setting \\(x=\\alpha\\) in (1) we obtain \\(0=f(0)=f(\\alpha)[f(y)]\\) for all \\(y \\in \\mathbb{R}\\). Hence, \\([f(y)]=0\\) for all \\(y \\in \\mathbb{R}\\). Finally, substituting \\(x=1\\) in (1) provides \\(f(y)=0\\) for all \\(y \\in \\mathbb{R}\\), thus contradicting the condition \\(f(\\alpha) \\neq 0\\).\n\nSubcase 2b. Conversely, we have \\(f(\\alpha)=0\\) for all \\(0 \\leq \\alpha<1\\). Consider any real \\(z\\); there exists an integer \\(N\\) such that \\(\\alpha=\\frac{z}{N} \\in[0,1)\\) (one may set \\(N=[z]+1\\) if \\(z \\geq 0\\) and \\(N=[z]-1\\) otherwise). Now, from (1) we get \\(f(z)=f([N] \\alpha)=f(N)[f(\\alpha)]=0\\) for all \\(z \\in \\mathbb{R}\\).\n\nFinally, a straightforward check shows that all the obtained functions satisfy (1).\nSolution 2. Assume that \\([f(y)]=0\\) for some \\(y\\); then the substitution \\(x=1\\) provides \\(f(y)=f(1)[f(y)]=0\\). Hence, if \\([f(y)]=0\\) for all \\(y\\), then \\(f(y)=0\\) for all \\(y\\). This function obviously satisfies the problem conditions.\n\nSo we are left to consider the case when \\([f(a)] \\neq 0\\) for some \\(a\\). Then we have\n\n\\[\nf([x] a)=f(x)[f(a)], \\quad \\text { or } \\quad f(x)=\\frac{f([x] a)}{[f(a)]}\n\\]\n\nThis means that \\(f\\left(x_{1}\\right)=f\\left(x_{2}\\right)\\) whenever \\(\\left[x_{1}\\right]=\\left[x_{2}\\right]\\), hence \\(f(x)=f([x])\\), and we may assume that \\(a\\) is an integer.\n\nNow we have\n\n\\[\nf(a)=f\\left(2 a \\cdot \\frac{1}{2}\\right)=f(2 a)\\left[f\\left(\\frac{1}{2}\\right)\\right]=f(2 a)[f(0)]\n\\]\n\nthis implies \\([f(0)] \\neq 0\\), so we may even assume that \\(a=0\\). Therefore equation (3) provides\n\n\\[\nf(x)=\\frac{f(0)}{[f(0)]}=C \\neq 0\n\\]\n\nfor each \\(x\\). Now, condition (1) becomes equivalent to the equation \\(C=C[C]\\) which holds exactly when \\([C]=1\\)."}
{"id": "imo-shortlist-2010-a2", "question": "A2. Let the real numbers \\(a, b, c, d\\) satisfy the relations \\(a+b+c+d=6\\) and \\(a^{2}+b^{2}+c^{2}+d^{2}=12\\). Prove that\n\n\\[\n36 \\leq 4\\left(a^{3}+b^{3}+c^{3}+d^{3}\\right)-\\left(a^{4}+b^{4}+c^{4}+d^{4}\\right) \\leq 48\n\\]", "category": "Algebra", "source": "IMO Shortlist", "year": 2010, "solution": "Observe that\n\n\\[\n\\begin{gathered}\n4\\left(a^{3}+b^{3}+c^{3}+d^{3}\\right)-\\left(a^{4}+b^{4}+c^{4}+d^{4}\\right)=-\\left((a-1)^{4}+(b-1)^{4}+(c-1)^{4}+(d-1)^{4}\\right) \n+6\\left(a^{2}+b^{2}+c^{2}+d^{2}\\right)-4(a+b+c+d)+4 \n=-\\left((a-1)^{4}+(b-1)^{4}+(c-1)^{4}+(d-1)^{4}\\right)+52\n\n\\]\n\nNow, introducing \\(x=a-1, y=b-1, z=c-1, t=d-1\\), we need to prove the inequalities\n\n\\[\n16 \\geq x^{4}+y^{4}+z^{4}+t^{4} \\geq 4\n\\]\n\nunder the constraint\n\n\\[\nx^{2}+y^{2}+z^{2}+t^{2}=\\left(a^{2}+b^{2}+c^{2}+d^{2}\\right)-2(a+b+c+d)+4=4\n\\]\n\n(we will not use the value of \\(x+y+z+t\\) though it can be found).\nNow the rightmost inequality in (1) follows from the power mean inequality:\n\n\\[\nx^{4}+y^{4}+z^{4}+t^{4} \\geq \\frac{\\left(x^{2}+y^{2}+z^{2}+t^{2}\\right)^{2}}{4}=4\n\\]\n\nFor the other one, expanding the brackets we note that\n\n\\[\n\\left(x^{2}+y^{2}+z^{2}+t^{2}\\right)^{2}=\\left(x^{4}+y^{4}+z^{4}+t^{4}\\right)+q\n\\]\n\nwhere \\(q\\) is a nonnegative number, so\n\n\\[\nx^{4}+y^{4}+z^{4}+t^{4} \\leq\\left(x^{2}+y^{2}+z^{2}+t^{2}\\right)^{2}=16\n\\]\n\nand we are done.\nComment 1. The estimates are sharp; the lower and upper bounds are attained at ( \\(3,1,1,1\\) ) and \\((0,2,2,2)\\), respectively.\n\nComment 2. After the change of variables, one can finish the solution in several different ways. The latter estimate, for instance, it can be performed by moving the variables - since we need only the second of the two shifted conditions.\n\nSolution 2. First, we claim that \\(0 \\leq a, b, c, d \\leq 3\\). Actually, we have\n\n\\[\na+b+c=6-d, \\quad a^{2}+b^{2}+c^{2}=12-d^{2}\n\\]\n\nhence the power mean inequality\n\n\\[\na^{2}+b^{2}+c^{2} \\geq \\frac{(a+b+c)^{2}}{3}\n\\]\n\nrewrites as\n\n\\[\n12-d^{2} \\geq \\frac{(6-d)^{2}}{3} \\quad \\Longleftrightarrow \\quad 2 d(d-3) \\leq 0\n\\]\n\nwhich implies the desired inequalities for \\(d\\); since the conditions are symmetric, we also have the same estimate for the other variables.\n\nNow, to prove the rightmost inequality, we use the obvious inequality \\(x^{2}(x-2)^{2} \\geq 0\\) for each real \\(x\\); this inequality rewrites as \\(4 x^{3}-x^{4} \\leq 4 x^{2}\\). It follows that\n\n\\[\n\\left(4 a^{3}-a^{4}\\right)+\\left(4 b^{3}-b^{4}\\right)+\\left(4 c^{3}-c^{4}\\right)+\\left(4 d^{3}-d^{4}\\right) \\leq 4\\left(a^{2}+b^{2}+c^{2}+d^{2}\\right)=48\n\\]\n\nas desired.\nNow we prove the leftmost inequality in an analogous way. For each \\(x \\in[0,3]\\), we have \\((x+1)(x-1)^{2}(x-3) \\leq 0\\) which is equivalent to \\(4 x^{3}-x^{4} \\geq 2 x^{2}+4 x-3\\). This implies that \\(\\left(4 a^{3}-a^{4}\\right)+\\left(4 b^{3}-b^{4}\\right)+\\left(4 c^{3}-c^{4}\\right)+\\left(4 d^{3}-d^{4}\\right) \\geq 2\\left(a^{2}+b^{2}+c^{2}+d^{2}\\right)+4(a+b+c+d)-12=36\\), as desired.\n\nComment. It is easy to guess the extremal points ( \\(0,2,2,2\\) ) and ( \\(3,1,1,1\\) ) for this inequality. This provides a method of finding the polynomials used in Solution 2. Namely, these polynomials should have the form \\(x^{4}-4 x^{3}+a x^{2}+b x+c\\); moreover, the former polynomial should have roots at 2 (with an even multiplicity) and 0 , while the latter should have roots at 1 (with an even multiplicity) and 3 . These conditions determine the polynomials uniquely.\n\nSolution 3. First, expanding \\(48=4\\left(a^{2}+b^{2}+c^{2}+d^{2}\\right)\\) and applying the AM-GM inequality, we have\n\n\\[\n\\begin{aligned}\na^{4}+b^{4}+c^{4}+d^{4}+48 & =\\left(a^{4}+4 a^{2}\\right)+\\left(b^{4}+4 b^{2}\\right)+\\left(c^{4}+4 c^{2}\\right)+\\left(d^{4}+4 d^{2}\\right) \n& \\geq 2\\left(\\sqrt{a^{4} \\cdot 4 a^{2}}+\\sqrt{b^{4} \\cdot 4 b^{2}}+\\sqrt{c^{4} \\cdot 4 c^{2}}+\\sqrt{d^{4} \\cdot 4 d^{2}}\\right) \n& =4\\left(\\left|a^{3}\\right|+\\left|b^{3}\\right|+\\left|c^{3}\\right|+\\left|d^{3}\\right|\\right) \\geq 4\\left(a^{3}+b^{3}+c^{3}+d^{3}\\right),\n\n\\]\n\nwhich establishes the rightmost inequality.\nTo prove the leftmost inequality, we first show that \\(a, b, c, d \\in[0,3]\\) as in the previous solution. Moreover, we can assume that \\(0 \\leq a \\leq b \\leq c \\leq d\\). Then we have \\(a+b \\leq b+c \\leq\\) \\(\\frac{2}{3}(b+c+d) \\leq \\frac{2}{3} \\cdot 6=4\\).\n\nNext, we show that \\(4 b-b^{2} \\leq 4 c-c^{2}\\). Actually, this inequality rewrites as \\((c-b)(b+c-4) \\leq 0\\), which follows from the previous estimate. The inequality \\(4 a-a^{2} \\leq 4 b-b^{2}\\) can be proved analogously.\n\nFurther, the inequalities \\(a \\leq b \\leq c\\) together with \\(4 a-a^{2} \\leq 4 b-b^{2} \\leq 4 c-c^{2}\\) allow us to apply the Chebyshev inequality obtaining\n\n\\[\n\\begin{aligned}\na^{2}\\left(4 a-a^{2}\\right)+b^{2}\\left(4 b-b^{2}\\right)+c^{2}\\left(4 c-c^{2}\\right) & \\geq \\frac{1}{3}\\left(a^{2}+b^{2}+c^{2}\\right)\\left(4(a+b+c)-\\left(a^{2}+b^{2}+c^{2}\\right)\\right) \n& =\\frac{\\left(12-d^{2}\\right)\\left(4(6-d)-\\left(12-d^{2}\\right)\\right)}{3}\n\n\\]\n\nThis implies that\n\n\\[\n\\begin{aligned}\n\\left(4 a^{3}-a^{4}\\right) & +\\left(4 b^{3}-b^{4}\\right)+\\left(4 c^{3}-c^{4}\\right)+\\left(4 d^{3}-d^{4}\\right) \\geq \\frac{\\left(12-d^{2}\\right)\\left(d^{2}-4 d+12\\right)}{3}+4 d^{3}-d^{4} \n& =\\frac{144-48 d+16 d^{3}-4 d^{4}}{3}=36+\\frac{4}{3}(3-d)(d-1)\\left(d^{2}-3\\right)\n\n\\]\n\nFinally, we have \\(d^{2} \\geq \\frac{1}{4}\\left(a^{2}+b^{2}+c^{2}+d^{2}\\right)=3\\) (which implies \\(d>1\\) ); so, the expression \\(\\frac{4}{3}(3-d)(d-1)\\left(d^{2}-3\\right)\\) in the right-hand part of (2) is nonnegative, and the desired inequality is proved.\nComment. The rightmost inequality is easier than the leftmost one. In particular, Solutions 2 and 3 show that only the condition \\(a^{2}+b^{2}+c^{2}+d^{2}=12\\) is needed for the former one."}
{"id": "imo-shortlist-2010-a3", "question": "A3. Let \\(x_{1}, \\ldots, x_{100}\\) be nonnegative real numbers such that \\(x_{i}+x_{i+1}+x_{i+2} \\leq 1\\) for all \\(i=1, \\ldots, 100\\) (we put \\(x_{101}=x_{1}, x_{102}=x_{2}\\) ). Find the maximal possible value of the sum\n\n\\[\nS=\\sum_{i=1}^{100} x_{i} x_{i+2}\n\\]\n\n(Russia)\nAnswer. \\(\\frac{25}{2}\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2010, "solution": "Let \\(x_{2 i}=0, x_{2 i-1}=\\frac{1}{2}\\) for all \\(i=1, \\ldots, 50\\). Then we have \\(S=50 \\cdot\\left(\\frac{1}{2}\\right)^{2}=\\frac{25}{2}\\). So, we are left to show that \\(S \\leq \\frac{25}{2}\\) for all values of \\(x_{i}\\) 's satisfying the problem conditions.\n\nConsider any \\(1 \\leq i \\leq 50\\). By the problem condition, we get \\(x_{2 i-1} \\leq 1-x_{2 i}-x_{2 i+1}\\) and \\(x_{2 i+2} \\leq 1-x_{2 i}-x_{2 i+1}\\). Hence by the AM-GM inequality we get\n\n\\[\n\\begin{aligned}\nx_{2 i-1} x_{2 i+1} & +x_{2 i} x_{2 i+2} \\leq\\left(1-x_{2 i}-x_{2 i+1}\\right) x_{2 i+1}+x_{2 i}\\left(1-x_{2 i}-x_{2 i+1}\\right) \n& =\\left(x_{2 i}+x_{2 i+1}\\right)\\left(1-x_{2 i}-x_{2 i+1}\\right) \\leq\\left(\\frac{\\left(x_{2 i}+x_{2 i+1}\\right)+\\left(1-x_{2 i}-x_{2 i+1}\\right)}{2}\\right)^{2}=\\frac{1}{4}\n\n\\]\n\nSumming up these inequalities for \\(i=1,2, \\ldots, 50\\), we get the desired inequality\n\n\\[\n\\sum_{i=1}^{50}\\left(x_{2 i-1} x_{2 i+1}+x_{2 i} x_{2 i+2}\\right) \\leq 50 \\cdot \\frac{1}{4}=\\frac{25}{2} .\n\\]\n\nComment. This solution shows that a bit more general fact holds. Namely, consider \\(2 n\\) nonnegative numbers \\(x_{1}, \\ldots, x_{2 n}\\) in a row (with no cyclic notation) and suppose that \\(x_{i}+x_{i+1}+x_{i+2} \\leq 1\\) for all \\(i=1,2, \\ldots, 2 n-2\\). Then \\(\\sum_{i=1}^{2 n-2} x_{i} x_{i+2} \\leq \\frac{n-1}{4}\\).\n\nThe proof is the same as above, though if might be easier to find it (for instance, applying induction). The original estimate can be obtained from this version by considering the sequence \\(x_{1}, x_{2}, \\ldots, x_{100}, x_{1}, x_{2}\\).\n\nSolution 2. We present another proof of the estimate. From the problem condition, we get\n\n\\[\n\\begin{aligned}\nS=\\sum_{i=1}^{100} x_{i} x_{i+2} \\leq \\sum_{i=1}^{100} x_{i}\\left(1-x_{i}-x_{i+1}\\right) & =\\sum_{i=1}^{100} x_{i}-\\sum_{i=1}^{100} x_{i}^{2}-\\sum_{i=1}^{100} x_{i} x_{i+1} \n& =\\sum_{i=1}^{100} x_{i}-\\frac{1}{2} \\sum_{i=1}^{100}\\left(x_{i}+x_{i+1}\\right)^{2}\n\n\\]\n\nBy the AM-QM inequality, we have \\(\\sum\\left(x_{i}+x_{i+1}\\right)^{2} \\geq \\frac{1}{100}\\left(\\sum\\left(x_{i}+x_{i+1}\\right)\\right)^{2}\\), so\n\n\\[\n\\begin{aligned}\nS \\leq \\sum_{i=1}^{100} x_{i}-\\frac{1}{200}\\left(\\sum_{i=1}^{100}\\left(x_{i}+x_{i+1}\\right)\\right)^{2} & =\\sum_{i=1}^{100} x_{i}-\\frac{2}{100}\\left(\\sum_{i=1}^{100} x_{i}\\right)^{2} \n& =\\frac{2}{100}\\left(\\sum_{i=1}^{100} x_{i}\\right)\\left(\\frac{100}{2}-\\sum_{i=1}^{100} x_{i}\\right)\n\n\\]\n\nAnd finally, by the AM-GM inequality\n\n\\[\nS \\leq \\frac{2}{100} \\cdot\\left(\\frac{1}{2}\\left(\\sum_{i=1}^{100} x_{i}+\\frac{100}{2}-\\sum_{i=1}^{100} x_{i}\\right)\\right)^{2}=\\frac{2}{100} \\cdot\\left(\\frac{100}{4}\\right)^{2}=\\frac{25}{2} .\n\\]\n\nComment. These solutions are not as easy as they may seem at the first sight. There are two different optimal configurations in which the variables have different values, and not all of sums of three consecutive numbers equal 1. Although it is easy to find the value \\(\\frac{25}{2}\\), the estimates must be done with care to preserve equality in the optimal configurations."}
{"id": "imo-shortlist-2010-a4", "question": "A4. A sequence \\(x_{1}, x_{2}, \\ldots\\) is defined by \\(x_{1}=1\\) and \\(x_{2 k}=-x_{k}, x_{2 k-1}=(-1)^{k+1} x_{k}\\) for all \\(k \\geq 1\\). Prove that \\(x_{1}+x_{2}+\\cdots+x_{n} \\geq 0\\) for all \\(n \\geq 1\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2010, "solution": "We start with some observations. First, from the definition of \\(x_{i}\\) it follows that for each positive integer \\(k\\) we have\n\n\\[\nx_{4 k-3}=x_{2 k-1}=-x_{4 k-2} \\quad \\text { and } \\quad x_{4 k-1}=x_{4 k}=-x_{2 k}=x_{k}\n\\]\n\nHence, denoting \\(S_{n}=\\sum_{i=1}^{n} x_{i}\\), we have\n\n\\[\n\\begin{gathered}\nS_{4 k}=\\sum_{i=1}^{k}\\left(\\left(x_{4 k-3}+x_{4 k-2}\\right)+\\left(x_{4 k-1}+x_{4 k}\\right)\\right)=\\sum_{i=1}^{k}\\left(0+2 x_{k}\\right)=2 S_{k} \nS_{4 k+2}=S_{4 k}+\\left(x_{4 k+1}+x_{4 k+2}\\right)=S_{4 k}\n\n\\]\n\nObserve also that \\(S_{n}=\\sum_{i=1}^{n} x_{i} \\equiv \\sum_{i=1}^{n} 1=n(\\bmod 2)\\).\nNow we prove by induction on \\(k\\) that \\(S_{i} \\geq 0\\) for all \\(i \\leq 4 k\\). The base case is valid since \\(x_{1}=x_{3}=x_{4}=1, x_{2}=-1\\). For the induction step, assume that \\(S_{i} \\geq 0\\) for all \\(i \\leq 4 k\\). Using the relations (1)-(3), we obtain\n\n\\[\nS_{4 k+4}=2 S_{k+1} \\geq 0, \\quad S_{4 k+2}=S_{4 k} \\geq 0, \\quad S_{4 k+3}=S_{4 k+2}+x_{4 k+3}=\\frac{S_{4 k+2}+S_{4 k+4}}{2} \\geq 0\n\\]\n\nSo, we are left to prove that \\(S_{4 k+1} \\geq 0\\). If \\(k\\) is odd, then \\(S_{4 k}=2 S_{k} \\geq 0\\); since \\(k\\) is odd, \\(S_{k}\\) is odd as well, so we have \\(S_{4 k} \\geq 2\\) and hence \\(S_{4 k+1}=S_{4 k}+x_{4 k+1} \\geq 1\\).\n\nConversely, if \\(k\\) is even, then we have \\(x_{4 k+1}=x_{2 k+1}=x_{k+1}\\), hence \\(S_{4 k+1}=S_{4 k}+x_{4 k+1}=\\) \\(2 S_{k}+x_{k+1}=S_{k}+S_{k+1} \\geq 0\\). The step is proved.\n\nSolution 2. We will use the notation of \\(S_{n}\\) and the relations (1)-(3) from the previous solution.\n\nAssume the contrary and consider the minimal \\(n\\) such that \\(S_{n+1}<0\\); surely \\(n \\geq 1\\), and from \\(S_{n} \\geq 0\\) we get \\(S_{n}=0, x_{n+1}=-1\\). Hence, we are especially interested in the set \\(M=\\left\\{n: S_{n}=0\\right\\}\\); our aim is to prove that \\(x_{n+1}=1\\) whenever \\(n \\in M\\) thus coming to a contradiction.\n\nFor this purpose, we first describe the set \\(M\\) inductively. We claim that (i) \\(M\\) consists only of even numbers, (ii) \\(2 \\in M\\), and (iii) for every even \\(n \\geq 4\\) we have \\(n \\in M \\Longleftrightarrow[n / 4] \\in M\\). Actually, (i) holds since \\(S_{n} \\equiv n\\) (mod 2), (ii) is straightforward, while (iii) follows from the relations \\(S_{4 k+2}=S_{4 k}=2 S_{k}\\).\n\nNow, we are left to prove that \\(x_{n+1}=1\\) if \\(n \\in M\\). We use the induction on \\(n\\). The base case is \\(n=2\\), that is, the minimal element of \\(M\\); here we have \\(x_{3}=1\\), as desired.\n\nFor the induction step, consider some \\(4 \\leq n \\in M\\) and let \\(m=[n / 4] \\in M\\); then \\(m\\) is even, and \\(x_{m+1}=1\\) by the induction hypothesis. We prove that \\(x_{n+1}=x_{m+1}=1\\). If \\(n=4 m\\) then we have \\(x_{n+1}=x_{2 m+1}=x_{m+1}\\) since \\(m\\) is even; otherwise, \\(n=4 m+2\\), and \\(x_{n+1}=-x_{2 m+2}=x_{m+1}\\), as desired. The proof is complete.\nComment. Using the inductive definition of set \\(M\\), one can describe it explicitly. Namely, \\(M\\) consists exactly of all positive integers not containing digits 1 and 3 in their 4-base representation."}
{"id": "imo-shortlist-2010-a5", "question": "A5. Denote by \\(\\mathbb{Q}^{+}\\)the set of all positive rational numbers. Determine all functions \\(f: \\mathbb{Q}^{+} \\rightarrow \\mathbb{Q}^{+}\\) which satisfy the following equation for all \\(x, y \\in \\mathbb{Q}^{+}\\):\n\n\\[\nf\\left(f(x)^{2} y\\right)=x^{3} f(x y)\n\\]\n\n(Switzerland)\nAnswer. The only such function is \\(f(x)=\\frac{1}{x}\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2010, "solution": "By substituting \\(y=1\\), we get\n\n\\[\nf\\left(f(x)^{2}\\right)=x^{3} f(x)\n\\]\n\nThen, whenever \\(f(x)=f(y)\\), we have\n\n\\[\nx^{3}=\\frac{f\\left(f(x)^{2}\\right)}{f(x)}=\\frac{f\\left(f(y)^{2}\\right)}{f(y)}=y^{3}\n\\]\n\nwhich implies \\(x=y\\), so the function \\(f\\) is injective.\nNow replace \\(x\\) by \\(x y\\) in (2), and apply (1) twice, second time to \\(\\left(y, f(x)^{2}\\right.\\) ) instead of ( \\(x, y\\) ):\n\n\\[\nf\\left(f(x y)^{2}\\right)=(x y)^{3} f(x y)=y^{3} f\\left(f(x)^{2} y\\right)=f\\left(f(x)^{2} f(y)^{2}\\right)\n\\]\n\nSince \\(f\\) is injective, we get\n\n\\[\n\\begin{aligned}\nf(x y)^{2} & =f(x)^{2} f(y)^{2} \nf(x y) & =f(x) f(y)\n\n\\]\n\nTherefore, \\(f\\) is multiplicative. This also implies \\(f(1)=1\\) and \\(f\\left(x^{n}\\right)=f(x)^{n}\\) for all integers \\(n\\).\nThen the function equation (1) can be re-written as\n\n\\[\n\\begin{aligned}\nf(f(x))^{2} f(y) & =x^{3} f(x) f(y) \nf(f(x)) & =\\sqrt{x^{3} f(x)}\n\n\\]\n\nLet \\(g(x)=x f(x)\\). Then, by (3), we have\n\n\\[\n\\begin{aligned}\ng(g(x)) & =g(x f(x))=x f(x) \\cdot f(x f(x))=x f(x)^{2} f(f(x))= \n& =x f(x)^{2} \\sqrt{x^{3} f(x)}=(x f(x))^{5 / 2}=(g(x))^{5 / 2}\n\n\\]\n\nand, by induction,\n\n\\[\n\\underbrace{g(g(\\ldots g(x) \\ldots))}_{n+1}=(g(x))^{(5 / 2)^{n}}\n\\]\n\nfor every positive integer \\(n\\).\nConsider (4) for a fixed \\(x\\). The left-hand side is always rational, so \\((g(x))^{(5 / 2)^{n}}\\) must be rational for every \\(n\\). We show that this is possible only if \\(g(x)=1\\). Suppose that \\(g(x) \\neq 1\\), and let the prime factorization of \\(g(x)\\) be \\(g(x)=p_{1}^{\\alpha_{1}} \\ldots p_{k}^{\\alpha_{k}}\\) where \\(p_{1}, \\ldots, p_{k}\\) are distinct primes and \\(\\alpha_{1}, \\ldots, \\alpha_{k}\\) are nonzero integers. Then the unique prime factorization of (4) is\n\n\\[\n\\underbrace{g(g(\\ldots g}_{n+1}(x) \\ldots))=(g(x))^{(5 / 2)^{n}}=p_{1}^{(5 / 2)^{n} \\alpha_{1}} \\cdots p_{k}^{(5 / 2)^{n} \\alpha_{k}}\n\\]\n\nwhere the exponents should be integers. But this is not true for large values of \\(n\\), for example \\(\\left(\\frac{5}{2}\\right)^{n} \\alpha_{1}\\) cannot be a integer number when \\(2^{n} \\nmid \\alpha_{1}\\). Therefore, \\(g(x) \\neq 1\\) is impossible.\n\nHence, \\(g(x)=1\\) and thus \\(f(x)=\\frac{1}{x}\\) for all \\(x\\).\nThe function \\(f(x)=\\frac{1}{x}\\) satisfies the equation (1):\n\n\\[\nf\\left(f(x)^{2} y\\right)=\\frac{1}{f(x)^{2} y}=\\frac{1}{\\left(\\frac{1}{x}\\right)^{2} y}=\\frac{x^{3}}{x y}=x^{3} f(x y)\n\\]\n\nComment. Among \\(\\mathbb{R}^{+} \\rightarrow \\mathbb{R}^{+}\\)functions, \\(f(x)=\\frac{1}{x}\\) is not the only solution. Another solution is \\(f_{1}(x)=x^{3 / 2}\\). Using transfinite tools, infinitely many other solutions can be constructed."}
{"id": "imo-shortlist-2010-a6", "question": "A6. Suppose that \\(f\\) and \\(g\\) are two functions defined on the set of positive integers and taking positive integer values. Suppose also that the equations \\(f(g(n))=f(n)+1\\) and \\(g(f(n))=\\) \\(g(n)+1\\) hold for all positive integers. Prove that \\(f(n)=g(n)\\) for all positive integer \\(n\\).\n(Germany)", "category": "Algebra", "source": "IMO Shortlist", "year": 2010, "solution": "Throughout the solution, by \\(\\mathbb{N}\\) we denote the set of all positive integers. For any function \\(h: \\mathbb{N} \\rightarrow \\mathbb{N}\\) and for any positive integer \\(k\\), define \\(h^{k}(x)=\\underbrace{h(h(\\ldots h}_{k}(x) \\ldots)\\) ) (in particular, \\(\\left.h^{0}(x)=x\\right)\\).\n\nObserve that \\(f\\left(g^{k}(x)\\right)=f\\left(g^{k-1}(x)\\right)+1=\\cdots=f(x)+k\\) for any positive integer \\(k\\), and similarly \\(g\\left(f^{k}(x)\\right)=g(x)+k\\). Now let \\(a\\) and \\(b\\) are the minimal values attained by \\(f\\) and \\(g\\), respectively; say \\(f\\left(n_{f}\\right)=a, g\\left(n_{g}\\right)=b\\). Then we have \\(f\\left(g^{k}\\left(n_{f}\\right)\\right)=a+k, g\\left(f^{k}\\left(n_{g}\\right)\\right)=b+k\\), so the function \\(f\\) attains all values from the set \\(N_{f}=\\{a, a+1, \\ldots\\}\\), while \\(g\\) attains all the values from the set \\(N_{g}=\\{b, b+1, \\ldots\\}\\).\n\nNext, note that \\(f(x)=f(y)\\) implies \\(g(x)=g(f(x))-1=g(f(y))-1=g(y)\\); surely, the converse implication also holds. Now, we say that \\(x\\) and \\(y\\) are similar (and write \\(x \\sim y\\) ) if \\(f(x)=f(y)\\) (equivalently, \\(g(x)=g(y)\\) ). For every \\(x \\in \\mathbb{N}\\), we define \\([x]=\\{y \\in \\mathbb{N}: x \\sim y\\}\\); surely, \\(y_{1} \\sim y_{2}\\) for all \\(y_{1}, y_{2} \\in[x]\\), so \\([x]=[y]\\) whenever \\(y \\in[x]\\).\n\nNow we investigate the structure of the sets \\([x]\\).\nClaim 1. Suppose that \\(f(x) \\sim f(y)\\); then \\(x \\sim y\\), that is, \\(f(x)=f(y)\\). Consequently, each class \\([x]\\) contains at most one element from \\(N_{f}\\), as well as at most one element from \\(N_{g}\\).\nProof. If \\(f(x) \\sim f(y)\\), then we have \\(g(x)=g(f(x))-1=g(f(y))-1=g(y)\\), so \\(x \\sim y\\). The second statement follows now from the sets of values of \\(f\\) and \\(g\\).\n\nNext, we clarify which classes do not contain large elements.\nClaim 2. For any \\(x \\in \\mathbb{N}\\), we have \\([x] \\subseteq\\{1,2, \\ldots, b-1\\}\\) if and only if \\(f(x)=a\\). Analogously, \\([x] \\subseteq\\{1,2, \\ldots, a-1\\}\\) if and only if \\(g(x)=b\\).\nProof. We will prove that \\([x] \\nsubseteq\\{1,2, \\ldots, b-1\\} \\Longleftrightarrow f(x)>a\\); the proof of the second statement is similar.\n\nNote that \\(f(x)>a\\) implies that there exists some \\(y\\) satisfying \\(f(y)=f(x)-1\\), so \\(f(g(y))=\\) \\(f(y)+1=f(x)\\), and hence \\(x \\sim g(y) \\geq b\\). Conversely, if \\(b \\leq c \\sim x\\) then \\(c=g(y)\\) for some \\(y \\in \\mathbb{N}\\), which in turn follows \\(f(x)=f(g(y))=f(y)+1 \\geq a+1\\), and hence \\(f(x)>a\\).\n\nClaim 2 implies that there exists exactly one class contained in \\(\\{1, \\ldots, a-1\\}\\) (that is, the class \\(\\left[n_{g}\\right]\\) ), as well as exactly one class contained in \\(\\{1, \\ldots, b-1\\}\\) (the class \\(\\left[n_{f}\\right]\\) ). Assume for a moment that \\(a \\leq b\\); then \\(\\left[n_{g}\\right]\\) is contained in \\(\\{1, \\ldots, b-1\\}\\) as well, hence it coincides with \\(\\left[n_{g}\\right]\\). So, we get that\n\n\\[\nf(x)=a \\Longleftrightarrow g(x)=b \\Longleftrightarrow x \\sim n_{f} \\sim n_{g} .\n\\]\n\nClaim 3. \\(a=b\\).\nProof. By Claim 2, we have \\([a] \\neq\\left[n_{f}\\right]\\), so \\([a]\\) should contain some element \\(a^{\\prime} \\geq b\\) by Claim 2 again. If \\(a \\neq a^{\\prime}\\), then \\([a]\\) contains two elements \\(\\geq a\\) which is impossible by Claim 1. Therefore, \\(a=a^{\\prime} \\geq b\\). Similarly, \\(b \\geq a\\).\n\nNow we are ready to prove the problem statement. First, we establish the following\nClaim 4. For every integer \\(d \\geq 0, f^{d+1}\\left(n_{f}\\right)=g^{d+1}\\left(n_{f}\\right)=a+d\\).\nProof. Induction on \\(d\\). For \\(d=0\\), the statement follows from (1) and Claim 3. Next, for \\(d>1\\) from the induction hypothesis we have \\(f^{d+1}\\left(n_{f}\\right)=f\\left(f^{d}\\left(n_{f}\\right)\\right)=f\\left(g^{d}\\left(n_{f}\\right)\\right)=f\\left(n_{f}\\right)+d=a+d\\). The equality \\(g^{d+1}\\left(n_{f}\\right)=a+d\\) is analogous.\n\nFinally, for each \\(x \\in \\mathbb{N}\\), we have \\(f(x)=a+d\\) for some \\(d \\geq 0\\), so \\(f(x)=f\\left(g^{d}\\left(n_{f}\\right)\\right)\\) and hence \\(x \\sim g^{d}\\left(n_{f}\\right)\\). It follows that \\(g(x)=g\\left(g^{d}\\left(n_{f}\\right)\\right)=g^{d+1}\\left(n_{f}\\right)=a+d=f(x)\\) by Claim 4 .\n\nSolution 2. We start with the same observations, introducing the relation \\(\\sim\\) and proving Claim 1 from the previous solution.\n\nNote that \\(f(a)>a\\) since otherwise we have \\(f(a)=a\\) and hence \\(g(a)=g(f(a))=g(a)+1\\), which is false.\nClaim 2'. \\(\\quad a=b\\).\nProof. We can assume that \\(a \\leq b\\). Since \\(f(a) \\geq a+1\\), there exists some \\(x \\in \\mathbb{N}\\) such that \\(f(a)=f(x)+1\\), which is equivalent to \\(f(a)=f(g(x))\\) and \\(a \\sim g(x)\\). Since \\(g(x) \\geq b \\geq a\\), by Claim 1 we have \\(a=g(x) \\geq b\\), which together with \\(a \\leq b\\) proves the Claim.\n\nNow, almost the same method allows to find the values \\(f(a)\\) and \\(g(a)\\).\nClaim 3'. \\(\\quad f(a)=g(a)=a+1\\).\nProof. Assume the contrary; then \\(f(a) \\geq a+2\\), hence there exist some \\(x, y \\in \\mathbb{N}\\) such that \\(f(x)=f(a)-2\\) and \\(f(y)=g(x)\\) (as \\(g(x) \\geq a=b\\) ). Now we get \\(f(a)=f(x)+2=f\\left(g^{2}(x)\\right)\\), so \\(a \\sim g^{2}(x) \\geq a\\), and by Claim 1 we get \\(a=g^{2}(x)=g(f(y))=1+g(y) \\geq 1+a\\); this is impossible. The equality \\(g(a)=a+1\\) is similar.\n\nNow, we are prepared for the proof of the problem statement. First, we prove it for \\(n \\geq a\\). Claim 4'. For each integer \\(x \\geq a\\), we have \\(f(x)=g(x)=x+1\\).\nProof. Induction on \\(x\\). The base case \\(x=a\\) is provided by Claim \\(3^{\\prime}\\), while the induction step follows from \\(f(x+1)=f(g(x))=f(x)+1=(x+1)+1\\) and the similar computation for \\(g(x+1)\\).\n\nFinally, for an arbitrary \\(n \\in \\mathbb{N}\\) we have \\(g(n) \\geq a\\), so by Claim \\(4^{\\prime}\\) we have \\(f(n)+1=\\) \\(f(g(n))=g(n)+1\\), hence \\(f(n)=g(n)\\).\nComment. It is not hard now to describe all the functions \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}\\) satisfying the property \\(f(f(n))=\\) \\(f(n)+1\\). For each such function, there exists \\(n_{0} \\in \\mathbb{N}\\) such that \\(f(n)=n+1\\) for all \\(n \\geq n_{0}\\), while for each \\(n<n_{0}, f(n)\\) is an arbitrary number greater than of equal to \\(n_{0}\\) (these numbers may be different for different \\(n<n_{0}\\) )."}
{"id": "imo-shortlist-2010-a7", "question": "A7. Let \\(a_{1}, \\ldots, a_{r}\\) be positive real numbers. For \\(n>r\\), we inductively define\n\n\\[\na_{n}=\\max _{1 \\leq k \\leq n-1}\\left(a_{k}+a_{n-k}\\right)\n\\]\n\nProve that there exist positive integers \\(\\ell \\leq r\\) and \\(N\\) such that \\(a_{n}=a_{n-\\ell}+a_{\\ell}\\) for all \\(n \\geq N\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2010, "solution": "First, from the problem conditions we have that each \\(a_{n}(n>r)\\) can be expressed as \\(a_{n}=a_{j_{1}}+a_{j_{2}}\\) with \\(j_{1}, j_{2}<n, j_{1}+j_{2}=n\\). If, say, \\(j_{1}>r\\) then we can proceed in the same way with \\(a_{j_{1}}\\), and so on. Finally, we represent \\(a_{n}\\) in a form\n\n\\[\n\\begin{gathered}\na_{n}=a_{i_{1}}+\\cdots+a_{i_{k}} \n1 \\leq i_{j} \\leq r, \\quad i_{1}+\\cdots+i_{k}=n\n\n\\]\n\nMoreover, if \\(a_{i_{1}}\\) and \\(a_{i_{2}}\\) are the numbers in (2) obtained on the last step, then \\(i_{1}+i_{2}>r\\). Hence we can adjust (3) as\n\n\\[\n1 \\leq i_{j} \\leq r, \\quad i_{1}+\\cdots+i_{k}=n, \\quad i_{1}+i_{2}>r\n\\]\n\nOn the other hand, suppose that the indices \\(i_{1}, \\ldots, i_{k}\\) satisfy the conditions (4). Then, denoting \\(s_{j}=i_{1}+\\cdots+i_{j}\\), from (1) we have\n\n\\[\na_{n}=a_{s_{k}} \\geq a_{s_{k-1}}+a_{i_{k}} \\geq a_{s_{k-2}}+a_{i_{k-1}}+a_{i_{k}} \\geq \\cdots \\geq a_{i_{1}}+\\cdots+a_{i_{k}}\n\\]\n\nSummarizing these observations we get the following\nClaim. For every \\(n>r\\), we have\n\n\\[\na_{n}=\\max \\left\\{a_{i_{1}}+\\cdots+a_{i_{k}}: \\text { the collection }\\left(i_{1}, \\ldots, i_{k}\\right) \\text { satisfies }(4)\\right\\}\n\\]\n\nNow we denote\n\n\\[\ns=\\max _{1 \\leq i \\leq r} \\frac{a_{i}}{i}\n\\]\n\nand fix some index \\(\\ell \\leq r\\) such that \\(s=\\frac{a_{\\ell}}{\\ell}\\).\nConsider some \\(n \\geq r^{2} \\ell+2 r\\) and choose an expansion of \\(a_{n}\\) in the form (2), (4). Then we have \\(n=i_{1}+\\cdots+i_{k} \\leq r k\\), so \\(k \\geq n / r \\geq r \\ell+2\\). Suppose that none of the numbers \\(i_{3}, \\ldots, i_{k}\\) equals \\(\\ell\\). Then by the pigeonhole principle there is an index \\(1 \\leq j \\leq r\\) which appears among \\(i_{3}, \\ldots, i_{k}\\) at least \\(\\ell\\) times, and surely \\(j \\neq \\ell\\). Let us delete these \\(\\ell\\) occurrences of \\(j\\) from \\(\\left(i_{1}, \\ldots, i_{k}\\right)\\), and add \\(j\\) occurrences of \\(\\ell\\) instead, obtaining a sequence \\(\\left(i_{1}, i_{2}, i_{3}^{\\prime}, \\ldots, i_{k^{\\prime}}^{\\prime}\\right)\\) also satisfying (4). By Claim, we have\n\n\\[\na_{i_{1}}+\\cdots+a_{i_{k}}=a_{n} \\geq a_{i_{1}}+a_{i_{2}}+a_{i_{3}^{\\prime}}+\\cdots+a_{i_{k^{\\prime}}^{\\prime}}\n\\]\n\nor, after removing the coinciding terms, \\(\\ell a_{j} \\geq j a_{\\ell}\\), so \\(\\frac{a_{\\ell}}{\\ell} \\leq \\frac{a_{j}}{j}\\). By the definition of \\(\\ell\\), this means that \\(\\ell a_{j}=j a_{\\ell}\\), hence\n\n\\[\na_{n}=a_{i_{1}}+a_{i_{2}}+a_{i_{3}^{\\prime}}+\\cdots+a_{i_{k^{\\prime}}^{\\prime}} .\n\\]\n\nThus, for every \\(n \\geq r^{2} \\ell+2 r\\) we have found a representation of the form (2), (4) with \\(i_{j}=\\ell\\) for some \\(j \\geq 3\\). Rearranging the indices we may assume that \\(i_{k}=\\ell\\).\n\nFinally, observe that in this representation, the indices \\(\\left(i_{1}, \\ldots, i_{k-1}\\right)\\) satisfy the conditions (4) with \\(n\\) replaced by \\(n-\\ell\\). Thus, from the Claim we get\n\n\\[\na_{n-\\ell}+a_{\\ell} \\geq\\left(a_{i_{1}}+\\cdots+a_{i_{k-1}}\\right)+a_{\\ell}=a_{n}\n\\]\n\nwhich by (1) implies\n\n\\[\na_{n}=a_{n-\\ell}+a_{\\ell} \\quad \\text { for each } n \\geq r^{2} \\ell+2 r\n\\]\n\nas desired.\n\nSolution 2. As in the previous solution, we involve the expansion (2), (3), and we fix some index \\(1 \\leq \\ell \\leq r\\) such that\n\n\\[\n\\frac{a_{\\ell}}{\\ell}=s=\\max _{1 \\leq i \\leq r} \\frac{a_{i}}{i}\n\\]\n\nNow, we introduce the sequence ( \\(b_{n}\\) ) as \\(b_{n}=a_{n}-s n\\); then \\(b_{\\ell}=0\\).\nWe prove by induction on \\(n\\) that \\(b_{n} \\leq 0\\), and ( \\(b_{n}\\) ) satisfies the same recurrence relation as \\(\\left(a_{n}\\right)\\). The base cases \\(n \\leq r\\) follow from the definition of \\(s\\). Now, for \\(n>r\\) from the induction hypothesis we have\n\n\\[\nb_{n}=\\max _{1 \\leq k \\leq n-1}\\left(a_{k}+a_{n-k}\\right)-n s=\\max _{1 \\leq k \\leq n-1}\\left(b_{k}+b_{n-k}+n s\\right)-n s=\\max _{1 \\leq k \\leq n-1}\\left(b_{k}+b_{n-k}\\right) \\leq 0\n\\]\n\nas required.\nNow, if \\(b_{k}=0\\) for all \\(1 \\leq k \\leq r\\), then \\(b_{n}=0\\) for all \\(n\\), hence \\(a_{n}=s n\\), and the statement is trivial. Otherwise, define\n\n\\[\nM=\\max _{1 \\leq i \\leq r}\\left|b_{i}\\right|, \\quad \\varepsilon=\\min \\left\\{\\left|b_{i}\\right|: 1 \\leq i \\leq r, b_{i}<0\\right\\}\n\\]\n\nThen for \\(n>r\\) we obtain\n\n\\[\nb_{n}=\\max _{1 \\leq k \\leq n-1}\\left(b_{k}+b_{n-k}\\right) \\geq b_{\\ell}+b_{n-\\ell}=b_{n-\\ell}\n\\]\n\nso\n\n\\[\n0 \\geq b_{n} \\geq b_{n-\\ell} \\geq b_{n-2 \\ell} \\geq \\cdots \\geq-M\n\\]\n\nThus, in view of the expansion (2), (3) applied to the sequence \\(\\left(b_{n}\\right)\\), we get that each \\(b_{n}\\) is contained in a set\n\n\\[\nT=\\left\\{b_{i_{1}}+b_{i_{2}}+\\cdots+b_{i_{k}}: i_{1}, \\ldots, i_{k} \\leq r\\right\\} \\cap[-M, 0]\n\\]\n\nWe claim that this set is finite. Actually, for any \\(x \\in T\\), let \\(x=b_{i_{1}}+\\cdots+b_{i_{k}}\\left(i_{1}, \\ldots, i_{k} \\leq r\\right)\\). Then among \\(b_{i_{j}}\\) 's there are at most \\(\\frac{M}{\\varepsilon}\\) nonzero terms (otherwise \\(x<\\frac{M}{\\varepsilon} \\cdot(-\\varepsilon)<-M\\) ). Thus \\(x\\) can be expressed in the same way with \\(k \\leq \\frac{M}{\\varepsilon}\\), and there is only a finite number of such sums.\n\nFinally, for every \\(t=1,2, \\ldots, \\ell\\) we get that the sequence\n\n\\[\nb_{r+t}, b_{r+t+\\ell}, b_{r+t+2 \\ell}, \\ldots\n\\]\n\nis non-decreasing and attains the finite number of values; therefore it is constant from some index. Thus, the sequence \\(\\left(b_{n}\\right)\\) is periodic with period \\(\\ell\\) from some index \\(N\\), which means that\n\n\\[\nb_{n}=b_{n-\\ell}=b_{n-\\ell}+b_{\\ell} \\quad \\text { for all } n>N+\\ell\n\\]\n\nand hence\n\n\\[\na_{n}=b_{n}+n s=\\left(b_{n-\\ell}+(n-\\ell) s\\right)+\\left(b_{\\ell}+\\ell s\\right)=a_{n-\\ell}+a_{\\ell} \\quad \\text { for all } n>N+\\ell\n\\]\n\nas desired."}
{"id": "imo-shortlist-2010-a8", "question": "A8. Given six positive numbers \\(a, b, c, d, e, f\\) such that \\(a<b<c<d<e<f\\). Let \\(a+c+e=S\\) and \\(b+d+f=T\\). Prove that\n\n\\[\n2 S T>\\sqrt{3(S+T)(S(b d+b f+d f)+T(a c+a e+c e))}\n\\]\n\n(South Korea)", "category": "Algebra", "source": "IMO Shortlist", "year": 2010, "solution": "We define also \\(\\sigma=a c+c e+a e, \\tau=b d+b f+d f\\). The idea of the solution is to interpret (1) as a natural inequality on the roots of an appropriate polynomial.\n\nActually, consider the polynomial\n\n\\[\n\\begin{aligned}\nP(x)=(b+d+f)(x & -a)(x-c)(x-e)+(a+c+e)(x-b)(x-d)(x-f) \n& =T\\left(x^{3}-S x^{2}+\\sigma x-a c e\\right)+S\\left(x^{3}-T x^{2}+\\tau x-b d f\\right)\n\n\\]\n\nSurely, \\(P\\) is cubic with leading coefficient \\(S+T>0\\). Moreover, we have\n\n\\[\n\\begin{array}{ll}\nP(a)=S(a-b)(a-d)(a-f)<0, & P(c)=S(c-b)(c-d)(c-f)>0 \nP(e)=S(e-b)(e-d)(e-f)<0, & P(f)=T(f-a)(f-c)(f-e)>0\n\n\\]\n\nHence, each of the intervals \\((a, c),(c, e),(e, f)\\) contains at least one root of \\(P(x)\\). Since there are at most three roots at all, we obtain that there is exactly one root in each interval (denote them by \\(\\alpha \\in(a, c), \\beta \\in(c, e), \\gamma \\in(e, f))\\). Moreover, the polynomial \\(P\\) can be factorized as\n\n\\[\nP(x)=(T+S)(x-\\alpha)(x-\\beta)(x-\\gamma)\n\\]\n\nEquating the coefficients in the two representations (2) and (3) of \\(P(x)\\) provides\n\n\\[\n\\alpha+\\beta+\\gamma=\\frac{2 T S}{T+S}, \\quad \\alpha \\beta+\\alpha \\gamma+\\beta \\gamma=\\frac{S \\tau+T \\sigma}{T+S}\n\\]\n\nNow, since the numbers \\(\\alpha, \\beta, \\gamma\\) are distinct, we have\n\n\\[\n0<(\\alpha-\\beta)^{2}+(\\alpha-\\gamma)^{2}+(\\beta-\\gamma)^{2}=2(\\alpha+\\beta+\\gamma)^{2}-6(\\alpha \\beta+\\alpha \\gamma+\\beta \\gamma)\n\\]\n\nwhich implies\n\n\\[\n\\frac{4 S^{2} T^{2}}{(T+S)^{2}}=(\\alpha+\\beta+\\gamma)^{2}>3(\\alpha \\beta+\\alpha \\gamma+\\beta \\gamma)=\\frac{3(S \\tau+T \\sigma)}{T+S}\n\\]\n\nor\n\n\\[\n4 S^{2} T^{2}>3(T+S)(T \\sigma+S \\tau)\n\\]\n\nwhich is exactly what we need.\nComment 1. In fact, one can locate the roots of \\(P(x)\\) more narrowly: they should lie in the intervals \\((a, b),(c, d),(e, f)\\).\n\nSurely, if we change all inequality signs in the problem statement to non-strict ones, the (non-strict) inequality will also hold by continuity. One can also find when the equality is achieved. This happens in that case when \\(P(x)\\) is a perfect cube, which immediately implies that \\(b=c=d=e(=\\alpha=\\beta=\\gamma)\\), together with the additional condition that \\(P^{\\prime \\prime}(b)=0\\). Algebraically,\n\n\\[\n\\begin{array}{rlr}\n6(T+S) b-4 T S=0 & \\Longleftrightarrow & 3 b(a+4 b+f)=2(a+2 b)(2 b+f) \n& \\Longleftrightarrow & f=\\frac{b(4 b-a)}{2 a+b}=b\\left(1+\\frac{3(b-a)}{2 a+b}\\right)>b\n\n\\]\n\nThis means that for every pair of numbers \\(a, b\\) such that \\(0<a<b\\), there exists \\(f>b\\) such that the point \\((a, b, b, b, b, f)\\) is a point of equality.\n\nSolution 2. Let\n\n\\[\nU=\\frac{1}{2}\\left((e-a)^{2}+(c-a)^{2}+(e-c)^{2}\\right)=S^{2}-3(a c+a e+c e)\n\\]\n\nand\n\n\\[\nV=\\frac{1}{2}\\left((f-b)^{2}+(f-d)^{2}+(d-b)^{2}\\right)=T^{2}-3(b d+b f+d f)\n\\]\n\nThen\n\n\\[\n\\begin{aligned}\n& (\\text { L.H.S. })^{2}-(\\text { R.H.S. })^{2}=(2 S T)^{2}-(S+T)(S \\cdot 3(b d+b f+d f)+T \\cdot 3(a c+a e+c e))= \n& \\quad=4 S^{2} T^{2}-(S+T)\\left(S\\left(T^{2}-V\\right)+T\\left(S^{2}-U\\right)\\right)=(S+T)(S V+T U)-S T(T-S)^{2},\n\n\\]\n\nand the statement is equivalent with\n\n\\[\n(S+T)(S V+T U)>S T(T-S)^{2}\n\\]\n\nBy the Cauchy-Schwarz inequality,\n\n\\[\n(S+T)(T U+S V) \\geq(\\sqrt{S \\cdot T U}+\\sqrt{T \\cdot S V})^{2}=S T(\\sqrt{U}+\\sqrt{V})^{2} .\n\\]\n\nEstimate the quantities \\(\\sqrt{U}\\) and \\(\\sqrt{V}\\) by the QM-AM inequality with the positive terms \\((e-c)^{2}\\) and \\((d-b)^{2}\\) being omitted:\n\n\\[\n\\begin{aligned}\n\\sqrt{U}+\\sqrt{V} & >\\sqrt{\\frac{(e-a)^{2}+(c-a)^{2}}{2}}+\\sqrt{\\frac{(f-b)^{2}+(f-d)^{2}}{2}} \n& >\\frac{(e-a)+(c-a)}{2}+\\frac{(f-b)+(f-d)}{2}=\\left(f-\\frac{d}{2}-\\frac{b}{2}\\right)+\\left(\\frac{e}{2}+\\frac{c}{2}-a\\right) \n& =(T-S)+\\frac{3}{2}(e-d)+\\frac{3}{2}(c-b)>T-S\n\n\\]\n\nThe estimates (5) and (6) prove (4) and hence the statement.\nSolution 3. We keep using the notations \\(\\sigma\\) and \\(\\tau\\) from Solution 1. Moreover, let \\(s=c+e\\). Note that\n\n\\[\n(c-b)(c-d)+(e-f)(e-d)+(e-f)(c-b)<0\n\\]\n\nsince each summand is negative. This rewrites as\n\n\\[\n\\begin{aligned}\n(b d+b f+d f)-(a c+c e+a e) & <(c+e)(b+d+f-a-c-e), \\text { or } \n\\tau-\\sigma & <s(T-S)\n\n\\]\n\nThen we have\n\n\\[\n\\begin{aligned}\nS \\tau+T \\sigma & =S(\\tau-\\sigma)+(S+T) \\sigma<S s(T-S)+(S+T)(c e+a s) \n& \\leq S s(T-S)+(S+T)\\left(\\frac{s^{2}}{4}+(S-s) s\\right)=s\\left(2 S T-\\frac{3}{4}(S+T) s\\right)\n\n\\]\n\nUsing this inequality together with the AM-GM inequality we get\n\n\\[\n\\begin{aligned}\n\\sqrt{\\frac{3}{4}(S+T)(S \\tau+T \\sigma)} & <\\sqrt{\\frac{3}{4}(S+T) s\\left(2 S T-\\frac{3}{4}(S+T) s\\right)} \n& \\leq \\frac{\\frac{3}{4}(S+T) s+2 S T-\\frac{3}{4}(S+T) s}{2}=S T\n\n\\]\n\nHence,\n\n\\[\n2 S T>\\sqrt{3(S+T)(S(b d+b f+d f)+T(a c+a e+c e))}\n\\]\n\nComment 2. The expression (7) can be found by considering the sum of the roots of the quadratic polynomial \\(q(x)=(x-b)(x-d)(x-f)-(x-a)(x-c)(x-e)\\).\n\nSolution 4. We introduce the expressions \\(\\sigma\\) and \\(\\tau\\) as in the previous solutions. The idea of the solution is to change the values of variables \\(a, \\ldots, f\\) keeping the left-hand side unchanged and increasing the right-hand side; it will lead to a simpler inequality which can be proved in a direct way.\n\nNamely, we change the variables (i) keeping the (non-strict) inequalities \\(a \\leq b \\leq c \\leq d \\leq\\) \\(e \\leq f\\); (ii) keeping the values of sums \\(S\\) and \\(T\\) unchanged; and finally (iii) increasing the values of \\(\\sigma\\) and \\(\\tau\\). Then the left-hand side of (1) remains unchanged, while the right-hand side increases. Hence, the inequality (1) (and even a non-strict version of (1)) for the changed values would imply the same (strict) inequality for the original values.\n\nFirst, we find the sufficient conditions for (ii) and (iii) to be satisfied.\nLemma. Let \\(x, y, z>0\\); denote \\(U(x, y, z)=x+y+z, v(x, y, z)=x y+x z+y z\\). Suppose that \\(x^{\\prime}+y^{\\prime}=x+y\\) but \\(|x-y| \\geq\\left|x^{\\prime}-y^{\\prime}\\right| ;\\) then we have \\(U\\left(x^{\\prime}, y^{\\prime}, z\\right)=U(x, y, z)\\) and \\(v\\left(x^{\\prime}, y^{\\prime}, z\\right) \\geq\\) \\(v(x, y, z)\\) with equality achieved only when \\(|x-y|=\\left|x^{\\prime}-y^{\\prime}\\right|\\).\nProof. The first equality is obvious. For the second, we have\n\n\\[\n\\begin{aligned}\nv\\left(x^{\\prime}, y^{\\prime}, z\\right)=z\\left(x^{\\prime}+y^{\\prime}\\right)+x^{\\prime} y^{\\prime} & =z\\left(x^{\\prime}+y^{\\prime}\\right)+\\frac{\\left(x^{\\prime}+y^{\\prime}\\right)^{2}-\\left(x^{\\prime}-y^{\\prime}\\right)^{2}}{4} \n& \\geq z(x+y)+\\frac{(x+y)^{2}-(x-y)^{2}}{4}=v(x, y, z)\n\n\\]\n\nwith the equality achieved only for \\(\\left(x^{\\prime}-y^{\\prime}\\right)^{2}=(x-y)^{2} \\Longleftrightarrow\\left|x^{\\prime}-y^{\\prime}\\right|=|x-y|\\), as desired.\n\nNow, we apply Lemma several times making the following changes. For each change, we denote the new values by the same letters to avoid cumbersome notations.\n\n\\begin{enumerate}\n  \\item Let \\(k=\\frac{d-c}{2}\\). Replace \\((b, c, d, e)\\) by \\((b+k, c+k, d-k, e-k)\\). After the change we have \\(a<b<c=d<e<f\\), the values of \\(S\\), \\(T\\) remain unchanged, but \\(\\sigma, \\tau\\) strictly increase by Lemma.\n  \\item Let \\(\\ell=\\frac{e-d}{2}\\). Replace \\((c, d, e, f)\\) by \\((c+\\ell, d+\\ell, e-\\ell, f-\\ell)\\). After the change we have \\(a<b<c=d=e<f\\), the values of \\(S, T\\) remain unchanged, but \\(\\sigma, \\tau\\) strictly increase by the Lemma.\n  \\item Finally, let \\(m=\\frac{c-b}{3}\\). Replace \\((a, b, c, d, e, f)\\) by \\((a+2 m, b+2 m, c-m, d-m, e-m, f-m)\\). After the change, we have \\(a<b=c=d=e<f\\) and \\(S, T\\) are unchanged. To check (iii), we observe that our change can be considered as a composition of two changes: \\((a, b, c, d) \\rightarrow\\) \\((a+m, b+m, c-m, d-m)\\) and \\((a, b, e, f) \\rightarrow(a+m, b+m, e-m, f-m)\\). It is easy to see that each of these two consecutive changes satisfy the conditions of the Lemma, hence the values of \\(\\sigma\\) and \\(\\tau\\) increase.\n\n\nFinally, we come to the situation when \\(a<b=c=d=e<f\\), and we need to prove the inequality\n\n\\[\n\\begin{aligned}\n2(a+2 b)(2 b+f) & \\geq \\sqrt{3(a+4 b+f)\\left((a+2 b)\\left(b^{2}+2 b f\\right)+(2 b+f)\\left(2 a b+b^{2}\\right)\\right)} \n& =\\sqrt{3 b(a+4 b+f) \\cdot((a+2 b)(b+2 f)+(2 b+f)(2 a+b))}\n\n\\]\n\nNow, observe that\n\n\\[\n2 \\cdot 2(a+2 b)(2 b+f)=3 b(a+4 b+f)+((a+2 b)(b+2 f)+(2 a+b)(2 b+f))\n\\]\n\nHence (4) rewrites as\n\n\\[\n\\begin{aligned}\n3 b(a+4 b+f) & +((a+2 b)(b+2 f)+(2 a+b)(2 b+f)) \n& \\geq 2 \\sqrt{3 b(a+4 b+f) \\cdot((a+2 b)(b+2 f)+(2 b+f)(2 a+b))}\n\n\\]\n\nwhich is simply the AM-GM inequality.\nComment 3. Here, we also can find all the cases of equality. Actually, it is easy to see that if some two numbers among \\(b, c, d, e\\) are distinct then one can use Lemma to increase the right-hand side of (1). Further, if \\(b=c=d=e\\), then we need equality in (4); this means that we apply AM-GM to equal numbers, that is,\n\n\\[\n3 b(a+4 b+f)=(a+2 b)(b+2 f)+(2 a+b)(2 b+f)\n\\]\n\nwhich leads to the same equality as in Comment 1 ."}
{"id": "imo-shortlist-2010-c1", "question": "C1. In a concert, 20 singers will perform. For each singer, there is a (possibly empty) set of other singers such that he wishes to perform later than all the singers from that set. Can it happen that there are exactly 2010 orders of the singers such that all their wishes are satisfied?\n(Austria)\nAnswer. Yes, such an example exists.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2010, "solution": "We say that an order of singers is good if it satisfied all their wishes. Next, we say that a number \\(N\\) is realizable by \\(k\\) singers (or \\(k\\)-realizable) if for some set of wishes of these singers there are exactly \\(N\\) good orders. Thus, we have to prove that a number 2010 is 20-realizable.\n\nWe start with the following simple\nLemma. Suppose that numbers \\(n_{1}, n_{2}\\) are realizable by respectively \\(k_{1}\\) and \\(k_{2}\\) singers. Then the number \\(n_{1} n_{2}\\) is ( \\(k_{1}+k_{2}\\) )-realizable.\nProof. Let the singers \\(A_{1}, \\ldots, A_{k_{1}}\\) (with some wishes among them) realize \\(n_{1}\\), and the singers \\(B_{1}\\), \\(\\ldots, B_{k_{2}}\\) (with some wishes among them) realize \\(n_{2}\\). Add to each singer \\(B_{i}\\) the wish to perform later than all the singers \\(A_{j}\\). Then, each good order of the obtained set of singers has the form \\(\\left(A_{i_{1}}, \\ldots, A_{i_{k_{1}}}, B_{j_{1}}, \\ldots, B_{j_{k_{2}}}\\right)\\), where ( \\(A_{i_{1}}, \\ldots, A_{i_{k_{1}}}\\) ) is a good order for \\(A_{i}\\) 's and ( \\(B_{j_{1}}, \\ldots, B_{j_{k_{2}}}\\) ) is a good order for \\(B_{j}\\) 's. Conversely, each order of this form is obviously good. Hence, the number of good orders is \\(n_{1} n_{2}\\).\n\nIn view of Lemma, we show how to construct sets of singers containing 4, 3 and 13 singers and realizing the numbers 5,6 and 67 , respectively. Thus the number \\(2010=6 \\cdot 5 \\cdot 67\\) will be realizable by \\(4+3+13=20\\) singers. These companies of singers are shown in Figs. 1-3; the wishes are denoted by arrows, and the number of good orders for each Figure stands below in the brackets.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-24}\n\nFig. 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-24(1)}\n(67)\n\nFig. 3\n\nFor Fig. 1, there are exactly 5 good orders \\((a, b, c, d),(a, b, d, c),(b, a, c, d),(b, a, d, c)\\), ( \\(b, d, a, c\\) ). For Fig. 2, each of 6 orders is good since there are no wishes.\n\nFinally, for Fig. 3, the order of \\(a_{1}, \\ldots, a_{11}\\) is fixed; in this line, singer \\(x\\) can stand before each of \\(a_{i}(i \\leq 9)\\), and singer \\(y\\) can stand after each of \\(a_{j}(j \\geq 5)\\), thus resulting in \\(9 \\cdot 7=63\\) cases. Further, the positions of \\(x\\) and \\(y\\) in this line determine the whole order uniquely unless both of them come between the same pair ( \\(a_{i}, a_{i+1}\\) ) (thus \\(5 \\leq i \\leq 8\\) ); in the latter cases, there are two orders instead of 1 due to the order of \\(x\\) and \\(y\\). Hence, the total number of good orders is \\(63+4=67\\), as desired.\n\nComment. The number 20 in the problem statement is not sharp and is put there to respect the original formulation. So, if necessary, the difficulty level of this problem may be adjusted by replacing 20 by a smaller number. Here we present some improvements of the example leading to a smaller number of singers.\n\nSurely, each example with < 20 singers can be filled with some \"super-stars\" who should perform at the very end in a fixed order. Hence each of these improvements provides a different solution for the problem. Moreover, the large variety of ideas standing behind these examples allows to suggest that there are many other examples.\n\n\\begin{enumerate}\n  \\item Instead of building the examples realizing 5 and 6 , it is more economic to make an example realizing 30; it may seem even simpler. Two possible examples consisting of 5 and 6 singers are shown in Fig. 4; hence the number 20 can be decreased to 19 or 18 .\n\n\nFor Fig. 4a, the order of \\(a_{1}, \\ldots, a_{4}\\) is fixed, there are 5 ways to add \\(x\\) into this order, and there are 6 ways to add \\(y\\) into the resulting order of \\(a_{1}, \\ldots, a_{4}, x\\). Hence there are \\(5 \\cdot 6=30\\) good orders.\n\nOn Fig. 4b, for 5 singers \\(a, b_{1}, b_{2}, c_{1}, c_{2}\\) there are \\(5!=120\\) orders at all. Obviously, exactly one half of them satisfies the wish \\(b_{1} \\leftarrow b_{2}\\), and exactly one half of these orders satisfies another wish \\(c_{1} \\leftarrow c_{2}\\); hence, there are exactly \\(5!/ 4=30\\) good orders.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-25}\n2. One can merge the examples for 30 and 67 shown in Figs. 4b and 3 in a smarter way, obtaining a set of 13 singers representing 2010. This example is shown in Fig. 5; an arrow from/to group \\(\\left\\{b_{1}, \\ldots, b_{5}\\right\\}\\) means that there exists such arrow from each member of this group.\n\nHere, as in Fig. 4b, one can see that there are exactly 30 orders of \\(b_{1}, \\ldots, b_{5}, a_{6}, \\ldots, a_{11}\\) satisfying all their wishes among themselves. Moreover, one can prove in the same way as for Fig. 3 that each of these orders can be complemented by \\(x\\) and \\(y\\) in exactly 67 ways, hence obtaining \\(30 \\cdot 67=2010\\) good orders at all.\n\nAnalogously, one can merge the examples in Figs. 1-3 to represent 2010 by 13 singers as is shown in Fig. 6.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-26}\n(67)\n\nFig. 7\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-26(1)}\n(2010)\n\nFig. 8\n3. Finally, we will present two other improvements; the proofs are left to the reader. The graph in Fig. 7 shows how 10 singers can represent 67 . Moreover, even a company of 10 singers representing 2010 can be found; this company is shown in Fig. 8."}
{"id": "imo-shortlist-2010-c2", "question": "C2. On some planet, there are \\(2^{N}\\) countries \\((N \\geq 4)\\). Each country has a flag \\(N\\) units wide and one unit high composed of \\(N\\) fields of size \\(1 \\times 1\\), each field being either yellow or blue. No two countries have the same flag.\n\nWe say that a set of \\(N\\) flags is diverse if these flags can be arranged into an \\(N \\times N\\) square so that all \\(N\\) fields on its main diagonal will have the same color. Determine the smallest positive integer \\(M\\) such that among any \\(M\\) distinct flags, there exist \\(N\\) flags forming a diverse set.\n(Croatia)\nAnswer. \\(M=2^{N-2}+1\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2010, "solution": "When speaking about the diagonal of a square, we will always mean the main diagonal.\n\nLet \\(M_{N}\\) be the smallest positive integer satisfying the problem condition. First, we show that \\(M_{N}>2^{N-2}\\). Consider the collection of all \\(2^{N-2}\\) flags having yellow first squares and blue second ones. Obviously, both colors appear on the diagonal of each \\(N \\times N\\) square formed by these flags.\n\nWe are left to show that \\(M_{N} \\leq 2^{N-2}+1\\), thus obtaining the desired answer. We start with establishing this statement for \\(N=4\\).\n\nSuppose that we have 5 flags of length 4 . We decompose each flag into two parts of 2 squares each; thereby, we denote each flag as \\(L R\\), where the \\(2 \\times 1\\) flags \\(L, R \\in \\mathcal{S}=\\{\\mathrm{BB}, \\mathrm{BY}, \\mathrm{YB}, \\mathrm{YY}\\}\\) are its left and right parts, respectively. First, we make two easy observations on the flags \\(2 \\times 1\\) which can be checked manually.\n(i) For each \\(A \\in \\mathcal{S}\\), there exists only one \\(2 \\times 1\\) flag \\(C \\in \\mathcal{S}\\) (possibly \\(C=A\\) ) such that \\(A\\) and \\(C\\) cannot form a \\(2 \\times 2\\) square with monochrome diagonal (for part BB , that is YY , and for BY that is YB ).\n(ii) Let \\(A_{1}, A_{2}, A_{3} \\in \\mathcal{S}\\) be three distinct elements; then two of them can form a \\(2 \\times 2\\) square with yellow diagonal, and two of them can form a \\(2 \\times 2\\) square with blue diagonal (for all parts but BB , a pair (BY, YB) fits for both statements, while for all parts but BY, these pairs are \\((\\mathrm{YB}, \\mathrm{YY})\\) and \\((\\mathrm{BB}, \\mathrm{YB}))\\).\n\nNow, let \\(\\ell\\) and \\(r\\) be the numbers of distinct left and right parts of our 5 flags, respectively. The total number of flags is \\(5 \\leq r \\ell\\), hence one of the factors (say, \\(r\\) ) should be at least 3 . On the other hand, \\(\\ell, r \\leq 4\\), so there are two flags with coinciding right part; let them be \\(L_{1} R_{1}\\) and \\(L_{2} R_{1}\\left(L_{1} \\neq L_{2}\\right)\\).\n\nNext, since \\(r \\geq 3\\), there exist some flags \\(L_{3} R_{3}\\) and \\(L_{4} R_{4}\\) such that \\(R_{1}, R_{3}, R_{4}\\) are distinct. Let \\(L^{\\prime} R^{\\prime}\\) be the remaining flag. By (i), one of the pairs ( \\(L^{\\prime}, L_{1}\\) ) and ( \\(L^{\\prime}, L_{2}\\) ) can form a \\(2 \\times 2\\) square with monochrome diagonal; we can assume that \\(L^{\\prime}, L_{2}\\) form a square with a blue diagonal. Finally, the right parts of two of the flags \\(L_{1} R_{1}, L_{3} R_{3}, L_{4} R_{4}\\) can also form a \\(2 \\times 2\\) square with a blue diagonal by (ii). Putting these \\(2 \\times 2\\) squares on the diagonal of a \\(4 \\times 4\\) square, we find a desired arrangement of four flags.\n\nWe are ready to prove the problem statement by induction on \\(N\\); actually, above we have proved the base case \\(N=4\\). For the induction step, assume that \\(N>4\\), consider any \\(2^{N-2}+1\\) flags of length \\(N\\), and arrange them into a large flag of size \\(\\left(2^{N-2}+1\\right) \\times N\\). This flag contains a non-monochrome column since the flags are distinct; we may assume that this column is the first one. By the pigeonhole principle, this column contains at least \\(\\left\\lceil\\frac{2^{N-2}+1}{2}\\right\\rceil=2^{N-3}+1\\) squares of one color (say, blue). We call the flags with a blue first square good.\n\nConsider all the good flags and remove the first square from each of them. We obtain at least \\(2^{N-3}+1 \\geq M_{N-1}\\) flags of length \\(N-1\\); by the induction hypothesis, \\(N-1\\) of them\ncan form a square \\(Q\\) with the monochrome diagonal. Now, returning the removed squares, we obtain a rectangle \\((N-1) \\times N\\), and our aim is to supplement it on the top by one more flag.\n\nIf \\(Q\\) has a yellow diagonal, then we can take each flag with a yellow first square (it exists by a choice of the first column; moreover, it is not used in \\(Q\\) ). Conversely, if the diagonal of \\(Q\\) is blue then we can take any of the \\(\\geq 2^{N-3}+1-(N-1)>0\\) remaining good flags. So, in both cases we get a desired \\(N \\times N\\) square.\n\nSolution 2. We present a different proof of the estimate \\(M_{N} \\leq 2^{N-2}+1\\). We do not use the induction, involving Hall's lemma on matchings instead.\n\nConsider arbitrary \\(2^{N-2}+1\\) distinct flags and arrange them into a large \\(\\left(2^{N-2}+1\\right) \\times N\\) flag. Construct two bipartite graphs \\(G_{\\mathrm{y}}=\\left(V \\cup V^{\\prime}, E_{\\mathrm{y}}\\right)\\) and \\(G_{\\mathrm{b}}=\\left(V \\cup V^{\\prime}, E_{\\mathrm{b}}\\right)\\) with the common set of vertices as follows. Let \\(V\\) and \\(V^{\\prime}\\) be the set of columns and the set of flags under consideration, respectively. Next, let the edge ( \\(c, f\\) ) appear in \\(E_{\\mathrm{y}}\\) if the intersection of column \\(c\\) and flag \\(f\\) is yellow, and \\((c, f) \\in E_{\\mathrm{b}}\\) otherwise. Then we have to prove exactly that one of the graphs \\(G_{\\mathrm{y}}\\) and \\(G_{\\mathrm{b}}\\) contains a matching with all the vertices of \\(V\\) involved.\n\nAssume that these matchings do not exist. By Hall's lemma, it means that there exist two sets of columns \\(S_{\\mathrm{y}}, S_{\\mathrm{b}} \\subset V\\) such that \\(\\left|E_{\\mathrm{y}}\\left(S_{\\mathrm{y}}\\right)\\right| \\leq\\left|S_{\\mathrm{y}}\\right|-1\\) and \\(\\left|E_{\\mathrm{b}}\\left(S_{\\mathrm{b}}\\right)\\right| \\leq\\left|S_{\\mathrm{b}}\\right|-1\\) (in the left-hand sides, \\(E_{\\mathrm{y}}\\left(S_{\\mathrm{y}}\\right)\\) and \\(E_{\\mathrm{b}}\\left(S_{\\mathrm{b}}\\right)\\) denote respectively the sets of all vertices connected to \\(S_{\\mathrm{y}}\\) and \\(S_{\\mathrm{b}}\\) in the corresponding graphs). Our aim is to prove that this is impossible. Note that \\(S_{\\mathrm{y}}, S_{\\mathrm{b}} \\neq V\\) since \\(N \\leq 2^{N-2}+1\\).\n\nFirst, suppose that \\(S_{\\mathrm{y}} \\cap S_{\\mathrm{b}} \\neq \\varnothing\\), so there exists some \\(c \\in S_{\\mathrm{y}} \\cap S_{\\mathrm{b}}\\). Note that each flag is connected to \\(c\\) either in \\(G_{\\mathrm{y}}\\) or in \\(G_{\\mathrm{b}}\\), hence \\(E_{\\mathrm{y}}\\left(S_{\\mathrm{y}}\\right) \\cup E_{\\mathrm{b}}\\left(S_{\\mathrm{b}}\\right)=V^{\\prime}\\). Hence we have \\(2^{N-2}+1=\\left|V^{\\prime}\\right| \\leq\\left|E_{\\mathrm{y}}\\left(S_{\\mathrm{y}}\\right)\\right|+\\left|E_{\\mathrm{b}}\\left(S_{\\mathrm{b}}\\right)\\right| \\leq\\left|S_{\\mathrm{y}}\\right|+\\left|S_{\\mathrm{b}}\\right|-2 \\leq 2 N-4\\); this is impossible for \\(N \\geq 4\\).\n\nSo, we have \\(S_{\\mathrm{y}} \\cap S_{\\mathrm{b}}=\\varnothing\\). Let \\(y=\\left|S_{\\mathrm{y}}\\right|, b=\\left|S_{\\mathrm{b}}\\right|\\). From the construction of our graph, we have that all the flags in the set \\(V^{\\prime \\prime}=V^{\\prime} \\backslash\\left(E_{\\mathrm{y}}\\left(S_{\\mathrm{y}}\\right) \\cup E_{\\mathrm{b}}\\left(S_{\\mathrm{b}}\\right)\\right)\\) have blue squares in the columns of \\(S_{\\mathrm{y}}\\) and yellow squares in the columns of \\(S_{\\mathrm{b}}\\). Hence the only undetermined positions in these flags are the remaining \\(N-y-b\\) ones, so \\(2^{N-y-b} \\geq\\left|V^{\\prime \\prime}\\right| \\geq\\left|V^{\\prime}\\right|-\\left|E_{\\mathrm{y}}\\left(S_{\\mathrm{y}}\\right)\\right|-\\left|E_{\\mathrm{b}}\\left(S_{\\mathrm{b}}\\right)\\right| \\geq\\) \\(2^{N-2}+1-(y-1)-(b-1)\\), or, denoting \\(c=y+b, 2^{N-c}+c>2^{N-2}+2\\). This is impossible since \\(N \\geq c \\geq 2\\)."}
{"id": "imo-shortlist-2010-c3", "question": "C3. 2500 chess kings have to be placed on a \\(100 \\times 100\\) chessboard so that\n(i) no king can capture any other one (i.e. no two kings are placed in two squares sharing a common vertex);\n(ii) each row and each column contains exactly 25 kings.\n\nFind the number of such arrangements. (Two arrangements differing by rotation or symmetry are supposed to be different.)\n(Russia)\nAnswer. There are two such arrangements.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2010, "solution": "Suppose that we have an arrangement satisfying the problem conditions. Divide the board into \\(2 \\times 2\\) pieces; we call these pieces blocks. Each block can contain not more than one king (otherwise these two kings would attack each other); hence, by the pigeonhole principle each block must contain exactly one king.\n\nNow assign to each block a letter T or B if a king is placed in its top or bottom half, respectively. Similarly, assign to each block a letter L or R if a king stands in its left or right half. So we define \\(T\\)-blocks, \\(B\\)-blocks, \\(L\\)-blocks, and \\(R\\)-blocks. We also combine the letters; we call a block a \\(T L\\)-block if it is simultaneously T-block and L-block. Similarly we define \\(T R\\)-blocks, \\(B L\\)-blocks, and BR-blocks. The arrangement of blocks determines uniquely the arrangement of kings; so in the rest of the solution we consider the \\(50 \\times 50\\) system of blocks (see Fig. 1). We identify the blocks by their coordinate pairs; the pair \\((i, j)\\), where \\(1 \\leq i, j \\leq 50\\), refers to the \\(j\\) th block in the \\(i\\) th row (or the \\(i\\) th block in the \\(j\\) th column). The upper-left block is \\((1,1)\\).\n\nThe system of blocks has the following properties..\n(i') If \\((i, j)\\) is a B-block then \\((i+1, j)\\) is a B-block: otherwise the kings in these two blocks can take each other. Similarly: if \\((i, j)\\) is a T-block then \\((i-1, j)\\) is a T-block; if \\((i, j)\\) is an L-block then \\((i, j-1)\\) is an L-block; if \\((i, j)\\) is an R-block then \\((i, j+1)\\) is an R-block.\n(ii') Each column contains exactly 25 L-blocks and 25 R-blocks, and each row contains exactly 25 T-blocks and 25 B-blocks. In particular, the total number of L-blocks (or R-blocks, or T-blocks, or B-blocks) is equal to \\(25 \\cdot 50=1250\\).\n\nConsider any B-block of the form \\((1, j)\\). By ( \\(\\mathrm{i}^{\\prime}\\) ), all blocks in the \\(j\\) th column are B-blocks; so we call such a column B-column. By (ii'), we have 25 B -blocks in the first row, so we obtain 25 B -columns. These 25 B -columns contain 1250 B -blocks, hence all blocks in the remaining columns are T-blocks, and we obtain \\(25 T\\)-columns. Similarly, there are exactly \\(25 L\\)-rows and exactly \\(25 R\\)-rows.\n\nNow consider an arbitrary pair of a T-column and a neighboring B-column (columns with numbers \\(j\\) and \\(j+1)\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-29}\n\nFig. 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-29(1)}\n\nFig. 2\n\nCase 1. Suppose that the \\(j\\) th column is a T-column, and the \\((j+1)\\) th column is a Bcolumn. Consider some index \\(i\\) such that the \\(i\\) th row is an L-row; then \\((i, j+1)\\) is a BL-block. Therefore, \\((i+1, j)\\) cannot be a TR-block (see Fig. 2), hence \\((i+1, j)\\) is a TL-block, thus the\n\\((i+1)\\) th row is an L-row. Now, choosing the \\(i\\) th row to be the topmost L-row, we successively obtain that all rows from the \\(i\\) th to the 50 th are L-rows. Since we have exactly 25 L-rows, it follows that the rows from the 1st to the 25th are R-rows, and the rows from the 26th to the 50th are L-rows.\n\nNow consider the neighboring R-row and L-row (that are the rows with numbers 25 and 26). Replacing in the previous reasoning rows by columns and vice versa, the columns from the 1 st to the 25 th are T-columns, and the columns from the 26 th to the 50 th are B-columns. So we have a unique arrangement of blocks that leads to the arrangement of kings satisfying the condition of the problem (see Fig. 3).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-30(1)}\n\nFig. 3\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-30}\n\nFig. 4\n\nCase 2. Suppose that the \\(j\\) th column is a B-column, and the \\((j+1)\\) th column is a T-column. Repeating the arguments from Case 1, we obtain that the rows from the 1st to the 25 th are L-rows (and all other rows are R-rows), the columns from the 1st to the 25th are B-columns (and all other columns are T-columns), so we find exactly one more arrangement of kings (see Fig. 4)."}
{"id": "imo-shortlist-2010-c4", "question": "C4. Six stacks \\(S_{1}, \\ldots, S_{6}\\) of coins are standing in a row. In the beginning every stack contains a single coin. There are two types of allowed moves:\n\nMove 1: If stack \\(S_{k}\\) with \\(1 \\leq k \\leq 5\\) contains at least one coin, you may remove one coin from \\(S_{k}\\) and add two coins to \\(S_{k+1}\\).\nMove 2: If stack \\(S_{k}\\) with \\(1 \\leq k \\leq 4\\) contains at least one coin, then you may remove one coin from \\(S_{k}\\) and exchange stacks \\(S_{k+1}\\) and \\(S_{k+2}\\).\n\nDecide whether it is possible to achieve by a sequence of such moves that the first five stacks are empty, whereas the sixth stack \\(S_{6}\\) contains exactly \\(2010^{2010^{2010}}\\) coins.\n\\(\\mathbf{C 4}^{\\prime}\\). Same as Problem C4, but the constant \\(2010^{2010^{2010}}\\) is replaced by \\(2010^{2010}\\).\n(Netherlands)\nAnswer. Yes (in both variants of the problem). There exists such a sequence of moves.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2010, "solution": "Denote by \\(\\left(a_{1}, a_{2}, \\ldots, a_{n}\\right) \\rightarrow\\left(a_{1}^{\\prime}, a_{2}^{\\prime}, \\ldots, a_{n}^{\\prime}\\right)\\) the following: if some consecutive stacks contain \\(a_{1}, \\ldots, a_{n}\\) coins, then it is possible to perform several allowed moves such that the stacks contain \\(a_{1}^{\\prime}, \\ldots, a_{n}^{\\prime}\\) coins respectively, whereas the contents of the other stacks remain unchanged.\n\nLet \\(A=2010^{2010}\\) or \\(A=2010^{2010^{2010}}\\), respectively. Our goal is to show that\n\n\\[\n(1,1,1,1,1,1) \\rightarrow(0,0,0,0,0, A)\n\\]\n\nFirst we prove two auxiliary observations.\nLemma 1. \\((a, 0,0) \\rightarrow\\left(0,2^{a}, 0\\right)\\) for every \\(a \\geq 1\\).\nProof. We prove by induction that \\((a, 0,0) \\rightarrow\\left(a-k, 2^{k}, 0\\right)\\) for every \\(1 \\leq k \\leq a\\). For \\(k=1\\), apply Move 1 to the first stack:\n\n\\[\n(a, 0,0) \\rightarrow(a-1,2,0)=\\left(a-1,2^{1}, 0\\right)\n\\]\n\nNow assume that \\(k<a\\) and the statement holds for some \\(k<a\\). Starting from \\(\\left(a-k, 2^{k}, 0\\right)\\), apply Move 1 to the middle stack \\(2^{k}\\) times, until it becomes empty. Then apply Move 2 to the first stack:\n\n\\[\n\\left(a-k, 2^{k}, 0\\right) \\rightarrow\\left(a-k, 2^{k}-1,2\\right) \\rightarrow \\cdots \\rightarrow\\left(a-k, 0,2^{k+1}\\right) \\rightarrow\\left(a-k-1,2^{k+1}, 0\\right)\n\\]\n\nHence,\n\n\\[\n(a, 0,0) \\rightarrow\\left(a-k, 2^{k}, 0\\right) \\rightarrow\\left(a-k-1,2^{k+1}, 0\\right)\n\\]\n\nLemma 2. For every positive integer \\(n\\), let \\(P_{n}=\\underbrace{2^{2} .^{2^{2}}}_{n}\\) (e.g. \\(P_{3}=2^{2^{2}}=16\\) ). Then \\((a, 0,0,0) \\rightarrow\\left(0, P_{a}, 0,0\\right)\\) for every \\(a \\geq 1\\).\nProof. Similarly to Lemma 1, we prove that \\((a, 0,0,0) \\rightarrow\\left(a-k, P_{k}, 0,0\\right)\\) for every \\(1 \\leq k \\leq a\\).\nFor \\(k=1\\), apply Move 1 to the first stack:\n\n\\[\n(a, 0,0,0) \\rightarrow(a-1,2,0,0)=\\left(a-1, P_{1}, 0,0\\right)\n\\]\n\nNow assume that the lemma holds for some \\(k<a\\). Starting from ( \\(a-k, P_{k}, 0,0\\) ), apply Lemma 1, then apply Move 1 to the first stack:\n\n\\[\n\\left(a-k, P_{k}, 0,0\\right) \\rightarrow\\left(a-k, 0,2^{P_{k}}, 0\\right)=\\left(a-k, 0, P_{k+1}, 0\\right) \\rightarrow\\left(a-k-1, P_{k+1}, 0,0\\right)\n\\]\n\nTherefore,\n\n\\[\n(a, 0,0,0) \\rightarrow\\left(a-k, P_{k}, 0,0\\right) \\rightarrow\\left(a-k-1, P_{k+1}, 0,0\\right)\n\\]\n\nNow we prove the statement of the problem.\nFirst apply Move 1 to stack 5, then apply Move 2 to stacks \\(S_{4}, S_{3}, S_{2}\\) and \\(S_{1}\\) in this order. Then apply Lemma 2 twice:\n\n\\[\n\\begin{gathered}\n(1,1,1,1,1,1) \\rightarrow(1,1,1,1,0,3) \\rightarrow(1,1,1,0,3,0) \\rightarrow(1,1,0,3,0,0) \\rightarrow(1,0,3,0,0,0) \\rightarrow \n\\rightarrow(0,3,0,0,0,0) \\rightarrow\\left(0,0, P_{3}, 0,0,0\\right)=(0,0,16,0,0,0) \\rightarrow\\left(0,0,0, P_{16}, 0,0\\right)\n\n\\]\n\nWe already have more than \\(A\\) coins in stack \\(S_{4}\\), since\n\n\\[\nA \\leq 2010^{2010^{2010}}<\\left(2^{11}\\right)^{2010^{2010}}=2^{11 \\cdot 2010^{2010}}<2^{2010^{2011}}<2^{\\left(2^{11}\\right)^{2011}}=2^{2^{11 \\cdot 2011}}<2^{2^{2^{15}}}<P_{16}\n\\]\n\nTo decrease the number of coins in stack \\(S_{4}\\), apply Move 2 to this stack repeatedly until its size decreases to \\(A / 4\\). (In every step, we remove a coin from \\(S_{4}\\) and exchange the empty stacks \\(S_{5}\\) and \\(S_{6}\\).)\n\n\\[\n\\begin{aligned}\n\\left(0,0,0, P_{16}, 0,0\\right) \\rightarrow & \\left(0,0,0, P_{16}-1,0,0\\right) \\rightarrow\\left(0,0,0, P_{16}-2,0,0\\right) \\rightarrow \n& \\rightarrow \\cdots \\rightarrow(0,0,0, A / 4,0,0)\n\n\\]\n\nFinally, apply Move 1 repeatedly to empty stacks \\(S_{4}\\) and \\(S_{5}\\) :\n\n\\[\n(0,0,0, A / 4,0,0) \\rightarrow \\cdots \\rightarrow(0,0,0,0, A / 2,0) \\rightarrow \\cdots \\rightarrow(0,0,0,0,0, A)\n\\]\n\nComment 1. Starting with only 4 stack, it is not hard to check manually that we can achieve at most 28 coins in the last position. However, around 5 and 6 stacks the maximal number of coins explodes. With 5 stacks it is possible to achieve more than \\(2^{2^{14}}\\) coins. With 6 stacks the maximum is greater than \\(P_{P_{2^{14}}}\\).\n\nIt is not hard to show that the numbers \\(2010^{2010}\\) and \\(2010^{2010^{2010}}\\) in the problem can be replaced by any nonnegative integer up to \\(P_{P_{2^{14}}}\\).\nComment 2. The simpler variant \\(\\mathrm{C}^{\\prime} 4^{\\prime}\\) of the problem can be solved without Lemma 2:\n\n\\[\n\\begin{aligned}\n(1,1,1,1,1,1) & \\rightarrow(0,3,1,1,1,1) \\rightarrow(0,1,5,1,1,1) \\rightarrow(0,1,1,9,1,1) \\rightarrow \n& \\rightarrow(0,1,1,1,17,1) \\rightarrow(0,1,1,1,0,35) \\rightarrow(0,1,1,0,35,0) \\rightarrow(0,1,0,35,0,0) \\rightarrow \n& \\rightarrow(0,0,35,0,0,0) \\rightarrow\\left(0,0,1,2^{34}, 0,0\\right) \\rightarrow\\left(0,0,1,0,2^{2^{34}}, 0\\right) \\rightarrow\\left(0,0,0,2^{2^{34}}, 0,0\\right) \n& \\rightarrow\\left(0,0,0,2^{2^{34}}-1,0,0\\right) \\rightarrow \\ldots \\rightarrow(0,0,0, A / 4,0,0) \\rightarrow(0,0,0,0, A / 2,0) \\rightarrow(0,0,0,0,0, A)\n\n\\]\n\nFor this reason, the PSC suggests to consider the problem C4 as well. Problem C4 requires more invention and technical care. On the other hand, the problem statement in C 4 ' hides the fact that the resulting amount of coins can be such incredibly huge and leaves this discovery to the students."}
{"id": "imo-shortlist-2010-c5", "question": "C5. \\(n \\geq 4\\) players participated in a tennis tournament. Any two players have played exactly one game, and there was no tie game. We call a company of four players bad if one player was defeated by the other three players, and each of these three players won a game and lost another game among themselves. Suppose that there is no bad company in this tournament. Let \\(w_{i}\\) and \\(\\ell_{i}\\) be respectively the number of wins and losses of the \\(i\\) th player. Prove that\n\n\\[\n\\sum_{i=1}^{n}\\left(w_{i}-\\ell_{i}\\right)^{3} \\geq 0\n\\]\n\n(South Korea)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2010, "solution": "For any tournament \\(T\\) satisfying the problem condition, denote by \\(S(T)\\) sum under consideration, namely\n\n\\[\nS(T)=\\sum_{i=1}^{n}\\left(w_{i}-\\ell_{i}\\right)^{3}\n\\]\n\nFirst, we show that the statement holds if a tournament \\(T\\) has only 4 players. Actually, let \\(A=\\left(a_{1}, a_{2}, a_{3}, a_{4}\\right)\\) be the number of wins of the players; we may assume that \\(a_{1} \\geq a_{2} \\geq a_{3} \\geq a_{4}\\). We have \\(a_{1}+a_{2}+a_{3}+a_{4}=\\binom{4}{2}=6\\), hence \\(a_{4} \\leq 1\\). If \\(a_{4}=0\\), then we cannot have \\(a_{1}=a_{2}=a_{3}=2\\), otherwise the company of all players is bad. Hence we should have \\(A=(3,2,1,0)\\), and \\(S(T)=3^{3}+1^{3}+(-1)^{3}+(-3)^{3}=0\\). On the other hand, if \\(a_{4}=1\\), then only two possibilities, \\(A=(3,1,1,1)\\) and \\(A=(2,2,1,1)\\) can take place. In the former case we have \\(S(T)=3^{3}+3 \\cdot(-2)^{3}>0\\), while in the latter one \\(S(T)=1^{3}+1^{3}+(-1)^{3}+(-1)^{3}=0\\), as desired.\n\nNow we turn to the general problem. Consider a tournament \\(T\\) with no bad companies and enumerate the players by the numbers from 1 to \\(n\\). For every 4 players \\(i_{1}, i_{2}, i_{3}, i_{4}\\) consider a \"sub-tournament\" \\(T_{i_{1} i_{2} i_{3} i_{4}}\\) consisting of only these players and the games which they performed with each other. By the abovementioned, we have \\(S\\left(T_{i_{1} i_{2} i_{3} i_{4}}\\right) \\geq 0\\). Our aim is to prove that\n\n\\[\nS(T)=\\sum_{i_{1}, i_{2}, i_{3}, i_{4}} S\\left(T_{i_{1} i_{2} i_{3} i_{4}}\\right),\n\\]\n\nwhere the sum is taken over all 4 -tuples of distinct numbers from the set \\(\\{1, \\ldots, n\\}\\). This way the problem statement will be established.\n\nWe interpret the number \\(\\left(w_{i}-\\ell_{i}\\right)^{3}\\) as following. For \\(i \\neq j\\), let \\(\\varepsilon_{i j}=1\\) if the \\(i\\) th player wins against the \\(j\\) th one, and \\(\\varepsilon_{i j}=-1\\) otherwise. Then\n\n\\[\n\\left(w_{i}-\\ell_{i}\\right)^{3}=\\left(\\sum_{j \\neq i} \\varepsilon_{i j}\\right)^{3}=\\sum_{j_{1}, j_{2}, j_{3} \\neq i} \\varepsilon_{i j_{1}} \\varepsilon_{i j_{2}} \\varepsilon_{i j_{3}} .\n\\]\n\nHence,\n\n\\[\nS(T)=\\sum_{i \\notin\\left\\{j_{1}, j_{2}, j_{3}\\right\\}} \\varepsilon_{i j_{1}} \\varepsilon_{i j_{2}} \\varepsilon_{i j_{3}}\n\\]\n\nTo simplify this expression, consider all the terms in this sum where two indices are equal. If, for instance, \\(j_{1}=j_{2}\\), then the term contains \\(\\varepsilon_{i j_{1}}^{2}=1\\), so we can replace this term by \\(\\varepsilon_{i j_{3}}\\). Make such replacements for each such term; obviously, after this change each term of the form \\(\\varepsilon_{i j_{3}}\\) will appear \\(P(T)\\) times, hence\n\n\\[\nS(T)=\\sum_{\\left|\\left\\{i, j_{1}, j_{2}, j_{3}\\right\\}\\right|=4} \\varepsilon_{i j_{1}} \\varepsilon_{i j_{2}} \\varepsilon_{i j_{3}}+P(T) \\sum_{i \\neq j} \\varepsilon_{i j}=S_{1}(T)+P(T) S_{2}(T)\n\\]\n\nWe show that \\(S_{2}(T)=0\\) and hence \\(S(T)=S_{1}(T)\\) for each tournament. Actually, note that \\(\\varepsilon_{i j}=-\\varepsilon_{j i}\\), and the whole sum can be split into such pairs. Since the sum in each pair is 0 , so is \\(S_{2}(T)\\).\n\nThus the desired equality (2) rewrites as\n\n\\[\nS_{1}(T)=\\sum_{i_{1}, i_{2}, i_{3}, i_{4}} S_{1}\\left(T_{i_{1} i_{2} i_{3} i_{4}}\\right)\n\\]\n\nNow, if all the numbers \\(j_{1}, j_{2}, j_{3}\\) are distinct, then the set \\(\\left\\{i, j_{1}, j_{2}, j_{3}\\right\\}\\) is contained in exactly one 4 -tuple, hence the term \\(\\varepsilon_{i j_{1}} \\varepsilon_{i j_{2}} \\varepsilon_{i j_{3}}\\) appears in the right-hand part of (3) exactly once, as well as in the left-hand part. Clearly, there are no other terms in both parts, so the equality is established.\n\nSolution 2. Similarly to the first solution, we call the subsets of players as companies, and the \\(k\\)-element subsets will be called as \\(k\\)-companies.\n\nIn any company of the players, call a player the local champion of the company if he defeated all other members of the company. Similarly, if a player lost all his games against the others in the company then call him the local loser of the company. Obviously every company has at most one local champion and at most one local loser. By the condition of the problem, whenever a 4-company has a local loser, then this company has a local champion as well.\n\nSuppose that \\(k\\) is some positive integer, and let us count all cases when a player is the local champion of some \\(k\\)-company. The \\(i\\) th player won against \\(w_{i}\\) other player. To be the local champion of a \\(k\\)-company, he must be a member of the company, and the other \\(k-1\\) members must be chosen from those whom he defeated. Therefore, the \\(i\\) th player is the local champion of \\(\\binom{w_{i}}{k-1} k\\)-companies. Hence, the total number of local champions of all \\(k\\)-companies is \\(\\sum_{i=1}^{n}\\binom{w_{i}}{k-1}\\).\n\nSimilarly, the total number of local losers of the \\(k\\)-companies is \\(\\sum_{i=1}^{n}\\binom{\\ell_{i}}{k-1}\\).\nNow apply this for \\(k=2,3\\) and 4 .\nSince every game has a winner and a loser, we have \\(\\sum_{i=1}^{n} w_{i}=\\sum_{i=1}^{n} \\ell_{i}=\\binom{n}{2}\\), and hence\n\n\\[\n\\sum_{i=1}^{n}\\left(w_{i}-\\ell_{i}\\right)=0\n\\]\n\nIn every 3-company, either the players defeated one another in a cycle or the company has both a local champion and a local loser. Therefore, the total number of local champions and local losers in the 3 -companies is the same, \\(\\sum_{i=1}^{n}\\binom{w_{i}}{2}=\\sum_{i=1}^{n}\\binom{\\ell_{i}}{2}\\). So we have\n\n\\[\n\\sum_{i=1}^{n}\\left(\\binom{w_{i}}{2}-\\binom{\\ell_{i}}{2}\\right)=0\n\\]\n\nIn every 4-company, by the problem's condition, the number of local losers is less than or equal to the number of local champions. Then the same holds for the total numbers of local\nchampions and local losers in all 4-companies, so \\(\\sum_{i=1}^{n}\\binom{w_{i}}{3} \\geq \\sum_{i=1}^{n}\\binom{\\ell_{i}}{3}\\). Hence,\n\n\\[\n\\sum_{i=1}^{n}\\left(\\binom{w_{i}}{3}-\\binom{\\ell_{i}}{3}\\right) \\geq 0\n\\]\n\nNow we establish the problem statement (1) as a linear combination of (4), (5) and (6). It is easy check that\n\n\\[\n(x-y)^{3}=24\\left(\\binom{x}{3}-\\binom{y}{3}\\right)+24\\left(\\binom{x}{2}-\\binom{y}{2}\\right)-\\left(3(x+y)^{2}-4\\right)(x-y)\n\\]\n\nApply this identity to \\(x=w_{1}\\) and \\(y=\\ell_{i}\\). Since every player played \\(n-1\\) games, we have \\(w_{i}+\\ell_{i}=n-1\\), and thus\n\n\\[\n\\left(w_{i}-\\ell_{i}\\right)^{3}=24\\left(\\binom{w_{i}}{3}-\\binom{\\ell_{i}}{3}\\right)+24\\left(\\binom{w_{i}}{2}-\\binom{\\ell_{i}}{2}\\right)-\\left(3(n-1)^{2}-4\\right)\\left(w_{i}-\\ell_{i}\\right)\n\\]\n\nThen\n\n\\[\n\\sum_{i=1}^{n}\\left(w_{i}-\\ell_{i}\\right)^{3}=24 \\underbrace{\\sum_{i=1}^{n}\\left(\\binom{w_{i}}{3}-\\binom{\\ell_{i}}{3}\\right)}_{\\geq 0}+24 \\underbrace{\\sum_{i=1}^{n}\\left(\\binom{w_{i}}{2}-\\binom{\\ell_{i}}{2}\\right)}_{0}-\\left(3(n-1)^{2}-4\\right) \\underbrace{\\sum_{i=1}^{n}\\left(w_{i}-\\ell_{i}\\right)}_{0} \\geq 0\n\\]"}
{"id": "imo-shortlist-2010-c6", "question": "C6. Given a positive integer \\(k\\) and other two integers \\(b>w>1\\). There are two strings of pearls, a string of \\(b\\) black pearls and a string of \\(w\\) white pearls. The length of a string is the number of pearls on it.\n\nOne cuts these strings in some steps by the following rules. In each step:\n(i) The strings are ordered by their lengths in a non-increasing order. If there are some strings of equal lengths, then the white ones precede the black ones. Then \\(k\\) first ones (if they consist of more than one pearl) are chosen; if there are less than \\(k\\) strings longer than 1 , then one chooses all of them.\n(ii) Next, one cuts each chosen string into two parts differing in length by at most one.\n(For instance, if there are strings of 5, 4, 4, 2 black pearls, strings of 8, 4,3 white pearls and \\(k=4\\), then the strings of 8 white, 5 black, 4 white and 4 black pearls are cut into the parts \\((4,4),(3,2),(2,2)\\) and \\((2,2)\\), respectively.)\n\nThe process stops immediately after the step when a first isolated white pearl appears. Prove that at this stage, there will still exist a string of at least two black pearls.\n(Canada)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2010, "solution": "Denote the situation after the \\(i\\) th step by \\(A_{i}\\); hence \\(A_{0}\\) is the initial situation, and \\(A_{i-1} \\rightarrow A_{i}\\) is the \\(i\\) th step. We call a string containing \\(m\\) pearls an \\(m\\)-string; it is an \\(m\\)-w-string or a m-b-string if it is white or black, respectively.\n\nWe continue the process until every string consists of a single pearl. We will focus on three moments of the process: (a) the first stage \\(A_{s}\\) when the first 1 -string (no matter black or white) appears; (b) the first stage \\(A_{t}\\) where the total number of strings is greater than \\(k\\) (if such moment does not appear then we put \\(t=\\infty\\) ); and (c) the first stage \\(A_{f}\\) when all black pearls are isolated. It is sufficient to prove that in \\(A_{f-1}\\) (or earlier), a 1-w-string appears.\n\nWe start with some easy properties of the situations under consideration. Obviously, we have \\(s \\leq f\\). Moreover, all b-strings from \\(A_{f-1}\\) become single pearls in the \\(f\\) th step, hence all of them are 1- or 2-b-strings.\n\nNext, observe that in each step \\(A_{i} \\rightarrow A_{i+1}\\) with \\(i \\leq t-1\\), all ( \\(>1\\) )-strings were cut since there are not more than \\(k\\) strings at all; if, in addition, \\(i<s\\), then there were no 1 -string, so all the strings were cut in this step.\n\nNow, let \\(B_{i}\\) and \\(b_{i}\\) be the lengths of the longest and the shortest b-strings in \\(A_{i}\\), and let \\(W_{i}\\) and \\(w_{i}\\) be the same for \\(w\\)-strings. We show by induction on \\(i \\leq \\min \\{s, t\\}\\) that (i) the situation \\(A_{i}\\) contains exactly \\(2^{i}\\) black and \\(2^{i}\\) white strings, (ii) \\(B_{i} \\geq W_{i}\\), and (iii) \\(b_{i} \\geq w_{i}\\). The base case \\(i=0\\) is obvious. For the induction step, if \\(i \\leq \\min \\{s, t\\}\\) then in the \\(i\\) th step, each string is cut, thus the claim (i) follows from the induction hypothesis; next, we have \\(B_{i}=\\left\\lceil B_{i-1} / 2\\right\\rceil \\geq\\left\\lceil W_{i-1} / 2\\right\\rceil=W_{i}\\) and \\(b_{i}=\\left\\lfloor b_{i-1} / 2\\right\\rfloor \\geq\\left\\lfloor w_{i-1} / 2\\right\\rfloor=w_{i}\\), thus establishing (ii) and (iii).\n\nFor the numbers \\(s, t, f\\), two cases are possible.\nCase 1. Suppose that \\(s \\leq t\\) or \\(f \\leq t+1\\) (and hence \\(s \\leq t+1\\) ); in particular, this is true when \\(t=\\infty\\). Then in \\(A_{s-1}\\) we have \\(B_{s-1} \\geq W_{s-1}, b_{s-1} \\geq w_{s-1}>1\\) as \\(s-1 \\leq \\min \\{s, t\\}\\). Now, if \\(s=f\\), then in \\(A_{s-1}\\), there is no 1 -w-string as well as no ( \\(>2\\) )-b-string. That is, \\(2=B_{s-1} \\geq W_{s-1} \\geq b_{s-1} \\geq w_{s-1}>1\\), hence all these numbers equal 2 . This means that in \\(A_{s-1}\\), all strings contain 2 pearls, and there are \\(2^{s-1}\\) black and \\(2^{s-1}\\) white strings, which means \\(b=2 \\cdot 2^{s-1}=w\\). This contradicts the problem conditions.\n\nHence we have \\(s \\leq f-1\\) and thus \\(s \\leq t\\). Therefore, in the \\(s\\) th step each string is cut into two parts. Now, if a 1 -b-string appears in this step, then from \\(w_{s-1} \\leq b_{s-1}\\) we see that a\n\n1-w-string appears as well; so, in each case in the \\(s\\) th step a 1-w-string appears, while not all black pearls become single, as desired.\n\nCase 2. Now assume that \\(t+1 \\leq s\\) and \\(t+2 \\leq f\\). Then in \\(A_{t}\\) we have exactly \\(2^{t}\\) white and \\(2^{t}\\) black strings, all being larger than 1 , and \\(2^{t+1}>k \\geq 2^{t}\\) (the latter holds since \\(2^{t}\\) is the total number of strings in \\(A_{t-1}\\) ). Now, in the ( \\(t+1\\) )st step, exactly \\(k\\) strings are cut, not more than \\(2^{t}\\) of them being black; so the number of w -strings in \\(A_{t+1}\\) is at least \\(2^{t}+\\left(k-2^{t}\\right)=k\\). Since the number of w-strings does not decrease in our process, in \\(A_{f-1}\\) we have at least \\(k\\) white strings as well.\n\nFinally, in \\(A_{f-1}\\), all b-strings are not larger than 2, and at least one 2-b-string is cut in the \\(f\\) th step. Therefore, at most \\(k-1\\) white strings are cut in this step, hence there exists a w-string \\(\\mathcal{W}\\) which is not cut in the \\(f\\) th step. On the other hand, since a 2 -b-string is cut, all \\((\\geq 2)\\)-w-strings should also be cut in the \\(f\\) th step; hence \\(\\mathcal{W}\\) should be a single pearl. This is exactly what we needed.\nComment. In this solution, we used the condition \\(b \\neq w\\) only to avoid the case \\(b=w=2^{t}\\). Hence, if a number \\(b=w\\) is not a power of 2 , then the problem statement is also valid.\n\nSolution 2. We use the same notations as introduced in the first paragraph of the previous solution. We claim that at every stage, there exist a \\(u\\)-b-string and a \\(v\\)-w-string such that either\n(i) \\(u>v \\geq 1\\), or\n(ii) \\(2 \\leq u \\leq v<2 u\\), and there also exist \\(k-1\\) of ( \\(>v / 2\\) )-strings other than considered above.\n\nFirst, we notice that this statement implies the problem statement. Actually, in both cases (i) and (ii) we have \\(u>1\\), so at each stage there exists a ( \\(\\geq 2\\) )-b-string, and for the last stage it is exactly what we need.\n\nNow, we prove the claim by induction on the number of the stage. Obviously, for \\(A_{0}\\) the condition (i) holds since \\(b>w\\). Further, we suppose that the statement holds for \\(A_{i}\\), and prove it for \\(A_{i+1}\\). Two cases are possible.\n\nCase 1. Assume that in \\(A_{i}\\), there are a \\(u\\)-b-string and a \\(v\\)-w-string with \\(u>v\\). We can assume that \\(v\\) is the length of the shortest w-string in \\(A_{i}\\); since we are not at the final stage, we have \\(v \\geq 2\\). Now, in the \\((i+1)\\) st step, two subcases may occur.\n\nSubcase 1a. Suppose that either no \\(u\\)-b-string is cut, or both some \\(u\\)-b-string and some \\(v\\)-w-string are cut. Then in \\(A_{i+1}\\), we have either a \\(u\\)-b-string and a ( \\(\\leq v\\) )-w-string (and (i) is valid), or we have a \\([u / 2]\\)-b-string and a \\(\\lfloor v / 2\\rfloor-\\mathrm{w}\\)-string. In the latter case, from \\(u>v\\) we get \\(\\lceil u / 2\\rceil>\\lfloor v / 2\\rfloor\\), and (i) is valid again.\n\nSubcase 1b. Now, some \\(u\\)-b-string is cut, and no \\(v\\)-w-string is cut (and hence all the strings which are cut are longer than \\(v\\) ). If \\(u^{\\prime}=\\lceil u / 2\\rceil>v\\), then the condition (i) is satisfied since we have a \\(u^{\\prime}\\)-b-string and a \\(v\\)-w-string in \\(A_{i+1}\\). Otherwise, notice that the inequality \\(u>v \\geq 2\\) implies \\(u^{\\prime} \\geq 2\\). Furthermore, besides a fixed \\(u\\)-b-string, other \\(k-1\\) of ( \\(\\geq v+1\\) )-strings should be cut in the \\((i+1)\\) st step, hence providing at least \\(k-1\\) of \\((\\geq\\lceil(v+1) / 2\\rceil)\\)-strings, and \\(\\lceil(v+1) / 2\\rceil>v / 2\\). So, we can put \\(v^{\\prime}=v\\), and we have \\(u^{\\prime} \\leq v<u \\leq 2 u^{\\prime}\\), so the condition (ii) holds for \\(A_{i+1}\\).\n\nCase 2. Conversely, assume that in \\(A_{i}\\) there exist a \\(u\\)-b-string, a \\(v\\)-w-string \\((2 \\leq u \\leq v<2 u)\\) and a set \\(S\\) of \\(k-1\\) other strings larger than \\(v / 2\\) (and hence larger than 1 ). In the \\((i+1)\\) st step, three subcases may occur.\n\nSubcase 2a. Suppose that some \\(u\\)-b-string is not cut, and some \\(v\\)-w-string is cut. The latter one results in a \\(\\lfloor v / 2\\rfloor\\)-w-string, we have \\(v^{\\prime}=\\lfloor v / 2\\rfloor<u\\), and the condition (i) is valid.\n\nSubcase 2b. Next, suppose that no \\(v\\)-w-string is cut (and therefore no \\(u\\)-b-string is cut as \\(u \\leq v)\\). Then all \\(k\\) strings which are cut have the length \\(>v\\), so each one results in a ( \\(>v / 2\\) )string. Hence in \\(A_{i+1}\\), there exist \\(k \\geq k-1\\) of ( \\(>v / 2\\) )-strings other than the considered \\(u\\) - and \\(v\\)-strings, and the condition (ii) is satisfied.\n\nSubcase 2c. In the remaining case, all \\(u\\)-b-strings are cut. This means that all ( \\(\\geq u\\) )-strings are cut as well, hence our \\(v\\)-w-string is cut. Therefore in \\(A_{i+1}\\) there exists a \\(\\lceil u / 2\\rceil\\)-b-string together with a \\(\\lfloor v / 2\\rfloor\\)-w-string. Now, if \\(u^{\\prime}=\\lceil u / 2\\rceil>\\lfloor v / 2\\rfloor=v^{\\prime}\\) then the condition (i) is fulfilled. Otherwise, we have \\(u^{\\prime} \\leq v^{\\prime}<u \\leq 2 u^{\\prime}\\). In this case, we show that \\(u^{\\prime} \\geq 2\\). If, to the contrary, \\(u^{\\prime}=1\\) (and hence \\(u=2\\) ), then all black and white ( \\(\\geq 2\\) )-strings should be cut in the \\((i+1)\\) st step, and among these strings there are at least a \\(u\\)-b-string, a \\(v\\)-w-string, and \\(k-1\\) strings in \\(S\\) ( \\(k+1\\) strings altogether). This is impossible.\n\nHence, we get \\(2 \\leq u^{\\prime} \\leq v^{\\prime}<2 u^{\\prime}\\). To reach (ii), it remains to check that in \\(A_{i+1}\\), there exists a set \\(S^{\\prime}\\) of \\(k-1\\) other strings larger than \\(v^{\\prime} / 2\\). These will be exactly the strings obtained from the elements of \\(S\\). Namely, each \\(s \\in S\\) was either cut in the \\((i+1)\\) st step, or not. In the former case, let us include into \\(S^{\\prime}\\) the largest of the strings obtained from \\(s\\); otherwise we include \\(s\\) itself into \\(S^{\\prime}\\). All \\(k-1\\) strings in \\(S^{\\prime}\\) are greater than \\(v / 2 \\geq v^{\\prime}\\), as desired."}
{"id": "imo-shortlist-2010-c7", "question": "C7. Let \\(P_{1}, \\ldots, P_{s}\\) be arithmetic progressions of integers, the following conditions being satisfied:\n(i) each integer belongs to at least one of them;\n(ii) each progression contains a number which does not belong to other progressions.\n\nDenote by \\(n\\) the least common multiple of steps of these progressions; let \\(n=p_{1}^{\\alpha_{1}} \\ldots p_{k}^{\\alpha_{k}}\\) be its prime factorization. Prove that\n\n\\[\ns \\geq 1+\\sum_{i=1}^{k} \\alpha_{i}\\left(p_{i}-1\\right)\n\\]\n\n(Germany)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2010, "solution": "First, we prove the key lemma, and then we show how to apply it to finish the solution.\n\nLet \\(n_{1}, \\ldots, n_{k}\\) be positive integers. By an \\(n_{1} \\times n_{2} \\times \\cdots \\times n_{k}\\) grid we mean the set \\(N=\\) \\(\\left\\{\\left(a_{1}, \\ldots, a_{k}\\right): a_{i} \\in \\mathbb{Z}, 0 \\leq a_{i} \\leq n_{i}-1\\right\\}\\); the elements of \\(N\\) will be referred to as points. In this grid, we define a subgrid as a subset of the form\n\n\\[\nL=\\left\\{\\left(b_{1}, \\ldots, b_{k}\\right) \\in N: b_{i_{1}}=x_{i_{1}}, \\ldots, b_{i_{t}}=x_{i_{t}}\\right\\}\n\\]\n\nwhere \\(I=\\left\\{i_{1}, \\ldots, i_{t}\\right\\}\\) is an arbitrary nonempty set of indices, and \\(x_{i_{j}} \\in\\left[0, n_{i_{j}}-1\\right](1 \\leq j \\leq t)\\) are fixed integer numbers. Further, we say that a subgrid (1) is orthogonal to the \\(i\\) th coordinate axis if \\(i \\in I\\), and that it is parallel to the \\(i\\) th coordinate axis otherwise.\nLemma. Assume that the grid \\(N\\) is covered by subgrids \\(L_{1}, L_{2}, \\ldots, L_{s}\\) (this means \\(N=\\bigcup_{i=1}^{s} L_{i}\\) ) so that\n(ii') each subgrid contains a point which is not covered by other subgrids;\n(iii) for each coordinate axis, there exists a subgrid \\(L_{i}\\) orthogonal to this axis.\n\nThen\n\n\\[\ns \\geq 1+\\sum_{i=1}^{k}\\left(n_{i}-1\\right)\n\\]\n\nProof. Assume to the contrary that \\(s \\leq \\sum_{i}\\left(n_{i}-1\\right)=s^{\\prime}\\). Our aim is to find a point that is not covered by \\(L_{1}, \\ldots, L_{s}\\).\n\nThe idea of the proof is the following. Imagine that we expand each subgrid to some maximal subgrid so that for the \\(i\\) th axis, there will be at most \\(n_{i}-1\\) maximal subgrids orthogonal to this axis. Then the desired point can be found easily: its \\(i\\) th coordinate should be that not covered by the maximal subgrids orthogonal to the \\(i\\) th axis. Surely, the conditions for existence of such expansion are provided by Hall's lemma on matchings. So, we will follow this direction, although we will apply Hall's lemma to some subgraph instead of the whole graph.\n\nConstruct a bipartite graph \\(G=\\left(V \\cup V^{\\prime}, E\\right)\\) as follows. Let \\(V=\\left\\{L_{1}, \\ldots, L_{s}\\right\\}\\), and let \\(V^{\\prime}=\\left\\{v_{i j}: 1 \\leq i \\leq s, 1 \\leq j \\leq n_{i}-1\\right\\}\\) be some set of \\(s^{\\prime}\\) elements. Further, let the edge ( \\(L_{m}, v_{i j}\\) ) appear iff \\(L_{m}\\) is orthogonal to the \\(i\\) th axis.\n\nFor each subset \\(W \\subset V\\), denote\n\n\\[\nf(W)=\\left\\{v \\in V^{\\prime}:(L, v) \\in E \\text { for some } L \\in W\\right\\}\n\\]\n\nNotice that \\(f(V)=V^{\\prime}\\) by (iii).\nNow, consider the set \\(W \\subset V\\) containing the maximal number of elements such that \\(|W|>\\) \\(|f(W)|\\); if there is no such set then we set \\(W=\\varnothing\\). Denote \\(W^{\\prime}=f(W), U=V \\backslash W, U^{\\prime}=V^{\\prime} \\backslash W^{\\prime}\\).\n\nBy our assumption and the Lemma condition, \\(|f(V)|=\\left|V^{\\prime}\\right| \\geq|V|\\), hence \\(W \\neq V\\) and \\(U \\neq \\varnothing\\). Permuting the coordinates, we can assume that \\(U^{\\prime}=\\left\\{v_{i j}: 1 \\leq i \\leq \\ell\\right\\}, W^{\\prime}=\\left\\{v_{i j}: \\ell+1 \\leq i \\leq k\\right\\}\\).\n\nConsider the induced subgraph \\(G^{\\prime}\\) of \\(G\\) on the vertices \\(U \\cup U^{\\prime}\\). We claim that for every \\(X \\subset U\\), we get \\(\\left|f(X) \\cap U^{\\prime}\\right| \\geq|X|\\) (so \\(G^{\\prime}\\) satisfies the conditions of Hall's lemma). Actually, we have \\(|W| \\geq|f(W)|\\), so if \\(|X|>\\left|f(X) \\cap U^{\\prime}\\right|\\) for some \\(X \\subset U\\), then we have\n\n\\[\n|W \\cup X|=|W|+|X|>|f(W)|+\\left|f(X) \\cap U^{\\prime}\\right|=\\left|f(W) \\cup\\left(f(X) \\cap U^{\\prime}\\right)\\right|=|f(W \\cup X)|\n\\]\n\nThis contradicts the maximality of \\(|W|\\).\nThus, applying Hall's lemma, we can assign to each \\(L \\in U\\) some vertex \\(v_{i j} \\in U^{\\prime}\\) so that to distinct elements of \\(U\\), distinct vertices of \\(U^{\\prime}\\) are assigned. In this situation, we say that \\(L \\in U\\) corresponds to the \\(i\\) th axis, and write \\(g(L)=i\\). Since there are \\(n_{i}-1\\) vertices of the form \\(v_{i j}\\), we get that for each \\(1 \\leq i \\leq \\ell\\), not more than \\(n_{i}-1\\) subgrids correspond to the \\(i\\) th axis.\n\nFinally, we are ready to present the desired point. Since \\(W \\neq V\\), there exists a point \\(b=\\left(b_{1}, b_{2}, \\ldots, b_{k}\\right) \\in N \\backslash\\left(\\cup_{L \\in W} L\\right)\\). On the other hand, for every \\(1 \\leq i \\leq \\ell\\), consider any subgrid \\(L \\in U\\) with \\(g(L)=i\\). This means exactly that \\(L\\) is orthogonal to the \\(i\\) th axis, and hence all its elements have the same \\(i\\) th coordinate \\(c_{L}\\). Since there are at most \\(n_{i}-1\\) such subgrids, there exists a number \\(0 \\leq a_{i} \\leq n_{i}-1\\) which is not contained in a set \\(\\left\\{c_{L}: g(L)=i\\right\\}\\). Choose such number for every \\(1 \\leq i \\leq \\ell\\). Now we claim that point \\(a=\\left(a_{1}, \\ldots, a_{\\ell}, b_{\\ell+1}, \\ldots, b_{k}\\right)\\) is not covered, hence contradicting the Lemma condition.\n\nSurely, point \\(a\\) cannot lie in some \\(L \\in U\\), since all the points in \\(L\\) have \\(g(L)\\) th coordinate \\(c_{L} \\neq a_{g(L)}\\). On the other hand, suppose that \\(a \\in L\\) for some \\(L \\in W\\); recall that \\(b \\notin L\\). But the points \\(a\\) and \\(b\\) differ only at first \\(\\ell\\) coordinates, so \\(L\\) should be orthogonal to at least one of the first \\(\\ell\\) axes, and hence our graph contains some edge ( \\(L, v_{i j}\\) ) for \\(i \\leq \\ell\\). It contradicts the definition of \\(W^{\\prime}\\). The Lemma is proved.\n\nNow we turn to the problem. Let \\(d_{j}\\) be the step of the progression \\(P_{j}\\). Note that since \\(n=\\) l.c.m. \\(\\left(d_{1}, \\ldots, d_{s}\\right)\\), for each \\(1 \\leq i \\leq k\\) there exists an index \\(j(i)\\) such that \\(p_{i}^{\\alpha_{i}} \\mid d_{j(i)}\\). We assume that \\(n>1\\); otherwise the problem statement is trivial.\n\nFor each \\(0 \\leq m \\leq n-1\\) and \\(1 \\leq i \\leq k\\), let \\(m_{i}\\) be the residue of \\(m\\) modulo \\(p_{i}^{\\alpha_{i}}\\), and let \\(m_{i}=\\overline{r_{i \\alpha_{i}} \\ldots r_{i 1}}\\) be the base \\(p_{i}\\) representation of \\(m_{i}\\) (possibly, with some leading zeroes). Now, we put into correspondence to \\(m\\) the sequence \\(r(m)=\\left(r_{11}, \\ldots, r_{1 \\alpha_{1}}, r_{21}, \\ldots, r_{k \\alpha_{k}}\\right)\\). Hence \\(r(m)\\) lies in a \\(\\underbrace{p_{1} \\times \\cdots \\times p_{1}}_{\\alpha_{1} \\text { times }} \\times \\cdots \\times \\underbrace{p_{k} \\times \\cdots \\times p_{k}}_{\\alpha_{k} \\text { times }}\\) grid \\(N\\).\n\nSurely, if \\(r(m)=r\\left(m^{\\prime}\\right)\\) then \\(p_{i}^{\\alpha_{i}} \\mid m_{i}-m_{i}^{\\prime}\\), which follows \\(p_{i}^{\\alpha_{i}} \\mid m-m^{\\prime}\\) for all \\(1 \\leq i \\leq k\\); consequently, \\(n \\mid m-m^{\\prime}\\). So, when \\(m\\) runs over the set \\(\\{0, \\ldots, n-1\\}\\), the sequences \\(r(m)\\) do not repeat; since \\(|N|=n\\), this means that \\(r\\) is a bijection between \\(\\{0, \\ldots, n-1\\}\\) and \\(N\\). Now we will show that for each \\(1 \\leq i \\leq s\\), the set \\(L_{i}=\\left\\{r(m): m \\in P_{i}\\right\\}\\) is a subgrid, and that for each axis there exists a subgrid orthogonal to this axis. Obviously, these subgrids cover \\(N\\), and the condition (ii') follows directly from (ii). Hence the Lemma provides exactly the estimate we need.\n\nConsider some \\(1 \\leq j \\leq s\\) and let \\(d_{j}=p_{1}^{\\gamma_{1}} \\ldots p_{k}^{\\gamma_{k}}\\). Consider some \\(q \\in P_{j}\\) and let \\(r(q)=\\) \\(\\left(r_{11}, \\ldots, r_{k \\alpha_{k}}\\right)\\). Then for an arbitrary \\(q^{\\prime}\\), setting \\(r\\left(q^{\\prime}\\right)=\\left(r_{11}^{\\prime}, \\ldots, r_{k \\alpha_{k}}^{\\prime}\\right)\\) we have\n\n\\[\nq^{\\prime} \\in P_{j} \\quad \\Longleftrightarrow \\quad p_{i}^{\\gamma_{i}} \\mid q-q^{\\prime} \\text { for each } 1 \\leq i \\leq k \\quad \\Longleftrightarrow \\quad r_{i, t}=r_{i, t}^{\\prime} \\text { for all } t \\leq \\gamma_{i}\n\\]\n\nHence \\(L_{j}=\\left\\{\\left(r_{11}^{\\prime}, \\ldots, r_{k \\alpha_{k}}^{\\prime}\\right) \\in N: r_{i, t}=r_{i, t}^{\\prime}\\right.\\) for all \\(\\left.t \\leq \\gamma_{i}\\right\\}\\) which means that \\(L_{j}\\) is a subgrid containing \\(r(q)\\). Moreover, in \\(L_{j(i)}\\), all the coordinates corresponding to \\(p_{i}\\) are fixed, so it is orthogonal to all of their axes, as desired.\n\nComment 1. The estimate in the problem is sharp for every \\(n\\). One of the possible examples is the following one. For each \\(1 \\leq i \\leq k, 0 \\leq j \\leq \\alpha_{i}-1,1 \\leq k \\leq p-1\\), let\n\n\\[\nP_{i, j, k}=k p_{i}^{j}+p_{i}^{j+1} \\mathbb{Z}\n\\]\n\nand add the progression \\(P_{0}=n \\mathbb{Z}\\). One can easily check that this set satisfies all the problem conditions. There also exist other examples.\n\nOn the other hand, the estimate can be adjusted in the following sense. For every \\(1 \\leq i \\leq k\\), let \\(0=\\alpha_{i 0}, \\alpha_{i 1}, \\ldots, \\alpha_{i h_{i}}\\) be all the numbers of the form \\(\\operatorname{ord}_{p_{i}}\\left(d_{j}\\right)\\) in an increasing order (we delete the repeating occurences of a number, and add a number \\(0=\\alpha_{i 0}\\) if it does not occur). Then, repeating the arguments from the solution one can obtain that\n\n\\[\ns \\geq 1+\\sum_{i=1}^{k} \\sum_{j=1}^{h_{i}}\\left(p^{\\alpha_{j}-\\alpha_{j-1}}-1\\right)\n\\]\n\nNote that \\(p^{\\alpha}-1 \\geq \\alpha(p-1)\\), and the equality is achieved only for \\(\\alpha=1\\). Hence, for reaching the minimal number of the progressions, one should have \\(\\alpha_{i, j}=j\\) for all \\(i, j\\). In other words, for each \\(1 \\leq j \\leq \\alpha_{i}\\), there should be an index \\(t\\) such that \\(\\operatorname{ord}_{p_{i}}\\left(d_{t}\\right)=j\\).\n\nSolution 2. We start with introducing some notation. For positive integer \\(r\\), we denote \\([r]=\\{1,2, \\ldots, r\\}\\). Next, we say that a set of progressions \\(\\mathcal{P}=\\left\\{P_{1}, \\ldots, P_{s}\\right\\}\\) cover \\(\\mathbb{Z}\\) if each integer belongs to some of them; we say that this covering is minimal if no proper subset of \\(\\mathcal{P}\\) covers \\(\\mathbb{Z}\\). Obviously, each covering contains a minimal subcovering.\n\nNext, for a minimal covering \\(\\left\\{P_{1}, \\ldots, P_{s}\\right\\}\\) and for every \\(1 \\leq i \\leq s\\), let \\(d_{i}\\) be the step of progression \\(P_{i}\\), and \\(h_{i}\\) be some number which is contained in \\(P_{i}\\) but in none of the other progressions. We assume that \\(n>1\\), otherwise the problem is trivial. This implies \\(d_{i}>1\\), otherwise the progression \\(P_{i}\\) covers all the numbers, and \\(n=1\\).\n\nWe will prove a more general statement, namely the following\nClaim. Assume that the progressions \\(P_{1}, \\ldots, P_{s}\\) and number \\(n=p_{1}^{\\alpha_{1}} \\ldots p_{k}^{\\alpha_{k}}>1\\) are chosen as in the problem statement. Moreover, choose some nonempty set of indices \\(I=\\left\\{i_{1}, \\ldots, i_{t}\\right\\} \\subseteq[k]\\) and some positive integer \\(\\beta_{i} \\leq \\alpha_{i}\\) for every \\(i \\in I\\). Consider the set of indices\n\n\\[\nT=\\left\\{j: 1 \\leq j \\leq s, \\text { and } p_{i}^{\\alpha_{i}-\\beta_{i}+1} \\mid d_{j} \\text { for some } i \\in I\\right\\}\n\\]\n\nThen\n\n\\[\n|T| \\geq 1+\\sum_{i \\in I} \\beta_{i}\\left(p_{i}-1\\right)\n\\]\n\nObserve that the Claim for \\(I=[k]\\) and \\(\\beta_{i}=\\alpha_{i}\\) implies the problem statement, since the left-hand side in (2) is not greater than \\(s\\). Hence, it suffices to prove the Claim.\n\n\\begin{enumerate}\n  \\item First, we prove the Claim assuming that all \\(d_{j}\\) 's are prime numbers. If for some \\(1 \\leq i \\leq k\\) we have at least \\(p_{i}\\) progressions with the step \\(p_{i}\\), then they do not intersect and hence cover all the integers; it means that there are no other progressions, and \\(n=p_{i}\\); the Claim is trivial in this case.\n\n\nNow assume that for every \\(1 \\leq i \\leq k\\), there are not more than \\(p_{i}-1\\) progressions with step \\(p_{i}\\); each such progression covers the numbers with a fixed residue modulo \\(p_{i}\\), therefore there exists a residue \\(q_{i}\\) mod \\(p_{i}\\) which is not touched by these progressions. By the Chinese Remainder Theorem, there exists a number \\(q\\) such that \\(q \\equiv q_{i}\\left(\\bmod p_{i}\\right)\\) for all \\(1 \\leq i \\leq k\\); this number cannot be covered by any progression with step \\(p_{i}\\), hence it is not covered at all. A contradiction.\n2. Now, we assume that the general Claim is not valid, and hence we consider a counterexample \\(\\left\\{P_{1}, \\ldots, P_{s}\\right\\}\\) for the Claim; we can choose it to be minimal in the following sense:\n\n\\begin{itemize}\n  \\item the number \\(n\\) is minimal possible among all the counterexamples;\n  \\item the sum \\(\\sum_{i} d_{i}\\) is minimal possible among all the counterexamples having the chosen value of \\(n\\).\n\n\nAs was mentioned above, not all numbers \\(d_{i}\\) are primes; hence we can assume that \\(d_{1}\\) is composite, say \\(p_{1} \\mid d_{1}\\) and \\(d_{1}^{\\prime}=\\frac{d_{1}}{p_{1}}>1\\). Consider a progression \\(P_{1}^{\\prime}\\) having the step \\(d_{1}^{\\prime}\\), and containing \\(P_{1}\\). We will focus on two coverings constructed as follows.\n(i) Surely, the progressions \\(P_{1}^{\\prime}, P_{2}, \\ldots, P_{s}\\) cover \\(\\mathbb{Z}\\), though this covering in not necessarily minimal. So, choose some minimal subcovering \\(\\mathcal{P}^{\\prime}\\) in it; surely \\(P_{1}^{\\prime} \\in \\mathcal{P}^{\\prime}\\) since \\(h_{1}\\) is not covered by \\(P_{2}, \\ldots, P_{s}\\), so we may assume that \\(\\mathcal{P}^{\\prime}=\\left\\{P_{1}^{\\prime}, P_{2}, \\ldots, P_{s^{\\prime}}\\right\\}\\) for some \\(s^{\\prime} \\leq s\\). Furthermore, the period of the covering \\(\\mathcal{P}^{\\prime}\\) can appear to be less than \\(n\\); so we denote this period by\n\n\\[\nn^{\\prime}=p_{1}^{\\alpha_{1}-\\sigma_{1}} \\ldots p_{k}^{\\alpha_{k}-\\sigma_{k}}=\\text { l.c.m. }\\left(d_{1}^{\\prime}, d_{2}, \\ldots, d_{s^{\\prime}}\\right)\n\\]\n\nObserve that for each \\(P_{j} \\notin \\mathcal{P}^{\\prime}\\), we have \\(h_{j} \\in P_{1}^{\\prime}\\), otherwise \\(h_{j}\\) would not be covered by \\(\\mathcal{P}\\).\n(ii) On the other hand, each nonempty set of the form \\(R_{i}=P_{i} \\cap P_{1}^{\\prime}(1 \\leq i \\leq s)\\) is also a progression with a step \\(r_{i}=\\) l.c.m. \\(\\left(d_{i}, d_{1}^{\\prime}\\right)\\), and such sets cover \\(P_{1}^{\\prime}\\). Scaling these progressions with the ratio \\(1 / d_{1}^{\\prime}\\), we obtain the progressions \\(Q_{i}\\) with steps \\(q_{i}=r_{i} / d_{1}^{\\prime}\\) which cover \\(\\mathbb{Z}\\). Now we choose a minimal subcovering \\(\\mathcal{Q}\\) of this covering; again we should have \\(Q_{1} \\in \\mathcal{Q}\\) by the reasons of \\(h_{1}\\). Now, denote the period of \\(\\mathcal{Q}\\) by\n\n\\[\nn^{\\prime \\prime}=\\text { l.c.m. }\\left\\{q_{i}: Q_{i} \\in \\mathcal{Q}\\right\\}=\\frac{\\text { l.c.m. }\\left\\{r_{i}: Q_{i} \\in \\mathcal{Q}\\right\\}}{d_{1}^{\\prime}}=\\frac{p_{1}^{\\gamma_{1}} \\ldots p_{k}^{\\gamma_{k}}}{d_{1}^{\\prime}}\n\\]\n\nNote that if \\(h_{j} \\in P_{1}^{\\prime}\\), then the image of \\(h_{j}\\) under the scaling can be covered by \\(Q_{j}\\) only; so, in this case we have \\(Q_{j} \\in \\mathcal{Q}\\).\n\nOur aim is to find the desired number of progressions in coverings \\(\\mathcal{P}\\) and \\(\\mathcal{Q}\\). First, we have \\(n \\geq n^{\\prime}\\), and the sum of the steps in \\(\\mathcal{P}^{\\prime}\\) is less than that in \\(\\mathcal{P}\\); hence the Claim is valid for \\(\\mathcal{P}^{\\prime}\\). We apply it to the set of indices \\(I^{\\prime}=\\left\\{i \\in I: \\beta_{i}>\\sigma_{i}\\right\\}\\) and the exponents \\(\\beta_{i}^{\\prime}=\\beta_{i}-\\sigma_{i}\\); hence the set under consideration is\n\n\\[\nT^{\\prime}=\\left\\{j: 1 \\leq j \\leq s^{\\prime}, \\text { and } p_{i}^{\\left(\\alpha_{i}-\\sigma_{i}\\right)-\\beta_{i}^{\\prime}+1}=p_{i}^{\\alpha_{i}-\\beta_{i}+1} \\mid d_{j} \\text { for some } i \\in I^{\\prime}\\right\\} \\subseteq T \\cap\\left[s^{\\prime}\\right]\n\\]\n\nand we obtain that\n\n\\[\n\\left|T \\cap\\left[s^{\\prime}\\right]\\right| \\geq\\left|T^{\\prime}\\right| \\geq 1+\\sum_{i \\in I^{\\prime}}\\left(\\beta_{i}-\\sigma_{i}\\right)\\left(p_{i}-1\\right)=1+\\sum_{i \\in I}\\left(\\beta_{i}-\\sigma_{i}\\right)_{+}\\left(p_{i}-1\\right)\n\\]\n\nwhere \\((x)_{+}=\\max \\{x, 0\\}\\); the latter equality holds as for \\(i \\notin I^{\\prime}\\) we have \\(\\beta_{i} \\leq \\sigma_{i}\\).\nObserve that \\(x=(x-y)_{+}+\\min \\{x, y\\}\\) for all \\(x, y\\). So, if we find at least\n\n\\[\nG=\\sum_{i \\in I} \\min \\left\\{\\beta_{i}, \\sigma_{i}\\right\\}\\left(p_{i}-1\\right)\n\\]\n\nindices in \\(T \\cap\\left\\{s^{\\prime}+1, \\ldots, s\\right\\}\\), then we would have\n\n\\[\n|T|=\\left|T \\cap\\left[s^{\\prime}\\right]\\right|+\\left|T \\cap\\left\\{s^{\\prime}+1, \\ldots, s\\right\\}\\right| \\geq 1+\\sum_{i \\in I}\\left(\\left(\\beta_{i}-\\sigma_{i}\\right)_{+}+\\min \\left\\{\\beta_{i}, \\sigma_{i}\\right\\}\\right)\\left(p_{i}-1\\right)=1+\\sum_{i \\in I} \\beta_{i}\\left(p_{i}-1\\right),\n\\]\n\nthus leading to a contradiction with the choice of \\(\\mathcal{P}\\). We will find those indices among the indices of progressions in \\(\\mathcal{Q}\\).\n3. Now denote \\(I^{\\prime \\prime}=\\left\\{i \\in I: \\sigma_{i}>0\\right\\}\\) and consider some \\(i \\in I^{\\prime \\prime}\\); then \\(p_{i}^{\\alpha_{i}} \\nmid n^{\\prime}\\). On the other hand, there exists an index \\(j(i)\\) such that \\(p_{i}^{\\alpha_{i}} \\mid d_{j(i)}\\); this means that \\(d_{j(i)} \\nmid n^{\\prime}\\) and hence \\(P_{j(i)}\\) cannot appear in \\(\\mathcal{P}^{\\prime}\\), so \\(j(i)>s^{\\prime}\\). Moreover, we have observed before that in this case \\(h_{j(i)} \\in P_{1}^{\\prime}\\), hence \\(Q_{j(i)} \\in \\mathcal{Q}\\). This means that \\(q_{j(i)} \\mid n^{\\prime \\prime}\\), therefore \\(\\gamma_{i}=\\alpha_{i}\\) for each \\(i \\in I^{\\prime \\prime}\\) (recall here that \\(q_{i}=r_{i} / d_{1}^{\\prime}\\) and hence \\(\\left.d_{j(i)}\\left|r_{j(i)}\\right| d_{1}^{\\prime} n^{\\prime \\prime}\\right)\\).\n\nLet \\(d_{1}^{\\prime}=p_{1}^{\\tau_{1}} \\ldots p_{k}^{\\tau_{k}}\\). Then \\(n^{\\prime \\prime}=p_{1}^{\\gamma_{1}-\\tau_{1}} \\ldots p_{k}^{\\gamma_{i}-\\tau_{i}}\\). Now, if \\(i \\in I^{\\prime \\prime}\\), then for every \\(\\beta\\) the condition \\(p_{i}^{\\left(\\gamma_{i}-\\tau_{i}\\right)-\\beta+1} \\mid q_{j}\\) is equivalent to \\(p_{i}^{\\alpha_{i}-\\beta+1} \\mid r_{j}\\).\n\nNote that \\(n^{\\prime \\prime} \\leq n / d_{1}^{\\prime}<n\\), hence we can apply the Claim to the covering \\(\\mathcal{Q}\\). We perform this with the set of indices \\(I^{\\prime \\prime}\\) and the exponents \\(\\beta_{i}^{\\prime \\prime}=\\min \\left\\{\\beta_{i}, \\sigma_{i}\\right\\}>0\\). So, the set under consideration is\n\n\\[\n\\begin{aligned}\nT^{\\prime \\prime} & =\\left\\{j: Q_{j} \\in \\mathcal{Q}, \\text { and } p_{i}^{\\left(\\gamma_{i}-\\tau_{i}\\right)-\\min \\left\\{\\beta_{i}, \\sigma_{i}\\right\\}+1} \\mid q_{j} \\text { for some } i \\in I^{\\prime \\prime}\\right\\} \n& =\\left\\{j: Q_{j} \\in \\mathcal{Q}, \\text { and } p_{i}^{\\alpha_{i}-\\min \\left\\{\\beta_{i}, \\sigma_{i}\\right\\}+1} \\mid r_{j} \\text { for some } i \\in I^{\\prime \\prime}\\right\\}\n\n\\]\n\nand we obtain \\(\\left|T^{\\prime \\prime}\\right| \\geq 1+G\\). Finally, we claim that \\(T^{\\prime \\prime} \\subseteq T \\cap\\left(\\{1\\} \\cup\\left\\{s^{\\prime}+1, \\ldots, s\\right\\}\\right)\\); then we will obtain \\(\\left|T \\cap\\left\\{s^{\\prime}+1, \\ldots, s\\right\\}\\right| \\geq G\\), which is exactly what we need.\n\nTo prove this, consider any \\(j \\in T^{\\prime \\prime}\\). Observe first that \\(\\alpha_{i}-\\min \\left\\{\\beta_{i}, \\sigma_{i}\\right\\}+1>\\alpha_{i}-\\sigma_{i} \\geq \\tau_{i}\\), hence from \\(p_{i}^{\\alpha_{i}-\\min \\left\\{\\beta_{i}, \\sigma_{i}\\right\\}+1} \\mid r_{j}=\\) l.c.m. \\(\\left(d_{1}^{\\prime}, d_{j}\\right)\\) we have \\(p_{i}^{\\alpha_{i}-\\min \\left\\{\\beta_{i}, \\sigma_{i}\\right\\}+1} \\mid d_{j}\\), which means that \\(j \\in T\\). Next, the exponent of \\(p_{i}\\) in \\(d_{j}\\) is greater than that in \\(n^{\\prime}\\), which means that \\(P_{j} \\notin \\mathcal{P}^{\\prime}\\). This may appear only if \\(j=1\\) or \\(j>s^{\\prime}\\), as desired. This completes the proof.\nComment 2. A grid analogue of the Claim is also valid. It reads as following.\nClaim. Assume that the grid \\(N\\) is covered by subgrids \\(L_{1}, L_{2}, \\ldots, L_{s}\\) so that\n(ii') each subgrid contains a point which is not covered by other subgrids;\n(iii) for each coordinate axis, there exists a subgrid \\(L_{i}\\) orthogonal to this axis.\n\nChoose some set of indices \\(I=\\left\\{i_{1}, \\ldots, i_{t}\\right\\} \\subset[k]\\), and consider the set of indices\n\n\\[\nT=\\left\\{j: 1 \\leq j \\leq s, \\text { and } L_{j} \\text { is orthogonal to the } i \\text { th axis for some } i \\in I\\right\\}\n\\]\n\nThen\n\n\\[\n|T| \\geq 1+\\sum_{i \\in I}\\left(n_{i}-1\\right)\n\\]\n\nThis Claim may be proved almost in the same way as in Solution 1."}
{"id": "imo-shortlist-2010-g1", "question": "G1. Let \\(A B C\\) be an acute triangle with \\(D, E, F\\) the feet of the altitudes lying on \\(B C, C A, A B\\) respectively. One of the intersection points of the line \\(E F\\) and the circumcircle is \\(P\\). The lines \\(B P\\) and \\(D F\\) meet at point \\(Q\\). Prove that \\(A P=A Q\\).\n(United Kingdom)", "category": "Geometry", "source": "IMO Shortlist", "year": 2010, "solution": "The line \\(E F\\) intersects the circumcircle at two points. Depending on the choice of \\(P\\), there are two different cases to consider.\n\nCase 1: The point \\(P\\) lies on the ray \\(E F\\) (see Fig. 1).\nLet \\(\\angle C A B=\\alpha, \\angle A B C=\\beta\\) and \\(\\angle B C A=\\gamma\\). The quadrilaterals \\(B C E F\\) and \\(C A F D\\) are cyclic due to the right angles at \\(D, E\\) and \\(F\\). So,\n\n\\[\n\\begin{aligned}\n& \\angle B D F=180^{\\circ}-\\angle F D C=\\angle C A F=\\alpha, \n& \\angle A F E=180^{\\circ}-\\angle E F B=\\angle B C E=\\gamma, \n& \\angle D F B=180^{\\circ}-\\angle A F D=\\angle D C A=\\gamma .\n\n\\]\n\nSince \\(P\\) lies on the \\(\\operatorname{arc} A B\\) of the circumcircle, \\(\\angle P B A<\\angle B C A=\\gamma\\). Hence, we have\n\n\\[\n\\angle P B D+\\angle B D F=\\angle P B A+\\angle A B D+\\angle B D F<\\gamma+\\beta+\\alpha=180^{\\circ},\n\\]\n\nand the point \\(Q\\) must lie on the extensions of \\(B P\\) and \\(D F\\) beyond the points \\(P\\) and \\(F\\), respectively.\n\nFrom the cyclic quadrilateral \\(A P B C\\) we get\n\n\\[\n\\angle Q P A=180^{\\circ}-\\angle A P B=\\angle B C A=\\gamma=\\angle D F B=\\angle Q F A .\n\\]\n\nHence, the quadrilateral \\(A Q P F\\) is cyclic. Then \\(\\angle A Q P=180^{\\circ}-\\angle P F A=\\angle A F E=\\gamma\\).\nWe obtained that \\(\\angle A Q P=\\angle Q P A=\\gamma\\), so the triangle \\(A Q P\\) is isosceles, \\(A P=A Q\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-45(1)}\n\nFig. 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-45}\n\nFig. 2\n\nCase 2: The point \\(P\\) lies on the ray \\(F E\\) (see Fig. 2). In this case the point \\(Q\\) lies inside the segment FD.\n\nSimilarly to the first case, we have\n\n\\[\n\\angle Q P A=\\angle B C A=\\gamma=\\angle D F B=180^{\\circ}-\\angle A F Q .\n\\]\n\nHence, the quadrilateral \\(A F Q P\\) is cyclic.\nThen \\(\\angle A Q P=\\angle A F P=\\angle A F E=\\gamma=\\angle Q P A\\). The triangle \\(A Q P\\) is isosceles again, \\(\\angle A Q P=\\angle Q P A\\) and thus \\(A P=A Q\\).\nComment. Using signed angles, the two possible configurations can be handled simultaneously, without investigating the possible locations of \\(P\\) and \\(Q\\).\n\nSolution 2. For arbitrary points \\(X, Y\\) on the circumcircle, denote by \\(\\widehat{X Y}\\) the central angle of the arc \\(X Y\\).\n\nLet \\(P\\) and \\(P^{\\prime}\\) be the two points where the line \\(E F\\) meets the circumcircle; let \\(P\\) lie on the arc \\(A B\\) and let \\(P^{\\prime}\\) lie on the arc \\(C A\\). Let \\(B P\\) and \\(B P^{\\prime}\\) meet the line \\(D F\\) and \\(Q\\) and \\(Q^{\\prime}\\), respectively (see Fig. 3). We will prove that \\(A P=A P^{\\prime}=A Q=A Q^{\\prime}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-46}\n\nFig. 3\nLike in the first solution, we have \\(\\angle A F E=\\angle B F P=\\angle D F B=\\angle B C A=\\gamma\\) from the cyclic quadrilaterals \\(B C E F\\) and \\(C A F D\\).\n\nBy \\(\\widehat{P B}+\\widehat{P^{\\prime} A}=2 \\angle A F P^{\\prime}=2 \\gamma=2 \\angle B C A=\\widehat{A P}+\\widehat{P B}\\), we have\n\n\\[\n\\widehat{A P}=\\widehat{P^{\\prime} A}, \\quad \\angle P B A=\\angle A B P^{\\prime} \\quad \\text { and } \\quad A P=A P^{\\prime}\n\\]\n\nDue to \\(\\widehat{A P}=\\widehat{P^{\\prime}} A\\), the lines \\(B P\\) and \\(B Q^{\\prime}\\) are symmetrical about line \\(A B\\).\nSimilarly, by \\(\\angle B F P=\\angle Q^{\\prime} F B\\), the lines \\(F P\\) and \\(F Q^{\\prime}\\) are symmetrical about \\(A B\\). It follows that also the points \\(P\\) and \\(P^{\\prime}\\) are symmetrical to \\(Q^{\\prime}\\) and \\(Q\\), respectively. Therefore,\n\n\\[\nA P=A Q^{\\prime} \\quad \\text { and } \\quad A P^{\\prime}=A Q\n\\]\n\nThe relations (1) and (2) together prove \\(A P=A P^{\\prime}=A Q=A Q^{\\prime}\\)."}
{"id": "imo-shortlist-2010-g2", "question": "G2. Point \\(P\\) lies inside triangle \\(A B C\\). Lines \\(A P, B P, C P\\) meet the circumcircle of \\(A B C\\) again at points \\(K, L, M\\), respectively. The tangent to the circumcircle at \\(C\\) meets line \\(A B\\) at \\(S\\). Prove that \\(S C=S P\\) if and only if \\(M K=M L\\).\n(Poland)", "category": "Geometry", "source": "IMO Shortlist", "year": 2010, "solution": "We assume that \\(C A>C B\\), so point \\(S\\) lies on the ray \\(A B\\).\nFrom the similar triangles \\(\\triangle P K M \\sim \\triangle P C A\\) and \\(\\triangle P L M \\sim \\triangle P C B\\) we get \\(\\frac{P M}{K M}=\\frac{P A}{C A}\\) and \\(\\frac{L M}{P M}=\\frac{C B}{P B}\\). Multiplying these two equalities, we get\n\n\\[\n\\frac{L M}{K M}=\\frac{C B}{C A} \\cdot \\frac{P A}{P B} .\n\\]\n\nHence, the relation \\(M K=M L\\) is equivalent to \\(\\frac{C B}{C A}=\\frac{P B}{P A}\\).\nDenote by \\(E\\) the foot of the bisector of angle \\(B\\) in triangle \\(A B C\\). Recall that the locus of points \\(X\\) for which \\(\\frac{X A}{X B}=\\frac{C A}{C B}\\) is the Apollonius circle \\(\\Omega\\) with the center \\(Q\\) on the line \\(A B\\), and this circle passes through \\(C\\) and \\(E\\). Hence, we have \\(M K=M L\\) if and only if \\(P\\) lies on \\(\\Omega\\), that is \\(Q P=Q C\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-47}\n\nFig. 1\n\nNow we prove that \\(S=Q\\), thus establishing the problem statement. We have \\(\\angle C E S=\\) \\(\\angle C A E+\\angle A C E=\\angle B C S+\\angle E C B=\\angle E C S\\), so \\(S C=S E\\). Hence, the point \\(S\\) lies on \\(A B\\) as well as on the perpendicular bisector of \\(C E\\) and therefore coincides with \\(Q\\).\n\nSolution 2. As in the previous solution, we assume that \\(S\\) lies on the ray \\(A B\\).\n\n\\begin{enumerate}\n  \\item Let \\(P\\) be an arbitrary point inside both the circumcircle \\(\\omega\\) of the triangle \\(A B C\\) and the angle \\(A S C\\), the points \\(K, L, M\\) defined as in the problem. We claim that \\(S P=S C\\) implies \\(M K=M L\\).\n\n\nLet \\(E\\) and \\(F\\) be the points of intersection of the line \\(S P\\) with \\(\\omega\\), point \\(E\\) lying on the segment \\(S P\\) (see Fig. 2).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-48}\n\nFig. 2\n\nWe have \\(S P^{2}=S C^{2}=S A \\cdot S B\\), so \\(\\frac{S P}{S B}=\\frac{S A}{S P}\\), and hence \\(\\triangle P S A \\sim \\triangle B S P\\). Then \\(\\angle B P S=\\angle S A P\\). Since \\(2 \\angle B P S=\\widehat{B E}+\\widehat{L F}\\) and \\(2 \\angle S A P=\\widehat{B E}+\\widehat{E K}\\) we have\n\n\\[\n\\wideparen{L F}=\\wideparen{E K} .\n\\]\n\nOn the other hand, from \\(\\angle S P C=\\angle S C P\\) we have \\(\\wideparen{E C}+\\wideparen{M F}=\\wideparen{E C}+\\wideparen{E M}\\), or\n\n\\[\n\\widehat{M F}=\\widehat{E M}\n\\]\n\nFrom (1) and (2) we get \\(\\widehat{M F L}=\\widehat{M F}+\\widehat{F L}=\\widehat{M E}+\\widehat{E K}=\\widehat{M E K}\\) and hence \\(M K=M L\\). The claim is proved.\n2. We are left to prove the converse. So, assume that \\(M K=M L\\), and introduce the points \\(E\\) and \\(F\\) as above. We have \\(S C^{2}=S E \\cdot S F\\); hence, there exists a point \\(P^{\\prime}\\) lying on the segment \\(E F\\) such that \\(S P^{\\prime}=S C\\) (see Fig. 3).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-48(1)}\n\nFig. 3\n\nAssume that \\(P \\neq P^{\\prime}\\). Let the lines \\(A P^{\\prime}, B P^{\\prime}, C P^{\\prime}\\) meet \\(\\omega\\) again at points \\(K^{\\prime}, L^{\\prime}, M^{\\prime}\\) respectively. Now, if \\(P^{\\prime}\\) lies on the segment \\(P F\\) then by the first part of the solution we have \\(\\widehat{M^{\\prime} F L^{\\prime}}=\\widehat{M^{\\prime} E K^{\\prime}}\\). On the other hand, we have \\(\\widehat{M F L}>\\widehat{M^{\\prime} F L^{\\prime}}=\\widehat{M^{\\prime} E K^{\\prime}}>\\widehat{M E K}\\), therefore \\(\\widehat{M F L}>\\widehat{M E K}\\) which contradicts \\(M K=M L\\).\n\nSimilarly, if point \\(P^{\\prime}\\) lies on the segment \\(E P\\) then we get \\(\\widehat{M F L}<\\widehat{M E K}\\) which is impossible. Therefore, the points \\(P\\) and \\(P^{\\prime}\\) coincide and hence \\(S P=S P^{\\prime}=S C\\).\n\nSolution 3. We present a different proof of the converse direction, that is, \\(M K=M L \\Rightarrow\\) \\(S P=S C\\). As in the previous solutions we assume that \\(C A>C B\\), and the line \\(S P\\) meets \\(\\omega\\) at \\(E\\) and \\(F\\).\n\nFrom \\(M L=M K\\) we get \\(\\widehat{M E K}=\\widehat{M F L}\\). Now we claim that \\(\\widehat{M E}=\\widehat{M F}\\) and \\(\\widehat{E K}=\\widehat{F L}\\).\nTo the contrary, suppose first that \\(\\widehat{M E}>\\widehat{M F}\\); then \\(\\widehat{E K}=\\widehat{M E K}-\\widehat{M E}<\\widehat{M F L}-\\widehat{M F}=\\) \\(\\wideparen{F L}\\). Now, the inequality \\(\\wideparen{M E}>\\wideparen{M F}\\) implies \\(2 \\angle S C M=\\wideparen{E C}+\\wideparen{M E}>\\wideparen{E C}+\\wideparen{M F}=2 \\angle S P C\\) and hence \\(S P>S C\\). On the other hand, the inequality \\(\\widehat{E K}<\\widehat{F L}\\) implies \\(2 \\angle S P K=\\) \\(\\widehat{E K}+\\widehat{A F}<\\widehat{F L}+\\widehat{A F}=2 \\angle A B L\\), hence\n\n\\[\n\\angle S P A=180^{\\circ}-\\angle S P K>180^{\\circ}-\\angle A B L=\\angle S B P .\n\\]\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2025_05_30_d27755b953882b2aeed4g-49}\n\n\nFig. 4\nConsider the point \\(A^{\\prime}\\) on the ray \\(S A\\) for which \\(\\angle S P A^{\\prime}=\\angle S B P\\); in our case, this point lies on the segment \\(S A\\) (see Fig. 4). Then \\(\\triangle S B P \\sim \\triangle S P A^{\\prime}\\) and \\(S P^{2}=S B \\cdot S A^{\\prime}<S B \\cdot S A=S C^{2}\\). Therefore, \\(S P<S C\\) which contradicts \\(S P>S C\\).\n\nSimilarly, one can prove that the inequality \\(\\widehat{M E}<\\widehat{M F}\\) is also impossible. So, we get \\(\\widehat{M E}=\\widehat{M F}\\) and therefore \\(2 \\angle S C M=\\widehat{E C}+\\widehat{M E}=\\widehat{E C}+\\widehat{M F}=2 \\angle S P C\\), which implies \\(S C=S P\\) "}
{"id": "imo-shortlist-2010-g3", "question": "G3. Let \\(A_{1} A_{2} \\ldots A_{n}\\) be a convex polygon. Point \\(P\\) inside this polygon is chosen so that its projections \\(P_{1}, \\ldots, P_{n}\\) onto lines \\(A_{1} A_{2}, \\ldots, A_{n} A_{1}\\) respectively lie on the sides of the polygon. Prove that for arbitrary points \\(X_{1}, \\ldots, X_{n}\\) on sides \\(A_{1} A_{2}, \\ldots, A_{n} A_{1}\\) respectively,\n\n\\[\n\\max \\left\\{\\frac{X_{1} X_{2}}{P_{1} P_{2}}, \\ldots, \\frac{X_{n} X_{1}}{P_{n} P_{1}}\\right\\} \\geq 1\n\\]\n\n(Armenia)", "category": "Geometry", "source": "IMO Shortlist", "year": 2010, "solution": "Denote \\(P_{n+1}=P_{1}, X_{n+1}=X_{1}, A_{n+1}=A_{1}\\).\nLemma. Let point \\(Q\\) lies inside \\(A_{1} A_{2} \\ldots A_{n}\\). Then it is contained in at least one of the circumcircles of triangles \\(X_{1} A_{2} X_{2}, \\ldots, X_{n} A_{1} X_{1}\\).\n\nProof. If \\(Q\\) lies in one of the triangles \\(X_{1} A_{2} X_{2}, \\ldots, X_{n} A_{1} X_{1}\\), the claim is obvious. Otherwise \\(Q\\) lies inside the polygon \\(X_{1} X_{2} \\ldots X_{n}\\) (see Fig. 1). Then we have\n\n\\[\n\\begin{aligned}\n& \\left(\\angle X_{1} A_{2} X_{2}+\\angle X_{1} Q X_{2}\\right)+\\cdots+\\left(\\angle X_{n} A_{1} X_{1}+\\angle X_{n} Q X_{1}\\right) \n& \\quad=\\left(\\angle X_{1} A_{1} X_{2}+\\cdots+\\angle X_{n} A_{1} X_{1}\\right)+\\left(\\angle X_{1} Q X_{2}+\\cdots+\\angle X_{n} Q X_{1}\\right)=(n-2) \\pi+2 \\pi=n \\pi\n\n\\]\n\nhence there exists an index \\(i\\) such that \\(\\angle X_{i} A_{i+1} X_{i+1}+\\angle X_{i} Q X_{i+1} \\geq \\frac{\\pi n}{n}=\\pi\\). Since the quadrilateral \\(Q X_{i} A_{i+1} X_{i+1}\\) is convex, this means exactly that \\(Q\\) is contained the circumcircle of \\(\\triangle X_{i} A_{i+1} X_{i+1}\\), as desired.\n\nNow we turn to the solution. Applying lemma, we get that \\(P\\) lies inside the circumcircle of triangle \\(X_{i} A_{i+1} X_{i+1}\\) for some \\(i\\). Consider the circumcircles \\(\\omega\\) and \\(\\Omega\\) of triangles \\(P_{i} A_{i+1} P_{i+1}\\) and \\(X_{i} A_{i+1} X_{i+1}\\) respectively (see Fig. 2); let \\(r\\) and \\(R\\) be their radii. Then we get \\(2 r=A_{i+1} P \\leq 2 R\\) (since \\(P\\) lies inside \\(\\Omega\\) ), hence\n\n\\[\nP_{i} P_{i+1}=2 r \\sin \\angle P_{i} A_{i+1} P_{i+1} \\leq 2 R \\sin \\angle X_{i} A_{i+1} X_{i+1}=X_{i} X_{i+1}\n\\]\n\nQED.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-51(1)}\n\nFig. 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-51}\n\nFig. 2\n\nSolution 2. As in Solution 1, we assume that all indices of points are considered modulo \\(n\\).\nWe will prove a bit stronger inequality, namely\n\n\\[\n\\max \\left\\{\\frac{X_{1} X_{2}}{P_{1} P_{2}} \\cos \\alpha_{1}, \\ldots, \\frac{X_{n} X_{1}}{P_{n} P_{1}} \\cos \\alpha_{n}\\right\\} \\geq 1\n\\]\n\nwhere \\(\\alpha_{i}(1 \\leq i \\leq n)\\) is the angle between lines \\(X_{i} X_{i+1}\\) and \\(P_{i} P_{i+1}\\). We denote \\(\\beta_{i}=\\angle A_{i} P_{i} P_{i-1}\\) and \\(\\gamma_{i}=\\angle A_{i+1} P_{i} P_{i+1}\\) for all \\(1 \\leq i \\leq n\\).\n\nSuppose that for some \\(1 \\leq i \\leq n\\), point \\(X_{i}\\) lies on the segment \\(A_{i} P_{i}\\), while point \\(X_{i+1}\\) lies on the segment \\(P_{i+1} A_{i+2}\\). Then the projection of the segment \\(X_{i} X_{i+1}\\) onto the line \\(P_{i} P_{i+1}\\) contains segment \\(P_{i} P_{i+1}\\), since \\(\\gamma_{i}\\) and \\(\\beta_{i+1}\\) are acute angles (see Fig. 3). Therefore, \\(X_{i} X_{i+1} \\cos \\alpha_{i} \\geq\\) \\(P_{i} P_{i+1}\\), and in this case the statement is proved.\n\nSo, the only case left is when point \\(X_{i}\\) lies on segment \\(P_{i} A_{i+1}\\) for all \\(1 \\leq i \\leq n\\) (the case when each \\(X_{i}\\) lies on segment \\(A_{i} P_{i}\\) is completely analogous).\n\nNow, assume to the contrary that the inequality\n\n\\[\nX_{i} X_{i+1} \\cos \\alpha_{i}<P_{i} P_{i+1}\n\\]\n\nholds for every \\(1 \\leq i \\leq n\\). Let \\(Y_{i}\\) and \\(Y_{i+1}^{\\prime}\\) be the projections of \\(X_{i}\\) and \\(X_{i+1}\\) onto \\(P_{i} P_{i+1}\\). Then inequality (1) means exactly that \\(Y_{i} Y_{i+1}^{\\prime}<P_{i} P_{i+1}\\), or \\(P_{i} Y_{i}>P_{i+1} Y_{i+1}^{\\prime}\\) (again since \\(\\gamma_{i}\\) and \\(\\beta_{i+1}\\) are acute; see Fig. 4). Hence, we have\n\n\\[\nX_{i} P_{i} \\cos \\gamma_{i}>X_{i+1} P_{i+1} \\cos \\beta_{i+1}, \\quad 1 \\leq i \\leq n .\n\\]\n\nMultiplying these inequalities, we get\n\n\\[\n\\cos \\gamma_{1} \\cos \\gamma_{2} \\cdots \\cos \\gamma_{n}>\\cos \\beta_{1} \\cos \\beta_{2} \\cdots \\cos \\beta_{n}\n\\]\n\nOn the other hand, the sines theorem applied to triangle \\(P P_{i} P_{i+1}\\) provides\n\n\\[\n\\frac{P P_{i}}{P P_{i+1}}=\\frac{\\sin \\left(\\frac{\\pi}{2}-\\beta_{i+1}\\right)}{\\sin \\left(\\frac{\\pi}{2}-\\gamma_{i}\\right)}=\\frac{\\cos \\beta_{i+1}}{\\cos \\gamma_{i}} .\n\\]\n\nMultiplying these equalities we get\n\n\\[\n1=\\frac{\\cos \\beta_{2}}{\\cos \\gamma_{1}} \\cdot \\frac{\\cos \\beta_{3}}{\\cos \\gamma_{2}} \\cdots \\frac{\\cos \\beta_{1}}{\\cos \\gamma_{n}}\n\\]\n\nwhich contradicts (2).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-52}\n\nFig. 3"}
{"id": "imo-shortlist-2010-g4", "question": "G4. Let \\(I\\) be the incenter of a triangle \\(A B C\\) and \\(\\Gamma\\) be its circumcircle. Let the line \\(A I\\) intersect \\(\\Gamma\\) at a point \\(D \\neq A\\). Let \\(F\\) and \\(E\\) be points on side \\(B C\\) and arc \\(B D C\\) respectively such that \\(\\angle B A F=\\angle C A E<\\frac{1}{2} \\angle B A C\\). Finally, let \\(G\\) be the midpoint of the segment \\(I F\\). Prove that the lines \\(D G\\) and \\(E I\\) intersect on \\(\\Gamma\\).\n(Hong Kong)", "category": "Geometry", "source": "IMO Shortlist", "year": 2010, "solution": "Let \\(X\\) be the second point of intersection of line \\(E I\\) with \\(\\Gamma\\), and \\(L\\) be the foot of the bisector of angle \\(B A C\\). Let \\(G^{\\prime}\\) and \\(T\\) be the points of intersection of segment \\(D X\\) with lines \\(I F\\) and \\(A F\\), respectively. We are to prove that \\(G=G^{\\prime}\\), or \\(I G^{\\prime}=G^{\\prime} F\\). By the Menelaus theorem applied to triangle \\(A I F\\) and line \\(D X\\), it means that we need the relation\n\n\\[\n1=\\frac{G^{\\prime} F}{I G^{\\prime}}=\\frac{T F}{A T} \\cdot \\frac{A D}{I D}, \\quad \\text { or } \\quad \\frac{T F}{A T}=\\frac{I D}{A D}\n\\]\n\nLet the line \\(A F\\) intersect \\(\\Gamma\\) at point \\(K \\neq A\\) (see Fig. 1); since \\(\\angle B A K=\\angle C A E\\) we have \\(\\widehat{B K}=\\widehat{C E}\\), hence \\(K E \\| B C\\). Notice that \\(\\angle I A T=\\angle D A K=\\angle E A D=\\angle E X D=\\angle I X T\\), so the points \\(I, A, X, T\\) are concyclic. Hence we have \\(\\angle I T A=\\angle I X A=\\angle E X A=\\angle E K A\\), so \\(I T\\|K E\\| B C\\). Therefore we obtain \\(\\frac{T F}{A T}=\\frac{I L}{A I}\\).\n\nSince \\(C I\\) is the bisector of \\(\\angle A C L\\), we get \\(\\frac{I L}{A I}=\\frac{C L}{A C}\\). Furthermore, \\(\\angle D C L=\\angle D C B=\\) \\(\\angle D A B=\\angle C A D=\\frac{1}{2} \\angle B A C\\), hence the triangles \\(D C L\\) and \\(D A C\\) are similar; therefore we get \\(\\frac{C L}{A C}=\\frac{D C}{A D}\\). Finally, it is known that the midpoint \\(D\\) of arc \\(B C\\) is equidistant from points \\(I\\), \\(B, C\\), hence \\(\\frac{D C}{A D}=\\frac{I D}{A D}\\).\n\nSummarizing all these equalities, we get\n\n\\[\n\\frac{T F}{A T}=\\frac{I L}{A I}=\\frac{C L}{A C}=\\frac{D C}{A D}=\\frac{I D}{A D}\n\\]\n\nas desired.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-53(1)}\n\nFig. 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-53}\n\nFig. 2\n\nComment. The equality \\(\\frac{A I}{I L}=\\frac{A D}{D I}\\) is known and can be obtained in many different ways. For instance, one can consider the inversion with center \\(D\\) and radius \\(D C=D I\\). This inversion takes \\(\\widetilde{B A C}\\) to the segment \\(B C\\), so point \\(A\\) goes to \\(L\\). Hence \\(\\frac{I L}{D I}=\\frac{A I}{A D}\\), which is the desired equality.\n\nSolution 2. As in the previous solution, we introduce the points \\(X, T\\) and \\(K\\) and note that it suffice to prove the equality\n\n\\[\n\\frac{T F}{A T}=\\frac{D I}{A D} \\quad \\Longleftrightarrow \\quad \\frac{T F+A T}{A T}=\\frac{D I+A D}{A D} \\quad \\Longleftrightarrow \\quad \\frac{A T}{A D}=\\frac{A F}{D I+A D}\n\\]\n\nSince \\(\\angle F A D=\\angle E A I\\) and \\(\\angle T D A=\\angle X D A=\\angle X E A=\\angle I E A\\), we get that the triangles \\(A T D\\) and \\(A I E\\) are similar, therefore \\(\\frac{A T}{A D}=\\frac{A I}{A E}\\).\n\nNext, we also use the relation \\(D B=D C=D I\\). Let \\(J\\) be the point on the extension of segment \\(A D\\) over point \\(D\\) such that \\(D J=D I=D C\\) (see Fig. 2). Then \\(\\angle D J C=\\) \\(\\angle J C D=\\frac{1}{2}(\\pi-\\angle J D C)=\\frac{1}{2} \\angle A D C=\\frac{1}{2} \\angle A B C=\\angle A B I\\). Moreover, \\(\\angle B A I=\\angle J A C\\), hence triangles \\(A B I\\) and \\(A J C\\) are similar, so \\(\\frac{A B}{A J}=\\frac{A I}{A C}\\), or \\(A B \\cdot A C=A J \\cdot A I=(D I+A D) \\cdot A I\\).\n\nOn the other hand, we get \\(\\angle A B F=\\angle A B C=\\angle A E C\\) and \\(\\angle B A F=\\angle C A E\\), so triangles \\(A B F\\) and \\(A E C\\) are also similar, which implies \\(\\frac{A F}{A C}=\\frac{A B}{A E}\\), or \\(A B \\cdot A C=A F \\cdot A E\\).\n\nSummarizing we get\n\n\\[\n(D I+A D) \\cdot A I=A B \\cdot A C=A F \\cdot A E \\quad \\Rightarrow \\quad \\frac{A I}{A E}=\\frac{A F}{A D+D I} \\quad \\Rightarrow \\quad \\frac{A T}{A D}=\\frac{A F}{A D+D I}\n\\]\n\nas desired.\nComment. In fact, point \\(J\\) is an excenter of triangle \\(A B C\\)."}
{"id": "imo-shortlist-2010-g5", "question": "G5. Let \\(A B C D E\\) be a convex pentagon such that \\(B C \\| A E, A B=B C+A E\\), and \\(\\angle A B C=\\) \\(\\angle C D E\\). Let \\(M\\) be the midpoint of \\(C E\\), and let \\(O\\) be the circumcenter of triangle \\(B C D\\). Given that \\(\\angle D M O=90^{\\circ}\\), prove that \\(2 \\angle B D A=\\angle C D E\\).\n(Ukraine)", "category": "Geometry", "source": "IMO Shortlist", "year": 2010, "solution": "Choose point \\(T\\) on ray \\(A E\\) such that \\(A T=A B\\); then from \\(A E \\| B C\\) we have \\(\\angle C B T=\\angle A T B=\\angle A B T\\), so \\(B T\\) is the bisector of \\(\\angle A B C\\). On the other hand, we have \\(E T=A T-A E=A B-A E=B C\\), hence quadrilateral \\(B C T E\\) is a parallelogram, and the midpoint \\(M\\) of its diagonal \\(C E\\) is also the midpoint of the other diagonal \\(B T\\).\n\nNext, let point \\(K\\) be symmetrical to \\(D\\) with respect to \\(M\\). Then \\(O M\\) is the perpendicular bisector of segment \\(D K\\), and hence \\(O D=O K\\), which means that point \\(K\\) lies on the circumcircle of triangle \\(B C D\\). Hence we have \\(\\angle B D C=\\angle B K C\\). On the other hand, the angles \\(B K C\\) and \\(T D E\\) are symmetrical with respect to \\(M\\), so \\(\\angle T D E=\\angle B K C=\\angle B D C\\).\n\nTherefore, \\(\\angle B D T=\\angle B D E+\\angle E D T=\\angle B D E+\\angle B D C=\\angle C D E=\\angle A B C=180^{\\circ}-\\) \\(\\angle B A T\\). This means that the points \\(A, B, D, T\\) are concyclic, and hence \\(\\angle A D B=\\angle A T B=\\) \\(\\frac{1}{2} \\angle A B C=\\frac{1}{2} \\angle C D E\\), as desired.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-55(1)}\n\nSolution 2. Let \\(\\angle C B D=\\alpha, \\angle B D C=\\beta, \\angle A D E=\\gamma\\), and \\(\\angle A B C=\\angle C D E=2 \\varphi\\). Then we have \\(\\angle A D B=2 \\varphi-\\beta-\\gamma, \\angle B C D=180^{\\circ}-\\alpha-\\beta, \\angle A E D=360^{\\circ}-\\angle B C D-\\angle C D E=\\) \\(180^{\\circ}-2 \\varphi+\\alpha+\\beta\\), and finally \\(\\angle D A E=180^{\\circ}-\\angle A D E-\\angle A E D=2 \\varphi-\\alpha-\\beta-\\gamma\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-55}\n\nLet \\(N\\) be the midpoint of \\(C D\\); then \\(\\angle D N O=90^{\\circ}=\\angle D M O\\), hence points \\(M, N\\) lie on the circle with diameter \\(O D\\). Now, if points \\(O\\) and \\(M\\) lie on the same side of \\(C D\\), we have \\(\\angle D M N=\\angle D O N=\\frac{1}{2} \\angle D O C=\\alpha\\); in the other case, we have \\(\\angle D M N=180^{\\circ}-\\angle D O N=\\alpha\\);\nso, in both cases \\(\\angle D M N=\\alpha\\) (see Figures). Next, since \\(M N\\) is a midline in triangle \\(C D E\\), we have \\(\\angle M D E=\\angle D M N=\\alpha\\) and \\(\\angle N D M=2 \\varphi-\\alpha\\).\n\nNow we apply the sine rule to the triangles \\(A B D, A D E\\) (twice), \\(B C D\\) and \\(M N D\\) obtaining\n\n\\[\n\\begin{gathered}\n\\frac{A B}{A D}=\\frac{\\sin (2 \\varphi-\\beta-\\gamma)}{\\sin (2 \\varphi-\\alpha)}, \\quad \\frac{A E}{A D}=\\frac{\\sin \\gamma}{\\sin (2 \\varphi-\\alpha-\\beta)}, \\quad \\frac{D E}{A D}=\\frac{\\sin (2 \\varphi-\\alpha-\\beta-\\gamma)}{\\sin (2 \\varphi-\\alpha-\\beta)} \n\\frac{B C}{C D}=\\frac{\\sin \\beta}{\\sin \\alpha}, \\quad \\frac{C D}{D E}=\\frac{C D / 2}{D E / 2}=\\frac{N D}{N M}=\\frac{\\sin \\alpha}{\\sin (2 \\varphi-\\alpha)}\n\n\\]\n\nwhich implies\n\n\\[\n\\frac{B C}{A D}=\\frac{B C}{C D} \\cdot \\frac{C D}{D E} \\cdot \\frac{D E}{A D}=\\frac{\\sin \\beta \\cdot \\sin (2 \\varphi-\\alpha-\\beta-\\gamma)}{\\sin (2 \\varphi-\\alpha) \\cdot \\sin (2 \\varphi-\\alpha-\\beta)}\n\\]\n\nHence, the condition \\(A B=A E+B C\\), or equivalently \\(\\frac{A B}{A D}=\\frac{A E+B C}{A D}\\), after multiplying by the common denominator rewrites as\n\n\\[\n\\begin{aligned}\n& \\sin (2 \\varphi-\\alpha-\\beta) \\cdot \\sin (2 \\varphi-\\beta-\\gamma)=\\sin \\gamma \\cdot \\sin (2 \\varphi-\\alpha)+\\sin \\beta \\cdot \\sin (2 \\varphi-\\alpha-\\beta-\\gamma) \n\\Longleftrightarrow & \\cos (\\gamma-\\alpha)-\\cos (4 \\varphi-2 \\beta-\\alpha-\\gamma)=\\cos (2 \\varphi-\\alpha-2 \\beta-\\gamma)-\\cos (2 \\varphi+\\gamma-\\alpha) \n\\Longleftrightarrow & \\cos (\\gamma-\\alpha)+\\cos (2 \\varphi+\\gamma-\\alpha)=\\cos (2 \\varphi-\\alpha-2 \\beta-\\gamma)+\\cos (4 \\varphi-2 \\beta-\\alpha-\\gamma) \n\\Longleftrightarrow & \\cos \\varphi \\cdot \\cos (\\varphi+\\gamma-\\alpha)=\\cos \\varphi \\cdot \\cos (3 \\varphi-2 \\beta-\\alpha-\\gamma) \n\\Longleftrightarrow & \\cos \\varphi \\cdot(\\cos (\\varphi+\\gamma-\\alpha)-\\cos (3 \\varphi-2 \\beta-\\alpha-\\gamma))=0 \n\\Longleftrightarrow & \\cos \\varphi \\cdot \\sin (2 \\varphi-\\beta-\\alpha) \\cdot \\sin (\\varphi-\\beta-\\gamma)=0\n\n\\]\n\nSince \\(2 \\varphi-\\beta-\\alpha=180^{\\circ}-\\angle A E D<180^{\\circ}\\) and \\(\\varphi=\\frac{1}{2} \\angle A B C<90^{\\circ}\\), it follows that \\(\\varphi=\\beta+\\gamma\\), hence \\(\\angle B D A=2 \\varphi-\\beta-\\gamma=\\varphi=\\frac{1}{2} \\angle C D E\\), as desired."}
{"id": "imo-shortlist-2010-g6", "question": "G6. The vertices \\(X, Y, Z\\) of an equilateral triangle \\(X Y Z\\) lie respectively on the sides \\(B C\\), \\(C A, A B\\) of an acute-angled triangle \\(A B C\\). Prove that the incenter of triangle \\(A B C\\) lies inside triangle \\(X Y Z\\).\n\\(\\mathbf{G 6}^{\\boldsymbol{\\prime}}\\). The vertices \\(X, Y, Z\\) of an equilateral triangle \\(X Y Z\\) lie respectively on the sides \\(B C, C A, A B\\) of a triangle \\(A B C\\). Prove that if the incenter of triangle \\(A B C\\) lies outside triangle \\(X Y Z\\), then one of the angles of triangle \\(A B C\\) is greater than \\(120^{\\circ}\\).\n(Bulgaria)", "category": "Geometry", "source": "IMO Shortlist", "year": 2010, "solution": "for"}
{"id": "imo-shortlist-2010-g6", "question": "G6. We will prove a stronger fact; namely, we will show that the incenter \\(I\\) of triangle \\(A B C\\) lies inside the incircle of triangle \\(X Y Z\\) (and hence surely inside triangle \\(X Y Z\\) itself). We denote by \\(d(U, V W)\\) the distance between point \\(U\\) and line \\(V W\\).\n\nDenote by \\(O\\) the incenter of \\(\\triangle X Y Z\\) and by \\(r, r^{\\prime}\\) and \\(R^{\\prime}\\) the inradii of triangles \\(A B C, X Y Z\\) and the circumradius of \\(X Y Z\\), respectively. Then we have \\(R^{\\prime}=2 r^{\\prime}\\), and the desired inequality is \\(O I \\leq r^{\\prime}\\). We assume that \\(O \\neq I\\); otherwise the claim is trivial.\n\nLet the incircle of \\(\\triangle A B C\\) touch its sides \\(B C, A C, A B\\) at points \\(A_{1}, B_{1}, C_{1}\\) respectively. The lines \\(I A_{1}, I B_{1}, I C_{1}\\) cut the plane into 6 acute angles, each one containing one of the points \\(A_{1}, B_{1}, C_{1}\\) on its border. We may assume that \\(O\\) lies in an angle defined by lines \\(I A_{1}\\), \\(I C_{1}\\) and containing point \\(C_{1}\\) (see Fig. 1). Let \\(A^{\\prime}\\) and \\(C^{\\prime}\\) be the projections of \\(O\\) onto lines \\(I A_{1}\\) and \\(I C_{1}\\), respectively.\n\nSince \\(O X=R^{\\prime}\\), we have \\(d(O, B C) \\leq R^{\\prime}\\). Since \\(O A^{\\prime} \\| B C\\), it follows that \\(d\\left(A^{\\prime}, B C\\right)=\\) \\(A^{\\prime} I+r \\leq R^{\\prime}\\), or \\(A^{\\prime} I \\leq R^{\\prime}-r\\). On the other hand, the incircle of \\(\\triangle X Y Z\\) lies inside \\(\\triangle A B C\\), hence \\(d(O, A B) \\geq r^{\\prime}\\), and analogously we get \\(d(O, A B)=C^{\\prime} C_{1}=r-I C^{\\prime} \\geq r^{\\prime}\\), or \\(I C^{\\prime} \\leq r-r^{\\prime}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-57}\n\nFig. 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-57(1)}\n\nFig. 2\n\nFinally, the quadrilateral \\(I A^{\\prime} O C^{\\prime}\\) is circumscribed due to the right angles at \\(A^{\\prime}\\) and \\(C^{\\prime}\\) (see Fig. 2). On its circumcircle, we have \\(\\widetilde{A^{\\prime} O C^{\\prime}}=2 \\angle A^{\\prime} I C^{\\prime}<180^{\\circ}=\\widetilde{O C^{\\prime} I}\\), hence \\(180^{\\circ} \\geq\\) \\(\\widetilde{I C^{\\prime}}>\\widetilde{A^{\\prime} O}\\). This means that \\(I C^{\\prime}>A^{\\prime} O\\). Finally, we have \\(O I \\leq I A^{\\prime}+A^{\\prime} O<I A^{\\prime}+I C^{\\prime} \\leq\\) \\(\\left(R^{\\prime}-r\\right)+\\left(r-r^{\\prime}\\right)=R^{\\prime}-r^{\\prime}=r^{\\prime}\\), as desired.", "category": "Geometry", "source": "IMO Shortlist", "year": 2010, "solution": "for"}
{"id": "imo-shortlist-2010-g6", "question": "G6. Assume the contrary. Then the incenter \\(I\\) should lie in one of triangles \\(A Y Z, B X Z, C X Y\\) - assume that it lies in \\(\\triangle A Y Z\\). Let the incircle \\(\\omega\\) of \\(\\triangle A B C\\) touch sides \\(B C, A C\\) at point \\(A_{1}, B_{1}\\) respectively. Without loss of generality, assume that point \\(A_{1}\\) lies on segment \\(C X\\). In this case we will show that \\(\\angle C>90^{\\circ}\\) thus leading to a contradiction.\n\nNote that \\(\\omega\\) intersects each of the segments \\(X Y\\) and \\(Y Z\\) at two points; let \\(U, U^{\\prime}\\) and \\(V\\), \\(V^{\\prime}\\) be the points of intersection of \\(\\omega\\) with \\(X Y\\) and \\(Y Z\\), respectively ( \\(U Y>U^{\\prime} Y, V Y>V^{\\prime} Y\\); see Figs. 3 and 4). Note that \\(60^{\\circ}=\\angle X Y Z=\\frac{1}{2}\\left(\\widetilde{U V}-\\widetilde{U^{\\prime} V^{\\prime}}\\right) \\leq \\frac{1}{2} \\widetilde{U V}\\), hence \\(\\widetilde{U V} \\geq 120^{\\circ}\\).\n\nOn the other hand, since \\(I\\) lies in \\(\\triangle A Y Z\\), we get \\(\\widehat{V U V^{\\prime}}<180^{\\circ}\\), hence \\(\\widehat{U A_{1} U^{\\prime}} \\leq \\widehat{U A_{1} V^{\\prime}}<\\) \\(180^{\\circ}-\\widehat{U V} \\leq 60^{\\circ}\\).\n\nNow, two cases are possible due to the order of points \\(Y, B_{1}\\) on segment \\(A C\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-58}\n\nFig. 3\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-58(1)}\n\nFig. 4\n\nCase 1. Let point \\(Y\\) lie on the segment \\(A B_{1}\\) (see Fig. 3). Then we have \\(\\angle Y X C=\\) \\(\\frac{1}{2}\\left(\\widehat{A_{1} U^{\\prime}}-\\widehat{A_{1} U}\\right) \\leq \\frac{1}{2} \\widehat{U A_{1} U^{\\prime}}<30^{\\circ}\\); analogously, we get \\(\\angle X Y C \\leq \\frac{1}{2} \\widehat{U A_{1} U^{\\prime}}<30^{\\circ}\\). Therefore, \\(\\angle Y C X=180^{\\circ}-\\angle Y X C-\\angle X Y C>120^{\\circ}\\), as desired.\n\nCase 2. Now let point \\(Y\\) lie on the segment \\(C B_{1}\\) (see Fig. 4). Analogously, we obtain \\(\\angle Y X C<30^{\\circ}\\). Next, \\(\\angle I Y X>\\angle Z Y X=60^{\\circ}\\), but \\(\\angle I Y X<\\angle I Y B_{1}\\), since \\(Y B_{1}\\) is a tangent and \\(Y X\\) is a secant line to circle \\(\\omega\\) from point \\(Y\\). Hence, we get \\(120^{\\circ}<\\angle I Y B_{1}+\\angle I Y X=\\) \\(\\angle B_{1} Y X=\\angle Y X C+\\angle Y C X<30^{\\circ}+\\angle Y C X\\), hence \\(\\angle Y C X>120^{\\circ}-30^{\\circ}=90^{\\circ}\\), as desired.\n\nComment. In the same way, one can prove a more general\nClaim. Let the vertices \\(X, Y, Z\\) of a triangle \\(X Y Z\\) lie respectively on the sides \\(B C, C A, A B\\) of a triangle \\(A B C\\). Suppose that the incenter of triangle \\(A B C\\) lies outside triangle \\(X Y Z\\), and \\(\\alpha\\) is the least angle of \\(\\triangle X Y Z\\). Then one of the angles of triangle \\(A B C\\) is greater than \\(3 \\alpha-90^{\\circ}\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2010, "solution": "for \\(\\mathbf{G 6}{ }^{\\prime}\\). Assume the contrary. As in Solution 2, we assume that the incenter \\(I\\) of \\(\\triangle A B C\\) lies in \\(\\triangle A Y Z\\), and the tangency point \\(A_{1}\\) of \\(\\omega\\) and \\(B C\\) lies on segment \\(C X\\). Surely, \\(\\angle Y Z A \\leq 180^{\\circ}-\\angle Y Z X=120^{\\circ}\\), hence points \\(I\\) and \\(Y\\) lie on one side of the perpendicular bisector to \\(X Y\\); therefore \\(I X>I Y\\). Moreover, \\(\\omega\\) intersects segment \\(X Y\\) at two points, and therefore the projection \\(M\\) of \\(I\\) onto \\(X Y\\) lies on the segment \\(X Y\\). In this case, we will prove that \\(\\angle C>120^{\\circ}\\).\n\nLet \\(Y K, Y L\\) be two tangents from point \\(Y\\) to \\(\\omega\\) (points \\(K\\) and \\(A_{1}\\) lie on one side of \\(X Y\\); if \\(Y\\) lies on \\(\\omega\\), we say \\(K=L=Y\\) ); one of the points \\(K\\) and \\(L\\) is in fact a tangency point \\(B_{1}\\) of \\(\\omega\\) and \\(A C\\). From symmetry, we have \\(\\angle Y I K=\\angle Y I L\\). On the other hand, since \\(I X>I Y\\), we get \\(X M<X Y\\) which implies \\(\\angle A_{1} X Y<\\angle K Y X\\).\n\nNext, we have \\(\\angle M I Y=90^{\\circ}-\\angle I Y X<90^{\\circ}-\\angle Z Y X=30^{\\circ}\\). Since \\(I A_{1} \\perp A_{1} X, I M \\perp X Y\\), \\(I K \\perp Y K\\) we get \\(\\angle M I A_{1}=\\angle A_{1} X Y<\\angle K Y X=\\angle M I K\\). Finally, we get\n\n\\[\n\\begin{aligned}\n\\angle A_{1} I K<\\angle A_{1} I L=( & \\left.\\angle A_{1} I M+\\angle M I K\\right)+(\\angle K I Y+\\angle Y I L) \n& <2 \\angle M I K+2 \\angle K I Y=2 \\angle M I Y<60^{\\circ} .\n\n\\]\n\nHence, \\(\\angle A_{1} I B_{1}<60^{\\circ}\\), and therefore \\(\\angle A C B=180^{\\circ}-\\angle A_{1} I B_{1}>120^{\\circ}\\), as desired.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-59(1)}\n\nFig. 5\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-59}\n\nFig. 6\n\nComment 1. The estimate claimed in \\(\\mathrm{G}_{6}{ }^{\\prime}\\) is sharp. Actually, if \\(\\angle B A C>120^{\\circ}\\), one can consider an equilateral triangle \\(X Y Z\\) with \\(Z=A, Y \\in A C, X \\in B C\\) (such triangle exists since \\(\\angle A C B<60^{\\circ}\\) ). It intersects with the angle bisector of \\(\\angle B A C\\) only at point \\(A\\), hence it does not contain \\(I\\).\n\nComment 2. As in the previous solution, there is a generalization for an arbitrary triangle \\(X Y Z\\), but here we need some additional condition. The statement reads as follows.\nClaim. Let the vertices \\(X, Y, Z\\) of a triangle \\(X Y Z\\) lie respectively on the sides \\(B C, C A, A B\\) of a triangle \\(A B C\\). Suppose that the incenter of triangle \\(A B C\\) lies outside triangle \\(X Y Z, \\alpha\\) is the least angle of \\(\\triangle X Y Z\\), and all sides of triangle \\(X Y Z\\) are greater than \\(2 r \\cot \\alpha\\), where \\(r\\) is the inradius of \\(\\triangle A B C\\). Then one of the angles of triangle \\(A B C\\) is greater than \\(2 \\alpha\\).\n\nThe additional condition is needed to verify that \\(X M>Y M\\) since it cannot be shown in the original way. Actually, we have \\(\\angle M Y I>\\alpha, I M<r\\), hence \\(Y M<r \\cot \\alpha\\). Now, if we have \\(X Y=X M+Y M>2 r \\cot \\alpha\\), then surely \\(X M>Y M\\).\n\nOn the other hand, this additional condition follows easily from the conditions of the original problem. Actually, if \\(I \\in \\triangle A Y Z\\), then the diameter of \\(\\omega\\) parallel to \\(Y Z\\) is contained in \\(\\triangle A Y Z\\) and is thus shorter than \\(Y Z\\). Hence \\(Y Z>2 r>2 r \\cot 60^{\\circ}\\)."}
{"id": "imo-shortlist-2010-g7", "question": "G7. Three circular arcs \\(\\gamma_{1}, \\gamma_{2}\\), and \\(\\gamma_{3}\\) connect the points \\(A\\) and \\(C\\). These arcs lie in the same half-plane defined by line \\(A C\\) in such a way that arc \\(\\gamma_{2}\\) lies between the arcs \\(\\gamma_{1}\\) and \\(\\gamma_{3}\\). Point \\(B\\) lies on the segment \\(A C\\). Let \\(h_{1}, h_{2}\\), and \\(h_{3}\\) be three rays starting at \\(B\\), lying in the same half-plane, \\(h_{2}\\) being between \\(h_{1}\\) and \\(h_{3}\\). For \\(i, j=1,2,3\\), denote by \\(V_{i j}\\) the point of intersection of \\(h_{i}\\) and \\(\\gamma_{j}\\) (see the Figure below).\n\nDenote by \\(\\widehat{V_{i j} V_{k j}} \\widehat{V_{k \\ell} V_{i \\ell}}\\) the curved quadrilateral, whose sides are the segments \\(V_{i j} V_{i \\ell}, V_{k j} V_{k \\ell}\\) and \\(\\operatorname{arcs} V_{i j} V_{k j}\\) and \\(V_{i \\ell} V_{k \\ell}\\). We say that this quadrilateral is circumscribed if there exists a circle touching these two segments and two arcs.\n\nProve that if the curved quadrilaterals \\(\\widehat{V_{11} V_{21}} \\widehat{2_{22} V_{12}}, \\widehat{V_{12} V_{22}} \\widehat{V_{23} V_{13}}, \\widehat{V_{21} V_{31}} \\widehat{3_{32} V_{22}}\\) are circumscribed, then the curved quadrilateral \\(\\widehat{V_{22} V_{32}} \\widehat{V_{33} V_{23}}\\) is circumscribed, too.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-61}\n\nFig. 1\n(Hungary)", "category": "Geometry", "source": "IMO Shortlist", "year": 2010, "solution": "Denote by \\(O_{i}\\) and \\(R_{i}\\) the center and the radius of \\(\\gamma_{i}\\), respectively. Denote also by \\(H\\) the half-plane defined by \\(A C\\) which contains the whole configuration. For every point \\(P\\) in the half-plane \\(H\\), denote by \\(d(P)\\) the distance between \\(P\\) and line \\(A C\\). Furthermore, for any \\(r>0\\), denote by \\(\\Omega(P, r)\\) the circle with center \\(P\\) and radius \\(r\\).\nLemma 1. For every \\(1 \\leq i<j \\leq 3\\), consider those circles \\(\\Omega(P, r)\\) in the half-plane \\(H\\) which are tangent to \\(h_{i}\\) and \\(h_{j}\\).\n(a) The locus of the centers of these circles is the angle bisector \\(\\beta_{i j}\\) between \\(h_{i}\\) and \\(h_{j}\\).\n(b) There is a constant \\(u_{i j}\\) such that \\(r=u_{i j} \\cdot d(P)\\) for all such circles.\n\nProof. Part (a) is obvious. To prove part (b), notice that the circles which are tangent to \\(h_{i}\\) and \\(h_{j}\\) are homothetic with the common homothety center \\(B\\) (see Fig. 2). Then part (b) also becomes trivial.\n\nLemma 2. For every \\(1 \\leq i<j \\leq 3\\), consider those circles \\(\\Omega(P, r)\\) in the half-plane \\(H\\) which are externally tangent to \\(\\gamma_{i}\\) and internally tangent to \\(\\gamma_{j}\\).\n(a) The locus of the centers of these circles is an ellipse arc \\(\\varepsilon_{i j}\\) with end-points \\(A\\) and \\(C\\).\n(b) There is a constant \\(v_{i j}\\) such that \\(r=v_{i j} \\cdot d(P)\\) for all such circles.\n\nProof. (a) Notice that the circle \\(\\Omega(P, r)\\) is externally tangent to \\(\\gamma_{i}\\) and internally tangent to \\(\\gamma_{j}\\) if and only if \\(O_{i} P=R_{i}+r\\) and \\(O_{j}=R_{j}-r\\). Therefore, for each such circle we have\n\n\\[\nO_{i} P+O_{j} P=O_{i} A+O_{j} A=O_{i} C+O_{j} C=R_{i}+R_{j}\n\\]\n\nSuch points lie on an ellipse with foci \\(O_{i}\\) and \\(O_{j}\\); the diameter of this ellipse is \\(R_{i}+R_{j}\\), and it passes through the points \\(A\\) and \\(C\\). Let \\(\\varepsilon_{i j}\\) be that arc \\(A C\\) of the ellipse which runs inside the half plane \\(H\\) (see Fig. 3.)\n\nThis ellipse arc lies between the arcs \\(\\gamma_{i}\\) and \\(\\gamma_{j}\\). Therefore, if some point \\(P\\) lies on \\(\\varepsilon_{i j}\\), then \\(O_{i} P>R_{i}\\) and \\(O_{j} P<R_{j}\\). Now, we choose \\(r=O_{i} P-R_{i}=R_{j}-O_{j} P>0\\); then the\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-62(1)}\n\nFig. 2\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-62}\n\nFig. 3\ncircle \\(\\Omega(P, r)\\) touches \\(\\gamma_{i}\\) externally and touches \\(\\gamma_{j}\\) internally, so \\(P\\) belongs to the locus under investigation.\n(b) Let \\(\\vec{\\rho}=\\overrightarrow{A P}, \\overrightarrow{\\rho_{i}}=\\overrightarrow{A O_{i}}\\), and \\(\\vec{\\rho}_{j}=\\overrightarrow{A O_{j}}\\); let \\(d_{i j}=O_{i} O_{j}\\), and let \\(\\vec{v}\\) be a unit vector orthogonal to \\(A C\\) and directed toward \\(H\\). Then we have \\(\\left|\\vec{\\rho}_{i}\\right|=R_{i},\\left|\\vec{\\rho}_{j}\\right|=R_{j},\\left|\\overrightarrow{O_{i} P}\\right|=\\) \\(\\left|\\vec{\\rho}-\\vec{\\rho}_{i}\\right|=R_{i}+r,\\left|\\overrightarrow{O_{j} P}\\right|=\\left|\\vec{\\rho}-\\vec{\\rho}_{j}\\right|=R_{j}-r\\), hence\n\n\\[\n\\begin{gathered}\n\\left(\\vec{\\rho}-\\vec{\\rho}_{i}\\right)^{2}-\\left(\\vec{\\rho}-\\vec{\\rho}_{j}\\right)^{2}=\\left(R_{i}+r\\right)^{2}-\\left(R_{j}-r\\right)^{2}, \n\\left(\\vec{\\rho}_{i}^{2}-\\vec{\\rho}_{j}^{2}\\right)+2 \\vec{\\rho} \\cdot\\left(\\vec{\\rho}_{j}-\\vec{\\rho}_{i}\\right)=\\left(R_{i}^{2}-R_{j}^{2}\\right)+2 r\\left(R_{i}+R_{j}\\right), \nd_{i j} \\cdot d(P)=d_{i j} \\vec{v} \\cdot \\vec{\\rho}=\\left(\\vec{\\rho}_{j}-\\vec{\\rho}_{i}\\right) \\cdot \\vec{\\rho}=r\\left(R_{i}+R_{j}\\right) .\n\n\\]\n\nTherefore,\n\n\\[\nr=\\frac{d_{i j}}{R_{i}+R_{j}} \\cdot d(P)\n\\]\n\nand the value \\(v_{i j}=\\frac{d_{i j}}{R_{i}+R_{j}}\\) does not depend on \\(P\\).\nLemma 3. The curved quadrilateral \\(\\mathcal{Q}_{i j}=\\sqrt{i, j V_{i+1, j}} V_{i+1, j+1} V_{i, j+1}\\) is circumscribed if and only if \\(u_{i, i+1}=v_{j, j+1}\\).\nProof. First suppose that the curved quadrilateral \\(\\mathcal{Q}_{i j}\\) is circumscribed and \\(\\Omega(P, r)\\) is its inscribed circle. By Lemma 1 and Lemma 2 we have \\(r=u_{i, i+1} \\cdot d(P)\\) and \\(r=v_{j, j+1} \\cdot d(P)\\) as well. Hence, \\(u_{i, i+1}=v_{j, j+1}\\).\n\nTo prove the opposite direction, suppose \\(u_{i, i+1}=v_{j, j+1}\\). Let \\(P\\) be the intersection of the angle bisector \\(\\beta_{i, i+1}\\) and the ellipse arc \\(\\varepsilon_{j, j+1}\\). Choose \\(r=u_{i, i+1} \\cdot d(P)=v_{j, j+1} \\cdot d(P)\\). Then the circle \\(\\Omega(P, r)\\) is tangent to the half lines \\(h_{i}\\) and \\(h_{i+1}\\) by Lemma 1 , and it is tangent to the arcs \\(\\gamma_{j}\\) and \\(\\gamma_{j+1}\\) by Lemma 2. Hence, the curved quadrilateral \\(\\mathcal{Q}_{i j}\\) is circumscribed.\n\nBy Lemma 3, the statement of the problem can be reformulated to an obvious fact: If the equalities \\(u_{12}=v_{12}, u_{12}=v_{23}\\), and \\(u_{23}=v_{12}\\) hold, then \\(u_{23}=v_{23}\\) holds as well.\n\nComment 1. Lemma 2(b) (together with the easy Lemma 1(b)) is the key tool in this solution. If one finds this fact, then the solution can be finished in many ways. That is, one can find a circle touching three of \\(h_{2}, h_{3}, \\gamma_{2}\\), and \\(\\gamma_{3}\\), and then prove that it is tangent to the fourth one in either synthetic or analytical way. Both approaches can be successful.\n\nHere we present some discussion about this key Lemma.\n\n\\begin{enumerate}\n  \\item In the solution above we chose an analytic proof for Lemma 2(b) because we expect that most students will use coordinates or vectors to examine the locus of the centers, and these approaches are less case-sensitive.\n\n\nHere we outline a synthetic proof. We consider only the case when \\(P\\) does not lie in the line \\(O_{i} O_{j}\\). The other case can be obtained as a limit case, or computed in a direct way.\n\nLet \\(S\\) be the internal homothety center between the circles of \\(\\gamma_{i}\\) and \\(\\gamma_{j}\\), lying on \\(O_{i} O_{j}\\); this point does not depend on \\(P\\). Let \\(U\\) and \\(V\\) be the points of tangency of circle \\(\\sigma=\\Omega(P, r)\\) with \\(\\gamma_{i}\\) and \\(\\gamma_{j}\\), respectively (then \\(r=P U=P V\\) ); in other words, points \\(U\\) and \\(V\\) are the intersection points of rays \\(O_{i} P, O_{j} P\\) with arcs \\(\\gamma_{i}, \\gamma_{j}\\) respectively (see Fig. 4).\n\nDue to the theorem on three homothety centers (or just to the Menelaus theorem applied to triangle \\(O_{i} O_{j} P\\) ), the points \\(U, V\\) and \\(S\\) are collinear. Let \\(T\\) be the intersection point of line \\(A C\\) and the common tangent to \\(\\sigma\\) and \\(\\gamma_{i}\\) at \\(U\\); then \\(T\\) is the radical center of \\(\\sigma, \\gamma_{i}\\) and \\(\\gamma_{j}\\), hence \\(T V\\) is the common tangent to \\(\\sigma\\) and \\(\\gamma_{j}\\).\n\nLet \\(Q\\) be the projection of \\(P\\) onto the line \\(A C\\). By the right angles, the points \\(U, V\\) and \\(Q\\) lie on the circle with diameter \\(P T\\). From this fact and the equality \\(P U=P V\\) we get \\(\\angle U Q P=\\angle U V P=\\) \\(\\angle V U P=\\angle S U O_{i}\\). Since \\(O_{i} S \\| P Q\\), we have \\(\\angle S O_{i} U=\\angle Q P U\\). Hence, the triangles \\(S O_{i} U\\) and \\(U P Q\\) are similar and thus \\(\\frac{r}{d(P)}=\\frac{P U}{P Q}=\\frac{O_{i} S}{O_{i} U}=\\frac{O_{i} S}{R_{i}}\\); the last expression is constant since \\(S\\) is a constant point.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-63(1)}\n\nFig. 4\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-63}\n\nFig. 5\n2. Using some known facts about conics, the same statement can be proved in a very short way. Denote by \\(\\ell\\) the directrix of ellipse of \\(\\varepsilon_{i j}\\) related to the focus \\(O_{j}\\); since \\(\\varepsilon_{i j}\\) is symmetrical about \\(O_{i} O_{j}\\), we have \\(\\ell \\| A C\\). Recall that for each point \\(P \\in \\varepsilon_{i j}\\), we have \\(P O_{j}=\\epsilon \\cdot d_{\\ell}(P)\\), where \\(d_{\\ell}(P)\\) is the distance from \\(P\\) to \\(\\ell\\), and \\(\\epsilon\\) is the eccentricity of \\(\\varepsilon_{i j}\\) (see Fig. 5).\n\nNow we have\n\n\\[\nr=R_{j}-\\left(R_{j}-r\\right)=A O_{j}-P O_{j}=\\epsilon\\left(d_{\\ell}(A)-d_{\\ell}(P)\\right)=\\epsilon(d(P)-d(A))=\\epsilon \\cdot d(P)\n\\]\n\nand \\(\\epsilon\\) does not depend on \\(P\\).\n\nComment 2. One can find a spatial interpretations of the problem and the solution.\nFor every point ( \\(x, y\\) ) and radius \\(r>0\\), represent the circle \\(\\Omega((x, y), r)\\) by the point ( \\(x, y, r\\) ) in space. This point is the apex of the cone with base circle \\(\\Omega((x, y), r)\\) and height \\(r\\). According to Lemma 1, the circles which are tangent to \\(h_{i}\\) and \\(h_{j}\\) correspond to the points of a half line \\(\\beta_{i j}^{\\prime}\\), starting at \\(B\\).\n\nNow we translate Lemma 2. Take some \\(1 \\leq i<j \\leq 3\\), and consider those circles which are internally tangent to \\(\\gamma_{j}\\). It is easy to see that the locus of the points which represent these circles is a subset of a cone, containing \\(\\gamma_{j}\\). Similarly, the circles which are externally tangent to \\(\\gamma_{i}\\) correspond to the points on the extension of another cone, which has its apex on the opposite side of the base plane \\(\\Pi\\). (See Fig. 6; for this illustration, the \\(z\\)-coordinates were multiplied by 2.)\n\nThe two cones are symmetric to each other (they have the same aperture, and their axes are parallel). As is well-known, it follows that the common points of the two cones are co-planar. So the intersection of the two cones is a conic section - which is an ellipse, according to Lemma 2(a). The points which represent the circles touching \\(\\gamma_{i}\\) and \\(\\gamma_{j}\\) is an ellipse arc \\(\\varepsilon_{i j}^{\\prime}\\) with end-points \\(A\\) and \\(C\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-64(1)}\n\nFig. 6\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-64}\n\nFig. 7\n\nThus, the curved quadrilateral \\(\\mathcal{Q}_{i j}\\) is circumscribed if and only if \\(\\beta_{i, i+1}^{\\prime}\\) and \\(\\varepsilon_{j, j+1}^{\\prime}\\) intersect, i.e. if they are coplanar. If three of the four curved quadrilaterals are circumscribed, it means that \\(\\varepsilon_{12}^{\\prime}, \\varepsilon_{23}^{\\prime}\\), \\(\\beta_{12}^{\\prime}\\) and \\(\\beta_{23}^{\\prime}\\) lie in the same plane \\(\\Sigma\\), and the fourth intersection comes to existence, too (see Fig. 7).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_d27755b953882b2aeed4g-64(2)}\n\nA connection between mathematics and real life: the Palace of Creativity \"Shabyt\" (\"Inspiration\") in Astana"}
{"id": "imo-shortlist-2010-n1", "question": "N1. Find the least positive integer \\(n\\) for which there exists a set \\(\\left\\{s_{1}, s_{2}, \\ldots, s_{n}\\right\\}\\) consisting of \\(n\\) distinct positive integers such that\n\n\\[\n\\left(1-\\frac{1}{s_{1}}\\right)\\left(1-\\frac{1}{s_{2}}\\right) \\ldots\\left(1-\\frac{1}{s_{n}}\\right)=\\frac{51}{2010} .\n\\]\n\nN1 \\(^{\\prime}\\). Same as Problem N1, but the constant \\(\\frac{51}{2010}\\) is replaced by \\(\\frac{42}{2010}\\).\n(Canada)\nAnswer for Problem", "category": "Number Theory", "source": "IMO Shortlist", "year": 2010, "solution": ""}
{"id": "imo-shortlist-2010-n1", "question": "N1. \\(n=39\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2010, "solution": "for Problem"}
{"id": "imo-shortlist-2010-n1", "question": "N1. Suppose that for some \\(n\\) there exist the desired numbers; we may assume that \\(s_{1}<s_{2}<\\cdots<s_{n}\\). Surely \\(s_{1}>1\\) since otherwise \\(1-\\frac{1}{s_{1}}=0\\). So we have \\(2 \\leq s_{1} \\leq s_{2}-1 \\leq \\cdots \\leq s_{n}-(n-1)\\), hence \\(s_{i} \\geq i+1\\) for each \\(i=1, \\ldots, n\\). Therefore\n\n\\[\n\\begin{aligned}\n\\frac{51}{2010} & =\\left(1-\\frac{1}{s_{1}}\\right)\\left(1-\\frac{1}{s_{2}}\\right) \\ldots\\left(1-\\frac{1}{s_{n}}\\right) \n& \\geq\\left(1-\\frac{1}{2}\\right)\\left(1-\\frac{1}{3}\\right) \\ldots\\left(1-\\frac{1}{n+1}\\right)=\\frac{1}{2} \\cdot \\frac{2}{3} \\cdots \\frac{n}{n+1}=\\frac{1}{n+1},\n\n\\]\n\nwhich implies\n\n\\[\nn+1 \\geq \\frac{2010}{51}=\\frac{670}{17}>39\n\\]\n\nso \\(n \\geq 39\\).\nNow we are left to show that \\(n=39\\) fits. Consider the set \\(\\{2,3, \\ldots, 33,35,36, \\ldots, 40,67\\}\\) which contains exactly 39 numbers. We have\n\n\\[\n\\frac{1}{2} \\cdot \\frac{2}{3} \\cdots \\frac{32}{33} \\cdot \\frac{34}{35} \\cdots \\frac{39}{40} \\cdot \\frac{66}{67}=\\frac{1}{33} \\cdot \\frac{34}{40} \\cdot \\frac{66}{67}=\\frac{17}{670}=\\frac{51}{2010}\n\\]\n\nhence for \\(n=39\\) there exists a desired example.\nComment. One can show that the example (1) is unique.\nAnswer for Problem N1'. \\(n=48\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2010, "solution": "for Problem N1'. Suppose that for some \\(n\\) there exist the desired numbers. In the same way we obtain that \\(s_{i} \\geq i+1\\). Moreover, since the denominator of the fraction \\(\\frac{42}{2010}=\\frac{7}{335}\\) is divisible by 67 , some of \\(s_{i}\\) 's should be divisible by 67 , so \\(s_{n} \\geq s_{i} \\geq 67\\). This means that\n\n\\[\n\\frac{42}{2010} \\geq \\frac{1}{2} \\cdot \\frac{2}{3} \\cdots \\frac{n-1}{n} \\cdot\\left(1-\\frac{1}{67}\\right)=\\frac{66}{67 n}\n\\]\n\nwhich implies\n\n\\[\nn \\geq \\frac{2010 \\cdot 66}{42 \\cdot 67}=\\frac{330}{7}>47\n\\]\n\nso \\(n \\geq 48\\).\nNow we are left to show that \\(n=48\\) fits. Consider the set \\(\\{2,3, \\ldots, 33,36,37, \\ldots, 50,67\\}\\) which contains exactly 48 numbers. We have\n\n\\[\n\\frac{1}{2} \\cdot \\frac{2}{3} \\cdots \\frac{32}{33} \\cdot \\frac{35}{36} \\cdots \\frac{49}{50} \\cdot \\frac{66}{67}=\\frac{1}{33} \\cdot \\frac{35}{50} \\cdot \\frac{66}{67}=\\frac{7}{335}=\\frac{42}{2010}\n\\]\n\nhence for \\(n=48\\) there exists a desired example.\nComment 1. In this version of the problem, the estimate needs one more step, hence it is a bit harder. On the other hand, the example in this version is not unique. Another example is\n\n\\[\n\\frac{1}{2} \\cdot \\frac{2}{3} \\cdots \\frac{46}{47} \\cdot \\frac{66}{67} \\cdot \\frac{329}{330}=\\frac{1}{67} \\cdot \\frac{66}{330} \\cdot \\frac{329}{47}=\\frac{7}{67 \\cdot 5}=\\frac{42}{2010} .\n\\]\n\nComment 2. N1' was the Proposer's formulation of the problem. We propose N1 according to the number of current IMO."}
{"id": "imo-shortlist-2010-n2", "question": "N2. Find all pairs \\((m, n)\\) of nonnegative integers for which\n\n\\[\nm^{2}+2 \\cdot 3^{n}=m\\left(2^{n+1}-1\\right)\n\\]\n\n(Australia)\nAnswer. (6, 3), (9, 3), (9, 5), (54, 5).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2010, "solution": "For fixed values of \\(n\\), the equation (1) is a simple quadratic equation in \\(m\\). For \\(n \\leq 5\\) the solutions are listed in the following table.\n\n\\begin{center}\n\\begin{tabular}{|l|l|l|l|}\n\\hline\ncase & equation & discriminant & integer roots \n\\hline\n\\(n=0\\) & \\(m^{2}-m+2=0\\) & -7 & none \n\\(n=1\\) & \\(m^{2}-3 m+6=0\\) & -15 & none \n\\(n=2\\) & \\(m^{2}-7 m+18=0\\) & -23 & none \n\\(n=3\\) & \\(m^{2}-15 m+54=0\\) & 9 & \\(m=6\\) and \\(m=9\\) \n\\(n=4\\) & \\(m^{2}-31 m+162=0\\) & 313 & none \n\\(n=5\\) & \\(m^{2}-63 m+486=0\\) & \\(2025=45^{2}\\) & \\(m=9\\) and \\(m=54\\) \n\\hline\n\n\n\nWe prove that there is no solution for \\(n \\geq 6\\).\nSuppose that \\((m, n)\\) satisfies (1) and \\(n \\geq 6\\). Since \\(m \\mid 2 \\cdot 3^{n}=m\\left(2^{n+1}-1\\right)-m^{2}\\), we have \\(m=3^{p}\\) with some \\(0 \\leq p \\leq n\\) or \\(m=2 \\cdot 3^{q}\\) with some \\(0 \\leq q \\leq n\\).\n\nIn the first case, let \\(q=n-p\\); then\n\n\\[\n2^{n+1}-1=m+\\frac{2 \\cdot 3^{n}}{m}=3^{p}+2 \\cdot 3^{q}\n\\]\n\nIn the second case let \\(p=n-q\\). Then\n\n\\[\n2^{n+1}-1=m+\\frac{2 \\cdot 3^{n}}{m}=2 \\cdot 3^{q}+3^{p}\n\\]\n\nHence, in both cases we need to find the nonnegative integer solutions of\n\n\\[\n3^{p}+2 \\cdot 3^{q}=2^{n+1}-1, \\quad p+q=n\n\\]\n\nNext, we prove bounds for \\(p, q\\). From (2) we get\n\n\\[\n3^{p}<2^{n+1}=8^{\\frac{n+1}{3}}<9^{\\frac{n+1}{3}}=3^{\\frac{2(n+1)}{3}}\n\\]\n\nand\n\n\\[\n2 \\cdot 3^{q}<2^{n+1}=2 \\cdot 8^{\\frac{n}{3}}<2 \\cdot 9^{\\frac{n}{3}}=2 \\cdot 3^{\\frac{2 n}{3}}<2 \\cdot 3^{\\frac{2(n+1)}{3}}\n\\]\n\nso \\(p, q<\\frac{2(n+1)}{3}\\). Combining these inequalities with \\(p+q=n\\), we obtain\n\n\\[\n\\frac{n-2}{3}<p, q<\\frac{2(n+1)}{3}\n\\]\n\nNow let \\(h=\\min (p, q)\\). By (3) we have \\(h>\\frac{n-2}{3}\\); in particular, we have \\(h>1\\). On the left-hand side of (2), both terms are divisible by \\(3^{h}\\), therefore \\(9\\left|3^{h}\\right| 2^{n+1}-1\\). It is easy check that \\(\\operatorname{ord}_{9}(2)=6\\), so \\(9 \\mid 2^{n+1}-1\\) if and only if \\(6 \\mid n+1\\). Therefore, \\(n+1=6 r\\) for some positive integer \\(r\\), and we can write\n\n\\[\n2^{n+1}-1=4^{3 r}-1=\\left(4^{2 r}+4^{r}+1\\right)\\left(2^{r}-1\\right)\\left(2^{r}+1\\right)\n\\]\n\nNotice that the factor \\(4^{2 r}+4^{r}+1=\\left(4^{r}-1\\right)^{2}+3 \\cdot 4^{r}\\) is divisible by 3 , but it is never divisible by 9 . The other two factors in (4), \\(2^{r}-1\\) and \\(2^{r}+1\\) are coprime: both are odd and their difference is 2 . Since the whole product is divisible by \\(3^{h}\\), we have either \\(3^{h-1} \\mid 2^{r}-1\\) or \\(3^{h-1} \\mid 2^{r}+1\\). In any case, we have \\(3^{h-1} \\leq 2^{r}+1\\). Then\n\n\\[\n\\begin{gathered}\n3^{h-1} \\leq 2^{r}+1 \\leq 3^{r}=3^{\\frac{n+1}{6}} \n\\frac{n-2}{3}-1<h-1 \\leq \\frac{n+1}{6} \nn<11\n\n\\]\n\nBut this is impossible since we assumed \\(n \\geq 6\\), and we proved \\(6 \\mid n+1\\)."}
{"id": "imo-shortlist-2010-n3", "question": "N3. Find the smallest number \\(n\\) such that there exist polynomials \\(f_{1}, f_{2}, \\ldots, f_{n}\\) with rational coefficients satisfying\n\n\\[\nx^{2}+7=f_{1}(x)^{2}+f_{2}(x)^{2}+\\cdots+f_{n}(x)^{2}\n\\]\n\n(Poland)\nAnswer. The smallest \\(n\\) is 5 .", "category": "Number Theory", "source": "IMO Shortlist", "year": 2010, "solution": "The equality \\(x^{2}+7=x^{2}+2^{2}+1^{2}+1^{2}+1^{2}\\) shows that \\(n \\leq 5\\). It remains to show that \\(x^{2}+7\\) is not a sum of four (or less) squares of polynomials with rational coefficients.\n\nSuppose by way of contradiction that \\(x^{2}+7=f_{1}(x)^{2}+f_{2}(x)^{2}+f_{3}(x)^{2}+f_{4}(x)^{2}\\), where the coefficients of polynomials \\(f_{1}, f_{2}, f_{3}\\) and \\(f_{4}\\) are rational (some of these polynomials may be zero).\n\nClearly, the degrees of \\(f_{1}, f_{2}, f_{3}\\) and \\(f_{4}\\) are at most 1 . Thus \\(f_{i}(x)=a_{i} x+b_{i}\\) for \\(i=1,2,3,4\\) and some rationals \\(a_{1}, b_{1}, a_{2}, b_{2}, a_{3}, b_{3}, a_{4}, b_{4}\\). It follows that \\(x^{2}+7=\\sum_{i=1}^{4}\\left(a_{i} x+b_{i}\\right)^{2}\\) and hence\n\n\\[\n\\sum_{i=1}^{4} a_{i}^{2}=1, \\quad \\sum_{i=1}^{4} a_{i} b_{i}=0, \\quad \\sum_{i=1}^{4} b_{i}^{2}=7 .\n\\]\n\nLet \\(p_{i}=a_{i}+b_{i}\\) and \\(q_{i}=a_{i}-b_{i}\\) for \\(i=1,2,3,4\\). Then\n\n\\[\n\\begin{aligned}\n\\sum_{i=1}^{4} p_{i}^{2} & =\\sum_{i=1}^{4} a_{i}^{2}+2 \\sum_{i=1}^{4} a_{i} b_{i}+\\sum_{i=1}^{4} b_{i}^{2}=8 \n\\sum_{i=1}^{4} q_{i}^{2} & =\\sum_{i=1}^{4} a_{i}^{2}-2 \\sum_{i=1}^{4} a_{i} b_{i}+\\sum_{i=1}^{4} b_{i}^{2}=8 \n\\text { and } \\quad \\sum_{i=1}^{4} p_{i} q_{i} & =\\sum_{i=1}^{4} a_{i}^{2}-\\sum_{i=1}^{4} b_{i}^{2}=-6\n\n\\]\n\nwhich means that there exist a solution in integers \\(x_{1}, y_{1}, x_{2}, y_{2}, x_{3}, y_{3}, x_{4}, y_{4}\\) and \\(m>0\\) of the system of equations\n\n\\[\n\\text { (i) } \\sum_{i=1}^{4} x_{i}^{2}=8 m^{2}, \\quad \\text { (ii) } \\sum_{i=1}^{4} y_{i}^{2}=8 m^{2}, \\quad \\text { (iii) } \\sum_{i=1}^{4} x_{i} y_{i}=-6 m^{2}\n\\]\n\nWe will show that such a solution does not exist.\nAssume the contrary and consider a solution with minimal \\(m\\). Note that if an integer \\(x\\) is odd then \\(x^{2} \\equiv 1(\\bmod 8)\\). Otherwise (i.e., if \\(x\\) is even) we have \\(x^{2} \\equiv 0(\\bmod 8)\\) or \\(x^{2} \\equiv 4\\) (mod 8). Hence, by (i), we get that \\(x_{1}, x_{2}, x_{3}\\) and \\(x_{4}\\) are even. Similarly, by (ii), we get that \\(y_{1}, y_{2}, y_{3}\\) and \\(y_{4}\\) are even. Thus the LHS of (iii) is divisible by 4 and \\(m\\) is also even. It follows that ( \\(\\frac{x_{1}}{2}, \\frac{y_{1}}{2}, \\frac{x_{2}}{2}, \\frac{y_{2}}{2}, \\frac{x_{3}}{2}, \\frac{y_{3}}{2}, \\frac{x_{4}}{2}, \\frac{y_{4}}{2}, \\frac{m}{2}\\) ) is a solution of the system of equations (i), (ii) and (iii), which contradicts the minimality of \\(m\\).\n\nSolution 2. We prove that \\(n \\leq 4\\) is impossible. Define the numbers \\(a_{i}, b_{i}\\) for \\(i=1,2,3,4\\) as in the previous solution.\n\nBy Euler's identity we have\n\n\\[\n\\begin{aligned}\n\\left(a_{1}^{2}+a_{2}^{2}+a_{3}^{2}+a_{4}^{2}\\right)\\left(b_{1}^{2}+b_{2}^{2}+b_{3}^{2}+b_{4}^{2}\\right) & =\\left(a_{1} b_{1}+a_{2} b_{2}+a_{3} b_{3}+a_{4} b_{4}\\right)^{2}+\\left(a_{1} b_{2}-a_{2} b_{1}+a_{3} b_{4}-a_{4} b_{3}\\right)^{2} \n& +\\left(a_{1} b_{3}-a_{3} b_{1}+a_{4} b_{2}-a_{2} b_{4}\\right)^{2}+\\left(a_{1} b_{4}-a_{4} b_{1}+a_{2} b_{3}-a_{3} b_{2}\\right)^{2}\n\n\\]\n\nSo, using the relations (1) from the Solution 1 we get that\n\n\\[\n7=\\left(\\frac{m_{1}}{m}\\right)^{2}+\\left(\\frac{m_{2}}{m}\\right)^{2}+\\left(\\frac{m_{3}}{m}\\right)^{2}\n\\]\n\nwhere\n\n\\[\n\\begin{aligned}\n& \\frac{m_{1}}{m}=a_{1} b_{2}-a_{2} b_{1}+a_{3} b_{4}-a_{4} b_{3} \n& \\frac{m_{2}}{m}=a_{1} b_{3}-a_{3} b_{1}+a_{4} b_{2}-a_{2} b_{4} \n& \\frac{m_{3}}{m}=a_{1} b_{4}-a_{4} b_{1}+a_{2} b_{3}-a_{3} b_{2}\n\n\\]\n\nand \\(m_{1}, m_{2}, m_{3} \\in \\mathbb{Z}, m \\in \\mathbb{N}\\).\nLet \\(m\\) be a minimum positive integer number for which (2) holds. Then\n\n\\[\n8 m^{2}=m_{1}^{2}+m_{2}^{2}+m_{3}^{2}+m^{2}\n\\]\n\nAs in the previous solution, we get that \\(m_{1}, m_{2}, m_{3}, m\\) are all even numbers. Then ( \\(\\frac{m_{1}}{2}, \\frac{m_{2}}{2}, \\frac{m_{3}}{2}, \\frac{m}{2}\\) ) is also a solution of (2) which contradicts the minimality of \\(m\\). So, we have \\(n \\geq 5\\). The example with \\(n=5\\) is already shown in Solution 1 ."}
{"id": "imo-shortlist-2010-n4", "question": "N4. Let \\(a, b\\) be integers, and let \\(P(x)=a x^{3}+b x\\). For any positive integer \\(n\\) we say that the pair (a,b) is \\(n\\)-good if \\(n \\mid P(m)-P(k)\\) implies \\(n \\mid m-k\\) for all integers \\(m, k\\). We say that \\((a, b)\\) is very good if \\((a, b)\\) is \\(n\\)-good for infinitely many positive integers \\(n\\).\n(a) Find a pair \\((a, b)\\) which is 51 -good, but not very good.\n(b) Show that all 2010-good pairs are very good.\n(Turkey)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2010, "solution": "(a) We show that the pair \\(\\left(1,-51^{2}\\right)\\) is good but not very good. Let \\(P(x)=x^{3}-51^{2} x\\). Since \\(P(51)=P(0)\\), the pair \\(\\left(1,-51^{2}\\right)\\) is not \\(n\\)-good for any positive integer that does not divide 51 . Therefore, \\(\\left(1,-51^{2}\\right)\\) is not very good.\n\nOn the other hand, if \\(P(m) \\equiv P(k)(\\bmod 51)\\), then \\(m^{3} \\equiv k^{3}(\\bmod 51)\\). By Fermat's theorem, from this we obtain\n\n\\[\nm \\equiv m^{3} \\equiv k^{3} \\equiv k \\quad(\\bmod 3) \\quad \\text { and } \\quad m \\equiv m^{33} \\equiv k^{33} \\equiv k \\quad(\\bmod 17)\n\\]\n\nHence we have \\(m \\equiv k(\\bmod 51)\\). Therefore \\(\\left(1,-51^{2}\\right)\\) is 51 -good.\n(b) We will show that if a pair \\((a, b)\\) is 2010 -good then \\((a, b)\\) is \\(67^{i}\\)-good for all positive integer \\(i\\).\nClaim 1. If \\((a, b)\\) is 2010 -good then \\((a, b)\\) is 67 -good.\nProof. Assume that \\(P(m)=P(k)\\) (mod 67). Since 67 and 30 are coprime, there exist integers \\(m^{\\prime}\\) and \\(k^{\\prime}\\) such that \\(k^{\\prime} \\equiv k(\\bmod 67), k^{\\prime} \\equiv 0(\\bmod 30)\\), and \\(m^{\\prime} \\equiv m(\\bmod 67), m^{\\prime} \\equiv 0\\) \\((\\bmod 30)\\). Then we have \\(P\\left(m^{\\prime}\\right) \\equiv P(0) \\equiv P\\left(k^{\\prime}\\right)(\\bmod 30)\\) and \\(P\\left(m^{\\prime}\\right) \\equiv P(m) \\equiv P(k) \\equiv P\\left(k^{\\prime}\\right)\\) ( \\(\\bmod 67\\) ), hence \\(P\\left(m^{\\prime}\\right) \\equiv P\\left(k^{\\prime}\\right)(\\bmod 2010)\\). This implies \\(m^{\\prime} \\equiv k^{\\prime}(\\bmod 2010)\\) as \\((a, b)\\) is 2010-good. It follows that \\(m \\equiv m^{\\prime} \\equiv k^{\\prime} \\equiv k(\\bmod 67)\\). Therefore, \\((a, b)\\) is 67 -good.\nClaim 2. If \\((a, b)\\) is 67 -good then \\(67 \\mid a\\).\nProof. Suppose that \\(67 \\nmid a\\). Consider the sets \\(\\left\\{a t^{2}(\\bmod 67): 0 \\leq t \\leq 33\\right\\}\\) and \\(\\left\\{-3 a s^{2}-b\\right.\\) \\(\\bmod 67: 0 \\leq s \\leq 33\\}\\). Since \\(a \\not \\equiv 0(\\bmod 67)\\), each of these sets has 34 elements. Hence they have at least one element in common. If \\(a t^{2} \\equiv-3 a s^{2}-b(\\bmod 67)\\) then for \\(m=t \\pm s, k=\\mp 2 s\\) we have\n\n\\[\n\\begin{aligned}\nP(m)-P(k)=a\\left(m^{3}-k^{3}\\right)+b(m-k) & =(m-k)\\left(a\\left(m^{2}+m k+k^{2}\\right)+b\\right) \n& =(t \\pm 3 s)\\left(a t^{2}+3 a s^{2}+b\\right) \\equiv 0 \\quad(\\bmod 67)\n\n\\]\n\nSince \\((a, b)\\) is 67 -good, we must have \\(m \\equiv k(\\bmod 67)\\) in both cases, that is, \\(t \\equiv 3 s(\\bmod 67)\\) and \\(t \\equiv-3 s(\\bmod 67)\\). This means \\(t \\equiv s \\equiv 0(\\bmod 67)\\) and \\(b \\equiv-3 a s^{2}-a t^{2} \\equiv 0(\\bmod 67)\\). But then \\(67 \\mid P(7)-P(2)=67 \\cdot 5 a+5 b\\) and \\(67 \\nmid 7-2\\), contradicting that \\((a, b)\\) is 67 -good.\nClaim 3. If \\((a, b)\\) is 2010 -good then \\((a, b)\\) is \\(67^{i}\\)-good all \\(i \\geq 1\\).\nProof. By Claim 2, we have \\(67 \\mid a\\). If \\(67 \\mid b\\), then \\(P(x) \\equiv P(0)(\\bmod 67)\\) for all \\(x\\), contradicting that \\((a, b)\\) is 67 -good. Hence, \\(67 \\nmid b\\).\n\nSuppose that \\(67^{i} \\mid P(m)-P(k)=(m-k)\\left(a\\left(m^{2}+m k+k^{2}\\right)+b\\right)\\). Since \\(67 \\mid a\\) and \\(67 \\nmid b\\), the second factor \\(a\\left(m^{2}+m k+k^{2}\\right)+b\\) is coprime to 67 and hence \\(67^{i} \\mid m-k\\). Therefore, \\((a, b)\\) is \\(67^{i}\\)-good.\nComment 1. In the proof of Claim 2, the following reasoning can also be used. Since 3 is not a quadratic residue modulo 67 , either \\(a u^{2} \\equiv-b(\\bmod 67)\\) or \\(3 a v^{2} \\equiv-b(\\bmod 67)\\) has a solution. The settings \\((m, k)=(u, 0)\\) in the first case and \\((m, k)=(v,-2 v)\\) in the second case lead to \\(b \\equiv 0\\) (mod 67).\nComment 2. The pair (67,30) is \\(n\\)-good if and only if \\(n=d \\cdot 67^{i}\\), where \\(d \\mid 30\\) and \\(i \\geq 0\\). It shows that in part (b), one should deal with the large powers of 67 to reach the solution. The key property of number 67 is that it has the form \\(3 k+1\\), so there exists a nontrivial cubic root of unity modulo 67 ."}
{"id": "imo-shortlist-2010-n5", "question": "N5. Let \\(\\mathbb{N}\\) be the set of all positive integers. Find all functions \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}\\) such that the number \\((f(m)+n)(m+f(n))\\) is a square for all \\(m, n \\in \\mathbb{N}\\).\n\nAnswer. All functions of the form \\(f(n)=n+c\\), where \\(c \\in \\mathbb{N} \\cup\\{0\\}\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2010, "solution": "First, it is clear that all functions of the form \\(f(n)=n+c\\) with a constant nonnegative integer \\(c\\) satisfy the problem conditions since \\((f(m)+n)(f(n)+m)=(n+m+c)^{2}\\) is a square.\n\nWe are left to prove that there are no other functions. We start with the following Lemma. Suppose that \\(p \\mid f(k)-f(\\ell)\\) for some prime \\(p\\) and positive integers \\(k, \\ell\\). Then \\(p \\mid k-\\ell\\). Proof. Suppose first that \\(p^{2} \\mid f(k)-f(\\ell)\\), so \\(f(\\ell)=f(k)+p^{2} a\\) for some integer \\(a\\). Take some positive integer \\(D>\\max \\{f(k), f(\\ell)\\}\\) which is not divisible by \\(p\\) and set \\(n=p D-f(k)\\). Then the positive numbers \\(n+f(k)=p D\\) and \\(n+f(\\ell)=p D+(f(\\ell)-f(k))=p(D+p a)\\) are both divisible by \\(p\\) but not by \\(p^{2}\\). Now, applying the problem conditions, we get that both the numbers \\((f(k)+n)(f(n)+k)\\) and \\((f(\\ell)+n)(f(n)+\\ell)\\) are squares divisible by \\(p\\) (and thus by \\(p^{2}\\) ); this means that the multipliers \\(f(n)+k\\) and \\(f(n)+\\ell\\) are also divisible by \\(p\\), therefore \\(p \\mid(f(n)+k)-(f(n)+\\ell)=k-\\ell\\) as well.\n\nOn the other hand, if \\(f(k)-f(\\ell)\\) is divisible by \\(p\\) but not by \\(p^{2}\\), then choose the same number \\(D\\) and set \\(n=p^{3} D-f(k)\\). Then the positive numbers \\(f(k)+n=p^{3} D\\) and \\(f(\\ell)+n=\\) \\(p^{3} D+(f(\\ell)-f(k))\\) are respectively divisible by \\(p^{3}\\) (but not by \\(p^{4}\\) ) and by \\(p\\) (but not by \\(p^{2}\\) ). Hence in analogous way we obtain that the numbers \\(f(n)+k\\) and \\(f(n)+\\ell\\) are divisible by \\(p\\), therefore \\(p \\mid(f(n)+k)-(f(n)+\\ell)=k-\\ell\\).\n\nWe turn to the problem. First, suppose that \\(f(k)=f(\\ell)\\) for some \\(k, \\ell \\in \\mathbb{N}\\). Then by Lemma we have that \\(k-\\ell\\) is divisible by every prime number, so \\(k-\\ell=0\\), or \\(k=\\ell\\). Therefore, the function \\(f\\) is injective.\n\nNext, consider the numbers \\(f(k)\\) and \\(f(k+1)\\). Since the number \\((k+1)-k=1\\) has no prime divisors, by Lemma the same holds for \\(f(k+1)-f(k)\\); thus \\(|f(k+1)-f(k)|=1\\).\n\nNow, let \\(f(2)-f(1)=q,|q|=1\\). Then we prove by induction that \\(f(n)=f(1)+q(n-1)\\). The base for \\(n=1,2\\) holds by the definition of \\(q\\). For the step, if \\(n>1\\) we have \\(f(n+1)=\\) \\(f(n) \\pm q=f(1)+q(n-1) \\pm q\\). Since \\(f(n) \\neq f(n-2)=f(1)+q(n-2)\\), we get \\(f(n)=f(1)+q n\\), as desired.\n\nFinally, we have \\(f(n)=f(1)+q(n-1)\\). Then \\(q\\) cannot be -1 since otherwise for \\(n \\geq f(1)+1\\) we have \\(f(n) \\leq 0\\) which is impossible. Hence \\(q=1\\) and \\(f(n)=(f(1)-1)+n\\) for each \\(n \\in \\mathbb{N}\\), and \\(f(1)-1 \\geq 0\\), as desired."}
{"id": "imo-shortlist-2010-n6", "question": "N6. The rows and columns of a \\(2^{n} \\times 2^{n}\\) table are numbered from 0 to \\(2^{n}-1\\). The cells of the table have been colored with the following property being satisfied: for each \\(0 \\leq i, j \\leq 2^{n}-1\\), the \\(j\\) th cell in the \\(i\\) th row and the \\((i+j)\\) th cell in the \\(j\\) th row have the same color. (The indices of the cells in a row are considered modulo \\(2^{n}\\).)\n\nProve that the maximal possible number of colors is \\(2^{n}\\).\n(Iran)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2010, "solution": "Throughout the solution we denote the cells of the table by coordinate pairs; \\((i, j)\\) refers to the \\(j\\) th cell in the \\(i\\) th row.\n\nConsider the directed graph, whose vertices are the cells of the board, and the edges are the arrows \\((i, j) \\rightarrow(j, i+j)\\) for all \\(0 \\leq i, j \\leq 2^{n}-1\\). From each vertex \\((i, j)\\), exactly one edge passes (to \\(\\left(j, i+j \\bmod 2^{n}\\right)\\) ); conversely, to each cell ( \\(j, k\\) ) exactly one edge is directed (from the cell \\(\\left.\\left(k-j \\bmod 2^{n}, j\\right)\\right)\\). Hence, the graph splits into cycles.\n\nNow, in any coloring considered, the vertices of each cycle should have the same color by the problem condition. On the other hand, if each cycle has its own color, the obtained coloring obviously satisfies the problem conditions. Thus, the maximal possible number of colors is the same as the number of cycles, and we have to prove that this number is \\(2^{n}\\).\n\nNext, consider any cycle \\(\\left(i_{1}, j_{1}\\right),\\left(i_{2}, j_{2}\\right), \\ldots\\); we will describe it in other terms. Define a sequence ( \\(a_{0}, a_{1}, \\ldots\\) ) by the relations \\(a_{0}=i_{1}, a_{1}=j_{1}, a_{n+1}=a_{n}+a_{n-1}\\) for all \\(n \\geq 1\\) (we say that such a sequence is a Fibonacci-type sequence). Then an obvious induction shows that \\(i_{k} \\equiv a_{k-1}\\left(\\bmod 2^{n}\\right), j_{k} \\equiv a_{k}\\left(\\bmod 2^{n}\\right)\\). Hence we need to investigate the behavior of Fibonacci-type sequences modulo \\(2^{n}\\).\n\nDenote by \\(F_{0}, F_{1}, \\ldots\\) the Fibonacci numbers defined by \\(F_{0}=0, F_{1}=1\\), and \\(F_{n+2}=\\) \\(F_{n+1}+F_{n}\\) for \\(n \\geq 0\\). We also set \\(F_{-1}=1\\) according to the recurrence relation.\n\nFor every positive integer \\(m\\), denote by \\(\\nu(m)\\) the exponent of 2 in the prime factorization of \\(m\\), i.e. for which \\(2^{\\nu(m)} \\mid m\\) but \\(2^{\\nu(m)+1} \\nmid m\\).\nLemma 1. For every Fibonacci-type sequence \\(a_{0}, a_{1}, a_{2}, \\ldots\\), and every \\(k \\geq 0\\), we have \\(a_{k}=\\) \\(F_{k-1} a_{0}+F_{k} a_{1}\\).\nProof. Apply induction on \\(k\\). The base cases \\(k=0,1\\) are trivial. For the step, from the induction hypothesis we get\n\n\\[\na_{k+1}=a_{k}+a_{k-1}=\\left(F_{k-1} a_{0}+F_{k} a_{1}\\right)+\\left(F_{k-2} a_{0}+F_{k-1} a_{1}\\right)=F_{k} a_{0}+F_{k+1} a_{1}\n\\]\n\nLemma 2. For every \\(m \\geq 3\\),\n(a) we have \\(\\nu\\left(F_{3.2^{m-2}}\\right)=m\\);\n(b) \\(d=3 \\cdot 2^{m-2}\\) is the least positive index for which \\(2^{m} \\mid F_{d}\\);\n(c) \\(F_{3 \\cdot 2^{m-2}+1} \\equiv 1+2^{m-1}\\left(\\bmod 2^{m}\\right)\\).\n\nProof. Apply induction on \\(m\\). In the base case \\(m=3\\) we have \\(\\nu\\left(F_{3 \\cdot 2^{m-2}}\\right)=F_{6}=8\\), so \\(\\nu\\left(F_{3 \\cdot 2^{m-2}}\\right)=\\nu(8)=3\\), the preceding Fibonacci-numbers are not divisible by 8 , and indeed \\(F_{3 \\cdot 2^{m-2}+1}=F_{7}=13 \\equiv 1+4(\\bmod 8)\\).\n\nNow suppose that \\(m>3\\) and let \\(k=3 \\cdot 2^{m-3}\\). By applying Lemma 1 to the Fibonacci-type sequence \\(F_{k}, F_{k+1}, \\ldots\\) we get\n\n\\[\n\\begin{gathered}\nF_{2 k}=F_{k-1} F_{k}+F_{k} F_{k+1}=\\left(F_{k+1}-F_{k}\\right) F_{k}+F_{k+1} F_{k}=2 F_{k+1} F_{k}-F_{k}^{2} \nF_{2 k+1}=F_{k} \\cdot F_{k}+F_{k+1} \\cdot F_{k+1}=F_{k}^{2}+F_{k+1}^{2}\n\n\\]\n\nBy the induction hypothesis, \\(\\nu\\left(F_{k}\\right)=m-1\\), and \\(F_{k+1}\\) is odd. Therefore we get \\(\\nu\\left(F_{k}^{2}\\right)=\\) \\(2(m-1)>(m-1)+1=\\nu\\left(2 F_{k} F_{k+1}\\right)\\), which implies \\(\\nu\\left(F_{2 k}\\right)=m\\), establishing statement (a).\n\nMoreover, since \\(F_{k+1}=1+2^{m-2}+a 2^{m-1}\\) for some integer \\(a\\), we get\n\n\\[\nF_{2 k+1}=F_{k}^{2}+F_{k+1}^{2} \\equiv 0+\\left(1+2^{m-2}+a 2^{m-1}\\right)^{2} \\equiv 1+2^{m-1} \\quad\\left(\\bmod 2^{m}\\right)\n\\]\n\nas desired in statement (c).\nWe are left to prove that \\(2^{m} \\nmid F_{\\ell}\\) for \\(\\ell<2 k\\). Assume the contrary. Since \\(2^{m-1} \\mid F_{\\ell}\\), from the induction hypothesis it follows that \\(\\ell>k\\). But then we have \\(F_{\\ell}=F_{k-1} F_{\\ell-k}+F_{k} F_{\\ell-k+1}\\), where the second summand is divisible by \\(2^{m-1}\\) but the first one is not (since \\(F_{k-1}\\) is odd and \\(\\ell-k<k\\) ). Hence the sum is not divisible even by \\(2^{m-1}\\). A contradiction.\n\nNow, for every pair of integers \\((a, b) \\neq(0,0)\\), let \\(\\mu(a, b)=\\min \\{\\nu(a), \\nu(b)\\}\\). By an obvious induction, for every Fibonacci-type sequence \\(A=\\left(a_{0}, a_{1}, \\ldots\\right)\\) we have \\(\\mu\\left(a_{0}, a_{1}\\right)=\\mu\\left(a_{1}, a_{2}\\right)=\\ldots\\); denote this common value by \\(\\mu(A)\\). Also denote by \\(p_{n}(A)\\) the period of this sequence modulo \\(2^{n}\\), that is, the least \\(p>0\\) such that \\(a_{k+p} \\equiv a_{k}\\left(\\bmod 2^{n}\\right)\\) for all \\(k \\geq 0\\).\nLemma 3. Let \\(A=\\left(a_{0}, a_{1}, \\ldots\\right)\\) be a Fibonacci-type sequence such that \\(\\mu(A)=k<n\\). Then \\(p_{n}(A)=3 \\cdot 2^{n-1-k}\\).\nProof. First, we note that the sequence ( \\(a_{0}, a_{1}, \\ldots\\) ) has period \\(p\\) modulo \\(2^{n}\\) if and only if the sequence \\(\\left(a_{0} / 2^{k}, a_{1} / 2^{k}, \\ldots\\right)\\) has period \\(p\\) modulo \\(2^{n-k}\\). Hence, passing to this sequence we can assume that \\(k=0\\).\n\nWe prove the statement by induction on \\(n\\). It is easy to see that for \\(n=1,2\\) the claim is true; actually, each Fibonacci-type sequence \\(A\\) with \\(\\mu(A)=0\\) behaves as \\(0,1,1,0,1,1, \\ldots\\) modulo 2 , and as \\(0,1,1,2,3,1,0,1,1,2,3,1, \\ldots\\) modulo 4 (all pairs of residues from which at least one is odd appear as a pair of consecutive terms in this sequence).\n\nNow suppose that \\(n \\geq 3\\) and consider an arbitrary Fibonacci-type sequence \\(A=\\left(a_{0}, a_{1}, \\ldots\\right)\\) with \\(\\mu(A)=0\\). Obviously we should have \\(p_{n-1}(A) \\mid p_{n}(A)\\), or, using the induction hypothesis, \\(s=3 \\cdot 2^{n-2} \\mid p_{n}(A)\\). Next, we may suppose that \\(a_{0}\\) is even; hence \\(a_{1}\\) is odd, and \\(a_{0}=2 b_{0}\\), \\(a_{1}=2 b_{1}+1\\) for some integers \\(b_{0}, b_{1}\\).\n\nConsider the Fibonacci-type sequence \\(B=\\left(b_{0}, b_{1}, \\ldots\\right)\\) starting with ( \\(b_{0}, b_{1}\\) ). Since \\(a_{0}=\\) \\(2 b_{0}+F_{0}, a_{1}=2 b_{1}+F_{1}\\), by an easy induction we get \\(a_{k}=2 b_{k}+F_{k}\\) for all \\(k \\geq 0\\). By the induction hypothesis, we have \\(p_{n-1}(B) \\mid s\\), hence the sequence \\(\\left(2 b_{0}, 2 b_{1}, \\ldots\\right)\\) is \\(s\\)-periodic modulo \\(2^{n}\\). On the other hand, by Lemma 2 we have \\(F_{s+1} \\equiv 1+2^{n-1}\\left(\\bmod 2^{n}\\right), F_{2 s} \\equiv 0\\) \\(\\left(\\bmod 2^{n}\\right), F_{2 s+1} \\equiv 1\\left(\\bmod 2^{n}\\right)\\), hence\n\n\\[\n\\begin{gathered}\na_{s+1}=2 b_{s+1}+F_{s+1} \\equiv 2 b_{1}+1+2^{n-1} \\not \\equiv 2 b_{1}+1=a_{1} \\quad\\left(\\bmod 2^{n}\\right) \na_{2 s}=2 b_{2 s}+F_{2 s} \\equiv 2 b_{0}+0=a_{0} \\quad\\left(\\bmod 2^{n}\\right) \na_{2 s+1}=2 b_{2 s+1}+F_{2 s+1} \\equiv 2 b_{1}+1=a_{1} \\quad\\left(\\bmod 2^{n}\\right)\n\n\\]\n\nThe first line means that \\(A\\) is not \\(s\\)-periodic, while the other two provide that \\(a_{2 s} \\equiv a_{0}\\), \\(a_{2 s+1} \\equiv a_{1}\\) and hence \\(a_{2 s+t} \\equiv a_{t}\\) for all \\(t \\geq 0\\). Hence \\(s\\left|p_{n}(A)\\right| 2 s\\) and \\(p_{n}(A) \\neq s\\), which means that \\(p_{n}(A)=2 s\\), as desired.\n\nFinally, Lemma 3 provides a straightforward method of counting the number of cycles. Actually, take any number \\(0 \\leq k \\leq n-1\\) and consider all the cells \\((i, j)\\) with \\(\\mu(i, j)=k\\). The total number of such cells is \\(2^{2(n-k)}-2^{2(n-k-1)}=3 \\cdot 2^{2 n-2 k-2}\\). On the other hand, they are split into cycles, and by Lemma 3 the length of each cycle is \\(3 \\cdot 2^{n-1-k}\\). Hence the number of cycles consisting of these cells is exactly \\(\\frac{3 \\cdot 2^{2 n-2 k-2}}{3 \\cdot 2^{n-1-k}}=2^{n-k-1}\\). Finally, there is only one cell \\((0,0)\\) which is not mentioned in the previous computation, and it forms a separate cycle. So the total number of cycles is\n\n\\[\n1+\\sum_{k=0}^{n-1} 2^{n-1-k}=1+\\left(1+2+4+\\cdots+2^{n-1}\\right)=2^{n}\n\\]\n\nComment. We outline a different proof for the essential part of Lemma 3. That is, we assume that \\(k=0\\) and show that in this case the period of \\(\\left(a_{i}\\right)\\) modulo \\(2^{n}\\) coincides with the period of the Fibonacci numbers modulo \\(2^{n}\\); then the proof can be finished by the arguments from Lemma 2..\n\nNote that \\(p\\) is a (not necessarily minimal) period of the sequence ( \\(a_{i}\\) ) modulo \\(2^{n}\\) if and only if we have \\(a_{0} \\equiv a_{p}\\left(\\bmod 2^{n}\\right), a_{1} \\equiv a_{p+1}\\left(\\bmod 2^{n}\\right)\\), that is,\n\n\\[\n\\begin{aligned}\n& a_{0} \\equiv a_{p} \\equiv F_{p-1} a_{0}+F_{p} a_{1}=F_{p}\\left(a_{1}-a_{0}\\right)+F_{p+1} a_{0} \\quad\\left(\\bmod 2^{n}\\right) \n& a_{1} \\equiv a_{p+1}=F_{p} a_{0}+F_{p+1} a_{1} \\quad\\left(\\bmod 2^{n}\\right)\n\n\\]\n\nNow, If \\(p\\) is a period of \\(\\left(F_{i}\\right)\\) then we have \\(F_{p} \\equiv F_{0}=0\\left(\\bmod 2^{n}\\right)\\) and \\(F_{p+1} \\equiv F_{1}=1\\left(\\bmod 2^{n}\\right)\\), which by (1) implies that \\(p\\) is a period of \\(\\left(a_{i}\\right)\\) as well.\n\nConversely, suppose that \\(p\\) is a period of \\(\\left(a_{i}\\right)\\). Combining the relations of (1) we get\n\n\\[\n\\begin{aligned}\n0=a_{1} \\cdot a_{0}-a_{0} \\cdot a_{1} & \\equiv a_{1}\\left(F_{p}\\left(a_{1}-a_{0}\\right)+F_{p+1} a_{0}\\right)-a_{0}\\left(F_{p} a_{0}+F_{p+1} a_{1}\\right) \n& =F_{p}\\left(a_{1}^{2}-a_{1} a_{0}-a_{0}^{2}\\right) \\quad\\left(\\bmod 2^{n}\\right) \na_{1}^{2}-a_{1} a_{0}-a_{0}^{2}=\\left(a_{1}-a_{0}\\right) a_{1}-a_{0} \\cdot a_{0} & \\equiv\\left(a_{1}-a_{0}\\right)\\left(F_{p} a_{0}+F_{p+1} a_{1}\\right)-a_{0}\\left(F_{p}\\left(a_{1}-a_{0}\\right)+F_{p+1} a_{0}\\right) \n& =F_{p+1}\\left(a_{1}^{2}-a_{1} a_{0}-a_{0}^{2}\\right) \\quad\\left(\\bmod 2^{n}\\right)\n\n\\]\n\nSince at least one of the numbers \\(a_{0}, a_{1}\\) is odd, the number \\(a_{1}^{2}-a_{1} a_{0}-a_{0}^{2}\\) is odd as well. Therefore the previous relations are equivalent with \\(F_{p} \\equiv 0\\left(\\bmod 2^{n}\\right)\\) and \\(F_{p+1} \\equiv 1\\left(\\bmod 2^{n}\\right)\\), which means exactly that \\(p\\) is a period of ( \\(F_{0}, F_{1}, \\ldots\\) ) modulo \\(2^{n}\\).\n\nSo, the sets of periods of \\(\\left(a_{i}\\right)\\) and \\(\\left(F_{i}\\right)\\) coincide, and hence the minimal periods coincide as well."}
{"id": "imo-shortlist-2012-a1", "question": "A1. Find all the functions \\(f: \\mathbb{Z} \\rightarrow \\mathbb{Z}\\) such that\n\n\\[\nf(a)^{2}+f(b)^{2}+f(c)^{2}=2 f(a) f(b)+2 f(b) f(c)+2 f(c) f(a)\n\\]\n\nfor all integers \\(a, b, c\\) satisfying \\(a+b+c=0\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-a2", "question": "A2. Let \\(\\mathbb{Z}\\) and \\(\\mathbb{Q}\\) be the sets of integers and rationals respectively.\na) Does there exist a partition of \\(\\mathbb{Z}\\) into three non-empty subsets \\(A, B, C\\) such that the sets \\(A+B, B+C, C+A\\) are disjoint?\nb) Does there exist a partition of \\(\\mathbb{Q}\\) into three non-empty subsets \\(A, B, C\\) such that the sets \\(A+B, B+C, C+A\\) are disjoint?\n\nHere \\(X+Y\\) denotes the set \\(\\{x+y \\mid x \\in X, y \\in Y\\}\\), for \\(X, Y \\subseteq \\mathbb{Z}\\) and \\(X, Y \\subseteq \\mathbb{Q}\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-a3", "question": "A3. Let \\(a_{2}, \\ldots, a_{n}\\) be \\(n-1\\) positive real numbers, where \\(n \\geq 3\\), such that \\(a_{2} a_{3} \\cdots a_{n}=1\\). Prove that\n\n\\[\n\\left(1+a_{2}\\right)^{2}\\left(1+a_{3}\\right)^{3} \\cdots\\left(1+a_{n}\\right)^{n}>n^{n}\n\\]", "category": "Algebra", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-a4", "question": "A4. Let \\(f\\) and \\(g\\) be two nonzero polynomials with integer coefficients and \\(\\operatorname{deg} f>\\operatorname{deg} g\\). Suppose that for infinitely many primes \\(p\\) the polynomial \\(p f+g\\) has a rational root. Prove that \\(f\\) has a rational root.", "category": "Algebra", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-a5", "question": "A5. Find all functions \\(f: \\mathbb{R} \\rightarrow \\mathbb{R}\\) that satisfy the conditions\n\n\\[\nf(1+x y)-f(x+y)=f(x) f(y) \\quad \\text { for all } x, y \\in \\mathbb{R}\n\\]\n\nand \\(f(-1) \\neq 0\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-a6", "question": "A6. Let \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}\\) be a function, and let \\(f^{m}\\) be \\(f\\) applied \\(m\\) times. Suppose that for every \\(n \\in \\mathbb{N}\\) there exists a \\(k \\in \\mathbb{N}\\) such that \\(f^{2 k}(n)=n+k\\), and let \\(k_{n}\\) be the smallest such \\(k\\). Prove that the sequence \\(k_{1}, k_{2}, \\ldots\\) is unbounded.", "category": "Algebra", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-a7", "question": "A7. We say that a function \\(f: \\mathbb{R}^{k} \\rightarrow \\mathbb{R}\\) is a metapolynomial if, for some positive integers \\(m\\) and \\(n\\), it can be represented in the form\n\n\\[\nf\\left(x_{1}, \\ldots, x_{k}\\right)=\\max _{i=1, \\ldots, m} \\min _{j=1, \\ldots, n} P_{i, j}\\left(x_{1}, \\ldots, x_{k}\\right)\n\\]\n\nwhere \\(P_{i, j}\\) are multivariate polynomials. Prove that the product of two metapolynomials is also a metapolynomial.", "category": "Algebra", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-c1", "question": "C1. Several positive integers are written in a row. Iteratively, Alice chooses two adjacent numbers \\(x\\) and \\(y\\) such that \\(x>y\\) and \\(x\\) is to the left of \\(y\\), and replaces the pair \\((x, y)\\) by either \\((y+1, x)\\) or \\((x-1, x)\\). Prove that she can perform only finitely many such iterations.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-c2", "question": "C2. Let \\(n \\geq 1\\) be an integer. What is the maximum number of disjoint pairs of elements of the set \\(\\{1,2, \\ldots, n\\}\\) such that the sums of the different pairs are different integers not exceeding \\(n\\) ?", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-c3", "question": "C3. In a \\(999 \\times 999\\) square table some cells are white and the remaining ones are red. Let \\(T\\) be the number of triples ( \\(C_{1}, C_{2}, C_{3}\\) ) of cells, the first two in the same row and the last two in the same column, with \\(C_{1}\\) and \\(C_{3}\\) white and \\(C_{2}\\) red. Find the maximum value \\(T\\) can attain.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-c4", "question": "C4. Players \\(A\\) and \\(B\\) play a game with \\(N \\geq 2012\\) coins and 2012 boxes arranged around a circle. Initially \\(A\\) distributes the coins among the boxes so that there is at least 1 coin in each box. Then the two of them make moves in the order \\(B, A, B, A, \\ldots\\) by the following rules:\n\n\\begin{itemize}\n  \\item On every move of his \\(B\\) passes 1 coin from every box to an adjacent box.\n  \\item On every move of hers \\(A\\) chooses several coins that were not involved in \\(B\\) 's previous move and are in different boxes. She passes every chosen coin to an adjacent box.\n\n\nPlayer \\(A\\) 's goal is to ensure at least 1 coin in each box after every move of hers, regardless of how \\(B\\) plays and how many moves are made. Find the least \\(N\\) that enables her to succeed.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-c5", "question": "C5. The columns and the rows of a \\(3 n \\times 3 n\\) square board are numbered \\(1,2, \\ldots, 3 n\\). Every square ( \\(x, y\\) ) with \\(1 \\leq x, y \\leq 3 n\\) is colored asparagus, byzantium or citrine according as the modulo 3 remainder of \\(x+y\\) is 0,1 or 2 respectively. One token colored asparagus, byzantium or citrine is placed on each square, so that there are \\(3 n^{2}\\) tokens of each color.\n\nSuppose that one can permute the tokens so that each token is moved to a distance of at most \\(d\\) from its original position, each asparagus token replaces a byzantium token, each byzantium token replaces a citrine token, and each citrine token replaces an asparagus token. Prove that it is possible to permute the tokens so that each token is moved to a distance of at most \\(d+2\\) from its original position, and each square contains a token with the same color as the square.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-c6", "question": "C6. Let \\(k\\) and \\(n\\) be fixed positive integers. In the liar's guessing game, Amy chooses integers \\(x\\) and \\(N\\) with \\(1 \\leq x \\leq N\\). She tells Ben what \\(N\\) is, but not what \\(x\\) is. Ben may then repeatedly ask Amy whether \\(x \\in S\\) for arbitrary sets \\(S\\) of integers. Amy will always answer with yes or no, but she might lie. The only restriction is that she can lie at most \\(k\\) times in a row. After he has asked as many questions as he wants, Ben must specify a set of at most \\(n\\) positive integers. If \\(x\\) is in this set he wins; otherwise, he loses. Prove that:\na) If \\(n \\geq 2^{k}\\) then Ben can always win.\nb) For sufficiently large \\(k\\) there exist \\(n \\geq 1.99^{k}\\) such that Ben cannot guarantee a win.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-c7", "question": "C7. There are given \\(2^{500}\\) points on a circle labeled \\(1,2, \\ldots, 2^{500}\\) in some order. Prove that one can choose 100 pairwise disjoint chords joining some of these points so that the 100 sums of the pairs of numbers at the endpoints of the chosen chords are equal.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-g1", "question": "G1. In the triangle \\(A B C\\) the point \\(J\\) is the center of the excircle opposite to \\(A\\). This excircle is tangent to the side \\(B C\\) at \\(M\\), and to the lines \\(A B\\) and \\(A C\\) at \\(K\\) and \\(L\\) respectively. The lines \\(L M\\) and \\(B J\\) meet at \\(F\\), and the lines \\(K M\\) and \\(C J\\) meet at \\(G\\). Let \\(S\\) be the point of intersection of the lines \\(A F\\) and \\(B C\\), and let \\(T\\) be the point of intersection of the lines \\(A G\\) and \\(B C\\). Prove that \\(M\\) is the midpoint of \\(S T\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-g2", "question": "G2. Let \\(A B C D\\) be a cyclic quadrilateral whose diagonals \\(A C\\) and \\(B D\\) meet at \\(E\\). The extensions of the sides \\(A D\\) and \\(B C\\) beyond \\(A\\) and \\(B\\) meet at \\(F\\). Let \\(G\\) be the point such that \\(E C G D\\) is a parallelogram, and let \\(H\\) be the image of \\(E\\) under reflection in \\(A D\\). Prove that \\(D, H, F, G\\) are concyclic.", "category": "Geometry", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-g3", "question": "G3. In an acute triangle \\(A B C\\) the points \\(D, E\\) and \\(F\\) are the feet of the altitudes through \\(A\\), \\(B\\) and \\(C\\) respectively. The incenters of the triangles \\(A E F\\) and \\(B D F\\) are \\(I_{1}\\) and \\(I_{2}\\) respectively; the circumcenters of the triangles \\(A C I_{1}\\) and \\(B C I_{2}\\) are \\(O_{1}\\) and \\(O_{2}\\) respectively. Prove that \\(I_{1} I_{2}\\) and \\(O_{1} O_{2}\\) are parallel.", "category": "Geometry", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-g4", "question": "G4. Let \\(A B C\\) be a triangle with \\(A B \\neq A C\\) and circumcenter \\(O\\). The bisector of \\(\\angle B A C\\) intersects \\(B C\\) at \\(D\\). Let \\(E\\) be the reflection of \\(D\\) with respect to the midpoint of \\(B C\\). The lines through \\(D\\) and \\(E\\) perpendicular to \\(B C\\) intersect the lines \\(A O\\) and \\(A D\\) at \\(X\\) and \\(Y\\) respectively. Prove that the quadrilateral \\(B X C Y\\) is cyclic.", "category": "Geometry", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-g5", "question": "G5. Let \\(A B C\\) be a triangle with \\(\\angle B C A=90^{\\circ}\\), and let \\(C_{0}\\) be the foot of the altitude from \\(C\\). Choose a point \\(X\\) in the interior of the segment \\(C C_{0}\\), and let \\(K, L\\) be the points on the segments \\(A X, B X\\) for which \\(B K=B C\\) and \\(A L=A C\\) respectively. Denote by \\(M\\) the intersection of \\(A L\\) and \\(B K\\). Show that \\(M K=M L\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-g6", "question": "G6. Let \\(A B C\\) be a triangle with circumcenter \\(O\\) and incenter \\(I\\). The points \\(D, E\\) and \\(F\\) on the sides \\(B C, C A\\) and \\(A B\\) respectively are such that \\(B D+B F=C A\\) and \\(C D+C E=A B\\). The circumcircles of the triangles \\(B F D\\) and \\(C D E\\) intersect at \\(P \\neq D\\). Prove that \\(O P=O I\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-g7", "question": "G7. Let \\(A B C D\\) be a convex quadrilateral with non-parallel sides \\(B C\\) and \\(A D\\). Assume that there is a point \\(E\\) on the side \\(B C\\) such that the quadrilaterals \\(A B E D\\) and \\(A E C D\\) are circumscribed. Prove that there is a point \\(F\\) on the side \\(A D\\) such that the quadrilaterals \\(A B C F\\) and \\(B C D F\\) are circumscribed if and only if \\(A B\\) is parallel to \\(C D\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-g8", "question": "G8. Let \\(A B C\\) be a triangle with circumcircle \\(\\omega\\) and \\(\\ell\\) a line without common points with \\(\\omega\\). Denote by \\(P\\) the foot of the perpendicular from the center of \\(\\omega\\) to \\(\\ell\\). The side-lines \\(B C, C A, A B\\) intersect \\(\\ell\\) at the points \\(X, Y, Z\\) different from \\(P\\). Prove that the circumcircles of the triangles \\(A X P, B Y P\\) and \\(C Z P\\) have a common point different from \\(P\\) or are mutually tangent at \\(P\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-n1", "question": "N1. Call admissible a set \\(A\\) of integers that has the following property:\nIf \\(x, y \\in A\\) (possibly \\(x=y\\) ) then \\(x^{2}+k x y+y^{2} \\in A\\) for every integer \\(k\\).\nDetermine all pairs \\(m, n\\) of nonzero integers such that the only admissible set containing both \\(m\\) and \\(n\\) is the set of all integers.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-n2", "question": "N2. Find all triples \\((x, y, z)\\) of positive integers such that \\(x \\leq y \\leq z\\) and\n\n\\[\nx^{3}\\left(y^{3}+z^{3}\\right)=2012(x y z+2) .\n\\]", "category": "Number Theory", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-n3", "question": "N3. Determine all integers \\(m \\geq 2\\) such that every \\(n\\) with \\(\\frac{m}{3} \\leq n \\leq \\frac{m}{2}\\) divides the binomial coefficient \\(\\binom{n}{m-2 n}\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-n4", "question": "N4. An integer \\(a\\) is called friendly if the equation \\(\\left(m^{2}+n\\right)\\left(n^{2}+m\\right)=a(m-n)^{3}\\) has a", "category": "Number Theory", "source": "IMO Shortlist", "year": 2012, "solution": "over the positive integers.\na) Prove that there are at least 500 friendly integers in the set \\(\\{1,2, \\ldots, 2012\\}\\).\nb) Decide whether \\(a=2\\) is friendly."}
{"id": "imo-shortlist-2012-n5", "question": "N5. For a nonnegative integer \\(n\\) define \\(\\operatorname{rad}(n)=1\\) if \\(n=0\\) or \\(n=1\\), and \\(\\operatorname{rad}(n)=p_{1} p_{2} \\cdots p_{k}\\) where \\(p_{1}<p_{2}<\\cdots<p_{k}\\) are all prime factors of \\(n\\). Find all polynomials \\(f(x)\\) with nonnegative integer coefficients such that \\(\\operatorname{rad}(f(n))\\) divides \\(\\operatorname{rad}\\left(f\\left(n^{\\operatorname{rad}(n)}\\right)\\right)\\) for every nonnegative integer \\(n\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-n6", "question": "N6. Let \\(x\\) and \\(y\\) be positive integers. If \\(x^{2^{n}}-1\\) is divisible by \\(2^{n} y+1\\) for every positive integer \\(n\\), prove that \\(x=1\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-n7", "question": "N7. Find all \\(n \\in \\mathbb{N}\\) for which there exist nonnegative integers \\(a_{1}, a_{2}, \\ldots, a_{n}\\) such that\n\n\\[\n\\frac{1}{2^{a_{1}}}+\\frac{1}{2^{a_{2}}}+\\cdots+\\frac{1}{2^{a_{n}}}=\\frac{1}{3^{a_{1}}}+\\frac{2}{3^{a_{2}}}+\\cdots+\\frac{n}{3^{a_{n}}}=1 .\n\\]", "category": "Number Theory", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-n8", "question": "N8. Prove that for every prime \\(p>100\\) and every integer \\(r\\) there exist two integers \\(a\\) and \\(b\\) such that \\(p\\) divides \\(a^{2}+b^{5}-r\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2012, "solution": ""}
{"id": "imo-shortlist-2012-a1", "question": "A1. Find all the functions \\(f: \\mathbb{Z} \\rightarrow \\mathbb{Z}\\) such that\n\n\\[\nf(a)^{2}+f(b)^{2}+f(c)^{2}=2 f(a) f(b)+2 f(b) f(c)+2 f(c) f(a)\n\\]\n\nfor all integers \\(a, b, c\\) satisfying \\(a+b+c=0\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2012, "solution": "The substitution \\(a=b=c=0\\) gives \\(3 f(0)^{2}=6 f(0)^{2}\\), hence\n\n\\[\nf(0)=0\n\\]\n\nThe substitution \\(b=-a\\) and \\(c=0\\) gives \\(\\left((f(a)-f(-a))^{2}=0\\right.\\). Hence \\(f\\) is an even function:\n\n\\[\nf(a)=f(-a) \\quad \\text { for all } a \\in \\mathbb{Z} .\n\\]\n\nNow set \\(b=a\\) and \\(c=-2 a\\) to obtain \\(2 f(a)^{2}+f(2 a)^{2}=2 f(a)^{2}+4 f(a) f(2 a)\\). Hence\n\n\\[\nf(2 a)=0 \\text { or } f(2 a)=4 f(a) \\quad \\text { for all } a \\in \\mathbb{Z}\n\\]\n\nIf \\(f(r)=0\\) for some \\(r \\geq 1\\) then the substitution \\(b=r\\) and \\(c=-a-r\\) gives \\((f(a+r)-f(a))^{2}=0\\). So \\(f\\) is periodic with period \\(r\\), i. e.\n\n\\[\nf(a+r)=f(a) \\quad \\text { for all } a \\in \\mathbb{Z}\n\\]\n\nIn particular, if \\(f(1)=0\\) then \\(f\\) is constant, thus \\(f(a)=0\\) for all \\(a \\in \\mathbb{Z}\\). This function clearly satisfies the functional equation. For the rest of the analysis, we assume \\(f(1)=k \\neq 0\\).\n\nBy (3) we have \\(f(2)=0\\) or \\(f(2)=4 k\\). If \\(f(2)=0\\) then \\(f\\) is periodic of period 2 , thus \\(f(\\) even \\()=0\\) and \\(f\\) (odd) \\(=k\\). This function is a solution for every \\(k\\). We postpone the verification; for the sequel assume \\(f(2)=4 k \\neq 0\\).\n\nBy (3) again, we have \\(f(4)=0\\) or \\(f(4)=16 k\\). In the first case \\(f\\) is periodic of period 4, and \\(f(3)=f(-1)=f(1)=k\\), so we have \\(f(4 n)=0, f(4 n+1)=f(4 n+3)=k\\), and \\(f(4 n+2)=4 k\\) for all \\(n \\in \\mathbb{Z}\\). This function is a solution too, which we justify later. For the rest of the analysis, we assume \\(f(4)=16 k \\neq 0\\).\n\nWe show now that \\(f(3)=9 k\\). In order to do so, we need two substitutions:\n\n\\[\n\\begin{aligned}\n& a=1, b=2, c=-3 \\Longrightarrow f(3)^{2}-10 k f(3)+9 k^{2}=0 \n& a=1, b=3, c=-4 \\Longrightarrow f(3)^{2}-34 k f(3)+225 k^{2}=0 \\Longrightarrow f(3) \\in\\{k, 9 k\\} \n&a=13) \\in\\{9 k, 25 k\\}\n\n\\]\n\nTherefore \\(f(3)=9 k\\), as claimed. Now we prove inductively that the only remaining function is \\(f(x)=k x^{2}, x \\in \\mathbb{Z}\\). We proved this for \\(x=0,1,2,3,4\\). Assume that \\(n \\geq 4\\) and that \\(f(x)=k x^{2}\\) holds for all integers \\(x \\in[0, n]\\). Then the substitutions \\(a=n, b=1, c=-n-1\\) and \\(a=n-1\\), \\(b=2, c=-n-1\\) lead respectively to\n\n\\[\nf(n+1) \\in\\left\\{k(n+1)^{2}, k(n-1)^{2}\\right\\} \\quad \\text { and } \\quad f(n+1) \\in\\left\\{k(n+1)^{2}, k(n-3)^{2}\\right\\}\n\\]\n\nSince \\(k(n-1)^{2} \\neq k(n-3)^{2}\\) for \\(n \\neq 2\\), the only possibility is \\(f(n+1)=k(n+1)^{2}\\). This completes the induction, so \\(f(x)=k x^{2}\\) for all \\(x \\geq 0\\). The same expression is valid for negative values of \\(x\\) since \\(f\\) is even. To verify that \\(f(x)=k x^{2}\\) is actually a solution, we need to check the identity \\(a^{4}+b^{4}+(a+b)^{4}=2 a^{2} b^{2}+2 a^{2}(a+b)^{2}+2 b^{2}(a+b)^{2}\\), which follows directly by expanding both sides.\n\nTherefore the only possible solutions of the functional equation are the constant function \\(f_{1}(x)=0\\) and the following functions:\n\n\\[\nf_{2}(x)=k x^{2} \\quad f_{3}(x)=\\left\\{\\begin{array}{cc}\n0 & x \\text { even } \nk & x \\text { odd }\n \\quad f_{4}(x)=\\left\\{\\begin{array}{ccc}\n0 & x \\equiv 0 & (\\bmod 4) \nk & x \\equiv 1 & (\\bmod 2) \n4 k & x \\equiv 2 & (\\bmod 4)\n\\right.\\right.\n\\]\n\nfor any non-zero integer \\(k\\). The verification that they are indeed solutions was done for the first two. For \\(f_{3}\\) note that if \\(a+b+c=0\\) then either \\(a, b, c\\) are all even, in which case \\(f(a)=f(b)=f(c)=0\\), or one of them is even and the other two are odd, so both sides of the equation equal \\(2 k^{2}\\). For \\(f_{4}\\) we use similar parity considerations and the symmetry of the equation, which reduces the verification to the triples \\((0, k, k),(4 k, k, k),(0,0,0),(0,4 k, 4 k)\\). They all satisfy the equation.\n\nComment. We used several times the same fact: For any \\(a, b \\in \\mathbb{Z}\\) the functional equation is a quadratic equation in \\(f(a+b)\\) whose coefficients depend on \\(f(a)\\) and \\(f(b)\\) :\n\n\\[\nf(a+b)^{2}-2(f(a)+f(b)) f(a+b)+(f(a)-f(b))^{2}=0\n\\]\n\nIts discriminant is \\(16 f(a) f(b)\\). Since this value has to be non-negative for any \\(a, b \\in \\mathbb{Z}\\), we conclude that either \\(f\\) or \\(-f\\) is always non-negative. Also, if \\(f\\) is a solution of the functional equation, then \\(-f\\) is also a solution. Therefore we can assume \\(f(x) \\geq 0\\) for all \\(x \\in \\mathbb{Z}\\). Now, the two solutions of the quadratic equation are\n\n\\[\nf(a+b) \\in\\left\\{(\\sqrt{f(a)}+\\sqrt{f(b)})^{2},(\\sqrt{f(a)}-\\sqrt{f(b)})^{2}\\right\\} \\quad \\text { for all } a, b \\in \\mathbb{Z}\n\\]\n\nThe computation of \\(f(3)\\) from \\(f(1), f(2)\\) and \\(f(4)\\) that we did above follows immediately by setting \\((a, b)=(1,2)\\) and \\((a, b)=(1,-4)\\). The inductive step, where \\(f(n+1)\\) is derived from \\(f(n), f(n-1)\\), \\(f(2)\\) and \\(f(1)\\), follows immediately using \\((a, b)=(n, 1)\\) and \\((a, b)=(n-1,2)\\)."}
{"id": "imo-shortlist-2012-a2", "question": "A2. Let \\(\\mathbb{Z}\\) and \\(\\mathbb{Q}\\) be the sets of integers and rationals respectively.\na) Does there exist a partition of \\(\\mathbb{Z}\\) into three non-empty subsets \\(A, B, C\\) such that the sets \\(A+B, B+C, C+A\\) are disjoint?\nb) Does there exist a partition of \\(\\mathbb{Q}\\) into three non-empty subsets \\(A, B, C\\) such that the sets \\(A+B, B+C, C+A\\) are disjoint?\n\nHere \\(X+Y\\) denotes the set \\(\\{x+y \\mid x \\in X, y \\in Y\\}\\), for \\(X, Y \\subseteq \\mathbb{Z}\\) and \\(X, Y \\subseteq \\mathbb{Q}\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2012, "solution": "a) The residue classes modulo 3 yield such a partition:\n\n\\[\nA=\\{3 k \\mid k \\in \\mathbb{Z}\\}, \\quad B=\\{3 k+1 \\mid k \\in \\mathbb{Z}\\}, \\quad C=\\{3 k+2 \\mid k \\in \\mathbb{Z}\\} .\n\\]\n\nb) The answer is no. Suppose that \\(\\mathbb{Q}\\) can be partitioned into non-empty subsets \\(A, B, C\\) as stated. Note that for all \\(a \\in A, b \\in B, c \\in C\\) one has\n\n\\[\na+b-c \\in C, \\quad b+c-a \\in A, \\quad c+a-b \\in B .\n\\]\n\nIndeed \\(a+b-c \\notin A\\) as \\((A+B) \\cap(A+C)=\\emptyset\\), and similarly \\(a+b-c \\notin B\\), hence \\(a+b-c \\in C\\). The other two relations follow by symmetry. Hence \\(A+B \\subset C+C, B+C \\subset A+A, C+A \\subset B+B\\).\n\nThe opposite inclusions also hold. Let \\(a, a^{\\prime} \\in A\\) and \\(b \\in B, c \\in C\\) be arbitrary. By (1) \\(a^{\\prime}+c-b \\in B\\), and since \\(a \\in A, c \\in C\\), we use (1) again to obtain\n\n\\[\na+a^{\\prime}-b=a+\\left(a^{\\prime}+c-b\\right)-c \\in C\n\\]\n\nSo \\(A+A \\subset B+C\\) and likewise \\(B+B \\subset C+A, C+C \\subset A+B\\). In summary\n\n\\[\nB+C=A+A, \\quad C+A=B+B, \\quad A+B=C+C .\n\\]\n\nFurthermore suppose that \\(0 \\in A\\) without loss of generality. Then \\(B=\\{0\\}+B \\subset A+B\\) and \\(C=\\{0\\}+C \\subset A+C\\). So, since \\(B+C\\) is disjoint with \\(A+B\\) and \\(A+C\\), it is also disjoint with \\(B\\) and \\(C\\). Hence \\(B+C\\) is contained in \\(\\mathbb{Z} \\backslash(B \\cup C)=A\\). Because \\(B+C=A+A\\), we obtain \\(A+A \\subset A\\). On the other hand \\(A=\\{0\\}+A \\subset A+A\\), implying \\(A=A+A=B+C\\).\n\nTherefore \\(A+B+C=A+A+A=A\\), and now \\(B+B=C+A\\) and \\(C+C=A+B\\) yield \\(B+B+B=A+B+C=A, C+C+C=A+B+C=A\\). In particular if \\(r \\in \\mathbb{Q}=A \\cup B \\cup C\\) is arbitrary then \\(3 r \\in A\\).\n\nHowever such a conclusion is impossible. Take any \\(b \\in B(B \\neq \\emptyset)\\) and let \\(r=b / 3 \\in \\mathbb{Q}\\). Then \\(b=3 r \\in A\\) which is a contradiction.\n\nSolution 2. We prove that the example for \\(\\mathbb{Z}\\) from the first solution is unique, and then use this fact to solve part b).\n\nLet \\(\\mathbb{Z}=A \\cup B \\cup C\\) be a partition of \\(\\mathbb{Z}\\) with \\(A, B, C \\neq \\emptyset\\) and \\(A+B, B+C, C+A\\) disjoint. We need the relations (1) which clearly hold for \\(\\mathbb{Z}\\). Fix two consecutive integers from different sets, say \\(b \\in B\\) and \\(c=b+1 \\in C\\). For every \\(a \\in A\\) we have, in view of (1), \\(a-1=a+b-c \\in C\\) and \\(a+1=a+c-b \\in B\\). So every \\(a \\in A\\) is preceded by a number from \\(C\\) and followed by a number from \\(B\\).\n\nIn particular there are pairs of the form \\(c, c+1\\) with \\(c \\in C, c+1 \\in A\\). For such a pair and any \\(b \\in B\\) analogous reasoning shows that each \\(b \\in B\\) is preceded by a number from \\(A\\) and followed by a number from \\(C\\). There are also pairs \\(b, b-1\\) with \\(b \\in B, b-1 \\in A\\). We use them in a similar way to prove that each \\(c \\in C\\) is preceded by a number from \\(B\\) and followed by a number from \\(A\\).\n\nBy putting the observations together we infer that \\(A, B, C\\) are the three congruence classes modulo 3. Observe that all multiples of 3 are in the set of the partition that contains 0 .\n\nNow we turn to part b). Suppose that there is a partition of \\(\\mathbb{Q}\\) with the given properties. Choose three rationals \\(r_{i}=p_{i} / q_{i}\\) from the three sets \\(A, B, C, i=1,2,3\\), and set \\(N=3 q_{1} q_{2} q_{3}\\).\n\nLet \\(S \\subset \\mathbb{Q}\\) be the set of fractions with denominators \\(N\\) (irreducible or not). It is obtained through multiplication of every integer by the constant \\(1 / N\\), hence closed under sums and differences. Moreover, if we identify each \\(k \\in \\mathbb{Z}\\) with \\(k / N \\in S\\) then \\(S\\) is essentially the set \\(\\mathbb{Z}\\) with respect to addition. The numbers \\(r_{i}\\) belong to \\(S\\) because\n\n\\[\nr_{1}=\\frac{3 p_{1} q_{2} q_{3}}{N}, \\quad r_{2}=\\frac{3 p_{2} q_{3} q_{1}}{N}, \\quad r_{3}=\\frac{3 p_{3} q_{1} q_{2}}{N}\n\\]\n\nThe partition \\(\\mathbb{Q}=A \\cup B \\cup C\\) of \\(\\mathbb{Q}\\) induces a partition \\(S=A^{\\prime} \\cup B^{\\prime} \\cup C^{\\prime}\\) of \\(S\\), with \\(A^{\\prime}=A \\cap S\\), \\(B^{\\prime}=B \\cap S, C^{\\prime}=C \\cap S\\). Clearly \\(A^{\\prime}+B^{\\prime}, B^{\\prime}+C^{\\prime}, C^{\\prime}+A^{\\prime}\\) are disjoint, so this partition has the properties we consider.\n\nBy the uniqueness of the example for \\(\\mathbb{Z}\\) the sets \\(A^{\\prime}, B^{\\prime}, C^{\\prime}\\) are the congruence classes modulo 3 , multiplied by \\(1 / N\\). Also all multiples of \\(3 / N\\) are in the same set, \\(A^{\\prime}, B^{\\prime}\\) or \\(C^{\\prime}\\). This holds for \\(r_{1}, r_{2}, r_{3}\\) in particular as they are all multiples of \\(3 / N\\). However \\(r_{1}, r_{2}, r_{3}\\) are in different sets \\(A^{\\prime}, B^{\\prime}, C^{\\prime}\\) since they were chosen from different sets \\(A, B, C\\). The contradiction ends the proof.\n\nComment. The uniqueness of the example for \\(\\mathbb{Z}\\) can also be deduced from the argument in the first solution."}
{"id": "imo-shortlist-2012-a3", "question": "A3. Let \\(a_{2}, \\ldots, a_{n}\\) be \\(n-1\\) positive real numbers, where \\(n \\geq 3\\), such that \\(a_{2} a_{3} \\cdots a_{n}=1\\). Prove that\n\n\\[\n\\left(1+a_{2}\\right)^{2}\\left(1+a_{3}\\right)^{3} \\cdots\\left(1+a_{n}\\right)^{n}>n^{n}\n\\]", "category": "Algebra", "source": "IMO Shortlist", "year": 2012, "solution": "The substitution \\(a_{2}=\\frac{x_{2}}{x_{1}}, a_{3}=\\frac{x_{3}}{x_{2}}, \\ldots, a_{n}=\\frac{x_{1}}{x_{n-1}}\\) transforms the original problem into the inequality\n\n\\[\n\\left(x_{1}+x_{2}\\right)^{2}\\left(x_{2}+x_{3}\\right)^{3} \\cdots\\left(x_{n-1}+x_{1}\\right)^{n}>n^{n} x_{1}^{2} x_{2}^{3} \\cdots x_{n-1}^{n}\n\\]\n\nfor all \\(x_{1}, \\ldots, x_{n-1}>0\\). To prove this, we use the AM-GM inequality for each factor of the left-hand side as follows:\n\n\\[\n\\begin{aligned}\n\\left(x_{1}+x_{2}\\right)^{2} & & & \\geq 2^{2} x_{1} x_{2} \n\\left(x_{2}+x_{3}\\right)^{3} & = & \\left(2\\left(\\frac{x_{2}}{2}\\right)+x_{3}\\right)^{3} & \\geq 3^{3}\\left(\\frac{x_{2}}{2}\\right)^{2} x_{3} \n\\left(x_{3}+x_{4}\\right)^{4} & = & \\left(3\\left(\\frac{x_{3}}{3}\\right)+x_{4}\\right)^{4} & \\geq 4^{4}\\left(\\frac{x_{3}}{3}\\right)^{3} x_{4} \n& \\vdots & \\vdots & \\vdots \n\\left(x_{n-1}+x_{1}\\right)^{n} & = & \\left((n-1)\\left(\\frac{x_{n-1}}{n-1}\\right)+x_{1}\\right)^{n} & \\geq n^{n}\\left(\\frac{x_{n-1}}{n-1}\\right)^{n-1} x_{1}\n\n\\]\n\nMultiplying these inequalities together gives (*), with inequality sign \\(\\geq\\) instead of \\(>\\). However for the equality to occur it is necessary that \\(x_{1}=x_{2}, x_{2}=2 x_{3}, \\ldots, x_{n-1}=(n-1) x_{1}\\), implying \\(x_{1}=(n-1)!x_{1}\\). This is impossible since \\(x_{1}>0\\) and \\(n \\geq 3\\). Therefore the inequality is strict.\n\nComment. One can avoid the substitution \\(a_{i}=x_{i} / x_{i-1}\\). Apply the weighted AM-GM inequality to each factor \\(\\left(1+a_{k}\\right)^{k}\\), with the same weights like above, to obtain\n\n\\[\n\\left(1+a_{k}\\right)^{k}=\\left((k-1) \\frac{1}{k-1}+a_{k}\\right)^{k} \\geq \\frac{k^{k}}{(k-1)^{k-1}} a_{k}\n\\]\n\nMultiplying all these inequalities together gives\n\n\\[\n\\left(1+a_{2}\\right)^{2}\\left(1+a_{3}\\right)^{3} \\cdots\\left(1+a_{n}\\right)^{n} \\geq n^{n} a_{2} a_{3} \\cdots a_{n}=n^{n}\n\\]\n\nThe same argument as in the proof above shows that the equality cannot be attained."}
{"id": "imo-shortlist-2012-a4", "question": "A4. Let \\(f\\) and \\(g\\) be two nonzero polynomials with integer coefficients and \\(\\operatorname{deg} f>\\operatorname{deg} g\\). Suppose that for infinitely many primes \\(p\\) the polynomial \\(p f+g\\) has a rational root. Prove that \\(f\\) has a rational root.", "category": "Algebra", "source": "IMO Shortlist", "year": 2012, "solution": "Since \\(\\operatorname{deg} f>\\operatorname{deg} g\\), we have \\(|g(x) / f(x)|<1\\) for sufficiently large \\(x\\); more precisely, there is a real number \\(R\\) such that \\(|g(x) / f(x)|<1\\) for all \\(x\\) with \\(|x|>R\\). Then for all such \\(x\\) and all primes \\(p\\) we have\n\n\\[\n|p f(x)+g(x)| \\geq|f(x)|\\left(p-\\frac{|g(x)|}{|f(x)|}\\right)>0 .\n\\]\n\nHence all real roots of the polynomials \\(p f+g\\) lie in the interval \\([-R, R]\\).\nLet \\(f(x)=a_{n} x^{n}+a_{n-1} x^{n-1}+\\cdots+a_{0}\\) and \\(g(x)=b_{m} x^{m}+b_{m-1} x^{m-1}+\\cdots+b_{0}\\) where \\(n>m, a_{n} \\neq 0\\) and \\(b_{m} \\neq 0\\). Upon replacing \\(f(x)\\) and \\(g(x)\\) by \\(a_{n}^{n-1} f\\left(x / a_{n}\\right)\\) and \\(a_{n}^{n-1} g\\left(x / a_{n}\\right)\\) respectively, we reduce the problem to the case \\(a_{n}=1\\). In other words one can assume that \\(f\\) is monic. Then the leading coefficient of \\(p f+g\\) is \\(p\\), and if \\(r=u / v\\) is a rational root of \\(p f+g\\) with \\((u, v)=1\\) and \\(v>0\\), then either \\(v=1\\) or \\(v=p\\).\n\nFirst consider the case when \\(v=1\\) infinitely many times. If \\(v=1\\) then \\(|u| \\leq R\\), so there are only finitely many possibilities for the integer \\(u\\). Therefore there exist distinct primes \\(p\\) and \\(q\\) for which we have the same value of \\(u\\). Then the polynomials \\(p f+g\\) and \\(q f+g\\) share this root, implying \\(f(u)=g(u)=0\\). So in this case \\(f\\) and \\(g\\) have an integer root in common.\n\nNow suppose that \\(v=p\\) infinitely many times. By comparing the exponent of \\(p\\) in the denominators of \\(p f(u / p)\\) and \\(g(u / p)\\) we get \\(m=n-1\\) and \\(p f(u / p)+g(u / p)=0\\) reduces to an equation of the form\n\n\\[\n\\left(u^{n}+a_{n-1} p u^{n-1}+\\ldots+a_{0} p^{n}\\right)+\\left(b_{n-1} u^{n-1}+b_{n-2} p u^{n-2}+\\ldots+b_{0} p^{n-1}\\right)=0\n\\]\n\nThe equation above implies that \\(u^{n}+b_{n-1} u^{n-1}\\) is divisible by \\(p\\) and hence, since \\((u, p)=1\\), we have \\(u+b_{n-1}=p k\\) with some integer \\(k\\). On the other hand all roots of \\(p f+g\\) lie in the interval \\([-R, R]\\), so that\n\n\\[\n\\begin{gathered}\n\\frac{\\left|p k-b_{n-1}\\right|}{p}=\\frac{|u|}{p}<R, \n|k|<R+\\frac{\\left|b_{n-1}\\right|}{p}<R+\\left|b_{n-1}\\right| .\n\n\\]\n\nTherefore the integer \\(k\\) can attain only finitely many values. Hence there exists an integer \\(k\\) such that the number \\(\\frac{p k-b_{n-1}}{p}=k-\\frac{b_{n-1}}{p}\\) is a root of \\(p f+g\\) for infinitely many primes \\(p\\). For these primes we have\n\n\\[\nf\\left(k-b_{n-1} \\frac{1}{p}\\right)+\\frac{1}{p} g\\left(k-b_{n-1} \\frac{1}{p}\\right)=0\n\\]\n\nSo the equation\n\n\\[\nf\\left(k-b_{n-1} x\\right)+x g\\left(k-b_{n-1} x\\right)=0\n\\]\n\nhas infinitely many solutions of the form \\(x=1 / p\\). Since the left-hand side is a polynomial, this implies that (1) is a polynomial identity, so it holds for all real \\(x\\). In particular, by substituting \\(x=0\\) in (1) we get \\(f(k)=0\\). Thus the integer \\(k\\) is a root of \\(f\\).\n\nIn summary the monic polynomial \\(f\\) obtained after the initial reduction always has an integer root. Therefore the original polynomial \\(f\\) has a rational root.\n\nSolution 2. Analogously to the first solution, there exists a real number \\(R\\) such that the complex roots of all polynomials of the form \\(p f+g\\) lie in the disk \\(|z| \\leq R\\).\n\nFor each prime \\(p\\) such that \\(p f+g\\) has a rational root, by Gauss' lemma \\(p f+g\\) is the product of two integer polynomials, one with degree 1 and the other with degree \\(\\operatorname{deg} f-1\\). Since \\(p\\) is a prime, the leading coefficient of one of these factors divides the leading coefficient of \\(f\\). Denote that factor by \\(h_{p}\\).\n\nBy narrowing the set of the primes used we can assume that all polynomials \\(h_{p}\\) have the same degree and the same leading coefficient. Their complex roots lie in the disk \\(|z| \\leq R\\), hence Vieta's formulae imply that all coefficients of all polynomials \\(h_{p}\\) form a bounded set. Since these coefficients are integers, there are only finitely many possible polynomials \\(h_{p}\\). Hence there is a polynomial \\(h\\) such that \\(h_{p}=h\\) for infinitely many primes \\(p\\).\n\nFinally, if \\(p\\) and \\(q\\) are distinct primes with \\(h_{p}=h_{q}=h\\) then \\(h\\) divides \\((p-q) f\\). Since \\(\\operatorname{deg} h=1\\) or \\(\\operatorname{deg} h=\\operatorname{deg} f-1\\), in both cases \\(f\\) has a rational root.\n\nComment. Clearly the polynomial \\(h\\) is a common factor of \\(f\\) and \\(g\\). If \\(\\operatorname{deg} h=1\\) then \\(f\\) and \\(g\\) share a rational root. Otherwise \\(\\operatorname{deg} h=\\operatorname{deg} f-1\\) forces \\(\\operatorname{deg} g=\\operatorname{deg} f-1\\) and \\(g\\) divides \\(f\\) over the rationals.\nSolution 3. Like in the first solution, there is a real number \\(R\\) such that the real roots of all polynomials of the form \\(p f+g\\) lie in the interval \\([-R, R]\\).\n\nLet \\(p_{1}<p_{2}<\\cdots\\) be an infinite sequence of primes so that for every index \\(k\\) the polynomial \\(p_{k} f+g\\) has a rational root \\(r_{k}\\). The sequence \\(r_{1}, r_{2}, \\ldots\\) is bounded, so it has a convergent subsequence \\(r_{k_{1}}, r_{k_{2}}, \\ldots\\) Now replace the sequences \\(\\left(p_{1}, p_{2}, \\ldots\\right)\\) and \\(\\left(r_{1}, r_{2}, \\ldots\\right)\\) by \\(\\left(p_{k_{1}}, p_{k_{2}}, \\ldots\\right)\\) and \\(\\left(r_{k_{1}}, r_{k_{2}}, \\ldots\\right)\\); after this we can assume that the sequence \\(r_{1}, r_{2}, \\ldots\\) is convergent. Let \\(\\alpha=\\lim _{k \\rightarrow \\infty} r_{k}\\). We show that \\(\\alpha\\) is a rational root of \\(f\\).\n\nOver the interval \\([-R, R]\\), the polynomial \\(g\\) is bounded, \\(|g(x)| \\leq M\\) with some fixed \\(M\\). Therefore\n\n\\[\n\\left|f\\left(r_{k}\\right)\\right|=\\left|f\\left(r_{k}\\right)-\\frac{p_{k} f\\left(r_{k}\\right)+g\\left(r_{k}\\right)}{p_{k}}\\right|=\\frac{\\left|g\\left(r_{k}\\right)\\right|}{p_{k}} \\leq \\frac{M}{p_{k}} \\rightarrow 0\n\\]\n\nand\n\n\\[\nf(\\alpha)=f\\left(\\lim _{k \\rightarrow \\infty} r_{k}\\right)=\\lim _{k \\rightarrow \\infty} f\\left(r_{k}\\right)=0\n\\]\n\nSo \\(\\alpha\\) is a root of \\(f\\) indeed.\nNow let \\(u_{k}, v_{k}\\) be relative prime integers for which \\(r_{k}=\\frac{u_{k}}{v_{k}}\\). Let \\(a\\) be the leading coefficient of \\(f\\), let \\(b=f(0)\\) and \\(c=g(0)\\) be the constant terms of \\(f\\) and \\(g\\), respectively. The leading coefficient of the polynomial \\(p_{k} f+g\\) is \\(p_{k} a\\), its constant term is \\(p_{k} b+c\\). So \\(v_{k}\\) divides \\(p_{k} a\\) and \\(u_{k}\\) divides \\(p_{k} b+c\\). Let \\(p_{k} b+c=u_{k} e_{k}\\) (if \\(p_{k} b+c=u_{k}=0\\) then let \\(e_{k}=1\\) ).\n\nWe prove that \\(\\alpha\\) is rational by using the following fact. Let \\(\\left(p_{n}\\right)\\) and \\(\\left(q_{n}\\right)\\) be sequences of integers such that the sequence \\(\\left(p_{n} / q_{n}\\right)\\) converges. If \\(\\left(p_{n}\\right)\\) or \\(\\left(q_{n}\\right)\\) is bounded then \\(\\lim \\left(p_{n} / q_{n}\\right)\\) is rational.\n\nCase 1: There is an infinite subsequence ( \\(k_{n}\\) ) of indices such that \\(v_{k_{n}}\\) divides \\(a\\). Then ( \\(v_{k_{n}}\\) ) is bounded, so \\(\\alpha=\\lim _{n \\rightarrow \\infty}\\left(u_{k_{n}} / v_{k_{n}}\\right)\\) is rational.\n\nCase 2: There is an infinite subsequence \\(\\left(k_{n}\\right)\\) of indices such that \\(v_{k_{n}}\\) does not divide \\(a\\). For such indices we have \\(v_{k_{n}}=p_{k_{n}} d_{k_{n}}\\) where \\(d_{k_{n}}\\) is a divisor of \\(a\\). Then\n\n\\[\n\\alpha=\\lim _{n \\rightarrow \\infty} \\frac{u_{k_{n}}}{v_{k_{n}}}=\\lim _{n \\rightarrow \\infty} \\frac{p_{k_{n}} b+c}{p_{k_{n}} d_{k_{n}} e_{k_{n}}}=\\lim _{n \\rightarrow \\infty} \\frac{b}{d_{k_{n}} e_{k_{n}}}+\\lim _{n \\rightarrow \\infty} \\frac{c}{p_{k_{n}} d_{k_{n}} e_{k_{n}}}=\\lim _{n \\rightarrow \\infty} \\frac{b}{d_{k_{n}} e_{k_{n}}}\n\\]\n\nBecause the numerator \\(b\\) in the last limit is bounded, \\(\\alpha\\) is rational."}
{"id": "imo-shortlist-2012-a5", "question": "A5. Find all functions \\(f: \\mathbb{R} \\rightarrow \\mathbb{R}\\) that satisfy the conditions\n\n\\[\nf(1+x y)-f(x+y)=f(x) f(y) \\quad \\text { for all } x, y \\in \\mathbb{R}\n\\]\n\nand \\(f(-1) \\neq 0\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2012, "solution": "The only solution is the function \\(f(x)=x-1, x \\in \\mathbb{R}\\).\nWe set \\(g(x)=f(x)+1\\) and show that \\(g(x)=x\\) for all real \\(x\\). The conditions take the form\n\n\\[\ng(1+x y)-g(x+y)=(g(x)-1)(g(y)-1) \\quad \\text { for all } x, y \\in \\mathbb{R} \\text { and } g(-1) \\neq 1\n\\]\n\nDenote \\(C=g(-1)-1 \\neq 0\\). Setting \\(y=-1\\) in (1) gives\n\n\\[\ng(1-x)-g(x-1)=C(g(x)-1)\n\\]\n\nSet \\(x=1\\) in (2) to obtain \\(C(g(1)-1)=0\\). Hence \\(g(1)=1\\) as \\(C \\neq 0\\). Now plugging in \\(x=0\\) and \\(x=2\\) yields \\(g(0)=0\\) and \\(g(2)=2\\) respectively.\n\nWe pass on to the key observations\n\n\\[\n\\begin{array}{ll}\ng(x)+g(2-x)=2 & \\text { for all } x \\in \\mathbb{R} \ng(x+2)-g(x)=2 & \\text { for all } x \\in \\mathbb{R}\n\n\\]\n\nReplace \\(x\\) by \\(1-x\\) in (2), then change \\(x\\) to \\(-x\\) in the resulting equation. We obtain the relations \\(g(x)-g(-x)=C(g(1-x)-1), g(-x)-g(x)=C(g(1+x)-1)\\). Then adding them up leads to \\(C(g(1-x)+g(1+x)-2)=0\\). Thus \\(C \\neq 0\\) implies (3).\n\nLet \\(u, v\\) be such that \\(u+v=1\\). Apply (1) to the pairs \\((u, v)\\) and \\((2-u, 2-v)\\) :\n\n\\[\ng(1+u v)-g(1)=(g(u)-1)(g(v)-1), \\quad g(3+u v)-g(3)=(g(2-u)-1)(g(2-v)-1)\n\\]\n\nObserve that the last two equations have equal right-hand sides by (3). Hence \\(u+v=1\\) implies\n\n\\[\ng(u v+3)-g(u v+1)=g(3)-g(1)\n\\]\n\nEach \\(x \\leq 5 / 4\\) is expressible in the form \\(x=u v+1\\) with \\(u+v=1\\) (the quadratic function \\(t^{2}-t+(x-1)\\) has real roots for \\(\\left.x \\leq 5 / 4\\right)\\). Hence \\(g(x+2)-g(x)=g(3)-g(1)\\) whenever \\(x \\leq 5 / 4\\). Because \\(g(x)=x\\) holds for \\(x=0,1,2\\), setting \\(x=0\\) yields \\(g(3)=3\\). This proves (4) for \\(x \\leq 5 / 4\\). If \\(x>5 / 4\\) then \\(-x<5 / 4\\) and so \\(g(2-x)-g(-x)=2\\) by the above. On the other hand (3) gives \\(g(x)=2-g(2-x), g(x+2)=2-g(-x)\\), so that \\(g(x+2)-g(x)=g(2-x)-g(-x)=2\\). Thus (4) is true for all \\(x \\in \\mathbb{R}\\).\n\nNow replace \\(x\\) by \\(-x\\) in (3) to obtain \\(g(-x)+g(2+x)=2\\). In view of (4) this leads to \\(g(x)+g(-x)=0\\), i. e. \\(g(-x)=-g(x)\\) for all \\(x\\). Taking this into account, we apply (1) to the pairs \\((-x, y)\\) and \\((x,-y)\\) :\n\\(g(1-x y)-g(-x+y)=(g(x)+1)(1-g(y)), \\quad g(1-x y)-g(x-y)=(1-g(x))(g(y)+1)\\).\nAdding up yields \\(g(1-x y)=1-g(x) g(y)\\). Then \\(g(1+x y)=1+g(x) g(y)\\) by (3). Now the original equation (1) takes the form \\(g(x+y)=g(x)+g(y)\\). Hence \\(g\\) is additive.\n\nBy additvity \\(g(1+x y)=g(1)+g(x y)=1+g(x y)\\); since \\(g(1+x y)=1+g(x) g(y)\\) was shown above, we also have \\(g(x y)=g(x) g(y)\\) ( \\(g\\) is multiplicative). In particular \\(y=x\\) gives \\(g\\left(x^{2}\\right)=g(x)^{2} \\geq 0\\) for all \\(x\\), meaning that \\(g(x) \\geq 0\\) for \\(x \\geq 0\\). Since \\(g\\) is additive and bounded from below on \\([0,+\\infty)\\), it is linear; more exactly \\(g(x)=g(1) x=x\\) for all \\(x \\in \\mathbb{R}\\).\n\nIn summary \\(f(x)=x-1, x \\in \\mathbb{R}\\). It is straightforward that this function satisfies the requirements.\n\nComment. There are functions that satisfy the given equation but vanish at -1 , for instance the constant function 0 and \\(f(x)=x^{2}-1, x \\in \\mathbb{R}\\)."}
{"id": "imo-shortlist-2012-a6", "question": "A6. Let \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}\\) be a function, and let \\(f^{m}\\) be \\(f\\) applied \\(m\\) times. Suppose that for every \\(n \\in \\mathbb{N}\\) there exists a \\(k \\in \\mathbb{N}\\) such that \\(f^{2 k}(n)=n+k\\), and let \\(k_{n}\\) be the smallest such \\(k\\). Prove that the sequence \\(k_{1}, k_{2}, \\ldots\\) is unbounded.", "category": "Algebra", "source": "IMO Shortlist", "year": 2012, "solution": "We restrict attention to the set\n\n\\[\nS=\\left\\{1, f(1), f^{2}(1), \\ldots\\right\\}\n\\]\n\nObserve that \\(S\\) is unbounded because for every number \\(n\\) in \\(S\\) there exists a \\(k>0\\) such that \\(f^{2 k}(n)=n+k\\) is in \\(S\\). Clearly \\(f\\) maps \\(S\\) into itself; moreover \\(f\\) is injective on \\(S\\). Indeed if \\(f^{i}(1)=f^{j}(1)\\) with \\(i \\neq j\\) then the values \\(f^{m}(1)\\) start repeating periodically from some point on, and \\(S\\) would be finite.\n\nDefine \\(g: S \\rightarrow S\\) by \\(g(n)=f^{2 k_{n}}(n)=n+k_{n}\\). We prove that \\(g\\) is injective too. Suppose that \\(g(a)=g(b)\\) with \\(a<b\\). Then \\(a+k_{a}=f^{2 k_{a}}(a)=f^{2 k_{b}}(b)=b+k_{b}\\) implies \\(k_{a}>k_{b}\\). So, since \\(f\\) is injective on \\(S\\), we obtain\n\n\\[\nf^{2\\left(k_{a}-k_{b}\\right)}(a)=b=a+\\left(k_{a}-k_{b}\\right)\n\\]\n\nHowever this contradicts the minimality of \\(k_{a}\\) as \\(0<k_{a}-k_{b}<k_{a}\\).\nLet \\(T\\) be the set of elements of \\(S\\) that are not of the form \\(g(n)\\) with \\(n \\in S\\). Note that \\(1 \\in T\\) by \\(g(n)>n\\) for \\(n \\in S\\), so \\(T\\) is non-empty. For each \\(t \\in T\\) denote \\(C_{t}=\\left\\{t, g(t), g^{2}(t), \\ldots\\right\\}\\); call \\(C_{t}\\) the chain starting at \\(t\\). Observe that distinct chains are disjoint because \\(g\\) is injective. Each \\(n \\in S \\backslash T\\) has the form \\(n=g\\left(n^{\\prime}\\right)\\) with \\(n^{\\prime}<n, n^{\\prime} \\in S\\). Repeated applications of the same observation show that \\(n \\in C_{t}\\) for some \\(t \\in T\\), i. e. \\(S\\) is the disjoint union of the chains \\(C_{t}\\).\n\nIf \\(f^{n}(1)\\) is in the chain \\(C_{t}\\) starting at \\(t=f^{n_{t}}(1)\\) then \\(n=n_{t}+2 a_{1}+\\cdots+2 a_{j}\\) with\n\n\\[\nf^{n}(1)=g^{j}\\left(f^{n_{t}}(1)\\right)=f^{2 a_{j}}\\left(f^{2 a_{j-1}}\\left(\\cdots f^{2 a_{1}}\\left(f^{n_{t}}(1)\\right)\\right)\\right)=f^{n_{t}}(1)+a_{1}+\\cdots+a_{j}\n\\]\n\nHence\n\n\\[\nf^{n}(1)=f^{n_{t}}(1)+\\frac{n-n_{t}}{2}=t+\\frac{n-n_{t}}{2}\n\\]\n\nNow we show that \\(T\\) is infinite. We argue by contradiction. Suppose that there are only finitely many chains \\(C_{t_{1}}, \\ldots, C_{t_{r}}\\), starting at \\(t_{1}<\\cdots<t_{r}\\). Fix \\(N\\). If \\(f^{n}(1)\\) with \\(1 \\leq n \\leq N\\) is in \\(C_{t}\\) then \\(f^{n}(1)=t+\\frac{n-n_{t}}{2} \\leq t_{r}+\\frac{N}{2}\\) by (1). But then the \\(N+1\\) distinct natural numbers \\(1, f(1), \\ldots, f^{N}(1)\\) are all less than \\(t_{r}+\\frac{N}{2}\\) and hence \\(N+1 \\leq t_{r}+\\frac{N}{2}\\). This is a contradiction if \\(N\\) is sufficiently large, and hence \\(T\\) is infinite.\n\nTo complete the argument, choose any \\(k\\) in \\(\\mathbb{N}\\) and consider the \\(k+1\\) chains starting at the first \\(k+1\\) numbers in \\(T\\). Let \\(t\\) be the greatest one among these numbers. Then each of the chains in question contains a number not exceeding \\(t\\), and at least one of them does not contain any number among \\(t+1, \\ldots, t+k\\). So there is a number \\(n\\) in this chain such that \\(g(n)-n>k\\), i. e. \\(k_{n}>k\\). In conclusion \\(k_{1}, k_{2}, \\ldots\\) is unbounded."}
{"id": "imo-shortlist-2012-a7", "question": "A7. We say that a function \\(f: \\mathbb{R}^{k} \\rightarrow \\mathbb{R}\\) is a metapolynomial if, for some positive integers \\(m\\) and \\(n\\), it can be represented in the form\n\n\\[\nf\\left(x_{1}, \\ldots, x_{k}\\right)=\\max _{i=1, \\ldots, m} \\min _{j=1, \\ldots, n} P_{i, j}\\left(x_{1}, \\ldots, x_{k}\\right)\n\\]\n\nwhere \\(P_{i, j}\\) are multivariate polynomials. Prove that the product of two metapolynomials is also a metapolynomial.", "category": "Algebra", "source": "IMO Shortlist", "year": 2012, "solution": "We use the notation \\(f(x)=f\\left(x_{1}, \\ldots, x_{k}\\right)\\) for \\(x=\\left(x_{1}, \\ldots, x_{k}\\right)\\) and \\([m]=\\{1,2, \\ldots, m\\}\\). Observe that if a metapolynomial \\(f(x)\\) admits a representation like the one in the statement for certain positive integers \\(m\\) and \\(n\\), then they can be replaced by any \\(m^{\\prime} \\geq m\\) and \\(n^{\\prime} \\geq n\\). For instance, if we want to replace \\(m\\) by \\(m+1\\) then it is enough to define \\(P_{m+1, j}(x)=P_{m, j}(x)\\) and note that repeating elements of a set do not change its maximum nor its minimum. So one can assume that any two metapolynomials are defined with the same \\(m\\) and \\(n\\). We reserve letters \\(P\\) and \\(Q\\) for polynomials, so every function called \\(P, P_{i, j}, Q, Q_{i, j}, \\ldots\\) is a polynomial function.\n\nWe start with a lemma that is useful to change expressions of the form min max \\(f_{i, j}\\) to ones of the form max min \\(g_{i, j}\\).\nLemma. Let \\(\\left\\{a_{i, j}\\right\\}\\) be real numbers, for all \\(i \\in[m]\\) and \\(j \\in[n]\\). Then\n\n\\[\n\\min _{i \\in[m]} \\max _{j \\in[n]} a_{i, j}=\\max _{j_{1}, \\ldots, j_{m} \\in[n]} \\min _{i \\in[m]} a_{i, j_{i}}\n\\]\n\nwhere the max in the right-hand side is over all vectors \\(\\left(j_{1}, \\ldots, j_{m}\\right)\\) with \\(j_{1}, \\ldots, j_{m} \\in[n]\\).\nProof. We can assume for all \\(i\\) that \\(a_{i, n}=\\max \\left\\{a_{i, 1}, \\ldots, a_{i, n}\\right\\}\\) and \\(a_{m, n}=\\min \\left\\{a_{1, n}, \\ldots, a_{m, n}\\right\\}\\). The left-hand side is \\(=a_{m, n}\\) and hence we need to prove the same for the right-hand side. If \\(\\left(j_{1}, j_{2}, \\ldots, j_{m}\\right)=(n, n, \\ldots, n)\\) then \\(\\min \\left\\{a_{1, j_{1}}, \\ldots, a_{m, j_{m}}\\right\\}=\\min \\left\\{a_{1, n}, \\ldots, a_{m, n}\\right\\}=a_{m, n}\\) which implies that the right-hand side is \\(\\geq a_{m, n}\\). It remains to prove the opposite inequality and this is equivalent to \\(\\min \\left\\{a_{1, j_{1}}, \\ldots, a_{m, j_{m}}\\right\\} \\leq a_{m, n}\\) for all possible \\(\\left(j_{1}, j_{2}, \\ldots, j_{m}\\right)\\). This is true because min \\(\\left\\{a_{1, j_{1}}, \\ldots, a_{m, j_{m}}\\right\\} \\leq a_{m, j_{m}} \\leq a_{m, n}\\).\n\nWe need to show that the family \\(\\mathcal{M}\\) of metapolynomials is closed under multiplication, but it turns out easier to prove more: that it is also closed under addition, maxima and minima.\n\nFirst we prove the assertions about the maxima and the minima. If \\(f_{1}, \\ldots, f_{r}\\) are metapolynomials, assume them defined with the same \\(m\\) and \\(n\\). Then\n\n\\[\nf=\\max \\left\\{f_{1}, \\ldots, f_{r}\\right\\}=\\max \\left\\{\\max _{i \\in[m]} \\min _{j \\in[n]} P_{i, j}^{1}, \\ldots, \\max _{i \\in[m]} \\min _{j \\in[n]} P_{i, j}^{r}\\right\\}=\\max _{s \\in[r], i \\in[m]} \\min _{j \\in[n]} P_{i, j}^{s}\n\\]\n\nIt follows that \\(f=\\max \\left\\{f_{1}, \\ldots, f_{r}\\right\\}\\) is a metapolynomial. The same argument works for the minima, but first we have to replace min max by max min, and this is done via the lemma.\n\nAnother property we need is that if \\(f=\\max \\min P_{i, j}\\) is a metapolynomial then so is \\(-f\\). Indeed, \\(-f=\\min \\left(-\\min P_{i, j}\\right)=\\min \\max P_{i, j}\\).\n\nTo prove \\(\\mathcal{M}\\) is closed under addition let \\(f=\\max \\min P_{i, j}\\) and \\(g=\\max \\min Q_{i, j}\\). Then\n\n\\[\n\\begin{gathered}\nf(x)+g(x)=\\max _{i \\in[m]} \\min _{j \\in[n]} P_{i, j}(x)+\\max _{i \\in[m]} \\min _{j \\in[n]} Q_{i, j}(x) \n=\\max _{i_{1}, i_{2} \\in[m]}\\left(\\min _{j \\in[n]} P_{i_{1}, j}(x)+\\min _{j \\in[n]} Q_{i_{2}, j}(x)\\right)=\\max _{i_{1}, i_{2} \\in[m]} \\min _{j_{1}, j_{2} \\in[n]}\\left(P_{i_{1}, j_{1}}(x)+Q_{i_{2}, j_{2}}(x)\\right)\n\n\\]\n\nand hence \\(f(x)+g(x)\\) is a metapolynomial.\nWe proved that \\(\\mathcal{M}\\) is closed under sums, maxima and minima, in particular any function that can be expressed by sums, max, min, polynomials or even metapolynomials is in \\(\\mathcal{M}\\).\n\nWe would like to proceed with multiplication along the same lines like with addition, but there is an essential difference. In general the product of the maxima of two sets is not equal\nto the maximum of the product of the sets. We need to deal with the fact that \\(a<b\\) and \\(c<d\\) do not imply \\(a c<b d\\). However this is true for \\(a, b, c, d \\geq 0\\).\n\nIn view of this we decompose each function \\(f(x)\\) into its positive part \\(f^{+}(x)=\\max \\{f(x), 0\\}\\) and its negative part \\(f^{-}(x)=\\max \\{0,-f(x)\\}\\). Note that \\(f=f^{+}-f^{-}\\)and \\(f^{+}, f^{-} \\in \\mathcal{M}\\) if \\(f \\in \\mathcal{M}\\). The whole problem reduces to the claim that if \\(f\\) and \\(g\\) are metapolynomials with \\(f, g \\geq 0\\) then \\(f g\\) it is also a metapolynomial.\n\nAssuming this claim, consider arbitrary \\(f, g \\in \\mathcal{M}\\). We have\n\n\\[\nf g=\\left(f^{+}-f^{-}\\right)\\left(g^{+}-g^{-}\\right)=f^{+} g^{+}-f^{+} g^{-}-f^{-} g^{+}+f^{-} g^{-}\n\\]\n\nand hence \\(f g \\in \\mathcal{M}\\). Indeed, \\(\\mathcal{M}\\) is closed under addition, also \\(f^{+} g^{+}, f^{+} g^{-}, f^{-} g^{+}, f^{-} g^{-} \\in \\mathcal{M}\\) because \\(f^{+}, f^{-}, g^{+}, g^{-} \\geq 0\\).\n\nIt remains to prove the claim. In this case \\(f, g \\geq 0\\), and one can try to repeat the argument for the sum. More precisely, let \\(f=\\max \\min P_{i j} \\geq 0\\) and \\(g=\\max \\min Q_{i j} \\geq 0\\). Then\n\n\\[\nf g=\\max \\min P_{i, j} \\cdot \\max \\min Q_{i, j}=\\max \\min P_{i, j}^{+} \\cdot \\max \\min Q_{i, j}^{+}=\\max \\min P_{i_{1}, j_{1}}^{+} \\cdot Q_{i_{2}, j_{2}}^{+}\n\\]\n\nHence it suffices to check that \\(P^{+} Q^{+} \\in \\mathcal{M}\\) for any pair of polynomials \\(P\\) and \\(Q\\). This reduces to the identity\n\n\\[\nu^{+} v^{+}=\\max \\left\\{0, \\min \\{u v, u, v\\}, \\min \\left\\{u v, u v^{2}, u^{2} v\\right\\}, \\min \\left\\{u v, u, u^{2} v\\right\\}, \\min \\left\\{u v, u v^{2}, v\\right\\}\\right\\},\n\\]\n\nwith \\(u\\) replaced by \\(P(x)\\) and \\(v\\) replaced by \\(Q(x)\\). The formula is proved by a case-by-case analysis. If \\(u \\leq 0\\) or \\(v \\leq 0\\) then both sides equal 0 . In case \\(u, v \\geq 0\\), the right-hand side is clearly \\(\\leq u v\\). To prove the opposite inequality we use that \\(u v\\) equals\n\n\\[\n\\begin{array}{ll}\n\\min \\{u v, u, v\\} & \\text { if } 0 \\leq u, v \\leq 1 \n\\min \\left\\{u v, u v^{2}, u^{2} v\\right\\} & \\text { if } 1 \\leq u, v \n\\min \\left\\{u v, u, u^{2} v\\right\\} & \\text { if } 0 \\leq v \\leq 1 \\leq u \n\\min \\left\\{u v, u v^{2}, v\\right\\} & \\text { if } 0 \\leq u \\leq 1 \\leq v\n\n\\]\n\nComment. The case \\(k=1\\) is simpler and can be solved by proving that a function \\(f: \\mathbb{R} \\rightarrow \\mathbb{R}\\) is a metapolynomial if and only if it is a piecewise polinomial (and continuos) function.\n\nIt is enough to prove that all such functions are metapolynomials, and this easily reduces to the following case. Given a polynomial \\(P(x)\\) with \\(P(0)=0\\), the function \\(f\\) defined by \\(f(x)=P(x)\\) for \\(x \\geq 0\\) and 0 otherwise is a metapolynomial. For this last claim, it suffices to prove that \\(\\left(x^{+}\\right)^{n}\\) is a metapolynomial, and this follows from the formula \\(\\left(x^{+}\\right)^{n}=\\max \\left\\{0, \\min \\left\\{x^{n-1}, x^{n}\\right\\}, \\min \\left\\{x^{n}, x^{n+1}\\right\\}\\right\\}\\)."}
{"id": "imo-shortlist-2012-c1", "question": "C1. Several positive integers are written in a row. Iteratively, Alice chooses two adjacent numbers \\(x\\) and \\(y\\) such that \\(x>y\\) and \\(x\\) is to the left of \\(y\\), and replaces the pair \\((x, y)\\) by either \\((y+1, x)\\) or \\((x-1, x)\\). Prove that she can perform only finitely many such iterations.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2012, "solution": "Note first that the allowed operation does not change the maximum \\(M\\) of the initial sequence. Let \\(a_{1}, a_{2}, \\ldots, a_{n}\\) be the numbers obtained at some point of the process. Consider the sum\n\n\\[\nS=a_{1}+2 a_{2}+\\cdots+n a_{n}\n\\]\n\nWe claim that \\(S\\) increases by a positive integer amount with every operation. Let the operation replace the pair ( \\(a_{i}, a_{i+1}\\) ) by a pair ( \\(c, a_{i}\\) ), where \\(a_{i}>a_{i+1}\\) and \\(c=a_{i+1}+1\\) or \\(c=a_{i}-1\\). Then the new and the old value of \\(S\\) differ by \\(d=\\left(i c+(i+1) a_{i}\\right)-\\left(i a_{i}+(i+1) a_{i+1}\\right)=a_{i}-a_{i+1}+i\\left(c-a_{i+1}\\right)\\). The integer \\(d\\) is positive since \\(a_{i}-a_{i+1} \\geq 1\\) and \\(c-a_{i+1} \\geq 0\\).\n\nOn the other hand \\(S \\leq(1+2+\\cdots+n) M\\) as \\(a_{i} \\leq M\\) for all \\(i=1, \\ldots, n\\). Since \\(S\\) increases by at least 1 at each step and never exceeds the constant \\((1+2+\\cdots+n) M\\), the process stops after a finite number of iterations.\n\nSolution 2. Like in the first solution note that the operations do not change the maximum \\(M\\) of the initial sequence. Now consider the reverse lexicographical order for \\(n\\)-tuples of integers. We say that \\(\\left(x_{1}, \\ldots, x_{n}\\right)<\\left(y_{1}, \\ldots, y_{n}\\right)\\) if \\(x_{n}<y_{n}\\), or if \\(x_{n}=y_{n}\\) and \\(x_{n-1}<y_{n-1}\\), or if \\(x_{n}=y_{n}\\), \\(x_{n-1}=y_{n-1}\\) and \\(x_{n-2}<y_{n-2}\\), etc. Each iteration creates a sequence that is greater than the previous one with respect to this order, and no sequence occurs twice during the process. On the other hand there are finitely many possible sequences because their terms are always positive integers not exceeding \\(M\\). Hence the process cannot continue forever.\n\nSolution 3. Let the current numbers be \\(a_{1}, a_{2}, \\ldots, a_{n}\\). Define the score \\(s_{i}\\) of \\(a_{i}\\) as the number of \\(a_{j}\\) 's that are less than \\(a_{i}\\). Call the sequence \\(s_{1}, s_{2}, \\ldots, s_{n}\\) the score sequence of \\(a_{1}, a_{2}, \\ldots, a_{n}\\).\n\nLet us say that a sequence \\(x_{1}, \\ldots, x_{n}\\) dominates a sequence \\(y_{1}, \\ldots, y_{n}\\) if the first index \\(i\\) with \\(x_{i} \\neq y_{i}\\) is such that \\(x_{i}<y_{i}\\). We show that after each operation the new score sequence dominates the old one. Score sequences do not repeat, and there are finitely many possibilities for them, no more than \\((n-1)^{n}\\). Hence the process will terminate.\n\nConsider an operation that replaces \\((x, y)\\) by \\((a, x)\\), with \\(a=y+1\\) or \\(a=x-1\\). Suppose that \\(x\\) was originally at position \\(i\\). For each \\(j<i\\) the score \\(s_{j}\\) does not increase with the change because \\(y \\leq a\\) and \\(x \\leq x\\). If \\(s_{j}\\) decreases for some \\(j<i\\) then the new score sequence dominates the old one. Assume that \\(s_{j}\\) stays the same for all \\(j<i\\) and consider \\(s_{i}\\). Since \\(x>y\\) and \\(y \\leq a \\leq x\\), we see that \\(s_{i}\\) decreases by at least 1 . This concludes the proof.\n\nComment. All three proofs work if \\(x\\) and \\(y\\) are not necessarily adjacent, and if the pair \\((x, y)\\) is replaced by any pair ( \\(a, x\\) ), with \\(a\\) an integer satisfying \\(y \\leq a \\leq x\\). There is nothing special about the \"weights\" \\(1,2, \\ldots, n\\) in the definition of \\(S=\\sum_{i=1}^{n} i a_{i}\\) from the first solution. For any sequence \\(w_{1}<w_{2}<\\cdots<w_{n}\\) of positive integers, the sum \\(\\sum_{i=1}^{n} w_{i} a_{i}\\) increases by at least 1 with each operation.\n\nConsider the same problem, but letting Alice replace the pair \\((x, y)\\) by \\((a, x)\\), where \\(a\\) is any positive integer less than \\(x\\). The same conclusion holds in this version, i. e. the process stops eventually. The solution using the reverse lexicographical order works without any change. The first solution would require a special set of weights like \\(w_{i}=M^{i}\\) for \\(i=1, \\ldots, n\\).\n\nComment. The first and the second solutions provide upper bounds for the number of possible operations, respectively of order \\(M n^{2}\\) and \\(M^{n}\\) where \\(M\\) is the maximum of the original sequence. The upper bound \\((n-1)^{n}\\) in the third solution does not depend on \\(M\\)."}
{"id": "imo-shortlist-2012-c2", "question": "C2. Let \\(n \\geq 1\\) be an integer. What is the maximum number of disjoint pairs of elements of the set \\(\\{1,2, \\ldots, n\\}\\) such that the sums of the different pairs are different integers not exceeding \\(n\\) ?", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2012, "solution": "Consider \\(x\\) such pairs in \\(\\{1,2, \\ldots, n\\}\\). The sum \\(S\\) of the \\(2 x\\) numbers in them is at least \\(1+2+\\cdots+2 x\\) since the pairs are disjoint. On the other hand \\(S \\leq n+(n-1)+\\cdots+(n-x+1)\\) because the sums of the pairs are different and do not exceed \\(n\\). This gives the inequality\n\n\\[\n\\frac{2 x(2 x+1)}{2} \\leq n x-\\frac{x(x-1)}{2}\n\\]\n\nwhich leads to \\(x \\leq \\frac{2 n-1}{5}\\). Hence there are at most \\(\\left\\lfloor\\frac{2 n-1}{5}\\right\\rfloor\\) pairs with the given properties.\nWe show a construction with exactly \\(\\left\\lfloor\\frac{2 n-1}{5}\\right\\rfloor\\) pairs. First consider the case \\(n=5 k+3\\) with \\(k \\geq 0\\), where \\(\\left\\lfloor\\frac{2 n-1}{5}\\right\\rfloor=2 k+1\\). The pairs are displayed in the following table.\n\n\\begin{center}\n\\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}\n\\hline\n\\multirow{2}{*}{Pairs} & \\(3 k+1\\) & \\(3 k\\) & \\(\\cdots\\) & \\(2 k+2\\) & \\(4 k+2\\) & \\(4 k+1\\) & \\(\\cdots\\) & \\(3 k+3\\) & \\(3 k+2\\) \n & 2 & 4 & \\(\\cdots\\) & \\(2 k\\) & 1 & 3 & \\(\\cdots\\) & \\(2 k-1\\) & \\(2 k+1\\) \n\\hline\nSums & \\(3 k+3\\) & \\(3 k+4\\) & \\(\\cdots\\) & \\(4 k+2\\) & \\(4 k+3\\) & \\(4 k+4\\) & \\(\\cdots\\) & \\(5 k+2\\) & \\(5 k+3\\) \n\\hline\n\n\n\nThe \\(2 k+1\\) pairs involve all numbers from 1 to \\(4 k+2\\); their sums are all numbers from \\(3 k+3\\) to \\(5 k+3\\). The same construction works for \\(n=5 k+4\\) and \\(n=5 k+5\\) with \\(k \\geq 0\\). In these cases the required number \\(\\left\\lfloor\\frac{2 n-1}{5}\\right\\rfloor\\) of pairs equals \\(2 k+1\\) again, and the numbers in the table do not exceed \\(5 k+3\\). In the case \\(n=5 k+2\\) with \\(k \\geq 0\\) one needs only \\(2 k\\) pairs. They can be obtained by ignoring the last column of the table (thus removing \\(5 k+3\\) ). Finally, \\(2 k\\) pairs are also needed for the case \\(n=5 k+1\\) with \\(k \\geq 0\\). Now it suffices to ignore the last column of the table and then subtract 1 from each number in the first row.\n\nComment. The construction above is not unique. For instance, the following table shows another set of \\(2 k+1\\) pairs for the cases \\(n=5 k+3, n=5 k+4\\), and \\(n=5 k+5\\).\n\n\\begin{center}\n\\begin{tabular}{|c|c|c|l|c|c|c|l|c|}\n\\hline\n\\multirow{2}{*}{Pairs} & 1 & 2 & \\(\\cdots\\) & \\(k\\) & \\(k+1\\) & \\(k+2\\) & \\(\\cdots\\) & \\(2 k+1\\) \n & \\(4 k+1\\) & \\(4 k-1\\) & \\(\\cdots\\) & \\(2 k+3\\) & \\(4 k+2\\) & \\(4 k\\) & \\(\\cdots\\) & \\(2 k+2\\) \n\\hline\nSums & \\(4 k+2\\) & \\(4 k+1\\) & \\(\\cdots\\) & \\(3 k+3\\) & \\(5 k+3\\) & \\(5 k+2\\) & \\(\\cdots\\) & \\(4 k+3\\) \n\\hline\n\n\n\nThe table for the case \\(n=5 k+2\\) would be the same, with the pair ( \\(k+1,4 k+2\\) ) removed. For the case \\(n=5 k+1\\) remove the last column and subtract 2 from each number in the second row."}
{"id": "imo-shortlist-2012-c3", "question": "C3. In a \\(999 \\times 999\\) square table some cells are white and the remaining ones are red. Let \\(T\\) be the number of triples ( \\(C_{1}, C_{2}, C_{3}\\) ) of cells, the first two in the same row and the last two in the same column, with \\(C_{1}\\) and \\(C_{3}\\) white and \\(C_{2}\\) red. Find the maximum value \\(T\\) can attain.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2012, "solution": "We prove that in an \\(n \\times n\\) square table there are at most \\(\\frac{4 n^{4}}{27}\\) such triples.\nLet row \\(i\\) and column \\(j\\) contain \\(a_{i}\\) and \\(b_{j}\\) white cells respectively, and let \\(R\\) be the set of red cells. For every red cell \\((i, j)\\) there are \\(a_{i} b_{j}\\) admissible triples \\(\\left(C_{1}, C_{2}, C_{3}\\right)\\) with \\(C_{2}=(i, j)\\), therefore\n\n\\[\nT=\\sum_{(i, j) \\in R} a_{i} b_{j}\n\\]\n\nWe use the inequality \\(2 a b \\leq a^{2}+b^{2}\\) to obtain\n\n\\[\nT \\leq \\frac{1}{2} \\sum_{(i, j) \\in R}\\left(a_{i}^{2}+b_{j}^{2}\\right)=\\frac{1}{2} \\sum_{i=1}^{n}\\left(n-a_{i}\\right) a_{i}^{2}+\\frac{1}{2} \\sum_{j=1}^{n}\\left(n-b_{j}\\right) b_{j}^{2}\n\\]\n\nThis is because there are \\(n-a_{i}\\) red cells in row \\(i\\) and \\(n-b_{j}\\) red cells in column \\(j\\). Now we maximize the right-hand side.\n\nBy the AM-GM inequality we have\n\n\\[\n(n-x) x^{2}=\\frac{1}{2}(2 n-2 x) \\cdot x \\cdot x \\leq \\frac{1}{2}\\left(\\frac{2 n}{3}\\right)^{3}=\\frac{4 n^{3}}{27}\n\\]\n\nwith equality if and only if \\(x=\\frac{2 n}{3}\\). By putting everything together, we get\n\n\\[\nT \\leq \\frac{n}{2} \\frac{4 n^{3}}{27}+\\frac{n}{2} \\frac{4 n^{3}}{27}=\\frac{4 n^{4}}{27}\n\\]\n\nIf \\(n=999\\) then any coloring of the square table with \\(x=\\frac{2 n}{3}=666\\) white cells in each row and column attains the maximum as all inequalities in the previous argument become equalities. For example color a cell ( \\(i, j\\) ) white if \\(i-j \\equiv 1,2, \\ldots, 666(\\bmod 999)\\), and red otherwise.\n\nTherefore the maximum value \\(T\\) can attain is \\(T=\\frac{4 \\cdot 999^{4}}{27}\\).\n\nComment. One can obtain a better preliminary estimate with the Cauchy-Schwarz inequality:\n\n\\[\nT=\\sum_{(i, j) \\in R} a_{i} b_{j} \\leq\\left(\\sum_{(i, j) \\in R} a_{i}^{2}\\right)^{\\frac{1}{2}} \\cdot\\left(\\sum_{(i, j) \\in R} b_{j}^{2}\\right)^{\\frac{1}{2}}=\\left(\\sum_{i=1}^{n}\\left(n-a_{i}\\right) a_{i}^{2}\\right)^{\\frac{1}{2}} \\cdot\\left(\\sum_{j=1}^{n}\\left(n-b_{j}\\right) b_{j}^{2}\\right)^{\\frac{1}{2}} .\n\\]\n\nIt can be used to reach the same conclusion."}
{"id": "imo-shortlist-2012-c4", "question": "C4. Players \\(A\\) and \\(B\\) play a game with \\(N \\geq 2012\\) coins and 2012 boxes arranged around a circle. Initially \\(A\\) distributes the coins among the boxes so that there is at least 1 coin in each box. Then the two of them make moves in the order \\(B, A, B, A, \\ldots\\) by the following rules:\n\n\\begin{itemize}\n  \\item On every move of his \\(B\\) passes 1 coin from every box to an adjacent box.\n  \\item On every move of hers \\(A\\) chooses several coins that were not involved in \\(B\\) 's previous move and are in different boxes. She passes every chosen coin to an adjacent box.\n\n\nPlayer \\(A\\) 's goal is to ensure at least 1 coin in each box after every move of hers, regardless of how \\(B\\) plays and how many moves are made. Find the least \\(N\\) that enables her to succeed.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2012, "solution": "We argue for a general \\(n \\geq 7\\) instead of 2012 and prove that the required minimum \\(N\\) is \\(2 n-2\\). For \\(n=2012\\) this gives \\(N_{\\text {min }}=4022\\).\na) If \\(N=2 n-2\\) player \\(A\\) can achieve her goal. Let her start the game with a regular distribution: \\(n-2\\) boxes with 2 coins and 2 boxes with 1 coin. Call the boxes of the two kinds red and white respectively. We claim that on her first move \\(A\\) can achieve a regular distribution again, regardless of \\(B\\) 's first move \\(M\\). She acts according as the following situation \\(S\\) occurs after \\(M\\) or not: The initial distribution contains a red box \\(R\\) with 2 white neighbors, and \\(R\\) receives no coins from them on move \\(M\\).\n\nSuppose that \\(S\\) does not occur. Exactly one of the coins \\(c_{1}\\) and \\(c_{2}\\) in a given red box \\(X\\) is involved in \\(M\\), say \\(c_{1}\\). If \\(M\\) passes \\(c_{1}\\) to the right neighbor of \\(X\\), let \\(A\\) pass \\(c_{2}\\) to its left neighbor, and vice versa. By doing so with all red boxes \\(A\\) performs a legal move \\(M^{\\prime}\\). Thus \\(M\\) and \\(M^{\\prime}\\) combined move the 2 coins of every red box in opposite directions. Hence after \\(M\\) and \\(M^{\\prime}\\) are complete each neighbor of a red box \\(X\\) contains exactly 1 coin that was initially in \\(X\\). So each box with a red neighbor is non-empty after \\(M^{\\prime}\\). If initially there is a box \\(X\\) with 2 white neighbors ( \\(X\\) is red and unique) then \\(X\\) receives a coin from at least one of them on move \\(M\\) since \\(S\\) does not occur. Such a coin is not involved in \\(M^{\\prime}\\), so \\(X\\) is also non-empty after \\(M^{\\prime}\\). Furthermore each box \\(Y\\) has given away its initial content after \\(M\\) and \\(M^{\\prime}\\). A red neighbor of \\(Y\\) adds 1 coin to it; a white neighbor adds at most 1 coin because it is not involved in \\(M^{\\prime}\\). Hence each box contains 1 or 2 coins after \\(M^{\\prime}\\). Because \\(N=2 n-2\\), such a distribution is regular.\n\nNow let \\(S\\) occur after move \\(M\\). Then \\(A\\) leaves untouched the exceptional red box \\(R\\). With all remaining red boxes she proceeds like in the previous case, thus making a legal move \\(M^{\\prime \\prime}\\). Box \\(R\\) receives no coins from its neighbors on either move, so there is 1 coin in it after \\(M^{\\prime \\prime}\\). Like above \\(M\\) and \\(M^{\\prime \\prime}\\) combined pass exactly 1 coin from every red box different from \\(R\\) to each of its neighbors. Every box except \\(R\\) has a red neighbor different from \\(R\\), hence all boxes are non-empty after \\(M^{\\prime \\prime}\\). Next, each box \\(Y\\) except \\(R\\) loses its initial content after \\(M\\) and \\(M^{\\prime \\prime}\\). A red neighbor of \\(Y\\) adds at most 1 coin to it; a white neighbor also adds at most 1 coin as it does not participate in \\(M^{\\prime \\prime}\\). Thus each box has 1 or 2 coins after \\(M^{\\prime \\prime}\\), and the obtained distribution is regular.\n\nPlayer \\(A\\) can apply the described strategy indefinitely, so \\(N=2 n-2\\) enables her to succeed.\nb) For \\(N \\leq 2 n-3\\) player \\(B\\) can achieve an empty box after some move of \\(A\\). Let \\(\\alpha\\) be a set of \\(\\ell\\) consecutive boxes containing a total of \\(N(\\alpha)\\) coins. We call \\(\\alpha\\) an arc if \\(\\ell \\leq n-2\\) and \\(N(\\alpha) \\leq 2 \\ell-3\\). Note that \\(\\ell \\geq 2\\) by the last condition. Moreover if both extremes of \\(\\alpha\\) are non-empty boxes then \\(N(\\alpha) \\geq 2\\), so that \\(N(\\alpha) \\leq 2 \\ell-3\\) implies \\(\\ell \\geq 3\\). Observe also that if an extreme \\(X\\) of \\(\\alpha\\) has more than 1 coin then ignoring \\(X\\) yields a shorter arc. It follows that every arc contains an arc whose extremes have at most 1 coin each.\n\nGiven a clockwise labeling \\(1,2, \\ldots, n\\) of the boxes, suppose that boxes \\(1,2, \\ldots, \\ell\\) form an arc \\(\\alpha\\), with \\(\\ell \\leq n-2\\) and \\(N(\\alpha) \\leq 2 \\ell-3\\). Suppose also that all \\(n \\geq 7\\) boxes are non-empty. Then \\(B\\) can move so that an arc \\(\\alpha^{\\prime}\\) with \\(N\\left(\\alpha^{\\prime}\\right)<N(\\alpha)\\) will appear after any response of \\(A\\).\n\nOne may assume exactly 1 coin in boxes 1 and \\(\\ell\\) by a previous remark. Let \\(B\\) pass 1 coin in counterclockwise direction from box 1 and box \\(n\\), and in clockwise direction from each remaining box. This leaves \\(N(\\alpha)-2\\) coins in the boxes of \\(\\alpha\\). In addition, due to \\(3 \\leq \\ell \\leq n-2\\), box \\(\\ell\\) has exactly 1 coin \\(c\\), the one received from box \\(\\ell-1\\).\n\nLet player \\(A\\) 's next move \\(M\\) pass \\(k \\leq 2\\) coins to boxes \\(1,2, \\ldots, \\ell\\) from the remaining ones. Only boxes 1 and \\(\\ell\\) can receive such coins, at most 1 each. If \\(k<2\\) then after move \\(M\\) boxes \\(1,2, \\ldots, \\ell\\) form an arc \\(\\alpha^{\\prime}\\) with \\(N\\left(\\alpha^{\\prime}\\right)<N(\\alpha)\\). If \\(k=2\\) then \\(M\\) adds a coin to box \\(\\ell\\). Also \\(M\\) does not move coin \\(c\\) from \\(\\ell\\) because \\(c\\) is involved in the previous move of \\(B\\). In summary boxes \\(1,2, \\ldots, \\ell\\) contain \\(N(\\alpha)\\) coins like before, so they form an arc. However there are 2 coins now in the extreme \\(\\ell\\) of the arc. Ignore \\(\\ell\\) to obtain a shorter arc \\(\\alpha^{\\prime}\\) with \\(N\\left(\\alpha^{\\prime}\\right)<N(\\alpha)\\).\n\nConsider any initial distribution without empty boxes. Since \\(N \\leq 2 n-3\\), there are at least 3 boxes in it with exactly 1 coin. It follows from \\(n \\geq 7\\) that some 2 of them are the extremes of an arc \\(\\alpha\\). Hence \\(B\\) can make the move described above, which leads to an arc \\(\\alpha^{\\prime}\\) with \\(N\\left(\\alpha^{\\prime}\\right)<N(\\alpha)\\) after \\(A\\) 's response. If all boxes in the new distribution are non-empty he can repeat the same, and so on. Because \\(N(\\alpha)\\) cannot decrease indefinitely, an empty box will occur after some move of \\(A\\)."}
{"id": "imo-shortlist-2012-c5", "question": "C5. The columns and the rows of a \\(3 n \\times 3 n\\) square board are numbered \\(1,2, \\ldots, 3 n\\). Every square ( \\(x, y\\) ) with \\(1 \\leq x, y \\leq 3 n\\) is colored asparagus, byzantium or citrine according as the modulo 3 remainder of \\(x+y\\) is 0,1 or 2 respectively. One token colored asparagus, byzantium or citrine is placed on each square, so that there are \\(3 n^{2}\\) tokens of each color.\n\nSuppose that one can permute the tokens so that each token is moved to a distance of at most \\(d\\) from its original position, each asparagus token replaces a byzantium token, each byzantium token replaces a citrine token, and each citrine token replaces an asparagus token. Prove that it is possible to permute the tokens so that each token is moved to a distance of at most \\(d+2\\) from its original position, and each square contains a token with the same color as the square.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2012, "solution": "Without loss of generality it suffices to prove that the A-tokens can be moved to distinct A -squares in such a way that each A -token is moved to a distance at most \\(d+2\\) from its original place. This means we need a perfect matching between the \\(3 n^{2} \\mathrm{~A}\\)-squares and the \\(3 n^{2}\\) A-tokens such that the distance in each pair of the matching is at most \\(d+2\\).\n\nTo find the matching, we construct a bipartite graph. The A-squares will be the vertices in one class of the graph; the vertices in the other class will be the A-tokens.\n\nSplit the board into \\(3 \\times 1\\) horizontal triminos; then each trimino contains exactly one Asquare. Take a permutation \\(\\pi\\) of the tokens which moves A-tokens to B-tokens, B-tokens to C-tokens, and C-tokens to A-tokens, in each case to a distance at most \\(d\\). For each A-square \\(S\\), and for each A-token \\(T\\), connect \\(S\\) and \\(T\\) by an edge if \\(T, \\pi(T)\\) or \\(\\pi^{-1}(T)\\) is on the trimino containing \\(S\\). We allow multiple edges; it is even possible that the same square and the same token are connected with three edges. Obviously the lengths of the edges in the graph do not exceed \\(d+2\\). By length of an edge we mean the distance between the A-square and the A-token it connects.\n\nEach A-token \\(T\\) is connected with the three A-squares whose triminos contain \\(T, \\pi(T)\\) and \\(\\pi^{-1}(T)\\). Therefore in the graph all tokens are of degree 3 . We show that the same is true for the A-squares. Let \\(S\\) be an arbitrary A-square, and let \\(T_{1}, T_{2}, T_{3}\\) be the three tokens on the trimino containing \\(S\\). For \\(i=1,2,3\\), if \\(T_{i}\\) is an A-token, then \\(S\\) is connected with \\(T_{i}\\); if \\(T_{i}\\) is a B-token then \\(S\\) is connected with \\(\\pi^{-1}\\left(T_{i}\\right)\\); finally, if \\(T_{i}\\) is a C-token then \\(S\\) is connected with \\(\\pi\\left(T_{i}\\right)\\). Hence in the graph the A-squares also are of degree 3 .\n\nSince the A-squares are of degree 3 , from every set \\(\\mathcal{S}\\) of A-squares exactly \\(3|\\mathcal{S}|\\) edges start. These edges end in at least \\(|\\mathcal{S}|\\) tokens because the A-tokens also are of degree 3. Hence every set \\(\\mathcal{S}\\) of A-squares has at least \\(|\\mathcal{S}|\\) neighbors among the A-tokens.\n\nTherefore, by Hall's marriage theorem, the graph contains a perfect matching between the two vertex classes. So there is a perfect matching between the A-squares and A-tokens with edges no longer than \\(d+2\\). It follows that the tokens can be permuted as specified in the problem statement.\n\nComment 1. In the original problem proposal the board was infinite and there were only two colors. Having \\(n\\) colors for some positive integer \\(n\\) was an option; we chose \\(n=3\\). Moreover, we changed the board to a finite one to avoid dealing with infinite graphs (although Hall's theorem works in the infinite case as well).\n\nWith only two colors Hall's theorem is not needed. In this case we split the board into \\(2 \\times 1\\) dominos, and in the resulting graph all vertices are of degree 2 . The graph consists of disjoint cycles with even length and infinite paths, so the existence of the matching is trivial.\n\nHaving more than three colors would make the problem statement more complicated, because we need a matching between every two color classes of tokens. However, this would not mean a significant increase in difficulty.\n\nComment 2. According to Wikipedia, the color asparagus (hexadecimal code \\#87A96B) is a tone of green that is named after the vegetable. Crayola created this color in 1993 as one of the 16 to be named in the Name The Color Contest. Byzantium (\\#702963) is a dark tone of purple. Its first recorded use as a color name in English was in 1926. Citrine (\\#E4D00A) is variously described as yellow, greenish-yellow, brownish-yellow or orange. The first known use of citrine as a color name in English was in the 14th century."}
{"id": "imo-shortlist-2012-c6", "question": "C6. Let \\(k\\) and \\(n\\) be fixed positive integers. In the liar's guessing game, Amy chooses integers \\(x\\) and \\(N\\) with \\(1 \\leq x \\leq N\\). She tells Ben what \\(N\\) is, but not what \\(x\\) is. Ben may then repeatedly ask Amy whether \\(x \\in S\\) for arbitrary sets \\(S\\) of integers. Amy will always answer with yes or no, but she might lie. The only restriction is that she can lie at most \\(k\\) times in a row. After he has asked as many questions as he wants, Ben must specify a set of at most \\(n\\) positive integers. If \\(x\\) is in this set he wins; otherwise, he loses. Prove that:\na) If \\(n \\geq 2^{k}\\) then Ben can always win.\nb) For sufficiently large \\(k\\) there exist \\(n \\geq 1.99^{k}\\) such that Ben cannot guarantee a win.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2012, "solution": "Consider an answer \\(A \\in\\{y e s, n o\\}\\) to a question of the kind \"Is \\(x\\) in the set \\(S\\) ?\" We say that \\(A\\) is inconsistent with a number \\(i\\) if \\(A=y e s\\) and \\(i \\notin S\\), or if \\(A=n o\\) and \\(i \\in S\\). Observe that an answer inconsistent with the target number \\(x\\) is a lie.\na) Suppose that Ben has determined a set \\(T\\) of size \\(m\\) that contains \\(x\\). This is true initially with \\(m=N\\) and \\(T=\\{1,2, \\ldots, N\\}\\). For \\(m>2^{k}\\) we show how Ben can find a number \\(y \\in T\\) that is different from \\(x\\). By performing this step repeatedly he can reduce \\(T\\) to be of size \\(2^{k} \\leq n\\) and thus win.\n\nSince only the size \\(m>2^{k}\\) of \\(T\\) is relevant, assume that \\(T=\\left\\{0,1, \\ldots, 2^{k}, \\ldots, m-1\\right\\}\\). Ben begins by asking repeatedly whether \\(x\\) is \\(2^{k}\\). If Amy answers no \\(k+1\\) times in a row, one of these answers is truthful, and so \\(x \\neq 2^{k}\\). Otherwise Ben stops asking about \\(2^{k}\\) at the first answer yes. He then asks, for each \\(i=1, \\ldots, k\\), if the binary representation of \\(x\\) has a 0 in the \\(i\\) th digit. Regardless of what the \\(k\\) answers are, they are all inconsistent with a certain number \\(y \\in\\left\\{0,1, \\ldots, 2^{k}-1\\right\\}\\). The preceding answer yes about \\(2^{k}\\) is also inconsistent with \\(y\\). Hence \\(y \\neq x\\). Otherwise the last \\(k+1\\) answers are not truthful, which is impossible.\n\nEither way, Ben finds a number in \\(T\\) that is different from \\(x\\), and the claim is proven.\nb) We prove that if \\(1<\\lambda<2\\) and \\(n=\\left\\lfloor(2-\\lambda) \\lambda^{k+1}\\right\\rfloor-1\\) then Ben cannot guarantee a win. To complete the proof, then it suffices to take \\(\\lambda\\) such that \\(1.99<\\lambda<2\\) and \\(k\\) large enough so that\n\n\\[\nn=\\left\\lfloor(2-\\lambda) \\lambda^{k+1}\\right\\rfloor-1 \\geq 1.99^{k}\n\\]\n\nConsider the following strategy for Amy. First she chooses \\(N=n+1\\) and \\(x \\in\\{1,2, \\ldots, n+1\\}\\) arbitrarily. After every answer of hers Amy determines, for each \\(i=1,2, \\ldots, n+1\\), the number \\(m_{i}\\) of consecutive answers she has given by that point that are inconsistent with \\(i\\). To decide on her next answer, she then uses the quantity\n\n\\[\n\\phi=\\sum_{i=1}^{n+1} \\lambda^{m_{i}}\n\\]\n\nNo matter what Ben's next question is, Amy chooses the answer which minimizes \\(\\phi\\).\nWe claim that with this strategy \\(\\phi\\) will always stay less than \\(\\lambda^{k+1}\\). Consequently no exponent \\(m_{i}\\) in \\(\\phi\\) will ever exceed \\(k\\), hence Amy will never give more than \\(k\\) consecutive answers inconsistent with some \\(i\\). In particular this applies to the target number \\(x\\), so she will never lie more than \\(k\\) times in a row. Thus, given the claim, Amy's strategy is legal. Since the strategy does not depend on \\(x\\) in any way, Ben can make no deductions about \\(x\\), and therefore he cannot guarantee a win.\n\nIt remains to show that \\(\\phi<\\lambda^{k+1}\\) at all times. Initially each \\(m_{i}\\) is 0 , so this condition holds in the beginning due to \\(1<\\lambda<2\\) and \\(n=\\left\\lfloor(2-\\lambda) \\lambda^{k+1}\\right\\rfloor-1\\). Suppose that \\(\\phi<\\lambda^{k+1}\\) at some point, and Ben has just asked if \\(x \\in S\\) for some set \\(S\\). According as Amy answers yes or no, the new value of \\(\\phi\\) becomes\n\n\\[\n\\phi_{1}=\\sum_{i \\in S} 1+\\sum_{i \\notin S} \\lambda^{m_{i}+1} \\quad \\text { or } \\quad \\phi_{2}=\\sum_{i \\in S} \\lambda^{m_{i}+1}+\\sum_{i \\notin S} 1 .\n\\]\n\nSince Amy chooses the option minimizing \\(\\phi\\), the new \\(\\phi\\) will equal \\(\\min \\left(\\phi_{1}, \\phi_{2}\\right)\\). Now we have\n\n\\[\n\\min \\left(\\phi_{1}, \\phi_{2}\\right) \\leq \\frac{1}{2}\\left(\\phi_{1}+\\phi_{2}\\right)=\\frac{1}{2}\\left(\\sum_{i \\in S}\\left(1+\\lambda^{m_{i}+1}\\right)+\\sum_{i \\notin S}\\left(\\lambda^{m_{i}+1}+1\\right)\\right)=\\frac{1}{2}(\\lambda \\phi+n+1)\n\\]\n\nBecause \\(\\phi<\\lambda^{k+1}\\), the assumptions \\(\\lambda<2\\) and \\(n=\\left\\lfloor(2-\\lambda) \\lambda^{k+1}\\right\\rfloor-1\\) lead to\n\n\\[\n\\min \\left(\\phi_{1}, \\phi_{2}\\right)<\\frac{1}{2}\\left(\\lambda^{k+2}+(2-\\lambda) \\lambda^{k+1}\\right)=\\lambda^{k+1}\n\\]\n\nThe claim follows, which completes the solution.\n\nComment. Given a fixed \\(k\\), let \\(f(k)\\) denote the minimum value of \\(n\\) for which Ben can guarantee a victory. The problem asks for a proof that for large \\(k\\)\n\n\\[\n1.99^{k} \\leq f(k) \\leq 2^{k}\n\\]\n\nA computer search shows that \\(f(k)=2,3,4,7,11,17\\) for \\(k=1,2,3,4,5,6\\)."}
{"id": "imo-shortlist-2012-c7", "question": "C7. There are given \\(2^{500}\\) points on a circle labeled \\(1,2, \\ldots, 2^{500}\\) in some order. Prove that one can choose 100 pairwise disjoint chords joining some of these points so that the 100 sums of the pairs of numbers at the endpoints of the chosen chords are equal.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2012, "solution": "The proof is based on the following general fact.\nLemma. In a graph \\(G\\) each vertex \\(v\\) has degree \\(d_{v}\\). Then \\(G\\) contains an independent set \\(S\\) of vertices such that \\(|S| \\geq f(G)\\) where\n\n\\[\nf(G)=\\sum_{v \\in G} \\frac{1}{d_{v}+1}\n\\]\n\nProof. Induction on \\(n=|G|\\). The base \\(n=1\\) is clear. For the inductive step choose a vertex \\(v_{0}\\) in \\(G\\) of minimum degree \\(d\\). Delete \\(v_{0}\\) and all of its neighbors \\(v_{1}, \\ldots, v_{d}\\) and also all edges with endpoints \\(v_{0}, v_{1}, \\ldots, v_{d}\\). This gives a new graph \\(G^{\\prime}\\). By the inductive assumption \\(G^{\\prime}\\) contains an independent set \\(S^{\\prime}\\) of vertices such that \\(\\left|S^{\\prime}\\right| \\geq f\\left(G^{\\prime}\\right)\\). Since no vertex in \\(S^{\\prime}\\) is a neighbor of \\(v_{0}\\) in \\(G\\), the set \\(S=S^{\\prime} \\cup\\left\\{v_{0}\\right\\}\\) is independent in \\(G\\).\n\nLet \\(d_{v}^{\\prime}\\) be the degree of a vertex \\(v\\) in \\(G^{\\prime}\\). Clearly \\(d_{v}^{\\prime} \\leq d_{v}\\) for every such vertex \\(v\\), and also \\(d_{v_{i}} \\geq d\\) for all \\(i=0,1, \\ldots, d\\) by the minimal choice of \\(v_{0}\\). Therefore\n\n\\[\nf\\left(G^{\\prime}\\right)=\\sum_{v \\in G^{\\prime}} \\frac{1}{d_{v}^{\\prime}+1} \\geq \\sum_{v \\in G^{\\prime}} \\frac{1}{d_{v}+1}=f(G)-\\sum_{i=0}^{d} \\frac{1}{d_{v_{i}}+1} \\geq f(G)-\\frac{d+1}{d+1}=f(G)-1\n\\]\n\nHence \\(|S|=\\left|S^{\\prime}\\right|+1 \\geq f\\left(G^{\\prime}\\right)+1 \\geq f(G)\\), and the induction is complete.\nWe pass on to our problem. For clarity denote \\(n=2^{499}\\) and draw all chords determined by the given \\(2 n\\) points. Color each chord with one of the colors \\(3,4, \\ldots, 4 n-1\\) according to the sum of the numbers at its endpoints. Chords with a common endpoint have different colors. For each color \\(c\\) consider the following graph \\(G_{c}\\). Its vertices are the chords of color \\(c\\), and two chords are neighbors in \\(G_{c}\\) if they intersect. Let \\(f\\left(G_{c}\\right)\\) have the same meaning as in the lemma for all graphs \\(G_{c}\\).\n\nEvery chord \\(\\ell\\) divides the circle into two arcs, and one of them contains \\(m(\\ell) \\leq n-1\\) given points. (In particular \\(m(\\ell)=0\\) if \\(\\ell\\) joins two consecutive points.) For each \\(i=0,1, \\ldots, n-2\\) there are \\(2 n\\) chords \\(\\ell\\) with \\(m(\\ell)=i\\). Such a chord has degree at most \\(i\\) in the respective graph. Indeed let \\(A_{1}, \\ldots, A_{i}\\) be all points on either arc determined by a chord \\(\\ell\\) with \\(m(\\ell)=i\\) and color \\(c\\). Every \\(A_{j}\\) is an endpoint of at most 1 chord colored \\(c, j=1, \\ldots, i\\). Hence at most \\(i\\) chords of color \\(c\\) intersect \\(\\ell\\).\n\nIt follows that for each \\(i=0,1, \\ldots, n-2\\) the \\(2 n\\) chords \\(\\ell\\) with \\(m(\\ell)=i\\) contribute at least \\(\\frac{2 n}{i+1}\\) to the sum \\(\\sum_{c} f\\left(G_{c}\\right)\\). Summation over \\(i=0,1, \\ldots, n-2\\) gives\n\n\\[\n\\sum_{c} f\\left(G_{c}\\right) \\geq 2 n \\sum_{i=1}^{n-1} \\frac{1}{i}\n\\]\n\nBecause there are \\(4 n-3\\) colors in all, averaging yields a color \\(c\\) such that\n\n\\[\nf\\left(G_{c}\\right) \\geq \\frac{2 n}{4 n-3} \\sum_{i=1}^{n-1} \\frac{1}{i}>\\frac{1}{2} \\sum_{i=1}^{n-1} \\frac{1}{i}\n\\]\n\nBy the lemma there are at least \\(\\frac{1}{2} \\sum_{i=1}^{n-1} \\frac{1}{i}\\) pairwise disjoint chords of color \\(c\\), i. e. with the same sum \\(c\\) of the pairs of numbers at their endpoints. It remains to show that \\(\\frac{1}{2} \\sum_{i=1}^{n-1} \\frac{1}{i} \\geq 100\\) for \\(n=2^{499}\\). Indeed we have\n\n\\[\n\\sum_{i=1}^{n-1} \\frac{1}{i}>\\sum_{i=1}^{2^{400}} \\frac{1}{i}=1+\\sum_{k=1}^{400} \\sum_{i=2^{k-1+1}}^{2^{k}} \\frac{1}{i}>1+\\sum_{k=1}^{400} \\frac{2^{k-1}}{2^{k}}=201>200\n\\]\n\nThis completes the solution."}
{"id": "imo-shortlist-2012-g1", "question": "G1. In the triangle \\(A B C\\) the point \\(J\\) is the center of the excircle opposite to \\(A\\). This excircle is tangent to the side \\(B C\\) at \\(M\\), and to the lines \\(A B\\) and \\(A C\\) at \\(K\\) and \\(L\\) respectively. The lines \\(L M\\) and \\(B J\\) meet at \\(F\\), and the lines \\(K M\\) and \\(C J\\) meet at \\(G\\). Let \\(S\\) be the point of intersection of the lines \\(A F\\) and \\(B C\\), and let \\(T\\) be the point of intersection of the lines \\(A G\\) and \\(B C\\). Prove that \\(M\\) is the midpoint of \\(S T\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2012, "solution": "Let \\(\\alpha=\\angle C A B, \\beta=\\angle A B C\\) and \\(\\gamma=\\angle B C A\\). The line \\(A J\\) is the bisector of \\(\\angle C A B\\), so \\(\\angle J A K=\\angle J A L=\\frac{\\alpha}{2}\\). By \\(\\angle A K J=\\angle A L J=90^{\\circ}\\) the points \\(K\\) and \\(L\\) lie on the circle \\(\\omega\\) with diameter \\(A J\\).\n\nThe triangle \\(K B M\\) is isosceles as \\(B K\\) and \\(B M\\) are tangents to the excircle. Since \\(B J\\) is the bisector of \\(\\angle K B M\\), we have \\(\\angle M B J=90^{\\circ}-\\frac{\\beta}{2}\\) and \\(\\angle B M K=\\frac{\\beta}{2}\\). Likewise \\(\\angle M C J=90^{\\circ}-\\frac{\\gamma}{2}\\) and \\(\\angle C M L=\\frac{\\gamma}{2}\\). Also \\(\\angle B M F=\\angle C M L\\), therefore\n\n\\[\n\\angle L F J=\\angle M B J-\\angle B M F=\\left(90^{\\circ}-\\frac{\\beta}{2}\\right)-\\frac{\\gamma}{2}=\\frac{\\alpha}{2}=\\angle L A J\n\\]\n\nHence \\(F\\) lies on the circle \\(\\omega\\). (By the angle computation, \\(F\\) and \\(A\\) are on the same side of \\(B C\\).) Analogously, \\(G\\) also lies on \\(\\omega\\). Since \\(A J\\) is a diameter of \\(\\omega\\), we obtain \\(\\angle A F J=\\angle A G J=90^{\\circ}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_6fdca1c2bf1a061018cfg-29}\n\nThe lines \\(A B\\) and \\(B C\\) are symmetric with respect to the external bisector \\(B F\\). Because \\(A F \\perp B F\\) and \\(K M \\perp B F\\), the segments \\(S M\\) and \\(A K\\) are symmetric with respect to \\(B F\\), hence \\(S M=A K\\). By symmetry \\(T M=A L\\). Since \\(A K\\) and \\(A L\\) are equal as tangents to the excircle, it follows that \\(S M=T M\\), and the proof is complete.\n\nComment. After discovering the circle \\(A F K J L G\\), there are many other ways to complete the solution. For instance, from the cyclic quadrilaterals \\(J M F S\\) and \\(J M G T\\) one can find \\(\\angle T S J=\\angle S T J=\\frac{\\alpha}{2}\\). Another possibility is to use the fact that the lines \\(A S\\) and \\(G M\\) are parallel (both are perpendicular to the external angle bisector \\(B J)\\), so \\(\\frac{M S}{M T}=\\frac{A G}{G T}=1\\)."}
{"id": "imo-shortlist-2012-g2", "question": "G2. Let \\(A B C D\\) be a cyclic quadrilateral whose diagonals \\(A C\\) and \\(B D\\) meet at \\(E\\). The extensions of the sides \\(A D\\) and \\(B C\\) beyond \\(A\\) and \\(B\\) meet at \\(F\\). Let \\(G\\) be the point such that \\(E C G D\\) is a parallelogram, and let \\(H\\) be the image of \\(E\\) under reflection in \\(A D\\). Prove that \\(D, H, F, G\\) are concyclic.", "category": "Geometry", "source": "IMO Shortlist", "year": 2012, "solution": "We show first that the triangles \\(F D G\\) and \\(F B E\\) are similar. Since \\(A B C D\\) is cyclic, the triangles \\(E A B\\) and \\(E D C\\) are similar, as well as \\(F A B\\) and \\(F C D\\). The parallelogram \\(E C G D\\) yields \\(G D=E C\\) and \\(\\angle C D G=\\angle D C E\\); also \\(\\angle D C E=\\angle D C A=\\angle D B A\\) by inscribed angles. Therefore\n\n\\[\n\\begin{gathered}\n\\angle F D G=\\angle F D C+\\angle C D G=\\angle F B A+\\angle A B D=\\angle F B E, \n\\frac{G D}{E B}=\\frac{C E}{E B}=\\frac{C D}{A B}=\\frac{F D}{F B} .\n\n\\]\n\nIt follows that \\(F D G\\) and \\(F B E\\) are similar, and so \\(\\angle F G D=\\angle F E B\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_6fdca1c2bf1a061018cfg-30}\n\nSince \\(H\\) is the reflection of \\(E\\) with respect to \\(F D\\), we conclude that\n\n\\[\n\\angle F H D=\\angle F E D=180^{\\circ}-\\angle F E B=180^{\\circ}-\\angle F G D .\n\\]\n\nThis proves that \\(D, H, F, G\\) are concyclic.\n\nComment. Points \\(E\\) and \\(G\\) are always in the half-plane determined by the line \\(F D\\) that contains \\(B\\) and \\(C\\), but \\(H\\) is always in the other half-plane. In particular, \\(D H F G\\) is cyclic if and only if \\(\\angle F H D+\\angle F G D=180^{\\circ}\\)."}
{"id": "imo-shortlist-2012-g3", "question": "G3. In an acute triangle \\(A B C\\) the points \\(D, E\\) and \\(F\\) are the feet of the altitudes through \\(A\\), \\(B\\) and \\(C\\) respectively. The incenters of the triangles \\(A E F\\) and \\(B D F\\) are \\(I_{1}\\) and \\(I_{2}\\) respectively; the circumcenters of the triangles \\(A C I_{1}\\) and \\(B C I_{2}\\) are \\(O_{1}\\) and \\(O_{2}\\) respectively. Prove that \\(I_{1} I_{2}\\) and \\(O_{1} O_{2}\\) are parallel.", "category": "Geometry", "source": "IMO Shortlist", "year": 2012, "solution": "Let \\(\\angle C A B=\\alpha, \\angle A B C=\\beta, \\angle B C A=\\gamma\\). We start by showing that \\(A, B, I_{1}\\) and \\(I_{2}\\) are concyclic. Since \\(A I_{1}\\) and \\(B I_{2}\\) bisect \\(\\angle C A B\\) and \\(\\angle A B C\\), their extensions beyond \\(I_{1}\\) and \\(I_{2}\\) meet at the incenter \\(I\\) of the triangle. The points \\(E\\) and \\(F\\) are on the circle with diameter \\(B C\\), so \\(\\angle A E F=\\angle A B C\\) and \\(\\angle A F E=\\angle A C B\\). Hence the triangles \\(A E F\\) and \\(A B C\\) are similar with ratio of similitude \\(\\frac{A E}{A B}=\\cos \\alpha\\). Because \\(I_{1}\\) and \\(I\\) are their incenters, we obtain \\(I_{1} A=I A \\cos \\alpha\\) and \\(I I_{1}=I A-I_{1} A=2 I A \\sin ^{2} \\frac{\\alpha}{2}\\). By symmetry \\(I I_{2}=2 I B \\sin ^{2} \\frac{\\beta}{2}\\). The law of sines in the triangle \\(A B I\\) gives \\(I A \\sin \\frac{\\alpha}{2}=I B \\sin \\frac{\\beta}{2}\\). Hence\n\n\\[\nI I_{1} \\cdot I A=2\\left(I A \\sin \\frac{\\alpha}{2}\\right)^{2}=2\\left(I B \\sin \\frac{\\beta}{2}\\right)^{2}=I I_{2} \\cdot I B\n\\]\n\nTherefore \\(A, B, I_{1}\\) and \\(I_{2}\\) are concyclic, as claimed.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_6fdca1c2bf1a061018cfg-31}\n\nIn addition \\(I I_{1} \\cdot I A=I I_{2} \\cdot I B\\) implies that \\(I\\) has the same power with respect to the circles \\(\\left(A C I_{1}\\right),\\left(B C I_{2}\\right)\\) and \\(\\left(A B I_{1} I_{2}\\right)\\). Then \\(C I\\) is the radical axis of \\(\\left(A C I_{1}\\right)\\) and \\(\\left(B C I_{2}\\right)\\); in particular \\(C I\\) is perpendicular to the line of centers \\(O_{1} O_{2}\\).\n\nNow it suffices to prove that \\(C I \\perp I_{1} I_{2}\\). Let \\(C I\\) meet \\(I_{1} I_{2}\\) at \\(Q\\), then it is enough to check that \\(\\angle I I_{1} Q+\\angle I_{1} I Q=90^{\\circ}\\). Since \\(\\angle I_{1} I Q\\) is external for the triangle \\(A C I\\), we have\n\n\\[\n\\angle I I_{1} Q+\\angle I_{1} I Q=\\angle I I_{1} Q+(\\angle A C I+\\angle C A I)=\\angle I I_{1} I_{2}+\\angle A C I+\\angle C A I\n\\]\n\nIt remains to note that \\(\\angle I I_{1} I_{2}=\\frac{\\beta}{2}\\) from the cyclic quadrilateral \\(A B I_{1} I_{2}\\), and \\(\\angle A C I=\\frac{\\gamma}{2}\\), \\(\\angle C A I=\\frac{\\alpha}{2}\\). Therefore \\(\\angle I I_{1} Q+\\angle I_{1} I Q=\\frac{\\alpha}{2}+\\frac{\\beta}{2}+\\frac{\\gamma}{2}=90^{\\circ}\\), completing the proof.\n\nComment. It follows from the first part of the solution that the common point \\(I_{3} \\neq C\\) of the circles \\(\\left(A C I_{1}\\right)\\) and \\(\\left(B C I_{2}\\right)\\) is the incenter of the triangle \\(C D E\\)."}
{"id": "imo-shortlist-2012-g4", "question": "G4. Let \\(A B C\\) be a triangle with \\(A B \\neq A C\\) and circumcenter \\(O\\). The bisector of \\(\\angle B A C\\) intersects \\(B C\\) at \\(D\\). Let \\(E\\) be the reflection of \\(D\\) with respect to the midpoint of \\(B C\\). The lines through \\(D\\) and \\(E\\) perpendicular to \\(B C\\) intersect the lines \\(A O\\) and \\(A D\\) at \\(X\\) and \\(Y\\) respectively. Prove that the quadrilateral \\(B X C Y\\) is cyclic.", "category": "Geometry", "source": "IMO Shortlist", "year": 2012, "solution": "The bisector of \\(\\angle B A C\\) and the perpendicular bisector of \\(B C\\) meet at \\(P\\), the midpoint of the minor arc \\(\\widehat{B C}\\) (they are different lines as \\(A B \\neq A C\\) ). In particular \\(O P\\) is perpendicular to \\(B C\\) and intersects it at \\(M\\), the midpoint of \\(B C\\).\n\nDenote by \\(Y^{\\prime}\\) the reflexion of \\(Y\\) with respect to \\(O P\\). Since \\(\\angle B Y C=\\angle B Y^{\\prime} C\\), it suffices to prove that \\(B X C Y^{\\prime}\\) is cyclic.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_6fdca1c2bf1a061018cfg-32}\n\nWe have\n\n\\[\n\\angle X A P=\\angle O P A=\\angle E Y P\n\\]\n\nThe first equality holds because \\(O A=O P\\), and the second one because \\(E Y\\) and \\(O P\\) are both perpendicular to \\(B C\\) and hence parallel. But \\(\\left\\{Y, Y^{\\prime}\\right\\}\\) and \\(\\{E, D\\}\\) are pairs of symmetric points with respect to \\(O P\\), it follows that \\(\\angle E Y P=\\angle D Y^{\\prime} P\\) and hence\n\n\\[\n\\angle X A P=\\angle D Y^{\\prime} P=\\angle X Y^{\\prime} P\n\\]\n\nThe last equation implies that \\(X A Y^{\\prime} P\\) is cyclic. By the powers of \\(D\\) with respect to the circles ( \\(X A Y^{\\prime} P\\) ) and ( \\(A B P C\\) ) we obtain\n\n\\[\nX D \\cdot D Y^{\\prime}=A D \\cdot D P=B D \\cdot D C\n\\]\n\nIt follows that \\(B X C Y^{\\prime}\\) is cyclic, as desired."}
{"id": "imo-shortlist-2012-g5", "question": "G5. Let \\(A B C\\) be a triangle with \\(\\angle B C A=90^{\\circ}\\), and let \\(C_{0}\\) be the foot of the altitude from \\(C\\). Choose a point \\(X\\) in the interior of the segment \\(C C_{0}\\), and let \\(K, L\\) be the points on the segments \\(A X, B X\\) for which \\(B K=B C\\) and \\(A L=A C\\) respectively. Denote by \\(M\\) the intersection of \\(A L\\) and \\(B K\\). Show that \\(M K=M L\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2012, "solution": "Let \\(C^{\\prime}\\) be the reflection of \\(C\\) in the line \\(A B\\), and let \\(\\omega_{1}\\) and \\(\\omega_{2}\\) be the circles with centers \\(A\\) and \\(B\\), passing through \\(L\\) and \\(K\\) respectively. Since \\(A C^{\\prime}=A C=A L\\) and \\(B C^{\\prime}=B C=B K\\), both \\(\\omega_{1}\\) and \\(\\omega_{2}\\) pass through \\(C\\) and \\(C^{\\prime}\\). By \\(\\angle B C A=90^{\\circ}, A C\\) is tangent to \\(\\omega_{2}\\) at \\(C\\), and \\(B C\\) is tangent to \\(\\omega_{1}\\) at \\(C\\). Let \\(K_{1} \\neq K\\) be the second intersection of \\(A X\\) and \\(\\omega_{2}\\), and let \\(L_{1} \\neq L\\) be the second intersection of \\(B X\\) and \\(\\omega_{1}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_6fdca1c2bf1a061018cfg-33}\n\nBy the powers of \\(X\\) with respect to \\(\\omega_{2}\\) and \\(\\omega_{1}\\),\n\n\\[\nX K \\cdot X K_{1}=X C \\cdot X C^{\\prime}=X L \\cdot X L_{1}\n\\]\n\nso the points \\(K_{1}, L, K, L_{1}\\) lie on a circle \\(\\omega_{3}\\).\nThe power of \\(A\\) with respect to \\(\\omega_{2}\\) gives\n\n\\[\nA L^{2}=A C^{2}=A K \\cdot A K_{1}\n\\]\n\nindicating that \\(A L\\) is tangent to \\(\\omega_{3}\\) at \\(L\\). Analogously, \\(B K\\) is tangent to \\(\\omega_{3}\\) at \\(K\\). Hence \\(M K\\) and \\(M L\\) are the two tangents from \\(M\\) to \\(\\omega_{3}\\) and therefore \\(M K=M L\\)."}
{"id": "imo-shortlist-2012-g6", "question": "G6. Let \\(A B C\\) be a triangle with circumcenter \\(O\\) and incenter \\(I\\). The points \\(D, E\\) and \\(F\\) on the sides \\(B C, C A\\) and \\(A B\\) respectively are such that \\(B D+B F=C A\\) and \\(C D+C E=A B\\). The circumcircles of the triangles \\(B F D\\) and \\(C D E\\) intersect at \\(P \\neq D\\). Prove that \\(O P=O I\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2012, "solution": "By Miquel's theorem the circles \\((A E F)=\\omega_{A},(B F D)=\\omega_{B}\\) and \\((C D E)=\\omega_{C}\\) have a common point, for arbitrary points \\(D, E\\) and \\(F\\) on \\(B C, C A\\) and \\(A B\\). So \\(\\omega_{A}\\) passes through the common point \\(P \\neq D\\) of \\(\\omega_{B}\\) and \\(\\omega_{C}\\).\n\nLet \\(\\omega_{A}, \\omega_{B}\\) and \\(\\omega_{C}\\) meet the bisectors \\(A I, B I\\) and \\(C I\\) at \\(A \\neq A^{\\prime}, B \\neq B^{\\prime}\\) and \\(C \\neq C^{\\prime}\\) respectively. The key observation is that \\(A^{\\prime}, B^{\\prime}\\) and \\(C^{\\prime}\\) do not depend on the particular choice of \\(D, E\\) and \\(F\\), provided that \\(B D+B F=C A, C D+C E=A B\\) and \\(A E+A F=B C\\) hold true (the last equality follows from the other two). For a proof we need the following fact.\nLemma. Given is an angle with vertex \\(A\\) and measure \\(\\alpha\\). A circle \\(\\omega\\) through \\(A\\) intersects the angle bisector at \\(L\\) and sides of the angle at \\(X\\) and \\(Y\\). Then \\(A X+A Y=2 A L \\cos \\frac{\\alpha}{2}\\).\nProof. Note that \\(L\\) is the midpoint of \\(\\operatorname{arc} \\widehat{X L Y}\\) in \\(\\omega\\) and set \\(X L=Y L=u, X Y=v\\). By Ptolemy's theorem \\(A X \\cdot Y L+A Y \\cdot X L=A L \\cdot X Y\\), which rewrites as \\((A X+A Y) u=A L \\cdot v\\). Since \\(\\angle L X Y=\\frac{\\alpha}{2}\\) and \\(\\angle X L Y=180^{\\circ}-\\alpha\\), we have \\(v=2 \\cos \\frac{\\alpha}{2} u\\) by the law of sines, and the claim follows.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_6fdca1c2bf1a061018cfg-34}\n\nApply the lemma to \\(\\angle B A C=\\alpha\\) and the circle \\(\\omega=\\omega_{A}\\), which intersects \\(A I\\) at \\(A^{\\prime}\\). This gives \\(2 A A^{\\prime} \\cos \\frac{\\alpha}{2}=A E+A F=B C\\); by symmetry analogous relations hold for \\(B B^{\\prime}\\) and \\(C C^{\\prime}\\). It follows that \\(A^{\\prime}, B^{\\prime}\\) and \\(C^{\\prime}\\) are independent of the choice of \\(D, E\\) and \\(F\\), as stated.\n\nWe use the lemma two more times with \\(\\angle B A C=\\alpha\\). Let \\(\\omega\\) be the circle with diameter \\(A I\\). Then \\(X\\) and \\(Y\\) are the tangency points of the incircle of \\(A B C\\) with \\(A B\\) and \\(A C\\), and hence \\(A X=A Y=\\frac{1}{2}(A B+A C-B C)\\). So the lemma yields \\(2 A I \\cos \\frac{\\alpha}{2}=A B+A C-B C\\). Next, if \\(\\omega\\) is the circumcircle of \\(A B C\\) and \\(A I\\) intersects \\(\\omega\\) at \\(M \\neq A\\) then \\(\\{X, Y\\}=\\{B, C\\}\\), and so \\(2 A M \\cos \\frac{\\alpha}{2}=A B+A C\\) by the lemma. To summarize,\n\n\\[\n2 A A^{\\prime} \\cos \\frac{\\alpha}{2}=B C, \\quad 2 A I \\cos \\frac{\\alpha}{2}=A B+A C-B C, \\quad 2 A M \\cos \\frac{\\alpha}{2}=A B+A C\n\\]\n\nThese equalities imply \\(A A^{\\prime}+A I=A M\\), hence the segments \\(A M\\) and \\(I A^{\\prime}\\) have a common midpoint. It follows that \\(I\\) and \\(A^{\\prime}\\) are equidistant from the circumcenter \\(O\\). By symmetry \\(O I=O A^{\\prime}=O B^{\\prime}=O C^{\\prime}\\), so \\(I, A^{\\prime}, B^{\\prime}, C^{\\prime}\\) are on a circle centered at \\(O\\).\n\nTo prove \\(O P=O I\\), now it suffices to show that \\(I, A^{\\prime}, B^{\\prime}, C^{\\prime}\\) and \\(P\\) are concyclic. Clearly one can assume \\(P \\neq I, A^{\\prime}, B^{\\prime}, C^{\\prime}\\).\n\nWe use oriented angles to avoid heavy case distinction. The oriented angle between the lines \\(l\\) and \\(m\\) is denoted by \\(\\angle(l, m)\\). We have \\(\\angle(l, m)=-\\angle(m, l)\\) and \\(\\angle(l, m)+\\angle(m, n)=\\angle(l, n)\\) for arbitrary lines \\(l, m\\) and \\(n\\). Four distinct non-collinear points \\(U, V, X, Y\\) are concyclic if and only if \\(\\angle(U X, V X)=\\angle(U Y, V Y)\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_6fdca1c2bf1a061018cfg-35}\n\nSuppose for the moment that \\(A^{\\prime}, B^{\\prime}, P, I\\) are distinct and noncollinear; then it is enough to check the equality \\(\\angle\\left(A^{\\prime} P, B^{\\prime} P\\right)=\\angle\\left(A^{\\prime} I, B^{\\prime} I\\right)\\). Because \\(A, F, P, A^{\\prime}\\) are on the circle \\(\\omega_{A}\\), we have \\(\\angle\\left(A^{\\prime} P, F P\\right)=\\angle\\left(A^{\\prime} A, F A\\right)=\\angle\\left(A^{\\prime} I, A B\\right)\\). Likewise \\(\\angle\\left(B^{\\prime} P, F P\\right)=\\angle\\left(B^{\\prime} I, A B\\right)\\). Therefore\n\n\\[\n\\angle\\left(A^{\\prime} P, B^{\\prime} P\\right)=\\angle\\left(A^{\\prime} P, F P\\right)+\\angle\\left(F P, B^{\\prime} P\\right)=\\angle\\left(A^{\\prime} I, A B\\right)-\\angle\\left(B^{\\prime} I, A B\\right)=\\angle\\left(A^{\\prime} I, B^{\\prime} I\\right)\n\\]\n\nHere we assumed that \\(P \\neq F\\). If \\(P=F\\) then \\(P \\neq D, E\\) and the conclusion follows similarly (use \\(\\angle\\left(A^{\\prime} F, B^{\\prime} F\\right)=\\angle\\left(A^{\\prime} F, E F\\right)+\\angle(E F, D F)+\\angle\\left(D F, B^{\\prime} F\\right)\\) and inscribed angles in \\(\\left.\\omega_{A}, \\omega_{B}, \\omega_{C}\\right)\\).\n\nThere is no loss of generality in assuming \\(A^{\\prime}, B^{\\prime}, P, I\\) distinct and noncollinear. If \\(A B C\\) is an equilateral triangle then the equalities (*) imply that \\(A^{\\prime}, B^{\\prime}, C^{\\prime}, I, O\\) and \\(P\\) coincide, so \\(O P=O I\\). Otherwise at most one of \\(A^{\\prime}, B^{\\prime}, C^{\\prime}\\) coincides with \\(I\\). If say \\(C^{\\prime}=I\\) then \\(O I \\perp C I\\) by the previous reasoning. It follows that \\(A^{\\prime}, B^{\\prime} \\neq I\\) and hence \\(A^{\\prime} \\neq B^{\\prime}\\). Finally \\(A^{\\prime}, B^{\\prime}\\) and \\(I\\) are noncollinear because \\(I, A^{\\prime}, B^{\\prime}, C^{\\prime}\\) are concyclic.\n\nComment. The proposer remarks that the locus \\(\\gamma\\) of the points \\(P\\) is an arc of the circle \\(\\left(A^{\\prime} B^{\\prime} C^{\\prime} I\\right)\\). The reflection \\(I^{\\prime}\\) of \\(I\\) in \\(O\\) belongs to \\(\\gamma\\); it is obtained by choosing \\(D, E\\) and \\(F\\) to be the tangency points of the three excircles with their respective sides. The rest of the circle \\(\\left(A^{\\prime} B^{\\prime} C^{\\prime} I\\right)\\), except \\(I\\), can be included in \\(\\gamma\\) by letting \\(D, E\\) and \\(F\\) vary on the extensions of the sides and assuming signed lengths. For instance if \\(B\\) is between \\(C\\) and \\(D\\) then the length \\(B D\\) must be taken with a negative sign. The incenter \\(I\\) corresponds to the limit case where \\(D\\) tends to infinity."}
{"id": "imo-shortlist-2012-g7", "question": "G7. Let \\(A B C D\\) be a convex quadrilateral with non-parallel sides \\(B C\\) and \\(A D\\). Assume that there is a point \\(E\\) on the side \\(B C\\) such that the quadrilaterals \\(A B E D\\) and \\(A E C D\\) are circumscribed. Prove that there is a point \\(F\\) on the side \\(A D\\) such that the quadrilaterals \\(A B C F\\) and \\(B C D F\\) are circumscribed if and only if \\(A B\\) is parallel to \\(C D\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2012, "solution": "Let \\(\\omega_{1}\\) and \\(\\omega_{2}\\) be the incircles and \\(O_{1}\\) and \\(O_{2}\\) the incenters of the quadrilaterals \\(A B E D\\) and \\(A E C D\\) respectively. A point \\(F\\) with the stated property exists only if \\(\\omega_{1}\\) and \\(\\omega_{2}\\) are also the incircles of the quadrilaterals \\(A B C F\\) and \\(B C D F\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_6fdca1c2bf1a061018cfg-36(1)}\n\nLet the tangents from \\(B\\) to \\(\\omega_{2}\\) and from \\(C\\) to \\(\\omega_{1}\\) (other than \\(B C\\) ) meet \\(A D\\) at \\(F_{1}\\) and \\(F_{2}\\) respectively. We need to prove that \\(F_{1}=F_{2}\\) if and only if \\(A B \\| C D\\).\nLemma. The circles \\(\\omega_{1}\\) and \\(\\omega_{2}\\) with centers \\(O_{1}\\) and \\(O_{2}\\) are inscribed in an angle with vertex \\(O\\). The points \\(P, S\\) on one side of the angle and \\(Q, R\\) on the other side are such that \\(\\omega_{1}\\) is the incircle of the triangle \\(P Q O\\), and \\(\\omega_{2}\\) is the excircle of the triangle \\(R S O\\) opposite to \\(O\\). Denote \\(p=O O_{1} \\cdot O O_{2}\\). Then exactly one of the following relations holds:\n\n\\[\nO P \\cdot O R<p<O Q \\cdot O S, \\quad O P \\cdot O R>p>O Q \\cdot O S, \\quad O P \\cdot O R=p=O Q \\cdot O S\n\\]\n\nProof. Denote \\(\\angle O P O_{1}=u, \\angle O Q O_{1}=v, \\angle O O_{2} R=x, \\angle O O_{2} S=y, \\angle P O Q=2 \\varphi\\). Because \\(P O_{1}, Q O_{1}, R O_{2}, S O_{2}\\) are internal or external bisectors in the triangles \\(P Q O\\) and \\(R S O\\), we have\n\n\\[\nu+v=x+y\\left(=90^{\\circ}-\\varphi\\right)\n\\]\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2025_05_30_6fdca1c2bf1a061018cfg-36}\n\n\nBy the law of sines\n\n\\[\n\\frac{O P}{O O_{1}}=\\frac{\\sin (u+\\varphi)}{\\sin u} \\quad \\text { and } \\quad \\frac{O O_{2}}{O R}=\\frac{\\sin (x+\\varphi)}{\\sin x}\n\\]\n\nTherefore, since \\(x, u\\) and \\(\\varphi\\) are acute,\n\\(O P \\cdot O R \\geq p \\Leftrightarrow \\frac{O P}{O O_{1}} \\geq \\frac{O O_{2}}{O R} \\Leftrightarrow \\sin x \\sin (u+\\varphi) \\geq \\sin u \\sin (x+\\varphi) \\Leftrightarrow \\sin (x-u) \\geq 0 \\Leftrightarrow x \\geq u\\).\nThus \\(O P \\cdot O R \\geq p\\) is equivalent to \\(x \\geq u\\), with \\(O P \\cdot O R=p\\) if and only if \\(x=u\\).\nAnalogously, \\(p \\geq O Q \\cdot O S\\) is equivalent to \\(v \\geq y\\), with \\(p=O Q \\cdot O S\\) if and only if \\(v=y\\). On the other hand \\(x \\geq u\\) and \\(v \\geq y\\) are equivalent by (1), with \\(x=u\\) if and only if \\(v=y\\). The conclusion of the lemma follows from here.\n\nGoing back to the problem, apply the lemma to the quadruples \\(\\left\\{B, E, D, F_{1}\\right\\},\\{A, B, C, D\\}\\) and \\(\\left\\{A, E, C, F_{2}\\right\\}\\). Assuming \\(O E \\cdot O F_{1}>p\\), we obtain\n\n\\[\nO E \\cdot O F_{1}>p \\Rightarrow O B \\cdot O D<p \\Rightarrow O A \\cdot O C>p \\Rightarrow O E \\cdot O F_{2}<p .\n\\]\n\nIn other words, \\(O E \\cdot O F_{1}>p\\) implies\n\n\\[\nO B \\cdot O D<p<O A \\cdot O C \\quad \\text { and } \\quad O E \\cdot O F_{1}>p>O E \\cdot O F_{2}\n\\]\n\nSimilarly, \\(O E \\cdot O F_{1}<p\\) implies\n\n\\[\nO B \\cdot O D>p>O A \\cdot O C \\quad \\text { and } \\quad O E \\cdot O F_{1}<p<O E \\cdot O F_{2}\n\\]\n\nIn these cases \\(F_{1} \\neq F_{2}\\) and \\(O B \\cdot O D \\neq O A \\cdot O C\\), so the lines \\(A B\\) and \\(C D\\) are not parallel.\nThere remains the case \\(O E \\cdot O F_{1}=p\\). Here the lemma leads to \\(O B \\cdot O D=p=O A \\cdot O C\\) and \\(O E \\cdot O F_{1}=p=O E \\cdot O F_{2}\\). Therefore \\(F_{1}=F_{2}\\) and \\(A B \\| C D\\).\n\nComment. The conclusion is also true if \\(B C\\) and \\(A D\\) are parallel. One can prove a limit case of the lemma for the configuration shown in the figure below, where \\(r_{1}\\) and \\(r_{2}\\) are parallel rays starting at \\(O^{\\prime}\\) and \\(O^{\\prime \\prime}\\), with \\(O^{\\prime} O^{\\prime \\prime} \\perp r_{1}, r_{2}\\) and \\(O\\) the midpoint of \\(O^{\\prime} O^{\\prime \\prime}\\). Two circles with centers \\(O_{1}\\) and \\(O_{2}\\) are inscribed in the strip between \\(r_{1}\\) and \\(r_{2}\\). The lines \\(P Q\\) and \\(R S\\) are tangent to the circles, with \\(P, S\\) on \\(r_{1}\\), and \\(Q, R\\) on \\(r_{2}\\), so that \\(O, O_{1}\\) are on the same side of \\(P Q\\) and \\(O, O_{2}\\) are on different sides of \\(R S\\). Denote \\(s=O O_{1}+O O_{2}\\). Then exactly one of the following relations holds:\n\n\\[\nO^{\\prime} P+O^{\\prime \\prime} R<s<O^{\\prime \\prime} Q+O^{\\prime} S, \\quad O^{\\prime} P+O^{\\prime \\prime} R>s>O^{\\prime \\prime} Q+O^{\\prime} S, \\quad O^{\\prime} P+O^{\\prime \\prime} R=s=O^{\\prime \\prime} Q+O^{\\prime} S\n\\]\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2025_05_30_6fdca1c2bf1a061018cfg-37}\n\n\nOnce this is established, the proof of the original statement for \\(B C \\| A D\\) is analogous to the one in the intersecting case. One replaces products by sums of relevant segments."}
{"id": "imo-shortlist-2012-g8", "question": "G8. Let \\(A B C\\) be a triangle with circumcircle \\(\\omega\\) and \\(\\ell\\) a line without common points with \\(\\omega\\). Denote by \\(P\\) the foot of the perpendicular from the center of \\(\\omega\\) to \\(\\ell\\). The side-lines \\(B C, C A, A B\\) intersect \\(\\ell\\) at the points \\(X, Y, Z\\) different from \\(P\\). Prove that the circumcircles of the triangles \\(A X P, B Y P\\) and \\(C Z P\\) have a common point different from \\(P\\) or are mutually tangent at \\(P\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2012, "solution": "Let \\(\\omega_{A}, \\omega_{B}, \\omega_{C}\\) and \\(\\omega\\) be the circumcircles of triangles \\(A X P, B Y P, C Z P\\) and \\(A B C\\) respectively. The strategy of the proof is to construct a point \\(Q\\) with the same power with respect to the four circles. Then each of \\(P\\) and \\(Q\\) has the same power with respect to \\(\\omega_{A}, \\omega_{B}, \\omega_{C}\\) and hence the three circles are coaxial. In other words they have another common point \\(P^{\\prime}\\) or the three of them are tangent at \\(P\\).\n\nWe first give a description of the point \\(Q\\). Let \\(A^{\\prime} \\neq A\\) be the second intersection of \\(\\omega\\) and \\(\\omega_{A}\\); define \\(B^{\\prime}\\) and \\(C^{\\prime}\\) analogously. We claim that \\(A A^{\\prime}, B B^{\\prime}\\) and \\(C C^{\\prime}\\) have a common point. Once this claim is established, the point just constructed will be on the radical axes of the three pairs of circles \\(\\left\\{\\omega, \\omega_{A}\\right\\},\\left\\{\\omega, \\omega_{B}\\right\\},\\left\\{\\omega, \\omega_{C}\\right\\}\\). Hence it will have the same power with respect to \\(\\omega, \\omega_{A}, \\omega_{B}, \\omega_{C}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_6fdca1c2bf1a061018cfg-38}\n\nWe proceed to prove that \\(A A^{\\prime}, B B^{\\prime}\\) and \\(C C^{\\prime}\\) intersect at one point. Let \\(r\\) be the circumradius of triangle \\(A B C\\). Define the points \\(X^{\\prime}, Y^{\\prime}, Z^{\\prime}\\) as the intersections of \\(A A^{\\prime}, B B^{\\prime}, C C^{\\prime}\\) with \\(\\ell\\). Observe that \\(X^{\\prime}, Y^{\\prime}, Z^{\\prime}\\) do exist. If \\(A A^{\\prime}\\) is parallel to \\(\\ell\\) then \\(\\omega_{A}\\) is tangent to \\(\\ell\\); hence \\(X=P\\) which is a contradiction. Similarly, \\(B B^{\\prime}\\) and \\(C C^{\\prime}\\) are not parallel to \\(\\ell\\).\n\nFrom the powers of the point \\(X^{\\prime}\\) with respect to the circles \\(\\omega_{A}\\) and \\(\\omega\\) we get\n\n\\[\nX^{\\prime} P \\cdot\\left(X^{\\prime} P+P X\\right)=X^{\\prime} P \\cdot X^{\\prime} X=X^{\\prime} A^{\\prime} \\cdot X^{\\prime} A=X^{\\prime} O^{2}-r^{2}\n\\]\n\nhence\n\n\\[\nX^{\\prime} P \\cdot P X=X^{\\prime} O^{2}-r^{2}-X^{\\prime} P^{2}=O P^{2}-r^{2}\n\\]\n\nWe argue analogously for the points \\(Y^{\\prime}\\) and \\(Z^{\\prime}\\), obtaining\n\n\\[\nX^{\\prime} P \\cdot P X=Y^{\\prime} P \\cdot P Y=Z^{\\prime} P \\cdot P Z=O P^{2}-r^{2}=k^{2} .\n\\]\n\nIn these computations all segments are regarded as directed segments. We keep the same convention for the sequel.\n\nWe prove that the lines \\(A A^{\\prime}, B B^{\\prime}, C C^{\\prime}\\) intersect at one point by Ceva's theorem. To avoid distracting remarks we interpret everything projectively, i. e. whenever two lines are parallel they meet at a point on the line at infinity.\n\nLet \\(U, V, W\\) be the intersections of \\(A A^{\\prime}, B B^{\\prime}, C C^{\\prime}\\) with \\(B C, C A, A B\\) respectively. The idea is that although it is difficult to calculate the ratio \\(\\frac{B U}{C U}\\), it is easier to deal with the cross-ratio \\(\\frac{B U}{C U} / \\frac{B X}{C X}\\) because we can send it to the line \\(\\ell\\). With this in mind we apply Menelaus' theorem to the triangle \\(A B C\\) and obtain \\(\\frac{B X}{C X} \\cdot \\frac{C Y}{A Y} \\cdot \\frac{A Z}{B Z}=1\\). Hence Ceva's ratio can be expressed as\n\n\\[\n\\frac{B U}{C U} \\cdot \\frac{C V}{A V} \\cdot \\frac{A W}{B W}=\\frac{B U}{C U} / \\frac{B X}{C X} \\cdot \\frac{C V}{A V} / \\frac{C Y}{A Y} \\cdot \\frac{A W}{B W} / \\frac{A Z}{B Z}\n\\]\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2025_05_30_6fdca1c2bf1a061018cfg-39}\n\n\nProject the line \\(B C\\) to \\(\\ell\\) from \\(A\\). The cross-ratio between \\(B C\\) and \\(U X\\) equals the cross-ratio between \\(Z Y\\) and \\(X^{\\prime} X\\). Repeating the same argument with the lines \\(C A\\) and \\(A B\\) gives\n\n\\[\n\\frac{B U}{C U} \\cdot \\frac{C V}{A V} \\cdot \\frac{A W}{B W}=\\frac{Z X^{\\prime}}{Y X^{\\prime}} / \\frac{Z X}{Y X} \\cdot \\frac{X Y^{\\prime}}{Z Y^{\\prime}} / \\frac{X Y}{Z Y} \\cdot \\frac{Y Z^{\\prime}}{X Z^{\\prime}} / \\frac{Y Z}{X Z}\n\\]\n\nand hence\n\n\\[\n\\frac{B U}{C U} \\cdot \\frac{C V}{A V} \\cdot \\frac{A W}{B W}=(-1) \\cdot \\frac{Z X^{\\prime}}{Y X^{\\prime}} \\cdot \\frac{X Y^{\\prime}}{Z Y^{\\prime}} \\cdot \\frac{Y Z^{\\prime}}{X Z^{\\prime}} .\n\\]\n\nThe equations (1) reduce the problem to a straightforward computation on the line \\(\\ell\\). For instance, the transformation \\(t \\mapsto-k^{2} / t\\) preserves cross-ratio and interchanges the points \\(X, Y, Z\\) with the points \\(X^{\\prime}, Y^{\\prime}, Z^{\\prime}\\). Then\n\n\\[\n\\frac{B U}{C U} \\cdot \\frac{C V}{A V} \\cdot \\frac{A W}{B W}=(-1) \\cdot \\frac{Z X^{\\prime}}{Y X^{\\prime}} / \\frac{Z Z^{\\prime}}{Y Z^{\\prime}} \\cdot \\frac{X Y^{\\prime}}{Z Y^{\\prime}} / \\frac{X Z^{\\prime}}{Z Z^{\\prime}}=-1 .\n\\]\n\nWe proved that Ceva's ratio equals -1 , so \\(A A^{\\prime}, B B^{\\prime}, C C^{\\prime}\\) intersect at one point \\(Q\\).\nComment 1. There is a nice projective argument to prove that \\(A X^{\\prime}, B Y^{\\prime}, C Z^{\\prime}\\) intersect at one point. Suppose that \\(\\ell\\) and \\(\\omega\\) intersect at a pair of complex conjugate points \\(D\\) and \\(E\\). Consider a projective transformation that takes \\(D\\) and \\(E\\) to \\([i ; 1,0]\\) and \\([-i, 1,0]\\). Then \\(\\ell\\) is the line at infinity, and \\(\\omega\\) is a conic through the special points \\([i ; 1,0]\\) and \\([-i, 1,0]\\), hence it is a circle. So one can assume that \\(A X, B Y, C Z\\) are parallel to \\(B C, C A, A B\\). The involution on \\(\\ell\\) taking \\(X, Y, Z\\) to \\(X^{\\prime}, Y^{\\prime}, Z^{\\prime}\\) and leaving \\(D, E\\) fixed is the involution changing each direction to its perpendicular one. Hence \\(A X, B Y, C Z\\) are also perpendicular to \\(A X^{\\prime}, B Y^{\\prime}, C Z^{\\prime}\\).\n\nIt follows from the above that \\(A X^{\\prime}, B Y^{\\prime}, C Z^{\\prime}\\) intersect at the orthocenter of triangle \\(A B C\\).\nComment 2. The restriction that the line \\(\\ell\\) does not intersect the circumcricle \\(\\omega\\) is unnecessary. The proof above works in general. In case \\(\\ell\\) intersects \\(\\omega\\) at \\(D\\) and \\(E\\) point \\(P\\) is the midpoint of \\(D E\\), and some equations can be interpreted differently. For instance\n\n\\[\nX^{\\prime} P \\cdot X^{\\prime} X=X^{\\prime} A^{\\prime} \\cdot X^{\\prime} A=X^{\\prime} D \\cdot X^{\\prime} E,\n\\]\n\nand hence the pairs \\(X^{\\prime} X\\) and \\(D E\\) are harmonic conjugates. This means that \\(X^{\\prime}, Y^{\\prime}, Z^{\\prime}\\) are the harmonic conjugates of \\(X, Y, Z\\) with respect to the segment \\(D E\\).\n\nSolution 2. First we prove that there is an inversion in space that takes \\(\\ell\\) and \\(\\omega\\) to parallel circles on a sphere. Let \\(Q R\\) be the diameter of \\(\\omega\\) whose extension beyond \\(Q\\) passes through \\(P\\). Let \\(\\Pi\\) be the plane carrying our objects. In space, choose a point \\(O\\) such that the line \\(Q O\\) is perpendicular to \\(\\Pi\\) and \\(\\angle P O R=90^{\\circ}\\), and apply an inversion with pole \\(O\\) (the radius of the inversion does not matter). For any object \\(\\mathcal{T}\\) denote by \\(\\mathcal{T}^{\\prime}\\) the image of \\(\\mathcal{T}\\) under this inversion.\n\nThe inversion takes the plane \\(\\Pi\\) to a sphere \\(\\Pi^{\\prime}\\). The lines in \\(\\Pi\\) are taken to circles through \\(O\\), and the circles in \\(\\Pi\\) also are taken to circles on \\(\\Pi^{\\prime}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_6fdca1c2bf1a061018cfg-40}\n\nSince the line \\(\\ell\\) and the circle \\(\\omega\\) are perpendicular to the plane \\(O P Q\\), the circles \\(\\ell^{\\prime}\\) and \\(\\omega^{\\prime}\\) also are perpendicular to this plane. Hence, the planes of the circles \\(\\ell^{\\prime}\\) and \\(\\omega^{\\prime}\\) are parallel.\n\nNow consider the circles \\(A^{\\prime} X^{\\prime} P^{\\prime}, B^{\\prime} Y^{\\prime} P^{\\prime}\\) and \\(C^{\\prime} Z^{\\prime} P^{\\prime}\\). We want to prove that either they have a common point (on \\(\\Pi^{\\prime}\\) ), different from \\(P^{\\prime}\\), or they are tangent to each other.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_6fdca1c2bf1a061018cfg-40(1)}\n\nThe point \\(X^{\\prime}\\) is the second intersection of the circles \\(B^{\\prime} C^{\\prime} O\\) and \\(\\ell^{\\prime}\\), other than \\(O\\). Hence, the lines \\(O X^{\\prime}\\) and \\(B^{\\prime} C^{\\prime}\\) are coplanar. Moreover, they lie in the parallel planes of \\(\\ell^{\\prime}\\) and \\(\\omega^{\\prime}\\). Therefore, \\(O X^{\\prime}\\) and \\(B^{\\prime} C^{\\prime}\\) are parallel. Analogously, \\(O Y^{\\prime}\\) and \\(O Z^{\\prime}\\) are parallel to \\(A^{\\prime} C^{\\prime}\\) and \\(A^{\\prime} B^{\\prime}\\).\n\nLet \\(A_{1}\\) be the second intersection of the circles \\(A^{\\prime} X^{\\prime} P^{\\prime}\\) and \\(\\omega^{\\prime}\\), other than \\(A^{\\prime}\\). The segments \\(A^{\\prime} A_{1}\\) and \\(P^{\\prime} X^{\\prime}\\) are coplanar, and therefore parallel. Now we know that \\(B^{\\prime} C^{\\prime}\\) and \\(A^{\\prime} A_{1}\\) are parallel to \\(O X^{\\prime}\\) and \\(X^{\\prime} P^{\\prime}\\) respectively, but these two segments are perpendicular because \\(O P^{\\prime}\\) is a diameter in \\(\\ell^{\\prime}\\). We found that \\(A^{\\prime} A_{1}\\) and \\(B^{\\prime} C^{\\prime}\\) are perpendicular, hence \\(A^{\\prime} A_{1}\\) is the altitude in the triangle \\(A^{\\prime} B^{\\prime} C^{\\prime}\\), starting from \\(A\\).\n\nAnalogously, let \\(B_{1}\\) and \\(C_{1}\\) be the second intersections of \\(\\omega^{\\prime}\\) with the circles \\(B^{\\prime} P^{\\prime} Y^{\\prime}\\) and \\(C^{\\prime} P^{\\prime} Z^{\\prime}\\), other than \\(B^{\\prime}\\) and \\(C^{\\prime}\\) respectively. Then \\(B^{\\prime} B_{1}\\) and \\(C^{\\prime} C_{1}\\) are the other two altitudes in the triangle \\(A^{\\prime} B^{\\prime} C^{\\prime}\\).\n\nLet \\(H\\) be the orthocenter of the triangle \\(A^{\\prime} B^{\\prime} C^{\\prime}\\). Let \\(W\\) be the second intersection of the line \\(P^{\\prime} H\\) with the sphere \\(\\Pi^{\\prime}\\), other than \\(P^{\\prime}\\). The point \\(W\\) lies on the sphere \\(\\Pi^{\\prime}\\), in the plane of the circle \\(A^{\\prime} P^{\\prime} X^{\\prime}\\), so \\(W\\) lies on the circle \\(A^{\\prime} P^{\\prime} X^{\\prime}\\). Similarly, \\(W\\) lies on the circles \\(B^{\\prime} P^{\\prime} Y^{\\prime}\\) and \\(C^{\\prime} P^{\\prime} Z^{\\prime}\\) as well; indeed \\(W\\) is the second common point of the three circles.\n\nIf the line \\(P^{\\prime} H\\) is tangent to the sphere then \\(W\\) coincides with \\(P^{\\prime}\\), and \\(P^{\\prime} H\\) is the common tangent of the three circles."}
{"id": "imo-shortlist-2012-n1", "question": "N1. Call admissible a set \\(A\\) of integers that has the following property:\nIf \\(x, y \\in A\\) (possibly \\(x=y\\) ) then \\(x^{2}+k x y+y^{2} \\in A\\) for every integer \\(k\\).\nDetermine all pairs \\(m, n\\) of nonzero integers such that the only admissible set containing both \\(m\\) and \\(n\\) is the set of all integers.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2012, "solution": "A pair of integers \\(m, n\\) fulfills the condition if and only if \\(\\operatorname{gcd}(m, n)=1\\). Suppose that \\(\\operatorname{gcd}(m, n)=d>1\\). The set\n\n\\[\nA=\\{\\ldots,-2 d,-d, 0, d, 2 d, \\ldots\\}\n\\]\n\nis admissible, because if \\(d\\) divides \\(x\\) and \\(y\\) then it divides \\(x^{2}+k x y+y^{2}\\) for every integer \\(k\\). Also \\(m, n \\in A\\) and \\(A \\neq \\mathbb{Z}\\).\n\nNow let \\(\\operatorname{gcd}(m, n)=1\\), and let \\(A\\) be an admissible set containing \\(m\\) and \\(n\\). We use the following observations to prove that \\(A=\\mathbb{Z}\\) :\n(i) \\(k x^{2} \\in A\\) for every \\(x \\in A\\) and every integer \\(k\\).\n(ii) \\((x+y)^{2} \\in A\\) for all \\(x, y \\in A\\).\n\nTo justify (i) let \\(y=x\\) in the definition of an admissible set; to justify (ii) let \\(k=2\\).\nSince \\(\\operatorname{gcd}(m, n)=1\\), we also have \\(\\operatorname{gcd}\\left(m^{2}, n^{2}\\right)=1\\). Hence one can find integers \\(a, b\\) such that \\(a m^{2}+b n^{2}=1\\). It follows from (i) that \\(a m^{2} \\in A\\) and \\(b n^{2} \\in A\\). Now we deduce from (ii) that \\(1=\\left(a m^{2}+b n^{2}\\right)^{2} \\in A\\). But if \\(1 \\in A\\) then (i) implies \\(k \\in A\\) for every integer \\(k\\)."}
{"id": "imo-shortlist-2012-n2", "question": "N2. Find all triples ( \\(x, y, z\\) ) of positive integers such that \\(x \\leq y \\leq z\\) and\n\n\\[\nx^{3}\\left(y^{3}+z^{3}\\right)=2012(x y z+2) .\n\\]", "category": "Number Theory", "source": "IMO Shortlist", "year": 2012, "solution": "First note that \\(x\\) divides \\(2012 \\cdot 2=2^{3} \\cdot 503\\). If \\(503 \\mid x\\) then the right-hand side of the equation is divisible by \\(503^{3}\\), and it follows that \\(503^{2} \\mid x y z+2\\). This is false as \\(503 \\mid x\\). Hence \\(x=2^{m}\\) with \\(m \\in\\{0,1,2,3\\}\\). If \\(m \\geq 2\\) then \\(2^{6} \\mid 2012(x y z+2)\\). However the highest powers of 2 dividing 2012 and \\(x y z+2=2^{m} y z+2\\) are \\(2^{2}\\) and \\(2^{1}\\) respectively. So \\(x=1\\) or \\(x=2\\), yielding the two equations\n\n\\[\ny^{3}+z^{3}=2012(y z+2), \\quad \\text { and } \\quad y^{3}+z^{3}=503(y z+1)\n\\]\n\nIn both cases the prime \\(503=3 \\cdot 167+2\\) divides \\(y^{3}+z^{3}\\). We claim that \\(503 \\mid y+z\\). This is clear if \\(503 \\mid y\\), so let \\(503 \\nmid y\\) and \\(503 \\nmid z\\). Then \\(y^{502} \\equiv z^{502}(\\bmod 503)\\) by Fermat's little theorem. On the other hand \\(y^{3} \\equiv-z^{3}(\\bmod 503)\\) implies \\(y^{3 \\cdot 167} \\equiv-z^{3 \\cdot 167}(\\bmod 503)\\), i. e. \\(y^{501} \\equiv-z^{501}(\\bmod 503)\\). It follows that \\(y \\equiv-z(\\bmod 503)\\) as claimed.\n\nTherefore \\(y+z=503 k\\) with \\(k \\geq 1\\). In view of \\(y^{3}+z^{3}=(y+z)\\left((y-z)^{2}+y z\\right)\\) the two equations take the form\n\n\\[\n\\begin{aligned}\n& k(y-z)^{2}+(k-4) y z=8 \n& k(y-z)^{2}+(k-1) y z=1\n\n\\]\n\nIn (1) we have \\((k-4) y z \\leq 8\\), which implies \\(k \\leq 4\\). Indeed if \\(k>4\\) then \\(1 \\leq(k-4) y z \\leq 8\\), so that \\(y \\leq 8\\) and \\(z \\leq 8\\). This is impossible as \\(y+z=503 k \\geq 503\\). Note next that \\(y^{3}+z^{3}\\) is even in the first equation. Hence \\(y+z=503 k\\) is even too, meaning that \\(k\\) is even. Thus \\(k=2\\) or \\(k=4\\). Clearly (1) has no integer solutions for \\(k=4\\). If \\(k=2\\) then (1) takes the form \\((y+z)^{2}-5 y z=4\\). Since \\(y+z=503 k=503 \\cdot 2\\), this leads to \\(5 y z=503^{2} \\cdot 2^{2}-4\\). However \\(503^{2} \\cdot 2^{2}-4\\) is not a multiple of 5 . Therefore (1) has no integer solutions.\n\nEquation (2) implies \\(0 \\leq(k-1) y z \\leq 1\\), so that \\(k=1\\) or \\(k=2\\). Also \\(0 \\leq k(y-z)^{2} \\leq 1\\), hence \\(k=2\\) only if \\(y=z\\). However then \\(y=z=1\\), which is false in view of \\(y+z \\geq 503\\). Therefore \\(k=1\\) and (2) takes the form \\((y-z)^{2}=1\\), yielding \\(z-y=|y-z|=1\\). Combined with \\(k=1\\) and \\(y+z=503 k\\), this leads to \\(y=251, z=252\\).\n\nIn summary the triple \\((2,251,252)\\) is the only solution."}
{"id": "imo-shortlist-2012-n3", "question": "N3. Determine all integers \\(m \\geq 2\\) such that every \\(n\\) with \\(\\frac{m}{3} \\leq n \\leq \\frac{m}{2}\\) divides the binomial coefficient \\(\\binom{n}{m-2 n}\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2012, "solution": "The integers in question are all prime numbers.\nFirst we check that all primes satisfy the condition, and even a stronger one. Namely, if \\(p\\) is a prime then every \\(n\\) with \\(1 \\leq n \\leq \\frac{p}{2}\\) divides \\(\\binom{n}{p-2 n}\\). This is true for \\(p=2\\) where \\(n=1\\) is the only possibility. For an odd prime \\(p\\) take \\(n \\in\\left[1, \\frac{p}{2}\\right]\\) and consider the following identity of binomial coefficients:\n\n\\[\n(p-2 n) \\cdot\\binom{n}{p-2 n}=n \\cdot\\binom{n-1}{p-2 n-1}\n\\]\n\nSince \\(p \\geq 2 n\\) and \\(p\\) is odd, all factors are non-zero. If \\(d=\\operatorname{gcd}(p-2 n, n)\\) then \\(d\\) divides \\(p\\), but \\(d \\leq n<p\\) and hence \\(d=1\\). It follows that \\(p-2 n\\) and \\(n\\) are relatively prime, and so the factor \\(n\\) in the right-hand side divides the binomial coefficient \\(\\binom{n}{p-2 n}\\).\n\nNext we show that no composite number \\(m\\) has the stated property. Consider two cases.\n\n\\begin{itemize}\n  \\item If \\(m=2 k\\) with \\(k>1\\), pick \\(n=k\\). Then \\(\\frac{m}{3} \\leq n \\leq \\frac{m}{2}\\) but \\(\\binom{n}{m-2 n}=\\binom{k}{0}=1\\) is not divisible by \\(k>1\\).\n  \\item If \\(m\\) is odd then there exist an odd prime \\(p\\) and an integer \\(k \\geq 1\\) with \\(m=p(2 k+1)\\). Pick \\(n=p k\\), then \\(\\frac{m}{3} \\leq n \\leq \\frac{m}{2}\\) by \\(k \\geq 1\\). However\n\n\n\\[\n\\frac{1}{n}\\binom{n}{m-2 n}=\\frac{1}{p k}\\binom{p k}{p}=\\frac{(p k-1)(p k-2) \\cdots(p k-(p-1))}{p!}\n\\]\n\nis not an integer, because \\(p\\) divides the denominator but not the numerator."}
{"id": "imo-shortlist-2012-n4", "question": "N4. An integer \\(a\\) is called friendly if the equation \\(\\left(m^{2}+n\\right)\\left(n^{2}+m\\right)=a(m-n)^{3}\\) has a", "category": "Number Theory", "source": "IMO Shortlist", "year": 2012, "solution": "over the positive integers.\na) Prove that there are at least 500 friendly integers in the set \\(\\{1,2, \\ldots, 2012\\}\\).\nb) Decide whether \\(a=2\\) is friendly.\n\nSolution. a) Every \\(a\\) of the form \\(a=4 k-3\\) with \\(k \\geq 2\\) is friendly. Indeed the numbers \\(m=2 k-1>0\\) and \\(n=k-1>0\\) satisfy the given equation with \\(a=4 k-3\\) :\n\n\\[\n\\left(m^{2}+n\\right)\\left(n^{2}+m\\right)=\\left((2 k-1)^{2}+(k-1)\\right)\\left((k-1)^{2}+(2 k-1)\\right)=(4 k-3) k^{3}=a(m-n)^{3} .\n\\]\n\nHence \\(5,9, \\ldots, 2009\\) are friendly and so \\(\\{1,2, \\ldots, 2012\\}\\) contains at least 502 friendly numbers.\nb) We show that \\(a=2\\) is not friendly. Consider the equation with \\(a=2\\) and rewrite its left-hand side as a difference of squares:\n\n\\[\n\\frac{1}{4}\\left(\\left(m^{2}+n+n^{2}+m\\right)^{2}-\\left(m^{2}+n-n^{2}-m\\right)^{2}\\right)=2(m-n)^{3}\n\\]\n\nSince \\(m^{2}+n-n^{2}-m=(m-n)(m+n-1)\\), we can further reformulate the equation as\n\n\\[\n\\left(m^{2}+n+n^{2}+m\\right)^{2}=(m-n)^{2}\\left(8(m-n)+(m+n-1)^{2}\\right)\n\\]\n\nIt follows that \\(8(m-n)+(m+n-1)^{2}\\) is a perfect square. Clearly \\(m>n\\), hence there is an integer \\(s \\geq 1\\) such that\n\n\\[\n(m+n-1+2 s)^{2}=8(m-n)+(m+n-1)^{2} .\n\\]\n\nSubtracting the squares gives \\(s(m+n-1+s)=2(m-n)\\). Since \\(m+n-1+s>m-n\\), we conclude that \\(s<2\\). Therefore the only possibility is \\(s=1\\) and \\(m=3 n\\). However then the left-hand side of the given equation (with \\(a=2\\) ) is greater than \\(m^{3}=27 n^{3}\\), whereas its right-hand side equals \\(16 n^{3}\\). The contradiction proves that \\(a=2\\) is not friendly.\n\nComment. A computer search shows that there are 561 friendly numbers in \\(\\{1,2, \\ldots, 2012\\}\\)."}
{"id": "imo-shortlist-2012-n5", "question": "N5. For a nonnegative integer \\(n\\) define \\(\\operatorname{rad}(n)=1\\) if \\(n=0\\) or \\(n=1\\), and \\(\\operatorname{rad}(n)=p_{1} p_{2} \\cdots p_{k}\\) where \\(p_{1}<p_{2}<\\cdots<p_{k}\\) are all prime factors of \\(n\\). Find all polynomials \\(f(x)\\) with nonnegative integer coefficients such that \\(\\operatorname{rad}(f(n))\\) divides \\(\\operatorname{rad}\\left(f\\left(n^{\\operatorname{rad}(n)}\\right)\\right)\\) for every nonnegative integer \\(n\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2012, "solution": "We are going to prove that \\(f(x)=a x^{m}\\) for some nonnegative integers \\(a\\) and \\(m\\). If \\(f(x)\\) is the zero polynomial we are done, so assume that \\(f(x)\\) has at least one positive coefficient. In particular \\(f(1)>0\\).\n\nLet \\(p\\) be a prime number. The condition is that \\(f(n) \\equiv 0(\\bmod p)\\) implies\n\n\\[\nf\\left(n^{\\operatorname{rad}(n)}\\right) \\equiv 0 \\quad(\\bmod p)\n\\]\n\nSince \\(\\operatorname{rad}\\left(n^{\\operatorname{rad}(n)^{k}}\\right)=\\operatorname{rad}(n)\\) for all \\(k\\), repeated applications of the preceding implication show that if \\(p\\) divides \\(f(n)\\) then\n\n\\[\nf\\left(n^{\\operatorname{rad}(n)^{k}}\\right) \\equiv 0 \\quad(\\bmod p) \\quad \\text { for all } k .\n\\]\n\nThe idea is to construct a prime \\(p\\) and a positive integer \\(n\\) such that \\(p-1\\) divides \\(n\\) and \\(p\\) divides \\(f(n)\\). In this case, for \\(k\\) large enough \\(p-1\\) divides \\(\\operatorname{rad}(n)^{k}\\). Hence if \\((p, n)=1\\) then \\(n^{\\operatorname{rad}(n)^{k}} \\equiv 1(\\bmod p)\\) by Fermat's little theorem, so that\n\n\\[\nf(1) \\equiv f\\left(n^{\\operatorname{rad}(n)^{k}}\\right) \\equiv 0 \\quad(\\bmod p)\n\\]\n\nSuppose that \\(f(x)=g(x) x^{m}\\) with \\(g(0) \\neq 0\\). Let \\(t\\) be a positive integer, \\(p\\) any prime factor of \\(g(-t)\\) and \\(n=(p-1) t\\). So \\(p-1\\) divides \\(n\\) and \\(f(n)=f((p-1) t) \\equiv f(-t) \\equiv 0(\\bmod p)\\), hence either \\((p, n)>1\\) or (2) holds. If \\((p,(p-1) t)>1\\) then \\(p\\) divides \\(t\\) and \\(g(0) \\equiv g(-t) \\equiv 0(\\bmod p)\\), meaning that \\(p\\) divides \\(g(0)\\).\n\nIn conclusion we proved that each prime factor of \\(g(-t)\\) divides \\(g(0) f(1) \\neq 0\\), and thus the set of prime factors of \\(g(-t)\\) when \\(t\\) ranges through the positive integers is finite. This is known to imply that \\(g(x)\\) is a constant polynomial, and so \\(f(x)=a x^{m}\\).\n\nSolution 2. Let \\(f(x)\\) be a polynomial with integer coefficients (not necessarily nonnegative) such that \\(\\operatorname{rad}(f(n))\\) divides \\(\\operatorname{rad}\\left(f\\left(n^{\\operatorname{rad}(n)}\\right)\\right)\\) for any nonnegative integer \\(n\\). We give a complete description of all polynomials with this property. More precisely, we claim that if \\(f(x)\\) is such a polynomial and \\(\\xi\\) is a root of \\(f(x)\\) then so is \\(\\xi^{d}\\) for every positive integer \\(d\\).\n\nTherefore each root of \\(f(x)\\) is zero or a root of unity. In particular, if a root of unity \\(\\xi\\) is a root of \\(f(x)\\) then \\(1=\\xi^{d}\\) is a root too (for some positive integer \\(d\\) ). In the original problem \\(f(x)\\) has nonnegative coefficients. Then either \\(f(x)\\) is the zero polynomial or \\(f(1)>0\\) and \\(\\xi=0\\) is the only possible root. In either case \\(f(x)=a x^{m}\\) with \\(a\\) and \\(m\\) nonnegative integers.\n\nTo prove the claim let \\(\\xi\\) be a root of \\(f(x)\\), and let \\(g(x)\\) be an irreducible factor of \\(f(x)\\) such that \\(g(\\xi)=0\\). If 0 or 1 are roots of \\(g(x)\\) then either \\(\\xi=0\\) or \\(\\xi=1\\) (because \\(g(x)\\) is irreducible) and we are done. So assume that \\(g(0), g(1) \\neq 0\\). By decomposing \\(d\\) as a product of prime numbers, it is enough to consider the case \\(d=p\\) prime. We argue for \\(p=2\\). Since \\(\\operatorname{rad}\\left(2^{k}\\right)=2\\) for every \\(k\\), we have\n\n\\[\n\\operatorname{rad}\\left(f\\left(2^{k}\\right)\\right) \\mid \\operatorname{rad}\\left(f\\left(2^{2 k}\\right)\\right)\n\\]\n\nNow we prove that \\(g(x)\\) divides \\(f\\left(x^{2}\\right)\\). Suppose that this is not the case. Then, since \\(g(x)\\) is irreducible, there are integer-coefficient polynomials \\(a(x), b(x)\\) and an integer \\(N\\) such that\n\n\\[\na(x) g(x)+b(x) f\\left(x^{2}\\right)=N\n\\]\n\nEach prime factor \\(p\\) of \\(g\\left(2^{k}\\right)\\) divides \\(f\\left(2^{k}\\right)\\), so by \\(\\operatorname{rad}\\left(f\\left(2^{k}\\right)\\right) \\mid \\operatorname{rad}\\left(f\\left(2^{2 k}\\right)\\right)\\) it also divides \\(f\\left(2^{2 k}\\right)\\). From the equation above with \\(x=2^{k}\\) it follows that \\(p\\) divides \\(N\\).\n\nIn summary, each prime divisor of \\(g\\left(2^{k}\\right)\\) divides \\(N\\), for all \\(k \\geq 0\\). Let \\(p_{1}, \\ldots, p_{n}\\) be the odd primes dividing \\(N\\), and suppose that\n\n\\[\ng(1)=2^{\\alpha} p_{1}^{\\alpha_{1}} \\cdots p_{n}^{\\alpha_{n}}\n\\]\n\nIf \\(k\\) is divisible by \\(\\varphi\\left(p_{1}^{\\alpha_{1}+1} \\cdots p_{n}^{\\alpha_{n}+1}\\right)\\) then\n\n\\[\n2^{k} \\equiv 1 \\quad\\left(\\bmod p_{1}^{\\alpha_{1}+1} \\cdots p_{n}^{\\alpha_{n}+1}\\right)\n\\]\n\nyielding\n\n\\[\ng\\left(2^{k}\\right) \\equiv g(1) \\quad\\left(\\bmod p_{1}^{\\alpha_{1}+1} \\cdots p_{n}^{\\alpha_{n}+1}\\right)\n\\]\n\nIt follows that for each \\(i\\) the maximal power of \\(p_{i}\\) dividing \\(g\\left(2^{k}\\right)\\) and \\(g(1)\\) is the same, namely \\(p_{i}^{\\alpha_{i}}\\). On the other hand, for large enough \\(k\\), the maximal power of 2 dividing \\(g\\left(2^{k}\\right)\\) and \\(g(0) \\neq 0\\) is the same. From the above, for \\(k\\) divisible by \\(\\varphi\\left(p_{1}^{\\alpha_{1}+1} \\cdots p_{n}^{\\alpha_{n}+1}\\right)\\) and large enough, we obtain that \\(g\\left(2^{k}\\right)\\) divides \\(g(0) \\cdot g(1)\\). This is impossible because \\(g(0), g(1) \\neq 0\\) are fixed and \\(g\\left(2^{k}\\right)\\) is arbitrarily large.\n\nIn conclusion, \\(g(x)\\) divides \\(f\\left(x^{2}\\right)\\). Recall that \\(\\xi\\) is a root of \\(f(x)\\) such that \\(g(\\xi)=0\\); then \\(f\\left(\\xi^{2}\\right)=0\\), i. e. \\(\\xi^{2}\\) is a root of \\(f(x)\\).\n\nLikewise if \\(\\xi\\) is a root of \\(f(x)\\) and \\(p\\) an arbitrary prime then \\(\\xi^{p}\\) is a root too. The argument is completely analogous, in the proof above just replace 2 by \\(p\\) and \"odd prime\" by \"prime different from \\(p\\).\"\n\nComment. The claim in the second solution can be proved by varying \\(n(\\bmod p)\\) in (1). For instance, we obtain\n\n\\[\nf\\left(n^{r a d(n+p k)}\\right) \\equiv 0 \\quad(\\bmod p)\n\\]\n\nfor every positive integer \\(k\\). One can prove that if ( \\(n, p\\) ) \\(=1\\) then \\(\\operatorname{rad}(n+p k)\\) runs through all residue classes \\(r(\\bmod p-1)\\) with \\((r, p-1)\\) squarefree. Hence if \\(f(n) \\equiv 0(\\bmod p)\\) then \\(f\\left(n^{r}\\right) \\equiv 0(\\bmod p)\\) for all integers \\(r\\). This implies the claim by an argument leading to the identity (3)."}
{"id": "imo-shortlist-2012-n6", "question": "N6. Let \\(x\\) and \\(y\\) be positive integers. If \\(x^{2^{n}}-1\\) is divisible by \\(2^{n} y+1\\) for every positive integer \\(n\\), prove that \\(x=1\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2012, "solution": "First we prove the following fact: For every positive integer \\(y\\) there exist infinitely many primes \\(p \\equiv 3(\\bmod 4)\\) such that \\(p\\) divides some number of the form \\(2^{n} y+1\\).\n\nClearly it is enough to consider the case \\(y\\) odd. Let\n\n\\[\n2 y+1=p_{1}^{e_{1}} \\cdots p_{r}^{e_{r}}\n\\]\n\nbe the prime factorization of \\(2 y+1\\). Suppose on the contrary that there are finitely many primes \\(p_{r+1}, \\ldots, p_{r+s} \\equiv 3(\\bmod 4)\\) that divide some number of the form \\(2^{n} y+1\\) but do not divide \\(2 y+1\\).\n\nWe want to find an \\(n\\) such that \\(p_{i}^{e_{i}} \\| 2^{n} y+1\\) for \\(1 \\leq i \\leq r\\) and \\(p_{i} \\nmid 2^{n} y+1\\) for \\(r+1 \\leq i \\leq r+s\\). For this it suffices to take\n\n\\[\nn=1+\\varphi\\left(p_{1}^{e_{1}+1} \\cdots p_{r}^{e_{r}+1} p_{r+1}^{1} \\cdots p_{r+s}^{1}\\right)\n\\]\n\nbecause then\n\n\\[\n2^{n} y+1 \\equiv 2 y+1 \\quad\\left(\\bmod p_{1}^{e_{1}+1} \\cdots p_{r}^{e_{r}+1} p_{r+1}^{1} \\cdots p_{r+s}^{1}\\right)\n\\]\n\nThe last congruence means that \\(p_{1}^{e_{1}}, \\ldots, p_{r}^{e_{r}}\\) divide exactly \\(2^{n} y+1\\) and no prime \\(p_{r+1}, \\ldots, p_{r+s}\\) divides \\(2^{n} y+1\\). It follows that the prime factorization of \\(2^{n} y+1\\) consists of the prime powers \\(p_{1}^{e_{1}}, \\ldots, p_{r}^{e_{r}}\\) and powers of primes \\(\\equiv 1(\\bmod 4)\\). Because \\(y\\) is odd, we obtain\n\n\\[\n2^{n} y+1 \\equiv p_{1}^{e_{1}} \\cdots p_{r}^{e_{r}} \\equiv 2 y+1 \\equiv 3 \\quad(\\bmod 4)\n\\]\n\nThis is a contradiction since \\(n>1\\), and so \\(2^{n} y+1 \\equiv 1(\\bmod 4)\\).\nNow we proceed to the problem. If \\(p\\) is a prime divisor of \\(2^{n} y+1\\) the problem statement implies that \\(x^{d} \\equiv 1(\\bmod p)\\) for \\(d=2^{n}\\). By Fermat's little theorem the same congruence holds for \\(d=p-1\\), so it must also hold for \\(d=\\left(2^{n}, p-1\\right)\\). For \\(p \\equiv 3(\\bmod 4)\\) we have \\(\\left(2^{n}, p-1\\right)=2\\), therefore in this case \\(x^{2} \\equiv 1(\\bmod p)\\).\n\nIn summary, we proved that every prime \\(p \\equiv 3(\\bmod 4)\\) that divides some number of the form \\(2^{n} y+1\\) also divides \\(x^{2}-1\\). This is possible only if \\(x=1\\), otherwise by the above \\(x^{2}-1\\) would be a positive integer with infinitely many prime factors.\n\nComment. For each \\(x\\) and each odd prime \\(p\\) the maximal power of \\(p\\) dividing \\(x^{2^{n}}-1\\) for some \\(n\\) is bounded and hence the same must be true for the numbers \\(2^{n} y+1\\). We infer that \\(p^{2}\\) divides \\(2^{p-1}-1\\) for each prime divisor \\(p\\) of \\(2^{n} y+1\\). However trying to reach a contradiction with this conclusion alone seems hopeless, since it is not even known if there are infinitely many primes \\(p\\) without this property."}
{"id": "imo-shortlist-2012-n7", "question": "N7. Find all \\(n \\in \\mathbb{N}\\) for which there exist nonnegative integers \\(a_{1}, a_{2}, \\ldots, a_{n}\\) such that\n\n\\[\n\\frac{1}{2^{a_{1}}}+\\frac{1}{2^{a_{2}}}+\\cdots+\\frac{1}{2^{a_{n}}}=\\frac{1}{3^{a_{1}}}+\\frac{2}{3^{a_{2}}}+\\cdots+\\frac{n}{3^{a_{n}}}=1 .\n\\]", "category": "Number Theory", "source": "IMO Shortlist", "year": 2012, "solution": "Such numbers \\(a_{1}, a_{2}, \\ldots, a_{n}\\) exist if and only if \\(n \\equiv 1(\\bmod 4)\\) or \\(n \\equiv 2(\\bmod 4)\\).\nLet \\(\\sum_{k=1}^{n} \\frac{k}{3^{a} k}=1\\) with \\(a_{1}, a_{2}, \\ldots, a_{n}\\) nonnegative integers. Then \\(1 \\cdot x_{1}+2 \\cdot x_{2}+\\cdots+n \\cdot x_{n}=3^{a}\\) with \\(x_{1}, \\ldots, x_{n}\\) powers of 3 and \\(a \\geq 0\\). The right-hand side is odd, and the left-hand side has the same parity as \\(1+2+\\cdots+n\\). Hence the latter sum is odd, which implies \\(n \\equiv 1,2(\\bmod 4)\\). Now we prove the converse.\n\nCall feasible a sequence \\(b_{1}, b_{2}, \\ldots, b_{n}\\) if there are nonnegative integers \\(a_{1}, a_{2}, \\ldots, a_{n}\\) such that\n\n\\[\n\\frac{1}{2^{a_{1}}}+\\frac{1}{2^{a_{2}}}+\\cdots+\\frac{1}{2^{a_{n}}}=\\frac{b_{1}}{3^{a_{1}}}+\\frac{b_{2}}{3^{a_{2}}}+\\cdots+\\frac{b_{n}}{3^{a_{n}}}=1\n\\]\n\nLet \\(b_{k}\\) be a term of a feasible sequence \\(b_{1}, b_{2}, \\ldots, b_{n}\\) with exponents \\(a_{1}, a_{2}, \\ldots, a_{n}\\) like above, and let \\(u, v\\) be nonnegative integers with sum \\(3 b_{k}\\). Observe that\n\n\\[\n\\frac{1}{2^{a_{k}+1}}+\\frac{1}{2^{a_{k}+1}}=\\frac{1}{2^{a_{k}}} \\quad \\text { and } \\quad \\frac{u}{3^{a_{k}+1}}+\\frac{v}{3^{a_{k}+1}}=\\frac{b_{k}}{3^{a_{k}}}\n\\]\n\nIt follows that the sequence \\(b_{1}, \\ldots, b_{k-1}, u, v, b_{k+1}, \\ldots, b_{n}\\) is feasible. The exponents \\(a_{i}\\) are the same for the unchanged terms \\(b_{i}, i \\neq k\\); the new terms \\(u, v\\) have exponents \\(a_{k}+1\\).\n\nWe state the conclusion in reverse. If two terms \\(u, v\\) of a sequence are replaced by one term \\(\\frac{u+v}{3}\\) and the obtained sequence is feasible, then the original sequence is feasible too. Denote by \\(\\alpha_{n}\\) the sequence \\(1,2, \\ldots, n\\). To show that \\(\\alpha_{n}\\) is feasible for \\(n \\equiv 1,2(\\bmod 4)\\), we transform it by \\(n-1\\) replacements \\(\\{u, v\\} \\mapsto \\frac{u+v}{3}\\) to the one-term sequence \\(\\alpha_{1}\\). The latter is feasible, with \\(a_{1}=0\\). Note that if \\(m\\) and \\(2 m\\) are terms of a sequence then \\(\\{m, 2 m\\} \\mapsto m\\), so \\(2 m\\) can be ignored if necessary.\n\nLet \\(n \\geq 16\\). We prove that \\(\\alpha_{n}\\) can be reduced to \\(\\alpha_{n-12}\\) by 12 operations. Write \\(n=12 k+r\\) where \\(k \\geq 1\\) and \\(0 \\leq r \\leq 11\\). If \\(0 \\leq r \\leq 5\\) then the last 12 terms of \\(\\alpha_{n}\\) can be partitioned into 2 singletons \\(\\{12 k-6\\},\\{12 k\\}\\) and the following 5 pairs:\n\n\\[\n\\{12 k-6-i, 12 k-6+i\\}, i=1, \\ldots, 5-r ; \\quad\\{12 k-j, 12 k+j\\}, j=1, \\ldots, r\n\\]\n\n(There is only one kind of pairs if \\(r \\in\\{0,5\\}\\).) One can ignore \\(12 k-6\\) and \\(12 k\\) since \\(\\alpha_{n}\\) contains \\(6 k-3\\) and \\(6 k\\). Furthermore the 5 operations \\(\\{12 k-6-i, 12 k-6+i\\} \\mapsto 8 k-4\\) and \\(\\{12 k-j, 12 k+j\\} \\mapsto 8 k\\) remove the 10 terms in the pairs and bring in 5 new terms equal to \\(8 k-4\\) or \\(8 k\\). All of these can be ignored too as \\(4 k-2\\) and \\(4 k\\) are still present in the sequence. Indeed \\(4 k \\leq n-12\\) is equivalent to \\(8 k \\geq 12-r\\), which is true for \\(r \\in\\{4,5\\}\\). And if \\(r \\in\\{0,1,2,3\\}\\) then \\(n \\geq 16\\) implies \\(k \\geq 2\\), so \\(8 k \\geq 12-r\\) also holds. Thus \\(\\alpha_{n}\\) reduces to \\(\\alpha_{n-12}\\).\n\nThe case \\(6 \\leq r \\leq 11\\) is analogous. Consider the singletons \\(\\{12 k\\},\\{12 k+6\\}\\) and the 5 pairs\n\n\\[\n\\{12 k-i, 12 k+i\\}, i=1, \\ldots, 11-r ; \\quad\\{12 k+6-j, 12 k+6+j\\}, j=1, \\ldots, r-6\n\\]\n\nIgnore the singletons like before, then remove the pairs via operations \\(\\{12 k-i, 12 k+i\\} \\mapsto 8 k\\) and \\(\\{12 k+6-j, 12 k+6+j\\} \\mapsto 8 k+4\\). The 5 newly-appeared terms \\(8 k\\) and \\(8 k+4\\) can be ignored too since \\(4 k+2 \\leq n-12\\) (this follows from \\(k \\geq 1\\) and \\(r \\geq 6\\) ). We obtain \\(\\alpha_{n-12}\\) again.\n\nThe problem reduces to \\(2 \\leq n \\leq 15\\). In fact \\(n \\in\\{2,5,6,9,10,13,14\\}\\) by \\(n \\equiv 1,2(\\bmod 4)\\). The cases \\(n=2,6,10,14\\) reduce to \\(n=1,5,9,13\\) respectively because the last even term of \\(\\alpha_{n}\\) can be ignored. For \\(n=5\\) apply \\(\\{4,5\\} \\mapsto 3\\), then \\(\\{3,3\\} \\mapsto 2\\), then ignore the 2 occurrences of 2 . For \\(n=9\\) ignore 6 first, then apply \\(\\{5,7\\} \\mapsto 4,\\{4,8\\} \\mapsto 4,\\{3,9\\} \\mapsto 4\\). Now ignore the 3 occurrences of 4 , then ignore 2 . Finally \\(n=13\\) reduces to \\(n=10\\) by \\(\\{11,13\\} \\mapsto 8\\) and ignoring 8 and 12 . The proof is complete."}
{"id": "imo-shortlist-2012-n8", "question": "N8. Prove that for every prime \\(p>100\\) and every integer \\(r\\) there exist two integers \\(a\\) and \\(b\\) such that \\(p\\) divides \\(a^{2}+b^{5}-r\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2012, "solution": "Throughout the solution, all congruence relations are meant modulo \\(p\\).\nFix \\(p\\), and let \\(\\mathcal{P}=\\{0,1, \\ldots, p-1\\}\\) be the set of residue classes modulo \\(p\\). For every \\(r \\in \\mathcal{P}\\), let \\(S_{r}=\\left\\{(a, b) \\in \\mathcal{P} \\times \\mathcal{P}: a^{2}+b^{5} \\equiv r\\right\\}\\), and let \\(s_{r}=\\left|S_{r}\\right|\\). Our aim is to prove \\(s_{r}>0\\) for all \\(r \\in \\mathcal{P}\\).\n\nWe will use the well-known fact that for every residue class \\(r \\in \\mathcal{P}\\) and every positive integer \\(k\\), there are at most \\(k\\) values \\(x \\in \\mathcal{P}\\) such that \\(x^{k} \\equiv r\\).\nLemma. Let \\(N\\) be the number of quadruples \\((a, b, c, d) \\in \\mathcal{P}^{4}\\) for which \\(a^{2}+b^{5} \\equiv c^{2}+d^{5}\\). Then\n\n\\[\nN=\\sum_{r \\in \\mathcal{P}} s_{r}^{2}\n\\]\n\nand\n\n\\[\nN \\leq p\\left(p^{2}+4 p-4\\right)\n\\]\n\nProof. (a) For each residue class \\(r\\) there exist exactly \\(s_{r}\\) pairs \\((a, b)\\) with \\(a^{2}+b^{5} \\equiv r\\) and \\(s_{r}\\) pairs ( \\(c, d\\) ) with \\(c^{2}+d^{5} \\equiv r\\). So there are \\(s_{r}^{2}\\) quadruples with \\(a^{2}+b^{5} \\equiv c^{2}+d^{5} \\equiv r\\). Taking the sum over all \\(r \\in \\mathcal{P}\\), the statement follows.\n(b) Choose an arbitrary pair \\((b, d) \\in \\mathcal{P}\\) and look for the possible values of \\(a, c\\).\n\n\\begin{enumerate}\n  \\item Suppose that \\(b^{5} \\equiv d^{5}\\), and let \\(k\\) be the number of such pairs ( \\(b, d\\) ). The value \\(b\\) can be chosen in \\(p\\) different ways. For \\(b \\equiv 0\\) only \\(d=0\\) has this property; for the nonzero values of \\(b\\) there are at most 5 possible values for \\(d\\). So we have \\(k \\leq 1+5(p-1)=5 p-4\\).\n\n\nThe values \\(a\\) and \\(c\\) must satisfy \\(a^{2} \\equiv c^{2}\\), so \\(a \\equiv \\pm c\\), and there are exactly \\(2 p-1\\) such pairs \\((a, c)\\).\n2. Now suppose \\(b^{5} \\not \\equiv d^{5}\\). In this case \\(a\\) and \\(c\\) must be distinct. By \\((a-c)(a+c)=d^{5}-b^{5}\\), the value of \\(a-c\\) uniquely determines \\(a+c\\) and thus \\(a\\) and \\(c\\) as well. Hence, there are \\(p-1\\) suitable pairs \\((a, c)\\).\n\nThus, for each of the \\(k\\) pairs ( \\(b, d\\) ) with \\(b^{5} \\equiv d^{5}\\) there are \\(2 p-1\\) pairs ( \\(a, c\\) ), and for each of the other \\(p^{2}-k\\) pairs ( \\(b, d\\) ) there are \\(p-1\\) pairs ( \\(a, c\\) ). Hence,\n\n\\[\nN=k(2 p-1)+\\left(p^{2}-k\\right)(p-1)=p^{2}(p-1)+k p \\leq p^{2}(p-1)+(5 p-4) p=p\\left(p^{2}+4 p-4\\right)\n\\]\n\nTo prove the statement of the problem, suppose that \\(S_{r}=\\emptyset\\) for some \\(r \\in \\mathcal{P}\\); obviously \\(r \\not \\equiv 0\\). Let \\(T=\\left\\{x^{10}: x \\in \\mathcal{P} \\backslash\\{0\\}\\right\\}\\) be the set of nonzero 10th powers modulo \\(p\\). Since each residue class is the 10 th power of at most 10 elements in \\(\\mathcal{P}\\), we have \\(|T| \\geq \\frac{p-1}{10} \\geq 4\\) by \\(p>100\\).\n\nFor every \\(t \\in T\\), we have \\(S_{t r}=\\emptyset\\). Indeed, if \\((x, y) \\in S_{t r}\\) and \\(t \\equiv z^{10}\\) then\n\n\\[\n\\left(z^{-5} x\\right)^{2}+\\left(z^{-2} y\\right)^{5} \\equiv t^{-1}\\left(x^{2}+y^{5}\\right) \\equiv r\n\\]\n\nso \\(\\left(z^{-5} x, z^{-2} y\\right) \\in S_{r}\\). So, there are at least \\(\\frac{p-1}{10} \\geq 4\\) empty sets among \\(S_{1}, \\ldots, S_{p-1}\\), and there are at most \\(p-4\\) nonzero values among \\(s_{0}, s_{2}, \\ldots, s_{p-1}\\). Then by the AM-QM inequality we obtain\n\n\\[\nN=\\sum_{r \\in \\mathcal{P} \\backslash r T} s_{r}^{2} \\geq \\frac{1}{p-4}\\left(\\sum_{r \\in \\mathcal{P} \\backslash r T} s_{r}\\right)^{2}=\\frac{|\\mathcal{P} \\times \\mathcal{P}|^{2}}{p-4}=\\frac{p^{4}}{p-4}>p\\left(p^{2}+4 p-4\\right),\n\\]\n\nwhich is impossible by the lemma.\n\nSolution 2. If \\(5 \\nmid p-1\\), then all modulo \\(p\\) residue classes are complete fifth powers and the statement is trivial. So assume that \\(p=10 k+1\\) where \\(k \\geq 10\\). Let \\(g\\) be a primitive root modulo \\(p\\).\n\nWe will use the following facts:\n(F1) If some residue class \\(x\\) is not quadratic then \\(x^{(p-1) / 2} \\equiv-1(\\bmod p)\\).\n(F2) For every integer \\(d\\), as a simple corollary of the summation formula for geometric progressions,\n\n\\[\n\\sum_{i=0}^{2 k-1} g^{5 d i} \\equiv\\left\\{\\begin{array}{ll}\n2 k & \\text { if } 2 k \\mid d \n0 & \\text { if } 2 k \\not k d\n \\quad(\\bmod p)\\right.\n\\]\n\nSuppose that, contrary to the statement, some modulo \\(p\\) residue class \\(r\\) cannot be expressed as \\(a^{2}+b^{5}\\). Of course \\(r \\not \\equiv 0(\\bmod p)\\). By (F1) we have \\(\\left(r-b^{5}\\right)^{(p-1) / 2}=\\left(r-b^{5}\\right)^{5 k} \\equiv-1(\\bmod p)\\) for all residue classes \\(b\\).\n\nFor \\(t=1,2 \\ldots, k-1\\) consider the sums\n\n\\[\nS(t)=\\sum_{i=0}^{2 k-1}\\left(r-g^{5 i}\\right)^{5 k} g^{5 t i}\n\\]\n\nBy the indirect assumption and (F2),\n\n\\[\nS(t)=\\sum_{i=0}^{2 k-1}\\left(r-\\left(g^{i}\\right)^{5}\\right)^{5 k} g^{5 t i} \\equiv \\sum_{i=0}^{2 k-1}(-1) g^{5 t i} \\equiv-\\sum_{i=0}^{2 k-1} g^{5 t i} \\equiv 0 \\quad(\\bmod p)\n\\]\n\nbecause \\(2 k\\) cannot divide \\(t\\).\nOn the other hand, by the binomial theorem,\n\n\\[\n\\begin{aligned}\nS(t) & =\\sum_{i=0}^{2 k-1}\\left(\\sum_{j=0}^{5 k}\\binom{5 k}{j} r^{5 k-j}\\left(-g^{5 i}\\right)^{j}\\right) g^{5 t i}=\\sum_{j=0}^{5 k}(-1)^{j}\\binom{5 k}{j} r^{5 k-j}\\left(\\sum_{i=0}^{2 k-1} g^{5(j+t) i}\\right) \\equiv \n& \\equiv \\sum_{j=0}^{5 k}(-1)^{j}\\binom{5 k}{j} r^{5 k-j}\\left\\{\\begin{array}{ll}\n2 k & \\text { if } 2 k \\mid j+t \n0 & \\text { if } 2 k \\not 2 \\nmid j+t\n \\quad(\\bmod p) .\\right.\n\n\\]\n\nSince \\(1 \\leq j+t<6 k\\), the number \\(2 k\\) divides \\(j+t\\) only for \\(j=2 k-t\\) and \\(j=4 k-t\\). Hence,\n\n\\[\n\\begin{gathered}\n0 \\equiv S(t) \\equiv(-1)^{t}\\left(\\binom{5 k}{2 k-t} r^{3 k+t}+\\binom{5 k}{4 k-t} r^{k+t}\\right) \\cdot 2 k \\quad(\\bmod p) \n\\binom{5 k}{2 k-t} r^{2 k}+\\binom{5 k}{4 k-t} \\equiv 0 \\quad(\\bmod p)\n\n\\]\n\nTaking this for \\(t=1,2\\) and eliminating \\(r\\), we get\n\n\\[\n\\begin{aligned}\n0 & \\equiv\\binom{5 k}{2 k-2}\\left(\\binom{5 k}{2 k-1} r^{2 k}+\\binom{5 k}{4 k-1}\\right)-\\binom{5 k}{2 k-1}\\left(\\binom{5 k}{2 k-2} r^{2 k}+\\binom{5 k}{4 k-2}\\right) \n& =\\binom{5 k}{2 k-2}\\binom{5 k}{4 k-1}-\\binom{5 k}{2 k-1}\\binom{5 k}{4 k-2} \n& =\\frac{(5 k)!^{2}}{(2 k-1)!(3 k+2)!(4 k-1)!(k+2)!}((2 k-1)(k+2)-(3 k+2)(4 k-1)) \n& =\\frac{-(5 k)!^{2} \\cdot 2 k(5 k+1)}{(2 k-1)!(3 k+2)!(4 k-1)!(k+2)!}(\\bmod p) .\n\n\\]\n\nBut in the last expression none of the numbers is divisible by \\(p=10 k+1\\), a contradiction.\n\nComment 1. The argument in the second solution is valid whenever \\(k \\geq 3\\), that is for all primes \\(p=10 k+1\\) except \\(p=11\\). This is an exceptional case when the statement is not true; \\(r=7\\) cannot be expressed as desired.\n\nComment 2. The statement is true in a more general setting: for every positive integer \\(n\\), for all sufficiently large \\(p\\), each residue class modulo \\(p\\) can be expressed as \\(a^{2}+b^{n}\\). Choosing \\(t=3\\) would allow using the Cauchy-Davenport theorem (together with some analysis on the case of equality).\n\nIn the literature more general results are known. For instance, the statement easily follows from the Hasse-Weil bound."}
{"id": "imo-shortlist-2016-a1", "question": "A1. Let \\(a, b\\) and \\(c\\) be positive real numbers such that \\(\\min \\{a b, b c, c a\\} \\geqslant 1\\). Prove that\n\n\\[\n\\sqrt[3]{\\left(a^{2}+1\\right)\\left(b^{2}+1\\right)\\left(c^{2}+1\\right)} \\leqslant\\left(\\frac{a+b+c}{3}\\right)^{2}+1\n\\]", "category": "Algebra", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-a2", "question": "A2. Find the smallest real constant \\(C\\) such that for any positive real numbers \\(a_{1}, a_{2}, a_{3}, a_{4}\\) and \\(a_{5}\\) (not necessarily distinct), one can always choose distinct subscripts \\(i, j, k\\) and \\(l\\) such that\n\n\\[\n\\left|\\frac{a_{i}}{a_{j}}-\\frac{a_{k}}{a_{l}}\\right| \\leqslant C\n\\]", "category": "Algebra", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-a3", "question": "A3. Find all integers \\(n \\geqslant 3\\) with the following property: for all real numbers \\(a_{1}, a_{2}, \\ldots, a_{n}\\) and \\(b_{1}, b_{2}, \\ldots, b_{n}\\) satisfying \\(\\left|a_{k}\\right|+\\left|b_{k}\\right|=1\\) for \\(1 \\leqslant k \\leqslant n\\), there exist \\(x_{1}, x_{2}, \\ldots, x_{n}\\), each of which is either -1 or 1 , such that\n\n\\[\n\\left|\\sum_{k=1}^{n} x_{k} a_{k}\\right|+\\left|\\sum_{k=1}^{n} x_{k} b_{k}\\right| \\leqslant 1\n\\]", "category": "Algebra", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-a4", "question": "A4. Denote by \\(\\mathbb{R}^{+}\\)the set of all positive real numbers. Find all functions \\(f: \\mathbb{R}^{+} \\rightarrow \\mathbb{R}^{+}\\)such that\n\n\\[\nx f\\left(x^{2}\\right) f(f(y))+f(y f(x))=f(x y)\\left(f\\left(f\\left(x^{2}\\right)\\right)+f\\left(f\\left(y^{2}\\right)\\right)\\right)\n\\]\n\nfor all positive real numbers \\(x\\) and \\(y\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-c1", "question": "C1. The leader of an IMO team chooses positive integers \\(n\\) and \\(k\\) with \\(n>k\\), and announces them to the deputy leader and a contestant. The leader then secretly tells the deputy leader an \\(n\\)-digit binary string, and the deputy leader writes down all \\(n\\)-digit binary strings which differ from the leader's in exactly \\(k\\) positions. (For example, if \\(n=3\\) and \\(k=1\\), and if the leader chooses 101, the deputy leader would write down 001, 111 and 100.) The contestant is allowed to look at the strings written by the deputy leader and guess the leader's string. What is the minimum number of guesses (in terms of \\(n\\) and \\(k\\) ) needed to guarantee the correct answer?", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-c2", "question": "C2. Find all positive integers \\(n\\) for which all positive divisors of \\(n\\) can be put into the cells of a rectangular table under the following constraints:\n\n\\begin{itemize}\n  \\item each cell contains a distinct divisor;\n  \\item the sums of all rows are equal; and\n  \\item the sums of all columns are equal.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-c3", "question": "C3. Let \\(n\\) be a positive integer relatively prime to 6 . We paint the vertices of a regular \\(n\\)-gon with three colours so that there is an odd number of vertices of each colour. Show that there exists an isosceles triangle whose three vertices are of different colours.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-c4", "question": "C4. Find all positive integers \\(n\\) for which we can fill in the entries of an \\(n \\times n\\) table with the following properties:\n\n\\begin{itemize}\n  \\item each entry can be one of \\(I, M\\) and \\(O\\);\n  \\item in each row and each column, the letters \\(I, M\\) and \\(O\\) occur the same number of times; and\n  \\item in any diagonal whose number of entries is a multiple of three, the letters \\(I, M\\) and \\(O\\) occur the same number of times.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-c5", "question": "C5. Let \\(n \\geqslant 3\\) be a positive integer. Find the maximum number of diagonals of a regular \\(n\\)-gon one can select, so that any two of them do not intersect in the interior or they are perpendicular to each other.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-c6", "question": "C6. There are \\(n \\geqslant 3\\) islands in a city. Initially, the ferry company offers some routes between some pairs of islands so that it is impossible to divide the islands into two groups such that no two islands in different groups are connected by a ferry route.\n\nAfter each year, the ferry company will close a ferry route between some two islands \\(X\\) and \\(Y\\). At the same time, in order to maintain its service, the company will open new routes according to the following rule: for any island which is connected by a ferry route to exactly one of \\(X\\) and \\(Y\\), a new route between this island and the other of \\(X\\) and \\(Y\\) is added.\n\nSuppose at any moment, if we partition all islands into two nonempty groups in any way, then it is known that the ferry company will close a certain route connecting two islands from the two groups after some years. Prove that after some years there will be an island which is connected to all other islands by ferry routes.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-c7", "question": "C7. Let \\(n \\geqslant 2\\) be an integer. In the plane, there are \\(n\\) segments given in such a way that any two segments have an intersection point in the interior, and no three segments intersect at a single point. Jeff places a snail at one of the endpoints of each of the segments and claps his hands \\(n-1\\) times. Each time when he claps his hands, all the snails move along their own segments and stay at the next intersection points until the next clap. Since there are \\(n-1\\) intersection points on each segment, all snails will reach the furthest intersection points from their starting points after \\(n-1\\) claps.\n(a) Prove that if \\(n\\) is odd then Jeff can always place the snails so that no two of them ever occupy the same intersection point.\n(b) Prove that if \\(n\\) is even then there must be a moment when some two snails occupy the same intersection point no matter how Jeff places the snails.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-c8", "question": "C8. Let \\(n\\) be a positive integer. Determine the smallest positive integer \\(k\\) with the following property: it is possible to mark \\(k\\) cells on a \\(2 n \\times 2 n\\) board so that there exists a unique partition of the board into \\(1 \\times 2\\) and \\(2 \\times 1\\) dominoes, none of which contains two marked cells.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-g1", "question": "G1. In a convex pentagon \\(A B C D E\\), let \\(F\\) be a point on \\(A C\\) such that \\(\\angle F B C=90^{\\circ}\\). Suppose triangles \\(A B F, A C D\\) and \\(A D E\\) are similar isosceles triangles with\n\n\\[\n\\angle F A B=\\angle F B A=\\angle D A C=\\angle D C A=\\angle E A D=\\angle E D A .\n\\]\n\nLet \\(M\\) be the midpoint of \\(C F\\). Point \\(X\\) is chosen such that \\(A M X E\\) is a parallelogram. Show that \\(B D, E M\\) and \\(F X\\) are concurrent.", "category": "Geometry", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-g2", "question": "G2. Let \\(A B C\\) be a triangle with circumcircle \\(\\Gamma\\) and incentre \\(I\\). Let \\(M\\) be the midpoint of side \\(B C\\). Denote by \\(D\\) the foot of perpendicular from \\(I\\) to side \\(B C\\). The line through \\(I\\) perpendicular to \\(A I\\) meets sides \\(A B\\) and \\(A C\\) at \\(F\\) and \\(E\\) respectively. Suppose the circumcircle of triangle \\(A E F\\) intersects \\(\\Gamma\\) at a point \\(X\\) other than \\(A\\). Prove that lines \\(X D\\) and \\(A M\\) meet on \\(\\Gamma\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-g3", "question": "G3. Let \\(B=(-1,0)\\) and \\(C=(1,0)\\) be fixed points on the coordinate plane. A nonempty, bounded subset \\(S\\) of the plane is said to be nice if\n(i) there is a point \\(T\\) in \\(S\\) such that for every point \\(Q\\) in \\(S\\), the segment \\(T Q\\) lies entirely in \\(S\\); and\n(ii) for any triangle \\(P_{1} P_{2} P_{3}\\), there exists a unique point \\(A\\) in \\(S\\) and a permutation \\(\\sigma\\) of the indices \\(\\{1,2,3\\}\\) for which triangles \\(A B C\\) and \\(P_{\\sigma(1)} P_{\\sigma(2)} P_{\\sigma(3)}\\) are similar.\n\nProve that there exist two distinct nice subsets \\(S\\) and \\(S^{\\prime}\\) of the set \\(\\{(x, y): x \\geqslant 0, y \\geqslant 0\\}\\) such that if \\(A \\in S\\) and \\(A^{\\prime} \\in S^{\\prime}\\) are the unique choices of points in (ii), then the product \\(B A \\cdot B A^{\\prime}\\) is a constant independent of the triangle \\(P_{1} P_{2} P_{3}\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-g4", "question": "G4. Let \\(A B C\\) be a triangle with \\(A B=A C \\neq B C\\) and let \\(I\\) be its incentre. The line \\(B I\\) meets \\(A C\\) at \\(D\\), and the line through \\(D\\) perpendicular to \\(A C\\) meets \\(A I\\) at \\(E\\). Prove that the reflection of \\(I\\) in \\(A C\\) lies on the circumcircle of triangle \\(B D E\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-g5", "question": "G5. Let \\(D\\) be the foot of perpendicular from \\(A\\) to the Euler line (the line passing through the circumcentre and the orthocentre) of an acute scalene triangle \\(A B C\\). A circle \\(\\omega\\) with centre \\(S\\) passes through \\(A\\) and \\(D\\), and it intersects sides \\(A B\\) and \\(A C\\) at \\(X\\) and \\(Y\\) respectively. Let \\(P\\) be the foot of altitude from \\(A\\) to \\(B C\\), and let \\(M\\) be the midpoint of \\(B C\\). Prove that the circumcentre of triangle \\(X S Y\\) is equidistant from \\(P\\) and \\(M\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-g6", "question": "G6. Let \\(A B C D\\) be a convex quadrilateral with \\(\\angle A B C=\\angle A D C<90^{\\circ}\\). The internal angle bisectors of \\(\\angle A B C\\) and \\(\\angle A D C\\) meet \\(A C\\) at \\(E\\) and \\(F\\) respectively, and meet each other at point \\(P\\). Let \\(M\\) be the midpoint of \\(A C\\) and let \\(\\omega\\) be the circumcircle of triangle \\(B P D\\). Segments \\(B M\\) and \\(D M\\) intersect \\(\\omega\\) again at \\(X\\) and \\(Y\\) respectively. Denote by \\(Q\\) the intersection point of lines \\(X E\\) and \\(Y F\\). Prove that \\(P Q \\perp A C\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-g7", "question": "G7. Let \\(I\\) be the incentre of a non-equilateral triangle \\(A B C, I_{A}\\) be the \\(A\\)-excentre, \\(I_{A}^{\\prime}\\) be the reflection of \\(I_{A}\\) in \\(B C\\), and \\(l_{A}\\) be the reflection of line \\(A I_{A}^{\\prime}\\) in \\(A I\\). Define points \\(I_{B}, I_{B}^{\\prime}\\) and line \\(l_{B}\\) analogously. Let \\(P\\) be the intersection point of \\(l_{A}\\) and \\(l_{B}\\).\n(a) Prove that \\(P\\) lies on line \\(O I\\) where \\(O\\) is the circumcentre of triangle \\(A B C\\).\n(b) Let one of the tangents from \\(P\\) to the incircle of triangle \\(A B C\\) meet the circumcircle at points \\(X\\) and \\(Y\\). Show that \\(\\angle X I Y=120^{\\circ}\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-g8", "question": "G8. Let \\(A_{1}, B_{1}\\) and \\(C_{1}\\) be points on sides \\(B C, C A\\) and \\(A B\\) of an acute triangle \\(A B C\\) respectively, such that \\(A A_{1}, B B_{1}\\) and \\(C C_{1}\\) are the internal angle bisectors of triangle \\(A B C\\). Let \\(I\\) be the incentre of triangle \\(A B C\\), and \\(H\\) be the orthocentre of triangle \\(A_{1} B_{1} C_{1}\\). Show that\n\n\\[\nA H+B H+C H \\geqslant A I+B I+C I\n\\]", "category": "Geometry", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-n1", "question": "N1. For any positive integer \\(k\\), denote the sum of digits of \\(k\\) in its decimal representation by \\(S(k)\\). Find all polynomials \\(P(x)\\) with integer coefficients such that for any positive integer \\(n \\geqslant 2016\\), the integer \\(P(n)\\) is positive and\n\n\\[\nS(P(n))=P(S(n))\n\\]", "category": "Number Theory", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-n2", "question": "N2. Let \\(\\tau(n)\\) be the number of positive divisors of \\(n\\). Let \\(\\tau_{1}(n)\\) be the number of positive divisors of \\(n\\) which have remainders 1 when divided by 3 . Find all possible integral values of the fraction \\(\\frac{\\tau(10 n)}{\\tau_{1}(10 n)}\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-n3", "question": "N3. Define \\(P(n)=n^{2}+n+1\\). For any positive integers \\(a\\) and \\(b\\), the set\n\n\\[\n\\{P(a), P(a+1), P(a+2), \\ldots, P(a+b)\\}\n\\]\n\nis said to be fragrant if none of its elements is relatively prime to the product of the other elements. Determine the smallest size of a fragrant set.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-n4", "question": "N4. Let \\(n, m, k\\) and \\(l\\) be positive integers with \\(n \\neq 1\\) such that \\(n^{k}+m n^{l}+1\\) divides \\(n^{k+l}-1\\). Prove that\n\n\\begin{itemize}\n  \\item \\(m=1\\) and \\(l=2 k\\); or\n  \\item \\(l \\mid k\\) and \\(m=\\frac{n^{k-l}-1}{n^{l}-1}\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-n5", "question": "N5. Let \\(a\\) be a positive integer which is not a square number. Denote by \\(A\\) the set of all positive integers \\(k\\) such that\n\n\\[\nk=\\frac{x^{2}-a}{x^{2}-y^{2}}\n\\]\n\nfor some integers \\(x\\) and \\(y\\) with \\(x>\\sqrt{a}\\). Denote by \\(B\\) the set of all positive integers \\(k\\) such that (1) is satisfied for some integers \\(x\\) and \\(y\\) with \\(0 \\leqslant x<\\sqrt{a}\\). Prove that \\(A=B\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-n6", "question": "N6. Denote by \\(\\mathbb{N}\\) the set of all positive integers. Find all functions \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}\\) such that for all positive integers \\(m\\) and \\(n\\), the integer \\(f(m)+f(n)-m n\\) is nonzero and divides \\(m f(m)+n f(n)\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-n7", "question": "N7. Let \\(n\\) be an odd positive integer. In the Cartesian plane, a cyclic polygon \\(P\\) with area \\(S\\) is chosen. All its vertices have integral coordinates, and all squares of its side lengths are divisible by \\(n\\). Prove that \\(2 S\\) is an integer divisible by \\(n\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-n8", "question": "N8. Find all polynomials \\(P(x)\\) of odd degree \\(d\\) and with integer coefficients satisfying the following property: for each positive integer \\(n\\), there exist \\(n\\) positive integers \\(x_{1}, x_{2}, \\ldots, x_{n}\\) such that \\(\\frac{1}{2}<\\frac{P\\left(x_{i}\\right)}{P\\left(x_{j}\\right)}<2\\) and \\(\\frac{P\\left(x_{i}\\right)}{P\\left(x_{j}\\right)}\\) is the \\(d\\)-th power of a rational number for every pair of indices \\(i\\) and \\(j\\) with \\(1 \\leqslant i, j \\leqslant n\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-a1", "question": "A1. Let \\(a, b\\) and \\(c\\) be positive real numbers such that \\(\\min \\{a b, b c, c a\\} \\geqslant 1\\). Prove that\n\n\\[\n\\sqrt[3]{\\left(a^{2}+1\\right)\\left(b^{2}+1\\right)\\left(c^{2}+1\\right)} \\leqslant\\left(\\frac{a+b+c}{3}\\right)^{2}+1\n\\]", "category": "Algebra", "source": "IMO Shortlist", "year": 2016, "solution": "We first show the following.\n\n\\begin{itemize}\n  \\item Claim. For any positive real numbers \\(x, y\\) with \\(x y \\geqslant 1\\), we have\n\n\n\\[\n\\left(x^{2}+1\\right)\\left(y^{2}+1\\right) \\leqslant\\left(\\left(\\frac{x+y}{2}\\right)^{2}+1\\right)^{2}\n\\]\n\nProof. Note that \\(x y \\geqslant 1\\) implies \\(\\left(\\frac{x+y}{2}\\right)^{2}-1 \\geqslant x y-1 \\geqslant 0\\). We find that\n\n\\[\n\\left(x^{2}+1\\right)\\left(y^{2}+1\\right)=(x y-1)^{2}+(x+y)^{2} \\leqslant\\left(\\left(\\frac{x+y}{2}\\right)^{2}-1\\right)^{2}+(x+y)^{2}=\\left(\\left(\\frac{x+y}{2}\\right)^{2}+1\\right)^{2} .\n\\]\n\nWithout loss of generality, assume \\(a \\geqslant b \\geqslant c\\). This implies \\(a \\geqslant 1\\). Let \\(d=\\frac{a+b+c}{3}\\). Note that\n\n\\[\na d=\\frac{a(a+b+c)}{3} \\geqslant \\frac{1+1+1}{3}=1\n\\]\n\nThen we can apply (2) to the pair \\((a, d)\\) and the pair \\((b, c)\\). We get\n\n\\[\n\\left(a^{2}+1\\right)\\left(d^{2}+1\\right)\\left(b^{2}+1\\right)\\left(c^{2}+1\\right) \\leqslant\\left(\\left(\\frac{a+d}{2}\\right)^{2}+1\\right)^{2}\\left(\\left(\\frac{b+c}{2}\\right)^{2}+1\\right)^{2}\n\\]\n\nNext, from\n\n\\[\n\\frac{a+d}{2} \\cdot \\frac{b+c}{2} \\geqslant \\sqrt{a d} \\cdot \\sqrt{b c} \\geqslant 1\n\\]\n\nwe can apply (2) again to the pair ( \\(\\frac{a+d}{2}, \\frac{b+c}{2}\\) ). Together with (3), we have\n\n\\[\n\\left(a^{2}+1\\right)\\left(d^{2}+1\\right)\\left(b^{2}+1\\right)\\left(c^{2}+1\\right) \\leqslant\\left(\\left(\\frac{a+b+c+d}{4}\\right)^{2}+1\\right)^{4}=\\left(d^{2}+1\\right)^{4}\n\\]\n\nTherefore, \\(\\left(a^{2}+1\\right)\\left(b^{2}+1\\right)\\left(c^{2}+1\\right) \\leqslant\\left(d^{2}+1\\right)^{3}\\), and (1) follows by taking cube root of both sides.\n\nComment. After justifying the Claim, one may also obtain (1) by mixing variables. Indeed, the function involved is clearly continuous, and hence it suffices to check that the condition \\(x y \\geqslant 1\\) is preserved under each mixing step. This is true since whenever \\(a b, b c, c a \\geqslant 1\\), we have\n\n\\[\n\\frac{a+b}{2} \\cdot \\frac{a+b}{2} \\geqslant a b \\geqslant 1 \\quad \\text { and } \\quad \\frac{a+b}{2} \\cdot c \\geqslant \\frac{1+1}{2}=1 .\n\\]\n\nSolution 2. Let \\(f(x)=\\ln \\left(1+x^{2}\\right)\\). Then the inequality (1) to be shown is equivalent to\n\n\\[\n\\frac{f(a)+f(b)+f(c)}{3} \\leqslant f\\left(\\frac{a+b+c}{3}\\right),\n\\]\n\nwhile (2) becomes\n\n\\[\n\\frac{f(x)+f(y)}{2} \\leqslant f\\left(\\frac{x+y}{2}\\right)\n\\]\n\nfor \\(x y \\geqslant 1\\).\nWithout loss of generality, assume \\(a \\geqslant b \\geqslant c\\). From the Claim in Solution 1, we have\n\n\\[\n\\frac{f(a)+f(b)+f(c)}{3} \\leqslant \\frac{f(a)+2 f\\left(\\frac{b+c}{2}\\right)}{3}\n\\]\n\nNote that \\(a \\geqslant 1\\) and \\(\\frac{b+c}{2} \\geqslant \\sqrt{b c} \\geqslant 1\\). Since\n\n\\[\nf^{\\prime \\prime}(x)=\\frac{2\\left(1-x^{2}\\right)}{\\left(1+x^{2}\\right)^{2}}\n\\]\n\nwe know that \\(f\\) is concave on \\([1, \\infty)\\). Then we can apply Jensen's Theorem to get\n\n\\[\n\\frac{f(a)+2 f\\left(\\frac{b+c}{2}\\right)}{3} \\leqslant f\\left(\\frac{a+2 \\cdot \\frac{b+c}{2}}{3}\\right)=f\\left(\\frac{a+b+c}{3}\\right)\n\\]\n\nThis completes the proof."}
{"id": "imo-shortlist-2016-a2", "question": "A2. Find the smallest real constant \\(C\\) such that for any positive real numbers \\(a_{1}, a_{2}, a_{3}, a_{4}\\) and \\(a_{5}\\) (not necessarily distinct), one can always choose distinct subscripts \\(i, j, k\\) and \\(l\\) such that\n\n\\[\n\\left|\\frac{a_{i}}{a_{j}}-\\frac{a_{k}}{a_{l}}\\right| \\leqslant C\n\\]\n\nAnswer. The smallest \\(C\\) is \\(\\frac{1}{2}\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2016, "solution": "We first show that \\(C \\leqslant \\frac{1}{2}\\). For any positive real numbers \\(a_{1} \\leqslant a_{2} \\leqslant a_{3} \\leqslant a_{4} \\leqslant a_{5}\\), consider the five fractions\n\n\\[\n\\frac{a_{1}}{a_{2}}, \\frac{a_{3}}{a_{4}}, \\frac{a_{1}}{a_{5}}, \\frac{a_{2}}{a_{3}}, \\frac{a_{4}}{a_{5}}\n\\]\n\nEach of them lies in the interval \\((0,1]\\). Therefore, by the Pigeonhole Principle, at least three of them must lie in ( \\(0, \\frac{1}{2}\\) ] or lie in ( \\(\\frac{1}{2}, 1\\) ] simultaneously. In particular, there must be two consecutive terms in (2) which belong to an interval of length \\(\\frac{1}{2}\\) (here, we regard \\(\\frac{a_{1}}{a_{2}}\\) and \\(\\frac{a_{4}}{a_{5}}\\) as consecutive). In other words, the difference of these two fractions is less than \\(\\frac{1}{2}\\). As the indices involved in these two fractions are distinct, we can choose them to be \\(i, j, k, l\\) and conclude that \\(C \\leqslant \\frac{1}{2}\\).\n\nNext, we show that \\(C=\\frac{1}{2}\\) is best possible. Consider the numbers \\(1,2,2,2, n\\) where \\(n\\) is a large real number. The fractions formed by two of these numbers in ascending order are \\(\\frac{1}{n}, \\frac{2}{n}, \\frac{1}{2}, \\frac{2}{2}, \\frac{2}{1}, \\frac{n}{2}, \\frac{n}{1}\\). Since the indices \\(i, j, k, l\\) are distinct, \\(\\frac{1}{n}\\) and \\(\\frac{2}{n}\\) cannot be chosen simultaneously. Therefore the minimum value of the left-hand side of (1) is \\(\\frac{1}{2}-\\frac{2}{n}\\). When \\(n\\) tends to infinity, this value approaches \\(\\frac{1}{2}\\), and so \\(C\\) cannot be less than \\(\\frac{1}{2}\\).\n\nThese conclude that \\(C=\\frac{1}{2}\\) is the smallest possible choice.\nComment. The conclusion still holds if \\(a_{1}, a_{2}, \\ldots, a_{5}\\) are pairwise distinct, since in the construction, we may replace the 2's by real numbers sufficiently close to 2 .\n\nThere are two possible simplifications for this problem:\n(i) the answer \\(C=\\frac{1}{2}\\) is given to the contestants; or\n(ii) simply ask the contestants to prove the inequality (1) for \\(C=\\frac{1}{2}\\)."}
{"id": "imo-shortlist-2016-a3", "question": "A3. Find all integers \\(n \\geqslant 3\\) with the following property: for all real numbers \\(a_{1}, a_{2}, \\ldots, a_{n}\\) and \\(b_{1}, b_{2}, \\ldots, b_{n}\\) satisfying \\(\\left|a_{k}\\right|+\\left|b_{k}\\right|=1\\) for \\(1 \\leqslant k \\leqslant n\\), there exist \\(x_{1}, x_{2}, \\ldots, x_{n}\\), each of which is either -1 or 1 , such that\n\n\\[\n\\left|\\sum_{k=1}^{n} x_{k} a_{k}\\right|+\\left|\\sum_{k=1}^{n} x_{k} b_{k}\\right| \\leqslant 1\n\\]\n\nAnswer. \\(n\\) can be any odd integer greater than or equal to 3 .", "category": "Algebra", "source": "IMO Shortlist", "year": 2016, "solution": "For any even integer \\(n \\geqslant 4\\), we consider the case\n\n\\[\na_{1}=a_{2}=\\cdots=a_{n-1}=b_{n}=0 \\quad \\text { and } \\quad b_{1}=b_{2}=\\cdots=b_{n-1}=a_{n}=1 .\n\\]\n\nThe condition \\(\\left|a_{k}\\right|+\\left|b_{k}\\right|=1\\) is satisfied for each \\(1 \\leqslant k \\leqslant n\\). No matter how we choose each \\(x_{k}\\), both sums \\(\\sum_{k=1}^{n} x_{k} a_{k}\\) and \\(\\sum_{k=1}^{n} x_{k} b_{k}\\) are odd integers. This implies \\(\\left|\\sum_{k=1}^{n} x_{k} a_{k}\\right| \\geqslant 1\\) and \\(\\left|\\sum_{k=1}^{n} x_{k} b_{k}\\right| \\geqslant 1\\), which shows (1) cannot hold.\n\nFor any odd integer \\(n \\geqslant 3\\), we may assume without loss of generality \\(b_{k} \\geqslant 0\\) for \\(1 \\leqslant k \\leqslant n\\) (this can be done by flipping the pair \\(\\left(a_{k}, b_{k}\\right)\\) to \\(\\left(-a_{k},-b_{k}\\right)\\) and \\(x_{k}\\) to \\(-x_{k}\\) if necessary) and \\(a_{1} \\geqslant a_{2} \\geqslant \\cdots \\geqslant a_{m} \\geqslant 0>a_{m+1} \\geqslant \\cdots \\geqslant a_{n}\\). We claim that the choice \\(x_{k}=(-1)^{k+1}\\) for \\(1 \\leqslant k \\leqslant n\\) will work. Define\n\n\\[\ns=\\sum_{k=1}^{m} x_{k} a_{k} \\quad \\text { and } \\quad t=-\\sum_{k=m+1}^{n} x_{k} a_{k}\n\\]\n\nNote that\n\n\\[\ns=\\left(a_{1}-a_{2}\\right)+\\left(a_{3}-a_{4}\\right)+\\cdots \\geqslant 0\n\\]\n\nby the assumption \\(a_{1} \\geqslant a_{2} \\geqslant \\cdots \\geqslant a_{m}\\) (when \\(m\\) is odd, there is a single term \\(a_{m}\\) at the end, which is also positive). Next, we have\n\n\\[\ns=a_{1}-\\left(a_{2}-a_{3}\\right)-\\left(a_{4}-a_{5}\\right)-\\cdots \\leqslant a_{1} \\leqslant 1 .\n\\]\n\nSimilarly,\n\n\\[\nt=\\left(-a_{n}+a_{n-1}\\right)+\\left(-a_{n-2}+a_{n-3}\\right)+\\cdots \\geqslant 0\n\\]\n\nand\n\n\\[\nt=-a_{n}+\\left(a_{n-1}-a_{n-2}\\right)+\\left(a_{n-3}-a_{n-4}\\right)+\\cdots \\leqslant-a_{n} \\leqslant 1 .\n\\]\n\nFrom the condition, we have \\(a_{k}+b_{k}=1\\) for \\(1 \\leqslant k \\leqslant m\\) and \\(-a_{k}+b_{k}=1\\) for \\(m+1 \\leqslant k \\leqslant n\\). It follows that \\(\\sum_{k=1}^{n} x_{k} a_{k}=s-t\\) and \\(\\sum_{k=1}^{n} x_{k} b_{k}=1-s-t\\). Hence it remains to prove\n\n\\[\n|s-t|+|1-s-t| \\leqslant 1\n\\]\n\nunder the constraint \\(0 \\leqslant s, t \\leqslant 1\\). By symmetry, we may assume \\(s \\geqslant t\\). If \\(1-s-t \\geqslant 0\\), then we have\n\n\\[\n|s-t|+|1-s-t|=s-t+1-s-t=1-2 t \\leqslant 1\n\\]\n\nIf \\(1-s-t \\leqslant 0\\), then we have\n\n\\[\n|s-t|+|1-s-t|=s-t-1+s+t=2 s-1 \\leqslant 1\n\\]\n\nHence, the inequality is true in both cases.\nThese show \\(n\\) can be any odd integer greater than or equal to 3 .\n\nSolution 2. The even case can be handled in the same way as Solution 1. For the odd case, we prove by induction on \\(n\\).\n\nFirstly, for \\(n=3\\), we may assume without loss of generality \\(a_{1} \\geqslant a_{2} \\geqslant a_{3} \\geqslant 0\\) and \\(b_{1}=a_{1}-1\\) (if \\(b_{1}=1-a_{1}\\), we may replace each \\(b_{k}\\) by \\(-b_{k}\\) ).\n\n\\begin{itemize}\n  \\item Case 1. \\(b_{2}=a_{2}-1\\) and \\(b_{3}=a_{3}-1\\), in which case we take \\(\\left(x_{1}, x_{2}, x_{3}\\right)=(1,-1,1)\\).\n\n\nLet \\(c=a_{1}-a_{2}+a_{3}\\) so that \\(0 \\leqslant c \\leqslant 1\\). Then \\(\\left|b_{1}-b_{2}+b_{3}\\right|=\\left|a_{1}-a_{2}+a_{3}-1\\right|=1-c\\) and hence \\(|c|+\\left|b_{1}-b_{2}+b_{3}\\right|=1\\).\n\n\\begin{itemize}\n  \\item Case 2. \\(b_{2}=1-a_{2}\\) and \\(b_{3}=1-a_{3}\\), in which case we take \\(\\left(x_{1}, x_{2}, x_{3}\\right)=(1,-1,1)\\).\n\n\nLet \\(c=a_{1}-a_{2}+a_{3}\\) so that \\(0 \\leqslant c \\leqslant 1\\). Since \\(a_{3} \\leqslant a_{2}\\) and \\(a_{1} \\leqslant 1\\), we have\n\n\\[\nc-1 \\leqslant b_{1}-b_{2}+b_{3}=a_{1}+a_{2}-a_{3}-1 \\leqslant 1-c\n\\]\n\nThis gives \\(\\left|b_{1}-b_{2}+b_{3}\\right| \\leqslant 1-c\\) and hence \\(|c|+\\left|b_{1}-b_{2}+b_{3}\\right| \\leqslant 1\\).\n\n\\begin{itemize}\n  \\item Case 3. \\(b_{2}=a_{2}-1\\) and \\(b_{3}=1-a_{3}\\), in which case we take \\(\\left(x_{1}, x_{2}, x_{3}\\right)=(-1,1,1)\\).\n\n\nLet \\(c=-a_{1}+a_{2}+a_{3}\\). If \\(c \\geqslant 0\\), then \\(a_{3} \\leqslant 1\\) and \\(a_{2} \\leqslant a_{1}\\) imply\n\n\\[\nc-1 \\leqslant-b_{1}+b_{2}+b_{3}=-a_{1}+a_{2}-a_{3}+1 \\leqslant 1-c\n\\]\n\nIf \\(c<0\\), then \\(a_{1} \\leqslant a_{2}+1\\) and \\(a_{3} \\geqslant 0\\) imply\n\n\\[\n-c-1 \\leqslant-b_{1}+b_{2}+b_{3}=-a_{1}+a_{2}-a_{3}+1 \\leqslant 1+c .\n\\]\n\nIn both cases, we get \\(\\left|-b_{1}+b_{2}+b_{3}\\right| \\leqslant 1-|c|\\) and hence \\(|c|+\\left|-b_{1}+b_{2}+b_{3}\\right| \\leqslant 1\\).\n\n\\begin{itemize}\n  \\item Case 4. \\(b_{2}=1-a_{2}\\) and \\(b_{3}=a_{3}-1\\), in which case we take \\(\\left(x_{1}, x_{2}, x_{3}\\right)=(-1,1,1)\\).\n\n\nLet \\(c=-a_{1}+a_{2}+a_{3}\\). If \\(c \\geqslant 0\\), then \\(a_{2} \\leqslant 1\\) and \\(a_{3} \\leqslant a_{1}\\) imply\n\n\\[\nc-1 \\leqslant-b_{1}+b_{2}+b_{3}=-a_{1}-a_{2}+a_{3}+1 \\leqslant 1-c\n\\]\n\nIf \\(c<0\\), then \\(a_{1} \\leqslant a_{3}+1\\) and \\(a_{2} \\geqslant 0\\) imply\n\n\\[\n-c-1 \\leqslant-b_{1}+b_{2}+b_{3}=-a_{1}-a_{2}+a_{3}+1 \\leqslant 1+c .\n\\]\n\nIn both cases, we get \\(\\left|-b_{1}+b_{2}+b_{3}\\right| \\leqslant 1-|c|\\) and hence \\(|c|+\\left|-b_{1}+b_{2}+b_{3}\\right| \\leqslant 1\\).\nWe have found \\(x_{1}, x_{2}, x_{3}\\) satisfying (1) in each case for \\(n=3\\).\nNow, let \\(n \\geqslant 5\\) be odd and suppose the result holds for any smaller odd cases. Again we may assume \\(a_{k} \\geqslant 0\\) for each \\(1 \\leqslant k \\leqslant n\\). By the Pigeonhole Principle, there are at least three indices \\(k\\) for which \\(b_{k}=a_{k}-1\\) or \\(b_{k}=1-a_{k}\\). Without loss of generality, suppose \\(b_{k}=a_{k}-1\\) for \\(k=1,2,3\\). Again by the Pigeonhole Principle, as \\(a_{1}, a_{2}, a_{3}\\) lies between 0 and 1 , the difference of two of them is at most \\(\\frac{1}{2}\\). By changing indices if necessary, we may assume \\(0 \\leqslant d=a_{1}-a_{2} \\leqslant \\frac{1}{2}\\).\n\nBy the inductive hypothesis, we can choose \\(x_{3}, x_{4}, \\ldots, x_{n}\\) such that \\(a^{\\prime}=\\sum_{k=3}^{n} x_{k} a_{k}\\) and \\(b^{\\prime}=\\sum_{k=3}^{n} x_{k} b_{k}\\) satisfy \\(\\left|a^{\\prime}\\right|+\\left|b^{\\prime}\\right| \\leqslant 1\\). We may further assume \\(a^{\\prime} \\geqslant 0\\).\n\n\\begin{itemize}\n  \\item Case 1. \\(b^{\\prime} \\geqslant 0\\), in which case we take \\(\\left(x_{1}, x_{2}\\right)=(-1,1)\\).\n\n\nWe have \\(\\left|-a_{1}+a_{2}+a^{\\prime}\\right|+\\left|-\\left(a_{1}-1\\right)+\\left(a_{2}-1\\right)+b^{\\prime}\\right|=\\left|-d+a^{\\prime}\\right|+\\left|-d+b^{\\prime}\\right| \\leqslant\\) \\(\\max \\left\\{a^{\\prime}+b^{\\prime}-2 d, a^{\\prime}-b^{\\prime}, b^{\\prime}-a^{\\prime}, 2 d-a^{\\prime}-b^{\\prime}\\right\\} \\leqslant 1\\) since \\(0 \\leqslant a^{\\prime}, b^{\\prime}, a^{\\prime}+b^{\\prime} \\leqslant 1\\) and \\(0 \\leqslant d \\leqslant \\frac{1}{2}\\).\n\n\\begin{itemize}\n  \\item Case 2. \\(0>b^{\\prime} \\geqslant-a^{\\prime}\\), in which case we take \\(\\left(x_{1}, x_{2}\\right)=(-1,1)\\).\n\n\nWe have \\(\\left|-a_{1}+a_{2}+a^{\\prime}\\right|+\\left|-\\left(a_{1}-1\\right)+\\left(a_{2}-1\\right)+b^{\\prime}\\right|=\\left|-d+a^{\\prime}\\right|+\\left|-d+b^{\\prime}\\right|\\). If \\(-d+a^{\\prime} \\geqslant 0\\), this equals \\(a^{\\prime}-b^{\\prime}=\\left|a^{\\prime}\\right|+\\left|b^{\\prime}\\right| \\leqslant 1\\). If \\(-d+a^{\\prime}<0\\), this equals \\(2 d-a^{\\prime}-b^{\\prime} \\leqslant 2 d \\leqslant 1\\).\n\n\\begin{itemize}\n  \\item Case 3. \\(b^{\\prime}<-a^{\\prime}\\), in which case we take \\(\\left(x_{1}, x_{2}\\right)=(1,-1)\\).\n\n\nWe have \\(\\left|a_{1}-a_{2}+a^{\\prime}\\right|+\\left|\\left(a_{1}-1\\right)-\\left(a_{2}-1\\right)+b^{\\prime}\\right|=\\left|d+a^{\\prime}\\right|+\\left|d+b^{\\prime}\\right|\\). If \\(d+b^{\\prime} \\geqslant 0\\), this equals \\(2 d+a^{\\prime}+b^{\\prime}<2 d \\leqslant 1\\). If \\(d+b^{\\prime}<0\\), this equals \\(a^{\\prime}-b^{\\prime}=\\left|a^{\\prime}\\right|+\\left|b^{\\prime}\\right| \\leqslant 1\\).\n\nTherefore, we have found \\(x_{1}, x_{2}, \\ldots, x_{n}\\) satisfying (1) in each case. By induction, the property holds for all odd integers \\(n \\geqslant 3\\)."}
{"id": "imo-shortlist-2016-a4", "question": "A4. Denote by \\(\\mathbb{R}^{+}\\)the set of all positive real numbers. Find all functions \\(f: \\mathbb{R}^{+} \\rightarrow \\mathbb{R}^{+}\\)such that\n\n\\[\nx f\\left(x^{2}\\right) f(f(y))+f(y f(x))=f(x y)\\left(f\\left(f\\left(x^{2}\\right)\\right)+f\\left(f\\left(y^{2}\\right)\\right)\\right)\n\\]\n\nfor all positive real numbers \\(x\\) and \\(y\\).\nAnswer. \\(f(x)=\\frac{1}{x}\\) for any \\(x \\in \\mathbb{R}^{+}\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2016, "solution": "Taking \\(x=y=1\\) in (1), we get \\(f(1) f(f(1))+f(f(1))=2 f(1) f(f(1))\\) and hence \\(f(1)=1\\). Swapping \\(x\\) and \\(y\\) in (1) and comparing with (1) again, we find\n\n\\[\nx f\\left(x^{2}\\right) f(f(y))+f(y f(x))=y f\\left(y^{2}\\right) f(f(x))+f(x f(y))\n\\]\n\nTaking \\(y=1\\) in (2), we have \\(x f\\left(x^{2}\\right)+f(f(x))=f(f(x))+f(x)\\), that is,\n\n\\[\nf\\left(x^{2}\\right)=\\frac{f(x)}{x}\n\\]\n\nTake \\(y=1\\) in (1) and apply (3) to \\(x f\\left(x^{2}\\right)\\). We get \\(f(x)+f(f(x))=f(x)\\left(f\\left(f\\left(x^{2}\\right)\\right)+1\\right)\\), which implies\n\n\\[\nf\\left(f\\left(x^{2}\\right)\\right)=\\frac{f(f(x))}{f(x)}\n\\]\n\nFor any \\(x \\in \\mathbb{R}^{+}\\), we find that\n\n\\[\nf\\left(f(x)^{2}\\right) \\stackrel{(3)}{=} \\frac{f(f(x))}{f(x)} \\stackrel{(4)}{=} f\\left(f\\left(x^{2}\\right)\\right) \\stackrel{(3)}{=} f\\left(\\frac{f(x)}{x}\\right)\n\\]\n\nIt remains to show the following key step.\n\n\\begin{itemize}\n  \\item Claim. The function \\(f\\) is injective.\n\n\nProof. Using (3) and (4), we rewrite (1) as\n\n\\[\nf(x) f(f(y))+f(y f(x))=f(x y)\\left(\\frac{f(f(x))}{f(x)}+\\frac{f(f(y))}{f(y)}\\right) .\n\\]\n\nTake \\(x=y\\) in (6) and apply (3). This gives \\(f(x) f(f(x))+f(x f(x))=2 \\frac{f(f(x))}{x}\\), which means\n\n\\[\nf(x f(x))=f(f(x))\\left(\\frac{2}{x}-f(x)\\right)\n\\]\n\nUsing (3), equation (2) can be rewritten as\n\n\\[\nf(x) f(f(y))+f(y f(x))=f(y) f(f(x))+f(x f(y))\n\\]\n\nSuppose \\(f(x)=f(y)\\) for some \\(x, y \\in \\mathbb{R}^{+}\\). Then (8) implies\n\n\\[\nf(y f(y))=f(y f(x))=f(x f(y))=f(x f(x))\n\\]\n\nUsing (7), this gives\n\n\\[\nf(f(y))\\left(\\frac{2}{y}-f(y)\\right)=f(f(x))\\left(\\frac{2}{x}-f(x)\\right)\n\\]\n\nNoting \\(f(x)=f(y)\\), we find \\(x=y\\). This establishes the injectivity.\n\nBy the Claim and (5), we get the only possible solution \\(f(x)=\\frac{1}{x}\\). It suffices to check that this is a solution. Indeed, the left-hand side of (1) becomes\n\n\\[\nx \\cdot \\frac{1}{x^{2}} \\cdot y+\\frac{x}{y}=\\frac{y}{x}+\\frac{x}{y}\n\\]\n\nwhile the right-hand side becomes\n\n\\[\n\\frac{1}{x y}\\left(x^{2}+y^{2}\\right)=\\frac{x}{y}+\\frac{y}{x}\n\\]\n\nThe two sides agree with each other.\nSolution 2. Taking \\(x=y=1\\) in (1), we get \\(f(1) f(f(1))+f(f(1))=2 f(1) f(f(1))\\) and hence \\(f(1)=1\\). Putting \\(x=1\\) in (1), we have \\(f(f(y))+f(y)=f(y)\\left(1+f\\left(f\\left(y^{2}\\right)\\right)\\right)\\) so that\n\n\\[\nf(f(y))=f(y) f\\left(f\\left(y^{2}\\right)\\right)\n\\]\n\nPutting \\(y=1\\) in (1), we get \\(x f\\left(x^{2}\\right)+f(f(x))=f(x)\\left(f\\left(f\\left(x^{2}\\right)\\right)+1\\right)\\). Using (9), this gives\n\n\\[\nx f\\left(x^{2}\\right)=f(x)\n\\]\n\nReplace \\(y\\) by \\(\\frac{1}{x}\\) in (1). Then we have\n\n\\[\nx f\\left(x^{2}\\right) f\\left(f\\left(\\frac{1}{x}\\right)\\right)+f\\left(\\frac{f(x)}{x}\\right)=f\\left(f\\left(x^{2}\\right)\\right)+f\\left(f\\left(\\frac{1}{x^{2}}\\right)\\right) .\n\\]\n\nThe relation (10) shows \\(f\\left(\\frac{f(x)}{x}\\right)=f\\left(f\\left(x^{2}\\right)\\right)\\). Also, using (9) with \\(y=\\frac{1}{x}\\) and using (10) again, the last equation reduces to\n\n\\[\nf(x) f\\left(\\frac{1}{x}\\right)=1\n\\]\n\nReplace \\(x\\) by \\(\\frac{1}{x}\\) and \\(y\\) by \\(\\frac{1}{y}\\) in (1) and apply (11). We get\n\n\\[\n\\frac{1}{x f\\left(x^{2}\\right) f(f(y))}+\\frac{1}{f(y f(x))}=\\frac{1}{f(x y)}\\left(\\frac{1}{f\\left(f\\left(x^{2}\\right)\\right)}+\\frac{1}{f\\left(f\\left(y^{2}\\right)\\right)}\\right)\n\\]\n\nClearing denominators, we can use (1) to simplify the numerators and obtain\n\n\\[\nf(x y)^{2} f\\left(f\\left(x^{2}\\right)\\right) f\\left(f\\left(y^{2}\\right)\\right)=x f\\left(x^{2}\\right) f(f(y)) f(y f(x))\n\\]\n\nUsing (9) and (10), this is the same as\n\n\\[\nf(x y)^{2} f(f(x))=f(x)^{2} f(y) f(y f(x))\n\\]\n\nSubstitute \\(y=f(x)\\) in (12) and apply (10) (with \\(x\\) replaced by \\(f(x)\\) ). We have\n\n\\[\nf(x f(x))^{2}=f(x) f(f(x))\n\\]\n\nTaking \\(y=x\\) in (12), squaring both sides, and using (10) and (13), we find that\n\n\\[\nf(f(x))=x^{4} f(x)^{3}\n\\]\n\nFinally, we combine (9), (10) and (14) to get\n\n\\[\ny^{4} f(y)^{3} \\stackrel{(14)}{=} f(f(y)) \\stackrel{(9)}{=} f(y) f\\left(f\\left(y^{2}\\right)\\right) \\stackrel{(14)}{=} f(y) y^{8} f\\left(y^{2}\\right)^{3} \\stackrel{(10)}{=} y^{5} f(y)^{4}\n\\]\n\nwhich implies \\(f(y)=\\frac{1}{y}\\). This is a solution by the checking in Solution 1 ."}
{"id": "imo-shortlist-2016-c1", "question": "C1. The leader of an IMO team chooses positive integers \\(n\\) and \\(k\\) with \\(n>k\\), and announces them to the deputy leader and a contestant. The leader then secretly tells the deputy leader an \\(n\\)-digit binary string, and the deputy leader writes down all \\(n\\)-digit binary strings which differ from the leader's in exactly \\(k\\) positions. (For example, if \\(n=3\\) and \\(k=1\\), and if the leader chooses 101, the deputy leader would write down 001, 111 and 100.) The contestant is allowed to look at the strings written by the deputy leader and guess the leader's string. What is the minimum number of guesses (in terms of \\(n\\) and \\(k\\) ) needed to guarantee the correct answer?\n\nAnswer. The minimum number of guesses is 2 if \\(n=2 k\\) and 1 if \\(n \\neq 2 k\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2016, "solution": "Let \\(X\\) be the binary string chosen by the leader and let \\(X^{\\prime}\\) be the binary string of length \\(n\\) every digit of which is different from that of \\(X\\). The strings written by the deputy leader are the same as those in the case when the leader's string is \\(X^{\\prime}\\) and \\(k\\) is changed to \\(n-k\\). In view of this, we may assume \\(k \\geqslant \\frac{n}{2}\\). Also, for the particular case \\(k=\\frac{n}{2}\\), this argument shows that the strings \\(X\\) and \\(X^{\\prime}\\) cannot be distinguished, and hence in that case the contestant has to guess at least twice.\n\nIt remains to show that the number of guesses claimed suffices. Consider any string \\(Y\\) which differs from \\(X\\) in \\(m\\) digits where \\(0<m<2 k\\). Without loss of generality, assume the first \\(m\\) digits of \\(X\\) and \\(Y\\) are distinct. Let \\(Z\\) be the binary string obtained from \\(X\\) by changing its first \\(k\\) digits. Then \\(Z\\) is written by the deputy leader. Note that \\(Z\\) differs from \\(Y\\) by \\(|m-k|\\) digits where \\(|m-k|<k\\) since \\(0<m<2 k\\). From this observation, the contestant must know that \\(Y\\) is not the desired string.\n\nAs we have assumed \\(k \\geqslant \\frac{n}{2}\\), when \\(n<2 k\\), every string \\(Y \\neq X\\) differs from \\(X\\) in fewer than \\(2 k\\) digits. When \\(n=2 k\\), every string except \\(X\\) and \\(X^{\\prime}\\) differs from \\(X\\) in fewer than \\(2 k\\) digits. Hence, the answer is as claimed.\n\nSolution 2. Firstly, assume \\(n \\neq 2 k\\). Without loss of generality suppose the first digit of the leader's string is 1 . Then among the \\(\\binom{n}{k}\\) strings written by the deputy leader, \\(\\binom{n-1}{k}\\) will begin with 1 and \\(\\binom{n-1}{k-1}\\) will begin with 0 . Since \\(n \\neq 2 k\\), we have \\(k+(k-1) \\neq n-1\\) and so \\(\\binom{n-1}{k} \\neq\\binom{ n-1}{k-1}\\). Thus, by counting the number of strings written by the deputy leader that start with 0 and 1 , the contestant can tell the first digit of the leader's string. The same can be done on the other digits, so 1 guess suffices when \\(n \\neq 2 k\\).\n\nSecondly, for the case \\(n=2\\) and \\(k=1\\), the answer is clearly 2 . For the remaining cases where \\(n=2 k>2\\), the deputy leader would write down the same strings if the leader's string \\(X\\) is replaced by \\(X^{\\prime}\\) obtained by changing each digit of \\(X\\). This shows at least 2 guesses are needed. We shall show that 2 guesses suffice in this case. Suppose the first two digits of the leader's string are the same. Then among the strings written by the deputy leader, the prefices 01 and 10 will occur \\(\\binom{2 k-2}{k-1}\\) times each, while the prefices 00 and 11 will occur \\(\\binom{2 k-2}{k}\\) times each. The two numbers are interchanged if the first two digits of the leader's string are different. Since \\(\\binom{2 k-2}{k-1} \\neq\\binom{ 2 k-2}{k}\\), the contestant can tell whether the first two digits of the leader's string are the same or not. He can work out the relation of the first digit and the\nother digits in the same way and reduce the leader's string to only 2 possibilities. The proof is complete."}
{"id": "imo-shortlist-2016-c2", "question": "C2. Find all positive integers \\(n\\) for which all positive divisors of \\(n\\) can be put into the cells of a rectangular table under the following constraints:\n\n\\begin{itemize}\n  \\item each cell contains a distinct divisor;\n  \\item the sums of all rows are equal; and\n  \\item the sums of all columns are equal.\n\n\nAnswer. 1.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2016, "solution": "Suppose all positive divisors of \\(n\\) can be arranged into a rectangular table of size \\(k \\times l\\) where the number of rows \\(k\\) does not exceed the number of columns \\(l\\). Let the sum of numbers in each column be \\(s\\). Since \\(n\\) belongs to one of the columns, we have \\(s \\geqslant n\\), where equality holds only when \\(n=1\\).\n\nFor \\(j=1,2, \\ldots, l\\), let \\(d_{j}\\) be the largest number in the \\(j\\)-th column. Without loss of generality, assume \\(d_{1}>d_{2}>\\cdots>d_{l}\\). Since these are divisors of \\(n\\), we have\n\n\\[\nd_{l} \\leqslant \\frac{n}{l}\n\\]\n\nAs \\(d_{l}\\) is the maximum entry of the \\(l\\)-th column, we must have\n\n\\[\nd_{l} \\geqslant \\frac{s}{k} \\geqslant \\frac{n}{k}\n\\]\n\nThe relations (1) and (2) combine to give \\(\\frac{n}{l} \\geqslant \\frac{n}{k}\\), that is, \\(k \\geqslant l\\). Together with \\(k \\leqslant l\\), we conclude that \\(k=l\\). Then all inequalities in (1) and (2) are equalities. In particular, \\(s=n\\) and so \\(n=1\\), in which case the conditions are clearly satisfied.\n\nSolution 2. Clearly \\(n=1\\) works. Then we assume \\(n>1\\) and let its prime factorization be \\(n=p_{1}^{r_{1}} p_{2}^{r_{2}} \\cdots p_{t}^{r_{t}}\\). Suppose the table has \\(k\\) rows and \\(l\\) columns with \\(1<k \\leqslant l\\). Note that \\(k l\\) is the number of positive divisors of \\(n\\) and the sum of all entries is the sum of positive divisors of \\(n\\), which we denote by \\(\\sigma(n)\\). Consider the column containing \\(n\\). Since the column sum is \\(\\frac{\\sigma(n)}{l}\\), we must have \\(\\frac{\\sigma(n)}{l}>n\\). Therefore, we have\n\n\\[\n\\begin{aligned}\n\\left(r_{1}+1\\right)\\left(r_{2}+1\\right) \\cdots\\left(r_{t}+1\\right) & =k l \\leqslant l^{2}<\\left(\\frac{\\sigma(n)}{n}\\right)^{2} \n& =\\left(1+\\frac{1}{p_{1}}+\\cdots+\\frac{1}{p_{1}^{r_{1}}}\\right)^{2} \\cdots\\left(1+\\frac{1}{p_{t}}+\\cdots+\\frac{1}{p_{t}^{r_{t}}}\\right)^{2}\n\n\\]\n\nThis can be rewritten as\n\n\\[\nf\\left(p_{1}, r_{1}\\right) f\\left(p_{2}, r_{2}\\right) \\cdots f\\left(p_{t}, r_{t}\\right)<1\n\\]\n\nwhere\n\n\\[\nf(p, r)=\\frac{r+1}{\\left(1+\\frac{1}{p}+\\cdots+\\frac{1}{p^{r}}\\right)^{2}}=\\frac{(r+1)\\left(1-\\frac{1}{p}\\right)^{2}}{\\left(1-\\frac{1}{p^{r+1}}\\right)^{2}}\n\\]\n\nDirect computation yields\n\n\\[\nf(2,1)=\\frac{8}{9}, \\quad f(2,2)=\\frac{48}{49}, \\quad f(3,1)=\\frac{9}{8}\n\\]\n\nAlso, we find that\n\n\\[\n\\begin{aligned}\n& f(2, r) \\geqslant\\left(1-\\frac{1}{2^{r+1}}\\right)^{-2}>1 \\quad \\text { for } r \\geqslant 3 \n& f(3, r) \\geqslant \\frac{4}{3}\\left(1-\\frac{1}{3^{r+1}}\\right)^{-2}>\\frac{4}{3}>\\frac{9}{8} \\quad \\text { for } r \\geqslant 2, \\text { and } \n& f(p, r) \\geqslant \\frac{32}{25}\\left(1-\\frac{1}{p^{r+1}}\\right)^{-2}>\\frac{32}{25}>\\frac{9}{8} \\quad \\text { for } p \\geqslant 5\n\n\\]\n\nFrom these values and bounds, it is clear that (3) holds only when \\(n=2\\) or 4. In both cases, it is easy to see that the conditions are not satisfied. Hence, the only possible \\(n\\) is 1 ."}
{"id": "imo-shortlist-2016-c3", "question": "C3. Let \\(n\\) be a positive integer relatively prime to 6 . We paint the vertices of a regular \\(n\\)-gon with three colours so that there is an odd number of vertices of each colour. Show that there exists an isosceles triangle whose three vertices are of different colours.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2016, "solution": "For \\(k=1,2,3\\), let \\(a_{k}\\) be the number of isosceles triangles whose vertices contain exactly \\(k\\) colours. Suppose on the contrary that \\(a_{3}=0\\). Let \\(b, c, d\\) be the number of vertices of the three different colours respectively. We now count the number of pairs \\((\\triangle, E)\\) where \\(\\Delta\\) is an isosceles triangle and \\(E\\) is a side of \\(\\Delta\\) whose endpoints are of different colours.\n\nOn the one hand, since we have assumed \\(a_{3}=0\\), each triangle in the pair must contain exactly two colours, and hence each triangle contributes twice. Thus the number of pairs is \\(2 a_{2}\\).\n\nOn the other hand, if we pick any two vertices \\(A, B\\) of distinct colours, then there are three isosceles triangles having these as vertices, two when \\(A B\\) is not the base and one when \\(A B\\) is the base since \\(n\\) is odd. Note that the three triangles are all distinct as \\((n, 3)=1\\). In this way, we count the number of pairs to be \\(3(b c+c d+d b)\\). However, note that \\(2 a_{2}\\) is even while \\(3(b c+c d+d b)\\) is odd, as each of \\(b, c, d\\) is. This yields a contradiction and hence \\(a_{3} \\geqslant 1\\).\n\nComment. A slightly stronger version of this problem is to replace the condition \\((n, 6)=1\\) by \\(n\\) being odd (where equilateral triangles are regarded as isosceles triangles). In that case, the only difference in the proof is that by fixing any two vertices \\(A, B\\), one can find exactly one or three isosceles triangles having these as vertices. But since only parity is concerned in the solution, the proof goes the same way.\n\nThe condition that there is an odd number of vertices of each colour is necessary, as can be seen from the following example. Consider \\(n=25\\) and we label the vertices \\(A_{0}, A_{1}, \\ldots, A_{24}\\). Suppose colour 1 is used for \\(A_{0}\\), colour 2 is used for \\(A_{5}, A_{10}, A_{15}, A_{20}\\), while colour 3 is used for the remaining vertices. Then any isosceles triangle having colours 1 and 2 must contain \\(A_{0}\\) and one of \\(A_{5}, A_{10}, A_{15}, A_{20}\\). Clearly, the third vertex must have index which is a multiple of 5 so it is not of colour 3 ."}
{"id": "imo-shortlist-2016-c4", "question": "C4. Find all positive integers \\(n\\) for which we can fill in the entries of an \\(n \\times n\\) table with the following properties:\n\n\\begin{itemize}\n  \\item each entry can be one of \\(I, M\\) and \\(O\\);\n  \\item in each row and each column, the letters \\(I, M\\) and \\(O\\) occur the same number of times; and\n  \\item in any diagonal whose number of entries is a multiple of three, the letters \\(I, M\\) and \\(O\\) occur the same number of times.\n\n\nAnswer. \\(n\\) can be any multiple of 9 .", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2016, "solution": "We first show that such a table exists when \\(n\\) is a multiple of 9 . Consider the following \\(9 \\times 9\\) table.\n\n\\[\n\\left(\\begin{array}{ccccccccc}\nI & I & I & M & M & M & O & O & O \nM & M & M & O & O & O & I & I & I \nO & O & O & I & I & I & M & M & M \nI & I & I & M & M & M & O & O & O \nM & M & M & O & O & O & I & I & I \nO & O & O & I & I & I & M & M & M \nI & I & I & M & M & M & O & O & O \nM & M & M & O & O & O & I & I & I \nO & O & O & I & I & I & M & M & M\n\\right)\n\\]\n\nIt is a direct checking that the table (1) satisfies the requirements. For \\(n=9 k\\) where \\(k\\) is a positive integer, we form an \\(n \\times n\\) table using \\(k \\times k\\) copies of (1). For each row and each column of the table of size \\(n\\), since there are three \\(I\\) 's, three \\(M\\) 's and three \\(O\\) 's for any nine consecutive entries, the numbers of \\(I, M\\) and \\(O\\) are equal. In addition, every diagonal of the large table whose number of entries is divisible by 3 intersects each copy of (1) at a diagonal with number of entries divisible by 3 (possibly zero). Therefore, every such diagonal also contains the same number of \\(I, M\\) and \\(O\\).\n\nNext, consider any \\(n \\times n\\) table for which the requirements can be met. As the number of entries of each row should be a multiple of 3 , we let \\(n=3 k\\) where \\(k\\) is a positive integer. We divide the whole table into \\(k \\times k\\) copies of \\(3 \\times 3\\) blocks. We call the entry at the centre of such a \\(3 \\times 3\\) square a vital entry. We also call any row, column or diagonal that contains at least one vital entry a vital line. We compute the number of pairs \\((l, c)\\) where \\(l\\) is a vital line and \\(c\\) is an entry belonging to \\(l\\) that contains the letter \\(M\\). We let this number be \\(N\\).\n\nOn the one hand, since each vital line contains the same number of \\(I, M\\) and \\(O\\), it is obvious that each vital row and each vital column contain \\(k\\) occurrences of \\(M\\). For vital diagonals in either direction, we count there are exactly\n\n\\[\n1+2+\\cdots+(k-1)+k+(k-1)+\\cdots+2+1=k^{2}\n\\]\n\noccurrences of \\(M\\). Therefore, we have \\(N=4 k^{2}\\).\n\nOn the other hand, there are \\(3 k^{2}\\) occurrences of \\(M\\) in the whole table. Note that each entry belongs to exactly 1 or 4 vital lines. Therefore, \\(N\\) must be congruent to \\(3 k^{2} \\bmod 3\\).\n\nFrom the double counting, we get \\(4 k^{2} \\equiv 3 k^{2}(\\bmod 3)\\), which forces \\(k\\) to be a multiple of 3. Therefore, \\(n\\) has to be a multiple of 9 and the proof is complete."}
{"id": "imo-shortlist-2016-c5", "question": "C5. Let \\(n \\geqslant 3\\) be a positive integer. Find the maximum number of diagonals of a regular \\(n\\)-gon one can select, so that any two of them do not intersect in the interior or they are perpendicular to each other.\n\nAnswer. \\(n-2\\) if \\(n\\) is even and \\(n-3\\) if \\(n\\) is odd.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2016, "solution": "We consider two cases according to the parity of \\(n\\).\n\n\\begin{itemize}\n  \\item Case 1. \\(n\\) is odd.\n\n\nWe first claim that no pair of diagonals is perpendicular. Suppose \\(A, B, C, D\\) are vertices where \\(A B\\) and \\(C D\\) are perpendicular, and let \\(E\\) be the vertex lying on the perpendicular bisector of \\(A B\\). Let \\(E^{\\prime}\\) be the opposite point of \\(E\\) on the circumcircle of the regular polygon. Since \\(E C=E^{\\prime} D\\) and \\(C, D, E\\) are vertices of the regular polygon, \\(E^{\\prime}\\) should also belong to the polygon. This contradicts the fact that a regular polygon with an odd number of vertices does not contain opposite points on the circumcircle.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2200921d1d27b7195e25g-39}\n\nTherefore in the odd case we can only select diagonals which do not intersect. In the maximal case these diagonals should divide the regular \\(n\\)-gon into \\(n-2\\) triangles, so we can select at most \\(n-3\\) diagonals. This can be done, for example, by selecting all diagonals emanated from a particular vertex.\n\n\\begin{itemize}\n  \\item Case 2. \\(n\\) is even.\n\n\nIf there is no intersection, then the proof in the odd case works. Suppose there are two perpendicular diagonals selected. We consider the set \\(S\\) of all selected diagonals parallel to one of them which intersect with some selected diagonals. Suppose \\(S\\) contains \\(k\\) diagonals and the number of distinct endpoints of the \\(k\\) diagonals is \\(l\\).\n\nFirstly, consider the longest diagonal in one of the two directions in \\(S\\). No other diagonal in \\(S\\) can start from either endpoint of that diagonal, since otherwise it has to meet another longer diagonal in \\(S\\). The same holds true for the other direction. Ignoring these two longest diagonals and their four endpoints, the remaining \\(k-2\\) diagonals share \\(l-4\\) endpoints where each endpoint can belong to at most two diagonals. This gives \\(2(l-4) \\geqslant 2(k-2)\\), so that \\(k \\leqslant l-2\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2200921d1d27b7195e25g-40}\n\nConsider a group of consecutive vertices of the regular \\(n\\)-gon so that each of the two outermost vertices is an endpoint of a diagonal in \\(S\\), while the interior points are not. There are \\(l\\) such groups. We label these groups \\(P_{1}, P_{2}, \\ldots, P_{l}\\) in this order. We claim that each selected diagonal outside \\(S\\) must connect vertices of the same group \\(P_{i}\\). Consider any diagonal \\(d\\) joining vertices from distinct groups \\(P_{i}\\) and \\(P_{j}\\). Let \\(d_{1}\\) and \\(d_{2}\\) be two diagonals in \\(S\\) each having one of the outermost points of \\(P_{i}\\) as endpoint. Then \\(d\\) must meet either \\(d_{1}, d_{2}\\) or a diagonal in \\(S\\) which is perpendicular to both \\(d_{1}\\) and \\(d_{2}\\). In any case \\(d\\) should belong to \\(S\\) by definition, which is a contradiction.\n\nWithin the same group \\(P_{i}\\), there are no perpendicular diagonals since the vertices belong to the same side of a diameter of the circumcircle. Hence there can be at most \\(\\left|P_{i}\\right|-2\\) selected diagonals within \\(P_{i}\\), including the one joining the two outermost points of \\(P_{i}\\) when \\(\\left|P_{i}\\right|>2\\). Therefore, the maximum number of diagonals selected is\n\n\\[\n\\sum_{i=1}^{l}\\left(\\left|P_{i}\\right|-2\\right)+k=\\sum_{i=1}^{l}\\left|P_{i}\\right|-2 l+k=(n+l)-2 l+k=n-l+k \\leqslant n-2 .\n\\]\n\nThis upper bound can be attained as follows. We take any vertex \\(A\\) and let \\(A^{\\prime}\\) be the vertex for which \\(A A^{\\prime}\\) is a diameter of the circumcircle. If we select all diagonals emanated from \\(A\\) together with the diagonal \\(d^{\\prime}\\) joining the two neighbouring vertices of \\(A^{\\prime}\\), then the only pair of diagonals that meet each other is \\(A A^{\\prime}\\) and \\(d^{\\prime}\\), which are perpendicular to each other. In total we can take \\(n-2\\) diagonals.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2200921d1d27b7195e25g-40(1)}\n\nSolution 2. The constructions and the odd case are the same as Solution 1. Instead of dealing separately with the case where \\(n\\) is even, we shall prove by induction more generally that we can select at most \\(n-2\\) diagonals for any cyclic \\(n\\)-gon with circumcircle \\(\\Gamma\\).\n\nThe base case \\(n=3\\) is trivial since there is no diagonal at all. Suppose the upper bound holds for any cyclic polygon with fewer than \\(n\\) sides. For a cyclic \\(n\\)-gon, if there is a selected diagonal which does not intersect any other selected diagonal, then this diagonal divides the \\(n\\)-gon into an \\(m\\)-gon and an \\(l\\)-gon (with \\(m+l=n+2\\) ) so that each selected diagonal belongs to one of them. Without loss of generality, we may assume the \\(m\\)-gon lies on the same side of a diameter of \\(\\Gamma\\). Then no two selected diagonals of the \\(m\\)-gon can intersect, and hence we can select at most \\(m-3\\) diagonals. Also, we can apply the inductive hypothesis to the \\(l\\)-gon. This shows the maximum number of selected diagonals is \\((m-3)+(l-2)+1=n-2\\).\n\nIt remains to consider the case when all selected diagonals meet at least one other selected diagonal. Consider a pair of selected perpendicular diagonals \\(d_{1}, d_{2}\\). They divide the circumference of \\(\\Gamma\\) into four arcs, each of which lies on the same side of a diameter of \\(\\Gamma\\). If there are two selected diagonals intersecting each other and neither is parallel to \\(d_{1}\\) or \\(d_{2}\\), then their endpoints must belong to the same arc determined by \\(d_{1}, d_{2}\\), and hence they cannot be perpendicular. This violates the condition, and hence all selected diagonals must have the same direction as one of \\(d_{1}, d_{2}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2200921d1d27b7195e25g-41}\n\nTake the longest selected diagonal in one of the two directions. We argue as in Solution 1 that its endpoints do not belong to any other selected diagonal. The same holds true for the longest diagonal in the other direction. Apart from these four endpoints, each of the remaining \\(n-4\\) vertices can belong to at most two selected diagonals. Thus we can select at most \\(\\frac{1}{2}(2(n-4)+4)=n-2\\) diagonals. Then the proof follows by induction."}
{"id": "imo-shortlist-2016-c6", "question": "C6. There are \\(n \\geqslant 3\\) islands in a city. Initially, the ferry company offers some routes between some pairs of islands so that it is impossible to divide the islands into two groups such that no two islands in different groups are connected by a ferry route.\n\nAfter each year, the ferry company will close a ferry route between some two islands \\(X\\) and \\(Y\\). At the same time, in order to maintain its service, the company will open new routes according to the following rule: for any island which is connected by a ferry route to exactly one of \\(X\\) and \\(Y\\), a new route between this island and the other of \\(X\\) and \\(Y\\) is added.\n\nSuppose at any moment, if we partition all islands into two nonempty groups in any way, then it is known that the ferry company will close a certain route connecting two islands from the two groups after some years. Prove that after some years there will be an island which is connected to all other islands by ferry routes.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2016, "solution": "Initially, we pick any pair of islands \\(A\\) and \\(B\\) which are connected by a ferry route and put \\(A\\) in set \\(\\mathcal{A}\\) and \\(B\\) in set \\(\\mathcal{B}\\). From the condition, without loss of generality there must be another island which is connected to \\(A\\). We put such an island \\(C\\) in set \\(\\mathcal{B}\\). We say that two sets of islands form a network if each island in one set is connected to each island in the other set.\n\nNext, we shall included all islands to \\(\\mathcal{A} \\cup \\mathcal{B}\\) one by one. Suppose we have two sets \\(\\mathcal{A}\\) and \\(\\mathcal{B}\\) which form a network where \\(3 \\leqslant|\\mathcal{A} \\cup \\mathcal{B}|<n\\). This relation no longer holds only when a ferry route between islands \\(A \\in \\mathcal{A}\\) and \\(B \\in \\mathcal{B}\\) is closed. In that case, we define \\(\\mathcal{A}^{\\prime}=\\{A, B\\}\\), and \\(\\mathcal{B}^{\\prime}=(\\mathcal{A} \\cup \\mathcal{B})-\\{A, B\\}\\). Note that \\(\\mathcal{B}^{\\prime}\\) is nonempty. Consider any island \\(C \\in \\mathcal{A}-\\{A\\}\\). From the relation of \\(\\mathcal{A}\\) and \\(\\mathcal{B}\\), we know that \\(C\\) is connected to \\(B\\). If \\(C\\) was not connected to \\(A\\) before the route between \\(A\\) and \\(B\\) closes, then there will be a route added between \\(C\\) and \\(A\\) afterwards. Hence, \\(C\\) must now be connected to both \\(A\\) and \\(B\\). The same holds true for any island in \\(\\mathcal{B}-\\{B\\}\\). Therefore, \\(\\mathcal{A}^{\\prime}\\) and \\(\\mathcal{B}^{\\prime}\\) form a network, and \\(\\mathcal{A}^{\\prime} \\cup \\mathcal{B}^{\\prime}=\\mathcal{A} \\cup \\mathcal{B}\\). Hence these islands can always be partitioned into sets \\(\\mathcal{A}\\) and \\(\\mathcal{B}\\) which form a network.\n\nAs \\(|\\mathcal{A} \\cup \\mathcal{B}|<n\\), there are some islands which are not included in \\(\\mathcal{A} \\cup \\mathcal{B}\\). From the condition, after some years there must be a ferry route between an island \\(A\\) in \\(\\mathcal{A} \\cup \\mathcal{B}\\) and an island \\(D\\) outside \\(\\mathcal{A} \\cup \\mathcal{B}\\) which closes. Without loss of generality assume \\(A \\in \\mathcal{A}\\). Then each island in \\(\\mathcal{B}\\) must then be connected to \\(D\\), no matter it was or not before. Hence, we can put \\(D\\) in set \\(\\mathcal{A}\\) so that the new sets \\(\\mathcal{A}\\) and \\(\\mathcal{B}\\) still form a network and the size of \\(\\mathcal{A} \\cup \\mathcal{B}\\) is increased by 1 . The same process can be done to increase the size of \\(\\mathcal{A} \\cup \\mathcal{B}\\). Eventually, all islands are included in this way so we may now assume \\(|\\mathcal{A} \\cup \\mathcal{B}|=n\\).\n\nSuppose a ferry route between \\(A \\in \\mathcal{A}\\) and \\(B \\in \\mathcal{B}\\) is closed after some years. We put \\(A\\) and \\(B\\) in set \\(\\mathcal{A}^{\\prime}\\) and all remaining islands in set \\(\\mathcal{B}^{\\prime}\\). Then \\(\\mathcal{A}^{\\prime}\\) and \\(\\mathcal{B}^{\\prime}\\) form a network. This relation no longer holds only when a route between \\(A\\), without loss of generality, and \\(C \\in \\mathcal{B}^{\\prime}\\) is closed. Since this must eventually occur, at that time island \\(B\\) will be connected to all other islands and the result follows."}
{"id": "imo-shortlist-2016-c7", "question": "C7. Let \\(n \\geqslant 2\\) be an integer. In the plane, there are \\(n\\) segments given in such a way that any two segments have an intersection point in the interior, and no three segments intersect at a single point. Jeff places a snail at one of the endpoints of each of the segments and claps his hands \\(n-1\\) times. Each time when he claps his hands, all the snails move along their own segments and stay at the next intersection points until the next clap. Since there are \\(n-1\\) intersection points on each segment, all snails will reach the furthest intersection points from their starting points after \\(n-1\\) claps.\n(a) Prove that if \\(n\\) is odd then Jeff can always place the snails so that no two of them ever occupy the same intersection point.\n(b) Prove that if \\(n\\) is even then there must be a moment when some two snails occupy the same intersection point no matter how Jeff places the snails.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2016, "solution": "We consider a big disk which contains all the segments. We extend each segment to a line \\(l_{i}\\) so that each of them cuts the disk at two distinct points \\(A_{i}, B_{i}\\).\n(a) For odd \\(n\\), we travel along the circumference of the disk and mark each of the points \\(A_{i}\\) or \\(B_{i}\\) 'in' and 'out' alternately. Since every pair of lines intersect in the disk, there are exactly \\(n-1\\) points between \\(A_{i}\\) and \\(B_{i}\\) for any fixed \\(1 \\leqslant i \\leqslant n\\). As \\(n\\) is odd, this means one of \\(A_{i}\\) and \\(B_{i}\\) is marked 'in' and the other is marked 'out'. Then Jeff can put a snail on the endpoint of each segment which is closer to the 'in' side of the corresponding line. We claim that the snails on \\(l_{i}\\) and \\(l_{j}\\) do not meet for any pairs \\(i, j\\), hence proving part (a).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2200921d1d27b7195e25g-43}\n\nWithout loss of generality, we may assume the snails start at \\(A_{i}\\) and \\(A_{j}\\) respectively. Let \\(l_{i}\\) intersect \\(l_{j}\\) at \\(P\\). Note that there is an odd number of points between \\(\\operatorname{arc} A_{i} A_{j}\\). Each of these points belongs to a line \\(l_{k}\\). Such a line \\(l_{k}\\) must intersect exactly one of\nthe segments \\(A_{i} P\\) and \\(A_{j} P\\), making an odd number of intersections. For the other lines, they may intersect both segments \\(A_{i} P\\) and \\(A_{j} P\\), or meet none of them. Therefore, the total number of intersection points on segments \\(A_{i} P\\) and \\(A_{j} P\\) (not counting \\(P\\) ) is odd. However, if the snails arrive at \\(P\\) at the same time, then there should be the same number of intersections on \\(A_{i} P\\) and \\(A_{j} P\\), which gives an even number of intersections. This is a contradiction so the snails do not meet each other.\n(b) For even \\(n\\), we consider any way that Jeff places the snails and mark each of the points \\(A_{i}\\) or \\(B_{i}\\) 'in' and 'out' according to the directions travelled by the snails. In this case there must be two neighbouring points \\(A_{i}\\) and \\(A_{j}\\) both of which are marked 'in'. Let \\(P\\) be the intersection of the segments \\(A_{i} B_{i}\\) and \\(A_{j} B_{j}\\). Then any other segment meeting one of the segments \\(A_{i} P\\) and \\(A_{j} P\\) must also meet the other one, and so the number of intersections on \\(A_{i} P\\) and \\(A_{j} P\\) are the same. This shows the snails starting from \\(A_{i}\\) and \\(A_{j}\\) will meet at \\(P\\).\n\nComment. The conclusions do not hold for pseudosegments, as can be seen from the following examples.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2200921d1d27b7195e25g-44}"}
{"id": "imo-shortlist-2016-c8", "question": "C8. Let \\(n\\) be a positive integer. Determine the smallest positive integer \\(k\\) with the following property: it is possible to mark \\(k\\) cells on a \\(2 n \\times 2 n\\) board so that there exists a unique partition of the board into \\(1 \\times 2\\) and \\(2 \\times 1\\) dominoes, none of which contains two marked cells.\n\nAnswer. 2n.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2016, "solution": "We first construct an example of marking \\(2 n\\) cells satisfying the requirement. Label the rows and columns \\(1,2, \\ldots, 2 n\\) and label the cell in the \\(i\\)-th row and the \\(j\\)-th column \\((i, j)\\).\n\nFor \\(i=1,2, \\ldots, n\\), we mark the cells \\((i, i)\\) and \\((i, i+1)\\). We claim that the required partition exists and is unique. The two diagonals of the board divide the board into four regions. Note that the domino covering cell \\((1,1)\\) must be vertical. This in turn shows that each domino covering \\((2,2),(3,3), \\ldots,(n, n)\\) is vertical. By induction, the dominoes in the left region are all vertical. By rotational symmetry, the dominoes in the bottom region are horizontal, and so on. This shows that the partition exists and is unique.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2200921d1d27b7195e25g-45}\n\nIt remains to show that this value of \\(k\\) is the smallest possible. Assume that only \\(k<2 n\\) cells are marked, and there exists a partition \\(P\\) satisfying the requirement. It suffices to show there exists another desirable partition distinct from \\(P\\). Let \\(d\\) be the main diagonal of the board.\n\nConstruct the following graph with edges of two colours. Its vertices are the cells of the board. Connect two vertices with a red edge if they belong to the same domino of \\(P\\). Connect two vertices with a blue edge if their reflections in \\(d\\) are connected by a red edge. It is possible that two vertices are connected by edges of both colours. Clearly, each vertex has both red and blue degrees equal to 1 . Thus the graph splits into cycles where the colours of edges in each cycle alternate (a cycle may have length 2).\n\nConsider any cell \\(c\\) lying on the diagonal \\(d\\). Its two edges are symmetrical with respect to \\(d\\). Thus they connect \\(c\\) to different cells. This shows \\(c\\) belongs to a cycle \\(C(c)\\) of length at least 4 . Consider a part of this cycle \\(c_{0}, c_{1}, \\ldots, c_{m}\\) where \\(c_{0}=c\\) and \\(m\\) is the least positive integer such that \\(c_{m}\\) lies on \\(d\\). Clearly, \\(c_{m}\\) is distinct from \\(c\\). From the construction, the path symmetrical to this with respect to \\(d\\) also lies in the graph, and so these paths together form \\(C(c)\\). Hence, \\(C(c)\\) contains exactly two cells from \\(d\\). Then all \\(2 n\\) cells in \\(d\\) belong to \\(n\\) cycles \\(C_{1}, C_{2}, \\ldots, C_{n}\\), each has length at least 4 .\n\nBy the Pigeonhole Principle, there exists a cycle \\(C_{i}\\) containing at most one of the \\(k\\) marked cells. We modify \\(P\\) as follows. We remove all dominoes containing the vertices of \\(C_{i}\\), which\ncorrespond to the red edges of \\(C_{i}\\). Then we put the dominoes corresponding to the blue edges of \\(C_{i}\\). Since \\(C_{i}\\) has at least 4 vertices, the resultant partition \\(P^{\\prime}\\) is different from \\(P\\). Clearly, no domino in \\(P^{\\prime}\\) contains two marked cells as \\(C_{i}\\) contains at most one marked cell. This shows the partition is not unique and hence \\(k\\) cannot be less than \\(2 n\\)."}
{"id": "imo-shortlist-2016-g1", "question": "G1. In a convex pentagon \\(A B C D E\\), let \\(F\\) be a point on \\(A C\\) such that \\(\\angle F B C=90^{\\circ}\\). Suppose triangles \\(A B F, A C D\\) and \\(A D E\\) are similar isosceles triangles with\n\n\\[\n\\angle F A B=\\angle F B A=\\angle D A C=\\angle D C A=\\angle E A D=\\angle E D A .\n\\]\n\nLet \\(M\\) be the midpoint of \\(C F\\). Point \\(X\\) is chosen such that \\(A M X E\\) is a parallelogram. Show that \\(B D, E M\\) and \\(F X\\) are concurrent.", "category": "Geometry", "source": "IMO Shortlist", "year": 2016, "solution": "Denote the common angle in (1) by \\(\\theta\\). As \\(\\triangle A B F \\sim \\triangle A C D\\), we have \\(\\frac{A B}{A C}=\\frac{A F}{A D}\\) so that \\(\\triangle A B C \\sim \\triangle A F D\\). From \\(E A=E D\\), we get\n\n\\[\n\\angle A F D=\\angle A B C=90^{\\circ}+\\theta=180^{\\circ}-\\frac{1}{2} \\angle A E D .\n\\]\n\nHence, \\(F\\) lies on the circle with centre \\(E\\) and radius \\(E A\\). In particular, \\(E F=E A=E D\\). As \\(\\angle E F A=\\angle E A F=2 \\theta=\\angle B F C\\), points \\(B, F, E\\) are collinear.\n\nAs \\(\\angle E D A=\\angle M A D\\), we have \\(E D / / A M\\) and hence \\(E, D, X\\) are collinear. As \\(M\\) is the midpoint of \\(C F\\) and \\(\\angle C B F=90^{\\circ}\\), we get \\(M F=M B\\). In the isosceles triangles \\(E F A\\) and \\(M F B\\), we have \\(\\angle E F A=\\angle M F B\\) and \\(A F=B F\\). Therefore, they are congruent to each other. Then we have \\(B M=A E=X M\\) and \\(B E=B F+F E=A F+F M=A M=E X\\). This shows \\(\\triangle E M B \\cong \\triangle E M X\\). As \\(F\\) and \\(D\\) lie on \\(E B\\) and \\(E X\\) respectively and \\(E F=E D\\), we know that lines \\(B D\\) and \\(X F\\) are symmetric with respect to \\(E M\\). It follows that the three lines are concurrent.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2200921d1d27b7195e25g-47}\n\nSolution 2. From \\(\\angle C A D=\\angle E D A\\), we have \\(A C / / E D\\). Together with \\(A C / / E X\\), we know that \\(E, D, X\\) are collinear. Denote the common angle in (1) by \\(\\theta\\). From \\(\\triangle A B F \\sim \\triangle A C D\\), we get \\(\\frac{A B}{A C}=\\frac{A F}{A D}\\) so that \\(\\triangle A B C \\sim \\triangle A F D\\). This yields \\(\\angle A F D=\\angle A B C=90^{\\circ}+\\theta\\) and hence \\(\\angle F D C=90^{\\circ}\\), implying that \\(B C D F\\) is cyclic. Let \\(\\Gamma_{1}\\) be its circumcircle.\n\nNext, from \\(\\triangle A B F \\sim \\triangle A D E\\), we have \\(\\frac{A B}{A D}=\\frac{A F}{A E}\\) so that \\(\\triangle A B D \\sim \\triangle A F E\\). Therefore,\n\n\\[\n\\angle A F E=\\angle A B D=\\theta+\\angle F B D=\\theta+\\angle F C D=2 \\theta=180^{\\circ}-\\angle B F A .\n\\]\n\nThis implies \\(B, F, E\\) are collinear. Note that \\(F\\) is the incentre of triangle \\(D A B\\). Point \\(E\\) lies on the internal angle bisector of \\(\\angle D B A\\) and lies on the perpendicular bisector of \\(A D\\). It follows that \\(E\\) lies on the circumcircle \\(\\Gamma_{2}\\) of triangle \\(A B D\\), and \\(E A=E F=E D\\).\n\nAlso, since \\(C F\\) is a diameter of \\(\\Gamma_{1}\\) and \\(M\\) is the midpoint of \\(C F, M\\) is the centre of \\(\\Gamma_{1}\\) and hence \\(\\angle A M D=2 \\theta=\\angle A B D\\). This shows \\(M\\) lies on \\(\\Gamma_{2}\\). Next, \\(\\angle M D X=\\angle M A E=\\angle D X M\\) since \\(A M X E\\) is a parallelogram. Hence \\(M D=M X\\) and \\(X\\) lies on \\(\\Gamma_{1}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2200921d1d27b7195e25g-48}\n\nWe now have two ways to complete the solution.\n\n\\begin{itemize}\n  \\item Method 1. From \\(E F=E A=X M\\) and \\(E X / / F M, E F M X\\) is an isosceles trapezoid and is cyclic. Denote its circumcircle by \\(\\Gamma_{3}\\). Since \\(B D, E M, F X\\) are the three radical axes of \\(\\Gamma_{1}, \\Gamma_{2}, \\Gamma_{3}\\), they must be concurrent.\n  \\item Method 2. As \\(\\angle D M F=2 \\theta=\\angle B F M\\), we have \\(D M / / E B\\). Also, \\(\\angle B F D+\\angle X B F=\\angle B F C+\\angle C F D+90^{\\circ}-\\angle C B X=2 \\theta+\\left(90^{\\circ}-\\theta\\right)+90^{\\circ}-\\theta=180^{\\circ}\\)\nimplies \\(D F / / X B\\). These show the corresponding sides of triangles \\(D M F\\) and \\(B E X\\) are parallel. By Desargues' Theorem, the two triangles are perspective and hence \\(D B, M E, F X\\) meet at a point.\n\n\nComment. In Solution 2, both the Radical Axis Theorem and Desargues' Theorem could imply \\(D B, M E, F X\\) are parallel. However, this is impossible as can be seen from the configuration. For example, it is obvious that \\(D B\\) and \\(M E\\) meet each other.\nSolution 3. Let the common angle in (1) be \\(\\theta\\). From \\(\\triangle A B F \\sim \\triangle A C D\\), we have \\(\\frac{A B}{A C}=\\frac{A F}{A D}\\) so that \\(\\triangle A B C \\sim \\triangle A F D\\). Then \\(\\angle A D F=\\angle A C B=90^{\\circ}-2 \\theta=90^{\\circ}-\\angle B A D\\) and hence \\(D F \\perp A B\\). As \\(F A=F B\\), this implies \\(\\triangle D A B\\) is isosceles with \\(D A=D B\\). Then \\(F\\) is the incentre of \\(\\triangle D A B\\).\n\nNext, from \\(\\angle A E D=180^{\\circ}-2 \\theta=180^{\\circ}-\\angle D B A\\), points \\(A, B, D, E\\) are concyclic. Since we also have \\(E A=E D\\), this shows \\(E, F, B\\) are collinear and \\(E A=E F=E D\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2200921d1d27b7195e25g-49}\n\nNote that \\(C\\) lies on the internal angle bisector of \\(\\angle B A D\\) and lies on the external angle bisector of \\(\\angle D B A\\). It follows that it is the \\(A\\)-excentre of triangle \\(D A B\\). As \\(M\\) is the midpoint of \\(C F, M\\) lies on the circumcircle of triangle \\(D A B\\) and it is the centre of the circle passing through \\(D, F, B, C\\). By symmetry, \\(D E F M\\) is a rhombus. Then the midpoints of \\(A X, E M\\) and \\(D F\\) coincide, and it follows that \\(D A F X\\) is a parallelogram.\n\nLet \\(P\\) be the intersection of \\(B D\\) and \\(E M\\), and \\(Q\\) be the intersection of \\(A D\\) and \\(B E\\). From \\(\\angle B A C=\\angle D C A\\), we know that \\(D C, A B, E M\\) are parallel. Thus we have \\(\\frac{D P}{P B}=\\frac{C M}{M A}\\). This is further equal to \\(\\frac{A E}{B E}\\) since \\(C M=D M=D E=A E\\) and \\(M A=B E\\). From \\(\\triangle A E Q \\sim \\triangle B E A\\), we find that\n\n\\[\n\\frac{D P}{P B}=\\frac{A E}{B E}=\\frac{A Q}{B A}=\\frac{Q F}{F B}\n\\]\n\nby the Angle Bisector Theorem. This implies \\(Q D / / F P\\) and hence \\(F, P, X\\) are collinear, as desired."}
{"id": "imo-shortlist-2016-g2", "question": "G2. Let \\(A B C\\) be a triangle with circumcircle \\(\\Gamma\\) and incentre \\(I\\). Let \\(M\\) be the midpoint of side \\(B C\\). Denote by \\(D\\) the foot of perpendicular from \\(I\\) to side \\(B C\\). The line through \\(I\\) perpendicular to \\(A I\\) meets sides \\(A B\\) and \\(A C\\) at \\(F\\) and \\(E\\) respectively. Suppose the circumcircle of triangle \\(A E F\\) intersects \\(\\Gamma\\) at a point \\(X\\) other than \\(A\\). Prove that lines \\(X D\\) and \\(A M\\) meet on \\(\\Gamma\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2016, "solution": "Let \\(A M\\) meet \\(\\Gamma\\) again at \\(Y\\) and \\(X Y\\) meet \\(B C\\) at \\(D^{\\prime}\\). It suffices to show \\(D^{\\prime}=D\\). We shall apply the following fact.\n\n\\begin{itemize}\n  \\item Claim. For any cyclic quadrilateral \\(P Q R S\\) whose diagonals meet at \\(T\\), we have\n\n\n\\[\n\\frac{Q T}{T S}=\\frac{P Q \\cdot Q R}{P S \\cdot S R}\n\\]\n\nProof. We use \\(\\left[W_{1} W_{2} W_{3}\\right]\\) to denote the area of \\(W_{1} W_{2} W_{3}\\). Then\n\n\\[\n\\frac{Q T}{T S}=\\frac{[P Q R]}{[P S R]}=\\frac{\\frac{1}{2} P Q \\cdot Q R \\sin \\angle P Q R}{\\frac{1}{2} P S \\cdot S R \\sin \\angle P S R}=\\frac{P Q \\cdot Q R}{P S \\cdot S R}\n\\]\n\nApplying the Claim to \\(A B Y C\\) and \\(X B Y C\\) respectively, we have \\(1=\\frac{B M}{M C}=\\frac{A B \\cdot B Y}{A C \\cdot C Y}\\) and \\(\\frac{B D^{\\prime}}{D^{\\prime} C}=\\frac{X B \\cdot B Y}{X C \\cdot C Y}\\). These combine to give\n\n\\[\n\\frac{B D^{\\prime}}{C D^{\\prime}}=\\frac{X B}{X C} \\cdot \\frac{B Y}{C Y}=\\frac{X B}{X C} \\cdot \\frac{A C}{A B}\n\\]\n\nNext, we use directed angles to find that \\(\\measuredangle X B F=\\measuredangle X B A=\\measuredangle X C A=\\measuredangle X C E\\) and \\(\\measuredangle X F B=\\measuredangle X F A=\\measuredangle X E A=\\measuredangle X E C\\). This shows triangles \\(X B F\\) and \\(X C E\\) are directly similar. In particular, we have\n\n\\[\n\\frac{X B}{X C}=\\frac{B F}{C E}\n\\]\n\nIn the following, we give two ways to continue the proof.\n\n\\begin{itemize}\n  \\item Method 1. Here is a geometrical method. As \\(\\angle F I B=\\angle A I B-90^{\\circ}=\\frac{1}{2} \\angle A C B=\\angle I C B\\) and \\(\\angle F B I=\\angle I B C\\), the triangles \\(F B I\\) and \\(I B C\\) are similar. Analogously, triangles \\(E I C\\) and \\(I B C\\) are also similar. Hence, we get\n\n\n\\[\n\\frac{F B}{I B}=\\frac{B I}{B C} \\quad \\text { and } \\quad \\frac{E C}{I C}=\\frac{I C}{B C}\n\\]\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2025_05_30_2200921d1d27b7195e25g-51}\n\n\nNext, construct a line parallel to \\(B C\\) and tangent to the incircle. Suppose it meets sides \\(A B\\) and \\(A C\\) at \\(B_{1}\\) and \\(C_{1}\\) respectively. Let the incircle touch \\(A B\\) and \\(A C\\) at \\(B_{2}\\) and \\(C_{2}\\) respectively. By homothety, the line \\(B_{1} I\\) is parallel to the external angle bisector of \\(\\angle A B C\\), and hence \\(\\angle B_{1} I B=90^{\\circ}\\). Since \\(\\angle B B_{2} I=90^{\\circ}\\), we get \\(B B_{2} \\cdot B B_{1}=B I^{2}\\), and similarly \\(C C_{2} \\cdot C C_{1}=C I^{2}\\). Hence,\n\n\\[\n\\frac{B I^{2}}{C I^{2}}=\\frac{B B_{2} \\cdot B B_{1}}{C C_{2} \\cdot C C_{1}}=\\frac{B B_{1}}{C C_{1}} \\cdot \\frac{B D}{C D}=\\frac{A B}{A C} \\cdot \\frac{B D}{C D} .\n\\]\n\nCombining (1), (2), (3) and (4), we conclude\n\n\\[\n\\frac{B D^{\\prime}}{C D^{\\prime}}=\\frac{X B}{X C} \\cdot \\frac{A C}{A B}=\\frac{B F}{C E} \\cdot \\frac{A C}{A B}=\\frac{B I^{2}}{C I^{2}} \\cdot \\frac{A C}{A B}=\\frac{B D}{C D}\n\\]\n\nso that \\(D^{\\prime}=D\\). The result then follows.\n\n\\begin{itemize}\n  \\item Method 2. We continue the proof of Solution 1 using trigonometry. Let \\(\\beta=\\frac{1}{2} \\angle A B C\\) and \\(\\gamma=\\frac{1}{2} \\angle A C B\\). Observe that \\(\\angle F I B=\\angle A I B-90^{\\circ}=\\gamma\\). Hence, \\(\\frac{B F}{F I}=\\frac{\\sin \\angle F I B}{\\sin \\angle I B F}=\\frac{\\sin \\gamma}{\\sin \\beta}\\). Similarly, \\(\\frac{C E}{E I}=\\frac{\\sin \\beta}{\\sin \\gamma}\\). As \\(F I=E I\\), we get\n\n\n\\[\n\\frac{B F}{C E}=\\frac{B F}{F I} \\cdot \\frac{E I}{C E}=\\left(\\frac{\\sin \\gamma}{\\sin \\beta}\\right)^{2}\n\\]\n\nTogether with (1) and (2), we find that\n\n\\[\n\\frac{B D^{\\prime}}{C D^{\\prime}}=\\frac{A C}{A B} \\cdot\\left(\\frac{\\sin \\gamma}{\\sin \\beta}\\right)^{2}=\\frac{\\sin 2 \\beta}{\\sin 2 \\gamma} \\cdot\\left(\\frac{\\sin \\gamma}{\\sin \\beta}\\right)^{2}=\\frac{\\tan \\gamma}{\\tan \\beta}=\\frac{I D / C D}{I D / B D}=\\frac{B D}{C D}\n\\]\n\nThis shows \\(D^{\\prime}=D\\) and the result follows.\nSolution 2. Let \\(\\omega_{A}\\) be the \\(A\\)-mixtilinear incircle of triangle \\(A B C\\). From the properties of mixtilinear incircles, \\(\\omega_{A}\\) touches sides \\(A B\\) and \\(A C\\) at \\(F\\) and \\(E\\) respectively. Suppose \\(\\omega_{A}\\) is tangent to \\(\\Gamma\\) at \\(T\\). Let \\(A M\\) meet \\(\\Gamma\\) again at \\(Y\\), and let \\(D_{1}, T_{1}\\) be the reflections of \\(D\\) and \\(T\\) with respect to the perpendicular bisector of \\(B C\\) respectively. It is well-known that \\(\\angle B A T=\\angle D_{1} A C\\) so that \\(A, D_{1}, T_{1}\\) are collinear.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2200921d1d27b7195e25g-52}\n\nWe then show that \\(X, M, T_{1}\\) are collinear. Let \\(R\\) be the radical centre of \\(\\omega_{A}, \\Gamma\\) and the circumcircle of triangle \\(A E F\\). Then \\(R\\) lies on \\(A X, E F\\) and the tangent at \\(T\\) to \\(\\Gamma\\). Let \\(A T\\) meet \\(\\omega_{A}\\) again at \\(S\\) and meet \\(E F\\) at \\(P\\). Obviously, \\(S F T E\\) is a harmonic quadrilateral. Projecting from \\(T\\), the pencil ( \\(R, P ; F, E\\) ) is harmonic. We further project the pencil onto \\(\\Gamma\\) from \\(A\\), so that \\(X B T C\\) is a harmonic quadrilateral. As \\(T T_{1} / / B C\\), the projection from \\(T_{1}\\) onto \\(B C\\) maps \\(T\\) to a point at infinity, and hence maps \\(X\\) to the midpoint of \\(B C\\), which is \\(M\\). This shows \\(X, M, T_{1}\\) are collinear.\n\nWe have two ways to finish the proof.\n\n\\begin{itemize}\n  \\item Method 1. Note that both \\(A Y\\) and \\(X T_{1}\\) are chords of \\(\\Gamma\\) passing through the midpoint \\(M\\) of the chord \\(B C\\). By the Butterfly Theorem, \\(X Y\\) and \\(A T_{1}\\) cut \\(B C\\) at a pair of symmetric points with respect to \\(M\\), and hence \\(X, D, Y\\) are collinear. The proof is thus complete.\n  \\item Method 2. Here, we finish the proof without using the Butterfly Theorem. As \\(D T T_{1} D_{1}\\) is an isosceles trapezoid, we have\n\n\n\\[\n\\measuredangle Y T D=\\measuredangle Y T T_{1}+\\measuredangle T_{1} T D=\\measuredangle Y A T_{1}+\\measuredangle A D_{1} D=\\measuredangle Y M D\n\\]\n\nso that \\(D, T, Y, M\\) are concyclic. As \\(X, M, T_{1}\\) are collinear, we have\n\n\\[\n\\measuredangle A Y D=\\measuredangle M T D=\\measuredangle D_{1} T_{1} M=\\measuredangle A T_{1} X=\\measuredangle A Y X .\n\\]\n\nThis shows \\(X, D, Y\\) are collinear."}
{"id": "imo-shortlist-2016-g3", "question": "G3. Let \\(B=(-1,0)\\) and \\(C=(1,0)\\) be fixed points on the coordinate plane. A nonempty, bounded subset \\(S\\) of the plane is said to be nice if\n(i) there is a point \\(T\\) in \\(S\\) such that for every point \\(Q\\) in \\(S\\), the segment \\(T Q\\) lies entirely in \\(S\\); and\n(ii) for any triangle \\(P_{1} P_{2} P_{3}\\), there exists a unique point \\(A\\) in \\(S\\) and a permutation \\(\\sigma\\) of the indices \\(\\{1,2,3\\}\\) for which triangles \\(A B C\\) and \\(P_{\\sigma(1)} P_{\\sigma(2)} P_{\\sigma(3)}\\) are similar.\n\nProve that there exist two distinct nice subsets \\(S\\) and \\(S^{\\prime}\\) of the set \\(\\{(x, y): x \\geqslant 0, y \\geqslant 0\\}\\) such that if \\(A \\in S\\) and \\(A^{\\prime} \\in S^{\\prime}\\) are the unique choices of points in (ii), then the product \\(B A \\cdot B A^{\\prime}\\) is a constant independent of the triangle \\(P_{1} P_{2} P_{3}\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2016, "solution": "If in the similarity of \\(\\triangle A B C\\) and \\(\\triangle P_{\\sigma(1)} P_{\\sigma(2)} P_{\\sigma(3)}, B C\\) corresponds to the longest side of \\(\\triangle P_{1} P_{2} P_{3}\\), then we have \\(B C \\geqslant A B \\geqslant A C\\). The condition \\(B C \\geqslant A B\\) is equivalent to \\((x+1)^{2}+y^{2} \\leqslant 4\\), while \\(A B \\geqslant A C\\) is trivially satisfied for any point in the first quadrant. Then we first define\n\n\\[\nS=\\left\\{(x, y):(x+1)^{2}+y^{2} \\leqslant 4, x \\geqslant 0, y \\geqslant 0\\right\\}\n\\]\n\nNote that \\(S\\) is the intersection of a disk and the first quadrant, so it is bounded and convex, and we can choose any \\(T \\in S\\) to meet condition (i). For any point \\(A\\) in \\(S\\), the relation \\(B C \\geqslant A B \\geqslant A C\\) always holds. Therefore, the point \\(A\\) in (ii) is uniquely determined, while its existence is guaranteed by the above construction.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2200921d1d27b7195e25g-54}\n\nNext, if in the similarity of \\(\\triangle A^{\\prime} B C\\) and \\(\\triangle P_{\\sigma(1)} P_{\\sigma(2)} P_{\\sigma(3)}, B C\\) corresponds to the second longest side of \\(\\triangle P_{1} P_{2} P_{3}\\), then we have \\(A^{\\prime} B \\geqslant B C \\geqslant A^{\\prime} C\\). The two inequalities are equivalent to \\((x+1)^{2}+y^{2} \\geqslant 4\\) and \\((x-1)^{2}+y^{2} \\leqslant 4\\) respectively. Then we define\n\n\\[\nS^{\\prime}=\\left\\{(x, y):(x+1)^{2}+y^{2} \\geqslant 4,(x-1)^{2}+y^{2} \\leqslant 4, x \\geqslant 0, y \\geqslant 0\\right\\}\n\\]\n\nThe boundedness condition is satisfied while (ii) can be argued as in the previous case. For (i), note that \\(S^{\\prime}\\) contains points inside the disk \\((x-1)^{2}+y^{2} \\leqslant 4\\) and outside the disk \\((x+1)^{2}+y^{2} \\geqslant 4\\). This shows we can take \\(T^{\\prime}=(1,2)\\) in (i), which is the topmost point of the circle \\((x-1)^{2}+y^{2}=4\\).\n\nIt remains to check that the product \\(B A \\cdot B A^{\\prime}\\) is a constant. Suppose we are given a triangle \\(P_{1} P_{2} P_{3}\\) with \\(P_{1} P_{2} \\geqslant P_{2} P_{3} \\geqslant P_{3} P_{1}\\). By the similarity, we have\n\n\\[\nB A=B C \\cdot \\frac{P_{2} P_{3}}{P_{1} P_{2}} \\quad \\text { and } \\quad B A^{\\prime}=B C \\cdot \\frac{P_{1} P_{2}}{P_{2} P_{3}}\n\\]\n\nThus \\(B A \\cdot B A^{\\prime}=B C^{2}=4\\), which is certainly independent of the triangle \\(P_{1} P_{2} P_{3}\\).\nComment. The original version of this problem includes the condition that the interiors of \\(S\\) and \\(S^{\\prime}\\) are disjoint. We remove this condition since it is hard to define the interior of a point set rigorously."}
{"id": "imo-shortlist-2016-g4", "question": "G4. Let \\(A B C\\) be a triangle with \\(A B=A C \\neq B C\\) and let \\(I\\) be its incentre. The line \\(B I\\) meets \\(A C\\) at \\(D\\), and the line through \\(D\\) perpendicular to \\(A C\\) meets \\(A I\\) at \\(E\\). Prove that the reflection of \\(I\\) in \\(A C\\) lies on the circumcircle of triangle \\(B D E\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2016-n1", "question": "N1. For any positive integer \\(k\\), denote the sum of digits of \\(k\\) in its decimal representation by \\(S(k)\\). Find all polynomials \\(P(x)\\) with integer coefficients such that for any positive integer \\(n \\geqslant 2016\\), the integer \\(P(n)\\) is positive and\n\n\\[\nS(P(n))=P(S(n))\n\\]", "category": "Number Theory", "source": "IMO Shortlist", "year": 2016, "solution": ""}
{"id": "imo-shortlist-2018-a1", "question": "A1. Let \\(\\mathbb{Q}_{>0}\\) denote the set of all positive rational numbers. Determine all functions \\(f: \\mathbb{Q}_{>0} \\rightarrow \\mathbb{Q}>0\\) satisfying\n\n\\[\nf\\left(x^{2} f(y)^{2}\\right)=f(x)^{2} f(y)\n\\]\n\nfor all \\(x, y \\in \\mathbb{Q}_{>0}\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-a2", "question": "A2. Find all positive integers \\(n \\geqslant 3\\) for which there exist real numbers \\(a_{1}, a_{2}, \\ldots, a_{n}\\), \\(a_{n+1}=a_{1}, a_{n+2}=a_{2}\\) such that\n\n\\[\na_{i} a_{i+1}+1=a_{i+2}\n\\]\n\nfor all \\(i=1,2, \\ldots, n\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-a3", "question": "A3. Given any set \\(S\\) of positive integers, show that at least one of the following two assertions holds:\n(1) There exist distinct finite subsets \\(F\\) and \\(G\\) of \\(S\\) such that \\(\\sum_{x \\in F} 1 / x=\\sum_{x \\in G} 1 / x\\);\n(2) There exists a positive rational number \\(r<1\\) such that \\(\\sum_{x \\in F} 1 / x \\neq r\\) for all finite subsets \\(F\\) of \\(S\\).\n(Luxembourg)", "category": "Algebra", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-a4", "question": "A4. Let \\(a_{0}, a_{1}, a_{2}, \\ldots\\) be a sequence of real numbers such that \\(a_{0}=0, a_{1}=1\\), and for every \\(n \\geqslant 2\\) there exists \\(1 \\leqslant k \\leqslant n\\) satisfying\n\n\\[\na_{n}=\\frac{a_{n-1}+\\cdots+a_{n-k}}{k} .\n\\]\n\nFind the maximal possible value of \\(a_{2018}-a_{2017}\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-a5", "question": "A5. Determine all functions \\(f:(0, \\infty) \\rightarrow \\mathbb{R}\\) satisfying\n\n\\[\n\\left(x+\\frac{1}{x}\\right) f(y)=f(x y)+f\\left(\\frac{y}{x}\\right)\n\\]\n\nfor all \\(x, y>0\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-a6", "question": "A6. Let \\(m, n \\geqslant 2\\) be integers. Let \\(f\\left(x_{1}, \\ldots, x_{n}\\right)\\) be a polynomial with real coefficients such that\n\n\\[\nf\\left(x_{1}, \\ldots, x_{n}\\right)=\\left\\lfloor\\frac{x_{1}+\\ldots+x_{n}}{m}\\right\\rfloor \\quad \\text { for every } x_{1}, \\ldots, x_{n} \\in\\{0,1, \\ldots, m-1\\}\n\\]\n\nProve that the total degree of \\(f\\) is at least \\(n\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-a7", "question": "A7. Find the maximal value of\n\n\\[\nS=\\sqrt[3]{\\frac{a}{b+7}}+\\sqrt[3]{\\frac{b}{c+7}}+\\sqrt[3]{\\frac{c}{d+7}}+\\sqrt[3]{\\frac{d}{a+7}}\n\\]\n\nwhere \\(a, b, c, d\\) are nonnegative real numbers which satisfy \\(a+b+c+d=100\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-c1", "question": "C1. Let \\(n \\geqslant 3\\) be an integer. Prove that there exists a set \\(S\\) of \\(2 n\\) positive integers satisfying the following property: For every \\(m=2,3, \\ldots, n\\) the set \\(S\\) can be partitioned into two subsets with equal sums of elements, with one of subsets of cardinality \\(m\\).\n(Iceland)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-c2", "question": "C2. Queenie and Horst play a game on a \\(20 \\times 20\\) chessboard. In the beginning the board is empty. In every turn, Horst places a black knight on an empty square in such a way that his new knight does not attack any previous knights. Then Queenie places a white queen on an empty square. The game gets finished when somebody cannot move.\n\nFind the maximal positive \\(K\\) such that, regardless of the strategy of Queenie, Horst can put at least \\(K\\) knights on the board.\n(Armenia)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-c3", "question": "C3. Let \\(n\\) be a given positive integer. Sisyphus performs a sequence of turns on a board consisting of \\(n+1\\) squares in a row, numbered 0 to \\(n\\) from left to right. Initially, \\(n\\) stones are put into square 0, and the other squares are empty. At every turn, Sisyphus chooses any nonempty square, say with \\(k\\) stones, takes one of those stones and moves it to the right by at most \\(k\\) squares (the stone should stay within the board). Sisyphus' aim is to move all \\(n\\) stones to square \\(n\\).\n\nProve that Sisyphus cannot reach the aim in less than\n\n\\[\n\\left\\lceil\\frac{n}{1}\\right\\rceil+\\left\\lceil\\frac{n}{2}\\right\\rceil+\\left\\lceil\\frac{n}{3}\\right\\rceil+\\cdots+\\left\\lceil\\frac{n}{n}\\right\\rceil\n\\]\n\nturns. (As usual, \\(\\lceil x\\rceil\\) stands for the least integer not smaller than \\(x\\).)\n(Netherlands)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-c4", "question": "C4. An anti-Pascal pyramid is a finite set of numbers, placed in a triangle-shaped array so that the first row of the array contains one number, the second row contains two numbers, the third row contains three numbers and so on; and, except for the numbers in the bottom row, each number equals the absolute value of the difference of the two numbers below it. For instance, the triangle below is an anti-Pascal pyramid with four rows, in which every integer from 1 to \\(1+2+3+4=10\\) occurs exactly once:\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b62628dbd164bd27ffa8g-06}\n\nIs it possible to form an anti-Pascal pyramid with 2018 rows, using every integer from 1 to \\(1+2+\\cdots+2018\\) exactly once?\n(Iran)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-c5", "question": "C5. Let \\(k\\) be a positive integer. The organising committee of a tennis tournament is to schedule the matches for \\(2 k\\) players so that every two players play once, each day exactly one match is played, and each player arrives to the tournament site the day of his first match, and departs the day of his last match. For every day a player is present on the tournament, the committee has to pay 1 coin to the hotel. The organisers want to design the schedule so as to minimise the total cost of all players' stays. Determine this minimum cost.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-c6", "question": "C6. Let \\(a\\) and \\(b\\) be distinct positive integers. The following infinite process takes place on an initially empty board.\n(i) If there is at least a pair of equal numbers on the board, we choose such a pair and increase one of its components by \\(a\\) and the other by \\(b\\).\n(ii) If no such pair exists, we write down two times the number 0 .\n\nProve that, no matter how we make the choices in \\((i)\\), operation (ii) will be performed only finitely many times.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-c7", "question": "C7. Consider 2018 pairwise crossing circles no three of which are concurrent. These circles subdivide the plane into regions bounded by circular edges that meet at vertices. Notice that there are an even number of vertices on each circle. Given the circle, alternately colour the vertices on that circle red and blue. In doing so for each circle, every vertex is coloured twice once for each of the two circles that cross at that point. If the two colourings agree at a vertex, then it is assigned that colour; otherwise, it becomes yellow. Show that, if some circle contains at least 2061 yellow points, then the vertices of some region are all yellow.\n(India)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-g1", "question": "G1. Let \\(A B C\\) be an acute-angled triangle with circumcircle \\(\\Gamma\\). Let \\(D\\) and \\(E\\) be points on the segments \\(A B\\) and \\(A C\\), respectively, such that \\(A D=A E\\). The perpendicular bisectors of the segments \\(B D\\) and \\(C E\\) intersect the small arcs \\(\\widehat{A B}\\) and \\(\\widehat{A C}\\) at points \\(F\\) and \\(G\\) respectively. Prove that \\(D E \\| F G\\).\n(Greece)", "category": "Geometry", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-g2", "question": "G2. Let \\(A B C\\) be a triangle with \\(A B=A C\\), and let \\(M\\) be the midpoint of \\(B C\\). Let \\(P\\) be a point such that \\(P B<P C\\) and \\(P A\\) is parallel to \\(B C\\). Let \\(X\\) and \\(Y\\) be points on the lines \\(P B\\) and \\(P C\\), respectively, so that \\(B\\) lies on the segment \\(P X, C\\) lies on the segment \\(P Y\\), and \\(\\angle P X M=\\angle P Y M\\). Prove that the quadrilateral \\(A P X Y\\) is cyclic.\n(Australia)", "category": "Geometry", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-g3", "question": "G3. A circle \\(\\omega\\) of radius 1 is given. A collection \\(T\\) of triangles is called good, if the following conditions hold:\n(i) each triangle from \\(T\\) is inscribed in \\(\\omega\\);\n(ii) no two triangles from \\(T\\) have a common interior point.\n\nDetermine all positive real numbers \\(t\\) such that, for each positive integer \\(n\\), there exists a good collection of \\(n\\) triangles, each of perimeter greater than \\(t\\).\n(South Africa)", "category": "Geometry", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-g4", "question": "G4. A point \\(T\\) is chosen inside a triangle \\(A B C\\). Let \\(A_{1}, B_{1}\\), and \\(C_{1}\\) be the reflections of \\(T\\) in \\(B C, C A\\), and \\(A B\\), respectively. Let \\(\\Omega\\) be the circumcircle of the triangle \\(A_{1} B_{1} C_{1}\\). The lines \\(A_{1} T, B_{1} T\\), and \\(C_{1} T\\) meet \\(\\Omega\\) again at \\(A_{2}, B_{2}\\), and \\(C_{2}\\), respectively. Prove that the lines \\(A A_{2}, B B_{2}\\), and \\(C C_{2}\\) are concurrent on \\(\\Omega\\).\n(Mongolia)", "category": "Geometry", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-g5", "question": "G5. Let \\(A B C\\) be a triangle with circumcircle \\(\\omega\\) and incentre \\(I\\). A line \\(\\ell\\) intersects the lines \\(A I, B I\\), and \\(C I\\) at points \\(D, E\\), and \\(F\\), respectively, distinct from the points \\(A, B, C\\), and \\(I\\). The perpendicular bisectors \\(x, y\\), and \\(z\\) of the segments \\(A D, B E\\), and \\(C F\\), respectively determine a triangle \\(\\Theta\\). Show that the circumcircle of the triangle \\(\\Theta\\) is tangent to \\(\\omega\\).\n(Denmark)", "category": "Geometry", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-g6", "question": "G6. A convex quadrilateral \\(A B C D\\) satisfies \\(A B \\cdot C D=B C \\cdot D A\\). A point \\(X\\) is chosen inside the quadrilateral so that \\(\\angle X A B=\\angle X C D\\) and \\(\\angle X B C=\\angle X D A\\). Prove that \\(\\angle A X B+\\) \\(\\angle C X D=180^{\\circ}\\).\n(Poland)", "category": "Geometry", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-g7", "question": "G7. Let \\(O\\) be the circumcentre, and \\(\\Omega\\) be the circumcircle of an acute-angled triangle \\(A B C\\). Let \\(P\\) be an arbitrary point on \\(\\Omega\\), distinct from \\(A, B, C\\), and their antipodes in \\(\\Omega\\). Denote the circumcentres of the triangles \\(A O P, B O P\\), and \\(C O P\\) by \\(O_{A}, O_{B}\\), and \\(O_{C}\\), respectively. The lines \\(\\ell_{A}, \\ell_{B}\\), and \\(\\ell_{C}\\) perpendicular to \\(B C, C A\\), and \\(A B\\) pass through \\(O_{A}, O_{B}\\), and \\(O_{C}\\), respectively. Prove that the circumcircle of the triangle formed by \\(\\ell_{A}, \\ell_{B}\\), and \\(\\ell_{C}\\) is tangent to the line \\(O P\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-n1", "question": "N1. Determine all pairs \\((n, k)\\) of distinct positive integers such that there exists a positive integer \\(s\\) for which the numbers of divisors of \\(s n\\) and of \\(s k\\) are equal.\n(Ukraine)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-n2", "question": "N2. Let \\(n>1\\) be a positive integer. Each cell of an \\(n \\times n\\) table contains an integer. Suppose that the following conditions are satisfied:\n(i) Each number in the table is congruent to 1 modulo \\(n\\);\n(ii) The sum of numbers in any row, as well as the sum of numbers in any column, is congruent to \\(n\\) modulo \\(n^{2}\\).\n\nLet \\(R_{i}\\) be the product of the numbers in the \\(i^{\\text {th }}\\) row, and \\(C_{j}\\) be the product of the numbers in the \\(j^{\\text {th }}\\) column. Prove that the sums \\(R_{1}+\\cdots+R_{n}\\) and \\(C_{1}+\\cdots+C_{n}\\) are congruent modulo \\(n^{4}\\).\n(Indonesia)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-n3", "question": "N3. Define the sequence \\(a_{0}, a_{1}, a_{2}, \\ldots\\) by \\(a_{n}=2^{n}+2^{\\lfloor n / 2\\rfloor}\\). Prove that there are infinitely many terms of the sequence which can be expressed as a sum of (two or more) distinct terms of the sequence, as well as infinitely many of those which cannot be expressed in such a way.\n(Serbia)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-n4", "question": "N4. Let \\(a_{1}, a_{2}, \\ldots, a_{n}, \\ldots\\) be a sequence of positive integers such that\n\n\\[\n\\frac{a_{1}}{a_{2}}+\\frac{a_{2}}{a_{3}}+\\cdots+\\frac{a_{n-1}}{a_{n}}+\\frac{a_{n}}{a_{1}}\n\\]\n\nis an integer for all \\(n \\geqslant k\\), where \\(k\\) is some positive integer. Prove that there exists a positive integer \\(m\\) such that \\(a_{n}=a_{n+1}\\) for all \\(n \\geqslant m\\).\n(Mongolia)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-n5", "question": "N5. Four positive integers \\(x, y, z\\), and \\(t\\) satisfy the relations\n\n\\[\nx y-z t=x+y=z+t\n\\]\n\nIs it possible that both \\(x y\\) and \\(z t\\) are perfect squares?\n(Russia)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-n6", "question": "N6. Let \\(f:\\{1,2,3, \\ldots\\} \\rightarrow\\{2,3, \\ldots\\}\\) be a function such that \\(f(m+n) \\mid f(m)+f(n)\\) for all pairs \\(m, n\\) of positive integers. Prove that there exists a positive integer \\(c>1\\) which divides all values of \\(f\\).\n(Mexico)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-n7", "question": "N7. Let \\(n \\geqslant 2018\\) be an integer, and let \\(a_{1}, a_{2}, \\ldots, a_{n}, b_{1}, b_{2}, \\ldots, b_{n}\\) be pairwise distinct positive integers not exceeding \\(5 n\\). Suppose that the sequence\n\n\\[\n\\frac{a_{1}}{b_{1}}, \\frac{a_{2}}{b_{2}}, \\ldots, \\frac{a_{n}}{b_{n}}\n\\]\n\nforms an arithmetic progression. Prove that the terms of the sequence are equal.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2018, "solution": ""}
{"id": "imo-shortlist-2018-a1", "question": "A1. Let \\(\\mathbb{Q}_{>0}\\) denote the set of all positive rational numbers. Determine all functions \\(f: \\mathbb{Q}_{>0} \\rightarrow \\mathbb{Q}_{>0}\\) satisfying\n\n\\[\nf\\left(x^{2} f(y)^{2}\\right)=f(x)^{2} f(y)\n\\]\n\nfor all \\(x, y \\in \\mathbb{Q}_{>0}\\).\n(Switzerland)\nAnswer: \\(f(x)=1\\) for all \\(x \\in \\mathbb{Q}_{>0}\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2018, "solution": "Take any \\(a, b \\in \\mathbb{Q}_{>0}\\). By substituting \\(x=f(a), y=b\\) and \\(x=f(b), y=a\\) into (*) we get\n\n\\[\nf(f(a))^{2} f(b)=f\\left(f(a)^{2} f(b)^{2}\\right)=f(f(b))^{2} f(a)\n\\]\n\nwhich yields\n\n\\[\n\\frac{f(f(a))^{2}}{f(a)}=\\frac{f(f(b))^{2}}{f(b)} \\quad \\text { for all } a, b \\in \\mathbb{Q}_{>0}\n\\]\n\nIn other words, this shows that there exists a constant \\(C \\in \\mathbb{Q}_{>0}\\) such that \\(f(f(a))^{2}=C f(a)\\), or\n\n\\[\n\\left(\\frac{f(f(a))}{C}\\right)^{2}=\\frac{f(a)}{C} \\quad \\text { for all } a \\in \\mathbb{Q}_{>0}\n\\]\n\nDenote by \\(f^{n}(x)=\\underbrace{f(f(\\ldots(f(x)) \\ldots)) \\text { the } n^{\\text {th }} \\text { iteration of } f \\text {. Equality (1) yields }}_{n}\\)\n\n\\[\n\\frac{f(a)}{C}=\\left(\\frac{f^{2}(a)}{C}\\right)^{2}=\\left(\\frac{f^{3}(a)}{C}\\right)^{4}=\\cdots=\\left(\\frac{f^{n+1}(a)}{C}\\right)^{2^{n}}\n\\]\n\nfor all positive integer \\(n\\). So, \\(f(a) / C\\) is the \\(2^{n}\\)-th power of a rational number for all positive integer \\(n\\). This is impossible unless \\(f(a) / C=1\\), since otherwise the exponent of some prime in the prime decomposition of \\(f(a) / C\\) is not divisible by sufficiently large powers of 2 . Therefore, \\(f(a)=C\\) for all \\(a \\in \\mathbb{Q}_{>0}\\).\n\nFinally, after substituting \\(f \\equiv C\\) into (\\textit{) we get \\(C=C^{3}\\), whence \\(C=1\\). So \\(f(x) \\equiv 1\\) is the unique function satisfying (}).\n\nComment 1. There are several variations of the solution above. For instance, one may start with finding \\(f(1)=1\\). To do this, let \\(d=f(1)\\). By substituting \\(x=y=1\\) and \\(x=d^{2}, y=1\\) into (*) we get \\(f\\left(d^{2}\\right)=d^{3}\\) and \\(f\\left(d^{6}\\right)=f\\left(d^{2}\\right)^{2} \\cdot d=d^{7}\\). By substituting now \\(x=1, y=d^{2}\\) we obtain \\(f\\left(d^{6}\\right)=d^{2} \\cdot d^{3}=d^{5}\\). Therefore, \\(d^{7}=f\\left(d^{6}\\right)=d^{5}\\), whence \\(d=1\\).\n\nAfter that, the rest of the solution simplifies a bit, since we already know that \\(C=\\frac{f(f(1))^{2}}{f(1)}=1\\). Hence equation (1) becomes merely \\(f(f(a))^{2}=f(a)\\), which yields \\(f(a)=1\\) in a similar manner.\n\nComment 2. There exist nonconstant functions \\(f: \\mathbb{R}^{+} \\rightarrow \\mathbb{R}^{+}\\)satisfying (*) for all real \\(x, y>0\\) e.g., \\(f(x)=\\sqrt{x}\\)."}
{"id": "imo-shortlist-2018-a2", "question": "A2. Find all positive integers \\(n \\geqslant 3\\) for which there exist real numbers \\(a_{1}, a_{2}, \\ldots, a_{n}\\), \\(a_{n+1}=a_{1}, a_{n+2}=a_{2}\\) such that\n\n\\[\na_{i} a_{i+1}+1=a_{i+2}\n\\]\n\nfor all \\(i=1,2, \\ldots, n\\).\n(Slovakia)\nAnswer: \\(n\\) can be any multiple of 3 .", "category": "Algebra", "source": "IMO Shortlist", "year": 2018, "solution": "For the sake of convenience, extend the sequence \\(a_{1}, \\ldots, a_{n+2}\\) to an infinite periodic sequence with period \\(n\\). ( \\(n\\) is not necessarily the shortest period.)\n\nIf \\(n\\) is divisible by 3 , then \\(\\left(a_{1}, a_{2}, \\ldots\\right)=(-1,-1,2,-1,-1,2, \\ldots)\\) is an obvious solution.\nWe will show that in every periodic sequence satisfying the recurrence, each positive term is followed by two negative values, and after them the next number is positive again. From this, it follows that \\(n\\) is divisible by 3 .\n\nIf the sequence contains two consecutive positive numbers \\(a_{i}, a_{i+1}\\), then \\(a_{i+2}=a_{i} a_{i+1}+1>1\\), so the next value is positive as well; by induction, all numbers are positive and greater than 1. But then \\(a_{i+2}=a_{i} a_{i+1}+1 \\geqslant 1 \\cdot a_{i+1}+1>a_{i+1}\\) for every index \\(i\\), which is impossible: our sequence is periodic, so it cannot increase everywhere.\n\nIf the number 0 occurs in the sequence, \\(a_{i}=0\\) for some index \\(i\\), then it follows that \\(a_{i+1}=a_{i-1} a_{i}+1\\) and \\(a_{i+2}=a_{i} a_{i+1}+1\\) are two consecutive positive elements in the sequences and we get the same contradiction again.\n\nNotice that after any two consecutive negative numbers the next one must be positive: if \\(a_{i}<0\\) and \\(a_{i+1}<0\\), then \\(a_{i+2}=a_{1} a_{i+1}+1>1>0\\). Hence, the positive and negative numbers follow each other in such a way that each positive term is followed by one or two negative values and then comes the next positive term.\n\nConsider the case when the positive and negative values alternate. So, if \\(a_{i}\\) is a negative value then \\(a_{i+1}\\) is positive, \\(a_{i+2}\\) is negative and \\(a_{i+3}\\) is positive again.\n\nNotice that \\(a_{i} a_{i+1}+1=a_{i+2}<0<a_{i+3}=a_{i+1} a_{i+2}+1\\); by \\(a_{i+1}>0\\) we conclude \\(a_{i}<a_{i+2}\\). Hence, the negative values form an infinite increasing subsequence, \\(a_{i}<a_{i+2}<a_{i+4}<\\ldots\\), which is not possible, because the sequence is periodic.\n\nThe only case left is when there are consecutive negative numbers in the sequence. Suppose that \\(a_{i}\\) and \\(a_{i+1}\\) are negative; then \\(a_{i+2}=a_{i} a_{i+1}+1>1\\). The number \\(a_{i+3}\\) must be negative. We show that \\(a_{i+4}\\) also must be negative.\n\nNotice that \\(a_{i+3}\\) is negative and \\(a_{i+4}=a_{i+2} a_{i+3}+1<1<a_{i} a_{i+1}+1=a_{i+2}\\), so\n\n\\[\na_{i+5}-a_{i+4}=\\left(a_{i+3} a_{i+4}+1\\right)-\\left(a_{i+2} a_{i+3}+1\\right)=a_{i+3}\\left(a_{i+4}-a_{i+2}\\right)>0\n\\]\n\ntherefore \\(a_{i+5}>a_{i+4}\\). Since at most one of \\(a_{i+4}\\) and \\(a_{i+5}\\) can be positive, that means that \\(a_{i+4}\\) must be negative.\n\nNow \\(a_{i+3}\\) and \\(a_{i+4}\\) are negative and \\(a_{i+5}\\) is positive; so after two negative and a positive terms, the next three terms repeat the same pattern. That completes the solution.\n\nSolution 2. We prove that the shortest period of the sequence must be 3. Then it follows that \\(n\\) must be divisible by 3 .\n\nNotice that the equation \\(x^{2}+1=x\\) has no real root, so the numbers \\(a_{1}, \\ldots, a_{n}\\) cannot be all equal, hence the shortest period of the sequence cannot be 1 .\n\nBy applying the recurrence relation for \\(i\\) and \\(i+1\\),\n\n\\[\n\\begin{gathered}\n\\left(a_{i+2}-1\\right) a_{i+2}=a_{i} a_{i+1} a_{i+2}=a_{i}\\left(a_{i+3}-1\\right), \\quad \\text { so } \na_{i+2}^{2}-a_{i} a_{i+3}=a_{i+2}-a_{i}\n\n\\]\n\nBy summing over \\(i=1,2, \\ldots, n\\), we get\n\n\\[\n\\sum_{i=1}^{n}\\left(a_{i}-a_{i+3}\\right)^{2}=0\n\\]\n\nThat proves that \\(a_{i}=a_{i+3}\\) for every index \\(i\\), so the sequence \\(a_{1}, a_{2}, \\ldots\\) is indeed periodic with period 3. The shortest period cannot be 1 , so it must be 3 ; therefore, \\(n\\) is divisible by 3 .\n\nComment. By solving the system of equations \\(a b+1=c, \\quad b c+1=a, \\quad c a+1=b\\), it can be seen that the pattern \\((-1,-1,2)\\) is repeated in all sequences satisfying the problem conditions."}
{"id": "imo-shortlist-2018-a3", "question": "A3. Given any set \\(S\\) of positive integers, show that at least one of the following two assertions holds:\n(1) There exist distinct finite subsets \\(F\\) and \\(G\\) of \\(S\\) such that \\(\\sum_{x \\in F} 1 / x=\\sum_{x \\in G} 1 / x\\);\n(2) There exists a positive rational number \\(r<1\\) such that \\(\\sum_{x \\in F} 1 / x \\neq r\\) for all finite subsets \\(F\\) of \\(S\\).\n(Luxembourg)", "category": "Algebra", "source": "IMO Shortlist", "year": 2018, "solution": "Argue indirectly. Agree, as usual, that the empty sum is 0 to consider rationals in \\([0,1)\\); adjoining 0 causes no harm, since \\(\\sum_{x \\in F} 1 / x=0\\) for no nonempty finite subset \\(F\\) of \\(S\\). For every rational \\(r\\) in \\([0,1)\\), let \\(F_{r}\\) be the unique finite subset of \\(S\\) such that \\(\\sum_{x \\in F_{r}} 1 / x=r\\). The argument hinges on the lemma below.\nLemma. If \\(x\\) is a member of \\(S\\) and \\(q\\) and \\(r\\) are rationals in \\([0,1)\\) such that \\(q-r=1 / x\\), then \\(x\\) is a member of \\(F_{q}\\) if and only if it is not one of \\(F_{r}\\).\nProof. If \\(x\\) is a member of \\(F_{q}\\), then\n\n\\[\n\\sum_{y \\in F_{q} \\backslash\\{x\\}} \\frac{1}{y}=\\sum_{y \\in F_{q}} \\frac{1}{y}-\\frac{1}{x}=q-\\frac{1}{x}=r=\\sum_{y \\in F_{r}} \\frac{1}{y}\n\\]\n\nso \\(F_{r}=F_{q} \\backslash\\{x\\}\\), and \\(x\\) is not a member of \\(F_{r}\\). Conversely, if \\(x\\) is not a member of \\(F_{r}\\), then\n\n\\[\n\\sum_{y \\in F_{r} \\cup\\{x\\}} \\frac{1}{y}=\\sum_{y \\in F_{r}} \\frac{1}{y}+\\frac{1}{x}=r+\\frac{1}{x}=q=\\sum_{y \\in F_{q}} \\frac{1}{y}\n\\]\n\nso \\(F_{q}=F_{r} \\cup\\{x\\}\\), and \\(x\\) is a member of \\(F_{q}\\).\nConsider now an element \\(x\\) of \\(S\\) and a positive rational \\(r<1\\). Let \\(n=\\lfloor r x\\rfloor\\) and consider the sets \\(F_{r-k / x}, k=0, \\ldots, n\\). Since \\(0 \\leqslant r-n / x<1 / x\\), the set \\(F_{r-n / x}\\) does not contain \\(x\\), and a repeated application of the lemma shows that the \\(F_{r-(n-2 k) / x}\\) do not contain \\(x\\), whereas the \\(F_{r-(n-2 k-1) / x}\\) do. Consequently, \\(x\\) is a member of \\(F_{r}\\) if and only if \\(n\\) is odd.\n\nFinally, consider \\(F_{2 / 3}\\). By the preceding, \\(\\lfloor 2 x / 3\\rfloor\\) is odd for each \\(x\\) in \\(F_{2 / 3}\\), so \\(2 x / 3\\) is not integral. Since \\(F_{2 / 3}\\) is finite, there exists a positive rational \\(\\varepsilon\\) such that \\(\\lfloor(2 / 3-\\varepsilon) x\\rfloor=\\lfloor 2 x / 3\\rfloor\\) for all \\(x\\) in \\(F_{2 / 3}\\). This implies that \\(F_{2 / 3}\\) is a subset of \\(F_{2 / 3-\\varepsilon}\\) which is impossible.\n\nComment. The solution above can be adapted to show that the problem statement still holds, if the condition \\(r<1\\) in (2) is replaced with \\(r<\\delta\\), for an arbitrary positive \\(\\delta\\). This yields that, if \\(S\\) does not satisfy (1), then there exist infinitely many positive rational numbers \\(r<1\\) such that \\(\\sum_{x \\in F} 1 / x \\neq r\\) for all finite subsets \\(F\\) of \\(S\\).\nSolution 2. A finite \\(S\\) clearly satisfies (2), so let \\(S\\) be infinite. If \\(S\\) fails both conditions, so does \\(S \\backslash\\{1\\}\\). We may and will therefore assume that \\(S\\) consists of integers greater than 1 . Label the elements of \\(S\\) increasingly \\(x_{1}<x_{2}<\\cdots\\), where \\(x_{1} \\geqslant 2\\).\n\nWe first show that \\(S\\) satisfies (2) if \\(x_{n+1} \\geqslant 2 x_{n}\\) for all \\(n\\). In this case, \\(x_{n} \\geqslant 2^{n-1} x_{1}\\) for all \\(n\\), so\n\n\\[\ns=\\sum_{n \\geqslant 1} \\frac{1}{x_{n}} \\leqslant \\sum_{n \\geqslant 1} \\frac{1}{2^{n-1} x_{1}}=\\frac{2}{x_{1}} .\n\\]\n\nIf \\(x_{1} \\geqslant 3\\), or \\(x_{1}=2\\) and \\(x_{n+1}>2 x_{n}\\) for some \\(n\\), then \\(\\sum_{x \\in F} 1 / x<s<1\\) for every finite subset \\(F\\) of \\(S\\), so \\(S\\) satisfies (2); and if \\(x_{1}=2\\) and \\(x_{n+1}=2 x_{n}\\) for all \\(n\\), that is, \\(x_{n}=2^{n}\\) for all \\(n\\), then every finite subset \\(F\\) of \\(S\\) consists of powers of 2 , so \\(\\sum_{x \\in F} 1 / x \\neq 1 / 3\\) and again \\(S\\) satisfies (2).\n\nFinally, we deal with the case where \\(x_{n+1}<2 x_{n}\\) for some \\(n\\). Consider the positive rational \\(r=1 / x_{n}-1 / x_{n+1}<1 / x_{n+1}\\). If \\(r=\\sum_{x \\in F} 1 / x\\) for no finite subset \\(F\\) of \\(S\\), then \\(S\\) satisfies (2).\n\nWe now assume that \\(r=\\sum_{x \\in F_{0}} 1 / x\\) for some finite subset \\(F_{0}\\) of \\(S\\), and show that \\(S\\) satisfies (1). Since \\(\\sum_{x \\in F_{0}} 1 / x=r<1 / x_{n+1}\\), it follows that \\(x_{n+1}\\) is not a member of \\(F_{0}\\), so\n\n\\[\n\\sum_{x \\in F_{0} \\cup\\left\\{x_{n+1}\\right\\}} \\frac{1}{x}=\\sum_{x \\in F_{0}} \\frac{1}{x}+\\frac{1}{x_{n+1}}=r+\\frac{1}{x_{n+1}}=\\frac{1}{x_{n}}\n\\]\n\nConsequently, \\(F=F_{0} \\cup\\left\\{x_{n+1}\\right\\}\\) and \\(G=\\left\\{x_{n}\\right\\}\\) are distinct finite subsets of \\(S\\) such that \\(\\sum_{x \\in F} 1 / x=\\sum_{x \\in G} 1 / x\\), and \\(S\\) satisfies (1)."}
{"id": "imo-shortlist-2018-a4", "question": "A4. Let \\(a_{0}, a_{1}, a_{2}, \\ldots\\) be a sequence of real numbers such that \\(a_{0}=0, a_{1}=1\\), and for every \\(n \\geqslant 2\\) there exists \\(1 \\leqslant k \\leqslant n\\) satisfying\n\n\\[\na_{n}=\\frac{a_{n-1}+\\cdots+a_{n-k}}{k}\n\\]\n\nFind the maximal possible value of \\(a_{2018}-a_{2017}\\).\n(Belgium)\nAnswer: The maximal value is \\(\\frac{2016}{2017^{2}}\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2018, "solution": "The claimed maximal value is achieved at\n\n\\[\n\\begin{gathered}\na_{1}=a_{2}=\\cdots=a_{2016}=1, \\quad a_{2017}=\\frac{a_{2016}+\\cdots+a_{0}}{2017}=1-\\frac{1}{2017}, \na_{2018}=\\frac{a_{2017}+\\cdots+a_{1}}{2017}=1-\\frac{1}{2017^{2}} .\n\n\\]\n\nNow we need to show that this value is optimal. For brevity, we use the notation\n\n\\[\nS(n, k)=a_{n-1}+a_{n-2}+\\cdots+a_{n-k} \\quad \\text { for nonnegative integers } k \\leqslant n .\n\\]\n\nIn particular, \\(S(n, 0)=0\\) and \\(S(n, 1)=a_{n-1}\\). In these terms, for every integer \\(n \\geqslant 2\\) there exists a positive integer \\(k \\leqslant n\\) such that \\(a_{n}=S(n, k) / k\\).\n\nFor every integer \\(n \\geqslant 1\\) we define\n\n\\[\nM_{n}=\\max _{1 \\leqslant k \\leqslant n} \\frac{S(n, k)}{k}, \\quad m_{n}=\\min _{1 \\leqslant k \\leqslant n} \\frac{S(n, k)}{k}, \\quad \\text { and } \\quad \\Delta_{n}=M_{n}-m_{n} \\geqslant 0\n\\]\n\nBy definition, \\(a_{n} \\in\\left[m_{n}, M_{n}\\right]\\) for all \\(n \\geqslant 2\\); on the other hand, \\(a_{n-1}=S(n, 1) / 1 \\in\\left[m_{n}, M_{n}\\right]\\). Therefore,\n\n\\[\na_{2018}-a_{2017} \\leqslant M_{2018}-m_{2018}=\\Delta_{2018}\n\\]\n\nand we are interested in an upper bound for \\(\\Delta_{2018}\\).\nAlso by definition, for any \\(0<k \\leqslant n\\) we have \\(k m_{n} \\leqslant S(n, k) \\leqslant k M_{n}\\); notice that these inequalities are also valid for \\(k=0\\).\nClaim 1. For every \\(n>2\\), we have \\(\\Delta_{n} \\leqslant \\frac{n-1}{n} \\Delta_{n-1}\\).\nProof. Choose positive integers \\(k, \\ell \\leqslant n\\) such that \\(M_{n}=S(n, k) / k\\) and \\(m_{n}=S(n, \\ell) / \\ell\\). We have \\(S(n, k)=a_{n-1}+S(n-1, k-1)\\), so\n\n\\[\nk\\left(M_{n}-a_{n-1}\\right)=S(n, k)-k a_{n-1}=S(n-1, k-1)-(k-1) a_{n-1} \\leqslant(k-1)\\left(M_{n-1}-a_{n-1}\\right),\n\\]\n\nsince \\(S(n-1, k-1) \\leqslant(k-1) M_{n-1}\\). Similarly, we get\n\n\\[\n\\ell\\left(a_{n-1}-m_{n}\\right)=(\\ell-1) a_{n-1}-S(n-1, \\ell-1) \\leqslant(\\ell-1)\\left(a_{n-1}-m_{n-1}\\right)\n\\]\n\nSince \\(m_{n-1} \\leqslant a_{n-1} \\leqslant M_{n-1}\\) and \\(k, \\ell \\leqslant n\\), the obtained inequalities yield\n\n\\[\n\\begin{aligned}\n& M_{n}-a_{n-1} \\leqslant \\frac{k-1}{k}\\left(M_{n-1}-a_{n-1}\\right) \\leqslant \\frac{n-1}{n}\\left(M_{n-1}-a_{n-1}\\right) \\quad \\text { and } \n& a_{n-1}-m_{n} \\leqslant \\frac{\\ell-1}{\\ell}\\left(a_{n-1}-m_{n-1}\\right) \\leqslant \\frac{n-1}{n}\\left(a_{n-1}-m_{n-1}\\right)\n\n\\]\n\nTherefore,\n\n\\[\n\\Delta_{n}=\\left(M_{n}-a_{n-1}\\right)+\\left(a_{n-1}-m_{n}\\right) \\leqslant \\frac{n-1}{n}\\left(\\left(M_{n-1}-a_{n-1}\\right)+\\left(a_{n-1}-m_{n-1}\\right)\\right)=\\frac{n-1}{n} \\Delta_{n-1}\n\\]\n\nBack to the problem, if \\(a_{n}=1\\) for all \\(n \\leqslant 2017\\), then \\(a_{2018} \\leqslant 1\\) and hence \\(a_{2018}-a_{2017} \\leqslant 0\\). Otherwise, let \\(2 \\leqslant q \\leqslant 2017\\) be the minimal index with \\(a_{q}<1\\). We have \\(S(q, i)=i\\) for all \\(i=1,2, \\ldots, q-1\\), while \\(S(q, q)=q-1\\). Therefore, \\(a_{q}<1\\) yields \\(a_{q}=S(q, q) / q=1-\\frac{1}{q}\\).\n\nNow we have \\(S(q+1, i)=i-\\frac{1}{q}\\) for \\(i=1,2, \\ldots, q\\), and \\(S(q+1, q+1)=q-\\frac{1}{q}\\). This gives us\n\n\\[\nm_{q+1}=\\frac{S(q+1,1)}{1}=\\frac{S(q+1, q+1)}{q+1}=\\frac{q-1}{q} \\quad \\text { and } \\quad M_{q+1}=\\frac{S(q+1, q)}{q}=\\frac{q^{2}-1}{q^{2}}\n\\]\n\nso \\(\\Delta_{q+1}=M_{q+1}-m_{q+1}=(q-1) / q^{2}\\). Denoting \\(N=2017 \\geqslant q\\) and using Claim 1 for \\(n=q+2, q+3, \\ldots, N+1\\) we finally obtain\n\n\\[\n\\Delta_{N+1} \\leqslant \\frac{q-1}{q^{2}} \\cdot \\frac{q+1}{q+2} \\cdot \\frac{q+2}{q+3} \\cdots \\frac{N}{N+1}=\\frac{1}{N+1}\\left(1-\\frac{1}{q^{2}}\\right) \\leqslant \\frac{1}{N+1}\\left(1-\\frac{1}{N^{2}}\\right)=\\frac{N-1}{N^{2}}\n\\]\n\nas required.\n\nComment 1. One may check that the maximal value of \\(a_{2018}-a_{2017}\\) is attained at the unique sequence, which is presented in the solution above.\n\nComment 2. An easier question would be to determine the maximal value of \\(\\left|a_{2018}-a_{2017}\\right|\\). In this version, the answer \\(\\frac{1}{2018}\\) is achieved at\n\n\\[\na_{1}=a_{2}=\\cdots=a_{2017}=1, \\quad a_{2018}=\\frac{a_{2017}+\\cdots+a_{0}}{2018}=1-\\frac{1}{2018}\n\\]\n\nTo prove that this value is optimal, it suffices to notice that \\(\\Delta_{2}=\\frac{1}{2}\\) and to apply Claim 1 obtaining\n\n\\[\n\\left|a_{2018}-a_{2017}\\right| \\leqslant \\Delta_{2018} \\leqslant \\frac{1}{2} \\cdot \\frac{2}{3} \\cdots \\frac{2017}{2018}=\\frac{1}{2018}\n\\]\n\nSolution 2. We present a different proof of the estimate \\(a_{2018}-a_{2017} \\leqslant \\frac{2016}{2017^{2}}\\). We keep the same notations of \\(S(n, k), m_{n}\\) and \\(M_{n}\\) from the previous solution.\n\nNotice that \\(S(n, n)=S(n, n-1)\\), as \\(a_{0}=0\\). Also notice that for \\(0 \\leqslant k \\leqslant \\ell \\leqslant n\\) we have \\(S(n, \\ell)=S(n, k)+S(n-k, \\ell-k)\\).\nClaim 2. For every positive integer \\(n\\), we have \\(m_{n} \\leqslant m_{n+1}\\) and \\(M_{n+1} \\leqslant M_{n}\\), so the segment \\(\\left[m_{n+1}, M_{n+1}\\right]\\) is contained in \\(\\left[m_{n}, M_{n}\\right]\\).\nProof. Choose a positive integer \\(k \\leqslant n+1\\) such that \\(m_{n+1}=S(n+1, k) / k\\). Then we have\n\n\\[\nk m_{n+1}=S(n+1, k)=a_{n}+S(n, k-1) \\geqslant m_{n}+(k-1) m_{n}=k m_{n}\n\\]\n\nwhich establishes the first inequality in the Claim. The proof of the second inequality is similar.\n\nClaim 3. For every positive integers \\(k \\geqslant n\\), we have \\(m_{n} \\leqslant a_{k} \\leqslant M_{n}\\).\nProof. By Claim 2, we have \\(\\left[m_{k}, M_{k}\\right] \\subseteq\\left[m_{k-1}, M_{k-1}\\right] \\subseteq \\ldots \\subseteq\\left[m_{n}, M_{n}\\right]\\). Since \\(a_{k} \\in\\left[m_{k}, M_{k}\\right]\\), the claim follows.\n\nClaim 4. For every integer \\(n \\geqslant 2\\), we have \\(M_{n}=S(n, n-1) /(n-1)\\) and \\(m_{n}=S(n, n) / n\\).\nProof. We use induction on \\(n\\). The base case \\(n=2\\) is routine. To perform the induction step, we need to prove the inequalities\n\n\\[\n\\frac{S(n, n)}{n} \\leqslant \\frac{S(n, k)}{k} \\quad \\text { and } \\quad \\frac{S(n, k)}{k} \\leqslant \\frac{S(n, n-1)}{n-1}\n\\]\n\nfor every positive integer \\(k \\leqslant n\\). Clearly, these inequalities hold for \\(k=n\\) and \\(k=n-1\\), as \\(S(n, n)=S(n, n-1)>0\\). In the sequel, we assume that \\(k<n-1\\).\n\nNow the first inequality in (1) rewrites as \\(n S(n, k) \\geqslant k S(n, n)=k(S(n, k)+S(n-k, n-k))\\), or, cancelling the terms occurring on both parts, as\n\n\\[\n(n-k) S(n, k) \\geqslant k S(n-k, n-k) \\Longleftrightarrow S(n, k) \\geqslant k \\cdot \\frac{S(n-k, n-k)}{n-k}\n\\]\n\nBy the induction hypothesis, we have \\(S(n-k, n-k) /(n-k)=m_{n-k}\\). By Claim 3, we get \\(a_{n-i} \\geqslant m_{n-k}\\) for all \\(i=1,2, \\ldots, k\\). Summing these \\(k\\) inequalities we obtain\n\n\\[\nS(n, k) \\geqslant k m_{n-k}=k \\cdot \\frac{S(n-k, n-k)}{n-k}\n\\]\n\nas required.\nThe second inequality in (1) is proved similarly. Indeed, this inequality is equivalent to\n\n\\[\n\\begin{aligned}\n(n-1) S(n, k) \\leqslant k S(n, n-1) & \\Longleftrightarrow(n-k-1) S(n, k) \\leqslant k S(n-k, n-k-1) \n& \\Longleftrightarrow S(n, k) \\leqslant k \\cdot \\frac{S(n-k, n-k-1)}{n-k-1}=k M_{n-k}\n\n\\]\n\nthe last inequality follows again from Claim 3, as each term in \\(S(n, k)\\) is at most \\(M_{n-k}\\).\nNow we can prove the required estimate for \\(a_{2018}-a_{2017}\\). Set \\(N=2017\\). By Claim 4,\n\n\\[\n\\begin{aligned}\na_{N+1}-a_{N} \\leqslant M_{N+1}-a_{N}=\\frac{S(N+1, N)}{N}-a_{N} & =\\frac{a_{N}+S(N, N-1)}{N}-a_{N} \n& =\\frac{S(N, N-1)}{N}-\\frac{N-1}{N} \\cdot a_{N}\n\n\\]\n\nOn the other hand, the same Claim yields\n\n\\[\na_{N} \\geqslant m_{N}=\\frac{S(N, N)}{N}=\\frac{S(N, N-1)}{N}\n\\]\n\nNoticing that each term in \\(S(N, N-1)\\) is at most 1 , so \\(S(N, N-1) \\leqslant N-1\\), we finally obtain\n\n\\[\na_{N+1}-a_{N} \\leqslant \\frac{S(N, N-1)}{N}-\\frac{N-1}{N} \\cdot \\frac{S(N, N-1)}{N}=\\frac{S(N, N-1)}{N^{2}} \\leqslant \\frac{N-1}{N^{2}} .\n\\]\n\nComment 1. Claim 1 in Solution 1 can be deduced from Claims 2 and 4 in Solution 2.\nBy Claim 4 we have \\(M_{n}=\\frac{S(n, n-1)}{n-1}\\) and \\(m_{n}=\\frac{S(n, n)}{n}=\\frac{S(n, n-1)}{n}\\). It follows that \\(\\Delta_{n}=M_{n}-m_{n}=\\) \\(\\frac{S(n, n-1)}{(n-1) n}\\) and so \\(M_{n}=n \\Delta_{n}\\) and \\(m_{n}=(n-1) \\Delta_{n}\\)\n\nSimilarly, \\(M_{n-1}=(n-1) \\Delta_{n-1}\\) and \\(m_{n-1}=(n-2) \\Delta_{n-1}\\). Then the inequalities \\(m_{n-1} \\leqslant m_{n}\\) and \\(M_{n} \\leqslant M_{n-1}\\) from Claim 2 write as \\((n-2) \\Delta_{n-1} \\leqslant(n-1) \\Delta_{n}\\) and \\(n \\Delta_{n} \\leqslant(n-1) \\Delta_{n-1}\\). Hence we have the double inequality\n\n\\[\n\\frac{n-2}{n-1} \\Delta_{n-1} \\leqslant \\Delta_{n} \\leqslant \\frac{n-1}{n} \\Delta_{n-1}\n\\]\n\nComment 2. Both solutions above discuss the properties of an arbitrary sequence satisfying the problem conditions. Instead, one may investigate only an optimal sequence which maximises the value of \\(a_{2018}-a_{2017}\\). Here we present an observation which allows to simplify such investigation - for instance, the proofs of Claim 1 in Solution 1 and Claim 4 in Solution 2.\n\nThe sequence \\(\\left(a_{n}\\right)\\) is uniquely determined by choosing, for every \\(n \\geqslant 2\\), a positive integer \\(k(n) \\leqslant n\\) such that \\(a_{n}=S(n, k(n)) / k(n)\\). Take an arbitrary \\(2 \\leqslant n_{0} \\leqslant 2018\\), and assume that all such integers \\(k(n)\\), for \\(n \\neq n_{0}\\), are fixed. Then, for every \\(n\\), the value of \\(a_{n}\\) is a linear function in \\(a_{n_{0}}\\) (whose possible values constitute some discrete subset of \\(\\left[m_{n_{0}}, M_{n_{0}}\\right]\\) containing both endpoints). Hence, \\(a_{2018}-a_{2017}\\) is also a linear function in \\(a_{n_{0}}\\), so it attains its maximal value at one of the endpoints of the segment \\(\\left[m_{n_{0}}, M_{n_{0}}\\right]\\).\n\nThis shows that, while dealing with an optimal sequence, we may assume \\(a_{n} \\in\\left\\{m_{n}, M_{n}\\right\\}\\) for all \\(2 \\leqslant n \\leqslant 2018\\). Now one can easily see that, if \\(a_{n}=m_{n}\\), then \\(m_{n+1}=m_{n}\\) and \\(M_{n+1} \\leqslant \\frac{m_{n}+n M_{n}}{n+1}\\); similar estimates hold in the case \\(a_{n}=M_{n}\\). This already establishes Claim 1, and simplifies the inductive proof of Claim 4, both applied to an optimal sequence."}
{"id": "imo-shortlist-2018-a5", "question": "A5. Determine all functions \\(f:(0, \\infty) \\rightarrow \\mathbb{R}\\) satisfying\n\n\\[\n\\left(x+\\frac{1}{x}\\right) f(y)=f(x y)+f\\left(\\frac{y}{x}\\right)\n\\]\n\nfor all \\(x, y>0\\).\n(South Korea)\nAnswer: \\(f(x)=C_{1} x+\\frac{C_{2}}{x}\\) with arbitrary constants \\(C_{1}\\) and \\(C_{2}\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2018, "solution": "Fix a real number \\(a>1\\), and take a new variable \\(t\\). For the values \\(f(t), f\\left(t^{2}\\right)\\), \\(f(a t)\\) and \\(f\\left(a^{2} t^{2}\\right)\\), the relation (1) provides a system of linear equations:\n\n\\[\n\\begin{array}{ll}\nx=y=t: & \\left(t+\\frac{1}{t}\\right) f(t)=f\\left(t^{2}\\right)+f(1) \nx=\\frac{t}{a}, y=a t: & \\left(\\frac{t}{a}+\\frac{a}{t}\\right) f(a t)=f\\left(t^{2}\\right)+f\\left(a^{2}\\right) \nx=a^{2} t, y=t: & \\left(a^{2} t+\\frac{1}{a^{2} t}\\right) f(t)=f\\left(a^{2} t^{2}\\right)+f\\left(\\frac{1}{a^{2}}\\right) \nx=y=a t: & \\left(a t+\\frac{1}{a t}\\right) f(a t)=f\\left(a^{2} t^{2}\\right)+f(1)\n\n\\]\n\nIn order to eliminate \\(f\\left(t^{2}\\right)\\), take the difference of (2a) and (2b); from (2c) and (2d) eliminate \\(f\\left(a^{2} t^{2}\\right)\\); then by taking a linear combination, eliminate \\(f(a t)\\) as well:\n\n\\[\n\\begin{aligned}\n\\left(t+\\frac{1}{t}\\right) f(t)-\\left(\\frac{t}{a}+\\frac{a}{t}\\right) f(a t) & =f(1)-f\\left(a^{2}\\right) \\quad \\text { and } \n\\left(a^{2} t+\\frac{1}{a^{2} t}\\right) & f(t)-\\left(a t+\\frac{1}{a t}\\right) f(a t)=f\\left(1 / a^{2}\\right)-f(1), \\quad \\text { so } \n\\left(\\left(a t+\\frac{1}{a t}\\right)\\left(t+\\frac{1}{t}\\right)\\right. & \\left.-\\left(\\frac{t}{a}+\\frac{a}{t}\\right)\\left(a^{2} t+\\frac{1}{a^{2} t}\\right)\\right) f(t) \n& =\\left(a t+\\frac{1}{a t}\\right)\\left(f(1)-f\\left(a^{2}\\right)\\right)-\\left(\\frac{t}{a}+\\frac{a}{t}\\right)\\left(f\\left(1 / a^{2}\\right)-f(1)\\right)\n\n\\]\n\nNotice that on the left-hand side, the coefficient of \\(f(t)\\) is nonzero and does not depend on \\(t\\) :\n\n\\[\n\\left(a t+\\frac{1}{a t}\\right)\\left(t+\\frac{1}{t}\\right)-\\left(\\frac{t}{a}+\\frac{a}{t}\\right)\\left(a^{2} t+\\frac{1}{a^{2} t}\\right)=a+\\frac{1}{a}-\\left(a^{3}+\\frac{1}{a^{3}}\\right)<0 .\n\\]\n\nAfter dividing by this fixed number, we get\n\n\\[\nf(t)=C_{1} t+\\frac{C_{2}}{t}\n\\]\n\nwhere the numbers \\(C_{1}\\) and \\(C_{2}\\) are expressed in terms of \\(a, f(1), f\\left(a^{2}\\right)\\) and \\(f\\left(1 / a^{2}\\right)\\), and they do not depend on \\(t\\).\n\nThe functions of the form (3) satisfy the equation:\n\n\\[\n\\left(x+\\frac{1}{x}\\right) f(y)=\\left(x+\\frac{1}{x}\\right)\\left(C_{1} y+\\frac{C_{2}}{y}\\right)=\\left(C_{1} x y+\\frac{C_{2}}{x y}\\right)+\\left(C_{1} \\frac{y}{x}+C_{2} \\frac{x}{y}\\right)=f(x y)+f\\left(\\frac{y}{x}\\right) .\n\\]\n\nSolution 2. We start with an observation. If we substitute \\(x=a \\neq 1\\) and \\(y=a^{n}\\) in (1), we obtain\n\n\\[\nf\\left(a^{n+1}\\right)-\\left(a+\\frac{1}{a}\\right) f\\left(a^{n}\\right)+f\\left(a^{n-1}\\right)=0\n\\]\n\nFor the sequence \\(z_{n}=a^{n}\\), this is a homogeneous linear recurrence of the second order, and its characteristic polynomial is \\(t^{2}-\\left(a+\\frac{1}{a}\\right) t+1=(t-a)\\left(t-\\frac{1}{a}\\right)\\) with two distinct nonzero roots, namely \\(a\\) and \\(1 / a\\). As is well-known, the general solution is \\(z_{n}=C_{1} a^{n}+C_{2}(1 / a)^{n}\\) where the index \\(n\\) can be as well positive as negative. Of course, the numbers \\(C_{1}\\) and \\(C_{2}\\) may depend of the choice of \\(a\\), so in fact we have two functions, \\(C_{1}\\) and \\(C_{2}\\), such that\n\n\\[\nf\\left(a^{n}\\right)=C_{1}(a) \\cdot a^{n}+\\frac{C_{2}(a)}{a^{n}} \\quad \\text { for every } a \\neq 1 \\text { and every integer } n .\n\\]\n\nThe relation (4) can be easily extended to rational values of \\(n\\), so we may conjecture that \\(C_{1}\\) and \\(C_{2}\\) are constants, and whence \\(f(t)=C_{1} t+\\frac{C_{2}}{t}\\). As it was seen in the previous solution, such functions indeed satisfy (1).\n\nThe equation (1) is linear in \\(f\\); so if some functions \\(f_{1}\\) and \\(f_{2}\\) satisfy (1) and \\(c_{1}, c_{2}\\) are real numbers, then \\(c_{1} f_{1}(x)+c_{2} f_{2}(x)\\) is also a solution of (1). In order to make our formulas simpler, define\n\n\\[\nf_{0}(x)=f(x)-f(1) \\cdot x\n\\]\n\nThis function is another one satisfying (1) and the extra constraint \\(f_{0}(1)=0\\). Repeating the same argument on linear recurrences, we can write \\(f_{0}(a)=K(a) a^{n}+\\frac{L(a)}{a^{n}}\\) with some functions \\(K\\) and \\(L\\). By substituting \\(n=0\\), we can see that \\(K(a)+L(a)=f_{0}(1)=0\\) for every \\(a\\). Hence,\n\n\\[\nf_{0}\\left(a^{n}\\right)=K(a)\\left(a^{n}-\\frac{1}{a^{n}}\\right)\n\\]\n\nNow take two numbers \\(a>b>1\\) arbitrarily and substitute \\(x=(a / b)^{n}\\) and \\(y=(a b)^{n}\\) in (1):\n\n\\[\n\\begin{aligned}\n\\left(\\frac{a^{n}}{b^{n}}+\\frac{b^{n}}{a^{n}}\\right) f_{0}\\left((a b)^{n}\\right) & =f_{0}\\left(a^{2 n}\\right)+f_{0}\\left(b^{2 n}\\right), \\quad \\text { so } \n\\left(\\frac{a^{n}}{b^{n}}+\\frac{b^{n}}{a^{n}}\\right) K(a b)\\left((a b)^{n}-\\frac{1}{(a b)^{n}}\\right) & =K(a)\\left(a^{2 n}-\\frac{1}{a^{2 n}}\\right)+K(b)\\left(b^{2 n}-\\frac{1}{b^{2 n}}\\right), \\quad \\text { or equivalently } \nK(a b)\\left(a^{2 n}-\\frac{1}{a^{2 n}}+b^{2 n}-\\frac{1}{b^{2 n}}\\right) & =K(a)\\left(a^{2 n}-\\frac{1}{a^{2 n}}\\right)+K(b)\\left(b^{2 n}-\\frac{1}{b^{2 n}}\\right)\n\n\\]\n\nBy dividing (5) by \\(a^{2 n}\\) and then taking limit with \\(n \\rightarrow+\\infty\\) we get \\(K(a b)=K(a)\\). Then (5) reduces to \\(K(a)=K(b)\\). Hence, \\(K(a)=K(b)\\) for all \\(a>b>1\\).\n\nFix \\(a>1\\). For every \\(x>0\\) there is some \\(b\\) and an integer \\(n\\) such that \\(1<b<a\\) and \\(x=b^{n}\\). Then\n\n\\[\nf_{0}(x)=f_{0}\\left(b^{n}\\right)=K(b)\\left(b^{n}-\\frac{1}{b^{n}}\\right)=K(a)\\left(x-\\frac{1}{x}\\right)\n\\]\n\nHence, we have \\(f(x)=f_{0}(x)+f(1) x=C_{1} x+\\frac{C_{2}}{x}\\) with \\(C_{1}=K(a)+f(1)\\) and \\(C_{2}=-K(a)\\).\n\nComment. After establishing (5), there are several variants of finishing the solution. For example, instead of taking a limit, we can obtain a system of linear equations for \\(K(a), K(b)\\) and \\(K(a b)\\) by substituting two positive integers \\(n\\) in (5), say \\(n=1\\) and \\(n=2\\). This approach leads to a similar ending as in the first solution.\n\nOptionally, we define another function \\(f_{1}(x)=f_{0}(x)-C\\left(x-\\frac{1}{x}\\right)\\) and prescribe \\(K(c)=0\\) for another fixed \\(c\\). Then we can choose \\(a b=c\\) and decrease the number of terms in (5)."}
{"id": "imo-shortlist-2018-a6", "question": "A6. Let \\(m, n \\geqslant 2\\) be integers. Let \\(f\\left(x_{1}, \\ldots, x_{n}\\right)\\) be a polynomial with real coefficients such that\n\n\\[\nf\\left(x_{1}, \\ldots, x_{n}\\right)=\\left\\lfloor\\frac{x_{1}+\\ldots+x_{n}}{m}\\right\\rfloor \\quad \\text { for every } x_{1}, \\ldots, x_{n} \\in\\{0,1, \\ldots, m-1\\}\n\\]\n\nProve that the total degree of \\(f\\) is at least \\(n\\).\n(Brazil)", "category": "Algebra", "source": "IMO Shortlist", "year": 2018, "solution": "We transform the problem to a single variable question by the following\nLemma. Let \\(a_{1}, \\ldots, a_{n}\\) be nonnegative integers and let \\(G(x)\\) be a nonzero polynomial with \\(\\operatorname{deg} G \\leqslant a_{1}+\\ldots+a_{n}\\). Suppose that some polynomial \\(F\\left(x_{1}, \\ldots, x_{n}\\right)\\) satisfies\n\n\\[\nF\\left(x_{1}, \\ldots, x_{n}\\right)=G\\left(x_{1}+\\ldots+x_{n}\\right) \\quad \\text { for }\\left(x_{1}, \\ldots, x_{n}\\right) \\in\\left\\{0,1, \\ldots, a_{1}\\right\\} \\times \\ldots \\times\\left\\{0,1, \\ldots, a_{n}\\right\\}\n\\]\n\nThen \\(F\\) cannot be the zero polynomial, and \\(\\operatorname{deg} F \\geqslant \\operatorname{deg} G\\).\nFor proving the lemma, we will use forward differences of polynomials. If \\(p(x)\\) is a polynomial with a single variable, then define \\((\\Delta p)(x)=p(x+1)-p(x)\\). It is well-known that if \\(p\\) is a nonconstant polynomial then \\(\\operatorname{deg} \\Delta p=\\operatorname{deg} p-1\\).\n\nIf \\(p\\left(x_{1}, \\ldots, x_{n}\\right)\\) is a polynomial with \\(n\\) variables and \\(1 \\leqslant k \\leqslant n\\) then let\n\n\\[\n\\left(\\Delta_{k} p\\right)\\left(x_{1}, \\ldots, x_{n}\\right)=p\\left(x_{1}, \\ldots, x_{k-1}, x_{k}+1, x_{k+1}, \\ldots, x_{n}\\right)-p\\left(x_{1}, \\ldots, x_{n}\\right)\n\\]\n\nIt is also well-known that either \\(\\Delta_{k} p\\) is the zero polynomial or \\(\\operatorname{deg}\\left(\\Delta_{k} p\\right) \\leqslant \\operatorname{deg} p-1\\).\nProof of the lemma. We apply induction on the degree of \\(G\\). If \\(G\\) is a constant polynomial then we have \\(F(0, \\ldots, 0)=G(0) \\neq 0\\), so \\(F\\) cannot be the zero polynomial.\n\nSuppose that \\(\\operatorname{deg} G \\geqslant 1\\) and the lemma holds true for lower degrees. Since \\(a_{1}+\\ldots+a_{n} \\geqslant\\) \\(\\operatorname{deg} G>0\\), at least one of \\(a_{1}, \\ldots, a_{n}\\) is positive; without loss of generality suppose \\(a_{1} \\geqslant 1\\).\n\nConsider the polynomials \\(F_{1}=\\Delta_{1} F\\) and \\(G_{1}=\\Delta G\\). On the grid \\(\\left\\{0, \\ldots, a_{1}-1\\right\\} \\times\\left\\{0, \\ldots, a_{2}\\right\\} \\times\\) \\(\\ldots \\times\\left\\{0, \\ldots, a_{n}\\right\\}\\) we have\n\n\\[\n\\begin{aligned}\nF_{1}\\left(x_{1}, \\ldots, x_{n}\\right) & =F\\left(x_{1}+1, x_{2}, \\ldots, x_{n}\\right)-F\\left(x_{1}, x_{2}, \\ldots, x_{n}\\right)= \n& =G\\left(x_{1}+\\ldots+x_{n}+1\\right)-G\\left(x_{1}+\\ldots+x_{n}\\right)=G_{1}\\left(x_{1}+\\ldots+x_{n}\\right)\n\n\\]\n\nSince \\(G\\) is nonconstant, we have \\(\\operatorname{deg} G_{1}=\\operatorname{deg} G-1 \\leqslant\\left(a_{1}-1\\right)+a_{2}+\\ldots+a_{n}\\). Therefore we can apply the induction hypothesis to \\(F_{1}\\) and \\(G_{1}\\) and conclude that \\(F_{1}\\) is not the zero polynomial and \\(\\operatorname{deg} F_{1} \\geqslant \\operatorname{deg} G_{1}\\). Hence, \\(\\operatorname{deg} F \\geqslant \\operatorname{deg} F_{1}+1 \\geqslant \\operatorname{deg} G_{1}+1=\\operatorname{deg} G\\). That finishes the proof.\n\nTo prove the problem statement, take the unique polynomial \\(g(x)\\) so that \\(g(x)=\\left\\lfloor\\frac{x}{m}\\right\\rfloor\\) for \\(x \\in\\{0,1, \\ldots, n(m-1)\\}\\) and \\(\\operatorname{deg} g \\leqslant n(m-1)\\). Notice that precisely \\(n(m-1)+1\\) values of \\(g\\) are prescribed, so \\(g(x)\\) indeed exists and is unique. Notice further that the constraints \\(g(0)=g(1)=0\\) and \\(g(m)=1\\) together enforce \\(\\operatorname{deg} g \\geqslant 2\\).\n\nBy applying the lemma to \\(a_{1}=\\ldots=a_{n}=m-1\\) and the polynomials \\(f\\) and \\(g\\), we achieve \\(\\operatorname{deg} f \\geqslant \\operatorname{deg} g\\). Hence we just need a suitable lower bound on \\(\\operatorname{deg} g\\).\n\nConsider the polynomial \\(h(x)=g(x+m)-g(x)-1\\). The degree of \\(g(x+m)-g(x)\\) is \\(\\operatorname{deg} g-1 \\geqslant 1\\), so \\(\\operatorname{deg} h=\\operatorname{deg} g-1 \\geqslant 1\\), and therefore \\(h\\) cannot be the zero polynomial. On the other hand, \\(h\\) vanishes at the points \\(0,1, \\ldots, n(m-1)-m\\), so \\(h\\) has at least \\((n-1)(m-1)\\) roots. Hence,\n\n\\[\n\\operatorname{deg} f \\geqslant \\operatorname{deg} g=\\operatorname{deg} h+1 \\geqslant(n-1)(m-1)+1 \\geqslant n .\n\\]\n\nComment 1. In the lemma we have equality for the choice \\(F\\left(x_{1}, \\ldots, x_{n}\\right)=G\\left(x_{1}+\\ldots+x_{n}\\right)\\), so it indeed transforms the problem to an equivalent single-variable question.\n\nComment 2. If \\(m \\geqslant 3\\), the polynomial \\(h(x)\\) can be replaced by \\(\\Delta g\\). Notice that\n\n\\[\n(\\Delta g)(x)=\\left\\{\\begin{array}{ll}\n1 & \\text { if } x \\equiv-1 \\quad(\\bmod m) \n0 & \\text { otherwise }\n \\quad \\text { for } x=0,1, \\ldots, n(m-1)-1\\right.\n\\]\n\nHence, \\(\\Delta g\\) vanishes at all integers \\(x\\) with \\(0 \\leqslant x<n(m-1)\\) and \\(x \\not \\equiv-1(\\bmod m)\\). This leads to \\(\\operatorname{deg} g \\geqslant \\frac{(m-1)^{2} n}{m}+1\\).\n\nIf \\(m\\) is even then this lower bound can be improved to \\(n(m-1)\\). For \\(0 \\leqslant N<n(m-1)\\), the \\((N+1)^{\\text {st }}\\) forward difference at \\(x=0\\) is\n\n\\[\n\\left(\\Delta^{N+1}\\right) g(0)=\\sum_{k=0}^{N}(-1)^{N-k}\\binom{N}{k}(\\Delta g)(k)=\\sum_{\\substack{0 \\leqslant k \\leqslant N \\\\ k \\equiv-1(\\bmod m)}}(-1)^{N-k}\\binom{N}{k}\n\\]\n\nSince \\(m\\) is even, all signs in the last sum are equal; with \\(N=n(m-1)-1\\) this proves \\(\\Delta^{n(m-1)} g(0) \\neq 0\\), indicating that \\(\\operatorname{deg} g \\geqslant n(m-1)\\).\n\nHowever, there are infinitely many cases when all terms in (*) cancel out, for example if \\(m\\) is an odd divisor of \\(n+1\\). In such cases, \\(\\operatorname{deg} f\\) can be less than \\(n(m-1)\\).\n\nComment 3. The lemma is closely related to the so-called\nAlon-Fredi bound. Let \\(S_{1}, \\ldots, S_{n}\\) be nonempty finite sets in a field and suppose that the polynomial \\(P\\left(x_{1}, \\ldots, x_{n}\\right)\\) vanishes at the points of the grid \\(S_{1} \\times \\ldots \\times S_{n}\\), except for a single point. Then \\(\\operatorname{deg} P \\geqslant \\sum_{i=1}^{n}\\left(\\left|S_{i}\\right|-1\\right)\\).\n(A well-known application of the Alon-Fredi bound was the former IMO problem 2007/6. Since then, this result became popular among the students and is part of the IMO training for many IMO teams.)\n\nThe proof of the lemma can be replaced by an application of the Alon-Fredi bound as follows. Let \\(d=\\operatorname{deg} G\\), and let \\(G_{0}\\) be the unique polynomial such that \\(G_{0}(x)=G(x)\\) for \\(x \\in\\{0,1, \\ldots, d-1\\}\\) but \\(\\operatorname{deg} G_{0}<d\\). The polynomials \\(G_{0}\\) and \\(G\\) are different because they have different degrees, and they attain the same values at \\(0,1, \\ldots, d-1\\); that enforces \\(G_{0}(d) \\neq G(d)\\).\n\nChoose some nonnegative integers \\(b_{1}, \\ldots, b_{n}\\) so that \\(b_{1} \\leqslant a_{1}, \\ldots, b_{n} \\leqslant a_{n}\\), and \\(b_{1}+\\ldots+b_{n}=d\\), and consider the polynomial\n\n\\[\nH\\left(x_{1}, \\ldots, x_{n}\\right)=F\\left(x_{1}, \\ldots, x_{n}\\right)-G_{0}\\left(x_{1}+\\ldots+x_{n}\\right)\n\\]\n\non the grid \\(\\left\\{0,1, \\ldots, b_{1}\\right\\} \\times \\ldots \\times\\left\\{0,1, \\ldots, b_{n}\\right\\}\\).\nAt the point \\(\\left(b_{1}, \\ldots, b_{n}\\right)\\) we have \\(H\\left(b_{1}, \\ldots, b_{n}\\right)=G(d)-G_{0}(d) \\neq 0\\). At all other points of the grid we have \\(F=G\\) and therefore \\(H=G-G_{0}=0\\). So, by the Alon-Fredi bound, \\(\\operatorname{deg} H \\geqslant b_{1}+\\ldots+b_{n}=d\\). Since \\(\\operatorname{deg} G_{0}<d\\), this implies \\(\\operatorname{deg} F=\\operatorname{deg}\\left(H+G_{0}\\right)=\\operatorname{deg} H \\geqslant d=\\operatorname{deg} G\\)."}
{"id": "imo-shortlist-2018-a7", "question": "A7. Find the maximal value of\n\n\\[\nS=\\sqrt[3]{\\frac{a}{b+7}}+\\sqrt[3]{\\frac{b}{c+7}}+\\sqrt[3]{\\frac{c}{d+7}}+\\sqrt[3]{\\frac{d}{a+7}}\n\\]\n\nwhere \\(a, b, c, d\\) are nonnegative real numbers which satisfy \\(a+b+c+d=100\\).\n(Taiwan)\nAnswer: \\(\\frac{8}{\\sqrt[3]{7}}\\), reached when \\((a, b, c, d)\\) is a cyclic permutation of \\((1,49,1,49)\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2018, "solution": "Since the value \\(8 / \\sqrt[3]{7}\\) is reached, it suffices to prove that \\(S \\leqslant 8 / \\sqrt[3]{7}\\).\nAssume that \\(x, y, z, t\\) is a permutation of the variables, with \\(x \\leqslant y \\leqslant z \\leqslant t\\). Then, by the rearrangement inequality,\n\n\\[\nS \\leqslant\\left(\\sqrt[3]{\\frac{x}{t+7}}+\\sqrt[3]{\\frac{t}{x+7}}\\right)+\\left(\\sqrt[3]{\\frac{y}{z+7}}+\\sqrt[3]{\\frac{z}{y+7}}\\right)\n\\]\n\nClaim. The first bracket above does not exceed \\(\\sqrt[3]{\\frac{x+t+14}{7}}\\).\nProof. Since\n\n\\[\nX^{3}+Y^{3}+3 X Y Z-Z^{3}=\\frac{1}{2}(X+Y-Z)\\left((X-Y)^{2}+(X+Z)^{2}+(Y+Z)^{2}\\right),\n\\]\n\nthe inequality \\(X+Y \\leqslant Z\\) is equivalent (when \\(X, Y, Z \\geqslant 0\\) ) to \\(X^{3}+Y^{3}+3 X Y Z \\leqslant Z^{3}\\). Therefore, the claim is equivalent to\n\n\\[\n\\frac{x}{t+7}+\\frac{t}{x+7}+3 \\sqrt[3]{\\frac{x t(x+t+14)}{7(x+7)(t+7)}} \\leqslant \\frac{x+t+14}{7}\n\\]\n\nNotice that\n\n\\[\n\\begin{aligned}\n& 3 \\sqrt[3]{\\frac{x t(x+t+14)}{7(x+7)(t+7)}}=3 \\sqrt[3]{\\frac{t(x+7)}{7(t+7)} \\cdot \\frac{x(t+7)}{7(x+7)} \\cdot \\frac{7(x+t+14)}{(t+7)(x+7)}} \n& \\quad \\leqslant \\frac{t(x+7)}{7(t+7)}+\\frac{x(t+7)}{7(x+7)}+\\frac{7(x+t+14)}{(t+7)(x+7)}\n\n\\]\n\nby the AM-GM inequality, so it suffices to prove\n\n\\[\n\\frac{x}{t+7}+\\frac{t}{x+7}+\\frac{t(x+7)}{7(t+7)}+\\frac{x(t+7)}{7(x+7)}+\\frac{7(x+t+14)}{(t+7)(x+7)} \\leqslant \\frac{x+t+14}{7}\n\\]\n\nA straightforward check verifies that the last inequality is in fact an equality.\nThe claim leads now to\n\n\\[\nS \\leqslant \\sqrt[3]{\\frac{x+t+14}{7}}+\\sqrt[3]{\\frac{y+z+14}{7}} \\leqslant 2 \\sqrt[3]{\\frac{x+y+z+t+28}{14}}=\\frac{8}{\\sqrt[3]{7}}\n\\]\n\nthe last inequality being due to the AM-CM inequality (or to the fact that \\(\\sqrt[3]{ }\\) is concave on \\([0, \\infty)\\) ).\n\nSolution 2. We present a different proof for the estimate \\(S \\leqslant 8 / \\sqrt[3]{7}\\).\nStart by using Hlder's inequality:\n\n\\[\nS^{3}=\\left(\\sum_{\\mathrm{cyc}} \\frac{\\sqrt[6]{a} \\cdot \\sqrt[6]{a}}{\\sqrt[3]{b+7}}\\right)^{3} \\leqslant \\sum_{\\mathrm{cyc}}(\\sqrt[6]{a})^{3} \\cdot \\sum_{\\mathrm{cyc}}(\\sqrt[6]{a})^{3} \\cdot \\sum_{\\mathrm{cyc}}\\left(\\frac{1}{\\sqrt[3]{b+7}}\\right)^{3}=\\left(\\sum_{\\mathrm{cyc}} \\sqrt{a}\\right)^{2} \\sum_{\\mathrm{cyc}} \\frac{1}{b+7}\n\\]\n\nNotice that\n\n\\[\n\\frac{(x-1)^{2}(x-7)^{2}}{x^{2}+7} \\geqslant 0 \\Longleftrightarrow x^{2}-16 x+71 \\geqslant \\frac{448}{x^{2}+7}\n\\]\n\nyields\n\n\\[\n\\sum \\frac{1}{b+7} \\leqslant \\frac{1}{448} \\sum(b-16 \\sqrt{b}+71)=\\frac{1}{448}\\left(384-16 \\sum \\sqrt{b}\\right)=\\frac{48-2 \\sum \\sqrt{b}}{56} .\n\\]\n\nFinally,\n\n\\[\nS^{3} \\leqslant \\frac{1}{56}\\left(\\sum \\sqrt{a}\\right)^{2}\\left(48-2 \\sum \\sqrt{a}\\right) \\leqslant \\frac{1}{56}\\left(\\frac{\\sum \\sqrt{a}+\\sum \\sqrt{a}+\\left(48-2 \\sum \\sqrt{a}\\right)}{3}\\right)^{3}=\\frac{512}{7}\n\\]\n\nby the AM-GM inequality. The conclusion follows.\nComment. All the above works if we replace 7 and 100 with \\(k>0\\) and \\(2\\left(k^{2}+1\\right)\\), respectively; in this case, the answer becomes\n\n\\[\n2 \\sqrt[3]{\\frac{(k+1)^{2}}{k}}\n\\]\n\nEven further, a linear substitution allows to extend the solutions to a version with 7 and 100 being replaced with arbitrary positive real numbers \\(p\\) and \\(q\\) satisfying \\(q \\geqslant 4 p\\)."}
{"id": "imo-shortlist-2018-c1", "question": "C1. Let \\(n \\geqslant 3\\) be an integer. Prove that there exists a set \\(S\\) of \\(2 n\\) positive integers satisfying the following property: For every \\(m=2,3, \\ldots, n\\) the set \\(S\\) can be partitioned into two subsets with equal sums of elements, with one of subsets of cardinality \\(m\\).\n(Iceland)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2018, "solution": "We show that one of possible examples is the set\n\n\\[\nS=\\left\\{1 \\cdot 3^{k}, 2 \\cdot 3^{k}: k=1,2, \\ldots, n-1\\right\\} \\cup\\left\\{1, \\frac{3^{n}+9}{2}-1\\right\\}\n\\]\n\nIt is readily verified that all the numbers listed above are distinct (notice that the last two are not divisible by 3 ).\n\nThe sum of elements in \\(S\\) is\n\\(\\Sigma=1+\\left(\\frac{3^{n}+9}{2}-1\\right)+\\sum_{k=1}^{n-1}\\left(1 \\cdot 3^{k}+2 \\cdot 3^{k}\\right)=\\frac{3^{n}+9}{2}+\\sum_{k=1}^{n-1} 3^{k+1}=\\frac{3^{n}+9}{2}+\\frac{3^{n+1}-9}{2}=2 \\cdot 3^{n}\\).\nHence, in order to show that this set satisfies the problem requirements, it suffices to present, for every \\(m=2,3, \\ldots, n\\), an \\(m\\)-element subset \\(A_{m} \\subset S\\) whose sum of elements equals \\(3^{n}\\).\n\nSuch a subset is\n\n\\[\nA_{m}=\\left\\{2 \\cdot 3^{k}: k=n-m+1, n-m+2, \\ldots, n-1\\right\\} \\cup\\left\\{1 \\cdot 3^{n-m+1}\\right\\}\n\\]\n\nClearly, \\(\\left|A_{m}\\right|=m\\). The sum of elements in \\(A_{m}\\) is\n\n\\[\n3^{n-m+1}+\\sum_{k=n-m+1}^{n-1} 2 \\cdot 3^{k}=3^{n-m+1}+\\frac{2 \\cdot 3^{n}-2 \\cdot 3^{n-m+1}}{2}=3^{n}\n\\]\n\nas required.\n\nComment. Let us present a more general construction. Let \\(s_{1}, s_{2}, \\ldots, s_{2 n-1}\\) be a sequence of pairwise distinct positive integers satisfying \\(s_{2 i+1}=s_{2 i}+s_{2 i-1}\\) for all \\(i=2,3, \\ldots, n-1\\). Set \\(s_{2 n}=s_{1}+s_{2}+\\) \\(\\cdots+s_{2 n-4}\\).\n\nAssume that \\(s_{2 n}\\) is distinct from the other terms of the sequence. Then the set \\(S=\\left\\{s_{1}, s_{2}, \\ldots, s_{2 n}\\right\\}\\) satisfies the problem requirements. Indeed, the sum of its elements is\n\n\\[\n\\Sigma=\\sum_{i=1}^{2 n-4} s_{i}+\\left(s_{2 n-3}+s_{2 n-2}\\right)+s_{2 n-1}+s_{2 n}=s_{2 n}+s_{2 n-1}+s_{2 n-1}+s_{2 n}=2 s_{2 n}+2 s_{2 n-1}\n\\]\n\nTherefore, we have\n\n\\[\n\\frac{\\Sigma}{2}=s_{2 n}+s_{2 n-1}=s_{2 n}+s_{2 n-2}+s_{2 n-3}=s_{2 n}+s_{2 n-2}+s_{2 n-4}+s_{2 n-5}=\\ldots\n\\]\n\nwhich shows that the required sets \\(A_{m}\\) can be chosen as\n\n\\[\nA_{m}=\\left\\{s_{2 n}, s_{2 n-2}, \\ldots, s_{2 n-2 m+4}, s_{2 n-2 m+3}\\right\\}\n\\]\n\nSo, the only condition to be satisfied is \\(s_{2 n} \\notin\\left\\{s_{1}, s_{2}, \\ldots, s_{2 n-1}\\right\\}\\), which can be achieved in many different ways (e.g., by choosing properly the number \\(s_{1}\\) after specifying \\(s_{2}, s_{3}, \\ldots, s_{2 n-1}\\) ).\n\nThe solution above is an instance of this general construction. Another instance, for \\(n>3\\), is the set\n\n\\[\n\\left\\{F_{1}, F_{2}, \\ldots, F_{2 n-1}, F_{1}+\\cdots+F_{2 n-4}\\right\\}\n\\]\n\nwhere \\(F_{1}=1, F_{2}=2, F_{n+1}=F_{n}+F_{n-1}\\) is the usual Fibonacci sequence."}
{"id": "imo-shortlist-2018-c2", "question": "C2. Queenie and Horst play a game on a \\(20 \\times 20\\) chessboard. In the beginning the board is empty. In every turn, Horst places a black knight on an empty square in such a way that his new knight does not attack any previous knights. Then Queenie places a white queen on an empty square. The game gets finished when somebody cannot move.\n\nFind the maximal positive \\(K\\) such that, regardless of the strategy of Queenie, Horst can put at least \\(K\\) knights on the board.\n(Armenia)\nAnswer: \\(K=20^{2} / 4=100\\). In case of a \\(4 N \\times 4 M\\) board, the answer is \\(K=4 N M\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2018, "solution": "We show two strategies, one for Horst to place at least 100 knights, and another strategy for Queenie that prevents Horst from putting more than 100 knights on the board.\n\nA strategy for Horst: Put knights only on black squares, until all black squares get occupied.\n\nColour the squares of the board black and white in the usual way, such that the white and black squares alternate, and let Horst put his knights on black squares as long as it is possible. Two knights on squares of the same colour never attack each other. The number of black squares is \\(20^{2} / 2=200\\). The two players occupy the squares in turn, so Horst will surely find empty black squares in his first 100 steps.\n\nA strategy for Queenie: Group the squares into cycles of length 4, and after each step of Horst, occupy the opposite square in the same cycle.\n\nConsider the squares of the board as vertices of a graph; let two squares be connected if two knights on those squares would attack each other. Notice that in a \\(4 \\times 4\\) board the squares can be grouped into 4 cycles of length 4, as shown in Figure 1. Divide the board into parts of size \\(4 \\times 4\\), and perform the same grouping in every part; this way we arrange the 400 squares of the board into 100 cycles (Figure 2).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b62628dbd164bd27ffa8g-27}\n\nFigure 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b62628dbd164bd27ffa8g-27(2)}\n\nFigure 2\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b62628dbd164bd27ffa8g-27(1)}\n\nFigure 3\n\nThe strategy of Queenie can be as follows: Whenever Horst puts a new knight to a certain square \\(A\\), which is part of some cycle \\(A-B-C-D-A\\), let Queenie put her queen on the opposite square \\(C\\) in that cycle (Figure 3). From this point, Horst cannot put any knight on \\(A\\) or \\(C\\) because those squares are already occupied, neither on \\(B\\) or \\(D\\) because those squares are attacked by the knight standing on \\(A\\). Hence, Horst can put at most one knight on each cycle, that is at most 100 knights in total.\n\nComment 1. Queenie's strategy can be prescribed by a simple rule: divide the board into \\(4 \\times 4\\) parts; whenever Horst puts a knight in a part \\(P\\), Queenie reflects that square about the centre of \\(P\\) and puts her queen on the reflected square.\n\nComment 2. The result remains the same if Queenie moves first. In the first turn, she may put her first queen arbitrarily. Later, if she has to put her next queen on a square that already contains a queen, she may move arbitrarily again."}
{"id": "imo-shortlist-2018-c3", "question": "C3. Let \\(n\\) be a given positive integer. Sisyphus performs a sequence of turns on a board consisting of \\(n+1\\) squares in a row, numbered 0 to \\(n\\) from left to right. Initially, \\(n\\) stones are put into square 0, and the other squares are empty. At every turn, Sisyphus chooses any nonempty square, say with \\(k\\) stones, takes one of those stones and moves it to the right by at most \\(k\\) squares (the stone should stay within the board). Sisyphus' aim is to move all \\(n\\) stones to square \\(n\\).\n\nProve that Sisyphus cannot reach the aim in less than\n\n\\[\n\\left\\lceil\\frac{n}{1}\\right\\rceil+\\left\\lceil\\frac{n}{2}\\right\\rceil+\\left\\lceil\\frac{n}{3}\\right\\rceil+\\cdots+\\left\\lceil\\frac{n}{n}\\right\\rceil\n\\]\n\nturns. (As usual, \\(\\lceil x\\rceil\\) stands for the least integer not smaller than \\(x\\).)\n(Netherlands)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2018, "solution": "The stones are indistinguishable, and all have the same origin and the same final position. So, at any turn we can prescribe which stone from the chosen square to move. We do it in the following manner. Number the stones from 1 to \\(n\\). At any turn, after choosing a square, Sisyphus moves the stone with the largest number from this square.\n\nThis way, when stone \\(k\\) is moved from some square, that square contains not more than \\(k\\) stones (since all their numbers are at most \\(k\\) ). Therefore, stone \\(k\\) is moved by at most \\(k\\) squares at each turn. Since the total shift of the stone is exactly \\(n\\), at least \\(\\lceil n / k\\rceil\\) moves of stone \\(k\\) should have been made, for every \\(k=1,2, \\ldots, n\\).\n\nBy summing up over all \\(k=1,2, \\ldots, n\\), we get the required estimate.\n\nComment. The original submission contained the second part, asking for which values of \\(n\\) the equality can be achieved. The answer is \\(n=1,2,3,4,5,7\\). The Problem Selection Committee considered this part to be less suitable for the competition, due to technicalities."}
{"id": "imo-shortlist-2018-c4", "question": "C4. An anti-Pascal pyramid is a finite set of numbers, placed in a triangle-shaped array so that the first row of the array contains one number, the second row contains two numbers, the third row contains three numbers and so on; and, except for the numbers in the bottom row, each number equals the absolute value of the difference of the two numbers below it. For instance, the triangle below is an anti-Pascal pyramid with four rows, in which every integer from 1 to \\(1+2+3+4=10\\) occurs exactly once:\n\n\\begin{center}\n\\begin{tabular}{cccc}\n & \\multicolumn{2}{c}{4} &  \n\\({ }^{2}\\) & 6 &  &  \n\\(5^{5}\\) & \\(7^{7}\\) & 1 &  \n8 & 10 & 9. &  \nIs it possible to form an anti-Pascal pyramid with 2018 rows, using every integer from 1 to \\(1+2+\\cdots+2018\\) exactly once?\n(Iran)\nAnswer: No, it is not possible.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2018, "solution": "Let \\(T\\) be an anti-Pascal pyramid with \\(n\\) rows, containing every integer from 1 to \\(1+2+\\cdots+n\\), and let \\(a_{1}\\) be the topmost number in \\(T\\) (Figure 1). The two numbers below \\(a_{1}\\) are some \\(a_{2}\\) and \\(b_{2}=a_{1}+a_{2}\\), the two numbers below \\(b_{2}\\) are some \\(a_{3}\\) and \\(b_{3}=a_{1}+a_{2}+a_{3}\\), and so on and so forth all the way down to the bottom row, where some \\(a_{n}\\) and \\(b_{n}=a_{1}+a_{2}+\\cdots+a_{n}\\) are the two neighbours below \\(b_{n-1}=a_{1}+a_{2}+\\cdots+a_{n-1}\\). Since the \\(a_{k}\\) are \\(n\\) pairwise distinct positive integers whose sum does not exceed the largest number in \\(T\\), which is \\(1+2+\\cdots+n\\), it follows that they form a permutation of \\(1,2, \\ldots, n\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b62628dbd164bd27ffa8g-29}\n\nFigure 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b62628dbd164bd27ffa8g-29(1)}\n\nFigure 2\n\nConsider now (Figure 2) the two 'equilateral' subtriangles of \\(T\\) whose bottom rows contain the numbers to the left, respectively right, of the pair \\(a_{n}, b_{n}\\). (One of these subtriangles may very well be empty.) At least one of these subtriangles, say \\(T^{\\prime}\\), has side length \\(\\ell \\geqslant\\lceil(n-2) / 2\\rceil\\). Since \\(T^{\\prime}\\) obeys the anti-Pascal rule, it contains \\(\\ell\\) pairwise distinct positive integers \\(a_{1}^{\\prime}, a_{2}^{\\prime}, \\ldots, a_{\\ell}^{\\prime}\\), where \\(a_{1}^{\\prime}\\) is at the apex, and \\(a_{k}^{\\prime}\\) and \\(b_{k}^{\\prime}=a_{1}^{\\prime}+a_{2}^{\\prime}+\\cdots+a_{k}^{\\prime}\\) are the two neighbours below \\(b_{k-1}^{\\prime}\\) for each \\(k=2,3 \\ldots, \\ell\\). Since the \\(a_{k}\\) all lie outside \\(T^{\\prime}\\), and they form a permutation of \\(1,2, \\ldots, n\\), the \\(a_{k}^{\\prime}\\) are all greater than \\(n\\). Consequently,\n\n\\[\n\\begin{array}{r}\nb_{\\ell}^{\\prime} \\geqslant(n+1)+(n+2)+\\cdots+(n+\\ell)=\\frac{\\ell(2 n+\\ell+1)}{2} \n\\geqslant \\frac{1}{2} \\cdot \\frac{n-2}{2}\\left(2 n+\\frac{n-2}{2}+1\\right)=\\frac{5 n(n-2)}{8},\n\n\\]\n\nwhich is greater than \\(1+2+\\cdots+n=n(n+1) / 2\\) for \\(n=2018\\). A contradiction.\nComment. The above estimate may be slightly improved by noticing that \\(b_{\\ell}^{\\prime} \\neq b_{n}\\). This implies \\(n(n+1) / 2=b_{n}>b_{\\ell}^{\\prime} \\geqslant\\lceil(n-2) / 2\\rceil(2 n+\\lceil(n-2) / 2\\rceil+1) / 2\\), so \\(n \\leqslant 7\\) if \\(n\\) is odd, and \\(n \\leqslant 12\\) if \\(n\\) is even. It seems that the largest anti-Pascal pyramid whose entries are a permutation of the integers from 1 to \\(1+2+\\cdots+n\\) has 5 rows."}
{"id": "imo-shortlist-2018-c5", "question": "C5. Let \\(k\\) be a positive integer. The organising committee of a tennis tournament is to schedule the matches for \\(2 k\\) players so that every two players play once, each day exactly one match is played, and each player arrives to the tournament site the day of his first match, and departs the day of his last match. For every day a player is present on the tournament, the committee has to pay 1 coin to the hotel. The organisers want to design the schedule so as to minimise the total cost of all players' stays. Determine this minimum cost.\n(Russia)\nAnswer: The required minimum is \\(k\\left(4 k^{2}+k-1\\right) / 2\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2018, "solution": "Enumerate the days of the tournament \\(1,2, \\ldots,\\binom{2 k}{2}\\). Let \\(b_{1} \\leqslant b_{2} \\leqslant \\cdots \\leqslant b_{2 k}\\) be the days the players arrive to the tournament, arranged in nondecreasing order; similarly, let \\(e_{1} \\geqslant \\cdots \\geqslant e_{2 k}\\) be the days they depart arranged in nonincreasing order (it may happen that a player arrives on day \\(b_{i}\\) and departs on day \\(e_{j}\\), where \\(i \\neq j\\) ). If a player arrives on day \\(b\\) and departs on day \\(e\\), then his stay cost is \\(e-b+1\\). Therefore, the total stay cost is\n\n\\[\n\\Sigma=\\sum_{i=1}^{2 k} e_{i}-\\sum_{i=1}^{2 k} b_{i}+n=\\sum_{i=1}^{2 k}\\left(e_{i}-b_{i}+1\\right)\n\\]\n\nBounding the total cost from below. To this end, estimate \\(e_{i+1}-b_{i+1}+1\\). Before day \\(b_{i+1}\\), only \\(i\\) players were present, so at most \\(\\binom{i}{2}\\) matches could be played. Therefore, \\(b_{i+1} \\leqslant\\binom{ i}{2}+1\\). Similarly, at most \\(\\binom{i}{2}\\) matches could be played after day \\(e_{i+1}\\), so \\(e_{i} \\geqslant\\binom{ 2 k}{2}-\\binom{i}{2}\\). Thus,\n\n\\[\ne_{i+1}-b_{i+1}+1 \\geqslant\\binom{ 2 k}{2}-2\\binom{i}{2}=k(2 k-1)-i(i-1)\n\\]\n\nThis lower bound can be improved for \\(i>k\\) : List the \\(i\\) players who arrived first, and the \\(i\\) players who departed last; at least \\(2 i-2 k\\) players appear in both lists. The matches between these players were counted twice, though the players in each pair have played only once. Therefore, if \\(i>k\\), then\n\n\\[\ne_{i+1}-b_{i+1}+1 \\geqslant\\binom{ 2 k}{2}-2\\binom{i}{2}+\\binom{2 i-2 k}{2}=(2 k-i)^{2}\n\\]\n\nAn optimal tournament, We now describe a schedule in which the lower bounds above are all achieved simultaneously. Split players into two groups \\(X\\) and \\(Y\\), each of cardinality \\(k\\). Next, partition the schedule into three parts. During the first part, the players from \\(X\\) arrive one by one, and each newly arrived player immediately plays with everyone already present. During the third part (after all players from \\(X\\) have already departed) the players from \\(Y\\) depart one by one, each playing with everyone still present just before departing.\n\nIn the middle part, everyone from \\(X\\) should play with everyone from \\(Y\\). Let \\(S_{1}, S_{2}, \\ldots, S_{k}\\) be the players in \\(X\\), and let \\(T_{1}, T_{2}, \\ldots, T_{k}\\) be the players in \\(Y\\). Let \\(T_{1}, T_{2}, \\ldots, T_{k}\\) arrive in this order; after \\(T_{j}\\) arrives, he immediately plays with all the \\(S_{i}, i>j\\). Afterwards, players \\(S_{k}\\), \\(S_{k-1}, \\ldots, S_{1}\\) depart in this order; each \\(S_{i}\\) plays with all the \\(T_{j}, i \\leqslant j\\), just before his departure, and \\(S_{k}\\) departs the day \\(T_{k}\\) arrives. For \\(0 \\leqslant s \\leqslant k-1\\), the number of matches played between \\(T_{k-s}\\) 's arrival and \\(S_{k-s}\\) 's departure is\n\n\\[\n\\sum_{j=k-s}^{k-1}(k-j)+1+\\sum_{j=k-s}^{k-1}(k-j+1)=\\frac{1}{2} s(s+1)+1+\\frac{1}{2} s(s+3)=(s+1)^{2}\n\\]\n\nThus, if \\(i>k\\), then the number of matches that have been played between \\(T_{i-k+1}\\) 's arrival, which is \\(b_{i+1}\\), and \\(S_{i-k+1}\\) 's departure, which is \\(e_{i+1}\\), is \\((2 k-i)^{2}\\); that is, \\(e_{i+1}-b_{i+1}+1=(2 k-i)^{2}\\), showing the second lower bound achieved for all \\(i>k\\).\n\nIf \\(i \\leqslant k\\), then the matches between the \\(i\\) players present before \\(b_{i+1}\\) all fall in the first part of the schedule, so there are \\(\\binom{i}{2}\\) such, and \\(b_{i+1}=\\binom{i}{2}+1\\). Similarly, after \\(e_{i+1}\\), there are \\(i\\) players left, all \\(\\binom{i}{2}\\) matches now fall in the third part of the schedule, and \\(e_{i+1}=\\binom{2 k}{2}-\\binom{i}{2}\\). The first lower bound is therefore also achieved for all \\(i \\leqslant k\\).\n\nConsequently, all lower bounds are achieved simultaneously, and the schedule is indeed optimal.\nEvaluation. Finally, evaluate the total cost for the optimal schedule:\n\n\\[\n\\begin{aligned}\n\\Sigma & =\\sum_{i=0}^{k}(k(2 k-1)-i(i-1))+\\sum_{i=k+1}^{2 k-1}(2 k-i)^{2}=(k+1) k(2 k-1)-\\sum_{i=0}^{k} i(i-1)+\\sum_{j=1}^{k-1} j^{2} \n& =k(k+1)(2 k-1)-k^{2}+\\frac{1}{2} k(k+1)=\\frac{1}{2} k\\left(4 k^{2}+k-1\\right)\n\n\\]\n\nSolution 2. Consider any tournament schedule. Label players \\(P_{1}, P_{2}, \\ldots, P_{2 k}\\) in order of their arrival, and label them again \\(Q_{2 k}, Q_{2 k-1}, \\ldots, Q_{1}\\) in order of their departure, to define a permutation \\(a_{1}, a_{2}, \\ldots, a_{2 k}\\) of \\(1,2, \\ldots, 2 k\\) by \\(P_{i}=Q_{a_{i}}\\).\n\nWe first describe an optimal tournament for any given permutation \\(a_{1}, a_{2}, \\ldots, a_{2 k}\\) of the indices \\(1,2, \\ldots, 2 k\\). Next, we find an optimal permutation and an optimal tournament.\nOptimisation for a fixed \\(a_{1}, \\ldots, a_{2 k}\\). We say that the cost of the match between \\(P_{i}\\) and \\(P_{j}\\) is the number of players present at the tournament when this match is played. Clearly, the Committee pays for each day the cost of the match of that day. Hence, we are to minimise the total cost of all matches.\n\nNotice that \\(Q_{2 k}\\) 's departure does not precede \\(P_{2 k}\\) 's arrival. Hence, the number of players at the tournament monotonically increases (non-strictly) until it reaches \\(2 k\\), and then monotonically decreases (non-strictly). So, the best time to schedule the match between \\(P_{i}\\) and \\(P_{j}\\) is either when \\(P_{\\max (i, j)}\\) arrives, or when \\(Q_{\\max \\left(a_{i}, a_{j}\\right)}\\) departs, in which case the cost is \\(\\min \\left(\\max (i, j), \\max \\left(a_{i}, a_{j}\\right)\\right)\\).\n\nConversely, assuming that \\(i>j\\), if this match is scheduled between the arrivals of \\(P_{i}\\) and \\(P_{i+1}\\), then its cost will be exactly \\(i=\\max (i, j)\\). Similarly, one can make it cost \\(\\max \\left(a_{i}, a_{j}\\right)\\). Obviously, these conditions can all be simultaneously satisfied, so the minimal cost for a fixed sequence \\(a_{1}, a_{2}, \\ldots, a_{2 k}\\) is\n\n\\[\n\\Sigma\\left(a_{1}, \\ldots, a_{2 k}\\right)=\\sum_{1 \\leqslant i<j \\leqslant 2 k} \\min \\left(\\max (i, j), \\max \\left(a_{i}, a_{j}\\right)\\right)\n\\]\n\nOptimising the sequence ( \\(a_{i}\\) ). Optimisation hinges on the lemma below.\nLemma. If \\(a \\leqslant b\\) and \\(c \\leqslant d\\), then\n\n\\[\n\\begin{aligned}\n\\min (\\max (a, x), \\max (c, y))+\\min & (\\max (b, x), \\max (d, y)) \n\\geqslant & \\min (\\max (a, x), \\max (d, y))+\\min (\\max (b, x), \\max (c, y))\n\n\\]\n\nProof. Write \\(a^{\\prime}=\\max (a, x) \\leqslant \\max (b, x)=b^{\\prime}\\) and \\(c^{\\prime}=\\max (c, y) \\leqslant \\max (d, y)=d^{\\prime}\\) and check that \\(\\min \\left(a^{\\prime}, c^{\\prime}\\right)+\\min \\left(b^{\\prime}, d^{\\prime}\\right) \\geqslant \\min \\left(a^{\\prime}, d^{\\prime}\\right)+\\min \\left(b^{\\prime}, c^{\\prime}\\right)\\).\n\nConsider a permutation \\(a_{1}, a_{2}, \\ldots, a_{2 k}\\) such that \\(a_{i}<a_{j}\\) for some \\(i<j\\). Swapping \\(a_{i}\\) and \\(a_{j}\\) does not change the ( \\(i, j\\) )th summand in (1), and for \\(\\ell \\notin\\{i, j\\}\\) the sum of the ( \\(i, \\ell\\) )th and the ( \\(j, \\ell\\) )th summands does not increase by the Lemma. Hence the optimal value does not increase, but the number of disorders in the permutation increases. This process stops when \\(a_{i}=2 k+1-i\\) for all \\(i\\), so the required minimum is\n\n\\[\n\\begin{aligned}\nS(2 k, 2 k-1, \\ldots, 1) & =\\sum_{1 \\leqslant i<j \\leqslant 2 k} \\min (\\max (i, j), \\max (2 k+1-i, 2 k+1-j)) \n& =\\sum_{1 \\leqslant i<j \\leqslant 2 k} \\min (j, 2 k+1-i)\n\n\\]\n\nThe latter sum is fairly tractable and yields the stated result; we omit the details.\nComment. If the number of players is odd, say, \\(2 k-1\\), the required minimum is \\(k(k-1)(4 k-1) / 2\\). In this case, \\(|X|=k,|Y|=k-1\\), the argument goes along the same lines, but some additional technicalities are to be taken care of.\n\nThis page is intentionally left blank"}
{"id": "imo-shortlist-2018-c6", "question": "C6. Let \\(a\\) and \\(b\\) be distinct positive integers. The following infinite process takes place on an initially empty board.\n(i) If there is at least a pair of equal numbers on the board, we choose such a pair and increase one of its components by \\(a\\) and the other by \\(b\\).\n(ii) If no such pair exists, we write down two times the number 0 .\n\nProve that, no matter how we make the choices in \\((i)\\), operation \\((i i)\\) will be performed only finitely many times.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2018, "solution": "We may assume \\(\\operatorname{gcd}(a, b)=1\\); otherwise we work in the same way with multiples of \\(d=\\operatorname{gcd}(a, b)\\).\n\nSuppose that after \\(N\\) moves of type (ii) and some moves of type (i) we have to add two new zeros. For each integer \\(k\\), denote by \\(f(k)\\) the number of times that the number \\(k\\) appeared on the board up to this moment. Then \\(f(0)=2 N\\) and \\(f(k)=0\\) for \\(k<0\\). Since the board contains at most one \\(k-a\\), every second occurrence of \\(k-a\\) on the board produced, at some moment, an occurrence of \\(k\\); the same stands for \\(k-b\\). Therefore,\n\n\\[\nf(k)=\\left\\lfloor\\frac{f(k-a)}{2}\\right\\rfloor+\\left\\lfloor\\frac{f(k-b)}{2}\\right\\rfloor\n\\]\n\nyielding\n\n\\[\nf(k) \\geqslant \\frac{f(k-a)+f(k-b)}{2}-1\n\\]\n\nSince \\(\\operatorname{gcd}(a, b)=1\\), every integer \\(x>a b-a-b\\) is expressible in the form \\(x=s a+t b\\), with integer \\(s, t \\geqslant 0\\).\n\nWe will prove by induction on \\(s+t\\) that if \\(x=s a+b t\\), with \\(s, t\\) nonnegative integers, then\n\n\\[\nf(x)>\\frac{f(0)}{2^{s+t}}-2\n\\]\n\nThe base case \\(s+t=0\\) is trivial. Assume now that (3) is true for \\(s+t=v\\). Then, if \\(s+t=v+1\\) and \\(x=s a+t b\\), at least one of the numbers \\(s\\) and \\(t\\) - say \\(s\\) - is positive, hence by (2),\n\n\\[\nf(x)=f(s a+t b) \\geqslant \\frac{f((s-1) a+t b)}{2}-1>\\frac{1}{2}\\left(\\frac{f(0)}{2^{s+t-1}}-2\\right)-1=\\frac{f(0)}{2^{s+t}}-2\n\\]\n\nAssume now that we must perform moves of type (ii) ad infinitum. Take \\(n=a b-a-b\\) and suppose \\(b>a\\). Since each of the numbers \\(n+1, n+2, \\ldots, n+b\\) can be expressed in the form \\(s a+t b\\), with \\(0 \\leqslant s \\leqslant b\\) and \\(0 \\leqslant t \\leqslant a\\), after moves of type ( \\(i i\\) ) have been performed \\(2^{a+b+1}\\) times and we have to add a new pair of zeros, each \\(f(n+k), k=1,2, \\ldots, b\\), is at least 2 . In this case (1) yields inductively \\(f(n+k) \\geqslant 2\\) for all \\(k \\geqslant 1\\). But this is absurd: after a finite number of moves, \\(f\\) cannot attain nonzero values at infinitely many points.\n\nSolution 2. We start by showing that the result of the process in the problem does not depend on the way the operations are performed. For that purpose, it is convenient to modify the process a bit.\nClaim 1. Suppose that the board initially contains a finite number of nonnegative integers, and one starts performing type ( \\(i\\) ) moves only. Assume that one had applied \\(k\\) moves which led to a final arrangement where no more type ( \\(i\\) ) moves are possible. Then, if one starts from the same initial arrangement, performing type (i) moves in an arbitrary fashion, then the process will necessarily stop at the same final arrangement\n\nProof. Throughout this proof, all moves are supposed to be of type ( \\(i\\) ).\nInduct on \\(k\\); the base case \\(k=0\\) is trivial, since no moves are possible. Assume now that \\(k \\geqslant 1\\). Fix some canonical process, consisting of \\(k\\) moves \\(M_{1}, M_{2}, \\ldots, M_{k}\\), and reaching the final arrangement \\(A\\). Consider any sample process \\(m_{1}, m_{2}, \\ldots\\) starting with the same initial arrangement and proceeding as long as possible; clearly, it contains at least one move. We need to show that this process stops at \\(A\\).\n\nLet move \\(m_{1}\\) consist in replacing two copies of \\(x\\) with \\(x+a\\) and \\(x+b\\). If move \\(M_{1}\\) does the same, we may apply the induction hypothesis to the arrangement appearing after \\(m_{1}\\). Otherwise, the canonical process should still contain at least one move consisting in replacing \\((x, x) \\mapsto(x+a, x+b)\\), because the initial arrangement contains at least two copies of \\(x\\), while the final one contains at most one such.\n\nLet \\(M_{i}\\) be the first such move. Since the copies of \\(x\\) are indistinguishable and no other copy of \\(x\\) disappeared before \\(M_{i}\\) in the canonical process, the moves in this process can be permuted as \\(M_{i}, M_{1}, \\ldots, M_{i-1}, M_{i+1}, \\ldots, M_{k}\\), without affecting the final arrangement. Now it suffices to perform the move \\(m_{1}=M_{i}\\) and apply the induction hypothesis as above.\nClaim 2. Consider any process starting from the empty board, which involved exactly \\(n\\) moves of type (ii) and led to a final arrangement where all the numbers are distinct. Assume that one starts with the board containing \\(2 n\\) zeroes (as if \\(n\\) moves of type ( \\(i i\\) ) were made in the beginning), applying type ( \\(i\\) ) moves in an arbitrary way. Then this process will reach the same final arrangement.\nProof. Starting with the board with \\(2 n\\) zeros, one may indeed model the first process mentioned in the statement of the claim, omitting the type ( \\(i i\\) ) moves. This way, one reaches the same final arrangement. Now, Claim 1 yields that this final arrangement will be obtained when type ( \\(i\\) ) moves are applied arbitrarily.\n\nClaim 2 allows now to reformulate the problem statement as follows: There exists an integer \\(n\\) such that, starting from \\(2 n\\) zeroes, one may apply type (i) moves indefinitely.\n\nIn order to prove this, we start with an obvious induction on \\(s+t=k \\geqslant 1\\) to show that if we start with \\(2^{s+t}\\) zeros, then we can get simultaneously on the board, at some point, each of the numbers \\(s a+t b\\), with \\(s+t=k\\).\n\nSuppose now that \\(a<b\\). Then, an appropriate use of separate groups of zeros allows us to get two copies of each of the numbers \\(s a+t b\\), with \\(1 \\leqslant s, t \\leqslant b\\).\n\nDefine \\(N=a b-a-b\\), and notice that after representing each of numbers \\(N+k, 1 \\leqslant k \\leqslant b\\), in the form \\(s a+t b, 1 \\leqslant s, t \\leqslant b\\) we can get, using enough zeros, the numbers \\(N+1, N+2, \\ldots, N+a\\) and the numbers \\(N+1, N+2, \\ldots, N+b\\).\n\nFrom now on we can perform only moves of type ( \\(i\\) ). Indeed, if \\(n \\geqslant N\\), the occurrence of the numbers \\(n+1, n+2, \\ldots, n+a\\) and \\(n+1, n+2, \\ldots, n+b\\) and the replacement \\((n+1, n+1) \\mapsto\\) \\((n+b+1, n+a+1)\\) leads to the occurrence of the numbers \\(n+2, n+3, \\ldots, n+a+1\\) and \\(n+2, n+3, \\ldots, n+b+1\\).\n\nComment. The proofs of Claims 1 and 2 may be extended in order to show that in fact the number of moves in the canonical process is the same as in an arbitrary sample one."}
{"id": "imo-shortlist-2018-c7", "question": "C7. Consider 2018 pairwise crossing circles no three of which are concurrent. These circles subdivide the plane into regions bounded by circular edges that meet at vertices. Notice that there are an even number of vertices on each circle. Given the circle, alternately colour the vertices on that circle red and blue. In doing so for each circle, every vertex is coloured twice once for each of the two circles that cross at that point. If the two colourings agree at a vertex, then it is assigned that colour; otherwise, it becomes yellow. Show that, if some circle contains at least 2061 yellow points, then the vertices of some region are all yellow.\n(India)", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2018, "solution": "Letting \\(n=2018\\), we will show that, if every region has at least one non-yellow vertex, then every circle contains at most \\(n+\\lfloor\\sqrt{n-2}\\rfloor-2\\) yellow points. In the case at hand, the latter equals \\(2018+44-2=2060\\), contradicting the hypothesis.\n\nConsider the natural geometric graph \\(G\\) associated with the configuration of \\(n\\) circles. Fix any circle \\(C\\) in the configuration, let \\(k\\) be the number of yellow points on \\(C\\), and find a suitable lower bound for the total number of yellow vertices of \\(G\\) in terms of \\(k\\) and \\(n\\). It turns out that \\(k\\) is even, and \\(G\\) has at least\n\n\\[\nk+2\\binom{k / 2}{2}+2\\binom{n-k / 2-1}{2}=\\frac{k^{2}}{2}-(n-2) k+(n-2)(n-1)\n\\]\n\nyellow vertices. The proof hinges on the two lemmata below.\nLemma 1. Let two circles in the configuration cross at \\(x\\) and \\(y\\). Then \\(x\\) and \\(y\\) are either both yellow or both non-yellow.\nProof. This is because the numbers of interior vertices on the four arcs \\(x\\) and \\(y\\) determine on the two circles have like parities.\n\nIn particular, each circle in the configuration contains an even number of yellow vertices.\nLemma 2. If \\(\\widehat{x y}, \\widehat{y z}\\), and \\(\\widehat{z x}\\) are circular arcs of three pairwise distinct circles in the configuration, then the number of yellow vertices in the set \\(\\{x, y, z\\}\\) is odd.\nProof. Let \\(C_{1}, C_{2}, C_{3}\\) be the three circles under consideration. Assume, without loss of generality, that \\(C_{2}\\) and \\(C_{3}\\) cross at \\(x, C_{3}\\) and \\(C_{1}\\) cross at \\(y\\), and \\(C_{1}\\) and \\(C_{2}\\) cross at \\(z\\). Let \\(k_{1}\\), \\(k_{2}, k_{3}\\) be the numbers of interior vertices on the three circular arcs under consideration. Since each circle in the configuration, different from the \\(C_{i}\\), crosses the cycle \\(\\widetilde{x y} \\cup \\widehat{y z} \\cup \\widehat{z x}\\) at an even number of points (recall that no three circles are concurrent), and self-crossings are counted twice, the sum \\(k_{1}+k_{2}+k_{3}\\) is even.\n\nLet \\(Z_{1}\\) be the colour \\(z\\) gets from \\(C_{1}\\) and define the other colours similarly. By the preceding, the number of bichromatic pairs in the list \\(\\left(Z_{1}, Y_{1}\\right),\\left(X_{2}, Z_{2}\\right),\\left(Y_{3}, X_{3}\\right)\\) is odd. Since the total number of colour changes in a cycle \\(Z_{1}-Y_{1}-Y_{3}-X_{3}-X_{2}-Z_{2}-Z_{1}\\) is even, the number of bichromatic pairs in the list \\(\\left(X_{2}, X_{3}\\right),\\left(Y_{1}, Y_{3}\\right),\\left(Z_{1}, Z_{2}\\right)\\) is odd, and the lemma follows.\n\nWe are now in a position to prove that (\\textit{) bounds the total number of yellow vertices from below. Refer to Lemma 1 to infer that the \\(k\\) yellow vertices on \\(C\\) pair off to form the pairs of points where \\(C\\) is crossed by \\(k / 2\\) circles in the configuration. By Lemma 2, these circles cross pairwise to account for another \\(2\\binom{k / 2}{2}\\) yellow vertices. Finally, the remaining \\(n-k / 2-1\\) circles in the configuration cross \\(C\\) at non-yellow vertices, by Lemma 1, and Lemma 2 applies again to show that these circles cross pairwise to account for yet another \\(2\\binom{n-k / 2-1}{2}\\) yellow vertices. Consequently, there are at least (}) yellow vertices.\n\nNext, notice that \\(G\\) is a plane graph on \\(n(n-1)\\) degree 4 vertices, having exactly \\(2 n(n-1)\\) edges and exactly \\(n(n-1)+2\\) faces (regions), the outer face inclusive (by Euler's formula for planar graphs).\nLemma 3. Each face of \\(G\\) has equally many red and blue vertices. In particular, each face has an even number of non-yellow vertices.\n\nProof. Trace the boundary of a face once in circular order, and consider the colours each vertex is assigned in the colouring of the two circles that cross at that vertex, to infer that colours of non-yellow vertices alternate.\n\nConsequently, if each region has at least one non-yellow vertex, then it has at least two such. Since each vertex of \\(G\\) has degree 4, consideration of vertex-face incidences shows that \\(G\\) has at least \\(n(n-1) / 2+1\\) non-yellow vertices, and hence at most \\(n(n-1) / 2-1\\) yellow vertices. (In fact, Lemma 3 shows that there are at least \\(n(n-1) / 4+1 / 2\\) red, respectively blue, vertices.)\n\nFinally, recall the lower bound (*) for the total number of yellow vertices in \\(G\\), to write \\(n(n-1) / 2-1 \\geqslant k^{2} / 2-(n-2) k+(n-2)(n-1)\\), and conclude that \\(k \\leqslant n+\\lfloor\\sqrt{n-2}\\rfloor-2\\), as claimed in the first paragraph.\n\nSolution 2. The first two lemmata in Solution 1 show that the circles in the configuration split into two classes: Consider any circle \\(C\\) along with all circles that cross \\(C\\) at yellow points to form one class; the remaining circles then form the other class. Lemma 2 shows that any pair of circles in the same class cross at yellow points; otherwise, they cross at non-yellow points.\n\nCall the circles from the two classes white and black, respectively. Call a region yellow if its vertices are all yellow. Let \\(w\\) and \\(b\\) be the numbers of white and black circles, respectively; clearly, \\(w+b=n\\). Assume that \\(w \\geqslant b\\), and that there is no yellow region. Clearly, \\(b \\geqslant 1\\), otherwise each region is yellow. The white circles subdivide the plane into \\(w(w-1)+2\\) larger regions - call them white. The white regions (or rather their boundaries) subdivide each black circle into black arcs. Since there are no yellow regions, each white region contains at least one black arc.\n\nConsider any white region; let it contain \\(t \\geqslant 1\\) black arcs. We claim that the number of points at which these \\(t\\) arcs cross does not exceed \\(t-1\\). To prove this, consider a multigraph whose vertices are these black arcs, two vertices being joined by an edge for each point at which the corresponding arcs cross. If this graph had more than \\(t-1\\) edges, it would contain a cycle, since it has \\(t\\) vertices; this cycle would correspond to a closed contour formed by black sub-arcs, lying inside the region under consideration. This contour would, in turn, define at least one yellow region, which is impossible.\n\nLet \\(t_{i}\\) be the number of black arcs inside the \\(i^{\\text {th }}\\) white region. The total number of black arcs is \\(\\sum_{i} t_{i}=2 w b\\), and they cross at \\(2\\binom{b}{2}=b(b-1)\\) points. By the preceding,\n\n\\[\nb(b-1) \\leqslant \\sum_{i=1}^{w^{2}-w+2}\\left(t_{i}-1\\right)=\\sum_{i=1}^{w^{2}-w+2} t_{i}-\\left(w^{2}-w+2\\right)=2 w b-\\left(w^{2}-w+2\\right)\n\\]\n\nor, equivalently, \\((w-b)^{2} \\leqslant w+b-2=n-2\\), which is the case if and only if \\(w-b \\leqslant\\lfloor\\sqrt{n-2}\\rfloor\\). Consequently, \\(b \\leqslant w \\leqslant(n+\\lfloor\\sqrt{n-2}\\rfloor) / 2\\), so there are at most \\(2(w-1) \\leqslant n+\\lfloor\\sqrt{n-2}\\rfloor-2\\) yellow vertices on each circle - a contradiction."}
{"id": "imo-shortlist-2018-g1", "question": "G1. Let \\(A B C\\) be an acute-angled triangle with circumcircle \\(\\Gamma\\). Let \\(D\\) and \\(E\\) be points on the segments \\(A B\\) and \\(A C\\), respectively, such that \\(A D=A E\\). The perpendicular bisectors of the segments \\(B D\\) and \\(C E\\) intersect the small arcs \\(\\wideparen{A B}\\) and \\(\\wideparen{A C}\\) at points \\(F\\) and \\(G\\) respectively. Prove that \\(D E \\| F G\\).\n(Greece)", "category": "Geometry", "source": "IMO Shortlist", "year": 2018, "solution": "In the sequel, all the considered arcs are small arcs.\nLet \\(P\\) be the midpoint of the arc \\(\\overline{B C}\\). Then \\(A P\\) is the bisector of \\(\\angle B A C\\), hence, in the isosceles triangle \\(A D E, A P \\perp D E\\). So, the statement of the problem is equivalent to \\(A P \\perp F G\\).\n\nIn order to prove this, let \\(K\\) be the second intersection of \\(\\Gamma\\) with \\(F D\\). Then the triangle FBD is isosceles, therefore\n\n\\[\n\\angle A K F=\\angle A B F=\\angle F D B=\\angle A D K,\n\\]\n\nyielding \\(A K=A D\\). In the same way, denoting by \\(L\\) the second intersection of \\(\\Gamma\\) with \\(G E\\), we get \\(A L=A E\\). This shows that \\(A K=A L\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b62628dbd164bd27ffa8g-38}\n\nNow \\(\\angle F B D=\\angle F D B\\) gives \\(\\overrightarrow{A F}=\\overrightarrow{B F}+\\overrightarrow{A K}=\\overrightarrow{B F}+\\overrightarrow{A L}\\), hence \\(\\overrightarrow{B F}=\\overrightarrow{L F}\\). In a similar way, we get \\(\\overrightarrow{C G}=\\overrightarrow{G K}\\). This yields\n\n\\[\n\\angle(A P, F G)=\\frac{\\widehat{A F}+\\widehat{P G}}{2}=\\frac{\\widehat{A L}+\\widehat{L F}+\\widehat{P C}+\\widehat{C G}}{2}=\\frac{\\widehat{K L}+\\widehat{L B}+\\widehat{B C}+\\widehat{C K}}{4}=90^{\\circ} .\n\\]\n\nSolution 2. Let \\(Z=A B \\cap F G, T=A C \\cap F G\\). It suffices to prove that \\(\\angle A T Z=\\angle A Z T\\).\nLet \\(X\\) be the point for which \\(F X A D\\) is a parallelogram. Then\n\n\\[\n\\angle F X A=\\angle F D A=180^{\\circ}-\\angle F D B=180^{\\circ}-\\angle F B D,\n\\]\n\nwhere in the last equality we used that \\(F D=F B\\). It follows that the quadrilateral \\(B F X A\\) is cyclic, so \\(X\\) lies on \\(\\Gamma\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b62628dbd164bd27ffa8g-38(1)}\n\nAnalogously, if \\(Y\\) is the point for which \\(G Y A E\\) is a parallelogram, then \\(Y\\) lies on \\(\\Gamma\\). So the quadrilateral \\(X F G Y\\) is cyclic and \\(F X=A D=A E=G Y\\), hence \\(X F G Y\\) is an isosceles trapezoid.\n\nNow, by \\(X F \\| A Z\\) and \\(Y G \\| A T\\), it follows that \\(\\angle A T Z=\\angle Y G F=\\angle X F G=\\angle A Z T\\).\nSolution 3. As in the first solution, we prove that \\(F G \\perp A P\\), where \\(P\\) is the midpoint of the small arc \\(\\widehat{B C}\\).\n\nLet \\(O\\) be the circumcentre of the triangle \\(A B C\\), and let \\(M\\) and \\(N\\) be the midpoints of the small arcs \\(\\wideparen{A B}\\) and \\(\\wideparen{A C}\\), respectively. Then \\(O M\\) and \\(O N\\) are the perpendicular bisectors of \\(A B\\) and \\(A C\\), respectively.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b62628dbd164bd27ffa8g-39}\n\nThe distance \\(d\\) between \\(O M\\) and the perpendicular bisector of \\(B D\\) is \\(\\frac{1}{2} A B-\\frac{1}{2} B D=\\frac{1}{2} A D\\), hence it is equal to the distance between \\(O N\\) and the perpendicular bisector of \\(C E\\).\n\nThis shows that the isosceles trapezoid determined by the diameter \\(\\delta\\) of \\(\\Gamma\\) through \\(M\\) and the chord parallel to \\(\\delta\\) through \\(F\\) is congruent to the isosceles trapezoid determined by the diameter \\(\\delta^{\\prime}\\) of \\(\\Gamma\\) through \\(N\\) and the chord parallel to \\(\\delta^{\\prime}\\) through \\(G\\). Therefore \\(M F=N G\\), yielding \\(M N \\| F G\\).\n\nNow\n\n\\[\n\\angle(M N, A P)=\\frac{1}{2}(\\widehat{A M}+\\widehat{P C}+\\widehat{C N})=\\frac{1}{4}(\\widehat{A B}+\\widehat{B C}+\\widehat{C A})=90^{\\circ},\n\\]\n\nhence \\(M N \\perp A P\\), and the conclusion follows."}
{"id": "imo-shortlist-2018-g2", "question": "G2. Let \\(A B C\\) be a triangle with \\(A B=A C\\), and let \\(M\\) be the midpoint of \\(B C\\). Let \\(P\\) be a point such that \\(P B<P C\\) and \\(P A\\) is parallel to \\(B C\\). Let \\(X\\) and \\(Y\\) be points on the lines \\(P B\\) and \\(P C\\), respectively, so that \\(B\\) lies on the segment \\(P X, C\\) lies on the segment \\(P Y\\), and \\(\\angle P X M=\\angle P Y M\\). Prove that the quadrilateral \\(A P X Y\\) is cyclic.\n(Australia)", "category": "Geometry", "source": "IMO Shortlist", "year": 2018, "solution": "Since \\(A B=A C, A M\\) is the perpendicular bisector of \\(B C\\), hence \\(\\angle P A M=\\) \\(\\angle A M C=90^{\\circ}\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b62628dbd164bd27ffa8g-40}\n\nNow let \\(Z\\) be the common point of \\(A M\\) and the perpendicular through \\(Y\\) to \\(P C\\) (notice that \\(Z\\) lies on to the ray \\(A M\\) beyond \\(M\\) ). We have \\(\\angle P A Z=\\angle P Y Z=90^{\\circ}\\). Thus the points \\(P, A, Y\\), and \\(Z\\) are concyclic.\n\nSince \\(\\angle C M Z=\\angle C Y Z=90^{\\circ}\\), the quadrilateral \\(C Y Z M\\) is cyclic, hence \\(\\angle C Z M=\\) \\(\\angle C Y M\\). By the condition in the statement, \\(\\angle C Y M=\\angle B X M\\), and, by symmetry in \\(Z M\\), \\(\\angle C Z M=\\angle B Z M\\). Therefore, \\(\\angle B X M=\\angle B Z M\\). It follows that the points \\(B, X, Z\\), and \\(M\\) are concyclic, hence \\(\\angle B X Z=180^{\\circ}-\\angle B M Z=90^{\\circ}\\).\n\nFinally, we have \\(\\angle P X Z=\\angle P Y Z=\\angle P A Z=90^{\\circ}\\), hence the five points \\(P, A, X, Y, Z\\) are concyclic. In particular, the quadrilateral \\(A P X Y\\) is cyclic, as required.\n\nComment 1. Clearly, the key point \\(Z\\) from the solution above can be introduced in several different ways, e.g., as the second meeting point of the circle \\(C M Y\\) and the line \\(A M\\), or as the second meeting point of the circles \\(C M Y\\) and \\(B M X\\), etc.\n\nFor some of definitions of \\(Z\\) its location is not obvious. For instance, if \\(Z\\) is defined as a common point of \\(A M\\) and the perpendicular through \\(X\\) to \\(P X\\), it is not clear that \\(Z\\) lies on the ray \\(A M\\) beyond \\(M\\). To avoid such slippery details some more restrictions on the construction may be required.\n\nComment 2. Let us discuss a connection to the Miquel point of a cyclic quadrilateral. Set \\(X^{\\prime}=\\) \\(M X \\cap P C, Y^{\\prime}=M Y \\cap P B\\), and \\(Q=X Y \\cap X^{\\prime} Y^{\\prime}\\) (see the figure below).\n\nWe claim that \\(B C \\| P Q\\). (One way of proving this is the following. Notice that the quadruple of lines \\(P X, P M, P Y, P Q\\) is harmonic, hence the quadruple \\(B, M, C, P Q \\cap B C\\) of their intersection points with \\(B C\\) is harmonic. Since \\(M\\) is the midpoint of \\(B C, P Q \\cap B C\\) is an ideal point, i.e., \\(P Q \\| B C\\).)\n\nIt follows from the given equality \\(\\angle P X M=\\angle P Y M\\) that the quadrilateral \\(X Y X^{\\prime} Y^{\\prime}\\) is cyclic. Note that \\(A\\) is the projection of \\(M\\) onto \\(P Q\\). By a known description, \\(A\\) is the Miquel point for the sidelines \\(X Y, X Y^{\\prime}, X^{\\prime} Y, X^{\\prime} Y^{\\prime}\\). In particular, the circle \\(P X Y\\) passes through \\(A\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b62628dbd164bd27ffa8g-41}\n\nComment 3. An alternative approach is the following. One can note that the (oriented) lengths of the segments \\(C Y\\) and \\(B X\\) are both linear functions of a parameter \\(t=\\cot \\angle P X M\\). As \\(t\\) varies, the intersection point \\(S\\) of the perpendicular bisectors of \\(P X\\) and \\(P Y\\) traces a fixed line, thus the family of circles \\(P X Y\\) has a fixed common point (other than \\(P\\) ). By checking particular cases, one can show that this fixed point is \\(A\\).\n\nComment 4. The problem states that \\(\\angle P X M=\\angle P Y M\\) implies that \\(A P X Y\\) is cyclic. The original submission claims that these two conditions are in fact equivalent. The Problem Selection Committee omitted the converse part, since it follows easily from the direct one, by reversing arguments."}
{"id": "imo-shortlist-2018-g3", "question": "G3. A circle \\(\\omega\\) of radius 1 is given. A collection \\(T\\) of triangles is called good, if the following conditions hold:\n(i) each triangle from \\(T\\) is inscribed in \\(\\omega\\);\n(ii) no two triangles from \\(T\\) have a common interior point.\n\nDetermine all positive real numbers \\(t\\) such that, for each positive integer \\(n\\), there exists a good collection of \\(n\\) triangles, each of perimeter greater than \\(t\\).\n(South Africa)\nAnswer: \\(t \\in(0,4]\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2018, "solution": "First, we show how to construct a good collection of \\(n\\) triangles, each of perimeter greater than 4 . This will show that all \\(t \\leqslant 4\\) satisfy the required conditions.\n\nConstruct inductively an \\((n+2)\\)-gon \\(B A_{1} A_{2} \\ldots A_{n} C\\) inscribed in \\(\\omega\\) such that \\(B C\\) is a diameter, and \\(B A_{1} A_{2}, B A_{2} A_{3}, \\ldots, B A_{n-1} A_{n}, B A_{n} C\\) is a good collection of \\(n\\) triangles. For \\(n=1\\), take any triangle \\(B A_{1} C\\) inscribed in \\(\\omega\\) such that \\(B C\\) is a diameter; its perimeter is greater than \\(2 B C=4\\). To perform the inductive step, assume that the \\((n+2)\\)-gon \\(B A_{1} A_{2} \\ldots A_{n} C\\) is already constructed. Since \\(A_{n} B+A_{n} C+B C>4\\), one can choose a point \\(A_{n+1}\\) on the small arc \\(\\widetilde{C A_{n}}\\), close enough to \\(C\\), so that \\(A_{n} B+A_{n} A_{n+1}+B A_{n+1}\\) is still greater than 4 . Thus each of these new triangles \\(B A_{n} A_{n+1}\\) and \\(B A_{n+1} C\\) has perimeter greater than 4 , which completes the induction step.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b62628dbd164bd27ffa8g-42}\n\nWe proceed by showing that no \\(t>4\\) satisfies the conditions of the problem. To this end, we assume that there exists a good collection \\(T\\) of \\(n\\) triangles, each of perimeter greater than \\(t\\), and then bound \\(n\\) from above.\n\nTake \\(\\varepsilon>0\\) such that \\(t=4+2 \\varepsilon\\).\nClaim. There exists a positive constant \\(\\sigma=\\sigma(\\varepsilon)\\) such that any triangle \\(\\Delta\\) with perimeter \\(2 s \\geqslant 4+2 \\varepsilon\\), inscribed in \\(\\omega\\), has area \\(S(\\Delta)\\) at least \\(\\sigma\\).\nProof. Let \\(a, b, c\\) be the side lengths of \\(\\Delta\\). Since \\(\\Delta\\) is inscribed in \\(\\omega\\), each side has length at most 2. Therefore, \\(s-a \\geqslant(2+\\varepsilon)-2=\\varepsilon\\). Similarly, \\(s-b \\geqslant \\varepsilon\\) and \\(s-c \\geqslant \\varepsilon\\). By Heron's formula, \\(S(\\Delta)=\\sqrt{s(s-a)(s-b)(s-c)} \\geqslant \\sqrt{(2+\\varepsilon) \\varepsilon^{3}}\\). Thus we can set \\(\\sigma(\\varepsilon)=\\sqrt{(2+\\varepsilon) \\varepsilon^{3}}\\).\n\nNow we see that the total area \\(S\\) of all triangles from \\(T\\) is at least \\(n \\sigma(\\varepsilon)\\). On the other hand, \\(S\\) does not exceed the area of the disk bounded by \\(\\omega\\). Thus \\(n \\sigma(\\varepsilon) \\leqslant \\pi\\), which means that \\(n\\) is bounded from above.\n\nComment 1. One may prove the Claim using the formula \\(S=\\frac{a b c}{4 R}\\) instead of Heron's formula.\nComment 2. In the statement of the problem condition \\((i)\\) could be replaced by a weaker one: each triangle from \\(T\\) lies within \\(\\omega\\). This does not affect the solution above, but reduces the number of ways to prove the Claim.\n\nThis page is intentionally left blank"}
{"id": "imo-shortlist-2018-g4", "question": "G4. A point \\(T\\) is chosen inside a triangle \\(A B C\\). Let \\(A_{1}, B_{1}\\), and \\(C_{1}\\) be the reflections of \\(T\\) in \\(B C, C A\\), and \\(A B\\), respectively. Let \\(\\Omega\\) be the circumcircle of the triangle \\(A_{1} B_{1} C_{1}\\). The lines \\(A_{1} T, B_{1} T\\), and \\(C_{1} T\\) meet \\(\\Omega\\) again at \\(A_{2}, B_{2}\\), and \\(C_{2}\\), respectively. Prove that the lines \\(A A_{2}, B B_{2}\\), and \\(C C_{2}\\) are concurrent on \\(\\Omega\\).\n(Mongolia)", "category": "Geometry", "source": "IMO Shortlist", "year": 2018, "solution": "By \\(\\Varangle(\\ell, n)\\) we always mean the directed angle of the lines \\(\\ell\\) and \\(n\\), taken modulo \\(180^{\\circ}\\).\nLet \\(C C_{2}\\) meet \\(\\Omega\\) again at \\(K\\) (as usual, if \\(C C_{2}\\) is tangent to \\(\\Omega\\), we set \\(T=C_{2}\\) ). We show that the line \\(B B_{2}\\) contains \\(K\\); similarly, \\(A A_{2}\\) will also pass through \\(K\\). For this purpose, it suffices to prove that\n\n\\[\n\\Varangle\\left(C_{2} C, C_{2} A_{1}\\right)=\\Varangle\\left(B_{2} B, B_{2} A_{1}\\right) .\n\\]\n\nBy the problem condition, \\(C B\\) and \\(C A\\) are the perpendicular bisectors of \\(T A_{1}\\) and \\(T B_{1}\\), respectively. Hence, \\(C\\) is the circumcentre of the triangle \\(A_{1} T B_{1}\\). Therefore,\n\n\\[\n\\Varangle\\left(C A_{1}, C B\\right)=\\Varangle(C B, C T)=\\Varangle\\left(B_{1} A_{1}, B_{1} T\\right)=\\Varangle\\left(B_{1} A_{1}, B_{1} B_{2}\\right)\n\\]\n\nIn circle \\(\\Omega\\) we have \\(\\Varangle\\left(B_{1} A_{1}, B_{1} B_{2}\\right)=\\Varangle\\left(C_{2} A_{1}, C_{2} B_{2}\\right)\\). Thus,\n\n\\[\n\\Varangle\\left(C A_{1}, C B\\right)=\\Varangle\\left(B_{1} A_{1}, B_{1} B_{2}\\right)=\\Varangle\\left(C_{2} A_{1}, C_{2} B_{2}\\right) .\n\\]\n\nSimilarly, we get\n\n\\[\n\\Varangle\\left(B A_{1}, B C\\right)=\\Varangle\\left(C_{1} A_{1}, C_{1} C_{2}\\right)=\\Varangle\\left(B_{2} A_{1}, B_{2} C_{2}\\right) .\n\\]\n\nThe two obtained relations yield that the triangles \\(A_{1} B C\\) and \\(A_{1} B_{2} C_{2}\\) are similar and equioriented, hence\n\n\\[\n\\frac{A_{1} B_{2}}{A_{1} B}=\\frac{A_{1} C_{2}}{A_{1} C} \\quad \\text { and } \\quad \\Varangle\\left(A_{1} B, A_{1} C\\right)=\\Varangle\\left(A_{1} B_{2}, A_{1} C_{2}\\right) \\text {. }\n\\]\n\nThe second equality may be rewritten as \\(\\Varangle\\left(A_{1} B, A_{1} B_{2}\\right)=\\Varangle\\left(A_{1} C, A_{1} C_{2}\\right)\\), so the triangles \\(A_{1} B B_{2}\\) and \\(A_{1} C C_{2}\\) are also similar and equioriented. This establishes (1).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b62628dbd164bd27ffa8g-44}\n\nComment 1. In fact, the triangle \\(A_{1} B C\\) is an image of \\(A_{1} B_{2} C_{2}\\) under a spiral similarity centred at \\(A_{1}\\); in this case, the triangles \\(A B B_{2}\\) and \\(A C C_{2}\\) are also spirally similar with the same centre.\n\nComment 2. After obtaining (2) and (3), one can finish the solution in different ways.\nFor instance, introducing the point \\(X=B C \\cap B_{2} C_{2}\\), one gets from these relations that the 4 -tuples ( \\(A_{1}, B, B_{2}, X\\) ) and ( \\(A_{1}, C, C_{2}, X\\) ) are both cyclic. Therefore, \\(K\\) is the Miquel point of the lines \\(B B_{2}\\), \\(C C_{2}, B C\\), and \\(B_{2} C_{2}\\); this yields that the meeting point of \\(B B_{2}\\) and \\(C C_{2}\\) lies on \\(\\Omega\\).\n\nYet another way is to show that the points \\(A_{1}, B, C\\), and \\(K\\) are concyclic, as\n\n\\[\n\\Varangle\\left(K C, K A_{1}\\right)=\\Varangle\\left(B_{2} C_{2}, B_{2} A_{1}\\right)=\\Varangle\\left(B C, B A_{1}\\right) .\n\\]\n\nBy symmetry, the second point \\(K^{\\prime}\\) of intersection of \\(B B_{2}\\) with \\(\\Omega\\) is also concyclic to \\(A_{1}, B\\), and \\(C\\), hence \\(K^{\\prime}=K\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b62628dbd164bd27ffa8g-45}\n\nComment 3. The requirement that the common point of the lines \\(A A_{2}, B B_{2}\\), and \\(C C_{2}\\) should lie on \\(\\Omega\\) may seem to make the problem easier, since it suggests some approaches. On the other hand, there are also different ways of showing that the lines \\(A A_{2}, B B_{2}\\), and \\(C C_{2}\\) are just concurrent.\n\nIn particular, the problem conditions yield that the lines \\(A_{2} T, B_{2} T\\), and \\(C_{2} T\\) are perpendicular to the corresponding sides of the triangle \\(A B C\\). One may show that the lines \\(A T, B T\\), and \\(C T\\) are also perpendicular to the corresponding sides of the triangle \\(A_{2} B_{2} C_{2}\\), i.e., the triangles \\(A B C\\) and \\(A_{2} B_{2} C_{2}\\) are orthologic, and their orthology centres coincide. It is known that such triangles are also perspective, i.e. the lines \\(A A_{2}, B B_{2}\\), and \\(C C_{2}\\) are concurrent (in projective sense).\n\nTo show this mutual orthology, one may again apply angle chasing, but there are also other methods. Let \\(A^{\\prime}, B^{\\prime}\\), and \\(C^{\\prime}\\) be the projections of \\(T\\) onto the sides of the triangle \\(A B C\\). Then \\(A_{2} T \\cdot T A^{\\prime}=\\) \\(B_{2} T \\cdot T B^{\\prime}=C_{2} T \\cdot T C^{\\prime}\\), since all three products equal (minus) half the power of \\(T\\) with respect to \\(\\Omega\\). This means that \\(A_{2}, B_{2}\\), and \\(C_{2}\\) are the poles of the sidelines of the triangle \\(A B C\\) with respect to some circle centred at \\(T\\) and having pure imaginary radius (in other words, the reflections of \\(A_{2}, B_{2}\\), and \\(C_{2}\\) in \\(T\\) are the poles of those sidelines with respect to some regular circle centred at \\(T\\) ). Hence, dually, the vertices of the triangle \\(A B C\\) are also the poles of the sidelines of the triangle \\(A_{2} B_{2} C_{2}\\)."}
{"id": "imo-shortlist-2018-g5", "question": "G5. Let \\(A B C\\) be a triangle with circumcircle \\(\\omega\\) and incentre \\(I\\). A line \\(\\ell\\) intersects the lines \\(A I, B I\\), and \\(C I\\) at points \\(D, E\\), and \\(F\\), respectively, distinct from the points \\(A, B, C\\), and \\(I\\). The perpendicular bisectors \\(x, y\\), and \\(z\\) of the segments \\(A D, B E\\), and \\(C F\\), respectively determine a triangle \\(\\Theta\\). Show that the circumcircle of the triangle \\(\\Theta\\) is tangent to \\(\\omega\\).\n(Denmark)\n\nPreamble. Let \\(X=y \\cap z, Y=x \\cap z, Z=x \\cap y\\) and let \\(\\Omega\\) denote the circumcircle of the triangle \\(X Y Z\\). Denote by \\(X_{0}, Y_{0}\\), and \\(Z_{0}\\) the second intersection points of \\(A I, B I\\) and \\(C I\\), respectively, with \\(\\omega\\). It is known that \\(Y_{0} Z_{0}\\) is the perpendicular bisector of \\(A I, Z_{0} X_{0}\\) is the perpendicular bisector of \\(B I\\), and \\(X_{0} Y_{0}\\) is the perpendicular bisector of \\(C I\\). In particular, the triangles \\(X Y Z\\) and \\(X_{0} Y_{0} Z_{0}\\) are homothetic, because their corresponding sides are parallel.\n\nThe", "category": "Geometry", "source": "IMO Shortlist", "year": 2018, "solution": "s below mostly exploit the following approach. Consider the triangles XY Z and \\(X_{0} Y_{0} Z_{0}\\), or some other pair of homothetic triangles \\(\\Delta\\) and \\(\\delta\\) inscribed into \\(\\Omega\\) and \\(\\omega\\), respectively. In order to prove that \\(\\Omega\\) and \\(\\omega\\) are tangent, it suffices to show that the centre \\(T\\) of the homothety taking \\(\\Delta\\) to \\(\\delta\\) lies on \\(\\omega\\) (or \\(\\Omega\\) ), or, in other words, to show that \\(\\Delta\\) and \\(\\delta\\) are perspective (i.e., the lines joining corresponding vertices are concurrent), with their perspector lying on \\(\\omega\\) (or \\(\\Omega\\) ).\n\nWe use directed angles throughout all the solutions."}
{"id": "imo-shortlist-2018-n1", "question": "N1. Determine all pairs \\((n, k)\\) of distinct positive integers such that there exists a positive integer \\(s\\) for which the numbers of divisors of \\(s n\\) and of \\(s k\\) are equal.\n(Ukraine)\nAnswer: All pairs \\((n, k)\\) such that \\(n \\nmid k\\) and \\(k \\nmid n\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2018, "solution": "As usual, the number of divisors of a positive integer \\(n\\) is denoted by \\(d(n)\\). If \\(n=\\prod_{i} p_{i}^{\\alpha_{i}}\\) is the prime factorisation of \\(n\\), then \\(d(n)=\\prod_{i}\\left(\\alpha_{i}+1\\right)\\).\n\nWe start by showing that one cannot find any suitable number \\(s\\) if \\(k \\mid n\\) or \\(n \\mid k\\) (and \\(k \\neq n\\) ). Suppose that \\(n \\mid k\\), and choose any positive integer \\(s\\). Then the set of divisors of \\(s n\\) is a proper subset of that of \\(s k\\), hence \\(d(s n)<d(s k)\\). Therefore, the pair \\((n, k)\\) does not satisfy the problem requirements. The case \\(k \\mid n\\) is similar.\n\nNow assume that \\(n \\nmid k\\) and \\(k \\nmid n\\). Let \\(p_{1}, \\ldots, p_{t}\\) be all primes dividing \\(n k\\), and consider the prime factorisations\n\n\\[\nn=\\prod_{i=1}^{t} p_{i}^{\\alpha_{i}} \\quad \\text { and } \\quad k=\\prod_{i=1}^{t} p_{i}^{\\beta_{i}} .\n\\]\n\nIt is reasonable to search for the number \\(s\\) having the form\n\n\\[\ns=\\prod_{i=1}^{t} p_{i}^{\\gamma_{i}} .\n\\]\n\nThe (nonnegative integer) exponents \\(\\gamma_{i}\\) should be chosen so as to satisfy\n\n\\[\n\\frac{d(s n)}{d(s k)}=\\prod_{i=1}^{t} \\frac{\\alpha_{i}+\\gamma_{i}+1}{\\beta_{i}+\\gamma_{i}+1}=1\n\\]\n\nFirst of all, if \\(\\alpha_{i}=\\beta_{i}\\) for some \\(i\\), then, regardless of the value of \\(\\gamma_{i}\\), the corresponding factor in (1) equals 1 and does not affect the product. So we may assume that there is no such index \\(i\\). For the other factors in (1), the following lemma is useful.\nLemma. Let \\(\\alpha>\\beta\\) be nonnegative integers. Then, for every integer \\(M \\geqslant \\beta+1\\), there exists a nonnegative integer \\(\\gamma\\) such that\n\n\\[\n\\frac{\\alpha+\\gamma+1}{\\beta+\\gamma+1}=1+\\frac{1}{M}=\\frac{M+1}{M}\n\\]\n\nProof.\n\n\\[\n\\frac{\\alpha+\\gamma+1}{\\beta+\\gamma+1}=1+\\frac{1}{M} \\Longleftrightarrow \\frac{\\alpha-\\beta}{\\beta+\\gamma+1}=\\frac{1}{M} \\Longleftrightarrow \\gamma=M(\\alpha-\\beta)-(\\beta+1) \\geqslant 0\n\\]\n\nNow we can finish the solution. Without loss of generality, there exists an index \\(u\\) such that \\(\\alpha_{i}>\\beta_{i}\\) for \\(i=1,2, \\ldots, u\\), and \\(\\alpha_{i}<\\beta_{i}\\) for \\(i=u+1, \\ldots, t\\). The conditions \\(n \\nmid k\\) and \\(k \\nmid n\\) mean that \\(1 \\leqslant u \\leqslant t-1\\).\n\nChoose an integer \\(X\\) greater than all the \\(\\alpha_{i}\\) and \\(\\beta_{i}\\). By the lemma, we can define the numbers \\(\\gamma_{i}\\) so as to satisfy\n\n\\[\n\\begin{array}{ll}\n\\frac{\\alpha_{i}+\\gamma_{i}+1}{\\beta_{i}+\\gamma_{i}+1}=\\frac{u X+i}{u X+i-1} & \\text { for } i=1,2, \\ldots, u, \\text { and } \n\\frac{\\beta_{u+i}+\\gamma_{u+i}+1}{\\alpha_{u+i}+\\gamma_{u+i}+1}=\\frac{(t-u) X+i}{(t-u) X+i-1} & \\text { for } i=1,2, \\ldots, t-u\n\n\\]\n\nThen we will have\n\n\\[\n\\frac{d(s n)}{d(s k)}=\\prod_{i=1}^{u} \\frac{u X+i}{u X+i-1} \\cdot \\prod_{i=1}^{t-u} \\frac{(t-u) X+i-1}{(t-u) X+i}=\\frac{u(X+1)}{u X} \\cdot \\frac{(t-u) X}{(t-u)(X+1)}=1,\n\\]\n\nas required.\n\nComment. The lemma can be used in various ways, in order to provide a suitable value of \\(s\\). In particular, one may apply induction on the number \\(t\\) of prime factors, using identities like\n\n\\[\n\\frac{n}{n-1}=\\frac{n^{2}}{n^{2}-1} \\cdot \\frac{n+1}{n}\n\\]"}
{"id": "imo-shortlist-2018-n2", "question": "N2. Let \\(n>1\\) be a positive integer. Each cell of an \\(n \\times n\\) table contains an integer. Suppose that the following conditions are satisfied:\n(i) Each number in the table is congruent to 1 modulo \\(n\\);\n(ii) The sum of numbers in any row, as well as the sum of numbers in any column, is congruent to \\(n\\) modulo \\(n^{2}\\).\n\nLet \\(R_{i}\\) be the product of the numbers in the \\(i^{\\text {th }}\\) row, and \\(C_{j}\\) be the product of the numbers in the \\(j^{\\text {th }}\\) column. Prove that the sums \\(R_{1}+\\cdots+R_{n}\\) and \\(C_{1}+\\cdots+C_{n}\\) are congruent modulo \\(n^{4}\\).\n(Indonesia)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2018, "solution": "Let \\(A_{i, j}\\) be the entry in the \\(i^{\\text {th }}\\) row and the \\(j^{\\text {th }}\\) column; let \\(P\\) be the product of all \\(n^{2}\\) entries. For convenience, denote \\(a_{i, j}=A_{i, j}-1\\) and \\(r_{i}=R_{i}-1\\). We show that\n\n\\[\n\\sum_{i=1}^{n} R_{i} \\equiv(n-1)+P \\quad\\left(\\bmod n^{4}\\right)\n\\]\n\nDue to symmetry of the problem conditions, the sum of all the \\(C_{j}\\) is also congruent to \\((n-1)+P\\) modulo \\(n^{4}\\), whence the conclusion.\n\nBy condition \\((i)\\), the number \\(n\\) divides \\(a_{i, j}\\) for all \\(i\\) and \\(j\\). So, every product of at least two of the \\(a_{i, j}\\) is divisible by \\(n^{2}\\), hence\n\\(R_{i}=\\prod_{j=1}^{n}\\left(1+a_{i, j}\\right)=1+\\sum_{j=1}^{n} a_{i, j}+\\sum_{1 \\leqslant j_{1}<j_{2} \\leqslant n} a_{i, j_{1}} a_{i, j_{2}}+\\cdots \\equiv 1+\\sum_{j=1}^{n} a_{i, j} \\equiv 1-n+\\sum_{j=1}^{n} A_{i, j} \\quad\\left(\\bmod n^{2}\\right)\\)\nfor every index \\(i\\). Using condition \\((i i)\\), we obtain \\(R_{i} \\equiv 1\\left(\\bmod n^{2}\\right)\\), and so \\(n^{2} \\mid r_{i}\\).\nTherefore, every product of at least two of the \\(r_{i}\\) is divisible by \\(n^{4}\\). Repeating the same argument, we obtain\n\n\\[\nP=\\prod_{i=1}^{n} R_{i}=\\prod_{i=1}^{n}\\left(1+r_{i}\\right) \\equiv 1+\\sum_{i=1}^{n} r_{i} \\quad\\left(\\bmod n^{4}\\right)\n\\]\n\nwhence\n\n\\[\n\\sum_{i=1}^{n} R_{i}=n+\\sum_{i=1}^{n} r_{i} \\equiv n+(P-1) \\quad\\left(\\bmod n^{4}\\right)\n\\]\n\nas desired.\n\nComment. The original version of the problem statement contained also the condition\n(iii) The product of all the numbers in the table is congruent to 1 modulo \\(n^{4}\\).\n\nThis condition appears to be superfluous, so it was omitted.\nSolution 2. We present a more straightforward (though lengthier) way to establish (1). We also use the notation of \\(a_{i, j}\\).\n\nBy condition \\((i)\\), all the \\(a_{i, j}\\) are divisible by \\(n\\). Therefore, we have\n\n\\[\n\\begin{aligned}\nP=\\prod_{i=1}^{n} \\prod_{j=1}^{n}\\left(1+a_{i, j}\\right) \\equiv 1+\\sum_{(i, j)} a_{i, j} & +\\sum_{\\left(i_{1}, j_{1}\\right),\\left(i_{2}, j_{2}\\right)} a_{i_{1}, j_{1}} a_{i_{2}, j_{2}} \n& +\\sum_{\\left(i_{1}, j_{1}\\right),\\left(i_{2}, j_{2}\\right),\\left(i_{3}, j_{3}\\right)} a_{i_{1}, j_{1}} a_{i_{2}, j_{2}} a_{i_{3}, j_{3}} \\quad\\left(\\bmod n^{4}\\right)\n\n\\]\n\nwhere the last two sums are taken over all unordered pairs/triples of pairwise different pairs \\((i, j)\\); such conventions are applied throughout the solution.\n\nSimilarly,\n\n\\[\n\\sum_{i=1}^{n} R_{i}=\\sum_{i=1}^{n} \\prod_{j=1}^{n}\\left(1+a_{i, j}\\right) \\equiv n+\\sum_{i} \\sum_{j} a_{i, j}+\\sum_{i} \\sum_{j_{1}, j_{2}} a_{i, j_{1}} a_{i, j_{2}}+\\sum_{i} \\sum_{j_{1}, j_{2}, j_{3}} a_{i, j_{1}} a_{i, j_{2}} a_{i, j_{3}} \\quad\\left(\\bmod n^{4}\\right)\n\\]\n\nTherefore,\n\n\\[\n\\begin{aligned}\nP+(n-1)-\\sum_{i} R_{i} \\equiv \\sum_{\\substack{\\left(i_{1}, j_{1}\\right),\\left(i_{2}, j_{2}\\right) \ni_{1} \\neq i_{2}}} a_{i_{1}, j_{1}} a_{i_{2}, j_{2}} & +\\sum_{\\substack{\\left(i_{1}, j_{1}\\right),\\left(i_{2}, j_{2}\\right),\\left(i_{3}, j_{3}\\right) \ni_{1} \\neq i_{2} \\neq i_{3} \\neq i_{1}}} a_{i_{1}, j_{1}} a_{i_{2}, j_{2}} a_{i_{3}, j_{3}} \n& +\\sum_{\\substack{\\left(i_{1}, j_{1}\\right),\\left(i_{2}, j_{2}\\right),\\left(i_{3}, j_{3}\\right) \ni_{1} \\neq i_{2}=i_{3}}} a_{i_{1}, j_{1}} a_{i_{2}, j_{2}} a_{i_{3}, j_{3}} \\quad\\left(\\bmod n^{4}\\right) .\n\n\\]\n\nWe show that in fact each of the three sums appearing in the right-hand part of this congruence is divisible by \\(n^{4}\\); this yields (1). Denote those three sums by \\(\\Sigma_{1}, \\Sigma_{2}\\), and \\(\\Sigma_{3}\\) in order of appearance. Recall that by condition (ii) we have\n\n\\[\n\\sum_{j} a_{i, j} \\equiv 0 \\quad\\left(\\bmod n^{2}\\right) \\quad \\text { for all indices } i\n\\]\n\nFor every two indices \\(i_{1}<i_{2}\\) we have\n\n\\[\n\\sum_{j_{1}} \\sum_{j_{2}} a_{i_{1}, j_{1}} a_{i_{2}, j_{2}}=\\left(\\sum_{j_{1}} a_{i_{1}, j_{1}}\\right) \\cdot\\left(\\sum_{j_{2}} a_{i_{2}, j_{2}}\\right) \\equiv 0 \\quad\\left(\\bmod n^{4}\\right),\n\\]\n\nsince each of the two factors is divisible by \\(n^{2}\\). Summing over all pairs ( \\(i_{1}, i_{2}\\) ) we obtain \\(n^{4} \\mid \\Sigma_{1}\\).\nSimilarly, for every three indices \\(i_{1}<i_{2}<i_{3}\\) we have\n\n\\[\n\\sum_{j_{1}} \\sum_{j_{2}} \\sum_{j_{3}} a_{i_{1}, j_{1}} a_{i_{2}, j_{2}} a_{i_{3}, j_{3}}=\\left(\\sum_{j_{1}} a_{i_{1}, j_{1}}\\right) \\cdot\\left(\\sum_{j_{2}} a_{i_{2}, j_{2}}\\right) \\cdot\\left(\\sum_{j_{3}} a_{i_{3}, j_{3}}\\right)\n\\]\n\nwhich is divisible even by \\(n^{6}\\). Hence \\(n^{4} \\mid \\Sigma_{2}\\).\nFinally, for every indices \\(i_{1} \\neq i_{2}=i_{3}\\) and \\(j_{2}<j_{3}\\) we have\n\n\\[\na_{i_{2}, j_{2}} \\cdot a_{i_{2}, j_{3}} \\cdot \\sum_{j_{1}} a_{i_{1}, j_{1}} \\equiv 0 \\quad\\left(\\bmod n^{4}\\right)\n\\]\n\nsince the three factors are divisible by \\(n, n\\), and \\(n^{2}\\), respectively. Summing over all 4 -tuples of indices \\(\\left(i_{1}, i_{2}, j_{2}, j_{3}\\right)\\) we get \\(n^{4} \\mid \\Sigma_{3}\\)."}
{"id": "imo-shortlist-2018-n3", "question": "N3. Define the sequence \\(a_{0}, a_{1}, a_{2}, \\ldots\\) by \\(a_{n}=2^{n}+2^{\\lfloor n / 2\\rfloor}\\). Prove that there are infinitely many terms of the sequence which can be expressed as a sum of (two or more) distinct terms of the sequence, as well as infinitely many of those which cannot be expressed in such a way.\n(Serbia)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2018, "solution": "Call a nonnegative integer representable if it equals the sum of several (possibly 0 or 1) distinct terms of the sequence. We say that two nonnegative integers \\(b\\) and \\(c\\) are equivalent (written as \\(b \\sim c\\) ) if they are either both representable or both non-representable.\n\nOne can easily compute\n\n\\[\nS_{n-1}:=a_{0}+\\cdots+a_{n-1}=2^{n}+2^{\\lceil n / 2\\rceil}+2^{\\lfloor n / 2\\rfloor}-3\n\\]\n\nIndeed, we have \\(S_{n}-S_{n-1}=2^{n}+2^{\\lfloor n / 2\\rfloor}=a_{n}\\) so we can use the induction. In particular, \\(S_{2 k-1}=2^{2 k}+2^{k+1}-3\\).\n\nNote that, if \\(n \\geqslant 3\\), then \\(2^{\\lceil n / 2\\rceil} \\geqslant 2^{2}>3\\), so\n\n\\[\nS_{n-1}=2^{n}+2^{\\lceil n / 2\\rceil}+2^{\\lfloor n / 2\\rfloor}-3>2^{n}+2^{\\lfloor n / 2\\rfloor}=a_{n}\n\\]\n\nAlso notice that \\(S_{n-1}-a_{n}=2^{\\lceil n / 2\\rceil}-3<a_{n}\\).\nThe main tool of the solution is the following claim.\nClaim 1. Assume that \\(b\\) is a positive integer such that \\(S_{n-1}-a_{n}<b<a_{n}\\) for some \\(n \\geqslant 3\\). Then \\(b \\sim S_{n-1}-b\\).\nProof. As seen above, we have \\(S_{n-1}>a_{n}\\). Denote \\(c=S_{n-1}-b\\); then \\(S_{n-1}-a_{n}<c<a_{n}\\), so the roles of \\(b\\) and \\(c\\) are symmetrical.\n\nAssume that \\(b\\) is representable. The representation cannot contain \\(a_{i}\\) with \\(i \\geqslant n\\), since \\(b<a_{n}\\). So \\(b\\) is the sum of some subset of \\(\\left\\{a_{0}, a_{1}, \\ldots, a_{n-1}\\right\\}\\); then \\(c\\) is the sum of the complement. The converse is obtained by swapping \\(b\\) and \\(c\\).\n\nWe also need the following version of this claim.\nClaim 2. For any \\(n \\geqslant 3\\), the number \\(a_{n}\\) can be represented as a sum of two or more distinct terms of the sequence if and only if \\(S_{n-1}-a_{n}=2^{\\lceil n / 2\\rceil}-3\\) is representable.\nProof. Denote \\(c=S_{n-1}-a_{n}<a_{n}\\). If \\(a_{n}\\) satisfies the required condition, then it is the sum of some subset of \\(\\left\\{a_{0}, a_{1}, \\ldots, a_{n-1}\\right\\}\\); then \\(c\\) is the sum of the complement. Conversely, if \\(c\\) is representable, then its representation consists only of the numbers from \\(\\left\\{a_{0}, \\ldots, a_{n-1}\\right\\}\\), so \\(a_{n}\\) is the sum of the complement.\n\nBy Claim 2, in order to prove the problem statement, it suffices to find infinitely many representable numbers of the form \\(2^{t}-3\\), as well as infinitely many non-representable ones.\nClaim 3. For every \\(t \\geqslant 3\\), we have \\(2^{t}-3 \\sim 2^{4 t-6}-3\\), and \\(2^{4 t-6}-3>2^{t}-3\\).\nProof. The inequality follows from \\(t \\geqslant 3\\). In order to prove the equivalence, we apply Claim 1 twice in the following manner.\n\nFirst, since \\(S_{2 t-3}-a_{2 t-2}=2^{t-1}-3<2^{t}-3<2^{2 t-2}+2^{t-1}=a_{2 t-2}\\), by Claim 1 we have \\(2^{t}-3 \\sim S_{2 t-3}-\\left(2^{t}-3\\right)=2^{2 t-2}\\).\n\nSecond, since \\(S_{4 t-7}-a_{4 t-6}=2^{2 t-3}-3<2^{2 t-2}<2^{4 t-6}+2^{2 t-3}=a_{4 t-6}\\), by Claim 1 we have \\(2^{2 t-2} \\sim S_{4 t-7}-2^{2 t-2}=2^{4 t-6}-3\\).\n\nTherefore, \\(2^{t}-3 \\sim 2^{2 t-2} \\sim 2^{4 t-6}-3\\), as required.\nNow it is easy to find the required numbers. Indeed, the number \\(2^{3}-3=5=a_{0}+a_{1}\\) is representable, so Claim 3 provides an infinite sequence of representable numbers\n\n\\[\n2^{3}-3 \\sim 2^{6}-3 \\sim 2^{18}-3 \\sim \\cdots \\sim 2^{t}-3 \\sim 2^{4 t-6}-3 \\sim \\cdots .\n\\]\n\nOn the other hand, the number \\(2^{7}-3=125\\) is non-representable (since by Claim 1 we have \\(125 \\sim S_{6}-125=24 \\sim S_{4}-24=17 \\sim S_{3}-17=4\\) which is clearly non-representable). So Claim 3 provides an infinite sequence of non-representable numbers\n\n\\[\n2^{7}-3 \\sim 2^{22}-3 \\sim 2^{82}-3 \\sim \\cdots \\sim 2^{t}-3 \\sim 2^{4 t-6}-3 \\sim \\cdots\n\\]\n\nSolution 2. We keep the notion of representability and the notation \\(S_{n}\\) from the previous solution. We say that an index \\(n\\) is good if \\(a_{n}\\) writes as a sum of smaller terms from the sequence \\(a_{0}, a_{1}, \\ldots\\). Otherwise we say it is bad. We must prove that there are infinitely many good indices, as well as infinitely many bad ones.\nLemma 1. If \\(m \\geqslant 0\\) is an integer, then \\(4^{m}\\) is representable if and only if either of \\(2 m+1\\) and \\(2 m+2\\) is good.\n\nProof. The case \\(m=0\\) is obvious, so we may assume that \\(m \\geqslant 1\\). Let \\(n=2 m+1\\) or \\(2 m+2\\). Then \\(n \\geqslant 3\\). We notice that\n\n\\[\nS_{n-1}<a_{n-2}+a_{n}\n\\]\n\nThe inequality writes as \\(2^{n}+2^{\\lceil n / 2\\rceil}+2^{\\lfloor n / 2\\rfloor}-3<2^{n}+2^{\\lfloor n / 2\\rfloor}+2^{n-2}+2^{\\lfloor n / 2\\rfloor-1}\\), i.e. as \\(2^{\\lceil n / 2\\rceil}<\\) \\(2^{n-2}+2^{\\lfloor n / 2\\rfloor-1}+3\\). If \\(n \\geqslant 4\\), then \\(n / 2 \\leqslant n-2\\), so \\(\\lceil n / 2\\rceil \\leqslant n-2\\) and \\(2^{\\lceil n / 2\\rceil} \\leqslant 2^{n-2}\\). For \\(n=3\\) the inequality verifies separately.\n\nIf \\(n\\) is good, then \\(a_{n}\\) writes as \\(a_{n}=a_{i_{1}}+\\cdots+a_{i_{r}}\\), where \\(r \\geqslant 2\\) and \\(i_{1}<\\cdots<i_{r}<n\\). Then \\(i_{r}=n-1\\) and \\(i_{r-1}=n-2\\), for if \\(n-1\\) or \\(n-2\\) is missing from the sequence \\(i_{1}, \\ldots, i_{r}\\), then \\(a_{i_{1}}+\\cdots+a_{i_{r}} \\leqslant a_{0}+\\cdots+a_{n-3}+a_{n-1}=S_{n-1}-a_{n-2}<a_{n}\\). Thus, if \\(n\\) is good, then both \\(a_{n}-a_{n-1}\\) and \\(a_{n}-a_{n-1}-a_{n-2}\\) are representable.\n\nWe now consider the cases \\(n=2 m+1\\) and \\(n=2 m+2\\) separately.\nIf \\(n=2 m+1\\), then \\(a_{n}-a_{n-1}=a_{2 m+1}-a_{2 m}=\\left(2^{2 m+1}+2^{m}\\right)-\\left(2^{2 m}+2^{m}\\right)=2^{2 m}\\). So we proved that, if \\(2 m+1\\) is good, then \\(2^{2 m}\\) is representable. Conversely, if \\(2^{2 m}\\) is representable, then \\(2^{2 m}<a_{2 m}\\), so \\(2^{2 m}\\) is a sum of some distinct terms \\(a_{i}\\) with \\(i<2 m\\). It follows that \\(a_{2 m+1}=a_{2 m}+2^{2 m}\\) writes as \\(a_{2 m}\\) plus a sum of some distinct terms \\(a_{i}\\) with \\(i<2 m\\). Hence \\(2 m+1\\) is good.\n\nIf \\(n=2 m+2\\), then \\(a_{n}-a_{n-1}-a_{n-2}=a_{2 m+2}-a_{2 m+1}-a_{2 m}=\\left(2^{2 m+2}+2^{m+1}\\right)-\\left(2^{2 m+1}+\\right.\\) \\(\\left.2^{m}\\right)-\\left(2^{2 m}+2^{m}\\right)=2^{2 m}\\). So we proved that, if \\(2 m+2\\) is good, then \\(2^{2 m}\\) is representable. Conversely, if \\(2^{2 m}\\) is representable, then, as seen in the previous case, it writes as a sum of some distinct terms \\(a_{i}\\) with \\(i<2 m\\). Hence \\(a_{2 m+2}=a_{2 m+1}+a_{2 m}+2^{2 m}\\) writes as \\(a_{2 m+1}+a_{2 m}\\) plus a sum of some distinct terms \\(a_{i}\\) with \\(i<2 m\\). Thus \\(2 m+2\\) is good.\n\nLemma 2. If \\(k \\geqslant 2\\), then \\(2^{4 k-2}\\) is representable if and only if \\(2^{k+1}\\) is representable.\nIn particular, if \\(s \\geqslant 2\\), then \\(4^{s}\\) is representable if and only if \\(4^{4 s-3}\\) is representable. Also, \\(4^{4 s-3}>4^{s}\\).\n\nProof. We have \\(2^{4 k-2}<a_{4 k-2}\\), so in a representation of \\(2^{4 k-2}\\) we can have only terms \\(a_{i}\\) with \\(i \\leqslant 4 k-3\\). Notice that\n\n\\[\na_{0}+\\cdots+a_{4 k-3}=2^{4 k-2}+2^{2 k}-3<2^{4 k-2}+2^{2 k}+2^{k}=2^{4 k-2}+a_{2 k}\n\\]\n\nHence, any representation of \\(2^{4 k-2}\\) must contain all terms from \\(a_{2 k}\\) to \\(a_{4 k-3}\\). (If any of these terms is missing, then the sum of the remaining ones is \\(\\leqslant\\left(a_{0}+\\cdots+a_{4 k-3}\\right)-a_{2 k}<2^{4 k-2}\\).) Hence, if \\(2^{4 k-2}\\) is representable, then \\(2^{4 k-2}-\\sum_{i=2 k}^{4 k-3} a_{i}\\) is representable. But\n\\(2^{4 k-2}-\\sum_{i=2 k}^{4 k-3} a_{i}=2^{4 k-2}-\\left(S_{4 k-3}-S_{2 k-1}\\right)=2^{4 k-2}-\\left(2^{4 k-2}+2^{2 k}-3\\right)+\\left(2^{2 k}+2^{k+1}-3\\right)=2^{k+1}\\).\nSo, if \\(2^{4 k-2}\\) is representable, then \\(2^{k+1}\\) is representable. Conversely, if \\(2^{k+1}\\) is representable, then \\(2^{k+1}<2^{2 k}+2^{k}=a_{2 k}\\), so \\(2^{k+1}\\) writes as a sum of some distinct terms \\(a_{i}\\) with \\(i<2 k\\). It follows that \\(2^{4 k-2}=\\sum_{i=2 k}^{4 k-3} a_{i}+2^{k+1}\\) writes as \\(a_{4 k-3}+a_{4 k-4}+\\cdots+a_{2 k}\\) plus the sum of some distinct terms \\(a_{i}\\) with \\(i<2 k\\). Hence \\(2^{4 k-2}\\) is representable.\n\nFor the second statement, if \\(s \\geqslant 2\\), then we just take \\(k=2 s-1\\) and we notice that \\(2^{k+1}=4^{s}\\) and \\(2^{4 k-2}=4^{4 s-3}\\). Also, \\(s \\geqslant 2\\) implies that \\(4 s-3>s\\).\n\nNow \\(4^{2}=a_{2}+a_{3}\\) is representable, whereas \\(4^{6}=4096\\) is not. Indeed, note that \\(4^{6}=2^{12}<a_{12}\\), so the only available terms for a representation are \\(a_{0}, \\ldots, a_{11}\\), i.e., \\(2,3,6,10,20,36,72\\), 136, 272, 528, 1056, 2080. Their sum is \\(S_{11}=4221\\), which exceeds 4096 by 125. Then any representation of 4096 must contain all the terms from \\(a_{0}, \\ldots, a_{11}\\) that are greater that 125 , i.e., \\(136,272,528,1056,2080\\). Their sum is 4072 . Since \\(4096-4072=24\\) and 24 is clearly not representable, 4096 is non-representable as well.\n\nStarting with these values of \\(m\\), by using Lemma 2, we can obtain infinitely many representable powers of 4, as well as infinitely many non-representable ones. By Lemma 1, this solves our problem.\n\nThis page is intentionally left blank"}
{"id": "imo-shortlist-2018-n4", "question": "N4. Let \\(a_{1}, a_{2}, \\ldots, a_{n}, \\ldots\\) be a sequence of positive integers such that\n\n\\[\n\\frac{a_{1}}{a_{2}}+\\frac{a_{2}}{a_{3}}+\\cdots+\\frac{a_{n-1}}{a_{n}}+\\frac{a_{n}}{a_{1}}\n\\]\n\nis an integer for all \\(n \\geqslant k\\), where \\(k\\) is some positive integer. Prove that there exists a positive integer \\(m\\) such that \\(a_{n}=a_{n+1}\\) for all \\(n \\geqslant m\\).\n(Mongolia)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2018, "solution": "The argument hinges on the following two facts: Let \\(a, b, c\\) be positive integers such that \\(N=b / c+(c-b) / a\\) is an integer.\n(1) If \\(\\operatorname{gcd}(a, c)=1\\), then \\(c\\) divides \\(b\\); and\n(2) If \\(\\operatorname{gcd}(a, b, c)=1\\), then \\(\\operatorname{gcd}(a, b)=1\\).\n\nTo prove (1), write \\(a b=c(a N+b-c)\\). Since \\(\\operatorname{gcd}(a, c)=1\\), it follows that \\(c\\) divides \\(b\\). To prove (2), write \\(c^{2}-b c=a(c N-b)\\) to infer that \\(a\\) divides \\(c^{2}-b c\\). Letting \\(d=\\operatorname{gcd}(a, b)\\), it follows that \\(d\\) divides \\(c^{2}\\), and since the two are relatively prime by hypothesis, \\(d=1\\).\n\nNow, let \\(s_{n}=a_{1} / a_{2}+a_{2} / a_{3}+\\cdots+a_{n-1} / a_{n}+a_{n} / a_{1}\\), let \\(\\delta_{n}=\\operatorname{gcd}\\left(a_{1}, a_{n}, a_{n+1}\\right)\\) and write\n\n\\[\ns_{n+1}-s_{n}=\\frac{a_{n}}{a_{n+1}}+\\frac{a_{n+1}-a_{n}}{a_{1}}=\\frac{a_{n} / \\delta_{n}}{a_{n+1} / \\delta_{n}}+\\frac{a_{n+1} / \\delta_{n}-a_{n} / \\delta_{n}}{a_{1} / \\delta_{n}}\n\\]\n\nLet \\(n \\geqslant k\\). Since \\(\\operatorname{gcd}\\left(a_{1} / \\delta_{n}, a_{n} / \\delta_{n}, a_{n+1} / \\delta_{n}\\right)=1\\), it follows by (2) that \\(\\operatorname{gcd}\\left(a_{1} / \\delta_{n}, a_{n} / \\delta_{n}\\right)=1\\). Let \\(d_{n}=\\operatorname{gcd}\\left(a_{1}, a_{n}\\right)\\). Then \\(d_{n}=\\delta_{n} \\cdot \\operatorname{gcd}\\left(a_{1} / \\delta_{n}, a_{n} / \\delta_{n}\\right)=\\delta_{n}\\), so \\(d_{n}\\) divides \\(a_{n+1}\\), and therefore \\(d_{n}\\) divides \\(d_{n+1}\\).\n\nConsequently, from some rank on, the \\(d_{n}\\) form a nondecreasing sequence of integers not exceeding \\(a_{1}\\), so \\(d_{n}=d\\) for all \\(n \\geqslant \\ell\\), where \\(\\ell\\) is some positive integer.\n\nFinally, since \\(\\operatorname{gcd}\\left(a_{1} / d, a_{n+1} / d\\right)=1\\), it follows by (1) that \\(a_{n+1} / d\\) divides \\(a_{n} / d\\), so \\(a_{n} \\geqslant a_{n+1}\\) for all \\(n \\geqslant \\ell\\). The conclusion follows.\n\nSolution 2. We use the same notation \\(s_{n}\\). This time, we explore the exponents of primes in the prime factorizations of the \\(a_{n}\\) for \\(n \\geqslant k\\).\n\nTo start, for every \\(n \\geqslant k\\), we know that the number\n\n\\[\ns_{n+1}-s_{n}=\\frac{a_{n}}{a_{n+1}}+\\frac{a_{n+1}}{a_{1}}-\\frac{a_{n}}{a_{1}}\n\\]\n\nis integer. Multiplying it by \\(a_{1}\\) we obtain that \\(a_{1} a_{n} / a_{n+1}\\) is integer as well, so that \\(a_{n+1} \\mid a_{1} a_{n}\\). This means that \\(a_{n} \\mid a_{1}^{n-k} a_{k}\\), so all prime divisors of \\(a_{n}\\) are among those of \\(a_{1} a_{k}\\). There are finitely many such primes; therefore, it suffices to prove that the exponent of each of them in the prime factorization of \\(a_{n}\\) is eventually constant.\n\nChoose any prime \\(p \\mid a_{1} a_{k}\\). Recall that \\(v_{p}(q)\\) is the standard notation for the exponent of \\(p\\) in the prime factorization of a nonzero rational number \\(q\\). Say that an index \\(n \\geqslant k\\) is large if \\(v_{p}\\left(a_{n}\\right) \\geqslant v_{p}\\left(a_{1}\\right)\\). We separate two cases.\nCase 1: There exists a large index \\(n\\).\nIf \\(v_{p}\\left(a_{n+1}\\right)<v_{p}\\left(a_{1}\\right)\\), then \\(v_{p}\\left(a_{n} / a_{n+1}\\right)\\) and \\(v_{p}\\left(a_{n} / a_{1}\\right)\\) are nonnegative, while \\(v_{p}\\left(a_{n+1} / a_{1}\\right)<0\\); hence (*) cannot be an integer. This contradiction shows that index \\(n+1\\) is also large.\n\nOn the other hand, if \\(v_{p}\\left(a_{n+1}\\right)>v_{p}\\left(a_{n}\\right)\\), then \\(v_{p}\\left(a_{n} / a_{n+1}\\right)<0\\), while \\(v_{p}\\left(\\left(a_{n+1}-a_{n}\\right) / a_{1}\\right) \\geqslant 0\\), so (*) is not integer again. Thus, \\(v_{p}\\left(a_{1}\\right) \\leqslant v_{p}\\left(a_{n+1}\\right) \\leqslant v_{p}\\left(a_{n}\\right)\\).\n\nThe above arguments can now be applied successively to indices \\(n+1, n+2, \\ldots\\), showing that all the indices greater than \\(n\\) are large, and the sequence \\(v_{p}\\left(a_{n}\\right), v_{p}\\left(a_{n+1}\\right), v_{p}\\left(a_{n+2}\\right), \\ldots\\) is nonincreasing - hence eventually constant.\n\nCase 2: There is no large index.\nWe have \\(v_{p}\\left(a_{1}\\right)>v_{p}\\left(a_{n}\\right)\\) for all \\(n \\geqslant k\\). If we had \\(v_{p}\\left(a_{n+1}\\right)<v_{p}\\left(a_{n}\\right)\\) for some \\(n \\geqslant k\\), then \\(v_{p}\\left(a_{n+1} / a_{1}\\right)<v_{p}\\left(a_{n} / a_{1}\\right)<0<v_{p}\\left(a_{n} / a_{n+1}\\right)\\) which would also yield that \\((*)\\) is not integer. Therefore, in this case the sequence \\(v_{p}\\left(a_{k}\\right), v_{p}\\left(a_{k+1}\\right), v_{p}\\left(a_{k+2}\\right), \\ldots\\) is nondecreasing and bounded by \\(v_{p}\\left(a_{1}\\right)\\) from above; hence it is also eventually constant.\n\nComment. Given any positive odd integer \\(m\\), consider the \\(m\\)-tuple ( \\(2,2^{2}, \\ldots, 2^{m-1}, 2^{m}\\) ). Appending an infinite string of 1's to this \\(m\\)-tuple yields an eventually constant sequence of integers satisfying the condition in the statement, and shows that the rank from which the sequence stabilises may be arbitrarily large.\n\nThere are more sophisticated examples. The solution to part (b) of 10532, Amer. Math. Monthly, Vol. 105 No. 8 (Oct. 1998), 775-777 (available at \\href{https://www.jstor.org/stable/2589009}{https://www.jstor.org/stable/2589009}), shows that, for every integer \\(m \\geqslant 5\\), there exists an \\(m\\)-tuple ( \\(a_{1}, a_{2}, \\ldots, a_{m}\\) ) of pairwise distinct positive integers such that \\(\\operatorname{gcd}\\left(a_{1}, a_{2}\\right)=\\operatorname{gcd}\\left(a_{2}, a_{3}\\right)=\\cdots=\\operatorname{gcd}\\left(a_{m-1}, a_{m}\\right)=\\operatorname{gcd}\\left(a_{m}, a_{1}\\right)=1\\), and the sum \\(a_{1} / a_{2}+a_{2} / a_{3}+\\cdots+a_{m-1} / a_{m}+a_{m} / a_{1}\\) is an integer. Letting \\(a_{m+k}=a_{1}, k=1,2, \\ldots\\), extends such an \\(m\\)-tuple to an eventually constant sequence of positive integers satisfying the condition in the statement of the problem at hand.\n\nHere is the example given by the proposers of 10532. Let \\(b_{1}=2\\), let \\(b_{k+1}=1+b_{1} \\cdots b_{k}=\\) \\(1+b_{k}\\left(b_{k}-1\\right), k \\geqslant 1\\), and set \\(B_{m}=b_{1} \\cdots b_{m-4}=b_{m-3}-1\\). The \\(m\\)-tuple ( \\(a_{1}, a_{2}, \\ldots, a_{m}\\) ) defined below satisfies the required conditions:\n\n\\[\n\\begin{aligned}\na_{1}=1, & a_{2}=\\left(8 B_{m}+1\\right) B_{m}+8, \\quad a_{3}=8 B_{m}+1, \\quad a_{k}=b_{m-k} \\quad \\text { for } 4 \\leqslant k \\leqslant m-1, \n& a_{m}=\\frac{a_{2}}{2} \\cdot a_{3} \\cdot \\frac{B_{m}}{2}=\\left(\\frac{1}{2}\\left(8 B_{m}+1\\right) B_{m}+4\\right) \\cdot\\left(8 B_{m}+1\\right) \\cdot \\frac{B_{m}}{2}\n\n\\]\n\nIt is readily checked that \\(a_{1}<a_{m-1}<a_{m-2}<\\cdots<a_{3}<a_{2}<a_{m}\\). For further details we refer to the solution mentioned above. Acquaintance with this example (or more elaborated examples derived from) offers no advantage in tackling the problem."}
{"id": "imo-shortlist-2018-n5", "question": "N5. Four positive integers \\(x, y, z\\), and \\(t\\) satisfy the relations\n\n\\[\nx y-z t=x+y=z+t .\n\\]\n\nIs it possible that both \\(x y\\) and \\(z t\\) are perfect squares?\n(Russia)\nAnswer: No.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2018, "solution": "Arguing indirectly, assume that \\(x y=a^{2}\\) and \\(z t=c^{2}\\) with \\(a, c>0\\).\nSuppose that the number \\(x+y=z+t\\) is odd. Then \\(x\\) and \\(y\\) have opposite parity, as well as \\(z\\) and \\(t\\). This means that both \\(x y\\) and \\(z t\\) are even, as well as \\(x y-z t=x+y\\); a contradiction. Thus, \\(x+y\\) is even, so the number \\(s=\\frac{x+y}{2}=\\frac{z+t}{2}\\) is a positive integer.\n\nNext, we set \\(b=\\frac{|x-y|}{2}, d=\\frac{|z-t|}{2}\\). Now the problem conditions yield\n\n\\[\ns^{2}=a^{2}+b^{2}=c^{2}+d^{2}\n\\]\n\nand\n\n\\[\n2 s=a^{2}-c^{2}=d^{2}-b^{2}\n\\]\n\n(the last equality in (2) follows from (1)). We readily get from (2) that \\(a, d>0\\).\nIn the sequel we will use only the relations (1) and (2), along with the fact that \\(a, d, s\\) are positive integers, while \\(b\\) and \\(c\\) are nonnegative integers, at most one of which may be zero. Since both relations are symmetric with respect to the simultaneous swappings \\(a \\leftrightarrow d\\) and \\(b \\leftrightarrow c\\), we assume, without loss of generality, that \\(b \\geqslant c\\) (and hence \\(b>0\\) ). Therefore, \\(d^{2}=2 s+b^{2}>c^{2}\\), whence\n\n\\[\nd^{2}>\\frac{c^{2}+d^{2}}{2}=\\frac{s^{2}}{2}\n\\]\n\nOn the other hand, since \\(d^{2}-b^{2}\\) is even by (2), the numbers \\(b\\) and \\(d\\) have the same parity, so \\(0<b \\leqslant d-2\\). Therefore,\n\n\\[\n2 s=d^{2}-b^{2} \\geqslant d^{2}-(d-2)^{2}=4(d-1), \\quad \\text { i.e., } \\quad d \\leqslant \\frac{s}{2}+1\n\\]\n\nCombining (3) and (4) we obtain\n\n\\[\n2 s^{2}<4 d^{2} \\leqslant 4\\left(\\frac{s}{2}+1\\right)^{2}, \\quad \\text { or } \\quad(s-2)^{2}<8\n\\]\n\nwhich yields \\(s \\leqslant 4\\).\nFinally, an easy check shows that each number of the form \\(s^{2}\\) with \\(1 \\leqslant s \\leqslant 4\\) has a unique representation as a sum of two squares, namely \\(s^{2}=s^{2}+0^{2}\\). Thus, (1) along with \\(a, d>0\\) imply \\(b=c=0\\), which is impossible.\n\nSolution 2. We start with a complete description of all 4-tuples ( \\(x, y, z, t\\) ) of positive integers satisfying (*). As in the solution above, we notice that the numbers\n\n\\[\ns=\\frac{x+y}{2}=\\frac{z+t}{2}, \\quad p=\\frac{x-y}{2}, \\quad \\text { and } \\quad q=\\frac{z-t}{2}\n\\]\n\nare integers (we may, and will, assume that \\(p, q \\geqslant 0\\) ). We have\n\n\\[\n2 s=x y-z t=(s+p)(s-p)-(s+q)(s-q)=q^{2}-p^{2},\n\\]\n\nso \\(p\\) and \\(q\\) have the same parity, and \\(q>p\\).\n\nSet now \\(k=\\frac{q-p}{2}, \\ell=\\frac{q+p}{2}\\). Then we have \\(s=\\frac{q^{2}-p^{2}}{2}=2 k \\ell\\) and hence\n\n\\[\n\\begin{array}{ll}\nx=s+p=2 k \\ell-k+\\ell, & y=s-p=2 k \\ell+k-\\ell \nz=s+q=2 k \\ell+k+\\ell, & t=s-q=2 k \\ell-k-\\ell\n\n\\]\n\nRecall here that \\(\\ell \\geqslant k>0\\) and, moreover, \\((k, \\ell) \\neq(1,1)\\), since otherwise \\(t=0\\).\nAssume now that both \\(x y\\) and \\(z t\\) are squares. Then \\(x y z t\\) is also a square. On the other hand, we have\n\n\\[\n\\begin{aligned}\nx y z t=(2 k \\ell-k+\\ell) & (2 k \\ell+k-\\ell)(2 k \\ell+k+\\ell)(2 k \\ell-k-\\ell) \n= & \\left(4 k^{2} \\ell^{2}-(k-\\ell)^{2}\\right)\\left(4 k^{2} \\ell^{2}-(k+\\ell)^{2}\\right)=\\left(4 k^{2} \\ell^{2}-k^{2}-\\ell^{2}\\right)^{2}-4 k^{2} \\ell^{2} .\n\n\\]\n\nDenote \\(D=4 k^{2} \\ell^{2}-k^{2}-\\ell^{2}>0\\). From (6) we get \\(D^{2}>x y z t\\). On the other hand,\n\n\\[\n\\begin{aligned}\n&(D-1)^{2}=D^{2}-2\\left(4 k^{2} \\ell^{2}-k^{2}-\\ell^{2}\\right)+1=\\left(D^{2}-4 k^{2} \\ell^{2}\\right)-\\left(2 k^{2}-1\\right)\\left(2 \\ell^{2}-1\\right)+2 \n&=x y z t-\\left(2 k^{2}-1\\right)\\left(2 \\ell^{2}-1\\right)+2<x y z t\n\n\\]\n\nsince \\(\\ell \\geqslant 2\\) and \\(k \\geqslant 1\\). Thus \\((D-1)^{2}<x y z t<D^{2}\\), and \\(x y z t\\) cannot be a perfect square; a contradiction.\n\nComment. The first part of Solution 2 shows that all 4-tuples of positive integers \\(x \\geqslant y, z \\geqslant t\\) satisfying (\\textit{) have the form (5), where \\(\\ell \\geqslant k>0\\) and \\(\\ell \\geqslant 2\\). The converse is also true: every pair of positive integers \\(\\ell \\geqslant k>0\\), except for the pair \\(k=\\ell=1\\), generates via (5) a 4 -tuple of positive integers satisfying (})."}
{"id": "imo-shortlist-2018-n6", "question": "N6. Let \\(f:\\{1,2,3, \\ldots\\} \\rightarrow\\{2,3, \\ldots\\}\\) be a function such that \\(f(m+n) \\mid f(m)+f(n)\\) for all pairs \\(m, n\\) of positive integers. Prove that there exists a positive integer \\(c>1\\) which divides all values of \\(f\\).\n(Mexico)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2018, "solution": "For every positive integer \\(m\\), define \\(S_{m}=\\{n: m \\mid f(n)\\}\\).\nLemma. If the set \\(S_{m}\\) is infinite, then \\(S_{m}=\\{d, 2 d, 3 d, \\ldots\\}=d \\cdot \\mathbb{Z}_{>0}\\) for some positive integer \\(d\\).\nProof. Let \\(d=\\min S_{m}\\); the definition of \\(S_{m}\\) yields \\(m \\mid f(d)\\).\nWhenever \\(n \\in S_{m}\\) and \\(n>d\\), we have \\(m|f(n)| f(n-d)+f(d)\\), so \\(m \\mid f(n-d)\\) and therefore \\(n-d \\in S_{m}\\). Let \\(r \\leqslant d\\) be the least positive integer with \\(n \\equiv r(\\bmod d)\\); repeating the same step, we can see that \\(n-d, n-2 d, \\ldots, r \\in S_{m}\\). By the minimality of \\(d\\), this shows \\(r=d\\) and therefore \\(d \\mid n\\).\n\nStarting from an arbitrarily large element of \\(S_{m}\\), the process above reaches all multiples of \\(d\\); so they all are elements of \\(S_{m}\\).\n\nThe solution for the problem will be split into two cases.\nCase 1: The function \\(f\\) is bounded.\nCall a prime \\(p\\) frequent if the set \\(S_{p}\\) is infinite, i.e., if \\(p\\) divides \\(f(n)\\) for infinitely many positive integers \\(n\\); otherwise call \\(p\\) sporadic. Since the function \\(f\\) is bounded, there are only a finite number of primes that divide at least one \\(f(n)\\); so altogether there are finitely many numbers \\(n\\) such that \\(f(n)\\) has a sporadic prime divisor. Let \\(N\\) be a positive integer, greater than all those numbers \\(n\\).\n\nLet \\(p_{1}, \\ldots, p_{k}\\) be the frequent primes. By the lemma we have \\(S_{p_{i}}=d_{i} \\cdot \\mathbb{Z}_{>0}\\) for some \\(d_{i}\\). Consider the number\n\n\\[\nn=N d_{1} d_{2} \\cdots d_{k}+1\n\\]\n\nDue to \\(n>N\\), all prime divisors of \\(f(n)\\) are frequent primes. Let \\(p_{i}\\) be any frequent prime divisor of \\(f(n)\\). Then \\(n \\in S_{p_{i}}\\), and therefore \\(d_{i} \\mid n\\). But \\(n \\equiv 1\\left(\\bmod d_{i}\\right)\\), which means \\(d_{i}=1\\). Hence \\(S_{p_{i}}=1 \\cdot \\mathbb{Z}_{>0}=\\mathbb{Z}_{>0}\\) and therefore \\(p_{i}\\) is a common divisor of all values \\(f(n)\\).\n\nCase 2: \\(f\\) is unbounded.\nWe prove that \\(f(1)\\) divides all \\(f(n)\\).\nLet \\(a=f(1)\\). Since \\(1 \\in S_{a}\\), by the lemma it suffices to prove that \\(S_{a}\\) is an infinite set.\nCall a positive integer \\(p\\) a peak if \\(f(p)>\\max (f(1), \\ldots, f(p-1))\\). Since \\(f\\) is not bounded, there are infinitely many peaks. Let \\(1=p_{1}<p_{2}<\\ldots\\) be the sequence of all peaks, and let \\(h_{k}=f\\left(p_{k}\\right)\\). Notice that for any peak \\(p_{i}\\) and for any \\(k<p_{i}\\), we have \\(f\\left(p_{i}\\right) \\mid f(k)+f\\left(p_{i}-k\\right)<\\) \\(2 f\\left(p_{i}\\right)\\), hence\n\n\\[\nf(k)+f\\left(p_{i}-k\\right)=f\\left(p_{i}\\right)=h_{i}\n\\]\n\nBy the pigeonhole principle, among the numbers \\(h_{1}, h_{2}, \\ldots\\) there are infinitely many that are congruent modulo \\(a\\). Let \\(k_{0}<k_{1}<k_{2}<\\ldots\\) be an infinite sequence of positive integers such that \\(h_{k_{0}} \\equiv h_{k_{1}} \\equiv \\ldots(\\bmod a)\\). Notice that\n\n\\[\nf\\left(p_{k_{i}}-p_{k_{0}}\\right)=f\\left(p_{k_{i}}\\right)-f\\left(p_{k_{0}}\\right)=h_{k_{i}}-h_{k_{0}} \\equiv 0 \\quad(\\bmod a),\n\\]\n\nso \\(p_{k_{i}}-p_{k_{0}} \\in S_{a}\\) for all \\(i=1,2, \\ldots\\). This provides infinitely many elements in \\(S_{a}\\).\nHence, \\(S_{a}\\) is an infinite set, and therefore \\(f(1)=a\\) divides \\(f(n)\\) for every \\(n\\).\n\nComment. As an extension of the solution above, it can be proven that if \\(f\\) is not bounded then \\(f(n)=a n\\) with \\(a=f(1)\\).\n\nTake an arbitrary positive integer \\(n\\); we will show that \\(f(n+1)=f(n)+a\\). Then it follows by induction that \\(f(n)=a n\\).\n\nTake a peak \\(p\\) such that \\(p>n+2\\) and \\(h=f(p)>f(n)+2 a\\). By (1) we have \\(f(p-1)=\\) \\(f(p)-f(1)=h-a\\) and \\(f(n+1)=f(p)-f(p-n-1)=h-f(p-n-1)\\). From \\(h-a=f(p-1) \\mid\\) \\(f(n)+f(p-n-1)<f(n)+h<2(h-a)\\) we get \\(f(n)+f(p-n-1)=h-a\\). Then\n\n\\[\nf(n+1)-f(n)=(h-f(p-n-1))-(h-a-f(p-n-1))=a\n\\]\n\nOn the other hand, there exists a wide family of bounded functions satisfying the required properties. Here we present a few examples:\n\n\\[\nf(n)=c ; \\quad f(n)=\\left\\{\\begin{array}{ll}\n2 c & \\text { if } n \\text { is even } \nc & \\text { if } n \\text { is odd } ;\n \\quad f(n)= \\begin{cases}2018 c & \\text { if } n \\leqslant 2018 \nc & \\text { if } n>2018\\right.\n\\]\n\nSolution 2. Let \\(d_{n}=\\operatorname{gcd}(f(n), f(1))\\). From \\(d_{n+1} \\mid f(1)\\) and \\(d_{n+1}|f(n+1)| f(n)+f(1)\\), we can see that \\(d_{n+1} \\mid f(n)\\); then \\(d_{n+1} \\mid \\operatorname{gcd}(f(n), f(1))=d_{n}\\). So the sequence \\(d_{1}, d_{2}, \\ldots\\) is nonincreasing in the sense that every element is a divisor of the previous elements. Let \\(d=\\min \\left(d_{1}, d_{2}, \\ldots\\right)=\\operatorname{gcd}\\left(d_{1} . d_{2}, \\ldots\\right)=\\operatorname{gcd}(f(1), f(2), \\ldots)\\); we have to prove \\(d \\geqslant 2\\).\n\nFor the sake of contradiction, suppose that the statement is wrong, so \\(d=1\\); that means there is some index \\(n_{0}\\) such that \\(d_{n}=1\\) for every \\(n \\geqslant n_{0}\\), i.e., \\(f(n)\\) is coprime with \\(f(1)\\).\nClaim 1. If \\(2^{k} \\geqslant n_{0}\\) then \\(f\\left(2^{k}\\right) \\leqslant 2^{k}\\).\nProof. By the condition, \\(f(2 n) \\mid 2 f(n)\\); a trivial induction yields \\(f\\left(2^{k}\\right) \\mid 2^{k} f(1)\\). If \\(2^{k} \\geqslant n_{0}\\) then \\(f\\left(2^{k}\\right)\\) is coprime with \\(f(1)\\), so \\(f\\left(2^{k}\\right)\\) is a divisor of \\(2^{k}\\).\nClaim 2. There is a constant \\(C\\) such that \\(f(n)<n+C\\) for every \\(n\\).\nProof. Take the first power of 2 which is greater than or equal to \\(n_{0}\\) : let \\(K=2^{k} \\geqslant n_{0}\\). By Claim 1, we have \\(f(K) \\leqslant K\\). Notice that \\(f(n+K) \\mid f(n)+f(K)\\) implies \\(f(n+K) \\leqslant\\) \\(f(n)+f(K) \\leqslant f(n)+K\\). If \\(n=t K+r\\) for some \\(t \\geqslant 0\\) and \\(1 \\leqslant r \\leqslant K\\), then we conclude\n\\(f(n) \\leqslant K+f(n-K) \\leqslant 2 K+f(n-2 K) \\leqslant \\ldots \\leqslant t K+f(r)<n+\\max (f(1), f(2), \\ldots, f(K))\\),\nso the claim is true with \\(C=\\max (f(1), \\ldots, f(K))\\).\nClaim 3. If \\(a, b \\in \\mathbb{Z}_{>0}\\) are coprime then \\(\\operatorname{gcd}(f(a), f(b)) \\mid f(1)\\). In particular, if \\(a, b \\geqslant n_{0}\\) are coprime then \\(f(a)\\) and \\(f(b)\\) are coprime.\nProof. Let \\(d=\\operatorname{gcd}(f(a), f(b))\\). We can replicate Euclid's algorithm. Formally, apply induction on \\(a+b\\). If \\(a=1\\) or \\(b=1\\) then we already have \\(d \\mid f(1)\\).\n\nWithout loss of generality, suppose \\(1<a<b\\). Then \\(d \\mid f(a)\\) and \\(d|f(b)| f(a)+f(b-a)\\), so \\(d \\mid f(b-a)\\). Therefore \\(d\\) divides \\(\\operatorname{gcd}(f(a), f(b-a))\\) which is a divisor of \\(f(1)\\) by the induction hypothesis.\n\nLet \\(p_{1}<p_{2}<\\ldots\\) be the sequence of all prime numbers; for every \\(k\\), let \\(q_{k}\\) be the lowest power of \\(p_{k}\\) with \\(q_{k} \\geqslant n_{0}\\). (Notice that there are only finitely many positive integers with \\(q_{k} \\neq p_{k}\\).)\n\nTake a positive integer \\(N\\), and consider the numbers\n\n\\[\nf(1), f\\left(q_{1}\\right), f\\left(q_{2}\\right), \\ldots, f\\left(q_{N}\\right)\n\\]\n\nHere we have \\(N+1\\) numbers, each being greater than 1 , and they are pairwise coprime by Claim 3. Therefore, they have at least \\(N+1\\) different prime divisors in total, and their greatest prime divisor is at least \\(p_{N+1}\\). Hence, \\(\\max \\left(f(1), f\\left(q_{1}\\right), \\ldots, f\\left(q_{N}\\right)\\right) \\geqslant p_{N+1}\\).\n\nChoose \\(N\\) such that \\(\\max \\left(q_{1}, \\ldots, q_{N}\\right)=p_{N}\\) (this is achieved if \\(N\\) is sufficiently large), and \\(p_{N+1}-p_{N}>C\\) (that is possible, because there are arbitrarily long gaps between the primes). Then we establish a contradiction\n\n\\[\np_{N+1} \\leqslant \\max \\left(f(1), f\\left(q_{1}\\right), \\ldots, f\\left(q_{N}\\right)\\right)<\\max \\left(1+C, q_{1}+C, \\ldots, q_{N}+C\\right)=p_{N}+C<p_{N+1}\n\\]\n\nwhich proves the statement."}
{"id": "imo-shortlist-2018-n7", "question": "N7. Let \\(n \\geqslant 2018\\) be an integer, and let \\(a_{1}, a_{2}, \\ldots, a_{n}, b_{1}, b_{2}, \\ldots, b_{n}\\) be pairwise distinct positive integers not exceeding \\(5 n\\). Suppose that the sequence\n\n\\[\n\\frac{a_{1}}{b_{1}}, \\frac{a_{2}}{b_{2}}, \\ldots, \\frac{a_{n}}{b_{n}}\n\\]\n\nforms an arithmetic progression. Prove that the terms of the sequence are equal.\n(Thailand)", "category": "Number Theory", "source": "IMO Shortlist", "year": 2018, "solution": "Suppose that (1) is an arithmetic progression with nonzero difference. Let the difference be \\(\\Delta=\\frac{c}{d}\\), where \\(d>0\\) and \\(c, d\\) are coprime.\n\nWe will show that too many denominators \\(b_{i}\\) should be divisible by \\(d\\). To this end, for any \\(1 \\leqslant i \\leqslant n\\) and any prime divisor \\(p\\) of \\(d\\), say that the index \\(i\\) is \\(p\\)-wrong, if \\(v_{p}\\left(b_{i}\\right)<v_{p}(d)\\). \\(\\left(v_{p}(x)\\right.\\) stands for the exponent of \\(p\\) in the prime factorisation of \\(x\\).)\nClaim 1. For any prime \\(p\\), all \\(p\\)-wrong indices are congruent modulo \\(p\\). In other words, the \\(p\\)-wrong indices (if they exist) are included in an arithmetic progression with difference \\(p\\).\nProof. Let \\(\\alpha=v_{p}(d)\\). For the sake of contradiction, suppose that \\(i\\) and \\(j\\) are \\(p\\)-wrong indices (i.e., none of \\(b_{i}\\) and \\(b_{j}\\) is divisible by \\(p^{\\alpha}\\) ) such that \\(i \\not \\equiv j(\\bmod p)\\). Then the least common denominator of \\(\\frac{a_{i}}{b_{i}}\\) and \\(\\frac{a_{j}}{b_{j}}\\) is not divisible by \\(p^{\\alpha}\\). But this is impossible because in their difference, \\((i-j) \\Delta=\\frac{(i-j) c}{d}\\), the numerator is coprime to \\(p\\), but \\(p^{\\alpha}\\) divides the denominator \\(d\\).\n\nClaim 2. \\(d\\) has no prime divisors greater than 5.\nProof. Suppose that \\(p \\geqslant 7\\) is a prime divisor of \\(d\\). Among the indices \\(1,2, \\ldots, n\\), at most \\(\\left\\lceil\\frac{n}{p}\\right\\rceil<\\frac{n}{p}+1\\) are \\(p\\)-wrong, so \\(p\\) divides at least \\(\\frac{p-1}{p} n-1\\) of \\(b_{1}, \\ldots, b_{n}\\). Since these denominators are distinct,\n\n\\[\n5 n \\geqslant \\max \\left\\{b_{i}: p \\mid b_{i}\\right\\} \\geqslant\\left(\\frac{p-1}{p} n-1\\right) p=(p-1)(n-1)-1 \\geqslant 6(n-1)-1>5 n\n\\]\n\na contradiction.\nClaim 3. For every \\(0 \\leqslant k \\leqslant n-30\\), among the denominators \\(b_{k+1}, b_{k+2}, \\ldots, b_{k+30}\\), at least \\(\\varphi(30)=8\\) are divisible by \\(d\\).\nProof. By Claim 1, the 2 -wrong, 3 -wrong and 5 -wrong indices can be covered by three arithmetic progressions with differences 2,3 and 5 . By a simple inclusion-exclusion, \\((2-1) \\cdot(3-1) \\cdot(5-1)=8\\) indices are not covered; by Claim 2, we have \\(d \\mid b_{i}\\) for every uncovered index \\(i\\).\n\nClaim 4. \\(|\\Delta|<\\frac{20}{n-2}\\) and \\(d>\\frac{n-2}{20}\\).\nProof. From the sequence (1), remove all fractions with \\(b_{n}<\\frac{n}{2}\\), There remain at least \\(\\frac{n}{2}\\) fractions, and they cannot exceed \\(\\frac{5 n}{n / 2}=10\\). So we have at least \\(\\frac{n}{2}\\) elements of the arithmetic progression (1) in the interval ( 0,10 ], hence the difference must be below \\(\\frac{10}{n / 2-1}=\\frac{20}{n-2}\\).\n\nThe second inequality follows from \\(\\frac{1}{d} \\leqslant \\frac{|c|}{d}=|\\Delta|\\).\nNow we have everything to get the final contradiction. By Claim 3, we have \\(d \\mid b_{i}\\) for at least \\(\\left\\lfloor\\frac{n}{30}\\right\\rfloor \\cdot 8\\) indices \\(i\\). By Claim 4, we have \\(d \\geqslant \\frac{n-2}{20}\\). Therefore,\n\n\\[\n5 n \\geqslant \\max \\left\\{b_{i}: d \\mid b_{i}\\right\\} \\geqslant\\left(\\left\\lfloor\\frac{n}{30}\\right\\rfloor \\cdot 8\\right) \\cdot d>\\left(\\frac{n}{30}-1\\right) \\cdot 8 \\cdot \\frac{n-2}{20}>5 n .\n\\]\n\nComment 1. It is possible that all terms in (1) are equal, for example with \\(a_{i}=2 i-1\\) and \\(b_{i}=4 i-2\\) we have \\(\\frac{a_{i}}{b_{i}}=\\frac{1}{2}\\).\n\nComment 2. The bound \\(5 n\\) in the statement is far from sharp; the solution above can be modified to work for \\(9 n\\). For large \\(n\\), the bound \\(5 n\\) can be replaced by \\(n^{\\frac{3}{2}-\\varepsilon}\\).\n\nThe activities of the Problem Selection Committee were supported by\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_b62628dbd164bd27ffa8g-72}\nvine la tine"}
{"id": "imo-shortlist-2015-a1", "question": "A1. Suppose that a sequence \\(a_{1}, a_{2}, \\ldots\\) of positive real numbers satisfies\n\n\\[\na_{k+1} \\geqslant \\frac{k a_{k}}{a_{k}^{2}+(k-1)}\n\\]\n\nfor every positive integer \\(k\\). Prove that \\(a_{1}+a_{2}+\\cdots+a_{n} \\geqslant n\\) for every \\(n \\geqslant 2\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-a2", "question": "A2. Determine all functions \\(f: \\mathbb{Z} \\rightarrow \\mathbb{Z}\\) with the property that\n\n\\[\nf(x-f(y))=f(f(x))-f(y)-1\n\\]\n\nholds for all \\(x, y \\in \\mathbb{Z}\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-a3", "question": "A3. Let \\(n\\) be a fixed positive integer. Find the maximum possible value of\n\n\\[\n\\sum_{1 \\leqslant r<s \\leqslant 2 n}(s-r-n) x_{r} x_{s}\n\\]\n\nwhere \\(-1 \\leqslant x_{i} \\leqslant 1\\) for all \\(i=1,2, \\ldots, 2 n\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-a4", "question": "A4. Find all functions \\(f: \\mathbb{R} \\rightarrow \\mathbb{R}\\) satisfying the equation\n\n\\[\nf(x+f(x+y))+f(x y)=x+f(x+y)+y f(x)\n\\]\n\nfor all real numbers \\(x\\) and \\(y\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-a5", "question": "A5. Let \\(2 \\mathbb{Z}+1\\) denote the set of odd integers. Find all functions \\(f: \\mathbb{Z} \\rightarrow 2 \\mathbb{Z}+1\\) satisfying\n\n\\[\nf(x+f(x)+y)+f(x-f(x)-y)=f(x+y)+f(x-y)\n\\]\n\nfor every \\(x, y \\in \\mathbb{Z}\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-a6", "question": "A6. Let \\(n\\) be a fixed integer with \\(n \\geqslant 2\\). We say that two polynomials \\(P\\) and \\(Q\\) with real coefficients are block-similar if for each \\(i \\in\\{1,2, \\ldots, n\\}\\) the sequences\n\n\\[\n\\begin{array}{ll}\nP(2015 i), P(2015 i-1), \\ldots, P(2015 i-2014) & \\text { and } \nQ(2015 i), Q(2015 i-1), \\ldots, Q(2015 i-2014) &\n\n\\]\n\nare permutations of each other.\n(a) Prove that there exist distinct block-similar polynomials of degree \\(n+1\\).\n(b) Prove that there do not exist distinct block-similar polynomials of degree \\(n\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-c1", "question": "C1. In Lineland there are \\(n \\geqslant 1\\) towns, arranged along a road running from left to right. Each town has a left bulldozer (put to the left of the town and facing left) and a right bulldozer (put to the right of the town and facing right). The sizes of the \\(2 n\\) bulldozers are distinct. Every time when a right and a left bulldozer confront each other, the larger bulldozer pushes the smaller one off the road. On the other hand, the bulldozers are quite unprotected at their rears; so, if a bulldozer reaches the rear-end of another one, the first one pushes the second one off the road, regardless of their sizes.\n\nLet \\(A\\) and \\(B\\) be two towns, with \\(B\\) being to the right of \\(A\\). We say that town \\(A\\) can sweep town \\(B\\) away if the right bulldozer of \\(A\\) can move over to \\(B\\) pushing off all bulldozers it meets. Similarly, \\(B\\) can sweep \\(A\\) away if the left bulldozer of \\(B\\) can move to \\(A\\) pushing off all bulldozers of all towns on its way.\n\nProve that there is exactly one town which cannot be swept away by any other one.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-c2", "question": "C2. Let \\(\\mathcal{V}\\) be a finite set of points in the plane. We say that \\(\\mathcal{V}\\) is balanced if for any two distinct points \\(A, B \\in \\mathcal{V}\\), there exists a point \\(C \\in \\mathcal{V}\\) such that \\(A C=B C\\). We say that \\(\\mathcal{V}\\) is center-free if for any distinct points \\(A, B, C \\in \\mathcal{V}\\), there does not exist a point \\(P \\in \\mathcal{V}\\) such that \\(P A=P B=P C\\).\n(a) Show that for all \\(n \\geqslant 3\\), there exists a balanced set consisting of \\(n\\) points.\n(b) For which \\(n \\geqslant 3\\) does there exist a balanced, center-free set consisting of \\(n\\) points?", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-c3", "question": "C3. For a finite set \\(A\\) of positive integers, we call a partition of \\(A\\) into two disjoint nonempty subsets \\(A_{1}\\) and \\(A_{2}\\) good if the least common multiple of the elements in \\(A_{1}\\) is equal to the greatest common divisor of the elements in \\(A_{2}\\). Determine the minimum value of \\(n\\) such that there exists a set of \\(n\\) positive integers with exactly 2015 good partitions.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-c4", "question": "C4. Let \\(n\\) be a positive integer. Two players \\(A\\) and \\(B\\) play a game in which they take turns choosing positive integers \\(k \\leqslant n\\). The rules of the game are:\n(i) A player cannot choose a number that has been chosen by either player on any previous turn.\n(ii) A player cannot choose a number consecutive to any of those the player has already chosen on any previous turn.\n(iii) The game is a draw if all numbers have been chosen; otherwise the player who cannot choose a number anymore loses the game.\n\nThe player \\(A\\) takes the first turn. Determine the outcome of the game, assuming that both players use optimal strategies.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-c5", "question": "C5. Consider an infinite sequence \\(a_{1}, a_{2}, \\ldots\\) of positive integers with \\(a_{i} \\leqslant 2015\\) for all \\(i \\geqslant 1\\). Suppose that for any two distinct indices \\(i\\) and \\(j\\) we have \\(i+a_{i} \\neq j+a_{j}\\).\n\nProve that there exist two positive integers \\(b\\) and \\(N\\) such that\n\n\\[\n\\left|\\sum_{i=m+1}^{n}\\left(a_{i}-b\\right)\\right| \\leqslant 1007^{2}\n\\]\n\nwhenever \\(n>m \\geqslant N\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-c6", "question": "C6. Let \\(S\\) be a nonempty set of positive integers. We say that a positive integer \\(n\\) is clean if it has a unique representation as a sum of an odd number of distinct elements from \\(S\\). Prove that there exist infinitely many positive integers that are not clean.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-c7", "question": "C7. In a company of people some pairs are enemies. A group of people is called unsociable if the number of members in the group is odd and at least 3 , and it is possible to arrange all its members around a round table so that every two neighbors are enemies. Given that there are at most 2015 unsociable groups, prove that it is possible to partition the company into 11 parts so that no two enemies are in the same part.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-g1", "question": "G1. Let \\(A B C\\) be an acute triangle with orthocenter \\(H\\). Let \\(G\\) be the point such that the quadrilateral \\(A B G H\\) is a parallelogram. Let \\(I\\) be the point on the line \\(G H\\) such that \\(A C\\) bisects \\(H I\\). Suppose that the line \\(A C\\) intersects the circumcircle of the triangle \\(G C I\\) at \\(C\\) and \\(J\\). Prove that \\(I J=A H\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-g2", "question": "G2. Let \\(A B C\\) be a triangle inscribed into a circle \\(\\Omega\\) with center \\(O\\). A circle \\(\\Gamma\\) with center \\(A\\) meets the side \\(B C\\) at points \\(D\\) and \\(E\\) such that \\(D\\) lies between \\(B\\) and \\(E\\). Moreover, let \\(F\\) and \\(G\\) be the common points of \\(\\Gamma\\) and \\(\\Omega\\). We assume that \\(F\\) lies on the arc \\(A B\\) of \\(\\Omega\\) not containing \\(C\\), and \\(G\\) lies on the arc \\(A C\\) of \\(\\Omega\\) not containing \\(B\\). The circumcircles of the triangles \\(B D F\\) and \\(C E G\\) meet the sides \\(A B\\) and \\(A C\\) again at \\(K\\) and \\(L\\), respectively. Suppose that the lines \\(F K\\) and \\(G L\\) are distinct and intersect at \\(X\\). Prove that the points \\(A, X\\), and \\(O\\) are collinear.", "category": "Geometry", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-g3", "question": "G3. Let \\(A B C\\) be a triangle with \\(\\angle C=90^{\\circ}\\), and let \\(H\\) be the foot of the altitude from \\(C\\). A point \\(D\\) is chosen inside the triangle \\(C B H\\) so that \\(C H\\) bisects \\(A D\\). Let \\(P\\) be the intersection point of the lines \\(B D\\) and \\(C H\\). Let \\(\\omega\\) be the semicircle with diameter \\(B D\\) that meets the segment \\(C B\\) at an interior point. A line through \\(P\\) is tangent to \\(\\omega\\) at \\(Q\\). Prove that the lines \\(C Q\\) and \\(A D\\) meet on \\(\\omega\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-g4", "question": "G4. Let \\(A B C\\) be an acute triangle, and let \\(M\\) be the midpoint of \\(A C\\). A circle \\(\\omega\\) passing through \\(B\\) and \\(M\\) meets the sides \\(A B\\) and \\(B C\\) again at \\(P\\) and \\(Q\\), respectively. Let \\(T\\) be the point such that the quadrilateral \\(B P T Q\\) is a parallelogram. Suppose that \\(T\\) lies on the circumcircle of the triangle \\(A B C\\). Determine all possible values of \\(B T / B M\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-g5", "question": "G5. Let \\(A B C\\) be a triangle with \\(C A \\neq C B\\). Let \\(D, F\\), and \\(G\\) be the midpoints of the sides \\(A B, A C\\), and \\(B C\\), respectively. A circle \\(\\Gamma\\) passing through \\(C\\) and tangent to \\(A B\\) at \\(D\\) meets the segments \\(A F\\) and \\(B G\\) at \\(H\\) and \\(I\\), respectively. The points \\(H^{\\prime}\\) and \\(I^{\\prime}\\) are symmetric to \\(H\\) and \\(I\\) about \\(F\\) and \\(G\\), respectively. The line \\(H^{\\prime} I^{\\prime}\\) meets \\(C D\\) and \\(F G\\) at \\(Q\\) and \\(M\\), respectively. The line \\(C M\\) meets \\(\\Gamma\\) again at \\(P\\). Prove that \\(C Q=Q P\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-g6", "question": "G6. Let \\(A B C\\) be an acute triangle with \\(A B>A C\\), and let \\(\\Gamma\\) be its circumcircle. Let \\(H\\), \\(M\\), and \\(F\\) be the orthocenter of the triangle, the midpoint of \\(B C\\), and the foot of the altitude from \\(A\\), respectively. Let \\(Q\\) and \\(K\\) be the two points on \\(\\Gamma\\) that satisfy \\(\\angle A Q H=90^{\\circ}\\) and \\(\\angle Q K H=90^{\\circ}\\). Prove that the circumcircles of the triangles \\(K Q H\\) and \\(K F M\\) are tangent to each other.", "category": "Geometry", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-g7", "question": "G7. Let \\(A B C D\\) be a convex quadrilateral, and let \\(P, Q, R\\), and \\(S\\) be points on the sides \\(A B, B C, C D\\), and \\(D A\\), respectively. Let the line segments \\(P R\\) and \\(Q S\\) meet at \\(O\\). Suppose that each of the quadrilaterals \\(A P O S, B Q O P, C R O Q\\), and \\(D S O R\\) has an incircle. Prove that the lines \\(A C, P Q\\), and \\(R S\\) are either concurrent or parallel to each other.", "category": "Geometry", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-g8", "question": "G8. A triangulation of a convex polygon \\(\\Pi\\) is a partitioning of \\(\\Pi\\) into triangles by diagonals having no common points other than the vertices of the polygon. We say that a triangulation is a Thaiangulation if all triangles in it have the same area.\n\nProve that any two different Thaiangulations of a convex polygon \\(\\Pi\\) differ by exactly two triangles. (In other words, prove that it is possible to replace one pair of triangles in the first Thaiangulation with a different pair of triangles so as to obtain the second Thaiangulation.)", "category": "Geometry", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-n1", "question": "N1. Determine all positive integers \\(M\\) for which the sequence \\(a_{0}, a_{1}, a_{2}, \\ldots\\), defined by \\(a_{0}=\\frac{2 M+1}{2}\\) and \\(a_{k+1}=a_{k}\\left\\lfloor a_{k}\\right\\rfloor\\) for \\(k=0,1,2, \\ldots\\), contains at least one integer term.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-n2", "question": "N2. Let \\(a\\) and \\(b\\) be positive integers such that \\(a!b!\\) is a multiple of \\(a!+b!\\). Prove that \\(3 a \\geqslant 2 b+2\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-n3", "question": "N3. Let \\(m\\) and \\(n\\) be positive integers such that \\(m>n\\). Define \\(x_{k}=(m+k) /(n+k)\\) for \\(k=\\) \\(1,2, \\ldots, n+1\\). Prove that if all the numbers \\(x_{1}, x_{2}, \\ldots, x_{n+1}\\) are integers, then \\(x_{1} x_{2} \\cdots x_{n+1}-1\\) is divisible by an odd prime.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-n4", "question": "N4. Suppose that \\(a_{0}, a_{1}, \\ldots\\) and \\(b_{0}, b_{1}, \\ldots\\) are two sequences of positive integers satisfying \\(a_{0}, b_{0} \\geqslant 2\\) and\n\n\\[\na_{n+1}=\\operatorname{gcd}\\left(a_{n}, b_{n}\\right)+1, \\quad b_{n+1}=\\operatorname{lcm}\\left(a_{n}, b_{n}\\right)-1\n\\]\n\nfor all \\(n \\geqslant 0\\). Prove that the sequence ( \\(a_{n}\\) ) is eventually periodic; in other words, there exist integers \\(N \\geqslant 0\\) and \\(t>0\\) such that \\(a_{n+t}=a_{n}\\) for all \\(n \\geqslant N\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-n5", "question": "N5. Determine all triples \\((a, b, c)\\) of positive integers for which \\(a b-c, b c-a\\), and \\(c a-b\\) are powers of 2 .\n\nExplanation: A power of 2 is an integer of the form \\(2^{n}\\), where \\(n\\) denotes some nonnegative integer.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-n6", "question": "N6. Let \\(\\mathbb{Z}_{>0}\\) denote the set of positive integers. Consider a function \\(f: \\mathbb{Z}_{>0} \\rightarrow \\mathbb{Z}_{>0}\\). For any \\(m, n \\in \\mathbb{Z}_{>0}\\) we write \\(f^{n}(m)=\\underbrace{f(f(\\ldots f}_{n}(m) \\ldots)\\) ). Suppose that \\(f\\) has the following two properties:\n(i) If \\(m, n \\in \\mathbb{Z}_{>0}\\), then \\(\\frac{f^{n}(m)-m}{n} \\in \\mathbb{Z}_{>0}\\);\n(ii) The set \\(\\mathbb{Z}_{>0} \\backslash\\left\\{f(n) \\mid n \\in \\mathbb{Z}_{>0}\\right\\}\\) is finite.\n\nProve that the sequence \\(f(1)-1, f(2)-2, f(3)-3, \\ldots\\) is periodic.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-n7", "question": "N7. Let \\(\\mathbb{Z}_{>0}\\) denote the set of positive integers. For any positive integer \\(k\\), a function \\(f: \\mathbb{Z}_{>0} \\rightarrow \\mathbb{Z}_{>0}\\) is called \\(k\\)-good if \\(\\operatorname{gcd}(f(m)+n, f(n)+m) \\leqslant k\\) for all \\(m \\neq n\\). Find all \\(k\\) such that there exists a \\(k\\)-good function.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-n8", "question": "N8. For every positive integer \\(n\\) with prime factorization \\(n=\\prod_{i=1}^{k} p_{i}^{\\alpha_{i}}\\), define\n\n\\[\n\\mho(n)=\\sum_{i: p_{i}>10^{100}} \\alpha_{i}\n\\]\n\nThat is, \\(\\mho(n)\\) is the number of prime factors of \\(n\\) greater than \\(10^{100}\\), counted with multiplicity.\nFind all strictly increasing functions \\(f: \\mathbb{Z} \\rightarrow \\mathbb{Z}\\) such that\n\n\\[\n\\mho(f(a)-f(b)) \\leqslant \\mho(a-b) \\quad \\text { for all integers } a \\text { and } b \\text { with } a>b .\n\\]", "category": "Number Theory", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-a1", "question": "A1. Suppose that a sequence \\(a_{1}, a_{2}, \\ldots\\) of positive real numbers satisfies\n\n\\[\na_{k+1} \\geqslant \\frac{k a_{k}}{a_{k}^{2}+(k-1)}\n\\]\n\nfor every positive integer \\(k\\). Prove that \\(a_{1}+a_{2}+\\cdots+a_{n} \\geqslant n\\) for every \\(n \\geqslant 2\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2015, "solution": "From the constraint (1), it can be seen that\n\n\\[\n\\frac{k}{a_{k+1}} \\leqslant \\frac{a_{k}^{2}+(k-1)}{a_{k}}=a_{k}+\\frac{k-1}{a_{k}},\n\\]\n\nand so\n\n\\[\na_{k} \\geqslant \\frac{k}{a_{k+1}}-\\frac{k-1}{a_{k}} .\n\\]\n\nSumming up the above inequality for \\(k=1, \\ldots, m\\), we obtain\n\n\\[\na_{1}+a_{2}+\\cdots+a_{m} \\geqslant\\left(\\frac{1}{a_{2}}-\\frac{0}{a_{1}}\\right)+\\left(\\frac{2}{a_{3}}-\\frac{1}{a_{2}}\\right)+\\cdots+\\left(\\frac{m}{a_{m+1}}-\\frac{m-1}{a_{m}}\\right)=\\frac{m}{a_{m+1}} .\n\\]\n\nNow we prove the problem statement by induction on \\(n\\). The case \\(n=2\\) can be done by applying (1) to \\(k=1\\) :\n\n\\[\na_{1}+a_{2} \\geqslant a_{1}+\\frac{1}{a_{1}} \\geqslant 2 .\n\\]\n\nFor the induction step, assume that the statement is true for some \\(n \\geqslant 2\\). If \\(a_{n+1} \\geqslant 1\\), then the induction hypothesis yields\n\n\\[\n\\left(a_{1}+\\cdots+a_{n}\\right)+a_{n+1} \\geqslant n+1 .\n\\]\n\nOtherwise, if \\(a_{n+1}<1\\) then apply (2) as\n\n\\[\n\\left(a_{1}+\\cdots+a_{n}\\right)+a_{n+1} \\geqslant \\frac{n}{a_{n+1}}+a_{n+1}=\\frac{n-1}{a_{n+1}}+\\left(\\frac{1}{a_{n+1}}+a_{n+1}\\right)>(n-1)+2 .\n\\]\n\nThat completes the solution.\n\nComment 1. It can be seen easily that having equality in the statement requires \\(a_{1}=a_{2}=1\\) in the base case \\(n=2\\), and \\(a_{n+1}=1\\) in (3). So the equality \\(a_{1}+\\cdots+a_{n}=n\\) is possible only in the trivial case \\(a_{1}=\\cdots=a_{n}=1\\).\n\nComment 2. After obtaining (2), there are many ways to complete the solution. We outline three such possibilities.\n\n\\begin{itemize}\n  \\item With defining \\(s_{n}=a_{1}+\\cdots+a_{n}\\), the induction step can be replaced by\n\n\n\\[\ns_{n+1}=s_{n}+a_{n+1} \\geqslant s_{n}+\\frac{n}{s_{n}} \\geqslant n+1,\n\\]\n\nbecause the function \\(x \\mapsto x+\\frac{n}{x}\\) increases on \\([n, \\infty)\\).\n\n\\begin{itemize}\n  \\item By applying the AM-GM inequality to the numbers \\(a_{1}+\\cdots+a_{k}\\) and \\(k a_{k+1}\\), we can conclude\n\n\n\\[\na_{1}+\\cdots+a_{k}+k a_{k+1} \\geqslant 2 k\n\\]\n\nand sum it up for \\(k=1, \\ldots, n-1\\).\n\n\\begin{itemize}\n  \\item We can derive the symmetric estimate\n\n\n\\[\n\\sum_{1 \\leqslant i<j \\leqslant n} a_{i} a_{j}=\\sum_{j=2}^{n}\\left(a_{1}+\\cdots+a_{j-1}\\right) a_{j} \\geqslant \\sum_{j=2}^{n}(j-1)=\\frac{n(n-1)}{2}\n\\]\n\nand combine it with the AM-QM inequality."}
{"id": "imo-shortlist-2015-a2", "question": "A2. Determine all functions \\(f: \\mathbb{Z} \\rightarrow \\mathbb{Z}\\) with the property that\n\n\\[\nf(x-f(y))=f(f(x))-f(y)-1\n\\]\n\nholds for all \\(x, y \\in \\mathbb{Z}\\).\n\nAnswer. There are two such functions, namely the constant function \\(x \\mapsto-1\\) and the successor function \\(x \\mapsto x+1\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2015, "solution": "It is immediately checked that both functions mentioned in the answer are as desired.\n\nNow let \\(f\\) denote any function satisfying (1) for all \\(x, y \\in \\mathbb{Z}\\). Substituting \\(x=0\\) and \\(y=f(0)\\) into (1) we learn that the number \\(z=-f(f(0))\\) satisfies \\(f(z)=-1\\). So by plugging \\(y=z\\) into (1) we deduce that\n\n\\[\nf(x+1)=f(f(x))\n\\]\n\nholds for all \\(x \\in \\mathbb{Z}\\). Thereby (1) simplifies to\n\n\\[\nf(x-f(y))=f(x+1)-f(y)-1\n\\]\n\nWe now work towards showing that \\(f\\) is linear by contemplating the difference \\(f(x+1)-f(x)\\) for any \\(x \\in \\mathbb{Z}\\). By applying (3) with \\(y=x\\) and (2) in this order, we obtain\n\n\\[\nf(x+1)-f(x)=f(x-f(x))+1=f(f(x-1-f(x)))+1\n\\]\n\nSince (3) shows \\(f(x-1-f(x))=f(x)-f(x)-1=-1\\), this simplifies to\n\n\\[\nf(x+1)=f(x)+A\n\\]\n\nwhere \\(A=f(-1)+1\\) is some absolute constant.\nNow a standard induction in both directions reveals that \\(f\\) is indeed linear and that in fact we have \\(f(x)=A x+B\\) for all \\(x \\in \\mathbb{Z}\\), where \\(B=f(0)\\). Substituting this into (2) we obtain that\n\n\\[\nA x+(A+B)=A^{2} x+(A B+B)\n\\]\n\nholds for all \\(x \\in \\mathbb{Z}\\); applying this to \\(x=0\\) and \\(x=1\\) we infer \\(A+B=A B+B\\) and \\(A^{2}=A\\). The second equation leads to \\(A=0\\) or \\(A=1\\). In case \\(A=1\\), the first equation gives \\(B=1\\), meaning that \\(f\\) has to be the successor function. If \\(A=0\\), then \\(f\\) is constant and (1) shows that its constant value has to be -1 . Thereby the solution is complete.\n\nComment. After (2) and (3) have been obtained, there are several other ways to combine them so as to obtain linearity properties of \\(f\\). For instance, using (2) thrice in a row and then (3) with \\(x=f(y)\\) one may deduce that\n\n\\[\nf(y+2)=f(f(y+1))=f(f(f(y)))=f(f(y)+1)=f(y)+f(0)+1\n\\]\n\nholds for all \\(y \\in \\mathbb{Z}\\). It follows that \\(f\\) behaves linearly on the even numbers and on the odd numbers separately, and moreover that the slopes of these two linear functions coincide. From this point, one may complete the solution with some straightforward case analysis.\n\nA different approach using the equations (2) and (3) will be presented in Solution 2. To show that it is also possible to start in a completely different way, we will also present a third solution that avoids these equations entirely.\n\nSolution 2. We commence by deriving (2) and (3) as in the first solution. Now provided that \\(f\\) is injective, (2) tells us that \\(f\\) is the successor function. Thus we may assume from now on that \\(f\\) is not injective, i.e., that there are two integers \\(a>b\\) with \\(f(a)=f(b)\\). A straightforward induction using (2) in the induction step reveals that we have \\(f(a+n)=f(b+n)\\) for all nonnegative integers \\(n\\). Consequently, the sequence \\(\\gamma_{n}=f(b+n)\\) is periodic and thus in particular bounded, which means that the numbers\n\n\\[\n\\varphi=\\min _{n \\geqslant 0} \\gamma_{n} \\quad \\text { and } \\quad \\psi=\\max _{n \\geqslant 0} \\gamma_{n}\n\\]\n\nexist.\nLet us pick any integer \\(y\\) with \\(f(y)=\\varphi\\) and then an integer \\(x \\geqslant a\\) with \\(f(x-f(y))=\\varphi\\). Due to the definition of \\(\\varphi\\) and (3) we have\n\n\\[\n\\varphi \\leqslant f(x+1)=f(x-f(y))+f(y)+1=2 \\varphi+1\n\\]\n\nwhence \\(\\varphi \\geqslant-1\\). The same reasoning applied to \\(\\psi\\) yields \\(\\psi \\leqslant-1\\). Since \\(\\varphi \\leqslant \\psi\\) holds trivially, it follows that \\(\\varphi=\\psi=-1\\), or in other words that we have \\(f(t)=-1\\) for all integers \\(t \\geqslant a\\).\n\nFinally, if any integer \\(y\\) is given, we may find an integer \\(x\\) which is so large that \\(x+1 \\geqslant a\\) and \\(x-f(y) \\geqslant a\\) hold. Due to (3) and the result from the previous paragraph we get\n\n\\[\nf(y)=f(x+1)-f(x-f(y))-1=(-1)-(-1)-1=-1\n\\]\n\nThereby the problem is solved.\nSolution 3. Set \\(d=f(0)\\). By plugging \\(x=f(y)\\) into (1) we obtain\n\n\\[\nf^{3}(y)=f(y)+d+1\n\\]\n\nfor all \\(y \\in \\mathbb{Z}\\), where the left-hand side abbreviates \\(f(f(f(y)))\\). When we replace \\(x\\) in (1) by \\(f(x)\\) we obtain \\(f(f(x)-f(y))=f^{3}(x)-f(y)-1\\) and as a consequence of (4) this simplifies to\n\n\\[\nf(f(x)-f(y))=f(x)-f(y)+d\n\\]\n\nNow we consider the set\n\n\\[\nE=\\{f(x)-d \\mid x \\in \\mathbb{Z}\\}\n\\]\n\nGiven two integers \\(a\\) and \\(b\\) from \\(E\\), we may pick some integers \\(x\\) and \\(y\\) with \\(f(x)=a+d\\) and \\(f(y)=b+d\\); now (5) tells us that \\(f(a-b)=(a-b)+d\\), which means that \\(a-b\\) itself exemplifies \\(a-b \\in E\\). Thus,\n\n\\[\nE \\text { is closed under taking differences. }\n\\]\n\nAlso, the definitions of \\(d\\) and \\(E\\) yield \\(0 \\in E\\). If \\(E=\\{0\\}\\), then \\(f\\) is a constant function and (1) implies that the only value attained by \\(f\\) is indeed -1 .\n\nSo let us henceforth suppose that \\(E\\) contains some number besides zero. It is known that in this case (6) entails \\(E\\) to be the set of all integer multiples of some positive integer \\(k\\). Indeed, this holds for\n\n\\[\nk=\\min \\{|x| \\mid x \\in E \\text { and } x \\neq 0\\}\n\\]\n\nas one may verify by an argument based on division with remainder.\nThus we have\n\n\\[\n\\{f(x) \\mid x \\in \\mathbb{Z}\\}=\\{k \\cdot t+d \\mid t \\in \\mathbb{Z}\\} .\n\\]\n\nDue to (5) and (7) we get\n\n\\[\nf(k \\cdot t)=k \\cdot t+d\n\\]\n\nfor all \\(t \\in \\mathbb{Z}\\), whence in particular \\(f(k)=k+d\\). So by comparing the results of substituting \\(y=0\\) and \\(y=k\\) into (1) we learn that\n\n\\[\nf(z+k)=f(z)+k\n\\]\n\nholds for all integers \\(z\\). In plain English, this means that on any residue class modulo \\(k\\) the function \\(f\\) is linear with slope 1 .\n\nNow by (7) the set of all values attained by \\(f\\) is such a residue class. Hence, there exists an absolute constant \\(c\\) such that \\(f(f(x))=f(x)+c\\) holds for all \\(x \\in \\mathbb{Z}\\). Thereby (1) simplifies to\n\n\\[\nf(x-f(y))=f(x)-f(y)+c-1\n\\]\n\nOn the other hand, considering (1) modulo \\(k\\) we obtain \\(d \\equiv-1(\\bmod k)\\) because of (7). So by (7) again, \\(f\\) attains the value -1 .\n\nThus we may apply (9) to some integer \\(y\\) with \\(f(y)=-1\\), which gives \\(f(x+1)=f(x)+c\\). So \\(f\\) is a linear function with slope \\(c\\). Hence, (8) leads to \\(c=1\\), wherefore there is an absolute constant \\(d^{\\prime}\\) with \\(f(x)=x+d^{\\prime}\\) for all \\(x \\in \\mathbb{Z}\\). Using this for \\(x=0\\) we obtain \\(d^{\\prime}=d\\) and finally (4) discloses \\(d=1\\), meaning that \\(f\\) is indeed the successor function."}
{"id": "imo-shortlist-2015-a3", "question": "A3. Let \\(n\\) be a fixed positive integer. Find the maximum possible value of\n\n\\[\n\\sum_{1 \\leqslant r<s \\leqslant 2 n}(s-r-n) x_{r} x_{s}\n\\]\n\nwhere \\(-1 \\leqslant x_{i} \\leqslant 1\\) for all \\(i=1,2, \\ldots, 2 n\\).\nAnswer. \\(n(n-1)\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2015, "solution": "Let \\(Z\\) be the expression to be maximized. Since this expression is linear in every variable \\(x_{i}\\) and \\(-1 \\leqslant x_{i} \\leqslant 1\\), the maximum of \\(Z\\) will be achieved when \\(x_{i}=-1\\) or 1 . Therefore, it suffices to consider only the case when \\(x_{i} \\in\\{-1,1\\}\\) for all \\(i=1,2, \\ldots, 2 n\\).\n\nFor \\(i=1,2, \\ldots, 2 n\\), we introduce auxiliary variables\n\n\\[\ny_{i}=\\sum_{r=1}^{i} x_{r}-\\sum_{r=i+1}^{2 n} x_{r}\n\\]\n\nTaking squares of both sides, we have\n\n\\[\n\\begin{aligned}\ny_{i}^{2} & =\\sum_{r=1}^{2 n} x_{r}^{2}+\\sum_{r<s \\leqslant i} 2 x_{r} x_{s}+\\sum_{i<r<s} 2 x_{r} x_{s}-\\sum_{r \\leqslant i<s} 2 x_{r} x_{s} \n& =2 n+\\sum_{r<s \\leqslant i} 2 x_{r} x_{s}+\\sum_{i<r<s} 2 x_{r} x_{s}-\\sum_{r \\leqslant i<s} 2 x_{r} x_{s}\n\n\\]\n\nwhere the last equality follows from the fact that \\(x_{r} \\in\\{-1,1\\}\\). Notice that for every \\(r<s\\), the coefficient of \\(x_{r} x_{s}\\) in (1) is 2 for each \\(i=1, \\ldots, r-1, s, \\ldots, 2 n\\), and this coefficient is -2 for each \\(i=r, \\ldots, s-1\\). This implies that the coefficient of \\(x_{r} x_{s}\\) in \\(\\sum_{i=1}^{2 n} y_{i}^{2}\\) is \\(2(2 n-s+r)-2(s-r)=\\) \\(4(n-s+r)\\). Therefore, summing (1) for \\(i=1,2, \\ldots, 2 n\\) yields\n\n\\[\n\\sum_{i=1}^{2 n} y_{i}^{2}=4 n^{2}+\\sum_{1 \\leqslant r<s \\leqslant 2 n} 4(n-s+r) x_{r} x_{s}=4 n^{2}-4 Z\n\\]\n\nHence, it suffices to find the minimum of the left-hand side.\nSince \\(x_{r} \\in\\{-1,1\\}\\), we see that \\(y_{i}\\) is an even integer. In addition, \\(y_{i}-y_{i-1}=2 x_{i}= \\pm 2\\), and so \\(y_{i-1}\\) and \\(y_{i}\\) are consecutive even integers for every \\(i=2,3, \\ldots, 2 n\\). It follows that \\(y_{i-1}^{2}+y_{i}^{2} \\geqslant 4\\), which implies\n\n\\[\n\\sum_{i=1}^{2 n} y_{i}^{2}=\\sum_{j=1}^{n}\\left(y_{2 j-1}^{2}+y_{2 j}^{2}\\right) \\geqslant 4 n\n\\]\n\nCombining (2) and (3), we get\n\n\\[\n4 n \\leqslant \\sum_{i=1}^{2 n} y_{i}^{2}=4 n^{2}-4 Z\n\\]\n\nHence, \\(Z \\leqslant n(n-1)\\).\nIf we set \\(x_{i}=1\\) for odd indices \\(i\\) and \\(x_{i}=-1\\) for even indices \\(i\\), then we obtain equality in (3) (and thus in (4)). Therefore, the maximum possible value of \\(Z\\) is \\(n(n-1)\\), as desired.\n\nComment 1. \\(Z=n(n-1)\\) can be achieved by several other examples. In particular, \\(x_{i}\\) needs not be \\(\\pm 1\\). For instance, setting \\(x_{i}=(-1)^{i}\\) for all \\(2 \\leqslant i \\leqslant 2 n\\), we find that the coefficient of \\(x_{1}\\) in \\(Z\\) is 0 . Therefore, \\(x_{1}\\) can be chosen arbitrarily in the interval \\([-1,1]\\).\n\nNevertheless, if \\(x_{i} \\in\\{-1,1\\}\\) for all \\(i=1,2, \\ldots, 2 n\\), then the equality \\(Z=n(n-1)\\) holds only when \\(\\left(y_{1}, y_{2}, \\ldots, y_{2 n}\\right)=(0, \\pm 2,0, \\pm 2, \\ldots, 0, \\pm 2)\\) or \\(( \\pm 2,0, \\pm 2,0, \\ldots, \\pm 2,0)\\). In each case, we can reconstruct \\(x_{i}\\) accordingly. The sum \\(\\sum_{i=1}^{2 n} x_{i}\\) in the optimal cases needs not be 0 , but it must equal 0 or \\(\\pm 2\\).\n\nComment 2. Several variations in setting up the auxiliary variables are possible. For instance, one may let \\(x_{2 n+i}=-x_{i}\\) and \\(y_{i}^{\\prime}=x_{i}+x_{i+1}+\\cdots+x_{i+n-1}\\) for any \\(1 \\leqslant i \\leqslant 2 n\\). Similarly to Solution 1 , we obtain \\(Y:=y_{1}^{\\prime 2}+y_{2}^{\\prime 2}+\\cdots+y_{2 n}^{\\prime 2}=2 n^{2}-2 Z\\). Then, it suffices to show that \\(Y \\geqslant 2 n\\). If \\(n\\) is odd, then each \\(y_{i}^{\\prime}\\) is odd, and so \\(y_{i}^{\\prime 2} \\geqslant 1\\). If \\(n\\) is even, then each \\(y_{i}^{\\prime}\\) is even. We can check that at least one of \\(y_{i}^{\\prime}, y_{i+1}^{\\prime}, y_{n+i}^{\\prime}\\), and \\(y_{n+i+1}^{\\prime}\\) is nonzero, so that \\(y_{i}^{\\prime 2}+y_{i+1}^{\\prime 2}+y_{n+i}^{\\prime 2}+y_{n+i+1}^{\\prime 2} \\geqslant 4\\); summing these up for \\(i=1,3, \\ldots, n-1\\) yields \\(Y \\geqslant 2 n\\).\n\nSolution 2. We present a different method of obtaining the bound \\(Z \\leqslant n(n-1)\\). As in the previous solution, we reduce the problem to the case \\(x_{i} \\in\\{-1,1\\}\\). For brevity, we use the notation \\([2 n]=\\{1,2, \\ldots, 2 n\\}\\).\n\nConsider any \\(x_{1}, x_{2}, \\ldots, x_{2 n} \\in\\{-1,1\\}\\). Let\n\n\\[\nA=\\left\\{i \\in[2 n]: x_{i}=1\\right\\} \\quad \\text { and } \\quad B=\\left\\{i \\in[2 n]: x_{i}=-1\\right\\}\n\\]\n\nFor any subsets \\(X\\) and \\(Y\\) of [2n] we define\n\n\\[\ne(X, Y)=\\sum_{r<s, r \\in X, s \\in Y}(s-r-n)\n\\]\n\nOne may observe that\n\n\\[\ne(A, A)+e(A, B)+e(B, A)+e(B, B)=e([2 n],[2 n])=\\sum_{1 \\leqslant r<s \\leqslant 2 n}(s-r-n)=-\\frac{(n-1) n(2 n-1)}{3}\n\\]\n\nTherefore, we have\n\n\\[\nZ=e(A, A)-e(A, B)-e(B, A)+e(B, B)=2(e(A, A)+e(B, B))+\\frac{(n-1) n(2 n-1)}{3}\n\\]\n\nThus, we need to maximize \\(e(A, A)+e(B, B)\\), where \\(A\\) and \\(B\\) form a partition of [2n].\nDue to the symmetry, we may assume that \\(|A|=n-p\\) and \\(|B|=n+p\\), where \\(0 \\leqslant p \\leqslant n\\). From now on, we fix the value of \\(p\\) and find an upper bound for \\(Z\\) in terms of \\(n\\) and \\(p\\).\n\nLet \\(a_{1}<a_{2}<\\cdots<a_{n-p}\\) and \\(b_{1}<b_{2}<\\cdots<b_{n+p}\\) list all elements of \\(A\\) and \\(B\\), respectively. Then\n\n\\[\ne(A, A)=\\sum_{1 \\leqslant i<j \\leqslant n-p}\\left(a_{j}-a_{i}-n\\right)=\\sum_{i=1}^{n-p}(2 i-1-n+p) a_{i}-\\binom{n-p}{2} \\cdot n\n\\]\n\nand similarly\n\n\\[\ne(B, B)=\\sum_{i=1}^{n+p}(2 i-1-n-p) b_{i}-\\binom{n+p}{2} \\cdot n\n\\]\n\nThus, now it suffices to maximize the value of\n\n\\[\nM=\\sum_{i=1}^{n-p}(2 i-1-n+p) a_{i}+\\sum_{i=1}^{n+p}(2 i-1-n-p) b_{i}\n\\]\n\nIn order to get an upper bound, we will apply the rearrangement inequality to the sequence \\(a_{1}, a_{2}, \\ldots, a_{n-p}, b_{1}, b_{2}, \\ldots, b_{n+p}\\) (which is a permutation of \\(1,2, \\ldots, 2 n\\) ), together with the sequence of coefficients of these numbers in (8). The coefficients of \\(a_{i}\\) form the sequence\n\n\\[\nn-p-1, n-p-3, \\ldots, 1-n+p\n\\]\n\nand those of \\(b_{i}\\) form the sequence\n\n\\[\nn+p-1, n+p-3, \\ldots, 1-n-p\n\\]\n\nAltogether, these coefficients are, in descending order:\n\n\\begin{itemize}\n  \\item \\(n+p+1-2 i\\), for \\(i=1,2, \\ldots, p\\);\n  \\item \\(n-p+1-2 i\\), counted twice, for \\(i=1,2, \\ldots, n-p\\); and\n  \\item \\(-(n+p+1-2 i)\\), for \\(i=p, p-1, \\ldots, 1\\).\n\n\nThus, the rearrangement inequality yields\n\n\\[\n\\begin{aligned}\nM \\leqslant \\sum_{i=1}^{p}(n+p+1-2 i)(2 n+1-i) & \n& \\quad+\\sum_{i=1}^{n-p}(n-p+1-2 i)((2 n+2-p-2 i)+(2 n+1-p-2 i)) \n& \\quad-\\sum_{i=1}^{p}(n+p+1-2 i) i\n\n\\]\n\nFinally, combining the information from (5), (6), (7), and (9), we obtain\n\n\\[\n\\begin{aligned}\nZ \\leqslant & \\frac{(n-1) n(2 n-1)}{3}-2 n\\left(\\binom{n-p}{2}+\\binom{n+p}{2}\\right) \n& +2 \\sum_{i=1}^{p}(n+p+1-2 i)(2 n+1-2 i)+2 \\sum_{i=1}^{n-p}(n-p+1-2 i)(4 n-2 p+3-4 i),\n\n\\]\n\nwhich can be simplified to\n\n\\[\nZ \\leqslant n(n-1)-\\frac{2}{3} p(p-1)(p+1) .\n\\]\n\nSince \\(p\\) is a nonnegative integer, this yields \\(Z \\leqslant n(n-1)\\)."}
{"id": "imo-shortlist-2015-a4", "question": "A4. Find all functions \\(f: \\mathbb{R} \\rightarrow \\mathbb{R}\\) satisfying the equation\n\n\\[\nf(x+f(x+y))+f(x y)=x+f(x+y)+y f(x)\n\\]\n\nfor all real numbers \\(x\\) and \\(y\\).\nAnswer. There are two such functions, namely the identity function and \\(x \\mapsto 2-x\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2015, "solution": "Clearly, each of the functions \\(x \\mapsto x\\) and \\(x \\mapsto 2-x\\) satisfies (1). It suffices now to show that they are the only solutions to the problem.\n\nSuppose that \\(f\\) is any function satisfying (1). Then setting \\(y=1\\) in (1), we obtain\n\n\\[\nf(x+f(x+1))=x+f(x+1)\n\\]\n\nin other words, \\(x+f(x+1)\\) is a fixed point of \\(f\\) for every \\(x \\in \\mathbb{R}\\).\nWe distinguish two cases regarding the value of \\(f(0)\\).\nCase 1. \\(\\quad f(0) \\neq 0\\).\nBy letting \\(x=0\\) in (1), we have\n\n\\[\nf(f(y))+f(0)=f(y)+y f(0)\n\\]\n\nSo, if \\(y_{0}\\) is a fixed point of \\(f\\), then substituting \\(y=y_{0}\\) in the above equation we get \\(y_{0}=1\\). Thus, it follows from (2) that \\(x+f(x+1)=1\\) for all \\(x \\in \\mathbb{R}\\). That is, \\(f(x)=2-x\\) for all \\(x \\in \\mathbb{R}\\).\nCase 2. \\(\\quad f(0)=0\\).\nBy letting \\(y=0\\) and replacing \\(x\\) by \\(x+1\\) in (1), we obtain\n\n\\[\nf(x+f(x+1)+1)=x+f(x+1)+1\n\\]\n\nFrom (1), the substitution \\(x=1\\) yields\n\n\\[\nf(1+f(y+1))+f(y)=1+f(y+1)+y f(1)\n\\]\n\nBy plugging \\(x=-1\\) into (2), we see that \\(f(-1)=-1\\). We then plug \\(y=-1\\) into (4) and deduce that \\(f(1)=1\\). Hence, (4) reduces to\n\n\\[\nf(1+f(y+1))+f(y)=1+f(y+1)+y\n\\]\n\nAccordingly, if both \\(y_{0}\\) and \\(y_{0}+1\\) are fixed points of \\(f\\), then so is \\(y_{0}+2\\). Thus, it follows from (2) and (3) that \\(x+f(x+1)+2\\) is a fixed point of \\(f\\) for every \\(x \\in \\mathbb{R}\\); i.e.,\n\n\\[\nf(x+f(x+1)+2)=x+f(x+1)+2\n\\]\n\nReplacing \\(x\\) by \\(x-2\\) simplifies the above equation to\n\n\\[\nf(x+f(x-1))=x+f(x-1)\n\\]\n\nOn the other hand, we set \\(y=-1\\) in (1) and get\n\n\\[\nf(x+f(x-1))=x+f(x-1)-f(x)-f(-x)\n\\]\n\nTherefore, \\(f(-x)=-f(x)\\) for all \\(x \\in \\mathbb{R}\\).\nFinally, we substitute \\((x, y)\\) by \\((-1,-y)\\) in (1) and use the fact that \\(f(-1)=-1\\) to get\n\n\\[\nf(-1+f(-y-1))+f(y)=-1+f(-y-1)+y\n\\]\n\nSince \\(f\\) is an odd function, the above equation becomes\n\n\\[\n-f(1+f(y+1))+f(y)=-1-f(y+1)+y\n\\]\n\nBy adding this equation to (5), we conclude that \\(f(y)=y\\) for all \\(y \\in \\mathbb{R}\\)."}
{"id": "imo-shortlist-2015-a5", "question": "A5. Let \\(2 \\mathbb{Z}+1\\) denote the set of odd integers. Find all functions \\(f: \\mathbb{Z} \\rightarrow 2 \\mathbb{Z}+1\\) satisfying\n\n\\[\nf(x+f(x)+y)+f(x-f(x)-y)=f(x+y)+f(x-y)\n\\]\n\nfor every \\(x, y \\in \\mathbb{Z}\\).\n\nAnswer. Fix an odd positive integer \\(d\\), an integer \\(k\\), and odd integers \\(\\ell_{0}, \\ell_{1}, \\ldots, \\ell_{d-1}\\). Then the function defined as\n\n\\[\nf(m d+i)=2 k m d+\\ell_{i} d \\quad(m \\in \\mathbb{Z}, \\quad i=0,1, \\ldots, d-1)\n\\]\n\nsatisfies the problem requirements, and these are all such functions.", "category": "Algebra", "source": "IMO Shortlist", "year": 2015, "solution": "Throughout the solution, all functions are assumed to map integers to integers.\nFor any function \\(g\\) and any nonzero integer \\(t\\), define\n\n\\[\n\\Delta_{t} g(x)=g(x+t)-g(x)\n\\]\n\nFor any nonzero integers \\(a\\) and \\(b\\), notice that \\(\\Delta_{a} \\Delta_{b} g=\\Delta_{b} \\Delta_{a} g\\). Moreover, if \\(\\Delta_{a} g=0\\) and \\(\\Delta_{b} g=0\\), then \\(\\Delta_{a+b} g=0\\) and \\(\\Delta_{a t} g=0\\) for all nonzero integers \\(t\\). We say that \\(g\\) is \\(t\\)-quasiperiodic if \\(\\Delta_{t} g\\) is a constant function (in other words, if \\(\\Delta_{1} \\Delta_{t} g=0\\), or \\(\\Delta_{1} g\\) is \\(t\\)-periodic). In this case, we call \\(t\\) a quasi-period of \\(g\\). We say that \\(g\\) is quasi-periodic if it is \\(t\\)-quasi-periodic for some nonzero integer \\(t\\).\n\nNotice that a quasi-period of \\(g\\) is a period of \\(\\Delta_{1} g\\). So if \\(g\\) is quasi-periodic, then its minimal positive quasi-period \\(t\\) divides all its quasi-periods.\n\nWe now assume that \\(f\\) satisfies (1). First, by setting \\(a=x+y\\), the problem condition can be rewritten as\n\n\\[\n\\Delta_{f(x)} f(a)=\\Delta_{f(x)} f(2 x-a-f(x)) \\quad \\text { for all } x, a \\in \\mathbb{Z}\n\\]\n\nLet \\(b\\) be an arbitrary integer and let \\(k\\) be an arbitrary positive integer. Applying (2) when \\(a\\) is substituted by \\(b, b+f(x), \\ldots, b+(k-1) f(x)\\) and summing up all these equations, we get\n\n\\[\n\\Delta_{k f(x)} f(b)=\\Delta_{k f(x)} f(2 x-b-k f(x))\n\\]\n\nNotice that a similar argument works when \\(k\\) is negative, so that\n\n\\[\n\\Delta_{M} f(b)=\\Delta_{M} f(2 x-b-M) \\quad \\text { for any nonzero integer } M \\text { such that } f(x) \\mid M .\n\\]\n\nWe now prove two lemmas.\nLemma 1. For any distinct integers \\(x\\) and \\(y\\), the function \\(\\Delta_{\\operatorname{lcm}(f(x), f(y))} f\\) is \\(2(y-x)\\)-periodic. Proof. Denote \\(L=\\operatorname{lcm}(f(x), f(y))\\). Applying (3) twice, we obtain\n\n\\[\n\\Delta_{L} f(b)=\\Delta_{L} f(2 x-b-L)=\\Delta_{L} f(2 y-(b+2(y-x))-L)=\\Delta_{L} f(b+2(y-x))\n\\]\n\nThus, the function \\(\\Delta_{L} f\\) is \\(2(y-x)\\)-periodic, as required.\nLemma 2. Let \\(g\\) be a function. If \\(t\\) and \\(s\\) are nonzero integers such that \\(\\Delta_{t s} g=0\\) and \\(\\Delta_{t} \\Delta_{t} g=0\\), then \\(\\Delta_{t} g=0\\).\nProof. Assume, without loss of generality, that \\(s\\) is positive. Let \\(a\\) be an arbitrary integer. Since \\(\\Delta_{t} \\Delta_{t} g=0\\), we have\n\n\\[\n\\Delta_{t} g(a)=\\Delta_{t} g(a+t)=\\cdots=\\Delta_{t} g(a+(s-1) t)\n\\]\n\nThe sum of these \\(s\\) equal numbers is \\(\\Delta_{t s} g(a)=0\\), so each of them is zero, as required.\n\nWe now return to the solution.\nStep 1. We prove that \\(f\\) is quasi-periodic.\nLet \\(Q=\\operatorname{lcm}(f(0), f(1))\\). Applying Lemma 1, we get that the function \\(g=\\Delta_{Q} f\\) is 2-periodic. In other words, the values of \\(g\\) are constant on even numbers and on odd numbers separately. Moreover, setting \\(M=Q\\) and \\(x=b=0\\) in (3), we get \\(g(0)=g(-Q)\\). Since 0 and \\(-Q\\) have different parities, the value of \\(g\\) at even numbers is the same as that at odd numbers. Thus, \\(g\\) is constant, which means that \\(Q\\) is a quasi-period of \\(f\\).\nStep 2. Denote the minimal positive quasi-period of \\(f\\) by \\(T\\). We prove that \\(T \\mid f(x)\\) for all integers \\(x\\).\n\nSince an odd number \\(Q\\) is a quasi-period of \\(f\\), the number \\(T\\) is also odd. Now suppose, to the contrary, that there exist an odd prime \\(p\\), a positive integer \\(\\alpha\\), and an integer \\(u\\) such that \\(p^{\\alpha} \\mid T\\) but \\(p^{\\alpha} \\nmid f(u)\\). Setting \\(x=u\\) and \\(y=0\\) in (1), we have \\(2 f(u)=f(u+f(u))+f(u-f(u))\\), so \\(p^{\\alpha}\\) does not divide the value of \\(f\\) at one of the points \\(u+f(u)\\) or \\(u-f(u)\\). Denote this point by \\(v\\).\n\nLet \\(L=\\operatorname{lcm}(f(u), f(v))\\). Since \\(|u-v|=f(u)\\), from Lemma 1 we get \\(\\Delta_{2 f(u)} \\Delta_{L} f=0\\). Hence the function \\(\\Delta_{L} f\\) is \\(2 f(u)\\)-periodic as well as \\(T\\)-periodic, so it is \\(\\operatorname{gcd}(T, 2 f(u))\\)-periodic, or \\(\\Delta_{\\operatorname{gcd}(T, 2 f(u))} \\Delta_{L} f=0\\). Similarly, observe that the function \\(\\Delta_{\\operatorname{gcd}(T, 2 f(u))} f\\) is \\(L\\)-periodic as well as \\(T\\)-periodic, so we may conclude that \\(\\Delta_{\\operatorname{gcd}(T, L)} \\Delta_{\\operatorname{gcd}(T, 2 f(u))} f=0\\). Since \\(p^{\\alpha} \\nmid L\\), both \\(\\operatorname{gcd}(T, 2 f(u))\\) and \\(\\operatorname{gcd}(T, L)\\) divide \\(T / p\\). We thus obtain \\(\\Delta_{T / p} \\Delta_{T / p} f=0\\), which yields\n\n\\[\n\\Delta_{T / p} \\Delta_{T / p} \\Delta_{1} f=0\n\\]\n\nSince \\(\\Delta_{T} \\Delta_{1} f=0\\), we can apply Lemma 2 to the function \\(\\Delta_{1} f\\), obtaining \\(\\Delta_{T / p} \\Delta_{1} f=0\\). However, this means that \\(f\\) is ( \\(T / p\\) )-quasi-periodic, contradicting the minimality of \\(T\\). Our claim is proved.\n\nStep 3. We describe all functions \\(f\\).\nLet \\(d\\) be the greatest common divisor of all values of \\(f\\). Then \\(d\\) is odd. By Step 2, \\(d\\) is a quasi-period of \\(f\\), so that \\(\\Delta_{d} f\\) is constant. Since the value of \\(\\Delta_{d} f\\) is even and divisible by \\(d\\), we may denote this constant by \\(2 d k\\), where \\(k\\) is an integer. Next, for all \\(i=0,1, \\ldots, d-1\\), define \\(\\ell_{i}=f(i) / d\\); notice that \\(\\ell_{i}\\) is odd. Then\n\n\\[\nf(m d+i)=\\Delta_{m d} f(i)+f(i)=2 k m d+\\ell_{i} d \\quad \\text { for all } m \\in \\mathbb{Z} \\quad \\text { and } i=0,1, \\ldots, d-1 .\n\\]\n\nThis shows that all functions satisfying (1) are listed in the answer.\nIt remains to check that all such functions indeed satisfy (1). This is equivalent to checking (2), which is true because for every integer \\(x\\), the value of \\(f(x)\\) is divisible by \\(d\\), so that \\(\\Delta_{f(x)} f\\) is constant.\n\nComment. After obtaining Lemmas 1 and 2, it is possible to complete the steps in a different order. Here we sketch an alternative approach.\n\nFor any function \\(g\\) and any nonzero integer \\(t\\), we say that \\(g\\) is \\(t\\)-pseudo-periodic if \\(\\Delta_{t} \\Delta_{t} g=0\\). In this case, we call \\(t\\) a pseudo-period of \\(g\\), and we say that \\(g\\) is pseudo-periodic.\n\nLet us first prove a basic property: if a function \\(g\\) is pseudo-periodic, then its minimal positive pseudo-period divides all its pseudo-periods. To establish this, it suffices to show that if \\(t\\) and \\(s\\) are pseudo-periods of \\(g\\) with \\(t \\neq s\\), then so is \\(t-s\\). Indeed, suppose that \\(\\Delta_{t} \\Delta_{t} g=\\Delta_{s} \\Delta_{s} g=0\\). Then \\(\\Delta_{t} \\Delta_{t} \\Delta_{s} g=\\Delta_{t s} \\Delta_{s} g=0\\), so that \\(\\Delta_{t} \\Delta_{s} g=0\\) by Lemma 2. Taking differences, we obtain \\(\\Delta_{t} \\Delta_{t-s} g=\\Delta_{s} \\Delta_{t-s} g=0\\), and thus \\(\\Delta_{t-s} \\Delta_{t-s} g=0\\).\n\nNow let \\(f\\) satisfy the problem condition. We will show that \\(f\\) is pseudo-periodic. When this is done, we will let \\(T^{\\prime}\\) be the minimal pseudo-period of \\(f\\), and show that \\(T^{\\prime}\\) divides \\(2 f(x)\\) for every integer \\(x\\), using arguments similar to Step 2 of the solution. Then we will come back to Step 1 by showing that \\(T^{\\prime}\\) is also a quasi-period of \\(f\\).\n\nFirst, Lemma 1 yields that \\(\\Delta_{2(y-x)} \\Delta_{\\operatorname{lcm}(f(x), f(y))} f=0\\) for every distinct integers \\(x\\) and \\(y\\). Hence \\(f\\) is pseudo-periodic with pseudo-period \\(L_{x, y}=\\operatorname{lcm}(2(y-x), f(x), f(y))\\).\n\nWe now show that \\(T^{\\prime} \\mid 2 f(x)\\) for every integer \\(x\\). Suppose, to the contrary, that there exists an integer \\(u\\), a prime \\(p\\), and a positive integer \\(\\alpha\\) such that \\(p^{\\alpha} \\mid T^{\\prime}\\) and \\(p^{\\alpha} \\nmid 2 f(u)\\). Choose \\(v\\) as in Step 2 and employ Lemma 1 to obtain \\(\\Delta_{2 f(u)} \\Delta_{\\operatorname{lcm}(f(u), f(v))} f=0\\). However, this implies that \\(\\Delta_{T^{\\prime} / p} \\Delta_{T^{\\prime} / p} f=0\\), a contradiction with the minimality of \\(T^{\\prime}\\).\n\nWe now claim that \\(\\Delta_{T^{\\prime}} \\Delta_{2} f=0\\). Indeed, Lemma 1 implies that there exists an integer \\(s\\) such that \\(\\Delta_{s} \\Delta_{2} f=0\\). Hence \\(\\Delta_{T^{\\prime} s} \\Delta_{2} f=\\Delta_{T^{\\prime}} \\Delta_{T^{\\prime}} \\Delta_{2} f=0\\), which allows us to conclude that \\(\\Delta_{T^{\\prime}} \\Delta_{2} f=0\\) by Lemma 2. (The last two paragraphs are similar to Step 2 of the solution.)\n\nNow, it is not difficult to finish the solution, though more work is needed to eliminate the factors of 2 from the subscripts of \\(\\Delta_{T^{\\prime}} \\Delta_{2} f=0\\). Once this is done, we will obtain an odd quasi-period of \\(f\\) that divides \\(f(x)\\) for all integers \\(x\\). Then we can complete the solution as in Step 3."}
{"id": "imo-shortlist-2015-a6", "question": "A6. Let \\(n\\) be a fixed integer with \\(n \\geqslant 2\\). We say that two polynomials \\(P\\) and \\(Q\\) with real coefficients are block-similar if for each \\(i \\in\\{1,2, \\ldots, n\\}\\) the sequences\n\n\\[\n\\begin{aligned}\n& P(2015 i), P(2015 i-1), \\ldots, P(2015 i-2014) \\quad \\text { and } \n& Q(2015 i), Q(2015 i-1), \\ldots, Q(2015 i-2014)\n\n\\]\n\nare permutations of each other.\n(a) Prove that there exist distinct block-similar polynomials of degree \\(n+1\\).\n(b) Prove that there do not exist distinct block-similar polynomials of degree \\(n\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2015, "solution": "For convenience, we set \\(k=2015=2 \\ell+1\\).\n\nPart (a). Consider the following polynomials of degree \\(n+1\\) :\n\n\\[\nP(x)=\\prod_{i=0}^{n}(x-i k) \\quad \\text { and } \\quad Q(x)=\\prod_{i=0}^{n}(x-i k-1)\n\\]\n\nSince \\(Q(x)=P(x-1)\\) and \\(P(0)=P(k)=P(2 k)=\\cdots=P(n k)\\), these polynomials are block-similar (and distinct).\n\nPart (b). For every polynomial \\(F(x)\\) and every nonnegative integer \\(m\\), define \\(\\Sigma_{F}(m)=\\) \\(\\sum_{i=1}^{m} F(i)\\); in particular, \\(\\Sigma_{F}(0)=0\\). It is well-known that for every nonnegative integer \\(d\\) the sum \\(\\sum_{i=1}^{m} i^{d}\\) is a polynomial in \\(m\\) of degree \\(d+1\\). Thus \\(\\Sigma_{F}\\) may also be regarded as a real polynomial of degree \\(\\operatorname{deg} F+1\\) (with the exception that if \\(F=0\\), then \\(\\Sigma_{F}=0\\) as well). This allows us to consider the values of \\(\\Sigma_{F}\\) at all real points (where the initial definition does not apply).\n\nAssume for the sake of contradiction that there exist two distinct block-similar polynomials \\(P(x)\\) and \\(Q(x)\\) of degree \\(n\\). Then both polynomials \\(\\Sigma_{P-Q}(x)\\) and \\(\\Sigma_{P^{2}-Q^{2}}(x)\\) have roots at the points \\(0, k, 2 k, \\ldots, n k\\). This motivates the following lemma, where we use the special polynomial\n\n\\[\nT(x)=\\prod_{i=0}^{n}(x-i k)\n\\]\n\nLemma. Assume that \\(F(x)\\) is a nonzero polynomial such that \\(0, k, 2 k, \\ldots, n k\\) are among the roots of the polynomial \\(\\Sigma_{F}(x)\\). Then \\(\\operatorname{deg} F \\geqslant n\\), and there exists a polynomial \\(G(x)\\) such that \\(\\operatorname{deg} G=\\operatorname{deg} F-n\\) and \\(F(x)=T(x) G(x)-T(x-1) G(x-1)\\).\nProof. If deg \\(F<n\\), then \\(\\Sigma_{F}(x)\\) has at least \\(n+1\\) roots, while its degree is less than \\(n+1\\). Therefore, \\(\\Sigma_{F}(x)=0\\) and hence \\(F(x)=0\\), which is impossible. Thus \\(\\operatorname{deg} F \\geqslant n\\).\n\nThe lemma condition yields that \\(\\Sigma_{F}(x)=T(x) G(x)\\) for some polynomial \\(G(x)\\) such that \\(\\operatorname{deg} G=\\operatorname{deg} \\Sigma_{F}-(n+1)=\\operatorname{deg} F-n\\).\n\nNow, let us define \\(F_{1}(x)=T(x) G(x)-T(x-1) G(x-1)\\). Then for every positive integer \\(n\\) we have\n\n\\[\n\\Sigma_{F_{1}}(n)=\\sum_{i=1}^{n}(T(x) G(x)-T(x-1) G(x-1))=T(n) G(n)-T(0) G(0)=T(n) G(n)=\\Sigma_{F}(n)\n\\]\n\nso the polynomial \\(\\Sigma_{F-F_{1}}(x)=\\Sigma_{F}(x)-\\Sigma_{F_{1}}(x)\\) has infinitely many roots. This means that this polynomial is zero, which in turn yields \\(F(x)=F_{1}(x)\\), as required.\n\nFirst, we apply the lemma to the nonzero polynomial \\(R_{1}(x)=P(x)-Q(x)\\). Since the degree of \\(R_{1}(x)\\) is at most \\(n\\), we conclude that it is exactly \\(n\\). Moreover, \\(R_{1}(x)=\\alpha \\cdot(T(x)-T(x-1))\\) for some nonzero constant \\(\\alpha\\).\n\nOur next aim is to prove that the polynomial \\(S(x)=P(x)+Q(x)\\) is constant. Assume the contrary. Then, notice that the polynomial \\(R_{2}(x)=P(x)^{2}-Q(x)^{2}=R_{1}(x) S(x)\\) is also nonzero and satisfies the lemma condition. Since \\(n<\\operatorname{deg} R_{1}+\\operatorname{deg} S=\\operatorname{deg} R_{2} \\leqslant 2 n\\), the lemma yields\n\n\\[\nR_{2}(x)=T(x) G(x)-T(x-1) G(x-1)\n\\]\n\nwith some polynomial \\(G(x)\\) with \\(0<\\operatorname{deg} G \\leqslant n\\).\nSince the polynomial \\(R_{1}(x)=\\alpha(T(x)-T(x-1))\\) divides the polynomial\n\n\\[\nR_{2}(x)=T(x)(G(x)-G(x-1))+G(x-1)(T(x)-T(x-1)),\n\\]\n\nwe get \\(R_{1}(x) \\mid T(x)(G(x)-G(x-1))\\). On the other hand,\n\n\\[\n\\operatorname{gcd}\\left(T(x), R_{1}(x)\\right)=\\operatorname{gcd}(T(x), T(x)-T(x-1))=\\operatorname{gcd}(T(x), T(x-1))=1,\n\\]\n\nsince both \\(T(x)\\) and \\(T(x-1)\\) are the products of linear polynomials, and their roots are distinct. Thus \\(R_{1}(x) \\mid G(x)-G(x-1)\\). However, this is impossible since \\(G(x)-G(x-1)\\) is a nonzero polynomial of degree less than \\(n=\\operatorname{deg} R_{1}\\).\n\nThus, our assumption is wrong, and \\(S(x)\\) is a constant polynomial, say \\(S(x)=\\beta\\). Notice that the polynomials \\((2 P(x)-\\beta) / \\alpha\\) and \\((2 Q(x)-\\beta) / \\alpha\\) are also block-similar and distinct. So we may replace the initial polynomials by these ones, thus obtaining two block-similar polynomials \\(P(x)\\) and \\(Q(x)\\) with \\(P(x)=-Q(x)=T(x)-T(x-1)\\). It remains to show that this is impossible.\n\nFor every \\(i=1,2 \\ldots, n\\), the values \\(T(i k-k+1)\\) and \\(T(i k-1)\\) have the same sign. This means that the values \\(P(i k-k+1)=T(i k-k+1)\\) and \\(P(i k)=-T(i k-1)\\) have opposite signs, so \\(P(x)\\) has a root in each of the \\(n\\) segments \\([i k-k+1, i k]\\). Since \\(\\operatorname{deg} P=n\\), it must have exactly one root in each of them.\n\nThus, the sequence \\(P(1), P(2), \\ldots, P(k)\\) should change sign exactly once. On the other hand, since \\(P(x)\\) and \\(-P(x)\\) are block-similar, this sequence must have as many positive terms as negative ones. Since \\(k=2 \\ell+1\\) is odd, this shows that the middle term of the sequence above must be zero, so \\(P(\\ell+1)=0\\), or \\(T(\\ell+1)=T(\\ell)\\). However, this is not true since\n\n\\[\n|T(\\ell+1)|=|\\ell+1| \\cdot|\\ell| \\cdot \\prod_{i=2}^{n}|\\ell+1-i k|<|\\ell| \\cdot|\\ell+1| \\cdot \\prod_{i=2}^{n}|\\ell-i k|=|T(\\ell)|\n\\]\n\nwhere the strict inequality holds because \\(n \\geqslant 2\\). We come to the final contradiction.\n\nComment 1. In the solution above, we used the fact that \\(k>1\\) is odd. One can modify the arguments of the last part in order to work for every (not necessarily odd) sufficiently large value of \\(k\\); namely, when \\(k\\) is even, one may show that the sequence \\(P(1), P(2), \\ldots, P(k)\\) has different numbers of positive and negative terms.\n\nOn the other hand, the problem statement with \\(k\\) replaced by 2 is false, since the polynomials \\(P(x)=T(x)-T(x-1)\\) and \\(Q(x)=T(x-1)-T(x)\\) are block-similar in this case, due to the fact that \\(P(2 i-1)=-P(2 i)=Q(2 i)=-Q(2 i-1)=T(2 i-1)\\) for all \\(i=1,2, \\ldots, n\\). Thus, every complete solution should use the relation \\(k>2\\).\n\nOne may easily see that the condition \\(n \\geqslant 2\\) is also substantial, since the polynomials \\(x\\) and \\(k+1-x\\) become block-similar if we set \\(n=1\\).\n\nIt is easily seen from the solution that the result still holds if we assume that the polynomials have degree at most \\(n\\).\n\nSolution 2. We provide an alternative argument for part (b).\nAssume again that there exist two distinct block-similar polynomials \\(P(x)\\) and \\(Q(x)\\) of degree \\(n\\). Let \\(R(x)=P(x)-Q(x)\\) and \\(S(x)=P(x)+Q(x)\\). For brevity, we also denote the segment \\([(i-1) k+1, i k]\\) by \\(I_{i}\\), and the set \\(\\{(i-1) k+1,(i-1) k+2, \\ldots, i k\\}\\) of all integer points in \\(I_{i}\\) by \\(Z_{i}\\).\nStep 1. We prove that \\(R(x)\\) has exactly one root in each segment \\(I_{i}, i=1,2, \\ldots, n\\) and all these roots are simple.\n\nIndeed, take any \\(i \\in\\{1,2, \\ldots, n\\}\\) and choose some points \\(p^{-}, p^{+} \\in Z_{i}\\) so that\n\n\\[\nP\\left(p^{-}\\right)=\\min _{x \\in Z_{i}} P(x) \\quad \\text { and } \\quad P\\left(p^{+}\\right)=\\max _{x \\in Z_{i}} P(x)\n\\]\n\nSince the sequences of values of \\(P\\) and \\(Q\\) in \\(Z_{i}\\) are permutations of each other, we have \\(R\\left(p^{-}\\right)=P\\left(p^{-}\\right)-Q\\left(p^{-}\\right) \\leqslant 0\\) and \\(R\\left(p^{+}\\right)=P\\left(p^{+}\\right)-Q\\left(p^{+}\\right) \\geqslant 0\\). Since \\(R(x)\\) is continuous, there exists at least one root of \\(R(x)\\) between \\(p^{-}\\)and \\(p^{+}\\)- thus in \\(I_{i}\\).\n\nSo, \\(R(x)\\) has at least one root in each of the \\(n\\) disjoint segments \\(I_{i}\\) with \\(i=1,2, \\ldots, n\\). Since \\(R(x)\\) is nonzero and its degree does not exceed \\(n\\), it should have exactly one root in each of these segments, and all these roots are simple, as required.\nStep 2. We prove that \\(S(x)\\) is constant.\nWe start with the following claim.\nClaim. For every \\(i=1,2, \\ldots, n\\), the sequence of values \\(S((i-1) k+1), S((i-1) k+2), \\ldots\\), \\(S(i k)\\) cannot be strictly increasing.\nProof. Fix any \\(i \\in\\{1,2, \\ldots, n\\}\\). Due to the symmetry, we may assume that \\(P(i k) \\leqslant Q(i k)\\). Choose now \\(p^{-}\\)and \\(p^{+}\\)as in Step 1. If we had \\(P\\left(p^{+}\\right)=P\\left(p^{-}\\right)\\), then \\(P\\) would be constant on \\(Z_{i}\\), so all the elements of \\(Z_{i}\\) would be the roots of \\(R(x)\\), which is not the case. In particular, we have \\(p^{+} \\neq p^{-}\\). If \\(p^{-}>p^{+}\\), then \\(S\\left(p^{-}\\right)=P\\left(p^{-}\\right)+Q\\left(p^{-}\\right) \\leqslant Q\\left(p^{+}\\right)+P\\left(p^{+}\\right)=S\\left(p^{+}\\right)\\), so our claim holds.\n\nWe now show that the remaining case \\(p^{-}<p^{+}\\)is impossible. Assume first that \\(P\\left(p^{+}\\right)>\\) \\(Q\\left(p^{+}\\right)\\). Then, like in Step 1, we have \\(R\\left(p^{-}\\right) \\leqslant 0, R\\left(p^{+}\\right)>0\\), and \\(R(i k) \\leqslant 0\\), so \\(R(x)\\) has a root in each of the intervals \\(\\left[p^{-}, p^{+}\\right)\\)and \\(\\left(p^{+}, i k\\right]\\). This contradicts the result of Step 1.\n\nWe are left only with the case \\(p^{-}<p^{+}\\)and \\(P\\left(p^{+}\\right)=Q\\left(p^{+}\\right)\\)(thus \\(p^{+}\\)is the unique root of \\(R(x)\\) in \\(I_{i}\\) ). If \\(p^{+}=i k\\), then the values of \\(R(x)\\) on \\(Z_{i} \\backslash\\{i k\\}\\) are all of the same sign, which is absurd since their sum is zero. Finally, if \\(p^{-}<p^{+}<i k\\), then \\(R\\left(p^{-}\\right)\\)and \\(R(i k)\\) are both negative. This means that \\(R(x)\\) should have an even number of roots in \\(\\left[p^{-}, i k\\right]\\), counted with multiplicity. This also contradicts the result of Step 1.\n\nIn a similar way, one may prove that for every \\(i=1,2, \\ldots, n\\), the sequence \\(S((i-1) k+1)\\), \\(S((i-1) k+2), \\ldots, S(i k)\\) cannot be strictly decreasing. This means that the polynomial \\(\\Delta S(x)=S(x)-S(x-1)\\) attains at least one nonnegative value, as well as at least one nonpositive value, on the set \\(Z_{i}\\) (and even on \\(Z_{i} \\backslash\\{(i-1) k+1\\}\\) ); so \\(\\Delta S\\) has a root in \\(I_{i}\\).\n\nThus \\(\\Delta S\\) has at least \\(n\\) roots; however, its degree is less than \\(n\\), so \\(\\Delta S\\) should be identically zero. This shows that \\(S(x)\\) is a constant, say \\(S(x) \\equiv \\beta\\).\nStep 3. Notice that the polynomials \\(P(x)-\\beta / 2\\) and \\(Q(x)-\\beta / 2\\) are also block-similar and distinct. So we may replace the initial polynomials by these ones, thus reaching \\(P(x)=-Q(x)\\).\n\nThen \\(R(x)=2 P(x)\\), so \\(P(x)\\) has exactly one root in each of the segments \\(I_{i}, i=1,2, \\ldots, n\\). On the other hand, \\(P(x)\\) and \\(-P(x)\\) should attain the same number of positive values on \\(Z_{i}\\). Since \\(k\\) is odd, this means that \\(Z_{i}\\) contains exactly one root of \\(P(x)\\); moreover, this root should be at the center of \\(Z_{i}\\), because \\(P(x)\\) has the same number of positive and negative values on \\(Z_{i}\\).\n\nThus we have found all \\(n\\) roots of \\(P(x)\\), so\n\n\\[\nP(x)=c \\prod_{i=1}^{n}(x-i k+\\ell) \\quad \\text { for some } c \\in \\mathbb{R} \\backslash\\{0\\}\n\\]\n\nwhere \\(\\ell=(k-1) / 2\\). It remains to notice that for every \\(t \\in Z_{1} \\backslash\\{1\\}\\) we have\n\n\\[\n|P(t)|=|c| \\cdot|t-\\ell-1| \\cdot \\prod_{i=2}^{n}|t-i k+\\ell|<|c| \\cdot \\ell \\cdot \\prod_{i=2}^{n}|1-i k+\\ell|=|P(1)|,\n\\]\n\nso \\(P(1) \\neq-P(t)\\) for all \\(t \\in Z_{1}\\). This shows that \\(P(x)\\) is not block-similar to \\(-P(x)\\). The final contradiction.\n\nComment 2. One may merge Steps 1 and 2 in the following manner. As above, we set \\(R(x)=\\) \\(P(x)-Q(x)\\) and \\(S(x)=P(x)+Q(x)\\).\n\nWe aim to prove that the polynomial \\(S(x)=2 P(x)-R(x)=2 Q(x)+R(x)\\) is constant. Since the degrees of \\(R(x)\\) and \\(S(x)\\) do not exceed \\(n\\), it suffices to show that the total number of roots of \\(R(x)\\) and \\(\\Delta S(x)=S(x)-S(x-1)\\) is at least \\(2 n\\). For this purpose, we prove the following claim.\nClaim. For every \\(i=1,2, \\ldots, n\\), either each of \\(R\\) and \\(\\Delta S\\) has a root in \\(I_{i}\\), or \\(R\\) has at least two roots in \\(I_{i}\\).\nProof. Fix any \\(i \\in\\{1,2, \\ldots, n\\}\\). Let \\(r \\in Z_{i}\\) be a point such that \\(|R(r)|=\\max _{x \\in Z_{i}}|R(x)|\\); we may assume that \\(R(r)>0\\). Next, let \\(p^{-}, q^{+} \\in I_{i}\\) be some points such that \\(P\\left(p^{-}\\right)=\\min _{x \\in Z_{i}} P(x)\\) and \\(Q\\left(q^{+}\\right)=\\max _{x \\in Z_{i}} Q(x)\\). Notice that \\(P\\left(p^{-}\\right) \\leqslant Q(r)<P(r)\\) and \\(Q\\left(q^{+}\\right) \\geqslant P(r)>Q(r)\\), so \\(r\\) is different from \\(p^{-}\\)and \\(q^{+}\\).\n\nWithout loss of generality, we may assume that \\(p^{-}<r\\). Then we have \\(R\\left(p^{-}\\right)=P\\left(p^{-}\\right)-Q\\left(p^{-}\\right) \\leqslant\\) \\(0<R(r)\\), so \\(R(x)\\) has a root in \\(\\left[p^{-}, r\\right)\\). If \\(q^{+}>r\\), then, similarly, \\(R\\left(q^{+}\\right) \\leqslant 0<R(r)\\), and \\(R(x)\\) also has a root in ( \\(r, q^{+}\\)]; so \\(R(x)\\) has two roots in \\(I_{i}\\), as required.\n\nIn the remaining case we have \\(q^{+}<r\\); it suffices now to show that in this case \\(\\Delta S\\) has a root in \\(I_{i}\\). Since \\(P\\left(p^{-}\\right) \\leqslant Q(r)\\) and \\(\\left|R\\left(p^{-}\\right)\\right| \\leqslant R(r)\\), we have \\(S\\left(p^{-}\\right)=2 P\\left(p^{-}\\right)-R\\left(p^{-}\\right) \\leqslant 2 Q(r)+R(r)=S(r)\\). Similarly, we get \\(S\\left(q^{+}\\right)=2 Q\\left(q^{+}\\right)+R\\left(q^{+}\\right) \\geqslant 2 P(r)-R(r)=S(r)\\). Therefore, the sequence of values of \\(S\\) on \\(Z_{i}\\) is neither strictly increasing nor strictly decreasing, which shows that \\(\\Delta S\\) has a root in \\(I_{i}\\).\n\nComment 3. After finding the relation \\(P(x)-Q(x)=\\alpha(T(x)-T(x-1))\\) from Solution 1, one may also follow the approach presented in Solution 2. Knowledge of the difference of polynomials may simplify some steps; e.g., it is clear now that \\(P(x)-Q(x)\\) has exactly one root in each of the segments \\(I_{i}\\)."}
{"id": "imo-shortlist-2015-c1", "question": "C1. In Lineland there are \\(n \\geqslant 1\\) towns, arranged along a road running from left to right. Each town has a left bulldozer (put to the left of the town and facing left) and a right bulldozer (put to the right of the town and facing right). The sizes of the \\(2 n\\) bulldozers are distinct. Every time when a right and a left bulldozer confront each other, the larger bulldozer pushes the smaller one off the road. On the other hand, the bulldozers are quite unprotected at their rears; so, if a bulldozer reaches the rear-end of another one, the first one pushes the second one off the road, regardless of their sizes.\n\nLet \\(A\\) and \\(B\\) be two towns, with \\(B\\) being to the right of \\(A\\). We say that town \\(A\\) can sweep town \\(B\\) away if the right bulldozer of \\(A\\) can move over to \\(B\\) pushing off all bulldozers it meets. Similarly, \\(B\\) can sweep \\(A\\) away if the left bulldozer of \\(B\\) can move to \\(A\\) pushing off all bulldozers of all towns on its way.\n\nProve that there is exactly one town which cannot be swept away by any other one.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2015, "solution": "Let \\(T_{1}, T_{2}, \\ldots, T_{n}\\) be the towns enumerated from left to right. Observe first that, if town \\(T_{i}\\) can sweep away town \\(T_{j}\\), then \\(T_{i}\\) also can sweep away every town located between \\(T_{i}\\) and \\(T_{j}\\).\n\nWe prove the problem statement by strong induction on \\(n\\). The base case \\(n=1\\) is trivial.\nFor the induction step, we first observe that the left bulldozer in \\(T_{1}\\) and the right bulldozer in \\(T_{n}\\) are completely useless, so we may forget them forever. Among the other \\(2 n-2\\) bulldozers, we choose the largest one. Without loss of generality, it is the right bulldozer of some town \\(T_{k}\\) with \\(k<n\\).\n\nSurely, with this large bulldozer \\(T_{k}\\) can sweep away all the towns to the right of it. Moreover, none of these towns can sweep \\(T_{k}\\) away; so they also cannot sweep away any town to the left of \\(T_{k}\\). Thus, if we remove the towns \\(T_{k+1}, T_{k+2}, \\ldots, T_{n}\\), none of the remaining towns would change its status of being (un)sweepable away by the others.\n\nApplying the induction hypothesis to the remaining towns, we find a unique town among \\(T_{1}, T_{2}, \\ldots, T_{k}\\) which cannot be swept away. By the above reasons, it is also the unique such town in the initial situation. Thus the induction step is established.\n\nSolution 2. We start with the same enumeration and the same observation as in Solution 1. We also denote by \\(\\ell_{i}\\) and \\(r_{i}\\) the sizes of the left and the right bulldozers belonging to \\(T_{i}\\), respectively. One may easily see that no two towns \\(T_{i}\\) and \\(T_{j}\\) with \\(i<j\\) can sweep each other away, for this would yield \\(r_{i}>\\ell_{j}>r_{i}\\).\n\nClearly, there is no town which can sweep \\(T_{n}\\) away from the right. Then we may choose the leftmost town \\(T_{k}\\) which cannot be swept away from the right. One can observe now that no town \\(T_{i}\\) with \\(i>k\\) may sweep away some town \\(T_{j}\\) with \\(j<k\\), for otherwise \\(T_{i}\\) would be able to sweep \\(T_{k}\\) away as well.\n\nNow we prove two claims, showing together that \\(T_{k}\\) is the unique town which cannot be swept away, and thus establishing the problem statement.\n\nClaim 1. \\(T_{k}\\) also cannot be swept away from the left.\nProof. Let \\(T_{m}\\) be some town to the left of \\(T_{k}\\). By the choice of \\(T_{k}\\), town \\(T_{m}\\) can be swept away from the right by some town \\(T_{p}\\) with \\(p>m\\). As we have already observed, \\(p\\) cannot be greater than \\(k\\). On the other hand, \\(T_{m}\\) cannot sweep \\(T_{p}\\) away, so a fortiori it cannot sweep \\(T_{k}\\) away.\n\nClaim 2. Any town \\(T_{m}\\) with \\(m \\neq k\\) can be swept away by some other town.\n\nProof. If \\(m<k\\), then \\(T_{m}\\) can be swept away from the right due to the choice of \\(T_{k}\\). In the remaining case we have \\(m>k\\).\n\nLet \\(T_{p}\\) be a town among \\(T_{k}, T_{k+1}, \\ldots, T_{m-1}\\) having the largest right bulldozer. We claim that \\(T_{p}\\) can sweep \\(T_{m}\\) away. If this is not the case, then \\(r_{p}<\\ell_{q}\\) for some \\(q\\) with \\(p<q \\leqslant m\\). But this means that \\(\\ell_{q}\\) is greater than all the numbers \\(r_{i}\\) with \\(k \\leqslant i \\leqslant m-1\\), so \\(T_{q}\\) can sweep \\(T_{k}\\) away. This contradicts the choice of \\(T_{k}\\).\n\nComment 1. One may employ the same ideas within the inductive approach. Here we sketch such a solution.\n\nAssume that the problem statement holds for the collection of towns \\(T_{1}, T_{2}, \\ldots, T_{n-1}\\), so that there is a unique town \\(T_{i}\\) among them which cannot be swept away by any other of them. Thus we need to prove that in the full collection \\(T_{1}, T_{2}, \\ldots, T_{n}\\), exactly one of the towns \\(T_{i}\\) and \\(T_{n}\\) cannot be swept away.\n\nIf \\(T_{n}\\) cannot sweep \\(T_{i}\\) away, then it remains to prove that \\(T_{n}\\) can be swept away by some other town. This can be established as in the second paragraph of the proof of Claim 2.\n\nIf \\(T_{n}\\) can sweep \\(T_{i}\\) away, then it remains to show that \\(T_{n}\\) cannot be swept away by any other town. Since \\(T_{n}\\) can sweep \\(T_{i}\\) away, it also can sweep all the towns \\(T_{i}, T_{i+1}, \\ldots, T_{n-1}\\) away, so \\(T_{n}\\) cannot be swept away by any of those. On the other hand, none of the remaining towns \\(T_{1}, T_{2}, \\ldots, T_{i-1}\\) can sweep \\(T_{i}\\) away, so that they cannot sweep \\(T_{n}\\) away as well.\n\nComment 2. Here we sketch yet another inductive approach. Assume that \\(n>1\\). Firstly, we find a town which can be swept away by each of its neighbors (each town has two neighbors, except for the bordering ones each of which has one); we call such town a loser. Such a town exists, because there are \\(n-1\\) pairs of neighboring towns, and in each of them there is only one which can sweep the other away; so there exists a town which is a winner in none of these pairs.\n\nNotice that a loser can be swept away, but it cannot sweep any other town away (due to its neighbors' protection). Now we remove a loser, and suggest its left bulldozer to its right neighbor (if it exists), and its right bulldozer to a left one (if it exists). Surely, a town accepts a suggestion if a suggested bulldozer is larger than the town's one of the same orientation.\n\nNotice that suggested bulldozers are useless in attack (by the definition of a loser), but may serve for defensive purposes. Moreover, each suggested bulldozer's protection works for the same pairs of remaining towns as before the removal.\n\nBy the induction hypothesis, the new configuration contains exactly one town which cannot be swept away. The arguments above show that the initial one also satisfies this property.\nSolution 3. We separately prove that ( \\(i\\) ) there exists a town which cannot be swept away, and that (ii) there is at most one such town. We also make use of the two observations from the previous solutions.\nTo prove ( \\(i\\) ), assume contrariwise that every town can be swept away. Let \\(t_{1}\\) be the leftmost town; next, for every \\(k=1,2, \\ldots\\) we inductively choose \\(t_{k+1}\\) to be some town which can sweep \\(t_{k}\\) away. Now we claim that for every \\(k=1,2, \\ldots\\), the town \\(t_{k+1}\\) is to the right of \\(t_{k}\\); this leads to the contradiction, since the number of towns is finite.\n\nInduction on \\(k\\). The base case \\(k=1\\) is clear due to the choice of \\(t_{1}\\). Assume now that for all \\(j\\) with \\(1 \\leqslant j<k\\), the town \\(t_{j+1}\\) is to the right of \\(t_{j}\\). Suppose that \\(t_{k+1}\\) is situated to the left of \\(t_{k}\\); then it lies between \\(t_{j}\\) and \\(t_{j+1}\\) (possibly coinciding with \\(t_{j}\\) ) for some \\(j<k\\). Therefore, \\(t_{k+1}\\) can be swept away by \\(t_{j+1}\\), which shows that it cannot sweep \\(t_{j+1}\\) away - so \\(t_{k+1}\\) also cannot sweep \\(t_{k}\\) away. This contradiction proves the induction step.\n\nTo prove ( \\(i i\\) ), we also argue indirectly and choose two towns \\(A\\) and \\(B\\) neither of which can be swept away, with \\(A\\) being to the left of \\(B\\). Consider the largest bulldozer \\(b\\) between them (taking into consideration the right bulldozer of \\(A\\) and the left bulldozer of \\(B\\) ). Without loss of generality, \\(b\\) is a left bulldozer; then it is situated in some town to the right of \\(A\\), and this town may sweep \\(A\\) away since nothing prevents it from doing that. A contradiction.\n\nComment 3. The Problem Selection Committee decided to reformulate this problem. The original formulation was as follows.\n\nLet \\(n\\) be a positive integer. There are \\(n\\) cards in a deck, enumerated from bottom to top with numbers \\(1,2, \\ldots, n\\). For each \\(i=1,2, \\ldots, n\\), an even number \\(a_{i}\\) is printed on the lower side and an odd number \\(b_{i}\\) is printed on the upper side of the \\(i^{\\text {th }}\\) card. We say that the \\(i^{\\text {th }}\\) card opens the \\(j^{\\text {th }}\\) card, if \\(i<j\\) and \\(b_{i}<a_{k}\\) for every \\(k=i+1, i+2, \\ldots, j\\). Similarly, we say that the \\(i^{\\text {th }}\\) card closes the \\(j^{\\text {th }}\\) card, if \\(i>j\\) and \\(a_{i}<b_{k}\\) for every \\(k=i-1, i-2, \\ldots, j\\). Prove that the deck contains exactly one card which is neither opened nor closed by any other card."}
{"id": "imo-shortlist-2015-c2", "question": "C2. Let \\(\\mathcal{V}\\) be a finite set of points in the plane. We say that \\(\\mathcal{V}\\) is balanced if for any two distinct points \\(A, B \\in \\mathcal{V}\\), there exists a point \\(C \\in \\mathcal{V}\\) such that \\(A C=B C\\). We say that \\(\\mathcal{V}\\) is center-free if for any distinct points \\(A, B, C \\in \\mathcal{V}\\), there does not exist a point \\(P \\in \\mathcal{V}\\) such that \\(P A=P B=P C\\).\n(a) Show that for all \\(n \\geqslant 3\\), there exists a balanced set consisting of \\(n\\) points.\n(b) For which \\(n \\geqslant 3\\) does there exist a balanced, center-free set consisting of \\(n\\) points?\n\nAnswer for part (b). All odd integers \\(n \\geqslant 3\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2015, "solution": ""}
{"id": "imo-shortlist-2015-g1", "question": "G1. Let \\(A B C\\) be an acute triangle with orthocenter \\(H\\). Let \\(G\\) be the point such that the quadrilateral \\(A B G H\\) is a parallelogram. Let \\(I\\) be the point on the line \\(G H\\) such that \\(A C\\) bisects \\(H I\\). Suppose that the line \\(A C\\) intersects the circumcircle of the triangle \\(G C I\\) at \\(C\\) and \\(J\\). Prove that \\(I J=A H\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2015, "solution": "Since \\(H G \\| A B\\) and \\(B G \\| A H\\), we have \\(B G \\perp B C\\) and \\(C H \\perp G H\\). Therefore, the quadrilateral \\(B G C H\\) is cyclic. Since \\(H\\) is the orthocenter of the triangle \\(A B C\\), we have \\(\\angle H A C=90^{\\circ}-\\angle A C B=\\angle C B H\\). Using that \\(B G C H\\) and \\(C G J I\\) are cyclic quadrilaterals, we get\n\n\\[\n\\angle C J I=\\angle C G H=\\angle C B H=\\angle H A C .\n\\]\n\nLet \\(M\\) be the intersection of \\(A C\\) and \\(G H\\), and let \\(D \\neq A\\) be the point on the line \\(A C\\) such that \\(A H=H D\\). Then \\(\\angle M J I=\\angle H A C=\\angle M D H\\).\n\nSince \\(\\angle M J I=\\angle M D H, \\angle I M J=\\angle H M D\\), and \\(I M=M H\\), the triangles \\(I M J\\) and \\(H M D\\) are congruent, and thus \\(I J=H D=A H\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-44}\n\nComment. Instead of introducing the point \\(D\\), one can complete the solution by using the law of sines in the triangles \\(I J M\\) and \\(A M H\\), yielding\n\n\\[\n\\frac{I J}{I M}=\\frac{\\sin \\angle I M J}{\\sin \\angle M J I}=\\frac{\\sin \\angle A M H}{\\sin \\angle H A M}=\\frac{A H}{M H}=\\frac{A H}{I M} .\n\\]\n\nSolution 2. Obtain \\(\\angle C G H=\\angle H A C\\) as in the previous solution. In the parallelogram \\(A B G H\\) we have \\(\\angle B A H=\\angle H G B\\). It follows that\n\n\\[\n\\angle H M C=\\angle B A C=\\angle B A H+\\angle H A C=\\angle H G B+\\angle C G H=\\angle C G B .\n\\]\n\nSo the right triangles \\(C M H\\) and \\(C G B\\) are similar. Also, in the circumcircle of triangle \\(G C I\\) we have similar triangles \\(M I J\\) and \\(M C G\\). Therefore,\n\n\\[\n\\frac{I J}{C G}=\\frac{M I}{M C}=\\frac{M H}{M C}=\\frac{G B}{G C}=\\frac{A H}{C G} .\n\\]\n\nHence \\(I J=A H\\)."}
{"id": "imo-shortlist-2015-g2", "question": "G2. Let \\(A B C\\) be a triangle inscribed into a circle \\(\\Omega\\) with center \\(O\\). A circle \\(\\Gamma\\) with center \\(A\\) meets the side \\(B C\\) at points \\(D\\) and \\(E\\) such that \\(D\\) lies between \\(B\\) and \\(E\\). Moreover, let \\(F\\) and \\(G\\) be the common points of \\(\\Gamma\\) and \\(\\Omega\\). We assume that \\(F\\) lies on the arc \\(A B\\) of \\(\\Omega\\) not containing \\(C\\), and \\(G\\) lies on the arc \\(A C\\) of \\(\\Omega\\) not containing \\(B\\). The circumcircles of the triangles \\(B D F\\) and \\(C E G\\) meet the sides \\(A B\\) and \\(A C\\) again at \\(K\\) and \\(L\\), respectively. Suppose that the lines \\(F K\\) and \\(G L\\) are distinct and intersect at \\(X\\). Prove that the points \\(A, X\\), and \\(O\\) are collinear.", "category": "Geometry", "source": "IMO Shortlist", "year": 2015, "solution": "It suffices to prove that the lines \\(F K\\) and \\(G L\\) are symmetric about \\(A O\\). Now the segments \\(A F\\) and \\(A G\\), being chords of \\(\\Omega\\) with the same length, are clearly symmetric with respect to \\(A O\\). Hence it is enough to show\n\n\\[\n\\angle K F A=\\angle A G L .\n\\]\n\nLet us denote the circumcircles of \\(B D F\\) and \\(C E G\\) by \\(\\omega_{B}\\) and \\(\\omega_{C}\\), respectively. To prove (1), we start from\n\n\\[\n\\angle K F A=\\angle D F G+\\angle G F A-\\angle D F K .\n\\]\n\nIn view of the circles \\(\\omega_{B}, \\Gamma\\), and \\(\\Omega\\), this may be rewritten as\n\n\\[\n\\angle K F A=\\angle C E G+\\angle G B A-\\angle D B K=\\angle C E G-\\angle C B G .\n\\]\n\nDue to the circles \\(\\omega_{C}\\) and \\(\\Omega\\), we obtain \\(\\angle K F A=\\angle C L G-\\angle C A G=\\angle A G L\\). Thereby the problem is solved.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-45}\n\nFigure 1\n\nSolution 2. Again, we denote the circumcircle of \\(B D K F\\) by \\(\\omega_{B}\\). In addition, we set \\(\\alpha=\\) \\(\\angle B A C, \\varphi=\\angle A B F\\), and \\(\\psi=\\angle E D A=\\angle A E D\\) (see Figure 2). Notice that \\(A F=A G\\) entails \\(\\varphi=\\angle G C A\\), so all three of \\(\\alpha, \\varphi\\), and \\(\\psi\\) respect the \"symmetry\" between \\(B\\) and \\(C\\) of our configuration. Again, we reduce our task to proving (1).\n\nThis time, we start from\n\n\\[\n2 \\angle K F A=2(\\angle D F A-\\angle D F K) .\n\\]\n\nSince the triangle \\(A F D\\) is isosceles, we have\n\n\\[\n\\angle D F A=\\angle A D F=\\angle E D F-\\psi=\\angle B F D+\\angle E B F-\\psi .\n\\]\n\nMoreover, because of the circle \\(\\omega_{B}\\) we have \\(\\angle D F K=\\angle C B A\\). Altogether, this yields\n\n\\[\n2 \\angle K F A=\\angle D F A+(\\angle B F D+\\angle E B F-\\psi)-2 \\angle C B A,\n\\]\n\nwhich simplifies to\n\n\\[\n2 \\angle K F A=\\angle B F A+\\varphi-\\psi-\\angle C B A\n\\]\n\nNow the quadrilateral \\(A F B C\\) is cyclic, so this entails \\(2 \\angle K F A=\\alpha+\\varphi-\\psi\\).\nDue to the \"symmetry\" between \\(B\\) and \\(C\\) alluded to above, this argument also shows that \\(2 \\angle A G L=\\alpha+\\varphi-\\psi\\). This concludes the proof of (1).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-46}\n\nFigure 2\n\nComment 1. As the first solution shows, the assumption that \\(A\\) be the center of \\(\\Gamma\\) may be weakened to the following one: The center of \\(\\Gamma\\) lies on the line \\(O A\\). The second solution may be modified to yield the same result.\n\nComment 2. It might be interesting to remark that \\(\\angle G D K=90^{\\circ}\\). To prove this, let \\(G^{\\prime}\\) denote the point on \\(\\Gamma\\) diametrically opposite to \\(G\\). Because of \\(\\angle K D F=\\angle K B F=\\angle A G F=\\angle G^{\\prime} D F\\), the points \\(D, K\\), and \\(G^{\\prime}\\) are collinear, which leads to the desired result. Notice that due to symmetry we also have \\(\\angle L E F=90^{\\circ}\\).\n\nMoreover, a standard argument shows that the triangles \\(A G L\\) and \\(B G E\\) are similar. By symmetry again, also the triangles \\(A F K\\) and \\(C D F\\) are similar.\n\nThere are several ways to derive a solution from these facts. For instance, one may argue that\n\n\\[\n\\begin{aligned}\n\\angle K F A & =\\angle B F A-\\angle B F K=\\angle B F A-\\angle E D G^{\\prime}=\\left(180^{\\circ}-\\angle A G B\\right)-\\left(180^{\\circ}-\\angle G^{\\prime} G E\\right) \n& =\\angle A G E-\\angle A G B=\\angle B G E=\\angle A G L\n\n\\]\n\nComment 3. The original proposal did not contain the point \\(X\\) in the assumption and asked instead to prove that the lines \\(F K, G L\\), and \\(A O\\) are concurrent. This differs from the version given above only insofar as it also requires to show that these lines cannot be parallel. The Problem Selection Committee removed this part from the problem intending to make it thus more suitable for the Olympiad.\n\nFor the sake of completeness, we would still like to sketch one possibility for proving \\(F K \\nVdash A O\\) here. As the points \\(K\\) and \\(O\\) lie in the angular region \\(\\angle F A G\\), it suffices to check \\(\\angle K F A+\\angle F A O<180^{\\circ}\\). Multiplying by 2 and making use of the formulae from the second solution, we see that this is equivalent to \\((\\alpha+\\varphi-\\psi)+\\left(180^{\\circ}-2 \\varphi\\right)<360^{\\circ}\\), which in turn is an easy consequence of \\(\\alpha<180^{\\circ}\\)."}
{"id": "imo-shortlist-2015-g3", "question": "G3. Let \\(A B C\\) be a triangle with \\(\\angle C=90^{\\circ}\\), and let \\(H\\) be the foot of the altitude from \\(C\\). A point \\(D\\) is chosen inside the triangle \\(C B H\\) so that \\(C H\\) bisects \\(A D\\). Let \\(P\\) be the intersection point of the lines \\(B D\\) and \\(C H\\). Let \\(\\omega\\) be the semicircle with diameter \\(B D\\) that meets the segment \\(C B\\) at an interior point. A line through \\(P\\) is tangent to \\(\\omega\\) at \\(Q\\). Prove that the lines \\(C Q\\) and \\(A D\\) meet on \\(\\omega\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2015, "solution": "Let \\(K\\) be the projection of \\(D\\) onto \\(A B\\); then \\(A H=H K\\) (see Figure 1). Since \\(P H \\| D K\\), we have\n\n\\[\n\\frac{P D}{P B}=\\frac{H K}{H B}=\\frac{A H}{H B} .\n\\]\n\nLet \\(L\\) be the projection of \\(Q\\) onto \\(D B\\). Since \\(P Q\\) is tangent to \\(\\omega\\) and \\(\\angle D Q B=\\angle B L Q=\\) \\(90^{\\circ}\\), we have \\(\\angle P Q D=\\angle Q B P=\\angle D Q L\\). Therefore, \\(Q D\\) and \\(Q B\\) are respectively the internal and the external bisectors of \\(\\angle P Q L\\). By the angle bisector theorem, we obtain\n\n\\[\n\\frac{P D}{D L}=\\frac{P Q}{Q L}=\\frac{P B}{B L} .\n\\]\n\nThe relations (1) and (2) yield \\(\\frac{A H}{H B}=\\frac{P D}{P B}=\\frac{D L}{L B}\\). So, the spiral similarity \\(\\tau\\) centered at \\(B\\) and sending \\(A\\) to \\(D\\) maps \\(H\\) to \\(L\\). Moreover, \\(\\tau\\) sends the semicircle with diameter \\(A B\\) passing through \\(C\\) to \\(\\omega\\). Due to \\(C H \\perp A B\\) and \\(Q L \\perp D B\\), it follows that \\(\\tau(C)=Q\\).\n\nHence, the triangles \\(A B D\\) and \\(C B Q\\) are similar, so \\(\\angle A D B=\\angle C Q B\\). This means that the lines \\(A D\\) and \\(C Q\\) meet at some point \\(T\\), and this point satisfies \\(\\angle B D T=\\angle B Q T\\). Therefore, \\(T\\) lies on \\(\\omega\\), as needed.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-47}\n\nFigure 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-47(1)}\n\nFigure 2\n\nComment 1. Since \\(\\angle B A D=\\angle B C Q\\), the point \\(T\\) lies also on the circumcircle of the triangle \\(A B C\\).\nSolution 2. Let \\(\\Gamma\\) be the circumcircle of \\(A B C\\), and let \\(A D\\) meet \\(\\omega\\) at \\(T\\). Then \\(\\angle A T B=\\) \\(\\angle A C B=90^{\\circ}\\), so \\(T\\) lies on \\(\\Gamma\\) as well. As in the previous solution, let \\(K\\) be the projection of \\(D\\) onto \\(A B\\); then \\(A H=H K\\) (see Figure 2).\n\nOur goal now is to prove that the points \\(C, Q\\), and \\(T\\) are collinear. Let \\(C T\\) meet \\(\\omega\\) again at \\(Q^{\\prime}\\). Then, it suffices to show that \\(P Q^{\\prime}\\) is tangent to \\(\\omega\\), or that \\(\\angle P Q^{\\prime} D=\\angle Q^{\\prime} B D\\).\n\nSince the quadrilateral \\(B D Q^{\\prime} T\\) is cyclic and the triangles \\(A H C\\) and \\(K H C\\) are congruent, we have \\(\\angle Q^{\\prime} B D=\\angle Q^{\\prime} T D=\\angle C T A=\\angle C B A=\\angle A C H=\\angle H C K\\). Hence, the right triangles \\(C H K\\) and \\(B Q^{\\prime} D\\) are similar. This implies that \\(\\frac{H K}{C K}=\\frac{Q^{\\prime} D}{B D}\\), and thus \\(H K \\cdot B D=C K \\cdot Q^{\\prime} D\\).\n\nNotice that \\(P H \\| D K\\); therefore, we have \\(\\frac{P D}{B D}=\\frac{H K}{B K}\\), and so \\(P D \\cdot B K=H K \\cdot B D\\). Consequently, \\(P D \\cdot B K=H K \\cdot B D=C K \\cdot Q^{\\prime} D\\), which yields \\(\\frac{P D}{Q^{\\prime} D}=\\frac{C K}{B K}\\).\n\nSince \\(\\angle C K A=\\angle K A C=\\angle B D Q^{\\prime}\\), the triangles \\(C K B\\) and \\(P D Q^{\\prime}\\) are similar, so \\(\\angle P Q^{\\prime} D=\\) \\(\\angle C B A=\\angle Q^{\\prime} B D\\), as required.\n\nComment 2. There exist several other ways to prove that \\(P Q^{\\prime}\\) is tangent to \\(\\omega\\). For instance, one may compute \\(\\frac{P D}{P B}\\) and \\(\\frac{P Q^{\\prime}}{P B}\\) in terms of \\(A H\\) and \\(H B\\) to verify that \\(P Q^{\\prime 2}=P D \\cdot P B\\), concluding that \\(P Q^{\\prime}\\) is tangent to \\(\\omega\\).\n\nAnother possible approach is the following. As in Solution 2, we introduce the points \\(T\\) and \\(Q^{\\prime}\\) and mention that the triangles \\(A B C\\) and \\(D B Q^{\\prime}\\) are similar (see Figure 3).\n\nLet \\(M\\) be the midpoint of \\(A D\\), and let \\(L\\) be the projection of \\(Q^{\\prime}\\) onto \\(A B\\). Construct \\(E\\) on the line \\(A B\\) so that \\(E P\\) is parallel to \\(A D\\). Projecting from \\(P\\), we get \\((A, B ; H, E)=(A, D ; M, \\infty)=-1\\).\n\nSince \\(\\frac{E A}{A B}=\\frac{P D}{D B}\\), the point \\(P\\) is the image of \\(E\\) under the similarity transform mapping \\(A B C\\) to \\(D B Q^{\\prime}\\). Therefore, we have \\((D, B ; L, P)=(A, B ; H, E)=-1\\), which means that \\(Q^{\\prime} D\\) and \\(Q^{\\prime} B\\) are respectively the internal and the external bisectors of \\(\\angle P Q^{\\prime} L\\). This implies that \\(P Q^{\\prime}\\) is tangent to \\(\\omega\\), as required.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-48}\n\nFigure 3\nSolution 3. Introduce the points \\(T\\) and \\(Q^{\\prime}\\) as in the previous solution. Note that \\(T\\) lies on the circumcircle of \\(A B C\\). Here we present yet another proof that \\(P Q^{\\prime}\\) is tangent to \\(\\omega\\).\n\nLet \\(\\Omega\\) be the circle completing the semicircle \\(\\omega\\). Construct a point \\(F\\) symmetric to \\(C\\) with respect to \\(A B\\). Let \\(S \\neq T\\) be the second intersection point of \\(F T\\) and \\(\\Omega\\) (see Figure 4).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-48(1)}\n\nFigure 4\nSince \\(A C=A F\\), we have \\(\\angle D K C=\\angle H C K=\\angle C B A=\\angle C T A=\\angle D T S=180^{\\circ}-\\) \\(\\angle S K D\\). Thus, the points \\(C, K\\), and \\(S\\) are collinear. Notice also that \\(\\angle Q^{\\prime} K D=\\angle Q^{\\prime} T D=\\) \\(\\angle H C K=\\angle K F H=180^{\\circ}-\\angle D K F\\). This implies that the points \\(F, K\\), and \\(Q^{\\prime}\\) are collinear.\n\nApplying Pascal's theorem to the degenerate hexagon \\(K Q^{\\prime} Q^{\\prime} T S S\\), we get that the tangents to \\(\\Omega\\) passing through \\(Q^{\\prime}\\) and \\(S\\) intersect on \\(C F\\). The relation \\(\\angle Q^{\\prime} T D=\\angle D T S\\) yields that \\(Q^{\\prime}\\) and \\(S\\) are symmetric with respect to \\(B D\\). Therefore, the two tangents also intersect on \\(B D\\). Thus, the two tangents pass through \\(P\\). Hence, \\(P Q^{\\prime}\\) is tangent to \\(\\omega\\), as needed."}
{"id": "imo-shortlist-2015-g4", "question": "G4. Let \\(A B C\\) be an acute triangle, and let \\(M\\) be the midpoint of \\(A C\\). A circle \\(\\omega\\) passing through \\(B\\) and \\(M\\) meets the sides \\(A B\\) and \\(B C\\) again at \\(P\\) and \\(Q\\), respectively. Let \\(T\\) be the point such that the quadrilateral \\(B P T Q\\) is a parallelogram. Suppose that \\(T\\) lies on the circumcircle of the triangle \\(A B C\\). Determine all possible values of \\(B T / B M\\).\n\nAnswer. \\(\\sqrt{2}\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2015, "solution": "Let \\(S\\) be the center of the parallelogram \\(B P T Q\\), and let \\(B^{\\prime} \\neq B\\) be the point on the ray \\(B M\\) such that \\(B M=M B^{\\prime}\\) (see Figure 1). It follows that \\(A B C B^{\\prime}\\) is a parallelogram. Then, \\(\\angle A B B^{\\prime}=\\angle P Q M\\) and \\(\\angle B B^{\\prime} A=\\angle B^{\\prime} B C=\\angle M P Q\\), and so the triangles \\(A B B^{\\prime}\\) and \\(M Q P\\) are similar. It follows that \\(A M\\) and \\(M S\\) are corresponding medians in these triangles. Hence,\n\n\\[\n\\angle S M P=\\angle B^{\\prime} A M=\\angle B C A=\\angle B T A .\n\\]\n\nSince \\(\\angle A C T=\\angle P B T\\) and \\(\\angle T A C=\\angle T B C=\\angle B T P\\), the triangles \\(T C A\\) and \\(P B T\\) are similar. Again, as \\(T M\\) and \\(P S\\) are corresponding medians in these triangles, we have\n\n\\[\n\\angle M T A=\\angle T P S=\\angle B Q P=\\angle B M P .\n\\]\n\nNow we deal separately with two cases.\nCase 1. \\(S\\) does not lie on \\(B M\\). Since the configuration is symmetric between \\(A\\) and \\(C\\), we may assume that \\(S\\) and \\(A\\) lie on the same side with respect to the line \\(B M\\).\n\nApplying (1) and (2), we get\n\n\\[\n\\angle B M S=\\angle B M P-\\angle S M P=\\angle M T A-\\angle B T A=\\angle M T B,\n\\]\n\nand so the triangles \\(B S M\\) and \\(B M T\\) are similar. We now have \\(B M^{2}=B S \\cdot B T=B T^{2} / 2\\), so \\(B T=\\sqrt{2} B M\\).\n\nCase 2. \\(S\\) lies on \\(B M\\). It follows from (2) that \\(\\angle B C A=\\angle M T A=\\angle B Q P=\\angle B M P\\) (see Figure 2). Thus, \\(P Q \\| A C\\) and \\(P M \\| A T\\). Hence, \\(B S / B M=B P / B A=B M / B T\\), so \\(B T^{2}=2 B M^{2}\\) and \\(B T=\\sqrt{2} B M\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-49}\n\nFigure 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-49(1)}\n\nFigure 2\n\nComment 1. Here is another way to show that the triangles \\(B S M\\) and \\(B M T\\) are similar. Denote by \\(\\Omega\\) the circumcircle of the triangle \\(A B C\\). Let \\(R\\) be the second point of intersection of \\(\\omega\\) and \\(\\Omega\\), and let \\(\\tau\\) be the spiral similarity centered at \\(R\\) mapping \\(\\omega\\) to \\(\\Omega\\). Then, one may show that \\(\\tau\\) maps each point \\(X\\) on \\(\\omega\\) to a point \\(Y\\) on \\(\\Omega\\) such that \\(B, X\\), and \\(Y\\) are collinear (see Figure 3). If we let \\(K\\) and \\(L\\) be the second points of intersection of \\(B M\\) with \\(\\Omega\\) and of \\(B T\\) with \\(\\omega\\), respectively, then it follows that the triangle \\(M K T\\) is the image of \\(S M L\\) under \\(\\tau\\). We now obtain \\(\\angle B S M=\\angle T M B\\), which implies the desired result.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-50}\n\nFigure 3\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-50(1)}\n\nFigure 4\n\nSolution 2. Again, we denote by \\(\\Omega\\) the circumcircle of the triangle \\(A B C\\).\nChoose the points \\(X\\) and \\(Y\\) on the rays \\(B A\\) and \\(B C\\) respectively, so that \\(\\angle M X B=\\angle M B C\\) and \\(\\angle B Y M=\\angle A B M\\) (see Figure 4). Then the triangles \\(B M X\\) and \\(Y M B\\) are similar. Since \\(\\angle X P M=\\angle B Q M\\), the points \\(P\\) and \\(Q\\) correspond to each other in these triangles. So, if \\(\\overrightarrow{B P}=\\mu \\cdot \\overrightarrow{B X}\\), then \\(\\overrightarrow{B Q}=(1-\\mu) \\cdot \\overrightarrow{B Y}\\). Thus\n\n\\[\n\\overrightarrow{B T}=\\overrightarrow{B P}+\\overrightarrow{B Q}=\\overrightarrow{B Y}+\\mu \\cdot(\\overrightarrow{B X}-\\overrightarrow{B Y})=\\overrightarrow{B Y}+\\mu \\cdot \\overrightarrow{Y X}\n\\]\n\nwhich means that \\(T\\) lies on the line \\(X Y\\).\nLet \\(B^{\\prime} \\neq B\\) be the point on the ray \\(B M\\) such that \\(B M=M B^{\\prime}\\). Then \\(\\angle M B^{\\prime} A=\\) \\(\\angle M B C=\\angle M X B\\) and \\(\\angle C B^{\\prime} M=\\angle A B M=\\angle B Y M\\). This means that the triangles \\(B M X\\), \\(B A B^{\\prime}, Y M B\\), and \\(B^{\\prime} C B\\) are all similar; hence \\(B A \\cdot B X=B M \\cdot B B^{\\prime}=B C \\cdot B Y\\). Thus there exists an inversion centered at \\(B\\) which swaps \\(A\\) with \\(X, M\\) with \\(B^{\\prime}\\), and \\(C\\) with \\(Y\\). This inversion then swaps \\(\\Omega\\) with the line \\(X Y\\), and hence it preserves \\(T\\). Therefore, we have \\(B T^{2}=B M \\cdot B B^{\\prime}=2 B M^{2}\\), and \\(B T=\\sqrt{2} B M\\).\n\nSolution 3. We begin with the following lemma.\nLemma. Let \\(A B C T\\) be a cyclic quadrilateral. Let \\(P\\) and \\(Q\\) be points on the sides \\(B A\\) and \\(B C\\) respectively, such that \\(B P T Q\\) is a parallelogram. Then \\(B P \\cdot B A+B Q \\cdot B C=B T^{2}\\).\nProof. Let the circumcircle of the triangle \\(Q T C\\) meet the line \\(B T\\) again at \\(J\\) (see Figure 5). The power of \\(B\\) with respect to this circle yields\n\n\\[\nB Q \\cdot B C=B J \\cdot B T\n\\]\n\nWe also have \\(\\angle T J Q=180^{\\circ}-\\angle Q C T=\\angle T A B\\) and \\(\\angle Q T J=\\angle A B T\\), and so the triangles \\(T J Q\\) and \\(B A T\\) are similar. We now have \\(T J / T Q=B A / B T\\). Therefore,\n\n\\[\nT J \\cdot B T=T Q \\cdot B A=B P \\cdot B A .\n\\]\n\nCombining (3) and (4) now yields the desired result.\nLet \\(X\\) and \\(Y\\) be the midpoints of \\(B A\\) and \\(B C\\) respectively (see Figure 6). Applying the lemma to the cyclic quadrilaterals \\(P B Q M\\) and \\(A B C T\\), we obtain\n\n\\[\nB X \\cdot B P+B Y \\cdot B Q=B M^{2}\n\\]\n\nand\n\n\\[\nB P \\cdot B A+B Q \\cdot B C=B T^{2} .\n\\]\n\nSince \\(B A=2 B X\\) and \\(B C=2 B Y\\), we have \\(B T^{2}=2 B M^{2}\\), and so \\(B T=\\sqrt{2} B M\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-51(1)}\n\nFigure 5\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-51}\n\nFigure 6\n\nComment 2. Here we give another proof of the lemma using Ptolemy's theorem. We readily have\n\n\\[\nT C \\cdot B A+T A \\cdot B C=A C \\cdot B T .\n\\]\n\nThe lemma now follows from\n\n\\[\n\\frac{B P}{T C}=\\frac{B Q}{T A}=\\frac{B T}{A C}=\\frac{\\sin \\angle B C T}{\\sin \\angle A B C} .\n\\]"}
{"id": "imo-shortlist-2015-g5", "question": "G5. Let \\(A B C\\) be a triangle with \\(C A \\neq C B\\). Let \\(D, F\\), and \\(G\\) be the midpoints of the sides \\(A B, A C\\), and \\(B C\\), respectively. A circle \\(\\Gamma\\) passing through \\(C\\) and tangent to \\(A B\\) at \\(D\\) meets the segments \\(A F\\) and \\(B G\\) at \\(H\\) and \\(I\\), respectively. The points \\(H^{\\prime}\\) and \\(I^{\\prime}\\) are symmetric to \\(H\\) and \\(I\\) about \\(F\\) and \\(G\\), respectively. The line \\(H^{\\prime} I^{\\prime}\\) meets \\(C D\\) and \\(F G\\) at \\(Q\\) and \\(M\\), respectively. The line \\(C M\\) meets \\(\\Gamma\\) again at \\(P\\). Prove that \\(C Q=Q P\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2015, "solution": "We may assume that \\(C A>C B\\). Observe that \\(H^{\\prime}\\) and \\(I^{\\prime}\\) lie inside the segments \\(C F\\) and \\(C G\\), respectively. Therefore, \\(M\\) lies outside \\(\\triangle A B C\\) (see Figure 1).\n\nDue to the powers of points \\(A\\) and \\(B\\) with respect to the circle \\(\\Gamma\\), we have\n\n\\[\nC H^{\\prime} \\cdot C A=A H \\cdot A C=A D^{2}=B D^{2}=B I \\cdot B C=C I^{\\prime} \\cdot C B .\n\\]\n\nTherefore, \\(C H^{\\prime} \\cdot C F=C I^{\\prime} \\cdot C G\\). Hence, the quadrilateral \\(H^{\\prime} I^{\\prime} G F\\) is cyclic, and so \\(\\angle I^{\\prime} H^{\\prime} C=\\) \\(\\angle C G F\\).\n\nLet \\(D F\\) and \\(D G\\) meet \\(\\Gamma\\) again at \\(R\\) and \\(S\\), respectively. We claim that the points \\(R\\) and \\(S\\) lie on the line \\(H^{\\prime} I^{\\prime}\\).\n\nObserve that \\(F H^{\\prime} \\cdot F A=F H \\cdot F C=F R \\cdot F D\\). Thus, the quadrilateral \\(A D H^{\\prime} R\\) is cyclic, and hence \\(\\angle R H^{\\prime} F=\\angle F D A=\\angle C G F=\\angle I^{\\prime} H^{\\prime} C\\). Therefore, the points \\(R, H^{\\prime}\\), and \\(I^{\\prime}\\) are collinear. Similarly, the points \\(S, H^{\\prime}\\), and \\(I^{\\prime}\\) are also collinear, and so all the points \\(R, H^{\\prime}, Q, I^{\\prime}, S\\), and \\(M\\) are all collinear.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-52}\n\nFigure 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-52(1)}\n\nFigure 2\n\nThen, \\(\\angle R S D=\\angle R D A=\\angle D F G\\). Hence, the quadrilateral \\(R S G F\\) is cyclic (see Figure 2). Therefore, \\(M H^{\\prime} \\cdot M I^{\\prime}=M F \\cdot M G=M R \\cdot M S=M P \\cdot M C\\). Thus, the quadrilateral \\(C P I^{\\prime} H^{\\prime}\\) is also cyclic. Let \\(\\omega\\) be its circumcircle.\n\nNotice that \\(\\angle H^{\\prime} C Q=\\angle S D C=\\angle S R C\\) and \\(\\angle Q C I^{\\prime}=\\angle C D R=\\angle C S R\\). Hence, \\(\\triangle C H^{\\prime} Q \\sim \\triangle R C Q\\) and \\(\\triangle C I^{\\prime} Q \\sim \\triangle S C Q\\), and therefore \\(Q H^{\\prime} \\cdot Q R=Q C^{2}=Q I^{\\prime} \\cdot Q S\\).\n\nWe apply the inversion with center \\(Q\\) and radius \\(Q C\\). Observe that the points \\(R, C\\), and \\(S\\) are mapped to \\(H^{\\prime}, C\\), and \\(I^{\\prime}\\), respectively. Therefore, the circumcircle \\(\\Gamma\\) of \\(\\triangle R C S\\) is mapped to the circumcircle \\(\\omega\\) of \\(\\triangle H^{\\prime} C I^{\\prime}\\). Since \\(P\\) and \\(C\\) belong to both circles and the point \\(C\\) is preserved by the inversion, we have that \\(P\\) is also mapped to itself. We then get \\(Q P^{2}=Q C^{2}\\). Hence, \\(Q P=Q C\\).\n\nComment 1. The problem statement still holds when \\(\\Gamma\\) intersects the sides \\(C A\\) and \\(C B\\) outside segments \\(A F\\) and \\(B G\\), respectively.\n\nSolution 2. Let \\(X=H I \\cap A B\\), and let the tangent to \\(\\Gamma\\) at \\(C\\) meet \\(A B\\) at \\(Y\\). Let \\(X C\\) meet \\(\\Gamma\\) again at \\(X^{\\prime}\\) (see Figure 3). Projecting from \\(C, X\\), and \\(C\\) again, we have \\((X, A ; D, B)=\\) \\(\\left(X^{\\prime}, H ; D, I\\right)=(C, I ; D, H)=(Y, B ; D, A)\\). Since \\(A\\) and \\(B\\) are symmetric about \\(D\\), it follows that \\(X\\) and \\(Y\\) are also symmetric about \\(D\\).\n\nNow, Menelaus' theorem applied to \\(\\triangle A B C\\) with the line HIX yields\n\n\\[\n1=\\frac{C H}{H A} \\cdot \\frac{B I}{I C} \\cdot \\frac{A X}{X B}=\\frac{A H^{\\prime}}{H^{\\prime} C} \\cdot \\frac{C I^{\\prime}}{I^{\\prime} B} \\cdot \\frac{B Y}{Y A} .\n\\]\n\nBy the converse of Menelaus' theorem applied to \\(\\triangle A B C\\) with points \\(H^{\\prime}, I^{\\prime}, Y\\), we get that the points \\(H^{\\prime}, I^{\\prime}, Y\\) are collinear.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-53}\n\nFigure 3\nLet \\(T\\) be the midpoint of \\(C D\\), and let \\(O\\) be the center of \\(\\Gamma\\). Let \\(C M\\) meet \\(T Y\\) at \\(N\\). To avoid confusion, we clean some superfluous details out of the picture (see Figure 4).\n\nLet \\(V=M T \\cap C Y\\). Since \\(M T \\| Y D\\) and \\(D T=T C\\), we get \\(C V=V Y\\). Then Ceva's theorem applied to \\(\\triangle C T Y\\) with the point \\(M\\) yields\n\n\\[\n1=\\frac{T Q}{Q C} \\cdot \\frac{C V}{V Y} \\cdot \\frac{Y N}{N T}=\\frac{T Q}{Q C} \\cdot \\frac{Y N}{N T} .\n\\]\n\nTherefore, \\(\\frac{T Q}{Q C}=\\frac{T N}{N Y}\\). So, \\(N Q \\| C Y\\), and thus \\(N Q \\perp O C\\).\nNote that the points \\(O, N, T\\), and \\(Y\\) are collinear. Therefore, \\(C Q \\perp O N\\). So, \\(Q\\) is the orthocenter of \\(\\triangle O C N\\), and hence \\(O Q \\perp C P\\). Thus, \\(Q\\) lies on the perpendicular bisector of \\(C P\\), and therefore \\(C Q=Q P\\), as required.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-53(1)}\n\nFigure 4\n\nComment 2. The second part of Solution 2 provides a proof of the following more general statement, which does not involve a specific choice of \\(Q\\) on \\(C D\\).\n\nLet \\(Y C\\) and \\(Y D\\) be two tangents to a circle \\(\\Gamma\\) with center \\(O\\) (see Figure 4). Let \\(\\ell\\) be the midline of \\(\\triangle Y C D\\) parallel to \\(Y D\\). Let \\(Q\\) and \\(M\\) be two points on \\(C D\\) and \\(\\ell\\), respectively, such that the line \\(Q M\\) passes through \\(Y\\). Then \\(O Q \\perp C M\\)."}
{"id": "imo-shortlist-2015-g6", "question": "G6. Let \\(A B C\\) be an acute triangle with \\(A B>A C\\), and let \\(\\Gamma\\) be its circumcircle. Let \\(H\\), \\(M\\), and \\(F\\) be the orthocenter of the triangle, the midpoint of \\(B C\\), and the foot of the altitude from \\(A\\), respectively. Let \\(Q\\) and \\(K\\) be the two points on \\(\\Gamma\\) that satisfy \\(\\angle A Q H=90^{\\circ}\\) and \\(\\angle Q K H=90^{\\circ}\\). Prove that the circumcircles of the triangles \\(K Q H\\) and \\(K F M\\) are tangent to each other.", "category": "Geometry", "source": "IMO Shortlist", "year": 2015, "solution": "Let \\(A^{\\prime}\\) be the point diametrically opposite to \\(A\\) on \\(\\Gamma\\). Since \\(\\angle A Q A^{\\prime}=90^{\\circ}\\) and \\(\\angle A Q H=90^{\\circ}\\), the points \\(Q, H\\), and \\(A^{\\prime}\\) are collinear. Similarly, if \\(Q^{\\prime}\\) denotes the point on \\(\\Gamma\\) diametrically opposite to \\(Q\\), then \\(K, H\\), and \\(Q^{\\prime}\\) are collinear. Let the line \\(A H F\\) intersect \\(\\Gamma\\) again at \\(E\\); it is known that \\(M\\) is the midpoint of the segment \\(H A^{\\prime}\\) and that \\(F\\) is the midpoint of \\(H E\\). Let \\(J\\) be the midpoint of \\(H Q^{\\prime}\\).\n\nConsider any point \\(T\\) such that \\(T K\\) is tangent to the circle \\(K Q H\\) at \\(K\\) with \\(Q\\) and \\(T\\) lying on different sides of \\(K H\\) (see Figure 1). Then \\(\\angle H K T=\\angle H Q K\\) and we are to prove that \\(\\angle M K T=\\angle C F K\\). Thus it remains to show that \\(\\angle H Q K=\\angle C F K+\\angle H K M\\). Due to \\(\\angle H Q K=90^{\\circ}-\\angle Q^{\\prime} H A^{\\prime}\\) and \\(\\angle C F K=90^{\\circ}-\\angle K F A\\), this means the same as \\(\\angle Q^{\\prime} H A^{\\prime}=\\) \\(\\angle K F A-\\angle H K M\\). Now, since the triangles \\(K H E\\) and \\(A H Q^{\\prime}\\) are similar with \\(F\\) and \\(J\\) being the midpoints of corresponding sides, we have \\(\\angle K F A=\\angle H J A\\), and analogously one may obtain \\(\\angle H K M=\\angle J Q H\\). Thereby our task is reduced to verifying\n\n\\[\n\\angle Q^{\\prime} H A^{\\prime}=\\angle H J A-\\angle J Q H .\n\\]\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2025_05_30_8bd4da09f41316bd42acg-55(1)}\n\n\nFigure 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-55}\n\nFigure 2\n\nTo avoid confusion, let us draw a new picture at this moment (see Figure 2). Owing to \\(\\angle Q^{\\prime} H A^{\\prime}=\\angle J Q H+\\angle H J Q\\) and \\(\\angle H J A=\\angle Q J A+\\angle H J Q\\), we just have to show that \\(2 \\angle J Q H=\\angle Q J A\\). To this end, it suffices to remark that \\(A Q A^{\\prime} Q^{\\prime}\\) is a rectangle and that \\(J\\), being defined to be the midpoint of \\(H Q^{\\prime}\\), has to lie on the mid parallel of \\(Q A^{\\prime}\\) and \\(Q^{\\prime} A\\).\n\nSolution 2. We define the points \\(A^{\\prime}\\) and \\(E\\) and prove that the ray \\(M H\\) passes through \\(Q\\) in the same way as in the first solution. Notice that the points \\(A^{\\prime}\\) and \\(E\\) can play analogous roles to the points \\(Q\\) and \\(K\\), respectively: point \\(A^{\\prime}\\) is the second intersection of the line \\(M H\\) with \\(\\Gamma\\), and \\(E\\) is the point on \\(\\Gamma\\) with the property \\(\\angle H E A^{\\prime}=90^{\\circ}\\) (see Figure 3).\n\nIn the circles \\(K Q H\\) and \\(E A^{\\prime} H\\), the line segments \\(H Q\\) and \\(H A^{\\prime}\\) are diameters, respectively; so, these circles have a common tangent \\(t\\) at \\(H\\), perpendicular to \\(M H\\). Let \\(R\\) be the radical center of the circles \\(A B C, K Q H\\) and \\(E A^{\\prime} H\\). Their pairwise radical axes are the lines \\(Q K\\), \\(A^{\\prime} E\\) and the line \\(t\\); they all pass through \\(R\\). Let \\(S\\) be the midpoint of \\(H R\\); by \\(\\angle Q K H=\\)\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-56}\n\nFigure 3\n\\(\\angle H E A^{\\prime}=90^{\\circ}\\), the quadrilateral \\(H E R K\\) is cyclic and its circumcenter is \\(S\\); hence we have \\(S K=S E=S H\\). The line \\(B C\\), being the perpendicular bisector of \\(H E\\), passes through \\(S\\).\n\nThe circle \\(H M F\\) also is tangent to \\(t\\) at \\(H\\); from the power of \\(S\\) with respect to the circle \\(H M F\\) we have\n\n\\[\nS M \\cdot S F=S H^{2}=S K^{2} .\n\\]\n\nSo, the power of \\(S\\) with respect to the circles \\(K Q H\\) and \\(K F M\\) is \\(S K^{2}\\). Therefore, the line segment \\(S K\\) is tangent to both circles at \\(K\\)."}
{"id": "imo-shortlist-2015-g7", "question": "G7. Let \\(A B C D\\) be a convex quadrilateral, and let \\(P, Q, R\\), and \\(S\\) be points on the sides \\(A B, B C, C D\\), and \\(D A\\), respectively. Let the line segments \\(P R\\) and \\(Q S\\) meet at \\(O\\). Suppose that each of the quadrilaterals \\(A P O S, B Q O P, C R O Q\\), and \\(D S O R\\) has an incircle. Prove that the lines \\(A C, P Q\\), and \\(R S\\) are either concurrent or parallel to each other.", "category": "Geometry", "source": "IMO Shortlist", "year": 2015, "solution": "Denote by \\(\\gamma_{A}, \\gamma_{B}, \\gamma_{C}\\), and \\(\\gamma_{D}\\) the incircles of the quadrilaterals \\(A P O S, B Q O P\\), \\(C R O Q\\), and DSOR, respectively.\n\nWe start with proving that the quadrilateral \\(A B C D\\) also has an incircle which will be referred to as \\(\\Omega\\). Denote the points of tangency as in Figure 1. It is well-known that \\(Q Q_{1}=O O_{1}\\) (if \\(B C \\| P R\\), this is obvious; otherwise, one may regard the two circles involved as the incircle and an excircle of the triangle formed by the lines \\(O Q, P R\\), and \\(B C\\) ). Similarly, \\(O O_{1}=P P_{1}\\). Hence we have \\(Q Q_{1}=P P_{1}\\). The other equalities of segment lengths marked in Figure 1 can be proved analogously. These equalities, together with \\(A P_{1}=A S_{1}\\) and similar ones, yield \\(A B+C D=A D+B C\\), as required.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-57}\n\nFigure 1\n\nNext, let us draw the lines parallel to \\(Q S\\) through \\(P\\) and \\(R\\), and also draw the lines parallel to \\(P R\\) through \\(Q\\) and \\(S\\). These lines form a parallelogram; denote its vertices by \\(A^{\\prime}, B^{\\prime}, C^{\\prime}\\), and \\(D^{\\prime}\\) as shown in Figure 2.\n\nSince the quadrilateral \\(A P O S\\) has an incircle, we have \\(A P-A S=O P-O S=A^{\\prime} S-A^{\\prime} P\\). It is well-known that in this case there also exists a circle \\(\\omega_{A}\\) tangent to the four rays \\(A P\\), \\(A S, A^{\\prime} P\\), and \\(A^{\\prime} S\\). It is worth mentioning here that in case when, say, the lines \\(A B\\) and \\(A^{\\prime} B^{\\prime}\\) coincide, the circle \\(\\omega_{A}\\) is just tangent to \\(A B\\) at \\(P\\). We introduce the circles \\(\\omega_{B}, \\omega_{C}\\), and \\(\\omega_{D}\\) in a similar manner.\n\nAssume that the radii of the circles \\(\\omega_{A}\\) and \\(\\omega_{C}\\) are different. Let \\(X\\) be the center of the homothety having a positive scale factor and mapping \\(\\omega_{A}\\) to \\(\\omega_{C}\\).\n\nNow, Monge's theorem applied to the circles \\(\\omega_{A}, \\Omega\\), and \\(\\omega_{C}\\) shows that the points \\(A, C\\), and \\(X\\) are collinear. Applying the same theorem to the circles \\(\\omega_{A}, \\omega_{B}\\), and \\(\\omega_{C}\\), we see that the points \\(P, Q\\), and \\(X\\) are also collinear. Similarly, the points \\(R, S\\), and \\(X\\) are collinear, as required.\n\nIf the radii of \\(\\omega_{A}\\) and \\(\\omega_{C}\\) are equal but these circles do not coincide, then the degenerate version of the same theorem yields that the three lines \\(A C, P Q\\), and \\(R S\\) are parallel to the line of centers of \\(\\omega_{A}\\) and \\(\\omega_{C}\\).\n\nFinally, we need to say a few words about the case when \\(\\omega_{A}\\) and \\(\\omega_{C}\\) coincide (and thus they also coincide with \\(\\Omega, \\omega_{B}\\), and \\(\\omega_{D}\\) ). It may be regarded as the limit case in the following manner.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-58}\n\nFigure 2\n\nLet us fix the positions of \\(A, P, O\\), and \\(S\\) (thus we also fix the circles \\(\\omega_{A}, \\gamma_{A}, \\gamma_{B}\\), and \\(\\gamma_{D}\\) ). Now we vary the circle \\(\\gamma_{C}\\) inscribed into \\(\\angle Q O R\\); for each of its positions, one may reconstruct the lines \\(B C\\) and \\(C D\\) as the external common tangents to \\(\\gamma_{B}, \\gamma_{C}\\) and \\(\\gamma_{C}, \\gamma_{D}\\) different from \\(P R\\) and \\(Q S\\), respectively. After such variation, the circle \\(\\Omega\\) changes, so the result obtained above may be applied.\n\nSolution 2. Applying Menelaus' theorem to \\(\\triangle A B C\\) with the line \\(P Q\\) and to \\(\\triangle A C D\\) with the line \\(R S\\), we see that the line \\(A C\\) meets \\(P Q\\) and \\(R S\\) at the same point (possibly at infinity) if and only if\n\n\\[\n\\frac{A P}{P B} \\cdot \\frac{B Q}{Q C} \\cdot \\frac{C R}{R D} \\cdot \\frac{D S}{S A}=1\n\\]\n\nSo, it suffices to prove (1).\nWe start with the following result.\nLemma 1. Let \\(E F G H\\) be a circumscribed quadrilateral, and let \\(M\\) be its incenter. Then\n\n\\[\n\\frac{E F \\cdot F G}{G H \\cdot H E}=\\frac{F M^{2}}{H M^{2}}\n\\]\n\nProof. Notice that \\(\\angle E M H+\\angle G M F=\\angle F M E+\\angle H M G=180^{\\circ}, \\angle F G M=\\angle M G H\\), and \\(\\angle H E M=\\angle M E F\\) (see Figure 3). By the law of sines, we get\n\n\\[\n\\frac{E F}{F M} \\cdot \\frac{F G}{F M}=\\frac{\\sin \\angle F M E \\cdot \\sin \\angle G M F}{\\sin \\angle M E F \\cdot \\sin \\angle F G M}=\\frac{\\sin \\angle H M G \\cdot \\sin \\angle E M H}{\\sin \\angle M G H \\cdot \\sin \\angle H E M}=\\frac{G H}{H M} \\cdot \\frac{H E}{H M} .\n\\]\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2025_05_30_8bd4da09f41316bd42acg-59}\n\n\nFigure 3\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-59(2)}\n\nFigure 4\n\nWe denote by \\(I, J, K\\), and \\(L\\) the incenters of the quadrilaterals \\(A P O S, B Q O P, C R O Q\\), and DSOR, respectively. Applying Lemma 1 to these four quadrilaterals we get\n\n\\[\n\\frac{A P \\cdot P O}{O S \\cdot S A} \\cdot \\frac{B Q \\cdot Q O}{O P \\cdot P B} \\cdot \\frac{C R \\cdot R O}{O Q \\cdot Q C} \\cdot \\frac{D S \\cdot S O}{O R \\cdot R D}=\\frac{P I^{2}}{S I^{2}} \\cdot \\frac{Q J^{2}}{P J^{2}} \\cdot \\frac{R K^{2}}{Q K^{2}} \\cdot \\frac{S L^{2}}{R L^{2}},\n\\]\n\nwhich reduces to\n\n\\[\n\\frac{A P}{P B} \\cdot \\frac{B Q}{Q C} \\cdot \\frac{C R}{R D} \\cdot \\frac{D S}{S A}=\\frac{P I^{2}}{P J^{2}} \\cdot \\frac{Q J^{2}}{Q K^{2}} \\cdot \\frac{R K^{2}}{R L^{2}} \\cdot \\frac{S L^{2}}{S I^{2}} .\n\\]\n\nNext, we have \\(\\angle I P J=\\angle J O I=90^{\\circ}\\), and the line \\(O P\\) separates \\(I\\) and \\(J\\) (see Figure 4). This means that the quadrilateral IPJO is cyclic. Similarly, we get that the quadrilateral \\(J Q K O\\) is cyclic with \\(\\angle J Q K=90^{\\circ}\\). Thus, \\(\\angle Q K J=\\angle Q O J=\\angle J O P=\\angle J I P\\). Hence, the right triangles \\(I P J\\) and \\(K Q J\\) are similar. Therefore, \\(\\frac{P I}{P J}=\\frac{Q K}{Q J}\\). Likewise, we obtain \\(\\frac{R K}{R L}=\\frac{S I}{S L}\\). These two equations together with (2) yield (1).\n\nComment. Instead of using the sine law, one may prove Lemma 1 by the following approach.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-59(1)}\n\nFigure 5\n\nLet \\(N\\) be the point such that \\(\\triangle N H G \\sim \\triangle M E F\\) and such that \\(N\\) and \\(M\\) lie on different sides of the line \\(G H\\), as shown in Figure 5. Then \\(\\angle G N H+\\angle H M G=\\angle F M E+\\angle H M G=180^{\\circ}\\). So, the quadrilateral \\(G N H M\\) is cyclic. Thus, \\(\\angle M N H=\\angle M G H=\\angle F G M\\) and \\(\\angle H M N=\\angle H G N=\\) \\(\\angle E F M=\\angle M F G\\). Hence, \\(\\triangle H M N \\sim \\triangle M F G\\). Therefore, \\(\\frac{H M}{H G}=\\frac{H M}{H N} \\cdot \\frac{H N}{H G}=\\frac{M F}{M G} \\cdot \\frac{E M}{E F}\\). Similarly, we obtain \\(\\frac{H M}{H E}=\\frac{M F}{M E} \\cdot \\frac{G M}{G F}\\). By multiplying these two equations, we complete the proof.\n\nSolution 3. We present another approach for showing (1) from Solution 2.\nLemma 2. Let \\(E F G H\\) and \\(E^{\\prime} F^{\\prime} G^{\\prime} H^{\\prime}\\) be circumscribed quadrilaterals such that \\(\\angle E+\\angle E^{\\prime}=\\) \\(\\angle F+\\angle F^{\\prime}=\\angle G+\\angle G^{\\prime}=\\angle H+\\angle H^{\\prime}=180^{\\circ}\\). Then\n\n\\[\n\\frac{E F \\cdot G H}{F G \\cdot H E}=\\frac{E^{\\prime} F^{\\prime} \\cdot G^{\\prime} H^{\\prime}}{F^{\\prime} G^{\\prime} \\cdot H^{\\prime} E^{\\prime}}\n\\]\n\nProof. Let \\(M\\) and \\(M^{\\prime}\\) be the incenters of \\(E F G H\\) and \\(E^{\\prime} F^{\\prime} G^{\\prime} H^{\\prime}\\), respectively. We use the notation [ \\(X Y Z\\) ] for the area of a triangle \\(X Y Z\\).\n\nTaking into account the relation \\(\\angle F M E+\\angle F^{\\prime} M^{\\prime} E^{\\prime}=180^{\\circ}\\) together with the analogous ones, we get\n\n\\[\n\\begin{aligned}\n\\frac{E F \\cdot G H}{F G \\cdot H E} & =\\frac{[M E F] \\cdot[M G H]}{[M F G] \\cdot[M H E]}=\\frac{M E \\cdot M F \\cdot \\sin \\angle F M E \\cdot M G \\cdot M H \\cdot \\sin \\angle H M G}{M F \\cdot M G \\cdot \\sin \\angle G M F \\cdot M H \\cdot M E \\cdot \\sin \\angle E M H} \n& =\\frac{M^{\\prime} E^{\\prime} \\cdot M^{\\prime} F^{\\prime} \\cdot \\sin \\angle F^{\\prime} M^{\\prime} E^{\\prime} \\cdot M^{\\prime} G^{\\prime} \\cdot M^{\\prime} H^{\\prime} \\cdot \\sin \\angle H^{\\prime} M^{\\prime} G^{\\prime}}{M^{\\prime} F^{\\prime} \\cdot M^{\\prime} G^{\\prime} \\cdot \\sin \\angle G^{\\prime} M^{\\prime} F^{\\prime} \\cdot M^{\\prime} H^{\\prime} \\cdot M^{\\prime} E^{\\prime} \\cdot \\sin \\angle E^{\\prime} M^{\\prime} H^{\\prime}}=\\frac{E^{\\prime} F^{\\prime} \\cdot G^{\\prime} H^{\\prime}}{F^{\\prime} G^{\\prime} \\cdot H^{\\prime} E^{\\prime}} .\n\n\\]\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2025_05_30_8bd4da09f41316bd42acg-60}\n\n\nFigure 6\nDenote by \\(h\\) the homothety centered at \\(O\\) that maps the incircle of \\(C R O Q\\) to the incircle of \\(A P O S\\). Let \\(Q^{\\prime}=h(Q), C^{\\prime}=h(C), R^{\\prime}=h(R), O^{\\prime}=O, S^{\\prime}=S, A^{\\prime}=A\\), and \\(P^{\\prime}=P\\). Furthermore, define \\(B^{\\prime}=A^{\\prime} P^{\\prime} \\cap C^{\\prime} Q^{\\prime}\\) and \\(D^{\\prime}=A^{\\prime} S^{\\prime} \\cap C^{\\prime} R^{\\prime}\\) as shown in Figure 6. Then\n\n\\[\n\\frac{A P \\cdot O S}{P O \\cdot S A}=\\frac{A^{\\prime} P^{\\prime} \\cdot O^{\\prime} S^{\\prime}}{P^{\\prime} O^{\\prime} \\cdot S^{\\prime} A^{\\prime}}\n\\]\n\nholds trivially. We also have\n\n\\[\n\\frac{C R \\cdot O Q}{R O \\cdot Q C}=\\frac{C^{\\prime} R^{\\prime} \\cdot O^{\\prime} Q^{\\prime}}{R^{\\prime} O^{\\prime} \\cdot Q^{\\prime} C^{\\prime}}\n\\]\n\nby the similarity of the quadrilaterals \\(C R O Q\\) and \\(C^{\\prime} R^{\\prime} O^{\\prime} Q^{\\prime}\\).\nNext, consider the circumscribed quadrilaterals \\(B Q O P\\) and \\(B^{\\prime} Q^{\\prime} O^{\\prime} P^{\\prime}\\) whose incenters lie on different sides of the quadrilaterals' shared side line \\(O P=O^{\\prime} P^{\\prime}\\). Observe that \\(B Q \\| B^{\\prime} Q^{\\prime}\\) and that \\(B^{\\prime}\\) and \\(Q^{\\prime}\\) lie on the lines \\(B P\\) and \\(Q O\\), respectively. It is now easy to see that the two quadrilaterals satisfy the hypotheses of Lemma 2. Thus, we deduce\n\n\\[\n\\frac{B Q \\cdot O P}{Q O \\cdot P B}=\\frac{B^{\\prime} Q^{\\prime} \\cdot O^{\\prime} P^{\\prime}}{Q^{\\prime} O^{\\prime} \\cdot P^{\\prime} B^{\\prime}}\n\\]\n\nSimilarly, we get\n\n\\[\n\\frac{D S \\cdot O R}{S O \\cdot R D}=\\frac{D^{\\prime} S^{\\prime} \\cdot O^{\\prime} R^{\\prime}}{S^{\\prime} O^{\\prime} \\cdot R^{\\prime} D^{\\prime}}\n\\]\n\nMultiplying these four equations, we obtain\n\n\\[\n\\frac{A P}{P B} \\cdot \\frac{B Q}{Q C} \\cdot \\frac{C R}{R D} \\cdot \\frac{D S}{S A}=\\frac{A^{\\prime} P^{\\prime}}{P^{\\prime} B^{\\prime}} \\cdot \\frac{B^{\\prime} Q^{\\prime}}{Q^{\\prime} C^{\\prime}} \\cdot \\frac{C^{\\prime} R^{\\prime}}{R^{\\prime} D^{\\prime}} \\cdot \\frac{D^{\\prime} S^{\\prime}}{S^{\\prime} A^{\\prime}} .\n\\]\n\nFinally, we apply Brianchon's theorem to the circumscribed hexagon \\(A^{\\prime} P^{\\prime} R^{\\prime} C^{\\prime} Q^{\\prime} S^{\\prime}\\) and deduce that the lines \\(A^{\\prime} C^{\\prime}, P^{\\prime} Q^{\\prime}\\), and \\(R^{\\prime} S^{\\prime}\\) are either concurrent or parallel to each other. So, by Menelaus' theorem, we obtain\n\n\\[\n\\frac{A^{\\prime} P^{\\prime}}{P^{\\prime} B^{\\prime}} \\cdot \\frac{B^{\\prime} Q^{\\prime}}{Q^{\\prime} C^{\\prime}} \\cdot \\frac{C^{\\prime} R^{\\prime}}{R^{\\prime} D^{\\prime}} \\cdot \\frac{D^{\\prime} S^{\\prime}}{S^{\\prime} A^{\\prime}}=1\n\\]\n\nThis equation together with (3) yield (1)."}
{"id": "imo-shortlist-2015-g8", "question": "G8. A triangulation of a convex polygon \\(\\Pi\\) is a partitioning of \\(\\Pi\\) into triangles by diagonals having no common points other than the vertices of the polygon. We say that a triangulation is a Thaiangulation if all triangles in it have the same area.\n\nProve that any two different Thaiangulations of a convex polygon \\(\\Pi\\) differ by exactly two triangles. (In other words, prove that it is possible to replace one pair of triangles in the first Thaiangulation with a different pair of triangles so as to obtain the second Thaiangulation.)", "category": "Geometry", "source": "IMO Shortlist", "year": 2015, "solution": "We denote by \\([S]\\) the area of a polygon \\(S\\).\nRecall that each triangulation of a convex \\(n\\)-gon has exactly \\(n-2\\) triangles. This means that all triangles in any two Thaiangulations of a convex polygon \\(\\Pi\\) have the same area.\n\nLet \\(\\mathcal{T}\\) be a triangulation of a convex polygon \\(\\Pi\\). If four vertices \\(A, B, C\\), and \\(D\\) of \\(\\Pi\\) form a parallelogram, and \\(\\mathcal{T}\\) contains two triangles whose union is this parallelogram, then we say that \\(\\mathcal{T}\\) contains parallelogram \\(A B C D\\). Notice here that if two Thaiangulations \\(\\mathcal{T}_{1}\\) and \\(\\mathcal{T}_{2}\\) of \\(\\Pi\\) differ by two triangles, then the union of these triangles is a quadrilateral each of whose diagonals bisects its area, i.e., a parallelogram.\n\nWe start with proving two properties of triangulations.\nLemma 1. A triangulation of a convex polygon \\(\\Pi\\) cannot contain two parallelograms.\nProof. Arguing indirectly, assume that \\(P_{1}\\) and \\(P_{2}\\) are two parallelograms contained in some triangulation \\(\\mathcal{T}\\). If they have a common triangle in \\(\\mathcal{T}\\), then we may assume that \\(P_{1}\\) consists of triangles \\(A B C\\) and \\(A D C\\) of \\(\\mathcal{T}\\), while \\(P_{2}\\) consists of triangles \\(A D C\\) and \\(C D E\\) (see Figure 1). But then \\(B C\\|A D\\| C E\\), so the three vertices \\(B, C\\), and \\(E\\) of \\(\\Pi\\) are collinear, which is absurd.\n\nAssume now that \\(P_{1}\\) and \\(P_{2}\\) contain no common triangle. Let \\(P_{1}=A B C D\\). The sides \\(A B\\), \\(B C, C D\\), and \\(D A\\) partition \\(\\Pi\\) into several parts, and \\(P_{2}\\) is contained in one of them; we may assume that this part is cut off from \\(P_{1}\\) by \\(A D\\). Then one may label the vertices of \\(P_{2}\\) by \\(X\\), \\(Y, Z\\), and \\(T\\) so that the polygon \\(A B C D X Y Z T\\) is convex (see Figure 2; it may happen that \\(D=X\\) and/or \\(T=A\\), but still this polygon has at least six vertices). But the sum of the external angles of this polygon at \\(B, C, Y\\), and \\(Z\\) is already \\(360^{\\circ}\\), which is impossible. A final contradiction.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-62}\n\nFigure 1\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-62(2)}\n\nFigure 2\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-62(1)}\n\nFigure 3\n\nLemma 2. Every triangle in a Thaiangulation \\(\\mathcal{T}\\) of \\(\\Pi\\) contains a side of \\(\\Pi\\).\nProof. Let \\(A B C\\) be a triangle in \\(\\mathcal{T}\\). Apply an affine transform such that \\(A B C\\) maps to an equilateral triangle; let \\(A^{\\prime} B^{\\prime} C^{\\prime}\\) be the image of this triangle, and \\(\\Pi^{\\prime}\\) be the image of \\(\\Pi\\). Clearly, \\(\\mathcal{T}\\) maps into a Thaiangulation \\(\\mathcal{T}^{\\prime}\\) of \\(\\Pi^{\\prime}\\).\n\nAssume that none of the sides of \\(\\triangle A^{\\prime} B^{\\prime} C^{\\prime}\\) is a side of \\(\\Pi^{\\prime}\\). Then \\(\\mathcal{T}^{\\prime}\\) contains some other triangles with these sides, say, \\(A^{\\prime} B^{\\prime} Z, C^{\\prime} A^{\\prime} Y\\), and \\(B^{\\prime} C^{\\prime} X\\); notice that \\(A^{\\prime} Z B^{\\prime} X C^{\\prime} Y\\) is a convex hexagon (see Figure 3). The sum of its external angles at \\(X, Y\\), and \\(Z\\) is less than \\(360^{\\circ}\\). So one of these angles (say, at \\(Z\\) ) is less than \\(120^{\\circ}\\), hence \\(\\angle A^{\\prime} Z B^{\\prime}>60^{\\circ}\\). Then \\(Z\\) lies on a circular arc subtended by \\(A^{\\prime} B^{\\prime}\\) and having angular measure less than \\(240^{\\circ}\\); consequently, the altitude \\(Z H\\) of \\(\\triangle A^{\\prime} B^{\\prime} Z\\) is less than \\(\\sqrt{3} A^{\\prime} B^{\\prime} / 2\\). Thus \\(\\left[A^{\\prime} B^{\\prime} Z\\right]<\\left[A^{\\prime} B^{\\prime} C^{\\prime}\\right]\\), and \\(\\mathcal{T}^{\\prime}\\) is not a Thaiangulation. A contradiction.\n\nNow we pass to the solution. We say that a triangle in a triangulation of \\(\\Pi\\) is an ear if it contains two sides of \\(\\Pi\\). Note that each triangulation of a polygon contains some ear.\n\nArguing indirectly, we choose a convex polygon \\(\\Pi\\) with the least possible number of sides such that some two Thaiangulations \\(\\mathcal{T}_{1}\\) and \\(\\mathcal{T}_{2}\\) of \\(\\Pi\\) violate the problem statement (thus \\(\\Pi\\) has at least five sides). Consider now any ear \\(A B C\\) in \\(\\mathcal{T}_{1}\\), with \\(A C\\) being a diagonal of \\(\\Pi\\). If \\(\\mathcal{T}_{2}\\) also contains \\(\\triangle A B C\\), then one may cut \\(\\triangle A B C\\) off from \\(\\Pi\\), getting a polygon with a smaller number of sides which also violates the problem statement. This is impossible; thus \\(\\mathcal{T}_{2}\\) does not contain \\(\\triangle A B C\\).\n\nNext, \\(\\mathcal{T}_{1}\\) contains also another triangle with side \\(A C\\), say \\(\\triangle A C D\\). By Lemma 2, this triangle contains a side of \\(\\Pi\\), so \\(D\\) is adjacent to either \\(A\\) or \\(C\\) on the boundary of \\(\\Pi\\). We may assume that \\(D\\) is adjacent to \\(C\\).\n\nAssume that \\(\\mathcal{T}_{2}\\) does not contain the triangle \\(B C D\\). Then it contains two different triangles \\(B C X\\) and \\(C D Y\\) (possibly, with \\(X=Y\\) ); since these triangles have no common interior points, the polygon \\(A B C D Y X\\) is convex (see Figure 4). But, since \\([A B C]=[B C X]=\\) \\([A C D]=[C D Y]\\), we get \\(A X \\| B C\\) and \\(A Y \\| C D\\) which is impossible. Thus \\(\\mathcal{T}_{2}\\) contains \\(\\triangle B C D\\).\n\nTherefore, \\([A B D]=[A B C]+[A C D]-[B C D]=[A B C]\\), and \\(A B C D\\) is a parallelogram contained in \\(\\mathcal{T}_{1}\\). Let \\(\\mathcal{T}^{\\prime}\\) be the Thaiangulation of \\(\\Pi\\) obtained from \\(\\mathcal{T}_{1}\\) by replacing the diagonal \\(A C\\) with \\(B D\\); then \\(\\mathcal{T}^{\\prime}\\) is distinct from \\(\\mathcal{T}_{2}\\) (otherwise \\(\\mathcal{T}_{1}\\) and \\(\\mathcal{T}_{2}\\) would differ by two triangles). Moreover, \\(\\mathcal{T}^{\\prime}\\) shares a common ear \\(B C D\\) with \\(\\mathcal{T}_{2}\\). As above, cutting this ear away we obtain that \\(\\mathcal{T}_{2}\\) and \\(\\mathcal{T}^{\\prime}\\) differ by two triangles forming a parallelogram different from \\(A B C D\\). Thus \\(\\mathcal{T}^{\\prime}\\) contains two parallelograms, which contradicts Lemma 1.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-63}\n\nFigure 4\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-63(1)}\n\nFigure 5\n\nComment 1. Lemma 2 is equivalent to the well-known Erds-Debrunner inequality stating that for any triangle \\(P Q R\\) and any points \\(A, B, C\\) lying on the sides \\(Q R, R P\\), and \\(P Q\\), respectively, we have\n\n\\[\n[A B C] \\geqslant \\min \\{[A B R],[B C P],[C A Q]\\} .\n\\]\n\nTo derive this inequality from Lemma 2, one may assume that (1) does not hold, and choose some points \\(X, Y\\), and \\(Z\\) inside the triangles \\(B C P, C A Q\\), and \\(A B R\\), respectively, so that \\([A B C]=\\) \\([A B Z]=[B C X]=[C A Y]\\). Then a convex hexagon \\(A Z B X C Y\\) has a Thaiangulation containing \\(\\triangle A B C\\), which contradicts Lemma 2.\n\nConversely, assume that a Thaiangulation \\(\\mathcal{T}\\) of \\(\\Pi\\) contains a triangle \\(A B C\\) none of whose sides is a side of \\(\\Pi\\), and let \\(A B Z, A Y C\\), and \\(X B C\\) be other triangles in \\(\\mathcal{T}\\) containing the corresponding sides. Then \\(A Z B X C Y\\) is a convex hexagon.\n\nConsider the lines through \\(A, B\\), and \\(C\\) parallel to \\(Y Z, Z X\\), and \\(X Y\\), respectively. They form a triangle \\(X^{\\prime} Y^{\\prime} Z^{\\prime}\\) similar to \\(\\triangle X Y Z\\) (see Figure 5). By (1) we have\n\n\\[\n[A B C] \\geqslant \\min \\left\\{\\left[A B Z^{\\prime}\\right],\\left[B C X^{\\prime}\\right],\\left[C A Y^{\\prime}\\right]\\right\\}>\\min \\{[A B Z],[B C X],[C A Y]\\},\n\\]\n\nso \\(\\mathcal{T}\\) is not a Thaiangulation.\n\nSolution 2. We will make use of the preliminary observations from Solution 1, together with Lemma 1.\n\nArguing indirectly, we choose a convex polygon \\(\\Pi\\) with the least possible number of sides such that some two Thaiangulations \\(\\mathcal{T}_{1}\\) and \\(\\mathcal{T}_{2}\\) of \\(\\Pi\\) violate the statement (thus \\(\\Pi\\) has at least five sides). Assume that \\(\\mathcal{T}_{1}\\) and \\(\\mathcal{T}_{2}\\) share a diagonal \\(d\\) splitting \\(\\Pi\\) into two smaller polygons \\(\\Pi_{1}\\) and \\(\\Pi_{2}\\). Since the problem statement holds for any of them, the induced Thaiangulations of each of \\(\\Pi_{i}\\) differ by two triangles forming a parallelogram (the Thaiangulations induced on \\(\\Pi_{i}\\) by \\(\\mathcal{T}_{1}\\) and \\(T_{2}\\) may not coincide, otherwise \\(\\mathcal{T}_{1}\\) and \\(\\mathcal{T}_{2}\\) would differ by at most two triangles). But both these parallelograms are contained in \\(\\mathcal{T}_{1}\\); this contradicts Lemma 1. Therefore, \\(\\mathcal{T}_{1}\\) and \\(\\mathcal{T}_{2}\\) share no diagonal. Hence they also share no triangle.\n\nWe consider two cases.\nCase 1. Assume that some vertex \\(B\\) of \\(\\Pi\\) is an endpoint of some diagonal in \\(\\mathcal{T}_{1}\\), as well as an endpoint of some diagonal in \\(\\mathcal{T}_{2}\\).\n\nLet \\(A\\) and \\(C\\) be the vertices of \\(\\Pi\\) adjacent to \\(B\\). Then \\(\\mathcal{T}_{1}\\) contains some triangles \\(A B X\\) and \\(B C Y\\), while \\(\\mathcal{T}_{2}\\) contains some triangles \\(A B X^{\\prime}\\) and \\(B C Y^{\\prime}\\). Here, some of the points \\(X\\), \\(X^{\\prime}, Y\\), and \\(Y^{\\prime}\\) may coincide; however, in view of our assumption together with the fact that \\(\\mathcal{T}_{1}\\) and \\(\\mathcal{T}_{2}\\) share no triangle, all four triangles \\(A B X, B C Y, A B X^{\\prime}\\), and \\(B C Y^{\\prime}\\) are distinct.\n\nSince \\([A B X]=[B C Y]=\\left[A B X^{\\prime}\\right]=\\left[B C Y^{\\prime}\\right]\\), we have \\(X X^{\\prime} \\| A B\\) and \\(Y Y^{\\prime} \\| B C\\). Now, if \\(X=Y\\), then \\(X^{\\prime}\\) and \\(Y^{\\prime}\\) lie on different lines passing through \\(X\\) and are distinct from that point, so that \\(X^{\\prime} \\neq Y^{\\prime}\\). In this case, we may switch the two Thaiangulations. So, hereafter we assume that \\(X \\neq Y\\).\n\nIn the convex pentagon \\(A B C Y X\\) we have either \\(\\angle B A X+\\angle A X Y>180^{\\circ}\\) or \\(\\angle X Y C+\\) \\(\\angle Y C B>180^{\\circ}\\) (or both); due to the symmetry, we may assume that the first inequality holds. Let \\(r\\) be the ray emerging from \\(X\\) and co-directed with \\(\\overrightarrow{A B}\\); our inequality shows that \\(r\\) points to the interior of the pentagon (and thus to the interior of \\(\\Pi\\) ). Therefore, the ray opposite to \\(r\\) points outside \\(\\Pi\\), so \\(X^{\\prime}\\) lies on \\(r\\); moreover, \\(X^{\\prime}\\) lies on the \"arc\" \\(C Y\\) of \\(\\Pi\\) not containing \\(X\\). So the segments \\(X X^{\\prime}\\) and \\(Y B\\) intersect (see Figure 6).\n\nLet \\(O\\) be the intersection point of the rays \\(r\\) and \\(B C\\). Since the triangles \\(A B X^{\\prime}\\) and \\(B C Y^{\\prime}\\) have no common interior points, \\(Y^{\\prime}\\) must lie on the \"arc\" \\(C X^{\\prime}\\) which is situated inside the triangle \\(X B O\\). Therefore, the line \\(Y Y^{\\prime}\\) meets two sides of \\(\\triangle X B O\\), none of which may be \\(X B\\) (otherwise the diagonals \\(X B\\) and \\(Y Y^{\\prime}\\) would share a common point). Thus \\(Y Y^{\\prime}\\) intersects \\(B O\\), which contradicts \\(Y Y^{\\prime} \\| B C\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-64}\n\nFigure 6\n\nCase 2. In the remaining case, each vertex of \\(\\Pi\\) is an endpoint of a diagonal in at most one of \\(\\mathcal{T}_{1}\\) and \\(\\mathcal{T}_{2}\\). On the other hand, a triangulation cannot contain two consecutive vertices with no diagonals from each. Therefore, the vertices of \\(\\Pi\\) alternatingly emerge diagonals in \\(\\mathcal{T}_{1}\\) and in \\(\\mathcal{T}_{2}\\). In particular, \\(\\Pi\\) has an even number of sides.\n\nNext, we may choose five consecutive vertices \\(A, B, C, D\\), and \\(E\\) of \\(\\Pi\\) in such a way that\n\n\\[\n\\angle A B C+\\angle B C D>180^{\\circ} \\text { and } \\angle B C D+\\angle C D E>180^{\\circ} .\n\\]\n\nIn order to do this, it suffices to choose three consecutive vertices \\(B, C\\), and \\(D\\) of \\(\\Pi\\) such that the sum of their external angles is at most \\(180^{\\circ}\\). This is possible, since \\(\\Pi\\) has at least six sides.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_8bd4da09f41316bd42acg-65}\n\nFigure 7\n\nWe may assume that \\(\\mathcal{T}_{1}\\) has no diagonals from \\(B\\) and \\(D\\) (and thus contains the triangles \\(A B C\\) and \\(C D E\\) ), while \\(\\mathcal{T}_{2}\\) has no diagonals from \\(A, C\\), and \\(E\\) (and thus contains the triangle \\(B C D)\\). Now, since \\([A B C]=[B C D]=[C D E]\\), we have \\(A D \\| B C\\) and \\(B E \\| C D\\) (see Figure 7). By (2) this yields that \\(A D>B C\\) and \\(B E>C D\\). Let \\(X=A C \\cap B D\\) and \\(Y=C E \\cap B D\\); then the inequalities above imply that \\(A X>C X\\) and \\(E Y>C Y\\).\n\nFinally, \\(\\mathcal{T}_{2}\\) must also contain some triangle \\(B D Z\\) with \\(Z \\neq C\\); then the ray \\(C Z\\) lies in the angle \\(A C E\\). Since \\([B C D]=[B D Z]\\), the diagonal \\(B D\\) bisects \\(C Z\\). Together with the inequalities above, this yields that \\(Z\\) lies inside the triangle \\(A C E\\) (but \\(Z\\) is distinct from \\(A\\) and \\(E)\\), which is impossible. The final contradiction.\n\nComment 2. Case 2 may also be accomplished with the use of Lemma 2. Indeed, since each triangulation of an \\(n\\)-gon contains \\(n-2\\) triangles neither of which may contain three sides of \\(\\Pi\\), Lemma 2 yields that each Thaiangulation contains exactly two ears. But each vertex of \\(\\Pi\\) is a vertex of an ear either in \\(\\mathcal{T}_{1}\\) or in \\(\\mathcal{T}_{2}\\), so \\(\\Pi\\) cannot have more than four vertices."}
{"id": "imo-shortlist-2015-n1", "question": "N1. Determine all positive integers \\(M\\) for which the sequence \\(a_{0}, a_{1}, a_{2}, \\ldots\\), defined by \\(a_{0}=\\frac{2 M+1}{2}\\) and \\(a_{k+1}=a_{k}\\left\\lfloor a_{k}\\right\\rfloor\\) for \\(k=0,1,2, \\ldots\\), contains at least one integer term.\n\nAnswer. All integers \\(M \\geqslant 2\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2015, "solution": "Define \\(b_{k}=2 a_{k}\\) for all \\(k \\geqslant 0\\). Then\n\n\\[\nb_{k+1}=2 a_{k+1}=2 a_{k}\\left\\lfloor a_{k}\\right\\rfloor=b_{k}\\left\\lfloor\\frac{b_{k}}{2}\\right\\rfloor\n\\]\n\nSince \\(b_{0}\\) is an integer, it follows that \\(b_{k}\\) is an integer for all \\(k \\geqslant 0\\).\nSuppose that the sequence \\(a_{0}, a_{1}, a_{2}, \\ldots\\) does not contain any integer term. Then \\(b_{k}\\) must be an odd integer for all \\(k \\geqslant 0\\), so that\n\n\\[\nb_{k+1}=b_{k}\\left\\lfloor\\frac{b_{k}}{2}\\right\\rfloor=\\frac{b_{k}\\left(b_{k}-1\\right)}{2}\n\\]\n\nHence\n\n\\[\nb_{k+1}-3=\\frac{b_{k}\\left(b_{k}-1\\right)}{2}-3=\\frac{\\left(b_{k}-3\\right)\\left(b_{k}+2\\right)}{2}\n\\]\n\nfor all \\(k \\geqslant 0\\).\nSuppose that \\(b_{0}-3>0\\). Then equation (2) yields \\(b_{k}-3>0\\) for all \\(k \\geqslant 0\\). For each \\(k \\geqslant 0\\), define \\(c_{k}\\) to be the highest power of 2 that divides \\(b_{k}-3\\). Since \\(b_{k}-3\\) is even for all \\(k \\geqslant 0\\), the number \\(c_{k}\\) is positive for every \\(k \\geqslant 0\\).\n\nNote that \\(b_{k}+2\\) is an odd integer. Therefore, from equation (2), we have that \\(c_{k+1}=c_{k}-1\\). Thus, the sequence \\(c_{0}, c_{1}, c_{2}, \\ldots\\) of positive integers is strictly decreasing, a contradiction. So, \\(b_{0}-3 \\leqslant 0\\), which implies \\(M=1\\).\n\nFor \\(M=1\\), we can check that the sequence is constant with \\(a_{k}=\\frac{3}{2}\\) for all \\(k \\geqslant 0\\). Therefore, the answer is \\(M \\geqslant 2\\).\n\nSolution 2. We provide an alternative way to show \\(M=1\\) once equation (1) has been reached. We claim that \\(b_{k} \\equiv 3\\left(\\bmod 2^{m}\\right)\\) for all \\(k \\geqslant 0\\) and \\(m \\geqslant 1\\). If this is true, then we would have \\(b_{k}=3\\) for all \\(k \\geqslant 0\\) and hence \\(M=1\\).\n\nTo establish our claim, we proceed by induction on \\(m\\). The base case \\(b_{k} \\equiv 3(\\bmod 2)\\) is true for all \\(k \\geqslant 0\\) since \\(b_{k}\\) is odd. Now suppose that \\(b_{k} \\equiv 3\\left(\\bmod 2^{m}\\right)\\) for all \\(k \\geqslant 0\\). Hence \\(b_{k}=2^{m} d_{k}+3\\) for some integer \\(d_{k}\\). We have\n\n\\[\n3 \\equiv b_{k+1} \\equiv\\left(2^{m} d_{k}+3\\right)\\left(2^{m-1} d_{k}+1\\right) \\equiv 3 \\cdot 2^{m-1} d_{k}+3 \\quad\\left(\\bmod 2^{m}\\right)\n\\]\n\nso that \\(d_{k}\\) must be even. This implies that \\(b_{k} \\equiv 3\\left(\\bmod 2^{m+1}\\right)\\), as required.\nComment. The reason the number 3 which appears in both solutions is important, is that it is a nontrivial fixed point of the recurrence relation for \\(b_{k}\\)."}
{"id": "imo-shortlist-2015-n2", "question": "N2. Let \\(a\\) and \\(b\\) be positive integers such that \\(a!b!\\) is a multiple of \\(a!+b!\\). Prove that \\(3 a \\geqslant 2 b+2\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2015, "solution": "If \\(a>b\\), we immediately get \\(3 a \\geqslant 2 b+2\\). In the case \\(a=b\\), the required inequality is equivalent to \\(a \\geqslant 2\\), which can be checked easily since \\((a, b)=(1,1)\\) does not satisfy \\(a!+b!\\mid a!b!\\). We now assume \\(a<b\\) and denote \\(c=b-a\\). The required inequality becomes \\(a \\geqslant 2 c+2\\).\n\nSuppose, to the contrary, that \\(a \\leqslant 2 c+1\\). Define \\(M=\\frac{b!}{a!}=(a+1)(a+2) \\cdots(a+c)\\). Since \\(a!+b!\\mid a!b!\\) implies \\(1+M \\mid a!M\\), we obtain \\(1+M \\mid a!\\). Note that we must have \\(c<a\\); otherwise \\(1+M>a!\\), which is impossible. We observe that \\(c!\\mid M\\) since \\(M\\) is a product of \\(c\\) consecutive integers. Thus \\(\\operatorname{gcd}(1+M, c!)=1\\), which implies\n\n\\[\n1+M \\left\\lvert\\, \\frac{a!}{c!}=(c+1)(c+2) \\cdots a\\right.\n\\]\n\nIf \\(a \\leqslant 2 c\\), then \\(\\frac{a!}{c!}\\) is a product of \\(a-c \\leqslant c\\) integers not exceeding \\(a\\) whereas \\(M\\) is a product of \\(c\\) integers exceeding \\(a\\). Therefore, \\(1+M>\\frac{a!}{c!}\\), which is a contradiction.\n\nIt remains to exclude the case \\(a=2 c+1\\). Since \\(a+1=2(c+1)\\), we have \\(c+1 \\mid M\\). Hence, we can deduce from (1) that \\(1+M \\mid(c+2)(c+3) \\cdots a\\). Now \\((c+2)(c+3) \\cdots a\\) is a product of \\(a-c-1=c\\) integers not exceeding \\(a\\); thus it is smaller than \\(1+M\\). Again, we arrive at a contradiction.\n\nComment 1. One may derive a weaker version of (1) and finish the problem as follows. After assuming \\(a \\leqslant 2 c+1\\), we have \\(\\left\\lfloor\\frac{a}{2}\\right\\rfloor \\leqslant c\\), so \\(\\left.\\left\\lfloor\\frac{a}{2}\\right\\rfloor!\\right\\rvert\\, M\\). Therefore,\n\n\\[\n1+M \\left\\lvert\\,\\left(\\left\\lfloor\\frac{a}{2}\\right\\rfloor+1\\right)\\left(\\left\\lfloor\\frac{a}{2}\\right\\rfloor+2\\right) \\cdots a\\right.\n\\]\n\nObserve that \\(\\left(\\left\\lfloor\\frac{a}{2}\\right\\rfloor+1\\right)\\left(\\left\\lfloor\\frac{a}{2}\\right\\rfloor+2\\right) \\cdots a\\) is a product of \\(\\left\\lceil\\frac{a}{2}\\right\\rceil\\) integers not exceeding \\(a\\). This leads to a contradiction when \\(a\\) is even since \\(\\left\\lceil\\frac{a}{2}\\right\\rceil=\\frac{a}{2} \\leqslant c\\) and \\(M\\) is a product of \\(c\\) integers exceeding \\(a\\).\n\nWhen \\(a\\) is odd, we can further deduce that \\(1+M \\left\\lvert\\,\\left(\\frac{a+3}{2}\\right)\\left(\\frac{a+5}{2}\\right) \\cdots a\\right.\\) since \\(\\left.\\left\\lfloor\\frac{a}{2}\\right\\rfloor+1=\\frac{a+1}{2} \\right\\rvert\\, a+1\\). Now \\(\\left(\\frac{a+3}{2}\\right)\\left(\\frac{a+5}{2}\\right) \\cdots a\\) is a product of \\(\\frac{a-1}{2} \\leqslant c\\) numbers not exceeding \\(a\\), and we get a contradiction.\n\nSolution 2. As in Solution 1, we may assume that \\(a<b\\) and let \\(c=b-a\\). Suppose, to the contrary, that \\(a \\leqslant 2 c+1\\). From \\(a!+b!\\mid a!b!\\), we have\n\n\\[\nN=1+(a+1)(a+2) \\cdots(a+c) \\mid(a+c)!,\n\\]\n\nwhich implies that all prime factors of \\(N\\) are at most \\(a+c\\).\nLet \\(p\\) be a prime factor of \\(N\\). If \\(p \\leqslant c\\) or \\(p \\geqslant a+1\\), then \\(p\\) divides one of \\(a+1, \\ldots, a+c\\) which is impossible. Hence \\(a \\geqslant p \\geqslant c+1\\). Furthermore, we must have \\(2 p>a+c\\); otherwise, \\(a+1 \\leqslant 2 c+2 \\leqslant 2 p \\leqslant a+c\\) so \\(p \\mid N-1\\), again impossible. Thus, we have \\(p \\in\\left(\\frac{a+c}{2}, a\\right]\\), and \\(p^{2} \\nmid(a+c)\\) ! since \\(2 p>a+c\\). Therefore, \\(p^{2} \\nmid N\\) as well.\n\nIf \\(a \\leqslant c+2\\), then the interval \\(\\left(\\frac{a+c}{2}, a\\right]\\) contains at most one integer and hence at most one prime number, which has to be \\(a\\). Since \\(p^{2} \\nmid N\\), we must have \\(N=p=a\\) or \\(N=1\\), which is absurd since \\(N>a \\geqslant 1\\). Thus, we have \\(a \\geqslant c+3\\), and so \\(\\frac{a+c+1}{2} \\geqslant c+2\\). It follows that \\(p\\) lies in the interval \\([c+2, a]\\).\n\nThus, every prime appearing in the prime factorization of \\(N\\) lies in the interval \\([c+2, a]\\), and its exponent is exactly 1 . So we must have \\(N \\mid(c+2)(c+3) \\cdots a\\). However, \\((c+2)(c+3) \\cdots a\\) is a product of \\(a-c-1 \\leqslant c\\) numbers not exceeding \\(a\\), so it is less than \\(N\\). This is a contradiction.\n\nComment 2. The original problem statement also asks to determine when the equality \\(3 a=2 b+2\\) holds. It can be checked that the answer is \\((a, b)=(2,2),(4,5)\\)."}
{"id": "imo-shortlist-2015-n3", "question": "N3. Let \\(m\\) and \\(n\\) be positive integers such that \\(m>n\\). Define \\(x_{k}=(m+k) /(n+k)\\) for \\(k=\\) \\(1,2, \\ldots, n+1\\). Prove that if all the numbers \\(x_{1}, x_{2}, \\ldots, x_{n+1}\\) are integers, then \\(x_{1} x_{2} \\cdots x_{n+1}-1\\) is divisible by an odd prime.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2015, "solution": "Assume that \\(x_{1}, x_{2}, \\ldots, x_{n+1}\\) are integers. Define the integers\n\n\\[\na_{k}=x_{k}-1=\\frac{m+k}{n+k}-1=\\frac{m-n}{n+k}>0\n\\]\n\nfor \\(k=1,2, \\ldots, n+1\\).\nLet \\(P=x_{1} x_{2} \\cdots x_{n+1}-1\\). We need to prove that \\(P\\) is divisible by an odd prime, or in other words, that \\(P\\) is not a power of 2 . To this end, we investigate the powers of 2 dividing the numbers \\(a_{k}\\).\n\nLet \\(2^{d}\\) be the largest power of 2 dividing \\(m-n\\), and let \\(2^{c}\\) be the largest power of 2 not exceeding \\(2 n+1\\). Then \\(2 n+1 \\leqslant 2^{c+1}-1\\), and so \\(n+1 \\leqslant 2^{c}\\). We conclude that \\(2^{c}\\) is one of the numbers \\(n+1, n+2, \\ldots, 2 n+1\\), and that it is the only multiple of \\(2^{c}\\) appearing among these numbers. Let \\(\\ell\\) be such that \\(n+\\ell=2^{c}\\). Since \\(\\frac{m-n}{n+\\ell}\\) is an integer, we have \\(d \\geqslant c\\). Therefore, \\(2^{d-c+1} \\nmid a_{\\ell}=\\frac{m-n}{n+\\ell}\\), while \\(2^{d-c+1} \\mid a_{k}\\) for all \\(k \\in\\{1, \\ldots, n+1\\} \\backslash\\{\\ell\\}\\).\n\nComputing modulo \\(2^{d-c+1}\\), we get\n\n\\[\nP=\\left(a_{1}+1\\right)\\left(a_{2}+1\\right) \\cdots\\left(a_{n+1}+1\\right)-1 \\equiv\\left(a_{\\ell}+1\\right) \\cdot 1^{n}-1 \\equiv a_{\\ell} \\not \\equiv 0 \\quad\\left(\\bmod 2^{d-c+1}\\right)\n\\]\n\nTherefore, \\(2^{d-c+1} \\nmid P\\).\nOn the other hand, for any \\(k \\in\\{1, \\ldots, n+1\\} \\backslash\\{\\ell\\}\\), we have \\(2^{d-c+1} \\mid a_{k}\\). So \\(P \\geqslant a_{k} \\geqslant 2^{d-c+1}\\), and it follows that \\(P\\) is not a power of 2 .\n\nComment. Instead of attempting to show that \\(P\\) is not a power of 2 , one may try to find an odd factor of \\(P\\) (greater than 1) as follows:\n\nFrom \\(a_{k}=\\frac{m-n}{n+k} \\in \\mathbb{Z}_{>0}\\), we get that \\(m-n\\) is divisible by \\(n+1, n+2, \\ldots, 2 n+1\\), and thus it is also divisible by their least common multiple \\(L\\). So \\(m-n=q L\\) for some positive integer \\(q\\); hence \\(x_{k}=q \\cdot \\frac{L}{n+k}+1\\).\n\nThen, since \\(n+1 \\leqslant 2^{c}=n+\\ell \\leqslant 2 n+1 \\leqslant 2^{c+1}-1\\), we have \\(2^{c} \\mid L\\), but \\(2^{c+1} \\nmid L\\). So \\(\\frac{L}{n+\\ell}\\) is odd, while \\(\\frac{L}{n+k}\\) is even for \\(k \\neq \\ell\\). Computing modulo \\(2 q\\) yields\n\n\\[\nx_{1} x_{2} \\cdots x_{n+1}-1 \\equiv(q+1) \\cdot 1^{n}-1 \\equiv q \\quad(\\bmod 2 q) .\n\\]\n\nThus, \\(x_{1} x_{2} \\cdots x_{n+1}-1=2 q r+q=q(2 r+1)\\) for some integer \\(r\\).\nSince \\(x_{1} x_{2} \\cdots x_{n+1}-1 \\geqslant x_{1} x_{2}-1 \\geqslant(q+1)^{2}-1>q\\), we have \\(r \\geqslant 1\\). This implies that \\(x_{1} x_{2} \\cdots x_{n+1}-1\\) is divisible by an odd prime."}
{"id": "imo-shortlist-2015-n4", "question": "N4. Suppose that \\(a_{0}, a_{1}, \\ldots\\) and \\(b_{0}, b_{1}, \\ldots\\) are two sequences of positive integers satisfying \\(a_{0}, b_{0} \\geqslant 2\\) and\n\n\\[\na_{n+1}=\\operatorname{gcd}\\left(a_{n}, b_{n}\\right)+1, \\quad b_{n+1}=\\operatorname{lcm}\\left(a_{n}, b_{n}\\right)-1\n\\]\n\nfor all \\(n \\geqslant 0\\). Prove that the sequence \\(\\left(a_{n}\\right)\\) is eventually periodic; in other words, there exist integers \\(N \\geqslant 0\\) and \\(t>0\\) such that \\(a_{n+t}=a_{n}\\) for all \\(n \\geqslant N\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2015, "solution": "Let \\(s_{n}=a_{n}+b_{n}\\). Notice that if \\(a_{n} \\mid b_{n}\\), then \\(a_{n+1}=a_{n}+1, b_{n+1}=b_{n}-1\\) and \\(s_{n+1}=s_{n}\\). So, \\(a_{n}\\) increases by 1 and \\(s_{n}\\) does not change until the first index is reached with \\(a_{n} \\nmid s_{n}\\). Define\n\n\\[\nW_{n}=\\left\\{m \\in \\mathbb{Z}_{>0}: m \\geqslant a_{n} \\text { and } m \\nmid s_{n}\\right\\} \\quad \\text { and } \\quad w_{n}=\\min W_{n}\n\\]\n\nClaim 1. The sequence \\(\\left(w_{n}\\right)\\) is non-increasing.\nProof. If \\(a_{n} \\mid b_{n}\\) then \\(a_{n+1}=a_{n}+1\\). Due to \\(a_{n} \\mid s_{n}\\), we have \\(a_{n} \\notin W_{n}\\). Moreover \\(s_{n+1}=s_{n}\\); therefore, \\(W_{n+1}=W_{n}\\) and \\(w_{n+1}=w_{n}\\).\n\nOtherwise, if \\(a_{n} \\nmid b_{n}\\), then \\(a_{n} \\nmid s_{n}\\), so \\(a_{n} \\in W_{n}\\) and thus \\(w_{n}=a_{n}\\). We show that \\(a_{n} \\in W_{n+1}\\); this implies \\(w_{n+1} \\leqslant a_{n}=w_{n}\\). By the definition of \\(W_{n+1}\\), we need that \\(a_{n} \\geqslant a_{n+1}\\) and \\(a_{n} \\nmid s_{n+1}\\). The first relation holds because of \\(\\operatorname{gcd}\\left(a_{n}, b_{n}\\right)<a_{n}\\). For the second relation, observe that in \\(s_{n+1}=\\operatorname{gcd}\\left(a_{n}, b_{n}\\right)+\\operatorname{lcm}\\left(a_{n}, b_{n}\\right)\\), the second term is divisible by \\(a_{n}\\), but the first term is not. So \\(a_{n} \\nmid s_{n+1}\\); that completes the proof of the claim.\n\nLet \\(w=\\min _{n} w_{n}\\) and let \\(N\\) be an index with \\(w=w_{N}\\). Due to Claim 1 , we have \\(w_{n}=w\\) for all \\(n \\geqslant N\\).\n\nLet \\(g_{n}=\\operatorname{gcd}\\left(w, s_{n}\\right)\\). As we have seen, starting from an arbitrary index \\(n \\geqslant N\\), the sequence \\(a_{n}, a_{n+1}, \\ldots\\) increases by 1 until it reaches \\(w\\), which is the first value not dividing \\(s_{n}\\); then it drops to \\(\\operatorname{gcd}\\left(w, s_{n}\\right)+1=g_{n}+1\\).\nClaim 2. The sequence \\(\\left(g_{n}\\right)\\) is constant for \\(n \\geqslant N\\).\nProof. If \\(a_{n} \\mid b_{n}\\), then \\(s_{n+1}=s_{n}\\) and hence \\(g_{n+1}=g_{n}\\). Otherwise we have \\(a_{n}=w\\),\n\n\\[\n\\begin{aligned}\n& \\operatorname{gcd}\\left(a_{n}, b_{n}\\right)=\\operatorname{gcd}\\left(a_{n}, s_{n}\\right)=\\operatorname{gcd}\\left(w, s_{n}\\right)=g_{n} \n& \\qquad \\begin{aligned}\ns_{n+1} & =\\operatorname{gcd}\\left(a_{n}, b_{n}\\right)+\\operatorname{lcm}\\left(a_{n}, b_{n}\\right)=g_{n}+\\frac{a_{n} b_{n}}{g_{n}}=g_{n}+\\frac{w\\left(s_{n}-w\\right)}{g_{n}} \n\\text { and } \\quad g_{n+1} & =\\operatorname{gcd}\\left(w, s_{n+1}\\right)=\\operatorname{gcd}\\left(w, g_{n}+\\frac{s_{n}-w}{g_{n}} w\\right)=\\operatorname{gcd}\\left(w, g_{n}\\right)=g_{n}\n\n\n\\]\n\nLet \\(g=g_{N}\\). We have proved that the sequence \\(\\left(a_{n}\\right)\\) eventually repeats the following cycle:\n\n\\[\ng+1 \\mapsto g+2 \\mapsto \\ldots \\mapsto w \\mapsto g+1\n\\]\n\nSolution 2. By Claim 1 in the first solution, we have \\(a_{n} \\leqslant w_{n} \\leqslant w_{0}\\), so the sequence \\(\\left(a_{n}\\right)\\) is bounded, and hence it has only finitely many values.\n\nLet \\(M=\\operatorname{lcm}\\left(a_{1}, a_{2}, \\ldots\\right)\\), and consider the sequence \\(b_{n}\\) modulo \\(M\\). Let \\(r_{n}\\) be the remainder of \\(b_{n}\\), divided by \\(M\\). For every index \\(n\\), since \\(a_{n}|M| b_{n}-r_{n}\\), we have \\(\\operatorname{gcd}\\left(a_{n}, b_{n}\\right)=\\operatorname{gcd}\\left(a_{n}, r_{n}\\right)\\), and therefore\n\n\\[\na_{n+1}=\\operatorname{gcd}\\left(a_{n}, r_{n}\\right)+1\n\\]\n\nMoreover,\n\n\\[\n\\begin{aligned}\nr_{n+1} & \\equiv b_{n+1}=\\operatorname{lcm}\\left(a_{n}, b_{n}\\right)-1=\\frac{a_{n}}{\\operatorname{gcd}\\left(a_{n}, b_{n}\\right)} b_{n}-1 \n& =\\frac{a_{n}}{\\operatorname{gcd}\\left(a_{n}, r_{n}\\right)} b_{n}-1 \\equiv \\frac{a_{n}}{\\operatorname{gcd}\\left(a_{n}, r_{n}\\right)} r_{n}-1 \\quad(\\bmod M)\n\n\\]\n\nHence, the pair ( \\(a_{n}, r_{n}\\) ) uniquely determines the pair ( \\(a_{n+1}, r_{n+1}\\) ). Since there are finitely many possible pairs, the sequence of pairs ( \\(a_{n}, r_{n}\\) ) is eventually periodic; in particular, the sequence \\(\\left(a_{n}\\right)\\) is eventually periodic.\n\nComment. We show that there are only four possibilities for \\(g\\) and \\(w\\) (as defined in Solution 1), namely\n\n\\[\n(w, g) \\in\\{(2,1),(3,1),(4,2),(5,1)\\}\n\\]\n\nThis means that the sequence \\(\\left(a_{n}\\right)\\) eventually repeats one of the following cycles:\n\n\\[\n(2), \\quad(2,3), \\quad(3,4), \\quad \\text { or } \\quad(2,3,4,5) .\n\\]\n\nUsing the notation of Solution 1, for \\(n \\geqslant N\\) the sequence \\(\\left(a_{n}\\right)\\) has a cycle \\((g+1, g+2, \\ldots, w)\\) such that \\(g=\\operatorname{gcd}\\left(w, s_{n}\\right)\\). By the observations in the proof of Claim 2, the numbers \\(g+1, \\ldots, w-1\\) all divide \\(s_{n}\\); so the number \\(L=\\operatorname{lcm}(g+1, g+2, \\ldots, w-1)\\) also divides \\(s_{n}\\). Moreover, \\(g\\) also divides \\(w\\).\n\nNow choose any \\(n \\geqslant N\\) such that \\(a_{n}=w\\). By (1), we have\n\n\\[\ns_{n+1}=g+\\frac{w\\left(s_{n}-w\\right)}{g}=s_{n} \\cdot \\frac{w}{g}-\\frac{w^{2}-g^{2}}{g}\n\\]\n\nSince \\(L\\) divides both \\(s_{n}\\) and \\(s_{n+1}\\), it also divides the number \\(T=\\frac{w^{2}-g^{2}}{g}\\).\nSuppose first that \\(w \\geqslant 6\\), which yields \\(g+1 \\leqslant \\frac{w}{2}+1 \\leqslant w-2\\). Then \\((w-2)(w-1)|L| T\\), so we have either \\(w^{2}-g^{2} \\geqslant 2(w-1)(w-2)\\), or \\(g=1\\) and \\(w^{2}-g^{2}=(w-1)(w-2)\\). In the former case we get \\((w-1)(w-5)+\\left(g^{2}-1\\right) \\leqslant 0\\) which is false by our assumption. The latter equation rewrites as \\(3 w=3\\), so \\(w=1\\), which is also impossible.\n\nNow we are left with the cases when \\(w \\leqslant 5\\) and \\(g \\mid w\\). The case \\((w, g)=(4,1)\\) violates the condition \\(L \\left\\lvert\\, \\frac{w^{2}-g^{2}}{g}\\right.\\); all other such pairs are listed in (2).\n\nIn the table below, for each pair ( \\(w, g\\) ), we provide possible sequences ( \\(a_{n}\\) ) and ( \\(b_{n}\\) ). That shows that the cycles shown in (3) are indeed possible.\n\n\\[\n\\begin{array}{llll}\nw=2 & g=1 & a_{n}=2 & b_{n}=2 \\cdot 2^{n}+1 \nw=3 & g=1 & \\left(a_{2 k}, a_{2 k+1}\\right)=(2,3) & \\left(b_{2 k}, b_{2 k+1}\\right)=\\left(6 \\cdot 3^{k}+2,6 \\cdot 3^{k}+1\\right) \nw=4 & g=2 & \\left(a_{2 k}, a_{2 k+1}\\right)=(3,4) & \\left(b_{2 k}, b_{2 k+1}\\right)=\\left(12 \\cdot 2^{k}+3,12 \\cdot 2^{k}+2\\right) \nw=5 & g=1 & \\left(a_{4 k}, \\ldots, a_{4 k+3}\\right)=(2,3,4,5) & \\left(b_{4 k}, \\ldots, b_{4 k+3}\\right)=\\left(6 \\cdot 5^{k}+4, \\ldots, 6 \\cdot 5^{k}+1\\right)\n\n\\]"}
{"id": "imo-shortlist-2015-n5", "question": "N5. Determine all triples \\((a, b, c)\\) of positive integers for which \\(a b-c, b c-a\\), and \\(c a-b\\) are powers of 2.\n\nExplanation: A power of 2 is an integer of the form \\(2^{n}\\), where \\(n\\) denotes some nonnegative integer.\n\nAnswer. There are sixteen such triples, namely \\((2,2,2)\\), the three permutations of \\((2,2,3)\\), and the six permutations of each of \\((2,6,11)\\) and \\((3,5,7)\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2015, "solution": "It can easily be verified that these sixteen triples are as required. Now let \\((a, b, c)\\) be any triple with the desired property. If we would have \\(a=1\\), then both \\(b-c\\) and \\(c-b\\) were powers of 2, which is impossible since their sum is zero; because of symmetry, this argument shows \\(a, b, c \\geqslant 2\\).\n\nCase 1. Among \\(a, b\\), and \\(c\\) there are at least two equal numbers.\nWithout loss of generality we may suppose that \\(a=b\\). Then \\(a^{2}-c\\) and \\(a(c-1)\\) are powers of 2. The latter tells us that actually \\(a\\) and \\(c-1\\) are powers of 2 . So there are nonnegative integers \\(\\alpha\\) and \\(\\gamma\\) with \\(a=2^{\\alpha}\\) and \\(c=2^{\\gamma}+1\\). Since \\(a^{2}-c=2^{2 \\alpha}-2^{\\gamma}-1\\) is a power of 2 and thus incongruent to -1 modulo 4 , we must have \\(\\gamma \\leqslant 1\\). Moreover, each of the terms \\(2^{2 \\alpha}-2\\) and \\(2^{2 \\alpha}-3\\) can only be a power of 2 if \\(\\alpha=1\\). It follows that the triple ( \\(a, b, c\\) ) is either ( \\(2,2,2\\) ) or \\((2,2,3)\\).\n\nCase 2. The numbers \\(a, b\\), and \\(c\\) are distinct.\nDue to symmetry we may suppose that\n\n\\[\n2 \\leqslant a<b<c\n\\]\n\nWe are to prove that the triple \\((a, b, c)\\) is either \\((2,6,11)\\) or \\((3,5,7)\\). By our hypothesis, there exist three nonnegative integers \\(\\alpha, \\beta\\) and \\(\\gamma\\) such that\n\n\\[\n\\begin{aligned}\nb c-a & =2^{\\alpha}, \na c-b & =2^{\\beta}, \n\\text { and } \\quad a b-c & =2^{\\gamma} .\n\n\\]\n\nEvidently we have\n\n\\[\n\\alpha>\\beta>\\gamma\n\\]\n\nDepending on how large \\(a\\) is, we divide the argument into two further cases.\nCase 2.1. \\(\\quad a=2\\).\nWe first prove that \\(\\gamma=0\\). Assume for the sake of contradiction that \\(\\gamma>0\\). Then \\(c\\) is even by (4) and, similarly, \\(b\\) is even by (5) and (3). So the left-hand side of (2) is congruent to 2 modulo 4 , which is only possible if \\(b c=4\\). As this contradicts (1), we have thereby shown that \\(\\gamma=0\\), i.e., that \\(c=2 b-1\\).\n\nNow (3) yields \\(3 b-2=2^{\\beta}\\). Due to \\(b>2\\) this is only possible if \\(\\beta \\geqslant 4\\). If \\(\\beta=4\\), then we get \\(b=6\\) and \\(c=2 \\cdot 6-1=11\\), which is a solution. It remains to deal with the case \\(\\beta \\geqslant 5\\). Now (2) implies\n\n\\[\n9 \\cdot 2^{\\alpha}=9 b(2 b-1)-18=(3 b-2)(6 b+1)-16=2^{\\beta}\\left(2^{\\beta+1}+5\\right)-16,\n\\]\n\nand by \\(\\beta \\geqslant 5\\) the right-hand side is not divisible by 32. Thus \\(\\alpha \\leqslant 4\\) and we get a contradiction to (5).\n\nCase 2.2. \\(\\quad a \\geqslant 3\\).\nPick an integer \\(\\vartheta \\in\\{-1,+1\\}\\) such that \\(c-\\vartheta\\) is not divisible by 4 . Now\n\n\\[\n2^{\\alpha}+\\vartheta \\cdot 2^{\\beta}=\\left(b c-a \\vartheta^{2}\\right)+\\vartheta(c a-b)=(b+a \\vartheta)(c-\\vartheta)\n\\]\n\nis divisible by \\(2^{\\beta}\\) and, consequently, \\(b+a \\vartheta\\) is divisible by \\(2^{\\beta-1}\\). On the other hand, \\(2^{\\beta}=a c-b>\\) \\((a-1) c \\geqslant 2 c\\) implies in view of (1) that \\(a\\) and \\(b\\) are smaller than \\(2^{\\beta-1}\\). All this is only possible if \\(\\vartheta=1\\) and \\(a+b=2^{\\beta-1}\\). Now (3) yields\n\n\\[\na c-b=2(a+b),\n\\]\n\nwhence \\(4 b>a+3 b=a(c-1) \\geqslant a b\\), which in turn yields \\(a=3\\).\nSo (6) simplifies to \\(c=b+2\\) and (2) tells us that \\(b(b+2)-3=(b-1)(b+3)\\) is a power of 2. Consequently, the factors \\(b-1\\) and \\(b+3\\) are powers of 2 themselves. Since their difference is 4 , this is only possible if \\(b=5\\) and thus \\(c=7\\). Thereby the solution is complete.\n\nSolution 2. As in the beginning of the first solution, we observe that \\(a, b, c \\geqslant 2\\). Depending on the parities of \\(a, b\\), and \\(c\\) we distinguish three cases.\n\nCase 1. The numbers \\(a, b\\), and \\(c\\) are even.\nLet \\(2^{A}, 2^{B}\\), and \\(2^{C}\\) be the largest powers of 2 dividing \\(a, b\\), and \\(c\\) respectively. We may assume without loss of generality that \\(1 \\leqslant A \\leqslant B \\leqslant C\\). Now \\(2^{B}\\) is the highest power of 2 dividing \\(a c-b\\), whence \\(a c-b=2^{B} \\leqslant b\\). Similarly, we deduce \\(b c-a=2^{A} \\leqslant a\\). Adding both estimates we get \\((a+b) c \\leqslant 2(a+b)\\), whence \\(c \\leqslant 2\\). So \\(c=2\\) and thus \\(A=B=C=1\\); moreover, we must have had equality throughout, i.e., \\(a=2^{A}=2\\) and \\(b=2^{B}=2\\). We have thereby found the solution \\((a, b, c)=(2,2,2)\\).\n\nCase 2. The numbers \\(a, b\\), and \\(c\\) are odd.\nIf any two of these numbers are equal, say \\(a=b\\), then \\(a c-b=a(c-1)\\) has a nontrivial odd divisor and cannot be a power of 2. Hence \\(a, b\\), and \\(c\\) are distinct. So we may assume without loss of generality that \\(a<b<c\\).\n\nLet \\(\\alpha\\) and \\(\\beta\\) denote the nonnegative integers for which \\(b c-a=2^{\\alpha}\\) and \\(a c-b=2^{\\beta}\\) hold. Clearly, we have \\(\\alpha>\\beta\\), and thus \\(2^{\\beta}\\) divides\n\n\\[\na \\cdot 2^{\\alpha}-b \\cdot 2^{\\beta}=a(b c-a)-b(a c-b)=b^{2}-a^{2}=(b+a)(b-a) .\n\\]\n\nSince \\(a\\) is odd, it is not possible that both factors \\(b+a\\) and \\(b-a\\) are divisible by 4 . Consequently, one of them has to be a multiple of \\(2^{\\beta-1}\\). Hence one of the numbers \\(2(b+a)\\) and \\(2(b-a)\\) is divisible by \\(2^{\\beta}\\) and in either case we have\n\n\\[\na c-b=2^{\\beta} \\leqslant 2(a+b)\n\\]\n\nThis in turn yields \\((a-1) b<a c-b<4 b\\) and thus \\(a=3\\) (recall that \\(a\\) is odd and larger than 1). Substituting this back into (7) we learn \\(c \\leqslant b+2\\). But due to the parity \\(b<c\\) entails that \\(b+2 \\leqslant c\\) holds as well. So we get \\(c=b+2\\) and from \\(b c-a=(b-1)(b+3)\\) being a power of 2 it follows that \\(b=5\\) and \\(c=7\\).\n\nCase 3. Among \\(a, b\\), and \\(c\\) both parities occur.\nWithout loss of generality, we suppose that \\(c\\) is odd and that \\(a \\leqslant b\\). We are to show that \\((a, b, c)\\) is either \\((2,2,3)\\) or \\((2,6,11)\\). As at least one of \\(a\\) and \\(b\\) is even, the expression \\(a b-c\\) is odd; since it is also a power of 2 , we obtain\n\n\\[\na b-c=1\n\\]\n\nIf \\(a=b\\), then \\(c=a^{2}-1\\), and from \\(a c-b=a\\left(a^{2}-2\\right)\\) being a power of 2 it follows that both \\(a\\) and \\(a^{2}-2\\) are powers of 2 , whence \\(a=2\\). This gives rise to the solution \\((2,2,3)\\).\n\nWe may suppose \\(a<b\\) from now on. As usual, we let \\(\\alpha>\\beta\\) denote the integers satisfying\n\n\\[\n2^{\\alpha}=b c-a \\quad \\text { and } \\quad 2^{\\beta}=a c-b\n\\]\n\nIf \\(\\beta=0\\) it would follow that \\(a c-b=a b-c=1\\) and hence that \\(b=c=1\\), which is absurd. So \\(\\beta\\) and \\(\\alpha\\) are positive and consequently \\(a\\) and \\(b\\) are even. Substituting \\(c=a b-1\\) into (9) we obtain\n\n\\[\n\\begin{aligned}\n2^{\\alpha} & =a b^{2}-(a+b) \n\\text { and } \\quad 2^{\\beta} & =a^{2} b-(a+b)\n\n\\]\n\nThe addition of both equation yields \\(2^{\\alpha}+2^{\\beta}=(a b-2)(a+b)\\). Now \\(a b-2\\) is even but not divisible by 4 , so the highest power of 2 dividing \\(a+b\\) is \\(2^{\\beta-1}\\). For this reason, the equations (10) and (11) show that the highest powers of 2 dividing either of the numbers \\(a b^{2}\\) and \\(a^{2} b\\) is likewise \\(2^{\\beta-1}\\). Thus there is an integer \\(\\tau \\geqslant 1\\) together with odd integers \\(A, B\\), and \\(C\\) such that \\(a=2^{\\tau} A, b=2^{\\tau} B, a+b=2^{3 \\tau} C\\), and \\(\\beta=1+3 \\tau\\).\n\nNotice that \\(A+B=2^{2 \\tau} C \\geqslant 4 C\\). Moreover, (11) entails \\(A^{2} B-C=2\\). Thus \\(8=\\) \\(4 A^{2} B-4 C \\geqslant 4 A^{2} B-A-B \\geqslant A^{2}(3 B-1)\\). Since \\(A\\) and \\(B\\) are odd with \\(A<B\\), this is only possible if \\(A=1\\) and \\(B=3\\). Finally, one may conclude \\(C=1, \\tau=1, a=2, b=6\\), and \\(c=11\\). We have thereby found the triple ( \\(2,6,11\\) ). This completes the discussion of the third case, and hence the solution.\n\nComment. In both solutions, there are many alternative ways to proceed in each of its cases. Here we present a different treatment of the part \" \\(a<b\\) \" of Case 3 in Solution 2, assuming that (8) and (9) have already been written down:\n\nPut \\(d=\\operatorname{gcd}(a, b)\\) and define the integers \\(p\\) and \\(q\\) by \\(a=d p\\) and \\(b=d q\\); notice that \\(p<q\\) and \\(\\operatorname{gcd}(p, q)=1\\). Now (8) implies \\(c=d^{2} p q-1\\) and thus we have\n\n\\[\n\\begin{aligned}\n& 2^{\\alpha}=d\\left(d^{2} p q^{2}-p-q\\right) \n\\text { and } \\quad 2^{\\beta} & =d\\left(d^{2} p^{2} q-p-q\\right)\n\n\\]\n\nNow \\(2^{\\beta}\\) divides \\(2^{\\alpha}-2^{\\beta}=d^{3} p q(q-p)\\) and, as \\(p\\) and \\(q\\) are easily seen to be coprime to \\(d^{2} p^{2} q-p-q\\), it follows that\n\n\\[\n\\left(d^{2} p^{2} q-p-q\\right) \\mid d^{2}(q-p)\n\\]\n\nIn particular, we have \\(d^{2} p^{2} q-p-q \\leqslant d^{2}(q-p)\\), i.e., \\(d^{2}\\left(p^{2} q+p-q\\right) \\leqslant p+q\\). As \\(p^{2} q+p-q>0\\), this may be weakened to \\(p^{2} q+p-q \\leqslant p+q\\). Hence \\(p^{2} q \\leqslant 2 q\\), which is only possible if \\(p=1\\).\n\nGoing back to (13), we get\n\n\\[\n\\left(d^{2} q-q-1\\right) \\mid d^{2}(q-1)\n\\]\n\nNow \\(2\\left(d^{2} q-q-1\\right) \\leqslant d^{2}(q-1)\\) would entail \\(d^{2}(q+1) \\leqslant 2(q+1)\\) and thus \\(d=1\\). But this would tell us that \\(a=d p=1\\), which is absurd. This argument proves \\(2\\left(d^{2} q-q-1\\right)>d^{2}(q-1)\\) and in the light of (14) it follows that \\(d^{2} q-q-1=d^{2}(q-1)\\), i.e., \\(q=d^{2}-1\\). Plugging this together with \\(p=1\\) into (12) we infer \\(2^{\\beta}=d^{3}\\left(d^{2}-2\\right)\\). Hence \\(d\\) and \\(d^{2}-2\\) are powers of 2 . Consequently, \\(d=2, q=3\\), \\(a=2, b=6\\), and \\(c=11\\), as desired."}
{"id": "imo-shortlist-2015-n6", "question": "N6. Let \\(\\mathbb{Z}_{>0}\\) denote the set of positive integers. Consider a function \\(f: \\mathbb{Z}_{>0} \\rightarrow \\mathbb{Z}_{>0}\\). For any \\(m, n \\in \\mathbb{Z}_{>0}\\) we write \\(f^{n}(m)=\\underbrace{f(f(\\ldots f}_{n}(m) \\ldots))\\). Suppose that \\(f\\) has the following two properties:\n(i) If \\(m, n \\in \\mathbb{Z}_{>0}\\), then \\(\\frac{f^{n}(m)-m}{n} \\in \\mathbb{Z}_{>0}\\);\n(ii) The set \\(\\mathbb{Z}_{>0} \\backslash\\left\\{f(n) \\mid n \\in \\mathbb{Z}_{>0}\\right\\}\\) is finite.\n\nProve that the sequence \\(f(1)-1, f(2)-2, f(3)-3, \\ldots\\) is periodic.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2015, "solution": "We split the solution into three steps. In the first of them, we show that the function \\(f\\) is injective and explain how this leads to a useful visualization of \\(f\\). Then comes the second step, in which most of the work happens: its goal is to show that for any \\(n \\in \\mathbb{Z}_{>0}\\) the sequence \\(n, f(n), f^{2}(n), \\ldots\\) is an arithmetic progression. Finally, in the third step we put everything together, thus solving the problem.\n\nStep 1. We commence by checking that \\(f\\) is injective. For this purpose, we consider any \\(m, k \\in \\mathbb{Z}_{>0}\\) with \\(f(m)=f(k)\\). By \\((i)\\), every positive integer \\(n\\) has the property that\n\n\\[\n\\frac{k-m}{n}=\\frac{f^{n}(m)-m}{n}-\\frac{f^{n}(k)-k}{n}\n\\]\n\nis a difference of two integers and thus integral as well. But for \\(n=|k-m|+1\\) this is only possible if \\(k=m\\). Thereby, the injectivity of \\(f\\) is established.\n\nNow recall that due to condition ( \\(i i\\) ) there are finitely many positive integers \\(a_{1}, \\ldots, a_{k}\\) such that \\(\\mathbb{Z}_{>0}\\) is the disjoint union of \\(\\left\\{a_{1}, \\ldots, a_{k}\\right\\}\\) and \\(\\left\\{f(n) \\mid n \\in \\mathbb{Z}_{>0}\\right\\}\\). Notice that by plugging \\(n=1\\) into condition ( \\(i\\) ) we get \\(f(m)>m\\) for all \\(m \\in \\mathbb{Z}_{>0}\\).\n\nWe contend that every positive integer \\(n\\) may be expressed uniquely in the form \\(n=f^{j}\\left(a_{i}\\right)\\) for some \\(j \\geqslant 0\\) and \\(i \\in\\{1, \\ldots, k\\}\\). The uniqueness follows from the injectivity of \\(f\\). The existence can be proved by induction on \\(n\\) in the following way. If \\(n \\in\\left\\{a_{1}, \\ldots, a_{k}\\right\\}\\), then we may take \\(j=0\\); otherwise there is some \\(n^{\\prime}<n\\) with \\(f\\left(n^{\\prime}\\right)=n\\) to which the induction hypothesis may be applied.\n\nThe result of the previous paragraph means that every positive integer appears exactly once in the following infinite picture, henceforth referred to as \"the Table\":\n\n\\begin{center}\n\\begin{tabular}{|c|c|c|c|c}\n\\hline\n\\(a_{1}\\) & \\(f\\left(a_{1}\\right)\\) & \\(f^{2}\\left(a_{1}\\right)\\) & \\(f^{3}\\left(a_{1}\\right)\\) & \\(\\ldots\\) \n\\hline\n\\(a_{2}\\) & \\(f\\left(a_{2}\\right)\\) & \\(f^{2}\\left(a_{2}\\right)\\) & \\(f^{3}\\left(a_{2}\\right)\\) & \\(\\ldots\\) \n\\hline\n\\(\\vdots\\) & \\(\\vdots\\) & \\(\\vdots\\) & \\(\\vdots\\) &  \n\\hline\n\\(a_{k}\\) & \\(f\\left(a_{k}\\right)\\) & \\(f^{2}\\left(a_{k}\\right)\\) & \\(f^{3}\\left(a_{k}\\right)\\) & \\(\\ldots\\) \n\\hline\n\n\n\nThe Table\n\nStep 2. Our next goal is to prove that each row of the Table is an arithmetic progression. Assume contrariwise that the number \\(t\\) of rows which are arithmetic progressions would satisfy \\(0 \\leqslant t<k\\). By permuting the rows if necessary we may suppose that precisely the first \\(t\\) rows are arithmetic progressions, say with steps \\(T_{1}, \\ldots, T_{t}\\). Our plan is to find a further row that is \"not too sparse\" in an asymptotic sense, and then to prove that such a row has to be an arithmetic progression as well.\n\nLet us write \\(T=\\operatorname{lcm}\\left(T_{1}, T_{2}, \\ldots, T_{t}\\right)\\) and \\(A=\\max \\left\\{a_{1}, a_{2}, \\ldots, a_{t}\\right\\}\\) if \\(t>0\\); and \\(T=1\\) and \\(A=0\\) if \\(t=0\\). For every integer \\(n \\geqslant A\\), the interval \\(\\Delta_{n}=[n+1, n+T]\\) contains exactly \\(T / T_{i}\\)\nelements of the \\(i^{\\text {th }}\\) row \\((1 \\leqslant i \\leqslant t)\\). Therefore, the number of elements from the last \\((k-t)\\) rows of the Table contained in \\(\\Delta_{n}\\) does not depend on \\(n \\geqslant A\\). It is not possible that none of these intervals \\(\\Delta_{n}\\) contains an element from the \\(k-t\\) last rows, because infinitely many numbers appear in these rows. It follows that for each \\(n \\geqslant A\\) the interval \\(\\Delta_{n}\\) contains at least one member from these rows.\n\nThis yields that for every positive integer \\(d\\), the interval \\([A+1, A+(d+1)(k-t) T]\\) contains at least \\((d+1)(k-t)\\) elements from the last \\(k-t\\) rows; therefore, there exists an index \\(x\\) with \\(t+1 \\leqslant x \\leqslant k\\), possibly depending on \\(d\\), such that our interval contains at least \\(d+1\\) elements from the \\(x^{\\text {th }}\\) row. In this situation we have\n\n\\[\nf^{d}\\left(a_{x}\\right) \\leqslant A+(d+1)(k-t) T\n\\]\n\nFinally, since there are finitely many possibilities for \\(x\\), there exists an index \\(x \\geqslant t+1\\) such that the set\n\n\\[\nX=\\left\\{d \\in \\mathbb{Z}_{>0} \\mid f^{d}\\left(a_{x}\\right) \\leqslant A+(d+1)(k-t) T\\right\\}\n\\]\n\nis infinite. Thereby we have found the \"dense row\" promised above.\nBy assumption ( \\(i\\) ), for every \\(d \\in X\\) the number\n\n\\[\n\\beta_{d}=\\frac{f^{d}\\left(a_{x}\\right)-a_{x}}{d}\n\\]\n\nis a positive integer not exceeding\n\n\\[\n\\frac{A+(d+1)(k-t) T}{d} \\leqslant \\frac{A d+2 d(k-t) T}{d}=A+2(k-t) T\n\\]\n\nThis leaves us with finitely many choices for \\(\\beta_{d}\\), which means that there exists a number \\(T_{x}\\) such that the set\n\n\\[\nY=\\left\\{d \\in X \\mid \\beta_{d}=T_{x}\\right\\}\n\\]\n\nis infinite. Notice that we have \\(f^{d}\\left(a_{x}\\right)=a_{x}+d \\cdot T_{x}\\) for all \\(d \\in Y\\).\nNow we are prepared to prove that the numbers in the \\(x^{\\text {th }}\\) row form an arithmetic progression, thus coming to a contradiction with our assumption. Let us fix any positive integer \\(j\\). Since the set \\(Y\\) is infinite, we can choose a number \\(y \\in Y\\) such that \\(y-j>\\left|f^{j}\\left(a_{x}\\right)-\\left(a_{x}+j T_{x}\\right)\\right|\\). Notice that both numbers\n\n\\[\nf^{y}\\left(a_{x}\\right)-f^{j}\\left(a_{x}\\right)=f^{y-j}\\left(f^{j}\\left(a_{x}\\right)\\right)-f^{j}\\left(a_{x}\\right) \\quad \\text { and } \\quad f^{y}\\left(a_{x}\\right)-\\left(a_{x}+j T_{x}\\right)=(y-j) T_{x}\n\\]\n\nare divisible by \\(y-j\\). Thus, the difference between these numbers is also divisible by \\(y-j\\). Since the absolute value of this difference is less than \\(y-j\\), it has to vanish, so we get \\(f^{j}\\left(a_{x}\\right)=\\) \\(a_{x}+j \\cdot T_{x}\\).\n\nHence, it is indeed true that all rows of the Table are arithmetic progressions.\nStep 3. Keeping the above notation in force, we denote the step of the \\(i^{\\text {th }}\\) row of the table by \\(T_{i}\\). Now we claim that we have \\(f(n)-n=f(n+T)-(n+T)\\) for all \\(n \\in \\mathbb{Z}_{>0}\\), where\n\n\\[\nT=\\operatorname{lcm}\\left(T_{1}, \\ldots, T_{k}\\right)\n\\]\n\nTo see this, let any \\(n \\in \\mathbb{Z}_{>0}\\) be given and denote the index of the row in which it appears in the Table by \\(i\\). Then we have \\(f^{j}(n)=n+j \\cdot T_{i}\\) for all \\(j \\in \\mathbb{Z}_{>0}\\), and thus indeed\n\n\\[\nf(n+T)-f(n)=f^{1+T / T_{i}}(n)-f(n)=\\left(n+T+T_{i}\\right)-\\left(n+T_{i}\\right)=T\n\\]\n\nThis concludes the solution.\n\nComment 1. There are some alternative ways to complete the second part once the index \\(x\\) corresponding to a \"dense row\" is found. For instance, one may show that for some integer \\(T_{x}^{*}\\) the set\n\n\\[\nY^{*}=\\left\\{j \\in \\mathbb{Z}_{>0} \\mid f^{j+1}\\left(a_{x}\\right)-f^{j}\\left(a_{x}\\right)=T_{x}^{*}\\right\\}\n\\]\n\nis infinite, and then one may conclude with a similar divisibility argument.\nComment 2. It may be checked that, conversely, any way to fill out the Table with finitely many arithmetic progressions so that each positive integer appears exactly once, gives rise to a function \\(f\\) satisfying the two conditions mentioned in the problem. For example, we may arrange the positive integers as follows:\n\n\\begin{center}\n\\begin{tabular}{|c|c|c|c|c|c}\n\\hline\n2 & 4 & 6 & 8 & 10 & \\(\\ldots\\) \n\\hline\n1 & 5 & 9 & 13 & 17 & \\(\\ldots\\) \n\\hline\n3 & 7 & 11 & 15 & 19 & \\(\\ldots\\) \n\\hline\n\n\n\nThis corresponds to the function\n\n\\[\nf(n)= \\begin{cases}n+2 & \\text { if } n \\text { is even } \\\\ n+4 & \\text { if } n \\text { is odd }\n\\]\n\nAs this example shows, it is not true that the function \\(n \\mapsto f(n)-n\\) has to be constant."}
{"id": "imo-shortlist-2015-n7", "question": "N7. Let \\(\\mathbb{Z}_{>0}\\) denote the set of positive integers. For any positive integer \\(k\\), a function \\(f: \\mathbb{Z}_{>0} \\rightarrow \\mathbb{Z}_{>0}\\) is called \\(k\\)-good if \\(\\operatorname{gcd}(f(m)+n, f(n)+m) \\leqslant k\\) for all \\(m \\neq n\\). Find all \\(k\\) such that there exists a \\(k\\)-good function.\n\nAnswer. \\(k \\geqslant 2\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2015, "solution": "For any function \\(f: \\mathbb{Z}_{>0} \\rightarrow \\mathbb{Z}_{>0}\\), let \\(G_{f}(m, n)=\\operatorname{gcd}(f(m)+n, f(n)+m)\\). Note that a \\(k\\)-good function is also \\((k+1)\\)-good for any positive integer \\(k\\). Hence, it suffices to show that there does not exist a 1-good function and that there exists a 2-good function.\n\nWe first show that there is no 1 -good function. Suppose that there exists a function \\(f\\) such that \\(G_{f}(m, n)=1\\) for all \\(m \\neq n\\). Now, if there are two distinct even numbers \\(m\\) and \\(n\\) such that \\(f(m)\\) and \\(f(n)\\) are both even, then \\(2 \\mid G_{f}(m, n)\\), a contradiction. A similar argument holds if there are two distinct odd numbers \\(m\\) and \\(n\\) such that \\(f(m)\\) and \\(f(n)\\) are both odd. Hence we can choose an even \\(m\\) and an odd \\(n\\) such that \\(f(m)\\) is odd and \\(f(n)\\) is even. This also implies that \\(2 \\mid G_{f}(m, n)\\), a contradiction.\n\nWe now construct a 2-good function. Define \\(f(n)=2^{g(n)+1}-n-1\\), where \\(g\\) is defined recursively by \\(g(1)=1\\) and \\(g(n+1)=\\left(2^{g(n)+1}\\right)!\\).\n\nFor any positive integers \\(m>n\\), set\n\n\\[\nA=f(m)+n=2^{g(m)+1}-m+n-1, \\quad B=f(n)+m=2^{g(n)+1}-n+m-1\n\\]\n\nWe need to show that \\(\\operatorname{gcd}(A, B) \\leqslant 2\\). First, note that \\(A+B=2^{g(m)+1}+2^{g(n)+1}-2\\) is not divisible by 4 , so that \\(4 \\nmid \\operatorname{gcd}(A, B)\\). Now we suppose that there is an odd prime \\(p\\) for which \\(p \\mid \\operatorname{gcd}(A, B)\\) and derive a contradiction.\n\nWe first claim that \\(2^{g(m-1)+1} \\geqslant B\\). This is a rather weak bound; one way to prove it is as follows. Observe that \\(g(k+1)>g(k)\\) and hence \\(2^{g(k+1)+1} \\geqslant 2^{g(k)+1}+1\\) for every positive integer \\(k\\). By repeatedly applying this inequality, we obtain \\(2^{g(m-1)+1} \\geqslant 2^{g(n)+1}+(m-1)-n=B\\).\n\nNow, since \\(p \\mid B\\), we have \\(p-1<B \\leqslant 2^{g(m-1)+1}\\), so that \\(p-1 \\mid\\left(2^{g(m-1)+1}\\right)!=g(m)\\). Hence \\(2^{g(m)} \\equiv 1(\\bmod p)\\), which yields \\(A+B \\equiv 2^{g(n)+1}(\\bmod p)\\). However, since \\(p \\mid A+B\\), this implies that \\(p=2\\), a contradiction.\n\nSolution 2. We provide an alternative construction of a 2 -good function \\(f\\).\nLet \\(\\mathcal{P}\\) be the set consisting of 4 and all odd primes. For every \\(p \\in \\mathcal{P}\\), we say that a number \\(a \\in\\{0,1, \\ldots, p-1\\}\\) is \\(p\\)-useful if \\(a \\not \\equiv-a(\\bmod p)\\). Note that a residue modulo \\(p\\) which is neither 0 nor 2 is \\(p\\)-useful (the latter is needed only when \\(p=4\\) ).\n\nWe will construct \\(f\\) recursively; in some steps, we will also define a \\(p\\)-useful number \\(a_{p}\\). After the \\(m^{\\text {th }}\\) step, the construction will satisfy the following conditions:\n(i) The values of \\(f(n)\\) have already been defined for all \\(n \\leqslant m\\), and \\(p\\)-useful numbers \\(a_{p}\\) have already been defined for all \\(p \\leqslant m+2\\);\n(ii) If \\(n \\leqslant m\\) and \\(p \\leqslant m+2\\), then \\(f(n)+n \\not \\equiv a_{p}(\\bmod p)\\);\n(iii) \\(\\operatorname{gcd}\\left(f\\left(n_{1}\\right)+n_{2}, f\\left(n_{2}\\right)+n_{1}\\right) \\leqslant 2\\) for all \\(n_{1}<n_{2} \\leqslant m\\).\n\nIf these conditions are satisfied, then \\(f\\) will be a 2 -good function.\nStep 1. Set \\(f(1)=1\\) and \\(a_{3}=1\\). Clearly, all the conditions are satisfied.\nStep \\(m\\), for \\(m \\geqslant 2\\). We need to determine \\(f(m)\\) and, if \\(m+2 \\in \\mathcal{P}\\), the number \\(a_{m+2}\\). Defining \\(f(m)\\). Let \\(X_{m}=\\{p \\in \\mathcal{P}: p \\mid f(n)+m\\) for some \\(n<m\\}\\). We will determine \\(f(m) \\bmod p\\) for all \\(p \\in X_{m}\\) and then choose \\(f(m)\\) using the Chinese Remainder Theorem.\n\nTake any \\(p \\in X_{m}\\). If \\(p \\leqslant m+1\\), then we define \\(f(m) \\equiv-a_{p}-m(\\bmod p)\\). Otherwise, if \\(p \\geqslant m+2\\), then we define \\(f(m) \\equiv 0(\\bmod p)\\).\nDefining \\(a_{m+2}\\). Now let \\(p=m+2\\) and suppose that \\(p \\in \\mathcal{P}\\). We choose \\(a_{p}\\) to be a residue modulo \\(p\\) that is not congruent to 0,2 , or \\(f(n)+n\\) for any \\(n \\leqslant m\\). Since \\(f(1)+1=2\\), there are at most \\(m+1<p\\) residues to avoid, so we can always choose a remaining residue.\n\nWe first check that ( \\(i i\\) ) is satisfied. We only need to check it if \\(p=m+2\\) or \\(n=m\\). In the former case, we have \\(f(n)+n \\neq a_{p}(\\bmod p)\\) by construction. In the latter case, if \\(n=m\\) and \\(p \\leqslant m+1\\), then we have \\(f(m)+m \\equiv-a_{p} \\not \\equiv a_{p}(\\bmod p)\\), where we make use of the fact that \\(a_{p}\\) is \\(p\\)-useful.\n\nNow we check that (iii) holds. Suppose, to the contrary, that \\(p \\mid \\operatorname{gcd}(f(n)+m, f(m)+n)\\) for some \\(n<m\\). Then \\(p \\in X_{m}\\) and \\(p \\mid f(m)+n\\). If \\(p \\geqslant m+2\\), then \\(0 \\equiv f(m)+n \\equiv n(\\bmod p)\\), which is impossible since \\(n<m<p\\).\n\nOtherwise, if \\(p \\leqslant m+1\\), then\n\n\\[\n0 \\equiv(f(m)+n)+(f(n)+m) \\equiv(f(n)+n)+(f(m)+m) \\equiv(f(n)+n)-a_{p}(\\bmod p)\n\\]\n\nThis implies that \\(f(n)+n \\equiv a_{p}(\\bmod p)\\), a contradiction with \\((i i)\\).\nComment 1. For any \\(p \\in \\mathcal{P}\\), we may also define \\(a_{p}\\) at step \\(m\\) for an arbitrary \\(m \\leqslant p-2\\). The construction will work as long as we define a finite number of \\(a_{p}\\) at each step.\n\nComment 2. When attempting to construct a 2-good function \\(f\\) recursively, the following way seems natural. Start with setting \\(f(1)=1\\). Next, for each integer \\(m>1\\), introduce the set \\(X_{m}\\) like in Solution 2 and define \\(f(m)\\) so as to satisfy\n\n\\[\n\\begin{array}{rll}\nf(m) \\equiv f(m-p) & (\\bmod p) & \\text { for all } p \\in X_{m} \\text { with } p<m, \\quad \\text { and } \nf(m) \\equiv 0 & (\\bmod p) & \\text { for all } p \\in X_{m} \\text { with } p \\geqslant m .\n\n\\]\n\nThis construction might seem to work. Indeed, consider a fixed \\(p \\in \\mathcal{P}\\), and suppose that \\(p\\) divides \\(\\operatorname{gcd}(f(n)+m, f(m)+n)\\) for some \\(n<m\\). Choose such \\(m\\) and \\(n\\) so that \\(\\max (m, n)\\) is minimal. Then \\(p \\in X_{m}\\). We can check that \\(p<m\\), so that the construction implies that \\(p\\) divides \\(\\operatorname{gcd}(f(n)+(m-p), f(m-p)+n)\\). Since \\(\\max (n, m-p)<\\max (m, n)\\), this almost leads to a contradiction-the only trouble is the possibility that \\(n=m-p\\). However, this flaw may happen to be not so easy to fix.\n\nWe will present one possible way to repair this argument in the next comment.\nComment 3. There are many recursive constructions for a 2 -good function \\(f\\). Here we sketch one general approach which may be specified in different ways. For convenience, we denote by \\(\\mathbb{Z}_{p}\\) the set of residues modulo \\(p\\); all operations on elements of \\(\\mathbb{Z}_{p}\\) are also performed modulo \\(p\\).\n\nThe general structure is the same as in Solution 2, i.e. using the Chinese Remainder Theorem to successively determine \\(f(m)\\). But instead of designating a common \"safe\" residue \\(a_{p}\\) for future steps, we act as follows.\n\nFor every \\(p \\in \\mathcal{P}\\), in some step of the process we define \\(p\\) subsets \\(B_{p}^{(1)}, B_{p}^{(2)}, \\ldots, B_{p}^{(p)} \\subset \\mathbb{Z}_{p}\\). The meaning of these sets is that\n\n\\[\nf(m)+m \\text { should be congruent to some element in } B_{p}^{(i)} \\text { whenever } m \\equiv i(\\bmod p) \\text { for } i \\in \\mathbb{Z}_{p} \\text {. }\n\\]\n\nMoreover, in every such subset we specify a safe element \\(b_{p}^{(i)} \\in B_{p}^{(i)}\\). The meaning now is that in future steps, it is safe to set \\(f(m)+m \\equiv b_{p}^{(i)}(\\bmod p)\\) whenever \\(m \\equiv i(\\bmod p)\\). In view of (1), this safety will follow from the condition that \\(p \\nmid \\operatorname{gcd}\\left(b_{p}^{(i)}+(j-i), c^{(j)}-(j-i)\\right)\\) for all \\(j \\in \\mathbb{Z}_{p}\\) and all \\(c^{(j)} \\in B_{p}^{(j)}\\). In turn, this condition can be rewritten as\n\n\\[\n-b_{p}^{(i)} \\notin B_{p}^{(j)}, \\quad \\text { where } \\quad j \\equiv i-b_{p}^{(i)} \\quad(\\bmod p) .\n\\]\n\nThe construction in Solution 2 is equivalent to setting \\(b_{p}^{(i)}=-a_{p}\\) and \\(B_{p}^{(i)}=\\mathbb{Z}_{p} \\backslash\\left\\{a_{p}\\right\\}\\) for all \\(i\\). However, there are different, more technical specifications of our approach.\n\nOne may view the (incomplete) construction in Comment 2 as defining \\(B_{p}^{(i)}\\) and \\(b_{p}^{(i)}\\) at step \\(p-1\\) by setting \\(B_{p}^{(0)}=\\left\\{b_{p}^{(0)}\\right\\}=\\{0\\}\\) and \\(B_{p}^{(i)}=\\left\\{b_{p}^{(i)}\\right\\}=\\{f(i)+i \\bmod p\\}\\) for every \\(i=1,2, \\ldots, p-1\\). However, this construction violates (2) as soon as some number of the form \\(f(i)+i\\) is divisible by some \\(p\\) with \\(i+2 \\leqslant p \\in \\mathcal{P}\\), since then \\(-b_{p}^{(i)}=b_{p}^{(i)} \\in B_{p}^{(i)}\\).\n\nHere is one possible way to repair this construction. For all \\(p \\in \\mathcal{P}\\), we define the sets \\(B_{p}^{(i)}\\) and the elements \\(b_{p}^{(i)}\\) at step ( \\(p-2\\) ) as follows. Set \\(B_{p}^{(1)}=\\left\\{b_{p}^{(1)}\\right\\}=\\{2\\}\\) and \\(B_{p}^{(-1)}=B_{p}^{(0)}=\\left\\{b_{p}^{(-1)}\\right\\}=\\left\\{b_{p}^{(0)}\\right\\}=\\) \\(\\{-1\\}\\). Next, for all \\(i=2, \\ldots, p-2\\), define \\(B_{p}^{(i)}=\\{i, f(i)+i \\bmod p\\}\\) and \\(b_{p}^{(i)}=i\\). One may see that these definitions agree with both (1) and (2)."}
{"id": "imo-shortlist-2015-n8", "question": "N8. For every positive integer \\(n\\) with prime factorization \\(n=\\prod_{i=1}^{k} p_{i}^{\\alpha_{i}}\\), define\n\n\\[\n\\mho(n)=\\sum_{i: p_{i}>10^{100}} \\alpha_{i}\n\\]\n\nThat is, \\(\\mho(n)\\) is the number of prime factors of \\(n\\) greater than \\(10^{100}\\), counted with multiplicity.\nFind all strictly increasing functions \\(f: \\mathbb{Z} \\rightarrow \\mathbb{Z}\\) such that\n\n\\[\n\\mho(f(a)-f(b)) \\leqslant \\mho(a-b) \\quad \\text { for all integers } a \\text { and } b \\text { with } a>b\n\\]\n\nAnswer. \\(f(x)=a x+b\\), where \\(b\\) is an arbitrary integer, and \\(a\\) is an arbitrary positive integer with \\(\\mho(a)=0\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2015, "solution": "A straightforward check shows that all the functions listed in the answer satisfy the problem condition. It remains to show the converse.\n\nAssume that \\(f\\) is a function satisfying the problem condition. Notice that the function \\(g(x)=f(x)-f(0)\\) also satisfies this condition. Replacing \\(f\\) by \\(g\\), we assume from now on that \\(f(0)=0\\); then \\(f(n)>0\\) for any positive integer \\(n\\). Thus, we aim to prove that there exists a positive integer \\(a\\) with \\(\\mho(a)=0\\) such that \\(f(n)=a n\\) for all \\(n \\in \\mathbb{Z}\\).\n\nWe start by introducing some notation. Set \\(N=10^{100}\\). We say that a prime \\(p\\) is large if \\(p>N\\), and \\(p\\) is small otherwise; let \\(\\mathcal{S}\\) be the set of all small primes. Next, we say that a positive integer is large or small if all its prime factors are such (thus, the number 1 is the unique number which is both large and small). For a positive integer \\(k\\), we denote the greatest large divisor of \\(k\\) and the greatest small divisor of \\(k\\) by \\(L(k)\\) and \\(S(k)\\), respectively; thus, \\(k=L(k) S(k)\\).\n\nWe split the proof into three steps.\nStep 1. We prove that for every large \\(k\\), we have \\(k|f(a)-f(b) \\Longleftrightarrow k| a-b\\). In other words, \\(L(f(a)-f(b))=L(a-b)\\) for all integers \\(a\\) and \\(b\\) with \\(a>b\\).\n\nWe use induction on \\(k\\). The base case \\(k=1\\) is trivial. For the induction step, assume that \\(k_{0}\\) is a large number, and that the statement holds for all large numbers \\(k\\) with \\(k<k_{0}\\).\nClaim 1. For any integers \\(x\\) and \\(y\\) with \\(0<x-y<k_{0}\\), the number \\(k_{0}\\) does not divide \\(f(x)-f(y)\\).\nProof. Assume, to the contrary, that \\(k_{0} \\mid f(x)-f(y)\\). Let \\(\\ell=L(x-y)\\); then \\(\\ell \\leqslant x-y<k_{0}\\). By the induction hypothesis, \\(\\ell \\mid f(x)-f(y)\\), and thus \\(\\operatorname{lcm}\\left(k_{0}, \\ell\\right) \\mid f(x)-f(y)\\). Notice that \\(\\operatorname{lcm}\\left(k_{0}, \\ell\\right)\\) is large, and \\(\\operatorname{lcm}\\left(k_{0}, \\ell\\right) \\geqslant k_{0}>\\ell\\). But then\n\n\\[\n\\mho(f(x)-f(y)) \\geqslant \\mho\\left(\\operatorname{lcm}\\left(k_{0}, \\ell\\right)\\right)>\\mho(\\ell)=\\mho(x-y)\n\\]\n\nwhich is impossible.\nNow we complete the induction step. By Claim 1, for every integer \\(a\\) each of the sequences\n\n\\[\nf(a), f(a+1), \\ldots, f\\left(a+k_{0}-1\\right) \\quad \\text { and } \\quad f(a+1), f(a+2), \\ldots, f\\left(a+k_{0}\\right)\n\\]\n\nforms a complete residue system modulo \\(k_{0}\\). This yields \\(f(a) \\equiv f\\left(a+k_{0}\\right)\\left(\\bmod k_{0}\\right)\\). Thus, \\(f(a) \\equiv f(b)\\left(\\bmod k_{0}\\right)\\) whenever \\(a \\equiv b\\left(\\bmod k_{0}\\right)\\).\n\nFinally, if \\(a \\not \\equiv b\\left(\\bmod k_{0}\\right)\\) then there exists an integer \\(b^{\\prime}\\) such that \\(b^{\\prime} \\equiv b\\left(\\bmod k_{0}\\right)\\) and \\(\\left|a-b^{\\prime}\\right|<k_{0}\\). Then \\(f(b) \\equiv f\\left(b^{\\prime}\\right) \\not \\equiv f(a)\\left(\\bmod k_{0}\\right)\\). The induction step is proved.\nStep 2. We prove that for some small integer a there exist infinitely many integers \\(n\\) such that \\(\\overline{f(n)=}\\) an. In other words, \\(f\\) is linear on some infinite set.\n\nWe start with the following general statement.\n\nClaim 2. There exists a constant \\(c\\) such that \\(f(t)<c t\\) for every positive integer \\(t>N\\).\nProof. Let \\(d\\) be the product of all small primes, and let \\(\\alpha\\) be a positive integer such that \\(2^{\\alpha}>f(N)\\). Then, for every \\(p \\in \\mathcal{S}\\) the numbers \\(f(0), f(1), \\ldots, f(N)\\) are distinct modulo \\(p^{\\alpha}\\). Set \\(P=d^{\\alpha}\\) and \\(c=P+f(N)\\).\n\nChoose any integer \\(t>N\\). Due to the choice of \\(\\alpha\\), for every \\(p \\in \\mathcal{S}\\) there exists at most one nonnegative integer \\(i \\leqslant N\\) with \\(p^{\\alpha} \\mid f(t)-f(i)\\). Since \\(|\\mathcal{S}|<N\\), we can choose a nonnegative integer \\(j \\leqslant N\\) such that \\(p^{\\alpha} \\nmid f(t)-f(j)\\) for all \\(p \\in \\mathcal{S}\\). Therefore, \\(S(f(t)-f(j))<P\\).\n\nOn the other hand, Step 1 shows that \\(L(f(t)-f(j))=L(t-j) \\leqslant t-j\\). Since \\(0 \\leqslant j \\leqslant N\\), this yields\n\n\\[\nf(t)=f(j)+L(f(t)-f(j)) \\cdot S(f(t)-f(j))<f(N)+(t-j) P \\leqslant(P+f(N)) t=c t\n\\]\n\nNow let \\(\\mathcal{T}\\) be the set of large primes. For every \\(t \\in \\mathcal{T}\\), Step 1 implies \\(L(f(t))=t\\), so the ratio \\(f(t) / t\\) is an integer. Now Claim 2 leaves us with only finitely many choices for this ratio, which means that there exists an infinite subset \\(\\mathcal{T}^{\\prime} \\subseteq \\mathcal{T}\\) and a positive integer \\(a\\) such that \\(f(t)=a t\\) for all \\(t \\in \\mathcal{T}^{\\prime}\\), as required.\n\nSince \\(L(t)=L(f(t))=L(a) L(t)\\) for all \\(t \\in \\mathcal{T}^{\\prime}\\), we get \\(L(a)=1\\), so the number \\(a\\) is small.\nStep 3. We show that \\(f(x)=\\) ax for all \\(x \\in \\mathbb{Z}\\).\nLet \\(R_{i}=\\{x \\in \\mathbb{Z}: x \\equiv i(\\bmod N!)\\}\\) denote the residue class of \\(i\\) modulo \\(N!\\).\nClaim 3. Assume that for some \\(r\\), there are infinitely many \\(n \\in R_{r}\\) such that \\(f(n)=a n\\). Then \\(f(x)=a x\\) for all \\(x \\in R_{r+1}\\).\nProof. Choose any \\(x \\in R_{r+1}\\). By our assumption, we can select \\(n \\in R_{r}\\) such that \\(f(n)=\\) an and \\(|n-x|>|f(x)-a x|\\). Since \\(n-x \\equiv r-(r+1)=-1(\\bmod N!)\\), the number \\(|n-x|\\) is large. Therefore, by Step 1 we have \\(f(x) \\equiv f(n)=a n \\equiv a x(\\bmod n-x)\\), so \\(n-x \\mid f(x)-a x\\). Due to the choice of \\(n\\), this yields \\(f(x)=a x\\).\n\nTo complete Step 3, notice that the set \\(\\mathcal{T}^{\\prime}\\) found in Step 2 contains infinitely many elements of some residue class \\(R_{i}\\). Applying Claim 3, we successively obtain that \\(f(x)=a x\\) for all \\(x \\in R_{i+1}, R_{i+2}, \\ldots, R_{i+N!}=R_{i}\\). This finishes the solution.\n\nComment 1. As the proposer also mentions, one may also consider the version of the problem where the condition (1) is replaced by the condition that \\(L(f(a)-f(b))=L(a-b)\\) for all integers \\(a\\) and \\(b\\) with \\(a>b\\). This allows to remove of Step 1 from the solution.\n\nComment 2. Step 2 is the main step of the solution. We sketch several different approaches allowing to perform this step using statements which are weaker than Claim 2.\n\nApproach 1. Let us again denote the product of all small primes by \\(d\\). We focus on the values \\(f\\left(d^{i}\\right)\\), \\(i \\geqslant 0\\). In view of Step 1, we have \\(L\\left(f\\left(d^{i}\\right)-f\\left(d^{k}\\right)\\right)=L\\left(d^{i}-d^{k}\\right)=d^{i-k}-1\\) for all \\(i>k \\geqslant 0\\).\n\nActing similarly to the beginning of the proof of Claim 2, one may choose a number \\(\\alpha \\geqslant 0\\) such that the residues of the numbers \\(f\\left(d^{i}\\right), i=0,1, \\ldots, N\\), are distinct modulo \\(p^{\\alpha}\\) for each \\(p \\in \\mathcal{S}\\). Then, for every \\(i>N\\), there exists an exponent \\(k=k(i) \\leqslant N\\) such that \\(S\\left(f\\left(d^{i}\\right)-f\\left(d^{k}\\right)\\right)<P=d^{\\alpha}\\).\n\nSince there are only finitely many options for \\(k(i)\\), as well as for the corresponding numbers \\(S\\left(f\\left(d^{i}\\right)-f\\left(d^{k}\\right)\\right)\\), there exists an infinite set \\(I\\) of exponents \\(i>N\\) such that \\(k(i)\\) attains the same value \\(k_{0}\\) for all \\(i \\in I\\), and such that, moreover, \\(S\\left(f\\left(d^{i}\\right)-f\\left(d^{k_{0}}\\right)\\right)\\) attains the same value \\(s_{0}\\) for all \\(i \\in I\\). Therefore, for all such \\(i\\) we have\n\n\\[\nf\\left(d^{i}\\right)=f\\left(d^{k_{0}}\\right)+L\\left(f\\left(d^{i}\\right)-f\\left(d^{k_{0}}\\right)\\right) \\cdot S\\left(f\\left(d^{i}\\right)-f\\left(d^{k_{0}}\\right)\\right)=f\\left(d^{k_{0}}\\right)+\\left(d^{i-k_{0}}-1\\right) s_{0}\n\\]\n\nwhich means that \\(f\\) is linear on the infinite set \\(\\left\\{d^{i}: i \\in I\\right\\}\\) (although with rational coefficients).\nFinally, one may implement the relation \\(f\\left(d^{i}\\right) \\equiv f(1)\\left(\\bmod d^{i}-1\\right)\\) in order to establish that in fact \\(f\\left(d^{i}\\right) / d^{i}\\) is a (small and fixed) integer for all \\(i \\in I\\).\n\nApproach 2. Alternatively, one may start with the following lemma.\nLemma. There exists a positive constant \\(c\\) such that\n\n\\[\nL\\left(\\prod_{i=1}^{3 N}(f(k)-f(i))\\right)=\\prod_{i=1}^{3 N} L(f(k)-f(i)) \\geqslant c(f(k))^{2 N}\n\\]\n\nfor all \\(k>3 N\\).\nProof. Let \\(k\\) be an integer with \\(k>3 N\\). Set \\(\\Pi=\\prod_{i=1}^{3 N}(f(k)-f(i))\\).\nNotice that for every prime \\(p \\in \\mathcal{S}\\), at most one of the numbers in the set\n\n\\[\n\\mathcal{H}=\\{f(k)-f(i): 1 \\leqslant i \\leqslant 3 N\\}\n\\]\n\nis divisible by a power of \\(p\\) which is greater than \\(f(3 N)\\); we say that such elements of \\(\\mathcal{H}\\) are bad. Now, for each element \\(h \\in \\mathcal{H}\\) which is not bad we have \\(S(h) \\leqslant f(3 N)^{N}\\), while the bad elements do not exceed \\(f(k)\\). Moreover, there are less than \\(N\\) bad elements in \\(\\mathcal{H}\\). Therefore,\n\n\\[\nS(\\Pi)=\\prod_{h \\in \\mathcal{H}} S(h) \\leqslant(f(3 N))^{3 N^{2}} \\cdot(f(k))^{N}\n\\]\n\nThis easily yields the lemma statement in view of the fact that \\(L(\\Pi) S(\\Pi)=\\Pi \\geqslant \\mu(f(k))^{3 N}\\) for some absolute constant \\(\\mu\\).\n\nAs a corollary of the lemma, one may get a weaker version of Claim 2 stating that there exists a positive constant \\(C\\) such that \\(f(k) \\leqslant C k^{3 / 2}\\) for all \\(k>3 N\\). Indeed, from Step 1 we have\n\n\\[\nk^{3 N} \\geqslant \\prod_{i=1}^{3 N} L(k-i)=\\prod_{i=1}^{3 N} L(f(k)-f(i)) \\geqslant c(f(k))^{2 N}\n\\]\n\nso \\(f(k) \\leqslant c^{-1 /(2 N)} k^{3 / 2}\\).\nTo complete Step 2 now, set \\(a=f(1)\\). Due to the estimates above, we may choose a positive integer \\(n_{0}\\) such that \\(|f(n)-a n|<\\frac{n(n-1)}{2}\\) for all \\(n \\geqslant n_{0}\\).\n\nTake any \\(n \\geqslant n_{0}\\) with \\(n \\equiv 2(\\bmod N!)\\). Then \\(L(f(n)-f(0))=L(n)=n / 2\\) and \\(L(f(n)-f(1))=\\) \\(L(n-1)=n-1\\); these relations yield \\(f(n) \\equiv f(0)=0 \\equiv a n(\\bmod n / 2)\\) and \\(f(n) \\equiv f(1)=a \\equiv a n\\) \\((\\bmod n-1)\\), respectively. Thus, \\(\\left.\\frac{n(n-1)}{2} \\right\\rvert\\, f(n)-a n\\), which shows that \\(f(n)=a n\\) in view of the estimate above.\n\nComment 3. In order to perform Step 3, it suffices to establish the equality \\(f(n)=a n\\) for any infinite set of values of \\(n\\). However, if this set has some good structure, then one may find easier ways to complete this step.\n\nFor instance, after showing, as in Approach 2, that \\(f(n)=a n\\) for all \\(n \\geqslant n_{0}\\) with \\(n \\equiv 2(\\bmod N!)\\), one may proceed as follows. Pick an arbitrary integer \\(x\\) and take any large prime \\(p\\) which is greater than \\(|f(x)-a x|\\). By the Chinese Remainder Theorem, there exists a positive integer \\(n>\\max \\left(x, n_{0}\\right)\\) such that \\(n \\equiv 2(\\bmod N!)\\) and \\(n \\equiv x(\\bmod p)\\). By Step 1, we have \\(f(x) \\equiv f(n)=a n \\equiv a x(\\bmod p)\\). Due to the choice of \\(p\\), this is possible only if \\(f(x)=a x\\)."}
{"id": "imo-shortlist-2008-a1", "question": "A1. Find all functions \\(f:(0, \\infty) \\rightarrow(0, \\infty)\\) such that\n\n\\[\n\\frac{f(p)^{2}+f(q)^{2}}{f\\left(r^{2}\\right)+f\\left(s^{2}\\right)}=\\frac{p^{2}+q^{2}}{r^{2}+s^{2}}\n\\]\n\nfor all \\(p, q, r, s>0\\) with \\(p q=r s\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2008, "solution": "Let \\(f\\) satisfy the given condition. Setting \\(p=q=r=s=1\\) yields \\(f(1)^{2}=f(1)\\) and hence \\(f(1)=1\\). Now take any \\(x>0\\) and set \\(p=x, q=1, r=s=\\sqrt{x}\\) to obtain\n\n\\[\n\\frac{f(x)^{2}+1}{2 f(x)}=\\frac{x^{2}+1}{2 x}\n\\]\n\nThis recasts into\n\n\\[\n\\begin{gathered}\nx f(x)^{2}+x=x^{2} f(x)+f(x) \n(x f(x)-1)(f(x)-x)=0\n\n\\]\n\nAnd thus,\n\n\\[\n\\text { for every } x>0, \\quad \\text { either } \\quad f(x)=x \\text { or } \\quad f(x)=\\frac{1}{x}\n\\]\n\nObviously, if\n\n\\[\nf(x)=x \\quad \\text { for all } x>0 \\quad \\text { or } \\quad f(x)=\\frac{1}{x} \\quad \\text { for all } x>0\n\\]\n\nthen the condition of the problem is satisfied. We show that actually these two functions are the only solutions.\n\nSo let us assume that there exists a function \\(f\\) satisfying the requirement, other than those in (2). Then \\(f(a) \\neq a\\) and \\(f(b) \\neq 1 / b\\) for some \\(a, b>0\\). By (1), these values must be \\(f(a)=1 / a, f(b)=b\\). Applying now the equation with \\(p=a, q=b, r=s=\\sqrt{a b}\\) we obtain \\(\\left(a^{-2}+b^{2}\\right) / 2 f(a b)=\\left(a^{2}+b^{2}\\right) / 2 a b\\); equivalently,\n\n\\[\nf(a b)=\\frac{a b\\left(a^{-2}+b^{2}\\right)}{a^{2}+b^{2}}\n\\]\n\nWe know however (see (1)) that \\(f(a b)\\) must be either \\(a b\\) or \\(1 / a b\\). If \\(f(a b)=a b\\) then by (3) \\(a^{-2}+b^{2}=a^{2}+b^{2}\\), so that \\(a=1\\). But, as \\(f(1)=1\\), this contradicts the relation \\(f(a) \\neq a\\). Likewise, if \\(f(a b)=1 / a b\\) then (3) gives \\(a^{2} b^{2}\\left(a^{-2}+b^{2}\\right)=a^{2}+b^{2}\\), whence \\(b=1\\), in contradiction to \\(f(b) \\neq 1 / b\\). Thus indeed the functions listed in (2) are the only two solutions.\n\nComment. The equation has as many as four variables with only one constraint \\(p q=r s\\), leaving three degrees of freedom and providing a lot of information. Various substitutions force various useful properties of the function searched. We sketch one more method to reach conclusion (1); certainly there are many others.\n\nNoticing that \\(f(1)=1\\) and setting, first, \\(p=q=1, r=\\sqrt{x}, s=1 / \\sqrt{x}\\), and then \\(p=x, q=1 / x\\), \\(r=s=1\\), we obtain two relations, holding for every \\(x>0\\),\n\n\\[\nf(x)+f\\left(\\frac{1}{x}\\right)=x+\\frac{1}{x} \\quad \\text { and } \\quad f(x)^{2}+f\\left(\\frac{1}{x}\\right)^{2}=x^{2}+\\frac{1}{x^{2}}\n\\]\n\nSquaring the first and subtracting the second gives \\(2 f(x) f(1 / x)=2\\). Subtracting this from the second relation of (4) leads to\n\n\\[\n\\left(f(x)-f\\left(\\frac{1}{x}\\right)\\right)^{2}=\\left(x-\\frac{1}{x}\\right)^{2} \\quad \\text { or } \\quad f(x)-f\\left(\\frac{1}{x}\\right)= \\pm\\left(x-\\frac{1}{x}\\right)\n\\]\n\nThe last two alternatives combined with the first equation of (4) imply the two alternatives of (1)."}
{"id": "imo-shortlist-2008-a2", "question": "A2. (a) Prove the inequality\n\n\\[\n\\frac{x^{2}}{(x-1)^{2}}+\\frac{y^{2}}{(y-1)^{2}}+\\frac{z^{2}}{(z-1)^{2}} \\geq 1\n\\]\n\nfor real numbers \\(x, y, z \\neq 1\\) satisfying the condition \\(x y z=1\\).\n(b) Show that there are infinitely many triples of rational numbers \\(x, y, z\\) for which this inequality turns into equality.", "category": "Algebra", "source": "IMO Shortlist", "year": 2008, "solution": "(a) We start with the substitution\n\n\\[\n\\frac{x}{x-1}=a, \\quad \\frac{y}{y-1}=b, \\quad \\frac{z}{z-1}=c, \\quad \\text { i.e., } \\quad x=\\frac{a}{a-1}, \\quad y=\\frac{b}{b-1}, \\quad z=\\frac{c}{c-1} .\n\\]\n\nThe inequality to be proved reads \\(a^{2}+b^{2}+c^{2} \\geq 1\\). The new variables are subject to the constraints \\(a, b, c \\neq 1\\) and the following one coming from the condition \\(x y z=1\\),\n\n\\[\n(a-1)(b-1)(c-1)=a b c\n\\]\n\nThis is successively equivalent to\n\n\\[\n\\begin{aligned}\na+b+c-1 & =a b+b c+c a \n2(a+b+c-1) & =(a+b+c)^{2}-\\left(a^{2}+b^{2}+c^{2}\\right) \na^{2}+b^{2}+c^{2}-2 & =(a+b+c)^{2}-2(a+b+c) \na^{2}+b^{2}+c^{2}-1 & =(a+b+c-1)^{2}\n\n\\]\n\nThus indeed \\(a^{2}+b^{2}+c^{2} \\geq 1\\), as desired.\n(b) From the equation \\(a^{2}+b^{2}+c^{2}-1=(a+b+c-1)^{2}\\) we see that the proposed inequality becomes an equality if and only if both sums \\(a^{2}+b^{2}+c^{2}\\) and \\(a+b+c\\) have value 1 . The first of them is equal to \\((a+b+c)^{2}-2(a b+b c+c a)\\). So the instances of equality are described by the system of two equations\n\n\\[\na+b+c=1, \\quad a b+b c+c a=0\n\\]\n\nplus the constraint \\(a, b, c \\neq 1\\). Elimination of \\(c\\) leads to \\(a^{2}+a b+b^{2}=a+b\\), which we regard as a quadratic equation in \\(b\\),\n\n\\[\nb^{2}+(a-1) b+a(a-1)=0\n\\]\n\nwith discriminant\n\n\\[\n\\Delta=(a-1)^{2}-4 a(a-1)=(1-a)(1+3 a)\n\\]\n\nWe are looking for rational triples \\((a, b, c)\\); it will suffice to have \\(a\\) rational such that \\(1-a\\) and \\(1+3 a\\) are both squares of rational numbers (then \\(\\Delta\\) will be so too). Set \\(a=k / m\\). We want \\(m-k\\) and \\(m+3 k\\) to be squares of integers. This is achieved for instance by taking \\(m=k^{2}-k+1\\) (clearly nonzero); then \\(m-k=(k-1)^{2}, m+3 k=(k+1)^{2}\\). Note that distinct integers \\(k\\) yield distinct values of \\(a=k / m\\).\n\nAnd thus, if \\(k\\) is any integer and \\(m=k^{2}-k+1, a=k / m\\) then \\(\\Delta=\\left(k^{2}-1\\right)^{2} / m^{2}\\) and the quadratic equation has rational roots \\(b=\\left(m-k \\pm k^{2} \\mp 1\\right) /(2 m)\\). Choose e.g. the larger root,\n\n\\[\nb=\\frac{m-k+k^{2}-1}{2 m}=\\frac{m+(m-2)}{2 m}=\\frac{m-1}{m}\n\\]\n\nComputing \\(c\\) from \\(a+b+c=1\\) then gives \\(c=(1-k) / m\\). The condition \\(a, b, c \\neq 1\\) eliminates only \\(k=0\\) and \\(k=1\\). Thus, as \\(k\\) varies over integers greater than 1 , we obtain an infinite family of rational triples ( \\(a, b, c\\) )-and coming back to the original variables ( \\(x=a /(a-1)\\) etc.)-an infinite family of rational triples \\((x, y, z)\\) with the needed property. (A short calculation shows that the resulting triples are \\(x=-k /(k-1)^{2}, y=k-k^{2}, z=(k-1) / k^{2}\\); but the proof was complete without listing them.)\n\nComment 1. There are many possible variations in handling the equation system \\(a^{2}+b^{2}+c^{2}=1\\), \\(a+b+c=1(a, b, c \\neq 1)\\) which of course describes a circle in the ( \\(a, b, c\\) )-space (with three points excluded), and finding infinitely many rational points on it.\n\nAlso the initial substitution \\(x=a /(a-1)\\) (etc.) can be successfully replaced by other similar substitutions, e.g. \\(x=1-1 / \\alpha\\) (etc.); or \\(x=x^{\\prime}-1\\) (etc.); or \\(1-y z=u\\) (etc.)- eventually reducing the inequality to \\((\\cdots)^{2} \\geq 0\\), the expression in the parentheses depending on the actual substitution.\n\nDepending on the method chosen, one arrives at various sequences of rational triples ( \\(x, y, z\\) ) as needed; let us produce just one more such example: \\(x=(2 r-2) /(r+1)^{2}, y=(2 r+2) /(r-1)^{2}\\), \\(z=\\left(r^{2}-1\\right) / 4\\) where \\(r\\) can be any rational number different from 1 or -1 .\n\nSolution 2 (an outline). (a) Without changing variables, just setting \\(z=1 / x y\\) and clearing fractions, the proposed inequality takes the form\n\n\\[\n(x y-1)^{2}\\left(x^{2}(y-1)^{2}+y^{2}(x-1)^{2}\\right)+(x-1)^{2}(y-1)^{2} \\geq(x-1)^{2}(y-1)^{2}(x y-1)^{2} .\n\\]\n\nWith the notation \\(p=x+y, q=x y\\) this becomes, after lengthy routine manipulation and a lot of cancellation\n\n\\[\nq^{4}-6 q^{3}+2 p q^{2}+9 q^{2}-6 p q+p^{2} \\geq 0\n\\]\n\nIt is not hard to notice that the expression on the left is just \\(\\left(q^{2}-3 q+p\\right)^{2}\\), hence nonnegative.\n(Without introducing \\(p\\) and \\(q\\), one is of course led with some more work to the same expression, just written in terms of \\(x\\) and \\(y\\); but then it is not that easy to see that it is a square.)\n(b) To have equality, one needs \\(q^{2}-3 q+p=0\\). Note that \\(x\\) and \\(y\\) are the roots of the quadratic trinomial (in a formal variable \\(t\\) ): \\(t^{2}-p t+q\\). When \\(q^{2}-3 q+p=0\\), the discriminant equals\n\n\\[\n\\delta=p^{2}-4 q=\\left(3 q-q^{2}\\right)^{2}-4 q=q(q-1)^{2}(q-4)\n\\]\n\nNow it suffices to have both \\(q\\) and \\(q-4\\) squares of rational numbers (then \\(p=3 q-q^{2}\\) and \\(\\sqrt{\\delta}\\) are also rational, and so are the roots of the trinomial). On setting \\(q=(n / m)^{2}=4+(l / m)^{2}\\) the requirement becomes \\(4 m^{2}+l^{2}=n^{2}\\) (with \\(l, m, n\\) being integers). This is just the Pythagorean equation, known to have infinitely many integer solutions.\n\nComment 2. Part (a) alone might also be considered as a possible contest problem (in the category of easy problems)."}
{"id": "imo-shortlist-2008-a3", "question": "A3. Let \\(S \\subseteq \\mathbb{R}\\) be a set of real numbers. We say that a pair \\((f, g)\\) of functions from \\(S\\) into \\(S\\) is a Spanish Couple on \\(S\\), if they satisfy the following conditions:\n(i) Both functions are strictly increasing, i.e. \\(f(x)<f(y)\\) and \\(g(x)<g(y)\\) for all \\(x, y \\in S\\) with \\(x<y\\);\n(ii) The inequality \\(f(g(g(x)))<g(f(x))\\) holds for all \\(x \\in S\\).\n\nDecide whether there exists a Spanish Couple\n(a) on the set \\(S=\\mathbb{N}\\) of positive integers;\n(b) on the set \\(S=\\{a-1 / b: a, b \\in \\mathbb{N}\\}\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2008, "solution": "We show that the answer is NO for part (a), and YES for part (b).\n(a) Throughout the solution, we will use the notation \\(g_{k}(x)=\\overbrace{g(g(\\ldots g(x)}^{k} \\ldots)\\) ), including \\(g_{0}(x)=x\\) as well.\n\nSuppose that there exists a Spanish Couple ( \\(f, g\\) ) on the set \\(\\mathbb{N}\\). From property (i) we have \\(f(x) \\geq x\\) and \\(g(x) \\geq x\\) for all \\(x \\in \\mathbb{N}\\).\n\nWe claim that \\(g_{k}(x) \\leq f(x)\\) for all \\(k \\geq 0\\) and all positive integers \\(x\\). The proof is done by induction on \\(k\\). We already have the base case \\(k=0\\) since \\(x \\leq f(x)\\). For the induction step from \\(k\\) to \\(k+1\\), apply the induction hypothesis on \\(g_{2}(x)\\) instead of \\(x\\), then apply (ii):\n\n\\[\ng\\left(g_{k+1}(x)\\right)=g_{k}\\left(g_{2}(x)\\right) \\leq f\\left(g_{2}(x)\\right)<g(f(x))\n\\]\n\nSince \\(g\\) is increasing, it follows that \\(g_{k+1}(x)<f(x)\\). The claim is proven.\nIf \\(g(x)=x\\) for all \\(x \\in \\mathbb{N}\\) then \\(f(g(g(x)))=f(x)=g(f(x))\\), and we have a contradiction with (ii). Therefore one can choose an \\(x_{0} \\in S\\) for which \\(x_{0}<g\\left(x_{0}\\right)\\). Now consider the sequence \\(x_{0}, x_{1}, \\ldots\\) where \\(x_{k}=g_{k}\\left(x_{0}\\right)\\). The sequence is increasing. Indeed, we have \\(x_{0}<g\\left(x_{0}\\right)=x_{1}\\), and \\(x_{k}<x_{k+1}\\) implies \\(x_{k+1}=g\\left(x_{k}\\right)<g\\left(x_{k+1}\\right)=x_{k+2}\\).\n\nHence, we obtain a strictly increasing sequence \\(x_{0}<x_{1}<\\ldots\\) of positive integers which on the other hand has an upper bound, namely \\(f\\left(x_{0}\\right)\\). This cannot happen in the set \\(\\mathbb{N}\\) of positive integers, thus no Spanish Couple exists on \\(\\mathbb{N}\\).\n(b) We present a Spanish Couple on the set \\(S=\\{a-1 / b: a, b \\in \\mathbb{N}\\}\\).\n\nLet\n\n\\[\n\\begin{aligned}\nf(a-1 / b) & =a+1-1 / b \ng(a-1 / b) & =a-1 /\\left(b+3^{a}\\right)\n\n\\]\n\nThese functions are clearly increasing. Condition (ii) holds, since\n\n\\[\nf(g(g(a-1 / b)))=(a+1)-1 /\\left(b+2 \\cdot 3^{a}\\right)<(a+1)-1 /\\left(b+3^{a+1}\\right)=g(f(a-1 / b))\n\\]\n\nComment. Another example of a Spanish couple is \\(f(a-1 / b)=3 a-1 / b, g(a-1 / b)=a-1 /(a+b)\\). More generally, postulating \\(f(a-1 / b)=h(a)-1 / b, \\quad g(a-1 / b)=a-1 / G(a, b)\\) with \\(h\\) increasing and \\(G\\) increasing in both variables, we get that \\(f \\circ g \\circ g<g \\circ f\\) holds if \\(G(a, G(a, b))<G(h(a), b)\\). A search just among linear functions \\(h(a)=C a, G(a, b)=A a+B b\\) results in finding that any integers \\(A>0, C>2\\) and \\(B=1\\) produce a Spanish couple (in the example above, \\(A=1, C=3\\) ). The proposer's example results from taking \\(h(a)=a+1, G(a, b)=3^{a}+b\\)."}
{"id": "imo-shortlist-2008-a4", "question": "A4. For an integer \\(m\\), denote by \\(t(m)\\) the unique number in \\(\\{1,2,3\\}\\) such that \\(m+t(m)\\) is a multiple of 3. A function \\(f: \\mathbb{Z} \\rightarrow \\mathbb{Z}\\) satisfies \\(f(-1)=0, f(0)=1, f(1)=-1\\) and\n\n\\[\nf\\left(2^{n}+m\\right)=f\\left(2^{n}-t(m)\\right)-f(m) \\quad \\text { for all integers } m, n \\geq 0 \\text { with } 2^{n}>m .\n\\]\n\nProve that \\(f(3 p) \\geq 0\\) holds for all integers \\(p \\geq 0\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2008, "solution": "The given conditions determine \\(f\\) uniquely on the positive integers. The signs of \\(f(1), f(2), \\ldots\\) seem to change quite erratically. However values of the form \\(f\\left(2^{n}-t(m)\\right)\\) are sufficient to compute directly any functional value. Indeed, let \\(n>0\\) have base 2 representation \\(n=2^{a_{0}}+2^{a_{1}}+\\cdots+2^{a_{k}}, a_{0}>a_{1}>\\cdots>a_{k} \\geq 0\\), and let \\(n_{j}=2^{a_{j}}+2^{a_{j-1}}+\\cdots+2^{a_{k}}, j=0, \\ldots, k\\). Repeated applications of the recurrence show that \\(f(n)\\) is an alternating sum of the quantities \\(f\\left(2^{a_{j}}-t\\left(n_{j+1}\\right)\\right)\\) plus \\((-1)^{k+1}\\). (The exact formula is not needed for our proof.)\n\nSo we focus attention on the values \\(f\\left(2^{n}-1\\right), f\\left(2^{n}-2\\right)\\) and \\(f\\left(2^{n}-3\\right)\\). Six cases arise; more specifically,\n\\(t\\left(2^{2 k}-3\\right)=2, t\\left(2^{2 k}-2\\right)=1, t\\left(2^{2 k}-1\\right)=3, t\\left(2^{2 k+1}-3\\right)=1, t\\left(2^{2 k+1}-2\\right)=3, t\\left(2^{2 k+1}-1\\right)=2\\).\nClaim. For all integers \\(k \\geq 0\\) the following equalities hold:\n\n\\[\n\\begin{array}{lll}\nf\\left(2^{2 k+1}-3\\right)=0, & f\\left(2^{2 k+1}-2\\right)=3^{k}, & f\\left(2^{2 k+1}-1\\right)=-3^{k} \nf\\left(2^{2 k+2}-3\\right)=-3^{k}, & f\\left(2^{2 k+2}-2\\right)=-3^{k}, & f\\left(2^{2 k+2}-1\\right)=2 \\cdot 3^{k}\n\n\\]\n\nProof. By induction on \\(k\\). The base \\(k=0\\) comes down to checking that \\(f(2)=-1\\) and \\(f(3)=2\\); the given values \\(f(-1)=0, f(0)=1, f(1)=-1\\) are also needed. Suppose the claim holds for \\(k-1\\). For \\(f\\left(2^{2 k+1}-t(m)\\right)\\), the recurrence formula and the induction hypothesis yield\n\n\\[\n\\begin{aligned}\n& f\\left(2^{2 k+1}-3\\right)=f\\left(2^{2 k}+\\left(2^{2 k}-3\\right)\\right)=f\\left(2^{2 k}-2\\right)-f\\left(2^{2 k}-3\\right)=-3^{k-1}+3^{k-1}=0, \n& f\\left(2^{2 k+1}-2\\right)=f\\left(2^{2 k}+\\left(2^{2 k}-2\\right)\\right)=f\\left(2^{2 k}-1\\right)-f\\left(2^{2 k}-2\\right)=2 \\cdot 3^{k-1}+3^{k-1}=3^{k}, \n& f\\left(2^{2 k+1}-1\\right)=f\\left(2^{2 k}+\\left(2^{2 k}-1\\right)\\right)=f\\left(2^{2 k}-3\\right)-f\\left(2^{2 k}-1\\right)=-3^{k-1}-2 \\cdot 3^{k-1}=-3^{k} .\n\n\\]\n\nFor \\(f\\left(2^{2 k+2}-t(m)\\right)\\) we use the three equalities just established:\n\n\\[\n\\begin{aligned}\n& f\\left(2^{2 k+2}-3\\right)=f\\left(2^{2 k+1}+\\left(2^{2 k+1}-3\\right)\\right)=f\\left(2^{2 k+1}-1\\right)-f\\left(2^{2 k+1}-3\\right)=-3^{k}-0=-3^{k}, \n& f\\left(2^{2 k+2}-2\\right)=f\\left(2^{2 k+1}+\\left(2^{2 k+1}-2\\right)\\right)=f\\left(2^{2 k+1}-3\\right)-f\\left(2^{2 k}-2\\right)=0-3^{k}=-3^{k}, \n& f\\left(2^{2 k+2}-1\\right)=f\\left(2^{2 k+1}+\\left(2^{2 k+1}-1\\right)\\right)=f\\left(2^{2 k+1}-2\\right)-f\\left(2^{2 k+1}-1\\right)=3^{k}+3^{k}=2 \\cdot 3^{k} .\n\n\\]\n\nThe claim follows.\nA closer look at the six cases shows that \\(f\\left(2^{n}-t(m)\\right) \\geq 3^{(n-1) / 2}\\) if \\(2^{n}-t(m)\\) is divisible by 3 , and \\(f\\left(2^{n}-t(m)\\right) \\leq 0\\) otherwise. On the other hand, note that \\(2^{n}-t(m)\\) is divisible by 3 if and only if \\(2^{n}+m\\) is. Therefore, for all nonnegative integers \\(m\\) and \\(n\\),\n(i) \\(f\\left(2^{n}-t(m)\\right) \\geq 3^{(n-1) / 2}\\) if \\(2^{n}+m\\) is divisible by 3 ;\n(ii) \\(f\\left(2^{n}-t(m)\\right) \\leq 0\\) if \\(2^{n}+m\\) is not divisible by 3 .\n\nOne more (direct) consequence of the claim is that \\(\\left|f\\left(2^{n}-t(m)\\right)\\right| \\leq \\frac{2}{3} \\cdot 3^{n / 2}\\) for all \\(m, n \\geq 0\\).\nThe last inequality enables us to find an upper bound for \\(|f(m)|\\) for \\(m\\) less than a given power of 2 . We prove by induction on \\(n\\) that \\(|f(m)| \\leq 3^{n / 2}\\) holds true for all integers \\(m, n \\geq 0\\) with \\(2^{n}>m\\).\n\nThe base \\(n=0\\) is clear as \\(f(0)=1\\). For the inductive step from \\(n\\) to \\(n+1\\), let \\(m\\) and \\(n\\) satisfy \\(2^{n+1}>m\\). If \\(m<2^{n}\\), we are done by the inductive hypothesis. If \\(m \\geq 2^{n}\\) then \\(m=2^{n}+k\\) where \\(2^{n}>k \\geq 0\\). Now, by \\(\\left|f\\left(2^{n}-t(k)\\right)\\right| \\leq \\frac{2}{3} \\cdot 3^{n / 2}\\) and the inductive assumption,\n\n\\[\n|f(m)|=\\left|f\\left(2^{n}-t(k)\\right)-f(k)\\right| \\leq\\left|f\\left(2^{n}-t(k)\\right)\\right|+|f(k)| \\leq \\frac{2}{3} \\cdot 3^{n / 2}+3^{n / 2}<3^{(n+1) / 2} .\n\\]\n\nThe induction is complete.\nWe proceed to prove that \\(f(3 p) \\geq 0\\) for all integers \\(p \\geq 0\\). Since \\(3 p\\) is not a power of 2 , its binary expansion contains at least two summands. Hence one can write \\(3 p=2^{a}+2^{b}+c\\) where \\(a>b\\) and \\(2^{b}>c \\geq 0\\). Applying the recurrence formula twice yields\n\n\\[\nf(3 p)=f\\left(2^{a}+2^{b}+c\\right)=f\\left(2^{a}-t\\left(2^{b}+c\\right)\\right)-f\\left(2^{b}-t(c)\\right)+f(c) .\n\\]\n\nSince \\(2^{a}+2^{b}+c\\) is divisible by 3 , we have \\(f\\left(2^{a}-t\\left(2^{b}+c\\right)\\right) \\geq 3^{(a-1) / 2}\\) by (i). Since \\(2^{b}+c\\) is not divisible by 3 , we have \\(f\\left(2^{b}-t(c)\\right) \\leq 0\\) by (ii). Finally \\(|f(c)| \\leq 3^{b / 2}\\) as \\(2^{b}>c \\geq 0\\), so that \\(f(c) \\geq-3^{b / 2}\\). Therefore \\(f(3 p) \\geq 3^{(a-1) / 2}-3^{b / 2}\\) which is nonnegative because \\(a>b\\)."}
{"id": "imo-shortlist-2008-a5", "question": "A5. Let \\(a, b, c, d\\) be positive real numbers such that\n\n\\[\na b c d=1 \\quad \\text { and } \\quad a+b+c+d>\\frac{a}{b}+\\frac{b}{c}+\\frac{c}{d}+\\frac{d}{a}\n\\]\n\nProve that\n\n\\[\na+b+c+d<\\frac{b}{a}+\\frac{c}{b}+\\frac{d}{c}+\\frac{a}{d}\n\\]", "category": "Algebra", "source": "IMO Shortlist", "year": 2008, "solution": "We show that if \\(a b c d=1\\), the sum \\(a+b+c+d\\) cannot exceed a certain weighted mean of the expressions \\(\\frac{a}{b}+\\frac{b}{c}+\\frac{c}{d}+\\frac{d}{a}\\) and \\(\\frac{b}{a}+\\frac{c}{b}+\\frac{d}{c}+\\frac{a}{d}\\).\n\nBy applying the AM-GM inequality to the numbers \\(\\frac{a}{b}, \\frac{a}{b}, \\frac{b}{c}\\) and \\(\\frac{a}{d}\\), we obtain\n\n\\[\na=\\sqrt[4]{\\frac{a^{4}}{a b c d}}=\\sqrt[4]{\\frac{a}{b} \\cdot \\frac{a}{b} \\cdot \\frac{b}{c} \\cdot \\frac{a}{d}} \\leq \\frac{1}{4}\\left(\\frac{a}{b}+\\frac{a}{b}+\\frac{b}{c}+\\frac{a}{d}\\right)\n\\]\n\nAnalogously,\n\n\\[\nb \\leq \\frac{1}{4}\\left(\\frac{b}{c}+\\frac{b}{c}+\\frac{c}{d}+\\frac{b}{a}\\right), \\quad c \\leq \\frac{1}{4}\\left(\\frac{c}{d}+\\frac{c}{d}+\\frac{d}{a}+\\frac{c}{b}\\right) \\quad \\text { and } \\quad d \\leq \\frac{1}{4}\\left(\\frac{d}{a}+\\frac{d}{a}+\\frac{a}{b}+\\frac{d}{c}\\right)\n\\]\n\nSumming up these estimates yields\n\n\\[\na+b+c+d \\leq \\frac{3}{4}\\left(\\frac{a}{b}+\\frac{b}{c}+\\frac{c}{d}+\\frac{d}{a}\\right)+\\frac{1}{4}\\left(\\frac{b}{a}+\\frac{c}{b}+\\frac{d}{c}+\\frac{a}{d}\\right)\n\\]\n\nIn particular, if \\(a+b+c+d>\\frac{a}{b}+\\frac{b}{c}+\\frac{c}{d}+\\frac{d}{a}\\) then \\(a+b+c+d<\\frac{b}{a}+\\frac{c}{b}+\\frac{d}{c}+\\frac{a}{d}\\).\nComment. The estimate in the above solution was obtained by applying the AM-GM inequality to each column of the \\(4 \\times 4\\) array\n\n\\[\n\\begin{array}{llll}\na / b & b / c & c / d & d / a \na / b & b / c & c / d & d / a \nb / c & c / d & d / a & a / b \na / d & b / a & c / b & d / c\n\n\\]\n\nand adding up the resulting inequalities. The same table yields a stronger bound: If \\(a, b, c, d>0\\) and \\(a b c d=1\\) then\n\n\\[\n\\left(\\frac{a}{b}+\\frac{b}{c}+\\frac{c}{d}+\\frac{d}{a}\\right)^{3}\\left(\\frac{b}{a}+\\frac{c}{b}+\\frac{d}{c}+\\frac{a}{d}\\right) \\geq(a+b+c+d)^{4}\n\\]\n\nIt suffices to apply Hlder's inequality to the sequences in the four rows, with weights \\(1 / 4\\) :\n\n\\[\n\\begin{gathered}\n\\left(\\frac{a}{b}+\\frac{b}{c}+\\frac{c}{d}+\\frac{d}{a}\\right)^{1 / 4}\\left(\\frac{a}{b}+\\frac{b}{c}+\\frac{c}{d}+\\frac{d}{a}\\right)^{1 / 4}\\left(\\frac{b}{c}+\\frac{c}{d}+\\frac{d}{a}+\\frac{a}{b}\\right)^{1 / 4}\\left(\\frac{a}{d}+\\frac{b}{a}+\\frac{c}{b}+\\frac{d}{c}\\right)^{1 / 4} \n\\geq\\left(\\frac{a a b a}{b b c d}\\right)^{1 / 4}+\\left(\\frac{b b c b}{c c d a}\\right)^{1 / 4}+\\left(\\frac{c c d c}{d d a b}\\right)^{1 / 4}+\\left(\\frac{d d a d}{a a b c}\\right)^{1 / 4}=a+b+c+d\n\n\\]"}
{"id": "imo-shortlist-2008-a6", "question": "A6. Let \\(f: \\mathbb{R} \\rightarrow \\mathbb{N}\\) be a function which satisfies\n\n\\[\nf\\left(x+\\frac{1}{f(y)}\\right)=f\\left(y+\\frac{1}{f(x)}\\right) \\quad \\text { for all } x, y \\in \\mathbb{R}\n\\]\n\nProve that there is a positive integer which is not a value of \\(f\\).", "category": "Algebra", "source": "IMO Shortlist", "year": 2008, "solution": "Suppose that the statement is false and \\(f(\\mathbb{R})=\\mathbb{N}\\). We prove several properties of the function \\(f\\) in order to reach a contradiction.\n\nTo start with, observe that one can assume \\(f(0)=1\\). Indeed, let \\(a \\in \\mathbb{R}\\) be such that \\(f(a)=1\\), and consider the function \\(g(x)=f(x+a)\\). By substituting \\(x+a\\) and \\(y+a\\) for \\(x\\) and \\(y\\) in (1), we have\n\n\\[\ng\\left(x+\\frac{1}{g(y)}\\right)=f\\left(x+a+\\frac{1}{f(y+a)}\\right)=f\\left(y+a+\\frac{1}{f(x+a)}\\right)=g\\left(y+\\frac{1}{g(x)}\\right) .\n\\]\n\nSo \\(g\\) satisfies the functional equation (1), with the additional property \\(g(0)=1\\). Also, \\(g\\) and \\(f\\) have the same set of values: \\(g(\\mathbb{R})=f(\\mathbb{R})=\\mathbb{N}\\). Henceforth we assume \\(f(0)=1\\).\nClaim 1. For an arbitrary fixed \\(c \\in \\mathbb{R}\\) we have \\(\\left\\{f\\left(c+\\frac{1}{n}\\right): n \\in \\mathbb{N}\\right\\}=\\mathbb{N}\\).\nProof. Equation (1) and \\(f(\\mathbb{R})=\\mathbb{N}\\) imply\n\\(f(\\mathbb{R})=\\left\\{f\\left(x+\\frac{1}{f(c)}\\right): x \\in \\mathbb{R}\\right\\}=\\left\\{f\\left(c+\\frac{1}{f(x)}\\right): x \\in \\mathbb{R}\\right\\} \\subset\\left\\{f\\left(c+\\frac{1}{n}\\right): n \\in \\mathbb{N}\\right\\} \\subset f(\\mathbb{R})\\).\nThe claim follows.\nWe will use Claim 1 in the special cases \\(c=0\\) and \\(c=1 / 3\\) :\n\n\\[\n\\left\\{f\\left(\\frac{1}{n}\\right): n \\in \\mathbb{N}\\right\\}=\\left\\{f\\left(\\frac{1}{3}+\\frac{1}{n}\\right): n \\in \\mathbb{N}\\right\\}=\\mathbb{N}\n\\]\n\nClaim 2. If \\(f(u)=f(v)\\) for some \\(u, v \\in \\mathbb{R}\\) then \\(f(u+q)=f(v+q)\\) for all nonnegative rational \\(q\\). Furthermore, if \\(f(q)=1\\) for some nonnegative rational \\(q\\) then \\(f(k q)=1\\) for all \\(k \\in \\mathbb{N}\\).\nProof. For all \\(x \\in \\mathbb{R}\\) we have by (1)\n\n\\[\nf\\left(u+\\frac{1}{f(x)}\\right)=f\\left(x+\\frac{1}{f(u)}\\right)=f\\left(x+\\frac{1}{f(v)}\\right)=f\\left(v+\\frac{1}{f(x)}\\right)\n\\]\n\nSince \\(f(x)\\) attains all positive integer values, this yields \\(f(u+1 / n)=f(v+1 / n)\\) for all \\(n \\in \\mathbb{N}\\). Let \\(q=k / n\\) be a positive rational number. Then \\(k\\) repetitions of the last step yield\n\n\\[\nf(u+q)=f\\left(u+\\frac{k}{n}\\right)=f\\left(v+\\frac{k}{n}\\right)=f(v+q)\n\\]\n\nNow let \\(f(q)=1\\) for some nonnegative rational \\(q\\), and let \\(k \\in \\mathbb{N}\\). As \\(f(0)=1\\), the previous conclusion yields successively \\(f(q)=f(2 q), f(2 q)=f(3 q), \\ldots, f((k-1) q)=f(k q)\\), as needed.\nClaim 3. The equality \\(f(q)=f(q+1)\\) holds for all nonnegative rational \\(q\\).\nProof. Let \\(m\\) be a positive integer such that \\(f(1 / m)=1\\). Such an \\(m\\) exists by (2). Applying the second statement of Claim 2 with \\(q=1 / m\\) and \\(k=m\\) yields \\(f(1)=1\\).\n\nGiven that \\(f(0)=f(1)=1\\), the first statement of Claim 2 implies \\(f(q)=f(q+1)\\) for all nonnegative rational \\(q\\).\n\nClaim 4. The equality \\(f\\left(\\frac{1}{n}\\right)=n\\) holds for every \\(n \\in \\mathbb{N}\\).\nProof. For a nonnegative rational \\(q\\) we set \\(x=q, y=0\\) in (1) and use Claim 3 to obtain\n\n\\[\nf\\left(\\frac{1}{f(q)}\\right)=f\\left(q+\\frac{1}{f(0)}\\right)=f(q+1)=f(q)\n\\]\n\nBy (2), for each \\(n \\in \\mathbb{N}\\) there exists a \\(k \\in \\mathbb{N}\\) such that \\(f(1 / k)=n\\). Applying the last equation with \\(q=1 / k\\), we have\n\n\\[\nn=f\\left(\\frac{1}{k}\\right)=f\\left(\\frac{1}{f(1 / k)}\\right)=f\\left(\\frac{1}{n}\\right)\n\\]\n\nNow we are ready to obtain a contradiction. Let \\(n \\in \\mathbb{N}\\) be such that \\(f(1 / 3+1 / n)=1\\). Such an \\(n\\) exists by (2). Let \\(1 / 3+1 / n=s / t\\), where \\(s, t \\in \\mathbb{N}\\) are coprime. Observe that \\(t>1\\) as \\(1 / 3+1 / n\\) is not an integer. Choose \\(k, l \\in \\mathbb{N}\\) so that that \\(k s-l t=1\\).\n\nBecause \\(f(0)=f(s / t)=1\\), Claim 2 implies \\(f(k s / t)=1\\). Now \\(f(k s / t)=f(1 / t+l)\\); on the other hand \\(f(1 / t+l)=f(1 / t)\\) by \\(l\\) successive applications of Claim 3. Finally, \\(f(1 / t)=t\\) by Claim 4, leading to the impossible \\(t=1\\). The solution is complete."}
{"id": "imo-shortlist-2008-a7", "question": "A7. Prove that for any four positive real numbers \\(a, b, c, d\\) the inequality\n\n\\[\n\\frac{(a-b)(a-c)}{a+b+c}+\\frac{(b-c)(b-d)}{b+c+d}+\\frac{(c-d)(c-a)}{c+d+a}+\\frac{(d-a)(d-b)}{d+a+b} \\geq 0\n\\]\n\nholds. Determine all cases of equality.", "category": "Algebra", "source": "IMO Shortlist", "year": 2008, "solution": "Denote the four terms by\n\n\\[\nA=\\frac{(a-b)(a-c)}{a+b+c}, \\quad B=\\frac{(b-c)(b-d)}{b+c+d}, \\quad C=\\frac{(c-d)(c-a)}{c+d+a}, \\quad D=\\frac{(d-a)(d-b)}{d+a+b} .\n\\]\n\nThe expression \\(2 A\\) splits into two summands as follows,\n\n\\[\n2 A=A^{\\prime}+A^{\\prime \\prime} \\quad \\text { where } \\quad A^{\\prime}=\\frac{(a-c)^{2}}{a+b+c}, \\quad A^{\\prime \\prime}=\\frac{(a-c)(a-2 b+c)}{a+b+c}\n\\]\n\nthis is easily verified. We analogously represent \\(2 B=B^{\\prime}+B^{\\prime \\prime}, 2 C=C^{\\prime}+C^{\\prime \\prime}, 2 B=D^{\\prime}+D^{\\prime \\prime}\\) and examine each of the sums \\(A^{\\prime}+B^{\\prime}+C^{\\prime}+D^{\\prime}\\) and \\(A^{\\prime \\prime}+B^{\\prime \\prime}+C^{\\prime \\prime}+D^{\\prime \\prime}\\) separately.\n\nWrite \\(s=a+b+c+d\\); the denominators become \\(s-d, s-a, s-b, s-c\\). By the CauchySchwarz inequality,\n\n\\[\n\\begin{aligned}\n& \\left(\\frac{|a-c|}{\\sqrt{s-d}} \\cdot \\sqrt{s-d}+\\frac{|b-d|}{\\sqrt{s-a}} \\cdot \\sqrt{s-a}+\\frac{|c-a|}{\\sqrt{s-b}} \\cdot \\sqrt{s-b}+\\frac{|d-b|}{\\sqrt{s-c}} \\cdot \\sqrt{s-c}\\right)^{2} \n& \\quad \\leq\\left(\\frac{(a-c)^{2}}{s-d}+\\frac{(b-d)^{2}}{s-a}+\\frac{(c-a)^{2}}{s-b}+\\frac{(d-b)^{2}}{s-c}\\right)(4 s-s)=3 s\\left(A^{\\prime}+B^{\\prime}+C^{\\prime}+D^{\\prime}\\right)\n\n\\]\n\nHence\n\n\\[\nA^{\\prime}+B^{\\prime}+C^{\\prime}+D^{\\prime} \\geq \\frac{(2|a-c|+2|b-d|)^{2}}{3 s} \\geq \\frac{16 \\cdot|a-c| \\cdot|b-d|}{3 s}\n\\]\n\nNext we estimate the absolute value of the other sum. We couple \\(A^{\\prime \\prime}\\) with \\(C^{\\prime \\prime}\\) to obtain\n\n\\[\n\\begin{aligned}\nA^{\\prime \\prime}+C^{\\prime \\prime} & =\\frac{(a-c)(a+c-2 b)}{s-d}+\\frac{(c-a)(c+a-2 d)}{s-b} \n& =\\frac{(a-c)(a+c-2 b)(s-b)+(c-a)(c+a-2 d)(s-d)}{(s-d)(s-b)} \n& =\\frac{(a-c)(-2 b(s-b)-b(a+c)+2 d(s-d)+d(a+c))}{s(a+c)+b d} \n& =\\frac{3(a-c)(d-b)(a+c)}{M}, \\quad \\text { with } \\quad M=s(a+c)+b d\n\n\\]\n\nHence by cyclic shift\n\n\\[\nB^{\\prime \\prime}+D^{\\prime \\prime}=\\frac{3(b-d)(a-c)(b+d)}{N}, \\quad \\text { with } \\quad N=s(b+d)+c a\n\\]\n\nThus\n\n\\[\nA^{\\prime \\prime}+B^{\\prime \\prime}+C^{\\prime \\prime}+D^{\\prime \\prime}=3(a-c)(b-d)\\left(\\frac{b+d}{N}-\\frac{a+c}{M}\\right)=\\frac{3(a-c)(b-d) W}{M N}\n\\]\n\nwhere\n\n\\[\nW=(b+d) M-(a+c) N=b d(b+d)-a c(a+c)\n\\]\n\nNote that\n\n\\[\nM N>(a c(a+c)+b d(b+d)) s \\geq|W| \\cdot s\n\\]\n\nNow (2) and (4) yield\n\n\\[\n\\left|A^{\\prime \\prime}+B^{\\prime \\prime}+C^{\\prime \\prime}+D^{\\prime \\prime}\\right| \\leq \\frac{3 \\cdot|a-c| \\cdot|b-d|}{s} .\n\\]\n\nCombined with (1) this results in\n\n\\[\n\\begin{aligned}\n2(A+B & +C+D)=\\left(A^{\\prime}+B^{\\prime}+C^{\\prime}+D^{\\prime}\\right)+\\left(A^{\\prime \\prime}+B^{\\prime \\prime}+C^{\\prime \\prime}+D^{\\prime \\prime}\\right) \n& \\geq \\frac{16 \\cdot|a-c| \\cdot|b-d|}{3 s}-\\frac{3 \\cdot|a-c| \\cdot|b-d|}{s}=\\frac{7 \\cdot|a-c| \\cdot|b-d|}{3(a+b+c+d)} \\geq 0\n\n\\]\n\nThis is the required inequality. From the last line we see that equality can be achieved only if either \\(a=c\\) or \\(b=d\\). Since we also need equality in (1), this implies that actually \\(a=c\\) and \\(b=d\\) must hold simultaneously, which is obviously also a sufficient condition.\n\nSolution 2. We keep the notations \\(A, B, C, D, s\\), and also \\(M, N, W\\) from the preceding solution; the definitions of \\(M, N, W\\) and relations (3), (4) in that solution did not depend on the foregoing considerations. Starting from\n\n\\[\n2 A=\\frac{(a-c)^{2}+3(a+c)(a-c)}{a+b+c}-2 a+2 c\n\\]\n\nwe get\n\n\\[\n\\begin{aligned}\n& 2(A+C)=(a-c)^{2}\\left(\\frac{1}{s-d}+\\frac{1}{s-b}\\right)+3(a+c)(a-c)\\left(\\frac{1}{s-d}-\\frac{1}{s-b}\\right) \n& \\quad=(a-c)^{2} \\frac{2 s-b-d}{M}+3(a+c)(a-c) \\cdot \\frac{d-b}{M}=\\frac{p(a-c)^{2}-3(a+c)(a-c)(b-d)}{M}\n\n\\]\n\nwhere \\(p=2 s-b-d=s+a+c\\). Similarly, writing \\(q=s+b+d\\) we have\n\n\\[\n2(B+D)=\\frac{q(b-d)^{2}-3(b+d)(b-d)(c-a)}{N} ;\n\\]\n\nspecific grouping of terms in the numerators has its aim. Note that \\(p q>2 s^{2}\\). By adding the fractions expressing \\(2(A+C)\\) and \\(2(B+D)\\),\n\n\\[\n2(A+B+C+D)=\\frac{p(a-c)^{2}}{M}+\\frac{3(a-c)(b-d) W}{M N}+\\frac{q(b-d)^{2}}{N}\n\\]\n\nwith \\(W\\) defined by (3).\nSubstitution \\(x=(a-c) / M, y=(b-d) / N\\) brings the required inequality to the form\n\n\\[\n2(A+B+C+D)=M p x^{2}+3 W x y+N q y^{2} \\geq 0\n\\]\n\nIt will be enough to verify that the discriminant \\(\\Delta=9 W^{2}-4 M N p q\\) of the quadratic trinomial \\(M p t^{2}+3 W t+N q\\) is negative; on setting \\(t=x / y\\) one then gets (6). The first inequality in (4) together with \\(p q>2 s^{2}\\) imply \\(4 M N p q>8 s^{3}(a c(a+c)+b d(b+d))\\). Since\n\n\\[\n(a+c) s^{3}>(a+c)^{4} \\geq 4 a c(a+c)^{2} \\quad \\text { and likewise } \\quad(b+d) s^{3}>4 b d(b+d)^{2},\n\\]\n\nthe estimate continues as follows,\n\n\\[\n4 M N p q>8\\left(4(a c)^{2}(a+c)^{2}+4(b d)^{2}(b+d)^{2}\\right)>32(b d(b+d)-a c(a+c))^{2}=32 W^{2} \\geq 9 W^{2}\n\\]\n\nThus indeed \\(\\Delta<0\\). The desired inequality (6) hence results. It becomes an equality if and only if \\(x=y=0\\); equivalently, if and only if \\(a=c\\) and simultaneously \\(b=d\\).\n\nComment. The two solutions presented above do not differ significantly; large portions overlap. The properties of the number \\(W\\) turn out to be crucial in both approaches. The Cauchy-Schwarz inequality, applied in the first solution, is avoided in the second, which requires no knowledge beyond quadratic trinomials.\n\nThe estimates in the proof of \\(\\Delta<0\\) in the second solution seem to be very wasteful. However, they come close to sharp when the terms in one of the pairs \\((a, c),(b, d)\\) are equal and much bigger than those in the other pair.\n\nIn attempts to prove the inequality by just considering the six cases of arrangement of the numbers \\(a, b, c, d\\) on the real line, one soon discovers that the cases which create real trouble are precisely those in which \\(a\\) and \\(c\\) are both greater or both smaller than \\(b\\) and \\(d\\).\n\nSolution 3.\n\n\\[\n\\begin{gathered}\n(a-b)(a-c)(a+b+d)(a+c+d)(b+c+d)= \n=((a-b)(a+b+d))((a-c)(a+c+d))(b+c+d)= \n=\\left(a^{2}+a d-b^{2}-b d\\right)\\left(a^{2}+a d-c^{2}-c d\\right)(b+c+d)= \n=\\left(a^{4}+2 a^{3} d-a^{2} b^{2}-a^{2} b d-a^{2} c^{2}-a^{2} c d+a^{2} d^{2}-a b^{2} d-a b d^{2}-a c^{2} d-a c d^{2}+b^{2} c^{2}+b^{2} c d+b c^{2} d+b c d^{2}\\right)(b+c+d)= \n=a^{4} b+a^{4} c+a^{4} d+\\left(b^{3} c^{2}+a^{2} d^{3}\\right)-a^{2} c^{3}+\\left(2 a^{3} d^{2}-b^{3} a^{2}+c^{3} b^{2}\\right)+ \n+\\left(b^{3} c d-c^{3} d a-d^{3} a b\\right)+\\left(2 a^{3} b d+c^{3} d b-d^{3} a c\\right)+\\left(2 a^{3} c d-b^{3} d a+d^{3} b c\\right) \n+\\left(-a^{2} b^{2} c+3 b^{2} c^{2} d-2 a c^{2} d^{2}\\right)+\\left(-2 a^{2} b^{2} d+2 b c^{2} d^{2}\\right)+\\left(-a^{2} b c^{2}-2 a^{2} c^{2} d-2 a b^{2} d^{2}+2 b^{2} c d^{2}\\right)+ \n+\\left(-2 a^{2} b c d-a b^{2} c d-a b c^{2} d-2 a b c d^{2}\\right)\n\n\\]\n\nIntroducing the notation \\(S_{x y z w}=\\sum_{c y c} a^{x} b^{y} c^{z} d^{w}\\), one can write\n\n\\[\n\\begin{gathered}\n\\sum_{c y c}(a-b)(a-c)(a+b+d)(a+c+d)(b+c+d)= \n=S_{4100}+S_{4010}+S_{4001}+2 S_{3200}-S_{3020}+2 S_{3002}-S_{3110}+2 S_{3101}+2 S_{3011}-3 S_{2120}-6 S_{2111}= \n+\\left(S_{4100}+S_{4001}+\\frac{1}{2} S_{3110}+\\frac{1}{2} S_{3011}-3 S_{2120}\\right)+ \n+\\left(S_{4010}-S_{3020}-\\frac{3}{2} S_{3110}+\\frac{3}{2} S_{3011}+\\frac{9}{16} S_{2210}+\\frac{9}{16} S_{2201}-\\frac{9}{8} S_{2111}\\right)+ \n+\\frac{9}{16}\\left(S_{3200}-S_{2210}-S_{2201}+S_{3002}\\right)+\\frac{23}{16}\\left(S_{3200}-2 S_{3101}+S_{3002}\\right)+\\frac{39}{8}\\left(S_{3101}-S_{2111}\\right),\n\n\\]\n\nwhere the expressions\n\n\\[\n\\begin{gathered}\nS_{4100}+S_{4001}+\\frac{1}{2} S_{3110}+\\frac{1}{2} S_{3011}-3 S_{2120}=\\sum_{c y c}\\left(a^{4} b+b c^{4}+\\frac{1}{2} a^{3} b c+\\frac{1}{2} a b c^{3}-3 a^{2} b c^{2}\\right) \nS_{4010}-S_{3020}-\\frac{3}{2} S_{3110}+\\frac{3}{2} S_{3011}+\\frac{9}{16} S_{2210}+\\frac{9}{16} S_{2201}-\\frac{9}{8} S_{2111}=\\sum_{c y c} a^{2} c\\left(a-c-\\frac{3}{4} b+\\frac{3}{4} d\\right)^{2} \nS_{3200}-S_{2210}-S_{2201}+S_{3002}=\\sum_{c y c} b^{2}\\left(a^{3}-a^{2} c-a c^{2}+c^{3}\\right)=\\sum_{c y c} b^{2}(a+c)(a-c)^{2} \nS_{3200}-2 S_{3101}+S_{3002}=\\sum_{c y c} a^{3}(b-d)^{2} \\quad \\text { and } \\quad S_{3101}-S_{2111}=\\frac{1}{3} \\sum_{c y c} b d\\left(2 a^{3}+c^{3}-3 a^{2} c\\right)\n\n\\]\n\nare all nonnegative."}
{"id": "imo-shortlist-2008-c1", "question": "C1. In the plane we consider rectangles whose sides are parallel to the coordinate axes and have positive length. Such a rectangle will be called a box. Two boxes intersect if they have a common point in their interior or on their boundary.\n\nFind the largest \\(n\\) for which there exist \\(n\\) boxes \\(B_{1}, \\ldots, B_{n}\\) such that \\(B_{i}\\) and \\(B_{j}\\) intersect if and only if \\(i \\not \\equiv j \\pm 1(\\bmod n)\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2008, "solution": "The maximum number of such boxes is 6 . One example is shown in the figure.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2a06c33868bd686c236cg-22}\n\nNow we show that 6 is the maximum. Suppose that boxes \\(B_{1}, \\ldots, B_{n}\\) satisfy the condition. Let the closed intervals \\(I_{k}\\) and \\(J_{k}\\) be the projections of \\(B_{k}\\) onto the \\(x\\) - and \\(y\\)-axis, for \\(1 \\leq k \\leq n\\).\n\nIf \\(B_{i}\\) and \\(B_{j}\\) intersect, with a common point \\((x, y)\\), then \\(x \\in I_{i} \\cap I_{j}\\) and \\(y \\in J_{i} \\cap J_{j}\\). So the intersections \\(I_{i} \\cap I_{j}\\) and \\(J_{i} \\cap J_{j}\\) are nonempty. Conversely, if \\(x \\in I_{i} \\cap I_{j}\\) and \\(y \\in J_{i} \\cap J_{j}\\) for some real numbers \\(x, y\\), then ( \\(x, y\\) ) is a common point of \\(B_{i}\\) and \\(B_{j}\\). Putting it around, \\(B_{i}\\) and \\(B_{j}\\) are disjoint if and only if their projections on at least one coordinate axis are disjoint.\n\nFor brevity we call two boxes or intervals adjacent if their indices differ by 1 modulo \\(n\\), and nonadjacent otherwise.\n\nThe adjacent boxes \\(B_{k}\\) and \\(B_{k+1}\\) do not intersect for each \\(k=1, \\ldots, n\\). Hence \\(\\left(I_{k}, I_{k+1}\\right)\\) or ( \\(J_{k}, J_{k+1}\\) ) is a pair of disjoint intervals, \\(1 \\leq k \\leq n\\). So there are at least \\(n\\) pairs of disjoint intervals among \\(\\left(I_{1}, I_{2}\\right), \\ldots,\\left(I_{n-1}, I_{n}\\right),\\left(I_{n}, I_{1}\\right) ;\\left(J_{1}, J_{2}\\right), \\ldots,\\left(J_{n-1}, J_{n}\\right),\\left(J_{n}, J_{1}\\right)\\).\n\nNext, every two nonadjacent boxes intersect, hence their projections on both axes intersect, too. Then the claim below shows that at most 3 pairs among \\(\\left(I_{1}, I_{2}\\right), \\ldots,\\left(I_{n-1}, I_{n}\\right),\\left(I_{n}, I_{1}\\right)\\) are disjoint, and the same holds for \\(\\left(J_{1}, J_{2}\\right), \\ldots,\\left(J_{n-1}, J_{n}\\right),\\left(J_{n}, J_{1}\\right)\\). Consequently \\(n \\leq 3+3=6\\), as stated. Thus we are left with the claim and its justification.\nClaim. Let \\(\\Delta_{1}, \\Delta_{2}, \\ldots, \\Delta_{n}\\) be intervals on a straight line such that every two nonadjacent intervals intersect. Then \\(\\Delta_{k}\\) and \\(\\Delta_{k+1}\\) are disjoint for at most three values of \\(k=1, \\ldots, n\\).\nProof. Denote \\(\\Delta_{k}=\\left[a_{k}, b_{k}\\right], 1 \\leq k \\leq n\\). Let \\(\\alpha=\\max \\left(a_{1}, \\ldots, a_{n}\\right)\\) be the rightmost among the left endpoints of \\(\\Delta_{1}, \\ldots, \\Delta_{n}\\), and let \\(\\beta=\\min \\left(b_{1}, \\ldots, b_{n}\\right)\\) be the leftmost among their right endpoints. Assume that \\(\\alpha=a_{2}\\) without loss of generality.\n\nIf \\(\\alpha \\leq \\beta\\) then \\(a_{i} \\leq \\alpha \\leq \\beta \\leq b_{i}\\) for all \\(i\\). Every \\(\\Delta_{i}\\) contains \\(\\alpha\\), and thus no disjoint pair ( \\(\\Delta_{i}, \\Delta_{i+1}\\) ) exists.\n\nIf \\(\\beta<\\alpha\\) then \\(\\beta=b_{i}\\) for some \\(i\\) such that \\(a_{i}<b_{i}=\\beta<\\alpha=a_{2}<b_{2}\\), hence \\(\\Delta_{2}\\) and \\(\\Delta_{i}\\) are disjoint. Now \\(\\Delta_{2}\\) intersects all remaining intervals except possibly \\(\\Delta_{1}\\) and \\(\\Delta_{3}\\), so \\(\\Delta_{2}\\) and \\(\\Delta_{i}\\) can be disjoint only if \\(i=1\\) or \\(i=3\\). Suppose by symmetry that \\(i=3\\); then \\(\\beta=b_{3}\\). Since each of the intervals \\(\\Delta_{4}, \\ldots, \\Delta_{n}\\) intersects \\(\\Delta_{2}\\), we have \\(a_{i} \\leq \\alpha \\leq b_{i}\\) for \\(i=4, \\ldots, n\\). Therefore \\(\\alpha \\in \\Delta_{4} \\cap \\ldots \\cap \\Delta_{n}\\), in particular \\(\\Delta_{4} \\cap \\ldots \\cap \\Delta_{n} \\neq \\emptyset\\). Similarly, \\(\\Delta_{5}, \\ldots, \\Delta_{n}, \\Delta_{1}\\) all intersect \\(\\Delta_{3}\\), so that \\(\\Delta_{5} \\cap \\ldots \\cap \\Delta_{n} \\cap \\Delta_{1} \\neq \\emptyset\\) as \\(\\beta \\in \\Delta_{5} \\cap \\ldots \\cap \\Delta_{n} \\cap \\Delta_{1}\\). This leaves \\(\\left(\\Delta_{1}, \\Delta_{2}\\right),\\left(\\Delta_{2}, \\Delta_{3}\\right)\\) and ( \\(\\Delta_{3}, \\Delta_{4}\\) ) as the only candidates for disjoint interval pairs, as desired.\n\nComment. The problem is a two-dimensional version of the original proposal which is included below. The extreme shortage of easy and appropriate submissions forced the Problem Selection Committee to shortlist a simplified variant. The same one-dimensional Claim is used in both versions.\n\nOriginal proposal. We consider parallelepipeds in three-dimensional space, with edges parallel to the coordinate axes and of positive length. Such a parallelepiped will be called a box. Two boxes intersect if they have a common point in their interior or on their boundary.\n\nFind the largest \\(n\\) for which there exist \\(n\\) boxes \\(B_{1}, \\ldots, B_{n}\\) such that \\(B_{i}\\) and \\(B_{j}\\) intersect if and only if \\(i \\not \\equiv j \\pm 1(\\bmod n)\\).\n\nThe maximum number of such boxes is 9 . Suppose that boxes \\(B_{1}, \\ldots, B_{n}\\) satisfy the condition. Let the closed intervals \\(I_{k}, J_{k}\\) and \\(K_{k}\\) be the projections of box \\(B_{k}\\) onto the \\(x-, y-\\) and \\(z\\)-axis, respectively, for \\(1 \\leq k \\leq n\\). As before, \\(B_{i}\\) and \\(B_{j}\\) are disjoint if and only if their projections on at least one coordinate axis are disjoint.\n\nWe call again two boxes or intervals adjacent if their indices differ by 1 modulo \\(n\\), and nonadjacent otherwise.\n\nThe adjacent boxes \\(B_{i}\\) and \\(B_{i+1}\\) do not intersect for each \\(i=1, \\ldots, n\\). Hence at least one of the pairs \\(\\left(I_{i}, I_{i+1}\\right),\\left(J_{i}, J_{i+1}\\right)\\) and \\(\\left(K_{i}, K_{i+1}\\right)\\) is a pair of disjoint intervals. So there are at least \\(n\\) pairs of disjoint intervals among \\(\\left(I_{i}, I_{i+1}\\right),\\left(J_{i}, J_{i+1}\\right),\\left(K_{i}, K_{i+1}\\right), 1 \\leq i \\leq n\\).\n\nNext, every two nonadjacent boxes intersect, hence their projections on the three axes intersect, too. Referring to the Claim in the solution of the two-dimensional version, we cocnclude that at most 3 pairs among \\(\\left(I_{1}, I_{2}\\right), \\ldots,\\left(I_{n-1}, I_{n}\\right),\\left(I_{n}, I_{1}\\right)\\) are disjoint; the same holds for \\(\\left(J_{1}, J_{2}\\right), \\ldots,\\left(J_{n-1}, J_{n}\\right),\\left(J_{n}, J_{1}\\right)\\) and \\(\\left(K_{1}, K_{2}\\right), \\ldots,\\left(K_{n-1}, K_{n}\\right),\\left(K_{n}, K_{1}\\right)\\). Consequently \\(n \\leq 3+3+3=9\\), as stated.\n\nFor \\(n=9\\), the desired system of boxes exists. Consider the intervals in the following table:\n\n\\begin{center}\n\\begin{tabular}{cccc}\n\\(i\\) & \\(I_{i}\\) & \\(J_{i}\\) & \\(K_{i}\\) \n1 & \\([1,4]\\) & \\([1,6]\\) & \\([3,6]\\) \n2 & \\([5,6]\\) & \\([1,6]\\) & \\([1,6]\\) \n3 & \\([1,2]\\) & \\([1,6]\\) & \\([1,6]\\) \n4 & \\([3,6]\\) & \\([1,4]\\) & \\([1,6]\\) \n5 & \\([1,6]\\) & \\([5,6]\\) & \\([1,6]\\) \n6 & \\([1,6]\\) & \\([1,2]\\) & \\([1,6]\\) \n7 & \\([1,6]\\) & \\([3,6]\\) & \\([1,4]\\) \n8 & \\([1,6]\\) & \\([1,6]\\) & \\([5,6]\\) \n9 & \\([1,6]\\) & \\([1,6]\\) & \\([1,2]\\) \nWe have \\(I_{1} \\cap I_{2}=I_{2} \\cap I_{3}=I_{3} \\cap I_{4}=\\emptyset, J_{4} \\cap J_{5}=J_{5} \\cap J_{6}=J_{6} \\cap J_{7}=\\emptyset\\), and finally \\(K_{7} \\cap K_{8}=K_{8} \\cap K_{9}=K_{9} \\cap K_{1}=\\emptyset\\). The intervals in each column intersect in all other cases. It follows that the boxes \\(B_{i}=I_{i} \\times J_{i} \\times K_{i}, i=1, \\ldots, 9\\), have the stated property."}
{"id": "imo-shortlist-2008-c2", "question": "C2. For every positive integer \\(n\\) determine the number of permutations ( \\(a_{1}, a_{2}, \\ldots, a_{n}\\) ) of the set \\(\\{1,2, \\ldots, n\\}\\) with the following property:\n\n\\[\n2\\left(a_{1}+a_{2}+\\cdots+a_{k}\\right) \\quad \\text { is divisible by } k \\quad \\text { for } k=1,2, \\ldots, n .\n\\]", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2008, "solution": "For each \\(n\\) let \\(F_{n}\\) be the number of permutations of \\(\\{1,2, \\ldots, n\\}\\) with the required property; call them nice. For \\(n=1,2,3\\) every permutation is nice, so \\(F_{1}=1, F_{2}=2, F_{3}=6\\).\n\nTake an \\(n>3\\) and consider any nice permutation \\(\\left(a_{1}, a_{2}, \\ldots, a_{n}\\right)\\) of \\(\\{1,2, \\ldots, n\\}\\). Then \\(n-1\\) must be a divisor of the number\n\n\\[\n\\begin{aligned}\n& 2\\left(a_{1}+a_{2}+\\cdots+a_{n-1}\\right)=2\\left((1+2+\\cdots+n)-a_{n}\\right) \n& \\quad=n(n+1)-2 a_{n}=(n+2)(n-1)+\\left(2-2 a_{n}\\right)\n\n\\]\n\nSo \\(2 a_{n}-2\\) must be divisible by \\(n-1\\), hence equal to 0 or \\(n-1\\) or \\(2 n-2\\). This means that\n\n\\[\na_{n}=1 \\quad \\text { or } \\quad a_{n}=\\frac{n+1}{2} \\quad \\text { or } \\quad a_{n}=n\n\\]\n\nSuppose that \\(a_{n}=(n+1) / 2\\). Since the permutation is nice, taking \\(k=n-2\\) we get that \\(n-2\\) has to be a divisor of\n\n\\[\n\\begin{aligned}\n2\\left(a_{1}+a_{2}+\\cdots+a_{n-2}\\right) & =2\\left((1+2+\\cdots+n)-a_{n}-a_{n-1}\\right) \n& =n(n+1)-(n+1)-2 a_{n-1}=(n+2)(n-2)+\\left(3-2 a_{n-1}\\right)\n\n\\]\n\nSo \\(2 a_{n-1}-3\\) should be divisible by \\(n-2\\), hence equal to 0 or \\(n-2\\) or \\(2 n-4\\). Obviously 0 and \\(2 n-4\\) are excluded because \\(2 a_{n-1}-3\\) is odd. The remaining possibility ( \\(2 a_{n-1}-3=n-2\\) ) leads to \\(a_{n-1}=(n+1) / 2=a_{n}\\), which also cannot hold. This eliminates \\((n+1) / 2\\) as a possible value of \\(a_{n}\\). Consequently \\(a_{n}=1\\) or \\(a_{n}=n\\).\n\nIf \\(a_{n}=n\\) then \\(\\left(a_{1}, a_{2}, \\ldots, a_{n-1}\\right)\\) is a nice permutation of \\(\\{1,2, \\ldots, n-1\\}\\). There are \\(F_{n-1}\\) such permutations. Attaching \\(n\\) to any one of them at the end creates a nice permutation of \\(\\{1,2, \\ldots, n\\}\\).\n\nIf \\(a_{n}=1\\) then \\(\\left(a_{1}-1, a_{2}-1, \\ldots, a_{n-1}-1\\right)\\) is a permutation of \\(\\{1,2, \\ldots, n-1\\}\\). It is also nice because the number\n\n\\[\n2\\left(\\left(a_{1}-1\\right)+\\cdots+\\left(a_{k}-1\\right)\\right)=2\\left(a_{1}+\\cdots+a_{k}\\right)-2 k\n\\]\n\nis divisible by \\(k\\), for any \\(k \\leq n-1\\). And again, any one of the \\(F_{n-1}\\) nice permutations \\(\\left(b_{1}, b_{2}, \\ldots, b_{n-1}\\right)\\) of \\(\\{1,2, \\ldots, n-1\\}\\) gives rise to a nice permutation of \\(\\{1,2, \\ldots, n\\}\\) whose last term is 1 , namely \\(\\left(b_{1}+1, b_{2}+1, \\ldots, b_{n-1}+1,1\\right)\\).\n\nThe bijective correspondences established in both cases show that there are \\(F_{n-1}\\) nice permutations of \\(\\{1,2, \\ldots, n\\}\\) with the last term 1 and also \\(F_{n-1}\\) nice permutations of \\(\\{1,2, \\ldots, n\\}\\) with the last term \\(n\\). Hence follows the recurrence \\(F_{n}=2 F_{n-1}\\). With the base value \\(F_{3}=6\\) this gives the outcome formula \\(F_{n}=3 \\cdot 2^{n-2}\\) for \\(n \\geq 3\\)."}
{"id": "imo-shortlist-2008-c3", "question": "C3. In the coordinate plane consider the set \\(S\\) of all points with integer coordinates. For a positive integer \\(k\\), two distinct points \\(A, B \\in S\\) will be called \\(k\\)-friends if there is a point \\(C \\in S\\) such that the area of the triangle \\(A B C\\) is equal to \\(k\\). A set \\(T \\subset S\\) will be called a \\(k\\)-clique if every two points in \\(T\\) are \\(k\\)-friends. Find the least positive integer \\(k\\) for which there exists a \\(k\\)-clique with more than 200 elements.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2008, "solution": "To begin, let us describe those points \\(B \\in S\\) which are \\(k\\)-friends of the point \\((0,0)\\). By definition, \\(B=(u, v)\\) satisfies this condition if and only if there is a point \\(C=(x, y) \\in S\\) such that \\(\\frac{1}{2}|u y-v x|=k\\). (This is a well-known formula expressing the area of triangle \\(A B C\\) when \\(A\\) is the origin.)\n\nTo say that there exist integers \\(x, y\\) for which \\(|u y-v x|=2 k\\), is equivalent to saying that the greatest common divisor of \\(u\\) and \\(v\\) is also a divisor of \\(2 k\\). Summing up, a point \\(B=(u, v) \\in S\\) is a \\(k\\)-friend of \\((0,0)\\) if and only if \\(\\operatorname{gcd}(u, v)\\) divides \\(2 k\\).\n\nTranslation by a vector with integer coordinates does not affect \\(k\\)-friendship; if two points are \\(k\\)-friends, so are their translates. It follows that two points \\(A, B \\in S, A=(s, t), B=(u, v)\\), are \\(k\\)-friends if and only if the point \\((u-s, v-t)\\) is a \\(k\\)-friend of \\((0,0)\\); i.e., if \\(\\operatorname{gcd}(u-s, v-t) \\mid 2 k\\).\n\nLet \\(n\\) be a positive integer which does not divide \\(2 k\\). We claim that a \\(k\\)-clique cannot have more than \\(n^{2}\\) elements.\n\nIndeed, all points \\((x, y) \\in S\\) can be divided into \\(n^{2}\\) classes determined by the remainders that \\(x\\) and \\(y\\) leave in division by \\(n\\). If a set \\(T\\) has more than \\(n^{2}\\) elements, some two points \\(A, B \\in T, A=(s, t), B=(u, v)\\), necessarily fall into the same class. This means that \\(n \\mid u-s\\) and \\(n \\mid v-t\\). Hence \\(n \\mid d\\) where \\(d=\\operatorname{gcd}(u-s, v-t)\\). And since \\(n\\) does not divide \\(2 k\\), also \\(d\\) does not divide \\(2 k\\). Thus \\(A\\) and \\(B\\) are not \\(k\\)-friends and the set \\(T\\) is not a \\(k\\)-clique.\n\nNow let \\(M(k)\\) be the least positive integer which does not divide \\(2 k\\). Write \\(M(k)=m\\) for the moment and consider the set \\(T\\) of all points \\((x, y)\\) with \\(0 \\leq x, y<m\\). There are \\(m^{2}\\) of them. If \\(A=(s, t), B=(u, v)\\) are two distinct points in \\(T\\) then both differences \\(|u-s|,|v-t|\\) are integers less than \\(m\\) and at least one of them is positive. By the definition of \\(m\\), every positive integer less than \\(m\\) divides \\(2 k\\). Therefore \\(u-s\\) (if nonzero) divides \\(2 k\\), and the same is true of \\(v-t\\). So \\(2 k\\) is divisible by \\(\\operatorname{gcd}(u-s, v-t)\\), meaning that \\(A, B\\) are \\(k\\)-friends. Thus \\(T\\) is a \\(k\\)-clique.\n\nIt follows that the maximum size of a \\(k\\)-clique is \\(M(k)^{2}\\), with \\(M(k)\\) defined as above. We are looking for the minimum \\(k\\) such that \\(M(k)^{2}>200\\).\n\nBy the definition of \\(M(k), 2 k\\) is divisible by the numbers \\(1,2, \\ldots, M(k)-1\\), but not by \\(M(k)\\) itself. If \\(M(k)^{2}>200\\) then \\(M(k) \\geq 15\\). Trying to hit \\(M(k)=15\\) we get a contradiction immediately ( \\(2 k\\) would have to be divisible by 3 and 5 , but not by 15 ).\n\nSo let us try \\(M(k)=16\\). Then \\(2 k\\) is divisible by the numbers \\(1,2, \\ldots, 15\\), hence also by their least common multiple \\(L\\), but not by 16 . And since \\(L\\) is not a multiple of 16 , we infer that \\(k=L / 2\\) is the least \\(k\\) with \\(M(k)=16\\).\n\nFinally, observe that if \\(M(k) \\geq 17\\) then \\(2 k\\) must be divisible by the least common multiple of \\(1,2, \\ldots, 16\\), which is equal to \\(2 L\\). Then \\(2 k \\geq 2 L\\), yielding \\(k>L / 2\\).\n\nIn conclusion, the least \\(k\\) with the required property is equal to \\(L / 2=180180\\)."}
{"id": "imo-shortlist-2008-c4", "question": "C4. Let \\(n\\) and \\(k\\) be fixed positive integers of the same parity, \\(k \\geq n\\). We are given \\(2 n\\) lamps numbered 1 through \\(2 n\\); each of them can be on or off. At the beginning all lamps are off. We consider sequences of \\(k\\) steps. At each step one of the lamps is switched (from off to on or from on to off).\n\nLet \\(N\\) be the number of \\(k\\)-step sequences ending in the state: lamps \\(1, \\ldots, n\\) on, lamps \\(n+1, \\ldots, 2 n\\) off.\n\nLet \\(M\\) be the number of \\(k\\)-step sequences leading to the same state and not touching lamps \\(n+1, \\ldots, 2 n\\) at all.\n\nFind the ratio \\(N / M\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2008, "solution": "A sequence of \\(k\\) switches ending in the state as described in the problem statement (lamps \\(1, \\ldots, n\\) on, lamps \\(n+1, \\ldots, 2 n\\) off) will be called an admissible process. If, moreover, the process does not touch the lamps \\(n+1, \\ldots, 2 n\\), it will be called restricted. So there are \\(N\\) admissible processes, among which \\(M\\) are restricted.\n\nIn every admissible process, restricted or not, each one of the lamps \\(1, \\ldots, n\\) goes from off to on, so it is switched an odd number of times; and each one of the lamps \\(n+1, \\ldots, 2 n\\) goes from off to off, so it is switched an even number of times.\n\nNotice that \\(M>0\\); i.e., restricted admissible processes do exist (it suffices to switch each one of the lamps \\(1, \\ldots, n\\) just once and then choose one of them and switch it \\(k-n\\) times, which by hypothesis is an even number).\n\nConsider any restricted admissible process \\(\\mathbf{p}\\). Take any lamp \\(\\ell, 1 \\leq \\ell \\leq n\\), and suppose that it was switched \\(k_{\\ell}\\) times. As noticed, \\(k_{\\ell}\\) must be odd. Select arbitrarily an even number of these \\(k_{\\ell}\\) switches and replace each of them by the switch of lamp \\(n+\\ell\\). This can be done in \\(2^{k_{\\ell}-1}\\) ways (because a \\(k_{\\ell}\\)-element set has \\(2^{k_{\\ell}-1}\\) subsets of even cardinality). Notice that \\(k_{1}+\\cdots+k_{n}=k\\).\n\nThese actions are independent, in the sense that the action involving lamp \\(\\ell\\) does not affect the action involving any other lamp. So there are \\(2^{k_{1}-1} \\cdot 2^{k_{2}-1} \\cdots 2^{k_{n}-1}=2^{k-n}\\) ways of combining these actions. In any of these combinations, each one of the lamps \\(n+1, \\ldots, 2 n\\) gets switched an even number of times and each one of the lamps \\(1, \\ldots, n\\) remains switched an odd number of times, so the final state is the same as that resulting from the original process \\(\\mathbf{p}\\).\n\nThis shows that every restricted admissible process \\(\\mathbf{p}\\) can be modified in \\(2^{k-n}\\) ways, giving rise to \\(2^{k-n}\\) distinct admissible processes (with all lamps allowed).\n\nNow we show that every admissible process \\(\\mathbf{q}\\) can be achieved in that way. Indeed, it is enough to replace every switch of a lamp with a label \\(\\ell>n\\) that occurs in \\(\\mathbf{q}\\) by the switch of the corresponding lamp \\(\\ell-n\\); in the resulting process \\(\\mathbf{p}\\) the lamps \\(n+1, \\ldots, 2 n\\) are not involved.\n\nSwitches of each lamp with a label \\(\\ell>n\\) had occurred in \\(\\mathbf{q}\\) an even number of times. So the performed replacements have affected each lamp with a label \\(\\ell \\leq n\\) also an even number of times; hence in the overall effect the final state of each lamp has remained the same. This means that the resulting process \\(\\mathbf{p}\\) is admissible - and clearly restricted, as the lamps \\(n+1, \\ldots, 2 n\\) are not involved in it any more.\n\nIf we now take process \\(\\mathbf{p}\\) and reverse all these replacements, then we obtain process \\(\\mathbf{q}\\). These reversed replacements are nothing else than the modifications described in the foregoing paragraphs.\n\nThus there is a one-to- \\(\\left(2^{k-n}\\right)\\) correspondence between the \\(M\\) restricted admissible processes and the total of \\(N\\) admissible processes. Therefore \\(N / M=2^{k-n}\\)."}
{"id": "imo-shortlist-2008-c5", "question": "C5. Let \\(S=\\left\\{x_{1}, x_{2}, \\ldots, x_{k+\\ell}\\right\\}\\) be a ( \\(k+\\ell\\) )-element set of real numbers contained in the interval \\([0,1] ; k\\) and \\(\\ell\\) are positive integers. A \\(k\\)-element subset \\(A \\subset S\\) is called nice if\n\n\\[\n\\left|\\frac{1}{k} \\sum_{x_{i} \\in A} x_{i}-\\frac{1}{\\ell} \\sum_{x_{j} \\in S \\backslash A} x_{j}\\right| \\leq \\frac{k+\\ell}{2 k \\ell}\n\\]\n\nProve that the number of nice subsets is at least \\(\\frac{2}{k+\\ell}\\binom{k+\\ell}{k}\\).", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2008, "solution": "For a \\(k\\)-element subset \\(A \\subset S\\), let \\(f(A)=\\frac{1}{k} \\sum_{x_{i} \\in A} x_{i}-\\frac{1}{\\ell} \\sum_{x_{j} \\in S \\backslash A} x_{j}\\). Denote \\(\\frac{k+\\ell}{2 k \\ell}=d\\).\nBy definition a subset \\(A\\) is nice if \\(|f(A)| \\leq d\\).\nTo each permutation ( \\(y_{1}, y_{2}, \\ldots, y_{k+\\ell}\\) ) of the set \\(S=\\left\\{x_{1}, x_{2}, \\ldots, x_{k+\\ell}\\right\\}\\) we assign \\(k+\\ell\\) subsets of \\(S\\) with \\(k\\) elements each, namely \\(A_{i}=\\left\\{y_{i}, y_{i+1}, \\ldots, y_{i+k-1}\\right\\}, i=1,2, \\ldots, k+\\ell\\). Indices are taken modulo \\(k+\\ell\\) here and henceforth. In other words, if \\(y_{1}, y_{2}, \\ldots, y_{k+\\ell}\\) are arranged around a circle in this order, the sets in question are all possible blocks of \\(k\\) consecutive elements.\nClaim. At least two nice sets are assigned to every permutation of \\(S\\).\nProof. Adjacent sets \\(A_{i}\\) and \\(A_{i+1}\\) differ only by the elements \\(y_{i}\\) and \\(y_{i+k}, i=1, \\ldots, k+\\ell\\). By the definition of \\(f\\), and because \\(y_{i}, y_{i+k} \\in[0,1]\\),\n\n\\[\n\\left|f\\left(A_{i+1}\\right)-f\\left(A_{i}\\right)\\right|=\\left|\\left(\\frac{1}{k}+\\frac{1}{\\ell}\\right)\\left(y_{i+k}-y_{i}\\right)\\right| \\leq \\frac{1}{k}+\\frac{1}{\\ell}=2 d\n\\]\n\nEach element \\(y_{i} \\in S\\) belongs to exactly \\(k\\) of the sets \\(A_{1}, \\ldots, A_{k+\\ell}\\). Hence in \\(k\\) of the expressions \\(f\\left(A_{1}\\right), \\ldots, f\\left(A_{k+\\ell}\\right)\\) the coefficient of \\(y_{i}\\) is \\(1 / k\\); in the remaining \\(\\ell\\) expressions, its coefficient is \\(-1 / \\ell\\). So the contribution of \\(y_{i}\\) to the sum of all \\(f\\left(A_{i}\\right)\\) equals \\(k \\cdot 1 / k-\\ell \\cdot 1 / \\ell=0\\). Since this holds for all \\(i\\), it follows that \\(f\\left(A_{1}\\right)+\\cdots+f\\left(A_{k+\\ell}\\right)=0\\).\n\nIf \\(f\\left(A_{p}\\right)=\\min f\\left(A_{i}\\right), f\\left(A_{q}\\right)=\\max f\\left(A_{i}\\right)\\), we obtain in particular \\(f\\left(A_{p}\\right) \\leq 0, f\\left(A_{q}\\right) \\geq 0\\). Let \\(p<q\\) (the case \\(p>q\\) is analogous; and the claim is true for \\(p=q\\) as \\(f\\left(A_{i}\\right)=0\\) for all \\(i\\) ).\n\nWe are ready to prove that at least two of the sets \\(A_{1}, \\ldots, A_{k+\\ell}\\) are nice. The interval \\([-d, d]\\) has length \\(2 d\\), and we saw that adjacent numbers in the circular arrangement \\(f\\left(A_{1}\\right), \\ldots, f\\left(A_{k+\\ell}\\right)\\) differ by at most \\(2 d\\). Suppose that \\(f\\left(A_{p}\\right)<-d\\) and \\(f\\left(A_{q}\\right)>d\\). Then one of the numbers \\(f\\left(A_{p+1}\\right), \\ldots, f\\left(A_{q-1}\\right)\\) lies in \\([-d, d]\\), and also one of the numbers \\(f\\left(A_{q+1}\\right), \\ldots, f\\left(A_{p-1}\\right)\\) lies there. Consequently, one of the sets \\(A_{p+1}, \\ldots, A_{q-1}\\) is nice, as well as one of the sets \\(A_{q+1}, \\ldots, A_{p-1}\\). If \\(-d \\leq f\\left(A_{p}\\right)\\) and \\(f\\left(A_{q}\\right) \\leq d\\) then \\(A_{p}\\) and \\(A_{q}\\) are nice.\n\nLet now \\(f\\left(A_{p}\\right)<-d\\) and \\(f\\left(A_{q}\\right) \\leq d\\). Then \\(f\\left(A_{p}\\right)+f\\left(A_{q}\\right)<0\\), and since \\(\\sum f\\left(A_{i}\\right)=0\\), there is an \\(r \\neq q\\) such that \\(f\\left(A_{r}\\right)>0\\). We have \\(0<f\\left(A_{r}\\right) \\leq f\\left(A_{q}\\right) \\leq d\\), so the sets \\(f\\left(A_{r}\\right)\\) and \\(f\\left(A_{q}\\right)\\) are nice. The only case remaining, \\(-d \\leq f\\left(A_{p}\\right)\\) and \\(d<f\\left(A_{q}\\right)\\), is analogous.\n\nApply the claim to each of the \\((k+\\ell)\\) ! permutations of \\(S=\\left\\{x_{1}, x_{2}, \\ldots, x_{k+\\ell}\\right\\}\\). This gives at least \\(2(k+\\ell)\\) ! nice sets, counted with repetitions: each nice set is counted as many times as there are permutations to which it is assigned.\n\nOn the other hand, each \\(k\\)-element set \\(A \\subset S\\) is assigned to exactly \\((k+\\ell) k!\\ell!\\) permutations. Indeed, such a permutation \\(\\left(y_{1}, y_{2}, \\ldots, y_{k+\\ell}\\right)\\) is determined by three independent choices: an in\\(\\operatorname{dex} i \\in\\{1,2, \\ldots, k+\\ell\\}\\) such that \\(A=\\left\\{y_{i}, y_{i+1}, \\ldots, y_{i+k-1}\\right\\}\\), a permutation \\(\\left(y_{i}, y_{i+1}, \\ldots, y_{i+k-1}\\right)\\) of the set \\(A\\), and a permutation \\(\\left(y_{i+k}, y_{i+k+1}, \\ldots, y_{i-1}\\right)\\) of the set \\(S \\backslash A\\).\n\nIn summary, there are at least \\(\\frac{2(k+\\ell)!}{(k+\\ell) k!\\ell!}=\\frac{2}{k+\\ell}\\binom{k+\\ell}{k}\\) nice sets."}
{"id": "imo-shortlist-2008-c6", "question": "C6. For \\(n \\geq 2\\), let \\(S_{1}, S_{2}, \\ldots, S_{2^{n}}\\) be \\(2^{n}\\) subsets of \\(A=\\left\\{1,2,3, \\ldots, 2^{n+1}\\right\\}\\) that satisfy the following property: There do not exist indices \\(a\\) and \\(b\\) with \\(a<b\\) and elements \\(x, y, z \\in A\\) with \\(x<y<z\\) such that \\(y, z \\in S_{a}\\) and \\(x, z \\in S_{b}\\). Prove that at least one of the sets \\(S_{1}, S_{2}, \\ldots, S_{2^{n}}\\) contains no more than \\(4 n\\) elements.", "category": "Combinatorics", "source": "IMO Shortlist", "year": 2008, "solution": "We prove that there exists a set \\(S_{a}\\) with at most \\(3 n+1\\) elements.\nGiven a \\(k \\in\\{1, \\ldots, n\\}\\), we say that an element \\(z \\in A\\) is \\(k\\)-good to a set \\(S_{a}\\) if \\(z \\in S_{a}\\) and \\(S_{a}\\) contains two other elements \\(x\\) and \\(y\\) with \\(x<y<z\\) such that \\(z-y<2^{k}\\) and \\(z-x \\geq 2^{k}\\). Also, \\(z \\in A\\) will be called good to \\(S_{a}\\) if \\(z\\) is \\(k\\)-good to \\(S_{a}\\) for some \\(k=1, \\ldots, n\\).\n\nWe claim that each \\(z \\in A\\) can be \\(k\\)-good to at most one set \\(S_{a}\\). Indeed, suppose on the contrary that \\(z\\) is \\(k\\)-good simultaneously to \\(S_{a}\\) and \\(S_{b}\\), with \\(a<b\\). Then there exist \\(y_{a} \\in S_{a}\\), \\(y_{a}<z\\), and \\(x_{b} \\in S_{b}, x_{b}<z\\), such that \\(z-y_{a}<2^{k}\\) and \\(z-x_{b} \\geq 2^{k}\\). On the other hand, since \\(z \\in S_{a} \\cap S_{b}\\), by the condition of the problem there is no element of \\(S_{a}\\) strictly between \\(x_{b}\\) and \\(z\\). Hence \\(y_{a} \\leq x_{b}\\), implying \\(z-y_{a} \\geq z-x_{b}\\). However this contradicts \\(z-y_{a}<2^{k}\\) and \\(z-x_{b} \\geq 2^{k}\\). The claim follows.\n\nAs a consequence, a fixed \\(z \\in A\\) can be good to at most \\(n\\) of the given sets (no more than one of them for each \\(k=1, \\ldots, n)\\).\n\nFurthermore, let \\(u_{1}<u_{2}<\\cdots<u_{m}<\\cdots<u_{p}\\) be all elements of a fixed set \\(S_{a}\\) that are not good to \\(S_{a}\\). We prove that \\(u_{m}-u_{1}>2\\left(u_{m-1}-u_{1}\\right)\\) for all \\(m \\geq 3\\).\n\nIndeed, assume that \\(u_{m}-u_{1} \\leq 2\\left(u_{m-1}-u_{1}\\right)\\) holds for some \\(m \\geq 3\\). This inequality can be written as \\(2\\left(u_{m}-u_{m-1}\\right) \\leq u_{m}-u_{1}\\). Take the unique \\(k\\) such that \\(2^{k} \\leq u_{m}-u_{1}<2^{k+1}\\). Then \\(2\\left(u_{m}-u_{m-1}\\right) \\leq u_{m}-u_{1}<2^{k+1}\\) yields \\(u_{m}-u_{m-1}<2^{k}\\). However the elements \\(z=u_{m}, x=u_{1}\\), \\(y=u_{m-1}\\) of \\(S_{a}\\) then satisfy \\(z-y<2^{k}\\) and \\(z-x \\geq 2^{k}\\), so that \\(z=u_{m}\\) is \\(k\\)-good to \\(S_{a}\\).\n\nThus each term of the sequence \\(u_{2}-u_{1}, u_{3}-u_{1}, \\ldots, u_{p}-u_{1}\\) is more than twice the previous one. Hence \\(u_{p}-u_{1}>2^{p-1}\\left(u_{2}-u_{1}\\right) \\geq 2^{p-1}\\). But \\(u_{p} \\in\\left\\{1,2,3, \\ldots, 2^{n+1}\\right\\}\\), so that \\(u_{p} \\leq 2^{n+1}\\). This yields \\(p-1 \\leq n\\), i. e. \\(p \\leq n+1\\).\n\nIn other words, each set \\(S_{a}\\) contains at most \\(n+1\\) elements that are not good to it.\nTo summarize the conclusions, mark with red all elements in the sets \\(S_{a}\\) that are good to the respective set, and with blue the ones that are not good. Then the total number of red elements, counting multiplicities, is at most \\(n \\cdot 2^{n+1}\\) (each \\(z \\in A\\) can be marked red in at most \\(n\\) sets). The total number of blue elements is at most \\((n+1) 2^{n}\\) (each set \\(S_{a}\\) contains at most \\(n+1\\) blue elements). Therefore the sum of cardinalities of \\(S_{1}, S_{2}, \\ldots, S_{2^{n}}\\) does not exceed \\((3 n+1) 2^{n}\\). By averaging, the smallest set has at most \\(3 n+1\\) elements.\n\nSolution 2. We show that one of the sets \\(S_{a}\\) has at most \\(2 n+1\\) elements. In the sequel \\(|\\cdot|\\) denotes the cardinality of a (finite) set.\nClaim. For \\(n \\geq 2\\), suppose that \\(k\\) subsets \\(S_{1}, \\ldots, S_{k}\\) of \\(\\left\\{1,2, \\ldots, 2^{n}\\right\\}\\) (not necessarily different) satisfy the condition of the problem. Then\n\n\\[\n\\sum_{i=1}^{k}\\left(\\left|S_{i}\\right|-n\\right) \\leq(2 n-1) 2^{n-2}\n\\]\n\nProof. Observe that if the sets \\(S_{i}(1 \\leq i \\leq k)\\) satisfy the condition then so do their arbitrary subsets \\(T_{i}(1 \\leq i \\leq k)\\). The condition also holds for the sets \\(t+S_{i}=\\left\\{t+x \\mid x \\in S_{i}\\right\\}\\) where \\(t\\) is arbitrary.\n\nNote also that a set may occur more than once among \\(S_{1}, \\ldots, S_{k}\\) only if its cardinality is less than 3 , in which case its contribution to the sum \\(\\sum_{i=1}^{k}\\left(\\left|S_{i}\\right|-n\\right)\\) is nonpositive (as \\(n \\geq 2\\) ).\n\nThe proof is by induction on \\(n\\). In the base case \\(n=2\\) we have subsets \\(S_{i}\\) of \\(\\{1,2,3,4\\}\\). Only the ones of cardinality 3 and 4 need to be considered by the remark above; each one of\nthem occurs at most once among \\(S_{1}, \\ldots, S_{k}\\). If \\(S_{i}=\\{1,2,3,4\\}\\) for some \\(i\\) then no \\(S_{j}\\) is a 3-element subset in view of the condition, hence \\(\\sum_{i=1}^{k}\\left(\\left|S_{i}\\right|-2\\right) \\leq 2\\). By the condition again, it is impossible that \\(S_{i}=\\{1,3,4\\}\\) and \\(S_{j}=\\{2,3,4\\}\\) for some \\(i, j\\). So if \\(\\left|S_{i}\\right| \\leq 3\\) for all \\(i\\) then at most 3 summands \\(\\left|S_{i}\\right|-2\\) are positive, corresponding to 3 -element subsets. This implies \\(\\sum_{i=1}^{k}\\left(\\left|S_{i}\\right|-2\\right) \\leq 3\\), therefore the conclusion is true for \\(n=2\\).\n\nSuppose that the claim holds for some \\(n \\geq 2\\), and let the sets \\(S_{1}, \\ldots, S_{k} \\subseteq\\left\\{1,2, \\ldots, 2^{n+1}\\right\\}\\) satisfy the given property. Denote \\(U_{i}=S_{i} \\cap\\left\\{1,2, \\ldots, 2^{n}\\right\\}, V_{i}=S_{i} \\cap\\left\\{2^{n}+1, \\ldots, 2^{n+1}\\right\\}\\). Let\n\n\\[\nI=\\left\\{i\\left|1 \\leq i \\leq k,\\left|U_{i}\\right| \\neq 0\\right\\}, \\quad J=\\{1, \\ldots, k\\} \\backslash I\\right.\n\\]\n\nThe sets \\(S_{j}\\) with \\(j \\in J\\) are all contained in \\(\\left\\{2^{n}+1, \\ldots, 2^{n+1}\\right\\}\\), so the induction hypothesis applies to their translates \\(-2^{n}+S_{j}\\) which have the same cardinalities. Consequently, this gives \\(\\sum_{j \\in J}\\left(\\left|S_{j}\\right|-n\\right) \\leq(2 n-1) 2^{n-2}\\), so that\n\n\\[\n\\sum_{j \\in J}\\left(\\left|S_{j}\\right|-(n+1)\\right) \\leq \\sum_{j \\in J}\\left(\\left|S_{j}\\right|-n\\right) \\leq(2 n-1) 2^{n-2}\n\\]\n\nFor \\(i \\in I\\), denote by \\(v_{i}\\) the least element of \\(V_{i}\\). Observe that if \\(V_{a}\\) and \\(V_{b}\\) intersect, with \\(a<b\\), \\(a, b \\in I\\), then \\(v_{a}\\) is their unique common element. Indeed, let \\(z \\in V_{a} \\cap V_{b} \\subseteq S_{a} \\cap S_{b}\\) and let \\(m\\) be the least element of \\(S_{b}\\). Since \\(b \\in I\\), we have \\(m \\leq 2^{n}\\). By the condition, there is no element of \\(S_{a}\\) strictly between \\(m \\leq 2^{n}\\) and \\(z>2^{n}\\), which implies \\(z=v_{a}\\).\n\nIt follows that if the element \\(v_{i}\\) is removed from each \\(V_{i}\\), a family of pairwise disjoint sets \\(W_{i}=V_{i} \\backslash\\left\\{v_{i}\\right\\}\\) is obtained, \\(i \\in I\\) (we assume \\(W_{i}=\\emptyset\\) if \\(V_{i}=\\emptyset\\) ). As \\(W_{i} \\subseteq\\left\\{2^{n}+1, \\ldots, 2^{n+1}\\right\\}\\) for all \\(i\\), we infer that \\(\\sum_{i \\in I}\\left|W_{i}\\right| \\leq 2^{n}\\). Therefore \\(\\sum_{i \\in I}\\left(\\left|V_{i}\\right|-1\\right) \\leq \\sum_{i \\in I}\\left|W_{i}\\right| \\leq 2^{n}\\).\n\nOn the other hand, the induction hypothesis applies directly to the sets \\(U_{i}, i \\in I\\), so that \\(\\sum_{i \\in \\mathcal{I}}\\left(\\left|U_{i}\\right|-n\\right) \\leq(2 n-1) 2^{n-2}\\). In summary,\n\n\\[\n\\sum_{i \\in I}\\left(\\left|S_{i}\\right|-(n+1)\\right)=\\sum_{i \\in I}\\left(\\left|U_{i}\\right|-n\\right)+\\sum_{i \\in I}\\left(\\left|V_{i}\\right|-1\\right) \\leq(2 n-1) 2^{n-2}+2^{n}\n\\]\n\nThe estimates (1) and (2) are sufficient to complete the inductive step:\n\n\\[\n\\begin{aligned}\n\\sum_{i=1}^{k}\\left(\\left|S_{i}\\right|-(n+1)\\right) & =\\sum_{i \\in I}\\left(\\left|S_{i}\\right|-(n+1)\\right)+\\sum_{j \\in J}\\left(\\left|S_{j}\\right|-(n+1)\\right) \n& \\leq(2 n-1) 2^{n-2}+2^{n}+(2 n-1) 2^{n-2}=(2 n+1) 2^{n-1}\n\n\\]\n\nReturning to the problem, consider \\(k=2^{n}\\) subsets \\(S_{1}, S_{2}, \\ldots, S_{2^{n}}\\) of \\(\\left\\{1,2,3, \\ldots, 2^{n+1}\\right\\}\\). If they satisfy the given condition, the claim implies \\(\\sum_{i=1}^{2^{n}}\\left(\\left|S_{i}\\right|-(n+1)\\right) \\leq(2 n+1) 2^{n-1}\\). By averaging again, we see that the smallest set has at most \\(2 n+1\\) elements.\n\nComment. It can happen that each set \\(S_{i}\\) has cardinality at least \\(n+1\\). Here is an example by the proposer.\n\nFor \\(i=1, \\ldots, 2^{n}\\), let \\(S_{i}=\\left\\{i+2^{k} \\mid 0 \\leq k \\leq n\\right\\}\\). Then \\(\\left|S_{i}\\right|=n+1\\) for all \\(i\\). Suppose that there exist \\(a<b\\) and \\(x<y<z\\) such that \\(y, z \\in S_{a}\\) and \\(x, z \\in S_{b}\\). Hence \\(z=a+2^{k}=b+2^{l}\\) for some \\(k>l\\). Since \\(y \\in S_{a}\\) and \\(y<z\\), we have \\(y \\leq a+2^{k-1}\\). So the element \\(x \\in S_{b}\\) satisfies\n\n\\[\nx<y \\leq a+2^{k-1}=z-2^{k-1} \\leq z-2^{l}=b\n\\]\n\nHowever the least element of \\(S_{b}\\) is \\(b+1\\), a contradiction."}
{"id": "imo-shortlist-2008-g1", "question": "G1. In an acute-angled triangle \\(A B C\\), point \\(H\\) is the orthocentre and \\(A_{0}, B_{0}, C_{0}\\) are the midpoints of the sides \\(B C, C A, A B\\), respectively. Consider three circles passing through \\(H\\) : \\(\\omega_{a}\\) around \\(A_{0}, \\omega_{b}\\) around \\(B_{0}\\) and \\(\\omega_{c}\\) around \\(C_{0}\\). The circle \\(\\omega_{a}\\) intersects the line \\(B C\\) at \\(A_{1}\\) and \\(A_{2} ; \\omega_{b}\\) intersects \\(C A\\) at \\(B_{1}\\) and \\(B_{2} ; \\omega_{c}\\) intersects \\(A B\\) at \\(C_{1}\\) and \\(C_{2}\\). Show that the points \\(A_{1}, A_{2}, B_{1}, B_{2}, C_{1}, C_{2}\\) lie on a circle.", "category": "Geometry", "source": "IMO Shortlist", "year": 2008, "solution": "The perpendicular bisectors of the segments \\(A_{1} A_{2}, B_{1} B_{2}, C_{1} C_{2}\\) are also the perpendicular bisectors of \\(B C, C A, A B\\). So they meet at \\(O\\), the circumcentre of \\(A B C\\). Thus \\(O\\) is the only point that can possibly be the centre of the desired circle.\n\nFrom the right triangle \\(O A_{0} A_{1}\\) we get\n\n\\[\nO A_{1}^{2}=O A_{0}^{2}+A_{0} A_{1}^{2}=O A_{0}^{2}+A_{0} H^{2}\n\\]\n\nLet \\(K\\) be the midpoint of \\(A H\\) and let \\(L\\) be the midpoint of \\(C H\\). Since \\(A_{0}\\) and \\(B_{0}\\) are the midpoints of \\(B C\\) and \\(C A\\), we see that \\(A_{0} L \\| B H\\) and \\(B_{0} L \\| A H\\). Thus the segments \\(A_{0} L\\) and \\(B_{0} L\\) are perpendicular to \\(A C\\) and \\(B C\\), hence parallel to \\(O B_{0}\\) and \\(O A_{0}\\), respectively. Consequently \\(O A_{0} L B_{0}\\) is a parallelogram, so that \\(O A_{0}\\) and \\(B_{0} L\\) are equal and parallel. Also, the midline \\(B_{0} L\\) of triangle \\(A H C\\) is equal and parallel to \\(A K\\) and \\(K H\\).\n\nIt follows that \\(A K A_{0} O\\) and \\(H A_{0} O K\\) are parallelograms. The first one gives \\(A_{0} K=O A=R\\), where \\(R\\) is the circumradius of \\(A B C\\). From the second one we obtain\n\n\\[\n2\\left(O A_{0}^{2}+A_{0} H^{2}\\right)=O H^{2}+A_{0} K^{2}=O H^{2}+R^{2}\n\\]\n\n(In a parallelogram, the sum of squares of the diagonals equals the sum of squares of the sides).\nFrom (1) and (2) we get \\(O A_{1}^{2}=\\left(O H^{2}+R^{2}\\right) / 2\\). By symmetry, the same holds for the distances \\(O A_{2}, O B_{1}, O B_{2}, O C_{1}\\) and \\(O C_{2}\\). Thus \\(A_{1}, A_{2}, B_{1}, B_{2}, C_{1}, C_{2}\\) all lie on a circle with centre at \\(O\\) and radius \\(\\left(O H^{2}+R^{2}\\right) / 2\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2a06c33868bd686c236cg-30}\n\nSolution 2. We are going to show again that the circumcentre \\(O\\) is equidistant from the six points in question.\n\nLet \\(A^{\\prime}\\) be the second intersection point of \\(\\omega_{b}\\) and \\(\\omega_{c}\\). The line \\(B_{0} C_{0}\\), which is the line of centers of circles \\(\\omega_{b}\\) and \\(\\omega_{c}\\), is a midline in triangle \\(A B C\\), parallel to \\(B C\\) and perpendicular to the altitude \\(A H\\). The points \\(A^{\\prime}\\) and \\(H\\) are symmetric with respect to the line of centers. Therefore \\(A^{\\prime}\\) lies on the line \\(A H\\).\n\nFrom the two circles \\(\\omega_{b}\\) and \\(\\omega_{c}\\) we obtain \\(A C_{1} \\cdot A C_{2}=A A^{\\prime} \\cdot A H=A B_{1} \\cdot A B_{2}\\). So the quadrilateral \\(B_{1} B_{2} C_{1} C_{2}\\) is cyclic. The perpendicular bisectors of the sides \\(B_{1} B_{2}\\) and \\(C_{1} C_{2}\\) meet at \\(O\\). Hence \\(O\\) is the circumcentre of \\(B_{1} B_{2} C_{1} C_{2}\\) and so \\(O B_{1}=O B_{2}=O C_{1}=O C_{2}\\).\n\nAnalogous arguments yield \\(O A_{1}=O A_{2}=O B_{1}=O B_{2}\\) and \\(O A_{1}=O A_{2}=O C_{1}=O C_{2}\\). Thus \\(A_{1}, A_{2}, B_{1}, B_{2}, C_{1}, C_{2}\\) lie on a circle centred at \\(O\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2a06c33868bd686c236cg-31}\n\nComment. The problem can be solved without much difficulty in many ways by calculation, using trigonometry, coordinate geometry or complex numbers. As an example we present a short proof using vectors.\n\nSolution 3. Let again \\(O\\) and \\(R\\) be the circumcentre and circumradius. Consider the vectors\n\n\\[\n\\overrightarrow{O A}=\\mathbf{a}, \\quad \\overrightarrow{O B}=\\mathbf{b}, \\quad \\overrightarrow{O C}=\\mathbf{c}, \\quad \\text { where } \\quad \\mathbf{a}^{2}=\\mathbf{b}^{2}=\\mathbf{c}^{2}=R^{2}\n\\]\n\nIt is well known that \\(\\overrightarrow{O H}=\\mathbf{a}+\\mathbf{b}+\\mathbf{c}\\). Accordingly,\n\n\\[\n\\overrightarrow{A_{0} H}=\\overrightarrow{O H}-\\overrightarrow{O A_{0}}=(\\mathbf{a}+\\mathbf{b}+\\mathbf{c})-\\frac{\\mathbf{b}+\\mathbf{c}}{2}=\\frac{2 \\mathbf{a}+\\mathbf{b}+\\mathbf{c}}{2}\n\\]\n\nand\n\n\\[\n\\begin{gathered}\nO A_{1}^{2}=O A_{0}^{2}+A_{0} A_{1}^{2}=O A_{0}^{2}+A_{0} H^{2}=\\left(\\frac{\\mathbf{b}+\\mathbf{c}}{2}\\right)^{2}+\\left(\\frac{2 \\mathbf{a}+\\mathbf{b}+\\mathbf{c}}{2}\\right)^{2} \n=\\frac{1}{4}\\left(\\mathbf{b}^{2}+2 \\mathbf{b} \\mathbf{c}+\\mathbf{c}^{2}\\right)+\\frac{1}{4}\\left(4 \\mathbf{a}^{2}+4 \\mathbf{a} \\mathbf{b}+4 \\mathbf{a} \\mathbf{c}+\\mathbf{b}^{2}+2 \\mathbf{b} \\mathbf{c}+\\mathbf{c}^{2}\\right)=2 R^{2}+(\\mathbf{a} \\mathbf{b}+\\mathbf{a} \\mathbf{c}+\\mathbf{b} \\mathbf{c})\n\n\\]\n\nhere \\(\\mathbf{a b}, \\mathbf{b c}\\), etc. denote dot products of vectors. We get the same for the distances \\(O A_{2}, O B_{1}\\), \\(O B_{2}, O C_{1}\\) and \\(O C_{2}\\)."}
{"id": "imo-shortlist-2008-g2", "question": "G2. Given trapezoid \\(A B C D\\) with parallel sides \\(A B\\) and \\(C D\\), assume that there exist points \\(E\\) on line \\(B C\\) outside segment \\(B C\\), and \\(F\\) inside segment \\(A D\\), such that \\(\\angle D A E=\\angle C B F\\). Denote by \\(I\\) the point of intersection of \\(C D\\) and \\(E F\\), and by \\(J\\) the point of intersection of \\(A B\\) and \\(E F\\). Let \\(K\\) be the midpoint of segment \\(E F\\); assume it does not lie on line \\(A B\\).\n\nProve that \\(I\\) belongs to the circumcircle of \\(A B K\\) if and only if \\(K\\) belongs to the circumcircle of \\(C D J\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2008, "solution": "Assume that the disposition of points is as in the diagram.\nSince \\(\\angle E B F=180^{\\circ}-\\angle C B F=180^{\\circ}-\\angle E A F\\) by hypothesis, the quadrilateral \\(A E B F\\) is cyclic. Hence \\(A J \\cdot J B=F J \\cdot J E\\). In view of this equality, \\(I\\) belongs to the circumcircle of \\(A B K\\) if and only if \\(I J \\cdot J K=F J \\cdot J E\\). Expressing \\(I J=I F+F J, J E=F E-F J\\), and \\(J K=\\frac{1}{2} F E-F J\\), we find that \\(I\\) belongs to the circumcircle of \\(A B K\\) if and only if\n\n\\[\nF J=\\frac{I F \\cdot F E}{2 I F+F E}\n\\]\n\nSince \\(A E B F\\) is cyclic and \\(A B, C D\\) are parallel, \\(\\angle F E C=\\angle F A B=180^{\\circ}-\\angle C D F\\). Then \\(C D F E\\) is also cyclic, yielding \\(I D \\cdot I C=I F \\cdot I E\\). It follows that \\(K\\) belongs to the circumcircle of \\(C D J\\) if and only if \\(I J \\cdot I K=I F \\cdot I E\\). Expressing \\(I J=I F+F J, I K=I F+\\frac{1}{2} F E\\), and \\(I E=I F+F E\\), we find that \\(K\\) is on the circumcircle of \\(C D J\\) if and only if\n\n\\[\nF J=\\frac{I F \\cdot F E}{2 I F+F E}\n\\]\n\nThe conclusion follows.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2a06c33868bd686c236cg-32}\n\nComment. While the figure shows \\(B\\) inside segment \\(C E\\), it is possible that \\(C\\) is inside segment \\(B E\\). Consequently, \\(I\\) would be inside segment \\(E F\\) and \\(J\\) outside segment \\(E F\\). The position of point \\(K\\) on line \\(E F\\) with respect to points \\(I, J\\) may also vary.\n\nSome case may require that an angle \\(\\varphi\\) be replaced by \\(180^{\\circ}-\\varphi\\), and in computing distances, a sum may need to become a difference. All these cases can be covered by the proposed solution if it is clearly stated that signed distances and angles are used."}
{"id": "imo-shortlist-2008-g3", "question": "G3. Let \\(A B C D\\) be a convex quadrilateral and let \\(P\\) and \\(Q\\) be points in \\(A B C D\\) such that \\(P Q D A\\) and \\(Q P B C\\) are cyclic quadrilaterals. Suppose that there exists a point \\(E\\) on the line segment \\(P Q\\) such that \\(\\angle P A E=\\angle Q D E\\) and \\(\\angle P B E=\\angle Q C E\\). Show that the quadrilateral \\(A B C D\\) is cyclic.", "category": "Geometry", "source": "IMO Shortlist", "year": 2008, "solution": "Let \\(F\\) be the point on the line \\(A D\\) such that \\(E F \\| P A\\). By hypothesis, the quadrilateral \\(P Q D A\\) is cyclic. So if \\(F\\) lies between \\(A\\) and \\(D\\) then \\(\\angle E F D=\\angle P A D=180^{\\circ}-\\angle E Q D\\); the points \\(F\\) and \\(Q\\) are on distinct sides of the line \\(D E\\) and we infer that \\(E F D Q\\) is a cyclic quadrilateral. And if \\(D\\) lies between \\(A\\) and \\(F\\) then a similar argument shows that \\(\\angle E F D=\\angle E Q D\\); but now the points \\(F\\) and \\(Q\\) lie on the same side of \\(D E\\), so that \\(E D F Q\\) is a cyclic quadrilateral.\n\nIn either case we obtain the equality \\(\\angle E F Q=\\angle E D Q=\\angle P A E\\) which implies that \\(F Q \\| A E\\). So the triangles \\(E F Q\\) and \\(P A E\\) are either homothetic or parallel-congruent. More specifically, triangle \\(E F Q\\) is the image of \\(P A E\\) under the mapping \\(f\\) which carries the points \\(P, E\\) respectively to \\(E, Q\\) and is either a homothety or translation by a vector. Note that \\(f\\) is uniquely determined by these conditions and the position of the points \\(P, E, Q\\) alone.\n\nLet now \\(G\\) be the point on the line \\(B C\\) such that \\(E G \\| P B\\). The same reasoning as above applies to points \\(B, C\\) in place of \\(A, D\\), implying that the triangle \\(E G Q\\) is the image of \\(P B E\\) under the same mapping \\(f\\). So \\(f\\) sends the four points \\(A, P, B, E\\) respectively to \\(F, E, G, Q\\).\n\nIf \\(P E \\neq Q E\\), so that \\(f\\) is a homothety with a centre \\(X\\), then the lines \\(A F, P E, B G\\)-i.e. the lines \\(A D, P Q, B C\\)-are concurrent at \\(X\\). And since \\(P Q D A\\) and \\(Q P B C\\) are cyclic quadrilaterals, the equalities \\(X A \\cdot X D=X P \\cdot X Q=X B \\cdot X C\\) hold, showing that the quadrilateral \\(A B C D\\) is cyclic.\n\nFinally, if \\(P E=Q E\\), so that \\(f\\) is a translation, then \\(A D\\|P Q\\| B C\\). Thus \\(P Q D A\\) and \\(Q P B C\\) are isosceles trapezoids. Then also \\(A B C D\\) is an isosceles trapezoid, hence a cyclic quadrilateral.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2a06c33868bd686c236cg-33}\n\nSolution 2. Here is another way to reach the conclusion that the lines \\(A D, B C\\) and \\(P Q\\) are either concurrent or parallel. From the cyclic quadrilateral \\(P Q D A\\) we get\n\n\\[\n\\angle P A D=180^{\\circ}-\\angle P Q D=\\angle Q D E+\\angle Q E D=\\angle P A E+\\angle Q E D .\n\\]\n\nHence \\(\\angle Q E D=\\angle P A D-\\angle P A E=\\angle E A D\\). This in view of the tangent-chord theorem means that the circumcircle of triangle \\(E A D\\) is tangent to the line \\(P Q\\) at \\(E\\). Analogously, the circumcircle of triangle \\(E B C\\) is tangent to \\(P Q\\) at \\(E\\).\n\nSuppose that the line \\(A D\\) intersects \\(P Q\\) at \\(X\\). Since \\(X E\\) is tangent to the circle \\((E A D)\\), \\(X E^{2}=X A \\cdot X D\\). Also, \\(X A \\cdot X D=X P \\cdot X Q\\) because \\(P, Q, D, A\\) lie on a circle. Therefore \\(X E^{2}=X P \\cdot X Q\\).\n\nIt is not hard to see that this equation determines the position of the point \\(X\\) on the line \\(P Q\\) uniquely. Thus, if \\(B C\\) also cuts \\(P Q\\), say at \\(Y\\), then the analogous equation for \\(Y\\) yields \\(X=Y\\), meaning that the three lines indeed concur. In this case, as well as in the case where \\(A D\\|P Q\\| B C\\), the concluding argument is the same as in the first solution.\n\nIt remains to eliminate the possibility that e.g. \\(A D\\) meets \\(P Q\\) at \\(X\\) while \\(B C \\| P Q\\). Indeed, \\(Q P B C\\) would then be an isosceles trapezoid and the angle equality \\(\\angle P B E=\\angle Q C E\\) would force that \\(E\\) is the midpoint of \\(P Q\\). So the length of \\(X E\\), which is the geometric mean of the lengths of \\(X P\\) and \\(X Q\\), should also be their arithmetic mean-impossible, as \\(X P \\neq X Q\\). The proof is now complete.\n\nComment. After reaching the conclusion that the circles \\((E D A)\\) and \\((E B C)\\) are tangent to \\(P Q\\) one may continue as follows. Denote the circles (PQDA), \\((E D A),(E B C),(Q P B C)\\) by \\(\\omega_{1}, \\omega_{2}, \\omega_{3}, \\omega_{4}\\) respectively. Let \\(\\ell_{i j}\\) be the radical axis of the pair ( \\(\\omega_{i}, \\omega_{j}\\) ) for \\(i<j\\). As is well-known, the lines \\(\\ell_{12}, \\ell_{13}, \\ell_{23}\\) concur, possibly at infinity (let this be the meaning of the word concur in this comment). So do the lines \\(\\ell_{12}, \\ell_{14}, \\ell_{24}\\). Note however that \\(\\ell_{23}\\) and \\(\\ell_{14}\\) both coincide with the line \\(P Q\\). Hence the pair \\(\\ell_{12}, P Q\\) is in both triples; thus the four lines \\(\\ell_{12}, \\ell_{13}, \\ell_{24}\\) and \\(P Q\\) are concurrent.\n\nSimilarly, \\(\\ell_{13}, \\ell_{14}, \\ell_{34}\\) concur, \\(\\ell_{23}, \\ell_{24}, \\ell_{34}\\) concur, and since \\(\\ell_{14}=\\ell_{23}=P Q\\), the four lines \\(\\ell_{13}, \\ell_{24}, \\ell_{34}\\) and \\(P Q\\) are concurrent. The lines \\(\\ell_{13}\\) and \\(\\ell_{24}\\) are present in both quadruples, therefore all the lines \\(\\ell_{i j}\\) are concurrent. Hence the result."}
{"id": "imo-shortlist-2008-g4", "question": "G4. In an acute triangle \\(A B C\\) segments \\(B E\\) and \\(C F\\) are altitudes. Two circles passing through the points \\(A\\) and \\(F\\) are tangent to the line \\(B C\\) at the points \\(P\\) and \\(Q\\) so that \\(B\\) lies between \\(C\\) and \\(Q\\). Prove that the lines \\(P E\\) and \\(Q F\\) intersect on the circumcircle of triangle \\(A E F\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2008, "solution": "To approach the desired result we need some information about the slopes of the lines \\(P E\\) and \\(Q F\\); this information is provided by formulas (1) and (2) which we derive below.\n\nThe tangents \\(B P\\) and \\(B Q\\) to the two circles passing through \\(A\\) and \\(F\\) are equal, as \\(B P^{2}=B A \\cdot B F=B Q^{2}\\). Consider the altitude \\(A D\\) of triangle \\(A B C\\) and its orthocentre \\(H\\). From the cyclic quadrilaterals \\(C D F A\\) and \\(C D H E\\) we get \\(B A \\cdot B F=B C \\cdot B D=B E \\cdot B H\\). Thus \\(B P^{2}=B E \\cdot B H\\), or \\(B P / B H=B E / B P\\), implying that the triangles \\(B P H\\) and \\(B E P\\) are similar. Hence\n\n\\[\n\\angle B P E=\\angle B H P .\n\\]\n\nThe point \\(P\\) lies between \\(D\\) and \\(C\\); this follows from the equality \\(B P^{2}=B C \\cdot B D\\). In view of this equality, and because \\(B P=B Q\\),\n\n\\[\nD P \\cdot D Q=(B P-B D) \\cdot(B P+B D)=B P^{2}-B D^{2}=B D \\cdot(B C-B D)=B D \\cdot D C .\n\\]\n\nAlso \\(A D \\cdot D H=B D \\cdot D C\\), as is seen from the similar triangles \\(B D H\\) and \\(A D C\\). Combining these equalities we obtain \\(A D \\cdot D H=D P \\cdot D Q\\). Therefore \\(D H / D P=D Q / D A\\), showing that the triangles \\(H D P\\) and \\(Q D A\\) are similar. Hence \\(\\angle H P D=\\angle Q A D\\), which can be rewritten as \\(\\angle B P H=\\angle B A D+\\angle B A Q\\). And since \\(B Q\\) is tangent to the circumcircle of triangle \\(F A Q\\),\n\n\\[\n\\angle B Q F=\\angle B A Q=\\angle B P H-\\angle B A D .\n\\]\n\nFrom (1) and (2) we deduce\n\n\\[\n\\begin{aligned}\n\\angle B P E+\\angle B Q F & =(\\angle B H P+\\angle B P H)-\\angle B A D \n=\\left(90^{\\circ}+\\angle B C A\\right)-\\left(90^{\\circ}-\\angle A B C\\right) & \\left.=\\angle B C A+\\angle A B C=180^{\\circ}-\\angle P B H\\right)-\\angle B A D\n\n\\]\n\nThus \\(\\angle B P E+\\angle B Q F<180^{\\circ}\\), which means that the rays \\(P E\\) and \\(Q F\\) meet. Let \\(S\\) be the point of intersection. Then \\(\\angle P S Q=180^{\\circ}-(\\angle B P E+\\angle B Q F)=\\angle C A B=\\angle E A F\\).\n\nIf \\(S\\) lies between \\(P\\) and \\(E\\) then \\(\\angle P S Q=180^{\\circ}-\\angle E S F\\); and if \\(E\\) lies between \\(P\\) and \\(S\\) then \\(\\angle P S Q=\\angle E S F\\). In either case the equality \\(\\angle P S Q=\\angle E A F\\) which we have obtained means that \\(S\\) lies on the circumcircle of triangle \\(A E F\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2a06c33868bd686c236cg-35}\n\nSolution 2. Let \\(H\\) be the orthocentre of triangle \\(A B C\\) and let \\(\\omega\\) be the circle with diameter \\(A H\\), passing through \\(E\\) and \\(F\\). Introduce the points of intersection of \\(\\omega\\) with the following lines emanating from \\(P: P A \\cap \\omega=\\{A, U\\}, P H \\cap \\omega=\\{H, V\\}, P E \\cap \\omega=\\{E, S\\}\\). The altitudes of triangle \\(A H P\\) are contained in the lines \\(A V, H U, B C\\), meeting at its orthocentre \\(Q^{\\prime}\\).\n\nBy Pascal's theorem applied to the (tied) hexagon \\(A E S F H V\\), the points \\(A E \\cap F H=C\\), \\(E S \\cap H V=P\\) and \\(S F \\cap V A\\) are collinear, so \\(F S\\) passes through \\(Q^{\\prime}\\).\n\nDenote by \\(\\omega_{1}\\) and \\(\\omega_{2}\\) the circles with diameters \\(B C\\) and \\(P Q^{\\prime}\\), respectively. Let \\(D\\) be the foot of the altitude from \\(A\\) in triangle \\(A B C\\). Suppose that \\(A D\\) meets the circles \\(\\omega_{1}\\) and \\(\\omega_{2}\\) at the respective points \\(K\\) and \\(L\\).\n\nSince \\(H\\) is the orthocentre of \\(A B C\\), the triangles \\(B D H\\) and \\(A D C\\) are similar, and so \\(D A \\cdot D H=D B \\cdot D C=D K^{2}\\); the last equality holds because \\(B K C\\) is a right triangle. Since \\(H\\) is the orthocentre also in triangle \\(A Q^{\\prime} P\\), we analogously have \\(D L^{2}=D A \\cdot D H\\). Therefore \\(D K=D L\\) and \\(K=L\\).\n\nAlso, \\(B D \\cdot B C=B A \\cdot B F\\), from the similar triangles \\(A B D, C B F\\). In the right triangle \\(B K C\\) we have \\(B K^{2}=B D \\cdot B C\\). Hence, and because \\(B A \\cdot B F=B P^{2}=B Q^{2}\\) (by the definition of \\(P\\) and \\(Q\\) in the problem statement), we obtain \\(B K=B P=B Q\\). It follows that \\(B\\) is the centre of \\(\\omega_{2}\\) and hence \\(Q^{\\prime}=Q\\). So the lines \\(P E\\) and \\(Q F\\) meet at the point \\(S\\) lying on the circumcircle of triangle \\(A E F\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2a06c33868bd686c236cg-36}\n\nComment 1. If \\(T\\) is the point defined by \\(P F \\cap \\omega=\\{F, T\\}\\), Pascal's theorem for the hexagon \\(A F T E H V\\) will analogously lead to the conclusion that the line \\(E T\\) goes through \\(Q^{\\prime}\\). In other words, the lines \\(P F\\) and \\(Q E\\) also concur on \\(\\omega\\).\n\nComment 2. As is known from algebraic geometry, the points of the circle \\(\\omega\\) form a commutative groups with the operation defined as follows. Choose any point \\(0 \\in \\omega\\) (to be the neutral element of the group) and a line \\(\\ell\\) exterior to the circle. For \\(X, Y \\in \\omega\\), draw the line from the point \\(X Y \\cap \\ell\\) through 0 to its second intersection with \\(\\omega\\) and define this point to be \\(X+Y\\).\n\nIn our solution we have chosen \\(H\\) to be the neutral element in this group and line \\(B C\\) to be \\(\\ell\\). The fact that the lines \\(A V, H U, E T, F S\\) are concurrent can be deduced from the identities \\(A+A=0\\), \\(F=E+A, \\quad V=U+A=S+E=T+F\\).\n\nComment 3. The problem was submitted in the following equivalent formulation:\nLet \\(B E\\) and \\(C F\\) be altitudes of an acute triangle \\(A B C\\). We choose \\(P\\) on the side \\(B C\\) and \\(Q\\) on the extension of \\(C B\\) beyond \\(B\\) such that \\(B Q^{2}=B P^{2}=B F \\cdot A B\\). If \\(Q F\\) and \\(P E\\) intersect at \\(S\\), prove that \\(E S A F\\) is cyclic."}
{"id": "imo-shortlist-2008-g5", "question": "G5. Let \\(k\\) and \\(n\\) be integers with \\(0 \\leq k \\leq n-2\\). Consider a set \\(L\\) of \\(n\\) lines in the plane such that no two of them are parallel and no three have a common point. Denote by \\(I\\) the set of intersection points of lines in \\(L\\). Let \\(O\\) be a point in the plane not lying on any line of \\(L\\).\n\nA point \\(X \\in I\\) is colored red if the open line segment \\(O X\\) intersects at most \\(k\\) lines in \\(L\\). Prove that \\(I\\) contains at least \\(\\frac{1}{2}(k+1)(k+2)\\) red points.", "category": "Geometry", "source": "IMO Shortlist", "year": 2008, "solution": "There are at least \\(\\frac{1}{2}(k+1)(k+2)\\) points in the intersection set \\(I\\) in view of the condition \\(n \\geq k+2\\).\n\nFor each point \\(P \\in I\\), define its order as the number of lines that intersect the open line segment \\(O P\\). By definition, \\(P\\) is red if its order is at most \\(k\\). Note that there is always at least one point \\(X \\in I\\) of order 0 . Indeed, the lines in \\(L\\) divide the plane into regions, bounded or not, and \\(O\\) belongs to one of them. Clearly any corner of this region is a point of \\(I\\) with order 0 .\nClaim. Suppose that two points \\(P, Q \\in I\\) lie on the same line of \\(L\\), and no other line of \\(L\\) intersects the open line segment \\(P Q\\). Then the orders of \\(P\\) and \\(Q\\) differ by at most 1 .\nProof. Let \\(P\\) and \\(Q\\) have orders \\(p\\) and \\(q\\), respectively, with \\(p \\geq q\\). Consider triangle \\(O P Q\\). Now \\(p\\) equals the number of lines in \\(L\\) that intersect the interior of side \\(O P\\). None of these lines intersects the interior of side \\(P Q\\), and at most one can pass through \\(Q\\). All remaining lines must intersect the interior of side \\(O Q\\), implying that \\(q \\geq p-1\\). The conclusion follows.\n\nWe prove the main result by induction on \\(k\\). The base \\(k=0\\) is clear since there is a point of order 0 which is red. Assuming the statement true for \\(k-1\\), we pass on to the inductive step. Select a point \\(P \\in I\\) of order 0 , and consider one of the lines \\(\\ell \\in L\\) that pass through \\(P\\). There are \\(n-1\\) intersection points on \\(\\ell\\), one of which is \\(P\\). Out of the remaining \\(n-2\\) points, the \\(k\\) closest to \\(P\\) have orders not exceeding \\(k\\) by the Claim. It follows that there are at least \\(k+1\\) red points on \\(\\ell\\).\n\nLet us now consider the situation with \\(\\ell\\) removed (together with all intersection points it contains). By hypothesis of induction, there are at least \\(\\frac{1}{2} k(k+1)\\) points of order not exceeding \\(k-1\\) in the resulting configuration. Restoring \\(\\ell\\) back produces at most one new intersection point on each line segment joining any of these points to \\(O\\), so their order is at most \\(k\\) in the original configuration. The total number of points with order not exceeding \\(k\\) is therefore at least \\((k+1)+\\frac{1}{2} k(k+1)=\\frac{1}{2}(k+1)(k+2)\\). This completes the proof.\n\nComment. The steps of the proof can be performed in reverse order to obtain a configuration of \\(n\\) lines such that equality holds simultaneously for all \\(0 \\leq k \\leq n-2\\). Such a set of lines is illustrated in the Figure.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2a06c33868bd686c236cg-37}"}
{"id": "imo-shortlist-2008-g6", "question": "G6. There is given a convex quadrilateral \\(A B C D\\). Prove that there exists a point \\(P\\) inside the quadrilateral such that\n\n\\[\n\\angle P A B+\\angle P D C=\\angle P B C+\\angle P A D=\\angle P C D+\\angle P B A=\\angle P D A+\\angle P C B=90^{\\circ}\n\\]\n\nif and only if the diagonals \\(A C\\) and \\(B D\\) are perpendicular.", "category": "Geometry", "source": "IMO Shortlist", "year": 2008, "solution": "For a point \\(P\\) in \\(A B C D\\) which satisfies (1), let \\(K, L, M, N\\) be the feet of perpendiculars from \\(P\\) to lines \\(A B, B C, C D, D A\\), respectively. Note that \\(K, L, M, N\\) are interior to the sides as all angles in (1) are acute. The cyclic quadrilaterals \\(A K P N\\) and \\(D N P M\\) give\n\n\\[\n\\angle P A B+\\angle P D C=\\angle P N K+\\angle P N M=\\angle K N M\n\\]\n\nAnalogously, \\(\\angle P B C+\\angle P A D=\\angle L K N\\) and \\(\\angle P C D+\\angle P B A=\\angle M L K\\). Hence the equalities (1) imply \\(\\angle K N M=\\angle L K N=\\angle M L K=90^{\\circ}\\), so that \\(K L M N\\) is a rectangle. The converse also holds true, provided that \\(K, L, M, N\\) are interior to sides \\(A B, B C, C D, D A\\).\n(i) Suppose that there exists a point \\(P\\) in \\(A B C D\\) such that \\(K L M N\\) is a rectangle. We show that \\(A C\\) and \\(B D\\) are parallel to the respective sides of \\(K L M N\\).\n\nLet \\(O_{A}\\) and \\(O_{C}\\) be the circumcentres of the cyclic quadrilaterals \\(A K P N\\) and \\(C M P L\\). Line \\(O_{A} O_{C}\\) is the common perpendicular bisector of \\(L M\\) and \\(K N\\), therefore \\(O_{A} O_{C}\\) is parallel to \\(K L\\) and \\(M N\\). On the other hand, \\(O_{A} O_{C}\\) is the midline in the triangle \\(A C P\\) that is parallel to \\(A C\\). Therefore the diagonal \\(A C\\) is parallel to the sides \\(K L\\) and \\(M N\\) of the rectangle. Likewise, \\(B D\\) is parallel to \\(K N\\) and \\(L M\\). Hence \\(A C\\) and \\(B D\\) are perpendicular.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2a06c33868bd686c236cg-38}\n(ii) Suppose that \\(A C\\) and \\(B D\\) are perpendicular and meet at \\(R\\). If \\(A B C D\\) is a rhombus, \\(P\\) can be chosen to be its centre. So assume that \\(A B C D\\) is not a rhombus, and let \\(B R<D R\\) without loss of generality.\n\nDenote by \\(U_{A}\\) and \\(U_{C}\\) the circumcentres of the triangles \\(A B D\\) and \\(C D B\\), respectively. Let \\(A V_{A}\\) and \\(C V_{C}\\) be the diameters through \\(A\\) and \\(C\\) of the two circumcircles. Since \\(A R\\) is an altitude in triangle \\(A D B\\), lines \\(A C\\) and \\(A V_{A}\\) are isogonal conjugates, i. e. \\(\\angle D A V_{A}=\\angle B A C\\). Now \\(B R<D R\\) implies that ray \\(A U_{A}\\) lies in \\(\\angle D A C\\). Similarly, ray \\(C U_{C}\\) lies in \\(\\angle D C A\\). Both diameters \\(A V_{A}\\) and \\(C V_{C}\\) intersect \\(B D\\) as the angles at \\(B\\) and \\(D\\) of both triangles are acute. Also \\(U_{A} U_{C}\\) is parallel to \\(A C\\) as it is the perpendicular bisector of \\(B D\\). Hence \\(V_{A} V_{C}\\) is parallel to \\(A C\\), too. We infer that \\(A V_{A}\\) and \\(C V_{C}\\) intersect at a point \\(P\\) inside triangle \\(A C D\\), hence inside \\(A B C D\\).\n\nConstruct points \\(K, L, M, N, O_{A}\\) and \\(O_{C}\\) in the same way as in the introduction. It follows from the previous paragraph that \\(K, L, M, N\\) are interior to the respective sides. Now \\(O_{A} O_{C}\\) is a midline in triangle \\(A C P\\) again. Therefore lines \\(A C, O_{A} O_{C}\\) and \\(U_{A} U_{C}\\) are parallel.\n\nThe cyclic quadrilateral \\(A K P N\\) yields \\(\\angle N K P=\\angle N A P\\). Since \\(\\angle N A P=\\angle D A U_{A}=\\) \\(\\angle B A C\\), as specified above, we obtain \\(\\angle N K P=\\angle B A C\\). Because \\(P K\\) is perpendicular to \\(A B\\), it follows that \\(N K\\) is perpendicular to \\(A C\\), hence parallel to \\(B D\\). Likewise, \\(L M\\) is parallel to \\(B D\\).\n\nConsider the two homotheties with centres \\(A\\) and \\(C\\) which transform triangles \\(A B D\\) and \\(C D B\\) into triangles \\(A K N\\) and \\(C M L\\), respectively. The images of points \\(U_{A}\\) and \\(U_{C}\\) are \\(O_{A}\\) and \\(O_{C}\\), respectively. Since \\(U_{A} U_{C}\\) and \\(O_{A} O_{C}\\) are parallel to \\(A C\\), the two ratios of homothety are the same, equal to \\(\\lambda=A N / A D=A K / A B=A O_{A} / A U_{A}=C O_{C} / C U_{C}=C M / C D=C L / C B\\). It is now straightforward that \\(D N / D A=D M / D C=B K / B A=B L / B C=1-\\lambda\\). Hence \\(K L\\) and \\(M N\\) are parallel to \\(A C\\), implying that \\(K L M N\\) is a rectangle and completing the proof.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2a06c33868bd686c236cg-39}\n\nSolution 2. For a point \\(P\\) distinct from \\(A, B, C, D\\), let circles \\((A P D)\\) and \\((B P C)\\) intersect again at \\(Q(Q=P\\) if the circles are tangent \\()\\). Next, let circles \\((A Q B)\\) and \\((C Q D)\\) intersect again at \\(R\\). We show that if \\(P\\) lies in \\(A B C D\\) and satisfies (1) then \\(A C\\) and \\(B D\\) intersect at \\(R\\) and are perpendicular; the converse is also true. It is convenient to use directed angles. Let \\(\\measuredangle(U V, X Y)\\) denote the angle of counterclockwise rotation that makes line \\(U V\\) parallel to line \\(X Y\\). Recall that four noncollinear points \\(U, V, X, Y\\) are concyclic if and only if \\(\\measuredangle(U X, V X)=\\measuredangle(U Y, V Y)\\).\n\nThe definitions of points \\(P, Q\\) and \\(R\\) imply\n\n\\[\n\\begin{aligned}\n\\measuredangle(A R, B R) & =\\measuredangle(A Q, B Q)=\\measuredangle(A Q, P Q)+\\measuredangle(P Q, B Q)=\\measuredangle(A D, P D)+\\measuredangle(P C, B C), \n\\measuredangle(C R, D R) & =\\measuredangle(C Q, D Q)=\\measuredangle(C Q, P Q)+\\measuredangle(P Q, D Q)=\\measuredangle(C B, P B)+\\measuredangle(P A, D A), \n\\measuredangle(B R, C R) & =\\measuredangle(B R, R Q)+\\measuredangle(R Q, C R)=\\measuredangle(B A, A Q)+\\measuredangle(D Q, C D) \n& =\\measuredangle(B A, A P)+\\measuredangle(A P, A Q)+\\measuredangle(D Q, D P)+\\measuredangle(D P, C D) \n& =\\measuredangle(B A, A P)+\\measuredangle(D P, C D) .\n\n\\]\n\nObserve that the whole construction is reversible. One may start with point \\(R\\), define \\(Q\\) as the second intersection of circles \\((A R B)\\) and \\((C R D)\\), and then define \\(P\\) as the second intersection of circles \\((A Q D)\\) and \\((B Q C)\\). The equalities above will still hold true.\n\nAssume in addition that \\(P\\) is interior to \\(A B C D\\). Then\n\n\\[\n\\begin{gathered}\n\\measuredangle(A D, P D)=\\angle P D A, \\measuredangle(P C, B C)=\\angle P C B, \\measuredangle(C B, P B)=\\angle P B C, \\measuredangle(P A, D A)=\\angle P A D \n\\measuredangle(B A, A P)=\\angle P A B, \\measuredangle(D P, C D)=\\angle P D C\n\n\\]\n\n(i) Suppose that \\(P\\) lies in \\(A B C D\\) and satisfies (1). Then \\(\\measuredangle(A R, B R)=\\angle P D A+\\angle P C B=90^{\\circ}\\) and similarly \\(\\measuredangle(B R, C R)=\\measuredangle(C R, D R)=90^{\\circ}\\). It follows that \\(R\\) is the common point of lines \\(A C\\) and \\(B D\\), and that these lines are perpendicular.\n(ii) Suppose that \\(A C\\) and \\(B D\\) are perpendicular and intersect at \\(R\\). We show that the point \\(P\\) defined by the reverse construction (starting with \\(R\\) and ending with \\(P\\) ) lies in \\(A B C D\\). This is enough to finish the solution, because then the angle equalities above will imply (1).\n\nOne can assume that \\(Q\\), the second common point of circles \\((A B R)\\) and \\((C D R)\\), lies in \\(\\angle A R D\\). Then in fact \\(Q\\) lies in triangle \\(A D R\\) as angles \\(A Q R\\) and \\(D Q R\\) are obtuse. Hence \\(\\angle A Q D\\) is obtuse, too, so that \\(B\\) and \\(C\\) are outside circle ( \\(A D Q\\) ) ( \\(\\angle A B D\\) and \\(\\angle A C D\\) are acute).\n\nNow \\(\\angle C A B+\\angle C D B=\\angle B Q R+\\angle C Q R=\\angle C Q B\\) implies \\(\\angle C A B<\\angle C Q B\\) and \\(\\angle C D B<\\) \\(\\angle C Q B\\). Hence \\(A\\) and \\(D\\) are outside circle ( \\(B C Q\\) ). In conclusion, the second common point \\(P\\) of circles ( \\(A D Q\\) ) and ( \\(B C Q\\) ) lies on their arcs \\(A D Q\\) and \\(B C Q\\).\n\nWe can assume that \\(P\\) lies in \\(\\angle C Q D\\). Since\n\n\\[\n\\begin{gathered}\n\\angle Q P C+\\angle Q P D=\\left(180^{\\circ}-\\angle Q B C\\right)+\\left(180^{\\circ}-\\angle Q A D\\right)= \n=360^{\\circ}-(\\angle R B C+\\angle Q B R)-(\\angle R A D-\\angle Q A R)=360^{\\circ}-\\angle R B C-\\angle R A D>180^{\\circ}\n\n\\]\n\npoint \\(P\\) lies in triangle \\(C D Q\\), and hence in \\(A B C D\\). The proof is complete.\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2a06c33868bd686c236cg-40}"}
{"id": "imo-shortlist-2008-g7", "question": "G7. Let \\(A B C D\\) be a convex quadrilateral with \\(A B \\neq B C\\). Denote by \\(\\omega_{1}\\) and \\(\\omega_{2}\\) the incircles of triangles \\(A B C\\) and \\(A D C\\). Suppose that there exists a circle \\(\\omega\\) inscribed in angle \\(A B C\\), tangent to the extensions of line segments \\(A D\\) and \\(C D\\). Prove that the common external tangents of \\(\\omega_{1}\\) and \\(\\omega_{2}\\) intersect on \\(\\omega\\).", "category": "Geometry", "source": "IMO Shortlist", "year": 2008, "solution": "The proof below is based on two known facts.\nLemma 1. Given a convex quadrilateral \\(A B C D\\), suppose that there exists a circle which is inscribed in angle \\(A B C\\) and tangent to the extensions of line segments \\(A D\\) and \\(C D\\). Then \\(A B+A D=C B+C D\\).\nProof. The circle in question is tangent to each of the lines \\(A B, B C, C D, D A\\), and the respective points of tangency \\(K, L, M, N\\) are located as with circle \\(\\omega\\) in the figure. Then\n\n\\[\nA B+A D=(B K-A K)+(A N-D N), \\quad C B+C D=(B L-C L)+(C M-D M) .\n\\]\n\nAlso \\(B K=B L, D N=D M, A K=A N, C L=C M\\) by equalities of tangents. It follows that \\(A B+A D=C B+C D\\).\n\\includegraphics[max width=\\textwidth, center]{2025_05_30_2a06c33868bd686c236cg-41}\n\nFor brevity, in the sequel we write \"excircle \\(A C\\) \" for the excircle of a triangle with side \\(A C\\) which is tangent to line segment \\(A C\\) and the extensions of the other two sides.\nLemma 2. The incircle of triangle \\(A B C\\) is tangent to its side \\(A C\\) at \\(P\\). Let \\(P P^{\\prime}\\) be the diameter of the incircle through \\(P\\), and let line \\(B P^{\\prime}\\) intersect \\(A C\\) at \\(Q\\). Then \\(Q\\) is the point of tangency of side \\(A C\\) and excircle \\(A C\\).\nProof. Let the tangent at \\(P^{\\prime}\\) to the incircle \\(\\omega_{1}\\) meet \\(B A\\) and \\(B C\\) at \\(A^{\\prime}\\) and \\(C^{\\prime}\\). Now \\(\\omega_{1}\\) is the excircle \\(A^{\\prime} C^{\\prime}\\) of triangle \\(A^{\\prime} B C^{\\prime}\\), and it touches side \\(A^{\\prime} C^{\\prime}\\) at \\(P^{\\prime}\\). Since \\(A^{\\prime} C^{\\prime} \\| A C\\), the homothety with centre \\(B\\) and ratio \\(B Q / B P^{\\prime}\\) takes \\(\\omega_{1}\\) to the excircle \\(A C\\) of triangle \\(A B C\\). Because this homothety takes \\(P^{\\prime}\\) to \\(Q\\), the lemma follows.\n\nRecall also that if the incircle of a triangle touches its side \\(A C\\) at \\(P\\), then the tangency point \\(Q\\) of the same side and excircle \\(A C\\) is the unique point on line segment \\(A C\\) such that \\(A P=C Q\\).\n\nWe pass on to the main proof. Let \\(\\omega_{1}\\) and \\(\\omega_{2}\\) touch \\(A C\\) at \\(P\\) and \\(Q\\), respectively; then \\(A P=(A C+A B-B C) / 2, C Q=(C A+C D-A D) / 2\\). Since \\(A B-B C=C D-A D\\) by Lemma 1, we obtain \\(A P=C Q\\). It follows that in triangle \\(A B C\\) side \\(A C\\) and excircle \\(A C\\) are tangent at \\(Q\\). Likewise, in triangle \\(A D C\\) side \\(A C\\) and excircle \\(A C\\) are tangent at \\(P\\). Note that \\(P \\neq Q\\) as \\(A B \\neq B C\\).\n\nLet \\(P P^{\\prime}\\) and \\(Q Q^{\\prime}\\) be the diameters perpendicular to \\(A C\\) of \\(\\omega_{1}\\) and \\(\\omega_{2}\\), respectively. Then Lemma 2 shows that points \\(B, P^{\\prime}\\) and \\(Q\\) are collinear, and so are points \\(D, Q^{\\prime}\\) and \\(P\\).\n\nConsider the diameter of \\(\\omega\\) perpendicular to \\(A C\\) and denote by \\(T\\) its endpoint that is closer to \\(A C\\). The homothety with centre \\(B\\) and ratio \\(B T / B P^{\\prime}\\) takes \\(\\omega_{1}\\) to \\(\\omega\\). Hence \\(B, P^{\\prime}\\) and \\(T\\) are collinear. Similarly, \\(D, Q^{\\prime}\\) and \\(T\\) are collinear since the homothety with centre \\(D\\) and ratio \\(-D T / D Q^{\\prime}\\) takes \\(\\omega_{2}\\) to \\(\\omega\\).\n\nWe infer that points \\(T, P^{\\prime}\\) and \\(Q\\) are collinear, as well as \\(T, Q^{\\prime}\\) and \\(P\\). Since \\(P P^{\\prime} \\| Q Q^{\\prime}\\), line segments \\(P P^{\\prime}\\) and \\(Q Q^{\\prime}\\) are then homothetic with centre \\(T\\). The same holds true for circles \\(\\omega_{1}\\) and \\(\\omega_{2}\\) because they have \\(P P^{\\prime}\\) and \\(Q Q^{\\prime}\\) as diameters. Moreover, it is immediate that \\(T\\) lies on the same side of line \\(P P^{\\prime}\\) as \\(Q\\) and \\(Q^{\\prime}\\), hence the ratio of homothety is positive. In particular \\(\\omega_{1}\\) and \\(\\omega_{2}\\) are not congruent.\n\nIn summary, \\(T\\) is the centre of a homothety with positive ratio that takes circle \\(\\omega_{1}\\) to circle \\(\\omega_{2}\\). This completes the solution, since the only point with the mentioned property is the intersection of the the common external tangents of \\(\\omega_{1}\\) and \\(\\omega_{2}\\)."}
{"id": "imo-shortlist-2008-n1", "question": "N1. Let \\(n\\) be a positive integer and let \\(p\\) be a prime number. Prove that if \\(a, b, c\\) are integers (not necessarily positive) satisfying the equations\n\n\\[\na^{n}+p b=b^{n}+p c=c^{n}+p a\n\\]\n\nthen \\(a=b=c\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2008, "solution": "If two of \\(a, b, c\\) are equal, it is immediate that all the three are equal. So we may assume that \\(a \\neq b \\neq c \\neq a\\). Subtracting the equations we get \\(a^{n}-b^{n}=-p(b-c)\\) and two cyclic copies of this equation, which upon multiplication yield\n\n\\[\n\\frac{a^{n}-b^{n}}{a-b} \\cdot \\frac{b^{n}-c^{n}}{b-c} \\cdot \\frac{c^{n}-a^{n}}{c-a}=-p^{3}\n\\]\n\nIf \\(n\\) is odd then the differences \\(a^{n}-b^{n}\\) and \\(a-b\\) have the same sign and the product on the left is positive, while \\(-p^{3}\\) is negative. So \\(n\\) must be even.\n\nLet \\(d\\) be the greatest common divisor of the three differences \\(a-b, b-c, c-a\\), so that \\(a-b=d u, b-c=d v, c-a=d w ; \\operatorname{gcd}(u, v, w)=1, u+v+w=0\\).\n\nFrom \\(a^{n}-b^{n}=-p(b-c)\\) we see that \\((a-b) \\mid p(b-c)\\), i.e., \\(u \\mid p v\\); and cyclically \\(v|p w, w| p u\\). As \\(\\operatorname{gcd}(u, v, w)=1\\) and \\(u+v+w=0\\), at most one of \\(u, v, w\\) can be divisible by \\(p\\). Supposing that the prime \\(p\\) does not divide any one of them, we get \\(u|v, v| w, w \\mid u\\), whence \\(|u|=|v|=|w|=1\\); but this quarrels with \\(u+v+w=0\\).\n\nThus \\(p\\) must divide exactly one of these numbers. Let e.g. \\(p \\mid u\\) and write \\(u=p u_{1}\\). Now we obtain, similarly as before, \\(u_{1}|v, v| w, w \\mid u_{1}\\) so that \\(\\left|u_{1}\\right|=|v|=|w|=1\\). The equation \\(p u_{1}+v+w=0\\) forces that the prime \\(p\\) must be even; i.e. \\(p=2\\). Hence \\(v+w=-2 u_{1}= \\pm 2\\), implying \\(v=w(= \\pm 1)\\) and \\(u=-2 v\\). Consequently \\(a-b=-2(b-c)\\).\n\nKnowing that \\(n\\) is even, say \\(n=2 k\\), we rewrite the equation \\(a^{n}-b^{n}=-p(b-c)\\) with \\(p=2\\) in the form\n\n\\[\n\\left(a^{k}+b^{k}\\right)\\left(a^{k}-b^{k}\\right)=-2(b-c)=a-b\n\\]\n\nThe second factor on the left is divisible by \\(a-b\\), so the first factor ( \\(a^{k}+b^{k}\\) ) must be \\(\\pm 1\\). Then exactly one of \\(a\\) and \\(b\\) must be odd; yet \\(a-b=-2(b-c)\\) is even. Contradiction ends the proof.\n\nSolution 2. The beginning is as in the first solution. Assuming that \\(a, b, c\\) are not all equal, hence are all distinct, we derive equation (1) with the conclusion that \\(n\\) is even. Write \\(n=2 k\\).\n\nSuppose that \\(p\\) is odd. Then the integer\n\n\\[\n\\frac{a^{n}-b^{n}}{a-b}=a^{n-1}+a^{n-2} b+\\cdots+b^{n-1}\n\\]\n\nwhich is a factor in (1), must be odd as well. This sum of \\(n=2 k\\) summands is odd only if \\(a\\) and \\(b\\) have different parities. The same conclusion holding for \\(b, c\\) and for \\(c, a\\), we get that \\(a, b, c, a\\) alternate in their parities, which is clearly impossible.\n\nThus \\(p=2\\). The original system shows that \\(a, b, c\\) must be of the same parity. So we may divide (1) by \\(p^{3}\\), i.e. \\(2^{3}\\), to obtain the following product of six integer factors:\n\n\\[\n\\frac{a^{k}+b^{k}}{2} \\cdot \\frac{a^{k}-b^{k}}{a-b} \\cdot \\frac{b^{k}+c^{k}}{2} \\cdot \\frac{b^{k}-c^{k}}{b-c} \\cdot \\frac{c^{k}+a^{k}}{2} \\cdot \\frac{c^{k}-a^{k}}{c-a}=-1 .\n\\]\n\nEach one of the factors must be equal to \\(\\pm 1\\). In particular, \\(a^{k}+b^{k}= \\pm 2\\). If \\(k\\) is even, this becomes \\(a^{k}+b^{k}=2\\) and yields \\(|a|=|b|=1\\), whence \\(a^{k}-b^{k}=0\\), contradicting (2).\n\nLet now \\(k\\) be odd. Then the sum \\(a^{k}+b^{k}\\), with value \\(\\pm 2\\), has \\(a+b\\) as a factor. Since \\(a\\) and \\(b\\) are of the same parity, this means that \\(a+b= \\pm 2\\); and cyclically, \\(b+c= \\pm 2, c+a= \\pm 2\\). In some two of these equations the signs must coincide, hence some two of \\(a, b, c\\) are equal. This is the desired contradiction.\n\nComment. Having arrived at the equation (1) one is tempted to write down all possible decompositions of \\(-p^{3}\\) (cube of a prime) into a product of three integers. This leads to cumbersome examination of many cases, some of which are unpleasant to handle. One may do that just for \\(p=2\\), having earlier in some way eliminated odd primes from consideration.\n\nHowever, the second solution shows that the condition of \\(p\\) being a prime is far too strong. What is actually being used in that solution, is that \\(p\\) is either a positive odd integer or \\(p=2\\)."}
{"id": "imo-shortlist-2008-n2", "question": "N2. Let \\(a_{1}, a_{2}, \\ldots, a_{n}\\) be distinct positive integers, \\(n \\geq 3\\). Prove that there exist distinct indices \\(i\\) and \\(j\\) such that \\(a_{i}+a_{j}\\) does not divide any of the numbers \\(3 a_{1}, 3 a_{2}, \\ldots, 3 a_{n}\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2008, "solution": "Without loss of generality, let \\(0<a_{1}<a_{2}<\\cdots<a_{n}\\). One can also assume that \\(a_{1}, a_{2}, \\ldots, a_{n}\\) are coprime. Otherwise division by their greatest common divisor reduces the question to the new sequence whose terms are coprime integers.\n\nSuppose that the claim is false. Then for each \\(i<n\\) there exists a \\(j\\) such that \\(a_{n}+a_{i}\\) divides \\(3 a_{j}\\). If \\(a_{n}+a_{i}\\) is not divisible by 3 then \\(a_{n}+a_{i}\\) divides \\(a_{j}\\) which is impossible as \\(0<a_{j} \\leq a_{n}<a_{n}+a_{i}\\). Thus \\(a_{n}+a_{i}\\) is a multiple of 3 for \\(i=1, \\ldots, n-1\\), so that \\(a_{1}, a_{2}, \\ldots, a_{n-1}\\) are all congruent (to \\(-a_{n}\\) ) modulo 3 .\n\nNow \\(a_{n}\\) is not divisible by 3 or else so would be all remaining \\(a_{i}\\) 's, meaning that \\(a_{1}, a_{2}, \\ldots, a_{n}\\) are not coprime. Hence \\(a_{n} \\equiv r(\\bmod 3)\\) where \\(r \\in\\{1,2\\}\\), and \\(a_{i} \\equiv 3-r(\\bmod 3)\\) for all \\(i=1, \\ldots, n-1\\).\n\nConsider a sum \\(a_{n-1}+a_{i}\\) where \\(1 \\leq i \\leq n-2\\). There is at least one such sum as \\(n \\geq 3\\). Let \\(j\\) be an index such that \\(a_{n-1}+a_{i}\\) divides \\(3 a_{j}\\). Observe that \\(a_{n-1}+a_{i}\\) is not divisible by 3 since \\(a_{n-1}+a_{i} \\equiv 2 a_{i} \\not \\equiv 0(\\bmod 3)\\). It follows that \\(a_{n-1}+a_{i}\\) divides \\(a_{j}\\), in particular \\(a_{n-1}+a_{i} \\leq a_{j}\\). Hence \\(a_{n-1}<a_{j} \\leq a_{n}\\), implying \\(j=n\\). So \\(a_{n}\\) is divisible by all sums \\(a_{n-1}+a_{i}, 1 \\leq i \\leq n-2\\). In particular \\(a_{n-1}+a_{i} \\leq a_{n}\\) for \\(i=1, \\ldots, n-2\\).\n\nLet \\(j\\) be such that \\(a_{n}+a_{n-1}\\) divides \\(3 a_{j}\\). If \\(j \\leq n-2\\) then \\(a_{n}+a_{n-1} \\leq 3 a_{j}<a_{j}+2 a_{n-1}\\). This yields \\(a_{n}<a_{n-1}+a_{j}\\); however \\(a_{n-1}+a_{j} \\leq a_{n}\\) for \\(j \\leq n-2\\). Therefore \\(j=n-1\\) or \\(j=n\\).\n\nFor \\(j=n-1\\) we obtain \\(3 a_{n-1}=k\\left(a_{n}+a_{n-1}\\right)\\) with \\(k\\) an integer, and it is straightforward that \\(k=1\\left(k \\leq 0\\right.\\) and \\(k \\geq 3\\) contradict \\(0<a_{n-1}<a_{n} ; k=2\\) leads to \\(\\left.a_{n-1}=2 a_{n}>a_{n-1}\\right)\\). Thus \\(3 a_{n-1}=a_{n}+a_{n-1}\\), i. e. \\(a_{n}=2 a_{n-1}\\).\n\nSimilarly, if \\(j=n\\) then \\(3 a_{n}=k\\left(a_{n}+a_{n-1}\\right)\\) for some integer \\(k\\), and only \\(k=2\\) is possible. Hence \\(a_{n}=2 a_{n-1}\\) holds true in both cases remaining, \\(j=n-1\\) and \\(j=n\\).\n\nNow \\(a_{n}=2 a_{n-1}\\) implies that the sum \\(a_{n-1}+a_{1}\\) is strictly between \\(a_{n} / 2\\) and \\(a_{n}\\). But \\(a_{n-1}\\) and \\(a_{1}\\) are distinct as \\(n \\geq 3\\), so it follows from the above that \\(a_{n-1}+a_{1}\\) divides \\(a_{n}\\). This provides the desired contradiction."}
{"id": "imo-shortlist-2008-n3", "question": "N3. Let \\(a_{0}, a_{1}, a_{2}, \\ldots\\) be a sequence of positive integers such that the greatest common divisor of any two consecutive terms is greater than the preceding term; in symbols, \\(\\operatorname{gcd}\\left(a_{i}, a_{i+1}\\right)>a_{i-1}\\). Prove that \\(a_{n} \\geq 2^{n}\\) for all \\(n \\geq 0\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2008, "solution": "Since \\(a_{i} \\geq \\operatorname{gcd}\\left(a_{i}, a_{i+1}\\right)>a_{i-1}\\), the sequence is strictly increasing. In particular \\(a_{0} \\geq 1, a_{1} \\geq 2\\). For each \\(i \\geq 1\\) we also have \\(a_{i+1}-a_{i} \\geq \\operatorname{gcd}\\left(a_{i}, a_{i+1}\\right)>a_{i-1}\\), and consequently \\(a_{i+1} \\geq a_{i}+a_{i-1}+1\\). Hence \\(a_{2} \\geq 4\\) and \\(a_{3} \\geq 7\\). The equality \\(a_{3}=7\\) would force equalities in the previous estimates, leading to \\(\\operatorname{gcd}\\left(a_{2}, a_{3}\\right)=\\operatorname{gcd}(4,7)>a_{1}=2\\), which is false. Thus \\(a_{3} \\geq 8\\); the result is valid for \\(n=0,1,2,3\\). These are the base cases for a proof by induction.\n\nTake an \\(n \\geq 3\\) and assume that \\(a_{i} \\geq 2^{i}\\) for \\(i=0,1, \\ldots, n\\). We must show that \\(a_{n+1} \\geq 2^{n+1}\\). Let \\(\\operatorname{gcd}\\left(a_{n}, a_{n+1}\\right)=d\\). We know that \\(d>a_{n-1}\\). The induction claim is reached immediately in the following cases:\n\n\\[\n\\begin{array}{ll}\n\\text { if } a_{n+1} \\geq 4 d & \\text { then } a_{n+1}>4 a_{n-1} \\geq 4 \\cdot 2^{n-1}=2^{n+1} \n\\text { if } a_{n} \\geq 3 d & \\text { then } a_{n+1} \\geq a_{n}+d \\geq 4 d>4 a_{n-1} \\geq 4 \\cdot 2^{n-1}=2^{n+1} \n\\text { if } a_{n}=d & \\text { then } a_{n+1} \\geq a_{n}+d=2 a_{n} \\geq 2 \\cdot 2^{n}=2^{n+1}\n\n\\]\n\nThe only remaining possibility is that \\(a_{n}=2 d\\) and \\(a_{n+1}=3 d\\), which we assume for the sequel. So \\(a_{n+1}=\\frac{3}{2} a_{n}\\).\n\nLet now \\(\\operatorname{gcd}\\left(a_{n-1}, a_{n}\\right)=d^{\\prime}\\); then \\(d^{\\prime}>a_{n-2}\\). Write \\(a_{n}=m d^{\\prime}\\) ( \\(m\\) an integer). Keeping in mind that \\(d^{\\prime} \\leq a_{n-1}<d\\) and \\(a_{n}=2 d\\), we get that \\(m \\geq 3\\). Also \\(a_{n-1}<d=\\frac{1}{2} m d^{\\prime}\\), \\(a_{n+1}=\\frac{3}{2} m d^{\\prime}\\). Again we single out the cases which imply the induction claim immediately:\n\n\\[\n\\begin{aligned}\n& \\text { if } m \\geq 6 \\quad \\text { then } \\quad a_{n+1}=\\frac{3}{2} m d^{\\prime} \\geq 9 d^{\\prime}>9 a_{n-2} \\geq 9 \\cdot 2^{n-2}>2^{n+1} ; \n& \\text { if } 3 \\leq m \\leq 4 \\text { then } \\quad a_{n-1}<\\frac{1}{2} \\cdot 4 d^{\\prime}, \\text { and hence } a_{n-1}=d^{\\prime} \n& \\qquad a_{n+1}=\\frac{3}{2} m a_{n-1} \\geq \\frac{3}{2} \\cdot 3 a_{n-1} \\geq \\frac{9}{2} \\cdot 2^{n-1}>2^{n+1}\n\n\\]\n\nSo we are left with the case \\(m=5\\), which means that \\(a_{n}=5 d^{\\prime}, a_{n+1}=\\frac{15}{2} d^{\\prime}, a_{n-1}<d=\\frac{5}{2} d^{\\prime}\\). The last relation implies that \\(a_{n-1}\\) is either \\(d^{\\prime}\\) or \\(2 d^{\\prime}\\). Anyway, \\(a_{n-1} \\mid 2 d^{\\prime}\\).\n\nThe same pattern repeats once more. We denote \\(\\operatorname{gcd}\\left(a_{n-2}, a_{n-1}\\right)=d^{\\prime \\prime}\\); then \\(d^{\\prime \\prime}>a_{n-3}\\). Because \\(d^{\\prime \\prime}\\) is a divisor of \\(a_{n-1}\\), hence also of \\(2 d^{\\prime}\\), we may write \\(2 d^{\\prime}=m^{\\prime} d^{\\prime \\prime}\\) ( \\(m^{\\prime}\\) an integer). Since \\(d^{\\prime \\prime} \\leq a_{n-2}<d^{\\prime}\\), we get \\(m^{\\prime} \\geq 3\\). Also, \\(a_{n-2}<d^{\\prime}=\\frac{1}{2} m^{\\prime} d^{\\prime \\prime}, a_{n+1}=\\frac{15}{2} d^{\\prime}=\\frac{15}{4} m^{\\prime} d^{\\prime \\prime}\\). As before, we consider the cases:\n\n\\[\n\\begin{aligned}\n& \\text { if } m^{\\prime} \\geq 5 \\quad \\text { then } a_{n+1}=\\frac{15}{4} m^{\\prime} d^{\\prime \\prime} \\geq \\frac{75}{4} d^{\\prime \\prime}>\\frac{75}{4} a_{n-3} \\geq \\frac{75}{4} \\cdot 2^{n-3}>2^{n+1} ; \n& \\text { if } 3 \\leq m^{\\prime} \\leq 4 \\text { then } a_{n-2}<\\frac{1}{2} \\cdot 4 d^{\\prime \\prime}, \\text { and hence } a_{n-2}=d^{\\prime \\prime}, \n& \\qquad a_{n+1}=\\frac{15}{4} m^{\\prime} a_{n-2} \\geq \\frac{15}{4} \\cdot 3 a_{n-2} \\geq \\frac{45}{4} \\cdot 2^{n-2}>2^{n+1} .\n\n\\]\n\nBoth of them have produced the induction claim. But now there are no cases left. Induction is complete; the inequality \\(a_{n} \\geq 2^{n}\\) holds for all \\(n\\)."}
{"id": "imo-shortlist-2008-n4", "question": "N4. Let \\(n\\) be a positive integer. Show that the numbers\n\n\\[\n\\binom{2^{n}-1}{0}, \\quad\\binom{2^{n}-1}{1}, \\quad\\binom{2^{n}-1}{2}, \\quad \\ldots, \\quad\\binom{2^{n}-1}{2^{n-1}-1}\n\\]\n\nare congruent modulo \\(2^{n}\\) to \\(1,3,5, \\ldots, 2^{n}-1\\) in some order.", "category": "Number Theory", "source": "IMO Shortlist", "year": 2008, "solution": "It is well-known that all these numbers are odd. So the assertion that their remainders ( \\(\\bmod 2^{n}\\) ) make up a permutation of \\(\\left\\{1,3, \\ldots, 2^{n}-1\\right\\}\\) is equivalent just to saying that these remainders are all distinct. We begin by showing that\n\n\\[\n\\binom{2^{n}-1}{2 k}+\\binom{2^{n}-1}{2 k+1} \\equiv 0 \\quad\\left(\\bmod 2^{n}\\right) \\quad \\text { and } \\quad\\binom{2^{n}-1}{2 k} \\equiv(-1)^{k}\\binom{2^{n-1}-1}{k} \\quad\\left(\\bmod 2^{n}\\right)\n\\]\n\nThe first relation is immediate, as the sum on the left is equal to \\(\\binom{2^{n}}{2 k+1}=\\frac{2^{n}}{2 k+1}\\binom{2^{n}-1}{2 k}\\), hence is divisible by \\(2^{n}\\). The second relation:\n\n\\[\n\\binom{2^{n}-1}{2 k}=\\prod_{j=1}^{2 k} \\frac{2^{n}-j}{j}=\\prod_{i=1}^{k} \\frac{2^{n}-(2 i-1)}{2 i-1} \\cdot \\prod_{i=1}^{k} \\frac{2^{n-1}-i}{i} \\equiv(-1)^{k}\\binom{2^{n-1}-1}{k} \\quad\\left(\\bmod 2^{n}\\right)\n\\]\n\nThis prepares ground for a proof of the required result by induction on \\(n\\). The base case \\(n=1\\) is obvious. Assume the assertion is true for \\(n-1\\) and pass to \\(n\\), denoting \\(a_{k}=\\binom{2^{n-1}-1}{k}\\), \\(b_{m}=\\binom{2^{n}-1}{m}\\). The induction hypothesis is that all the numbers \\(a_{k}\\left(0 \\leq k<2^{n-2}\\right)\\) are distinct \\(\\left(\\bmod 2^{n-1}\\right)\\); the claim is that all the numbers \\(b_{m}\\left(0 \\leq m<2^{n-1}\\right)\\) are distinct ( \\(\\bmod 2^{n}\\) ).\n\nThe congruence relations (1) are restated as\n\n\\[\nb_{2 k} \\equiv(-1)^{k} a_{k} \\equiv-b_{2 k+1} \\quad\\left(\\bmod 2^{n}\\right)\n\\]\n\nShifting the exponent in the first relation of (1) from \\(n\\) to \\(n-1\\) we also have the congruence \\(a_{2 i+1} \\equiv-a_{2 i}\\left(\\bmod 2^{n-1}\\right)\\). We hence conclude:\n\n\\[\n\\text { If, for some } j, k<2^{n-2}, \\quad a_{k} \\equiv-a_{j}\\left(\\bmod 2^{n-1}\\right), \\text { then }\\{j, k\\}=\\{2 i, 2 i+1\\} \\text { for some } i \\text {. }\n\\]\n\nThis is so because in the sequence ( \\(a_{k}: k<2^{n-2}\\) ) each term \\(a_{j}\\) is complemented to \\(0\\left(\\bmod 2^{n-1}\\right)\\) by only one other term \\(a_{k}\\), according to the induction hypothesis.\n\nFrom (2) we see that \\(b_{4 i} \\equiv a_{2 i}\\) and \\(b_{4 i+3} \\equiv a_{2 i+1}\\left(\\bmod 2^{n}\\right)\\). Let\n\n\\[\nM=\\left\\{m: 0 \\leq m<2^{n-1}, m \\equiv 0 \\text { or } 3(\\bmod 4)\\right\\}, \\quad L=\\left\\{l: 0 \\leq l<2^{n-1}, l \\equiv 1 \\text { or } 2(\\bmod 4)\\right\\}\n\\]\n\nThe last two congruences take on the unified form\n\n\\[\nb_{m} \\equiv a_{\\lfloor m / 2\\rfloor} \\quad\\left(\\bmod 2^{n}\\right) \\quad \\text { for all } \\quad m \\in M\n\\]\n\nThus all the numbers \\(b_{m}\\) for \\(m \\in M\\) are distinct ( \\(\\bmod 2^{n}\\) ) because so are the numbers \\(a_{k}\\) (they are distinct \\(\\left(\\bmod 2^{n-1}\\right)\\), hence also \\(\\left(\\bmod 2^{n}\\right)\\) ).\n\nEvery \\(l \\in L\\) is paired with a unique \\(m \\in M\\) into a pair of the form \\(\\{2 k, 2 k+1\\}\\). So (2) implies that also all the \\(b_{l}\\) for \\(l \\in L\\) are distinct ( \\(\\bmod 2^{n}\\) ). It remains to eliminate the possibility that \\(b_{m} \\equiv b_{l}\\left(\\bmod 2^{n}\\right)\\) for some \\(m \\in M, l \\in L\\).\n\nSuppose that such a situation occurs. Let \\(m^{\\prime} \\in M\\) be such that \\(\\left\\{m^{\\prime}, l\\right\\}\\) is a pair of the form \\(\\{2 k, 2 k+1\\}\\), so that (see (2)) \\(\\quad b_{m^{\\prime}} \\equiv-b_{l}\\left(\\bmod 2^{n}\\right)\\). Hence \\(b_{m^{\\prime}} \\equiv-b_{m}\\left(\\bmod 2^{n}\\right)\\). Since both \\(m^{\\prime}\\) and \\(m\\) are in \\(M\\), we have by (4) \\(b_{m^{\\prime}} \\equiv a_{j}, b_{m} \\equiv a_{k}\\left(\\bmod 2^{n}\\right)\\) for \\(j=\\left\\lfloor m^{\\prime} / 2\\right\\rfloor, k=\\lfloor m / 2\\rfloor\\).\n\nThen \\(a_{j} \\equiv-a_{k}\\left(\\bmod 2^{n}\\right)\\). Thus, according to (3), \\(j=2 i, k=2 i+1\\) for some \\(i\\) (or vice versa). The equality \\(a_{2 i+1} \\equiv-a_{2 i}\\left(\\bmod 2^{n}\\right)\\) now means that \\(\\binom{2^{n-1}-1}{2 i}+\\binom{2^{n-1}-1}{2 i+1} \\equiv 0\\left(\\bmod 2^{n}\\right)\\). However, the sum on the left is equal to \\(\\binom{2^{n-1}}{2 i+1}\\). A number of this form cannot be divisible by \\(2^{n}\\). This is a contradiction which concludes the induction step and proves the result.\n\nSolution 2. We again proceed by induction, writing for brevity \\(N=2^{n-1}\\) and keeping notation \\(a_{k}=\\binom{N-1}{k}, b_{m}=\\binom{2 N-1}{m}\\). Assume that the result holds for the sequence \\(\\left(a_{0}, a_{1}, a_{2}, \\ldots, a_{N / 2-1}\\right)\\). In view of the symmetry \\(a_{N-1-k}=a_{k}\\) this sequence is a permutation of ( \\(a_{0}, a_{2}, a_{4}, \\ldots, a_{N-2}\\) ). So the induction hypothesis says that this latter sequence, taken \\((\\bmod N)\\), is a permutation of \\((1,3,5, \\ldots, N-1)\\). Similarly, the induction claim is that \\(\\left(b_{0}, b_{2}, b_{4}, \\ldots, b_{2 N-2}\\right)\\), taken \\((\\bmod 2 N)\\), is a permutation of \\((1,3,5, \\ldots, 2 N-1)\\).\n\nIn place of the congruence relations (2) we now use the following ones,\n\n\\[\nb_{4 i} \\equiv a_{2 i} \\quad(\\bmod N) \\quad \\text { and } \\quad b_{4 i+2} \\equiv b_{4 i}+N \\quad(\\bmod 2 N)\n\\]\n\nGiven this, the conclusion is immediate: the first formula of (5) together with the induction hypothesis tells us that \\(\\left(b_{0}, b_{4}, b_{8}, \\ldots, b_{2 N-4}\\right)(\\bmod N)\\) is a permutation of \\((1,3,5, \\ldots, N-1)\\). Then the second formula of (5) shows that ( \\(b_{2}, b_{6}, b_{10}, \\ldots, b_{2 N-2}\\) ) ( \\(\\bmod N\\) ) is exactly the same permutation; moreover, this formula distinguishes \\((\\bmod 2 N)\\) each \\(b_{4 i}\\) from \\(b_{4 i+2}\\).\n\nConsequently, these two sequences combined represent (mod \\(2 N\\) ) a permutation of the sequence \\((1,3,5, \\ldots, N-1, N+1, N+3, N+5, \\ldots, N+N-1)\\), and this is precisely the induction claim.\n\nNow we prove formulas (5); we begin with the second one. Since \\(b_{m+1}=b_{m} \\cdot \\frac{2 N-m-1}{m+1}\\),\n\n\\[\nb_{4 i+2}=b_{4 i} \\cdot \\frac{2 N-4 i-1}{4 i+1} \\cdot \\frac{2 N-4 i-2}{4 i+2}=b_{4 i} \\cdot \\frac{2 N-4 i-1}{4 i+1} \\cdot \\frac{N-2 i-1}{2 i+1} .\n\\]\n\nThe desired congruence \\(b_{4 i+2} \\equiv b_{4 i}+N\\) may be multiplied by the odd number \\((4 i+1)(2 i+1)\\), giving rise to a chain of successively equivalent congruences:\n\n\\[\n\\begin{aligned}\nb_{4 i}(2 N-4 i-1)(N-2 i-1) & \\equiv\\left(b_{4 i}+N\\right)(4 i+1)(2 i+1) & & (\\bmod 2 N) \nb_{4 i}(2 i+1-N) & \\equiv\\left(b_{4 i}+N\\right)(2 i+1) & & (\\bmod 2 N) \n\\left(b_{4 i}+2 i+1\\right) N & \\equiv 0 & & (\\bmod 2 N)\n\n\\]\n\nand the last one is satisfied, as \\(b_{4 i}\\) is odd. This settles the second relation in (5).\nThe first one is proved by induction on \\(i\\). It holds for \\(i=0\\). Assume \\(b_{4 i} \\equiv a_{2 i}(\\bmod 2 N)\\) and consider \\(i+1\\) :\n\n\\[\nb_{4 i+4}=b_{4 i+2} \\cdot \\frac{2 N-4 i-3}{4 i+3} \\cdot \\frac{2 N-4 i-4}{4 i+4} ; \\quad a_{2 i+2}=a_{2 i} \\cdot \\frac{N-2 i-1}{2 i+1} \\cdot \\frac{N-2 i-2}{2 i+2} .\n\\]\n\nBoth expressions have the fraction \\(\\frac{N-2 i-2}{2 i+2}\\) as the last factor. Since \\(2 i+2<N=2^{n-1}\\), this fraction reduces to \\(\\ell / m\\) with \\(\\ell\\) and \\(m\\) odd. In showing that \\(b_{4 i+4} \\equiv a_{2 i+2}(\\bmod 2 N)\\), we may ignore this common factor \\(\\ell / m\\). Clearing other odd denominators reduces the claim to\n\n\\[\nb_{4 i+2}(2 N-4 i-3)(2 i+1) \\equiv a_{2 i}(N-2 i-1)(4 i+3) \\quad(\\bmod 2 N)\n\\]\n\nBy the inductive assumption (saying that \\(b_{4 i} \\equiv a_{2 i}(\\bmod 2 N)\\) ) and by the second relation of (5), this is equivalent to\n\n\\[\n\\left(b_{4 i}+N\\right)(2 i+1) \\equiv b_{4 i}(2 i+1-N) \\quad(\\bmod 2 N)\n\\]\n\na congruence which we have already met in the preceding proof a few lines above. This completes induction (on \\(i\\) ) and the proof of (5), hence also the whole solution.\n\nComment. One can avoid the words congruent modulo in the problem statement by rephrasing the assertion into: Show that these numbers leave distinct remainders in division by \\(2^{n}\\)."}
{"id": "imo-shortlist-2008-n5", "question": "N5. For every \\(n \\in \\mathbb{N}\\) let \\(d(n)\\) denote the number of (positive) divisors of \\(n\\). Find all functions \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}\\) with the following properties:\n(i) \\(d(f(x))=x\\) for all \\(x \\in \\mathbb{N}\\);\n(ii) \\(f(x y)\\) divides \\((x-1) y^{x y-1} f(x)\\) for all \\(x, y \\in \\mathbb{N}\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2008, "solution": "There is a unique solution: the function \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}\\) defined by \\(f(1)=1\\) and\n\n\\[\nf(n)=p_{1}^{p_{1}^{a_{1}}-1} p_{2}^{p_{2}^{a_{2}}-1} \\cdots p_{k}^{p_{k}^{a_{k}}-1} \\text { where } n=p_{1}^{a_{1}} p_{2}^{a_{2}} \\cdots p_{k}^{a_{k}} \\text { is the prime factorization of } n>1 .\n\\]\n\nDirect verification shows that this function meets the requirements.\nConversely, let \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}\\) satisfy (i) and (ii). Applying (i) for \\(x=1\\) gives \\(d(f(1))=1\\), so \\(f(1)=1\\). In the sequel we prove that (1) holds for all \\(n>1\\). Notice that \\(f(m)=f(n)\\) implies \\(m=n\\) in view of (i). The formula \\(d\\left(p_{1}^{b_{1}} \\cdots p_{k}^{b_{k}}\\right)=\\left(b_{1}+1\\right) \\cdots\\left(b_{k}+1\\right)\\) will be used throughout.\n\nLet \\(p\\) be a prime. Since \\(d(f(p))=p\\), the formula just mentioned yields \\(f(p)=q^{p-1}\\) for some prime \\(q\\); in particular \\(f(2)=q^{2-1}=q\\) is a prime. We prove that \\(f(p)=p^{p-1}\\) for all primes \\(p\\).\n\nSuppose that \\(p\\) is odd and \\(f(p)=q^{p-1}\\) for a prime \\(q\\). Applying (ii) first with \\(x=2\\), \\(y=p\\) and then with \\(x=p, y=2\\) shows that \\(f(2 p)\\) divides both \\((2-1) p^{2 p-1} f(2)=p^{2 p-1} f(2)\\) and \\((p-1) 2^{2 p-1} f(p)=(p-1) 2^{2 p-1} q^{p-1}\\). If \\(q \\neq p\\) then the odd prime \\(p\\) does not divide \\((p-1) 2^{2 p-1} q^{p-1}\\), hence the greatest common divisor of \\(p^{2 p-1} f(2)\\) and \\((p-1) 2^{2 p-1} q^{p-1}\\) is a divisor of \\(f(2)\\). Thus \\(f(2 p)\\) divides \\(f(2)\\) which is a prime. As \\(f(2 p)>1\\), we obtain \\(f(2 p)=f(2)\\) which is impossible. So \\(q=p\\), i. e. \\(f(p)=p^{p-1}\\).\n\nFor \\(p=2\\) the same argument with \\(x=2, y=3\\) and \\(x=3, y=2\\) shows that \\(f(6)\\) divides both \\(3^{5} f(2)\\) and \\(2^{6} f(3)=2^{6} 3^{2}\\). If the prime \\(f(2)\\) is odd then \\(f(6)\\) divides \\(3^{2}=9\\), so \\(f(6) \\in\\{1,3,9\\}\\). However then \\(6=d(f(6)) \\in\\{d(1), d(3), d(9)\\}=\\{1,2,3\\}\\) which is false. In conclusion \\(f(2)=2\\).\n\nNext, for each \\(n>1\\) the prime divisors of \\(f(n)\\) are among the ones of \\(n\\). Indeed, let \\(p\\) be the least prime divisor of \\(n\\). Apply (ii) with \\(x=p\\) and \\(y=n / p\\) to obtain that \\(f(n)\\) divides \\((p-1) y^{n-1} f(p)=(p-1) y^{n-1} p^{p-1}\\). Write \\(f(n)=\\ell P\\) where \\(\\ell\\) is coprime to \\(n\\) and \\(P\\) is a product of primes dividing \\(n\\). Since \\(\\ell\\) divides \\((p-1) y^{n-1} p^{p-1}\\) and is coprime to \\(y^{n-1} p^{p-1}\\), it divides \\(p-1\\); hence \\(d(\\ell) \\leq \\ell<p\\). But (i) gives \\(n=d(f(n))=d(\\ell P)\\), and \\(d(\\ell P)=d(\\ell) d(P)\\) as \\(\\ell\\) and \\(P\\) are coprime. Therefore \\(d(\\ell)\\) is a divisor of \\(n\\) less than \\(p\\), meaning that \\(\\ell=1\\) and proving the claim.\n\nNow (1) is immediate for prime powers. If \\(p\\) is a prime and \\(a \\geq 1\\), by the above the only prime factor of \\(f\\left(p^{a}\\right)\\) is \\(p\\) (a prime factor does exist as \\(f\\left(p^{a}\\right)>1\\) ). So \\(f\\left(p^{a}\\right)=p^{b}\\) for some \\(b \\geq 1\\), and (i) yields \\(p^{a}=d\\left(f\\left(p^{a}\\right)\\right)=d\\left(p^{b}\\right)=b+1\\). Hence \\(f\\left(p^{a}\\right)=p^{p^{a}-1}\\), as needed.\n\nLet us finally show that (1) is true for a general \\(n>1\\) with prime factorization \\(n=p_{1}^{a_{1}} \\cdots p_{k}^{a_{k}}\\). We saw that the prime factorization of \\(f(n)\\) has the form \\(f(n)=p_{1}^{b_{1}} \\cdots p_{k}^{b_{k}}\\). For \\(i=1, \\ldots, k\\), set \\(x=p_{i}^{a_{i}}\\) and \\(y=n / x\\) in (ii) to infer that \\(f(n)\\) divides \\(\\left(p_{i}^{a_{i}}-1\\right) y^{n-1} f\\left(p_{i}^{a_{i}}\\right)\\). Hence \\(p_{i}^{b_{i}}\\) divides \\(\\left(p_{i}^{a_{i}}-1\\right) y^{n-1} f\\left(p_{i}^{a_{i}}\\right)\\), and because \\(p_{i}^{b_{i}}\\) is coprime to \\(\\left(p_{i}^{a_{i}}-1\\right) y^{n-1}\\), it follows that \\(p_{i}^{b_{i}}\\) divides \\(f\\left(p_{i}^{a_{i}}\\right)=p_{i}^{p_{i}^{a_{i}}-1}\\). So \\(b_{i} \\leq p_{i}^{a_{i}}-1\\) for all \\(i=1, \\ldots, k\\). Combined with (i), these conclusions imply\n\n\\[\np_{1}^{a_{1}} \\cdots p_{k}^{a_{k}}=n=d(f(n))=d\\left(p_{1}^{b_{1}} \\cdots p_{k}^{b_{k}}\\right)=\\left(b_{1}+1\\right) \\cdots\\left(b_{k}+1\\right) \\leq p_{1}^{a_{1}} \\cdots p_{k}^{a_{k}} .\n\\]\n\nHence all inequalities \\(b_{i} \\leq p_{i}^{a_{i}}-1\\) must be equalities, \\(i=1, \\ldots, k\\), implying that (1) holds true. The proof is complete."}
{"id": "imo-shortlist-2008-n6", "question": "N6. Prove that there exist infinitely many positive integers \\(n\\) such that \\(n^{2}+1\\) has a prime divisor greater than \\(2 n+\\sqrt{2 n}\\).", "category": "Number Theory", "source": "IMO Shortlist", "year": 2008, "solution": "Let \\(p \\equiv 1(\\bmod 8)\\) be a prime. The congruence \\(x^{2} \\equiv-1(\\bmod p)\\) has two solutions in \\([1, p-1]\\) whose sum is \\(p\\). If \\(n\\) is the smaller one of them then \\(p\\) divides \\(n^{2}+1\\) and \\(n \\leq(p-1) / 2\\). We show that \\(p>2 n+\\sqrt{10 n}\\).\n\nLet \\(n=(p-1) / 2-\\ell\\) where \\(\\ell \\geq 0\\). Then \\(n^{2} \\equiv-1(\\bmod p)\\) gives\n\n\\[\n\\left(\\frac{p-1}{2}-\\ell\\right)^{2} \\equiv-1 \\quad(\\bmod p) \\quad \\text { or } \\quad(2 \\ell+1)^{2}+4 \\equiv 0 \\quad(\\bmod p)\n\\]\n\nThus \\((2 \\ell+1)^{2}+4=r p\\) for some \\(r \\geq 0\\). As \\((2 \\ell+1)^{2} \\equiv 1 \\equiv p(\\bmod 8)\\), we have \\(r \\equiv 5(\\bmod 8)\\), so that \\(r \\geq 5\\). Hence \\((2 \\ell+1)^{2}+4 \\geq 5 p\\), implying \\(\\ell \\geq(\\sqrt{5 p-4}-1) / 2\\). Set \\(\\sqrt{5 p-4}=u\\) for clarity; then \\(\\ell \\geq(u-1) / 2\\). Therefore\n\n\\[\nn=\\frac{p-1}{2}-\\ell \\leq \\frac{1}{2}(p-u)\n\\]\n\nCombined with \\(p=\\left(u^{2}+4\\right) / 5\\), this leads to \\(u^{2}-5 u-10 n+4 \\geq 0\\). Solving this quadratic inequality with respect to \\(u \\geq 0\\) gives \\(u \\geq(5+\\sqrt{40 n+9}) / 2\\). So the estimate \\(n \\leq(p-u) / 2\\) leads to\n\n\\[\np \\geq 2 n+u \\geq 2 n+\\frac{1}{2}(5+\\sqrt{40 n+9})>2 n+\\sqrt{10 n}\n\\]\n\nSince there are infinitely many primes of the form \\(8 k+1\\), it follows easily that there are also infinitely many \\(n\\) with the stated property.\n\nComment. By considering the prime factorization of the product \\(\\prod_{n=1}^{N}\\left(n^{2}+1\\right)\\), it can be obtained that its greatest prime divisor is at least \\(c N \\log N\\). This could improve the statement as \\(p>n \\log n\\).\n\nHowever, the proof applies some advanced information about the distribution of the primes of the form \\(4 k+1\\), which is inappropriate for high schools contests."}
